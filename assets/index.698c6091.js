import{c as uh,g as vz,R as ve,a as bz,b as wz,u as Es,r as ce,G as bt,d as Sl,j as ye,e as joe,f as Sz,F as ur,T as dn,B as B2,h as Ba,p as Woe,n as zoe,i as Goe,k as Yoe,l as Rz,m as F4,o as Ez,q as Cz,s as _z}from"./index.762dfa5b.js";import{d as At,L as Tz,A as Oz,D as Az,R as Koe,a as dR,c as qoe,t as Xoe,r as Qoe}from"./hooks.f495613a.js";import{h as qt,m as Zoe}from"./moment.a565bb48.js";import{c as Ws,u as YS,S as Joe,A as eae,_ as H4,e as Iz,a as tae,b as rae,i as xp,d as nae,f as xz,g as Mz,h as r1,j as Nz,k as iae,l as oae,m as B4,n as Pz,o as Eg,p as aae,q as kz,r as sae,s as $z,t as lae,v as KS,w as uae,x as Lz,y as cae,z as Dz,B as qS,C as fae,D as hae,E as dae,F as Fz,G as pae,H as mae,I as gae,J as yae,K as Qe,L as vae,M as Xi,N as bae,O as wae,P as U4,Q as A_,R as Sae,T as Hz,U as Bz,V as Rae,W as Eae,X as Cae,Y as _ae,Z as V4,$ as Tae,a0 as Oae,a1 as Aae,a2 as Iae,a3 as xae,a4 as tM,a5 as Mae,a6 as pR,a7 as Nae,a8 as Pae}from"./DataGrid.09c43c43.js";import{l as Zi,_ as kb}from"./lodash.1cdac9a5.js";import{T as eu,M as kae,a as $ae,F as Lae,S as Dae}from"./TextField.1f308bd0.js";import{c as Fae,B as Zs}from"./Box.45647d0d.js";import{I as Hae,N as Bae,F as mR}from"./index.f4c50695.js";import{I as Cg,A as I_,C as Uae}from"./TableCell.1c764c2e.js";import{T as ps}from"./Typography.39869122.js";import{p as N}from"./index.4c7d49d7.js";import"./TableRow.d00d6f51.js";const Vae=Fae(),jae=Vae;var dt=function(t){try{return!!t()}catch{return!0}},Wae=dt,n1=!Wae(function(){var t=function(){}.bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),Uz=n1,Vz=Function.prototype,x_=Vz.call,zae=Uz&&Vz.bind.bind(x_,x_),mt=Uz?zae:function(t){return function(){return x_.apply(t,arguments)}},jz=mt,Gae=jz({}.toString),Yae=jz("".slice),ga=function(t){return Yae(Gae(t),8,-1)},Kae=mt,qae=dt,Xae=ga,gR=Object,Qae=Kae("".split),i1=qae(function(){return!gR("z").propertyIsEnumerable(0)})?function(t){return Xae(t)=="String"?Qae(t,""):gR(t)}:gR,No=function(t){return t==null},Zae=No,Jae=TypeError,vi=function(t){if(Zae(t))throw Jae("Can't call method on "+t);return t},ese=i1,tse=vi,$i=function(t){return ese(tse(t))},t0=function(t){return t&&t.Math==Math&&t},nr=t0(typeof globalThis=="object"&&globalThis)||t0(typeof window=="object"&&window)||t0(typeof self=="object"&&self)||t0(typeof uh=="object"&&uh)||function(){return this}()||Function("return this")(),gc={exports:{}},rse=!1,rM=nr,nse=Object.defineProperty,j4=function(t,e){try{nse(rM,t,{value:e,configurable:!0,writable:!0})}catch{rM[t]=e}return e},ise=nr,ose=j4,nM="__core-js_shared__",ase=ise[nM]||ose(nM,{}),W4=ase,iM=W4;(gc.exports=function(t,e){return iM[t]||(iM[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.30.1",mode:"global",copyright:"\xA9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.1/LICENSE",source:"https://github.com/zloirock/core-js"});var sse=vi,lse=Object,bi=function(t){return lse(sse(t))},use=mt,cse=bi,fse=use({}.hasOwnProperty),Rr=Object.hasOwn||function(e,r){return fse(cse(e),r)},hse=mt,dse=0,pse=Math.random(),mse=hse(1 .toString),XS=function(t){return"Symbol("+(t===void 0?"":t)+")_"+mse(++dse+pse,36)},yc=typeof navigator<"u"&&String(navigator.userAgent)||"",Wz=nr,yR=yc,oM=Wz.process,aM=Wz.Deno,sM=oM&&oM.versions||aM&&aM.version,lM=sM&&sM.v8,bo,U2;lM&&(bo=lM.split("."),U2=bo[0]>0&&bo[0]<4?1:+(bo[0]+bo[1]));!U2&&yR&&(bo=yR.match(/Edge\/(\d+)/),(!bo||bo[1]>=74)&&(bo=yR.match(/Chrome\/(\d+)/),bo&&(U2=+bo[1])));var o1=U2,uM=o1,gse=dt,Mp=!!Object.getOwnPropertySymbols&&!gse(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&uM&&uM<41}),yse=Mp,zz=yse&&!Symbol.sham&&typeof Symbol.iterator=="symbol",vse=nr,bse=gc.exports,cM=Rr,wse=XS,Sse=Mp,Rse=zz,Nf=vse.Symbol,vR=bse("wks"),Ese=Rse?Nf.for||Nf:Nf&&Nf.withoutSetter||wse,lr=function(t){return cM(vR,t)||(vR[t]=Sse&&cM(Nf,t)?Nf[t]:Ese("Symbol."+t)),vR[t]},M_=typeof document=="object"&&document.all,Cse=typeof M_>"u"&&M_!==void 0,Gz={all:M_,IS_HTMLDDA:Cse},Yz=Gz,_se=Yz.all,cr=Yz.IS_HTMLDDA?function(t){return typeof t=="function"||t===_se}:function(t){return typeof t=="function"},fM=cr,Kz=Gz,Tse=Kz.all,Wr=Kz.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:fM(t)||t===Tse}:function(t){return typeof t=="object"?t!==null:fM(t)},Ose=Wr,Ase=String,Ise=TypeError,$r=function(t){if(Ose(t))return t;throw Ise(Ase(t)+" is not an object")},z4={},xse=dt,zr=!xse(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),Mse=zr,Nse=dt,qz=Mse&&Nse(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),Jn={},Pse=nr,hM=Wr,N_=Pse.document,kse=hM(N_)&&hM(N_.createElement),QS=function(t){return kse?N_.createElement(t):{}},$se=zr,Lse=dt,Dse=QS,Xz=!$se&&!Lse(function(){return Object.defineProperty(Dse("div"),"a",{get:function(){return 7}}).a!=7}),Fse=n1,r0=Function.prototype.call,en=Fse?r0.bind(r0):function(){return r0.apply(r0,arguments)},bR=nr,Hse=cr,Bse=function(t){return Hse(t)?t:void 0},Cs=function(t,e){return arguments.length<2?Bse(bR[t]):bR[t]&&bR[t][e]},Use=mt,Rl=Use({}.isPrototypeOf),Vse=Cs,jse=cr,Wse=Rl,zse=zz,Gse=Object,a1=zse?function(t){return typeof t=="symbol"}:function(t){var e=Vse("Symbol");return jse(e)&&Wse(e.prototype,Gse(t))},Yse=String,Np=function(t){try{return Yse(t)}catch{return"Object"}},Kse=cr,qse=Np,Xse=TypeError,vc=function(t){if(Kse(t))return t;throw Xse(qse(t)+" is not a function")},Qse=vc,Zse=No,bc=function(t,e){var r=t[e];return Zse(r)?void 0:Qse(r)},wR=en,SR=cr,RR=Wr,Jse=TypeError,Qz=function(t,e){var r,n;if(e==="string"&&SR(r=t.toString)&&!RR(n=wR(r,t))||SR(r=t.valueOf)&&!RR(n=wR(r,t))||e!=="string"&&SR(r=t.toString)&&!RR(n=wR(r,t)))return n;throw Jse("Can't convert object to primitive value")},ele=en,dM=Wr,pM=a1,tle=bc,rle=Qz,nle=lr,ile=TypeError,ole=nle("toPrimitive"),Zz=function(t,e){if(!dM(t)||pM(t))return t;var r=tle(t,ole),n;if(r){if(e===void 0&&(e="default"),n=ele(r,t,e),!dM(n)||pM(n))return n;throw ile("Can't convert object to primitive value")}return e===void 0&&(e="number"),rle(t,e)},ale=Zz,sle=a1,ZS=function(t){var e=ale(t,"string");return sle(e)?e:e+""},lle=zr,ule=Xz,cle=qz,n0=$r,mM=ZS,fle=TypeError,ER=Object.defineProperty,hle=Object.getOwnPropertyDescriptor,CR="enumerable",_R="configurable",TR="writable";Jn.f=lle?cle?function(e,r,n){if(n0(e),r=mM(r),n0(n),typeof e=="function"&&r==="prototype"&&"value"in n&&TR in n&&!n[TR]){var i=hle(e,r);i&&i[TR]&&(e[r]=n.value,n={configurable:_R in n?n[_R]:i[_R],enumerable:CR in n?n[CR]:i[CR],writable:!1})}return ER(e,r,n)}:ER:function(e,r,n){if(n0(e),r=mM(r),n0(n),ule)try{return ER(e,r,n)}catch{}if("get"in n||"set"in n)throw fle("Accessors not supported");return"value"in n&&(e[r]=n.value),e};var dle=Math.ceil,ple=Math.floor,mle=Math.trunc||function(e){var r=+e;return(r>0?ple:dle)(r)},gle=mle,El=function(t){var e=+t;return e!==e||e===0?0:gle(e)},yle=El,vle=Math.max,ble=Math.min,s1=function(t,e){var r=yle(t);return r<0?vle(r+e,0):ble(r,e)},wle=El,Sle=Math.min,wc=function(t){return t>0?Sle(wle(t),9007199254740991):0},Rle=wc,oo=function(t){return Rle(t.length)},Ele=$i,Cle=s1,_le=oo,gM=function(t){return function(e,r,n){var i=Ele(e),o=_le(i),a=Cle(n,o),s;if(t&&r!=r){for(;o>a;)if(s=i[a++],s!=s)return!0}else for(;o>a;a++)if((t||a in i)&&i[a]===r)return t||a||0;return!t&&-1}},G4={includes:gM(!0),indexOf:gM(!1)},l1={},Tle=mt,OR=Rr,Ole=$i,Ale=G4.indexOf,Ile=l1,yM=Tle([].push),Jz=function(t,e){var r=Ole(t),n=0,i=[],o;for(o in r)!OR(Ile,o)&&OR(r,o)&&yM(i,o);for(;e.length>n;)OR(r,o=e[n++])&&(~Ale(i,o)||yM(i,o));return i},Y4=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],xle=Jz,Mle=Y4,u1=Object.keys||function(e){return xle(e,Mle)},Nle=zr,Ple=qz,kle=Jn,$le=$r,Lle=$i,Dle=u1;z4.f=Nle&&!Ple?Object.defineProperties:function(e,r){$le(e);for(var n=Lle(r),i=Dle(r),o=i.length,a=0,s;o>a;)kle.f(e,s=i[a++],n[s]);return e};var Fle=Cs,eG=Fle("document","documentElement"),Hle=gc.exports,Ble=XS,vM=Hle("keys"),JS=function(t){return vM[t]||(vM[t]=Ble(t))},Ule=$r,Vle=z4,bM=Y4,jle=l1,Wle=eG,zle=QS,Gle=JS,wM=">",SM="<",P_="prototype",k_="script",tG=Gle("IE_PROTO"),AR=function(){},rG=function(t){return SM+k_+wM+t+SM+"/"+k_+wM},RM=function(t){t.write(rG("")),t.close();var e=t.parentWindow.Object;return t=null,e},Yle=function(){var t=zle("iframe"),e="java"+k_+":",r;return t.style.display="none",Wle.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(rG("document.F=Object")),r.close(),r.F},i0,$b=function(){try{i0=new ActiveXObject("htmlfile")}catch{}$b=typeof document<"u"?document.domain&&i0?RM(i0):Yle():RM(i0);for(var t=bM.length;t--;)delete $b[P_][bM[t]];return $b()};jle[tG]=!0;var Pp=Object.create||function(e,r){var n;return e!==null?(AR[P_]=Ule(e),n=new AR,AR[P_]=null,n[tG]=e):n=$b(),r===void 0?n:Vle.f(n,r)},Kle=lr,qle=Pp,Xle=Jn.f,$_=Kle("unscopables"),L_=Array.prototype;L_[$_]==null&&Xle(L_,$_,{configurable:!0,value:qle(null)});var c1=function(t){L_[$_][t]=!0},f1={},Qle=nr,Zle=cr,EM=Qle.WeakMap,nG=Zle(EM)&&/native code/.test(String(EM)),h1=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},Jle=zr,eue=Jn,tue=h1,Sc=Jle?function(t,e,r){return eue.f(t,e,tue(1,r))}:function(t,e,r){return t[e]=r,t},rue=nG,iG=nr,nue=Wr,iue=Sc,IR=Rr,xR=W4,oue=JS,aue=l1,CM="Object already initialized",D_=iG.TypeError,sue=iG.WeakMap,V2,_g,j2,lue=function(t){return j2(t)?_g(t):V2(t,{})},uue=function(t){return function(e){var r;if(!nue(e)||(r=_g(e)).type!==t)throw D_("Incompatible receiver, "+t+" required");return r}};if(rue||xR.state){var $o=xR.state||(xR.state=new sue);$o.get=$o.get,$o.has=$o.has,$o.set=$o.set,V2=function(t,e){if($o.has(t))throw D_(CM);return e.facade=t,$o.set(t,e),e},_g=function(t){return $o.get(t)||{}},j2=function(t){return $o.has(t)}}else{var Lc=oue("state");aue[Lc]=!0,V2=function(t,e){if(IR(t,Lc))throw D_(CM);return e.facade=t,iue(t,Lc,e),e},_g=function(t){return IR(t,Lc)?t[Lc]:{}},j2=function(t){return IR(t,Lc)}}var _s={set:V2,get:_g,has:j2,enforce:lue,getterFor:uue},ya={},d1={},oG={}.propertyIsEnumerable,aG=Object.getOwnPropertyDescriptor,cue=aG&&!oG.call({1:2},1);d1.f=cue?function(e){var r=aG(this,e);return!!r&&r.enumerable}:oG;var fue=zr,hue=en,due=d1,pue=h1,mue=$i,gue=ZS,yue=Rr,vue=Xz,_M=Object.getOwnPropertyDescriptor;ya.f=fue?_M:function(e,r){if(e=mue(e),r=gue(r),vue)try{return _M(e,r)}catch{}if(yue(e,r))return pue(!hue(due.f,e,r),e[r])};var K4={exports:{}},F_=zr,bue=Rr,sG=Function.prototype,wue=F_&&Object.getOwnPropertyDescriptor,q4=bue(sG,"name"),Sue=q4&&function(){}.name==="something",Rue=q4&&(!F_||F_&&wue(sG,"name").configurable),p1={EXISTS:q4,PROPER:Sue,CONFIGURABLE:Rue},Eue=mt,Cue=cr,H_=W4,_ue=Eue(Function.toString);Cue(H_.inspectSource)||(H_.inspectSource=function(t){return _ue(t)});var lG=H_.inspectSource,X4=mt,Tue=dt,Oue=cr,o0=Rr,B_=zr,Aue=p1.CONFIGURABLE,Iue=lG,uG=_s,xue=uG.enforce,Mue=uG.get,TM=String,Lb=Object.defineProperty,Nue=X4("".slice),Pue=X4("".replace),kue=X4([].join),$ue=B_&&!Tue(function(){return Lb(function(){},"length",{value:8}).length!==8}),Lue=String(String).split("String"),Due=K4.exports=function(t,e,r){Nue(TM(e),0,7)==="Symbol("&&(e="["+Pue(TM(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!o0(t,"name")||Aue&&t.name!==e)&&(B_?Lb(t,"name",{value:e,configurable:!0}):t.name=e),$ue&&r&&o0(r,"arity")&&t.length!==r.arity&&Lb(t,"length",{value:r.arity});try{r&&o0(r,"constructor")&&r.constructor?B_&&Lb(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var n=xue(t);return o0(n,"source")||(n.source=kue(Lue,typeof e=="string"?e:"")),t};Function.prototype.toString=Due(function(){return Oue(this)&&Mue(this).source||Iue(this)},"toString");var Fue=cr,Hue=Jn,Bue=K4.exports,Uue=j4,ao=function(t,e,r,n){n||(n={});var i=n.enumerable,o=n.name!==void 0?n.name:e;if(Fue(r)&&Bue(r,o,n),n.global)i?t[e]=r:Uue(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=r:Hue.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},Rc={},Vue=Jz,jue=Y4,Wue=jue.concat("length","prototype");Rc.f=Object.getOwnPropertyNames||function(e){return Vue(e,Wue)};var m1={};m1.f=Object.getOwnPropertySymbols;var zue=Cs,Gue=mt,Yue=Rc,Kue=m1,que=$r,Xue=Gue([].concat),cG=zue("Reflect","ownKeys")||function(e){var r=Yue.f(que(e)),n=Kue.f;return n?Xue(r,n(e)):r},OM=Rr,Que=cG,Zue=ya,Jue=Jn,fG=function(t,e,r){for(var n=Que(e),i=Jue.f,o=Zue.f,a=0;a<n.length;a++){var s=n[a];!OM(t,s)&&!(r&&OM(r,s))&&i(t,s,o(e,s))}},ece=dt,tce=cr,rce=/#|\.prototype\./,g1=function(t,e){var r=ice[nce(t)];return r==ace?!0:r==oce?!1:tce(e)?ece(e):!!e},nce=g1.normalize=function(t){return String(t).replace(rce,".").toLowerCase()},ice=g1.data={},oce=g1.NATIVE="N",ace=g1.POLYFILL="P",e6=g1,MR=nr,sce=ya.f,lce=Sc,uce=ao,cce=j4,fce=fG,hce=e6,tt=function(t,e){var r=t.target,n=t.global,i=t.stat,o,a,s,l,u,c;if(n?a=MR:i?a=MR[r]||cce(r,{}):a=(MR[r]||{}).prototype,a)for(s in e){if(u=e[s],t.dontCallGetSet?(c=sce(a,s),l=c&&c.value):l=a[s],o=hce(n?s:r+(i?".":"#")+s,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;fce(u,l)}(t.sham||l&&l.sham)&&lce(u,"sham",!0),uce(a,s,u,t)}},dce=dt,hG=!dce(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),pce=Rr,mce=cr,gce=bi,yce=JS,vce=hG,AM=yce("IE_PROTO"),U_=Object,bce=U_.prototype,t6=vce?U_.getPrototypeOf:function(t){var e=gce(t);if(pce(e,AM))return e[AM];var r=e.constructor;return mce(r)&&e instanceof r?r.prototype:e instanceof U_?bce:null},wce=dt,Sce=cr,Rce=Wr,IM=t6,Ece=ao,Cce=lr,V_=Cce("iterator"),dG=!1,zu,NR,PR;[].keys&&(PR=[].keys(),"next"in PR?(NR=IM(IM(PR)),NR!==Object.prototype&&(zu=NR)):dG=!0);var _ce=!Rce(zu)||wce(function(){var t={};return zu[V_].call(t)!==t});_ce&&(zu={});Sce(zu[V_])||Ece(zu,V_,function(){return this});var pG={IteratorPrototype:zu,BUGGY_SAFARI_ITERATORS:dG},Tce=Jn.f,Oce=Rr,Ace=lr,xM=Ace("toStringTag"),r6=function(t,e,r){t&&!r&&(t=t.prototype),t&&!Oce(t,xM)&&Tce(t,xM,{configurable:!0,value:e})},Ice=pG.IteratorPrototype,xce=Pp,Mce=h1,Nce=r6,Pce=f1,kce=function(){return this},$ce=function(t,e,r,n){var i=e+" Iterator";return t.prototype=xce(Ice,{next:Mce(+!n,r)}),Nce(t,i,!1),Pce[i]=kce,t},Lce=mt,Dce=vc,Fce=function(t,e,r){try{return Lce(Dce(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}},Hce=cr,Bce=String,Uce=TypeError,Vce=function(t){if(typeof t=="object"||Hce(t))return t;throw Uce("Can't set "+Bce(t)+" as a prototype")},jce=Fce,Wce=$r,zce=Vce,Q4=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=jce(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(i,o){return Wce(i),zce(o),t?r(i,o):i.__proto__=o,i}}():void 0),Gce=tt,Yce=en,mG=p1,Kce=cr,qce=$ce,MM=t6,NM=Q4,Xce=r6,Qce=Sc,kR=ao,Zce=lr,Jce=f1,gG=pG,efe=mG.PROPER,tfe=mG.CONFIGURABLE,PM=gG.IteratorPrototype,a0=gG.BUGGY_SAFARI_ITERATORS,Jp=Zce("iterator"),kM="keys",em="values",$M="entries",rfe=function(){return this},Z4=function(t,e,r,n,i,o,a){qce(r,e,n);var s=function(v){if(v===i&&h)return h;if(!a0&&v in c)return c[v];switch(v){case kM:return function(){return new r(this,v)};case em:return function(){return new r(this,v)};case $M:return function(){return new r(this,v)}}return function(){return new r(this)}},l=e+" Iterator",u=!1,c=t.prototype,f=c[Jp]||c["@@iterator"]||i&&c[i],h=!a0&&f||s(i),d=e=="Array"&&c.entries||f,p,m,g;if(d&&(p=MM(d.call(new t)),p!==Object.prototype&&p.next&&(MM(p)!==PM&&(NM?NM(p,PM):Kce(p[Jp])||kR(p,Jp,rfe)),Xce(p,l,!0))),efe&&i==em&&f&&f.name!==em&&(tfe?Qce(c,"name",em):(u=!0,h=function(){return Yce(f,this)})),i)if(m={values:s(em),keys:o?h:s(kM),entries:s($M)},a)for(g in m)(a0||u||!(g in c))&&kR(c,g,m[g]);else Gce({target:e,proto:!0,forced:a0||u},m);return c[Jp]!==h&&kR(c,Jp,h,{name:i}),Jce[e]=h,m},J4=function(t,e){return{value:t,done:e}},nfe=$i,e8=c1,LM=f1,yG=_s,ife=Jn.f,ofe=Z4,s0=J4,afe=zr,vG="Array Iterator",sfe=yG.set,lfe=yG.getterFor(vG),ufe=ofe(Array,"Array",function(t,e){sfe(this,{type:vG,target:nfe(t),index:0,kind:e})},function(){var t=lfe(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,s0(void 0,!0)):r=="keys"?s0(n,!1):r=="values"?s0(e[n],!1):s0([n,e[n]],!1)},"values"),DM=LM.Arguments=LM.Array;e8("keys");e8("values");e8("entries");if(afe&&DM.name!=="values")try{ife(DM,"name",{value:"values"})}catch{}var cfe=lr,ffe=cfe("toStringTag"),bG={};bG[ffe]="z";var t8=String(bG)==="[object z]",hfe=t8,dfe=cr,Db=ga,pfe=lr,mfe=pfe("toStringTag"),gfe=Object,yfe=Db(function(){return arguments}())=="Arguments",vfe=function(t,e){try{return t[e]}catch{}},n6=hfe?Db:function(t){var e,r,n;return t===void 0?"Undefined":t===null?"Null":typeof(r=vfe(e=gfe(t),mfe))=="string"?r:yfe?Db(e):(n=Db(e))=="Object"&&dfe(e.callee)?"Arguments":n},bfe=t8,wfe=n6,Sfe=bfe?{}.toString:function(){return"[object "+wfe(this)+"]"},Rfe=t8,Efe=ao,Cfe=Sfe;Rfe||Efe(Object.prototype,"toString",Cfe,{unsafe:!0});var _fe=n6,Tfe=String,Gr=function(t){if(_fe(t)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return Tfe(t)},r8=mt,Ofe=El,Afe=Gr,Ife=vi,xfe=r8("".charAt),FM=r8("".charCodeAt),Mfe=r8("".slice),HM=function(t){return function(e,r){var n=Afe(Ife(e)),i=Ofe(r),o=n.length,a,s;return i<0||i>=o?t?"":void 0:(a=FM(n,i),a<55296||a>56319||i+1===o||(s=FM(n,i+1))<56320||s>57343?t?xfe(n,i):a:t?Mfe(n,i,i+2):(a-55296<<10)+(s-56320)+65536)}},n8={codeAt:HM(!1),charAt:HM(!0)},Nfe=n8.charAt,Pfe=Gr,wG=_s,kfe=Z4,BM=J4,SG="String Iterator",$fe=wG.set,Lfe=wG.getterFor(SG);kfe(String,"String",function(t){$fe(this,{type:SG,string:Pfe(t),index:0})},function(){var e=Lfe(this),r=e.string,n=e.index,i;return n>=r.length?BM(void 0,!0):(i=Nfe(r,n),e.index+=i.length,BM(i,!1))});var Dfe=dt,i8=!Dfe(function(){return Object.isExtensible(Object.preventExtensions({}))}),Ffe=ao,o8=function(t,e,r){for(var n in e)Ffe(t,n,e[n],r);return t},kp={exports:{}},a8={},Hfe=ZS,Bfe=Jn,Ufe=h1,$p=function(t,e,r){var n=Hfe(e);n in t?Bfe.f(t,n,Ufe(0,r)):t[n]=r},UM=s1,Vfe=oo,jfe=$p,Wfe=Array,zfe=Math.max,s8=function(t,e,r){for(var n=Vfe(t),i=UM(e,n),o=UM(r===void 0?n:r,n),a=Wfe(zfe(o-i,0)),s=0;i<o;i++,s++)jfe(a,s,t[i]);return a.length=s,a},Gfe=ga,Yfe=$i,RG=Rc.f,Kfe=s8,EG=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],qfe=function(t){try{return RG(t)}catch{return Kfe(EG)}};a8.f=function(e){return EG&&Gfe(e)=="Window"?qfe(e):RG(Yfe(e))};var Xfe=dt,Qfe=Xfe(function(){if(typeof ArrayBuffer=="function"){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}),Zfe=dt,Jfe=Wr,ehe=ga,VM=Qfe,Fb=Object.isExtensible,the=Zfe(function(){Fb(1)}),rhe=the||VM?function(e){return!Jfe(e)||VM&&ehe(e)=="ArrayBuffer"?!1:Fb?Fb(e):!0}:Fb,nhe=tt,ihe=mt,ohe=l1,ahe=Wr,l8=Rr,she=Jn.f,jM=Rc,lhe=a8,u8=rhe,uhe=XS,che=i8,CG=!1,vs=uhe("meta"),fhe=0,c8=function(t){she(t,vs,{value:{objectID:"O"+fhe++,weakData:{}}})},hhe=function(t,e){if(!ahe(t))return typeof t=="symbol"?t:(typeof t=="string"?"S":"P")+t;if(!l8(t,vs)){if(!u8(t))return"F";if(!e)return"E";c8(t)}return t[vs].objectID},dhe=function(t,e){if(!l8(t,vs)){if(!u8(t))return!0;if(!e)return!1;c8(t)}return t[vs].weakData},phe=function(t){return che&&CG&&u8(t)&&!l8(t,vs)&&c8(t),t},mhe=function(){ghe.enable=function(){},CG=!0;var t=jM.f,e=ihe([].splice),r={};r[vs]=1,t(r).length&&(jM.f=function(n){for(var i=t(n),o=0,a=i.length;o<a;o++)if(i[o]===vs){e(i,o,1);break}return i},nhe({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:lhe.f}))},ghe=kp.exports={enable:mhe,fastKey:hhe,getWeakData:dhe,onFreeze:phe};ohe[vs]=!0;var yhe=ga,vhe=mt,y1=function(t){if(yhe(t)==="Function")return vhe(t)},WM=y1,bhe=vc,whe=n1,She=WM(WM.bind),v1=function(t,e){return bhe(t),e===void 0?t:whe?She(t,e):function(){return t.apply(e,arguments)}},Rhe=lr,Ehe=f1,Che=Rhe("iterator"),_he=Array.prototype,_G=function(t){return t!==void 0&&(Ehe.Array===t||_he[Che]===t)},The=n6,zM=bc,Ohe=No,Ahe=f1,Ihe=lr,xhe=Ihe("iterator"),f8=function(t){if(!Ohe(t))return zM(t,xhe)||zM(t,"@@iterator")||Ahe[The(t)]},Mhe=en,Nhe=vc,Phe=$r,khe=Np,$he=f8,Lhe=TypeError,TG=function(t,e){var r=arguments.length<2?$he(t):e;if(Nhe(r))return Phe(Mhe(r,t));throw Lhe(khe(t)+" is not iterable")},Dhe=en,GM=$r,Fhe=bc,OG=function(t,e,r){var n,i;GM(t);try{if(n=Fhe(t,"return"),!n){if(e==="throw")throw r;return r}n=Dhe(n,t)}catch(o){i=!0,n=o}if(e==="throw")throw r;if(i)throw n;return GM(n),r},Hhe=v1,Bhe=en,Uhe=$r,Vhe=Np,jhe=_G,Whe=oo,YM=Rl,zhe=TG,Ghe=f8,KM=OG,Yhe=TypeError,Hb=function(t,e){this.stopped=t,this.result=e},qM=Hb.prototype,h8=function(t,e,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),o=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),s=!!(r&&r.INTERRUPTED),l=Hhe(e,n),u,c,f,h,d,p,m,g=function(w){return u&&KM(u,"normal",w),new Hb(!0,w)},v=function(w){return i?(Uhe(w),s?l(w[0],w[1],g):l(w[0],w[1])):s?l(w,g):l(w)};if(o)u=t.iterator;else if(a)u=t;else{if(c=Ghe(t),!c)throw Yhe(Vhe(t)+" is not iterable");if(jhe(c)){for(f=0,h=Whe(t);h>f;f++)if(d=v(t[f]),d&&YM(qM,d))return d;return new Hb(!1)}u=zhe(t,c)}for(p=o?t.next:u.next;!(m=Bhe(p,u)).done;){try{d=v(m.value)}catch(w){KM(u,"throw",w)}if(typeof d=="object"&&d&&YM(qM,d))return d}return new Hb(!1)},Khe=Rl,qhe=TypeError,d8=function(t,e){if(Khe(e,t))return t;throw qhe("Incorrect invocation")},Xhe=lr,AG=Xhe("iterator"),IG=!1;try{var Qhe=0,XM={next:function(){return{done:!!Qhe++}},return:function(){IG=!0}};XM[AG]=function(){return this},Array.from(XM,function(){throw 2})}catch{}var xG=function(t,e){if(!e&&!IG)return!1;var r=!1;try{var n={};n[AG]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch{}return r},Zhe=cr,Jhe=Wr,QM=Q4,p8=function(t,e,r){var n,i;return QM&&Zhe(n=e.constructor)&&n!==r&&Jhe(i=n.prototype)&&i!==r.prototype&&QM(t,i),t},ede=tt,tde=nr,rde=mt,ZM=e6,nde=ao,ide=kp.exports,ode=h8,ade=d8,sde=cr,lde=No,$R=Wr,LR=dt,ude=xG,cde=r6,fde=p8,i6=function(t,e,r){var n=t.indexOf("Map")!==-1,i=t.indexOf("Weak")!==-1,o=n?"set":"add",a=tde[t],s=a&&a.prototype,l=a,u={},c=function(v){var w=rde(s[v]);nde(s,v,v=="add"?function(E){return w(this,E===0?0:E),this}:v=="delete"?function(b){return i&&!$R(b)?!1:w(this,b===0?0:b)}:v=="get"?function(E){return i&&!$R(E)?void 0:w(this,E===0?0:E)}:v=="has"?function(E){return i&&!$R(E)?!1:w(this,E===0?0:E)}:function(E,A){return w(this,E===0?0:E,A),this})},f=ZM(t,!sde(a)||!(i||s.forEach&&!LR(function(){new a().entries().next()})));if(f)l=r.getConstructor(e,t,n,o),ide.enable();else if(ZM(t,!0)){var h=new l,d=h[o](i?{}:-0,1)!=h,p=LR(function(){h.has(1)}),m=ude(function(v){new a(v)}),g=!i&&LR(function(){for(var v=new a,w=5;w--;)v[o](w,w);return!v.has(-0)});m||(l=e(function(v,w){ade(v,s);var b=fde(new a,v,l);return lde(w)||ode(w,b[o],{that:b,AS_ENTRIES:n}),b}),l.prototype=s,s.constructor=l),(p||g)&&(c("delete"),c("has"),n&&c("get")),(g||d)&&c(o),i&&s.clear&&delete s.clear}return u[t]=l,ede({global:!0,constructor:!0,forced:l!=a},u),cde(l,t),i||r.setStrong(l,t,n),l},hde=ga,Lp=Array.isArray||function(e){return hde(e)=="Array"},dde=mt,pde=dt,MG=cr,mde=n6,gde=Cs,yde=lG,NG=function(){},vde=[],PG=gde("Reflect","construct"),m8=/^\s*(?:class|function)\b/,bde=dde(m8.exec),wde=!m8.exec(NG),tm=function(e){if(!MG(e))return!1;try{return PG(NG,vde,e),!0}catch{return!1}},kG=function(e){if(!MG(e))return!1;switch(mde(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return wde||!!bde(m8,yde(e))}catch{return!0}};kG.sham=!0;var o6=!PG||pde(function(){var t;return tm(tm.call)||!tm(Object)||!tm(function(){t=!0})||t})?kG:tm,JM=Lp,Sde=o6,Rde=Wr,Ede=lr,Cde=Ede("species"),eN=Array,_de=function(t){var e;return JM(t)&&(e=t.constructor,Sde(e)&&(e===eN||JM(e.prototype))?e=void 0:Rde(e)&&(e=e[Cde],e===null&&(e=void 0))),e===void 0?eN:e},Tde=_de,g8=function(t,e){return new(Tde(t))(e===0?0:e)},Ode=v1,Ade=mt,Ide=i1,xde=bi,Mde=oo,Nde=g8,tN=Ade([].push),xs=function(t){var e=t==1,r=t==2,n=t==3,i=t==4,o=t==6,a=t==7,s=t==5||o;return function(l,u,c,f){for(var h=xde(l),d=Ide(h),p=Ode(u,c),m=Mde(d),g=0,v=f||Nde,w=e?v(l,m):r||a?v(l,0):void 0,b,E;m>g;g++)if((s||g in d)&&(b=d[g],E=p(b,g,h),t))if(e)w[g]=E;else if(E)switch(t){case 3:return!0;case 5:return b;case 6:return g;case 2:tN(w,b)}else switch(t){case 4:return!1;case 7:tN(w,b)}return o?-1:n||i?i:w}},Ec={forEach:xs(0),map:xs(1),filter:xs(2),some:xs(3),every:xs(4),find:xs(5),findIndex:xs(6),filterReject:xs(7)},Pde=mt,rN=o8,l0=kp.exports.getWeakData,kde=d8,$de=$r,Lde=No,DR=Wr,Dde=h8,$G=Ec,nN=Rr,LG=_s,Fde=LG.set,Hde=LG.getterFor,Bde=$G.find,Ude=$G.findIndex,Vde=Pde([].splice),jde=0,u0=function(t){return t.frozen||(t.frozen=new DG)},DG=function(){this.entries=[]},FR=function(t,e){return Bde(t.entries,function(r){return r[0]===e})};DG.prototype={get:function(t){var e=FR(this,t);if(e)return e[1]},has:function(t){return!!FR(this,t)},set:function(t,e){var r=FR(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=Ude(this.entries,function(r){return r[0]===t});return~e&&Vde(this.entries,e,1),!!~e}};var FG={getConstructor:function(t,e,r,n){var i=t(function(l,u){kde(l,o),Fde(l,{type:e,id:jde++,frozen:void 0}),Lde(u)||Dde(u,l[n],{that:l,AS_ENTRIES:r})}),o=i.prototype,a=Hde(e),s=function(l,u,c){var f=a(l),h=l0($de(u),!0);return h===!0?u0(f).set(u,c):h[f.id]=c,l};return rN(o,{delete:function(l){var u=a(this);if(!DR(l))return!1;var c=l0(l);return c===!0?u0(u).delete(l):c&&nN(c,u.id)&&delete c[u.id]},has:function(u){var c=a(this);if(!DR(u))return!1;var f=l0(u);return f===!0?u0(c).has(u):f&&nN(f,c.id)}}),rN(o,r?{get:function(u){var c=a(this);if(DR(u)){var f=l0(u);return f===!0?u0(c).get(u):f?f[c.id]:void 0}},set:function(u,c){return s(this,u,c)}}:{add:function(u){return s(this,u,!0)}}),i}},Wde=i8,iN=nr,Bb=mt,oN=o8,zde=kp.exports,Gde=i6,HG=FG,c0=Wr,f0=_s.enforce,Yde=dt,Kde=nG,b1=Object,qde=Array.isArray,h0=b1.isExtensible,BG=b1.isFrozen,Xde=b1.isSealed,UG=b1.freeze,Qde=b1.seal,aN={},sN={},Zde=!iN.ActiveXObject&&"ActiveXObject"in iN,rm,VG=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},jG=Gde("WeakMap",VG,HG),Rf=jG.prototype,Ub=Bb(Rf.set),Jde=function(){return Wde&&Yde(function(){var t=UG([]);return Ub(new jG,t,1),!BG(t)})};if(Kde)if(Zde){rm=HG.getConstructor(VG,"WeakMap",!0),zde.enable();var lN=Bb(Rf.delete),d0=Bb(Rf.has),uN=Bb(Rf.get);oN(Rf,{delete:function(t){if(c0(t)&&!h0(t)){var e=f0(this);return e.frozen||(e.frozen=new rm),lN(this,t)||e.frozen.delete(t)}return lN(this,t)},has:function(e){if(c0(e)&&!h0(e)){var r=f0(this);return r.frozen||(r.frozen=new rm),d0(this,e)||r.frozen.has(e)}return d0(this,e)},get:function(e){if(c0(e)&&!h0(e)){var r=f0(this);return r.frozen||(r.frozen=new rm),d0(this,e)?uN(this,e):r.frozen.get(e)}return uN(this,e)},set:function(e,r){if(c0(e)&&!h0(e)){var n=f0(this);n.frozen||(n.frozen=new rm),d0(this,e)?Ub(this,e,r):n.frozen.set(e,r)}else Ub(this,e,r);return this}})}else Jde()&&oN(Rf,{set:function(e,r){var n;return qde(e)&&(BG(e)?n=aN:Xde(e)&&(n=sN)),Ub(this,e,r),n==aN&&UG(e),n==sN&&Qde(e),this}});var WG={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},epe=QS,HR=epe("span").classList,cN=HR&&HR.constructor&&HR.constructor.prototype,zG=cN===Object.prototype?void 0:cN,fN=nr,GG=WG,tpe=zG,$m=ufe,BR=Sc,YG=lr,UR=YG("iterator"),hN=YG("toStringTag"),VR=$m.values,KG=function(t,e){if(t){if(t[UR]!==VR)try{BR(t,UR,VR)}catch{t[UR]=VR}if(t[hN]||BR(t,hN,e),GG[e]){for(var r in $m)if(t[r]!==$m[r])try{BR(t,r,$m[r])}catch{t[r]=$m[r]}}}};for(var jR in GG)KG(fN[jR]&&fN[jR].prototype,jR);KG(tpe,"DOMTokenList");var rpe=dt,Dp=function(t,e){var r=[][t];return!!r&&rpe(function(){r.call(null,e||function(){return 1},1)})},npe=tt,ipe=y1,ope=G4.indexOf,ape=Dp,j_=ipe([].indexOf),qG=!!j_&&1/j_([1],1,-0)<0,spe=qG||!ape("indexOf");npe({target:"Array",proto:!0,forced:spe},{indexOf:function(e){var r=arguments.length>1?arguments[1]:void 0;return qG?j_(this,e,r)||0:ope(this,e,r)}});var dN=Np,lpe=TypeError,XG=function(t,e){if(!delete t[e])throw lpe("Cannot delete property "+dN(e)+" of "+dN(t))},pN=s8,upe=Math.floor,W_=function(t,e){var r=t.length,n=upe(r/2);return r<8?cpe(t,e):fpe(t,W_(pN(t,0,n),e),W_(pN(t,n),e),e)},cpe=function(t,e){for(var r=t.length,n=1,i,o;n<r;){for(o=n,i=t[n];o&&e(t[o-1],i)>0;)t[o]=t[--o];o!==n++&&(t[o]=i)}return t},fpe=function(t,e,r,n){for(var i=e.length,o=r.length,a=0,s=0;a<i||s<o;)t[a+s]=a<i&&s<o?n(e[a],r[s])<=0?e[a++]:r[s++]:a<i?e[a++]:r[s++];return t},hpe=W_,dpe=yc,mN=dpe.match(/firefox\/(\d+)/i),ppe=!!mN&&+mN[1],mpe=yc,gpe=/MSIE|Trident/.test(mpe),ype=yc,gN=ype.match(/AppleWebKit\/(\d+)\./),vpe=!!gN&&+gN[1],bpe=tt,QG=mt,wpe=vc,Spe=bi,yN=oo,Rpe=XG,vN=Gr,y8=dt,Epe=hpe,Cpe=Dp,bN=ppe,_pe=gpe,wN=o1,SN=vpe,zs=[],RN=QG(zs.sort),Tpe=QG(zs.push),Ope=y8(function(){zs.sort(void 0)}),Ape=y8(function(){zs.sort(null)}),Ipe=Cpe("sort"),ZG=!y8(function(){if(wN)return wN<70;if(!(bN&&bN>3)){if(_pe)return!0;if(SN)return SN<603;var t="",e,r,n,i;for(e=65;e<76;e++){switch(r=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)zs.push({k:r+i,v:n})}for(zs.sort(function(o,a){return a.v-o.v}),i=0;i<zs.length;i++)r=zs[i].k.charAt(0),t.charAt(t.length-1)!==r&&(t+=r);return t!=="DGBEFHACIJK"}}),xpe=Ope||!Ape||!Ipe||!ZG,Mpe=function(t){return function(e,r){return r===void 0?-1:e===void 0?1:t!==void 0?+t(e,r)||0:vN(e)>vN(r)?1:-1}};bpe({target:"Array",proto:!0,forced:xpe},{sort:function(e){e!==void 0&&wpe(e);var r=Spe(this);if(ZG)return e===void 0?RN(r):RN(r,e);var n=[],i=yN(r),o,a;for(a=0;a<i;a++)a in r&&Tpe(n,r[a]);for(Epe(n,Mpe(e)),o=yN(n),a=0;a<o;)r[a]=n[a++];for(;a<i;)Rpe(r,a++);return r}});var Npe=tt,Ppe=Ec.find,kpe=c1,z_="find",JG=!0;z_ in[]&&Array(1)[z_](function(){JG=!1});Npe({target:"Array",proto:!0,forced:JG},{find:function(e){return Ppe(this,e,arguments.length>1?arguments[1]:void 0)}});kpe(z_);var $pe=$r,eY=function(){var t=$pe(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},v8=dt,Lpe=nr,b8=Lpe.RegExp,w8=v8(function(){var t=b8("a","y");return t.lastIndex=2,t.exec("abcd")!=null}),Dpe=w8||v8(function(){return!b8("a","y").sticky}),Fpe=w8||v8(function(){var t=b8("^r","gy");return t.lastIndex=2,t.exec("str")!=null}),S8={BROKEN_CARET:Fpe,MISSED_STICKY:Dpe,UNSUPPORTED_Y:w8},Hpe=dt,Bpe=nr,Upe=Bpe.RegExp,tY=Hpe(function(){var t=Upe(".","s");return!(t.dotAll&&t.exec(`
`)&&t.flags==="s")}),Vpe=dt,jpe=nr,Wpe=jpe.RegExp,rY=Vpe(function(){var t=Wpe("(?<a>b)","g");return t.exec("b").groups.a!=="b"||"b".replace(t,"$<a>c")!=="bc"}),Pf=en,a6=mt,zpe=Gr,Gpe=eY,Ype=S8,Kpe=gc.exports,qpe=Pp,Xpe=_s.get,Qpe=tY,Zpe=rY,Jpe=Kpe("native-string-replace",String.prototype.replace),W2=RegExp.prototype.exec,G_=W2,eme=a6("".charAt),tme=a6("".indexOf),rme=a6("".replace),WR=a6("".slice),Y_=function(){var t=/a/,e=/b*/g;return Pf(W2,t,"a"),Pf(W2,e,"a"),t.lastIndex!==0||e.lastIndex!==0}(),nY=Ype.BROKEN_CARET,K_=/()??/.exec("")[1]!==void 0,nme=Y_||K_||nY||Qpe||Zpe;nme&&(G_=function(e){var r=this,n=Xpe(r),i=zpe(e),o=n.raw,a,s,l,u,c,f,h;if(o)return o.lastIndex=r.lastIndex,a=Pf(G_,o,i),r.lastIndex=o.lastIndex,a;var d=n.groups,p=nY&&r.sticky,m=Pf(Gpe,r),g=r.source,v=0,w=i;if(p&&(m=rme(m,"y",""),tme(m,"g")===-1&&(m+="g"),w=WR(i,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&eme(i,r.lastIndex-1)!==`
`)&&(g="(?: "+g+")",w=" "+w,v++),s=new RegExp("^(?:"+g+")",m)),K_&&(s=new RegExp("^"+g+"$(?!\\s)",m)),Y_&&(l=r.lastIndex),u=Pf(W2,p?s:r,w),p?u?(u.input=WR(u.input,v),u[0]=WR(u[0],v),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:Y_&&u&&(r.lastIndex=r.global?u.index+u[0].length:l),K_&&u&&u.length>1&&Pf(Jpe,u[0],s,function(){for(c=1;c<arguments.length-2;c++)arguments[c]===void 0&&(u[c]=void 0)}),u&&d)for(u.groups=f=qpe(null),c=0;c<d.length;c++)h=d[c],f[h[0]]=u[h[1]];return u});var s6=G_,ime=tt,EN=s6;ime({target:"RegExp",proto:!0,forced:/./.exec!==EN},{exec:EN});var ome=n1,iY=Function.prototype,CN=iY.apply,_N=iY.call,Cc=typeof Reflect=="object"&&Reflect.apply||(ome?_N.bind(CN):function(){return _N.apply(CN,arguments)}),TN=y1,ON=ao,ame=s6,AN=dt,oY=lr,sme=Sc,lme=oY("species"),zR=RegExp.prototype,l6=function(t,e,r,n){var i=oY(t),o=!AN(function(){var u={};return u[i]=function(){return 7},""[t](u)!=7}),a=o&&!AN(function(){var u=!1,c=/a/;return t==="split"&&(c={},c.constructor={},c.constructor[lme]=function(){return c},c.flags="",c[i]=/./[i]),c.exec=function(){return u=!0,null},c[i](""),!u});if(!o||!a||r){var s=TN(/./[i]),l=e(i,""[t],function(u,c,f,h,d){var p=TN(u),m=c.exec;return m===ame||m===zR.exec?o&&!d?{done:!0,value:s(c,f,h)}:{done:!0,value:p(f,c,h)}:{done:!1}});ON(String.prototype,t,l[0]),ON(zR,i,l[1])}n&&sme(zR[i],"sham",!0)},ume=n8.charAt,R8=function(t,e,r){return e+(r?ume(t,e).length:1)},E8=mt,cme=bi,fme=Math.floor,GR=E8("".charAt),hme=E8("".replace),YR=E8("".slice),dme=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,pme=/\$([$&'`]|\d{1,2})/g,mme=function(t,e,r,n,i,o){var a=r+t.length,s=n.length,l=pme;return i!==void 0&&(i=cme(i),l=dme),hme(o,l,function(u,c){var f;switch(GR(c,0)){case"$":return"$";case"&":return t;case"`":return YR(e,0,r);case"'":return YR(e,a);case"<":f=i[YR(c,1,-1)];break;default:var h=+c;if(h===0)return u;if(h>s){var d=fme(h/10);return d===0?u:d<=s?n[d-1]===void 0?GR(c,1):n[d-1]+GR(c,1):u}f=n[h-1]}return f===void 0?"":f})},IN=en,gme=$r,yme=cr,vme=ga,bme=s6,wme=TypeError,u6=function(t,e){var r=t.exec;if(yme(r)){var n=IN(r,t,e);return n!==null&&gme(n),n}if(vme(t)==="RegExp")return IN(bme,t,e);throw wme("RegExp#exec called on incompatible receiver")},Sme=Cc,xN=en,c6=mt,Rme=l6,Eme=dt,Cme=$r,_me=cr,Tme=No,Ome=El,Ame=wc,Dc=Gr,Ime=vi,xme=R8,Mme=bc,Nme=mme,Pme=u6,kme=lr,q_=kme("replace"),$me=Math.max,Lme=Math.min,Dme=c6([].concat),KR=c6([].push),MN=c6("".indexOf),NN=c6("".slice),Fme=function(t){return t===void 0?t:String(t)},Hme=function(){return"a".replace(/./,"$0")==="$0"}(),PN=function(){return/./[q_]?/./[q_]("a","$0")==="":!1}(),Bme=!Eme(function(){var t=/./;return t.exec=function(){var e=[];return e.groups={a:"7"},e},"".replace(t,"$<a>")!=="7"});Rme("replace",function(t,e,r){var n=PN?"$":"$0";return[function(o,a){var s=Ime(this),l=Tme(o)?void 0:Mme(o,q_);return l?xN(l,o,s,a):xN(e,Dc(s),o,a)},function(i,o){var a=Cme(this),s=Dc(i);if(typeof o=="string"&&MN(o,n)===-1&&MN(o,"$<")===-1){var l=r(e,a,s,o);if(l.done)return l.value}var u=_me(o);u||(o=Dc(o));var c=a.global;if(c){var f=a.unicode;a.lastIndex=0}for(var h=[];;){var d=Pme(a,s);if(d===null||(KR(h,d),!c))break;var p=Dc(d[0]);p===""&&(a.lastIndex=xme(s,Ame(a.lastIndex),f))}for(var m="",g=0,v=0;v<h.length;v++){d=h[v];for(var w=Dc(d[0]),b=$me(Lme(Ome(d.index),s.length),0),E=[],A=1;A<d.length;A++)KR(E,Fme(d[A]));var M=d.groups;if(u){var k=Dme([w],E,b,s);M!==void 0&&KR(k,M);var O=Dc(Sme(o,void 0,k))}else O=Nme(w,s,b,E,M,o);b>=g&&(m+=NN(s,g,b)+O,g=b+w.length)}return m+NN(s,g)}]},!Bme||!Hme||PN);var Ume=dt,Vme=lr,jme=o1,Wme=Vme("species"),w1=function(t){return jme>=51||!Ume(function(){var e=[],r=e.constructor={};return r[Wme]=function(){return{foo:1}},e[t](Boolean).foo!==1})},zme=tt,Gme=Ec.filter,Yme=w1,Kme=Yme("filter");zme({target:"Array",proto:!0,forced:!Kme},{filter:function(e){return Gme(this,e,arguments.length>1?arguments[1]:void 0)}});var qme=nr,aY=qme,C8={},Xme=lr;C8.f=Xme;var kN=aY,Qme=Rr,Zme=C8,Jme=Jn.f,_8=function(t){var e=kN.Symbol||(kN.Symbol={});Qme(e,t)||Jme(e,t,{value:Zme.f(t)})},ege=en,tge=Cs,rge=lr,nge=ao,sY=function(){var t=tge("Symbol"),e=t&&t.prototype,r=e&&e.valueOf,n=rge("toPrimitive");e&&!e[n]&&nge(e,n,function(i){return ege(r,this)},{arity:1})},ige=_8,oge=sY;ige("toPrimitive");oge();var age=$r,sge=Qz,lge=TypeError,uge=function(t){if(age(this),t==="string"||t==="default")t="string";else if(t!=="number")throw lge("Incorrect hint");return sge(this,t)},cge=Rr,fge=ao,hge=uge,dge=lr,$N=dge("toPrimitive"),LN=Date.prototype;cge(LN,$N)||fge(LN,$N,hge);var DN=K4.exports,pge=Jn,S1=function(t,e,r){return r.get&&DN(r.get,e,{getter:!0}),r.set&&DN(r.set,e,{setter:!0}),pge.f(t,e,r)},f6=tt,T8=nr,O8=en,mge=mt,ch=zr,fh=Mp,gge=dt,mn=Rr,yge=Rl,X_=$r,h6=$i,A8=ZS,vge=Gr,Q_=h1,Tg=Pp,lY=u1,bge=Rc,uY=a8,wge=m1,cY=ya,fY=Jn,Sge=z4,hY=d1,qR=ao,Rge=S1,I8=gc.exports,Ege=JS,dY=l1,FN=XS,Cge=lr,_ge=C8,Tge=_8,Oge=sY,Age=r6,pY=_s,d6=Ec.forEach,si=Ege("hidden"),p6="Symbol",Og="prototype",Ige=pY.set,HN=pY.getterFor(p6),Yi=Object[Og],Fu=T8.Symbol,Lm=Fu&&Fu[Og],xge=T8.TypeError,XR=T8.QObject,mY=cY.f,tu=fY.f,gY=uY.f,Mge=hY.f,yY=mge([].push),bs=I8("symbols"),R1=I8("op-symbols"),Nge=I8("wks"),Z_=!XR||!XR[Og]||!XR[Og].findChild,J_=ch&&gge(function(){return Tg(tu({},"a",{get:function(){return tu(this,"a",{value:7}).a}})).a!=7})?function(t,e,r){var n=mY(Yi,e);n&&delete Yi[e],tu(t,e,r),n&&t!==Yi&&tu(Yi,e,n)}:tu,QR=function(t,e){var r=bs[t]=Tg(Lm);return Ige(r,{type:p6,tag:t,description:e}),ch||(r.description=e),r},m6=function(e,r,n){e===Yi&&m6(R1,r,n),X_(e);var i=A8(r);return X_(n),mn(bs,i)?(n.enumerable?(mn(e,si)&&e[si][i]&&(e[si][i]=!1),n=Tg(n,{enumerable:Q_(0,!1)})):(mn(e,si)||tu(e,si,Q_(1,{})),e[si][i]=!0),J_(e,i,n)):tu(e,i,n)},x8=function(e,r){X_(e);var n=h6(r),i=lY(n).concat(wY(n));return d6(i,function(o){(!ch||O8(eT,n,o))&&m6(e,o,n[o])}),e},Pge=function(e,r){return r===void 0?Tg(e):x8(Tg(e),r)},eT=function(e){var r=A8(e),n=O8(Mge,this,r);return this===Yi&&mn(bs,r)&&!mn(R1,r)?!1:n||!mn(this,r)||!mn(bs,r)||mn(this,si)&&this[si][r]?n:!0},vY=function(e,r){var n=h6(e),i=A8(r);if(!(n===Yi&&mn(bs,i)&&!mn(R1,i))){var o=mY(n,i);return o&&mn(bs,i)&&!(mn(n,si)&&n[si][i])&&(o.enumerable=!0),o}},bY=function(e){var r=gY(h6(e)),n=[];return d6(r,function(i){!mn(bs,i)&&!mn(dY,i)&&yY(n,i)}),n},wY=function(t){var e=t===Yi,r=gY(e?R1:h6(t)),n=[];return d6(r,function(i){mn(bs,i)&&(!e||mn(Yi,i))&&yY(n,bs[i])}),n};fh||(Fu=function(){if(yge(Lm,this))throw xge("Symbol is not a constructor");var e=!arguments.length||arguments[0]===void 0?void 0:vge(arguments[0]),r=FN(e),n=function(i){this===Yi&&O8(n,R1,i),mn(this,si)&&mn(this[si],r)&&(this[si][r]=!1),J_(this,r,Q_(1,i))};return ch&&Z_&&J_(Yi,r,{configurable:!0,set:n}),QR(r,e)},Lm=Fu[Og],qR(Lm,"toString",function(){return HN(this).tag}),qR(Fu,"withoutSetter",function(t){return QR(FN(t),t)}),hY.f=eT,fY.f=m6,Sge.f=x8,cY.f=vY,bge.f=uY.f=bY,wge.f=wY,_ge.f=function(t){return QR(Cge(t),t)},ch&&(Rge(Lm,"description",{configurable:!0,get:function(){return HN(this).description}}),qR(Yi,"propertyIsEnumerable",eT,{unsafe:!0})));f6({global:!0,constructor:!0,wrap:!0,forced:!fh,sham:!fh},{Symbol:Fu});d6(lY(Nge),function(t){Tge(t)});f6({target:p6,stat:!0,forced:!fh},{useSetter:function(){Z_=!0},useSimple:function(){Z_=!1}});f6({target:"Object",stat:!0,forced:!fh,sham:!ch},{create:Pge,defineProperty:m6,defineProperties:x8,getOwnPropertyDescriptor:vY});f6({target:"Object",stat:!0,forced:!fh},{getOwnPropertyNames:bY});Oge();Age(Fu,p6);dY[si]=!0;var kge=Mp,SY=kge&&!!Symbol.for&&!!Symbol.keyFor,$ge=tt,Lge=Cs,Dge=Rr,Fge=Gr,RY=gc.exports,Hge=SY,ZR=RY("string-to-symbol-registry"),Bge=RY("symbol-to-string-registry");$ge({target:"Symbol",stat:!0,forced:!Hge},{for:function(t){var e=Fge(t);if(Dge(ZR,e))return ZR[e];var r=Lge("Symbol")(e);return ZR[e]=r,Bge[r]=e,r}});var Uge=tt,Vge=Rr,jge=a1,Wge=Np,zge=gc.exports,Gge=SY,BN=zge("symbol-to-string-registry");Uge({target:"Symbol",stat:!0,forced:!Gge},{keyFor:function(e){if(!jge(e))throw TypeError(Wge(e)+" is not a symbol");if(Vge(BN,e))return BN[e]}});var Yge=mt,E1=Yge([].slice),Kge=mt,UN=Lp,qge=cr,VN=ga,Xge=Gr,jN=Kge([].push),Qge=function(t){if(qge(t))return t;if(!!UN(t)){for(var e=t.length,r=[],n=0;n<e;n++){var i=t[n];typeof i=="string"?jN(r,i):(typeof i=="number"||VN(i)=="Number"||VN(i)=="String")&&jN(r,Xge(i))}var o=r.length,a=!0;return function(s,l){if(a)return a=!1,l;if(UN(this))return l;for(var u=0;u<o;u++)if(r[u]===s)return l}}},Zge=tt,EY=Cs,CY=Cc,Jge=en,C1=mt,_Y=dt,WN=cr,zN=a1,TY=E1,eye=Qge,tye=Mp,rye=String,Js=EY("JSON","stringify"),p0=C1(/./.exec),GN=C1("".charAt),nye=C1("".charCodeAt),iye=C1("".replace),oye=C1(1 .toString),aye=/[\uD800-\uDFFF]/g,YN=/^[\uD800-\uDBFF]$/,KN=/^[\uDC00-\uDFFF]$/,qN=!tye||_Y(function(){var t=EY("Symbol")();return Js([t])!="[null]"||Js({a:t})!="{}"||Js(Object(t))!="{}"}),XN=_Y(function(){return Js("\uDF06\uD834")!=='"\\udf06\\ud834"'||Js("\uDEAD")!=='"\\udead"'}),sye=function(t,e){var r=TY(arguments),n=eye(e);if(!(!WN(n)&&(t===void 0||zN(t))))return r[1]=function(i,o){if(WN(n)&&(o=Jge(n,this,rye(i),o)),!zN(o))return o},CY(Js,null,r)},lye=function(t,e,r){var n=GN(r,e-1),i=GN(r,e+1);return p0(YN,t)&&!p0(KN,i)||p0(KN,t)&&!p0(YN,n)?"\\u"+oye(nye(t,0),16):t};Js&&Zge({target:"JSON",stat:!0,arity:3,forced:qN||XN},{stringify:function(e,r,n){var i=TY(arguments),o=CY(qN?sye:Js,null,i);return XN&&typeof o=="string"?iye(o,aye,lye):o}});var uye=tt,cye=Mp,fye=dt,OY=m1,hye=bi,dye=!cye||fye(function(){OY.f(1)});uye({target:"Object",stat:!0,forced:dye},{getOwnPropertySymbols:function(e){var r=OY.f;return r?r(hye(e)):[]}});var pye=tt,mye=zr,gye=nr,m0=mt,yye=Rr,vye=cr,bye=Rl,wye=Gr,Sye=S1,Rye=fG,Na=gye.Symbol,Ml=Na&&Na.prototype;if(mye&&vye(Na)&&(!("description"in Ml)||Na().description!==void 0)){var QN={},g0=function(){var e=arguments.length<1||arguments[0]===void 0?void 0:wye(arguments[0]),r=bye(Ml,this)?new Na(e):e===void 0?Na():Na(e);return e===""&&(QN[r]=!0),r};Rye(g0,Na),g0.prototype=Ml,Ml.constructor=g0;var Eye=String(Na("test"))=="Symbol(test)",Cye=m0(Ml.valueOf),_ye=m0(Ml.toString),Tye=/^Symbol\((.*)\)[^)]+$/,Oye=m0("".replace),Aye=m0("".slice);Sye(Ml,"description",{configurable:!0,get:function(){var e=Cye(this);if(yye(QN,e))return"";var r=_ye(e),n=Eye?Aye(r,7,-1):Oye(r,Tye,"$1");return n===""?void 0:n}}),pye({global:!0,constructor:!0,forced:!0},{Symbol:g0})}var Iye=mt,AY=Iye(1 .valueOf),IY=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,xye=mt,Mye=vi,Nye=Gr,tT=IY,ZN=xye("".replace),Pye=RegExp("^["+tT+"]+"),kye=RegExp("(^|[^"+tT+"])["+tT+"]+$"),JR=function(t){return function(e){var r=Nye(Mye(e));return t&1&&(r=ZN(r,Pye,"")),t&2&&(r=ZN(r,kye,"$1")),r}},xY={start:JR(1),end:JR(2),trim:JR(3)},$ye=tt,MY=rse,Lye=zr,NY=nr,PY=aY,kY=mt,Dye=e6,JN=Rr,Fye=p8,Hye=Rl,Bye=a1,$Y=Zz,Uye=dt,Vye=Rc.f,jye=ya.f,Wye=Jn.f,zye=AY,Gye=xY.trim,g6="Number",Vf=NY[g6];PY[g6];var M8=Vf.prototype,Yye=NY.TypeError,Kye=kY("".slice),y0=kY("".charCodeAt),qye=function(t){var e=$Y(t,"number");return typeof e=="bigint"?e:Xye(e)},Xye=function(t){var e=$Y(t,"number"),r,n,i,o,a,s,l,u;if(Bye(e))throw Yye("Cannot convert a Symbol value to a number");if(typeof e=="string"&&e.length>2){if(e=Gye(e),r=y0(e,0),r===43||r===45){if(n=y0(e,2),n===88||n===120)return NaN}else if(r===48){switch(y0(e,1)){case 66:case 98:i=2,o=49;break;case 79:case 111:i=8,o=55;break;default:return+e}for(a=Kye(e,2),s=a.length,l=0;l<s;l++)if(u=y0(a,l),u<48||u>o)return NaN;return parseInt(a,i)}}return+e},N8=Dye(g6,!Vf(" 0o1")||!Vf("0b1")||Vf("+0x1")),Qye=function(t){return Hye(M8,t)&&Uye(function(){zye(t)})},y6=function(e){var r=arguments.length<1?0:Vf(qye(e));return Qye(this)?Fye(Object(r),this,y6):r};y6.prototype=M8;N8&&!MY&&(M8.constructor=y6);$ye({global:!0,constructor:!0,wrap:!0,forced:N8},{Number:y6});var Zye=function(t,e){for(var r=Lye?Vye(e):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,i;r.length>n;n++)JN(e,i=r[n])&&!JN(t,i)&&Wye(t,i,jye(e,i))};(N8||MY)&&Zye(PY[g6],Vf);var Jye=tt,eve=Q4;Jye({target:"Object",stat:!0},{setPrototypeOf:eve});var tve=tt,rve=dt,nve=bi,LY=t6,ive=hG,ove=rve(function(){LY(1)});tve({target:"Object",stat:!0,forced:ove,sham:!ive},{getPrototypeOf:function(e){return LY(nve(e))}});var DY=mt,ave=vc,sve=Wr,lve=Rr,eP=E1,uve=n1,FY=Function,cve=DY([].concat),fve=DY([].join),eE={},hve=function(t,e,r){if(!lve(eE,e)){for(var n=[],i=0;i<e;i++)n[i]="a["+i+"]";eE[e]=FY("C,a","return new C("+fve(n,",")+")")}return eE[e](t,r)},dve=uve?FY.bind:function(e){var r=ave(this),n=r.prototype,i=eP(arguments,1),o=function(){var s=cve(i,eP(arguments));return this instanceof o?hve(r,s.length,s):r.apply(e,s)};return sve(n)&&(o.prototype=n),o},pve=o6,mve=Np,gve=TypeError,HY=function(t){if(pve(t))return t;throw gve(mve(t)+" is not a constructor")},yve=tt,vve=Cs,tE=Cc,bve=dve,tP=HY,wve=$r,rP=Wr,Sve=Pp,BY=dt,P8=vve("Reflect","construct"),Rve=Object.prototype,Eve=[].push,UY=BY(function(){function t(){}return!(P8(function(){},[],t)instanceof t)}),VY=!BY(function(){P8(function(){})}),nP=UY||VY;yve({target:"Reflect",stat:!0,forced:nP,sham:nP},{construct:function(e,r){tP(e),wve(r);var n=arguments.length<3?e:tP(arguments[2]);if(VY&&!UY)return P8(e,r,n);if(e==n){switch(r.length){case 0:return new e;case 1:return new e(r[0]);case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[1],r[2]);case 4:return new e(r[0],r[1],r[2],r[3])}var i=[null];return tE(Eve,i,r),new(tE(bve,e,i))}var o=n.prototype,a=Sve(rP(o)?o:Rve),s=tE(e,a,r);return rP(s)?s:a}});var iP=Rr,Cve=function(t){return t!==void 0&&(iP(t,"value")||iP(t,"writable"))},_ve=tt,Tve=en,Ove=Wr,Ave=$r,Ive=Cve,xve=ya,Mve=t6;function jY(t,e){var r=arguments.length<3?t:arguments[2],n,i;if(Ave(t)===r)return t[e];if(n=xve.f(t,e),n)return Ive(n)?n.value:n.get===void 0?void 0:Tve(n.get,r);if(Ove(i=Mve(t)))return jY(i,e,r)}_ve({target:"Reflect",stat:!0},{get:jY});var Nve=tt,Pve=dt,kve=$i,WY=ya.f,zY=zr,$ve=!zY||Pve(function(){WY(1)});Nve({target:"Object",stat:!0,forced:$ve,sham:!zY},{getOwnPropertyDescriptor:function(e,r){return WY(kve(e),r)}});var Lve=_8;Lve("iterator");var Dve=tt,oP=Lp,Fve=o6,Hve=Wr,aP=s1,Bve=oo,Uve=$i,Vve=$p,jve=lr,Wve=w1,zve=E1,Gve=Wve("slice"),Yve=jve("species"),rE=Array,Kve=Math.max;Dve({target:"Array",proto:!0,forced:!Gve},{slice:function(e,r){var n=Uve(this),i=Bve(n),o=aP(e,i),a=aP(r===void 0?i:r,i),s,l,u;if(oP(n)&&(s=n.constructor,Fve(s)&&(s===rE||oP(s.prototype))?s=void 0:Hve(s)&&(s=s[Yve],s===null&&(s=void 0)),s===rE||s===void 0))return zve(n,o,a);for(l=new(s===void 0?rE:s)(Kve(a-o,0)),u=0;o<a;o++,u++)o in n&&Vve(l,u,n[o]);return l.length=u,l}});var qve=zr,Xve=p1.EXISTS,GY=mt,Qve=S1,YY=Function.prototype,Zve=GY(YY.toString),KY=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,Jve=GY(KY.exec),e1e="name";qve&&!Xve&&Qve(YY,e1e,{configurable:!0,get:function(){try{return Jve(KY,Zve(this))[1]}catch{return""}}});var t1e=$r,r1e=OG,n1e=function(t,e,r,n){try{return n?e(t1e(r)[0],r[1]):e(r)}catch(i){r1e(t,"throw",i)}},i1e=v1,o1e=en,a1e=bi,s1e=n1e,l1e=_G,u1e=o6,c1e=oo,sP=$p,f1e=TG,h1e=f8,lP=Array,d1e=function(e){var r=a1e(e),n=u1e(this),i=arguments.length,o=i>1?arguments[1]:void 0,a=o!==void 0;a&&(o=i1e(o,i>2?arguments[2]:void 0));var s=h1e(r),l=0,u,c,f,h,d,p;if(s&&!(this===lP&&l1e(s)))for(h=f1e(r,s),d=h.next,c=n?new this:[];!(f=o1e(d,h)).done;l++)p=a?s1e(h,o,[f.value,l],!0):f.value,sP(c,l,p);else for(u=c1e(r),c=n?new this(u):lP(u);u>l;l++)p=a?o(r[l],l):r[l],sP(c,l,p);return c.length=l,c},p1e=tt,m1e=d1e,g1e=xG,y1e=!g1e(function(t){Array.from(t)});p1e({target:"Array",stat:!0,forced:y1e},{from:m1e});var v1e=tt,b1e=i8,w1e=dt,S1e=Wr,R1e=kp.exports.onFreeze,rT=Object.freeze,E1e=w1e(function(){rT(1)});v1e({target:"Object",stat:!0,forced:E1e,sham:!b1e},{freeze:function(e){return rT&&S1e(e)?rT(R1e(e)):e}});var C1e=p1.PROPER,_1e=dt,uP=IY,cP="\u200B\x85\u180E",T1e=function(t){return _1e(function(){return!!uP[t]()||cP[t]()!==cP||C1e&&uP[t].name!==t})},O1e=tt,A1e=xY.trim,I1e=T1e;O1e({target:"String",proto:!0,forced:I1e("trim")},{trim:function(){return A1e(this)}});var x1e=tt,M1e=G4.includes,N1e=dt,P1e=c1,k1e=N1e(function(){return!Array(1).includes()});x1e({target:"Array",proto:!0,forced:k1e},{includes:function(e){return M1e(this,e,arguments.length>1?arguments[1]:void 0)}});P1e("includes");var $1e=en,L1e=Rr,D1e=Rl,F1e=eY,fP=RegExp.prototype,qY=function(t){var e=t.flags;return e===void 0&&!("flags"in fP)&&!L1e(t,"flags")&&D1e(fP,t)?$1e(F1e,t):e},H1e=p1.PROPER,B1e=ao,U1e=$r,hP=Gr,V1e=dt,j1e=qY,k8="toString",W1e=RegExp.prototype,XY=W1e[k8],z1e=V1e(function(){return XY.call({source:"a",flags:"b"})!="/a/b"}),G1e=H1e&&XY.name!=k8;(z1e||G1e)&&B1e(RegExp.prototype,k8,function(){var e=U1e(this),r=hP(e.source),n=hP(j1e(e));return"/"+r+"/"+n},{unsafe:!0});var Y1e=tt,K1e=n8.codeAt;Y1e({target:"String",proto:!0},{codePointAt:function(e){return K1e(this,e)}});var q1e=El,X1e=Gr,Q1e=vi,Z1e=RangeError,QY=function(e){var r=X1e(Q1e(this)),n="",i=q1e(e);if(i<0||i==1/0)throw Z1e("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(r+=r))i&1&&(n+=r);return n},ZY=mt,J1e=wc,dP=Gr,e0e=QY,t0e=vi,r0e=ZY(e0e),n0e=ZY("".slice),i0e=Math.ceil,pP=function(t){return function(e,r,n){var i=dP(t0e(e)),o=J1e(r),a=i.length,s=n===void 0?" ":dP(n),l,u;return o<=a||s==""?i:(l=o-a,u=r0e(s,i0e(l/s.length)),u.length>l&&(u=n0e(u,0,l)),t?i+u:u+i)}},o0e={start:pP(!1),end:pP(!0)},a0e=yc,s0e=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(a0e),l0e=tt,u0e=o0e.start,c0e=s0e;l0e({target:"String",proto:!0,forced:c0e},{padStart:function(e){return u0e(this,e,arguments.length>1?arguments[1]:void 0)}});var f0e=TypeError,h0e=9007199254740991,JY=function(t){if(t>h0e)throw f0e("Maximum allowed index exceeded");return t},d0e=tt,p0e=dt,m0e=Lp,g0e=Wr,y0e=bi,v0e=oo,mP=JY,gP=$p,b0e=g8,w0e=w1,S0e=lr,R0e=o1,eK=S0e("isConcatSpreadable"),E0e=R0e>=51||!p0e(function(){var t=[];return t[eK]=!1,t.concat()[0]!==t}),C0e=function(t){if(!g0e(t))return!1;var e=t[eK];return e!==void 0?!!e:m0e(t)},_0e=!E0e||!w0e("concat");d0e({target:"Array",proto:!0,arity:1,forced:_0e},{concat:function(e){var r=y0e(this),n=b0e(r,0),i=0,o,a,s,l,u;for(o=-1,s=arguments.length;o<s;o++)if(u=o===-1?r:arguments[o],C0e(u))for(l=v0e(u),mP(i+l),a=0;a<l;a++,i++)a in u&&gP(n,i,u[a]);else mP(i+1),gP(n,i++,u);return n.length=i,n}});var T0e=Wr,O0e=ga,A0e=lr,I0e=A0e("match"),$8=function(t){var e;return T0e(t)&&((e=t[I0e])!==void 0?!!e:O0e(t)=="RegExp")},x0e=$8,M0e=TypeError,L8=function(t){if(x0e(t))throw M0e("The method doesn't accept regular expressions");return t},N0e=lr,P0e=N0e("match"),D8=function(t){var e=/./;try{"/./"[t](e)}catch{try{return e[P0e]=!1,"/./"[t](e)}catch{}}return!1},k0e=tt,$0e=mt,L0e=L8,D0e=vi,yP=Gr,F0e=D8,H0e=$0e("".indexOf);k0e({target:"String",proto:!0,forced:!F0e("includes")},{includes:function(e){return!!~H0e(yP(D0e(this)),yP(L0e(e)),arguments.length>1?arguments[1]:void 0)}});var B0e=Cs,U0e=S1,V0e=lr,j0e=zr,vP=V0e("species"),tK=function(t){var e=B0e(t);j0e&&e&&!e[vP]&&U0e(e,vP,{configurable:!0,get:function(){return this}})},W0e=Pp,z0e=S1,bP=o8,G0e=v1,Y0e=d8,K0e=No,q0e=h8,X0e=Z4,v0=J4,Q0e=tK,nm=zr,wP=kp.exports.fastKey,rK=_s,SP=rK.set,nE=rK.getterFor,nK={getConstructor:function(t,e,r,n){var i=t(function(u,c){Y0e(u,o),SP(u,{type:e,index:W0e(null),first:void 0,last:void 0,size:0}),nm||(u.size=0),K0e(c)||q0e(c,u[n],{that:u,AS_ENTRIES:r})}),o=i.prototype,a=nE(e),s=function(u,c,f){var h=a(u),d=l(u,c),p,m;return d?d.value=f:(h.last=d={index:m=wP(c,!0),key:c,value:f,previous:p=h.last,next:void 0,removed:!1},h.first||(h.first=d),p&&(p.next=d),nm?h.size++:u.size++,m!=="F"&&(h.index[m]=d)),u},l=function(u,c){var f=a(u),h=wP(c),d;if(h!=="F")return f.index[h];for(d=f.first;d;d=d.next)if(d.key==c)return d};return bP(o,{clear:function(){for(var c=this,f=a(c),h=f.index,d=f.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete h[d.index],d=d.next;f.first=f.last=void 0,nm?f.size=0:c.size=0},delete:function(u){var c=this,f=a(c),h=l(c,u);if(h){var d=h.next,p=h.previous;delete f.index[h.index],h.removed=!0,p&&(p.next=d),d&&(d.previous=p),f.first==h&&(f.first=d),f.last==h&&(f.last=p),nm?f.size--:c.size--}return!!h},forEach:function(c){for(var f=a(this),h=G0e(c,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:f.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(c){return!!l(this,c)}}),bP(o,r?{get:function(c){var f=l(this,c);return f&&f.value},set:function(c,f){return s(this,c===0?0:c,f)}}:{add:function(c){return s(this,c=c===0?0:c,c)}}),nm&&z0e(o,"size",{configurable:!0,get:function(){return a(this).size}}),i},setStrong:function(t,e,r){var n=e+" Iterator",i=nE(e),o=nE(n);X0e(t,e,function(a,s){SP(this,{type:n,target:a,state:i(a),kind:s,last:void 0})},function(){for(var a=o(this),s=a.kind,l=a.last;l&&l.removed;)l=l.previous;return!a.target||!(a.last=l=l?l.next:a.state.first)?(a.target=void 0,v0(void 0,!0)):s=="keys"?v0(l.key,!1):s=="values"?v0(l.value,!1):v0([l.key,l.value],!1)},r?"entries":"values",!r,!0),Q0e(e)}},Z0e=i6,J0e=nK;Z0e("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},J0e);var RP=$r,ebe=HY,tbe=No,rbe=lr,nbe=rbe("species"),ibe=function(t,e){var r=RP(t).constructor,n;return r===void 0||tbe(n=RP(r)[nbe])?e:ebe(n)},obe=Cc,im=en,F8=mt,abe=l6,sbe=$r,lbe=No,ube=$8,EP=vi,cbe=ibe,fbe=R8,hbe=wc,iE=Gr,dbe=bc,CP=s8,_P=u6,pbe=s6,mbe=S8,gbe=dt,Fc=mbe.UNSUPPORTED_Y,TP=4294967295,ybe=Math.min,iK=[].push,vbe=F8(/./.exec),Hc=F8(iK),om=F8("".slice),bbe=!gbe(function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var r="ab".split(t);return r.length!==2||r[0]!=="a"||r[1]!=="b"});abe("split",function(t,e,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(i,o){var a=iE(EP(this)),s=o===void 0?TP:o>>>0;if(s===0)return[];if(i===void 0)return[a];if(!ube(i))return im(e,a,i,s);for(var l=[],u=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),c=0,f=new RegExp(i.source,u+"g"),h,d,p;(h=im(pbe,f,a))&&(d=f.lastIndex,!(d>c&&(Hc(l,om(a,c,h.index)),h.length>1&&h.index<a.length&&obe(iK,l,CP(h,1)),p=h[0].length,c=d,l.length>=s)));)f.lastIndex===h.index&&f.lastIndex++;return c===a.length?(p||!vbe(f,""))&&Hc(l,""):Hc(l,om(a,c)),l.length>s?CP(l,0,s):l}:"0".split(void 0,0).length?n=function(i,o){return i===void 0&&o===0?[]:im(e,this,i,o)}:n=e,[function(o,a){var s=EP(this),l=lbe(o)?void 0:dbe(o,t);return l?im(l,o,s,a):im(n,iE(s),o,a)},function(i,o){var a=sbe(this),s=iE(i),l=r(n,a,s,o,n!==e);if(l.done)return l.value;var u=cbe(a,RegExp),c=a.unicode,f=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(Fc?"g":"y"),h=new u(Fc?"^(?:"+a.source+")":a,f),d=o===void 0?TP:o>>>0;if(d===0)return[];if(s.length===0)return _P(h,s)===null?[s]:[];for(var p=0,m=0,g=[];m<s.length;){h.lastIndex=Fc?0:m;var v=_P(h,Fc?om(s,m):s),w;if(v===null||(w=ybe(hbe(h.lastIndex+(Fc?m:0)),s.length))===p)m=fbe(s,m,c);else{if(Hc(g,om(s,p,m)),g.length===d)return g;for(var b=1;b<=v.length-1;b++)if(Hc(g,v[b]),g.length===d)return g;m=p=w}}return Hc(g,om(s,p)),g}]},!bbe,Fc);function wbe(t){for(var e=t.length,r=0;r<e;)t[r]=[t[r]],r+=1}function OP(t,e){for(var r=e.length,n=0;n<r;)t.push(e[n]),n+=1}function Vb(t){var e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;for(var r=t.length,n=t[0].length,i=0;i<r;i++)for(var o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Fn(t,e,r,n){var i=-1,o=t,a=r;Array.isArray(t)||(o=Array.from(t));var s=o.length;for(n&&s&&(i+=1,a=o[i]),i+=1;i<s;)a=e(a,o[i],i,o),i+=1;return a}function Ji(t,e){var r=0,n=t;Array.isArray(t)||(n=Array.from(t));for(var i=n.length,o=[],a=-1;r<i;){var s=n[r];e(s,r,n)&&(a+=1,o[a]=s),r+=1}return o}function wt(t,e){var r=0,n=t;Array.isArray(t)||(n=Array.from(t));for(var i=n.length,o=[],a=-1;r<i;){var s=n[r];a+=1,o[a]=e(s,r,n),r+=1}return o}function ae(t,e){var r=0,n=t;Array.isArray(t)||(n=Array.from(t));for(var i=n.length;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function oK(t){var e=[];return ae(t,function(r){e.indexOf(r)===-1&&e.push(r)}),e}function AP(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=[].concat(e),i=n[0],o=n.slice(1),a=i;return ae(o,function(s){a=a.filter(function(l){return!s.includes(l)})}),a}function IP(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function Gt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var i=Fn(t,function(o,a,s){var l=a.replace(/\r?\n\s*/g,""),u=r[s]?r[s]:"";return o+l+u},"");return i.trim()}var xP,MP,NP,PP,kP,$P;function jf(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function nT(t){return nT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nT(t)}function Vr(t){var e;switch(nT(t)){case"string":case"number":e="".concat(t);break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function He(t){return typeof t<"u"}function tr(t){return typeof t>"u"}function on(t){return t===null||t===""||tr(t)}function Sbe(t){return Object.prototype.toString.call(t)==="[object RegExp]"}var Dm="length",qm=function(e){return parseInt(e,16)},LP=function(e){return parseInt(e,10)},z2=function(e,r,n){return e.substr(r,n)},Xm=function(e){return e.codePointAt(0)-65},iT=function(e){return"".concat(e).replace(/\-/g,"")},Rbe=function(e){return qm(z2(iT(e),qm("12"),Xm("F")))/(qm(z2(iT(e),Xm("B"),~~![][Dm]))||9)},Ebe=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},DP=!1,FP={invalid:function(){return Gt(xP||(xP=jf([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(e){var r=e.keyValidityDate,n=e.hotVersion;return Gt(MP||(MP=jf([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return Gt(NP||(NP=jf([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},HP={invalid:function(){return Gt(PP||(PP=jf([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(e){var r=e.keyValidityDate,n=e.hotVersion;return Gt(kP||(kP=jf([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return Gt($P||($P=jf([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function Cbe(t,e){var r=!on(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="12.3.3",o,a="invalid",s="invalid";t=iT(t||"");var l=_be(t);if(r||n||l)if(l){var u=qt("28/03/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),f=Rbe(t);o=qt((f+1)*864e5,"x").format("MMMM DD, YYYY"),c>f?(a="expired",s="expired"):(a="valid",s="valid")}else n?(a="non_commercial",s="valid"):(a="invalid",s="invalid");else a="missing",s="missing";if(Ebe()&&(a="valid",s="valid"),!DP&&a!=="valid"){var h=FP[a]({keyValidityDate:o,hotVersion:i});h&&console[a==="non_commercial"?"info":"warn"](FP[a]({keyValidityDate:o,hotVersion:i})),DP=!0}if(s!=="valid"&&e.parentNode){var d=HP[s]({keyValidityDate:o,hotVersion:i});if(d){var p=document.createElement("div");p.className="hot-display-license-info",p.innerHTML=HP[s]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(p,e.nextSibling)}}}function _be(t){var e=[][Dm],r=e;if(t[Dm]!==Xm("Z"))return!1;for(var n="",i="B<H4P+".split(""),o=Xm(i.shift());o;o=Xm(i.shift()||"A"))--o<""[Dm]?r=r|(LP("".concat(LP(qm(n)+(qm(z2(t,Math.abs(o),2))+[]).padStart(2,"0"))))%97||2)>>1:n=z2(t,o,o?i[Dm]===1?9:8:6);return r===e}var Tbe=bi,BP=s1,Obe=oo,Abe=function(e){for(var r=Tbe(this),n=Obe(r),i=arguments.length,o=BP(i>1?arguments[1]:void 0,n),a=i>2?arguments[2]:void 0,s=a===void 0?n:BP(a,n);s>o;)r[o++]=e;return r},Ibe=tt,xbe=Abe,Mbe=c1;Ibe({target:"Array",proto:!0},{fill:xbe});Mbe("fill");var Nbe=Ec.forEach,Pbe=Dp,kbe=Pbe("forEach"),$be=kbe?[].forEach:function(e){return Nbe(this,e,arguments.length>1?arguments[1]:void 0)},UP=nr,VP=WG,Lbe=zG,oE=$be,Dbe=Sc,aK=function(t){if(t&&t.forEach!==oE)try{Dbe(t,"forEach",oE)}catch{t.forEach=oE}};for(var aE in VP)VP[aE]&&aK(UP[aE]&&UP[aE].prototype);aK(Lbe);function jP(t,e,r){return e=Fbe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fbe(t){var e=Hbe(t,"string");return ws(e)==="symbol"?e:String(e)}function Hbe(t,e){if(ws(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ws(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ws(t){return ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ws(t)}function Ag(t){var e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Rt(t,function(r,n){n!=="__children"&&(r&&ws(r)==="object"&&!Array.isArray(r)?e[n]=Ag(r):Array.isArray(r)?r.length&&ws(r[0])==="object"&&!Array.isArray(r[0])?e[n]=[Ag(r[0])]:e[n]=[]:e[n]=null)})),e}function Cl(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Jr(t,e,r){var n=Array.isArray(r);return Rt(e,function(i,o){(n===!1||r.includes(o))&&(t[o]=i)}),t}function v6(t,e){Rt(e,function(r,n){e[n]&&ws(e[n])==="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),v6(t[n],e[n])):t[n]=e[n]})}function Qn(t){return ws(t)==="object"?JSON.parse(JSON.stringify(t)):t}function hi(t){var e={};return Rt(t,function(r,n){e[n]=r}),e}function ir(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return ae(r,function(i){t.MIXINS.push(i.MIXIN_NAME),Rt(i,function(o,a){if(t.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof o=="function")t.prototype[a]=o;else{var s=function(c,f){var h="_".concat(c),d=function(m){var g=m;return(Array.isArray(g)||St(g))&&(g=Qn(g)),g};return function(){return this[h]===void 0&&(this[h]=d(f)),this[h]}},l=function(c){var f="_".concat(c);return function(h){this[f]=h}};Object.defineProperty(t.prototype,a,{get:s(a,o),set:l(a),configurable:!0})}})}),t}function sK(t,e){return JSON.stringify(t)===JSON.stringify(e)}function St(t){return Object.prototype.toString.call(t)==="[object Object]"}function Ts(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function Rt(t,e){for(var r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function Bbe(t,e){var r=e.split("."),n=t;return Rt(r,function(i){if(n=n[i],n===void 0)return n=void 0,!1}),n}function sE(t,e,r){var n=e.split("."),i=t;n.forEach(function(o,a){a!==n.length-1?(Nr(i,o)||(i[o]={}),i=i[o]):i[o]=r})}function H8(t){if(!St(t))return 0;var e=function r(n){var i=0;return St(n)?Rt(n,function(o,a){a!=="__children"&&(i+=r(o))}):i+=1,i};return e(t)}function hh(t){var e,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),i=(e={_touched:!1},jP(e,n,t),jP(e,"isTouched",function(){return this._touched}),e);return Object.defineProperty(i,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),i}function Nr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var ii=function(e){var r={value:!1};return r.test=function(n,i){r.value=e(n,i)},r},va={chrome:ii(function(t,e){return/Chrome/.test(t)&&/Google/.test(e)}),chromeWebKit:ii(function(t){return/CriOS/.test(t)}),edge:ii(function(t){return/Edge/.test(t)}),edgeWebKit:ii(function(t){return/EdgiOS/.test(t)}),firefox:ii(function(t){return/Firefox/.test(t)}),firefoxWebKit:ii(function(t){return/FxiOS/.test(t)}),ie:ii(function(t){return/Trident/.test(t)}),ie9:ii(function(){return!!document.documentMode}),mobile:ii(function(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)}),safari:ii(function(t,e){return/Safari/.test(t)&&/Apple Computer/.test(e)})},_1={mac:ii(function(t){return/^Mac/.test(t)}),win:ii(function(t){return/^Win/.test(t)}),linux:ii(function(t){return/^Linux/.test(t)}),ios:ii(function(t){return/iPhone|iPad|iPod/i.test(t)})};function Ube(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.userAgent,r=e===void 0?navigator.userAgent:e,n=t.vendor,i=n===void 0?navigator.vendor:n;Rt(va,function(o){var a=o.test;return void a(r,i)})}function Vbe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.platform,r=e===void 0?navigator.platform:e;Rt(_1,function(n){var i=n.test;return void i(r)})}Ube();Vbe();function lK(){return va.chrome.value}function jbe(){return va.chromeWebKit.value}function lE(){return va.firefox.value}function Wbe(){return va.firefoxWebKit.value}function zbe(){return va.safari.value}function Gbe(){return va.edge.value}function Ybe(){return va.ie.value}function Kbe(){return va.ie9.value}function na(){return va.mobile.value}function uK(){return _1.ios.value}function cK(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,e=t.maxTouchPoints;return e>2&&_1.mac.value}function WP(){return _1.win.value}function zP(){return _1.mac.value}var Ge={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:lE()?182:174,AUDIO_MUTE:lE()?181:173,AUDIO_UP:lE()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},qbe=[Ge.ALT,Ge.ARROW_DOWN,Ge.ARROW_LEFT,Ge.ARROW_RIGHT,Ge.ARROW_UP,Ge.AUDIO_DOWN,Ge.AUDIO_MUTE,Ge.AUDIO_UP,Ge.BACKSPACE,Ge.CAPS_LOCK,Ge.DELETE,Ge.END,Ge.ENTER,Ge.ESCAPE,Ge.F1,Ge.F2,Ge.F3,Ge.F4,Ge.F5,Ge.F6,Ge.F7,Ge.F8,Ge.F9,Ge.F10,Ge.F11,Ge.F12,Ge.F13,Ge.F14,Ge.F15,Ge.F16,Ge.F17,Ge.F18,Ge.F19,Ge.HOME,Ge.INSERT,Ge.MEDIA_NEXT,Ge.MEDIA_PLAY_PAUSE,Ge.MEDIA_PREV,Ge.MEDIA_STOP,Ge.NULL,Ge.NUM_LOCK,Ge.PAGE_DOWN,Ge.PAGE_UP,Ge.PAUSE,Ge.SCROLL_LOCK,Ge.SHIFT,Ge.TAB];function Xbe(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function fK(t){return qbe.includes(t)}function Qbe(t){return[Ge.CONTROL,Ge.COMMAND_LEFT,Ge.COMMAND_RIGHT,Ge.COMMAND_FIREFOX].includes(t)}function Ig(t,e){var r=e.split("|"),n=!1;return ae(r,function(i){if(t===Ge[i])return n=!0,!1}),n}function la(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Ef(t){return t.isImmediatePropagationEnabled===!1}function Gu(t){return t.button===2}function B8(t){return t.button===0}var Zbe=Jn.f,Jbe=function(t,e,r){r in t||Zbe(t,r,{configurable:!0,get:function(){return e[r]},set:function(n){e[r]=n}})},e2e=zr,U8=nr,T1=mt,t2e=e6,r2e=p8,n2e=Sc,i2e=Rc.f,GP=Rl,o2e=$8,YP=Gr,a2e=qY,hK=S8,s2e=Jbe,l2e=ao,u2e=dt,c2e=Rr,f2e=_s.enforce,h2e=tK,d2e=lr,dK=tY,pK=rY,p2e=d2e("match"),el=U8.RegExp,Cf=el.prototype,m2e=U8.SyntaxError,g2e=T1(Cf.exec),G2=T1("".charAt),KP=T1("".replace),qP=T1("".indexOf),y2e=T1("".slice),v2e=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Hu=/a/g,uE=/a/g,b2e=new el(Hu)!==Hu,mK=hK.MISSED_STICKY,w2e=hK.UNSUPPORTED_Y,S2e=e2e&&(!b2e||mK||dK||pK||u2e(function(){return uE[p2e]=!1,el(Hu)!=Hu||el(uE)==uE||el(Hu,"i")!="/a/i"})),R2e=function(t){for(var e=t.length,r=0,n="",i=!1,o;r<=e;r++){if(o=G2(t,r),o==="\\"){n+=o+G2(t,++r);continue}!i&&o==="."?n+="[\\s\\S]":(o==="["?i=!0:o==="]"&&(i=!1),n+=o)}return n},E2e=function(t){for(var e=t.length,r=0,n="",i=[],o={},a=!1,s=!1,l=0,u="",c;r<=e;r++){if(c=G2(t,r),c==="\\")c=c+G2(t,++r);else if(c==="]")a=!1;else if(!a)switch(!0){case c==="[":a=!0;break;case c==="(":g2e(v2e,y2e(t,r+1))&&(r+=2,s=!0),n+=c,l++;continue;case(c===">"&&s):if(u===""||c2e(o,u))throw new m2e("Invalid capture group name");o[u]=!0,i[i.length]=[u,l],s=!1,u="";continue}s?u+=c:n+=c}return[n,i]};if(t2e("RegExp",S2e)){for(var Nl=function(e,r){var n=GP(Cf,this),i=o2e(e),o=r===void 0,a=[],s=e,l,u,c,f,h,d;if(!n&&i&&o&&e.constructor===Nl)return e;if((i||GP(Cf,e))&&(e=e.source,o&&(r=a2e(s))),e=e===void 0?"":YP(e),r=r===void 0?"":YP(r),s=e,dK&&"dotAll"in Hu&&(u=!!r&&qP(r,"s")>-1,u&&(r=KP(r,/s/g,""))),l=r,mK&&"sticky"in Hu&&(c=!!r&&qP(r,"y")>-1,c&&w2e&&(r=KP(r,/y/g,""))),pK&&(f=E2e(e),e=f[0],a=f[1]),h=r2e(el(e,r),n?this:Cf,Nl),(u||c||a.length)&&(d=f2e(h),u&&(d.dotAll=!0,d.raw=Nl(R2e(e),l)),c&&(d.sticky=!0),a.length&&(d.groups=a)),e!==s)try{n2e(h,"source",s===""?"(?:)":s)}catch{}return h},XP=i2e(el),QP=0;XP.length>QP;)s2e(Nl,el,XP[QP++]);Cf.constructor=Nl,Nl.prototype=Cf,l2e(U8,"RegExp",Nl,{constructor:!0})}h2e("RegExp");var C2e=tt,_2e=mt,T2e=i1,O2e=$i,A2e=Dp,I2e=_2e([].join),x2e=T2e!=Object,M2e=x2e||!A2e("join",",");C2e({target:"Array",proto:!0,forced:M2e},{join:function(e){return I2e(O2e(this),e===void 0?",":e)}});function oT(t){return oT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oT(t)}function V8(t){return window.requestAnimationFrame(t)}function N2e(){return!!document.documentElement.classList}function P2e(){return!!document.createTextNode("test").textContent}function k2e(){return!!window.getComputedStyle}function Y2(t){window.cancelAnimationFrame(t)}function gK(){return"ontouchstart"in window}var aT;function $2e(){var t=document.createElement("TABLE");t.style.borderSpacing="0",t.style.borderWidth="0",t.style.padding="0";var e=document.createElement("TBODY");t.appendChild(e),e.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",t.insertBefore(r,e),document.body.appendChild(t),aT=t.offsetHeight<2*t.lastChild.offsetHeight,document.body.removeChild(t)}function yK(){return aT===void 0&&$2e(),aT}var Bc;function L2e(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Bc||((typeof Intl>"u"?"undefined":oT(Intl))==="object"?Bc=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Bc=function(n,i){return"".concat(n).localeCompare(i)}:Bc=function(n,i){return n===i?0:n>i?-1:1},Bc)}var am;function D2e(){if(am!==void 0)return am;try{var t={get passive(){am=!0}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch{am=!1}return am}/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function Vs(t){return Vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vs(t)}function sT(t,e){return sT=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},sT(t,e)}function F2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jb(t,e,r){return F2e()?jb=Reflect.construct:jb=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&sT(u,a.prototype),u},jb.apply(null,arguments)}function mo(t){return H2e(t)||B2e(t)||U2e(t)||V2e()}function H2e(t){if(Array.isArray(t))return lT(t)}function B2e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function U2e(t,e){if(!!t){if(typeof t=="string")return lT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lT(t,e)}}function lT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function V2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j2e=Object.hasOwnProperty,ZP=Object.setPrototypeOf,W2e=Object.isFrozen,z2e=Object.getPrototypeOf,G2e=Object.getOwnPropertyDescriptor,Zn=Object.freeze,xo=Object.seal,Y2e=Object.create,vK=typeof Reflect<"u"&&Reflect,K2=vK.apply,uT=vK.construct;K2||(K2=function(e,r,n){return e.apply(r,n)});Zn||(Zn=function(e){return e});xo||(xo=function(e){return e});uT||(uT=function(e,r){return jb(e,mo(r))});var K2e=eo(Array.prototype.forEach),JP=eo(Array.prototype.pop),sm=eo(Array.prototype.push),Wb=eo(String.prototype.toLowerCase),cE=eo(String.prototype.toString),q2e=eo(String.prototype.match),fo=eo(String.prototype.replace),X2e=eo(String.prototype.indexOf),Q2e=eo(String.prototype.trim),Hn=eo(RegExp.prototype.test),fE=Z2e(TypeError);function eo(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return K2(t,e,n)}}function Z2e(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return uT(t,r)}}function _t(t,e,r){r=r||Wb,ZP&&ZP(t,null);for(var n=e.length;n--;){var i=e[n];if(typeof i=="string"){var o=r(i);o!==i&&(W2e(e)||(e[n]=o),i=o)}t[i]=!0}return t}function Pl(t){var e=Y2e(null),r;for(r in t)K2(j2e,t,[r])===!0&&(e[r]=t[r]);return e}function b0(t,e){for(;t!==null;){var r=G2e(t,e);if(r){if(r.get)return eo(r.get);if(typeof r.value=="function")return eo(r.value)}t=z2e(t)}function n(i){return console.warn("fallback value for",i),null}return n}var ek=Zn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),hE=Zn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),dE=Zn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),J2e=Zn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),pE=Zn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),ewe=Zn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),tk=Zn(["#text"]),rk=Zn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),mE=Zn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),nk=Zn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),w0=Zn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),twe=xo(/\{\{[\w\W]*|[\w\W]*\}\}/gm),rwe=xo(/<%[\w\W]*|[\w\W]*%>/gm),nwe=xo(/\${[\w\W]*}/gm),iwe=xo(/^data-[\-\w.\u00B7-\uFFFF]/),owe=xo(/^aria-[\-\w]+$/),awe=xo(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),swe=xo(/^(?:\w+script|data):/i),lwe=xo(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),uwe=xo(/^html$/i),cwe=function(){return typeof window>"u"?null:window},fwe=function(e,r){if(Vs(e)!=="object"||typeof e.createPolicy!="function")return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML:function(s){return s},createScriptURL:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function bK(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:cwe(),e=function(ge){return bK(ge)};if(e.version="2.4.5",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var r=t.document,n=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,a=t.Node,s=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,f=t.HTMLFormElement,h=t.DOMParser,d=t.trustedTypes,p=s.prototype,m=b0(p,"cloneNode"),g=b0(p,"nextSibling"),v=b0(p,"childNodes"),w=b0(p,"parentNode");if(typeof o=="function"){var b=n.createElement("template");b.content&&b.content.ownerDocument&&(n=b.content.ownerDocument)}var E=fwe(d,r),A=E?E.createHTML(""):"",M=n,k=M.implementation,O=M.createNodeIterator,x=M.createDocumentFragment,C=M.getElementsByTagName,I=r.importNode,H={};try{H=Pl(n).documentMode?n.documentMode:{}}catch{}var j={};e.isSupported=typeof w=="function"&&k&&typeof k.createHTMLDocument<"u"&&H!==9;var q=twe,Z=rwe,ne=nwe,ie=iwe,P=owe,y=swe,R=lwe,_=awe,$=null,B=_t({},[].concat(mo(ek),mo(hE),mo(dE),mo(pE),mo(tk))),W=null,ee=_t({},[].concat(mo(rk),mo(mE),mo(nk),mo(w0))),J=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),he=null,re=null,T=!0,D=!0,z=!1,K=!0,le=!1,X=!1,we=!1,Ce=!1,Ee=!1,Te=!1,Oe=!1,F=!0,U=!1,Y="user-content-",fe=!0,oe=!1,pe={},ue=null,se=_t({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),me=null,te=_t({},["audio","video","img","source","image","track"]),de=null,Se=_t({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Re="http://www.w3.org/1998/Math/MathML",Me="http://www.w3.org/2000/svg",qe="http://www.w3.org/1999/xhtml",ke=qe,We=!1,Ke=null,Xe=_t({},[Re,Me,qe],cE),nt,Et=["application/xhtml+xml","text/html"],it="text/html",st,rt=null,Lt=n.createElement("form"),kt=function(ge){return ge instanceof RegExp||ge instanceof Function},Mt=function(ge){rt&&rt===ge||((!ge||Vs(ge)!=="object")&&(ge={}),ge=Pl(ge),nt=Et.indexOf(ge.PARSER_MEDIA_TYPE)===-1?nt=it:nt=ge.PARSER_MEDIA_TYPE,st=nt==="application/xhtml+xml"?cE:Wb,$="ALLOWED_TAGS"in ge?_t({},ge.ALLOWED_TAGS,st):B,W="ALLOWED_ATTR"in ge?_t({},ge.ALLOWED_ATTR,st):ee,Ke="ALLOWED_NAMESPACES"in ge?_t({},ge.ALLOWED_NAMESPACES,cE):Xe,de="ADD_URI_SAFE_ATTR"in ge?_t(Pl(Se),ge.ADD_URI_SAFE_ATTR,st):Se,me="ADD_DATA_URI_TAGS"in ge?_t(Pl(te),ge.ADD_DATA_URI_TAGS,st):te,ue="FORBID_CONTENTS"in ge?_t({},ge.FORBID_CONTENTS,st):se,he="FORBID_TAGS"in ge?_t({},ge.FORBID_TAGS,st):{},re="FORBID_ATTR"in ge?_t({},ge.FORBID_ATTR,st):{},pe="USE_PROFILES"in ge?ge.USE_PROFILES:!1,T=ge.ALLOW_ARIA_ATTR!==!1,D=ge.ALLOW_DATA_ATTR!==!1,z=ge.ALLOW_UNKNOWN_PROTOCOLS||!1,K=ge.ALLOW_SELF_CLOSE_IN_ATTR!==!1,le=ge.SAFE_FOR_TEMPLATES||!1,X=ge.WHOLE_DOCUMENT||!1,Ee=ge.RETURN_DOM||!1,Te=ge.RETURN_DOM_FRAGMENT||!1,Oe=ge.RETURN_TRUSTED_TYPE||!1,Ce=ge.FORCE_BODY||!1,F=ge.SANITIZE_DOM!==!1,U=ge.SANITIZE_NAMED_PROPS||!1,fe=ge.KEEP_CONTENT!==!1,oe=ge.IN_PLACE||!1,_=ge.ALLOWED_URI_REGEXP||_,ke=ge.NAMESPACE||qe,J=ge.CUSTOM_ELEMENT_HANDLING||{},ge.CUSTOM_ELEMENT_HANDLING&&kt(ge.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(J.tagNameCheck=ge.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ge.CUSTOM_ELEMENT_HANDLING&&kt(ge.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(J.attributeNameCheck=ge.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ge.CUSTOM_ELEMENT_HANDLING&&typeof ge.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(J.allowCustomizedBuiltInElements=ge.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),le&&(D=!1),Te&&(Ee=!0),pe&&($=_t({},mo(tk)),W=[],pe.html===!0&&(_t($,ek),_t(W,rk)),pe.svg===!0&&(_t($,hE),_t(W,mE),_t(W,w0)),pe.svgFilters===!0&&(_t($,dE),_t(W,mE),_t(W,w0)),pe.mathMl===!0&&(_t($,pE),_t(W,nk),_t(W,w0))),ge.ADD_TAGS&&($===B&&($=Pl($)),_t($,ge.ADD_TAGS,st)),ge.ADD_ATTR&&(W===ee&&(W=Pl(W)),_t(W,ge.ADD_ATTR,st)),ge.ADD_URI_SAFE_ATTR&&_t(de,ge.ADD_URI_SAFE_ATTR,st),ge.FORBID_CONTENTS&&(ue===se&&(ue=Pl(ue)),_t(ue,ge.FORBID_CONTENTS,st)),fe&&($["#text"]=!0),X&&_t($,["html","head","body"]),$.table&&(_t($,["tbody"]),delete he.tbody),Zn&&Zn(ge),rt=ge)},gt=_t({},["mi","mo","mn","ms","mtext"]),Kr=_t({},["foreignobject","desc","title","annotation-xml"]),rn=_t({},["title","style","font","a","script"]),Lr=_t({},hE);_t(Lr,dE),_t(Lr,J2e);var co=_t({},pE);_t(co,ewe);var Zp=function(ge){var be=w(ge);(!be||!be.tagName)&&(be={namespaceURI:ke,tagName:"template"});var xe=Wb(ge.tagName),Dt=Wb(be.tagName);return Ke[ge.namespaceURI]?ge.namespaceURI===Me?be.namespaceURI===qe?xe==="svg":be.namespaceURI===Re?xe==="svg"&&(Dt==="annotation-xml"||gt[Dt]):Boolean(Lr[xe]):ge.namespaceURI===Re?be.namespaceURI===qe?xe==="math":be.namespaceURI===Me?xe==="math"&&Kr[Dt]:Boolean(co[xe]):ge.namespaceURI===qe?be.namespaceURI===Me&&!Kr[Dt]||be.namespaceURI===Re&&!gt[Dt]?!1:!co[xe]&&(rn[xe]||!Lr[xe]):!!(nt==="application/xhtml+xml"&&Ke[ge.namespaceURI]):!1},En=function(ge){sm(e.removed,{element:ge});try{ge.parentNode.removeChild(ge)}catch{try{ge.outerHTML=A}catch{ge.remove()}}},et=function(ge,be){try{sm(e.removed,{attribute:be.getAttributeNode(ge),from:be})}catch{sm(e.removed,{attribute:null,from:be})}if(be.removeAttribute(ge),ge==="is"&&!W[ge])if(Ee||Te)try{En(be)}catch{}else try{be.setAttribute(ge,"")}catch{}},Ct=function(ge){var be,xe;if(Ce)ge="<remove></remove>"+ge;else{var Dt=q2e(ge,/^[\r\n\t ]+/);xe=Dt&&Dt[0]}nt==="application/xhtml+xml"&&ke===qe&&(ge='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ge+"</body></html>");var ti=E?E.createHTML(ge):ge;if(ke===qe)try{be=new h().parseFromString(ti,nt)}catch{}if(!be||!be.documentElement){be=k.createDocument(ke,"template",null);try{be.documentElement.innerHTML=We?A:ti}catch{}}var Pn=be.body||be.documentElement;return ge&&xe&&Pn.insertBefore(n.createTextNode(xe),Pn.childNodes[0]||null),ke===qe?C.call(be,X?"html":"body")[0]:X?be.documentElement:Pn},Wt=function(ge){return O.call(ge.ownerDocument||ge,ge,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},mr=function(ge){return ge instanceof f&&(typeof ge.nodeName!="string"||typeof ge.textContent!="string"||typeof ge.removeChild!="function"||!(ge.attributes instanceof c)||typeof ge.removeAttribute!="function"||typeof ge.setAttribute!="function"||typeof ge.namespaceURI!="string"||typeof ge.insertBefore!="function"||typeof ge.hasChildNodes!="function")},Nt=function(ge){return Vs(a)==="object"?ge instanceof a:ge&&Vs(ge)==="object"&&typeof ge.nodeType=="number"&&typeof ge.nodeName=="string"},_r=function(ge,be,xe){!j[ge]||K2e(j[ge],function(Dt){Dt.call(e,be,xe,rt)})},qr=function(ge){var be;if(_r("beforeSanitizeElements",ge,null),mr(ge)||Hn(/[\u0080-\uFFFF]/,ge.nodeName))return En(ge),!0;var xe=st(ge.nodeName);if(_r("uponSanitizeElement",ge,{tagName:xe,allowedTags:$}),ge.hasChildNodes()&&!Nt(ge.firstElementChild)&&(!Nt(ge.content)||!Nt(ge.content.firstElementChild))&&Hn(/<[/\w]/g,ge.innerHTML)&&Hn(/<[/\w]/g,ge.textContent)||xe==="select"&&Hn(/<template/i,ge.innerHTML))return En(ge),!0;if(!$[xe]||he[xe]){if(!he[xe]&&$c(xe)&&(J.tagNameCheck instanceof RegExp&&Hn(J.tagNameCheck,xe)||J.tagNameCheck instanceof Function&&J.tagNameCheck(xe)))return!1;if(fe&&!ue[xe]){var Dt=w(ge)||ge.parentNode,ti=v(ge)||ge.childNodes;if(ti&&Dt)for(var Pn=ti.length,Cn=Pn-1;Cn>=0;--Cn)Dt.insertBefore(m(ti[Cn],!0),g(ge))}return En(ge),!0}return ge instanceof s&&!Zp(ge)||(xe==="noscript"||xe==="noembed")&&Hn(/<\/no(script|embed)/i,ge.innerHTML)?(En(ge),!0):(le&&ge.nodeType===3&&(be=ge.textContent,be=fo(be,q," "),be=fo(be,Z," "),be=fo(be,ne," "),ge.textContent!==be&&(sm(e.removed,{element:ge.cloneNode()}),ge.textContent=be)),_r("afterSanitizeElements",ge,null),!1)},Tr=function(ge,be,xe){if(F&&(be==="id"||be==="name")&&(xe in n||xe in Lt))return!1;if(!(D&&!re[be]&&Hn(ie,be))){if(!(T&&Hn(P,be))){if(!W[be]||re[be]){if(!($c(ge)&&(J.tagNameCheck instanceof RegExp&&Hn(J.tagNameCheck,ge)||J.tagNameCheck instanceof Function&&J.tagNameCheck(ge))&&(J.attributeNameCheck instanceof RegExp&&Hn(J.attributeNameCheck,be)||J.attributeNameCheck instanceof Function&&J.attributeNameCheck(be))||be==="is"&&J.allowCustomizedBuiltInElements&&(J.tagNameCheck instanceof RegExp&&Hn(J.tagNameCheck,xe)||J.tagNameCheck instanceof Function&&J.tagNameCheck(xe))))return!1}else if(!de[be]){if(!Hn(_,fo(xe,R,""))){if(!((be==="src"||be==="xlink:href"||be==="href")&&ge!=="script"&&X2e(xe,"data:")===0&&me[ge])){if(!(z&&!Hn(y,fo(xe,R,"")))){if(xe)return!1}}}}}}return!0},$c=function(ge){return ge.indexOf("-")>0},Ra=function(ge){var be,xe,Dt,ti;_r("beforeSanitizeAttributes",ge,null);var Pn=ge.attributes;if(!!Pn){var Cn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:W};for(ti=Pn.length;ti--;){be=Pn[ti];var e0=be,ln=e0.name,hR=e0.namespaceURI;if(xe=ln==="value"?be.value:Q2e(be.value),Dt=st(ln),Cn.attrName=Dt,Cn.attrValue=xe,Cn.keepAttr=!0,Cn.forceKeepAttr=void 0,_r("uponSanitizeAttribute",ge,Cn),xe=Cn.attrValue,!Cn.forceKeepAttr&&(et(ln,ge),!!Cn.keepAttr)){if(!K&&Hn(/\/>/i,xe)){et(ln,ge);continue}le&&(xe=fo(xe,q," "),xe=fo(xe,Z," "),xe=fo(xe,ne," "));var eM=st(ge.nodeName);if(!!Tr(eM,Dt,xe)){if(U&&(Dt==="id"||Dt==="name")&&(et(ln,ge),xe=Y+xe),E&&Vs(d)==="object"&&typeof d.getAttributeType=="function"&&!hR)switch(d.getAttributeType(eM,Dt)){case"TrustedHTML":xe=E.createHTML(xe);break;case"TrustedScriptURL":xe=E.createScriptURL(xe);break}try{hR?ge.setAttributeNS(hR,ln,xe):ge.setAttribute(ln,xe),JP(e.removed)}catch{}}}}_r("afterSanitizeAttributes",ge,null)}},xl=function Ve(ge){var be,xe=Wt(ge);for(_r("beforeSanitizeShadowDOM",ge,null);be=xe.nextNode();)_r("uponSanitizeShadowNode",be,null),!qr(be)&&(be.content instanceof i&&Ve(be.content),Ra(be));_r("afterSanitizeShadowDOM",ge,null)};return e.sanitize=function(Ve){var ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},be,xe,Dt,ti,Pn;if(We=!Ve,We&&(Ve="<!-->"),typeof Ve!="string"&&!Nt(Ve)){if(typeof Ve.toString!="function")throw fE("toString is not a function");if(Ve=Ve.toString(),typeof Ve!="string")throw fE("dirty is not a string, aborting")}if(!e.isSupported){if(Vs(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Ve=="string")return t.toStaticHTML(Ve);if(Nt(Ve))return t.toStaticHTML(Ve.outerHTML)}return Ve}if(we||Mt(ge),e.removed=[],typeof Ve=="string"&&(oe=!1),oe){if(Ve.nodeName){var Cn=st(Ve.nodeName);if(!$[Cn]||he[Cn])throw fE("root node is forbidden and cannot be sanitized in-place")}}else if(Ve instanceof a)be=Ct("<!---->"),xe=be.ownerDocument.importNode(Ve,!0),xe.nodeType===1&&xe.nodeName==="BODY"||xe.nodeName==="HTML"?be=xe:be.appendChild(xe);else{if(!Ee&&!le&&!X&&Ve.indexOf("<")===-1)return E&&Oe?E.createHTML(Ve):Ve;if(be=Ct(Ve),!be)return Ee?null:Oe?A:""}be&&Ce&&En(be.firstChild);for(var e0=Wt(oe?Ve:be);Dt=e0.nextNode();)Dt.nodeType===3&&Dt===ti||qr(Dt)||(Dt.content instanceof i&&xl(Dt.content),Ra(Dt),ti=Dt);if(ti=null,oe)return Ve;if(Ee){if(Te)for(Pn=x.call(be.ownerDocument);be.firstChild;)Pn.appendChild(be.firstChild);else Pn=be;return(W.shadowroot||W.shadowrootmod)&&(Pn=I.call(r,Pn,!0)),Pn}var ln=X?be.outerHTML:be.innerHTML;return X&&$["!doctype"]&&be.ownerDocument&&be.ownerDocument.doctype&&be.ownerDocument.doctype.name&&Hn(uwe,be.ownerDocument.doctype.name)&&(ln="<!DOCTYPE "+be.ownerDocument.doctype.name+`>
`+ln),le&&(ln=fo(ln,q," "),ln=fo(ln,Z," "),ln=fo(ln,ne," ")),E&&Oe?E.createHTML(ln):ln},e.setConfig=function(Ve){Mt(Ve),we=!0},e.clearConfig=function(){rt=null,we=!1},e.isValidAttribute=function(Ve,ge,be){rt||Mt({});var xe=st(Ve),Dt=st(ge);return Tr(xe,Dt,be)},e.addHook=function(Ve,ge){typeof ge=="function"&&(j[Ve]=j[Ve]||[],sm(j[Ve],ge))},e.removeHook=function(Ve){if(j[Ve])return JP(j[Ve])},e.removeHooks=function(Ve){j[Ve]&&(j[Ve]=[])},e.removeAllHooks=function(){j={}},e}var hwe=bK();function ms(t){return t[0].toUpperCase()+t.substr(1)}function wK(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function SK(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function RK(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(t).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n]})}function ik(t){return j8("".concat(t),{ALLOWED_TAGS:[]})}function j8(t,e){return hwe.sanitize(t,e)}function ok(t){return gwe(t)||mwe(t)||pwe(t)||dwe()}function dwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pwe(t,e){if(!!t){if(typeof t=="string")return cT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cT(t,e)}}function mwe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function gwe(t){if(Array.isArray(t))return cT(t)}function cT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ywe(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function vwe(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function q2(t){return vwe(t)&&t.parent}function Bu(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,i=n.ELEMENT_NODE,o=n.DOCUMENT_FRAGMENT_NODE,a=t;a!=null&&a!==r;){var s=a,l=s.nodeType,u=s.nodeName;if(l===i&&(e.includes(u)||e.includes(a)))return a;var c=a,f=c.host;f&&l===o?a=f:a=a.parentNode}return null}function S0(t,e,r){for(var n=[],i=t;i&&(i=Bu(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;var o=n.length;return o?n[o-1]:null}function Uu(t,e){var r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function bwe(t){var e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function kl(t,e,r){var n=r.parentElement.querySelector(".ht_clone_".concat(t));return n?n.contains(e):null}var fT,hT,dT;function R0(t){return!t||!t.length?[]:t.filter(function(e){return!!e})}if(N2e()){var ak=function(e){var r=e.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};fT=function(e,r){return e.classList===void 0||typeof r!="string"||r===""?!1:e.classList.contains(r)},hT=function(e,r){var n=e.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=R0(i),i.length>0)if(ak(n)){var o;(o=e.classList).add.apply(o,ok(i))}else for(var a=0;i[a];)e.classList.add(i[a]),a+=1},dT=function(e,r){var n=e.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=R0(i),i.length>0)if(ak(n)){var o;(o=e.classList).remove.apply(o,ok(i))}else for(var a=0;i[a];)e.classList.remove(i[a]),a+=1}}else{var gE=function(e){return new RegExp("(\\s|^)".concat(e,"(\\s|$)"))};fT=function(e,r){return e.className!==void 0&&gE(r).test(e.className)},hT=function(e,r){var n=e.className,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=R0(i),n==="")n=i.join(" ");else for(var o=0;o<i.length;o++)i[o]&&!gE(i[o]).test(n)&&(n+=" ".concat(i[o]));e.className=n},dT=function(e,r){var n=0,i=e.className,o=r;for(typeof o=="string"&&(o=o.split(" ")),o=R0(o);o[n];)i=i.replace(gE(o[n])," ").trim(),n+=1;e.className!==i&&(e.className=i)}}function at(t,e){return fT(t,e)}function _e(t,e){hT(t,e)}function ut(t,e){dT(t,e)}function EK(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1)for(var e=t.childNodes,r=e.length-1;r>=0;r--)EK(e[r])}function ua(t){for(var e;e=t.lastChild;)t.removeChild(e)}var wwe=/(<(.*)>|&(.*);)/;function Fp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;wwe.test(e)?t.innerHTML=r?j8(e):e:Yu(t,e)}function Yu(t,e){var r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?P2e?r.textContent=e:r.data=e:(ua(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function xg(t){for(var e=t.ownerDocument.documentElement,r=t;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return xg(r.host.impl);if(r.host)return xg(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Zr(t){var e=t.ownerDocument,r=e.defaultView,n=e.documentElement,i=t,o,a,s,l;if(yK()&&i.firstChild&&i.firstChild.nodeName==="CAPTION")return l=i.getBoundingClientRect(),{top:l.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:l.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(o=i.offsetLeft,a=i.offsetTop,s=i;(i=i.offsetParent)&&i!==e.body;)o+=i.offsetLeft,a+=i.offsetTop,s=i;return s&&s.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:o,top:a}}function Mg(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=t.scrollY;return e===void 0&&(e=t.document.documentElement.scrollTop),e}function dh(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=t.scrollX;return e===void 0&&(e=t.document.documentElement.scrollLeft),e}function X2(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Mg(e):t.scrollTop}function pT(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?dh(e):t.scrollLeft}function Q2(t){var e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);for(var n=["auto","scroll"],i=k2e(),o=t.parentNode;o&&o.style&&e.body!==o;){var a=o.style,s=a.overflow,l=a.overflowX,u=a.overflowY;if([s,l,u].includes("scroll"))return o;if(i){var c=r.getComputedStyle(o);if(s=c.overflow,l=c.overflowX,u=c.overflowY,n.includes(s)||n.includes(l)||n.includes(u))return o}if(o.clientHeight<=o.scrollHeight+1&&(n.includes(u)||n.includes(s))||o.clientWidth<=o.scrollWidth+1&&(n.includes(l)||n.includes(s)))return o;o=o.parentNode}return r}function Ng(t){for(var e=t.ownerDocument,r=e.defaultView,n=t.parentNode;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var i=Ku(n,r),o=["scroll","hidden","auto"],a=i.getPropertyValue("overflow"),s=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(a)||o.includes(s)||o.includes(l))return n;n=n.parentNode}return r}function Pg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?"".concat(r.innerWidth,"px"):e==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=t.style[e];if(n!==""&&n!==void 0)return n;var i=Ku(t,r);if(i[e]!==""&&i[e]!==void 0)return i[e]}function Ku(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function Qt(t){return t.offsetWidth}function wr(t){return yK()&&t.firstChild&&t.firstChild.nodeName==="CAPTION"?t.offsetHeight+t.firstChild.offsetHeight:t.offsetHeight}function Gs(t){return t.clientHeight||t.innerHeight}function zb(t){return t.clientWidth||t.innerWidth}function CK(t){var e=t.ownerDocument;if(t.selectionStart)return t.selectionStart;if(e.selection){t.focus();var r=e.selection.createRange();if(r===null)return 0;var n=t.createTextRange(),i=n.duplicate();return n.moveToBookmark(r.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}return 0}function Swe(t){var e=t.ownerDocument;if(t.selectionEnd)return t.selectionEnd;if(e.selection){var r=e.selection.createRange();if(r===null)return 0;var n=t.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function Rwe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=t.document,r="";return t.getSelection?r=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(r=e.selection.createRange().text),r}function sk(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=t.document;t.getSelection?t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges():e.selection&&e.selection.empty()}function b6(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{var n=t.parentNode,i=n.style.display;n.style.display="block",t.setSelectionRange(e,r),n.style.display=i}}}var yE;function Ewe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";var r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);var n=e.offsetWidth;r.style.overflow="scroll";var i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i}function gn(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return yE===void 0&&(yE=Ewe(t)),yE}function Cwe(t){return t.offsetWidth!==t.clientWidth}function _we(t){return t.offsetHeight!==t.clientHeight}function W8(t,e,r){Kbe()?(t.style.top=r,t.style.left=e):zbe()?t.style["-webkit-transform"]="translate3d(".concat(e,",").concat(r,",0)"):t.style.transform="translate3d(".concat(e,",").concat(r,",0)")}function w6(t){t.style.transform&&t.style.transform!==""?t.style.transform="":t.style["-webkit-transform"]&&t.style["-webkit-transform"]!==""&&(t.style["-webkit-transform"]="")}function Z2(t){var e=["INPUT","SELECT","TEXTAREA"];return t&&(e.indexOf(t.nodeName)>-1||t.contentEditable==="true")}function z8(t){return Z2(t)&&t.hasAttribute("data-hot-input")===!1}function Twe(t){var e=t.ownerDocument.activeElement;z8(e)||t.select()}function _K(t){return!t.parentNode}function Owe(t,e){var r=new IntersectionObserver(function(n,i){n.forEach(function(o){o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body});r.observe(t)}var Awe=i6,Iwe=nK;Awe("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Iwe);var xwe=zr,Mwe=Lp,Nwe=TypeError,Pwe=Object.getOwnPropertyDescriptor,kwe=xwe&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),$we=kwe?function(t,e){if(Mwe(t)&&!Pwe(t,"length").writable)throw Nwe("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},Lwe=tt,Dwe=bi,Fwe=s1,Hwe=El,Bwe=oo,Uwe=$we,Vwe=JY,jwe=g8,Wwe=$p,vE=XG,zwe=w1,Gwe=zwe("splice"),Ywe=Math.max,Kwe=Math.min;Lwe({target:"Array",proto:!0,forced:!Gwe},{splice:function(e,r){var n=Dwe(this),i=Bwe(n),o=Fwe(e,i),a=arguments.length,s,l,u,c,f,h;for(a===0?s=l=0:a===1?(s=0,l=i-o):(s=a-2,l=Kwe(Ywe(Hwe(r),0),i-o)),Vwe(i+s-l),u=jwe(n,l),c=0;c<l;c++)f=o+c,f in n&&Wwe(u,c,n[f]);if(u.length=l,s<l){for(c=o;c<i-l;c++)f=c+l,h=c+s,f in n?n[h]=n[f]:vE(n,h);for(c=i;c>i-l+s;c--)vE(n,c-1)}else if(s>l)for(c=i-l;c>o;c--)f=c+l-1,h=c+s-1,f in n?n[h]=n[f]:vE(n,h);for(c=0;c<s;c++)n[c+o]=arguments[c+2];return Uwe(n,i-l+s),u}});function Xt(){if(He(console)){var t;(t=console).warn.apply(t,arguments)}}function G8(){if(He(console)){var t;(t=console).error.apply(t,arguments)}}var qwe=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",Xwe=TypeError,TK=function(t,e){if(t<e)throw Xwe("Not enough arguments");return t},OK=nr,Qwe=Cc,Zwe=cr,Jwe=qwe,eSe=yc,tSe=E1,rSe=TK,nSe=OK.Function,iSe=/MSIE .\./.test(eSe)||Jwe&&function(){var t=OK.Bun.version.split(".");return t.length<3||t[0]==0&&(t[1]<3||t[1]==3&&t[2]==0)}(),Y8=function(t,e){var r=e?2:1;return iSe?function(n,i){var o=rSe(arguments.length,1)>r,a=Zwe(n)?n:nSe(n),s=o?tSe(arguments,r):[],l=o?function(){Qwe(a,this,s)}:a;return e?t(l,i):t(l)}:t},oSe=tt,AK=nr,aSe=Y8,lk=aSe(AK.setInterval,!0);oSe({global:!0,bind:!0,forced:AK.setInterval!==lk},{setInterval:lk});var sSe=tt,IK=nr,lSe=Y8,uk=lSe(IK.setTimeout,!0);sSe({global:!0,bind:!0,forced:IK.setTimeout!==uk},{setTimeout:uk});var uSe=tt,cSe=mt,fSe=Lp,hSe=cSe([].reverse),ck=[1,2];uSe({target:"Array",proto:!0,forced:String(ck)===String(ck.reverse())},{reverse:function(){return fSe(this)&&(this.length=this.length),hSe(this)}});function sr(t){return typeof t=="function"}function xK(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=this,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout(function(){n=t.apply(o,s)},e),n}return i}function MK(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return t.apply(this,r.concat(a))}}function dSe(t){var e=t.length;function r(n){return function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];var l=n.concat(a),u;return l.length>=e?u=t.apply(this,l):u=r(l),u}}return r([])}function mT(t,e,r,n,i,o,a,s){return He(s)?t.call(e,r,n,i,o,a,s):He(a)?t.call(e,r,n,i,o,a):He(o)?t.call(e,r,n,i,o):He(i)?t.call(e,r,n,i):He(n)?t.call(e,r,n):He(r)?t.call(e,r):t.call(e)}function kg(t){return kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kg(t)}var fk;function pSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gSe(n.key),n)}}function mSe(t,e,r){return e&&hk(t.prototype,e),r&&hk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function gSe(t){var e=ySe(t,"string");return kg(e)==="symbol"?e:String(e)}function ySe(t,e){if(kg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(kg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vSe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var Uc=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],bSe=Gt(fk||(fk=vSe([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),bE=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),wE=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),NK=function(){function t(){pSe(this,t),this.globalBucket=this.createEmptyBucket()}return mSe(t,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return ae(Uc,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var i=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))ae(n,function(l){return i.add(r,l,o)});else{bE.has(r)&&Xt(RK(bSe,{hookName:r,removedInVersion:bE.get(r)})),wE.has(r)&&Xt(wE.get(r));var a=this.getBucket(o);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var s=!1;n.initialHook&&ae(a[r],function(l,u){if(l.initialHook)return a[r][u]=n,s=!0,!1}),s||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var i=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?ae(n,function(a){return i.once(r,a,o)}):(n.runOnce=!0,this.add(r,n,o))}},{key:"remove",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=this.getBucket(i);return typeof o[r]<"u"&&o[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=this.getBucket(n);return!!(i[r]!==void 0&&i[r].length)}},{key:"run",value:function(r,n,i,o,a,s,l,u){{var c=this.globalBucket[n],f=c?c.length:0,h=0;if(f)for(;h<f;){if(!c[h]||c[h].skip){h+=1;continue}var d=mT(c[h],r,i,o,a,s,l,u);d!==void 0&&(i=d),c[h]&&c[h].runOnce&&this.remove(n,c[h]),h+=1}}{var p=this.getBucket(r)[n],m=p?p.length:0,g=0;if(m)for(;g<m;){if(!p[g]||p[g].skip){g+=1;continue}var v=mT(p[g],r,i,o,a,s,l,u);v!==void 0&&(i=v),p[g]&&p[g].runOnce&&this.remove(n,p[g],r),g+=1}}return i}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Rt(this.getBucket(r),function(n,i,o){return o[i].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||Uc.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&Uc.splice(Uc.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return wE.has(r)||bE.has(r)}},{key:"isRegistered",value:function(r){return Uc.indexOf(r)>=0}},{key:"getRegistered",value:function(){return Uc}}],[{key:"getSingleton",value:function(){return SSe()}}]),t}(),wSe=new NK;function SSe(){return wSe}const Ue=NK;function dk(t){return _Se(t)||CSe(t)||ESe(t)||RSe()}function RSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ESe(t,e){if(!!t){if(typeof t=="string")return gT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gT(t,e)}}function CSe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function _Se(t){if(Array.isArray(t))return gT(t)}function gT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var SE=new Map;function so(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";SE.has(t)||SE.set(t,new Map);var e=SE.get(t);function r(s,l){e.set(s,l)}function n(s){return e.get(s)}function i(s){return e.has(s)}function o(){return dk(e.keys())}function a(){return dk(e.values())}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:a}}var yT=new WeakMap,O1=so("editors"),TSe=O1.register,PK=O1.getItem,kK=O1.hasItem;O1.getNames;O1.getValues;function OSe(t){var e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},Ue.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function $K(t,e){var r;if(typeof t=="function")yT.get(t)||Ti(null,t),r=yT.get(t);else if(typeof t=="string")r=PK(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(t,'"'));return r.getInstance(e)}function pk(t){if(typeof t=="function")return t;if(!kK(t))throw Error('No registered editor found under "'.concat(t,'" name'));return PK(t).getConstructor()}function Ti(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);var r=new OSe(e);typeof t=="string"&&TSe(t,r),yT.set(e,r)}function $g(t){return $g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$g(t)}function ASe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xSe(n.key),n)}}function ISe(t,e,r){return e&&mk(t.prototype,e),r&&mk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function xSe(t){var e=MSe(t,"string");return $g(e)==="symbol"?e:String(e)}function MSe(t,e){if($g(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if($g(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var NSe=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ASe(this,t),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}return ISe(t,[{key:"addEventListener",value:function(r,n,i){var o=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(l){i.call(this,PSe(l))}return typeof a!="boolean"&&!D2e()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:i,callbackProxy:s,options:a,eventManager:this}),r.addEventListener(n,s,a),function(){o.removeEventListener(r,n,i)}}},{key:"removeEventListener",value:function(r,n,i){for(var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,s;a;)if(a-=1,s=this.context.eventListeners[a],s.event===n&&s.element===r){if(i&&i!==s.callback||o&&s.eventManager!==this)continue;this.context.eventListeners.splice(a,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!!this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var i=this.context.eventListeners[n];r&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options))}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var i=r.document,o=r;i||(i=r.ownerDocument?r.ownerDocument:r,o=i.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},s;i.createEvent?(s=i.createEvent("MouseEvents"),s.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,i.body.parentNode)):s=i.createEventObject(),r.dispatchEvent?r.dispatchEvent(s):r.fireEvent("on".concat(n),s)}}]),t}();function PSe(t){var e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),la(this)},t}const Er=NSe;function Lg(t){return Lg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lg(t)}function kSe(t,e){return FSe(t)||DSe(t,e)||LSe(t,e)||$Se()}function $Se(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LSe(t,e){if(!!t){if(typeof t=="string")return gk(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gk(t,e)}}function gk(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function DSe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function FSe(t){if(Array.isArray(t))return t}function HSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,USe(n.key),n)}}function BSe(t,e,r){return e&&yk(t.prototype,e),r&&yk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function USe(t){var e=VSe(t,"string");return Lg(e)==="symbol"?e:String(e)}function VSe(t,e){if(Lg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Lg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var S6="editorManager.navigation",Qm="editorManager.handlingEditor",vT=function(){function t(e,r,n){var i=this;HSe(this,t),this.instance=e,this.tableMeta=r,this.selection=n,this.eventManager=new Er(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var o=this.instance.getShortcutManager();o.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return i.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!i.destroyed&&i.instance.isListening()&&i.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,s,l){return i.onCellDblClick(a,s,l)})}return BSe(t,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),i=n.getContext("grid"),o=n.getContext("editor"),a={group:Qm};o.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(l,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),i.addShortcuts([{keys:[["F2"]],callback:function(l){r.openEditor(null,l,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(l,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,l,!0):r.moveSelectionAfterEnter(u.includes("shift")),la(l)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(m){m&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,i=n.row,o=n.col,a=this.instance.runHooks("modifyGetCellCoords",i,o),s=i,l=o;if(Array.isArray(a)){var u=kSe(a,2);s=u[0],l=u[1]}this.cellProperties=this.instance.getCellMeta(s,l);var c=this.instance.rootDocument.activeElement;if(c&&z8(c)&&c.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var f=this.instance.getCell(i,o,!0);if(f){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(l),p=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(s),l);this.activeEditor=$K(h,this.instance),this.activeEditor.prepare(i,o,d,f,p,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var o=this.instance.getSelectedRangeLast().highlight,a=o.row,s=o.col,l=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(s);this.instance.view.scrollViewport(this.instance._createCellCoords(l,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,i){this.activeEditor?this.activeEditor.finishEditing(r,n,i):i&&i(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,i=n.row,o=n.col,a=this.instance,s=a.rowIndexMapper,l=a.columnIndexMapper,u=s.isHidden(this.instance.toPhysicalRow(i))||l.isHidden(this.instance.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(!!this.instance.isListening()){var i=r.keyCode;if(!!this.selection.isSelected()){var o=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!fK(i)&&!Qbe(i)&&!o&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),s=a.getContext("editor"),l={runOnlyIf:function(){return He(n.instance.getSelected())},group:S6};s.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],l),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,i){i.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),t}(),vk=new WeakMap;vT.getInstance=function(t,e,r){var n=vk.get(t);return n||(n=new vT(t,e,r),vk.set(t,n)),n};const jSe=vT;var WSe="hooksRefRegisterer",LK={_hooksStorage:Object.create(null),addHook:function(e,r){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,r),this._hooksStorage[e].push(r),this},removeHooksByKey:function(e){var r=this;ae(this._hooksStorage[e]||[],function(n){r.hot.removeHook(e,n)})},clearHooks:function(){var e=this;Rt(this._hooksStorage,function(r,n){return e.removeHooksByKey(n)}),this._hooksStorage={}}};Ts(LK,"MIXIN_NAME",WSe,{writable:!1,enumerable:!1});const zSe=LK;function ph(t){return ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ph(t)}function GSe(t,e){return XSe(t)||qSe(t,e)||KSe(t,e)||YSe()}function YSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KSe(t,e){if(!!t){if(typeof t=="string")return bk(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bk(t,e)}}function bk(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function qSe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function XSe(t){if(Array.isArray(t))return t}function QSe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bT(t,e)}function bT(t,e){return bT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bT(t,e)}function ZSe(t){var e=t6e();return function(){var n=J2(t),i;if(e){var o=J2(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return JSe(this,i)}}function JSe(t,e){if(e&&(ph(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return e6e(t)}function e6e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function t6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function J2(t){return J2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},J2(t)}function wk(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,r6e(n.key),n)}}function Rk(t,e,r){return e&&Sk(t.prototype,e),r&&Sk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function r6e(t){var e=n6e(t,"string");return ph(e)==="symbol"?e:String(e)}function n6e(t,e){if(ph(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var i6e="base",cn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),wT="baseEditor",Hp=function(){function t(e){wk(this,t),this.hot=e,this.instance=e,this.state=cn.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return Rk(t,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,i,o,a,s){this.TD=o,this.row=r,this.col=n,this.prop=i,this.originalValue=a,this.cellProperties=s,this.state=cn.VIRGIN}},{key:"extend",value:function(){return function(r){QSe(i,r);var n=ZSe(i);function i(){return wk(this,i),n.apply(this,arguments)}return Rk(i)}(this.constructor)}},{key:"saveValue",value:function(r,n){var i=this,o,a,s,l;if(n){var u=this.hot.getSelectedLast();o=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),s=Math.max(u[0],u[2]),l=Math.max(u[1],u[3])}else{var c=[this.row,this.col,null,null];o=c[0],a=c[1],s=c[2],l=c[3]}var f=this.hot.runHooks("modifyGetCellCoords",o,a);if(Array.isArray(f)){var h=GSe(f,2);o=h[0],a=h[1]}var d=this.hot.getShortcutManager(),p=d.getContext("editor"),m={runOnlyIf:function(){return He(i.hot.getSelected())},group:wT};this.isInFullEditMode()&&p.addShortcuts([{keys:[["ArrowUp"]],callback:function(){i.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){i.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){i.hot.selection.transformStart(0,-1*i.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){i.hot.selection.transformStart(0,i.hot.getDirectionFactor())}}],m),this.hot.populateFromArray(o,a,r,s,l,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===cn.VIRGIN){var i=this.hot,o=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(o,a)),this.state=cn.EDITING,this.isInFullEditMode()){var s=typeof r=="string"?r:Vr(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,i){var o=this,a;if(i){var s=this._closeCallback;this._closeCallback=function(f){s&&s(f),i(f),o.hot.view.render()}}if(!this.isWaiting()){var l=this.hot.getShortcutManager(),u=l.getContext("editor");if(u.removeShortcutsByGroup(wT),u.removeShortcutsByGroup(S6),this.state===cn.VIRGIN){this.hot._registerTimeout(function(){o._fireCallbacks(!0)});return}if(this.state===cn.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var c=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof c=="string"?String.prototype.trim.call(c||""):c]]:a=[[c]],this.state=cn.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(f){o.state=cn.FINISHED,o.discardEditor(f)}):(this.state=cn.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=cn.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===cn.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=cn.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=cn.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===cn.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(!!n){var i=this.hot.view._wt,o=i.wtOverlays,a=i.wtViewport,s=this.hot.rootWindow,l=Zr(n),u=Qt(n),c=Zr(this.hot.rootElement),f=Qt(this.hot.rootElement),h=o.topOverlay.holder,d=o.inlineStartOverlay.holder,p=h!==s?h.scrollTop:0,m=d!==s?d.scrollLeft:0,g=s.innerWidth-c.left-f,v=(r=o.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,w=v.wtTable,b=w.name,E=["master","inline_start"].includes(b)?p:0,A=["master","top","bottom"].includes(b)?m:0,M=l.top===c.top?0:1,k=l.top-c.top-M-E,O=0;this.hot.isRtl()?O=s.innerWidth-l.left-u-g-1+A:O=l.left-c.left-1-A,["top","top_inline_start_corner"].includes(b)&&(k+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(O+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));var x=this.hot.hasColHeaders(),C=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),I=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),H=this.hot.rowIndexMapper.getRenderableIndexesLength(),j=H-this.hot.view._wt.getSetting("fixedRowsBottom");(x&&C<=0||C===j)&&(k+=1),I<=0&&(O+=1);var q=a.rowsRenderCalculator.startPosition,Z=a.columnsRenderCalculator.startPosition,ne=Math.abs(o.inlineStartOverlay.getScrollPosition()),ie=o.topOverlay.getScrollPosition(),P=gn(this.hot.rootDocument),y=n.offsetTop+q-ie,R=0;if(this.hot.isRtl()){var _=n.offsetLeft;_>=0?R=w.getWidth()-n.offsetLeft:R=Math.abs(_),R+=Z-ne-u}else R=n.offsetLeft+Z-ne;var $=Ku(this.TD,this.hot.rootWindow),B=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",W=parseInt($[B],10)>0?0:1,ee=parseInt($.borderTopWidth,10)>0?0:1,J=Qt(n)+W,he=wr(n)+ee,re=Cwe(h)?P:0,T=_we(d)?P:0,D=this.hot.view.maximumVisibleElementWidth(R)-re+W,z=Math.max(this.hot.view.maximumVisibleElementHeight(y)-T+ee,23);return{top:k,start:O,height:he,maxHeight:z,width:J,maxWidth:D}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return i6e}}]),t}();ir(Hp,zSe);var o6e=tt,a6e=Ec.map,s6e=w1,l6e=s6e("map");o6e({target:"Array",proto:!0,forced:!l6e},{map:function(e){return a6e(this,e,arguments.length>1?arguments[1]:void 0)}});function u6e(t){return d6e(t)||h6e(t)||f6e(t)||c6e()}function c6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function f6e(t,e){if(!!t){if(typeof t=="string")return ST(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ST(t,e)}}function h6e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function d6e(t){if(Array.isArray(t))return ST(t)}function ST(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function RT(t){return RT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},RT(t)}function Wi(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=RT(t);if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);var n=Array.from(new Set(["."].concat(u6e(e)))).map(function(i){return"\\".concat(i)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function p6e(t){return Wi(t,[","])}function Ye(t,e,r){var n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function ET(t,e,r){var n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function DK(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function m6e(){var t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},e,r=document.body,n=document.createTextNode(""),i=document.createElement("SPAN"),o=function(d,p,m){d.addEventListener(p,m,!1)},a=function(d,p,m){d.removeEventListener(p,m,!1)},s=function(d){var p,m;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=e.value+d:n.data=e.value+d,i.style.position="absolute",i.style.fontSize=f(e).fontSize,i.style.fontFamily=f(e).fontFamily,i.style.whiteSpace="pre",r.appendChild(i),p=i.clientWidth+2,r.removeChild(i),e.style.height=t.minHeight+"px",t.minWidth>p?e.style.width=t.minWidth+"px":p>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=p+"px",m=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>m?e.style.height=t.minHeight+"px":t.maxHeight<m?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=m+"px"},l=function(){window.setTimeout(s,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")t.minHeight=e.clientHeight;else{var p=parseInt(d.minHeight);isNaN(p)||(t.minHeight=p)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")t.maxHeight=e.clientHeight;else{var m=parseInt(d.maxHeight);isNaN(m)||(t.maxHeight=m)}if(d&&d.minWidth)if(d.minWidth=="inherit")t.minWidth=e.clientWidth;else{var g=parseInt(d.minWidth);isNaN(g)||(t.minWidth=g)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")t.maxWidth=e.clientWidth;else{var v=parseInt(d.maxWidth);isNaN(v)||(t.maxWidth=v)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))},c=function(d,p,m){e=d,u(p),e.nodeName=="TEXTAREA"&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),m&&(o(e,"change",s),o(e,"cut",l),o(e,"paste",l),o(e,"drop",l),o(e,"keydown",l),o(e,"focus",s),o(e,"compositionstart",l),o(e,"compositionupdate",l),o(e,"compositionend",l)),s()};function f(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,p,m){c(d,p,m)},unObserve:function(){a(e,"change",s),a(e,"cut",l),a(e,"paste",l),a(e,"drop",l),a(e,"keydown",l),a(e,"focus",s),a(e,"compositionstart",l),a(e,"compositionupdate",l),a(e,"compositionend",l)},resize:s}}function Ek(t,e){for(var r=CK(e),n=e.value.split(`
`),i=r,o=0,a=0;a<n.length;a++){var s=n[a];a!==0&&(o+=n[a-1].length+1);var l=o+s.length;if(t==="home"?i=o:t==="end"&&(i=l),r<=l)break}b6(e,i)}function mh(t){return mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mh(t)}function Ck(t,e){return b6e(t)||v6e(t,e)||y6e(t,e)||g6e()}function g6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function y6e(t,e){if(!!t){if(typeof t=="string")return _k(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _k(t,e)}}function _k(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function v6e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function b6e(t){if(Array.isArray(t))return t}function w6e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,R6e(n.key),n)}}function S6e(t,e,r){return e&&Tk(t.prototype,e),r&&Tk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function R6e(t){var e=E6e(t,"string");return mh(e)==="symbol"?e:String(e)}function E6e(t,e){if(mh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zm(){return typeof Reflect<"u"&&Reflect.get?Zm=Reflect.get.bind():Zm=function(e,r,n){var i=C6e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Zm.apply(this,arguments)}function C6e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=qu(t),t!==null););return t}function _6e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&CT(t,e)}function CT(t,e){return CT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},CT(t,e)}function T6e(t){var e=A6e();return function(){var n=qu(t),i;if(e){var o=qu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return O6e(this,i)}}function O6e(t,e){if(e&&(mh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FK(t)}function FK(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qu(t){return qu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qu(t)}var I6e="ht_editor_visible",E0="ht_editor_hidden",Ok="textEditor",x6e="text",_c=function(t){_6e(r,t);var e=T6e(r);function r(n){var i;return w6e(this,r),i=e.call(this,n),i.eventManager=new Er(FK(i)),i.autoResize=m6e(),i.TEXTAREA=void 0,i.textareaStyle=void 0,i.TEXTAREA_PARENT=void 0,i.textareaParentStyle=void 0,i.layerClass=void 0,i.createElements(),i.bindEvents(),i.hot.addHookOnce("afterDestroy",function(){return i.destroy()}),i}return S6e(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(i){this.TEXTAREA.value=i}},{key:"open",value:function(){var i=this;this.refreshDimensions(),this.showEditableElement();var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return i.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(i,o,a,s,l,u){var c=this.state;if(Zm(qu(r.prototype),"prepare",this).call(this,i,o,a,s,l,u),!u.readOnly){this.refreshDimensions(!0);var f=u.allowInvalid,h=u.fragmentSelection;f&&(this.TEXTAREA.value=""),c!==cn.FINISHED&&this.hideEditableElement();var d=!h;d&&!na()&&this.focus()}}},{key:"beginEditing",value:function(i,o){this.state===cn.VIRGIN&&(this.TEXTAREA.value="",Zm(qu(r.prototype),"beginEditing",this).call(this,i,o))}},{key:"focus",value:function(){this.TEXTAREA.select(),b6(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var i=this.hot.rootDocument;this.TEXTAREA=i.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,_e(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=i.createElement("DIV"),_e(this.TEXTAREA_PARENT,"handsontableInputHolder"),at(this.TEXTAREA_PARENT,this.layerClass)&&ut(this.TEXTAREA_PARENT,this.layerClass),_e(this.TEXTAREA_PARENT,E0),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(Ybe()||Gbe())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ut(this.TEXTAREA_PARENT,this.layerClass),_e(this.TEXTAREA_PARENT,E0)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var i=this.TEXTAREA_PARENT.childNodes,o=!1;Ye(i.length-1,function(a){var s=i[a];if(at(s,"handsontableEditor"))return o=!0,!1}),at(this.TEXTAREA_PARENT,E0)&&ut(this.TEXTAREA_PARENT,E0),o?(this.layerClass=I6e,_e(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),_e(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var i=this.hot.toPhysicalRow(this.row),o=this.hot.getSourceDataAtCell(i,this.col);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==cn.EDITING&&!i)){if(this.TD=this.getEditedCell(),!this.TD){i||this.close();return}var o=this.getEditedCellRect(),a=o.top,s=o.start,l=o.width,u=o.maxWidth,c=o.height,f=o.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(s,"px"),this.showEditableElement();var h=Ku(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=Ku(this.TEXTAREA),p=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),m=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),g=l-p,v=c-m,w=u-p,b=f-m;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(g,w),minHeight:Math.min(v,b),maxWidth:w,maxHeight:b},!0)}}},{key:"bindEvents",value:function(){var i=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(o){return o.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(o){return o.stopPropagation()}),uK()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return i.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){i.refreshDimensions(),i.focus()}),this.addHook("afterRowResize",function(){i.refreshDimensions(),i.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),a=o.getContext("editor"),s={runOnlyIf:function(){return He(i.hot.getSelected())},group:Ok},l=function(){i.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(c){var f=i.hot.getSettings(),h=typeof f.tabMoves=="function"?f.tabMoves(c):f.tabMoves;i.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(c){var f=i.hot.getSettings(),h=typeof f.tabMoves=="function"?f.tabMoves(c):f.tabMoves;i.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(c){return!i.hot.selection.isMultiple()&&!c.altKey},relativeToGroup:Qm,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(){return!i.hot.selection.isMultiple()},relativeToGroup:Qm,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return l(),!1},relativeToGroup:Qm,position:"before"},{keys:[["PageUp"]],callback:function(){i.hot.selection.transformStart(-i.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){i.hot.selection.transformStart(i.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(c,f){var h=Ck(f,1),d=h[0];Ek(d,i.TEXTAREA)}},{keys:[["End"]],callback:function(c,f){var h=Ck(f,1),d=h[0];Ek(d,i.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}}],s)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup(S6),o.removeShortcutsByGroup(Ok),o.removeShortcutsByGroup(wT)}},{key:"onAfterDocumentKeyDown",value:function(i){var o=[Ge.ARROW_UP,Ge.ARROW_RIGHT,Ge.ARROW_DOWN,Ge.ARROW_LEFT];o.indexOf(i.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(i.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return x6e}}]),r}(Hp);function gh(t){return gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gh(t)}function M6e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ak(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,P6e(n.key),n)}}function N6e(t,e,r){return e&&Ak(t.prototype,e),r&&Ak(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function P6e(t){var e=k6e(t,"string");return gh(e)==="symbol"?e:String(e)}function k6e(t,e){if(gh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function go(){return typeof Reflect<"u"&&Reflect.get?go=Reflect.get.bind():go=function(e,r,n){var i=$6e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},go.apply(this,arguments)}function $6e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ai(t),t!==null););return t}function L6e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_T(t,e)}function _T(t,e){return _T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_T(t,e)}function D6e(t){var e=B6e();return function(){var n=Ai(t),i;if(e){var o=Ai(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return F6e(this,i)}}function F6e(t,e){if(e&&(gh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return H6e(t)}function H6e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function B6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ai(t){return Ai=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ai(t)}var Ik="handsontableEditor",U6e="handsontable",K8=function(t){L6e(r,t);var e=D6e(r);function r(){return M6e(this,r),e.apply(this,arguments)}return N6e(r,[{key:"open",value:function(){go(Ai(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),b6(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),go(Ai(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(i,o,a,s,l,u){go(Ai(r.prototype),"prepare",this).call(this,i,o,a,s,l,u);var c=this,f={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,p){var m=this.getSourceData(p.row,p.col);m!==void 0&&c.setValue(m),c.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Jr(f,u.handsontable),this.htOptions=f}},{key:"beginEditing",value:function(i,o){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||go(Ai(r.prototype),"beginEditing",this).call(this,i,o)}},{key:"createElements",value:function(){go(Ai(r.prototype),"createElements",this).call(this);var i=this.hot.rootDocument.createElement("DIV");i.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(i),this.htContainer=i,this.assignHooks()}},{key:"finishEditing",value:function(i,o,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var s=this.htEditor.getInstance().getValue();s!==void 0&&this.setValue(s)}go(Ai(r.prototype),"finishEditing",this).call(this,i,o,a)}},{key:"assignHooks",value:function(){var i=this;this.hot.addHook("afterDestroy",function(){i.htEditor&&i.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),a=o.getContext("editor");go(Ai(r.prototype),"registerShortcuts",this).call(this);var s={group:Ik,relativeToGroup:S6,position:"before"},l=function(c,f){var h=i.htEditor.getInstance();if(c!==void 0&&(c<0||h.flipped&&c>h.countRows()-1?h.deselectCell():h.selectCell(c,0),h.getData().length))return f.preventDefault(),la(f),i.hot.listen(),i.TEXTAREA.focus(),!1};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(c){var f=i.htEditor.getInstance(),h,d;return!f.getSelectedLast()&&f.flipped?h=f.countRows()-1:f.getSelectedLast()&&(f.flipped?(d=f.getSelectedLast()[0],h=Math.max(0,d-1)):(d=f.getSelectedLast()[0],h=d-1)),l(h,c)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(c){var f=i.htEditor.getInstance(),h,d;if(!f.getSelectedLast()&&!f.flipped)h=0;else if(f.getSelectedLast()){if(f.flipped)h=f.getSelectedLast()[0]+1;else if(!f.flipped){var p=f.countRows()-1;d=f.getSelectedLast()[0],h=Math.min(p,d+1)}}return l(h,c)},preventDefault:!1}],s)}},{key:"unregisterShortcuts",value:function(){go(Ai(r.prototype),"unregisterShortcuts",this).call(this);var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup(Ik)}}],[{key:"EDITOR_TYPE",get:function(){return U6e}}]),r}(_c),V6e="base";function A1(t,e,r,n,i,o,a){var s=[],l=[];a.className&&_e(e,a.className),a.readOnly&&s.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?s.push(a.invalidCellClassName):l.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&s.push(a.noWordWrapClassName),!o&&a.placeholder&&s.push(a.placeholderCellClassName),ut(e,l),_e(e,s)}A1.RENDERER_TYPE=V6e;var j6e="text";function Os(t,e,r,n,i,o,a){A1.apply(this,[t,e,r,n,i,o,a]);var s=o;if(!s&&a.placeholder&&(s=a.placeholder),s=Vr(s),a.trimWhitespace&&(s=s.trim()),a.rendererTemplate){ua(e);var l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(r),e.appendChild(l)}else Yu(e,s)}Os.RENDERER_TYPE=j6e;function yh(t){return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yh(t)}function W6e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,HK(n.key),n)}}function z6e(t,e,r){return e&&xk(t.prototype,e),r&&xk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function au(){return typeof Reflect<"u"&&Reflect.get?au=Reflect.get.bind():au=function(e,r,n){var i=G6e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},au.apply(this,arguments)}function G6e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ua(t),t!==null););return t}function Y6e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&TT(t,e)}function TT(t,e){return TT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TT(t,e)}function K6e(t){var e=X6e();return function(){var n=Ua(t),i;if(e){var o=Ua(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return q6e(this,i)}}function q6e(t,e){if(e&&(yh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OT(t)}function OT(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function X6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ua(t){return Ua=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ua(t)}function Q6e(t,e,r){return e=HK(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HK(t){var e=Z6e(t,"string");return yh(e)==="symbol"?e:String(e)}function Z6e(t,e){if(yh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var RE=new WeakMap,J6e="autocomplete",q8=function(t){Y6e(r,t);var e=K6e(r);function r(n){var i;return W6e(this,r),i=e.call(this,n),Q6e(OT(i),"sortByRelevance",function(o,a,s){var l=[],u=[],c=o.length,f=a.length,h,d,p,m;if(c===0){for(p=0;p<f;p++)u.push(p);return u}for(p=0;p<f;p++){if(d=ik(Vr(a[p])),s)m=d.indexOf(o);else{var g=this.cellProperties.locale;m=d.toLocaleLowerCase(g).indexOf(o.toLocaleLowerCase(g))}m!==-1&&(h=d.length-m-c,l.push({baseIndex:p,index:m,charsLeft:h,value:d}))}for(l.sort(function(v,w){if(w.index===-1)return-1;if(v.index===-1)return 1;if(v.index<w.index)return-1;if(w.index<v.index)return 1;if(v.index===w.index){if(v.charsLeft<w.charsLeft)return-1;if(v.charsLeft>w.charsLeft)return 1}return 0}),p=0,f=l.length;p<f;p++)u.push(l[p].baseIndex);return u}),i.query=null,i.strippedChoices=[],i.rawChoices=[],RE.set(OT(i),{skipOne:!1,isMacOS:i.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),i}return z6e(r,[{key:"getValue",value:function(){var i=this,o=this.rawChoices.find(function(a){var s=i.stripValueIfNeeded(a);return s===i.TEXTAREA.value});return He(o)?o:this.TEXTAREA.value}},{key:"createElements",value:function(){au(Ua(r.prototype),"createElements",this).call(this),_e(this.htContainer,"autocompleteEditor"),_e(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var i=this,o=RE.get(this);au(Ua(r.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),s=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var l=gn();l===0&&o.isMacOS&&(l+=15),this.addHook("beforeKeyDown",function(u){return i.onBeforeKeyDown(u)}),a.updateSettings({colWidths:s?[Qt(this.TEXTAREA)-2]:void 0,width:s?Qt(this.TEXTAREA)+l:void 0,renderer:function(c,f,h,d,p,m,g){Os(c,f,h,d,p,m,g);var v=i.cellProperties,w=v.filteringCaseSensitive,b=v.allowHtml,E=v.locale,A=i.query,M=Vr(m),k,O;M&&!b&&(k=w===!0?M.indexOf(A):M.toLocaleLowerCase(E).indexOf(A.toLocaleLowerCase(E)),k!==-1&&(O=M.substr(k,A.length),M=M.replace(O,"<strong>".concat(O,"</strong>")))),f.innerHTML=M},autoColumnSize:!0}),o.skipOne&&(o.skipOne=!1),this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),au(Ua(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(i){au(Ua(r.prototype),"discardEditor",this).call(this,i),this.hot.view.render()}},{key:"queryChoices",value:function(i){var o=this,a=this.cellProperties.source;this.query=i,typeof a=="function"?a.call(this.cellProperties,i,function(s){o.rawChoices=s,o.updateChoicesList(o.stripValuesIfNeeded(s))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(i){var o=CK(this.TEXTAREA),a=Swe(this.TEXTAREA),s=this.cellProperties.sortByRelevance,l=this.cellProperties.filter,u=null,c=null,f=i;s&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),f,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(l===!1)h&&(c=u[0]);else{for(var d=[],p=0,m=f.length;p<m&&!(s&&h<=p);p++)h?d.push(f[u[p]]):d.push(f[p]);c=0,f=d}this.strippedChoices=f,this.htEditor.loadData(Vb([f])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(c),this.hot.listen(),b6(this.TEXTAREA,o,o===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var i=Ng(this.hot.view._wt.wtTable.TABLE),o=i===this.hot.rootWindow,a=this.cellProperties.preventOverflow;if(o||!o&&(a||a==="horizontal"))return!1;var s=Zr(this.TEXTAREA),l=wr(this.TEXTAREA),u=this.getDropdownHeight(),c=i.scrollTop,f=wr(this.hot.view._wt.wtTable.THEAD),h=Zr(i),d=s.top-h.top-f+c,p=i.scrollHeight-d-f-l,m=u>p&&d>p;return m?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(m?d:p,u),m}},{key:"limitDropdownIfNeeded",value:function(i,o){if(o>i){var a=0,s=0,l=0,u=null;do l=this.htEditor.getRowHeight(s)||this.htEditor.view._wt.getSetting("defaultRowHeight"),a+=l,s+=1;while(a<i);u=a-l,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+o-u,"px")),this.setDropdownHeight(a-l)}}},{key:"flipDropdown",value:function(i){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="".concat(-i,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var i=this.htEditor.getColWidth(0)+gn(this.hot.rootDocument)+2,o=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:o?void 0:i}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(i){this.htEditor.updateSettings({height:i})}},{key:"highlightBestMatchingChoice",value:function(i){typeof i=="number"?this.htEditor.selectCell(i,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var i=this.htEditor.getInstance().getRowHeight(0)||23,o=this.cellProperties.visibleRows;return this.strippedChoices.length>=o?o*i:this.strippedChoices.length*i+8}},{key:"stripValueIfNeeded",value:function(i){return this.stripValuesIfNeeded([i])[0]}},{key:"stripValuesIfNeeded",value:function(i){var o=this.cellProperties.allowHtml,a=wt(i,function(l){return Vr(l)}),s=wt(a,function(l){return o?l:ik(l)});return s}},{key:"allowKeyEventPropagation",value:function(i){var o=this.htEditor.getSelectedRangeLast(),a={row:o?o.from.row:-1},s=!1;return i===Ge.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(s=!0),i===Ge.ARROW_UP&&a.row>-1&&(s=!0),s}},{key:"onBeforeKeyDown",value:function(i){var o=this,a=RE.get(this);if(a.skipOne=!1,Xbe(i.keyCode)||i.keyCode===Ge.BACKSPACE||i.keyCode===Ge.DELETE||i.keyCode===Ge.INSERT){var s=10;if(i.keyCode===Ge.C&&(i.ctrlKey||i.metaKey))return;this.isOpened()||(s+=10),this.htEditor&&this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value),a.skipOne=!0},s)}}}],[{key:"EDITOR_TYPE",get:function(){return J6e}}]),r}(K8);function vh(t){return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vh(t)}function e5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,r5e(n.key),n)}}function t5e(t,e,r){return e&&Mk(t.prototype,e),r&&Mk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function r5e(t){var e=n5e(t,"string");return vh(e)==="symbol"?e:String(e)}function n5e(t,e){if(vh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function i5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&AT(t,e)}function AT(t,e){return AT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},AT(t,e)}function o5e(t){var e=l5e();return function(){var n=ew(t),i;if(e){var o=ew(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return a5e(this,i)}}function a5e(t,e){if(e&&(vh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return s5e(t)}function s5e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ew(t){return ew=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ew(t)}var u5e="checkbox",BK=function(t){i5e(r,t);var e=o5e(r);function r(){return e5e(this,r),e.apply(this,arguments)}return t5e(r,[{key:"beginEditing",value:function(i,o){if(o&&o.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');at(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return u5e}}]),r}(Hp),UK={exports:{}};const c5e=vz(Zoe);/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,e){(function(r,n){var i;{try{i=c5e}catch{}t.exports=n(i)}})(uh,function(r){var n=typeof r=="function",i=!!window.addEventListener,o=window.document,a=window.setTimeout,s=function(P,y,R,_){i?P.addEventListener(y,R,!!_):P.attachEvent("on"+y,R)},l=function(P,y,R,_){i?P.removeEventListener(y,R,!!_):P.detachEvent("on"+y,R)},u=function(P){return P.trim?P.trim():P.replace(/^\s+|\s+$/g,"")},c=function(P,y){return(" "+P.className+" ").indexOf(" "+y+" ")!==-1},f=function(P,y){c(P,y)||(P.className=P.className===""?y:P.className+" "+y)},h=function(P,y){P.className=u((" "+P.className+" ").replace(" "+y+" "," "))},d=function(P){return/Array/.test(Object.prototype.toString.call(P))},p=function(P){return/Date/.test(Object.prototype.toString.call(P))&&!isNaN(P.getTime())},m=function(P){var y=P.getDay();return y===0||y===6},g=function(P){return P%4===0&&P%100!==0||P%400===0},v=function(P,y){return[31,g(P)?29:28,31,30,31,30,31,31,30,31,30,31][y]},w=function(P){p(P)&&P.setHours(0,0,0,0)},b=function(P,y){return P.getTime()===y.getTime()},E=function(P,y,R){var _,$;for(_ in y)$=P[_]!==void 0,$&&typeof y[_]=="object"&&y[_]!==null&&y[_].nodeName===void 0?p(y[_])?R&&(P[_]=new Date(y[_].getTime())):d(y[_])?R&&(P[_]=y[_].slice(0)):P[_]=E({},y[_],R):(R||!$)&&(P[_]=y[_]);return P},A=function(P,y,R){var _;o.createEvent?(_=o.createEvent("HTMLEvents"),_.initEvent(y,!0,!1),_=E(_,R),P.dispatchEvent(_)):o.createEventObject&&(_=o.createEventObject(),_=E(_,R),P.fireEvent("on"+y,_))},M=function(P){return P.month<0&&(P.year-=Math.ceil(Math.abs(P.month)/12),P.month+=12),P.month>11&&(P.year+=Math.floor(Math.abs(P.month)/12),P.month-=12),P},k={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},O=function(P,y,R){for(y+=P.firstDay;y>=7;)y-=7;return R?P.i18n.weekdaysShort[y]:P.i18n.weekdays[y]},x=function(P){var y=[],R="false";if(P.isEmpty)if(P.showDaysInNextAndPreviousMonths)y.push("is-outside-current-month"),P.enableSelectionDaysInNextAndPreviousMonths||y.push("is-selection-disabled");else return'<td class="is-empty"></td>';return P.isDisabled&&y.push("is-disabled"),P.isToday&&y.push("is-today"),P.isSelected&&(y.push("is-selected"),R="true"),P.hasEvent&&y.push("has-event"),P.isInRange&&y.push("is-inrange"),P.isStartRange&&y.push("is-startrange"),P.isEndRange&&y.push("is-endrange"),'<td data-day="'+P.day+'" class="'+y.join(" ")+'" aria-selected="'+R+'"><button class="pika-button pika-day" type="button" data-pika-year="'+P.year+'" data-pika-month="'+P.month+'" data-pika-day="'+P.day+'">'+P.day+"</button></td>"},C=function(P,y){P.setHours(0,0,0,0);var R=P.getDate(),_=P.getDay(),$=y,B=$-1,W=7,ee=function(D){return(D+W-1)%W};P.setDate(R+B-ee(_));var J=new Date(P.getFullYear(),0,$),he=24*60*60*1e3,re=(P.getTime()-J.getTime())/he,T=1+Math.round((re-B+ee(J.getDay()))/W);return T},I=function(P,y,R,_){var $=new Date(R,y,P),B=n?r($).isoWeek():C($,_);return'<td class="pika-week">'+B+"</td>"},H=function(P,y,R,_){return'<tr class="pika-row'+(R?" pick-whole-week":"")+(_?" is-selected":"")+'">'+(y?P.reverse():P).join("")+"</tr>"},j=function(P){return"<tbody>"+P.join("")+"</tbody>"},q=function(P){var y,R=[];for(P.showWeekNumber&&R.push("<th></th>"),y=0;y<7;y++)R.push('<th scope="col"><abbr title="'+O(P,y)+'">'+O(P,y,!0)+"</abbr></th>");return"<thead><tr>"+(P.isRTL?R.reverse():R).join("")+"</tr></thead>"},Z=function(P,y,R,_,$,B){var W,ee,J,he=P._o,re=R===he.minYear,T=R===he.maxYear,D='<div id="'+B+'" class="pika-title" role="heading" aria-live="assertive">',z,K,le=!0,X=!0;for(J=[],W=0;W<12;W++)J.push('<option value="'+(R===$?W-y:12+W-y)+'"'+(W===_?' selected="selected"':"")+(re&&W<he.minMonth||T&&W>he.maxMonth?' disabled="disabled"':"")+">"+he.i18n.months[W]+"</option>");for(z='<div class="pika-label">'+he.i18n.months[_]+'<select class="pika-select pika-select-month" tabindex="-1">'+J.join("")+"</select></div>",d(he.yearRange)?(W=he.yearRange[0],ee=he.yearRange[1]+1):(W=R-he.yearRange,ee=1+R+he.yearRange),J=[];W<ee&&W<=he.maxYear;W++)W>=he.minYear&&J.push('<option value="'+W+'"'+(W===R?' selected="selected"':"")+">"+W+"</option>");return K='<div class="pika-label">'+R+he.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+J.join("")+"</select></div>",he.showMonthAfterYear?D+=K+z:D+=z+K,re&&(_===0||he.minMonth>=_)&&(le=!1),T&&(_===11||he.maxMonth<=_)&&(X=!1),y===0&&(D+='<button class="pika-prev'+(le?"":" is-disabled")+'" type="button">'+he.i18n.previousMonth+"</button>"),y===P._o.numberOfMonths-1&&(D+='<button class="pika-next'+(X?"":" is-disabled")+'" type="button">'+he.i18n.nextMonth+"</button>"),D+="</div>"},ne=function(P,y,R){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+R+'">'+q(P)+j(y)+"</table>"},ie=function(P){var y=this,R=y.config(P);y._onMouseDown=function($){if(!!y._v){$=$||window.event;var B=$.target||$.srcElement;if(!!B)if(c(B,"is-disabled")||(c(B,"pika-button")&&!c(B,"is-empty")&&!c(B.parentNode,"is-disabled")?(y.setDate(new Date(B.getAttribute("data-pika-year"),B.getAttribute("data-pika-month"),B.getAttribute("data-pika-day"))),R.bound&&a(function(){y.hide(),R.blurFieldOnSelect&&R.field&&R.field.blur()},100)):c(B,"pika-prev")?y.prevMonth():c(B,"pika-next")&&y.nextMonth()),c(B,"pika-select"))y._c=!0;else if($.preventDefault)$.preventDefault();else return $.returnValue=!1,!1}},y._onChange=function($){$=$||window.event;var B=$.target||$.srcElement;!B||(c(B,"pika-select-month")?y.gotoMonth(B.value):c(B,"pika-select-year")&&y.gotoYear(B.value))},y._onKeyChange=function($){if($=$||window.event,y.isVisible())switch($.keyCode){case 13:case 27:R.field&&R.field.blur();break;case 37:y.adjustDate("subtract",1);break;case 38:y.adjustDate("subtract",7);break;case 39:y.adjustDate("add",1);break;case 40:y.adjustDate("add",7);break;case 8:case 46:y.setDate(null);break}},y._parseFieldValue=function(){if(R.parse)return R.parse(R.field.value,R.format);if(n){var $=r(R.field.value,R.format,R.formatStrict);return $&&$.isValid()?$.toDate():null}else return new Date(Date.parse(R.field.value))},y._onInputChange=function($){var B;$.firedBy!==y&&(B=y._parseFieldValue(),p(B)&&y.setDate(B),y._v||y.show())},y._onInputFocus=function(){y.show()},y._onInputClick=function(){y.show()},y._onInputBlur=function(){var $=o.activeElement;do if(c($,"pika-single"))return;while($=$.parentNode);y._c||(y._b=a(function(){y.hide()},50)),y._c=!1},y._onClick=function($){$=$||window.event;var B=$.target||$.srcElement,W=B;if(!!B){!i&&c(B,"pika-select")&&(B.onchange||(B.setAttribute("onchange","return;"),s(B,"change",y._onChange)));do if(c(W,"pika-single")||W===R.trigger)return;while(W=W.parentNode);y._v&&B!==R.trigger&&W!==R.trigger&&y.hide()}},y.el=o.createElement("div"),y.el.className="pika-single"+(R.isRTL?" is-rtl":"")+(R.theme?" "+R.theme:""),s(y.el,"mousedown",y._onMouseDown,!0),s(y.el,"touchend",y._onMouseDown,!0),s(y.el,"change",y._onChange),R.keyboardInput&&s(o,"keydown",y._onKeyChange),R.field&&(R.container?R.container.appendChild(y.el):R.bound?o.body.appendChild(y.el):R.field.parentNode.insertBefore(y.el,R.field.nextSibling),s(R.field,"change",y._onInputChange),R.defaultDate||(R.defaultDate=y._parseFieldValue(),R.setDefaultDate=!0));var _=R.defaultDate;p(_)?R.setDefaultDate?y.setDate(_,!0):y.gotoDate(_):y.gotoDate(new Date),R.bound?(this.hide(),y.el.className+=" is-bound",s(R.trigger,"click",y._onInputClick),s(R.trigger,"focus",y._onInputFocus),s(R.trigger,"blur",y._onInputBlur)):this.show()};return ie.prototype={config:function(P){this._o||(this._o=E({},k,!0));var y=E(this._o,P,!0);y.isRTL=!!y.isRTL,y.field=y.field&&y.field.nodeName?y.field:null,y.theme=typeof y.theme=="string"&&y.theme?y.theme:null,y.bound=!!(y.bound!==void 0?y.field&&y.bound:y.field),y.trigger=y.trigger&&y.trigger.nodeName?y.trigger:y.field,y.disableWeekends=!!y.disableWeekends,y.disableDayFn=typeof y.disableDayFn=="function"?y.disableDayFn:null;var R=parseInt(y.numberOfMonths,10)||1;if(y.numberOfMonths=R>4?4:R,p(y.minDate)||(y.minDate=!1),p(y.maxDate)||(y.maxDate=!1),y.minDate&&y.maxDate&&y.maxDate<y.minDate&&(y.maxDate=y.minDate=!1),y.minDate&&this.setMinDate(y.minDate),y.maxDate&&this.setMaxDate(y.maxDate),d(y.yearRange)){var _=new Date().getFullYear()-10;y.yearRange[0]=parseInt(y.yearRange[0],10)||_,y.yearRange[1]=parseInt(y.yearRange[1],10)||_}else y.yearRange=Math.abs(parseInt(y.yearRange,10))||k.yearRange,y.yearRange>100&&(y.yearRange=100);return y},toString:function(P){return P=P||this._o.format,p(this._d)?this._o.toString?this._o.toString(this._d,P):n?r(this._d).format(P):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(P,y){n&&r.isMoment(P)&&this.setDate(P.toDate(),y)},getDate:function(){return p(this._d)?new Date(this._d.getTime()):null},setDate:function(P,y){if(!P)return this._d=null,this._o.field&&(this._o.field.value="",A(this._o.field,"change",{firedBy:this})),this.draw();if(typeof P=="string"&&(P=new Date(Date.parse(P))),!!p(P)){var R=this._o.minDate,_=this._o.maxDate;p(R)&&P<R?P=R:p(_)&&P>_&&(P=_),this._d=new Date(P.getTime()),w(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),A(this._o.field,"change",{firedBy:this})),!y&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(P){var y=!0;if(!!p(P)){if(this.calendars){var R=new Date(this.calendars[0].year,this.calendars[0].month,1),_=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),$=P.getTime();_.setMonth(_.getMonth()+1),_.setDate(_.getDate()-1),y=$<R.getTime()||_.getTime()<$}y&&(this.calendars=[{month:P.getMonth(),year:P.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(P,y){var R=this.getDate()||new Date,_=parseInt(y)*24*60*60*1e3,$;P==="add"?$=new Date(R.valueOf()+_):P==="subtract"&&($=new Date(R.valueOf()-_)),this.setDate($)},adjustCalendars:function(){this.calendars[0]=M(this.calendars[0]);for(var P=1;P<this._o.numberOfMonths;P++)this.calendars[P]=M({month:this.calendars[0].month+P,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(P){isNaN(P)||(this.calendars[0].month=parseInt(P,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(P){isNaN(P)||(this.calendars[0].year=parseInt(P,10),this.adjustCalendars())},setMinDate:function(P){P instanceof Date?(w(P),this._o.minDate=P,this._o.minYear=P.getFullYear(),this._o.minMonth=P.getMonth()):(this._o.minDate=k.minDate,this._o.minYear=k.minYear,this._o.minMonth=k.minMonth,this._o.startRange=k.startRange),this.draw()},setMaxDate:function(P){P instanceof Date?(w(P),this._o.maxDate=P,this._o.maxYear=P.getFullYear(),this._o.maxMonth=P.getMonth()):(this._o.maxDate=k.maxDate,this._o.maxYear=k.maxYear,this._o.maxMonth=k.maxMonth,this._o.endRange=k.endRange),this.draw()},setStartRange:function(P){this._o.startRange=P},setEndRange:function(P){this._o.endRange=P},draw:function(P){if(!(!this._v&&!P)){var y=this._o,R=y.minYear,_=y.maxYear,$=y.minMonth,B=y.maxMonth,W="",ee;this._y<=R&&(this._y=R,!isNaN($)&&this._m<$&&(this._m=$)),this._y>=_&&(this._y=_,!isNaN(B)&&this._m>B&&(this._m=B));for(var J=0;J<y.numberOfMonths;J++)ee="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),W+='<div class="pika-lendar">'+Z(this,J,this.calendars[J].year,this.calendars[J].month,this.calendars[0].year,ee)+this.render(this.calendars[J].year,this.calendars[J].month,ee)+"</div>";this.el.innerHTML=W,y.bound&&y.field.type!=="hidden"&&a(function(){y.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),y.bound&&y.field.setAttribute("aria-label",y.ariaLabel)}},adjustPosition:function(){var P,y,R,_,$,B,W,ee,J,he,re,T;if(!this._o.container){if(this.el.style.position="absolute",P=this._o.trigger,y=P,R=this.el.offsetWidth,_=this.el.offsetHeight,$=window.innerWidth||o.documentElement.clientWidth,B=window.innerHeight||o.documentElement.clientHeight,W=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,re=!0,T=!0,typeof P.getBoundingClientRect=="function")he=P.getBoundingClientRect(),ee=he.left+window.pageXOffset,J=he.bottom+window.pageYOffset;else for(ee=y.offsetLeft,J=y.offsetTop+y.offsetHeight;y=y.offsetParent;)ee+=y.offsetLeft,J+=y.offsetTop;(this._o.reposition&&ee+R>$||this._o.position.indexOf("right")>-1&&ee-R+P.offsetWidth>0)&&(ee=ee-R+P.offsetWidth,re=!1),(this._o.reposition&&J+_>B+W||this._o.position.indexOf("top")>-1&&J-_-P.offsetHeight>0)&&(J=J-_-P.offsetHeight,T=!1),this.el.style.left=ee+"px",this.el.style.top=J+"px",f(this.el,re?"left-aligned":"right-aligned"),f(this.el,T?"bottom-aligned":"top-aligned"),h(this.el,re?"right-aligned":"left-aligned"),h(this.el,T?"top-aligned":"bottom-aligned")}},render:function(P,y,R){var _=this._o,$=new Date,B=v(P,y),W=new Date(P,y,1).getDay(),ee=[],J=[];w($),_.firstDay>0&&(W-=_.firstDay,W<0&&(W+=7));for(var he=y===0?11:y-1,re=y===11?0:y+1,T=y===0?P-1:P,D=y===11?P+1:P,z=v(T,he),K=B+W,le=K;le>7;)le-=7;K+=7-le;for(var X=!1,we=0,Ce=0;we<K;we++){var Ee=new Date(P,y,1+(we-W)),Te=p(this._d)?b(Ee,this._d):!1,Oe=b(Ee,$),F=_.events.indexOf(Ee.toDateString())!==-1,U=we<W||we>=B+W,Y=1+(we-W),fe=y,oe=P,pe=_.startRange&&b(_.startRange,Ee),ue=_.endRange&&b(_.endRange,Ee),se=_.startRange&&_.endRange&&_.startRange<Ee&&Ee<_.endRange,me=_.minDate&&Ee<_.minDate||_.maxDate&&Ee>_.maxDate||_.disableWeekends&&m(Ee)||_.disableDayFn&&_.disableDayFn(Ee);U&&(we<W?(Y=z+Y,fe=he,oe=T):(Y=Y-B,fe=re,oe=D));var te={day:Y,month:fe,year:oe,hasEvent:F,isSelected:Te,isToday:Oe,isDisabled:me,isEmpty:U,isStartRange:pe,isEndRange:ue,isInRange:se,showDaysInNextAndPreviousMonths:_.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:_.enableSelectionDaysInNextAndPreviousMonths};_.pickWholeWeek&&Te&&(X=!0),J.push(x(te)),++Ce===7&&(_.showWeekNumber&&J.unshift(I(we-W,y,P,_.firstWeekOfYearMinDays)),ee.push(H(J,_.isRTL,_.pickWholeWeek,X)),J=[],Ce=0,X=!1)}return ne(_,ee,R)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(s(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var P=this._v;P!==!1&&(this._o.bound&&l(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),f(this.el,"is-hidden"),this._v=!1,P!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var P=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),P.keyboardInput&&l(o,"keydown",this._onKeyChange),P.field&&(l(P.field,"change",this._onInputChange),P.bound&&(l(P.trigger,"click",this._onInputClick),l(P.trigger,"focus",this._onInputFocus),l(P.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},ie})})(UK);const Nk=UK.exports;function bh(t){return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bh(t)}function f5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,d5e(n.key),n)}}function h5e(t,e,r){return e&&Pk(t.prototype,e),r&&Pk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function d5e(t){var e=p5e(t,"string");return bh(e)==="symbol"?e:String(e)}function p5e(t,e){if(bh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Da(){return typeof Reflect<"u"&&Reflect.get?Da=Reflect.get.bind():Da=function(e,r,n){var i=m5e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Da.apply(this,arguments)}function m5e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=wo(t),t!==null););return t}function g5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&IT(t,e)}function IT(t,e){return IT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},IT(t,e)}function y5e(t){var e=w5e();return function(){var n=wo(t),i;if(e){var o=wo(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return v5e(this,i)}}function v5e(t,e){if(e&&(bh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return b5e(t)}function b5e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wo(t){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wo(t)}var VK="date",kk="dateEditor",jK=function(t){g5e(r,t);var e=y5e(r);function r(n){var i;return f5e(this,r),i=e.call(this,n),i.defaultDateFormat="DD/MM/YYYY",i.isCellEdited=!1,i.parentDestroyed=!1,i.$datePicker=null,i}return h5e(r,[{key:"init",value:function(){var i=this;if(typeof qt!="function")throw new Error("You need to include moment.js to your project.");if(typeof Nk!="function")throw new Error("You need to include Pikaday to your project.");Da(wo(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){i.parentDestroyed=!0,i.destroyElements()})}},{key:"createElements",value:function(){Da(wo(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),_e(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var i=new Er(this);i.addEventListener(this.datePicker,"mousedown",function(o){return o.stopPropagation()})}},{key:"destroyElements",value:function(){var i=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),i&&i.removeChild(this.datePicker)}},{key:"prepare",value:function(i,o,a,s,l,u){Da(wo(r.prototype),"prepare",this).call(this,i,o,a,s,l,u)}},{key:"open",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=this.hot.getShortcutManager(),a=o.getContext("editor");Da(wo(r.prototype),"open",this).call(this),this.showDatepicker(i),a.addShortcut({keys:[["Enter"]],callback:function(l){l.stopPropagation()},group:kk})}},{key:"close",value:function(){var i,o=this;this._opened=!1,(i=this.$datePicker)!==null&&i!==void 0&&i.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){o.instance._refreshBorders()});var a=this.hot.getShortcutManager(),s=a.getContext("editor");s.removeShortcutsByGroup(kk),Da(wo(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(i){var a=this.originalValue;a!==void 0&&this.setValue(a)}Da(wo(r.prototype),"finishEditing",this).call(this,i,o)}},{key:"showDatepicker",value:function(i){var o=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,s=this.instance.view.isMouseDown(),l=i?fK(i.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new Nk(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+o.top+wr(this.TD),"px");var c=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?c=o.right-Qt(this.datePicker):c=o.left,this.datePickerStyle.left="".concat(c,"px"),this.originalValue?(u=this.originalValue,qt(u,a,!0).isValid()&&this.$datePicker.setMoment(qt(u,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!l&&!s&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,qt(u,a,!0).isValid()&&this.$datePicker.setMoment(qt(u,a),!0),!l&&!s&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var i=this,o=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&v6(a,this.cellProperties.datePickerConfig);var s=a.onSelect,l=a.onClose;return a.field=o,a.trigger=o,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.isRTL=!1,a.onSelect=function(u){var c=u;isNaN(c.getTime())||(c=qt(c).format(i.cellProperties.dateFormat||i.defaultDateFormat)),i.setValue(c),i.hideDatepicker(),s&&s()},a.onClose=function(){i.parentDestroyed||i.finishEditing(!1),l&&l()},a}}],[{key:"EDITOR_TYPE",get:function(){return VK}}]),r}(_c);function wh(t){return wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wh(t)}function S5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $k(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,E5e(n.key),n)}}function R5e(t,e,r){return e&&$k(t.prototype,e),r&&$k(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function E5e(t){var e=C5e(t,"string");return wh(e)==="symbol"?e:String(e)}function C5e(t,e){if(wh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gb(){return typeof Reflect<"u"&&Reflect.get?Gb=Reflect.get.bind():Gb=function(e,r,n){var i=_5e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Gb.apply(this,arguments)}function _5e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Sh(t),t!==null););return t}function T5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xT(t,e)}function xT(t,e){return xT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},xT(t,e)}function O5e(t){var e=x5e();return function(){var n=Sh(t),i;if(e){var o=Sh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return A5e(this,i)}}function A5e(t,e){if(e&&(wh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return I5e(t)}function I5e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function x5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sh(t){return Sh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sh(t)}var M5e="dropdown",X8=function(t){T5e(r,t);var e=O5e(r);function r(){return S5e(this,r),e.apply(this,arguments)}return R5e(r,[{key:"prepare",value:function(i,o,a,s,l,u){Gb(Sh(r.prototype),"prepare",this).call(this,i,o,a,s,l,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return M5e}}]),r}(q8);Ue.getSingleton().add("beforeValidate",function(t,e,r){var n=this.getCellMeta(e,this.propToCol(r));n.editor===X8&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function Rh(t){return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rh(t)}function N5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,k5e(n.key),n)}}function P5e(t,e,r){return e&&Lk(t.prototype,e),r&&Lk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function k5e(t){var e=$5e(t,"string");return Rh(e)==="symbol"?e:String(e)}function $5e(t,e){if(Rh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function L5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&MT(t,e)}function MT(t,e){return MT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},MT(t,e)}function D5e(t){var e=B5e();return function(){var n=tw(t),i;if(e){var o=tw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return F5e(this,i)}}function F5e(t,e){if(e&&(Rh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return H5e(t)}function H5e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function B5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tw(t){return tw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tw(t)}var U5e="numeric",WK=function(t){L5e(r,t);var e=D5e(r);function r(){return N5e(this,r),e.apply(this,arguments)}return P5e(r,null,[{key:"EDITOR_TYPE",get:function(){return U5e}}]),r}(_c);function Eh(t){return Eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Eh(t)}function V5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,W5e(n.key),n)}}function j5e(t,e,r){return e&&Dk(t.prototype,e),r&&Dk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function W5e(t){var e=z5e(t,"string");return Eh(e)==="symbol"?e:String(e)}function z5e(t,e){if(Eh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yb(){return typeof Reflect<"u"&&Reflect.get?Yb=Reflect.get.bind():Yb=function(e,r,n){var i=G5e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Yb.apply(this,arguments)}function G5e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ch(t),t!==null););return t}function Y5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&NT(t,e)}function NT(t,e){return NT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},NT(t,e)}function K5e(t){var e=Q5e();return function(){var n=Ch(t),i;if(e){var o=Ch(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return q5e(this,i)}}function q5e(t,e){if(e&&(Eh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return X5e(t)}function X5e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Q5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ch(t){return Ch=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ch(t)}var Z5e="password",zK=function(t){Y5e(r,t);var e=K5e(r);function r(){return V5e(this,r),e.apply(this,arguments)}return j5e(r,[{key:"createElements",value:function(){Yb(Ch(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,ua(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return Z5e}}]),r}(_c);function Xu(t){return Xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xu(t)}function J5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tRe(n.key),n)}}function eRe(t,e,r){return e&&Fk(t.prototype,e),r&&Fk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function tRe(t){var e=rRe(t,"string");return Xu(e)==="symbol"?e:String(e)}function rRe(t,e){if(Xu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Xu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kb(){return typeof Reflect<"u"&&Reflect.get?Kb=Reflect.get.bind():Kb=function(e,r,n){var i=nRe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Kb.apply(this,arguments)}function nRe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=_h(t),t!==null););return t}function iRe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&PT(t,e)}function PT(t,e){return PT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},PT(t,e)}function oRe(t){var e=lRe();return function(){var n=_h(t),i;if(e){var o=_h(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return aRe(this,i)}}function aRe(t,e){if(e&&(Xu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sRe(t)}function sRe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _h(t){return _h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_h(t)}var EE="ht_editor_visible",Hk="selectEditor",uRe="select",cRe=function(t){iRe(r,t);var e=oRe(r);function r(){return J5e(this,r),e.apply(this,arguments)}return eRe(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),_e(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(i){this.select.value=i}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",at(this.select,EE)&&ut(this.select,EE),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var i=this;this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){return i.refreshDimensions()}),this.addHook("afterRowResize",function(){return i.refreshDimensions()})}},{key:"prepare",value:function(i,o,a,s,l,u){var c=this;Kb(_h(r.prototype),"prepare",this).call(this,i,o,a,s,l,u);var f=this.cellProperties.selectOptions,h;typeof f=="function"?h=this.prepareOptions(f(this.row,this.col,this.prop)):h=this.prepareOptions(f),ua(this.select),Rt(h,function(d,p){var m=c.hot.rootDocument.createElement("OPTION");m.value=p,Fp(m,d),c.select.appendChild(m)})}},{key:"prepareOptions",value:function(i){var o={};if(Array.isArray(i))for(var a=0,s=i.length;a<s;a++)o[i[a]]=i[a];else Xu(i)==="object"&&(o=i);return o}},{key:"refreshValue",value:function(){var i=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===cn.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var i=this.getEditedCellRect(),o=i.top,a=i.start,s=i.width,l=i.height,u=this.select.style;u.height="".concat(l,"px"),u.width="".concat(s,"px"),u.top="".concat(o,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),u.margin="0px",_e(this.select,EE)}}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),a=o.getContext("editor"),s={group:Hk};this.isInFullEditMode()!==!1&&a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=i.select.selectedIndex-1;u>=0&&(i.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=i.select.selectedIndex+1;u<=i.select.length-1&&(i.select[u].selected=!0)}}],s)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup(Hk)}}],[{key:"EDITOR_TYPE",get:function(){return uRe}}]),r}(Hp);function Th(t){return Th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Th(t)}function fRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dRe(n.key),n)}}function hRe(t,e,r){return e&&Bk(t.prototype,e),r&&Bk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dRe(t){var e=pRe(t,"string");return Th(e)==="symbol"?e:String(e)}function pRe(t,e){if(Th(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qb(){return typeof Reflect<"u"&&Reflect.get?qb=Reflect.get.bind():qb=function(e,r,n){var i=mRe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},qb.apply(this,arguments)}function mRe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Oh(t),t!==null););return t}function gRe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kT(t,e)}function kT(t,e){return kT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kT(t,e)}function yRe(t){var e=wRe();return function(){var n=Oh(t),i;if(e){var o=Oh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return vRe(this,i)}}function vRe(t,e){if(e&&(Th(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bRe(t)}function bRe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oh(t){return Oh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Oh(t)}var SRe="time",GK=function(t){gRe(r,t);var e=yRe(r);function r(){return fRe(this,r),e.apply(this,arguments)}return hRe(r,[{key:"prepare",value:function(i,o,a,s,l,u){qb(Oh(r.prototype),"prepare",this).call(this,i,o,a,s,l,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return SRe}}]),r}(_c);function RRe(){Ti(Hp),Ti(q8),Ti(BK),Ti(jK),Ti(X8),Ti(K8),Ti(WK),Ti(zK),Ti(cRe),Ti(_c),Ti(GK)}var ERe="html";function Q8(t,e,r,n,i,o,a){A1.apply(this,[t,e,r,n,i,o,a]),Fp(e,o==null?"":o,!1)}Q8.RENDERER_TYPE=ERe;var CRe="autocomplete";function Bp(t,e,r,n,i,o,a){var s=t.rootDocument,l=a.allowHtml?Q8:Os,u=s.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(s.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,r,n,i,o,a]),e.firstChild||e.appendChild(s.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),_e(e,"htAutocomplete"),!t.acArrowListener){var c=new Er(t);t.acArrowListener=function(f){at(f.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(r,n),e)},c.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",function(){c.destroy()})}}Bp.RENDERER_TYPE=CRe;var Uk=new WeakMap,Vk=new WeakMap,_Re="htBadValue",Ah="data-row",Ih="data-col",TRe="checkboxRenderer",YK="checkbox";Ue.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,r){var n=e.label,i=e.type,o=e.row,a=e.column,s=e.prop;if(i===YK){if(n){var l=n.value,u=n.property,c=r;if(l)c=typeof l=="function"?l(o,a,s,r):l;else if(u){var f=this.getDataAtRowProp(o,u);c=f!==null?f:r}t=c}return t}});function Z8(t,e,r,n,i,o,a){var s=t.rootDocument;A1.apply(this,[t,e,r,n,i,o,a]),ORe(t);var l=ARe(s),u=a.label,c=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),ua(e),o===a.checkedTemplate||Vr(o).toLocaleLowerCase(a.locale)===Vr(a.checkedTemplate).toLocaleLowerCase(a.locale)?l.checked=!0:o===a.uncheckedTemplate||Vr(o).toLocaleLowerCase(a.locale)===Vr(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?l.checked=!1:on(o)?_e(l,"noValue"):(l.style.display="none",_e(l,_Re),c=!0),l.setAttribute(Ah,r),l.setAttribute(Ih,n),!c&&u){var f="";if(u.value)f=typeof u.value=="function"?u.value.call(this,r,n,i,o):u.value;else if(u.property){var h=t.getDataAtRowProp(r,u.property);f=h!==null?h:""}var d=IRe(s,f,u.separated!==!0);u.position==="before"?u.separated?(e.appendChild(d),e.appendChild(l)):(d.appendChild(l),l=d):(!u.position||u.position==="after")&&(u.separated?(e.appendChild(l),e.appendChild(d)):(d.insertBefore(l,d.firstChild),l=d))}(!u||u&&!u.separated)&&e.appendChild(l),c&&e.appendChild(s.createTextNode("#bad-value#")),Uk.has(t)||(Uk.set(t,!0),p());function p(){var v=t.getShortcutManager(),w=v.getContext("grid"),b={group:TRe};w.addShortcuts([{keys:[["space"]],callback:function(){return m(),!g()}},{keys:[["enter"]],callback:function(){return m(),!g()},runOnlyIf:function(){return t.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return m(!0),!g()},relativeToGroup:Qm,position:"before"}],b)}function m(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=t.getSelectedRange();if(!!w)for(var b=0;b<w.length;b++){for(var E=w[b].getTopStartCorner(),A=E.row,M=E.col,k=w[b].getBottomEndCorner(),O=k.row,x=k.col,C=[],I=A;I<=O;I+=1)for(var H=M;H<=x;H+=1){var j=t.getCellMeta(I,H);if(j.type!=="checkbox")return;if(j.readOnly!==!0){typeof j.checkedTemplate>"u"&&(j.checkedTemplate=!0),typeof j.uncheckedTemplate>"u"&&(j.uncheckedTemplate=!1);var q=t.getDataAtCell(I,H);v===!1?[j.checkedTemplate,j.checkedTemplate.toString()].includes(q)?C.push([I,H,j.uncheckedTemplate]):[j.uncheckedTemplate,j.uncheckedTemplate.toString(),null,void 0].includes(q)&&C.push([I,H,j.checkedTemplate]):C.push([I,H,j.uncheckedTemplate])}}C.length>0&&t.setDataAtCell(C)}}function g(){var v=t.getSelectedRange();if(!!v){for(var w=0;w<v.length;w++)for(var b=v[w].getTopStartCorner(),E=v[w].getBottomEndCorner(),A=b.row;A<=E.row;A++)for(var M=b.col;M<=E.col;M++){var k=t.getCellMeta(A,M);if(k.type!=="checkbox")return!1;var O=t.getCell(A,M);if(O==null)return!0;var x=O.querySelectorAll("input[type=checkbox]");if(x.length>0&&!k.readOnly)return!0}return!1}}}Z8.RENDERER_TYPE=YK;function ORe(t){var e=Vk.get(t);if(!e){var r=t.rootElement;e=new Er(t),e.addEventListener(r,"click",function(n){return MRe(n,t)}),e.addEventListener(r,"mouseup",function(n){return xRe(n,t)}),e.addEventListener(r,"change",function(n){return NRe(n,t)}),Vk.set(t,e)}return e}function ARe(t){var e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function IRe(t,e,r){var n=t.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(t.createTextNode(e)),n.cloneNode(!0)}function xRe(t,e){var r=t.target;!J8(r)||!r.hasAttribute(Ah)||!r.hasAttribute(Ih)||setTimeout(e.listen,10)}function MRe(t,e){var r=t.target;if(!!J8(r)&&!(!r.hasAttribute(Ah)||!r.hasAttribute(Ih))){var n=parseInt(r.getAttribute(Ah),10),i=parseInt(r.getAttribute(Ih),10),o=e.getCellMeta(n,i);o.readOnly&&t.preventDefault()}}function NRe(t,e){var r=t.target;if(!!J8(r)&&!(!r.hasAttribute(Ah)||!r.hasAttribute(Ih))){var n=parseInt(r.getAttribute(Ah),10),i=parseInt(r.getAttribute(Ih),10),o=e.getCellMeta(n,i);if(!o.readOnly){var a=null;t.target.checked?a=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:a=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(n,i,a)}}}function J8(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}var KK={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(){return function r(n,i,o){function a(u,c){if(!i[u]){if(!n[u]){var f=typeof Ws=="function"&&Ws;if(!c&&f)return f(u,!0);if(s)return s(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=i[u]={exports:{}};n[u][0].call(d.exports,function(p){return a(n[u][1][p]||p)},d,d.exports,r,n,i,o)}return i[u].exports}for(var s=typeof Ws=="function"&&Ws,l=0;l<o.length;l++)a(o[l]);return a}({1:[function(r,n,i){(function(o){var a,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",f=c+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,p=9007199254740991,m=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],g=1e7,v=1e9;function w(x){var C=0|x;return 0<x||x===C?C:C-1}function b(x){for(var C,I,H=1,j=x.length,q=x[0]+"";H<j;){for(C=x[H++]+"",I=d-C.length;I--;C="0"+C);q+=C}for(j=q.length;q.charCodeAt(--j)===48;);return q.slice(0,j+1||1)}function E(x,C){var I,H,j=x.c,q=C.c,Z=x.s,ne=C.s,ie=x.e,P=C.e;if(!Z||!ne)return null;if(I=j&&!j[0],H=q&&!q[0],I||H)return I?H?0:-ne:Z;if(Z!=ne)return Z;if(I=Z<0,H=ie==P,!j||!q)return H?0:!j^I?1:-1;if(!H)return P<ie^I?1:-1;for(ne=(ie=j.length)<(P=q.length)?ie:P,Z=0;Z<ne;Z++)if(j[Z]!=q[Z])return j[Z]>q[Z]^I?1:-1;return ie==P?0:P<ie^I?1:-1}function A(x,C,I,H){if(x<C||I<x||x!==(x<0?l(x):u(x)))throw Error(c+(H||"Argument")+(typeof x=="number"?x<C||I<x?" out of range: ":" not an integer: ":" not a primitive number: ")+String(x))}function M(x){var C=x.c.length-1;return w(x.e/d)==C&&x.c[C]%2!=0}function k(x,C){return(1<x.length?x.charAt(0)+"."+x.slice(1):x)+(C<0?"e":"e+")+C}function O(x,C,I){var H,j;if(C<0){for(j=I+".";++C;j+=I);x=j+x}else if(++C>(H=x.length)){for(j=I,C-=H;--C;j+=I);x+=j}else C<H&&(x=x.slice(0,C)+"."+x.slice(C));return x}(a=function x(C){var I,H,j,q,Z,ne,ie,P,y,R,_=X.prototype={constructor:X,toString:null,valueOf:null},$=new X(1),B=20,W=4,ee=-7,J=21,he=-1e7,re=1e7,T=!1,D=1,z=0,K={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},le="0123456789abcdefghijklmnopqrstuvwxyz";function X(F,U){var Y,fe,oe,pe,ue,se,me,te,de=this;if(!(de instanceof X))return new X(F,U);if(U==null){if(F instanceof X)return de.s=F.s,de.e=F.e,void(de.c=(F=F.c)?F.slice():F);if((se=typeof F=="number")&&0*F==0){if(de.s=1/F<0?(F=-F,-1):1,F===~~F){for(pe=0,ue=F;10<=ue;ue/=10,pe++);return de.e=pe,void(de.c=[F])}te=String(F)}else{if(te=String(F),!s.test(te))return j(de,te,se);de.s=te.charCodeAt(0)==45?(te=te.slice(1),-1):1}-1<(pe=te.indexOf("."))&&(te=te.replace(".","")),0<(ue=te.search(/e/i))?(pe<0&&(pe=ue),pe+=+te.slice(ue+1),te=te.substring(0,ue)):pe<0&&(pe=te.length)}else{if(A(U,2,le.length,"Base"),te=String(F),U==10)return Te(de=new X(F instanceof X?F:te),B+de.e+1,W);if(se=typeof F=="number"){if(0*F!=0)return j(de,te,se,U);if(de.s=1/F<0?(te=te.slice(1),-1):1,X.DEBUG&&15<te.replace(/^0\.0*|\./,"").length)throw Error(f+F);se=!1}else de.s=te.charCodeAt(0)===45?(te=te.slice(1),-1):1;for(Y=le.slice(0,U),pe=ue=0,me=te.length;ue<me;ue++)if(Y.indexOf(fe=te.charAt(ue))<0){if(fe=="."){if(pe<ue){pe=me;continue}}else if(!oe&&(te==te.toUpperCase()&&(te=te.toLowerCase())||te==te.toLowerCase()&&(te=te.toUpperCase()))){oe=!0,ue=-1,pe=0;continue}return j(de,String(F),se,U)}-1<(pe=(te=H(te,U,10,de.s)).indexOf("."))?te=te.replace(".",""):pe=te.length}for(ue=0;te.charCodeAt(ue)===48;ue++);for(me=te.length;te.charCodeAt(--me)===48;);if(te=te.slice(ue,++me)){if(me-=ue,se&&X.DEBUG&&15<me&&(p<F||F!==u(F)))throw Error(f+de.s*F);if(re<(pe=pe-ue-1))de.c=de.e=null;else if(pe<he)de.c=[de.e=0];else{if(de.e=pe,de.c=[],ue=(pe+1)%d,pe<0&&(ue+=d),ue<me){for(ue&&de.c.push(+te.slice(0,ue)),me-=d;ue<me;)de.c.push(+te.slice(ue,ue+=d));te=te.slice(ue),ue=d-te.length}else ue-=me;for(;ue--;te+="0");de.c.push(+te)}}else de.c=[de.e=0]}function we(F,U,Y,fe){var oe,pe,ue,se,me;if(Y==null?Y=W:A(Y,0,8),!F.c)return F.toString();if(oe=F.c[0],ue=F.e,U==null)me=b(F.c),me=fe==1||fe==2&&(ue<=ee||J<=ue)?k(me,ue):O(me,ue,"0");else if(pe=(F=Te(new X(F),U,Y)).e,se=(me=b(F.c)).length,fe==1||fe==2&&(U<=pe||pe<=ee)){for(;se<U;me+="0",se++);me=k(me,pe)}else if(U-=ue,me=O(me,pe,"0"),se<pe+1){if(0<--U)for(me+=".";U--;me+="0");}else if(0<(U+=pe-se))for(pe+1==se&&(me+=".");U--;me+="0");return F.s<0&&oe?"-"+me:me}function Ce(F,U){for(var Y,fe=1,oe=new X(F[0]);fe<F.length;fe++){if(!(Y=new X(F[fe])).s){oe=Y;break}U.call(oe,Y)&&(oe=Y)}return oe}function Ee(F,U,Y){for(var fe=1,oe=U.length;!U[--oe];U.pop());for(oe=U[0];10<=oe;oe/=10,fe++);return(Y=fe+Y*d-1)>re?F.c=F.e=null:F.c=Y<he?[F.e=0]:(F.e=Y,U),F}function Te(F,U,Y,fe){var oe,pe,ue,se,me,te,de,Se=F.c,Re=m;if(Se){e:{for(oe=1,se=Se[0];10<=se;se/=10,oe++);if((pe=U-oe)<0)pe+=d,ue=U,de=(me=Se[te=0])/Re[oe-ue-1]%10|0;else if((te=l((pe+1)/d))>=Se.length){if(!fe)break e;for(;Se.length<=te;Se.push(0));me=de=0,ue=(pe%=d)-d+(oe=1)}else{for(me=se=Se[te],oe=1;10<=se;se/=10,oe++);de=(ue=(pe%=d)-d+oe)<0?0:me/Re[oe-ue-1]%10|0}if(fe=fe||U<0||Se[te+1]!=null||(ue<0?me:me%Re[oe-ue-1]),fe=Y<4?(de||fe)&&(Y==0||Y==(F.s<0?3:2)):5<de||de==5&&(Y==4||fe||Y==6&&(0<pe?0<ue?me/Re[oe-ue]:0:Se[te-1])%10&1||Y==(F.s<0?8:7)),U<1||!Se[0])return Se.length=0,fe?(U-=F.e+1,Se[0]=Re[(d-U%d)%d],F.e=-U||0):Se[0]=F.e=0,F;if(pe==0?(Se.length=te,se=1,te--):(Se.length=te+1,se=Re[d-pe],Se[te]=0<ue?u(me/Re[oe-ue]%Re[ue])*se:0),fe)for(;;){if(te==0){for(pe=1,ue=Se[0];10<=ue;ue/=10,pe++);for(ue=Se[0]+=se,se=1;10<=ue;ue/=10,se++);pe!=se&&(F.e++,Se[0]==h&&(Se[0]=1));break}if(Se[te]+=se,Se[te]!=h)break;Se[te--]=0,se=1}for(pe=Se.length;Se[--pe]===0;Se.pop());}F.e>re?F.c=F.e=null:F.e<he&&(F.c=[F.e=0])}return F}function Oe(F){var U,Y=F.e;return Y===null?F.toString():(U=b(F.c),U=Y<=ee||J<=Y?k(U,Y):O(U,Y,"0"),F.s<0?"-"+U:U)}return X.clone=x,X.ROUND_UP=0,X.ROUND_DOWN=1,X.ROUND_CEIL=2,X.ROUND_FLOOR=3,X.ROUND_HALF_UP=4,X.ROUND_HALF_DOWN=5,X.ROUND_HALF_EVEN=6,X.ROUND_HALF_CEIL=7,X.ROUND_HALF_FLOOR=8,X.EUCLID=9,X.config=X.set=function(F){var U,Y;if(F!=null){if(typeof F!="object")throw Error(c+"Object expected: "+F);if(F.hasOwnProperty(U="DECIMAL_PLACES")&&(A(Y=F[U],0,v,U),B=Y),F.hasOwnProperty(U="ROUNDING_MODE")&&(A(Y=F[U],0,8,U),W=Y),F.hasOwnProperty(U="EXPONENTIAL_AT")&&((Y=F[U])&&Y.pop?(A(Y[0],-v,0,U),A(Y[1],0,v,U),ee=Y[0],J=Y[1]):(A(Y,-v,v,U),ee=-(J=Y<0?-Y:Y))),F.hasOwnProperty(U="RANGE"))if((Y=F[U])&&Y.pop)A(Y[0],-v,-1,U),A(Y[1],1,v,U),he=Y[0],re=Y[1];else{if(A(Y,-v,v,U),!Y)throw Error(c+U+" cannot be zero: "+Y);he=-(re=Y<0?-Y:Y)}if(F.hasOwnProperty(U="CRYPTO")){if((Y=F[U])!==!!Y)throw Error(c+U+" not true or false: "+Y);if(Y){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw T=!Y,Error(c+"crypto unavailable");T=Y}else T=Y}if(F.hasOwnProperty(U="MODULO_MODE")&&(A(Y=F[U],0,9,U),D=Y),F.hasOwnProperty(U="POW_PRECISION")&&(A(Y=F[U],0,v,U),z=Y),F.hasOwnProperty(U="FORMAT")){if(typeof(Y=F[U])!="object")throw Error(c+U+" not an object: "+Y);K=Y}if(F.hasOwnProperty(U="ALPHABET")){if(typeof(Y=F[U])!="string"||/^.$|[+-.\s]|(.).*\1/.test(Y))throw Error(c+U+" invalid: "+Y);le=Y}}return{DECIMAL_PLACES:B,ROUNDING_MODE:W,EXPONENTIAL_AT:[ee,J],RANGE:[he,re],CRYPTO:T,MODULO_MODE:D,POW_PRECISION:z,FORMAT:K,ALPHABET:le}},X.isBigNumber=function(F){return F instanceof X||F&&F._isBigNumber===!0||!1},X.maximum=X.max=function(){return Ce(arguments,_.lt)},X.minimum=X.min=function(){return Ce(arguments,_.gt)},X.random=(q=9007199254740992,Z=Math.random()*q&2097151?function(){return u(Math.random()*q)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(F){var U,Y,fe,oe,pe,ue=0,se=[],me=new X($);if(F==null?F=B:A(F,0,v),oe=l(F/d),T)if(crypto.getRandomValues){for(U=crypto.getRandomValues(new Uint32Array(oe*=2));ue<oe;)9e15<=(pe=131072*U[ue]+(U[ue+1]>>>11))?(Y=crypto.getRandomValues(new Uint32Array(2)),U[ue]=Y[0],U[ue+1]=Y[1]):(se.push(pe%1e14),ue+=2);ue=oe/2}else{if(!crypto.randomBytes)throw T=!1,Error(c+"crypto unavailable");for(U=crypto.randomBytes(oe*=7);ue<oe;)9e15<=(pe=281474976710656*(31&U[ue])+1099511627776*U[ue+1]+4294967296*U[ue+2]+16777216*U[ue+3]+(U[ue+4]<<16)+(U[ue+5]<<8)+U[ue+6])?crypto.randomBytes(7).copy(U,ue):(se.push(pe%1e14),ue+=7);ue=oe/7}if(!T)for(;ue<oe;)(pe=Z())<9e15&&(se[ue++]=pe%1e14);for(oe=se[--ue],F%=d,oe&&F&&(pe=m[d-F],se[ue]=u(oe/pe)*pe);se[ue]===0;se.pop(),ue--);if(ue<0)se=[fe=0];else{for(fe=-1;se[0]===0;se.splice(0,1),fe-=d);for(ue=1,pe=se[0];10<=pe;pe/=10,ue++);ue<d&&(fe-=d-ue)}return me.e=fe,me.c=se,me}),X.sum=function(){for(var F=1,U=arguments,Y=new X(U[0]);F<U.length;)Y=Y.plus(U[F++]);return Y},H=function(){var F="0123456789";function U(Y,fe,oe,pe){for(var ue,se,me=[0],te=0,de=Y.length;te<de;){for(se=me.length;se--;me[se]*=fe);for(me[0]+=pe.indexOf(Y.charAt(te++)),ue=0;ue<me.length;ue++)me[ue]>oe-1&&(me[ue+1]==null&&(me[ue+1]=0),me[ue+1]+=me[ue]/oe|0,me[ue]%=oe)}return me.reverse()}return function(Y,fe,oe,pe,ue){var se,me,te,de,Se,Re,Me,qe,ke=Y.indexOf("."),We=B,Ke=W;for(0<=ke&&(de=z,z=0,Y=Y.replace(".",""),Re=(qe=new X(fe)).pow(Y.length-ke),z=de,qe.c=U(O(b(Re.c),Re.e,"0"),10,oe,F),qe.e=qe.c.length),te=de=(Me=U(Y,fe,oe,ue?(se=le,F):(se=F,le))).length;Me[--de]==0;Me.pop());if(!Me[0])return se.charAt(0);if(ke<0?--te:(Re.c=Me,Re.e=te,Re.s=pe,Me=(Re=I(Re,qe,We,Ke,oe)).c,Se=Re.r,te=Re.e),ke=Me[me=te+We+1],de=oe/2,Se=Se||me<0||Me[me+1]!=null,Se=Ke<4?(ke!=null||Se)&&(Ke==0||Ke==(Re.s<0?3:2)):de<ke||ke==de&&(Ke==4||Se||Ke==6&&1&Me[me-1]||Ke==(Re.s<0?8:7)),me<1||!Me[0])Y=Se?O(se.charAt(1),-We,se.charAt(0)):se.charAt(0);else{if(Me.length=me,Se)for(--oe;++Me[--me]>oe;)Me[me]=0,me||(++te,Me=[1].concat(Me));for(de=Me.length;!Me[--de];);for(ke=0,Y="";ke<=de;Y+=se.charAt(Me[ke++]));Y=O(Y,te,se.charAt(0))}return Y}}(),I=function(){function F(fe,oe,pe){var ue,se,me,te,de=0,Se=fe.length,Re=oe%g,Me=oe/g|0;for(fe=fe.slice();Se--;)de=((se=Re*(me=fe[Se]%g)+(ue=Me*me+(te=fe[Se]/g|0)*Re)%g*g+de)/pe|0)+(ue/g|0)+Me*te,fe[Se]=se%pe;return de&&(fe=[de].concat(fe)),fe}function U(fe,oe,pe,ue){var se,me;if(pe!=ue)me=ue<pe?1:-1;else for(se=me=0;se<pe;se++)if(fe[se]!=oe[se]){me=fe[se]>oe[se]?1:-1;break}return me}function Y(fe,oe,pe,ue){for(var se=0;pe--;)fe[pe]-=se,se=fe[pe]<oe[pe]?1:0,fe[pe]=se*ue+fe[pe]-oe[pe];for(;!fe[0]&&1<fe.length;fe.splice(0,1));}return function(fe,oe,pe,ue,se){var me,te,de,Se,Re,Me,qe,ke,We,Ke,Xe,nt,Et,it,st,rt,Lt,kt=fe.s==oe.s?1:-1,Mt=fe.c,gt=oe.c;if(!(Mt&&Mt[0]&&gt&&gt[0]))return new X(fe.s&&oe.s&&(Mt?!gt||Mt[0]!=gt[0]:gt)?Mt&&Mt[0]==0||!gt?0*kt:kt/0:NaN);for(We=(ke=new X(kt)).c=[],kt=pe+(te=fe.e-oe.e)+1,se||(se=h,te=w(fe.e/d)-w(oe.e/d),kt=kt/d|0),de=0;gt[de]==(Mt[de]||0);de++);if(gt[de]>(Mt[de]||0)&&te--,kt<0)We.push(1),Se=!0;else{for(it=Mt.length,rt=gt.length,kt+=2,1<(Re=u(se/(gt[de=0]+1)))&&(gt=F(gt,Re,se),Mt=F(Mt,Re,se),rt=gt.length,it=Mt.length),Et=rt,Xe=(Ke=Mt.slice(0,rt)).length;Xe<rt;Ke[Xe++]=0);Lt=gt.slice(),Lt=[0].concat(Lt),st=gt[0],gt[1]>=se/2&&st++;do{if(Re=0,(me=U(gt,Ke,rt,Xe))<0){if(nt=Ke[0],rt!=Xe&&(nt=nt*se+(Ke[1]||0)),1<(Re=u(nt/st)))for(se<=Re&&(Re=se-1),qe=(Me=F(gt,Re,se)).length,Xe=Ke.length;U(Me,Ke,qe,Xe)==1;)Re--,Y(Me,rt<qe?Lt:gt,qe,se),qe=Me.length,me=1;else Re==0&&(me=Re=1),qe=(Me=gt.slice()).length;if(qe<Xe&&(Me=[0].concat(Me)),Y(Ke,Me,Xe,se),Xe=Ke.length,me==-1)for(;U(gt,Ke,rt,Xe)<1;)Re++,Y(Ke,rt<Xe?Lt:gt,Xe,se),Xe=Ke.length}else me===0&&(Re++,Ke=[0]);We[de++]=Re,Ke[0]?Ke[Xe++]=Mt[Et]||0:(Ke=[Mt[Et]],Xe=1)}while((Et++<it||Ke[0]!=null)&&kt--);Se=Ke[0]!=null,We[0]||We.splice(0,1)}if(se==h){for(de=1,kt=We[0];10<=kt;kt/=10,de++);Te(ke,pe+(ke.e=de+te*d-1)+1,ue,Se)}else ke.e=te,ke.r=+Se;return ke}}(),ne=/^(-?)0([xbo])(?=\w[\w.]*$)/i,ie=/^([^.]+)\.$/,P=/^\.([^.]+)$/,y=/^-?(Infinity|NaN)$/,R=/^\s*\+(?=[\w.])|^\s+|\s+$/g,j=function(F,U,Y,fe){var oe,pe=Y?U:U.replace(R,"");if(y.test(pe))F.s=isNaN(pe)?null:pe<0?-1:1,F.c=F.e=null;else{if(!Y&&(pe=pe.replace(ne,function(ue,se,me){return oe=(me=me.toLowerCase())=="x"?16:me=="b"?2:8,fe&&fe!=oe?ue:se}),fe&&(oe=fe,pe=pe.replace(ie,"$1").replace(P,"0.$1")),U!=pe))return new X(pe,oe);if(X.DEBUG)throw Error(c+"Not a"+(fe?" base "+fe:"")+" number: "+U);F.c=F.e=F.s=null}},_.absoluteValue=_.abs=function(){var F=new X(this);return F.s<0&&(F.s=1),F},_.comparedTo=function(F,U){return E(this,new X(F,U))},_.decimalPlaces=_.dp=function(F,U){var Y,fe,oe;if(F!=null)return A(F,0,v),U==null?U=W:A(U,0,8),Te(new X(this),F+this.e+1,U);if(!(Y=this.c))return null;if(fe=((oe=Y.length-1)-w(this.e/d))*d,oe=Y[oe])for(;oe%10==0;oe/=10,fe--);return fe<0&&(fe=0),fe},_.dividedBy=_.div=function(F,U){return I(this,new X(F,U),B,W)},_.dividedToIntegerBy=_.idiv=function(F,U){return I(this,new X(F,U),0,1)},_.exponentiatedBy=_.pow=function(F,U){var Y,fe,oe,pe,ue,se,me,te,de=this;if((F=new X(F)).c&&!F.isInteger())throw Error(c+"Exponent not an integer: "+Oe(F));if(U!=null&&(U=new X(U)),ue=14<F.e,!de.c||!de.c[0]||de.c[0]==1&&!de.e&&de.c.length==1||!F.c||!F.c[0])return te=new X(Math.pow(+Oe(de),ue?2-M(F):+Oe(F))),U?te.mod(U):te;if(se=F.s<0,U){if(U.c?!U.c[0]:!U.s)return new X(NaN);(fe=!se&&de.isInteger()&&U.isInteger())&&(de=de.mod(U))}else{if(9<F.e&&(0<de.e||de.e<-1||(de.e==0?1<de.c[0]||ue&&24e7<=de.c[1]:de.c[0]<8e13||ue&&de.c[0]<=9999975e7)))return pe=de.s<0&&M(F)?-0:0,-1<de.e&&(pe=1/pe),new X(se?1/pe:pe);z&&(pe=l(z/d+2))}for(me=ue?(Y=new X(.5),se&&(F.s=1),M(F)):(oe=Math.abs(+Oe(F)))%2,te=new X($);;){if(me){if(!(te=te.times(de)).c)break;pe?te.c.length>pe&&(te.c.length=pe):fe&&(te=te.mod(U))}if(oe){if((oe=u(oe/2))===0)break;me=oe%2}else if(Te(F=F.times(Y),F.e+1,1),14<F.e)me=M(F);else{if((oe=+Oe(F))==0)break;me=oe%2}de=de.times(de),pe?de.c&&de.c.length>pe&&(de.c.length=pe):fe&&(de=de.mod(U))}return fe?te:(se&&(te=$.div(te)),U?te.mod(U):pe?Te(te,z,W,void 0):te)},_.integerValue=function(F){var U=new X(this);return F==null?F=W:A(F,0,8),Te(U,U.e+1,F)},_.isEqualTo=_.eq=function(F,U){return E(this,new X(F,U))===0},_.isFinite=function(){return!!this.c},_.isGreaterThan=_.gt=function(F,U){return 0<E(this,new X(F,U))},_.isGreaterThanOrEqualTo=_.gte=function(F,U){return(U=E(this,new X(F,U)))===1||U===0},_.isInteger=function(){return!!this.c&&w(this.e/d)>this.c.length-2},_.isLessThan=_.lt=function(F,U){return E(this,new X(F,U))<0},_.isLessThanOrEqualTo=_.lte=function(F,U){return(U=E(this,new X(F,U)))===-1||U===0},_.isNaN=function(){return!this.s},_.isNegative=function(){return this.s<0},_.isPositive=function(){return 0<this.s},_.isZero=function(){return!!this.c&&this.c[0]==0},_.minus=function(F,U){var Y,fe,oe,pe,ue=this,se=ue.s;if(U=(F=new X(F,U)).s,!se||!U)return new X(NaN);if(se!=U)return F.s=-U,ue.plus(F);var me=ue.e/d,te=F.e/d,de=ue.c,Se=F.c;if(!me||!te){if(!de||!Se)return de?(F.s=-U,F):new X(Se?ue:NaN);if(!de[0]||!Se[0])return Se[0]?(F.s=-U,F):new X(de[0]?ue:W==3?-0:0)}if(me=w(me),te=w(te),de=de.slice(),se=me-te){for((oe=(pe=se<0)?(se=-se,de):(te=me,Se)).reverse(),U=se;U--;oe.push(0));oe.reverse()}else for(fe=(pe=(se=de.length)<(U=Se.length))?se:U,se=U=0;U<fe;U++)if(de[U]!=Se[U]){pe=de[U]<Se[U];break}if(pe&&(oe=de,de=Se,Se=oe,F.s=-F.s),0<(U=(fe=Se.length)-(Y=de.length)))for(;U--;de[Y++]=0);for(U=h-1;se<fe;){if(de[--fe]<Se[fe]){for(Y=fe;Y&&!de[--Y];de[Y]=U);--de[Y],de[fe]+=h}de[fe]-=Se[fe]}for(;de[0]==0;de.splice(0,1),--te);return de[0]?Ee(F,de,te):(F.s=W==3?-1:1,F.c=[F.e=0],F)},_.modulo=_.mod=function(F,U){var Y,fe,oe=this;return F=new X(F,U),!oe.c||!F.s||F.c&&!F.c[0]?new X(NaN):!F.c||oe.c&&!oe.c[0]?new X(oe):(D==9?(fe=F.s,F.s=1,Y=I(oe,F,0,3),F.s=fe,Y.s*=fe):Y=I(oe,F,0,D),(F=oe.minus(Y.times(F))).c[0]||D!=1||(F.s=oe.s),F)},_.multipliedBy=_.times=function(F,U){var Y,fe,oe,pe,ue,se,me,te,de,Se,Re,Me,qe,ke,We,Ke=this,Xe=Ke.c,nt=(F=new X(F,U)).c;if(!(Xe&&nt&&Xe[0]&&nt[0]))return!Ke.s||!F.s||Xe&&!Xe[0]&&!nt||nt&&!nt[0]&&!Xe?F.c=F.e=F.s=null:(F.s*=Ke.s,Xe&&nt?(F.c=[0],F.e=0):F.c=F.e=null),F;for(fe=w(Ke.e/d)+w(F.e/d),F.s*=Ke.s,(me=Xe.length)<(Se=nt.length)&&(qe=Xe,Xe=nt,nt=qe,oe=me,me=Se,Se=oe),oe=me+Se,qe=[];oe--;qe.push(0));for(ke=h,We=g,oe=Se;0<=--oe;){for(Y=0,Re=nt[oe]%We,Me=nt[oe]/We|0,pe=oe+(ue=me);oe<pe;)Y=((te=Re*(te=Xe[--ue]%We)+(se=Me*te+(de=Xe[ue]/We|0)*Re)%We*We+qe[pe]+Y)/ke|0)+(se/We|0)+Me*de,qe[pe--]=te%ke;qe[pe]=Y}return Y?++fe:qe.splice(0,1),Ee(F,qe,fe)},_.negated=function(){var F=new X(this);return F.s=-F.s||null,F},_.plus=function(F,U){var Y,fe=this,oe=fe.s;if(U=(F=new X(F,U)).s,!oe||!U)return new X(NaN);if(oe!=U)return F.s=-U,fe.minus(F);var pe=fe.e/d,ue=F.e/d,se=fe.c,me=F.c;if(!pe||!ue){if(!se||!me)return new X(oe/0);if(!se[0]||!me[0])return me[0]?F:new X(se[0]?fe:0*oe)}if(pe=w(pe),ue=w(ue),se=se.slice(),oe=pe-ue){for((Y=0<oe?(ue=pe,me):(oe=-oe,se)).reverse();oe--;Y.push(0));Y.reverse()}for((oe=se.length)-(U=me.length)<0&&(Y=me,me=se,se=Y,U=oe),oe=0;U;)oe=(se[--U]=se[U]+me[U]+oe)/h|0,se[U]=h===se[U]?0:se[U]%h;return oe&&(se=[oe].concat(se),++ue),Ee(F,se,ue)},_.precision=_.sd=function(F,U){var Y,fe,oe;if(F!=null&&F!==!!F)return A(F,1,v),U==null?U=W:A(U,0,8),Te(new X(this),F,U);if(!(Y=this.c))return null;if(fe=(oe=Y.length-1)*d+1,oe=Y[oe]){for(;oe%10==0;oe/=10,fe--);for(oe=Y[0];10<=oe;oe/=10,fe++);}return F&&this.e+1>fe&&(fe=this.e+1),fe},_.shiftedBy=function(F){return A(F,-p,p),this.times("1e"+F)},_.squareRoot=_.sqrt=function(){var F,U,Y,fe,oe,pe=this,ue=pe.c,se=pe.s,me=pe.e,te=B+4,de=new X("0.5");if(se!==1||!ue||!ue[0])return new X(!se||se<0&&(!ue||ue[0])?NaN:ue?pe:1/0);if((Y=(se=Math.sqrt(+Oe(pe)))==0||se==1/0?(((U=b(ue)).length+me)%2==0&&(U+="0"),se=Math.sqrt(+U),me=w((me+1)/2)-(me<0||me%2),new X(U=se==1/0?"1e"+me:(U=se.toExponential()).slice(0,U.indexOf("e")+1)+me)):new X(se+"")).c[0]){for((se=(me=Y.e)+te)<3&&(se=0);;)if(oe=Y,Y=de.times(oe.plus(I(pe,oe,te,1))),b(oe.c).slice(0,se)===(U=b(Y.c)).slice(0,se)){if(Y.e<me&&--se,(U=U.slice(se-3,se+1))!="9999"&&(fe||U!="4999")){+U&&(+U.slice(1)||U.charAt(0)!="5")||(Te(Y,Y.e+B+2,1),F=!Y.times(Y).eq(pe));break}if(!fe&&(Te(oe,oe.e+B+2,0),oe.times(oe).eq(pe))){Y=oe;break}te+=4,se+=4,fe=1}}return Te(Y,Y.e+B+1,W,F)},_.toExponential=function(F,U){return F!=null&&(A(F,0,v),F++),we(this,F,U,1)},_.toFixed=function(F,U){return F!=null&&(A(F,0,v),F=F+this.e+1),we(this,F,U)},_.toFormat=function(F,U,Y){var fe;if(Y==null)F!=null&&U&&typeof U=="object"?(Y=U,U=null):F&&typeof F=="object"?(Y=F,F=U=null):Y=K;else if(typeof Y!="object")throw Error(c+"Argument not an object: "+Y);if(fe=this.toFixed(F,U),this.c){var oe,pe=fe.split("."),ue=+Y.groupSize,se=+Y.secondaryGroupSize,me=Y.groupSeparator||"",te=pe[0],de=pe[1],Se=this.s<0,Re=Se?te.slice(1):te,Me=Re.length;if(se&&(oe=ue,ue=se,Me-=se=oe),0<ue&&0<Me){for(oe=Me%ue||ue,te=Re.substr(0,oe);oe<Me;oe+=ue)te+=me+Re.substr(oe,ue);0<se&&(te+=me+Re.slice(oe)),Se&&(te="-"+te)}fe=de?te+(Y.decimalSeparator||"")+((se=+Y.fractionGroupSize)?de.replace(new RegExp("\\d{"+se+"}\\B","g"),"$&"+(Y.fractionGroupSeparator||"")):de):te}return(Y.prefix||"")+fe+(Y.suffix||"")},_.toFraction=function(F){var U,Y,fe,oe,pe,ue,se,me,te,de,Se,Re,Me=this,qe=Me.c;if(F!=null&&(!(se=new X(F)).isInteger()&&(se.c||se.s!==1)||se.lt($)))throw Error(c+"Argument "+(se.isInteger()?"out of range: ":"not an integer: ")+Oe(se));if(!qe)return new X(Me);for(U=new X($),te=Y=new X($),fe=me=new X($),Re=b(qe),pe=U.e=Re.length-Me.e-1,U.c[0]=m[(ue=pe%d)<0?d+ue:ue],F=!F||0<se.comparedTo(U)?0<pe?U:te:se,ue=re,re=1/0,se=new X(Re),me.c[0]=0;de=I(se,U,0,1),(oe=Y.plus(de.times(fe))).comparedTo(F)!=1;)Y=fe,fe=oe,te=me.plus(de.times(oe=te)),me=oe,U=se.minus(de.times(oe=U)),se=oe;return oe=I(F.minus(Y),fe,0,1),me=me.plus(oe.times(te)),Y=Y.plus(oe.times(fe)),me.s=te.s=Me.s,Se=I(te,fe,pe*=2,W).minus(Me).abs().comparedTo(I(me,Y,pe,W).minus(Me).abs())<1?[te,fe]:[me,Y],re=ue,Se},_.toNumber=function(){return+Oe(this)},_.toPrecision=function(F,U){return F!=null&&A(F,1,v),we(this,F,U,2)},_.toString=function(F){var U,Y=this,fe=Y.s,oe=Y.e;return oe===null?fe?(U="Infinity",fe<0&&(U="-"+U)):U="NaN":(U=F==null?oe<=ee||J<=oe?k(b(Y.c),oe):O(b(Y.c),oe,"0"):F===10?O(b((Y=Te(new X(Y),B+oe+1,W)).c),Y.e,"0"):(A(F,2,le.length,"Base"),H(O(b(Y.c),oe,"0"),10,F,fe,!0)),fe<0&&Y.c[0]&&(U="-"+U)),U},_.valueOf=_.toJSON=function(){return Oe(this)},_._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(_[Symbol.toStringTag]="BigNumber",_[Symbol.for("nodejs.util.inspect.custom")]=_.valueOf),C!=null&&X.set(C),X}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=a)})(this)},{}],2:[function(r,n,i){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var a=o%10;return~~(o%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,i){function o(w,b){return function(E){if(Array.isArray(E))return E}(w)||function(E,A){var M=[],k=!0,O=!1,x=void 0;try{for(var C,I=E[Symbol.iterator]();!(k=(C=I.next()).done)&&(M.push(C.value),!A||M.length!==A);k=!0);}catch(H){O=!0,x=H}finally{try{k||I.return==null||I.return()}finally{if(O)throw x}}return M}(w,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),s=r("./validating"),l=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},f={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(w){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},E=2<arguments.length?arguments[2]:void 0;if(typeof b=="string"&&(b=l.parseFormat(b)),!s.validateFormat(b))return"ERROR: invalid format";var A=b.prefix||"",M=b.postfix||"",k=function(O,x,C){switch(x.output){case"currency":return x=v(x,a.currentCurrencyDefaultFormat()),function(le,X,we){var Ce=we.currentCurrency(),Ee=Object.assign({},f,X),Te=void 0,Oe="",F=!!Ee.totalLength||!!Ee.forceAverage||Ee.average,U=X.currencyPosition||Ce.position,Y=X.currencySymbol||Ce.symbol;Ee.spaceSeparated&&(Oe=" "),U==="infix"&&(Te=Oe+Y+Oe);var fe=g({instance:le,providedFormat:X,state:we,decimalSeparator:Te});return U==="prefix"&&(fe=le._value<0&&Ee.negative==="sign"?"-".concat(Oe).concat(Y).concat(fe.slice(1)):Y+Oe+fe),U&&U!=="postfix"||(fe=fe+(Oe=F?"":Oe)+Y),fe}(O,x,a);case"percent":return x=v(x,a.currentPercentageDefaultFormat()),function(le,X,we,Ce){var Ee=X.prefixSymbol,Te=g({instance:Ce(100*le._value),providedFormat:X,state:we}),Oe=Object.assign({},f,X);return Ee?"%".concat(Oe.spaceSeparated?" ":"").concat(Te):"".concat(Te).concat(Oe.spaceSeparated?" ":"","%")}(O,x,a,C);case"byte":return x=v(x,a.currentByteDefaultFormat()),$=O,W=a,ee=C,J=(B=x).base||"binary",he=c[J],re=d($._value,he.suffixes,he.scale),T=re.value,D=re.suffix,z=g({instance:ee(T),providedFormat:B,state:W,defaults:W.currentByteDefaultFormat()}),K=W.currentAbbreviations(),"".concat(z).concat(K.spaced?" ":"").concat(D);case"time":return x=v(x,a.currentTimeDefaultFormat()),P=O,y=Math.floor(P._value/60/60),R=Math.floor((P._value-60*y*60)/60),_=Math.round(P._value-60*y*60-60*R),"".concat(y,":").concat(R<10?"0":"").concat(R,":").concat(_<10?"0":"").concat(_);case"ordinal":return x=v(x,a.currentOrdinalDefaultFormat()),I=O,H=x,q=(j=a).currentOrdinal(),Z=Object.assign({},f,H),ne=g({instance:I,providedFormat:H,state:j}),ie=q(I._value),"".concat(ne).concat(Z.spaceSeparated?" ":"").concat(ie);case"number":default:return g({instance:O,providedFormat:x,numbro:C})}var I,H,j,q,Z,ne,ie,P,y,R,_,$,B,W,ee,J,he,re,T,D,z,K}(w,b,E);return k=(k=A+k)+M}function d(w,b,E){var A=b[0],M=Math.abs(w);if(E<=M){for(var k=1;k<b.length;++k){var O=Math.pow(E,k),x=Math.pow(E,k+1);if(O<=M&&M<x){A=b[k],w/=O;break}}A===b[0]&&(w/=Math.pow(E,b.length-1),A=b[b.length-1])}return{value:w,suffix:A}}function p(w){for(var b="",E=0;E<w;E++)b+="0";return b}function m(w,b){return w.toString().indexOf("e")!==-1?function(E,A){var M=E.toString(),k=o(M.split("e"),2),O=k[0],x=k[1],C=o(O.split("."),2),I=C[0],H=C[1],j=H===void 0?"":H;if(0<+x)M=I+j+p(x-j.length);else{var q=".";q=+I<0?"-0".concat(q):"0".concat(q);var Z=(p(-x-1)+Math.abs(I)+j).substr(0,A);Z.length<A&&(Z+=p(A-Z.length)),M=q+Z}return 0<+x&&0<A&&(M+=".".concat(p(A))),M}(w,b):(Math.round(+"".concat(w,"e+").concat(b))/Math.pow(10,b)).toFixed(b)}function g(w){var b=w.instance,E=w.providedFormat,A=w.state,M=A===void 0?a:A,k=w.decimalSeparator,O=w.defaults,x=O===void 0?M.currentDefaults():O,C=b._value;if(C===0&&M.hasZeroFormat())return M.getZeroFormat();if(!isFinite(C))return C.toString();var I,H,j,q,Z,ne,ie,P,y=Object.assign({},f,x,E),R=y.totalLength,_=R?0:y.characteristic,$=y.optionalCharacteristic,B=y.forceAverage,W=!!R||!!B||y.average,ee=R?-1:W&&E.mantissa===void 0?0:y.mantissa,J=!R&&(E.optionalMantissa===void 0?ee===-1:y.optionalMantissa),he=y.trimMantissa,re=y.thousandSeparated,T=y.spaceSeparated,D=y.negative,z=y.forceSign,K=y.exponential,le="";if(W){var X=function(F){var U=F.value,Y=F.forceAverage,fe=F.abbreviations,oe=F.spaceSeparated,pe=oe!==void 0&&oe,ue=F.totalLength,se=ue===void 0?0:ue,me="",te=Math.abs(U),de=-1;if(te>=Math.pow(10,12)&&!Y||Y==="trillion"?(me=fe.trillion,U/=Math.pow(10,12)):te<Math.pow(10,12)&&te>=Math.pow(10,9)&&!Y||Y==="billion"?(me=fe.billion,U/=Math.pow(10,9)):te<Math.pow(10,9)&&te>=Math.pow(10,6)&&!Y||Y==="million"?(me=fe.million,U/=Math.pow(10,6)):(te<Math.pow(10,6)&&te>=Math.pow(10,3)&&!Y||Y==="thousand")&&(me=fe.thousand,U/=Math.pow(10,3)),me&&(me=(pe?" ":"")+me),se){var Se=U.toString().split(".")[0];de=Math.max(se-Se.length,0)}return{value:U,abbreviation:me,mantissaPrecision:de}}({value:C,forceAverage:B,abbreviations:M.currentAbbreviations(),spaceSeparated:T,totalLength:R});C=X.value,le+=X.abbreviation,R&&(ee=X.mantissaPrecision)}if(K){var we=(H=(I={value:C,characteristicPrecision:_}).value,j=I.characteristicPrecision,q=j===void 0?0:j,Z=o(H.toExponential().split("e"),2),ne=Z[0],ie=Z[1],P=+ne,q&&1<q&&(P*=Math.pow(10,q-1),ie=0<=(ie=+ie-(q-1))?"+".concat(ie):ie),{value:P,abbreviation:"e".concat(ie)});C=we.value,le=we.abbreviation+le}var Ce,Ee,Te,Oe=function(F,U,Y,fe,oe){if(fe===-1)return F;var pe=m(U,fe),ue=o(pe.toString().split("."),2),se=ue[0],me=ue[1],te=me===void 0?"":me;if(te.match(/^0+$/)&&(Y||oe))return se;var de=te.match(/0+$/);return oe&&de?"".concat(se,".").concat(te.toString().slice(0,de.index)):pe.toString()}(C.toString(),C,J,ee,he);return Oe=function(F,U,Y,fe,oe){var pe=fe.currentDelimiters(),ue=pe.thousands;oe=oe||pe.decimal;var se=pe.thousandsSize||3,me=F.toString(),te=me.split(".")[0],de=me.split(".")[1];return Y&&(U<0&&(te=te.slice(1)),function(Se,Re){for(var Me=[],qe=0,ke=Se;0<ke;ke--)qe===Re&&(Me.unshift(ke),qe=0),qe++;return Me}(te.length,se).forEach(function(Se,Re){te=te.slice(0,Se+Re)+ue+te.slice(Se+Re)}),U<0&&(te="-".concat(te))),me=de?te+oe+de:te}(Oe=function(F,U,Y,fe){var oe=F,pe=o(oe.toString().split("."),2),ue=pe[0],se=pe[1];if(ue.match(/^-?0$/)&&Y)return se?"".concat(ue.replace("0",""),".").concat(se):ue.replace("0","");if(ue.length<fe)for(var me=fe-ue.length,te=0;te<me;te++)oe="0".concat(oe);return oe.toString()}(Oe,0,$,_),C,re,M,k),(W||K)&&(Oe=Oe+le),(z||C<0)&&(Ce=Oe,Te=D,Oe=(Ee=C)===0?Ce:+Ce==0?Ce.replace("-",""):0<Ee?"+".concat(Ce):Te==="sign"?Ce:"(".concat(Ce.replace("-",""),")")),Oe}function v(w,b){if(!w)return b;var E=Object.keys(w);return E.length===1&&E[0]==="output"?b:w}n.exports=function(w){return{format:function(){for(var b=arguments.length,E=new Array(b),A=0;A<b;A++)E[A]=arguments[A];return h.apply(void 0,E.concat([w]))},getByteUnit:function(){for(var b=arguments.length,E=new Array(b),A=0;A<b;A++)E[A]=arguments[A];return function(M){var k=c.general;return d(M._value,k.suffixes,k.scale).suffix}.apply(void 0,E.concat([w]))},getBinaryByteUnit:function(){for(var b=arguments.length,E=new Array(b),A=0;A<b;A++)E[A]=arguments[A];return function(M){var k=c.binary;return d(M._value,k.suffixes,k.scale).suffix}.apply(void 0,E.concat([w]))},getDecimalByteUnit:function(){for(var b=arguments.length,E=new Array(b),A=0;A<b;A++)E[A]=arguments[A];return function(M){var k=c.decimal;return d(M._value,k.suffixes,k.scale).suffix}.apply(void 0,E.concat([w]))},formatOrDefault:v}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,i){var o=r("./en-US"),a=r("./validating"),s=r("./parsing"),l={},u=void 0,c={},f=null,h={};function d(m){u=m}function p(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return p().currency},l.currentAbbreviations=function(){return p().abbreviations},l.currentDelimiters=function(){return p().delimiters},l.currentOrdinal=function(){return p().ordinal},l.currentDefaults=function(){return Object.assign({},p().defaults,h)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().timeFormat)},l.setDefaults=function(m){m=s.parseFormat(m),a.validateFormat(m)&&(h=m)},l.getZeroFormat=function(){return f},l.setZeroFormat=function(m){return f=typeof m=="string"?m:null},l.hasZeroFormat=function(){return f!==null},l.languageData=function(m){if(m){if(c[m])return c[m];throw new Error('Unknown tag "'.concat(m,'"'))}return p()},l.registerLanguage=function(m){var g=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(m))throw new Error("Invalid language data");c[m.languageTag]=m,g&&d(m.languageTag)},l.setLanguage=function(m){var g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[m]){var v=m.split("-")[0],w=Object.keys(c).find(function(b){return b.split("-")[0]===v});return c[w]?void d(w):void d(g)}d(m)},l.registerLanguage(o),u=o.languageTag,n.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,i){n.exports=function(o){return{loadLanguagesInNode:function(a){return s=o,void a.forEach(function(l){var u=void 0;try{u=r("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&s.registerLanguage(u)});var s}}}},{}],6:[function(r,n,i){var o=r("bignumber.js");function a(s,l,u){var c=new o(s._value),f=l;return u.isNumbro(l)&&(f=l._value),f=new o(f),s._value=c.minus(f).toNumber(),s}n.exports=function(s){return{add:function(l,u){return f=u,h=s,d=new o((c=l)._value),p=f,h.isNumbro(f)&&(p=f._value),p=new o(p),c._value=d.plus(p).toNumber(),c;var c,f,h,d,p},subtract:function(l,u){return a(l,u,s)},multiply:function(l,u){return f=u,h=s,d=new o((c=l)._value),p=f,h.isNumbro(f)&&(p=f._value),p=new o(p),c._value=d.times(p).toNumber(),c;var c,f,h,d,p},divide:function(l,u){return f=u,h=s,d=new o((c=l)._value),p=f,h.isNumbro(f)&&(p=f._value),p=new o(p),c._value=d.dividedBy(p).toNumber(),c;var c,f,h,d,p},set:function(l,u){return c=l,h=f=u,s.isNumbro(f)&&(h=f._value),c._value=h,c;var c,f,h},difference:function(l,u){return c=u,a(h=(f=s)(l._value),c,f),Math.abs(h._value);var c,f,h}}}},{"bignumber.js":1}],7:[function(r,n,i){function o(g,v){for(var w=0;w<v.length;w++){var b=v[w];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}var a=r("./globalState"),s=r("./validating"),l=r("./loading")(m),u=r("./unformatting"),c=r("./formatting")(m),f=r("./manipulating")(m),h=r("./parsing"),d=function(){function g(b){(function(E,A){if(!(E instanceof A))throw new TypeError("Cannot call a class as a function")})(this,g),this._value=b}var v,w;return v=g,(w=[{key:"clone",value:function(){return m(this._value)}},{key:"format",value:function(){var b=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,b)}},{key:"formatCurrency",value:function(b){return typeof b=="string"&&(b=h.parseFormat(b)),(b=c.formatOrDefault(b,a.currentCurrencyDefaultFormat())).output="currency",c.format(this,b)}},{key:"formatTime",value:function(){var b=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return b.output="time",c.format(this,b)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(b){return f.difference(this,b)}},{key:"add",value:function(b){return f.add(this,b)}},{key:"subtract",value:function(b){return f.subtract(this,b)}},{key:"multiply",value:function(b){return f.multiply(this,b)}},{key:"divide",value:function(b){return f.divide(this,b)}},{key:"set",value:function(b){return f.set(this,p(b))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(v.prototype,w),g}();function p(g){var v=g;return m.isNumbro(g)?v=g._value:typeof g=="string"?v=m.unformat(g):isNaN(g)&&(v=NaN),v}function m(g){return new d(p(g))}m.version="2.1.2",m.isNumbro=function(g){return g instanceof d},m.language=a.currentLanguage,m.registerLanguage=a.registerLanguage,m.setLanguage=a.setLanguage,m.languages=a.languages,m.languageData=a.languageData,m.zeroFormat=a.setZeroFormat,m.defaultFormat=a.currentDefaults,m.setDefaults=a.setDefaults,m.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,m.validate=s.validate,m.loadLanguagesInNode=l.loadLanguagesInNode,m.unformat=u.unformat,n.exports=m},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,i){n.exports={parseFormat:function(o){var a,s,l,u,c,f,h,d,p,m,g,v,w,b,E,A,M,k,O,x,C=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(s=C,o=(l=(a=o).match(/^{([^}]*)}/))?(s.prefix=l[1],a.slice(l[0].length)):a,c=C,function(I,H){if(I.indexOf("$")===-1){if(I.indexOf("%")===-1)return I.indexOf("bd")!==-1?(H.output="byte",H.base="general"):I.indexOf("b")!==-1?(H.output="byte",H.base="binary"):I.indexOf("d")!==-1?(H.output="byte",H.base="decimal"):I.indexOf(":")===-1?I.indexOf("o")!==-1&&(H.output="ordinal"):H.output="time";H.output="percent"}else H.output="currency"}(o=(f=(u=o).match(/{([^}]*)}$/))?(c.postfix=f[1],u.slice(0,-f[0].length)):u,C),h=C,(d=o.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),p=C,(m=o.split(".")[0].match(/0+/))&&(p.characteristic=m[0].length),function(I,H){if(I.indexOf(".")!==-1){var j=I.split(".")[0];H.optionalCharacteristic=j.indexOf("0")===-1}}(o,C),g=C,o.indexOf("a")!==-1&&(g.average=!0),w=C,(v=o).indexOf("K")!==-1?w.forceAverage="thousand":v.indexOf("M")!==-1?w.forceAverage="million":v.indexOf("B")!==-1?w.forceAverage="billion":v.indexOf("T")!==-1&&(w.forceAverage="trillion"),function(I,H){var j=I.split(".")[1];if(j){var q=j.match(/0+/);q&&(H.mantissa=q[0].length)}}(o,C),E=C,(b=o).match(/\[\.]/)?E.optionalMantissa=!0:b.match(/\./)&&(E.optionalMantissa=!1),A=C,o.indexOf(",")!==-1&&(A.thousandSeparated=!0),M=C,o.indexOf(" ")!==-1&&(M.spaceSeparated=!0),O=C,(k=o).match(/^\+?\([^)]*\)$/)&&(O.negative="parenthesis"),k.match(/^\+?-/)&&(O.negative="sign"),x=C,o.match(/^\+/)&&(x.forceSign=!0),C)}}},{}],9:[function(r,n,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",f=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,p=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===h?0:function m(g,v){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",b=3<arguments.length?arguments[3]:void 0,E=4<arguments.length?arguments[4]:void 0,A=5<arguments.length?arguments[5]:void 0,M=6<arguments.length?arguments[6]:void 0;if(!isNaN(+g))return+g;var k="",O=g.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(O!==g)return-1*m(O,v,w,b,E,A,M);for(var x=0;x<o.length;x++){var C=o[x];if((k=g.replace(C.key,""))!==g)return m(k,v,w,b,E,A,M)*C.factor}if((k=g.replace("%",""))!==g)return m(k,v,w,b,E,A,M)/100;var I=parseFloat(g);if(!isNaN(I)){var H=b(I);if(H&&H!=="."&&(k=g.replace(new RegExp("".concat(a(H),"$")),""))!==g)return m(k,v,w,b,E,A,M);var j={};Object.keys(A).forEach(function(R){j[A[R]]=R});for(var q=Object.keys(j).sort().reverse(),Z=q.length,ne=0;ne<Z;ne++){var ie=q[ne],P=j[ie];if((k=g.replace(ie,""))!==g){var y=void 0;switch(P){case"thousand":y=Math.pow(10,3);break;case"million":y=Math.pow(10,6);break;case"billion":y=Math.pow(10,9);break;case"trillion":y=Math.pow(10,12)}return m(k,v,w,b,E,A,M)*y}}}}(function(m,g){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",w=m.replace(v,"");return w=(w=w.replace(new RegExp("([0-9])".concat(a(g.thousands),"([0-9])"),"g"),"$1$2")).replace(g.decimal,".")}(l,u,c),u,c,f,h,d,p)}n.exports={unformat:function(l,u){var c,f,h,d=r("./globalState"),p=d.currentDelimiters(),m=d.currentCurrency().symbol,g=d.currentOrdinal(),v=d.getZeroFormat(),w=d.currentAbbreviations(),b=void 0;if(typeof l=="string")b=function(E,A){if(!E.indexOf(":")||A.thousands===":")return!1;var M=E.split(":");if(M.length!==3)return!1;var k=+M[0],O=+M[1],x=+M[2];return!isNaN(k)&&!isNaN(O)&&!isNaN(x)}(l,p)?(c=l.split(":"),f=+c[0],h=+c[1],+c[2]+60*h+3600*f):s(l,p,m,g,v,w,u);else{if(typeof l!="number")return;b=l}if(b!==void 0)return b}}},{"./globalState":4}],10:[function(r,n,i){function o(p){return function(m){if(Array.isArray(m)){for(var g=0,v=new Array(m.length);g<m.length;g++)v[g]=m[g];return v}}(p)||function(m){if(Symbol.iterator in Object(m)||Object.prototype.toString.call(m)==="[object Arguments]")return Array.from(m)}(p)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(p)}var s=r("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(p,m){return m.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(p){return p.output==="byte"}},characteristic:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(p){return 0<=p},message:"value must be positive"},{restriction:function(p,m){return!m.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(p,m){return m.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(p){return p.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function f(p){return!!s.unformat(p)}function h(p,m,g){var v=3<arguments.length&&arguments[3]!==void 0&&arguments[3],w=Object.keys(p).map(function(b){if(!m[b])return console.error("".concat(g," Invalid key: ").concat(b)),!1;var E=p[b],A=m[b];if(typeof A=="string"&&(A={type:A}),A.type==="format"){if(!h(E,u,"[Validate ".concat(b,"]"),!0))return!1}else if(a(E)!==A.type)return console.error("".concat(g," ").concat(b,' type mismatched: "').concat(A.type,'" expected, "').concat(a(E),'" provided')),!1;if(A.restrictions&&A.restrictions.length)for(var M=A.restrictions.length,k=0;k<M;k++){var O=A.restrictions[k],x=O.restriction,C=O.message;if(!x(E,p))return console.error("".concat(g," ").concat(b," invalid value: ").concat(C)),!1}return A.restriction&&!A.restriction(E,p)?(console.error("".concat(g," ").concat(b," invalid value: ").concat(A.message)),!1):A.validValues&&A.validValues.indexOf(E)===-1?(console.error("".concat(g," ").concat(b," invalid value: must be among ").concat(JSON.stringify(A.validValues),', "').concat(E,'" provided')),!1):!(A.children&&!h(E,A.children,"[Validate ".concat(b,"]")))});return v||w.push.apply(w,o(Object.keys(m).map(function(b){var E=m[b];if(typeof E=="string"&&(E={type:E}),E.mandatory){var A=E.mandatory;if(typeof A=="function"&&(A=A(p)),A&&p[b]===void 0)return console.error("".concat(g,' Missing mandatory key "').concat(b,'"')),!1}return!0}))),w.reduce(function(b,E){return b&&E},!0)}function d(p){return h(p,u,"[Validate format]")}n.exports={validate:function(p,m){var g=f(p),v=d(m);return g&&v},validateFormat:d,validateInput:f,validateLanguage:function(p){return h(p,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(KK);const $l=KK.exports;var PRe="numeric";function e3(t,e,r,n,i,o,a){var s=o;if(Wi(s)){var l=a.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,f=a.className||"",h=f.length?f.split(" "):[];if(typeof u<"u"&&!$l.languages()[u]){var d=u.replace("-",""),p=$l.allLanguages?$l.allLanguages[u]:$l[d];p&&$l.registerLanguage(p)}$l.setLanguage(u),s=$l(s).format(c||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),e.dir="ltr"}Os(t,e,r,n,i,s,a)}e3.RENDERER_TYPE=PRe;var kRe="password";function t3(t,e,r,n,i,o,a){Os.apply(this,[t,e,r,n,i,o,a]);var s=a.hashLength||e.innerHTML.length,l=a.hashSymbol||"*",u="";Ye(s-1,function(){u+=l}),Fp(e,u)}t3.RENDERER_TYPE=kRe;var $Re="time";function r3(t,e,r,n,i,o,a){Os.apply(this,[t,e,r,n,i,o,a]),e.dir="ltr"}r3.RENDERER_TYPE=$Re;var I1=so("renderers"),LRe=I1.register,DRe=I1.getItem,qK=I1.hasItem;I1.getNames;I1.getValues;function jk(t){if(typeof t=="function")return t;if(!qK(t))throw Error('No registered renderer found under "'.concat(t,'" name'));return DRe(t)}function xa(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),LRe(t,e)}function FRe(){xa(Bp),xa(A1),xa(Z8),xa(Q8),xa(e3),xa(t3),xa(Os),xa(r3)}var HRe="autocomplete";function R6(t,e){var r=t;if(r==null&&(r=""),this.allowEmpty&&r===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,Wk(r,e)):Wk(r,e)(this.source):e(!0)}R6.VALIDATOR_TYPE=HRe;function Wk(t,e){var r=t;return function(n){for(var i=!1,o=0,a=n.length;o<a;o++)if(r===n[o]){i=!0;break}e(i)}}var BRe=Object.is||function(e,r){return e===r?e!==0||1/e===1/r:e!=e&&r!=r},URe=en,VRe=l6,jRe=$r,WRe=No,zRe=vi,zk=BRe,Gk=Gr,GRe=bc,YRe=u6;VRe("search",function(t,e,r){return[function(i){var o=zRe(this),a=WRe(i)?void 0:GRe(i,t);return a?URe(a,i,o):new RegExp(i)[t](Gk(o))},function(n){var i=jRe(this),o=Gk(n),a=r(e,i,o);if(a.done)return a.value;var s=i.lastIndex;zk(s,0)||(i.lastIndex=0);var l=YRe(i,o);return zk(i.lastIndex,s)||(i.lastIndex=s),l===null?-1:l.index}]});function KRe(t){var e=new Date(t);return isNaN(new Date("".concat(t,"T00:00")).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}var qRe="date";function n3(t,e){var r=$K(VK,this.instance),n=t,i=!0;n==null&&(n="");var o=qt(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=qt(new Date(n)).isValid()||o;if(this.allowEmpty&&n===""&&(a=!0,o=!0),a||(i=!1),!a&&o&&(i=!0),a&&!o)if(this.correctFormat===!0){var s=XRe(n,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,s,"dateValidator"),i=!0}else i=!1;e(i)}n3.VALIDATOR_TYPE=qRe;function XRe(t,e){var r=qt(KRe(t)),n=qt(t,e),i=t.search(/[A-z]/g)>-1,o;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?o=r:o=n,o.format(e)}var QRe="numeric";function i3(t,e){var r=t;r==null&&(r=""),this.allowEmpty&&r===""?e(!0):e(r===""?!1:Wi(t))}i3.VALIDATOR_TYPE=QRe;var ZRe=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],JRe="time";function o3(t,e){var r=this.timeFormat||"h:mm:ss a",n=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;var o=/^\d{1,2}$/.test(i);o&&(i+=":00");var a=qt(i,ZRe,!0).isValid()?qt(i):qt(i,r),s=a.isValid(),l=qt(i,r,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(s=!0,l=!0),s||(n=!1),!s&&l&&(n=!0),s&&!l)if(this.correctFormat===!0){var u=a.format(r),c=this.instance.toVisualRow(this.row),f=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,f,u,"timeValidator"),n=!0}else n=!1;e(n)}o3.VALIDATOR_TYPE=JRe;var x1=so("validators"),eEe=x1.register,tEe=x1.getItem,XK=x1.hasItem;x1.getNames;x1.getValues;function rEe(t){if(typeof t=="function")return t;if(!XK(t))throw Error('No registered validator found under "'.concat(t,'" name'));return tEe(t)}function Fm(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),eEe(t,e)}function nEe(){Fm(R6),Fm(n3),Fm(i3),Fm(o3)}var iEe="autocomplete",oEe={CELL_TYPE:iEe,editor:q8,renderer:Bp,validator:R6},aEe="checkbox",sEe={CELL_TYPE:aEe,editor:BK,renderer:Z8},lEe="date",uEe={CELL_TYPE:lEe,editor:jK,renderer:Bp,validator:n3},cEe="dropdown",fEe={CELL_TYPE:cEe,editor:X8,renderer:Bp,validator:R6},hEe="handsontable",dEe={CELL_TYPE:hEe,editor:K8,renderer:Bp},pEe="numeric",mEe={CELL_TYPE:pEe,editor:WK,renderer:e3,validator:i3,dataType:"number"},gEe="password",yEe={CELL_TYPE:gEe,editor:zK,renderer:t3,copyable:!1},vEe="text",QK={CELL_TYPE:vEe,editor:_c,renderer:Os},bEe="time",wEe={CELL_TYPE:bEe,editor:GK,renderer:r3,validator:o3},M1=so("cellTypes"),SEe=M1.register,REe=M1.getItem,ZK=M1.hasItem;M1.getNames;M1.getValues;function EEe(t){if(!ZK(t))throw Error('You declared cell type "'.concat(t,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return REe(t)}function Yo(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);var r=e,n=r.editor,i=r.renderer,o=r.validator;n&&Ti(t,n),i&&xa(t,i),o&&Fm(t,o),SEe(t,e)}function CEe(){Yo(oEe),Yo(sEe),Yo(uEe),Yo(fEe),Yo(dEe),Yo(mEe),Yo(yEe),Yo(QK),Yo(wEe)}var _Ee=i6,TEe=FG;_Ee("WeakSet",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},TEe);function OEe(t){return xEe(t)||IEe(t)||JK(t)||AEe()}function AEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IEe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function xEe(t){if(Array.isArray(t))return $T(t)}function MEe(t,e){return kEe(t)||PEe(t,e)||JK(t,e)||NEe()}function NEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JK(t,e){if(!!t){if(typeof t=="string")return $T(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $T(t,e)}}function $T(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function PEe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function kEe(t){if(Array.isArray(t))return t}var LT="asc",$Ee="desc",Yk=new Map([[LT,[-1,1]],[$Ee,[1,-1]]]),LEe=function(e){return"The priority '".concat(e,"' is already declared in a map.")},DEe=function(e){return"The priority '".concat(e,"' is not a number.")};function FEe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.errorPriorityExists,r=t.errorPriorityNaN,n=new Map;e=sr(e)?e:LEe,r=sr(r)?r:DEe;function i(a,s){if(!Wi(a))throw new Error(r(a));if(n.has(a))throw new Error(e(a));n.set(a,s)}function o(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:LT,s=Yk.get(a)||Yk.get(LT),l=MEe(s,2),u=l[0],c=l[1];return OEe(n).sort(function(f,h){return f[0]<h[0]?u:c}).map(function(f){return f[1]})}return{addItem:i,getItems:o}}function HEe(t){return VEe(t)||UEe(t)||eq(t)||BEe()}function BEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UEe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function VEe(t){if(Array.isArray(t))return DT(t)}function Kk(t,e){return zEe(t)||WEe(t,e)||eq(t,e)||jEe()}function jEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eq(t,e){if(!!t){if(typeof t=="string")return DT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DT(t,e)}}function DT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function WEe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function zEe(t){if(Array.isArray(t))return t}var GEe=function(e){return"The id '".concat(e,"' is already declared in a map.")};function E6(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.errorIdExists,r=new Map;e=sr(e)?e:GEe;function n(c,f){if(u(c))throw new Error(e(c));r.set(c,f)}function i(c){return r.delete(c)}function o(){r.clear()}function a(c){var f=l().find(function(p){var m=Kk(p,2),g=m[0],v=m[1];return c===v?g:!1})||[null],h=Kk(f,1),d=h[0];return d}function s(c){return r.get(c)}function l(){return HEe(r)}function u(c){return r.has(c)}return{addItem:n,clear:o,getId:a,getItem:s,getItems:l,hasItem:u,removeItem:i}}function YEe(t){return QEe(t)||XEe(t)||qEe(t)||KEe()}function KEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qEe(t,e){if(!!t){if(typeof t=="string")return FT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FT(t,e)}}function XEe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function QEe(t){if(Array.isArray(t))return FT(t)}function FT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var ZEe=function(e){return"'".concat(e,"' value is already declared in a unique set.")};function JEe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.errorItemExists,r=new Set;e=sr(e)?e:ZEe;function n(a){if(r.has(a))throw new Error(e(a));r.add(a)}function i(){return YEe(r)}function o(){r.clear()}return{addItem:n,clear:o,getItems:i}}function eCe(t,e){return nCe(t)||rCe(t,e)||tq(t,e)||tCe()}function tCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rCe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function nCe(t){if(Array.isArray(t))return t}function qk(t){return aCe(t)||oCe(t)||tq(t)||iCe()}function iCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tq(t,e){if(!!t){if(typeof t=="string")return HT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HT(t,e)}}function oCe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function aCe(t){if(Array.isArray(t))return HT(t)}function HT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var a3=function(e){return'There is already registered "'.concat(e,'" plugin.')},sCe=function(e){return'There is already registered plugin on priority "'.concat(e,'".')},lCe=function(e){return'The priority "'.concat(e,'" is not a number.')},rq=FEe({errorPriorityExists:sCe,errorPriorityNaN:lCe}),nq=JEe({errorItemExists:a3}),BT=E6({errorIdExists:a3});function iq(){return[].concat(qk(rq.getItems()),qk(nq.getItems()))}function s3(t){var e=ms(t);return BT.getItem(e)}function uCe(t){return!!s3(t)}function Ht(t,e,r){var n=fCe(t,e,r),i=eCe(n,3);t=i[0],e=i[1],r=i[2],s3(t)===void 0&&cCe(t,e,r)}function cCe(t,e,r){var n=ms(t);if(BT.hasItem(n))throw new Error(a3(n));r===void 0?nq.addItem(n):rq.addItem(r,n),BT.addItem(n,e)}function fCe(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}function Dg(t){return Dg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dg(t)}function hCe(t,e){return gCe(t)||mCe(t,e)||pCe(t,e)||dCe()}function dCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pCe(t,e){if(!!t){if(typeof t=="string")return Xk(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xk(t,e)}}function Xk(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function mCe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function gCe(t){if(Array.isArray(t))return t}function yCe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bCe(n.key),n)}}function vCe(t,e,r){return e&&Qk(t.prototype,e),r&&Qk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function bCe(t){var e=wCe(t,"string");return Dg(e)==="symbol"?e:String(e)}function wCe(t,e){if(Dg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Dg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SCe(t,e){RCe(t,e),e.add(t)}function RCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ECe(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}var Zk=new Map([["plugin",uCe],["cell-type",ZK],["editor",kK],["renderer",qK],["validator",XK]]),CCe="base",Ll=new WeakMap,CE=[],Lo=null,Jk=new WeakSet,jt=function(){function t(e){var r=this;yCe(this,t),SCe(this,Jk),Ts(this,"hot",e,{writable:!1}),Ll.set(this,{hooks:{}}),Lo=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return vCe(t,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,i=Array.isArray(n)?n:[];if(i.length>0){var o=[];if(i.forEach(function(u){var c=u.split(":"),f=hCe(c,2),h=f[0],d=f[1];if(!Zk.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));Zk.get(h)(d)||o.push(" - ".concat(d," (").concat(h,")"))}),o.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(o.join(`
`),`
`)].join("");CE.push(a)}}Lo||(Lo=iq()),Lo.indexOf("UndoRedo")>=0&&Lo.splice(Lo.indexOf("UndoRedo"),1),Lo.indexOf(this.pluginName)>=0&&Lo.splice(Lo.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var s=Lo.length===0;if(s){if(CE.length>0){var l=["".concat(CE.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(l)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){Ll.get(this).hooks[r]=Ll.get(this).hooks[r]||[];var i=Ll.get(this).hooks[r];this.hot.addHook(r,n),i.push(n),Ll.get(this).hooks[r]=i}},{key:"removeHooks",value:function(r){var n=this;ae(Ll.get(this).hooks[r]||[],function(i){n.hot.removeHook(r,i)})}},{key:"clearHooks",value:function(){var r=this,n=Ll.get(this).hooks;Rt(n,function(i,o){return r.removeHooks(o)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){ae(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=ECe(this,Jk,_Ce).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Rt(this,function(n,i){i!=="hot"&&(r[i]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return CCe}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),t}();function _Ce(t){if(!t)return!1;var e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(var r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function Fg(t){return Fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fg(t)}function TCe(t,e){return xCe(t)||ICe(t,e)||ACe(t,e)||OCe()}function OCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ACe(t,e){if(!!t){if(typeof t=="string")return e$(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e$(t,e)}}function e$(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ICe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function xCe(t){if(Array.isArray(t))return t}function MCe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function t$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,PCe(n.key),n)}}function NCe(t,e,r){return e&&t$(t.prototype,e),r&&t$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function PCe(t){var e=kCe(t,"string");return Fg(e)==="symbol"?e:String(e)}function kCe(t,e){if(Fg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Fg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $Ce=function(){function t(e){MCe(this,t),this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return NCe(t,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={row:r};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={col:r};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),ae(this.rows,function(n){r(n.row,wr(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),ae(this.columns,function(n){var i=n.table.getBoundingClientRect(),o=i.width;r(n.col,Math.ceil(o))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(i){ae(i.strings,function(o){n.appendChild(r.createColElement(o.col))})}),n}},{key:"createRow",value:function(r){var n=this,i=this.hot.rootDocument,o=i.createDocumentFragment(),a=i.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),o.appendChild(a)),this.samples.forEach(function(s){ae(s.strings,function(l){var u=l.col,c=n.hot.getCellMeta(r,u);c.col=u,c.row=r;var f=n.hot.getCellRenderer(c),h=i.createElement("td");h.setAttribute("ghost-table",1),f(n.hot,h,r,u,n.hot.colToProp(u),l.value,c),o.appendChild(h)})}),o}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,i=n.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");o.push([-1,a]),i.appendChild(a)}this.samples.forEach(function(s){ae(s.strings,function(l){var u=l.col,c=n.createElement("th");o.push([u,c]),i.appendChild(c)})}),this.table.tHead.appendChild(i),ae(o,function(s){var l=TCe(s,2),u=l[0],c=l[1];r.hot.view.appendColHeader(u,c)})}},{key:"createCol",value:function(r){var n=this,i=this.hot.rootDocument,o=i.createDocumentFragment();return this.samples.forEach(function(a){ae(a.strings,function(s){var l=s.row,u=n.hot.getCellMeta(l,r);u.col=r,u.row=l;var c=n.hot.getCellRenderer(u),f=i.createElement("td"),h=i.createElement("tr");f.setAttribute("ghost-table",1),c(n.hot,f,l,r,n.hot.colToProp(r),s.value,u),h.appendChild(f),o.appendChild(h)})}),o}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),o=n.createElement("table"),a=n.createElement("thead"),s=n.createElement("tbody"),l=n.createElement("colgroup"),u=n.createElement("tr"),c=n.createElement("th");return this.isVertical()&&o.appendChild(l),this.isHorizontal()&&(u.appendChild(c),a.appendChild(u),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(a),this.isVertical()&&s.appendChild(u),o.appendChild(s),_e(o,r),i.appendChild(o),{fragment:i,table:o,tHead:a,tBody:s,colGroup:l,tr:u,th:c}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),o=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return _e(o,a),i.appendChild(o),{fragment:i,container:o}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),t}();const oq=$Ce;var LCe=tt,DCe=bi,aq=u1,FCe=dt,HCe=FCe(function(){aq(1)});LCe({target:"Object",stat:!0,forced:HCe},{keys:function(e){return aq(DCe(e))}});function Hg(t){return Hg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hg(t)}function BCe(t,e,r){return e=sq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UCe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sq(n.key),n)}}function VCe(t,e,r){return e&&r$(t.prototype,e),r&&r$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function sq(t){var e=jCe(t,"string");return Hg(e)==="symbol"?e:String(e)}function jCe(t,e){if(Hg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Hg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var WCe=function(){function t(e){UCe(this,t),this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}return VCe(t,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:t.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,i){var o=this,a=new Map,s=typeof i=="number"?{from:i,to:i}:i,l=s.from,u=s.to;return Ye(l,u,function(c){var f=o.generateSample(r,n,c);a.set(c,f)}),a}},{key:"generateSample",value:function(r,n,i){var o=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,s=r==="row"?"col":"row",l=[];return Ye(n.from,n.to,function(u){var c=r==="row"?o.dataFactory(i,u):o.dataFactory(u,i),f=c.value,h=c.bundleSeed,d=typeof h=="string"&&h.length>0,p;d?p=h:St(f)?p="".concat(Object.keys(f).length):Array.isArray(f)?p="".concat(f.length):p="".concat(Vr(f).length),a.has(p)||a.set(p,{needed:o.getSampleCount(),strings:[]});var m=a.get(p);if(m.needed){var g=l.indexOf(f)>-1;(!g||o.allowDuplicates||d)&&(m.strings.push(BCe({value:f},s,u)),l.push(f),m.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),t}();const lq=WCe;var ru=1,Ln=2;function Bg(t){return Bg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bg(t)}function zCe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,YCe(n.key),n)}}function GCe(t,e,r){return e&&n$(t.prototype,e),r&&n$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function YCe(t){var e=KCe(t,"string");return Bg(e)==="symbol"?e:String(e)}function KCe(t,e){if(Bg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Bg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Vc=new WeakMap,qCe=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.viewportSize,n=e.scrollOffset,i=e.totalItems,o=e.itemSizeFn,a=e.overrideFn,s=e.calculationType,l=e.stretchMode,u=e.stretchingItemWidthFn,c=u===void 0?function(h){return h}:u,f=e.inlineStartOffset;zCe(this,t),Vc.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:i,columnWidthFn:o,overrideFn:a,calculationType:s,stretchingColumnWidthFn:c,inlineStartOffset:f}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return GCe(t,[{key:"calculate",value:function(){for(var r=0,n=!0,i=[],o,a=0,s=0,l=Vc.get(this),u=l.calculationType,c=l.overrideFn,f=l.scrollOffset,h=Math.max(l.scrollOffset,0),d=l.totalColumns,p=l.viewportWidth,m=h>0?p+1:p,g=0;g<d;g++)if(o=this._getColumnWidth(g),r<=h&&u!==Ln&&(this.startColumn=g,a=o),r>=h&&r+(u===Ln?o:0)<=h+m&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=g,a=o),this.endColumn=g),i.push(r),r+=o,s=o,u!==Ln&&(this.endColumn=g),r>=h+p){n=!1;break}var v=f+p-m,w=u===Ln?0:s,b=u===Ln?a:0;if(v<-1*l.inlineStartOffset||f>i.at(-1)+w||-1*l.scrollOffset-l.viewportWidth>-1*b?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var E=i[this.endColumn]+o-i[this.startColumn-1];if((E<=p||u!==Ln)&&(this.startColumn-=1),E>p)break}u===ru&&this.startColumn!==null&&c&&c(this),this.startPosition=i[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var i=Vc.get(this),o=i.totalColumns,a=0,s=0;s<o;s++){var l=this._getColumnWidth(s),u=i.stretchingColumnWidthFn(void 0,s);typeof u=="number"?n-=u:a+=l}var c=n-a;if(this.stretch==="all"&&c>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var f=this._getColumnWidth(o-1),h=c+f;this.stretchLastWidth=h>=0?h:f}}}},{key:"getStretchedColumnWidth",value:function(r,n){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(r)),i}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var i=0,o=Vc.get(this),a=o.totalColumns;if(!this.stretchAllColumnsWidth[r]){var s=Math.round(n*this.stretchAllRatio),l=o.stretchingColumnWidthFn(s,r);l===void 0?this.stretchAllColumnsWidth[r]=s:this.stretchAllColumnsWidth[r]=isNaN(l)?this._getColumnWidth(r):l}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)i+=this.stretchAllColumnsWidth[u];i!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-i)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=Vc.get(this),i=n.totalColumns;return r===i-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=Vc.get(this).columnWidthFn(r);return isNaN(n)&&(n=t.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),t}();const l3=qCe;function Ug(t){return Ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ug(t)}function XCe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ZCe(n.key),n)}}function QCe(t,e,r){return e&&i$(t.prototype,e),r&&i$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZCe(t){var e=JCe(t,"string");return Ug(e)==="symbol"?e:String(e)}function JCe(t,e){if(Ug(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ug(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var o$=new WeakMap,e_e=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.viewportSize,n=e.scrollOffset,i=e.totalItems,o=e.itemSizeFn,a=e.overrideFn,s=e.calculationType,l=e.scrollbarHeight;XCe(this,t),o$.set(this,{viewportHeight:r,scrollOffset:n,totalRows:i,rowHeightFn:o,overrideFn:a,calculationType:s,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return QCe(t,[{key:"calculate",value:function(){for(var r=o$.get(this),n=r.calculationType,i=r.overrideFn,o=r.rowHeightFn,a=r.scrollOffset,s=Math.max(r.scrollOffset,0),l=r.totalRows,u=r.viewportHeight,c=r.horizontalScrollbarHeight||0,f=0,h=!0,d=[],p,m=0,g=0,v=0;v<l;v++)if(p=o(v),isNaN(p)&&(p=t.DEFAULT_HEIGHT),f<=s&&n!==Ln&&(this.startRow=v,m=p),f>=s&&f+(n===Ln?p:0)<=s+u-c&&(this.startRow===null&&(this.startRow=v,m=p),this.endRow=v),d.push(f),f+=p,g=p,n!==Ln&&(this.endRow=v),f>=s+u-c){h=!1;break}var w=a+u-c,b=n===Ln?m:0,E=n===Ln?0:g;if(w<b||a>d.at(-1)+E?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===l-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var A=d[this.endRow]+p-d[this.startRow-1];if((A<=u-c||n!==Ln)&&(this.startRow-=1),A>=u-c)break}n===ru&&this.startRow!==null&&i&&i(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),l<this.endRow&&(this.endRow=l-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),t}();const uq=e_e;function Vg(t){return Vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vg(t)}function t_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cq(n.key),n)}}function r_e(t,e,r){return e&&a$(t.prototype,e),r&&a$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function n_e(t,e,r){i_e(t,e),e.set(t,r)}function i_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s$(t,e,r){return e=cq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cq(t){var e=o_e(t,"string");return Vg(e)==="symbol"?e:String(e)}function o_e(t,e){if(Vg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Vg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lm(t,e){var r=fq(t,e,"get");return a_e(t,r)}function a_e(t,e){return e.get?e.get.call(t):e.value}function s_e(t,e,r){var n=fq(t,e,"set");return l_e(t,n,r),r}function fq(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function l_e(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Dl=new WeakMap,u_e=function(){function t(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;t_e(this,t),s$(this,"row",null),s$(this,"col",null),n_e(this,Dl,{writable:!0,value:!1}),s_e(this,Dl,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}return r_e(t,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(lm(this,Dl)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(lm(this,Dl)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(lm(this,Dl)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(lm(this,Dl)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new t(this.row,this.col,lm(this,Dl))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),t}();const rw=u_e;function jg(t){return jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jg(t)}function c_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hq(n.key),n)}}function f_e(t,e,r){return e&&l$(t.prototype,e),r&&l$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function h_e(t,e,r){d_e(t,e),e.set(t,r)}function d_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _E(t,e,r){return e=hq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hq(t){var e=p_e(t,"string");return jg(e)==="symbol"?e:String(e)}function p_e(t,e){if(jg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(jg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Do(t,e){var r=dq(t,e,"get");return m_e(t,r)}function m_e(t,e){return e.get?e.get.call(t):e.value}function g_e(t,e,r){var n=dq(t,e,"set");return y_e(t,n,r),r}function dq(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function y_e(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Di=new WeakMap,v_e=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;c_e(this,t),_E(this,"highlight",null),_E(this,"from",null),_E(this,"to",null),h_e(this,Di,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=r.clone(),this.to=n.clone(),g_e(this,Di,i)}return f_e(t,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,i=r.col,o=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return o.row<=n&&a.row>=n&&o.col<=i&&a.col>=i}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>i.row||r.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(i.row,r.row),Math.max(i.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),a=r.getOuterTopStartCorner(),s=r.getOuterBottomEndCorner(),l=Math.min(n.row,a.row),u=Math.min(n.col,a.col),c=Math.max(i.row,s.row),f=Math.max(i.col,s.col),h=this._createCellCoords(l,u),d=this._createCellCoords(c,f);return this.from=h,this.to=d,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var i=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=i[0],this.to=i[1];break;case"SE-NW":var o=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=o[0],this.to=o[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Do(this,Di)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Do(this,Di)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Do(this,Di)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Do(this,Di)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Do(this,Di)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Do(this,Di)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Do(this,Di)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Do(this,Di)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof rw))return!1;if(n){var i=n.from,o=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},o=[];return n.top===i.top&&o.push("top"),n.right===i.right&&o.push("right"),n.bottom===i.bottom&&o.push("bottom"),n.left===i.left&&o.push("left"),o}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],o=r.row;o<=n.row;o++)for(var a=r.col;a<=n.col;a++)!(this.from.row===o&&this.from.col===a)&&!(this.to.row===o&&this.to.col===a)&&i.push(this._createCellCoords(o,a));return i}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],o=r.row;o<=n.row;o++)for(var a=r.col;a<=n.col;a++)r.row===o&&r.col===a?i.push(r):n.row===o&&n.col===a?i.push(n):i.push(this._createCellCoords(o,a));return i}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=n.row;o<=i.row;o++)for(var a=n.col;a<=i.col;a++){var s=r(o,a);if(s===!1)return}}},{key:"clone",value:function(){return new t(this.highlight,this.from,this.to,Do(this,Di))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new rw(r,n,Do(this,Di))}}]),t}();const u3=v_e;function Wg(t){return Wg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wg(t)}function b_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,S_e(n.key),n)}}function w_e(t,e,r){return e&&u$(t.prototype,e),r&&u$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function S_e(t){var e=R_e(t,"string");return Wg(e)==="symbol"?e:String(e)}function R_e(t,e){if(Wg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Wg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jc=new WeakMap,E_e=function(){function t(e,r,n,i,o,a){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;b_e(this,t),this.wtSettings=n,this.domBindings=r,this.wtTable=o,this.selections=a,this.parent=s,this.eventManager=i,this.facadeGetter=e,jc.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return w_e(t,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(o){return r.onContextMenu(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(o){return r.onMouseOver(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(o){return r.onMouseOut(o)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},i=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};na()?n():(gK()&&n(),i())}},{key:"selectedCellWasTouched",value:function(r){var n=jc.get(this),i=this.parentCell(r),o=i.coords;if(n.selectedCellBeforeTouchEnd&&o){var a=[o.row,n.selectedCellBeforeTouchEnd.from.row],s=a[0],l=a[1],u=[o.col,n.selectedCellBeforeTouchEnd.from.col],c=u[0],f=u[1];return s===l&&c===f}return!1}},{key:"parentCell",value:function(r){var n={},i=this.wtTable.TABLE,o=S0(r,["TD","TH"],i);return o?(n.coords=this.wtTable.getCoords(o),n.TD=o):at(r,"wtBorder")&&at(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):at(r,"wtBorder")&&at(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=jc.get(this),i=this.domBindings.rootDocument.activeElement,o=MK(ywe,r.target),a=r.target;if(!(a===i||o(0)===i||o(1)===i)){var s=this.parentCell(a);at(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):s.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,s.coords,s.TD),(r.button===0||this.touchApplied)&&s.TD&&(n.dblClickOrigin[0]=s.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(!!this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,i=S0(r.target,["TD","TH"],n),o=this.parent||this;i&&i!==o.lastMouseOver&&Uu(i,n)&&(o.lastMouseOver=i,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(i),i))}}},{key:"onMouseOut",value:function(r){if(!!this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,i=S0(r.target,["TD","TH"],n),o=S0(r.relatedTarget,["TD","TH"],n);i&&i!==o&&Uu(i,n)&&this.callListener("onCellMouseOut",r,this.wtTable.getCoords(i),i)}}},{key:"onMouseUp",value:function(r){var n=jc.get(this),i=this.parentCell(r.target);i.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,i.coords,i.TD),!(r.button!==0&&!this.touchApplied)&&(i.TD===n.dblClickOrigin[0]&&i.TD===n.dblClickOrigin[1]?(at(r.target,"corner")?this.callListener("onCellCornerDblClick",r,i.coords,i.TD):this.callListener("onCellDblClick",r,i.coords,i.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):i.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=i.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=jc.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,i=r.target,o=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,a=He(o)&&o.row>=0&&o.col>=0,s=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(s){var l=["A","BUTTON","INPUT"];uK()&&(jbe()||Wbe())&&this.selectedCellWasTouched(i)&&!l.includes(i.tagName)?r.preventDefault():this.selectedCellWasTouched(i)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,i,o){var a=this.wtSettings.getSettingPure(r);a&&a(n,i,o,this.facadeGetter())}},{key:"destroy",value:function(){var r=jc.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),t}();const pq=E_e;function zg(t){return zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zg(t)}function C_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,T_e(n.key),n)}}function __e(t,e,r){return e&&c$(t.prototype,e),r&&c$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function T_e(t){var e=O_e(t,"string");return zg(e)==="symbol"?e:String(e)}function O_e(t,e){if(zg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(zg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var A_e=function(){function t(e,r,n){C_e(this,t),this.offset=e,this.total=r,this.countTH=n}return __e(t,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),t}();const I_e=A_e;function Gg(t){return Gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gg(t)}function x_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,N_e(n.key),n)}}function M_e(t,e,r){return e&&f$(t.prototype,e),r&&f$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function N_e(t){var e=P_e(t,"string");return Gg(e)==="symbol"?e:String(e)}function P_e(t,e){if(Gg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Gg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var k_e=function(){function t(e,r,n){x_e(this,t),this.offset=e,this.total=r,this.countTH=n}return M_e(t,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),t}();const $_e=k_e;var L_e=0,nw=1,iw=2;function Yg(t){return Yg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yg(t)}function D_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,H_e(n.key),n)}}function F_e(t,e,r){return e&&h$(t.prototype,e),r&&h$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function H_e(t){var e=B_e(t,"string");return Yg(e)==="symbol"?e:String(e)}function B_e(t,e){if(Yg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Yg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var d$=function(){function t(){D_e(this,t),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return F_e(t,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),t}();function Kg(t){return Kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kg(t)}function U_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,j_e(n.key),n)}}function V_e(t,e,r){return e&&p$(t.prototype,e),r&&p$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function j_e(t){var e=W_e(t,"string");return Kg(e)==="symbol"?e:String(e)}function W_e(t,e){if(Kg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Kg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var z_e=function(){function t(){U_e(this,t),this.size=new d$,this.workingSpace=L_e,this.sharedSize=null}return V_e(t,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof d$}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=nw,r.workingSpace=iw,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=iw,r.workingSpace=nw,this.sharedSize=r.getViewSize()}}]),t}();function qg(t){return qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qg(t)}function G_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,K_e(n.key),n)}}function Y_e(t,e,r){return e&&m$(t.prototype,e),r&&m$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function K_e(t){var e=q_e(t,"string");return qg(e)==="symbol"?e:String(e)}function q_e(t,e){if(qg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(qg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mq=function(){function t(e,r,n){G_e(this,t),this.rootNode=e,this.nodesPool=r,this.sizeSet=new z_e,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return Y_e(t,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,i=0;if(this.isSharedViewSet())for(var o=r.firstElementChild;o;){if(o.tagName===this.childNodeType)i+=1;else if(n.isPlaceOn(nw))break;o=o.nextElementSibling}else i=r.childElementCount;return i}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,i=this.isSharedViewSet(),o=n.getViewSize(),a=o.nextSize,s=this.getRenderedChildCount();s<a;){var l=this.nodesPool();!i||i&&n.isPlaceOn(iw)?r.appendChild(l):r.insertBefore(l,r.firstChild),s+=1}for(var u=i&&n.isPlaceOn(nw);s>a;)r.removeChild(u?r.firstChild:r.lastChild),s-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,i=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(iw)&&(i+=n.sharedSize.nextSize);var o=r.childNodes[i];if(o.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,o),o=a}this.collectedNodes.push(o),this.visualIndex+=1}},{key:"end",value:function(){}}]),t}();function xh(t){return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xh(t)}function X_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Z_e(n.key),n)}}function Q_e(t,e,r){return e&&g$(t.prototype,e),r&&g$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Z_e(t){var e=J_e(t,"string");return xh(e)==="symbol"?e:String(e)}function J_e(t,e){if(xh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&UT(t,e)}function UT(t,e){return UT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},UT(t,e)}function tTe(t){var e=iTe();return function(){var n=ow(t),i;if(e){var o=ow(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return rTe(this,i)}}function rTe(t,e){if(e&&(xh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nTe(t)}function nTe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function iTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ow(t){return ow=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ow(t)}var gq=function(t){eTe(r,t);var e=tTe(r);function r(){return X_e(this,r),e.apply(this,arguments)}return Q_e(r,[{key:"prependView",value:function(i){return this.sizeSet.prepend(i.sizeSet),i.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(i){return this.sizeSet.append(i.sizeSet),i.sizeSet.prepend(this.sizeSet),this}}]),r}(mq);function Xg(t){return Xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xg(t)}function oTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sTe(n.key),n)}}function aTe(t,e,r){return e&&y$(t.prototype,e),r&&y$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function sTe(t){var e=lTe(t,"string");return Xg(e)==="symbol"?e:String(e)}function lTe(t,e){if(Xg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Xg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uTe=function(){function t(e){oTe(this,t),this.nodeType=e.toUpperCase()}return aTe(t,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),t}();function Qg(t){return Qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qg(t)}function cTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hTe(n.key),n)}}function fTe(t,e,r){return e&&v$(t.prototype,e),r&&v$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function hTe(t){var e=dTe(t,"string");return Qg(e)==="symbol"?e:String(e)}function dTe(t,e){if(Qg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Qg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var N1=function(){function t(e,r){cTe(this,t),this.nodesPool=typeof e=="string"?new uTe(e):null,this.nodeType=e,this.rootNode=r,this.table=null,this.renderedNodes=0}return fTe(t,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),t}();function Mh(t){return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mh(t)}function pTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gTe(n.key),n)}}function mTe(t,e,r){return e&&b$(t.prototype,e),r&&b$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function gTe(t){var e=yTe(t,"string");return Mh(e)==="symbol"?e:String(e)}function yTe(t,e){if(Mh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&VT(t,e)}function VT(t,e){return VT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},VT(t,e)}function bTe(t){var e=RTe();return function(){var n=aw(t),i;if(e){var o=aw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return wTe(this,i)}}function wTe(t,e){if(e&&(Mh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return STe(t)}function STe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function RTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function aw(t){return aw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},aw(t)}var ETe=function(t){vTe(r,t);var e=bTe(r);function r(){var n;return pTe(this,r),n=e.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return mTe(r,[{key:"obtainOrderView",value:function(i){var o=this,a;return this.orderViews.has(i)?a=this.orderViews.get(i):(a=new gq(i,function(s){return o.nodesPool.obtain(o.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,a)),a}},{key:"render",value:function(){for(var i=this.table,o=i.rowsToRender,a=i.rowHeaderFunctions,s=i.rowHeadersCount,l=i.rows,u=i.cells,c=0;c<o;c++){var f=this.table.renderedRowToSource(c),h=l.getRenderedNode(c);this.sourceRowIndex=f;var d=this.obtainOrderView(h),p=u.obtainOrderView(h);d.appendView(p).setSize(s).setOffset(this.table.renderedColumnToSource(0)).start();for(var m=0;m<s;m++){d.render();var g=d.getCurrentNode();g.className="",g.removeAttribute("style"),a[m](f,g,m)}d.end()}}}]),r}(N1);function Nh(t){return Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nh(t)}function CTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,TTe(n.key),n)}}function _Te(t,e,r){return e&&w$(t.prototype,e),r&&w$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function TTe(t){var e=OTe(t,"string");return Nh(e)==="symbol"?e:String(e)}function OTe(t,e){if(Nh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ATe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jT(t,e)}function jT(t,e){return jT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},jT(t,e)}function ITe(t){var e=NTe();return function(){var n=sw(t),i;if(e){var o=sw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return xTe(this,i)}}function xTe(t,e){if(e&&(Nh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MTe(t)}function MTe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function NTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sw(t){return sw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sw(t)}var PTe=function(t){ATe(r,t);var e=ITe(r);function r(n){return CTe(this,r),e.call(this,null,n)}return _Te(r,[{key:"adjust",value:function(){var i=this.table,o=i.columnHeadersCount,a=i.rowHeadersCount,s=this.rootNode.firstChild;if(o){for(var l=this.table.columnsToRender,u=l+a,c=0,f=o;c<f;c++){for(s=this.rootNode.childNodes[c],s||(s=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(s)),this.renderedNodes=s.childNodes.length;this.renderedNodes<u;)s.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)s.removeChild(s.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>o)for(var d=o;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else s&&ua(s)}},{key:"render",value:function(){for(var i=this.table.columnHeadersCount,o=0;o<i;o+=1)for(var a=this.table,s=a.columnHeaderFunctions,l=a.columnsToRender,u=a.rowHeadersCount,c=this.rootNode.childNodes[o],f=-1*u;f<l;f+=1){var h=this.table.renderedColumnToSource(f),d=c.childNodes[f+u];d.className="",d.removeAttribute("style"),s[o](h,d,o)}}}]),r}(N1);function Ph(t){return Ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ph(t)}function kTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,LTe(n.key),n)}}function $Te(t,e,r){return e&&S$(t.prototype,e),r&&S$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function LTe(t){var e=DTe(t,"string");return Ph(e)==="symbol"?e:String(e)}function DTe(t,e){if(Ph(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&WT(t,e)}function WT(t,e){return WT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},WT(t,e)}function HTe(t){var e=VTe();return function(){var n=lw(t),i;if(e){var o=lw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return BTe(this,i)}}function BTe(t,e){if(e&&(Ph(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UTe(t)}function UTe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function VTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lw(t){return lw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lw(t)}var jTe=function(t){FTe(r,t);var e=HTe(r);function r(n){return kTe(this,r),e.call(this,null,n)}return $Te(r,[{key:"adjust",value:function(){for(var i=this.table,o=i.columnsToRender,a=i.rowHeadersCount,s=o+a;this.renderedNodes<s;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>s;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var i=this.table,o=i.columnsToRender,a=i.rowHeadersCount,s=0;s<a;s++){var l=this.table.renderedColumnToSource(s),u=this.table.columnUtils.getHeaderWidth(l);this.rootNode.childNodes[s].style.width="".concat(u,"px")}for(var c=0;c<o;c++){var f=this.table.renderedColumnToSource(c),h=this.table.columnUtils.getStretchedColumnWidth(f);this.rootNode.childNodes[c+a].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&_e(d,"rowHeader")}}]),r}(N1);function kh(t){return kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kh(t)}var R$;function WTe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function zTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,YTe(n.key),n)}}function GTe(t,e,r){return e&&E$(t.prototype,e),r&&E$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function YTe(t){var e=KTe(t,"string");return kh(e)==="symbol"?e:String(e)}function KTe(t,e){if(kh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zT(t,e)}function zT(t,e){return zT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zT(t,e)}function XTe(t){var e=JTe();return function(){var n=uw(t),i;if(e){var o=uw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return QTe(this,i)}}function QTe(t,e){if(e&&(kh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZTe(t)}function ZTe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function JTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uw(t){return uw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uw(t)}var C$=!1,eOe=function(t){qTe(r,t);var e=XTe(r);function r(n){var i;return zTe(this,r),i=e.call(this,"TR",n),i.orderView=new mq(n,function(o){return i.nodesPool.obtain(o)},i.nodeType),i}return GTe(r,[{key:"getRenderedNode",value:function(i){return this.orderView.getNode(i)}},{key:"render",value:function(){var i=this.table.rowsToRender;!C$&&i>1e3&&(C$=!0,Xt(Gt(R$||(R$=WTe([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(i).setOffset(this.table.renderedRowToSource(0)).start();for(var o=0;o<i;o++)this.orderView.render();this.orderView.end()}}]),r}(N1);function $h(t){return $h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$h(t)}function tOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nOe(n.key),n)}}function rOe(t,e,r){return e&&_$(t.prototype,e),r&&_$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function nOe(t){var e=iOe(t,"string");return $h(e)==="symbol"?e:String(e)}function iOe(t,e){if($h(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if($h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oOe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&GT(t,e)}function GT(t,e){return GT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},GT(t,e)}function aOe(t){var e=uOe();return function(){var n=cw(t),i;if(e){var o=cw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return sOe(this,i)}}function sOe(t,e){if(e&&($h(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lOe(t)}function lOe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function uOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cw(t){return cw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cw(t)}var cOe=function(t){oOe(r,t);var e=aOe(r);function r(){var n;return tOe(this,r),n=e.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return rOe(r,[{key:"obtainOrderView",value:function(i){var o=this,a;return this.orderViews.has(i)?a=this.orderViews.get(i):(a=new gq(i,function(s){return o.nodesPool.obtain(o.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,a)),a}},{key:"render",value:function(){for(var i=this.table,o=i.rowsToRender,a=i.columnsToRender,s=i.rows,l=i.rowHeaders,u=0;u<o;u++){var c=this.table.renderedRowToSource(u),f=s.getRenderedNode(u);this.sourceRowIndex=c;var h=this.obtainOrderView(f),d=l.obtainOrderView(f);h.prependView(d).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var p=0;p<a;p++){h.render();var m=h.getCurrentNode(),g=this.table.renderedColumnToSource(p);at(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),this.table.cellRenderer(c,g,m)}h.end()}}}]),r}(N1);function Zg(t){return Zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zg(t)}function fOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dOe(n.key),n)}}function hOe(t,e,r){return e&&T$(t.prototype,e),r&&T$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dOe(t){var e=pOe(t,"string");return Zg(e)==="symbol"?e:String(e)}function pOe(t,e){if(Zg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Zg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mOe=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;fOe(this,t),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return hOe(t,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,i=r.columnHeaders,o=r.colGroup,a=r.rows,s=r.cells;n.setTable(this),i.setTable(this),o.setTable(this),a.setTable(this),s.setTable(this),this.rowHeaders=n,this.columnHeaders=i,this.colGroup=o,this.rows=a,this.cells=s}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,i=0;i<r;i++){var o=n.getRenderedNode(i);if(o.firstChild){var a=this.renderedRowToSource(i),s=this.rowUtils.getHeight(a);s?o.firstChild.style.height="".concat(s-1,"px"):o.firstChild.style.height=""}}}}]),t}();function Jg(t){return Jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jg(t)}function gOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vOe(n.key),n)}}function yOe(t,e,r){return e&&O$(t.prototype,e),r&&O$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vOe(t){var e=bOe(t,"string");return Jg(e)==="symbol"?e:String(e)}function bOe(t,e){if(Jg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Jg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wOe=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.TABLE,n=e.THEAD,i=e.COLGROUP,o=e.TBODY,a=e.rowUtils,s=e.columnUtils,l=e.cellRenderer;gOe(this,t),this.renderer=new mOe(r,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new ETe,columnHeaders:new PTe(n),colGroup:new jTe(i),rows:new eOe(o),cells:new cOe}),this.renderer.setAxisUtils(a,s)}return yOe(t,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),t}();function ey(t){return ey=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ey(t)}function SOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,EOe(n.key),n)}}function ROe(t,e,r){return e&&A$(t.prototype,e),r&&A$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function EOe(t){var e=COe(t,"string");return ey(e)==="symbol"?e:String(e)}function COe(t,e){if(ey(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ey(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _Oe=function(){function t(e,r){SOe(this,t),this.dataAccessObject=e,this.wtSettings=r,this.headerWidths=new Map}return ROe(t,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,i=this.getWidth(r);if(n){var o=n.getStretchedColumnWidth(r,i);o&&(i=o)}return i}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return i!==void 0&&(n=n?Math.max(n,i):i),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,i=n.wtTable,o=n.wtViewport,a=n.cloneSource,s=a?a.wtTable.holder:i.holder,l=s.offsetHeight<s.scrollHeight?gn():0,u=r.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-l),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var c=r.getSetting("rowHeaders").length,f=r.getSetting("defaultColumnWidth"),h=0;h<c;h++){var d=Array.isArray(u)?u[h]:u;d=d==null?f:d,this.headerWidths.set(h,d)}}}]),t}();function ty(t){return ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ty(t)}function TOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,AOe(n.key),n)}}function OOe(t,e,r){return e&&I$(t.prototype,e),r&&I$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function AOe(t){var e=IOe(t,"string");return ty(e)==="symbol"?e:String(e)}function IOe(t,e){if(ty(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ty(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xOe=function(){function t(e,r){TOe(this,t),this.dataAccessObject=e,this.wtSettings=r}return OOe(t,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),i=this.dataAccessObject.wtViewport.oversizedRows[r];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}]),t}();function ry(t){return ry=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ry(t)}function MOe(t){return kOe(t)||POe(t)||yq(t)||NOe()}function NOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function POe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function kOe(t){if(Array.isArray(t))return YT(t)}function $Oe(t,e){return FOe(t)||DOe(t,e)||yq(t,e)||LOe()}function LOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yq(t,e){if(!!t){if(typeof t=="string")return YT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YT(t,e)}}function YT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function DOe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function FOe(t){if(Array.isArray(t))return t}function HOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vq(n.key),n)}}function BOe(t,e,r){return e&&x$(t.prototype,e),r&&x$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fo(t,e,r){return e=vq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vq(t){var e=UOe(t,"string");return ry(e)==="symbol"?e:String(e)}function UOe(t,e){if(ry(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ry(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var VOe=function(){function t(e,r,n,i,o){var a=this;HOe(this,t),Fo(this,"wtSettings",null),Fo(this,"domBindings",void 0),Fo(this,"TBODY",null),Fo(this,"THEAD",null),Fo(this,"COLGROUP",null),Fo(this,"hasTableHeight",!0),Fo(this,"hasTableWidth",!0),Fo(this,"isTableVisible",!1),Fo(this,"tableOffset",0),Fo(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,EK(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(s)}),this.rowUtils=new xOe(this.dataAccessObject,this.wtSettings),this.columnUtils=new _Oe(this.dataAccessObject,this.wtSettings),this.tableRenderer=new wOe({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return BOe(t,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!at(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,r),i.appendChild(r)),i.style.position="relative",i}},{key:"createHider",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!at(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,r),i.appendChild(r)),i}},{key:"createHolder",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!at(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,r),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),i.appendChild(r)),i}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,i=this.dataAccessObject,o=i.wtOverlays,a=i.wtViewport,s=n.getSetting("totalRows"),l=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),c=u.length,f=n.getSetting("columnHeaders"),h=f.length,d=!1,p=r;if(this.isMaster&&(this.holderOffset=Zr(this.holder),p=a.createRenderCalculators(p),c&&!n.getSetting("fixedColumnsStart"))){var m=o.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=m!==0,g!==this.correctHeaderWidth&&(p=!1)}if(this.isMaster&&(d=o.updateStateOfRendering()),p)this.isMaster&&a.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=Zr(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var v=s>0?this.getFirstRenderedRow():0,w=l>0?this.getFirstRenderedColumn():0;this.rowFilter=new $_e(v,s,h),this.columnFilter=new I_e(w,l,c);var b=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var E={};this.wtSettings.getSetting("beforeDraw",!0,E),b=E.skipRender!==!0}if(b){this.tableRenderer.setHeaderContentRenderers(u,f),(this.is(ta)||this.is(tl))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var A;if(this.isMaster&&(A=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(ta))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var M=Qt(this.hider),k=Qt(this.TABLE);M!==0&&k!==M&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),A!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(ta)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var O=!1;return this.isMaster&&(O=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(O=o.bottomOverlay.resetFixedPosition()||O),O=o.inlineStartOverlay.resetFixedPosition()||O,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),O?(o.refreshAll(),o.adjustElementsSize()):this.refreshSelections(p),d&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),i=this.wtSettings.getSetting("columnHeaders").length,o=this.wtSettings.getSetting("defaultRowHeight"),a,s,l,u=this.wtSettings.getSetting("columnHeaderHeight")||[];i;)i-=1,a=this.getColumnHeaderHeight(i),s=this.getColumnHeader(n,i),s&&(l=Gs(s),(!a&&o<l||a<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),Array.isArray(u)?u[i]!==null&&u[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(u[i]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=r.getSetting("columnHeaders"),a=0,s=o.length;a<s;a++)if(i[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(i[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(ta))&&!r.getSetting("externalRowCalculator"))for(var i=this.getRenderedRowsCount(),o=0;o<i;o++){var a=this.rowFilter.renderedToSource(o);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),i=0,o=n.length;i<o;i++)ut(n[i],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,i=this.dataAccessObject.selections;if(!!i){var o=Array.from(i),a=o.length;if(r){for(var s=[],l=0;l<a;l++){for(var u=o[l].settings,c=u.highlightHeaderClassName,f=u.highlightRowClassName,h=u.highlightColumnClassName,d=o[l].classNames,p=d.length,m=0;m<p;m++)s.includes(d[m])||s.push(d[m]);c&&!s.includes(c)&&s.push(c),f&&!s.includes(f)&&s.push(f),h&&!s.includes(h)&&s.push(h)}var g=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(g))for(var v=0;v<g.length;v++)s.push(g[v]);for(var w=s.length,b=0;b<w;b++)this.removeClassFromCells(s[b])}for(var E=0;E<a;E++)o[E].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,i=r.col,o=this.wtSettings.getSetting("onModifyGetCellCoords",n,i);if(o&&Array.isArray(o)){var a=$Oe(o,2);n=a[0],i=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;var s=this.getRow(n);if(!s&&n>=0)throw new Error("TR was expected to be rendered but is not");var l=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!l&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return l}},{key:"getRow",value:function(r){var n=null,i=null;if(r<0){var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceRowToVisibleColHeadedRow(r),i=this.THEAD}else{var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceToRendered(r),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(o){var a=o.childNodes[i];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var i=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=i)){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return o==null?void 0:o.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],i=this.wtSettings.getSetting("rowHeaders").length,o=0;o<i;o++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],s=a==null?void 0:a.childNodes[o];s&&n.push(s)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Bu(n,["TD","TH"])),n===null)return null;var i=n.parentNode,o=i.parentNode,a=bwe(i),s=n.cellIndex;if(kl(Ju,n,this.wtRootElement)||kl(Qu,n,this.wtRootElement))o.nodeName==="THEAD"&&(a-=o.childNodes.length);else if(kl(tl,n,this.wtRootElement)||kl(ta,n,this.wtRootElement)){var l=this.wtSettings.getSetting("totalRows");a=l-o.childNodes.length+a}else o===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return kl(Ju,n,this.wtRootElement)||kl(Zu,n,this.wtRootElement)||kl(tl,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(a,s)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),i=Gs(this.TBODY)-1,o,a,s,l,u;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,s=this.rowFilter.renderedToSource(r),o=this.getRowHeight(s),l=this.getTrForRow(s),u=l.querySelector("th"),u?a=Gs(u):a=Gs(l)-1,(!o&&this.wtSettings.getSetting("defaultRowHeight")<a||o<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return Qt(this.TABLE)}},{key:"getHeight",value:function(){return wr(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=Qt(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=wr(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return xg(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=sr(r)?r():null;return Array.isArray(n)?(n=MOe(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),t}();const Up=VOe;var jOe="stickyRowsBottom",bq={getFirstRenderedRow:function(){var e=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=e-r;return e===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Ts(bq,"MIXIN_NAME",jOe,{writable:!1,enumerable:!1});const wq=bq;var WOe="stickyColumnsStart",Sq={getFirstRenderedColumn:function(){var e=this.wtSettings.getSetting("totalColumns");return e===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Ts(Sq,"MIXIN_NAME",WOe,{writable:!1,enumerable:!1});const c3=Sq;function Lh(t){return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lh(t)}function M$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,GOe(n.key),n)}}function zOe(t,e,r){return e&&M$(t.prototype,e),r&&M$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function GOe(t){var e=YOe(t,"string");return Lh(e)==="symbol"?e:String(e)}function YOe(t,e){if(Lh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qOe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&KT(t,e)}function KT(t,e){return KT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},KT(t,e)}function XOe(t){var e=JOe();return function(){var n=fw(t),i;if(e){var o=fw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return QOe(this,i)}}function QOe(t,e){if(e&&(Lh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZOe(t)}function ZOe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function JOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fw(t){return fw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fw(t)}var f3=function(t){qOe(r,t);var e=XOe(r);function r(n,i,o,a){return KOe(this,r),e.call(this,n,i,o,a,tl)}return zOe(r)}(Up);ir(f3,wq);ir(f3,c3);const e7e=f3;var Qu="top",ta="bottom",Zu="inline_start",Ju="top_inline_start_corner",tl="bottom_inline_start_corner",t7e=[Qu,ta,Zu,Ju,tl],r7e=new Map([[Qu,"ht_clone_".concat(Qu)],[ta,"ht_clone_".concat(ta)],[Zu,"ht_clone_".concat(Zu," ht_clone_left")],[Ju,"ht_clone_".concat(Ju," ht_clone_top_left_corner")],[tl,"ht_clone_".concat(tl," ht_clone_bottom_left_corner")]]),n7e=Wr,i7e=Math.floor,o7e=Number.isInteger||function(e){return!n7e(e)&&isFinite(e)&&i7e(e)===e},a7e=tt,s7e=o7e;a7e({target:"Number",stat:!0},{isInteger:s7e});function ny(t){return ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ny(t)}function l7e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Rq(n.key),n)}}function u7e(t,e,r){return e&&N$(t.prototype,e),r&&N$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function TE(t,e,r){return e=Rq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rq(t){var e=c7e(t,"string");return ny(e)==="symbol"?e:String(e)}function c7e(t,e){if(ny(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ny(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var f7e=function(){function t(e){l7e(this,t),TE(this,"dataAccessObject",void 0),TE(this,"lastScrolledColumnPos",-1),TE(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}return u7e(t,[{key:"scrollViewport",value:function(r,n,i,o,a){var s=this.scrollViewportHorizontally(r.col,i,a),l=this.scrollViewportVertically(r.row,n,o);return s||l}},{key:"scrollViewportHorizontally",value:function(r,n,i){var o=this.dataAccessObject,a=o.drawn,s=o.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),c=n===void 0&&i===void 0,f=this.dataAccessObject,h=f.fixedColumnsStart,d=f.inlineStartOverlay;if(c&&r<h)return!1;var p=!1;return l===-1?p=d.scrollTo(r,c?r>this.lastScrolledColumnPos:n):(c&&(r<l||r>u)||!c)&&(p=d.scrollTo(r,c?r>u:n)),p&&(this.lastScrolledColumnPos=r),p}},{key:"scrollViewportVertically",value:function(r,n,i){var o=this.dataAccessObject,a=o.drawn,s=o.totalRows;if(!a||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),c=n===void 0&&i===void 0,f=this.dataAccessObject,h=f.fixedRowsBottom,d=f.fixedRowsTop,p=f.topOverlay;if(c&&(r<d||r>s-h-1))return!1;var m=!1;return l===-1?m=p.scrollTo(r,c?r>this.lastScrolledRowPos:i):(c&&(r<l||r>u)||!c)&&(m=p.scrollTo(r,c?r>u:i)),m&&(this.lastScrolledRowPos=r),m}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,o=r.wtViewport,a=r.totalRows,s=r.fixedRowsTop,l=r.rootWindow,u=i.getFirstVisibleRow();if(n.mainTableScrollableElement===l){var c=Zr(i.wtRootElement),f=Gs(i.hider),h=Gs(l),d=X2(l,l);if(c.top+f-h<=d){var p=o.getColumnHeaderHeight();p+=n.sumCellSizes(0,s);for(var m=a;m>0;m--)if(p+=n.sumCellSizes(m-1,m),c.top+f-p<=d){u=m;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,o=r.wtViewport,a=r.totalRows,s=r.rootWindow,l=i.getLastVisibleRow();if(n.mainTableScrollableElement===s){var u=Zr(i.wtRootElement),c=X2(s,s);if(u.top>c){for(var f=Gs(s),h=o.getColumnHeaderHeight(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-c>=f){l=d-2;break}}}return l}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,i=r.wtTable,o=r.wtViewport,a=r.totalColumns,s=r.rootWindow,l=i.getFirstVisibleColumn();if(n.mainTableScrollableElement===s){var u=Zr(i.wtRootElement),c=zb(i.hider),f=zb(s),h=Math.abs(pT(s,s));if(u.left+c-f<=h){for(var d=o.getRowHeaderWidth(),p=a;p>0;p--)if(d+=n.sumCellSizes(p-1,p),u.left+c-d<=h){l=p;break}}}return l}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,i=r.inlineStartOverlay,o=r.wtTable,a=r.wtViewport,s=r.totalColumns,l=r.rootWindow,u=o.getLastVisibleColumn();if(i.mainTableScrollableElement===l){var c=n.getSetting("rtlMode"),f=null;if(c){var h=o.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document,p=d.documentElement.offsetWidth;f=Math.abs(h.right-p)}else{var m=Zr(o.wtRootElement);f=m.left}var g=Math.abs(pT(l,l));if(f>g){for(var v=zb(l),w=a.getRowHeaderWidth(),b=1;b<=s;b++)if(w+=i.sumCellSizes(b-1,b),f+w-g>=v){u=b-2;break}}}return u}}]),t}();const h7e=f7e;function iy(t){return iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iy(t)}function d7e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Eq(n.key),n)}}function p7e(t,e,r){return e&&P$(t.prototype,e),r&&P$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ho(t,e,r){return e=Eq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Eq(t){var e=m7e(t,"string");return iy(e)==="symbol"?e:String(e)}function m7e(t,e){if(iy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(iy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var h3=function(){function t(e,r){d7e(this,t),ho(this,"wtTable",void 0),ho(this,"wtScroll",void 0),ho(this,"wtViewport",void 0),ho(this,"wtOverlays",void 0),ho(this,"selections",void 0),ho(this,"wtEvent",void 0),ho(this,"guid","wt_".concat(wK())),ho(this,"drawInterrupted",!1),ho(this,"drawn",!1),ho(this,"domBindings",void 0),ho(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new h7e(this.createScrollDao())}return p7e(t,[{key:"eventManager",get:function(){return new Er(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(o,a){Yu(a,r[o])}])}}},{key:"createCellCoords",value:function(r,n){return new rw(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,i){return new u3(r,n,i,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var i=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<o&&r.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<s&&r.row>=i-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<i&&r.row>=i-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,i,o,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),t}();function Dh(t){return Dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dh(t)}function k$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Cq(n.key),n)}}function g7e(t,e,r){return e&&k$(t.prototype,e),r&&k$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function y7e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v7e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qT(t,e)}function qT(t,e){return qT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},qT(t,e)}function b7e(t){var e=S7e();return function(){var n=hw(t),i;if(e){var o=hw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return w7e(this,i)}}function w7e(t,e){if(e&&(Dh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xb(t)}function Xb(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S7e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hw(t){return hw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hw(t)}function $$(t,e,r){return e=Cq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cq(t){var e=R7e(t,"string");return Dh(e)==="symbol"?e:String(e)}function R7e(t,e){if(Dh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var E7e=function(t){v7e(r,t);var e=b7e(r);function r(n,i,o){var a;y7e(this,r),a=e.call(this,n,i),$$(Xb(a),"cloneSource",void 0),$$(Xb(a),"cloneOverlay",void 0);var s=a.wtSettings.getSetting("facade",Xb(a));return a.cloneSource=o.source,a.cloneOverlay=o.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),s,a.domBindings,a.wtSettings),a.wtViewport=o.viewport,a.selections=o.selections,a.wtEvent=new pq(s,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,o.event),a.findOriginalHeaders(),a}return g7e(r)}(h3);function oy(t){return oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oy(t)}function C7e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function L$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_q(n.key),n)}}function _7e(t,e,r){return e&&L$(t.prototype,e),r&&L$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function T7e(t,e,r){return e=_q(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _q(t){var e=O7e(t,"string");return oy(e)==="symbol"?e:String(e)}function O7e(t,e){if(oy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(oy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var P1=function(){function t(e,r,n,i,o){C7e(this,t),T7e(this,"wtSettings",null),Ts(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;var a=this.wot.wtTable,s=a.TABLE,l=a.hider,u=a.spreader,c=a.holder,f=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=l,this.spreader=u,this.holder=c,this.wtRootElement=f,this.trimmingContainer=Ng(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return _7e(t,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Ng(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Q2(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,i){if(this.clone.wtTable.holder.contains(r)===!1){Xt("The provided element is not a child of the ".concat(this.type," overlay"));return}var o=this.mainTableScrollableElement===this.domBindings.rootWindow,a=i<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),l=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(u),top:u.offsetTop},f={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return o?h=this.getRelativeCellPositionWithinWindow(s,a,f,c):h=this.getRelativeCellPositionWithinHolder(s,l,a,f,c),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,i,o){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,l=0;if(!n)s=o.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+gn())),s=u<=0?-1*u:0}if(r){var c=this.clone.wtTable.TABLE.getBoundingClientRect();l=c.top-a.top}else l=o.top;return{start:i.start+s,top:i.top+l}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,i,o,a){var s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},l=0,u=0;if(i||(l=s.horizontal-a.start),n){var c=this.wot.wtTable.wtRootElement.getBoundingClientRect(),f=this.clone.wtTable.TABLE.getBoundingClientRect();u=f.top*-1+c.top}else r||(u=s.vertical-a.top);return{start:o.start-l,top:o.top-u}}},{key:"makeClone",value:function(){if(t7e.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,a=i.createElement("DIV"),s=i.createElement("TABLE"),l=r.wtRootElement.parentNode;a.className="".concat(r7e.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,s.className=r.TABLE.className,a.appendChild(s),l.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Qu||u==="vertical"&&this.type===Zu?this.mainTableScrollableElement=o:o.getComputedStyle(l).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=Q2(r.TABLE),new E7e(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(!!this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=r.style,o=n.style,a=r.parentNode.style;ae([i,o,a],function(s){s.width="",s.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),t}();function Fh(t){return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fh(t)}function Qb(t,e,r){return Tq()?Qb=Reflect.construct.bind():Qb=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&dw(u,a.prototype),u},Qb.apply(null,arguments)}function A7e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function D$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,x7e(n.key),n)}}function I7e(t,e,r){return e&&D$(t.prototype,e),r&&D$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function x7e(t){var e=M7e(t,"string");return Fh(e)==="symbol"?e:String(e)}function M7e(t,e){if(Fh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function N7e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dw(t,e)}function dw(t,e){return dw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},dw(t,e)}function P7e(t){var e=Tq();return function(){var n=pw(t),i;if(e){var o=pw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return k7e(this,i)}}function k7e(t,e){if(e&&(Fh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $7e(t)}function $7e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Tq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pw(t){return pw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pw(t)}var L7e=function(t){N7e(r,t);var e=P7e(r);function r(n,i,o,a,s,l){var u;return A7e(this,r),u=e.call(this,n,i,tl,o,a),u.bottomOverlay=s,u.inlineStartOverlay=l,u}return I7e(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Qb(e7e,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot;if(this.updateTrimmingContainer(),!i.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(o.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();o.style[this.isRtl()?"right":"left"]="".concat(a,"px"),o.style.bottom="".concat(s,"px")}else w6(o),this.repositionOverlay();var l=wr(this.clone.wtTable.TABLE),u=Qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),o.style.height="".concat(l,"px"),o.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var i=this.wot,o=i.wtTable,a=i.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-o.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=gn(s)),l.style.bottom="".concat(u,"px")}}]),r}(P1),D7e="calculatedColumns",Oq={getFirstRenderedColumn:function(){var e=this.dataAccessObject.startColumnRendered;return e===null?-1:e},getFirstVisibleColumn:function(){var e=this.dataAccessObject.startColumnVisible;return e===null?-1:e},getLastRenderedColumn:function(){var e=this.dataAccessObject.endColumnRendered;return e===null?-1:e},getLastVisibleColumn:function(){var e=this.dataAccessObject.endColumnVisible;return e===null?-1:e},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Ts(Oq,"MIXIN_NAME",D7e,{writable:!1,enumerable:!1});const d3=Oq;function Hh(t){return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hh(t)}function F$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,H7e(n.key),n)}}function F7e(t,e,r){return e&&F$(t.prototype,e),r&&F$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function H7e(t){var e=B7e(t,"string");return Hh(e)==="symbol"?e:String(e)}function B7e(t,e){if(Hh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function U7e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function V7e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&XT(t,e)}function XT(t,e){return XT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},XT(t,e)}function j7e(t){var e=G7e();return function(){var n=mw(t),i;if(e){var o=mw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return W7e(this,i)}}function W7e(t,e){if(e&&(Hh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return z7e(t)}function z7e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function G7e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mw(t){return mw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mw(t)}var p3=function(t){V7e(r,t);var e=j7e(r);function r(n,i,o,a){return U7e(this,r),e.call(this,n,i,o,a,ta)}return F7e(r)}(Up);ir(p3,wq);ir(p3,d3);const Y7e=p3;function Bh(t){return Bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bh(t)}function Zb(t,e,r){return Iq()?Zb=Reflect.construct.bind():Zb=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&gw(u,a.prototype),u},Zb.apply(null,arguments)}function K7e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function H$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xq(n.key),n)}}function q7e(t,e,r){return e&&H$(t.prototype,e),r&&H$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function X7e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gw(t,e)}function gw(t,e){return gw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gw(t,e)}function Q7e(t){var e=Iq();return function(){var n=yw(t),i;if(e){var o=yw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Z7e(this,i)}}function Z7e(t,e){if(e&&(Bh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Aq(t)}function Aq(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Iq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yw(t){return yw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yw(t)}function J7e(t,e,r){return e=xq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xq(t){var e=eAe(t,"string");return Bh(e)==="symbol"?e:String(e)}function eAe(t,e){if(Bh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var tAe=function(t){X7e(r,t);var e=Q7e(r);function r(n,i,o,a){var s;return K7e(this,r),s=e.call(this,n,i,ta,o,a),J7e(Aq(s),"cachedFixedRowsBottom",-1),s.cachedFixedRowsBottom=s.wtSettings.getSetting("fixedRowsBottom"),s}return q7e(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Zb(Y7e,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.domBindings.rootWindow,o=this.clone.wtTable.holder.parentNode;o.style.top="";var a=0,s=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===i&&(!s||s!=="vertical")?(a=this.getOverlayOffset(),o.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var l=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),l}},{key:"repositionOverlay",value:function(){var i=this.wot,o=i.wtTable,a=i.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-o.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=gn(s)),l.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===o?(o.scrollTo(dh(o),i),a=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wot,s=a.wtTable,l=a.wtSettings,u=l.getSetting("defaultRowHeight"),c=i,f=0;c<o;){var h=s.getRowHeight(c);f+=h===void 0?u:h,c+=1}return f}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot,o=i.wtTable,a=i.wtViewport,s=this.domBindings,l=s.rootDocument,u=s.rootWindow,c=gn(l),f=this.clone.wtTable.holder.parentNode,h=f.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var p=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(p-=c),p=Math.min(p,o.wtRootElement.scrollWidth),h.width="".concat(p,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var m=wr(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(m=0),h.height="".concat(m,"px")}},{key:"adjustRootChildrenSize",value:function(){var i=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height=i.parentNode.style.height}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[i]=""}},{key:"scrollTo",value:function(i,o){var a=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;o&&l.offsetHeight!==l.clientHeight&&(u=gn(this.domBindings.rootDocument)),o?(a+=this.sumCellSizes(0,i+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),i),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return X2(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===i&&(!o||o!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l,c=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-c+s,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(i){var o=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==o,s=this.wtSettings.getSetting("columnHeaders"),l=!1;if((a||o===0)&&s.length>0){var u=this.wot.wtTable.holder.parentNode,c=at(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),i||this.wtSettings.getSetting("totalRows")===0?(_e(u,"innerBorderBottom"),l=!c):(ut(u,"innerBorderBottom"),l=c)}return l}}]),r}(P1),rAe="calculatedRows",Mq={getFirstRenderedRow:function(){var e=this.dataAccessObject.startRowRendered;return e===null?-1:e},getFirstVisibleRow:function(){var e=this.dataAccessObject.startRowVisible;return e===null?-1:e},getLastRenderedRow:function(){var e=this.dataAccessObject.endRowRendered;return e===null?-1:e},getLastVisibleRow:function(){var e=this.dataAccessObject.endRowVisible;return e===null?-1:e},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Ts(Mq,"MIXIN_NAME",rAe,{writable:!1,enumerable:!1});const Nq=Mq;function Uh(t){return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uh(t)}function B$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,iAe(n.key),n)}}function nAe(t,e,r){return e&&B$(t.prototype,e),r&&B$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function iAe(t){var e=oAe(t,"string");return Uh(e)==="symbol"?e:String(e)}function oAe(t,e){if(Uh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&QT(t,e)}function QT(t,e){return QT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},QT(t,e)}function lAe(t){var e=fAe();return function(){var n=vw(t),i;if(e){var o=vw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return uAe(this,i)}}function uAe(t,e){if(e&&(Uh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cAe(t)}function cAe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vw(t){return vw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vw(t)}var m3=function(t){sAe(r,t);var e=lAe(r);function r(n,i,o,a){return aAe(this,r),e.call(this,n,i,o,a,Zu)}return nAe(r)}(Up);ir(m3,Nq);ir(m3,c3);const hAe=m3;function Vh(t){return Vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vh(t)}function Jb(t,e,r){return Pq()?Jb=Reflect.construct.bind():Jb=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&bw(u,a.prototype),u},Jb.apply(null,arguments)}function dAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mAe(n.key),n)}}function pAe(t,e,r){return e&&U$(t.prototype,e),r&&U$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mAe(t){var e=gAe(t,"string");return Vh(e)==="symbol"?e:String(e)}function gAe(t,e){if(Vh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bw(t,e)}function bw(t,e){return bw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bw(t,e)}function vAe(t){var e=Pq();return function(){var n=ww(t),i;if(e){var o=ww(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return bAe(this,i)}}function bAe(t,e){if(e&&(Vh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wAe(t)}function wAe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Pq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ww(t){return ww=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ww(t)}var SAe=function(t){yAe(r,t);var e=vAe(r);function r(n,i,o,a){return dAe(this,r),e.call(this,n,i,Zu,o,a)}return pAe(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Jb(hAe,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot.wtTable;if(!this.needFullRender||!i.holder.parentNode)return!1;var o=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,s=this.wtSettings.getSetting("preventOverflow"),l=0;this.trimmingContainer===o&&(!s||s!=="horizontal")?(l=this.getOverlayOffset()*(this.isRtl()?-1:1),W8(a,"".concat(l,"px"),"0px")):(l=this.getScrollPosition(),w6(a));var u=this.adjustHeaderBordersPosition(l);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(i=-i),this.mainTableScrollableElement===o&&o.scrollX!==i?(o.scrollTo(i,Mg(o)),a=!0):this.mainTableScrollableElement.scrollLeft!==i&&(this.mainTableScrollableElement.scrollLeft=i,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),s=i,l=0;s<o;)l+=this.wot.wtTable.getStretchedColumnWidth(s)||a,s+=1;return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,o=this.domBindings,a=o.rootDocument,s=o.rootWindow,l=gn(a),u=this.clone.wtTable.holder.parentNode,c=u.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||f==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=l),h=Math.min(h,i.wtRootElement.scrollHeight),c.height="".concat(h,"px")}else c.height="";this.clone.wtTable.holder.style.height=c.height;var d=Qt(this.clone.wtTable.TABLE);c.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,o=this.clone.wtTable.holder,a=this.wot.selections,s=this.facadeGetter(),l=Math.abs((i=a==null?void 0:a.getCell().getBorder(s).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.height=this.hider.style.height,o.style.height=o.parentNode.style.height,o.style.width="".concat(parseInt(o.parentNode.style.width,10)+l,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalColumns"),o=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style[o]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(i,o){var a=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;if(o){var c=this.wot.wtTable.getColumnWidth(i),f=this.wot.wtViewport.getViewportWidth();c>f&&(o=!1)}return o&&l.offsetWidth!==l.clientWidth&&(u=gn(this.domBindings.rootDocument)),o?(a+=this.sumCellSizes(0,i+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),i),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var i=this.wtSettings.getSetting("preventOverflow"),o=0;return!i&&this.trimmingContainer===this.domBindings.rootWindow&&(o=this.wot.wtTable.holderOffset.left),o}},{key:"getScrollPosition",value:function(){return Math.abs(pT(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===i&&(!o||o!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var s=this.wot.wtTable.getTotalWidth(),l=this.clone.wtTable.getTotalWidth(),u=s-l;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(i){var o=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),s=this.wtSettings.getSetting("fixedColumnsStart"),l=this.wtSettings.getSetting("totalRows");l?ut(o,"emptyRows"):_e(o,"emptyRows");var u=!1;if(s&&!a.length)_e(o,"innerBorderLeft innerBorderInlineStart");else if(!s&&a.length){var c=at(o,"innerBorderInlineStart");i?(_e(o,"innerBorderLeft innerBorderInlineStart"),u=!c):(ut(o,"innerBorderLeft innerBorderInlineStart"),u=c)}return u}}]),r}(P1),RAe="stickyRowsTop",kq={getFirstRenderedRow:function(){var e=this.wtSettings.getSetting("totalRows");return e===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Ts(kq,"MIXIN_NAME",RAe,{writable:!1,enumerable:!1});const $q=kq;function jh(t){return jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jh(t)}function V$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,CAe(n.key),n)}}function EAe(t,e,r){return e&&V$(t.prototype,e),r&&V$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function CAe(t){var e=_Ae(t,"string");return jh(e)==="symbol"?e:String(e)}function _Ae(t,e){if(jh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ZT(t,e)}function ZT(t,e){return ZT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ZT(t,e)}function AAe(t){var e=MAe();return function(){var n=Sw(t),i;if(e){var o=Sw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return IAe(this,i)}}function IAe(t,e){if(e&&(jh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xAe(t)}function xAe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function MAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sw(t){return Sw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sw(t)}var g3=function(t){OAe(r,t);var e=AAe(r);function r(n,i,o,a){return TAe(this,r),e.call(this,n,i,o,a,Ju)}return EAe(r)}(Up);ir(g3,$q);ir(g3,c3);const NAe=g3;function Wh(t){return Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wh(t)}function e2(t,e,r){return Lq()?e2=Reflect.construct.bind():e2=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&Rw(u,a.prototype),u},e2.apply(null,arguments)}function PAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dq(n.key),n)}}function kAe(t,e,r){return e&&j$(t.prototype,e),r&&j$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $Ae(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rw(t,e)}function Rw(t,e){return Rw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Rw(t,e)}function LAe(t){var e=Lq();return function(){var n=Ew(t),i;if(e){var o=Ew(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return DAe(this,i)}}function DAe(t,e){if(e&&(Wh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JT(t)}function JT(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Lq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ew(t){return Ew=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ew(t)}function W$(t,e,r){return e=Dq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Dq(t){var e=FAe(t,"string");return Wh(e)==="symbol"?e:String(e)}function FAe(t,e){if(Wh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var HAe=function(t){$Ae(r,t);var e=LAe(r);function r(n,i,o,a,s,l){var u;return PAe(this,r),u=e.call(this,n,i,Ju,o,a),W$(JT(u),"topOverlay",void 0),W$(JT(u),"inlineStartOverlay",void 0),u.topOverlay=s,u.inlineStartOverlay=l,u}return kAe(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return e2(NAe,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var o=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();W8(i,"".concat(o,"px"),"".concat(a,"px"))}else w6(i);var s=wr(this.clone.wtTable.TABLE),l=Qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(l,"px"),!1}}]),r}(P1);function zh(t){return zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zh(t)}function z$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,UAe(n.key),n)}}function BAe(t,e,r){return e&&z$(t.prototype,e),r&&z$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function UAe(t){var e=VAe(t,"string");return zh(e)==="symbol"?e:String(e)}function VAe(t,e){if(zh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eO(t,e)}function eO(t,e){return eO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},eO(t,e)}function zAe(t){var e=KAe();return function(){var n=Cw(t),i;if(e){var o=Cw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return GAe(this,i)}}function GAe(t,e){if(e&&(zh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YAe(t)}function YAe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function KAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cw(t){return Cw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cw(t)}var y3=function(t){WAe(r,t);var e=zAe(r);function r(n,i,o,a){return jAe(this,r),e.call(this,n,i,o,a,Qu)}return BAe(r)}(Up);ir(y3,$q);ir(y3,d3);const qAe=y3;function Gh(t){return Gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gh(t)}function t2(t,e,r){return Hq()?t2=Reflect.construct.bind():t2=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&_w(u,a.prototype),u},t2.apply(null,arguments)}function XAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function G$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Bq(n.key),n)}}function QAe(t,e,r){return e&&G$(t.prototype,e),r&&G$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_w(t,e)}function _w(t,e){return _w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_w(t,e)}function JAe(t){var e=Hq();return function(){var n=Tw(t),i;if(e){var o=Tw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return e4e(this,i)}}function e4e(t,e){if(e&&(Gh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fq(t)}function Fq(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Hq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tw(t){return Tw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tw(t)}function t4e(t,e,r){return e=Bq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bq(t){var e=r4e(t,"string");return Gh(e)==="symbol"?e:String(e)}function r4e(t,e){if(Gh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var n4e=function(t){ZAe(r,t);var e=JAe(r);function r(n,i,o,a){var s;return XAe(this,r),s=e.call(this,n,i,Qu,o,a),t4e(Fq(s),"cachedFixedRowsTop",-1),s.cachedFixedRowsTop=s.wtSettings.getSetting("fixedRowsTop"),s}return QAe(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t2(qAe,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode,o=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),s=0,l=!1;if(this.trimmingContainer===o&&(!a||a!=="vertical")){var u=this.wot.wtTable,c=u.hider.getBoundingClientRect(),f=Math.ceil(c.bottom),h=i.offsetHeight;l=f===h,s=this.getOverlayOffset(),W8(i,"0px","".concat(s,"px"))}else s=this.getScrollPosition(),w6(i);var d=this.adjustHeaderBordersPosition(s,l);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===o&&o.scrollY!==i?(o.scrollTo(dh(o),i),a=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wtSettings.getSetting("defaultRowHeight"),s=i,l=0;s<o;){var u=this.wot.wtTable.getRowHeight(s);l+=u===void 0?a:u,s+=1}return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,o=this.domBindings,a=o.rootDocument,s=o.rootWindow,l=gn(a),u=this.clone.wtTable.holder.parentNode,c=u.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||f==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=l),h=Math.min(h,i.wtRootElement.scrollWidth),c.width="".concat(h,"px")}else c.width="";this.clone.wtTable.holder.style.width=c.width;var d=wr(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),c.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,o=this.clone.wtTable.holder,a=this.wot.selections,s=this.facadeGetter(),l=Math.abs((i=a==null?void 0:a.getCell().getBorder(s).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height="".concat(parseInt(o.parentNode.style.height,10)+l,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[i]=""}},{key:"scrollTo",value:function(i,o){var a=this.wot,s=this.wtSettings,l=a.cloneSource?a.cloneSource:a,u=l.wtTable.holder,c=this.getTableParentOffset(),f=0;if(o){var h=this.wot.wtTable.getRowHeight(i),d=this.wot.wtViewport.getViewportHeight();h>d&&(o=!1)}if(o&&u.offsetHeight!==u.clientHeight&&(f=gn(this.domBindings.rootDocument)),o){var p=s.getSetting("fixedRowsBottom"),m=s.getSetting("totalRows");c+=this.sumCellSizes(0,i+1),c-=a.wtViewport.getViewportHeight()-this.sumCellSizes(m-p,m),c+=1}else c+=this.sumCellSizes(s.getSetting("fixedRowsTop"),i);return c+=f,this.setScrollPosition(c)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return X2(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===i&&(!o||o!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,s=this.wtSettings.getSetting("totalColumns");s?ut(a,"emptyColumns"):_e(a,"emptyColumns");var l=!1;if(!o){var u=this.wtSettings.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==u,f=this.wtSettings.getSetting("columnHeaders");if((c||u===0)&&f.length>0){var h=at(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),i||this.wtSettings.getSetting("totalRows")===0?(_e(a,"innerBorderTop"),l=!h):(ut(a,"innerBorderTop"),l=h)}}return l}}]),r}(P1);function ay(t){return ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ay(t)}function js(t,e,r){return i4e()?js=Reflect.construct.bind():js=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&tO(u,a.prototype),u},js.apply(null,arguments)}function i4e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tO(t,e){return tO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},tO(t,e)}function o4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Uq(n.key),n)}}function a4e(t,e,r){return e&&Y$(t.prototype,e),r&&Y$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ea(t,e,r){return e=Uq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uq(t){var e=s4e(t,"string");return ay(e)==="symbol"?e:String(e)}function s4e(t,e){if(ay(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ay(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var l4e=function(){function t(e,r,n,i,o,a){var s=this;o4e(this,t),Ea(this,"wot",null),Ea(this,"topOverlay",null),Ea(this,"bottomOverlay",null),Ea(this,"inlineStartOverlay",null),Ea(this,"topInlineStartCornerOverlay",null),Ea(this,"bottomInlineStartCornerOverlay",null),Ea(this,"browserLineHeight",void 0),Ea(this,"wtSettings",null),Ea(this,"resizeObserver",new ResizeObserver(function(h){V8(function(){!Array.isArray(h)||!h.length||s.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var l=this.domBindings,u=l.rootDocument,c=l.rootWindow;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=gn(u);var f=c.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=f?a.holder:Q2(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}return a4e(t,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,i=r.rootDocument,o=n.getComputedStyle(i.body),a=parseInt(o.lineHeight,10),s=parseInt(o.fontSize,10)*1.2;this.browserLineHeight=a||s}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=js(n4e,r),this.bottomOverlay=js(tAe,r),this.inlineStartOverlay=js(SAe,r),this.topInlineStartCornerOverlay=js(HAe,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=js(L7e,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(!!this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,s=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(i.documentElement,"keydown",function(p){return r.onKeyDown(p)}),this.eventManager.addEventListener(i.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(i,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(p){return r.onTableScroll(p)},{passive:!0}),a!==s&&this.eventManager.addEventListener(s,"scroll",function(p){return r.onTableScroll(p)},{passive:!0});var l=o.devicePixelRatio&&o.devicePixelRatio>1,u=this.scrollableElement===o,c=this.wtSettings.getSetting("preventWheel"),f={passive:u};(c||l||!lK())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(p){return r.onCloneWheel(p,c)},f);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(p){if(p&&p.needFullRender){var m=p.clone.wtTable.holder;r.eventManager.addEventListener(m,"wheel",function(g){return r.onCloneWheel(g,c)},f)}});var d;this.eventManager.addEventListener(o,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(o!==n&&a!==n&&!r.target.contains(o)||i!==n&&a!==n&&!r.target.contains(i))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var i=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,s=r.target,l=a!==i&&s!==i&&!s.contains(a),u=o!==i&&s!==i&&!s.contains(o);if(!(this.keyPressed&&(l||u))){var c=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==i&&c)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=Ig(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,i=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);var o=this.scrollVertically(n),a=this.scrollHorizontally(i);return o||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,o=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=o[0],s=o[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=i.scrollTop!==s||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var l=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;l&&(l.scrollLeft=a)}this.verticalScrolling&&(i.scrollTop=s),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,i=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=Q2(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,i=r.clientHeight,o=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),o}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,i=this.wtTable,o=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),l=n.getColumnHeaderHeight(),u=i.hider.style;if(u.width="".concat(s+this.inlineStartOverlay.sumCellSizes(0,o),"px"),u.height="".concat(l+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var c=i.wtRootElement,f=c.scrollHeight,h=c.scrollWidth,d=i.holder,p=d.scrollHeight,m=d.scrollWidth;this.hasScrollbarRight=f<p,this.hasScrollbarBottom=h<m,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>f&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){!this.wtTable.isVisible()||(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return ae(n,function(o){!o||o.clone&&o.clone.wtTable.TABLE.contains(r)&&(i=o.clone)}),i}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];ae(n,function(i){!i||(i.clone.wtTable.TABLE.className=r.className)})}}]),t}();const u4e=l4e;function sy(t){return sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sy(t)}function c4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vq(n.key),n)}}function f4e(t,e,r){return e&&K$(t.prototype,e),r&&K$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function q$(t,e,r){return e=Vq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vq(t){var e=h4e(t,"string");return sy(e)==="symbol"?e:String(e)}function h4e(t,e){if(sy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(sy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var d4e=function(){function t(e){var r=this;c4e(this,t),q$(this,"settings",{}),q$(this,"defaults",Object.freeze(this.getDefaults())),Rt(this.defaults,function(n,i){if(e[i]!==void 0)r.settings[i]=e[i];else{if(n===void 0)throw new Error('A required setting "'.concat(i,'" was not provided'));r.settings[i]=n}})}return f4e(t,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(i,o,a){var s=r.getSetting("data",i,o);Yu(a,s==null?"":s)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(i){return i},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(i){return i},onBeforeHighlightingColumnHeader:function(i){return i},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var i=this;return n===void 0?Rt(r,function(o,a){i.settings[a]=o}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,i,o,a){return typeof this.settings[r]=="function"?this.settings[r](n,i,o,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),t}();function Yh(t){return Yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yh(t)}function p4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function X$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g4e(n.key),n)}}function m4e(t,e,r){return e&&X$(t.prototype,e),r&&X$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function g4e(t){var e=y4e(t,"string");return Yh(e)==="symbol"?e:String(e)}function y4e(t,e){if(Yh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function v4e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rO(t,e)}function rO(t,e){return rO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rO(t,e)}function b4e(t){var e=R4e();return function(){var n=Ow(t),i;if(e){var o=Ow(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return w4e(this,i)}}function w4e(t,e){if(e&&(Yh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return S4e(t)}function S4e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function R4e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ow(t){return Ow=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ow(t)}var v3=function(t){v4e(r,t);var e=b4e(r);function r(n,i,o,a){return p4e(this,r),e.call(this,n,i,o,a,"master")}return m4e(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var i=Ng(this.wtRootElement),o=this.domBindings.rootWindow;if(i===o){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var s=i.parentElement,l=Pg(i,"height",o),u=Pg(i,"overflow",o),c=this.holder.style,f=i.scrollWidth,h=i.scrollHeight,d=i.getBoundingClientRect(),p=d.width,m=d.height,g=["auto","hidden","scroll"];if(s&&g.includes(u)){var v=i.cloneNode(!1);v.style.overflow="auto",v.style.position="absolute",i.nextElementSibling?s.insertBefore(v,i.nextElementSibling):s.appendChild(v);var w=parseInt(Ku(v,o).height,10);s.removeChild(v),w===0&&(m=0)}m=Math.min(m,h),c.height=l==="auto"?"auto":"".concat(m,"px"),p=Math.min(p,f),c.width="".concat(p,"px"),c.overflow="",this.hasTableHeight=c.height==="auto"?!0:m>0,this.hasTableWidth=p>0}this.isTableVisible=xg(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var i=this.wtSettings,o=this.dataAccessObject.wtViewport,a="master",s=i.getSetting("columnHeaders"),l=s.length;if(l&&!o.hasOversizedColumnHeadersMarked[a]){for(var u=i.getSetting("rowHeaders"),c=u.length,f=this.getRenderedColumnsCount(),h=0;h<l;h++)for(var d=-1*c;d<f;d++)this.markIfOversizedColumnHeader(d);o.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(Up);ir(v3,Nq);ir(v3,d3);const E4e=v3;function ly(t){return ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ly(t)}function C4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,T4e(n.key),n)}}function _4e(t,e,r){return e&&Q$(t.prototype,e),r&&Q$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function T4e(t){var e=O4e(t,"string");return ly(e)==="symbol"?e:String(e)}function O4e(t,e){if(ly(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ly(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var A4e=function(){function t(e,r,n,i,o){var a=this;C4e(this,t),this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return _4e(t,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,i=0;if(n===this.domBindings.rootWindow)i=r.documentElement.clientHeight;else{var o=wr(n);i=o>0&&n.clientHeight>0?n.clientHeight:1/0}return i}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=i.documentElement.offsetWidth,l=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),c=r.getSetting("rtlMode"),f=this.wtTable.TABLE.getBoundingClientRect(),h=c?f.right-s:f.left,d=s-h,p,m;if(u)return Qt(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?p=Math.min(d,s):p=Math.min(this.getContainerFillWidth(),d,s),a===o&&l>0&&this.sumColumnWidths(0,l-1)>p)return i.documentElement.clientWidth;if(a!==o&&(m=Pg(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o),m==="scroll"||m==="hidden"||m==="auto"))return Math.max(p,a.clientWidth);var g=r.getSetting("stretchH");return g==="none"||!g?Math.max(p,Qt(this.wtTable.TABLE)):p}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var i=0,o=r;o<n;)i+=this.wtTable.getColumnWidth(o),o+=1;return i}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var i=n.offsetWidth;return this.containerWidth=i,r.removeChild(n),i}},{key:"getWorkspaceOffset",value:function(){return Zr(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=wr(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var i=0,o=n.length;i<o;i++)this.rowHeaderWidth+=r[i]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var s=0,l=n.length;s<l;s++)a?(this.rowHeaderWidth+=Qt(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ru,n=this.wtSettings,i=this.wtTable,o,a,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===ru?o=1/0:o=this.getViewportHeight();var l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),c=n.getSetting("fixedRowsBottom"),f=n.getSetting("totalRows");return u&&l>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,u),l+=s,o-=s),c&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(f-c,f),o-=s),i.holder.clientHeight===i.holder.offsetHeight?a=0:a=gn(this.domBindings.rootDocument),new uq({viewportSize:o,scrollOffset:l,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return i.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ru,n=this.wtSettings,i=this.wtTable,o=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var s=n.getSetting("fixedColumnsStart");if(s&&a>=0){var l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);a+=l,o-=l}return i.holder.clientWidth!==i.holder.offsetWidth&&(o-=gn(this.domBindings.rootDocument)),new l3({viewportSize:o,scrollOffset:a,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(c){return i.getColumnWidth(c)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(c,f){return n.getSetting("onBeforeStretchingColumnWidth",c,f)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var i=this.createRowsCalculator(Ln),o=this.createColumnsCalculator(Ln);this.areAllProposedVisibleRowsAlreadyRendered(i)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(ru),this.columnsRenderCalculator=this.createColumnsCalculator(ru)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(Ln),this.columnsVisibleCalculator=this.createColumnsCalculator(Ln)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,i=r.endRow,o=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!o;var a=this.rowsRenderCalculator,s=a.startRow,l=a.endRow;return n<s||n===s&&n>0?!1:!(i>l||i===l&&i<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,i=r.endColumn,o=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!o;var a=this.columnsRenderCalculator,s=a.startColumn,l=a.endColumn;return n<s||n===s&&n>0?!1:!(i>l||i===l&&i<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Rt(this.hasOversizedColumnHeadersMarked,function(r,n,i){i[n]=void 0})}}]),t}();const I4e=A4e;function Kh(t){return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kh(t)}function x4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Z$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,N4e(n.key),n)}}function M4e(t,e,r){return e&&Z$(t.prototype,e),r&&Z$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function N4e(t){var e=P4e(t,"string");return Kh(e)==="symbol"?e:String(e)}function P4e(t,e){if(Kh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function k4e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nO(t,e)}function nO(t,e){return nO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},nO(t,e)}function $4e(t){var e=D4e();return function(){var n=Aw(t),i;if(e){var o=Aw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return L4e(this,i)}}function L4e(t,e){if(e&&(Kh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iO(t)}function iO(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function D4e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Aw(t){return Aw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Aw(t)}var F4e=function(t){k4e(r,t);var e=$4e(r);function r(n,i){var o;x4e(this,r),o=e.call(this,n,new d4e(i));var a=o.wtSettings.getSetting("facade",iO(o));return o.wtTable=new E4e(o.getTableDao(),a,o.domBindings,o.wtSettings),o.wtViewport=new I4e(o.getViewportDao(),o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.selections=o.wtSettings.getSetting("selections"),o.wtEvent=new pq(a,o.domBindings,o.wtSettings,o.eventManager,o.wtTable,o.selections),o.wtOverlays=new u4e(iO(o),a,o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.exportSettingsAsClassNames(),o.findOriginalHeaders(),o}return M4e(r,[{key:"exportSettingsAsClassNames",value:function(){var i=this,o={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],s=[];Rt(o,function(l,u){i.wtSettings.getSetting(u).length&&s.push(l),a.push(l)}),ut(this.wtTable.wtRootElement.parentNode,a),_e(this.wtTable.wtRootElement.parentNode,s)}},{key:"getViewportDao",value:function(){var i=this;return{get wot(){return i},get topOverlayTrimmingContainer(){return i.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return i.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return i.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return i.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return i.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return i.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return i.wtOverlays.topOverlay},get inlineStartOverlay(){return i.wtOverlays.inlineStartOverlay},get bottomOverlay(){return i.wtOverlays.bottomOverlay}}}}]),r}(h3);function uy(t){return uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uy(t)}function H4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function J$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,U4e(n.key),n)}}function B4e(t,e,r){return e&&J$(t.prototype,e),r&&J$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function U4e(t){var e=V4e(t,"string");return uy(e)==="symbol"?e:String(e)}function V4e(t,e){if(uy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(uy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var j4e=function(){function t(e){H4e(this,t),e instanceof h3?this._wot=e:this._initFromSettings(e)}return B4e(t,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var i=new t(n);return function(){return i}},this._wot=new F4e(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,i){return this._wot.createCellRange(r,n,i)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,i,o,a){return this._wot.scrollViewport(r,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wot.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wot.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,i,o,a){return this._wot.wtSettings.getSetting(r,n,i,o,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),t}(),W4e=zr,jq=mt,z4e=u1,G4e=$i,Y4e=d1.f,K4e=jq(Y4e),q4e=jq([].push),eL=function(t){return function(e){for(var r=G4e(e),n=z4e(r),i=n.length,o=0,a=[],s;i>o;)s=n[o++],(!W4e||K4e(r,s))&&q4e(a,t?[s,r[s]]:r[s]);return a}},X4e={entries:eL(!0),values:eL(!1)},Q4e=tt,Z4e=X4e.values;Q4e({target:"Object",stat:!0},{values:function(e){return Z4e(e)}});function cy(t){return cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cy(t)}function OE(t,e){return r8e(t)||t8e(t,e)||e8e(t,e)||J4e()}function J4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function e8e(t,e){if(!!t){if(typeof t=="string")return tL(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tL(t,e)}}function tL(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function t8e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function r8e(t){if(Array.isArray(t))return t}function n8e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,o8e(n.key),n)}}function i8e(t,e,r){return e&&rL(t.prototype,e),r&&rL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function o8e(t){var e=a8e(t,"string");return cy(e)==="symbol"?e:String(e)}function a8e(t,e){if(cy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(cy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var s8e=function(){function t(e,r){n8e(this,t),r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return i8e(t,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var i=function(l){var u=r.main.childNodes[l];r.eventManager.addEventListener(u,"mouseenter",function(c){return r.onMouseEnter(c,r.main.childNodes[l])})},o=0,a=this.main.childNodes.length;o<a;o++)i(o)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),la(r);var i=this,o=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function s(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function l(u){s(u)&&(i.eventManager.removeEventListener(o,"mousemove",l),n.style.display="block")}this.eventManager.addEventListener(o,"mousemove",l)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var i=["top","start","bottom","end","corner"],o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(var a=0;a<5;a++){var s=i[a],l=n.createElement("div");l.className="wtBorder ".concat(this.settings.className||""),this.settings[s]&&this.settings[s].hide&&(l.className+=" hidden"),o=l.style,o.backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:r.border.color,o.height=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),o.width=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(l)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),na()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,c=u.bordersHolder;c||(c=n.createElement("div"),c.className="htBorders",u.bordersHolder=c,u.spreader.appendChild(c)),c.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var i=10,o=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px")};Rt(a,function(l,u){r.selectionHandles.styles.bottomHitArea[u]=l,r.selectionHandles.styles.topHitArea[u]=l});var s={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};Rt(s,function(l,u){r.selectionHandles.styles.bottom[u]=l,r.selectionHandles.styles.top[u]=l}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var i=this.wot.selections.createOrGetArea();return!!(i.cellRange&&(r!==i.cellRange.to.row||n!==i.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,i,o,a,s){var l=this.wot.wtSettings.getSetting("rtlMode"),u=l?"right":"left",c=this.selectionHandles.styles,f=c.top,h=c.topHitArea,d=c.bottom,p=c.bottomHitArea,m=parseInt(f.borderWidth,10),g=parseInt(f.width,10),v=parseInt(h.width,10),w=this.wot.wtTable.getWidth(),b=this.wot.wtTable.getHeight();f.top="".concat(parseInt(i-g-1,10),"px"),f[u]="".concat(parseInt(o-g-1,10),"px"),h.top="".concat(parseInt(i-v/4*3,10),"px"),h[u]="".concat(parseInt(o-v/4*3,10),"px");var E=Math.min(parseInt(o+a,10),w-g-m*2),A=Math.min(parseInt(o+a-v/4,10),w-v-m*2);d[u]="".concat(E,"px"),p[u]="".concat(A,"px");var M=Math.min(parseInt(i+s,10),b-g-m*2),k=Math.min(parseInt(i+s-v/4,10),b-v-m*2);d.top="".concat(M,"px"),p.top="".concat(k,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(f.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",p.display="none"):(d.display="block",p.display="block")):(f.display="none",d.display="none",h.display="none",p.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(f.zIndex="9999",h.zIndex="9999"):(f.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,i=n.wtTable,o=n.rootDocument,a=n.rootWindow,s,l,u,c,f,h,d=i.getRenderedRowsCount(),p=0;p<d;p+=1){var m=i.rowFilter.renderedToSource(p);if(m>=r[0]&&m<=r[2]){s=m,f=r[0];break}}for(var g=d-1;g>=0;g-=1){var v=i.rowFilter.renderedToSource(g);if(v>=r[0]&&v<=r[2]){l=v;break}}for(var w=i.getRenderedColumnsCount(),b=0;b<w;b+=1){var E=i.columnFilter.renderedToSource(b);if(E>=r[1]&&E<=r[3]){u=E,h=r[1];break}}for(var A=w-1;A>=0;A-=1){var M=i.columnFilter.renderedToSource(A);if(M>=r[1]&&M<=r[3]){c=M;break}}if(s===void 0||u===void 0){this.disappear();return}var k=i.getCell(this.wot.createCellCoords(s,u)),O=s!==l||u!==c,x=O?i.getCell(this.wot.createCellCoords(l,c)):k,C=Zr(k),I=O?Zr(x):C,H=Zr(i.TABLE),j=Qt(i.TABLE),q=C.top,Z=C.left,ne=this.wot.wtSettings.getSetting("rtlMode"),ie=0,P=0;if(ne){var y=Qt(k),R=a.innerWidth-H.left-j;P=Z+y-I.left,ie=a.innerWidth-Z-y-R-1}else P=I.left+Qt(x)-Z,ie=Z-H.left-1;if(this.isEntireColumnSelected(s,l)){var _=this.getDimensionsFromHeader("columns",u,c,f,H),$=null;if(_){var B=OE(_,3);$=B[0],ie=B[1],P=B[2]}$&&(k=$)}var W=q-H.top-1,ee=I.top+wr(x)-q;if(this.isEntireRowSelected(u,c)){var J=this.getDimensionsFromHeader("rows",s,l,h,H),he=null;if(J){var re=OE(J,3);he=re[0],W=re[1],ee=re[2]}he&&(k=he)}var T=Ku(k,a);parseInt(T.borderTopWidth,10)>0&&(W+=1,ee=ee>0?ee-1:0),parseInt(T[ne?"borderRightWidth":"borderLeftWidth"],10)>0&&(ie+=1,P=P>0?P-1:0);var D=ne?"right":"left";this.topStyle.top="".concat(W,"px"),this.topStyle[D]="".concat(ie,"px"),this.topStyle.width="".concat(P,"px"),this.topStyle.display="block",this.startStyle.top="".concat(W,"px"),this.startStyle[D]="".concat(ie,"px"),this.startStyle.height="".concat(ee,"px"),this.startStyle.display="block";var z=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(W+ee-z,"px"),this.bottomStyle[D]="".concat(ie,"px"),this.bottomStyle.width="".concat(P,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(W,"px"),this.endStyle[D]="".concat(ie+P-z,"px"),this.endStyle.height="".concat(ee+1,"px"),this.endStyle.display="block";var K=this.settings.border.cornerVisible;K=typeof K=="function"?K(this.settings.layerLevel):K;var le=this.wot.getSetting("onModifyGetCellCoords",l,c),X=l,we=c;if(le&&Array.isArray(le)){var Ce=OE(le,4);X=Ce[2],we=Ce[3]}if(na()||!K||this.isPartRange(X,we))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(W+ee+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[D]="".concat(ie+P+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var Ee=Ng(i.TABLE),Te=Ee===a;Te&&(Ee=o.documentElement);var Oe=parseInt(this.cornerDefaultStyle.width,10)/2,F=parseInt(this.cornerDefaultStyle.height,10)/2;if(c===this.wot.getSetting("totalColumns")-1){var U=Te?x.getBoundingClientRect().left:x.offsetLeft,Y=!1,fe=0;ne?(fe=U-parseInt(this.cornerDefaultStyle.width,10)/2,Y=fe<0):(fe=U+Qt(x)+parseInt(this.cornerDefaultStyle.width,10)/2,Y=fe>=zb(Ee)),Y&&(this.cornerStyle[D]="".concat(Math.floor(ie+P+this.cornerCenterPointOffset-Oe),"px"),this.cornerStyle[ne?"borderLeftWidth":"borderRightWidth"]=0)}if(l===this.wot.getSetting("totalRows")-1){var oe=Te?x.getBoundingClientRect().top:x.offsetTop,pe=oe+wr(x)+parseInt(this.cornerDefaultStyle.height,10)/2,ue=pe>=Gs(Ee);ue&&(this.cornerStyle.top="".concat(Math.floor(W+ee+this.cornerCenterPointOffset-F),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}na()&&this.updateMultipleSelectionHandlesPosition(l,c,W,ie,P,ee)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,i,o,a){var s=this.wot.wtTable,l=s.wtRootElement.parentNode,u=null,c=null,f=null,h=null,d=null,p=null,m=null,g=null;switch(r){case"rows":u=function(){return s.getRowHeader.apply(s,arguments)},c=function(){return wr.apply(void 0,arguments)},f="ht__selection--rows",p="top";break;case"columns":u=function(){return s.getColumnHeader.apply(s,arguments)},c=function(){return Qt.apply(void 0,arguments)},f="ht__selection--columns",p="left";break}if(l.classList.contains(f)){var v=this.wot.getSetting("columnHeaders").length;if(m=u(n,v-o),g=u(i,v-o),!m||!g)return!1;var w=Zr(m),b=Zr(g);return m&&g&&(h=w[p]-a[p]-1,d=b[p]+c(g)-w[p]),[m,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var i=this[r].style,o=n[r];!o||o.hide?_e(this[r],"hidden"):(at(this[r],"hidden")&&ut(this[r],"hidden"),i.backgroundColor=o.color,(r==="top"||r==="bottom")&&(i.height="".concat(o.width,"px")),(r==="start"||r==="end")&&(i.width="".concat(o.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},i=this[r].style;i.backgroundColor=n.color,i.width="".concat(n.width,"px"),i.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?_e(this[r],"hidden"):ut(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",na()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),t}();const l8e=s8e;function u8e(t,e){return d8e(t)||h8e(t,e)||f8e(t,e)||c8e()}function c8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function f8e(t,e){if(!!t){if(typeof t=="string")return nL(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nL(t,e)}}function nL(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function h8e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function d8e(t){if(Array.isArray(t))return t}function qh(t){return qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qh(t)}function p8e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g8e(n.key),n)}}function m8e(t,e,r){return e&&iL(t.prototype,e),r&&iL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function g8e(t){var e=y8e(t,"string");return qh(e)==="symbol"?e:String(e)}function y8e(t,e){if(qh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var v8e=function(){function t(e,r){p8e(this,t),this.settings=e,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return m8e(t,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new l8e(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,i,o){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=r.wtTable.getCell(this.settings.createCellCoords(n,i));if(qh(s)==="object"){var l=o;a&&(l=this.classNameGenerator(s),this.classNames.includes(l)||this.classNames.push(l)),_e(s,l)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function i(o){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var s=a>=0?a:n,l=r;s-=1;var u=s===0?r:"".concat(r,"-").concat(s);if(at(o,u)){var c=s+1;l="".concat(r,"-").concat(c)}else l=i(o,s);return l}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),i=r.wtTable.getRenderedColumnsCount(),o=this.getCorners(),a=u8e(o,4),s=a[0],l=a[1],u=a[2],c=a[3],f=this.settings,h=f.highlightHeaderClassName,d=f.highlightColumnClassName,p=f.highlightRowClassName,m=f.highlightOnlyClosestHeader,g=f.selectionType,v=g===void 0||["active-header","header"].includes(g);if(v&&l!==null&&c!==null)for(var w=0,b=0;b<i;b+=1){var E=r.wtTable.columnFilter.renderedToSource(b);if(E>=l&&E<=c){var A=r.wtTable.getColumnHeaders(E),M=A.length-1;m&&A.length>1&&(A=[A[M]]);for(var k=0;k<A.length;k+=1){var O=[],x=A[k];h&&O.push(h),d&&O.push(d),k=m?M:k;var C=r.getSetting("onBeforeHighlightingColumnHeader",E,k,{selectionType:g,columnCursor:w,selectionWidth:c-l+1,classNames:O});C!==E&&(x=r.wtTable.getColumnHeader(C,k)),_e(x,O)}w+=1}}if(s!==null&&u!==null)for(var I=0,H=0;H<n;H+=1){var j=r.wtTable.rowFilter.renderedToSource(H);if(v&&j>=s&&j<=u){var q=r.wtTable.getRowHeaders(j),Z=q.length-1;m&&q.length>1&&(q=[q[Z]]);for(var ne=0;ne<q.length;ne+=1){var ie=[],P=q[ne];h&&ie.push(h),p&&ie.push(p),ne=m?Z:ne;var y=r.getSetting("onBeforeHighlightingRowHeader",j,ne,{selectionType:g,rowCursor:I,selectionHeight:u-s+1,classNames:ie});y!==j&&(P=r.wtTable.getRowHeader(y,ne)),_e(P,ie)}I+=1}if(l!==null&&c!==null)for(var R=0;R<i;R+=1){var _=r.wtTable.columnFilter.renderedToSource(R);j>=s&&j<=u&&_>=l&&_<=c?this.settings.className&&this.addClassAtCoords(r,j,_,this.settings.className,this.settings.markIntersections):j>=s&&j<=u?p&&this.addClassAtCoords(r,j,_,p):_>=l&&_<=c&&d&&this.addClassAtCoords(r,j,_,d);var $=r.getSetting("onAfterDrawSelection",j,_,this.settings.layerLevel);typeof $=="string"&&this.addClassAtCoords(r,j,_,$)}}r.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(r).appear(o)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),t}();const b8e=v8e;var w8e=tt,S8e=Ec.findIndex,R8e=c1,oO="findIndex",Wq=!0;oO in[]&&Array(1)[oO](function(){Wq=!1});w8e({target:"Array",proto:!0,forced:Wq},{findIndex:function(e){return S8e(this,e,arguments.length>1?arguments[1]:void 0)}});R8e(oO);var E8e="localHooks",zq={_localHooks:Object.create(null),addLocalHook:function(e,r){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(r),this},runLocalHooks:function(e,r,n,i,o,a,s){if(this._localHooks[e])for(var l=this._localHooks[e].length,u=0;u<l;u++)mT(this._localHooks[e][u],this,r,n,i,o,a,s)},clearLocalHooks:function(){return this._localHooks={},this}};Ts(zq,"MIXIN_NAME",E8e,{writable:!1,enumerable:!1});const wi=zq;function fy(t){return fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fy(t)}function C8e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,T8e(n.key),n)}}function _8e(t,e,r){return e&&oL(t.prototype,e),r&&oL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function T8e(t){var e=O8e(t,"string");return fy(e)==="symbol"?e:String(e)}function O8e(t,e){if(fy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Tc=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;C8e(this,t),this.indexedValues=[],this.initValueOrFn=e}return _8e(t,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,sr(this.initValueOrFn)?Ye(n-1,function(i){return r.indexedValues.push(r.initValueOrFn(i))}):Ye(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),t}();ir(Tc,wi);function AE(t){return M8e(t)||x8e(t)||I8e(t)||A8e()}function A8e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I8e(t,e){if(!!t){if(typeof t=="string")return aO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aO(t,e)}}function x8e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function M8e(t){if(Array.isArray(t))return aO(t)}function aO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function b3(t,e,r,n){var i=r.length?r[0]:void 0;return[].concat(AE(t.slice(0,i)),AE(r.map(function(o,a){return sr(n)?n(o,a):n})),AE(i===void 0?[]:t.slice(i)))}function w3(t,e){return Ji(t,function(r,n){return e.includes(n)===!1})}function Xh(t){return Xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xh(t)}function N8e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,k8e(n.key),n)}}function P8e(t,e,r){return e&&aL(t.prototype,e),r&&aL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function k8e(t){var e=$8e(t,"string");return Xh(e)==="symbol"?e:String(e)}function $8e(t,e){if(Xh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jm(){return typeof Reflect<"u"&&Reflect.get?Jm=Reflect.get.bind():Jm=function(e,r,n){var i=L8e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Jm.apply(this,arguments)}function L8e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ec(t),t!==null););return t}function D8e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sO(t,e)}function sO(t,e){return sO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sO(t,e)}function F8e(t){var e=U8e();return function(){var n=ec(t),i;if(e){var o=ec(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return H8e(this,i)}}function H8e(t,e){if(e&&(Xh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B8e(t)}function B8e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function U8e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ec(t){return ec=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ec(t)}var _l=function(t){D8e(r,t);var e=F8e(r);function r(){return N8e(this,r),e.apply(this,arguments)}return P8e(r,[{key:"insert",value:function(i,o){this.indexedValues=b3(this.indexedValues,i,o,this.initValueOrFn),Jm(ec(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=w3(this.indexedValues,i),Jm(ec(r.prototype),"remove",this).call(this,i)}}]),r}(Tc);function Qh(t){return Qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qh(t)}function V8e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,W8e(n.key),n)}}function j8e(t,e,r){return e&&sL(t.prototype,e),r&&sL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function W8e(t){var e=z8e(t,"string");return Qh(e)==="symbol"?e:String(e)}function z8e(t,e){if(Qh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function G8e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lO(t,e)}function lO(t,e){return lO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lO(t,e)}function Y8e(t){var e=X8e();return function(){var n=Iw(t),i;if(e){var o=Iw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return K8e(this,i)}}function K8e(t,e){if(e&&(Qh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q8e(t)}function q8e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function X8e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Iw(t){return Iw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Iw(t)}var C6=function(t){G8e(r,t);var e=Y8e(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return V8e(this,r),e.call(this,n)}return j8e(r,[{key:"getHiddenIndexes",value:function(){return Fn(this.getValues(),function(i,o,a){return o&&i.push(a),i},[])}}]),r}(_l);function IE(t){return e3e(t)||J8e(t)||Z8e(t)||Q8e()}function Q8e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z8e(t,e){if(!!t){if(typeof t=="string")return uO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uO(t,e)}}function J8e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function e3e(t){if(Array.isArray(t))return uO(t)}function uO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function S3(t,e,r){return[].concat(IE(t.slice(0,e)),IE(r),IE(t.slice(e)))}function hy(t,e){return Ji(t,function(r){return e.includes(r)===!1})}function R3(t,e){return wt(t,function(r){return r-e.filter(function(n){return n<r}).length})}function E3(t,e){var r=e[0],n=e.length;return wt(t,function(i){return i>=r?i+n:i})}function Zh(t){return Zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zh(t)}function t3e(t){return o3e(t)||i3e(t)||n3e(t)||r3e()}function r3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n3e(t,e){if(!!t){if(typeof t=="string")return cO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cO(t,e)}}function i3e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function o3e(t){if(Array.isArray(t))return cO(t)}function cO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function a3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Yq(n.key),n)}}function s3e(t,e,r){return e&&lL(t.prototype,e),r&&lL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fa(){return typeof Reflect<"u"&&Reflect.get?Fa=Reflect.get.bind():Fa=function(e,r,n){var i=l3e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Fa.apply(this,arguments)}function l3e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=So(t),t!==null););return t}function u3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fO(t,e)}function fO(t,e){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fO(t,e)}function c3e(t){var e=h3e();return function(){var n=So(t),i;if(e){var o=So(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return f3e(this,i)}}function f3e(t,e){if(e&&(Zh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gq(t)}function Gq(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function So(t){return So=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},So(t)}function d3e(t,e,r){return e=Yq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yq(t){var e=p3e(t,"string");return Zh(e)==="symbol"?e:String(e)}function p3e(t,e){if(Zh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _6=function(t){u3e(r,t);var e=c3e(r);function r(){var n;a3e(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),d3e(Gq(n),"orderOfIndexes",[]),n}return s3e(r,[{key:"getValues",value:function(){var i=this;return this.orderOfIndexes.map(function(o){return i.indexedValues[o]})}},{key:"setValues",value:function(i){this.orderOfIndexes=t3e(Array(i.length).keys()),Fa(So(r.prototype),"setValues",this).call(this,i)}},{key:"setValueAtIndex",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return i<this.indexedValues.length?(this.indexedValues[i]=o,this.orderOfIndexes.includes(i)===!1&&this.orderOfIndexes.splice(a,0,i),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(i){this.orderOfIndexes=hy(this.orderOfIndexes,[i]),sr(this.initValueOrFn)?Fa(So(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn(i)):Fa(So(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,Fa(So(r.prototype),"setDefaultValues",this).call(this,i)}},{key:"insert",value:function(i,o){this.indexedValues=b3(this.indexedValues,i,o,this.initValueOrFn),this.orderOfIndexes=E3(this.orderOfIndexes,o),Fa(So(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=w3(this.indexedValues,i),this.orderOfIndexes=hy(this.orderOfIndexes,i),this.orderOfIndexes=R3(this.orderOfIndexes,i),Fa(So(r.prototype),"remove",this).call(this,i)}},{key:"getEntries",value:function(){var i=this;return this.orderOfIndexes.map(function(o){return[o,i.getValueAtIndex(o)]})}}]),r}(Tc);function Jh(t){return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jh(t)}function m3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,y3e(n.key),n)}}function g3e(t,e,r){return e&&uL(t.prototype,e),r&&uL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function y3e(t){var e=v3e(t,"string");return Jh(e)==="symbol"?e:String(e)}function v3e(t,e){if(Jh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function b3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hO(t,e)}function hO(t,e){return hO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hO(t,e)}function w3e(t){var e=E3e();return function(){var n=xw(t),i;if(e){var o=xw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return S3e(this,i)}}function S3e(t,e){if(e&&(Jh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return R3e(t)}function R3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function E3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xw(t){return xw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xw(t)}var k1=function(t){b3e(r,t);var e=w3e(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return m3e(this,r),e.call(this,n)}return g3e(r,[{key:"getTrimmedIndexes",value:function(){return Fn(this.getValues(),function(i,o,a){return o&&i.push(a),i},[])}}]),r}(_l),cL=new Map([["indexesSequence",{getListWithInsertedItems:S3,getListWithRemovedItems:hy}],["physicallyIndexed",{getListWithInsertedItems:b3,getListWithRemovedItems:w3}]]),Kq=function(e){if(cL.has(e)===!1)throw new Error("Alter strategy with ID '".concat(e,"' does not exist."));return cL.get(e)};function ed(t){return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ed(t)}function C3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,T3e(n.key),n)}}function _3e(t,e,r){return e&&fL(t.prototype,e),r&&fL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function T3e(t){var e=O3e(t,"string");return ed(e)==="symbol"?e:String(e)}function O3e(t,e){if(ed(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eg(){return typeof Reflect<"u"&&Reflect.get?eg=Reflect.get.bind():eg=function(e,r,n){var i=A3e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},eg.apply(this,arguments)}function A3e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=tc(t),t!==null););return t}function I3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dO(t,e)}function dO(t,e){return dO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},dO(t,e)}function x3e(t){var e=P3e();return function(){var n=tc(t),i;if(e){var o=tc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return M3e(this,i)}}function M3e(t,e){if(e&&(ed(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return N3e(t)}function N3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function P3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tc(t){return tc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tc(t)}var qq=function(t){I3e(r,t);var e=x3e(r);function r(){return C3e(this,r),e.call(this,function(n){return n})}return _3e(r,[{key:"insert",value:function(i,o){var a=E3(this.indexedValues,o);this.indexedValues=S3(a,i,o),eg(tc(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){var o=hy(this.indexedValues,i);this.indexedValues=R3(o,i),eg(tc(r.prototype),"remove",this).call(this,i)}}]),r}(Tc),hL=new Map([["hiding",C6],["index",Tc],["linkedPhysicalIndexToValue",_6],["physicalIndexToValue",_l],["trimming",k1]]);function k3e(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!hL.has(t))throw new Error('The provided map type ("'.concat(t,'") does not exist.'));return new(hL.get(t))(e)}function dy(t){return dy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dy(t)}function $3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,D3e(n.key),n)}}function L3e(t,e,r){return e&&dL(t.prototype,e),r&&dL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function D3e(t){var e=F3e(t,"string");return dy(e)==="symbol"?e:String(e)}function F3e(t,e){if(dy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(dy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var C3=function(){function t(){$3e(this,t),this.collection=new Map}return L3e(t,[{key:"register",value:function(r,n){var i=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return i.runLocalHooks("change",n)}))}},{key:"unregister",value:function(r){var n=this.collection.get(r);He(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n))}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,i){return r.unregister(i)}),this.collection.clear()}},{key:"get",value:function(r){return tr(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(i){i.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),t}();ir(C3,wi);function td(t){return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},td(t)}function H3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,U3e(n.key),n)}}function B3e(t,e,r){return e&&pL(t.prototype,e),r&&pL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function U3e(t){var e=V3e(t,"string");return td(e)==="symbol"?e:String(e)}function V3e(t,e){if(td(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function j3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pO(t,e)}function pO(t,e){return pO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},pO(t,e)}function W3e(t){var e=Y3e();return function(){var n=Mw(t),i;if(e){var o=Mw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return z3e(this,i)}}function z3e(t,e){if(e&&(td(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G3e(t)}function G3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Y3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mw(t){return Mw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mw(t)}var mL=function(t){j3e(r,t);var e=W3e(r);function r(n,i){var o;return H3e(this,r),o=e.call(this),o.mergedValuesCache=[],o.aggregationFunction=n,o.fallbackValue=i,o}return B3e(r,[{key:"getMergedValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(i===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var o=wt(this.get(),function(f){return f.getValues()}),a=[],s=He(o[0])&&o[0].length||0,l=0;l<s;l+=1){for(var u=[],c=0;c<this.getLength();c+=1)u.push(o[c][l]);a.push(u)}return wt(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(i,o){var a=this.getMergedValues(o)[i];return He(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(C3);function py(t){return py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},py(t)}function K3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,X3e(n.key),n)}}function q3e(t,e,r){return e&&gL(t.prototype,e),r&&gL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function X3e(t){var e=Q3e(t,"string");return py(e)==="symbol"?e:String(e)}function Q3e(t,e){if(py(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(py(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Z3e(t,e,r){J3e(t,e),e.set(t,r)}function J3e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eIe(t,e,r){var n=Xq(t,e,"set");return tIe(t,n,r),r}function tIe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function rIe(t,e){var r=Xq(t,e,"get");return nIe(t,r)}function Xq(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function nIe(t,e){return e.get?e.get.call(t):e.value}var xE=new WeakMap,Qq=function(){function t(){K3e(this,t),Z3e(this,xE,{writable:!0,value:[]})}return q3e(t,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(rIe(this,xE)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){eIe(this,xE,r)}}]),t}();ir(Qq,wi);function yL(t,e){for(var r=[],n=0,i=0;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function my(t){return my=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},my(t)}function iIe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aIe(n.key),n)}}function oIe(t,e,r){return e&&vL(t.prototype,e),r&&vL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function aIe(t){var e=sIe(t,"string");return my(e)==="symbol"?e:String(e)}function sIe(t,e){if(my(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(my(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function um(t,e,r){lIe(t,e),e.set(t,r)}function lIe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fi(t,e){var r=Zq(t,e,"get");return uIe(t,r)}function uIe(t,e){return e.get?e.get.call(t):e.value}function C0(t,e,r){var n=Zq(t,e,"set");return cIe(t,n,r),r}function Zq(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function cIe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var _0=new WeakMap,cm=new WeakMap,T0=new WeakMap,O0=new WeakMap,A0=new WeakMap,fIe=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.initialIndexValue;iIe(this,t),um(this,_0,{writable:!0,value:new Set}),um(this,cm,{writable:!0,value:[]}),um(this,T0,{writable:!0,value:[]}),um(this,O0,{writable:!0,value:!1}),um(this,A0,{writable:!0,value:!1}),C0(this,A0,r!=null?r:!1)}return oIe(t,[{key:"createObserver",value:function(){var r=this,n=new Qq;return Fi(this,_0).add(n),n.addLocalHook("unsubscribe",function(){Fi(r,_0).delete(n)}),n._writeInitialChanges(yL(Fi(this,cm),Fi(this,T0))),n}},{key:"emit",value:function(r){var n=Fi(this,T0);(!Fi(this,O0)||Fi(this,cm).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(Fi(this,A0)):C0(this,cm,new Array(r.length).fill(Fi(this,A0))),Fi(this,O0)||(C0(this,O0,!0),n=Fi(this,cm)));var i=yL(n,r);Fi(this,_0).forEach(function(o){return o._write(i)}),C0(this,T0,r)}}]),t}();function gy(t){return gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gy(t)}var bL;function ME(t){return mIe(t)||pIe(t)||dIe(t)||hIe()}function hIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dIe(t,e){if(!!t){if(typeof t=="string")return mO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mO(t,e)}}function pIe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function mIe(t){if(Array.isArray(t))return mO(t)}function mO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function gIe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function yIe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bIe(n.key),n)}}function vIe(t,e,r){return e&&wL(t.prototype,e),r&&wL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function bIe(t){var e=wIe(t,"string");return gy(e)==="symbol"?e:String(e)}function wIe(t,e){if(gy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(gy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var SL=new Set(["getFirstNotHiddenIndex"]),gO=function(){function t(){var e=this;yIe(this,t),this.indexesSequence=new qq,this.trimmingMapsCollection=new mL(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new mL(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new C3,this.hidingChangesObservable=new fIe({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){e.indexesSequenceChanged=!0,e.updateCache(),e.runLocalHooks("change",e.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){e.trimmedIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",r,e.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){e.hiddenIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",r,e.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){e.runLocalHooks("change",r,e.variousMapsCollection)})}return vIe(t,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,i){return this.registerMap(r,k3e(n,i))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof k1?this.trimmingMapsCollection.register(r,n):n instanceof C6?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var i=this.getNumberOfIndexes();return i>0&&n.init(i),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return He(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return He(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return He(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return He(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n;SL.has("getFirstNotHiddenIndex")&&(SL.delete("getFirstNotHiddenIndex"),Xt(Gt(bL||(bL=gIe([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var a=this.getPhysicalFromVisualIndex(r);return a===null?i===!0&&o!==r-n?this.getFirstNotHiddenIndex(o,-n,!1,o):null:this.isHidden(a)===!1?r:this.getFirstNotHiddenIndex(r+n,n,i,o)}},{key:"getNearestNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.getPhysicalFromVisualIndex(r);if(o===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),s=-1;return n>0?s=a.findIndex(function(l){return l>r}):s=a.reverse().findIndex(function(l){return l<r}),s===-1?i?this.getNearestNotHiddenIndex(r,-n,!1):null:a[s]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=ME(new Array(r).keys()),this.notHiddenIndexesCache=ME(new Array(r).keys()),this.suspendOperations(),this.indexesSequence.init(r),this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var i=ME(Array(this.getNumberOfIndexes()-r).keys()).map(function(o){return o+r});this.removeIndexes(i)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesSequence.setValues(r)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var i=this.getIndexesSequence();return i.filter(function(o){return r.isTrimmed(o)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var i=this.getIndexesSequence();return i.filter(function(o){return r.isHidden(o)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var i=this.getNotTrimmedIndexes();return i.filter(function(o){return r.isHidden(o)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var i=this;typeof r=="number"&&(r=[r]);var o=wt(r,function(f){return i.getPhysicalFromVisualIndex(f)}),a=this.getNotTrimmedIndexesLength(),s=r.length,l=hy(this.getIndexesSequence(),o),u=a-s;if(n+s<a){var c=l.filter(function(f){return i.isTrimmed(f)===!1})[n];u=l.indexOf(c)}this.setIndexesSequence(S3(l,u,o))}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var i=this.getNotTrimmedIndexes()[r],o=He(i)?i:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=wt(new Array(n).fill(o),function(l,u){return l+u});this.suspendOperations(),this.indexesSequence.insert(a,s),this.trimmingMapsCollection.insertToEvery(a,s),this.hidingMapsCollection.insertToEvery(a,s),this.variousMapsCollection.insertToEvery(a,s),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesSequence.remove(r),this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromRenderableIndex(n),o=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(o,n)}}}]),t}();ir(gO,wi);function rd(t){return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rd(t)}function RL(t,e){return CIe(t)||EIe(t,e)||RIe(t,e)||SIe()}function SIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RIe(t,e){if(!!t){if(typeof t=="string")return EL(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EL(t,e)}}function EL(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function EIe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function CIe(t){if(Array.isArray(t))return t}function _Ie(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function CL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,OIe(n.key),n)}}function TIe(t,e,r){return e&&CL(t.prototype,e),r&&CL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function OIe(t){var e=AIe(t,"string");return rd(e)==="symbol"?e:String(e)}function AIe(t,e){if(rd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function su(){return typeof Reflect<"u"&&Reflect.get?su=Reflect.get.bind():su=function(e,r,n){var i=IIe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},su.apply(this,arguments)}function IIe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Va(t),t!==null););return t}function xIe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yO(t,e)}function yO(t,e){return yO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yO(t,e)}function MIe(t){var e=PIe();return function(){var n=Va(t),i;if(e){var o=Va(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return NIe(this,i)}}function NIe(t,e){if(e&&(rd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jq(t)}function Jq(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Va(t){return Va=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Va(t)}Ue.getSingleton().register("modifyAutoColumnSizeSeed");var fm="autoColumnSize",kIe=10,NE=new WeakMap,$Ie="autoColumnSize",LIe=function(t){xIe(r,t);var e=MIe(r);function r(n){var i;return _Ie(this,r),i=e.call(this,n),NE.set(Jq(i),{cachedColumnHeaders:[]}),i.ghostTable=new oq(i.hot),i.samplesGenerator=new lq(function(o,a){var s=i.hot.getCellMeta(o,a),l="";s.spanned||(l=i.hot.getDataAtCell(o,a));var u="";return i.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=i.hot.runHooks("modifyAutoColumnSizeSeed",u,s,l)),{value:l,bundleSeed:u}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredColumns=0,i.columnWidthsMap=new _l,i.hot.columnIndexMapper.registerMap($Ie,i.columnWidthsMap),i.addHook("beforeColumnResize",function(o,a,s){return i.onBeforeColumnResize(o,a,s)}),i}return TIe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[fm]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[fm];o&&o.useHeaders!==null&&o.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",o.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(a){return i.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return i.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return i.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,s){return i.getColumnWidth(s,a)}),this.addHook("afterInit",function(){return i.onAfterInit()}),su(Va(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var i=this.findColumnsWhereHeaderWasChanged();i.length&&(this.clearCache(i),this.calculateVisibleColumnsWidth()),su(Va(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=this;su(Va(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(o,a,s){return i.onBeforeColumnResize(o,a,s)})}},{key:"calculateVisibleColumnsWidth",value:function(){var i=this.hot.countRows();if(!!i){var o=this.hot.renderCall,a=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn();a===-1||s===-1||this.calculateColumnsWidth({from:a,to:s},void 0,o)}}},{key:"calculateColumnsWidth",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof o=="number"?{from:o,to:o}:o,u=typeof a=="number"?{from:a,to:a}:a;Ye(l.from,l.to,function(c){var f=i.hot.toPhysicalColumn(c);if(f===null&&(f=c),s||i.columnWidthsMap.getValueAtIndex(f)===null&&!i.hot._getColWidthFromSettings(f)){var h=i.samplesGenerator.generateColumnSamples(c,u);ae(h,function(d){var p=RL(d,2),m=p[0],g=p[1];return i.ghostTable.addColumn(m,g)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){i.ghostTable.getWidths(function(c,f){var h=i.hot.toPhysicalColumn(c);i.columnWidthsMap.setValueAtIndex(h,f)})},!0),this.measuredColumns=l.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,s=this.hot.countCols()-1,l=null;this.inProgress=!0;var u=function f(){if(!i.hot){Y2(l),i.inProgress=!1;return}i.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,s)},o),a=a+r.CALCULATION_STEP+1,a<s?l=V8(f):(Y2(l),i.inProgress=!1,i.hot.view.adjustElementsSize())},c=this.getSyncCalculationLimit();this.firstCalculation&&c>=0&&(this.calculateColumnsWidth({from:0,to:c},o),this.firstCalculation=!1,a=c+1),a<s?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[fm],o=i&&Nr(i,"samplingRatio")?i.samplingRatio:void 0,a=i&&Nr(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[fm],o=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return St(i)&&(o=i.syncLimit,SK(o)?o=DK(a,o):o>>=0),Math.min(o,a)}},{key:"getColumnWidth",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=o;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(i)),a&&typeof s=="number"&&(s=Math.max(s,l3.DEFAULT_WIDTH))),s}},{key:"getFirstVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var o=i.wtTable.getFirstVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(i.wtViewport.columnsRenderCalculator){var a=i.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var o=i.wtTable.getLastVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(i.wtViewport.columnsRenderCalculator){var a=i.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var i=this.hot.getColHeader(),o=NE.get(this),a=o.cachedColumnHeaders,s=Fn(i,function(l,u,c){var f=a.length;return(f-1<c||a[c]!==u)&&l.push(c),f-1<c?a.push(u):a[c]=u,l},[]);return s}},{key:"clearCache",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];o.length?this.hot.batchExecution(function(){ae(o,function(a){i.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Ji(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){i.hot&&i.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(i){var o=this,a=wt(i,function(s){var l=RL(s,2),u=l[1];return o.hot.toPhysicalColumn(o.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(i,o,a){var s=i;return a&&(this.calculateColumnsWidth(o,void 0,!0),s=this.getColumnWidth(o,void 0,!1)),s}},{key:"onAfterInit",value:function(){NE.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(i){var o=Ji(i,function(s){var l;return He((l=s.address)===null||l===void 0?void 0:l.col)}),a=wt(o,function(s){return s.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),su(Va(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return fm}},{key:"PLUGIN_PRIORITY",get:function(){return kIe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(jt),lu={horizontal:"horizontal",vertical:"vertical"};function DIe(t,e,r,n){var i=r.length,o=r?r[0].length:0,a=[],s=e.row-t.row,l=e.col-t.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],c=0;c<l;c++){var f=parseInt(r[0][c],10),h=parseInt(r[i-1][c],10),d=(n==="down"?h-f:f-h)/(i-1)||0;u.push(d)}a.push(u)}if(["right","left"].indexOf(n)!==-1)for(var p=0;p<s;p++){var m=parseInt(r[p][0],10),g=parseInt(r[p][o-1],10),v=(n==="right"?g-m:m-g)/(o-1)||0;a.push([v])}return a}function FIe(t,e,r){var n,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",n=r(e[0],e[1]),i=r(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",n=r(e[0],t[3]+1),i=r(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",n=r(e[0],e[1]),i=r(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",n=r(t[2]+1,e[1]),i=r(e[2],e[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:n,endOfDragCoords:i}}function HIe(t){var e={};return t===!0?(e.directions=Object.keys(lu),e.autoInsertRow=!0):St(t)?(He(t.autoInsertRow)?t.direction===lu.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,He(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(lu)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function nd(t){return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nd(t)}function BIe(t){return jIe(t)||VIe(t)||eX(t)||UIe()}function UIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VIe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function jIe(t){if(Array.isArray(t))return vO(t)}function WIe(t,e){return YIe(t)||GIe(t,e)||eX(t,e)||zIe()}function zIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eX(t,e){if(!!t){if(typeof t=="string")return vO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vO(t,e)}}function vO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function GIe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function YIe(t){if(Array.isArray(t))return t}function KIe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _L(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,XIe(n.key),n)}}function qIe(t,e,r){return e&&_L(t.prototype,e),r&&_L(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function XIe(t){var e=QIe(t,"string");return nd(e)==="symbol"?e:String(e)}function QIe(t,e){if(nd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uu(){return typeof Reflect<"u"&&Reflect.get?uu=Reflect.get.bind():uu=function(e,r,n){var i=ZIe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},uu.apply(this,arguments)}function ZIe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ja(t),t!==null););return t}function JIe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bO(t,e)}function bO(t,e){return bO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bO(t,e)}function exe(t){var e=rxe();return function(){var n=ja(t),i;if(e){var o=ja(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return txe(this,i)}}function txe(t,e){if(e&&(nd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tX(t)}function tX(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ja(t){return ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ja(t)}Ue.getSingleton().register("modifyAutofillRange");Ue.getSingleton().register("beforeAutofill");Ue.getSingleton().register("afterAutofill");var TL="autofill",nxe=20,ixe=["fillHandle"],oxe="insert_row_below",axe=200,sxe=function(t){JIe(r,t);var e=exe(r);function r(n){var i;return KIe(this,r),i=e.call(this,n),i.eventManager=new Er(tX(i)),i.addingStarted=!1,i.mouseDownOnCellCorner=!1,i.mouseDragOutside=!1,i.handleDraggedCells=0,i.directions=[],i.autoInsertRow=!1,i}return qIe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(o){return i.onAfterCellCornerMouseDown(o)}),this.addHook("afterOnCellCornerDblClick",function(o){return i.onCellCornerDblClick(o)}),this.addHook("beforeOnCellMouseOver",function(o,a){return i.onBeforeCellMouseOver(a)}),uu(ja(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),uu(ja(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),uu(ja(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var i=this,o=this.hot.getSelectedRangeLast(),a=o.getTopStartCorner(),s=a.row,l=a.col,u=o.getBottomEndCorner(),c=u.row,f=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:s,startCol:l,endRow:c,endCol:f}]),d=[],p=[],m=[];return ae(h,function(g){for(var v=g.startRow;v<=g.endRow;v+=1)d.indexOf(v)===-1&&d.push(v);for(var w=g.startCol;w<=g.endCol;w+=1)p.indexOf(w)===-1&&p.push(w)}),ae(d,function(g){var v=[];ae(p,function(w){v.push(i.hot.getCopyableData(g,w))}),m.push(v)}),m}},{key:"fillIn",value:function(){var i=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var o=this.hot.selection.highlight.getFill().getVisualCorners(),a=WIe(o,4),s=a[0],l=a[1],u=a[2],c=a[3],f=this.hot.getSelectedRangeLast(),h=f.getTopStartCorner(),d=f.getBottomEndCorner();this.resetSelectionOfDraggedArea();var p=[h.row,h.col,d.row,d.col],m=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,s),Math.min(h.col,l),Math.max(d.row,u),Math.max(d.col,c)],p),g=FIe(p,m,function(P,y){return i.hot._createCellCoords(P,y)}),v=g.directionOfDrag,w=g.startOfDragCoords,b=g.endOfDragCoords;if(w&&w.row>-1&&w.col>-1){var E=this.getSelectionData(),A=f.clone(),M=this.hot._createCellRange(w,w,b),k=this.hot.runHooks("beforeAutofill",E,A,M,v);if(k===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var O=DIe(w,b,E,v),x=k,C=k;if(["up","left"].indexOf(v)>-1&&!(C.length===1&&C[0].length===0))if(x=[],v==="up")for(var I=b.row-w.row+1,H=I%C.length,j=0;j<I;j++)x.push(C[(j+(C.length-H))%C.length]);else for(var q=b.col-w.col+1,Z=q%C[0].length,ne=0;ne<C.length;ne++){x.push([]);for(var ie=0;ie<q;ie++)x[ne].push(C[ne][(ie+(C[ne].length-Z))%C[ne].length])}this.hot.populateFromArray(w.row,w.col,x,b.row,b.col,"".concat(this.pluginName,".fill"),null,v,O),this.setSelection(m),this.hot.runHooks("afterAutofill",x,A,M,v),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(i){return i.row<0&&(i.row=0),i.col<0&&(i.col=0),i}},{key:"getCoordsOfDragAndDropBorders",value:function(i){var o=this.hot.getSelectedRangeLast(),a=o.getBottomEndCorner(),s=i;if(this.directions.includes(lu.vertical)&&this.directions.includes(lu.horizontal)){var l=o.getTopStartCorner();(a.col<=i.col||l.col>=i.col)&&(s=this.hot._createCellCoords(a.row,i.col)),(a.row<i.row||l.row>i.row)&&(s=this.hot._createCellCoords(i.row,a.col))}else if(this.directions.includes(lu.vertical))s=this.hot._createCellCoords(i.row,a.col);else if(this.directions.includes(lu.horizontal))s=this.hot._createCellCoords(a.row,i.col);else return;return this.reduceSelectionAreaIfNeeded(s)}},{key:"showBorder",value:function(i){var o=this.getCoordsOfDragAndDropBorders(i);o&&this.redrawBorders(o)}},{key:"addRow",value:function(){var i=this;this.hot._registerTimeout(function(){i.hot.alter(oxe,void 0,1,"".concat(i.pluginName,".fill")),i.addingStarted=!1},axe)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var i=this.hot.getSelectedLast(),o=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();i[2]<a-1&&o[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(i){for(var o=this.hot.getData(),a=this.hot.countRows(),s,l=i[2]+1;l<a;l++){for(var u=i[1];u<=i[3];u++){var c=o[l][u];if(c)return-1}var f=o[l][i[1]-1],h=o[l][i[3]+1];(!!f||!!h)&&(s=l)}return s}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(i,o){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(i[0],i[1])).add(this.hot._createCellCoords(o,i[3])).commit()}},{key:"setSelection",value:function(i){var o;(o=this.hot).selectCell.apply(o,BIe(wt(i,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var i=this.hot.getSelectedLast(),o=this.getIndexOfLastAdjacentFilledInRow(i);return o===-1||o===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(i,o),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(i){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(i).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(i){var o=this.hot.rootDocument.documentElement,a=Zr(this.hot.table).top-(this.hot.rootWindow.pageYOffset||o.scrollTop)+wr(this.hot.table),s=Zr(this.hot.table).left-(this.hot.rootWindow.pageXOffset||o.scrollLeft)+Qt(this.hot.table);return i.clientY>a&&i.clientX<=s}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(o,"mousemove",function(a){return i.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var i=this.selectAdjacent();i&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(i){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(i),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(i){var o=this.getIfMouseWasDraggedOutside(i);this.addingStarted===!1&&this.handleDraggedCells>0&&o?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var i=HIe(this.hot.getSettings().fillHandle);this.directions=i.directions,this.autoInsertRow=i.autoInsertRow}},{key:"destroy",value:function(){uu(ja(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return TL}},{key:"PLUGIN_PRIORITY",get:function(){return nxe}},{key:"SETTING_KEYS",get:function(){return[TL].concat(ixe)}}]),r}(jt);function id(t){return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},id(t)}function lxe(t,e){return hxe(t)||fxe(t,e)||cxe(t,e)||uxe()}function uxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cxe(t,e){if(!!t){if(typeof t=="string")return OL(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OL(t,e)}}function OL(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function fxe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function hxe(t){if(Array.isArray(t))return t}function dxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mxe(n.key),n)}}function pxe(t,e,r){return e&&AL(t.prototype,e),r&&AL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mxe(t){var e=gxe(t,"string");return id(e)==="symbol"?e:String(e)}function gxe(t,e){if(id(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wf(){return typeof Reflect<"u"&&Reflect.get?Wf=Reflect.get.bind():Wf=function(e,r,n){var i=yxe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Wf.apply(this,arguments)}function yxe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=rl(t),t!==null););return t}function vxe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wO(t,e)}function wO(t,e){return wO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wO(t,e)}function bxe(t){var e=Rxe();return function(){var n=rl(t),i;if(e){var o=rl(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return wxe(this,i)}}function wxe(t,e){if(e&&(id(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sxe(t)}function Sxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Rxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rl(t){return rl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rl(t)}var I0="autoRowSize",Exe=40,Cxe="autoRowSize",_xe=function(t){vxe(r,t);var e=bxe(r);function r(n){var i;return dxe(this,r),i=e.call(this,n),i.rowHeightsMap=void 0,i.headerHeight=null,i.ghostTable=new oq(i.hot),i.samplesGenerator=new lq(function(o,a){var s;return o>=0?s=i.hot.getDataAtCell(o,a):o===-1&&(s=i.hot.getColHeader(a)),{value:s}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredRows=0,i.rowHeightsMap=new _l,i.hot.rowIndexMapper.registerMap(Cxe,i.rowHeightsMap),i.addHook("beforeRowResize",function(o,a,s){return i.onBeforeRowResize(o,a,s)}),i}return pxe(r,[{key:"isEnabled",value:function(){var i=this.hot.getSettings()[I0];return i===!0||St(i)}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(o){return i.onBeforeChange(o)}),this.addHook("beforeColumnResize",function(){return i.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(o){return i.onBeforeViewRender(o)}),this.addHook("modifyRowHeight",function(o,a){return i.getRowHeight(a,o)}),this.addHook("modifyColumnHeaderHeight",function(){return i.getColumnHeaderHeight()}),Wf(rl(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this;this.headerHeight=null,Wf(rl(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(o,a,s){return i.onBeforeRowResize(o,a,s)})}},{key:"calculateRowsHeight",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof o=="number"?{from:o,to:o}:o,u=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var c=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(c.get(-1))}Ye(l.from,l.to,function(f){if(s||i.rowHeightsMap.getValueAtIndex(f)===null){var h=i.samplesGenerator.generateRowSamples(f,u);ae(h,function(d){var p=lxe(d,2),m=p[0],g=p[1];return i.ghostTable.addRow(m,g)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){i.ghostTable.getHeights(function(f,h){f<0?i.headerHeight=h:i.rowHeightsMap.setValueAtIndex(i.hot.toPhysicalRow(f),h)})},!0),this.measuredRows=l.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,s=this.hot.countRows()-1,l=null;this.inProgress=!0;var u=function f(){if(!i.hot){Y2(l),i.inProgress=!1;return}i.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,s)},o),a=a+r.CALCULATION_STEP+1,a<s?l=V8(f):(Y2(l),i.inProgress=!1,i.hot.view.adjustElementsSize(!0),i.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&i.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},c=this.getSyncCalculationLimit();this.firstCalculation&&c>=0&&(this.calculateRowsHeight({from:0,to:c},o),this.firstCalculation=!1,a=c+1),a<s?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[I0],o=i&&Nr(i,"samplingRatio")?i.samplingRatio:void 0,a=i&&Nr(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){xg(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[I0],o=r.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return St(i)&&(o=i.syncLimit,SK(o)?o=DK(a,o):o>>=0),Math.min(o,a)}},{key:"getRowHeight",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=i<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(i)),s=o;return a!==null&&a>(o||0)&&(s=a),s}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getFirstVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getLastVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(i){var o=this,a=typeof i=="number"?{from:i,to:i}:i,s=a.from,l=a.to;this.hot.batchExecution(function(){Ye(Math.min(s,l),Math.max(s,l),function(u){o.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!Ji(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){var i=this.hot.renderCall,o=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),s=this.getLastVisibleRow();if(!(a===-1||s===-1)){if(this.calculateRowsHeight({from:a,to:s},void 0,i),o){var l=this.hot.countRows()-1;this.calculateRowsHeight({from:l-o,to:l})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(i,o){this.clearCacheByRange({from:i,to:o}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(i,o,a){var s=i;return a&&(this.calculateRowsHeight(o,void 0,!0),s=this.getRowHeight(o)),s}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){i.hot&&i.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(i){var o=null;i.length===1?o=i[0][0]:i.length>1&&(o={from:i[0][0],to:i[i.length-1][0]}),o!==null&&this.clearCacheByRange(o)}},{key:"destroy",value:function(){this.ghostTable.clean(),Wf(rl(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return I0}},{key:"PLUGIN_PRIORITY",get:function(){return Exe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(jt);function od(t){return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},od(t)}function Txe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function IL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Axe(n.key),n)}}function Oxe(t,e,r){return e&&IL(t.prototype,e),r&&IL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Axe(t){var e=Ixe(t,"string");return od(e)==="symbol"?e:String(e)}function Ixe(t,e){if(od(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tg(){return typeof Reflect<"u"&&Reflect.get?tg=Reflect.get.bind():tg=function(e,r,n){var i=xxe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},tg.apply(this,arguments)}function xxe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=rc(t),t!==null););return t}function Mxe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&SO(t,e)}function SO(t,e){return SO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},SO(t,e)}function Nxe(t){var e=$xe();return function(){var n=rc(t),i;if(e){var o=rc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Pxe(this,i)}}function Pxe(t,e){if(e&&(od(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kxe(t)}function kxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $xe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rc(t){return rc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rc(t)}var rX=Kq("physicallyIndexed"),Lxe=rX.getListWithInsertedItems,Dxe=rX.getListWithRemovedItems,Fxe=function(t){Mxe(r,t);var e=Nxe(r);function r(){return Txe(this,r),e.call(this,function(n){return n})}return Oxe(r,[{key:"insert",value:function(i,o){var a=E3(this.indexedValues,o);this.indexedValues=Lxe(a,i,o,this.initValueOrFn),tg(rc(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){var o=Dxe(this.indexedValues,i);this.indexedValues=R3(o,i),tg(rc(r.prototype),"remove",this).call(this,i)}}]),r}(Tc);const Hxe=Fxe;function ad(t){return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ad(t)}function Bxe(t){return Wxe(t)||jxe(t)||Vxe(t)||Uxe()}function Uxe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vxe(t,e){if(!!t){if(typeof t=="string")return RO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RO(t,e)}}function jxe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Wxe(t){if(Array.isArray(t))return RO(t)}function RO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Yxe(n.key),n)}}function Gxe(t,e,r){return e&&xL(t.prototype,e),r&&xL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Yxe(t){var e=Kxe(t,"string");return ad(e)==="symbol"?e:String(e)}function Kxe(t,e){if(ad(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rg(){return typeof Reflect<"u"&&Reflect.get?rg=Reflect.get.bind():rg=function(e,r,n){var i=qxe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},rg.apply(this,arguments)}function qxe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=nc(t),t!==null););return t}function Xxe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&EO(t,e)}function EO(t,e){return EO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},EO(t,e)}function Qxe(t){var e=e9e();return function(){var n=nc(t),i;if(e){var o=nc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Zxe(this,i)}}function Zxe(t,e){if(e&&(ad(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jxe(t)}function Jxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function e9e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nc(t){return nc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nc(t)}var nX=Kq("physicallyIndexed"),t9e=nX.getListWithInsertedItems,r9e=nX.getListWithRemovedItems,n9e=function(t){Xxe(r,t);var e=Qxe(r);function r(){return zxe(this,r),e.call(this,function(n){return n})}return Gxe(r,[{key:"insert",value:function(i,o){var a=this;this.indexedValues=t9e(this.indexedValues,i,o,function(s,l){return a.getNextValue(l)}),rg(nc(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=r9e(this.indexedValues,i),rg(nc(r.prototype),"remove",this).call(this,i)}},{key:"getNextValue",value:function(i){return Math.max.apply(Math,Bxe(this.getValues()))+1+i}}]),r}(Tc);const i9e=n9e;function sd(t){return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sd(t)}function o9e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ML(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s9e(n.key),n)}}function a9e(t,e,r){return e&&ML(t.prototype,e),r&&ML(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s9e(t){var e=l9e(t,"string");return sd(e)==="symbol"?e:String(e)}function l9e(t,e){if(sd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zf(){return typeof Reflect<"u"&&Reflect.get?zf=Reflect.get.bind():zf=function(e,r,n){var i=u9e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},zf.apply(this,arguments)}function u9e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=nl(t),t!==null););return t}function c9e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&CO(t,e)}function CO(t,e){return CO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},CO(t,e)}function f9e(t){var e=p9e();return function(){var n=nl(t),i;if(e){var o=nl(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return h9e(this,i)}}function h9e(t,e){if(e&&(sd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return d9e(t)}function d9e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p9e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nl(t){return nl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nl(t)}var PE="bindRowsWithHeaders",m9e=210,g9e="loose",y9e=new Map([["loose",Hxe],["strict",i9e]]),v9e=function(t){c9e(r,t);var e=f9e(r);function r(n){var i;return o9e(this,r),i=e.call(this,n),i.headerIndexes=null,i}return a9e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PE]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[PE];typeof o!="string"&&(o=g9e);var a=y9e.get(o);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(s){return i.onModifyRowHeader(s)}),zf(nl(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),zf(nl(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(i){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(i))}},{key:"destroy",value:function(){zf(nl(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PE}},{key:"PLUGIN_PRIORITY",get:function(){return m9e}}]),r}(jt);function ld(t){return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ld(t)}function NL(t){return R9e(t)||S9e(t)||w9e(t)||b9e()}function b9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w9e(t,e){if(!!t){if(typeof t=="string")return _O(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _O(t,e)}}function S9e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function R9e(t){if(Array.isArray(t))return _O(t)}function _O(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function E9e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,iX(n.key),n)}}function C9e(t,e,r){return e&&PL(t.prototype,e),r&&PL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function cu(){return typeof Reflect<"u"&&Reflect.get?cu=Reflect.get.bind():cu=function(e,r,n){var i=_9e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},cu.apply(this,arguments)}function _9e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Wa(t),t!==null););return t}function T9e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&TO(t,e)}function TO(t,e){return TO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TO(t,e)}function O9e(t){var e=I9e();return function(){var n=Wa(t),i;if(e){var o=Wa(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return A9e(this,i)}}function A9e(t,e){if(e&&(ld(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _f(t)}function _f(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I9e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wa(t){return Wa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wa(t)}function x9e(t,e,r){M9e(t,e),e.set(t,r)}function M9e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kE(t,e,r){return e=iX(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iX(t){var e=N9e(t,"string");return ld(e)==="symbol"?e:String(e)}function N9e(t,e){if(ld(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kL(t,e){var r=oX(t,e,"get");return P9e(t,r)}function P9e(t,e){return e.get?e.get.call(t):e.value}function $E(t,e,r){var n=oX(t,e,"set");return k9e(t,n,r),r}function oX(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function k9e(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var LE="collapsibleColumns",$9e=290,L9e=["nestedHeaders"],Wc="collapsibleIndicator",$L=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),zc=new WeakMap,D9e=function(t){T9e(r,t);var e=O9e(r);function r(){var n;E9e(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),kE(_f(n),"nestedHeadersPlugin",null),kE(_f(n),"eventManager",new Er(_f(n))),kE(_f(n),"headerStateManager",null),x9e(_f(n),zc,{writable:!0,value:null}),n}return C9e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[LE]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),a=o.nestedHeaders;a||Xt("You need to configure the Nested Headers plugin in order to use collapsible headers."),$E(this,zc,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(s,l,u){return i.onBeforeOnCellMouseDown(s,l,u)}),cu(Wa(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(!!this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var i=this.hot.getSettings(),o=i.collapsibleColumns;typeof o=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(o)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(o))}cu(Wa(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),$E(this,zc,null),this.nestedHeadersPlugin=null,this.clearButtons(),cu(Wa(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(!!this.hot.view){var i=this.hot.view._wt.getSetting("columnHeaders").length,o=this.hot.view._wt.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,l=function(c){c&&c.parentNode.removeChild(c)};Ye(0,i-1,function(u){var c=o.childNodes[u],f=a.childNodes[u],h=s?s.childNodes[u]:null;Ye(0,c.childNodes.length-1,function(d){var p=c.childNodes[d].querySelector(".".concat(Wc));l(p),f&&f.childNodes[d]&&(p=f.childNodes[d].querySelector(".".concat(Wc)),l(p)),s&&h&&h.childNodes[d]&&(p=h.childNodes[d].querySelector(".".concat(Wc)),l(p))})})}}},{key:"expandSection",value:function(i){this.toggleCollapsibleSection([i],"expand")}},{key:"collapseSection",value:function(i){this.toggleCollapsibleSection([i],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(i){var o=this,a=this.headerStateManager.mapNodes(function(s){var l=s.collapsible,u=s.origColspan,c=s.headerLevel,f=s.columnIndex,h=s.isCollapsed;if(l===!0&&u>1&&(h&&i==="expand"||!h&&i==="collapse"))return{row:o.headerStateManager.levelToRowCoords(c),col:f}});this.toggleCollapsibleSection(a,i)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(i,o){var a=this;if(!$L.has(o))throw new Error("Unsupported action is passed (".concat(o,")."));if(!!Array.isArray(i)){var s=Ji(i,function(g){var v=g.row;return v<0}),l=s.length>0;ae(s,function(g){var v,w=g.row,b=g.col,E=(v=a.headerStateManager.getHeaderSettings(w,b))!==null&&v!==void 0?v:{},A=E.collapsible,M=E.isCollapsed;if(!A||M&&o==="collapse"||!M&&o==="expand")return l=!1,!1});var u=[],c=[];l&&ae(s,function(g){var v=g.row,w=g.col,b=a.headerStateManager.triggerNodeModification(o,v,w),E=b.colspanCompensation,A=b.affectedColumns,M=b.rollbackModification;E>0&&(c.push.apply(c,NL(A)),u.push(M))});var f=this.getCollapsedColumns(),h=[];o==="collapse"?h=oK([].concat(NL(f),c)):o==="expand"&&(h=Ji(f,function(g){return!c.includes(g)}));var d=$L.get(o),p=this.hot.runHooks(d.beforeHook,f,h,l);if(p===!1){ae(u,function(g){g()});return}this.hot.batchExecution(function(){ae(c,function(g){kL(a,zc).setValueAtIndex(a.hot.toPhysicalColumn(g),d.hideColumn)})},!0);var m=this.getCollapsedColumns().length!==f.length;this.hot.runHooks(d.afterHook,f,h,l,m),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return kL(this,zc).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(i,o,a){var s,l=(s=this.headerStateManager.getHeaderSettings(a,i))!==null&&s!==void 0?s:{},u=l.collapsible,c=l.origColspan,f=l.isCollapsed,h=u&&c>1&&i>=this.hot.getSettings().fixedColumnsStart,d=o.querySelector(".".concat(Wc));if(h)d||(d=this.hot.rootDocument.createElement("div"),_e(d,Wc),o.querySelector("div:first-child").appendChild(d)),ut(d,["collapsed","expanded"]),f?(_e(d,"collapsed"),Yu(d,"+")):(_e(d,"expanded"),Yu(d,"-"));else{var p;(p=d)===null||p===void 0||p.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(i,o){at(i.target,Wc)&&(at(i.target,"expanded")?(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([o],"collapse")):at(i.target,"collapsed")&&(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([o],"expand")),la(i))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,o){o||this.updatePlugin()}},{key:"destroy",value:function(){$E(this,zc,null),cu(Wa(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return LE}},{key:"PLUGIN_PRIORITY",get:function(){return $9e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[LE].concat(L9e)}}]),r}(jt),F9e=tt,H9e=zr,B9e=cG,U9e=$i,V9e=ya,j9e=$p;F9e({target:"Object",stat:!0,sham:!H9e},{getOwnPropertyDescriptors:function(e){for(var r=U9e(e),n=V9e.f,i=B9e(r),o={},a=0,s,l;i.length>a;)l=n(r,s=i[a++]),l!==void 0&&j9e(o,s,l);return o}});var LL=zr,W9e=mt,z9e=en,G9e=dt,DE=u1,Y9e=m1,K9e=d1,q9e=bi,X9e=i1,Gc=Object.assign,DL=Object.defineProperty,Q9e=W9e([].concat),Z9e=!Gc||G9e(function(){if(LL&&Gc({b:1},Gc(DL({},"a",{enumerable:!0,get:function(){DL(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var t={},e={},r=Symbol(),n="abcdefghijklmnopqrst";return t[r]=7,n.split("").forEach(function(i){e[i]=i}),Gc({},t)[r]!=7||DE(Gc({},e)).join("")!=n})?function(e,r){for(var n=q9e(e),i=arguments.length,o=1,a=Y9e.f,s=K9e.f;i>o;)for(var l=X9e(arguments[o++]),u=a?Q9e(DE(l),a(l)):DE(l),c=u.length,f=0,h;c>f;)h=u[f++],(!LL||z9e(s,l,h))&&(n[h]=l[h]);return n}:Gc,J9e=tt,FL=Z9e;J9e({target:"Object",stat:!0,arity:2,forced:Object.assign!==FL},{assign:FL});function yy(t){return yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yy(t)}function HL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function eMe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?HL(Object(r),!0).forEach(function(n){tMe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):HL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tMe(t,e,r){return e=aX(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BL(t,e){return oMe(t)||iMe(t,e)||nMe(t,e)||rMe()}function rMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nMe(t,e){if(!!t){if(typeof t=="string")return UL(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UL(t,e)}}function UL(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function iMe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function oMe(t){if(Array.isArray(t))return t}function aMe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aX(n.key),n)}}function sMe(t,e,r){return e&&VL(t.prototype,e),r&&VL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function aX(t){var e=lMe(t,"string");return yy(e)==="symbol"?e:String(e)}function lMe(t,e){if(yy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(yy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uMe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],cMe=!1,fMe=!0,hMe=!0,dMe=function(){function t(e,r){aMe(this,t),this.hot=e,this.sortingStates=new _6,this.sortEmptyCells=cMe,this.indicator=fMe,this.headerAction=hMe,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return sMe(t,[{key:"updateAllColumnsProperties",value:function(r){var n=this;!St(r)||Rt(r,function(i,o){uMe.includes(o)&&(n[o]=i)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var i=BL(n,1),o=i[0];return o===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return St(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(i){var o=BL(i,2),a=o[0],s=o[1];return eMe({column:r.hot.toVisualColumn(a)},s)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(He(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),t}(),Nw="asc",Pw="desc",pMe="colHeader";function mMe(t){if(St(t)===!1)return!1;var e=t.column,r=t.sortOrder;return Number.isInteger(e)&&[Nw,Pw].includes(r)}function gMe(t){if(t.some(function(r){return mMe(r)===!1}))return!1;var e=t.map(function(r){var n=r.column;return n});return new Set(e).size===e.length}function jL(t){if(t!==Pw)return t===Nw?Pw:Nw}function WL(t){var e=t.querySelector(".".concat(pMe));return e}function zL(t,e){if(t<0||!e.parentNode)return!1;var r=e.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(e.parentNode)-r.length;return n===-1}function OO(t,e,r){return t===-1&&e>=0&&Gu(r)===!1}var yMe="ascending",vMe="descending",sX="indicatorDisabled",lX="columnSorting",uX="sortAction",cX=new Map([[Nw,yMe],[Pw,vMe]]);function bMe(t,e,r,n){var i=[lX];if(n&&i.push(uX),r===!1)return i.push(sX),i;var o=t.getSortOrderOfColumn(e);return He(o)&&i.push(cX.get(o)),i}function wMe(){return Array.from(cX.values()).concat(uX,sX,lX)}function fX(t,e,r){var n=e.locale;return function(i,o){var a=r.sortEmptyCells;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof o=="string"&&(o=o.toLocaleLowerCase(n)),i===o?oa:on(i)?on(o)?oa:a&&t==="asc"?vr:br:on(o)?a&&t==="asc"?br:vr:isNaN(i)&&!isNaN(o)?t==="asc"?br:vr:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?vr:br:i>o?t==="asc"?br:vr:oa}}var hX="default";function SMe(t,e,r){return function(n,i){var o=parseFloat(n),a=parseFloat(i),s=r.sortEmptyCells;if(o===a||isNaN(o)&&isNaN(a))return oa;if(s){if(on(n))return t==="asc"?vr:br;if(on(i))return t==="asc"?br:vr}return isNaN(o)?br:isNaN(a)?vr:o<a?t==="asc"?vr:br:o>a?t==="asc"?br:vr:oa}}var RMe="numeric";function EMe(t,e,r){var n=e.checkedTemplate,i=e.uncheckedTemplate,o=r.sortEmptyCells;return function(a,s){var l=on(a),u=on(s),c=l?i:a,f=u?i:s,h=c===i||c===n,d=f===i||f===n;if(o===!1){if(l&&u===!1)return br;if(l===!1&&u)return vr}return h===!1&&d?t==="asc"?vr:br:h&&d===!1?t==="asc"?br:vr:h===!1&&d===!1?fX(t,e,r)(a,s):c===i&&f===n?t==="asc"?vr:br:c===n&&f===i?t==="asc"?br:vr:oa}}var CMe="checkbox";function _Me(t,e,r){return function(n,i){var o=r.sortEmptyCells;if(n===i)return oa;if(on(n))return on(i)?oa:o&&t==="asc"?vr:br;if(on(i))return o&&t==="asc"?br:vr;var a=e.dateFormat,s=qt(n,a),l=qt(i,a);return s.isValid()?l.isValid()?l.isAfter(s)?t==="asc"?vr:br:l.isBefore(s)?t==="asc"?br:vr:oa:vr:br}}var TMe="date",_3=so("sorting.compareFunctionFactory"),T6=_3.register,GL=_3.getItem,OMe=_3.hasItem,dX=so("sorting.mainSortComparator"),pX=dX.register,AMe=dX.getItem;function mX(t){return OMe(t)?GL(t):GL(hX)}T6(RMe,SMe);T6(CMe,EMe);T6(TMe,_Me);T6(hX,fX);var oa=0,vr=-1,br=1;function IMe(t,e){for(var r=AMe(e),n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];t.sort(r.apply(void 0,i))}function YL(t){return PMe(t)||NMe(t)||MMe(t)||xMe()}function xMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MMe(t,e){if(!!t){if(typeof t=="string")return KL(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KL(t,e)}}function KL(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function NMe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function PMe(t){if(Array.isArray(t))return t}function kMe(t,e){return function(r,n){var i=YL(r),o=i.slice(1),a=YL(n),s=a.slice(1);return function(u){var c=t[u],f=e[u],h=o[u],d=s[u],p=f.columnSorting,m=p.compareFunctionFactory?p.compareFunctionFactory:mX(f.type),g=m(c,f,p)(h,d);return g}(0)}}function ud(t){return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ud(t)}var $Me=["column"],LMe=["column"];function Yc(t){return BMe(t)||HMe(t)||FMe(t)||DMe()}function DMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FMe(t,e){if(!!t){if(typeof t=="string")return AO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AO(t,e)}}function HMe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function BMe(t){if(Array.isArray(t))return AO(t)}function AO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function qL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function XL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qL(Object(r),!0).forEach(function(n){UMe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function UMe(t,e,r){return e=gX(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QL(t,e){if(t==null)return{};var r=VMe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function VMe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function jMe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ZL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gX(n.key),n)}}function WMe(t,e,r){return e&&ZL(t.prototype,e),r&&ZL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function gX(t){var e=zMe(t,"string");return ud(e)==="symbol"?e:String(e)}function zMe(t,e){if(ud(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fu(){return typeof Reflect<"u"&&Reflect.get?fu=Reflect.get.bind():fu=function(e,r,n){var i=GMe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},fu.apply(this,arguments)}function GMe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=za(t),t!==null););return t}function YMe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&IO(t,e)}function IO(t,e){return IO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},IO(t,e)}function KMe(t){var e=QMe();return function(){var n=za(t),i;if(e){var o=za(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return qMe(this,i)}}function qMe(t,e){if(e&&(ud(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XMe(t)}function XMe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function QMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function za(t){return za=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},za(t)}var xO="columnSorting",ZMe=50,JL="append",JMe="replace";pX(xO,kMe);Ue.getSingleton().register("beforeColumnSort");Ue.getSingleton().register("afterColumnSort");var yX=function(t){YMe(r,t);var e=KMe(r);function r(n){var i;return jMe(this,r),i=e.call(this,n),i.columnStatesManager=null,i.columnMetaCache=null,i.pluginKey=xO,i.indexesSequenceCache=null,i}return WMe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnStatesManager=new dMe(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new _l(function(o){var a=i.hot.toVisualColumn(o);return a===null&&(a=o),i.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(o,a){return i.onAfterGetColHeader(o,a)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(o,a){return i.onAfterOnCellMouseDown(o,a)}),this.addHook("afterInit",function(){return i.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.hot.view&&this.loadOrSortBySettings(),fu(za(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this,o=function(s,l){var u=WL(l);zL(s,l)===!1||u===null||i.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",o),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("afterGetColHeader",o)}),this.hot.batchExecution(function(){i.indexesSequenceCache!==null&&(i.hot.rowIndexMapper.setIndexesSequence(i.indexesSequenceCache.getValues()),i.hot.rowIndexMapper.unregisterMap(i.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,fu(za(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){var o=this.getSortConfig(),a=this.getNormalizedSortConfigs(i),s=this.areValidSortConfigs(a),l=this.hot.runHooks("beforeColumnSort",o,a,s);l!==!1&&(o.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new qq),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",o,s?a:o,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(i){return He(i)?this.columnStatesManager.getColumnSortState(i):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(i){var o=this.getNormalizedSortConfigs(i);this.areValidSortConfigs(o)&&this.columnStatesManager.setSortStates(o)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i.slice(0,1):[i]}},{key:"areValidSortConfigs",value:function(i){var o=this.hot.countCols();return gMe(i)&&i.every(function(a){var s=a.column;return s<=o&&s>=0})}},{key:"saveAllSortSettings",value:function(i){var o=this,a=this.columnStatesManager.getAllColumnsProperties(),s=function(u){var c=u.column,f=QL(u,$Me);return XL({column:o.hot.toPhysicalColumn(c)},f)};a.initialConfig=wt(i,s),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var i=this,o={};this.hot.runHooks("persistentStateLoad","columnSorting",o);var a=o.value,s=function(u){var c=u.column,f=QL(u,LMe);return XL({column:i.hot.toVisualColumn(c)},f)};return He(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=wt(a.initialConfig,s)),a}},{key:"getColumnNextConfig",value:function(i){var o=this.columnStatesManager.getSortOrderOfColumn(i);if(He(o)){var a=jL(o);return He(a)?{column:i,sortOrder:a}:void 0}var s=this.hot.countCols();if(Number.isInteger(i)&&i>=0&&i<s)return{column:i,sortOrder:jL()}}},{key:"getNextSortConfig",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:JL,a=this.columnStatesManager.getIndexOfColumnInSortQueue(i),s=a!==-1,l=this.getSortConfig(),u=this.getColumnNextConfig(i);if(s){if(tr(u))return[].concat(Yc(l.slice(0,a)),Yc(l.slice(a+1)));if(o===JL)return[].concat(Yc(l.slice(0,a)),Yc(l.slice(a+1)),[u]);if(o===JMe)return[].concat(Yc(l.slice(0,a)),[u],Yc(l.slice(a+1)))}return He(u)?l.concat(u):l}},{key:"getPluginColumnConfig",value:function(i){if(St(i)){var o=i[this.pluginKey];if(St(o))return o}return{}}},{key:"getMergedPluginSettings",value:function(i){var o=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,i),l=Object.getPrototypeOf(s);return Array.isArray(l.columns)?Object.assign(a,o,this.getPluginColumnConfig(l.columns[i])):sr(l.columns)?Object.assign(a,o,this.getPluginColumnConfig(l.columns(i))):Object.assign(a,o)}},{key:"getFirstCellSettings",value:function(i){var o=this.hot.getCellMeta(0,i),a=Object.create(o);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(i)),a}},{key:"getNumberOfRowsToSort",value:function(i){var o=this.hot.getSettings();return o.maxRows<=i?o.maxRows:i-o.minSpareRows}},{key:"sortByPresetSortStates",value:function(i){var o=this;if(i.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],s=this.hot.countRows(),l=function(g){return wt(i,function(v){return o.hot.getDataAtCell(g,v.column)})},u=0;u<this.getNumberOfRowsToSort(s);u+=1)a.push([this.hot.toPhysicalRow(u)].concat(l(u)));var c=wt(a,function(m){return m[0]});IMe(a,this.pluginKey,wt(i,function(m){return m.sortOrder}),wt(i,function(m){return o.getFirstCellSettings(m.column)}));for(var f=a.length;f<s;f+=1)a.push([f].concat(l(f)));var h=wt(a,function(m){return m[0]}),d=new Map(wt(c,function(m,g){return[m,h[g]]})),p=wt(this.hot.rowIndexMapper.getIndexesSequence(),function(m){return d.has(m)?d.get(m):m});this.hot.rowIndexMapper.setIndexesSequence(p)}},{key:"loadOrSortBySettings",value:function(){var i=this.getAllSavedSortSettings();if(St(i))this.sortBySettings(i);else{var o=this.hot.getSettings()[this.pluginKey];this.sortBySettings(o)}}},{key:"sortBySettings",value:function(i){if(St(i)){this.columnStatesManager.updateAllColumnsProperties(i);var o=i.initialConfig;(Array.isArray(o)||St(o))&&this.sort(o)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(i,o){var a=WL(o);if(!(zL(i,o)===!1||a===null)){var s=this.getFirstCellSettings(i)[this.pluginKey],l=s.indicator,u=s.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,i,l,u)}}},{key:"updateHeaderClasses",value:function(i){if(ut(i,wMe()),this.enabled!==!1){for(var o=arguments.length,a=new Array(o>1?o-1:0),s=1;s<o;s++)a[s-1]=arguments[s];_e(i,bMe.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(i){fu(za(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),He(i[this.pluginKey])&&this.sortBySettings(i[this.pluginKey])}},{key:"onAfterLoadData",value:function(i){i===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(i,o){var a=this.getFirstCellSettings(o)[this.pluginKey],s=a.headerAction;return s&&i.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){OO(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,o){OO(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(o.col)),this.sort(this.getColumnNextConfig(o.col)))}},{key:"destroy",value:function(){var i;(i=this.columnStatesManager)===null||i===void 0||i.destroy(),fu(za(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return xO}},{key:"PLUGIN_PRIORITY",get:function(){return ZMe}}]),r}(jt),eNe=tt,T3=mt,tNe=El,rNe=AY,nNe=QY,eD=dt,iNe=RangeError,vX=String,bX=Math.floor,MO=T3(nNe),tD=T3("".slice),hm=T3(1 .toFixed),kf=function(t,e,r){return e===0?r:e%2===1?kf(t,e-1,r*t):kf(t*t,e/2,r)},oNe=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e},Kc=function(t,e,r){for(var n=-1,i=r;++n<6;)i+=e*t[n],t[n]=i%1e7,i=bX(i/1e7)},FE=function(t,e){for(var r=6,n=0;--r>=0;)n+=t[r],t[r]=bX(n/e),n=n%e*1e7},rD=function(t){for(var e=6,r="";--e>=0;)if(r!==""||e===0||t[e]!==0){var n=vX(t[e]);r=r===""?n:r+MO("0",7-n.length)+n}return r},aNe=eD(function(){return hm(8e-5,3)!=="0.000"||hm(.9,0)!=="1"||hm(1.255,2)!=="1.25"||hm(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!eD(function(){hm({})});eNe({target:"Number",proto:!0,forced:aNe},{toFixed:function(e){var r=rNe(this),n=tNe(e),i=[0,0,0,0,0,0],o="",a="0",s,l,u,c;if(n<0||n>20)throw iNe("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return vX(r);if(r<0&&(o="-",r=-r),r>1e-21)if(s=oNe(r*kf(2,69,1))-69,l=s<0?r*kf(2,-s,1):r/kf(2,s,1),l*=4503599627370496,s=52-s,s>0){for(Kc(i,0,l),u=n;u>=7;)Kc(i,1e7,0),u-=7;for(Kc(i,kf(10,u,1),0),u=s-1;u>=23;)FE(i,1<<23),u-=23;FE(i,1<<u),Kc(i,1,1),FE(i,2),a=rD(i)}else Kc(i,0,l),Kc(i,1<<-s,0),a=rD(i)+MO("0",n);return n>0?(c=a.length,a=o+(c<=n?"0."+MO("0",n-c)+a:tD(a,0,c-n)+"."+tD(a,c-n))):a=o+a,a}});function vy(t){return vy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vy(t)}function sNe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,uNe(n.key),n)}}function lNe(t,e,r){return e&&nD(t.prototype,e),r&&nD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function uNe(t){var e=cNe(t,"string");return vy(e)==="symbol"?e:String(e)}function cNe(t,e){if(vy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(vy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fNe=function(){function t(e,r){sNe(this,t),this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return lNe(t,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,i=[],o=r;if(!o&&typeof this.settings=="function"){this.settingsType="function";return}return o||(o=this.settings),ae(o,function(a){var s={};n.assignSetting(a,s,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,s,"reversedRowCoords",!1),n.assignSetting(a,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,s,"sourceColumn",a.destinationColumn),n.assignSetting(a,s,"type","sum"),n.assignSetting(a,s,"forceNumeric",!1),n.assignSetting(a,s,"suppressDataTypeErrors",!0),n.assignSetting(a,s,"suppressDataTypeErrors",!0),n.assignSetting(a,s,"customFunction",null),n.assignSetting(a,s,"readOnly",!0),n.assignSetting(a,s,"roundFloat",!1),i.push(s)}),i}},{key:"assignSetting",value:function(r,n,i,o){if(i==="ranges"&&r[i]===void 0){n[i]=o;return}else if(i==="ranges"&&r[i].length===0)return;if(r[i]===void 0){if(o instanceof Error)throw o;n[i]=o}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-r[i]-1:n[i]=r[i]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,i){if(this.settingsType==="function"){var o=r.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();ae(a,function(s){o==="row"&&s.destinationRow>=n&&(r==="insert_row"?s.alterRowOffset=i:r==="remove_row"&&(s.alterRowOffset=-1*i)),o==="col"&&s.destinationColumn>=n&&(r==="insert_col"?s.alterColumnOffset=i:r==="remove_col"&&(s.alterColumnOffset=-1*i))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,i,o,a){var s=this,l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function m(){return s.hot.removeHook("beforeViewRender",m),s.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var c=r.indexOf("row")>-1?"row":"col",f=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,p=n;ae(h,function(m){c==="row"&&m.destinationRow>=p&&(m.alterRowOffset=f*i),c==="col"&&m.destinationColumn>=p&&(m.alterColumnOffset=f*i)}),this.resetAllEndpoints(h,!d),d?ae(h,function(m){s.extendEndpointRanges(m,p,o[0],o.length),s.recreatePhysicalRanges(m),s.clearOffsetInformation(m)}):ae(h,function(m){s.shiftEndpointCoordinates(m,p)}),l&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,i,o){ae(r.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?i>a[1]?a[1]+=o:i<a[0]&&(a[0]-=o):i>=a[0]&&i<=a[1]&&(a[1]-=o,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,i=r.ranges,o=[],a=[];ae(i,function(s){var l=[];if(s[1])for(var u=s[0];u<=s[1];u++)l.push(n.hot.toPhysicalRow(u));else l.push(n.hot.toPhysicalRow(s[0]));a.push(l)}),ae(a,function(s){var l=[];ae(s,function(u,c){c===0?l.push(u):s[c]!==s[c-1]+1&&(l.push(s[c-1]),o.push(l),l=[],l.push(u)),c===s.length-1&&(l.push(u),o.push(l))})}),r.ranges=o}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,ae(r.ranges,function(i){ae(i,function(o,a){o>=n&&(i[a]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=n.some(function(a){var s=a.alterRowOffset||0,l=a.alterColumnOffset||0;return a.destinationRow+s>=r.hot.countRows()||a.destinationColumn+l>=r.hot.countCols()});o||(this.cellsToSetCache=[],ae(n,function(a){r.resetEndpointValue(a,i)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],ae(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,i=[];this.cellsToSetCache=[],ae(r,function(o,a,s){"".concat(o[2]||"")!=="".concat(o[3])&&ae(n.getAllEndpoints(),function(l,u){n.hot.propToCol(s[a][1])===l.sourceColumn&&i.indexOf(u)===-1&&i.push(u)})}),ae(i,function(o){n.refreshEndpoint(n.getEndpoint(o))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=r.alterRowOffset||0,o=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?i:0)),this.hot.toVisualColumn(r.destinationColumn+(n?o:0)),""])}},{key:"setEndpointValue",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var a=this.hot.toVisualRow(r.destinationRow);if(a!==null){var s=this.hot.getCellMeta(a,r.destinationColumn);(n==="init"||s.readOnly!==r.readOnly)&&(s.readOnly=r.readOnly,s.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),i?this.hot.setDataAtCell(o,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){Xt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),t}();const hNe=fNe;function HE(t){return t==null||isNaN(t)}function cd(t){return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cd(t)}var iD;function dNe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function pNe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gNe(n.key),n)}}function mNe(t,e,r){return e&&oD(t.prototype,e),r&&oD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function gNe(t){var e=yNe(t,"string");return cd(e)==="symbol"?e:String(e)}function yNe(t,e){if(cd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function r2(){return typeof Reflect<"u"&&Reflect.get?r2=Reflect.get.bind():r2=function(e,r,n){var i=vNe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},r2.apply(this,arguments)}function vNe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=fd(t),t!==null););return t}function bNe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&NO(t,e)}function NO(t,e){return NO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},NO(t,e)}function wNe(t){var e=ENe();return function(){var n=fd(t),i;if(e){var o=fd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return SNe(this,i)}}function SNe(t,e){if(e&&(cd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RNe(t)}function RNe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ENe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fd(t){return fd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fd(t)}var BE="columnSummary",CNe=220,_Ne=function(t){bNe(r,t);var e=wNe(r);function r(n){var i;return pNe(this,r),i=e.call(this,n),i.endpoints=null,i}return mNe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[BE]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.settings=this.hot.getSettings()[BE],this.endpoints=new hNe(this,this.settings),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeCreateRow",function(o,a,s){return i.endpoints.resetSetupBeforeStructureAlteration("insert_row",o,a,null,s)}),this.addHook("beforeCreateCol",function(o,a,s){return i.endpoints.resetSetupBeforeStructureAlteration("insert_col",o,a,null,s)}),this.addHook("beforeRemoveRow",function(){for(var o,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(o=i.endpoints).resetSetupBeforeStructureAlteration.apply(o,["remove_row"].concat(s))}),this.addHook("beforeRemoveCol",function(){for(var o,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(o=i.endpoints).resetSetupBeforeStructureAlteration.apply(o,["remove_col"].concat(s))}),this.addHook("afterCreateRow",function(o,a,s){return i.endpoints.resetSetupAfterStructureAlteration("insert_row",o,a,null,s)}),this.addHook("afterCreateCol",function(o,a,s){return i.endpoints.resetSetupAfterStructureAlteration("insert_col",o,a,null,s)}),this.addHook("afterRemoveRow",function(){for(var o,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(o=i.endpoints).resetSetupAfterStructureAlteration.apply(o,["remove_row"].concat(s))}),this.addHook("afterRemoveCol",function(){for(var o,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(o=i.endpoints).resetSetupAfterStructureAlteration.apply(o,["remove_col"].concat(s))}),this.addHook("afterRowMove",function(){return i.onAfterRowMove.apply(i,arguments)}),r2(fd(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(i){switch(i.type.toLowerCase()){case"sum":i.result=this.calculateSum(i);break;case"min":i.result=this.calculateMinMax(i,i.type);break;case"max":i.result=this.calculateMinMax(i,i.type);break;case"count":i.result=this.countEntries(i);break;case"average":i.result=this.calculateAverage(i);break;case"custom":i.result=i.customFunction.call(this,i);break}}},{key:"calculateSum",value:function(i){var o=this,a=0;return Rt(i.ranges,function(s){a+=o.getPartialSum(s,i.sourceColumn)}),a}},{key:"getPartialSum",value:function(i,o){var a=0,s=i[1]||i[0],l=null,u=0;do{if(l=this.getCellValue(s,o),l=HE(l)?null:l,l!==null){var c=("".concat(l).split(".")[1]||[]).length||1;c>u&&(u=c)}a+=l||0,s-=1}while(s>=i[0]);return Math.round(a*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(i,o){var a=this,s=null;return Rt(i.ranges,function(l){var u=a.getPartialMinMax(l,i.sourceColumn,o);if(s===null&&u!==null&&(s=u),u!==null)switch(o){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}}),s===null?"Not enough data":s}},{key:"getPartialMinMax",value:function(i,o,a){var s=null,l=i[1]||i[0],u;do{if(u=this.getCellValue(l,o),u=HE(u)?null:u,s===null)s=u;else if(u!==null)switch(a){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}l-=1}while(l>=i[0]);return s}},{key:"countEmpty",value:function(i,o){var a,s=0,l=i[1]||i[0];do a=this.getCellValue(l,o),a=HE(a)?null:a,a===null&&(s+=1),l-=1;while(l>=i[0]);return s}},{key:"countEntries",value:function(i){var o=this,a=0,s=i.ranges;return Rt(s,function(l){var u=l[1]===void 0?1:l[1]-l[0]+1,c=o.countEmpty(l,i.sourceColumn);a+=u,a-=c}),a}},{key:"calculateAverage",value:function(i){var o=this.calculateSum(i),a=this.countEntries(i);return o/a}},{key:"getCellValue",value:function(i,o){var a=this.hot.toVisualRow(i),s=this.hot.toVisualColumn(o),l=this.hot.getSourceDataAtCell(i,o),u="";if(a!==null&&s!==null&&(u=this.hot.getCellMeta(a,s).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof l=="string"&&(l=l.replace(/,/,".")),l=parseFloat(l)),isNaN(l)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Gt(iD||(iD=dNe(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),i,o));return l}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(i,o){i&&o!=="ColumnSummary.reset"&&o!=="ColumnSummary.set"&&o!=="loadData"&&this.endpoints.refreshChangedEndpoints(i)}},{key:"onAfterRowMove",value:function(i,o){this.endpoints.resetSetupBeforeStructureAlteration("move_row",i[0],i.length,i,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",o,i.length,i,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return BE}},{key:"PLUGIN_PRIORITY",get:function(){return CNe}}]),r}(jt);function by(t){return by=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},by(t)}function TNe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ANe(n.key),n)}}function ONe(t,e,r){return e&&aD(t.prototype,e),r&&aD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ANe(t){var e=INe(t,"string");return by(e)==="symbol"?e:String(e)}function INe(t,e){if(by(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(by(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xNe=function(){function t(e,r){TNe(this,t),this.rootDocument=e,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return ONe(t,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var i=this.getInputElement();i.style.width="".concat(r,"px"),i.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:Qt(this.getInputElement()),height:wr(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),_e(this.container,t.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),_e(r,t.CLASS_EDITOR),_e(n,t.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(t.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),t}();const MNe=xNe;var vt="---------";function NNe(){return{name:vt}}function PNe(t){return wt(t,function(e){return{start:e.getTopStartCorner(),end:e.getBottomEndCorner()}})}function x0(t){return at(t,"htSeparator")}function kNe(t){return at(t,"htSubmenu")}function M0(t){return at(t,"htDisabled")}function N0(t){return at(t,"htSelectionDisabled")}function Oc(t){var e=t.getSelected();return!e||e[0]<0?null:e}function $Ne(t,e){if(t.indexOf(e)!==-1)return t;var r=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(e)}function LNe(t,e){if(t.indexOf(e)!==-1)return t;var r=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(e)}function Fl(t,e){var r={};return ae(t,function(n){n.forAll(function(i,o){i>=0&&o>=0&&(r[i]||(r[i]=[]),r[i][o]=e(i,o))})}),r}function Hs(t,e,r,n,i){ae(t,function(o){o.forAll(function(a,s){a>=0&&s>=0&&DNe(a,s,e,r,n,i)})})}function DNe(t,e,r,n,i,o){var a=i(t,e),s=n;a.className&&(r==="vertical"?s=$Ne(a.className,n):s=LNe(a.className,n)),o(t,e,"className",s)}function Qo(t,e){var r=!1;return Array.isArray(t)&&ae(t,function(n){return n.forAll(function(i,o){if(i>=0&&o>=0&&e(i,o))return r=!0,!1}),r}),r}function Pa(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function FNe(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function wX(t,e){for(var r=t.slice(0),n=0;n<r.length&&r[n].name===e;)r.shift();return r}function HNe(t,e){var r=t.slice(0);return r.reverse(),r=wX(r,e),r.reverse(),r}function BNe(t){var e=[];return ae(t,function(r,n){n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function UNe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vt,r=t.slice(0);return r=wX(r,e),r=HNe(r,e),r=BNe(r),r}function wy(t){return wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wy(t)}function VNe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,WNe(n.key),n)}}function jNe(t,e,r){return e&&sD(t.prototype,e),r&&sD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function WNe(t){var e=zNe(t,"string");return wy(e)==="symbol"?e:String(e)}function zNe(t,e){if(wy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(wy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var GNe=250,YNe=250,SX=function(){function t(e){VNe(this,t),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}return jNe(t,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},YNe)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:GNe;this.showDebounced=xK(function(i){r.wasLastActionShow&&r.runLocalHooks("show",i.from.row,i.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),t}();ir(SX,wi);const KNe=SX;var RX="ContextMenu:items",ct=RX,O3="".concat(ct,".noItems"),A3="".concat(ct,".insertRowAbove"),I3="".concat(ct,".insertRowBelow"),x3="".concat(ct,".insertColumnOnTheLeft"),M3="".concat(ct,".insertColumnOnTheRight"),N3="".concat(ct,".removeRow"),P3="".concat(ct,".removeColumn"),k3="".concat(ct,".undo"),$3="".concat(ct,".redo"),L3="".concat(ct,".readOnly"),D3="".concat(ct,".clearColumn"),F3="".concat(ct,".copy"),H3="".concat(ct,".copyWithHeaders"),B3="".concat(ct,".copyWithGroupHeaders"),U3="".concat(ct,".copyHeadersOnly"),V3="".concat(ct,".cut"),j3="".concat(ct,".freezeColumn"),W3="".concat(ct,".unfreezeColumn"),z3="".concat(ct,".mergeCells"),G3="".concat(ct,".unmergeCells"),Y3="".concat(ct,".addComment"),K3="".concat(ct,".editComment"),q3="".concat(ct,".removeComment"),X3="".concat(ct,".readOnlyComment"),Q3="".concat(ct,".align"),Z3="".concat(ct,".align.left"),J3="".concat(ct,".align.center"),eI="".concat(ct,".align.right"),tI="".concat(ct,".align.justify"),rI="".concat(ct,".align.top"),nI="".concat(ct,".align.middle"),iI="".concat(ct,".align.bottom"),oI="".concat(ct,".borders"),aI="".concat(ct,".borders.top"),sI="".concat(ct,".borders.right"),lI="".concat(ct,".borders.bottom"),uI="".concat(ct,".borders.left"),cI="".concat(ct,".borders.remove"),fI="".concat(ct,".nestedHeaders.insertChildRow"),hI="".concat(ct,".nestedHeaders.detachFromParent"),dI="".concat(ct,".hideColumn"),pI="".concat(ct,".showColumn"),mI="".concat(ct,".hideRow"),gI="".concat(ct,".showRow"),ei="Filters:",Cr="".concat(ei,"conditions"),O6="".concat(Cr,".none"),yI="".concat(Cr,".isEmpty"),vI="".concat(Cr,".isNotEmpty"),bI="".concat(Cr,".isEqualTo"),wI="".concat(Cr,".isNotEqualTo"),SI="".concat(Cr,".beginsWith"),RI="".concat(Cr,".endsWith"),EI="".concat(Cr,".contains"),CI="".concat(Cr,".doesNotContain"),qNe="".concat(Cr,".byValue"),_I="".concat(Cr,".greaterThan"),TI="".concat(Cr,".greaterThanOrEqualTo"),OI="".concat(Cr,".lessThan"),AI="".concat(Cr,".lessThanOrEqualTo"),II="".concat(Cr,".isBetween"),xI="".concat(Cr,".isNotBetween"),MI="".concat(Cr,".after"),NI="".concat(Cr,".before"),PI="".concat(Cr,".today"),kI="".concat(Cr,".tomorrow"),$I="".concat(Cr,".yesterday"),LI="".concat(ei,"labels.filterByCondition"),DI="".concat(ei,"labels.filterByValue"),FI="".concat(ei,"labels.conjunction"),A6="".concat(ei,"labels.disjunction"),kw="".concat(ei,"values.blankCells"),HI="".concat(ei,"buttons.selectAll"),BI="".concat(ei,"buttons.clear"),UI="".concat(ei,"buttons.ok"),VI="".concat(ei,"buttons.cancel"),jI="".concat(ei,"buttons.placeholder.search"),WI="".concat(ei,"buttons.placeholder.value"),zI="".concat(ei,"buttons.placeholder.secondValue");const XNe=Object.freeze(Object.defineProperty({__proto__:null,CONTEXT_MENU_ITEMS_NAMESPACE:RX,CONTEXTMENU_ITEMS_NO_ITEMS:O3,CONTEXTMENU_ITEMS_ROW_ABOVE:A3,CONTEXTMENU_ITEMS_ROW_BELOW:I3,CONTEXTMENU_ITEMS_INSERT_LEFT:x3,CONTEXTMENU_ITEMS_INSERT_RIGHT:M3,CONTEXTMENU_ITEMS_REMOVE_ROW:N3,CONTEXTMENU_ITEMS_REMOVE_COLUMN:P3,CONTEXTMENU_ITEMS_UNDO:k3,CONTEXTMENU_ITEMS_REDO:$3,CONTEXTMENU_ITEMS_READ_ONLY:L3,CONTEXTMENU_ITEMS_CLEAR_COLUMN:D3,CONTEXTMENU_ITEMS_COPY:F3,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:H3,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:B3,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:U3,CONTEXTMENU_ITEMS_CUT:V3,CONTEXTMENU_ITEMS_FREEZE_COLUMN:j3,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:W3,CONTEXTMENU_ITEMS_MERGE_CELLS:z3,CONTEXTMENU_ITEMS_UNMERGE_CELLS:G3,CONTEXTMENU_ITEMS_ADD_COMMENT:Y3,CONTEXTMENU_ITEMS_EDIT_COMMENT:K3,CONTEXTMENU_ITEMS_REMOVE_COMMENT:q3,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:X3,CONTEXTMENU_ITEMS_ALIGNMENT:Q3,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:Z3,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:J3,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:eI,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:tI,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:rI,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:nI,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:iI,CONTEXTMENU_ITEMS_BORDERS:oI,CONTEXTMENU_ITEMS_BORDERS_TOP:aI,CONTEXTMENU_ITEMS_BORDERS_RIGHT:sI,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:lI,CONTEXTMENU_ITEMS_BORDERS_LEFT:uI,CONTEXTMENU_ITEMS_REMOVE_BORDERS:cI,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:fI,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:hI,CONTEXTMENU_ITEMS_HIDE_COLUMN:dI,CONTEXTMENU_ITEMS_SHOW_COLUMN:pI,CONTEXTMENU_ITEMS_HIDE_ROW:mI,CONTEXTMENU_ITEMS_SHOW_ROW:gI,FILTERS_NAMESPACE:ei,FILTERS_CONDITIONS_NAMESPACE:Cr,FILTERS_CONDITIONS_NONE:O6,FILTERS_CONDITIONS_EMPTY:yI,FILTERS_CONDITIONS_NOT_EMPTY:vI,FILTERS_CONDITIONS_EQUAL:bI,FILTERS_CONDITIONS_NOT_EQUAL:wI,FILTERS_CONDITIONS_BEGINS_WITH:SI,FILTERS_CONDITIONS_ENDS_WITH:RI,FILTERS_CONDITIONS_CONTAINS:EI,FILTERS_CONDITIONS_NOT_CONTAIN:CI,FILTERS_CONDITIONS_BY_VALUE:qNe,FILTERS_CONDITIONS_GREATER_THAN:_I,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:TI,FILTERS_CONDITIONS_LESS_THAN:OI,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:AI,FILTERS_CONDITIONS_BETWEEN:II,FILTERS_CONDITIONS_NOT_BETWEEN:xI,FILTERS_CONDITIONS_AFTER:MI,FILTERS_CONDITIONS_BEFORE:NI,FILTERS_CONDITIONS_TODAY:PI,FILTERS_CONDITIONS_TOMORROW:kI,FILTERS_CONDITIONS_YESTERDAY:$I,FILTERS_DIVS_FILTER_BY_CONDITION:LI,FILTERS_DIVS_FILTER_BY_VALUE:DI,FILTERS_LABELS_CONJUNCTION:FI,FILTERS_LABELS_DISJUNCTION:A6,FILTERS_VALUES_BLANK_CELLS:kw,FILTERS_BUTTONS_SELECT_ALL:HI,FILTERS_BUTTONS_CLEAR:BI,FILTERS_BUTTONS_OK:UI,FILTERS_BUTTONS_CANCEL:VI,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:jI,FILTERS_BUTTONS_PLACEHOLDER_VALUE:WI,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:zI},Symbol.toStringTag,{value:"Module"}));function hd(t){return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hd(t)}function UE(t,e,r){return e=EX(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QNe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,EX(n.key),n)}}function ZNe(t,e,r){return e&&lD(t.prototype,e),r&&lD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function EX(t){var e=JNe(t,"string");return hd(e)==="symbol"?e:String(e)}function JNe(t,e){if(hd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hu(){return typeof Reflect<"u"&&Reflect.get?hu=Reflect.get.bind():hu=function(e,r,n){var i=ePe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},hu.apply(this,arguments)}function ePe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ga(t),t!==null););return t}function tPe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&PO(t,e)}function PO(t,e){return PO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},PO(t,e)}function rPe(t){var e=iPe();return function(){var n=Ga(t),i;if(e){var o=Ga(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return nPe(this,i)}}function nPe(t,e){if(e&&(hd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CX(t)}function CX(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function iPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ga(t){return Ga=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ga(t)}var VE="comments",oPe=60,P0=new WeakMap,Ho="comment",qc="value",uD="style",k0="readOnly",aPe=function(t){tPe(r,t);var e=rPe(r);function r(n){var i;return QNe(this,r),i=e.call(this,n),i.editor=null,i.displaySwitch=null,i.eventManager=null,i.range={},i.preventEditorAutoSwitch=!1,P0.set(CX(i),{tempEditorDimensions:{},cellBelowCursor:null}),i}return ZNe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[VE]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.editor||(this.editor=new MNe(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Er(this)),this.displaySwitch||(this.displaySwitch=new KNe(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(o){return i.addToContextMenu(o)}),this.addHook("afterRenderer",function(o,a,s,l,u,c){return i.onAfterRenderer(o,c)}),this.addHook("afterScrollHorizontally",function(){return i.hide()}),this.addHook("afterScrollVertically",function(){return i.hide()}),this.addHook("afterBeginEditing",function(){return i.hide()}),this.displaySwitch.addLocalHook("hide",function(){return i.hide()}),this.displaySwitch.addLocalHook("show",function(o,a){return i.showAtCell(o,a)}),this.registerListeners(),hu(Ga(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),hu(Ga(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){hu(Ga(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var i=this,o=this.hot.rootDocument;this.eventManager.addEventListener(o,"mouseover",function(a){return i.onMouseOver(a)}),this.eventManager.addEventListener(o,"mousedown",function(a){return i.onMouseDown(a)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return i.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return i.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return i.onEditorMouseUp(a)})}},{key:"setRange",value:function(i){this.range=i}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(i){var o=Bu(i.target,"TD","TBODY");return!!(o&&at(o,"htCommentCell")&&Bu(o,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(i){return this.editor.getInputElement()===i.target}},{key:"setComment",value:function(i){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.editor.getValue(),a="";i!=null?a=i:o!=null&&(a=o);var s=this.range.from.row,l=this.range.from.col;this.updateCommentMeta(s,l,UE({},qc,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(i,o,a){this.setRange({from:this.hot._createCellCoords(i,o)}),this.setComment(a)}},{key:"removeComment",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Ho),i&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(i,o)}),this.removeComment(a)}},{key:"getComment",value:function(){var i=this.range.from.row,o=this.range.from.col;return this.getCommentMeta(i,o,qc)}},{key:"getCommentAtCell",value:function(i,o){return this.getCommentMeta(i,o,qc)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.range.from,o=i.row,a=i.col;if(o<0||o>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(s[Ho]?s[Ho][qc]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(i,o){return this.setRange({from:this.hot._createCellCoords(i,o)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var i,o,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var s=this.hot,l=s.rowIndexMapper,u=s.columnIndexMapper,c=this.range.from,f=c.row,h=c.col,d=l.getRenderableFromVisualIndex(f),p=u.getRenderableFromVisualIndex(h),m=d===null;this.editor.setPosition(0,0),d===null&&(d=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,-1))),p===null&&(p=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var g=d===null,v=p===null;d=(i=d)!==null&&i!==void 0?i:0,p=(o=p)!==null&&o!==void 0?o:0;var w=this.hot,b=w.rootWindow,E=w.view._wt,A=E.wtTable,M=E.getCell({row:d,col:p},!0),k=this.getCommentMeta(f,h,uD);k?this.editor.setSize(k.width,k.height):this.editor.resetSize();var O=v?0:A.getStretchedColumnWidth(p),x=m&&!g?wr(M):0,C=M.getBoundingClientRect(),I=C.left,H=C.top,j=C.width,q=C.height,Z=this.editor.getSize(),ne=Z.width,ie=Z.height,P=this.hot.rootWindow,y=P.innerWidth,R=P.innerHeight,_=this.hot.rootDocument.documentElement,$=I+b.scrollX+O,B=H+b.scrollY+x;this.hot.isRtl()&&($-=ne+O),this.hot.isLtr()&&I+j+ne>y?$=I+b.scrollX-ne-1:this.hot.isRtl()&&$<-(_.scrollWidth-_.clientWidth)&&($=I+b.scrollX+O+1),H+ie>R&&(B-=ie-q+1),this.editor.setPosition($,B),this.editor.setReadOnlyState(this.getCommentMeta(f,h,k0))}}},{key:"checkSelectionCommentsConsistency",value:function(){var i=this.hot.getSelectedRangeLast();if(!i)return!1;var o=!1,a=i.getTopStartCorner();return this.getCommentMeta(a.row,a.col,qc)&&(o=!0),o}},{key:"updateCommentMeta",value:function(i,o,a){var s=this.hot.getCellMeta(i,o)[Ho],l;s?(l=Qn(s),v6(l,a)):l=a,this.hot.setCellMeta(i,o,Ho,l)}},{key:"getCommentMeta",value:function(i,o,a){var s=this.hot.getCellMeta(i,o);if(!!s[Ho])return s[Ho][a]}},{key:"onMouseDown",value:function(i){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(i)){var o=Bu(i.target,"TD","TBODY"),a=null;o&&(a=this.hot.getCoords(o)),(!o||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}}},{key:"onMouseOver",value:function(i){var o=P0.get(this),a=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||at(i.target,"wtBorder")||o.cellBelowCursor===i.target||!this.editor))if(o.cellBelowCursor=a.elementFromPoint(i.clientX,i.clientY),this.targetIsCellWithComment(i)){var s=this.hot._createCellRange(this.hot.getCoords(i.target));this.displaySwitch.show(s)}else Uu(i.target,a)&&!this.targetIsCommentTextArea(i)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(i,o){o[Ho]&&o[Ho][qc]&&_e(i,o.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(i){var o=P0.get(this);o.tempEditorDimensions={width:Qt(i.target),height:wr(i.target)}}},{key:"onEditorMouseUp",value:function(i){var o=P0.get(this),a=Qt(i.target),s=wr(i.target);(a!==o.tempEditorDimensions.width+1||s!==o.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,UE({},uD,{width:a,height:s}))}},{key:"onContextMenuAddComment",value:function(){var i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:i.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var i=this,o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,o.forAll(function(a,s){a>=0&&s>=0&&i.removeCommentAtCell(a,s,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var i=this,o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,o.forAll(function(a,s){if(a>=0&&s>=0){var l=!!i.getCommentMeta(a,s,k0);i.updateCommentMeta(a,s,UE({},k0,!l))}})}},{key:"addToContextMenu",value:function(i){var o=this,a=function(){return o.hot.rowIndexMapper.getRenderableIndexesLength()>0&&o.hot.columnIndexMapper.getRenderableIndexesLength()>0};i.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return o.checkSelectionCommentsConsistency()?o.hot.getTranslatedPhrase(K3):o.hot.getTranslatedPhrase(Y3)},callback:function(){return o.onContextMenuAddComment()},disabled:function(){return a()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(q3)},callback:function(){return o.onContextMenuRemoveComment()},disabled:function(){return a()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var l=this,u=this.getTranslatedPhrase(X3),c=Qo(this.getSelectedRangeLast(),function(f,h){var d=l.getCellMeta(f,h)[Ho];if(d&&(d=d[k0]),d)return!0});return c&&(u=Pa(u)),u},callback:function(){return o.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner())||!o.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var i=this.hot.getSettings()[VE];if(St(i))return i.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),hu(Ga(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return VE}},{key:"PLUGIN_PRIORITY",get:function(){return oPe}}]),r}(jt);function Sy(t){return Sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sy(t)}function sPe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,uPe(n.key),n)}}function lPe(t,e,r){return e&&cD(t.prototype,e),r&&cD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function uPe(t){var e=cPe(t,"string");return Sy(e)==="symbol"?e:String(e)}function cPe(t,e){if(Sy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Sy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fPe=function(){function t(e){sPe(this,t),this.hot=e,this.commands={},this.commonCallback=null}return lPe(t,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var s=r.split(":"),l=s[0],u=s.length===2?s[1]:null,c=this.commands[l];if(!c)throw new Error("Menu command '".concat(l,"' not exists."));if(u&&c.submenu&&(c=hPe(u,c.submenu.items)),c.disabled!==!0&&!(typeof c.disabled=="function"&&c.disabled.call(this.hot)===!0)&&!Nr(c,"submenu")){var f=[];typeof c.callback=="function"&&f.push(c.callback),typeof this.commonCallback=="function"&&f.push(this.commonCallback),o.unshift(s.join(":")),ae(f,function(h){return h.apply(n.hot,o)})}}}]),t}();function hPe(t,e){var r;return ae(e,function(n){var i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}const _X=fPe;var Vi="alignment";function dPe(){return{key:Vi,name:function(){return this.getTranslatedPhrase(Q3)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(Vi,":left"),name:function(){var e=this,r=this.getTranslatedPhrase(Z3),n=Qo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(r=Pa(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Fl(r,function(a,s){return e.getCellMeta(a,s).className}),i="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",n,r,i,o),Hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(Vi,":center"),name:function(){var e=this,r=this.getTranslatedPhrase(J3),n=Qo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(r=Pa(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Fl(r,function(a,s){return e.getCellMeta(a,s).className}),i="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",n,r,i,o),Hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(Vi,":right"),name:function(){var e=this,r=this.getTranslatedPhrase(eI),n=Qo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(r=Pa(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Fl(r,function(a,s){return e.getCellMeta(a,s).className}),i="horizontal",o="htRight";this.runHooks("beforeCellAlignment",n,r,i,o),Hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(Vi,":justify"),name:function(){var e=this,r=this.getTranslatedPhrase(tI),n=Qo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(r=Pa(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Fl(r,function(a,s){return e.getCellMeta(a,s).className}),i="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",n,r,i,o),Hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{name:vt},{key:"".concat(Vi,":top"),name:function(){var e=this,r=this.getTranslatedPhrase(rI),n=Qo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(r=Pa(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Fl(r,function(a,s){return e.getCellMeta(a,s).className}),i="vertical",o="htTop";this.runHooks("beforeCellAlignment",n,r,i,o),Hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(Vi,":middle"),name:function(){var e=this,r=this.getTranslatedPhrase(nI),n=Qo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(r=Pa(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Fl(r,function(a,s){return e.getCellMeta(a,s).className}),i="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",n,r,i,o),Hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(Vi,":bottom"),name:function(){var e=this,r=this.getTranslatedPhrase(iI),n=Qo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(r=Pa(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Fl(r,function(a,s){return e.getCellMeta(a,s).className}),i="vertical",o="htBottom";this.runHooks("beforeCellAlignment",n,r,i,o),Hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1}]}}}var I6="clear_column";function pPe(){return{key:I6,name:function(){return this.getTranslatedPhrase(D3)},callback:function(e,r){var n=r[0].start.col,i=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),i,"ContextMenu.clearColumn")},disabled:function(){var e=Oc(this);return e?!this.selection.isSelectedByColumnHeader():!0}}}var $1="col_left";function mPe(){return{key:$1,name:function(){return this.getTranslatedPhrase(x3)},callback:function(){var e=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,e.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=Oc(this);if(!e)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var L1="col_right";function gPe(){return{key:L1,name:function(){return this.getTranslatedPhrase(M3)},callback:function(){var e=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,e.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=Oc(this);return e?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var D1="make_read_only";function yPe(){return{key:D1,name:function(){var e=this,r=this.getTranslatedPhrase(L3),n=Qo(this.getSelectedRange(),function(i,o){return e.getCellMeta(i,o).readOnly});return n&&(r=Pa(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Qo(r,function(i,o){return e.getCellMeta(i,o).readOnly});ae(r,function(i){i.forAll(function(o,a){o>=0&&a>=0&&e.setCellMeta(o,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var x6="redo";function vPe(){return{key:x6,name:function(){return this.getTranslatedPhrase($3)},callback:function(){this.redo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function TX(t,e){return RPe(t)||SPe(t,e)||wPe(t,e)||bPe()}function bPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wPe(t,e){if(!!t){if(typeof t=="string")return fD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fD(t,e)}}function fD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function SPe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function RPe(t){if(Array.isArray(t))return t}function kO(t){return kO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kO(t)}var M6=0,N6=1,OX=2,GI=3,EPe=[GI,OX],CPe=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],jE=Symbol("root"),hD=Symbol("child");function dd(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:jE;if(e!==jE&&e!==hD)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(t),n=e===jE,i=M6;if(r){var o=t[0];if(t.length===0)i=N6;else if(n&&o instanceof u3)i=GI;else if(n&&Array.isArray(o))i=dd(o,hD);else if(t.length>=2&&t.length<=4){var a=!t.some(function(s,l){return!CPe[l].includes(kO(s))});a&&(i=OX)}}return i}function Ry(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.keepDirection,n=r===void 0?!1:r,i=e.propToCol;if(!EPe.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){var a=t===GI,s=a?o.from.row:o[0],l=a?o.from.col:o[1],u=a?o.to.row:o[2],c=a?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),tr(u)&&(u=s),tr(c)&&(c=l),!n){var f=s,h=l,d=u,p=c;s=Math.min(f,d),l=Math.min(h,p),u=Math.max(f,d),c=Math.max(h,p)}return[s,l,u,c]}}function _Pe(t){var e=dd(t);if(e===M6||e===N6)return[];var r=Ry(e),n=new Set;ae(t,function(a){var s=r(a),l=TX(s,4),u=l[1],c=l[3],f=Math.max(u,0),h=c-f+1;ae(Array.from(new Array(h),function(d,p){return f+p}),function(d){n.has(d)||n.add(d)})});var i=Array.from(n).sort(function(a,s){return a-s}),o=Fn(i,function(a,s,l,u){return l!==0&&s===u[l-1]+1?a[a.length-1][1]+=1:a.push([s,1]),a},[]);return o}function TPe(t){var e=dd(t);if(e===M6||e===N6)return[];var r=Ry(e),n=new Set;ae(t,function(a){var s=r(a),l=TX(s,3),u=l[0],c=l[2],f=Math.max(u,0),h=c-f+1;ae(Array.from(new Array(h),function(d,p){return f+p}),function(d){n.has(d)||n.add(d)})});var i=Array.from(n).sort(function(a,s){return a-s}),o=Fn(i,function(a,s,l,u){return l!==0&&s===u[l-1]+1?a[a.length-1][1]+=1:a.push([s,1]),a},[]);return o}function Ms(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof t=="number"&&t>=0&&t<e}function OPe(t,e){return MPe(t)||xPe(t,e)||IPe(t,e)||APe()}function APe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IPe(t,e){if(!!t){if(typeof t=="string")return dD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dD(t,e)}}function dD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function xPe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function MPe(t){if(Array.isArray(t))return t}var F1="remove_col";function NPe(){return{key:F1,name:function(){var e=this.getSelected(),r=0;if(e)if(e.length>1)r=1;else{var n=OPe(e[0],4),i=n[1],o=n[3];i-o!==0&&(r=1)}return this.getTranslatedPhrase(P3,r)},callback:function(){this.alter("remove_col",_Pe(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=Oc(this);if(!e)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function PPe(t,e){return DPe(t)||LPe(t,e)||$Pe(t,e)||kPe()}function kPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Pe(t,e){if(!!t){if(typeof t=="string")return pD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pD(t,e)}}function pD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function LPe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function DPe(t){if(Array.isArray(t))return t}var P6="remove_row";function FPe(){return{key:P6,name:function(){var e=this.getSelected(),r=0;if(e)if(e.length>1)r=1;else{var n=PPe(e[0],3),i=n[0],o=n[2];i-o!==0&&(r=1)}return this.getTranslatedPhrase(N3,r)},callback:function(){this.alter("remove_row",TPe(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var e=Oc(this);if(!e)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var k6="row_above";function HPe(){return{key:k6,name:function(){return this.getTranslatedPhrase(A3)},callback:function(){var e=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",e.row,1,"ContextMenu.rowAbove")},disabled:function(){var e=Oc(this);if(!e)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var $6="row_below";function BPe(){return{key:$6,name:function(){return this.getTranslatedPhrase(I3)},callback:function(){var e=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",e.row,1,"ContextMenu.rowBelow")},disabled:function(){var e=Oc(this);return e?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Ey="no_items";function UPe(){return{key:Ey,name:function(){return this.getTranslatedPhrase(O3)},disabled:!0,isCommand:!1}}var L6="undo";function VPe(){return{key:L6,name:function(){return this.getTranslatedPhrase(k3)},callback:function(){this.undo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function Cy(t){return Cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cy(t)}var Bn;function Si(t,e,r){return e=jPe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jPe(t){var e=WPe(t,"string");return Cy(e)==="symbol"?e:String(e)}function WPe(t,e){if(Cy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Cy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var zPe=[k6,$6,$1,L1,I6,P6,F1,L6,x6,D1,Vi,vt,Ey],GPe=(Bn={},Si(Bn,vt,NNe),Si(Bn,Ey,UPe),Si(Bn,k6,HPe),Si(Bn,$6,BPe),Si(Bn,$1,mPe),Si(Bn,L1,gPe),Si(Bn,I6,pPe),Si(Bn,P6,FPe),Si(Bn,F1,NPe),Si(Bn,L6,VPe),Si(Bn,x6,vPe),Si(Bn,D1,yPe),Si(Bn,Vi,dPe),Bn);function AX(){var t={};return Rt(GPe,function(e,r){t[r]=e()}),t}function _y(t){return _y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_y(t)}function YPe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qPe(n.key),n)}}function KPe(t,e,r){return e&&mD(t.prototype,e),r&&mD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function qPe(t){var e=XPe(t,"string");return _y(e)==="symbol"?e:String(e)}function XPe(t,e){if(_y(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(_y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var QPe=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;YPe(this,t),this.hot=e,this.predefinedItems=AX(),this.defaultOrderPattern=r}return KPe(t,[{key:"setPredefinedItems",value:function(r){var n=this,i={};this.defaultOrderPattern.length=0,Rt(r,function(o,a){var s="";o.name===vt?(i[vt]=o,s=vt):isNaN(parseInt(a,10))?(o.key=o.key===void 0?a:o.key,i[a]=o,s=o.key):(i[o.key]=o,s=o.key),n.defaultOrderPattern.push(s)}),this.predefinedItems=i}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return ZPe(r,this.defaultOrderPattern,this.predefinedItems)}}]),t}();function ZPe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),St(i)?Rt(i,function(o,a){var s=r[typeof o=="string"?o:a];s||(s=o),St(o)?Jr(s,o):typeof s=="string"&&(s={name:s}),s.key===void 0&&(s.key=a),n.push(s)}):ae(i,function(o,a){var s=r[o];!s&&zPe.indexOf(o)>=0||(s||(s={name:o,key:"".concat(a)}),St(o)&&Jr(s,o),s.key===void 0&&(s.key=a),n.push(s))}),n}const IX=QPe;function Ty(t){return Ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ty(t)}function JPe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tke(n.key),n)}}function eke(t,e,r){return e&&gD(t.prototype,e),r&&gD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function tke(t){var e=rke(t,"string");return Ty(e)==="symbol"?e:String(e)}function rke(t,e){if(Ty(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ty(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var nke=function(){function t(e,r){JPe(this,t);var n=Mg(r),i=dh(r),o,a,s,l,u,c;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),s=parseInt(e.left,10),u=e.height||0,c=e.width||0,a=o,l=s,o+=n,s+=i):this.type==="event"&&(o=parseInt(e.pageY,10),s=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,a=o-n,l=s-i),this.top=o,this.topRelative=a,this.left=s,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}return eke(t,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),t}();const ike=nke;var oke=yc,ake=/(?:ipad|iphone|ipod).*applewebkit/i.test(oke),ske=ga,xX=typeof process<"u"&&ske(process)=="process",Ii=nr,lke=Cc,uke=v1,yD=cr,cke=Rr,MX=dt,vD=eG,fke=E1,bD=QS,hke=TK,dke=ake,pke=xX,$O=Ii.setImmediate,LO=Ii.clearImmediate,mke=Ii.process,WE=Ii.Dispatch,gke=Ii.Function,wD=Ii.MessageChannel,yke=Ii.String,zE=0,ng={},SD="onreadystatechange",Oy,Hl,GE,YE;MX(function(){Oy=Ii.location});var YI=function(t){if(cke(ng,t)){var e=ng[t];delete ng[t],e()}},KE=function(t){return function(){YI(t)}},RD=function(t){YI(t.data)},ED=function(t){Ii.postMessage(yke(t),Oy.protocol+"//"+Oy.host)};(!$O||!LO)&&($O=function(e){hke(arguments.length,1);var r=yD(e)?e:gke(e),n=fke(arguments,1);return ng[++zE]=function(){lke(r,void 0,n)},Hl(zE),zE},LO=function(e){delete ng[e]},pke?Hl=function(t){mke.nextTick(KE(t))}:WE&&WE.now?Hl=function(t){WE.now(KE(t))}:wD&&!dke?(GE=new wD,YE=GE.port2,GE.port1.onmessage=RD,Hl=uke(YE.postMessage,YE)):Ii.addEventListener&&yD(Ii.postMessage)&&!Ii.importScripts&&Oy&&Oy.protocol!=="file:"&&!MX(ED)?(Hl=ED,Ii.addEventListener("message",RD,!1)):SD in bD("script")?Hl=function(t){vD.appendChild(bD("script"))[SD]=function(){vD.removeChild(this),YI(t)}}:Hl=function(t){setTimeout(KE(t),0)});var NX={set:$O,clear:LO},vke=tt,bke=nr,CD=NX.clear;vke({global:!0,bind:!0,enumerable:!0,forced:bke.clearImmediate!==CD},{clearImmediate:CD});var wke=tt,PX=nr,_D=NX.set,Ske=Y8,TD=PX.setImmediate?Ske(_D,!1):_D;wke({global:!0,bind:!0,enumerable:!0,forced:PX.setImmediate!==TD},{setImmediate:TD});var Rke=en,Eke=l6,Cke=$r,_ke=No,Tke=wc,qE=Gr,Oke=vi,Ake=bc,Ike=R8,OD=u6;Eke("match",function(t,e,r){return[function(i){var o=Oke(this),a=_ke(i)?void 0:Ake(i,t);return a?Rke(a,i,o):new RegExp(i)[t](qE(o))},function(n){var i=Cke(this),o=qE(n),a=r(e,i,o);if(a.done)return a.value;if(!i.global)return OD(i,o);var s=i.unicode;i.lastIndex=0;for(var l=[],u=0,c;(c=OD(i,o))!==null;){var f=qE(c[0]);l[u]=f,f===""&&(i.lastIndex=Ike(o,Tke(i.lastIndex),s)),u++}return u===0?null:l}]});var xke=Cc,Mke=$i,Nke=El,Pke=oo,kke=Dp,$ke=Math.min,DO=[].lastIndexOf,kX=!!DO&&1/[1].lastIndexOf(1,-0)<0,Lke=kke("lastIndexOf"),Dke=kX||!Lke,Fke=Dke?function(e){if(kX)return xke(DO,this,arguments)||0;var r=Mke(this),n=Pke(r),i=n-1;for(arguments.length>1&&(i=$ke(i,Nke(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in r&&r[i]===e)return i||0;return-1}:DO,Hke=tt,AD=Fke;Hke({target:"Array",proto:!0,forced:AD!==[].lastIndexOf},{lastIndexOf:AD});var Bke=vc,Uke=bi,Vke=i1,jke=oo,Wke=TypeError,ID=function(t){return function(e,r,n,i){Bke(r);var o=Uke(e),a=Vke(o),s=jke(o),l=t?s-1:0,u=t?-1:1;if(n<2)for(;;){if(l in a){i=a[l],l+=u;break}if(l+=u,t?l<0:s<=l)throw Wke("Reduce of empty array with no initial value")}for(;t?l>=0:s>l;l+=u)l in a&&(i=r(i,a[l],l,o));return i}},zke={left:ID(!1),right:ID(!0)},Gke=tt,Yke=zke.left,Kke=Dp,xD=o1,qke=xX,Xke=!qke&&xD>79&&xD<83,Qke=Xke||!Kke("reduce");Gke({target:"Array",proto:!0,forced:Qke},{reduce:function(e){var r=arguments.length;return Yke(this,e,r,r>1?arguments[1]:void 0)}});function XE(t){return t$e(t)||e$e(t)||Jke(t)||Zke()}function Zke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jke(t,e){if(!!t){if(typeof t=="string")return FO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FO(t,e)}}function e$e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function t$e(t){if(Array.isArray(t))return FO(t)}function FO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var $X={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},r$e=new RegExp(Object.keys($X).map(function(t){return"(".concat(t,")")}).join("|"),"gi");function n$e(t){return(t&&t.nodeName||"")==="TABLE"}function MD(t){for(var e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData.apply(t,n),o=i.length,a=o>0?i[0].length:0,s=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,f=e?1:0,h=0;h<o;h+=1){for(var d=e&&h===0,p=[],m=0;m<a;m+=1){var g=!d&&r&&m===0,v="";if(d)v="<th>".concat(t.getColHeader(m-c),"</th>");else if(g)v="<th>".concat(t.getRowHeader(h-f),"</th>");else{var w=i[h][m],b=t.getCellMeta(h-f,m-c),E=b.hidden,A=b.rowspan,M=b.colspan;if(!E){var k=[];if(A&&k.push('rowspan="'.concat(A,'"')),M&&k.push('colspan="'.concat(M,'"')),on(w))v="<td ".concat(k.join(" "),"></td>");else{var O=w.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");v="<td ".concat(k.join(" "),">").concat(O,"</td>")}}}p.push(v)}var x=["<tr>"].concat(p,["</tr>"]).join("");d?l.splice(1,0,x):u.splice(-1,0,x)}return s.splice(1,0,l.join(""),u.join("")),s.join("")}function ND(t){for(var e=t.length,r=["<table>"],n=0;n<e;n+=1){var i=t[n],o=i.length,a=[];n===0&&r.push("<tbody>");for(var s=0;s<o;s+=1){var l=i[s],u=on(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function i$e(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);var o=t;if(typeof o=="string"){var a=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function($){var B=$.match(/<td\b[^>]*?>/g)[0],W=$.substring(B.length,$.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),ee="</td>";return"".concat(B).concat(W).concat(ee)});i.insertAdjacentHTML("afterbegin","".concat(a)),o=i.querySelector("table")}if(!(!o||!n$e(o))){var s=i.querySelector('meta[name$="enerator"]'),l=o.querySelector("tbody th")!==null,u=o.querySelector("tr"),c=u?Array.from(u.cells).reduce(function($,B){return $+B.colSpan},0)-(l?1:0):0,f=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[],d=!1,p=0,m=0;if(o.tHead){var g=Array.from(o.tHead.rows).filter(function($){var B=$.querySelector("td")!==null;return B&&h.push($),!B});p=g.length,d=p>0,p>1?r.nestedHeaders=Array.from(g).reduce(function($,B){var W=Array.from(B.cells).reduce(function(ee,J,he){if(l&&he===0)return ee;var re=J.colSpan,T=J.innerHTML,D=re>1?{label:T,colspan:re}:T;return ee.push(D),ee},[]);return $.push(W),$},[]):d&&(r.colHeaders=Array.from(g[0].children).reduce(function($,B,W){return l&&W===0||$.push(B.innerHTML),$},[]))}h.length&&(r.fixedRowsTop=h.length),f.length&&(r.fixedRowsBottom=f.length);var v=[].concat(h,XE(Array.from(o.tBodies).reduce(function($,B){return $.push.apply($,XE(Array.from(B.rows))),$},[])),XE(f));m=v.length;for(var w=new Array(m),b=0;b<m;b++)w[b]=new Array(c);for(var E=[],A=[],M=0;M<m;M++)for(var k=v[M],O=Array.from(k.cells),x=O.length,C=0;C<x;C++){var I=O[C],H=I.nodeName,j=I.innerHTML,q=I.rowSpan,Z=I.colSpan,ne=w[M].findIndex(function($){return $===void 0});if(H==="TD"){if(q>1||Z>1){for(var ie=M;ie<M+q;ie++)if(ie<m)for(var P=ne;P<ne+Z;P++)w[ie][P]=null;var y=I.getAttribute("style"),R=y&&y.includes("mso-ignore:colspan");R||E.push({col:ne,row:M,rowspan:q,colspan:Z})}var _="";s&&/excel/gi.test(s.content)?_=j.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):_=j.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),w[M][ne]=_.replace(r$e,function($){return $X[$]})}else A.push(j)}return E.length&&(r.mergeCells=E),A.length&&(r.rowHeaders=A),w.length&&(r.data=w),r}}function PD(t){var e=t.isShiftKey,r=t.isLeftClick,n=t.isRightClick,i=t.coords,o=t.selection,a=t.controller,s=t.cellCoordsFactory,l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!a.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!a.cell?o.setRangeEnd(s(i.row,i.col)):u&&i.row<0&&!a.column?o.setRangeEnd(s(l.to.row,i.col)):c&&i.col<0&&!a.row?o.setRangeEnd(s(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!a.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!a.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{var f=!o.inInSelection(i),h=r||n&&f;i.row<0&&i.col>=0&&!a.column?h&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!a.row?h&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!a.cell?h&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0)}}function o$e(t){var e=t.isLeftClick,r=t.coords,n=t.selection,i=t.controller,o=t.cellCoordsFactory;if(!!e){var a=n.isSelectedByRowHeader(),s=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();s&&!i.column?n.setRangeEnd(o(u-1,r.col)):a&&!i.row?n.setRangeEnd(o(r.row,l-1)):i.cell||n.setRangeEnd(r)}}var a$e=new Map([["mousedown",PD],["mouseover",o$e],["touchstart",PD]]);function kD(t,e){var r=e.coords,n=e.selection,i=e.controller,o=e.cellCoordsFactory;a$e.get(t.type)({coords:r,selection:n,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:B8(t)||t.type==="touchstart",isRightClick:Gu(t)})}var LX=new WeakMap,KI=Symbol("rootInstance");function s$e(t){LX.set(t,!0)}function l$e(t){return t===KI}function HO(t){return LX.has(t)}function Ay(t){return Ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ay(t)}function dm(t,e){return f$e(t)||c$e(t,e)||DX(t,e)||u$e()}function u$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c$e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function f$e(t){if(Array.isArray(t))return t}function $D(t){return p$e(t)||d$e(t)||DX(t)||h$e()}function h$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DX(t,e){if(!!t){if(typeof t=="string")return BO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BO(t,e)}}function d$e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function p$e(t){if(Array.isArray(t))return BO(t)}function BO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function m$e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,FX(n.key),n)}}function g$e(t,e,r){return e&&LD(t.prototype,e),r&&LD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function DD(t,e,r){y$e(t,e),e.set(t,r)}function y$e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ns(t,e,r){return e=FX(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FX(t){var e=v$e(t,"string");return Ay(e)==="symbol"?e:String(e)}function v$e(t,e){if(Ay(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ay(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FD(t,e){var r=HX(t,e,"get");return b$e(t,r)}function b$e(t,e){return e.get?e.get.call(t):e.value}function HD(t,e,r){var n=HX(t,e,"set");return w$e(t,n,r),r}function HX(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function w$e(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Bl=new WeakMap,QE=new WeakMap,ZE=new WeakMap,S$e=function(){function t(e){m$e(this,t),Ns(this,"instance",void 0),Ns(this,"eventManager",void 0),Ns(this,"settings",void 0),Ns(this,"THEAD",void 0),Ns(this,"TBODY",void 0),Ns(this,"_wt",void 0),Ns(this,"activeWt",void 0),DD(this,QE,{writable:!0,value:0}),DD(this,ZE,{writable:!0,value:0}),Ns(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new Er(this.instance),this.settings=this.instance.getSettings(),Bl.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return g$e(t,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var i=this._wt.getCell(r,n);return i<0?null:i}},{key:"scrollViewport",value:function(r,n,i,o,a){return this._wt.scrollViewport(r,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wt.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wt.scrollViewportVertically(r,n,i)}},{key:"createElements",value:function(){var r=Bl.get(this),n=this.instance,i=n.rootElement,o=n.rootDocument,a=i.getAttribute("style");a&&i.setAttribute("data-originalstyle",a),_e(i,"handsontable"),r.table=o.createElement("TABLE"),_e(r.table,"htCore"),this.instance.getSettings().tableClassName&&_e(r.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=Bl.get(this),i=this.instance,o=i.rootElement,a=i.rootDocument,s=i.selection,l=a.documentElement;this.eventManager.addEventListener(o,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var c=r.instance.rootWindow;sk(c),u.preventDefault(),c.focus()}}),this.eventManager.addEventListener(o,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(o,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&sk(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(l,"keyup",function(u){s.isInProgress()&&!u.shiftKey&&s.finish()}),this.eventManager.addEventListener(l,"mouseup",function(u){s.isInProgress()&&B8(u)&&s.finish(),n.mouseDown=!1,(z8(a.activeElement)||!s.isSelected()&&!s.isSelectedByAnyHeader()&&!o.contains(u.target)&&!Gu(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(l,"contextmenu",function(u){s.isInProgress()&&Gu(u)&&(s.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(l,"touchend",function(){s.isInProgress()&&s.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(l,"mousedown",function(u){var c=u.target,f=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!o||!r.instance.view)){var p=r.instance.view._wt.wtTable.holder;if(d===p){var m=gn(a);if(a.elementFromPoint(f+m,h)!==p||a.elementFromPoint(f,h+m)!==p)return}else for(;d!==l;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===o)return;d=d.parentNode}var g=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(c):r.settings.outsideClickDeselects;g?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||Z2(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,i=r.row,o=r.col;return(n=this.instance)._createCellCoords.apply(n,$D(this.translateFromRenderableToVisualIndex(i,o)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var i=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,o=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=r),o===null&&(o=n),[i,o]}},{key:"countRenderableIndexes",value:function(r,n){var i=Math.min(r.getNotTrimmedIndexesLength(),n),o=r.getNearestNotHiddenIndex(i-1,-1);return o===null?0:r.getRenderableFromVisualIndex(o)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,i,o){if(isNaN(r)||r<0)return 0;var a=i.getNearestNotHiddenIndex(r,n),s=i.getRenderableFromVisualIndex(a);if(!Number.isInteger(s))return 0;var l=0;return n<0?l=s+1:n>0&&(l=o-s),l}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=Bl.get(this),i={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return HO(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(c,f){var h;return(h=r.instance).getDataAtCell.apply(h,$D(r.translateFromRenderableToVisualIndex(c,f)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||i.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||i.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var c=[];return r.instance.hasRowHeaders()&&c.push(function(f,h){var d=f>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(f):f;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",c),HD(r,ZE,c.length),c},columnHeaders:function(){var c=[];return r.instance.hasColHeaders()&&c.push(function(f,h){var d=f>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(f):f;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",c),HD(r,QE,c.length),c},columnWidth:function(c){var f=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.getColWidth(f===null?c:f)},rowHeight:function(c){var f=r.instance.rowIndexMapper.getVisualFromRenderableIndex(c);return r.instance.getRowHeight(f===null?c:f)},cellRenderer:function(c,f,h){var d=r.translateFromRenderableToVisualIndex(c,f),p=dm(d,2),m=p[0],g=p[1],v=r.instance.runHooks("modifyGetCellCoords",m,g),w=m,b=g;if(Array.isArray(v)){var E=dm(v,2);w=E[0],b=E[1]}var A=r.instance.getCellMeta(w,b),M=r.instance.colToProp(b),k=r.instance.getDataAtRowProp(w,M);r.instance.hasHook("beforeValueRender")&&(k=r.instance.runHooks("beforeValueRender",k,A)),r.instance.runHooks("beforeRenderer",h,m,g,M,k,A),r.instance.getCellRenderer(A)(r.instance,h,m,g,M,k,A),r.instance.runHooks("afterRenderer",h,m,g,M,k,A)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(c,f,h,d){var p=r.translateFromRenderableToVisualCoords(f),m={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",c,p,h,m),!Ef(c)&&(kD(c,{coords:p,selection:r.instance.selection,controller:m,cellCoordsFactory:function(v,w){return r.instance._createCellCoords(v,w)}}),r.instance.runHooks("afterOnCellMouseDown",c,p,h),r.activeWt=r._wt)},onCellContextMenu:function(c,f,h,d){var p=r.translateFromRenderableToVisualCoords(f);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",c,p,h),!Ef(c)&&(r.instance.runHooks("afterOnCellContextMenu",c,p,h),r.activeWt=r._wt)},onCellMouseOut:function(c,f,h,d){var p=r.translateFromRenderableToVisualCoords(f);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",c,p,h),!Ef(c)&&(r.instance.runHooks("afterOnCellMouseOut",c,p,h),r.activeWt=r._wt)},onCellMouseOver:function(c,f,h,d){var p=r.translateFromRenderableToVisualCoords(f),m={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",c,p,h,m),!Ef(c)&&(n.mouseDown&&kD(c,{coords:p,selection:r.instance.selection,controller:m,cellCoordsFactory:function(v,w){return r.instance._createCellCoords(v,w)}}),r.instance.runHooks("afterOnCellMouseOver",c,p,h),r.activeWt=r._wt)},onCellMouseUp:function(c,f,h,d){var p=r.translateFromRenderableToVisualCoords(f);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",c,p,h),!(Ef(c)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",c,p,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(c){c.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",c)},onCellCornerDblClick:function(c){c.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",c)},beforeDraw:function(c,f){return r.beforeRender(c,f)},onDraw:function(c){return r.afterRender(c)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(c,f,h){var d=r.instance.rowIndexMapper,p=d.getVisualFromRenderableIndex(c),m=r.instance.runHooks("beforeHighlightingRowHeader",p,f,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(m,1))},onBeforeHighlightingColumnHeader:function(c,f,h){var d=r.instance.columnIndexMapper,p=d.getVisualFromRenderableIndex(c),m=r.instance.runHooks("beforeHighlightingColumnHeader",p,f,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(m,1))},onAfterDrawSelection:function(c,f,h){var d,p=r.translateFromRenderableToVisualIndex(c,f),m=dm(p,2),g=m[0],v=m[1],w=r.instance.selection.getSelectedRange(),b=w.size();if(b>0){var E=(h!=null?h:0)+1-b,A=w.peekByIndex(E);d=[A.from.row,A.from.col,A.to.row,A.to.col]}return r.instance.runHooks("afterDrawSelection",g,v,d,h)},onBeforeDrawBorders:function(c,f){var h=dm(c,4),d=h[0],p=h[1],m=h[2],g=h[3],v=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(p),r.instance.rowIndexMapper.getVisualFromRenderableIndex(m),r.instance.columnIndexMapper.getVisualFromRenderableIndex(g)];return r.instance.runHooks("beforeDrawBorders",v,f)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(c,f){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.runHooks("beforeStretchingColumnWidth",c,h)},onModifyRowHeaderWidth:function(c){return r.instance.runHooks("modifyRowHeaderWidth",c)},onModifyGetCellCoords:function(c,f,h){var d=r.instance.rowIndexMapper,p=r.instance.columnIndexMapper,m=f>=0?p.getVisualFromRenderableIndex(f):f,g=c>=0?d.getVisualFromRenderableIndex(c):c,v=r.instance.runHooks("modifyGetCellCoords",g,m,h);if(Array.isArray(v)){var w=dm(v,4),b=w[0],E=w[1],A=w[2],M=w[3];return[b>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(b,1)):b,E>=0?p.getRenderableFromVisualIndex(p.getNearestNotHiddenIndex(E,1)):E,A>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(A,-1)):A,M>=0?p.getRenderableFromVisualIndex(p.getNearestNotHiddenIndex(M,-1)):M]}},viewportRowCalculatorOverride:function(c){var f=r.settings.viewportRowRenderingOffset;if(f==="auto"&&r.settings.fixedRowsTop&&(f=10),f>0||f==="auto"){var h=r.countRenderableRows(),d=c.startRow,p=c.endRow;if(typeof f=="number")c.startRow=Math.max(d-f,0),c.endRow=Math.min(p+f,h-1);else if(f==="auto"){var m=Math.ceil(p/h*12);c.startRow=Math.max(d-m,0),c.endRow=Math.min(p+m,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",c)},viewportColumnCalculatorOverride:function(c){var f=r.settings.viewportColumnRenderingOffset;if(f==="auto"&&r.settings.fixedColumnsStart&&(f=10),f>0||f==="auto"){var h=r.countRenderableColumns(),d=c.startColumn,p=c.endColumn;if(typeof f=="number"&&(c.startColumn=Math.max(d-f,0),c.endColumn=Math.min(p+f,h-1)),f==="auto"){var m=Math.ceil(p/h*6);c.startColumn=Math.max(d-m,0),c.endColumn=Math.min(p+m,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",c)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var c=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||c}};this.instance.runHooks("beforeInitWalkontable",i),this._wt=new j4e(i),this.activeWt=this._wt;var o=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),s=a.width,l=a.height;this.setLastSize(s,l),this.eventManager.addEventListener(o,"mousedown",function(u){u.target===o&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(o,"contextmenu",function(u){u.target===o&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(Z2(r))return!0;var n=Uu(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Bl.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var i=n.firstChild;if(!at(i,"relative")){ua(n),this.appendRowHeader(r,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var o=this.instance,a=o.rootDocument,s=o.getRowHeader,l=a.createElement("div"),u=a.createElement("span");l.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,s),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var a=n.firstChild;at(a,"relative")?this.updateCellHeader(a.querySelector(".colHeader"),r,i,o):(ua(n),this.appendColHeader(r,n,i,o))}else{var s=this.instance.rootDocument,l=s.createElement("div"),u=s.createElement("span");l.className="relative",u.className="colHeader",this.updateCellHeader(u,r,i,o),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetColHeader",r,n,o)}},{key:"updateCellHeader",value:function(r,n,i){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=n,s=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(at(r,"colHeader")?a=s.wtTable.columnFilter.sourceToRendered(n):at(r,"rowHeader")&&(a=s.wtTable.rowFilter.sourceToRendered(n))),a>-1?Fp(r,i(n,o)):(Yu(r,String.fromCharCode(160)),_e(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),i=n-r;return i>0?i:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),i=n-r;return i>0?i:0}},{key:"setLastSize",value:function(r,n){var i=Bl.get(this),o=[r,n];i.lastWidth=o[0],i.lastHeight=o[1]}},{key:"getLastSize",value:function(){var r=Bl.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return FD(this,QE)}},{key:"getRowHeadersCount",value:function(){return FD(this,ZE)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),t}();const R$e=S$e;function UO(t){return UO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},UO(t)}var E$e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",BD=E$e.length;function C$e(t){for(var e=t+1,r="",n;e>0;)n=(e-1)%BD,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/BD,10);return r}function UD(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t,n=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(r=[t]),r.forEach(function(i,o){Array.isArray(i)?i.forEach(function(a,s){n.push([o+e,s,a])}):Object.keys(i).forEach(function(a){n.push([o+e,a,i[a]])})}),n}function BX(t){var e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&St(t[0])&&(e=H8(t[0]))),e}function _$e(t){return!!(Array.isArray(t)&&t.length&&t.every(function(e){return Array.isArray(e)}))}function T$e(t){return!!(Array.isArray(t)&&t.length&&t.every(function(e){return UO(e)==="object"&&!Array.isArray(e)&&e!==null}))}function Iy(t){return Iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Iy(t)}function O$e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,I$e(n.key),n)}}function A$e(t,e,r){return e&&VD(t.prototype,e),r&&VD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function I$e(t){var e=x$e(t,"string");return Iy(e)==="symbol"?e:String(e)}function x$e(t,e){if(Iy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Iy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var M$e=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];O$e(this,t),this.hot=e,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return A$e(t,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,i=[];return ae(this.data,function(o,a){var s=n.getAtCell(a,r);i.push(s)}),i}},{key:"getAtRow",value:function(r,n,i){var o=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=n===void 0&&i===void 0,l=null,u=null;if(l=this.modifyRowData(r),Array.isArray(l))u=[],s?l.forEach(function(h,d){u[d]=o.getAtPhysicalCell(r,d,l)}):Ye(n,i,function(h){u[h-n]=o.getAtPhysicalCell(r,h,l)});else if(St(l)||sr(l))if(a?u=[]:u={},!s||a){var c=0,f=this.countFirstRowKeys()-1;Ye(c,f,function(h){var d=o.colToProp(h);if(h>=(n||c)&&h<=(i||f)&&!Number.isInteger(d)){var p=o.getAtPhysicalCell(r,d,l);a?u.push(p):sE(u,d,p)}})}else Rt(l,function(h,d){sE(u,d,o.getAtPhysicalCell(r,d,l))});return u}},{key:"setAtCell",value:function(r,n,i){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var o=hh(i);this.hot.runHooks("modifySourceData",r,this.propToCol(n),o,"set"),o.isTouched()&&(i=o.value)}Number.isInteger(n)?this.data[r][n]=i:sE(this.data[r],n,i)}}},{key:"getAtPhysicalCell",value:function(r,n,i){var o=null;if(i&&(typeof n=="string"?o=Bbe(i,n):typeof n=="function"?o=n(i):o=i[n]),this.hot.hasHook("modifySourceData")){var a=hh(o);this.hot.runHooks("modifySourceData",r,this.colToProp(n),a,"get"),a.isTouched()&&(o=a.value)}return o}},{key:"getAtCell",value:function(r,n){var i=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),i)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,s=null,l=null,u=null,c=null;n===null||i===null?(a=!0,s=0,u=this.countRows()-1):(s=Math.min(n.row,i.row),l=Math.min(n.col,i.col),u=Math.max(n.row,i.row),c=Math.max(n.col,i.col));var f=[];return Ye(s,u,function(h){f.push(a?r.getAtRow(h,void 0,void 0,o):r.getAtRow(h,l,c,o))}),f}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return BX(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),t}();const N$e=M$e;var jD;function P$e(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function k$e(t,e){return Rt(e,function(r,n){tr(t[n])&&(t[n]=r)}),t}function UX(t){var e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=e.exec(t);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):t}function VX(t){He(t)&&G8(Gt(jD||(jD=P$e(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),t))}function $$e(t,e){var r=Array.isArray(t)&&Number.isInteger(e);return r?t[e]:t}var jX=so("phraseFormatters"),L$e=jX.register,D$e=jX.getValues;function F$e(t,e){L$e(t,e)}function H$e(){return D$e()}F$e("pluralize",$$e);function xy(t){return xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xy(t)}var Pe;function $e(t,e,r){return e=B$e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function B$e(t){var e=U$e(t,"string");return xy(e)==="symbol"?e:String(e)}function U$e(t,e){if(xy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(xy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var V$e=(Pe={languageCode:"en-US"},$e(Pe,O3,"No available options"),$e(Pe,A3,"Insert row above"),$e(Pe,I3,"Insert row below"),$e(Pe,x3,"Insert column left"),$e(Pe,M3,"Insert column right"),$e(Pe,N3,["Remove row","Remove rows"]),$e(Pe,P3,["Remove column","Remove columns"]),$e(Pe,k3,"Undo"),$e(Pe,$3,"Redo"),$e(Pe,L3,"Read only"),$e(Pe,D3,"Clear column"),$e(Pe,Q3,"Alignment"),$e(Pe,Z3,"Left"),$e(Pe,J3,"Center"),$e(Pe,eI,"Right"),$e(Pe,tI,"Justify"),$e(Pe,rI,"Top"),$e(Pe,nI,"Middle"),$e(Pe,iI,"Bottom"),$e(Pe,j3,"Freeze column"),$e(Pe,W3,"Unfreeze column"),$e(Pe,oI,"Borders"),$e(Pe,aI,"Top"),$e(Pe,sI,"Right"),$e(Pe,lI,"Bottom"),$e(Pe,uI,"Left"),$e(Pe,cI,"Remove border(s)"),$e(Pe,Y3,"Add comment"),$e(Pe,K3,"Edit comment"),$e(Pe,q3,"Delete comment"),$e(Pe,X3,"Read-only comment"),$e(Pe,z3,"Merge cells"),$e(Pe,G3,"Unmerge cells"),$e(Pe,F3,"Copy"),$e(Pe,H3,["Copy with header","Copy with headers"]),$e(Pe,B3,["Copy with group header","Copy with group headers"]),$e(Pe,U3,["Copy header only","Copy headers only"]),$e(Pe,V3,"Cut"),$e(Pe,fI,"Insert child row"),$e(Pe,hI,"Detach from parent"),$e(Pe,dI,["Hide column","Hide columns"]),$e(Pe,pI,["Show column","Show columns"]),$e(Pe,mI,["Hide row","Hide rows"]),$e(Pe,gI,["Show row","Show rows"]),$e(Pe,O6,"None"),$e(Pe,yI,"Is empty"),$e(Pe,vI,"Is not empty"),$e(Pe,bI,"Is equal to"),$e(Pe,wI,"Is not equal to"),$e(Pe,SI,"Begins with"),$e(Pe,RI,"Ends with"),$e(Pe,EI,"Contains"),$e(Pe,CI,"Does not contain"),$e(Pe,_I,"Greater than"),$e(Pe,TI,"Greater than or equal to"),$e(Pe,OI,"Less than"),$e(Pe,AI,"Less than or equal to"),$e(Pe,II,"Is between"),$e(Pe,xI,"Is not between"),$e(Pe,MI,"After"),$e(Pe,NI,"Before"),$e(Pe,PI,"Today"),$e(Pe,kI,"Tomorrow"),$e(Pe,$I,"Yesterday"),$e(Pe,kw,"Blank cells"),$e(Pe,LI,"Filter by condition"),$e(Pe,DI,"Filter by value"),$e(Pe,FI,"And"),$e(Pe,A6,"Or"),$e(Pe,HI,"Select all"),$e(Pe,BI,"Clear"),$e(Pe,UI,"OK"),$e(Pe,VI,"Cancel"),$e(Pe,jI,"Search"),$e(Pe,WI,"Value"),$e(Pe,zI,"Second value"),Pe);const WX=V$e;var VO=WX.languageCode,D6=so("languagesDictionaries"),j$e=D6.register,zX=D6.getItem,W$e=D6.hasItem,z$e=D6.getValues;GX(WX);function GX(t,e){var r=t,n=e;return St(t)&&(n=t,r=n.languageCode),G$e(r,n),j$e(r,Qn(n)),Qn(n)}function G$e(t,e){t!==VO&&k$e(e,zX(VO))}function YX(t){return qI(t)?Qn(zX(t)):null}function qI(t){return W$e(t)}function Y$e(){return z$e()}function KX(t,e,r){var n=YX(t);if(n===null)return null;var i=n[e];if(tr(i))return null;var o=K$e(i,r);return Array.isArray(o)?o[0]:o}function K$e(t,e){var r=t;return ae(H$e(),function(n){r=n(t,e)}),r}function q$e(t){var e=UX(t);return qI(e)||(e=VO,VX(t)),e}var F6="active-header",H6="area",My="cell",XI="fill",H1="header",QI="custom-selection";function pd(t){return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pd(t)}function X$e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,XX(n.key),n)}}function Q$e(t,e,r){return e&&WD(t.prototype,e),r&&WD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function n2(){return typeof Reflect<"u"&&Reflect.get?n2=Reflect.get.bind():n2=function(e,r,n){var i=Z$e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},n2.apply(this,arguments)}function Z$e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=md(t),t!==null););return t}function J$e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jO(t,e)}function jO(t,e){return jO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},jO(t,e)}function eLe(t){var e=rLe();return function(){var n=md(t),i;if(e){var o=md(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return tLe(this,i)}}function tLe(t,e){if(e&&(pd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qX(t)}function qX(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function md(t){return md=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},md(t)}function nLe(t,e,r){return e=XX(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XX(t){var e=iLe(t,"string");return pd(e)==="symbol"?e:String(e)}function iLe(t,e){if(pd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oLe=function(t){J$e(r,t);var e=eLe(r);function r(n,i){var o;return X$e(this,r),o=e.call(this,n,null),nLe(qX(o),"visualCellRange",null),o.visualCellRange=i||null,o.commit(),o}return Q$e(r,[{key:"add",value:function(i){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(i):this.visualCellRange.expand(i),this}},{key:"clear",value:function(){return this.visualCellRange=null,n2(md(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(i){var o=i.from,a=i.to,s=this.getNearestNotHiddenCoords(o,1),l=this.getNearestNotHiddenCoords(a,-1);if(s===null||l===null)return null;if(s.row>l.row||s.col>l.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;s=o,l=a}return this.settings.createCellRange(s,s,l)}},{key:"getNearestNotHiddenCoords",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o,s=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),i.row,o);if(s===null)return null;var l=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),i.col,a);return l===null?null:this.settings.createCellCoords(s,l)}},{key:"getNearestNotHiddenIndex",value:function(i,o,a){if(o<0)return o;var s=i.getNearestNotHiddenIndex(o,a),l=this.settings.type==="header"||this.settings.type==="active-header";return l&&s===null?-1:s}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var i=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return i===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(i.from,i.to),this}},{key:"syncWith",value:function(i){var o=i.getVerticalDirection()==="N-S"?1:-1,a=i.getHorizontalDirection()==="W-E"?1:-1,s=this.getNearestNotHiddenCoords(i.from.clone().normalize(),o,a);if(s!==null&&i.overlaps(s)){if(this.cellRange===null){var l=this.settings.visualToRenderableCoords(s);this.cellRange=this.settings.createCellRange(l)}return i.setHighlight(s),this}return i.setHighlight(i.from),this}},{key:"getCorners",value:function(){var i=this.cellRange,o=i.from,a=i.to,s=o.row===null||a.row===null,l=o.col===null||a.col===null,u=this.settings.createCellCoords(s?null:Math.min(o.row,a.row),l?null:Math.min(o.col,a.col)),c=this.settings.createCellCoords(s?null:Math.max(o.row,a.row),l?null:Math.max(o.col,a.col));return[u.row,u.col,c.row,c.col]}},{key:"getVisualCorners",value:function(){var i=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),o=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[i.row,i.col,o.row,o.col]}},{key:"createRenderableCellRange",value:function(i,o){var a=this.settings.visualToRenderableCoords(i),s=this.settings.visualToRenderableCoords(o);return this.settings.createCellRange(a,a,s)}}]),r}(b8e);const Vp=oLe;function Ny(t){return Ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ny(t)}var aLe=["activeHeaderClassName"];function zD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function GD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zD(Object(r),!0).forEach(function(n){sLe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function sLe(t,e,r){return e=lLe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lLe(t){var e=uLe(t,"string");return Ny(e)==="symbol"?e:String(e)}function uLe(t,e){if(Ny(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ny(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cLe(t,e){if(t==null)return{};var r=fLe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function fLe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function hLe(t){var e=t.activeHeaderClassName,r=cLe(t,aLe),n=new Vp(GD(GD({highlightHeaderClassName:e},r),{},{selectionType:F6}));return n}function Py(t){return Py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Py(t)}var dLe=["layerLevel","areaCornerVisible"];function YD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function KD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?YD(Object(r),!0).forEach(function(n){pLe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):YD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function pLe(t,e,r){return e=mLe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mLe(t){var e=gLe(t,"string");return Py(e)==="symbol"?e:String(e)}function gLe(t,e){if(Py(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Py(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yLe(t,e){if(t==null)return{};var r=vLe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function vLe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function bLe(t){var e=t.layerLevel,r=t.areaCornerVisible,n=yLe(t,dLe),i=new Vp(KD(KD({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:H6}));return i}function ky(t){return ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ky(t)}var wLe=["cellCornerVisible"];function qD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function XD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qD(Object(r),!0).forEach(function(n){SLe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function SLe(t,e,r){return e=RLe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RLe(t){var e=ELe(t,"string");return ky(e)==="symbol"?e:String(e)}function ELe(t,e){if(ky(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ky(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CLe(t,e){if(t==null)return{};var r=_Le(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function _Le(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function TLe(t){var e=t.cellCornerVisible,r=CLe(t,wLe),n=new Vp(XD(XD({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e}},r),{},{selectionType:My}));return n}function $y(t){return $y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$y(t)}var OLe=["border","visualCellRange"];function QD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function JE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?QD(Object(r),!0).forEach(function(n){ALe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):QD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ALe(t,e,r){return e=ILe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ILe(t){var e=xLe(t,"string");return $y(e)==="symbol"?e:String(e)}function xLe(t,e){if($y(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if($y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MLe(t,e){if(t==null)return{};var r=NLe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function NLe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function PLe(t){var e=t.border,r=t.visualCellRange,n=MLe(t,OLe),i=new Vp(JE(JE(JE({},e),n),{},{selectionType:QI}),r);return i}function Ly(t){return Ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ly(t)}function ZD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function JD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ZD(Object(r),!0).forEach(function(n){kLe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ZD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function kLe(t,e,r){return e=$Le(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Le(t){var e=LLe(t,"string");return Ly(e)==="symbol"?e:String(e)}function LLe(t,e){if(Ly(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ly(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DLe(t){if(t==null)throw new TypeError("Cannot destructure "+t)}function FLe(t){var e=Object.assign({},(DLe(t),t)),r=new Vp(JD(JD({className:"fill",border:{width:1,color:"#ff0000"}},e),{},{selectionType:XI}));return r}function Dy(t){return Dy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dy(t)}var HLe=["headerClassName","rowClassName","columnClassName"];function eF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function tF(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?eF(Object(r),!0).forEach(function(n){BLe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):eF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function BLe(t,e,r){return e=ULe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ULe(t){var e=VLe(t,"string");return Dy(e)==="symbol"?e:String(e)}function VLe(t,e){if(Dy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Dy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jLe(t,e){if(t==null)return{};var r=WLe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function WLe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function zLe(t){var e=t.headerClassName,r=t.rowClassName,n=t.columnClassName,i=jLe(t,HLe),o=new Vp(tF(tF({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:r,highlightColumnClassName:n},i),{},{highlightOnlyClosestHeader:!0,selectionType:H1}));return o}function Fy(t){return Fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fy(t)}function rF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function GLe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rF(Object(r),!0).forEach(function(n){YLe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function YLe(t,e,r){return e=KLe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KLe(t){var e=qLe(t,"string");return Fy(e)==="symbol"?e:String(e)}function qLe(t,e){if(Fy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Fy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var QX=so("highlight/types"),jp=QX.register,XLe=QX.getItem;jp(F6,hLe);jp(H6,bLe);jp(My,TLe);jp(QI,PLe);jp(XI,FLe);jp(H1,zLe);function Xc(t,e){return XLe(t)(GLe({type:t},e))}function Hy(t){return Hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hy(t)}function Ps(t){return eDe(t)||JLe(t)||ZLe(t)||QLe()}function QLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZLe(t,e){if(!!t){if(typeof t=="string")return WO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WO(t,e)}}function JLe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function eDe(t){if(Array.isArray(t))return WO(t)}function WO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function nF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function pm(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nF(Object(r),!0).forEach(function(n){tDe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tDe(t,e,r){return e=ZX(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ZX(n.key),n)}}function nDe(t,e,r){return e&&iF(t.prototype,e),r&&iF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZX(t){var e=iDe(t,"string");return Hy(e)==="symbol"?e:String(e)}function iDe(t,e){if(Hy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Hy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oDe=function(t){function e(r){rDe(this,e),this.options=r,this.layerLevel=0,this.cell=Xc(My,r),this.fill=Xc(XI,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return nDe(e,[{key:"isEnabledFor",value:function(n,i){var o=n;n===My&&(o="current");var a=this.options.disabledCellSelection(i.row,i.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(o)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,i;return this.areas.has(n)?i=this.areas.get(n):(i=Xc(H6,pm({layerLevel:n},this.options)),this.areas.set(n,i)),i}},{key:"getAreas",value:function(){return Ps(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,i;return this.headers.has(n)?i=this.headers.get(n):(i=Xc(H1,pm({},this.options)),this.headers.set(n,i)),i}},{key:"getHeaders",value:function(){return Ps(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,i;return this.activeHeaders.has(n)?i=this.activeHeaders.get(n):(i=Xc(F6,pm({},this.options)),this.activeHeaders.set(n,i)),i}},{key:"getActiveHeaders",value:function(){return Ps(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Ps(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(Xc(QI,pm(pm({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),ae(this.areas.values(),function(n){return void n.clear()}),ae(this.headers.values(),function(n){return void n.clear()}),ae(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:t,value:function(){return[this.cell,this.fill].concat(Ps(this.areas.values()),Ps(this.headers.values()),Ps(this.activeHeaders.values()),Ps(this.customSelections))[Symbol.iterator]()}}]),e}(Symbol.iterator);const aDe=oDe;function By(t){return By=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},By(t)}function sDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,uDe(n.key),n)}}function lDe(t,e,r){return e&&oF(t.prototype,e),r&&oF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function uDe(t){var e=cDe(t,"string");return By(e)==="symbol"?e:String(e)}function cDe(t,e){if(By(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(By(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fDe=function(t){function e(r){sDe(this,e),this.ranges=[],this.createCellRange=r}return lDe(e,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(i){return i.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=this.size()+n-1,o;return i>=0&&(o=this.ranges[i]),o}},{key:t,value:function(){return this.ranges[Symbol.iterator]()}}]),e}(Symbol.iterator);const hDe=fDe;function Uy(t){return Uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uy(t)}function dDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mDe(n.key),n)}}function pDe(t,e,r){return e&&aF(t.prototype,e),r&&aF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mDe(t){var e=gDe(t,"string");return Uy(e)==="symbol"?e:String(e)}function gDe(t,e){if(Uy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Uy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var JX=function(){function t(e,r){dDe(this,t),this.range=e,this.options=r}return pDe(t,[{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.options.createCellCoords(r,n),a=this.range.current().highlight,s=this.options.visualToRenderableCoords(a),l=s.row,u=s.col,c=a,f=0,h=0;if(this.runLocalHooks("beforeTransformStart",o),l!==null&&u!==null){var d=this.options.countRows(),p=this.options.countCols(),m=this.options.fixedRowsBottom(),g=this.options.minSpareRows(),v=this.options.minSpareCols(),w=this.options.autoWrapRow(),b=this.options.autoWrapCol();l+r>d-1?i&&g>0&&!(m&&l>=d-m-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):b&&(o.row=1-d,o.col=u+o.col===p-1?1-p:1):b&&l+o.row<0&&u+o.col>=0&&(o.row=d-1,o.col=u+o.col===0?p-1:-1),u+o.col>p-1?i&&v>0?(this.runLocalHooks("insertColRequire",p),p=this.options.countCols()):w&&(o.row=l+o.row===d-1?1-d:1,o.col=1-p):w&&u+o.col<0&&l+o.row>=0&&(o.row=l+o.row===0?d-1:-1,o.col=p-1);var E=this.options.createCellCoords(l+o.row,u+o.col);f=0,h=0,E.row<0?(f=-1,E.row=0):E.row>0&&E.row>=d&&(f=1,E.row=d-1),E.col<0?(h=-1,E.col=0):E.col>0&&E.col>=p&&(h=1,E.col=p-1),c=this.options.renderableToVisualCoords(E)}return this.runLocalHooks("afterTransformStart",c,f,h),c}},{key:"transformEnd",value:function(r,n){var i=this.options.createCellCoords(r,n),o=this.range.current(),a=o.to,s=0,l=0;this.runLocalHooks("beforeTransformEnd",i);var u=this.options.visualToRenderableCoords(o.highlight),c=u.row,f=u.col;if(c!==null&&f!==null){var h=this.options.countRows(),d=this.options.countCols(),p=this.options.visualToRenderableCoords(o.to),m=p.row,g=p.col,v=this.options.createCellCoords(m+i.row,g+i.col);s=0,l=0,v.row<0?(s=-1,v.row=0):v.row>0&&v.row>=h&&(s=1,v.row=h-1),v.col<0?(l=-1,v.col=0):v.col>0&&v.col>=d&&(l=1,v.col=d-1),a=this.options.renderableToVisualCoords(v)}return this.runLocalHooks("afterTransformEnd",a,s,l),a}}]),t}();ir(JX,wi);const yDe=JX;function Vy(t){return Vy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vy(t)}var sF;function lF(t,e){return SDe(t)||wDe(t,e)||bDe(t,e)||vDe()}function vDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bDe(t,e){if(!!t){if(typeof t=="string")return uF(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uF(t,e)}}function uF(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function wDe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function SDe(t){if(Array.isArray(t))return t}function RDe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function EDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_De(n.key),n)}}function CDe(t,e,r){return e&&cF(t.prototype,e),r&&cF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _De(t){var e=TDe(t,"string");return Vy(e)==="symbol"?e:String(e)}function TDe(t,e){if(Vy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Vy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var eQ=function(){function t(e,r){var n=this;EDe(this,t),this.settings=e,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new hDe(function(i,o,a){return n.tableProps.createCellRange(i,o,a)}),this.highlight=new aDe({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:function(o,a){return n.tableProps.isDisabledCellSelection(o,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,a){return n.tableProps.createCellCoords(o,a)},createCellRange:function(o,a,s){return n.tableProps.createCellRange(o,a,s)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new yDe(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,a){return n.tableProps.createCellCoords(o,a)},fixedRowsBottom:function(){return e.fixedRowsBottom},minSpareRows:function(){return e.minSpareRows},minSpareCols:function(){return e.minSpareCols},autoWrapRow:function(){return e.autoWrapRow},autoWrapCol:function(){return e.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(o))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(o))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(o))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(o))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(o))}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(o))})}return CDe(t,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.settings.selectionMode==="multiple",a=tr(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,s=r.row<0,l=r.col<0,u=s&&l,c=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(i?"Only":""),c),(!o||o&&!a&&tr(n))&&this.selectedRange.clear(),this.selectedRange.add(c),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&l&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&s&&this.selectedByColumnHeader.add(this.getLayerLevel()),i||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var i=this.selectedRange.current();this.settings.selectionMode!=="single"&&i.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(My,i.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(i);var o=this.getLayerLevel();o<this.highlight.layerLevel&&(ae(this.highlight.getAreas(),function(m){return void m.clear()}),ae(this.highlight.getHeaders(),function(m){return void m.clear()}),ae(this.highlight.getActiveHeaders(),function(m){return void m.clear()})),this.highlight.useLayerLevel(o);var a=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();if(a.clear(),s.clear(),l.clear(),this.highlight.isEnabledFor(H6,i.highlight)&&(this.isMultiple()||o>=1)&&(a.add(i.from).add(i.to).commit(),o===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(o-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(o)}if(this.highlight.isEnabledFor(H1,i.highlight)){var c=this.tableProps.countRowsTranslated()===0,f=this.tableProps.countColsTranslated()===0,h=i;if((c||f)&&(h=i.clone()),c&&(h.from.row=-1),f&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),s.add(h.from).commit()):s.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===i.getWidth();d&&l.add(this.tableProps.createCellCoords(i.from.row,-1)).add(this.tableProps.createCellCoords(i.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var p=this.tableProps.countRows()===i.getHeight();p&&l.add(this.tableProps.createCellCoords(-1,i.from.col)).add(this.tableProps.createCellCoords(-1,i.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=hh(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,i))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){!this.isSelected()||(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.tableProps.countRows(),o=this.tableProps.countCols();if(!(!r&&!n&&(i===0||o===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0),s=this.tableProps.createCellCoords(i-1,o-1);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(s),this.finish()}}},{key:"selectCells",value:function(r){var n=this,i=dd(r);if(i===N6)return!1;if(i===M6)throw new Error(Gt(sF||(sF=RDe([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var o=Ry(i,{propToCol:function(c){return n.tableProps.propToCol(c)},keepDirection:!0}),a=this.tableProps.countRows(),s=this.tableProps.countCols(),l=!r.some(function(u){var c=o(u),f=lF(c,4),h=f[0],d=f[1],p=f[2],m=f[3],g=Ms(h,a)&&Ms(d,s)&&Ms(p,a)&&Ms(m,s);return!g});return l&&(this.clear(),ae(r,function(u){var c=o(u),f=lF(c,4),h=f[0],d=f[1],p=f[2],m=f[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(p,m)),n.finish()})),l}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countCols(),l=this.tableProps.countRows(),u=Ms(o,s)&&Ms(a,s);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(i,o)),this.setRangeEnd(this.tableProps.createCellCoords(l-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=this.tableProps.countRows(),a=this.tableProps.countCols(),s=Ms(r,o)&&Ms(n,o);return s&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,i)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),s}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),i=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);var a=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();a.commit(),s.commit(),l.commit()}this.highlight.useLayerLevel(i)}}}]),t}();ir(eQ,wi);const ODe=eQ;var ADe=tt,tQ=y1,IDe=ya.f,xDe=wc,fF=Gr,MDe=L8,NDe=vi,PDe=D8,hF=tQ("".startsWith),kDe=tQ("".slice),$De=Math.min,rQ=PDe("startsWith"),LDe=!rQ&&!!function(){var t=IDe(String.prototype,"startsWith");return t&&!t.writable}();ADe({target:"String",proto:!0,forced:!LDe&&!rQ},{startsWith:function(e){var r=fF(NDe(this));MDe(e);var n=xDe($De(arguments.length>1?arguments[1]:void 0,r.length)),i=fF(e);return hF?hF(r,i,n):kDe(r,n,n+i.length)===i}});var dF=/^(\r\n|\n\r|\r|\n)/,DDe=/^[^\t\r\n]+/,pF=/^\t/;function FDe(t){var e=[[""]];if(t.length===0)return e;for(var r=0,n=0,i;t.length>0&&i!==t.length;)if(i=t.length,t.match(pF))t=t.replace(pF,""),r+=1,e[n][r]="";else if(t.match(dF))t=t.replace(dF,""),r=0,n+=1,e[n]=[""];else{var o="";if(t.startsWith('"')){for(var a=0,s=!0;s;){var l=t.slice(0,1);l==='"'&&(a+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&a%2===0)&&(s=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(c){return new Array(Math.floor(c.length/2)).fill('"').join("")})}else{var u=t.match(DDe);o=u?u[0]:"",t=t.slice(o.length)}e[n][r]=o}return e}function ig(t){var e,r,n,i,o="",a;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(o+="	"),a=t[e][n],typeof a=="string"?a.indexOf(`
`)>-1?o+='"'.concat(a.replace(/"/g,'""'),'"'):o+=a:a==null?o+="":o+=a;e!==r-1&&(o+=`
`)}return o}function eC(t){return VDe(t)||UDe(t)||BDe(t)||HDe()}function HDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BDe(t,e){if(!!t){if(typeof t=="string")return zO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zO(t,e)}}function UDe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function VDe(t){if(Array.isArray(t))return zO(t)}function zO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function gd(t){return gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gd(t)}function jDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zDe(n.key),n)}}function WDe(t,e,r){return e&&mF(t.prototype,e),r&&mF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function zDe(t){var e=GDe(t,"string");return gd(e)==="symbol"?e:String(e)}function GDe(t,e){if(gd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var YDe=function(){function t(e,r,n){jDe(this,t),this.instance=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return WDe(t,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,i;if(this.colToPropCache=[],this.propToColCache=new Map,n){var o=0,a=0,s=!1;if(typeof n=="function"){var l=H8(r);o=l>0?l:this.countFirstRowKeys(),s=!0}else{var u=this.tableMeta.maxCols;o=Math.min(u,n.length)}for(i=0;i<o;i++){var c=s?n(i):n[i];if(St(c)){if(typeof c.data<"u"){var f=s?a:i;this.colToPropCache[f]=c.data,this.propToColCache.set(c.data,f)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return BX(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,i){var o=this,a=n,s=i,l;return typeof a>"u"&&(a=0,s=""),gd(r)==="object"&&!Array.isArray(r)&&Rt(r,function(u,c){u===null?(l=s+c,o.colToPropCache.push(l),o.propToColCache.set(l,a),a+=1):a=o.recursiveDuckColumns(u,a,"".concat(c,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&He(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(He(n))return this.instance.toVisualColumn(n);var i=this.instance.toVisualColumn(r);return i===null?r:i}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?Ag(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=o.source,s=o.mode,l=s===void 0?"above":s,u=this.instance.countSourceRows(),c=u,f=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(c=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,i,a);if(d===!1||c===null)return{delta:0};for(var p=this.tableMeta.maxRows,m=this.getSchema().length,g=[],v=function(){var E=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?E=Qn(n.getSchema()):(E=[],Ye(m-1,function(){return E.push(null)})):n.instance.dataType==="function"?E=n.tableMeta.dataSchema(h+f):(E={},v6(E,n.getSchema())),g.push(E),f+=1};f<i&&u+f<p;)v();this.instance.rowIndexMapper.insertIndexes(h,f),l==="below"&&(c=Math.min(c+1,u)),this.spliceData(c,0,g);var w=this.instance.toVisualRow(c);return this.instance.countSourceRows()===g.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),f>0&&(r==null?this.metaManager.createRow(null,f):a!=="auto"&&this.metaManager.createRow(c,i)),this.instance.runHooks("afterCreateRow",w,f,a),this.instance.forceFullRender=!0,{delta:f,startPhysicalIndex:c}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.source,a=i.mode,s=a===void 0?"start":a;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var l=this.dataSource,u=this.tableMeta.maxCols,c=this.instance.countSourceCols(),f=r;(typeof f!="number"||f>=c)&&(f=c);var h=this.instance.runHooks("beforeCreateCol",f,n,o);if(h===!1)return{delta:0};var d=c;f<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(f));var p=this.instance.countSourceRows(),m=this.instance.countCols(),g=0,v=d;s==="end"&&(v=Math.min(v+1,c));for(var w=v;g<n&&m<u;){if(typeof f!="number"||f>=m)if(p>0)for(var b=0;b<p;b+=1)typeof l[b]>"u"&&(l[b]=[]),l[b].push(null);else l.push([null]);else for(var E=0;E<p;E++)l[E].splice(v,0,null);g+=1,v+=1,m+=1}this.instance.columnIndexMapper.insertIndexes(f,g),g>0&&(r==null?this.metaManager.createColumn(null,g):o!=="auto"&&this.metaManager.createColumn(w,n));var A=this.instance.toVisualColumn(w);return this.instance.runHooks("afterCreateCol",A,g,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:w}}},{key:"removeRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,a=Number.isInteger(r)?r:-i,s=this.visualRowsToPhysical(a,i),l=this.instance.countSourceRows();a=(l+a)%l;var u=this.instance.runHooks("beforeRemoveRow",a,s.length,s,o);if(u===!1)return!1;var c=s.length;if(this.filterData(a,c,s),a<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(s);var f=He(this.tableMeta.columns)||He(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&f===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=s.slice(0).sort(function(d,p){return p-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",a,c,s,o),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var o=typeof r!="number"?-n:r;o=(this.instance.countCols()+o)%this.instance.countCols();var a=this.visualColumnsToPhysical(o,n),s=a.slice(0).sort(function(w,b){return b-w}),l=this.instance.runHooks("beforeRemoveCol",o,n,a,i);if(l===!1)return!1;for(var u=!0,c=s.length,f=this.dataSource,h=0;h<c;h++)u&&a[0]!==a[h]-h&&(u=!1);if(u)for(var d=0,p=this.instance.countSourceRows();d<p;d++)f[d].splice(a[0],n),d===0&&this.metaManager.removeColumn(a[0],n);else for(var m=0,g=this.instance.countSourceRows();m<g;m++)for(var v=0;v<c;v++)f[m].splice(s[v],1),m===0&&this.metaManager.removeColumn(s[v],1);return o<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",o,n,a,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,i){for(var o=this.instance.getDataAtCol(r),a=o.slice(n,n+i),s=o.slice(n+i),l=arguments.length,u=new Array(l>3?l-3:0),c=3;c<l;c++)u[c-3]=arguments[c];OP(u,s);for(var f=0;f<i;)u.push(null),f+=1;return wbe(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,i){for(var o=this.instance.getSourceDataAtRow(r),a=o.slice(n,n+i),s=o.slice(n+i),l=arguments.length,u=new Array(l>3?l-3:0),c=3;c<l;c++)u[c-3]=arguments[c];OP(u,s);for(var f=0;f<i;)u.push(null),f+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,i){var o=this,a=this.instance.runHooks("beforeDataSplice",r,n,i);if(a!==!1){var s=[].concat(eC(this.dataSource.slice(0,r)),eC(i),eC(this.dataSource.slice(r)));this.dataSource.length=0,s.forEach(function(l){return o.dataSource.push(l)})}}},{key:"filterData",value:function(r,n,i){var o=this.instance.runHooks("filterData",r,n,i);Array.isArray(o)===!1&&(o=this.dataSource.filter(function(a,s){return i.indexOf(s)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}},{key:"get",value:function(r,n){var i=this.instance.toPhysicalRow(r),o=this.dataSource[i],a=this.instance.runHooks("modifyRowData",i);o=isNaN(a)?a:o;var s=null;if(o&&o.hasOwnProperty&&Nr(o,n))s=o[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var l=n.split("."),u=o;if(!u)return null;for(var c=0,f=l.length;c<f;c++)if(u=u[l[c]],typeof u>"u")return null;s=u}else typeof n=="function"&&(s=n(this.dataSource.slice(i,i+1)[0]));if(this.instance.hasHook("modifyData")){var h=hh(s);this.instance.runHooks("modifyData",i,this.propToCol(n),h,"get"),h.isTouched()&&(s=h.value)}return s}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,i){var o=this.instance.toPhysicalRow(r),a=i,s=this.dataSource[o],l=this.instance.runHooks("modifyRowData",o);if(s=isNaN(l)?l:s,this.instance.hasHook("modifyData")){var u=hh(a);this.instance.runHooks("modifyData",o,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(s&&s.hasOwnProperty&&Nr(s,n))s[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var c=n.split("."),f=s,h=0,d;for(h=0,d=c.length-1;h<d;h++)typeof f[c[h]]>"u"&&(f[c[h]]={}),f=f[c[h]];f[c[h]]=a}else typeof n=="function"?n(this.dataSource.slice(o,o+1)[0],a):s[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var i=this.instance.countSourceRows(),o=[],a=(i+r)%i,s=n,l;a<i&&s;)l=this.instance.toPhysicalRow(a),o.push(l),s-=1,a+=1;return o}},{key:"visualColumnsToPhysical",value:function(r,n){for(var i=this.instance.countCols(),o=[],a=(i+r)%i,s=n;a<i&&s;){var l=this.instance.toPhysicalColumn(a);o.push(l),s-=1,a+=1}return o}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var i=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,t.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,i){var o=[],a,s,l,u=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(u===0||c===0)return[];var f=i===t.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(c-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=h;a++){l=[];var p=a>=0?this.instance.toPhysicalRow(a):a;for(s=Math.min(r.col,n.col);s<=d&&p!==null;s++)l.push(f.call(this,a,this.colToProp(s)));p!==null&&o.push(l)}return o}},{key:"getText",value:function(r,n){return ig(this.getRange(r,n,t.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return ig(this.getRange(r,n,t.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),t}();const KDe=YDe;function qDe(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!Nr(e,t)}function B6(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,n=typeof e.type=="string"?EEe(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Rt(e,function(o,a){return void t._automaticallyAssignedMetaProps.delete(a)}),!!St(n)){r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);var i={};Rt(n,function(o,a){if(qDe(a,r)){var s;i[a]=o,(s=t._automaticallyAssignedMetaProps)===null||s===void 0||s.add(a)}}),Jr(t,i)}}function XDe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Cl(r,t);for(var n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function i2(t){return Number.isInteger(t)&&t>=0}function o2(t,e){if(!t())throw new Error("Assertion failed: ".concat(e))}function $0(t){return t==null}function GO(t){return GO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},GO(t)}const nQ=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(e){var r,n,i;for(r=0,n=this.countRows();r<n;r++)if(i=this.getDataAtCell(r,e),on(i)===!1)return!1;return!0},isEmptyRow:function(e){var r,n,i,o;for(r=0,n=this.countCols();r<n;r++)if(i=this.getDataAtCell(e,r),on(i)===!1)return GO(i)==="object"?(o=this.getCellMeta(e,r),sK(this.getSchema()[o.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function jy(t){return jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jy(t)}function gF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function yF(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gF(Object(r),!0).forEach(function(n){QDe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function QDe(t,e,r){return e=oQ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oQ(n.key),n)}}function iQ(t,e,r){return e&&vF(t.prototype,e),r&&vF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function oQ(t){var e=ZDe(t,"string");return jy(e)==="symbol"?e:String(e)}function ZDe(t,e){if(jy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(jy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aQ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function JDe(){return iQ(function t(){aQ(this,t)})}var eFe=function(){function t(e){aQ(this,t),this.metaCtor=JDe(),this.meta=this.metaCtor.prototype,Jr(this.meta,nQ()),this.meta.instance=e}return iQ(t,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;Jr(this.meta,r),B6(this.meta,yF(yF({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),t}();function Wy(t){return Wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wy(t)}function tFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nFe(n.key),n)}}function rFe(t,e,r){return e&&bF(t.prototype,e),r&&bF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function nFe(t){var e=iFe(t,"string");return Wy(e)==="symbol"?e:String(e)}function iFe(t,e){if(Wy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Wy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oFe=function(){function t(e){tFe(this,t);var r=e.getMetaConstructor();this.meta=new r}return rFe(t,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){Jr(this.meta,r),B6(this.meta,r,r)}}]),t}();function zy(t){return zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zy(t)}function wF(t){return uFe(t)||lFe(t)||sFe(t)||aFe()}function aFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sFe(t,e){if(!!t){if(typeof t=="string")return YO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YO(t,e)}}function lFe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function uFe(t){if(Array.isArray(t))return YO(t)}function YO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function cFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function SF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hFe(n.key),n)}}function fFe(t,e,r){return e&&SF(t.prototype,e),r&&SF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function hFe(t){var e=dFe(t,"string");return zy(e)==="symbol"?e:String(e)}function dFe(t,e){if(zy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(zy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var KO=function(t){function e(r){cFe(this,e),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return fFe(e,[{key:"obtain",value:function(n){o2(function(){return i2(n)},"Expecting an unsigned number.");var i=this._getStorageIndexByKey(n),o;if(i>=0)o=this.data[i],o===void 0&&(o=this.valueFactory(n),this.data[i]=o);else if(o=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=o,this.index[n]=a}else this.data.push(o),this.index[n]=this.data.length-1;return o}},{key:"insert",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;o2(function(){return i2(n)||$0(n)},"Expecting an unsigned number or null/undefined argument.");for(var o=[],a=this.data.length,s=0;s<i;s++)o.push(a+s),this.data.push(void 0);var l=$0(n)?this.index.length:n;this.index=[].concat(wF(this.index.slice(0,l)),o,wF(this.index.slice(l)))}},{key:"remove",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;o2(function(){return i2(n)||$0(n)},"Expecting an unsigned number or null/undefined argument.");for(var o=this.index.splice($0(n)?this.index.length-i:n,i),a=0;a<o.length;a++){var s=o[a];typeof s=="number"&&this.holes.add(s)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return Ji(this.data,function(i,o){return!n.holes.has(o)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],i=0;i<this.data.length;i++){var o=this._getKeyByStorageIndex(i);o!==-1&&n.push([o,this.data[i]])}var a=0;return{next:function(){if(a<n.length){var l=n[a];return a+=1,{value:l,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:t,value:function(){return this.entries()}}]),e}(Symbol.iterator);function Gy(t){return Gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gy(t)}function pFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function RF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gFe(n.key),n)}}function mFe(t,e,r){return e&&RF(t.prototype,e),r&&RF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function gFe(t){var e=yFe(t,"string");return Gy(e)==="symbol"?e:String(e)}function yFe(t,e){if(Gy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Gy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vFe=["data","width"],bFe=function(){function t(e){var r=this;pFe(this,t),this.globalMeta=e,this.metas=new KO(function(){return r._createMeta()})}return mFe(t,[{key:"updateMeta",value:function(r,n){var i=this.getMeta(r);Jr(i,n),B6(i,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return XDe(this.globalMeta.getMetaConstructor(),vFe).prototype}}]),t}();function Yy(t){return Yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yy(t)}function wFe(t){return CFe(t)||EFe(t)||RFe(t)||SFe()}function SFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RFe(t,e){if(!!t){if(typeof t=="string")return qO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qO(t,e)}}function EFe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function CFe(t){if(Array.isArray(t))return qO(t)}function qO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _Fe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function EF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,OFe(n.key),n)}}function TFe(t,e,r){return e&&EF(t.prototype,e),r&&EF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function OFe(t){var e=AFe(t,"string");return Yy(e)==="symbol"?e:String(e)}function AFe(t,e){if(Yy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Yy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var IFe=function(){function t(e){var r=this;_Fe(this,t),this.columnMeta=e,this.metas=new KO(function(){return r._createRow()})}return TFe(t,[{key:"updateMeta",value:function(r,n,i){var o=this.getMeta(r,n);Jr(o,i),B6(o,i)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(r,n)}},{key:"getMeta",value:function(r,n,i){var o=this.metas.obtain(r).obtain(n);return i===void 0?o:o[i]}},{key:"setMeta",value:function(r,n,i,o){var a,s=this.metas.obtain(r).obtain(n);(a=s._automaticallyAssignedMetaProps)===null||a===void 0||a.delete(i),s[i]=o}},{key:"removeMeta",value:function(r,n,i){var o=this.metas.obtain(r).obtain(n);delete o[i]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),i=0;i<n.length;i++)r.push.apply(r,wFe(n[i].values()));return r}},{key:"getMetasAtRow",value:function(r){o2(function(){return i2(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new KO(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),t}();function Ky(t){return Ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ky(t)}function xFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function CF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,NFe(n.key),n)}}function MFe(t,e,r){return e&&CF(t.prototype,e),r&&CF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function NFe(t){var e=PFe(t,"string");return Ky(e)==="symbol"?e:String(e)}function PFe(t,e){if(Ky(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ky(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var sQ=function(){function t(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];xFe(this,t),this.hot=e,this.globalMeta=new eFe(e),this.tableMeta=new oFe(this.globalMeta),this.columnMeta=new bFe(this.globalMeta),this.cellMeta=new IFe(this.columnMeta),i.forEach(function(o){return new o(r)}),this.globalMeta.updateMeta(n)}return MFe(t,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,i){var o=i.visualRow,a=i.visualColumn,s=this.cellMeta.getMeta(r,n);return s.visualRow=o,s.visualCol=a,s.row=r,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}},{key:"getCellMetaKeyValue",value:function(r,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,i)}},{key:"setCellMeta",value:function(r,n,i,o){this.cellMeta.setMeta(r,n,i,o)}},{key:"updateCellMeta",value:function(r,n,i){this.cellMeta.updateMeta(r,n,i)}},{key:"removeCellMeta",value:function(r,n,i){this.cellMeta.removeMeta(r,n,i)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),t}();ir(sQ,wi);function $w(t){return $w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$w(t)}function _F(t,e,r,n){var i=n.hotInstance,o=n.dataMap,a=n.dataSource,s=n.internalSource,l=n.source,u=n.metaManager,c=n.firstRun,f=ms(s),h=i.getSettings();Array.isArray(h.dataSchema)?i.dataType="array":sr(h.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks("before".concat(f),t,c,l);var d=new KDe(i,t,u);if(e(d),$w(t)==="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){var p=d.getSchema();t=[];var m,g=0,v=0;for(g=0,v=h.startRows;g<v;g++)if((i.dataType==="object"||i.dataType==="function")&&h.dataSchema)m=Qn(p),t.push(m);else if(i.dataType==="array")m=Qn(p[0]),t.push(m);else{m=[];for(var w=0,b=h.startCols;w<b;w++)m.push(null);t.push(m)}}else throw new Error("".concat(s," only accepts array of objects or array of arrays (").concat($w(t)," given)"));Array.isArray(t[0])&&(i.dataType="array"),h.data=t,d.dataSource=t,a.data=t,a.dataType=i.dataType,a.colToProp=d.colToProp.bind(d),a.propToCol=d.propToCol.bind(d),a.countCachedColumns=d.countCachedColumns.bind(d),r(d),i.runHooks("after".concat(f),t,c,l),c||(i.runHooks("afterChange",null,s),i.render())}function qy(t){return qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qy(t)}function kFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,LFe(n.key),n)}}function $Fe(t,e,r){return e&&TF(t.prototype,e),r&&TF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function LFe(t){var e=DFe(t,"string");return qy(e)==="symbol"?e:String(e)}function DFe(t,e){if(qy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(qy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var FFe=function(){function t(e){var r=this;kFe(this,t),this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),Ue.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return $Fe(t,[{key:"extendCellMeta",value:function(r){var n,i=r.row,o=r.col;if(!((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(o))){var a=r.visualRow,s=r.visualCol,l=this.metaManager.hot,u=l.colToProp(s);r.prop=u,l.runHooks("beforeGetCellMeta",a,s,r);var c=Nr(r,"type")?r.type:null,f=sr(r.cells)?r.cells(i,o,u):null;if(c)if(f){var h;f.type=(h=f.type)!==null&&h!==void 0?h:c}else f={type:c};f&&this.metaManager.updateCellMeta(i,o,f),l.runHooks("afterGetCellMeta",a,s,r),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(o)}}}]),t}();function Xy(t){return Xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xy(t)}function HFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,UFe(n.key),n)}}function BFe(t,e,r){return e&&OF(t.prototype,e),r&&OF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function UFe(t){var e=VFe(t,"string");return Xy(e)==="symbol"?e:String(e)}function VFe(t,e){if(Xy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Xy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jFe=function(){function t(e){HFe(this,t),this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var i=this.metaManager.hot.isRtl();if(i&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,i,o){if(!o)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return BFe(t,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,i){var o=n.target,a=n.onChange,s=a===void 0?function(){}:a,l=typeof o=="string",u=l?o:i,c="_".concat(u);r.metaManager.globalMeta.meta[c]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(i,c,s),l&&r.installPropWatcher(o,c,s)})}},{key:"installPropWatcher",value:function(r,n,i){var o=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(s){var l=!o.usageTracker.has(r);o.usageTracker.add(r),i.call(o,r,s,l),this[n]=s},enumerable:!0,configurable:!0})}}]),t}(),AF=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),L0=function(e){return e.map(function(r){var n=r.toLowerCase();return AF.has(n)?AF.get(n):n}).sort().join("+")},WFe=function(e){return e.split("+")},IF=function(e){return e.toLowerCase()},xF;function zFe(t){return KFe(t)||YFe(t)||lQ(t)||GFe()}function GFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YFe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function KFe(t){if(Array.isArray(t))return XO(t)}function qFe(t,e){return ZFe(t)||QFe(t,e)||lQ(t,e)||XFe()}function XFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lQ(t,e){if(!!t){if(typeof t=="string")return XO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XO(t,e)}}function XO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function QFe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function ZFe(t){if(Array.isArray(t))return t}function JFe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var eHe=function(e){var r=E6({errorIdExists:function(c){return'The "'.concat(c,'" shortcut is already registered in the "').concat(e,'" context.')}}),n=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=c.keys,h=c.callback,d=c.group,p=c.runOnlyIf,m=p===void 0?function(){return!0}:p,g=c.captureCtrl,v=g===void 0?!1:g,w=c.preventDefault,b=w===void 0?!0:w,E=c.stopPropagation,A=E===void 0?!1:E,M=c.relativeToGroup,k=c.position;if(tr(d))throw new Error("You need to define the shortcut's group.");if(sr(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(f)===!1)throw new Error(Gt(xF||(xF=JFe([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var O={callback:h,group:d,runOnlyIf:m,captureCtrl:v,preventDefault:b,stopPropagation:A};if(He(M)){var x=[M,k];O.relativeToGroup=x[0],O.position=x[1]}f.forEach(function(C){var I=L0(C),H=r.hasItem(I);if(H){var j=r.getItem(I),q=j.findIndex(function(Z){return Z.group===M});q!==-1?k==="before"?q-=1:q+=1:q=j.length,j.splice(q,0,O)}else r.addItem(I,[O])})},i=function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c.forEach(function(h){Rt(f,function(d,p){Object.prototype.hasOwnProperty.call(h,p)===!1&&(h[p]=f[p])}),n(h)})},o=function(c){var f=L0(c);r.removeItem(f)},a=function(c){var f=r.getItems();f.forEach(function(h){var d=qFe(h,2),p=d[0],m=d[1],g=m.filter(function(v){return v.group!==c});g.length===0?o(WFe(p)):(m.length=0,m.push.apply(m,zFe(g)))})},s=function(c){var f=L0(c),h=r.getItem(f);return He(h)?h.slice():[]},l=function(c){var f=L0(c);return r.hasItem(f)};return{addShortcut:n,addShortcuts:i,getShortcuts:s,hasShortcut:l,removeShortcutsByKeys:o,removeShortcutsByGroup:a}};function tHe(){var t=new Set;return{press:function(r){t.add(r)},release:function(r){t.delete(r)},releaseAll:function(){t.clear()},isPressed:function(r){return t.has(r)}}}var rHe=["meta","alt","shift","control"],mm=tHe();function nHe(t,e,r,n,i){var o=function(d){return rHe.includes(d)},a=function(d){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,m=[];return d.altKey&&m.push("alt"),p&&(d.ctrlKey||d.metaKey)?m.push("control/meta"):(d.ctrlKey&&m.push("control"),d.metaKey&&m.push("meta")),d.shiftKey&&m.push("shift"),m},s=function(d){if(e(d)!==!1){var p=r(d);if(!(d.keyCode===229||p===!1||Ef(d))){var m=IF(d.key),g=[];o(m)?mm.press(m):g=a(d);var v=[m].concat(g),w=i(d,v);!w&&(zP()&&g.includes("meta")||!zP()&&g.includes("control"))&&i(d,[m].concat(a(d,!0))),n(d)}}},l=function(d){if(e(d)!==!1){var p=IF(d.key);o(p)!==!1&&mm.release(p)}},u=function(){mm.releaseAll()},c=function(){for(var d=t;d;)d.document.documentElement.addEventListener("keydown",s),d.document.documentElement.addEventListener("keyup",l),d.document.documentElement.addEventListener("blur",u),d=q2(d)},f=function(){for(var d=t;d;)d.document.documentElement.removeEventListener("keydown",s),d.document.documentElement.removeEventListener("keyup",l),d.document.documentElement.removeEventListener("blur",u),d=q2(d)};return{mount:c,unmount:f,isPressed:function(d){return mm.isPressed(d)},releasePressedKeys:function(){return mm.releaseAll()}}}var iHe=function(e){var r=e.ownerWindow,n=e.handleEvent,i=e.beforeKeyDown,o=e.afterKeyDown,a=E6({errorIdExists:function(m){return'The "'.concat(m,'" context name is already registered.')}}),s="grid",l=function(m){var g=eHe(m);return a.addItem(m,g),g},u=function(){return s},c=function(m){return a.getItem(m)},f=function(m){s=m},h=!1,d=nHe(r,n,i,o,function(p,m){var g=c(u()),v=!1;if(!g.hasShortcut(m))return v;for(var w=g.getShortcuts(m),b=0;b<w.length;b++){var E=w[b],A=E.callback,M=E.runOnlyIf,k=E.preventDefault,O=E.stopPropagation,x=E.captureCtrl;if(M(p)!==!1&&(h=x,v=A(p,m)===!1,h=!1,k&&p.preventDefault(),O&&p.stopPropagation(),v))break}return v});return d.mount(),{addContext:l,getActiveContextName:u,getContext:c,setActiveContextName:f,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}},MF,NF;function ni(t){return ni=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ni(t)}function PF(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Bo(t,e){return sHe(t)||aHe(t,e)||uQ(t,e)||oHe()}function oHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aHe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function sHe(t){if(Array.isArray(t))return t}function Qc(t){return cHe(t)||uHe(t)||uQ(t)||lHe()}function lHe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uQ(t,e){if(!!t){if(typeof t=="string")return QO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QO(t,e)}}function uHe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function cHe(t){if(Array.isArray(t))return QO(t)}function QO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var fHe="gridDefault",tC=null,D0=new Set;function ZI(t,e){var r,n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,a=this,s=new Er(a),l,u,c,f,h=!0;l$e(i)&&s$e(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",p=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",p),this.isRtl=function(){return p==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},e.language=q$e(e.language);var m=new sQ(a,e,[FFe,jFe]),g=m.getTableMeta(),v=m.getGlobalMeta(),w=E6();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),HO(this)&&Cbe(e.licenseKey,t),this.guid="ht_".concat(wK()),this.columnIndexMapper=new gO,this.rowIndexMapper=new gO,u=new N$e(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var b=function(R){var _=R.row,$=R.col;return a._createCellCoords(_>=0?a.rowIndexMapper.getRenderableFromVisualIndex(_):_,$>=0?a.columnIndexMapper.getRenderableFromVisualIndex($):$)},E=function(R){var _=R.row,$=R.col;return a._createCellCoords(_>=0?a.rowIndexMapper.getVisualFromRenderableIndex(_):_,$>=0?a.columnIndexMapper.getVisualFromRenderableIndex($):$)},A=new ODe(g,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(R){return l.propToCol(R)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(R,_){return a._createCellCoords(R,_)},createCellRange:function(R,_,$){return a._createCellRange(R,_,$)},visualToRenderableCoords:b,renderableToVisualCoords:E,isDisabledCellSelection:function(R,_){return a.getCellMeta(R,_).disableVisualSelection}});this.selection=A;var M=function(R){var _=R.hiddenIndexesChanged;_&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",M),this.rowIndexMapper.addLocalHook("cacheUpdated",M),this.selection.addLocalHook("beforeSetRangeStart",function(y){n.runHooks("beforeSetRangeStart",y)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(y){n.runHooks("beforeSetRangeStartOnly",y)}),this.selection.addLocalHook("beforeSetRangeEnd",function(y){n.runHooks("beforeSetRangeEnd",y),y.row<0&&(y.row=n.view._wt.wtTable.getFirstVisibleRow()),y.col<0&&(y.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(y){var R=hh(!1),_=n.selection.getSelectedRange(),$=_.current(),B=$.from,W=$.to,ee=_.size()-1;n.runHooks("afterSelection",B.row,B.col,W.row,W.col,R,ee),n.runHooks("afterSelectionByProp",B.row,a.colToProp(B.col),W.row,a.colToProp(W.col),R,ee);var J=n.selection.isSelectedByAnyHeader(),he=n.selection.selectedRange.current(),re=!0;o&&(re=!1),R.isTouched()&&(re=!R.value);var T=n.selection.isSelectedByRowHeader(),D=n.selection.isSelectedByColumnHeader();re!==!1&&(J?T?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(y.row)):D&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(y.col)):he&&!n.selection.isMultiple()?n.view.scrollViewport(b(he.from)):n.view.scrollViewport(b(y))),T&&D?_e(n.rootElement,["ht__selection--rows","ht__selection--columns"]):T?(ut(n.rootElement,"ht__selection--columns"),_e(n.rootElement,"ht__selection--rows")):D?(ut(n.rootElement,"ht__selection--rows"),_e(n.rootElement,"ht__selection--columns")):ut(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(y){var R=y.length-1,_=y[R],$=_.from,B=_.to;n.runHooks("afterSelectionEnd",$.row,$.col,B.row,B.col,R),n.runHooks("afterSelectionEndByProp",$.row,a.colToProp($.col),B.row,a.colToProp(B.col),R)}),this.selection.addLocalHook("afterIsMultipleSelection",function(y){var R=n.runHooks("afterIsMultipleSelection",y.value);y.value&&(y.value=R)}),this.selection.addLocalHook("beforeModifyTransformStart",function(y){n.runHooks("modifyTransformStart",y)}),this.selection.addLocalHook("afterModifyTransformStart",function(y,R,_){n.runHooks("afterModifyTransformStart",y,R,_)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(y){n.runHooks("modifyTransformEnd",y)}),this.selection.addLocalHook("afterModifyTransformEnd",function(y,R,_){n.runHooks("afterModifyTransformEnd",y,R,_)}),this.selection.addLocalHook("afterDeselect",function(){f.destroyEditor(),n._refreshBorders(),ut(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(y){n.alter("insert_row_above",y,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(y){n.alter("insert_col_start",y,1,"auto")}),c={alter:function(R,_){var $,B,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,ee=arguments.length>3?arguments[3]:void 0,J=arguments.length>4?arguments[4]:void 0,he=function(Ke){if(Ke.length===0)return[];var Xe=Qc(Ke);Xe.sort(function(Et,it){var st=Bo(Et,1),rt=st[0],Lt=Bo(it,1),kt=Lt[0];return rt===kt?0:rt>kt?1:-1});var nt=Fn(Xe,function(Et,it){var st=Bo(it,2),rt=st[0],Lt=st[1],kt=Et[Et.length-1],Mt=Bo(kt,2),gt=Mt[0],Kr=Mt[1],rn=gt+Kr;if(rt<=rn){var Lr=Math.max(Lt-(rn-rt),0);kt[1]+=Lr}else Et.push([rt,Lt]);return Et},[Xe[0]]);return nt};switch(R){case"insert_row":D0.has(R)||(D0.add(R),Xt(Gt(MF||(MF=PF(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),R)));case"insert_row_below":case"insert_row_above":var re=a.countSourceRows();if(g.maxRows===re)return;var T=R==="insert_row_below"?"below":"above";_=($=_)!==null&&$!==void 0?$:R==="insert_row"||T==="below"?re:0;var D=l.createRow(_,W,{source:ee,mode:T}),z=D.delta,K=D.startPhysicalIndex;if(z){var le=A.selectedRange.current(),X=le==null?void 0:le.from,we=X==null?void 0:X.row,Ce=a.toVisualRow(K);if(A.isSelectedByCorner())a.selectAll();else if(He(we)&&we>=Ce){var Ee=le.to,Te=Ee.row,Oe=Ee.col,F=X.col;A.isSelectedByRowHeader()&&(F=-1),A.getSelectedRange().pop(),A.setRangeStartOnly(a._createCellCoords(we+z,F),!0),A.setRangeEnd(a._createCellCoords(Te+z,Oe))}else a._refreshBorders()}break;case"insert_col":D0.has(R)||(D0.add(R),Xt(Gt(NF||(NF=PF(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),R)));case"insert_col_start":case"insert_col_end":var U=R==="insert_col_end"?"end":"start";_=(B=_)!==null&&B!==void 0?B:R==="insert_col"||U==="end"?a.countSourceCols():0;var Y=l.createCol(_,W,{source:ee,mode:U}),fe=Y.delta,oe=Y.startPhysicalIndex;if(fe){if(Array.isArray(g.colHeaders)){var pe=[a.toVisualColumn(oe),0];pe.length+=fe,Array.prototype.splice.apply(g.colHeaders,pe)}var ue=A.selectedRange.current(),se=ue==null?void 0:ue.from,me=se==null?void 0:se.col,te=a.toVisualColumn(oe);if(A.isSelectedByCorner())a.selectAll();else if(He(me)&&me>=te){var de=ue.to,Se=de.row,Re=de.col,Me=se.row;A.isSelectedByColumnHeader()&&(Me=-1),A.getSelectedRange().pop(),A.setRangeStartOnly(a._createCellCoords(Me,me+fe),!0),A.setRangeEnd(a._createCellCoords(Se,Re+fe))}else a._refreshBorders()}break;case"remove_row":var qe=function(Ke){var Xe=0;ae(Ke,function(nt){var Et=Bo(nt,2),it=Et[0],st=Et[1],rt=on(it)?a.countRows()-1:Math.max(it-Xe,0);Number.isInteger(it)&&(it=Math.max(it-Xe,0));var Lt=l.removeRow(it,st,ee);if(!!Lt){var kt=a.countRows(),Mt=g.fixedRowsTop;Mt>=rt+1&&(g.fixedRowsTop-=Math.min(st,Mt-rt));var gt=g.fixedRowsBottom;gt&&rt>=kt-gt&&(g.fixedRowsBottom-=Math.min(st,gt)),Xe+=st}})};Array.isArray(_)?qe(he(_)):qe([[_,W]]),c.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var ke=function(Ke){var Xe=0;ae(Ke,function(nt){var Et=Bo(nt,2),it=Et[0],st=Et[1],rt=on(it)?a.countCols()-1:Math.max(it-Xe,0),Lt=a.toPhysicalColumn(rt);Number.isInteger(it)&&(it=Math.max(it-Xe,0));var kt=l.removeCol(it,st,ee);if(!!kt){var Mt=g.fixedColumnsStart;Mt>=rt+1&&(g.fixedColumnsStart-=Math.min(st,Mt-rt)),Array.isArray(g.colHeaders)&&(typeof Lt>"u"&&(Lt=-1),g.colHeaders.splice(Lt,st)),Xe+=st}})};Array.isArray(_)?ke(he(_)):ke([[_,W]]),c.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(R,'"'))}J||c.adjustRowsAndCols()},adjustRowsAndCols:function(){var R=g.minRows,_=g.minSpareRows,$=g.minCols,B=g.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&A.deselect(),R){var W=a.countRows();W<R&&l.createRow(W,R-W,{source:"auto"})}if(_){var ee=a.countEmptyRows(!0);if(ee<_){var J=_-ee,he=Math.min(J,g.maxRows-a.countSourceRows());l.createRow(a.countRows(),he,{source:"auto"})}}{var re;($||B)&&(re=a.countEmptyCols(!0));var T=a.countCols();if($&&!g.columns&&T<$){var D=$-T;re+=D,l.createCol(T,D,{source:"auto"})}if(B&&!g.columns&&a.dataType==="array"&&re<B){T=a.countCols();var z=B-re,K=Math.min(z,g.maxCols-T);l.createCol(T,K,{source:"auto"})}}if(A.isSelected()){var le=a.countRows(),X=a.countCols();ae(A.selectedRange,function(we){var Ce=!1,Ee=we.from.row,Te=we.from.col,Oe=we.to.row,F=we.to.col;Ee>le-1?(Ee=le-1,Ce=!0,Oe>Ee&&(Oe=Ee)):Oe>le-1&&(Oe=le-1,Ce=!0,Ee>Oe&&(Ee=Oe)),Te>X-1?(Te=X-1,Ce=!0,F>Te&&(F=Te)):F>X-1&&(F=X-1,Ce=!0,Te>F&&(Te=F)),Ce&&a.selectCell(Ee,Te,Oe,F)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(R,_,$,B,W,ee,J){var he,re,T,D,z=[],K={},le=[],X=R.row,we=R.col;if(re=_.length,re===0)return!1;var Ce=0,Ee=0;switch(St($)&&(Ce=$.col-we+1,Ee=$.row-X+1),W){case"shift_down":var Te=Vb(_),Oe=Te.length,F=Math.max(Oe,Ce),U=a.getData().slice(X),Y=Vb(U).slice(we,we+F);for(T=0;T<F;T+=1)if(T<Oe){for(he=0,re=Te[T].length;he<Ee-re;he+=1)Te[T].push(Te[T][he%re]);T<Y.length?le.push(Te[T].concat(Y[T])):le.push(Te[T].concat(new Array(U.length).fill(null)))}else le.push(Te[T%Oe].concat(Y[T]));a.populateFromArray(X,we,Vb(le));break;case"shift_right":var fe=_.length,oe=Math.max(fe,Ee),pe=a.getData().slice(X).map(function(Mt){return Mt.slice(we)});for(he=0;he<oe;he+=1)if(he<fe){for(T=0,D=_[he].length;T<Ce-D;T+=1)_[he].push(_[he][T%D]);if(he<pe.length)for(var ue=0;ue<pe[he].length;ue+=1)_[he].push(pe[he][ue]);else{var se;(se=_[he]).push.apply(se,Qc(new Array(pe[0].length).fill(null)))}}else _.push(_[he%re].slice(0,oe).concat(pe[he]));a.populateFromArray(X,we,_);break;case"overwrite":default:K.row=R.row,K.col=R.col;var me={row:$&&R?$.row-R.row+1:1,col:$&&R?$.col-R.col+1:1},te=0,de=0,Se=!0,Re,Me=function(gt){var Kr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,rn=_[gt%_.length];return Kr!==null?rn[Kr%rn.length]:rn},qe=_.length,ke=$?$.row-R.row+1:0;for($?re=ke:re=Math.max(qe,ke),he=0;he<re&&!($&&K.row>$.row&&ke>qe||!g.allowInsertRow&&K.row>a.countRows()-1||K.row>=g.maxRows);he++){var We=he-te,Ke=Me(We).length,Xe=$?$.col-R.col+1:0;if($?D=Xe:D=Math.max(Ke,Xe),K.col=R.col,Re=a.getCellMeta(K.row,K.col),(B==="CopyPaste.paste"||B==="Autofill.fill")&&Re.skipRowOnPaste){te+=1,K.row+=1,re+=1;continue}for(de=0,T=0;T<D&&!($&&K.col>$.col&&Xe>Ke||!g.allowInsertColumn&&K.col>a.countCols()-1||K.col>=g.maxCols);T++){if(Re=a.getCellMeta(K.row,K.col),(B==="CopyPaste.paste"||B==="Autofill.fill")&&Re.skipColumnOnPaste){de+=1,K.col+=1,D+=1;continue}if(Re.readOnly&&B!=="UndoRedo.undo"){K.col+=1;continue}var nt=T-de,Et=Me(We,nt),it=a.getDataAtCell(K.row,K.col),st={row:We,col:nt};if(B==="Autofill.fill"){var rt=a.runHooks("beforeAutofillInsidePopulate",st,ee,_,J,{},me);rt&&(Et=tr(rt.value)?Et:rt.value)}if(Et!==null&&ni(Et)==="object")if(Array.isArray(Et)&&it===null&&(it=[]),it===null||ni(it)!=="object")Se=!1;else{var Lt=Ag(Array.isArray(it)?it:it[0]||it),kt=Ag(Array.isArray(Et)?Et:Et[0]||Et);sK(Lt,kt)||Array.isArray(Lt)&&Array.isArray(kt)?Et=Qn(Et):Se=!1}else it!==null&&ni(it)==="object"&&(Se=!1);Se&&z.push([K.row,K.col,Et]),Se=!0,K.col+=1}K.row+=1}a.setDataAtCell(z,null,null,B||"populateFromArray");break}}};function k(y){var R=UX(y);qI(R)?(a.runHooks("beforeLanguageChange",R),v.language=R,a.runHooks("afterLanguageChange",R)):VX(y)}function O(y,R){var _=y==="className"?a.rootElement:a.table;if(h)_e(_,R);else{var $=[],B=[];v[y]&&($=Array.isArray(v[y])?v[y]:IP(v[y])),R&&(B=Array.isArray(R)?R:IP(R));var W=AP($,B),ee=AP(B,$);W.length&&ut(_,W),ee.length&&_e(_,ee)}v[y]=R}this.init=function(){u.setData(g.data),a.runHooks("beforeInit"),(na()||cK())&&_e(a.rootElement,"mobile"),this.updateSettings(g,!0),this.view=new R$e(this),f=jSe.getInstance(a,g,A),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),!!h&&a.rootElement.offsetParent===null&&Owe(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),ni(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function x(){var y=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,y=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&y===!1&&(y=!0,this.onQueueEmpty(this.valid))}}}function C(y){var R=y.replace(",",".");return isNaN(parseFloat(R))===!1?parseFloat(R):y}function I(y,R,_){if(!!y.length){var $=a.getActiveEditor(),B=a.runHooks("beforeChange",y,R||"edit"),W=!0;if(B===!1){$&&$.cancelChanges();return}var ee=new x;ee.onQueueEmpty=function(le){$&&W&&$.cancelChanges(),_(le)};for(var J=y.length-1;J>=0;J--)if(y[J]===null)y.splice(J,1);else{var he=Bo(y[J],4),re=he[0],T=he[1],D=he[3],z=l.propToCol(T),K=a.getCellMeta(re,z);K.type==="numeric"&&typeof D=="string"&&p6e(D)&&(y[J][3]=C(D)),a.getCellValidator(K)&&(ee.addValidatorToQueue(),a.validateCell(y[J][3],K,function(le,X){return function(we){if(typeof we!="boolean")throw new Error("Validation error: result is not boolean");if(we===!1&&X.allowInvalid===!1){W=!1,y.splice(le,1),X.valid=!0;var Ce=a.getCell(X.visualRow,X.visualCol);Ce!==null&&ut(Ce,g.invalidCellClassName)}ee.removeValidatorFormQueue()}}(J,K),R))}ee.checkIfQueueIsEmpty()}}function H(y,R){var _=y.length-1;if(!(_<0)){for(;_>=0;_--){var $=!1;if(y[_]===null){y.splice(_,1);continue}if(!((y[_][2]===null||y[_][2]===void 0)&&(y[_][3]===null||y[_][3]===void 0))){if(g.allowInsertRow)for(;y[_][0]>a.countRows()-1;){var B=l.createRow(void 0,void 0,{source:R}),W=B.delta;if(W===0){$=!0;break}}if(a.dataType==="array"&&(!g.columns||g.columns.length===0)&&g.allowInsertColumn)for(;l.propToCol(y[_][1])>a.countCols()-1;){var ee=l.createCol(void 0,void 0,{source:R}),J=ee.delta;if(J===0){$=!0;break}}$||l.set(y[_][0],y[_][1],y[_][3])}}a.forceFullRender=!0,c.adjustRowsAndCols(),a.runHooks("beforeChangeRender",y,R),f.lockEditor(),a._refreshBorders(null),f.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",y,R||"edit");var he=a.getActiveEditor();he&&He(he.refreshValue)&&he.refreshValue()}}this._createCellCoords=function(y,R){return a.view._wt.createCellCoords(y,R)},this._createCellRange=function(y,R,_){return a.view._wt.createCellRange(y,R,_)},this.validateCell=function(y,R,_,$){var B=a.getCellValidator(R);function W(ee){var J=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!J||R.hidden===!0){_(ee);return}var he=R.visualCol,re=R.visualRow,T=a.getCell(re,he,!0);if(T&&T.nodeName!=="TH"){var D=a.rowIndexMapper.getRenderableFromVisualIndex(re),z=a.columnIndexMapper.getRenderableFromVisualIndex(he);a.view._wt.getSetting("cellRenderer",D,z,T)}_(ee)}Sbe(B)&&(B=function(ee){return function(J,he){he(ee.test(J))}}(B)),sr(B)?(y=a.runHooks("beforeValidate",y,R.visualRow,R.prop,$),a._registerImmediate(function(){B.call(R,y,function(ee){!a||(ee=a.runHooks("afterValidate",ee,y,R.visualRow,R.prop,$),R.valid=ee,W(ee),a.runHooks("postAfterValidate",ee,y,R.visualRow,R.prop,$))})})):a._registerImmediate(function(){R.valid=!0,W(R.valid,!1)})};function j(y,R,_){return Array.isArray(y)?y:[[y,R,_]]}this.setDataAtCell=function(y,R,_,$){var B=j(y,R,_),W=[],ee=$,J,he,re;for(J=0,he=B.length;J<he;J++){if(ni(B[J])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof B[J][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");B[J][1]>=this.countCols()?re=B[J][1]:re=l.colToProp(B[J][1]),W.push([B[J][0],re,u.getAtCell(this.toPhysicalRow(B[J][0]),B[J][1]),B[J][2]])}!ee&&ni(y)==="object"&&(ee=R),a.runHooks("afterSetDataAtCell",W,ee),I(W,ee,function(){H(W,ee)})},this.setDataAtRowProp=function(y,R,_,$){var B=j(y,R,_),W=[],ee=$,J,he;for(J=0,he=B.length;J<he;J++)W.push([B[J][0],B[J][1],u.getAtCell(this.toPhysicalRow(B[J][0]),B[J][1]),B[J][2]]);!ee&&ni(y)==="object"&&(ee=R),a.runHooks("afterSetDataAtRowProp",W,ee),I(W,ee,function(){H(W,ee)})},this.listen=function(){a&&!a.isListening()&&(tC=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(tC=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return tC===a.guid},this.destroyEditor=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(y,R)},this.populateFromArray=function(y,R,_,$,B,W,ee,J,he){if(!(ni(_)==="object"&&ni(_[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var re=typeof $=="number"?a._createCellCoords($,B):null;return c.populateFromArray(a._createCellCoords(y,R),_,re,W,ee,J,he)},this.spliceCol=function(y,R,_){for(var $,B=arguments.length,W=new Array(B>3?B-3:0),ee=3;ee<B;ee++)W[ee-3]=arguments[ee];return($=l).spliceCol.apply($,[y,R,_].concat(W))},this.spliceRow=function(y,R,_){for(var $,B=arguments.length,W=new Array(B>3?B-3:0),ee=3;ee<B;ee++)W[ee-3]=arguments[ee];return($=l).spliceRow.apply($,[y,R,_].concat(W))},this.getSelected=function(){if(A.isSelected())return wt(A.getSelectedRange(),function(y){var R=y.from,_=y.to;return[R.row,R.col,_.row,_.col]})},this.getSelectedLast=function(){var y=this.getSelected(),R;return y&&y.length>0&&(R=y[y.length-1]),R},this.getSelectedRange=function(){if(A.isSelected())return Array.from(A.getSelectedRange())},this.getSelectedRangeLast=function(){var y=this.getSelectedRange(),R;return y&&y.length>0&&(R=y[y.length-1]),R},this.emptySelectedCells=function(y){var R=this;if(!(!A.isSelected()||this.countRows()===0||this.countCols()===0)){var _=[];ae(A.getSelectedRange(),function($){var B=$.getTopStartCorner(),W=$.getBottomEndCorner();Ye(B.row,W.row,function(ee){Ye(B.col,W.col,function(J){R.getCellMeta(ee,J).readOnly||_.push([ee,J,null])})})}),_.length>0&&this.setDataAtCell(_,y)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var y=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(y,0),!this.isRenderSuspended()&&y===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(f.lockEditor(),this._refreshBorders(null),f.unlockEditor()))},this.batchRender=function(y){this.suspendRender();var R=y();return this.resumeRender(),R},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(R,0),(!this.isExecutionSuspended()&&R===this.executionSuspendedCounter||y)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(y){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var _=y();return this.resumeExecution(R),_},this.batch=function(y){this.suspendRender(),this.suspendExecution();var R=y();return this.resumeExecution(),this.resumeRender(),R},this.refreshDimensions=function(){if(!!a.view){var y=a.view.getLastSize(),R=y.width,_=y.height,$=a.rootElement.getBoundingClientRect(),B=$.width,W=$.height,ee=B!==R||W!==_,J=a.runHooks("beforeRefreshDimensions",{width:R,height:_},{width:B,height:W},ee)===!1;J||((ee||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(B,W),a.render()),a.runHooks("afterRefreshDimensions",{width:R,height:_},{width:B,height:W},ee))}},this.updateData=function(y,R){var _=this;_F(y,function($){l=$},function($){l=$,a.columnIndexMapper.fitToLength(_.getInitialColumnCount()),a.rowIndexMapper.fitToLength(_.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:a,dataMap:l,dataSource:u,internalSource:"updateData",source:R,metaManager:m,firstRun:h})},this.loadData=function(y,R){_F(y,function(_){l=_},function(){m.clearCellsCache(),a.initIndexMappers(),c.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:l,dataSource:u,internalSource:"loadData",source:R,metaManager:m,firstRun:h})},this.getInitialColumnCount=function(){var y=g.columns,R=0;if(Array.isArray(y))R=y.length;else if(sr(y))if(a.dataType==="array")for(var _=this.countSourceCols(),$=0;$<_;$+=1)y($)&&(R+=1);else(a.dataType==="object"||a.dataType==="function")&&(R=l.colToPropCache.length);else if(He(g.dataSchema)){var B=l.getSchema();R=Array.isArray(B)?B.length:H8(B)}else R=this.countSourceCols();return R},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(y,R,_,$){return tr(y)?l.getAll():l.getRange(a._createCellCoords(y,R),a._createCellCoords(_,$),l.DESTINATION_RENDERER)},this.getCopyableText=function(y,R,_,$){return l.getCopyableText(a._createCellCoords(y,R),a._createCellCoords(_,$))},this.getCopyableData=function(y,R){return l.getCopyable(y,l.colToProp(R))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(y){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,_=(h?a.loadData:a.updateData).bind(this),$=!1,B,W;if(He(y.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(He(y.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(He(y.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(B in y)B==="data"||(B==="language"?k(y.language):B==="className"?O("className",y.className):B==="tableClassName"&&a.table?(O("tableClassName",y.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):Ue.getSingleton().isRegistered(B)||Ue.getSingleton().isDeprecated(B)?(sr(y[B])||Array.isArray(y[B]))&&(y[B].initialHook=!0,a.addHook(B,y[B])):!R&&Nr(y,B)&&(v[B]=y[B]));y.data===void 0&&g.data===void 0?_(null,"updateSettings"):y.data!==void 0?_(y.data,"updateSettings"):y.columns!==void 0&&(l.createMap(),a.initIndexMappers());var ee=a.countCols(),J=g.columns;if(J&&sr(J)&&($=!0),(y.cell!==void 0||y.cells!==void 0||y.columns!==void 0)&&m.clearCache(),ee>0)for(B=0,W=0;B<ee;B++){if(J){var he=$?J(B):J[W];he&&m.updateColumnMeta(W,he)}W+=1}He(y.cell)&&Rt(y.cell,function(le){a.setCellMetaObject(le.row,le.col,le)}),a.runHooks("afterCellMetaReset");var re=a.rootElement.style.height;re!==""&&(re=parseInt(a.rootElement.style.height,10));var T=y.height;if(sr(T)&&(T=T()),R){var D=a.rootElement.getAttribute("style");D&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(T===null){var z=a.rootElement.getAttribute("data-initialstyle");z&&(z.indexOf("height")>-1||z.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",z):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else T!==void 0&&(a.rootElement.style.height=isNaN(T)?"".concat(T):"".concat(T,"px"),a.rootElement.style.overflow="hidden");if(typeof y.width<"u"){var K=y.width;sr(K)&&(K=K()),a.rootElement.style.width=isNaN(K)?"".concat(K):"".concat(K,"px")}R||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",y)),c.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,f.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),f.unlockEditor()),!R&&a.view&&(re===""||T===""||T===void 0)&&re!==T&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var y=a.getSelectedLast();if(g.getValue){if(sr(g.getValue))return g.getValue.call(a);if(y)return a.getData()[y[0][0]][g.getValue]}else if(y)return a.getDataAtCell(y[0],y[1])},this.getSettings=function(){return g},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(y,R,_,$,B){c.alter(y,R,_,$,B)},this.getCell=function(y,R){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,$=R,B=y;if(R>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(R)))return null;$=this.columnIndexMapper.getRenderableFromVisualIndex(R)}if(y>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(y)))return null;B=this.rowIndexMapper.getRenderableFromVisualIndex(y)}return B===null||$===null?null:a.view.getCellAtCoords(a._createCellCoords(B,$),_)},this.getCoords=function(y){var R=this.view._wt.wtTable.getCoords(y);if(R===null)return null;var _=R.row,$=R.col,B=_,W=$;return _>=0&&(B=this.rowIndexMapper.getVisualFromRenderableIndex(_)),$>=0&&(W=this.columnIndexMapper.getVisualFromRenderableIndex($)),a._createCellCoords(B,W)},this.colToProp=function(y){return l.colToProp(y)},this.propToCol=function(y){return l.propToCol(y)},this.toVisualRow=function(y){return n.rowIndexMapper.getVisualFromPhysicalIndex(y)},this.toVisualColumn=function(y){return n.columnIndexMapper.getVisualFromPhysicalIndex(y)},this.toPhysicalRow=function(y){return n.rowIndexMapper.getPhysicalFromVisualIndex(y)},this.toPhysicalColumn=function(y){return n.columnIndexMapper.getPhysicalFromVisualIndex(y)},this.getDataAtCell=function(y,R){return l.get(y,l.colToProp(R))},this.getDataAtRowProp=function(y,R){return l.get(y,R)},this.getDataAtCol=function(y){for(var R=[],_=l.getRange(a._createCellCoords(0,y),a._createCellCoords(g.data.length-1,y),l.DESTINATION_RENDERER),$=0;$<_.length;$+=1)for(var B=0;B<_[$].length;B+=1)R.push(_[$][B]);return R},this.getDataAtProp=function(y){for(var R=[],_=l.getRange(a._createCellCoords(0,l.propToCol(y)),a._createCellCoords(g.data.length-1,l.propToCol(y)),l.DESTINATION_RENDERER),$=0;$<_.length;$+=1)for(var B=0;B<_[$].length;B+=1)R.push(_[$][B]);return R},this.getSourceData=function(y,R,_,$){var B;return y===void 0?B=u.getData():B=u.getByRange(a._createCellCoords(y,R),a._createCellCoords(_,$)),B},this.getSourceDataArray=function(y,R,_,$){var B;return y===void 0?B=u.getData(!0):B=u.getByRange(a._createCellCoords(y,R),a._createCellCoords(_,$),!0),B},this.getSourceDataAtCol=function(y){return u.getAtColumn(y)},this.setSourceDataAtCell=function(y,R,_,$){var B=j(y,R,_),W=this.hasHook("afterSetSourceDataAtCell"),ee=[];W&&ae(B,function(he){var re=Bo(he,3),T=re[0],D=re[1],z=re[2];ee.push([T,D,u.getAtCell(T,D),z])}),ae(B,function(he){var re=Bo(he,3),T=re[0],D=re[1],z=re[2];u.setAtCell(T,D,z)}),W&&this.runHooks("afterSetSourceDataAtCell",ee,$),this.render();var J=a.getActiveEditor();J&&He(J.refreshValue)&&J.refreshValue()},this.getSourceDataAtRow=function(y){return u.getAtRow(y)},this.getSourceDataAtCell=function(y,R){return u.getAtCell(y,R)},this.getDataAtRow=function(y){var R=l.getRange(a._createCellCoords(y,0),a._createCellCoords(y,this.countCols()-1),l.DESTINATION_RENDERER);return R[0]||[]},this.getDataType=function(y,R,_,$){var B=this,W=y===void 0?[0,0,this.countRows(),this.countCols()]:[y,R,_,$],ee=W[0],J=W[1],he=W[2],re=W[3],T=null,D=null;he===void 0&&(he=ee),re===void 0&&(re=J);var z="mixed";return Ye(Math.max(Math.min(ee,he),0),Math.max(ee,he),function(K){var le=!0;return Ye(Math.max(Math.min(J,re),0),Math.max(J,re),function(X){var we=B.getCellMeta(K,X);return D=we.type,T?le=T===D:T=D,le}),z=le?D:"mixed",le}),z},this.removeCellMeta=function(y,R,_){var $=[this.toPhysicalRow(y),this.toPhysicalColumn(R)],B=$[0],W=$[1],ee=m.getCellMetaKeyValue(B,W,_),J=a.runHooks("beforeRemoveCellMeta",y,R,_,ee);J!==!1&&(m.removeCellMeta(B,W,_),a.runHooks("afterRemoveCellMeta",y,R,_,ee)),ee=null},this.spliceCellsMeta=function(y){for(var R=this,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,$=arguments.length,B=new Array($>2?$-2:0),W=2;W<$;W++)B[W-2]=arguments[W];if(B.length>0&&!Array.isArray(B[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");_>0&&m.removeRow(this.toPhysicalRow(y),_),B.length>0&&ae(B.reverse(),function(ee){m.createRow(R.toPhysicalRow(y)),ae(ee,function(J,he){return R.setCellMetaObject(y,he,J)})}),a.render()},this.setCellMetaObject=function(y,R,_){var $=this;ni(_)==="object"&&Rt(_,function(B,W){$.setCellMeta(y,R,W,B)})},this.setCellMeta=function(y,R,_,$){var B=a.runHooks("beforeSetCellMeta",y,R,_,$);if(B!==!1){var W=y,ee=R;y<this.countRows()&&(W=this.toPhysicalRow(y)),R<this.countCols()&&(ee=this.toPhysicalColumn(R)),m.setCellMeta(W,ee,_,$),a.runHooks("afterSetCellMeta",y,R,_,$)}},this.getCellsMeta=function(){return m.getCellsMeta()},this.getCellMeta=function(y,R){var _=this.toPhysicalRow(y),$=this.toPhysicalColumn(R);return _===null&&(_=y),$===null&&($=R),m.getCellMeta(_,$,{visualRow:y,visualColumn:R})},this.getCellMetaAtRow=function(y){return m.getCellsMetaAtRow(y)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||g.columns)},this.getCellRenderer=function(y,R){var _=typeof y=="number"?a.getCellMeta(y,R).renderer:y.renderer;return typeof _=="string"?jk(_):tr(_)?jk("text"):_},this.getCellEditor=function(y,R){var _=typeof y=="number"?a.getCellMeta(y,R).editor:y.editor;return typeof _=="string"?pk(_):tr(_)?pk("text"):_},this.getCellValidator=function(y,R){var _=typeof y=="number"?a.getCellMeta(y,R).validator:y.validator;return typeof _=="string"?rEe(_):_},this.validateCells=function(y){this._validateCells(y)},this.validateRows=function(y,R){if(!Array.isArray(y))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(R,y)},this.validateColumns=function(y,R){if(!Array.isArray(y))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(R,void 0,y)},this._validateCells=function(y,R,_){var $=new x;y&&($.onQueueEmpty=y);for(var B=a.countRows()-1;B>=0;){if(R!==void 0&&R.indexOf(B)===-1){B-=1;continue}for(var W=a.countCols()-1;W>=0;){if(_!==void 0&&_.indexOf(W)===-1){W-=1;continue}$.addValidatorToQueue(),a.validateCell(a.getDataAtCell(B,W),a.getCellMeta(B,W),function(ee){if(typeof ee!="boolean")throw new Error("Validation error: result is not boolean");ee===!1&&($.valid=!1),$.removeValidatorFormQueue()},"validateCells"),W-=1}B-=1}$.checkIfQueueIsEmpty()},this.getRowHeader=function(y){var R=g.rowHeaders,_=y;return _!==void 0&&(_=a.runHooks("modifyRowHeader",_)),_===void 0?(R=[],Ye(a.countRows()-1,function($){R.push(a.getRowHeader($))})):Array.isArray(R)&&R[_]!==void 0?R=R[_]:sr(R)?R=R(_):R&&typeof R!="string"&&typeof R!="number"&&(R=_+1),R},this.hasRowHeaders=function(){return!!g.rowHeaders},this.hasColHeaders=function(){if(g.colHeaders!==void 0&&g.colHeaders!==null)return!!g.colHeaders;for(var y=0,R=a.countCols();y<R;y++)if(a.getColHeader(y))return!0;return!1},this.getColHeader=function(y){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,_=a.runHooks("modifyColHeader",y);if(_===void 0){for(var $=[],B=a.countCols(),W=0;W<B;W++)$.push(a.getColHeader(W));return $}var ee=g.colHeaders,J=function(D){for(var z=[],K=a.countCols(),le=0;le<K;le++)sr(g.columns)&&g.columns(le)&&z.push(le);return z[D]},he=a.toPhysicalColumn(_),re=J(he);return g.colHeaders===!1?ee=null:g.columns&&sr(g.columns)&&g.columns(re)&&g.columns(re).title?ee=g.columns(re).title:g.columns&&g.columns[he]&&g.columns[he].title?ee=g.columns[he].title:Array.isArray(g.colHeaders)&&g.colHeaders[he]!==void 0?ee=g.colHeaders[he]:sr(g.colHeaders)?ee=g.colHeaders(he):g.colHeaders&&typeof g.colHeaders!="string"&&typeof g.colHeaders!="number"&&(ee=C$e(_)),ee=a.runHooks("modifyColumnHeaderValue",ee,y,R),ee},this._getColWidthFromSettings=function(y){var R;if(y>=0){var _=a.getCellMeta(0,y);R=_.width}if((R===void 0||R===g.width)&&(R=g.colWidths),R!=null){switch(ni(R)){case"object":R=R[y];break;case"function":R=R(y);break}typeof R=="string"&&(R=parseInt(R,10))}return R},this.getColWidth=function(y){var R=a._getColWidthFromSettings(y);return R=a.runHooks("modifyColWidth",R,y),R===void 0&&(R=l3.DEFAULT_WIDTH),R},this._getRowHeightFromSettings=function(y){var R=g.rowHeights;if(R!=null){switch(ni(R)){case"object":R=R[y];break;case"function":R=R(y);break}typeof R=="string"&&(R=parseInt(R,10))}return R},this.getRowHeight=function(y){var R=a._getRowHeightFromSettings(y);return R=a.runHooks("modifyRowHeight",R,y),R},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){var y=g.maxCols,R=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(y,R)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=0;return ET(a.countRows()-1,function(_){if(a.isEmptyRow(_))R+=1;else if(y===!0)return!1}),R},this.countEmptyCols=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=0;return ET(a.countCols()-1,function(_){if(a.isEmptyCol(_))R+=1;else if(y===!0)return!1}),R},this.isEmptyRow=function(y){return g.isEmptyRow.call(a,y)},this.isEmptyCol=function(y){return g.isEmptyCol.call(a,y)},this.selectCell=function(y,R,_,$){var B=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,W=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return tr(y)||tr(R)?!1:this.selectCells([[y,R,_,$]],B,W)},this.selectCells=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;R===!1&&(o=!0);var $=A.selectCells(y);return $&&_&&a.listen(),o=!1,$},this.selectColumns=function(y){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y;return A.selectColumns(y,R)},this.selectRows=function(y){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y;return A.selectRows(y,R)},this.deselectCell=function(){A.deselect()},this.selectAll=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,R=y&&this.hasRowHeaders(),_=y&&this.hasColHeaders();o=!0,A.selectAll(R,_),o=!1};var q=function(R,_){return R.getNearestNotHiddenIndex(_,1,!0)};this.scrollViewportTo=function(y,R){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,$=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,B=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,W=!_,ee=!$,J=y,he=R;if(B){var re=Number.isInteger(y),T=Number.isInteger(R),D=re?q(this.rowIndexMapper,y):void 0,z=T?q(this.columnIndexMapper,R):void 0;if(D===null||z===null)return!1;J=re?a.rowIndexMapper.getRenderableFromVisualIndex(D):void 0,he=T?a.columnIndexMapper.getRenderableFromVisualIndex(z):void 0}var K=Number.isInteger(J),le=Number.isInteger(he);return K&&le?a.view.scrollViewport(a._createCellCoords(J,he),W,$,_,ee):K&&le===!1?a.view.scrollViewportVertically(J,W,_):le&&K===!1?a.view.scrollViewportHorizontally(he,$,ee):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),m.clearCache(),HO(a)){var y=this.rootDocument.querySelector(".hot-display-license-info");y&&y.parentNode.removeChild(y)}ua(a.rootElement),s.destroy(),f&&f.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),w.getItems().forEach(function(R){var _=Bo(R,2),$=_[1];$.destroy()}),w.clear(),a.runHooks("afterDestroy")},!0),Ue.getSingleton().destroy(a),Rt(a,function(R,_,$){sr(R)?$[_]=Z(_):_!=="guid"&&($[_]=null)}),a.isDestroyed=!0,l&&l.destroy(),a.rowIndexMapper=null,a.columnIndexMapper=null,l=null,c=null,A=null,f=null,a=null};function Z(y){return function(){throw new Error('The "'.concat(y,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return f.getActiveEditor()},this.getPlugin=function(y){var R=ms(y);return R==="UndoRedo"?this.undoRedo:w.getItem(R)},this.getPluginName=function(y){return y===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:w.getId(y)},this.getInstance=function(){return a},this.addHook=function(y,R){Ue.getSingleton().add(y,R,a)},this.hasHook=function(y){return Ue.getSingleton().has(y,a)||Ue.getSingleton().has(y)},this.addHookOnce=function(y,R){Ue.getSingleton().once(y,R,a)},this.removeHook=function(y,R){Ue.getSingleton().remove(y,R,a)},this.runHooks=function(y,R,_,$,B,W,ee){return Ue.getSingleton().run(a,y,R,_,$,B,W,ee)},this.getTranslatedPhrase=function(y,R){return KX(g.language,y,R)},this.toHTML=function(){return MD(n)},this.toTableElement=function(){var y=n.rootDocument.createElement("div");return y.insertAdjacentHTML("afterbegin",MD(n)),y.firstElementChild},this.timeouts=[],this._registerTimeout=function(y){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=y;typeof _=="function"&&(_=setTimeout(_,R)),this.timeouts.push(_)},this._clearTimeouts=function(){ae(this.timeouts,function(y){clearTimeout(y)})},this.immediates=[],this._registerImmediate=function(y){this.immediates.push(setImmediate(y))},this._clearImmediates=function(){ae(this.immediates,function(y){clearImmediate(y)})},this._refreshBorders=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;f.destroyEditor(y),a.view.render(),R&&A.isSelected()&&f.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var ne=iHe({handleEvent:function(R){var _=a.isListening(),$=(R==null?void 0:R.key)!==void 0;return _&&$},beforeKeyDown:function(R){return n.runHooks("beforeKeyDown",R)},afterKeyDown:function(R){n.isDestroyed||a.runHooks("afterDocumentKeyDown",R)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(y){y.ctrlKey===!1&&y.metaKey===!1&&ne.releasePressedKeys()}),this.getShortcutManager=function(){return ne};var ie=ne.addContext("grid"),P={runOnlyIf:function(){return He(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:fHe};ne.setActiveContextName("grid"),ie.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var R=a.getSelectedRange(),_=R[R.length-1].highlight,$=_.row,B=_.col,W=a.getDataAtCell($,B),ee=new Map,J=0;J<R.length;J++)R[J].forAll(function(he,re){if(he>=0&&re>=0&&(he!==$||re!==B)){var T=a.getCellMeta(he,re),D=T.readOnly;D||ee.set("".concat(he,"x").concat(re),[he,re,W])}});a.setDataAtCell(Array.from(ee.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){A.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){A.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){A.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var R=a.getSelectedRangeLast(),_=R.from,$=R.to,B=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);A.setRangeStart(_.clone()),A.setRangeEnd(a._createCellCoords(B,$.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){A.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){A.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){A.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var R=a.getSelectedRangeLast(),_=R.from,$=R.to,B=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);A.setRangeStart(_.clone()),A.setRangeEnd(a._createCellCoords(B,$.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){A.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var R,_=a.getSelectedRangeLast().highlight.row,$=(R=a.columnIndexMapper).getNearestNotHiddenIndex.apply(R,Qc(a.isRtl()?[a.countCols()-1,-1]:[0,1]));A.setRangeStart(a._createCellCoords(_,$))}},{keys:[["ArrowLeft","Shift"]],callback:function(){A.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var R,_=a.getSelectedRangeLast(),$=_.from,B=_.to,W=(R=a.columnIndexMapper).getNearestNotHiddenIndex.apply(R,Qc(a.isRtl()?[a.countCols()-1,-1]:[0,1]));A.setRangeStart($.clone()),A.setRangeEnd(a._createCellCoords(B.row,W))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){A.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var R,_=a.getSelectedRangeLast().highlight.row,$=(R=a.columnIndexMapper).getNearestNotHiddenIndex.apply(R,Qc(a.isRtl()?[0,1]:[a.countCols()-1,-1]));A.setRangeStart(a._createCellCoords(_,$))}},{keys:[["ArrowRight","Shift"]],callback:function(){A.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var R,_=a.getSelectedRangeLast(),$=_.from,B=_.to,W=(R=a.columnIndexMapper).getNearestNotHiddenIndex.apply(R,Qc(a.isRtl()?[0,1]:[a.countCols()-1,-1]));A.setRangeStart($.clone()),A.setRangeEnd(a._createCellCoords(B.row,W))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var R=parseInt(a.getSettings().fixedColumnsStart,10),_=a.getSelectedRangeLast().highlight.row,$=a.columnIndexMapper.getNearestNotHiddenIndex(R,1);A.setRangeStart(a._createCellCoords(_,$))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){A.setRangeEnd(a._createCellCoords(A.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var R=parseInt(a.getSettings().fixedRowsTop,10),_=parseInt(a.getSettings().fixedColumnsStart,10),$=a.rowIndexMapper.getNearestNotHiddenIndex(R,1),B=a.columnIndexMapper.getNearestNotHiddenIndex(_,1);A.setRangeStart(a._createCellCoords($,B))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){A.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){A.setRangeEnd(a._createCellCoords(A.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var R=parseInt(a.getSettings().fixedRowsBottom,10),_=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-R-1,-1),$=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);A.setRangeStart(a._createCellCoords(_,$))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){A.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var R=a.getSelectedRangeLast(),_=R.to,$=Math.max(_.row-a.countVisibleRows(),0),B=a.rowIndexMapper.getNearestNotHiddenIndex($,1);if(B!==null){var W=a._createCellCoords(B,_.col),ee=_.row-a.view.getFirstFullyVisibleRow(),J=Math.max(W.row-ee,0);A.setRangeEnd(W),a.scrollViewportTo(J)}}},{keys:[["PageDown"]],callback:function(){A.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var R=a.getSelectedRangeLast(),_=R.to,$=Math.min(_.row+a.countVisibleRows(),a.countRows()-1),B=a.rowIndexMapper.getNearestNotHiddenIndex($,-1);if(B!==null){var W=a._createCellCoords(B,_.col),ee=_.row-a.view.getFirstFullyVisibleRow(),J=Math.min(W.row-ee,a.countRows()-1);A.setRangeEnd(W),a.scrollViewportTo(J)}}},{keys:[["Tab"]],callback:function(R){var _=typeof g.tabMoves=="function"?g.tabMoves(R):g.tabMoves;A.transformStart(_.row,_.col,!0)}},{keys:[["Shift","Tab"]],callback:function(R){var _=typeof g.tabMoves=="function"?g.tabMoves(R):g.tabMoves;A.transformStart(-_.row,-_.col)}}],P),iq().forEach(function(y){var R=s3(y);w.addItem(y,new R(n))}),Ue.getSingleton().run(a,"construct")}function Qy(t){return Qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qy(t)}function kF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function $F(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kF(Object(r),!0).forEach(function(n){hHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hHe(t,e,r){return e=cQ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dHe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cQ(n.key),n)}}function pHe(t,e,r){return e&&LF(t.prototype,e),r&&LF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function cQ(t){var e=mHe(t,"string");return Qy(e)==="symbol"?e:String(e)}function mHe(t,e){if(Qy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Qy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var DF=215,fQ="menu",gHe=fQ,hQ=function(){function t(e,r){dHe(this,t),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:DF,container:this.hot.rootDocument.documentElement},this.eventManager=new Er(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return pHe(t,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(i){return r.onDocumentMouseDown(i)}),this.eventManager.addEventListener(n.document,"contextmenu",function(i){return r.onDocumentContextMenu(i)}),n=q2(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=xK(function(d){return r.openSubMenu(d)},300),i=this.options.minWidth||DF,o=!1,a=Ji(this.menuItems,function(d){return d.key===Ey&&(o=!0),FNe(d,r.hot)});if(a.length<1&&!o)a.push(AX()[Ey]);else if(a.length===0)return;a=UNe(a,vt);var s=!1,l={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(p){return He(p)&&p<i?i:p},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(p,m,g,v,w,b){return r.menuItemRenderer(p,m,g,v,w,b)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(p,m){r.isAllSubMenusClosed()?n(m.row):r.openSubMenu(m.row)},rowHeights:function(p){return a[p].name===vt?1:23},afterOnCellContextMenu:function(p){p.preventDefault(),WP()&&s&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(p){r.hasSelectedItem()&&(s=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(p))},afterOnCellMouseUp:function(p){(!WP()||!Gu(p))&&s&&r.hasSelectedItem()&&(na()||cK()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new ZI(this.container,l),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),c=u.addContext(gHe),f={group:fQ},h=$F($F({},f),{},{runOnlyIf:function(p){return Z2(p.target)===!1||r.container.contains(p.target)===!1}});u.setActiveContextName("menu"),c.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,p?r.selectNextCell(p[0],p[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,p?r.selectPrevCell(p[0],p[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var p=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,p){var m=r.openSubMenu(p[0]);m&&m.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,p&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(p){var m=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(m[0]).submenu||(r.executeCommand(p),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,p?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,p?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;!this.isOpened()||(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!kNe(n))return!1;var i=this.hotMenu.getSourceDataAtRow(r),o=new t(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(i.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=o,o}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),i=this.hotSubMenus[n.key];i&&(i.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;ae(this.hotMenu.getData(),function(n,i){return r.closeSubMenu(i)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var i=this.hot.getSelectedRange(),o=i?PNe(i):[];this.runLocalHooks("executeCommand",n.key,o,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,o,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,i=r.name,o=r.disabled,a=r.submenu,s=o===!0||typeof o=="function"&&o.call(this.hot)===!0;return n===!1||i===vt||s===!0||a}},{key:"setPosition",value:function(r){var n=new ike(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),o=i.right;n+=r.cellWidth+o-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),o=i.left;n-=r.left-o}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);x0(r)||M0(r)||N0(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);x0(n)||M0(n)||N0(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var i=r+1,o=i<this.hotMenu.countRows()?this.hotMenu.getCell(i,n):null;!o||(x0(o)||M0(o)||N0(o)?this.selectNextCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"selectPrevCell",value:function(r,n){var i=r-1,o=i>=0?this.hotMenu.getCell(i,n):null;!o||(x0(o)||M0(o)||N0(o)?this.selectPrevCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"menuItemRenderer",value:function(r,n,i,o,a,s){var l=this,u=r.getSourceDataAtRow(i),c=this.hot.rootDocument.createElement("div"),f=function(v){return Nr(v,"submenu")},h=function(v){return new RegExp(vt,"i").test(v.name)},d=function(v){return v.disabled===!0||typeof v.disabled=="function"&&v.disabled.call(l.hot)===!0},p=function(v){return v.disableSelection},m=s;typeof m=="function"&&(m=m.call(this.hot)),ua(n),_e(c,"htItemWrapper"),n.appendChild(c),h(u)?_e(n,"htSeparator"):typeof u.renderer=="function"?(_e(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,c,i,o,a,m))):Fp(c,m),d(u)?(_e(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):p(u)?(_e(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):f(u)?(_e(n,"htSubmenu"),p(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,o,void 0,void 0,!1,!1)})):(ut(n,["htSubmenu","htDisabled"]),p(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,o,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,i=r,o;return i&&(sr(i)&&(i=i.call(this.hot),i===null||tr(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i="".concat(this.options.className,"Sub_").concat(i),o=n.querySelector(".".concat(this.options.className,".").concat(i))),o||(o=n.createElement("div"),_e(o,"htMenu ".concat(this.options.className)),i&&_e(o,i),this.options.container.appendChild(o)),o}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,i=r.hider.style,o=r.holder.style,a=parseInt(i.width,10),s=Fn(n,function(l,u){return l+(u.name===vt?1:26)},0);o.width="".concat(a+3,"px"),o.height="".concat(s+3,"px"),i.height=o.height}},{key:"onAfterSelection",value:function(r,n,i,o,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(r){!this.isOpened()||(this.options.standalone&&this.hotMenu&&!Uu(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Uu(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){!this.isOpened()||at(r.target,"htCore")&&Uu(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),t}();ir(hQ,wi);const JI=hQ;function yd(t){return yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yd(t)}function yHe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function FF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bHe(n.key),n)}}function vHe(t,e,r){return e&&FF(t.prototype,e),r&&FF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function bHe(t){var e=wHe(t,"string");return yd(e)==="symbol"?e:String(e)}function wHe(t,e){if(yd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function du(){return typeof Reflect<"u"&&Reflect.get?du=Reflect.get.bind():du=function(e,r,n){var i=SHe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},du.apply(this,arguments)}function SHe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ya(t),t!==null););return t}function RHe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ZO(t,e)}function ZO(t,e){return ZO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ZO(t,e)}function EHe(t){var e=_He();return function(){var n=Ya(t),i;if(e){var o=Ya(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return CHe(this,i)}}function CHe(t,e){if(e&&(yd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dQ(t)}function dQ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _He(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ya(t){return Ya=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ya(t)}var F0="contextMenu",THe=70;Ue.getSingleton().register("afterContextMenuDefaultOptions");Ue.getSingleton().register("beforeContextMenuShow");Ue.getSingleton().register("afterContextMenuShow");Ue.getSingleton().register("afterContextMenuHide");Ue.getSingleton().register("afterContextMenuExecute");var pQ=function(t){RHe(r,t);var e=EHe(r);function r(n){var i;return yHe(this,r),i=e.call(this,n),i.eventManager=new Er(dQ(i)),i.commandExecutor=new _X(i.hot),i.itemsFactory=null,i.menu=null,i}return vHe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[F0]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[F0];typeof o.callback=="function"&&this.commandExecutor.setCommonCallback(o.callback),this.menu=new JI(this.hot,{className:"htContextMenu",keepInViewport:!0,container:o.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return(a=i.executeCommand).call.apply(a,[i].concat(l))}),this.addHook("afterOnCellContextMenu",function(a){return i.onAfterOnCellContextMenu(a)}),du(Ya(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),du(Ya(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),du(Ya(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(i){if(!!this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var o=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,c=l.left;o=u-Mg(i.view),a=c-dh(i.view)}else o=-1*Mg(this.menu.hotMenu.rootWindow),a=-1*dh(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(i.pageY,10)+o,left:parseInt(i.pageX,10)+a})}}},{key:"close",value:function(){!this.menu||(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(i){var o;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(o=this.commandExecutor).execute.apply(o,[i].concat(s))}},{key:"prepareMenuItems",value:function(){var i=this;this.itemsFactory=new IX(this.hot,r.DEFAULT_ITEMS);var o=this.hot.getSettings()[F0],a={items:this.itemsFactory.getItems(o)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var s=this.itemsFactory.getItems(o);this.hot.runHooks("beforeContextMenuSetItems",s),this.menu.setMenuItems(s),ae(s,function(l){return i.commandExecutor.registerCommand(l.key,l)})}},{key:"onAfterOnCellContextMenu",value:function(i){var o=this.hot.getSettings(),a=o.rowHeaders,s=o.colHeaders;function l(c){return c.nodeName==="TD"||c.parentNode.nodeName==="TD"}var u=i.target;this.close(),!at(u,"handsontableInput")&&(i.preventDefault(),i.stopPropagation(),!(!(a||s)&&!l(u)&&!(at(u,"current")&&at(u,"wtBorder")))&&this.open(i))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),du(Ya(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return F0}},{key:"PLUGIN_PRIORITY",get:function(){return THe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[k6,$6,vt,$1,L1,vt,P6,F1,vt,L6,x6,vt,D1,vt,Vi]}}]),r}(jt);pQ.SEPARATOR={name:vt};function OHe(t){return{key:"copy",name:function(){return this.getTranslatedPhrase(F3)},callback:function(){t.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function AHe(t){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(U3,n)},callback:function(){t.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function IHe(t){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(B3,n)},callback:function(){t.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function xHe(t){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(H3,n)},callback:function(){t.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function MHe(t){return{key:"cut",name:function(){return this.getTranslatedPhrase(V3)},callback:function(){t.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Zy(t){return Zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zy(t)}function NHe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function HF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,kHe(n.key),n)}}function PHe(t,e,r){return e&&HF(t.prototype,e),r&&HF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function kHe(t){var e=$He(t,"string");return Zy(e)==="symbol"?e:String(e)}function $He(t,e){if(Zy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Zy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var LHe=function(){function t(){NHe(this,t),this.data={}}return PHe(t,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),t}();function Jy(t){return Jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jy(t)}function BF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,FHe(n.key),n)}}function DHe(t,e,r){return e&&BF(t.prototype,e),r&&BF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function FHe(t){var e=HHe(t,"string");return Jy(e)==="symbol"?e:String(e)}function HHe(t,e){if(Jy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Jy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function BHe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var UHe=DHe(function t(){BHe(this,t),this.clipboardData=new LHe});function ev(t){return ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ev(t)}function VHe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function UF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,WHe(n.key),n)}}function jHe(t,e,r){return e&&UF(t.prototype,e),r&&UF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function WHe(t){var e=zHe(t,"string");return ev(e)==="symbol"?e:String(e)}function zHe(t,e){if(ev(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ev(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ex=function(){function t(e){VHe(this,t),this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new Er(this),this.listenersCount=new WeakSet,this.container=e}return jHe(t,[{key:"useSecondaryElement",value:function(){var r=KHe(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),VF(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),VF(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",na()||Twe(this.mainElement)}}]),t}();ir(ex,wi);var Lw=new WeakMap;function GHe(t){var e=new ex(t),r=Lw.get(t);return r=isNaN(r)?0:r,Lw.set(t,r+1),e}function YHe(t){t.eventManager.clear()}var rC=function(e,r){return function(n){return r.runLocalHooks(e,n)}};function VF(t,e,r){t.addEventListener(e,"copy",rC("copy",r)),t.addEventListener(e,"cut",rC("cut",r)),t.addEventListener(e,"paste",rC("paste",r))}var Dw=new WeakMap;function KHe(t){var e=Dw.get(t);if(e)return e.parentElement||t.appendChild(e),e;var r=t.defaultView?t:t.ownerDocument,n=r.createElement("textarea");return Dw.set(t,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",t.appendChild(n),n}function jF(t){if(t instanceof ex){var e=Lw.get(t.container);if(e=isNaN(e)?0:e,e>0&&(e-=1),YHe(t),e<=0){e=0;var r=Dw.get(t.container);r&&r.parentNode&&(r.parentNode.removeChild(r),Dw.delete(t.container)),t.mainElement=null}Lw.set(t.container,e)}}function tv(t){return tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tv(t)}function qHe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,QHe(n.key),n)}}function XHe(t,e,r){return e&&WF(t.prototype,e),r&&WF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function QHe(t){var e=ZHe(t,"string");return tv(e)==="symbol"?e:String(e)}function ZHe(t,e){if(tv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(tv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zF(t,e){mQ(t,e),e.add(t)}function Zc(t,e,r){mQ(t,e),e.set(t,r)}function mQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function H0(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}function jn(t,e){var r=gQ(t,e,"get");return JHe(t,r)}function JHe(t,e){return e.get?e.get.call(t):e.value}function Jc(t,e,r){var n=gQ(t,e,"set");return eBe(t,n,r),r}function gQ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function eBe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var ks=new WeakMap,nC=new WeakMap,gm=new WeakMap,JO=new WeakMap,e7=new WeakMap,ym=new WeakMap,B0=new WeakSet,GF=new WeakSet,tBe=function(){function t(e){var r=e.countRows,n=e.countColumns,i=e.rowsLimit,o=e.columnsLimit,a=e.countColumnHeaders;qHe(this,t),zF(this,GF),zF(this,B0),Zc(this,ks,{writable:!0,value:void 0}),Zc(this,nC,{writable:!0,value:void 0}),Zc(this,gm,{writable:!0,value:void 0}),Zc(this,JO,{writable:!0,value:void 0}),Zc(this,e7,{writable:!0,value:void 0}),Zc(this,ym,{writable:!0,value:void 0}),Jc(this,nC,r),Jc(this,gm,n),Jc(this,JO,i),Jc(this,e7,o),Jc(this,ym,a)}return XHe(t,[{key:"setSelectedRange",value:function(r){Jc(this,ks,r)}},{key:"getCellsRange",value:function(){if(jn(this,nC).call(this)===0||jn(this,gm).call(this)===0)return null;var r=jn(this,ks).getTopStartCorner(),n=r.row,i=r.col,o=jn(this,ks).getBottomEndCorner(),a=o.row,s=o.col,l=H0(this,GF,rBe).call(this,n,a),u=H0(this,B0,iC).call(this,i,s),c=a!==l||s!==u;return{isRangeTrimmed:c,startRow:n,startCol:i,endRow:l,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(jn(this,gm).call(this)===0||jn(this,ym).call(this)===0)return null;var r=jn(this,ks).getTopStartCorner(),n=r.col,i=jn(this,ks).getBottomEndCorner(),o=i.col,a=H0(this,B0,iC).call(this,n,o),s=o!==a;return{isRangeTrimmed:s,startRow:-1,startCol:n,endRow:-1,endCol:a}}},{key:"getAllColumnHeadersRange",value:function(){if(jn(this,gm).call(this)===0||jn(this,ym).call(this)===0)return null;var r=jn(this,ks).getTopStartCorner(),n=r.col,i=jn(this,ks).getBottomEndCorner(),o=i.col,a=H0(this,B0,iC).call(this,n,o),s=o!==a;return{isRangeTrimmed:s,startRow:-jn(this,ym).call(this),startCol:n,endRow:-1,endCol:a}}}]),t}();function iC(t,e){return Math.min(e,Math.max(t+jn(this,e7).call(this)-1,t))}function rBe(t,e){return Math.min(e,Math.max(t+jn(this,JO).call(this)-1,t))}function yQ(t){var e=[],r=[];return ae(t,function(n){var i=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);Ye(i,o,function(l){e.indexOf(l)===-1&&e.push(l)});var a=Math.min(n.startCol,n.endCol),s=Math.max(n.startCol,n.endCol);Ye(a,s,function(l){r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function nBe(t,e){return sBe(t)||aBe(t,e)||oBe(t,e)||iBe()}function iBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oBe(t,e){if(!!t){if(typeof t=="string")return YF(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YF(t,e)}}function YF(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function aBe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function sBe(t){if(Array.isArray(t))return t}function ic(t){return ic=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ic(t)}function lBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function KF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bQ(n.key),n)}}function uBe(t,e,r){return e&&KF(t.prototype,e),r&&KF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function pu(){return typeof Reflect<"u"&&Reflect.get?pu=Reflect.get.bind():pu=function(e,r,n){var i=cBe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},pu.apply(this,arguments)}function cBe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ka(t),t!==null););return t}function fBe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&t7(t,e)}function t7(t,e){return t7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},t7(t,e)}function hBe(t){var e=pBe();return function(){var n=Ka(t),i;if(e){var o=Ka(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return dBe(this,i)}}function dBe(t,e){if(e&&(ic(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vn(t)}function Vn(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ka(t){return Ka=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ka(t)}function mBe(t,e){vQ(t,e),e.add(t)}function Ul(t,e,r){vQ(t,e),e.set(t,r)}function vQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ef(t,e,r){return e=bQ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bQ(t){var e=gBe(t,"string");return ic(e)==="symbol"?e:String(e)}function gBe(t,e){if(ic(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ic(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yBe(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}function Ri(t,e){var r=wQ(t,e,"get");return vBe(t,r)}function vBe(t,e){return e.get?e.get.call(t):e.value}function Ca(t,e,r){var n=wQ(t,e,"set");return bBe(t,n,r),r}function wQ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function bBe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}Ue.getSingleton().register("afterCopyLimit");Ue.getSingleton().register("modifyCopyableRange");Ue.getSingleton().register("beforeCut");Ue.getSingleton().register("afterCut");Ue.getSingleton().register("beforePaste");Ue.getSingleton().register("afterPaste");Ue.getSingleton().register("beforeCopy");Ue.getSingleton().register("afterCopy");var U0="copyPaste",wBe=80,SBe=["fragmentSelection"],qF=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),oC=new WeakMap,aC=new WeakMap,sC=new WeakMap,tf=new WeakMap,V0=new WeakMap,j0=new WeakMap,rf=new WeakMap,XF=new WeakSet,RBe=function(t){fBe(r,t);var e=hBe(r);function r(){var n;lBe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),mBe(Vn(n),XF),ef(Vn(n),"columnsLimit",1/0),ef(Vn(n),"rowsLimit",1/0),ef(Vn(n),"pasteMode","overwrite"),ef(Vn(n),"uiContainer",n.hot.rootDocument.body),Ul(Vn(n),oC,{writable:!0,value:!1}),Ul(Vn(n),aC,{writable:!0,value:!1}),Ul(Vn(n),sC,{writable:!0,value:!1}),Ul(Vn(n),tf,{writable:!0,value:"cells-only"}),Ul(Vn(n),V0,{writable:!0,value:!1}),Ul(Vn(n),j0,{writable:!0,value:!1}),Ul(Vn(n),rf,{writable:!0,value:new tBe({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),ef(Vn(n),"copyableRanges",[]),ef(Vn(n),"focusableElement",void 0),n}return uBe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[U0]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),a=o[U0];if(ic(a)==="object"){var s,l;this.pasteMode=(s=a.pasteMode)!==null&&s!==void 0?s:this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,Ca(this,oC,!!a.copyColumnHeaders),Ca(this,aC,!!a.copyColumnGroupHeaders),Ca(this,sC,!!a.copyColumnHeadersOnly),this.uiContainer=(l=a.uiContainer)!==null&&l!==void 0?l:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return i.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return i.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return i.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return i.onBeforeKeyDown()}),this.focusableElement=GHe(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return i.onCopy(u)}).addLocalHook("cut",function(u){return i.onCut(u)}).addLocalHook("paste",function(u){return i.onPaste(u)}),pu(Ka(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),pu(Ka(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&jF(this.focusableElement),pu(Ka(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Ca(this,tf,i),Ca(this,V0,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Ca(this,j0,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(i){return ig(this.getRangedData(i))}},{key:"getRangedData",value:function(i){var o=this,a=[],s=yQ(i),l=s.rows,u=s.columns;return ae(l,function(c){var f=[];ae(u,function(h){c<0?f.push(o.hot.getColHeader(h,c)):f.push(o.hot.getCopyableData(c,h))}),a.push(f)}),a}},{key:"paste",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;if(!(!i&&!o)){var a=new UHe;i&&a.clipboardData.setData("text/plain",i),o&&a.clipboardData.setData("text/html",o),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var i=this.hot.getSelectedRangeLast();if(!!i){Ri(this,rf).setSelectedRange(i);var o=new Map([["headers",null],["cells",null]]);Ri(this,tf)==="column-headers-only"?o.set("headers",Ri(this,rf).getMostBottomColumnHeadersRange()):(Ri(this,tf)==="with-column-headers"?o.set("headers",Ri(this,rf).getMostBottomColumnHeadersRange()):Ri(this,tf)==="with-column-group-headers"&&o.set("headers",Ri(this,rf).getAllColumnHeadersRange()),o.set("cells",Ri(this,rf).getCellsRange())),this.copyableRanges=Array.from(o.values()).filter(function(f){return f!==null}).map(function(f){var h=f.startRow,d=f.startCol,p=f.endRow,m=f.endCol;return{startRow:h,startCol:d,endRow:p,endCol:m}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var a=o.get("cells");if(a!==null&&a.isRangeTrimmed){var s=a.startRow,l=a.startCol,u=a.endRow,c=a.endCol;this.hot.runHooks("afterCopyLimit",u-s+1,c-l+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var i,o=(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.TEXTAREA;o?this.focusableElement.setFocusableElement(o):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var i;return(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.isOpened()}},{key:"populateValues",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!!i.length){for(var a=i.length,s=i[0].length,l=[],u=o.getTopStartCorner(),c=u.row,f=u.col,h=o.getBottomEndCorner(),d=h.row,p=h.col,m=c,g=f,v=c,w=f;l.length<a||m<=d;){var b=this.hot.getCellMeta(m,f),E=b.skipRowOnPaste,A=b.visualRow;if(m=A+1,E!==!0){v=A,g=f;for(var M=[],k=l.length%a;M.length<s||g<=p;){var O=this.hot.getCellMeta(c,g),x=O.skipColumnOnPaste,C=O.visualCol;if(g=C+1,x!==!0){w=C;var I=M.length%s;M.push(i[k][I])}}l.push(M)}}return this.hot.populateFromArray(c,f,l,void 0,void 0,"CopyPaste.paste",this.pasteMode),[c,f,v,w]}}},{key:"onCopy",value:function(i){if(!(!this.hot.isListening()&&!Ri(this,V0)||this.isEditorOpened())){this.setCopyableText(),Ca(this,V0,!1);var o=this.getRangedData(this.copyableRanges),a=yBe(this,XF,EBe).call(this,this.copyableRanges),s=!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a);if(s){var l=ig(o);if(i&&i.clipboardData){var u=ND(o,this.hot.rootDocument);i.clipboardData.setData("text/plain",l),i.clipboardData.setData("text/html",[qF,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,a)}Ca(this,tf,"cells-only"),i.preventDefault()}}},{key:"onCut",value:function(i){if(!(!this.hot.isListening()&&!Ri(this,j0)||this.isEditorOpened())){this.setCopyableText(),Ca(this,j0,!1);var o=this.getRangedData(this.copyableRanges),a=!!this.hot.runHooks("beforeCut",o,this.copyableRanges);if(a){var s=ig(o);if(i&&i.clipboardData){var l=ND(o,this.hot.rootDocument);i.clipboardData.setData("text/plain",s),i.clipboardData.setData("text/html",[qF,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}i.preventDefault()}}},{key:"onPaste",value:function(i){if(!(!this.hot.isListening()||this.isEditorOpened())){i&&i.preventDefault&&i.preventDefault();var o;if(i&&typeof i.clipboardData<"u"){var a=j8(i.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var s=i$e(a,this.hot.rootDocument);o=s.data}else o=i.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=FDe(o)),!(o&&o.length===0)&&this.hot.runHooks("beforePaste",o,this.copyableRanges)!==!1){var l=this.populateValues(o),u=nBe(l,4),c=u[0],f=u[1],h=u[2],d=u[3];this.hot.selectCell(c,f,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:"---------"},OHe(this)),Ri(this,oC)&&i.items.push(xHe(this)),Ri(this,aC)&&i.items.push(IHe(this)),Ri(this,sC)&&i.items.push(AHe(this)),i.items.push(MHe(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&Rwe())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var i=this.hot.rootDocument.activeElement,o=this.hot.getActiveEditor();!o||i!==this.focusableElement.getFocusableElement()&&i!==o.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(jF(this.focusableElement),this.focusableElement=null),pu(Ka(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return U0}},{key:"SETTING_KEYS",get:function(){return[U0].concat(SBe)}},{key:"PLUGIN_PRIORITY",get:function(){return wBe}}]),r}(jt);function EBe(t){for(var e=yQ(t),r=e.rows,n=0,i=0;i<r.length&&!(r[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function SQ(t,e){return"border_row".concat(t,"col").concat(e)}function Hm(){return{width:1,color:"#000"}}function qa(){return{hide:!0}}function CBe(){return{width:1,color:"#000",cornerVisible:!1}}function lC(t){if(He(t.start)||He(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(He(t.end)||He(t.right)){var r;t.end=(r=t.end)!==null&&r!==void 0?r:t.right}return delete t.left,delete t.right,t}function vm(t){return He(t.start)&&(t.left=t.start),He(t.end)&&(t.right=t.end),t}function uC(t,e){return{id:SQ(t,e),border:CBe(),row:t,col:e,top:qa(),bottom:qa(),start:qa(),end:qa()}}function _Be(t,e){return Nr(e,"border")&&e.border&&(t.border=e.border),Nr(e,"top")&&He(e.top)&&(e.top?(St(e.top)||(e.top=Hm()),t.top=e.top):(e.top=qa(),t.top=e.top)),Nr(e,"bottom")&&He(e.bottom)&&(e.bottom?(St(e.bottom)||(e.bottom=Hm()),t.bottom=e.bottom):(e.bottom=qa(),t.bottom=e.bottom)),Nr(e,"start")&&He(e.start)&&(e.start?(St(e.start)||(e.start=Hm()),t.start=e.start):(e.start=qa(),t.start=e.start)),Nr(e,"end")&&He(e.end)&&(e.end?(St(e.end)||(e.end=Hm()),t.end=e.end):(e.end=qa(),t.end=e.end)),t}function Ss(t,e){var r=!1;return ae(t.getSelectedRange(),function(n){n.forAll(function(i,o){if(!(i<0||o<0)){var a=t.getCellMeta(i,o).borders;if(a)if(e){if(!Nr(a[e],"hide")||a[e].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function U6(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function TBe(t){return t.some(function(e){return He(e.left)||He(e.right)})}function OBe(t){return t.some(function(e){return He(e.start)||He(e.end)})}var ABe=new Map([["left","start"],["right","end"]]);function IBe(t){var e;return(e=ABe.get(t))!==null&&e!==void 0?e:t}function xBe(t){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(lI),n=Ss(this,"bottom");return n&&(r=U6(r)),r},callback:function(r,n){var i=Ss(this,"bottom");t.prepareBorder(n,"bottom",i)}}}function MBe(t){var e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(uI),i=Ss(this,e);return i&&(n=U6(n)),n},callback:function(n,i){var o=Ss(this,e);t.prepareBorder(i,e,o)}}}function NBe(t){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(cI)},callback:function(r,n){t.prepareBorder(n,"noBorders")},disabled:function(){return!Ss(this)}}}function PBe(t){var e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(sI),i=Ss(this,e);return i&&(n=U6(n)),n},callback:function(n,i){var o=Ss(this,e);t.prepareBorder(i,e,o)}}}function kBe(t){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(aI),n=Ss(this,"top");return n&&(r=U6(r)),r},callback:function(r,n){var i=Ss(this,"top");t.prepareBorder(n,"top",i)}}}function vd(t){return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vd(t)}function QF(t,e){return FBe(t)||DBe(t,e)||LBe(t,e)||$Be()}function $Be(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LBe(t,e){if(!!t){if(typeof t=="string")return ZF(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZF(t,e)}}function ZF(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function DBe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function FBe(t){if(Array.isArray(t))return t}function HBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function JF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,EQ(n.key),n)}}function BBe(t,e,r){return e&&JF(t.prototype,e),r&&JF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mu(){return typeof Reflect<"u"&&Reflect.get?mu=Reflect.get.bind():mu=function(e,r,n){var i=UBe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},mu.apply(this,arguments)}function UBe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Xa(t),t!==null););return t}function VBe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r7(t,e)}function r7(t,e){return r7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},r7(t,e)}function jBe(t){var e=zBe();return function(){var n=Xa(t),i;if(e){var o=Xa(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return WBe(this,i)}}function WBe(t,e){if(e&&(vd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RQ(t)}function RQ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xa(t){return Xa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xa(t)}function GBe(t,e,r){return e=EQ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EQ(t){var e=YBe(t,"string");return vd(e)==="symbol"?e:String(e)}function YBe(t,e){if(vd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var W0="customBorders",KBe=90,qBe=function(t){VBe(r,t);var e=jBe(r);function r(){var n;HBe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),GBe(RQ(n),"savedBorders",[]),n}return BBe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[W0]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(o){return i.onAfterContextMenuDefaultOptions(o)}),this.addHook("init",function(){return i.onAfterInit()}),mu(Xa(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),mu(Xa(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),mu(Xa(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(i,o){var a=this,s=["top","bottom","start","end"],l=null;o&&(this.checkSettingsCohesion([o]),s=Object.keys(o),l=lC(o));var u=dd(i),c=Ry(u);ae(i,function(f){for(var h=c(f),d=QF(h,4),p=d[0],m=d[1],g=d[2],v=d[3],w=function(A){for(var M=function(x){ae(s,function(C){a.prepareBorderFromCustomAdded(A,x,l,IBe(C))})},k=m;k<=v;k+=1)M(k)},b=p;b<=g;b+=1)w(b)}),this.hot.view.render()}},{key:"getBorders",value:function(i){var o=this;if(!Array.isArray(i))return this.savedBorders;var a=dd(i),s=Ry(a),l=[];return ae(i,function(u){for(var c=s(u),f=QF(c,4),h=f[0],d=f[1],p=f[2],m=f[3],g=function(b){for(var E=function(k){ae(o.savedBorders,function(O){O.row===b&&O.col===k&&l.push(vm(O))})},A=d;A<=m;A+=1)E(A)},v=h;v<=p;v+=1)g(v)}),l}},{key:"clearBorders",value:function(i){var o=this;i?this.setBorders(i):(ae(this.savedBorders,function(a){o.clearBordersFromSelectionSettings(a.id),o.clearNullCellRange(),o.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(i,o){var a=this.checkSavedBorders(i);a||this.savedBorders.push(i);var s=this.hot._createCellRange(this.hot._createCellCoords(i.row,i.col)),l=this.checkCustomSelections(i,s,o);l||this.hot.selection.highlight.addCustomSelection({border:i,visualCellRange:s})}},{key:"prepareBorderFromCustomAdded",value:function(i,o,a,s){var l=this.hot.countRows(),u=this.hot.countCols();if(!(i>=l||o>=u)){var c=uC(i,o);a&&(c=_Be(c,a),ae(this.hot.selection.highlight.customSelections,function(f){if(c.id===f.settings.id)return Object.assign(f.settings,a),c.id=f.settings.id,c.top=f.settings.top,c.bottom=f.settings.bottom,c.start=f.settings.start,c.end=f.settings.end,!1})),this.hot.setCellMeta(i,o,"borders",vm(c)),this.insertBorderIntoSettings(c,s)}}},{key:"prepareBorderFromCustomAddedRange",value:function(i,o){var a=this,s=Math.min(i.to.row,this.hot.countRows()-1),l=Math.min(i.to.col,this.hot.countCols()-1);Ye(i.from.row,s,function(u){Ye(i.from.col,l,function(c){var f=uC(u,c),h=0;u===i.from.row&&Nr(o,"top")&&(h+=1,f.top=o.top),u===i.to.row&&Nr(o,"bottom")&&(h+=1,f.bottom=o.bottom),c===i.from.col&&Nr(o,"start")&&(h+=1,f.start=o.start),c===i.to.col&&Nr(o,"end")&&(h+=1,f.end=o.end),h>0&&(a.hot.setCellMeta(u,c,"borders",vm(f)),a.insertBorderIntoSettings(f))})})}},{key:"removeAllBorders",value:function(i,o){var a=SQ(i,o);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(i,o,"borders")}},{key:"setBorder",value:function(i,o,a,s){var l=this.hot.getCellMeta(i,o).borders;if(!l||l.border===void 0?l=uC(i,o):l=lC(l),s){l[a]=qa();var u=this.countHide(l);if(u===4)this.removeAllBorders(i,o);else{var c=this.checkCustomSelectionsFromContextMenu(l,a,s);c||this.insertBorderIntoSettings(l),this.hot.setCellMeta(i,o,"borders",vm(l))}}else{l[a]=Hm();var f=this.checkCustomSelectionsFromContextMenu(l,a,s);f||this.insertBorderIntoSettings(l),this.hot.setCellMeta(i,o,"borders",vm(l))}}},{key:"prepareBorder",value:function(i,o,a){var s=this;ae(i,function(l){var u=l.start,c=l.end;if(u.row===c.row&&u.col===c.col)o==="noBorders"?s.removeAllBorders(u.row,u.col):s.setBorder(u.row,u.col,o,a);else switch(o){case"noBorders":Ye(u.col,c.col,function(f){Ye(u.row,c.row,function(h){s.removeAllBorders(h,f)})});break;case"top":Ye(u.col,c.col,function(f){s.setBorder(u.row,f,o,a)});break;case"bottom":Ye(u.col,c.col,function(f){s.setBorder(c.row,f,o,a)});break;case"start":Ye(u.row,c.row,function(f){s.setBorder(f,u.col,o,a)});break;case"end":Ye(u.row,c.row,function(f){s.setBorder(f,c.col,o,a)});break}})}},{key:"createCustomBorders",value:function(i){var o=this;ae(i,function(a){var s=lC(a);a.range?o.prepareBorderFromCustomAddedRange(a.range,s):o.prepareBorderFromCustomAdded(a.row,a.col,s)})}},{key:"countHide",value:function(i){var o=i.top,a=i.bottom,s=i.start,l=i.end,u=[o,a,s,l];return Fn(u,function(c,f){var h=c;return f&&f.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(i){var o=wt(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(i);o>-1&&this.hot.selection.highlight.customSelections[o].clear()}},{key:"clearNullCellRange",value:function(){var i=this;ae(this.hot.selection.highlight.customSelections,function(o,a){if(o.cellRange===null)return i.hot.selection.highlight.customSelections[a].destroy(),i.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var i=this;ae(this.savedBorders,function(o){i.clearBordersFromSelectionSettings(o.id),i.clearNullCellRange()})}},{key:"spliceBorder",value:function(i){var o=wt(this.savedBorders,function(a){return a.id}).indexOf(i);o>-1&&this.savedBorders.splice(o,1)}},{key:"checkSavedBorders",value:function(i){var o=this,a=!1,s=this.countHide(i);return s===4?(this.spliceBorder(i.id),a=!0):ae(this.savedBorders,function(l,u){if(i.id===l.id)return o.savedBorders[u]=i,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(i,o,a){var s=!1;return ae(this.hot.selection.highlight.customSelections,function(l){if(i.id===l.settings.id)return Rt(l.instanceBorders,function(u){u.toggleHiddenClass(o,a)}),s=!0,!1}),s}},{key:"checkCustomSelections",value:function(i,o,a){var s=this.countHide(i),l=!1;return s===4?(this.removeAllBorders(i.row,i.col),l=!0):ae(this.hot.selection.highlight.customSelections,function(u){if(i.id===u.settings.id)return u.visualCellRange=o,u.commit(),a&&Rt(u.instanceBorders,function(c){c.changeBorderStyle(a,i)}),l=!0,!1}),l}},{key:"changeBorderSettings",value:function(){var i=this.hot.getSettings()[W0];if(Array.isArray(i)){var o=Qn(i);this.checkSettingsCohesion(o),o.length||(this.savedBorders=o),this.createCustomBorders(o)}else i!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(i){var o=TBe(i),a=OBe(i);if(o&&a)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&o)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(i){!this.hot.getSettings()[W0]||i.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(oI)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[kBe(this),PBe(this),xBe(this),MBe(this),NBe(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){mu(Xa(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return W0}},{key:"PLUGIN_PRIORITY",get:function(){return KBe}}]),r}(jt);function bd(t){return bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bd(t)}function XBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ZBe(n.key),n)}}function QBe(t,e,r){return e&&eH(t.prototype,e),r&&eH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZBe(t){var e=JBe(t,"string");return bd(e)==="symbol"?e:String(e)}function JBe(t,e){if(bd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gu(){return typeof Reflect<"u"&&Reflect.get?gu=Reflect.get.bind():gu=function(e,r,n){var i=eUe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},gu.apply(this,arguments)}function eUe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Qa(t),t!==null););return t}function tUe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&n7(t,e)}function n7(t,e){return n7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},n7(t,e)}function rUe(t){var e=iUe();return function(){var n=Qa(t),i;if(e){var o=Qa(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return nUe(this,i)}}function nUe(t,e){if(e&&(bd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CQ(t)}function CQ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function iUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qa(t){return Qa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qa(t)}var tH="dragToScroll",oUe=100,aUe=function(t){tUe(r,t);var e=rUe(r);function r(n){var i;return XBe(this,r),i=e.call(this,n),i.eventManager=new Er(CQ(i)),i.boundaries=null,i.callback=null,i.listening=!1,i}return QBe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[tH]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(o){return i.setupListening(o)}),this.addHook("afterOnCellCornerMouseDown",function(o){return i.setupListening(o)}),this.registerEvents(),gu(Qa(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),gu(Qa(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),gu(Qa(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(i){this.boundaries=i}},{key:"setCallback",value:function(i){this.callback=i}},{key:"check",value:function(i,o){var a=0,s=0;o<this.boundaries.top?s=o-this.boundaries.top:o>this.boundaries.bottom&&(s=o-this.boundaries.bottom),i<this.boundaries.left?a=i-this.boundaries.left:i>this.boundaries.right&&(a=i-this.boundaries.right),this.callback(a,s)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var i=this,o=this.hot.rootWindow,a=o;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return i.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return i.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(s){return i.onMouseMove(s)}),a=q2(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(i){if(!Gu(i)){var o=this.hot.view._wt.wtTable.holder;o!==this.hot.rootWindow&&(this.setBoundaries(o.getBoundingClientRect()),this.setCallback(function(a,s){a<0?o.scrollLeft-=50:a>0&&(o.scrollLeft+=50),s<0?o.scrollTop-=20:s>0&&(o.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(i){!this.isListening()||this.check(i.clientX,i.clientY)}},{key:"destroy",value:function(){gu(Qa(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return tH}},{key:"PLUGIN_PRIORITY",get:function(){return oUe}}]),r}(jt);function wd(t){return wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wd(t)}function sUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,uUe(n.key),n)}}function lUe(t,e,r){return e&&rH(t.prototype,e),r&&rH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function uUe(t){var e=cUe(t,"string");return wd(e)==="symbol"?e:String(e)}function cUe(t,e){if(wd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yu(){return typeof Reflect<"u"&&Reflect.get?yu=Reflect.get.bind():yu=function(e,r,n){var i=fUe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},yu.apply(this,arguments)}function fUe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Za(t),t!==null););return t}function hUe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i7(t,e)}function i7(t,e){return i7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},i7(t,e)}function dUe(t){var e=mUe();return function(){var n=Za(t),i;if(e){var o=Za(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return pUe(this,i)}}function pUe(t,e){if(e&&(wd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Q(t)}function _Q(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function mUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Za(t){return Za=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Za(t)}Ue.getSingleton().register("afterDropdownMenuDefaultOptions");Ue.getSingleton().register("beforeDropdownMenuShow");Ue.getSingleton().register("afterDropdownMenuShow");Ue.getSingleton().register("afterDropdownMenuHide");Ue.getSingleton().register("afterDropdownMenuExecute");var cC="dropdownMenu",gUe=230,fC="changeType",TQ=function(t){hUe(r,t);var e=dUe(r);function r(n){var i;return sUe(this,r),i=e.call(this,n),i.eventManager=new Er(_Q(i)),i.commandExecutor=new _X(i.hot),i.itemsFactory=null,i.menu=null,i.hot.addHook("afterGetColHeader",function(o,a){return i.onAfterGetColHeader(o,a)}),i}return lUe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[cC]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.itemsFactory=new IX(this.hot,r.DEFAULT_ITEMS);var o=this.hot.getSettings()[cC],a={items:this.itemsFactory.getItems(o)};this.registerEvents(),typeof o.callback=="function"&&this.commandExecutor.setCommonCallback(o.callback),yu(Za(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){i.hot.runHooks("afterDropdownMenuDefaultOptions",a),i.itemsFactory.setPredefinedItems(a.items);var s=i.itemsFactory.getItems(o);i.menu&&i.menu.destroy(),i.menu=new JI(i.hot,{className:"htDropdownMenu",keepInViewport:!0,container:o.uiContainer||i.hot.rootDocument.body}),i.hot.runHooks("beforeDropdownMenuSetItems",s),i.menu.setMenuItems(s),i.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),i.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),i.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),i.menu.addLocalHook("executeCommand",function(){for(var l,u=arguments.length,c=new Array(u),f=0;f<u;f++)c[f]=arguments[f];return(l=i.executeCommand).call.apply(l,[i].concat(c))}),ae(s,function(l){return i.commandExecutor.registerCommand(l.key,l)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),yu(Za(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),yu(Za(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(o){return i.onTableClick(o)})}},{key:"open",value:function(i){!this.menu||(this.menu.open(),i.width&&this.menu.setOffset("left",i.width),this.menu.setPosition(i))}},{key:"close",value:function(){!this.menu||this.menu.close()}},{key:"executeCommand",value:function(i){for(var o,a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(o=this.commandExecutor).execute.apply(o,[i].concat(s))}},{key:"setListening",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(i?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(i){if(i.stopPropagation(),at(i.target,fC)&&!this.menu.isOpened()){var o=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,c=l.left;o=u,a=c}var f=i.target.getBoundingClientRect();this.open({left:f.left+a,top:f.top+i.target.offsetHeight+3+o,width:f.width,height:f.height})}}},{key:"onAfterGetColHeader",value:function(i,o){var a=o.parentNode;if(!!a){var s=a.parentNode.childNodes,l=Array.prototype.indexOf.call(s,a);if(!(i<0||l!==s.length-1)){var u=o.querySelector(".".concat(fC));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var c=this.hot.rootDocument.createElement("button");c.className=fC,c.type="button",c.onclick=function(){return!1},o.firstChild.insertBefore(c,o.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),yu(Za(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return cC}},{key:"PLUGIN_PRIORITY",get:function(){return gUe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[$1,L1,vt,F1,vt,I6,vt,D1,vt,Vi]}}]),r}(jt);TQ.SEPARATOR={name:vt};function rv(t){return rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rv(t)}function yUe(t,e){return SUe(t)||wUe(t,e)||bUe(t,e)||vUe()}function vUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bUe(t,e){if(!!t){if(typeof t=="string")return nH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nH(t,e)}}function nH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function wUe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function SUe(t){if(Array.isArray(t))return t}function RUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,CUe(n.key),n)}}function EUe(t,e,r){return e&&iH(t.prototype,e),r&&iH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function CUe(t){var e=_Ue(t,"string");return rv(e)==="symbol"?e:String(e)}function _Ue(t,e){if(rv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(rv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var TUe=function(){function t(e){RUe(this,t),this.hot=e,this.options={}}return EUe(t,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),i=n.startRow,o=n.startCol,a=n.endRow,s=n.endCol,l=this.options,u=[];return Ye(i,a,function(c){var f=[];!l.exportHiddenRows&&r._isHiddenRow(c)||(Ye(o,s,function(h){!l.exportHiddenColumns&&r._isHiddenColumn(h)||f.push(r.hot.getDataAtCell(c,h))}),u.push(f))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var i=this._getDataRange(),o=i.startRow,a=i.endRow,s=this.hot.getRowHeader();Ye(o,a,function(l){!r.options.exportHiddenRows&&r._isHiddenRow(l)||n.push(s[l])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var i=this._getDataRange(),o=i.startCol,a=i.endCol,s=this.hot.getColHeader();Ye(o,a,function(l){!r.options.exportHiddenColumns&&r._isHiddenColumn(l)||n.push(s[l])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,i=yUe(this.options.range,4),o=i[0],a=o===void 0?0:o,s=i[1],l=s===void 0?0:s,u=i[2],c=u===void 0?n:u,f=i[3],h=f===void 0?r:f;return a=Math.max(a,0),l=Math.max(l,0),c=Math.min(c,n),h=Math.min(h,r),{startRow:a,startCol:l,endRow:c,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),t}();const OUe=TUe;function nv(t){return nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nv(t)}function AUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xUe(n.key),n)}}function IUe(t,e,r){return e&&oH(t.prototype,e),r&&oH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function xUe(t){var e=MUe(t,"string");return nv(e)==="symbol"?e:String(e)}function MUe(t,e){if(nv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(nv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var NUe=function(){function t(e,r){AUe(this,t),this.dataProvider=e,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return IUe(t,[{key:"_mergeOptions",value:function(r){var n=hi(this.constructor.DEFAULT_OPTIONS),i=new Date;return n=Jr(hi(t.DEFAULT_OPTIONS),n),n=Jr(n,r),n.filename=RK(n.filename,{YYYY:i.getFullYear(),MM:"".concat(i.getMonth()+1).padStart(2,"0"),DD:"".concat(i.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),t}();const PUe=NUe;function Sd(t){return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sd(t)}function kUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,LUe(n.key),n)}}function $Ue(t,e,r){return e&&aH(t.prototype,e),r&&aH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function LUe(t){var e=DUe(t,"string");return Sd(e)==="symbol"?e:String(e)}function DUe(t,e){if(Sd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FUe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o7(t,e)}function o7(t,e){return o7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},o7(t,e)}function HUe(t){var e=VUe();return function(){var n=Fw(t),i;if(e){var o=Fw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return BUe(this,i)}}function BUe(t,e){if(e&&(Sd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UUe(t)}function UUe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function VUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fw(t){return Fw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fw(t)}var jUe=String.fromCharCode(13),WUe=String.fromCharCode(34),zUe=String.fromCharCode(10),GUe=function(t){FUe(r,t);var e=HUe(r);function r(){return kUe(this,r),e.apply(this,arguments)}return $Ue(r,[{key:"export",value:function(){var i=this,o=this.options,a=this.dataProvider.getData(),s=this.dataProvider.getColumnHeaders(),l=s.length>0,u=this.dataProvider.getRowHeaders(),c=u.length>0,f=o.bom?String.fromCharCode(65279):"";return l&&(s=wt(s,function(h){return i._escapeCell(h,!0)}),c&&(f+=o.columnDelimiter),f+=s.join(o.columnDelimiter),f+=o.rowDelimiter),ae(a,function(h,d){d>0&&(f+=o.rowDelimiter),c&&(f+=i._escapeCell(u[d])+o.columnDelimiter),f+=h.map(function(p){return i._escapeCell(p)}).join(o.columnDelimiter)}),f}},{key:"_escapeCell",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=Vr(i);return a!==""&&(o||a.indexOf(jUe)>=0||a.indexOf(WUe)>=0||a.indexOf(zUe)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(PUe);const YUe=GUe;function iv(t){return iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iv(t)}function KUe(t,e,r){return e=qUe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qUe(t){var e=XUe(t,"string");return iv(e)==="symbol"?e:String(e)}function XUe(t,e){if(iv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(iv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var QUe="csv",a7=KUe({},QUe,YUe);function ZUe(t,e,r){return typeof a7[t]=="function"?new a7[t](e,r):null}function Rd(t){return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rd(t)}function JUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tVe(n.key),n)}}function eVe(t,e,r){return e&&sH(t.prototype,e),r&&sH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function tVe(t){var e=rVe(t,"string");return Rd(e)==="symbol"?e:String(e)}function rVe(t,e){if(Rd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nVe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s7(t,e)}function s7(t,e){return s7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},s7(t,e)}function iVe(t){var e=sVe();return function(){var n=Hw(t),i;if(e){var o=Hw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return oVe(this,i)}}function oVe(t,e){if(e&&(Rd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aVe(t)}function aVe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hw(t){return Hw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hw(t)}var lVe="exportFile",uVe=240,cVe=function(t){nVe(r,t);var e=iVe(r);function r(){return JUe(this,r),e.apply(this,arguments)}return eVe(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(i,o).export()}},{key:"exportAsBlob",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(i,o))}},{key:"downloadFile",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,s=a.rootDocument,l=a.rootWindow,u=this._createTypeFormatter(i,o),c=this._createBlob(u),f=l.URL||l.webkitURL,h=s.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var p=f.createObjectURL(c);h.style.display="none",h.setAttribute("href",p),h.setAttribute("download",d),s.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),s.body.removeChild(h),setTimeout(function(){f.revokeObjectURL(p)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(c,d)}},{key:"_createTypeFormatter",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!a7[i])throw new Error('Export format type "'.concat(i,'" is not supported.'));return ZUe(i,new OUe(this.hot),o)}},{key:"_createBlob",value:function(i){var o=null;return typeof Blob<"u"&&(o=new Blob([i.export()],{type:"".concat(i.options.mimeType,";charset=").concat(i.options.encoding)})),o}}],[{key:"PLUGIN_KEY",get:function(){return lVe}},{key:"PLUGIN_PRIORITY",get:function(){return uVe}}]),r}(jt);function ov(t){return ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ov(t)}function fVe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dVe(n.key),n)}}function hVe(t,e,r){return e&&lH(t.prototype,e),r&&lH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dVe(t){var e=pVe(t,"string");return ov(e)==="symbol"?e:String(e)}function pVe(t,e){if(ov(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ov(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var OQ=function(){function t(e,r){var n=r.id,i=r.stateless,o=i===void 0?!0:i;fVe(this,t),this.hot=e,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=o?null:this.hot.columnIndexMapper.registerMap(this.stateId,new _6)}return hVe(t,[{key:"reset",value:function(){ae(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),ae(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),t}();ir(OQ,wi);const V6=OQ;var av={};function gl(t,e){if(!av[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));var r=av[t],n=r.condition,i=r.descriptor,o=e;return i.inputValuesDecorator&&(o=i.inputValuesDecorator(o)),function(a){return n.apply(a.meta.instance,[].concat([a],[o]))}}function vu(t){if(!av[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));return av[t].descriptor}function Yr(t,e,r){r.key=t,av[t]={condition:e,descriptor:r}}var fn="none";function mVe(){return!0}Yr(fn,mVe,{name:O6,inputsCount:0,showOperators:!1});var og="empty";function gVe(t){return on(t.value)}Yr(og,gVe,{name:yI,inputsCount:0,showOperators:!0});var a2="not_empty";function yVe(t,e){return!gl(og,e)(t)}Yr(a2,yVe,{name:vI,inputsCount:0,showOperators:!0});function vVe(t,e){return RVe(t)||SVe(t,e)||wVe(t,e)||bVe()}function bVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wVe(t,e){if(!!t){if(typeof t=="string")return uH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uH(t,e)}}function uH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function SVe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function RVe(t){if(Array.isArray(t))return t}var ag="eq";function EVe(t,e){var r=vVe(e,1),n=r[0];return Vr(t.value).toLocaleLowerCase(t.meta.locale)===Vr(n)}Yr(ag,EVe,{name:bI,inputsCount:1,showOperators:!0});var s2="neq";function CVe(t,e){return!gl(ag,e)(t)}Yr(s2,CVe,{name:wI,inputsCount:1,showOperators:!0});function _Ve(t,e){return IVe(t)||AVe(t,e)||OVe(t,e)||TVe()}function TVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OVe(t,e){if(!!t){if(typeof t=="string")return cH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cH(t,e)}}function cH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function AVe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function IVe(t){if(Array.isArray(t))return t}var AQ="gt";function xVe(t,e){var r=_Ve(e,1),n=r[0],i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}Yr(AQ,xVe,{name:_I,inputsCount:1,showOperators:!0});function MVe(t,e){return $Ve(t)||kVe(t,e)||PVe(t,e)||NVe()}function NVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PVe(t,e){if(!!t){if(typeof t=="string")return fH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fH(t,e)}}function fH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function kVe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function $Ve(t){if(Array.isArray(t))return t}var IQ="gte";function LVe(t,e){var r=MVe(e,1),n=r[0],i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}Yr(IQ,LVe,{name:TI,inputsCount:1,showOperators:!0});function DVe(t,e){return UVe(t)||BVe(t,e)||HVe(t,e)||FVe()}function FVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HVe(t,e){if(!!t){if(typeof t=="string")return hH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hH(t,e)}}function hH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function BVe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function UVe(t){if(Array.isArray(t))return t}var xQ="lt";function VVe(t,e){var r=DVe(e,1),n=r[0],i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}Yr(xQ,VVe,{name:OI,inputsCount:1,showOperators:!0});function jVe(t,e){return YVe(t)||GVe(t,e)||zVe(t,e)||WVe()}function WVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zVe(t,e){if(!!t){if(typeof t=="string")return dH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dH(t,e)}}function dH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function GVe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function YVe(t){if(Array.isArray(t))return t}var MQ="lte";function KVe(t,e){var r=jVe(e,1),n=r[0],i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}Yr(MQ,KVe,{name:AI,inputsCount:1,showOperators:!0});function qVe(t,e){return JVe(t)||ZVe(t,e)||QVe(t,e)||XVe()}function XVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QVe(t,e){if(!!t){if(typeof t=="string")return pH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pH(t,e)}}function pH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ZVe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function JVe(t){if(Array.isArray(t))return t}var tx="date_after";function eje(t,e){var r=qVe(e,1),n=r[0],i=qt(t.value,t.meta.dateFormat),o=qt(n,t.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)>=0}Yr(tx,eje,{name:MI,inputsCount:1,showOperators:!0});function tje(t,e){return oje(t)||ije(t,e)||nje(t,e)||rje()}function rje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nje(t,e){if(!!t){if(typeof t=="string")return mH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mH(t,e)}}function mH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ije(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function oje(t){if(Array.isArray(t))return t}var rx="date_before";function aje(t,e){var r=tje(e,1),n=r[0],i=qt(t.value,t.meta.dateFormat),o=qt(n,t.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)<=0}Yr(rx,aje,{name:NI,inputsCount:1,showOperators:!0});function sje(t,e){return fje(t)||cje(t,e)||uje(t,e)||lje()}function lje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uje(t,e){if(!!t){if(typeof t=="string")return gH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gH(t,e)}}function gH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function cje(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function fje(t){if(Array.isArray(t))return t}var Bw="between";function hje(t,e){var r=sje(e,2),n=r[0],i=r[1],o=n,a=i;if(t.meta.type==="numeric"){var s=parseFloat(o,10),l=parseFloat(a,10);o=Math.min(s,l),a=Math.max(s,l)}else if(t.meta.type==="date"){var u=gl(rx,[a]),c=gl(tx,[o]);return u(t)&&c(t)}return t.value>=o&&t.value<=a}Yr(Bw,hje,{name:II,inputsCount:2,showOperators:!0});var NQ="not_between";function dje(t,e){return!gl(Bw,e)(t)}Yr(NQ,dje,{name:xI,inputsCount:2,showOperators:!0});function pje(t,e){return vje(t)||yje(t,e)||gje(t,e)||mje()}function mje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gje(t,e){if(!!t){if(typeof t=="string")return yH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yH(t,e)}}function yH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function yje(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function vje(t){if(Array.isArray(t))return t}var PQ="begins_with";function bje(t,e){var r=pje(e,1),n=r[0];return Vr(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Vr(n))}Yr(PQ,bje,{name:SI,inputsCount:1,showOperators:!0});var wje=tt,kQ=y1,Sje=ya.f,Rje=wc,vH=Gr,Eje=L8,Cje=vi,_je=D8,bH=kQ("".endsWith),Tje=kQ("".slice),Oje=Math.min,$Q=_je("endsWith"),Aje=!$Q&&!!function(){var t=Sje(String.prototype,"endsWith");return t&&!t.writable}();wje({target:"String",proto:!0,forced:!Aje&&!$Q},{endsWith:function(e){var r=vH(Cje(this));Eje(e);var n=arguments.length>1?arguments[1]:void 0,i=r.length,o=n===void 0?i:Oje(Rje(n),i),a=vH(e);return bH?bH(r,a,o):Tje(r,o-a.length,o)===a}});function Ije(t,e){return Pje(t)||Nje(t,e)||Mje(t,e)||xje()}function xje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mje(t,e){if(!!t){if(typeof t=="string")return wH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wH(t,e)}}function wH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Nje(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function Pje(t){if(Array.isArray(t))return t}var LQ="ends_with";function kje(t,e){var r=Ije(e,1),n=r[0];return Vr(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Vr(n))}Yr(LQ,kje,{name:RI,inputsCount:1,showOperators:!0});function $je(t,e){return Hje(t)||Fje(t,e)||Dje(t,e)||Lje()}function Lje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dje(t,e){if(!!t){if(typeof t=="string")return SH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SH(t,e)}}function SH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Fje(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function Hje(t){if(Array.isArray(t))return t}var nx="contains";function Bje(t,e){var r=$je(e,1),n=r[0];return Vr(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Vr(n))>=0}Yr(nx,Bje,{name:EI,inputsCount:1,showOperators:!0});var DQ="not_contains";function Uje(t,e){return!gl(nx,e)(t)}Yr(DQ,Uje,{name:CI,inputsCount:1,showOperators:!0});var FQ="date_tomorrow";function Vje(t){var e=qt(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(qt().subtract(-1,"days").startOf("day"),"d"):!1}Yr(FQ,Vje,{name:kI,inputsCount:0});var HQ="date_today";function jje(t){var e=qt(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(qt().startOf("day"),"d"):!1}Yr(HQ,jje,{name:PI,inputsCount:0});var BQ="date_yesterday";function Wje(t){var e=qt(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(qt().subtract(1,"days").startOf("day"),"d"):!1}Yr(BQ,Wje,{name:$I,inputsCount:0});L2e();function zje(t,e){var r=t;return r===""&&(r="(".concat(e,")")),r}var l7=new Set([1]).has(1),Gje=l7&&typeof Array.from=="function";function B1(t){var e=t;return l7&&(e=new Set(e)),function(r){var n;return l7?n=e.has(r):n=!!~e.indexOf(r),n}}function UQ(t){return t==null?"":t}function u7(t){var e=t;return Gje?e=Array.from(new Set(e)):e=oK(e),e=e.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),e}function RH(t,e,r,n){var i=[],o=t===e,a;return o||(a=B1(e)),ae(t,function(s){var l=!1;(o||a(s))&&(l=!0);var u={checked:l,value:s,visualValue:zje(s,r)};n&&n(u),i.push(u)}),i}function VQ(t,e){return Xje(t)||qje(t,e)||Kje(t,e)||Yje()}function Yje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kje(t,e){if(!!t){if(typeof t=="string")return EH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EH(t,e)}}function EH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function qje(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function Xje(t){if(Array.isArray(t))return t}var bu="by_value";function Qje(t,e){var r=VQ(e,1),n=r[0];return n(t.value)}Yr(bu,Qje,{name:"By value",inputsCount:0,inputValuesDecorator:function(e){var r=VQ(e,1),n=r[0];return[B1(n)]},showOperators:!1});var sv={};function Zje(t){if(!sv[t])throw Error('Operation with id "'.concat(t,'" does not exist.'));var e=sv[t].func;return function(r,n){return e(r,n)}}function Jje(t){return sv[t].name}function ix(t,e,r){sv[t]={name:e,func:r}}var il="conjunction",eWe=FI;function tWe(t,e){return t.every(function(r){return r.func(e)})}ix(il,eWe,tWe);var Uw="disjunction",rWe=A6;function nWe(t,e){return t.some(function(r){return r.func(e)})}ix(Uw,rWe,nWe);var ox="disjunctionWithExtraCondition",iWe=A6;function oWe(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(function(r){return r.func(e)})&&t[t.length-1].func(e)}ix(ox,iWe,oWe);function lv(t){return lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lv(t)}var bm;function hC(t,e,r){return e=aWe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aWe(t){var e=sWe(t,"string");return lv(e)==="symbol"?e:String(e)}function sWe(t,e){if(lv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(lv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lWe="numeric",jQ="text",uWe="date",CH=(bm={},hC(bm,lWe,[fn,vt,og,a2,vt,ag,s2,vt,AQ,IQ,xQ,MQ,Bw,NQ]),hC(bm,jQ,[fn,vt,og,a2,vt,ag,s2,vt,PQ,LQ,vt,nx,DQ]),hC(bm,uWe,[fn,vt,og,a2,vt,ag,s2,vt,rx,tx,Bw,vt,FQ,HQ,BQ]),bm);function cWe(t){var e=[],r=t;return CH[r]||(r=jQ),ae(CH[r],function(n){var i;n===vt?i={name:vt}:i=hi(vu(n)),e.push(i)}),e}function uv(t){return uv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uv(t)}function fWe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _H(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dWe(n.key),n)}}function hWe(t,e,r){return e&&_H(t.prototype,e),r&&_H(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dWe(t){var e=pWe(t,"string");return uv(e)==="symbol"?e:String(e)}function pWe(t,e){if(uv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(uv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var dC="built",pC="building",TH=["click","input","keydown","keypress","keyup","focus","blur","change"],WQ=function(){function t(e,r){fWe(this,t),this.hot=e,this.eventManager=new Er(this),this.options=Jr(t.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return hWe(t,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===pC?this._element:this.buildState===dC?(this.update(),this._element):(this.buildState=pC,this.build(),this.buildState=dC,this._element)}},{key:"isBuilt",value:function(){return this.buildState===dC}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(ei)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(a,s){r.eventManager.addEventListener(a,s,function(l){return r.runLocalHooks(s,l,r)})};if(this.buildState||(this.buildState=pC),this.options.className&&_e(this._element,this.options.className),this.options.children.length)ae(this.options.children,function(o){return r._element.appendChild(o.element)});else if(this.options.wrapIt){var i=this.hot.rootDocument.createElement(this.options.tagName);Rt(this.options,function(o,a){i[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(i[a]=r.translateIfPossible(o))}),this._element.appendChild(i),ae(TH,function(o){return n(i,o)})}else ae(TH,function(o){return n(r._element,o)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return hi({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),t}();ir(WQ,wi);const ol=WQ;function Ed(t){return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ed(t)}function mWe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yWe(n.key),n)}}function gWe(t,e,r){return e&&OH(t.prototype,e),r&&OH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function yWe(t){var e=vWe(t,"string");return Ed(e)==="symbol"?e:String(e)}function vWe(t,e){if(Ed(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function l2(){return typeof Reflect<"u"&&Reflect.get?l2=Reflect.get.bind():l2=function(e,r,n){var i=bWe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},l2.apply(this,arguments)}function bWe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Cd(t),t!==null););return t}function wWe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c7(t,e)}function c7(t,e){return c7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},c7(t,e)}function SWe(t){var e=EWe();return function(){var n=Cd(t),i;if(e){var o=Cd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return RWe(this,i)}}function RWe(t,e){if(e&&(Ed(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zQ(t)}function zQ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function EWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cd(t){return Cd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cd(t)}var z0=new WeakMap,CWe=function(t){wWe(r,t);var e=SWe(r);function r(n,i){var o;return mWe(this,r),o=e.call(this,n,Jr(r.DEFAULTS,i)),z0.set(zQ(o),{}),o.registerHooks(),o}return gWe(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()}),this.addLocalHook("keyup",function(o){return i.onKeyup(o)})}},{key:"build",value:function(){l2(Cd(r.prototype),"build",this).call(this);var i=z0.get(this),o=this.hot.rootDocument.createElement("div");i.input=this._element.firstChild,_e(this._element,"htUIInput"),_e(o,"htUIInputIcon"),this._element.appendChild(o),this.update()}},{key:"update",value:function(){if(!!this.isBuilt()){var i=z0.get(this).input;i.type=this.options.type,i.placeholder=this.translateIfPossible(this.options.placeholder),i.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&z0.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(i){this.options.value=i.target.value}}],[{key:"DEFAULTS",get:function(){return hi({placeholder:"",type:"text",tagName:"input"})}}]),r}(ol);const Gf=CWe;function _d(t){return _d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_d(t)}function _We(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,OWe(n.key),n)}}function TWe(t,e,r){return e&&AH(t.prototype,e),r&&AH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function OWe(t){var e=AWe(t,"string");return _d(e)==="symbol"?e:String(e)}function AWe(t,e){if(_d(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(_d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yf(){return typeof Reflect<"u"&&Reflect.get?Yf=Reflect.get.bind():Yf=function(e,r,n){var i=IWe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Yf.apply(this,arguments)}function IWe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=al(t),t!==null););return t}function xWe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f7(t,e)}function f7(t,e){return f7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},f7(t,e)}function MWe(t){var e=PWe();return function(){var n=al(t),i;if(e){var o=al(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return NWe(this,i)}}function NWe(t,e){if(e&&(_d(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GQ(t)}function GQ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function al(t){return al=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},al(t)}var G0=new WeakMap,kWe=function(t){xWe(r,t);var e=MWe(r);function r(n,i){var o;return _We(this,r),o=e.call(this,n,Jr(r.DEFAULTS,i)),G0.set(GQ(o),{}),o.menu=null,o.items=[],o.registerHooks(),o}return TWe(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()})}},{key:"setItems",value:function(i){this.items=this.translateNames(i),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(i){var o=this;return ae(i,function(a){a.name=o.translateIfPossible(a.name)}),i}},{key:"build",value:function(){var i=this;Yf(al(r.prototype),"build",this).call(this),this.menu=new JI(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var o=new ol(this.hot,{className:"htUISelectCaption"}),a=new ol(this.hot,{className:"htUISelectDropdown"}),s=G0.get(this);s.caption=o,s.captionElement=o.element,s.dropdown=a,ae([o,a],function(l){return i._element.appendChild(l.element)}),this.menu.addLocalHook("select",function(l){return i.onMenuSelect(l)}),this.menu.addLocalHook("afterClose",function(){return i.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(!!this.isBuilt()){var i;this.options.value?i=this.options.value.name:i=this.menu.hot.getTranslatedPhrase(O6),G0.get(this).captionElement.textContent=i,Yf(al(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var i=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?i.left-5:i.left-31,top:i.top-1,width:i.width,height:i.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(i){i.name!==vt&&(this.options.value=i,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var i=G0.get(this),o=i.caption,a=i.dropdown;o&&o.destroy(),a&&a.destroy(),Yf(al(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return hi({className:"htUISelect",wrapIt:!1})}}]),r}(ol);const IH=kWe;function Td(t){return Td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Td(t)}function $We(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,DWe(n.key),n)}}function LWe(t,e,r){return e&&xH(t.prototype,e),r&&xH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function DWe(t){var e=FWe(t,"string");return Td(e)==="symbol"?e:String(e)}function FWe(t,e){if(Td(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function u2(){return typeof Reflect<"u"&&Reflect.get?u2=Reflect.get.bind():u2=function(e,r,n){var i=HWe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},u2.apply(this,arguments)}function HWe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Od(t),t!==null););return t}function BWe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h7(t,e)}function h7(t,e){return h7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},h7(t,e)}function UWe(t){var e=WWe();return function(){var n=Od(t),i;if(e){var o=Od(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return VWe(this,i)}}function VWe(t,e){if(e&&(Td(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jWe(t)}function jWe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function WWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Od(t){return Od=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Od(t)}var zWe=function(t){BWe(r,t);var e=UWe(r);function r(n,i){var o;return $We(this,r),o=e.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.addSeparator=i.addSeparator,o.elements.push(new IH(o.hot,{menuContainer:i.menuContainer})),o.elements.push(new Gf(o.hot,{placeholder:WI})),o.elements.push(new Gf(o.hot,{placeholder:zI})),o.registerHooks(),o}return LWe(r,[{key:"registerHooks",value:function(){var i=this;this.getSelectElement().addLocalHook("select",function(o){return i.onConditionSelect(o)}),this.getSelectElement().addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),ae(this.getInputElements(),function(o){o.addLocalHook("keydown",function(a){return i.onInputKeyDown(a)})})}},{key:"setState",value:function(i){var o=this;if(this.reset(),!!i){var a=hi(i.command);a.name.startsWith(Cr)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),ae(i.args,function(s,l){if(l>a.inputsCount-1)return!1;var u=o.getInputElement(l);u.setValue(s),u[a.inputsCount>l?"show":"hide"](),l||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var i=this.getSelectElement().getValue()||vu(fn),o=[];return ae(this.getInputElements(),function(a,s){i.inputsCount>s&&o.push(a.getValue())}),{command:i,args:o}}},{key:"updateState",value:function(i,o){var a=vu(i?i.name:fn);this.state.setValueAtIndex(o,{command:a,args:i?i.args:[]}),i||ae(this.getInputElements(),function(s){return s.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof IH})[0]}},{key:"getInputElement",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[i]}},{key:"getInputElements",value:function(){return this.elements.filter(function(i){return i instanceof Gf})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(a,s,l,u,c,f){_e(s.parentNode,"htFiltersMenuCondition"),i.addSeparator&&_e(s.parentNode,"border");var h=i.hot.rootDocument.createElement("div");return _e(h,"htFiltersMenuLabel"),h.textContent=f,s.appendChild(h),s.parentNode.hasAttribute("ghost-table")||ae(i.elements,function(d){return s.appendChild(d.element)}),s}}}},{key:"reset",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn(),o=[vu(fn)];if(i!==null){var a=i.visualIndex;o=cWe(this.hot.getDataType(0,a,this.hot.countRows(),a))}ae(this.getInputElements(),function(s){return s.hide()}),this.getSelectElement().setItems(o),u2(Od(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(o[0])}},{key:"onConditionSelect",value:function(i){ae(this.getInputElements(),function(o,a){o[i.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return o.focus()},10)}),this.runLocalHooks("change",i)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(i){Ig(i.keyCode,"ENTER")?(this.runLocalHooks("accept"),la(i)):Ig(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),la(i))}}]),r}(V6);const mC=zWe;function Ad(t){return Ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ad(t)}function GWe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function MH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,KWe(n.key),n)}}function YWe(t,e,r){return e&&MH(t.prototype,e),r&&MH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function KWe(t){var e=qWe(t,"string");return Ad(e)==="symbol"?e:String(e)}function qWe(t,e){if(Ad(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function c2(){return typeof Reflect<"u"&&Reflect.get?c2=Reflect.get.bind():c2=function(e,r,n){var i=XWe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},c2.apply(this,arguments)}function XWe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Id(t),t!==null););return t}function QWe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d7(t,e)}function d7(t,e){return d7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},d7(t,e)}function ZWe(t){var e=eze();return function(){var n=Id(t),i;if(e){var o=Id(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return JWe(this,i)}}function JWe(t,e){if(e&&(Ad(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YQ(t)}function YQ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Id(t){return Id=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Id(t)}var Y0=new WeakMap,tze=function(t){QWe(r,t);var e=ZWe(r);function r(n,i){var o;return GWe(this,r),o=e.call(this,n,Jr(r.DEFAULTS,i)),Y0.set(YQ(o),{}),o}return YWe(r,[{key:"build",value:function(){c2(Id(r.prototype),"build",this).call(this);var i=Y0.get(this);i.input=this._element.firstChild;var o=this.hot.rootDocument.createElement("label");o.textContent=this.translateIfPossible(this.options.label.textContent),o.htmlFor=this.translateIfPossible(this.options.label.htmlFor),i.label=o,this._element.appendChild(o),this.update()}},{key:"update",value:function(){if(!!this.isBuilt()){var i=Y0.get(this);i.input.checked=this.options.checked,i.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=i,this.update()}},{key:"focus",value:function(){this.isBuilt()&&Y0.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return hi({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(ol);const NH=tze;function xd(t){return xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xd(t)}var PH;function rze(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function nze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oze(n.key),n)}}function ize(t,e,r){return e&&kH(t.prototype,e),r&&kH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function oze(t){var e=aze(t,"string");return xd(e)==="symbol"?e:String(e)}function aze(t,e){if(xd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(xd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sze(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p7(t,e)}function p7(t,e){return p7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},p7(t,e)}function lze(t){var e=fze();return function(){var n=Vw(t),i;if(e){var o=Vw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return uze(this,i)}}function uze(t,e){if(e&&(xd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cze(t)}function cze(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vw(t){return Vw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vw(t)}var $H=0,hze=function(t){sze(r,t);var e=lze(r);function r(n,i){var o;return nze(this,r),o=e.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.buildOperatorsElement(),o}return ize(r,[{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(a,s){return _e(s.parentNode,"htFiltersMenuOperators"),s.parentNode.hasAttribute("ghost-table")||ae(i.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"buildOperatorsElement",value:function(){var i=this,o=[il,Uw];ae(o,function(a){var s=new NH(i.hot,{name:"operator",label:{htmlFor:a,textContent:Jje(a)},value:a,checked:a===o[$H],id:a});s.addLocalHook("change",function(l){return i.onRadioInputChange(l)}),i.elements.push(s)})}},{key:"setChecked",value:function(i){if(this.elements.length<i)throw Error(Gt(PH||(PH=rze(["Radio button with index "," doesn't exist."])),i));ae(this.elements,function(o,a){o.setChecked(a===i)})}},{key:"getActiveOperationId",value:function(){var i=this.elements.find(function(o){return o instanceof NH&&o.isChecked()});return i?i.getValue():il}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(i){this.reset(),i&&this.getActiveOperationId()!==i&&ae(this.elements,function(o){o.setChecked(o.getValue()===i)})}},{key:"updateState",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:il,o=arguments.length>1?arguments[1]:void 0,a=i;a===ox&&(a=Uw),this.state.setValueAtIndex(o,a)}},{key:"reset",value:function(){this.setChecked($H)}},{key:"onRadioInputChange",value:function(i){this.setState(i.target.value)}}]),r}(V6);const dze=hze;var pze=mt,mze=vi,LH=Gr,gze=/"/g,yze=pze("".replace),vze=function(t,e,r,n){var i=LH(mze(t)),o="<"+e;return r!==""&&(o+=" "+r+'="'+yze(LH(n),gze,"&quot;")+'"'),o+">"+i+"</"+e+">"},bze=dt,wze=function(t){return bze(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})},Sze=tt,Rze=vze,Eze=wze;Sze({target:"String",proto:!0,forced:Eze("link")},{link:function(e){return Rze(this,"a","href",e)}});function Md(t){return Md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Md(t)}function Cze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function DH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tze(n.key),n)}}function _ze(t,e,r){return e&&DH(t.prototype,e),r&&DH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tze(t){var e=Oze(t,"string");return Md(e)==="symbol"?e:String(e)}function Oze(t,e){if(Md(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function f2(){return typeof Reflect<"u"&&Reflect.get?f2=Reflect.get.bind():f2=function(e,r,n){var i=Aze(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},f2.apply(this,arguments)}function Aze(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Nd(t),t!==null););return t}function Ize(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m7(t,e)}function m7(t,e){return m7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},m7(t,e)}function xze(t){var e=Nze();return function(){var n=Nd(t),i;if(e){var o=Nd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Mze(this,i)}}function Mze(t,e){if(e&&(Md(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KQ(t)}function KQ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Nze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nd(t){return Nd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Nd(t)}var gC=new WeakMap,Pze=function(t){Ize(r,t);var e=xze(r);function r(n,i){var o;return Cze(this,r),o=e.call(this,n,Jr(r.DEFAULTS,i)),gC.set(KQ(o),{}),o}return _ze(r,[{key:"build",value:function(){f2(Nd(r.prototype),"build",this).call(this);var i=gC.get(this);i.link=this._element.firstChild}},{key:"update",value:function(){!this.isBuilt()||(gC.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return hi({href:"#",tagName:"a"})}}]),r}(ol);const FH=Pze;function Pd(t){return Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pd(t)}function HH(t){return Dze(t)||Lze(t)||$ze(t)||kze()}function kze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ze(t,e){if(!!t){if(typeof t=="string")return g7(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g7(t,e)}}function Lze(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Dze(t){if(Array.isArray(t))return g7(t)}function g7(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Fze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function BH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Bze(n.key),n)}}function Hze(t,e,r){return e&&BH(t.prototype,e),r&&BH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Bze(t){var e=Uze(t,"string");return Pd(e)==="symbol"?e:String(e)}function Uze(t,e){if(Pd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kf(){return typeof Reflect<"u"&&Reflect.get?Kf=Reflect.get.bind():Kf=function(e,r,n){var i=Vze(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Kf.apply(this,arguments)}function Vze(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=sl(t),t!==null););return t}function jze(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y7(t,e)}function y7(t,e){return y7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},y7(t,e)}function Wze(t){var e=Gze();return function(){var n=sl(t),i;if(e){var o=sl(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return zze(this,i)}}function zze(t,e){if(e&&(Pd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qQ(t)}function qQ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sl(t){return sl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sl(t)}var Yze=new WeakMap,Kze="multipleSelect.itemBox",qze=function(t){jze(r,t);var e=Wze(r);function r(n,i){var o;return Fze(this,r),o=e.call(this,n,Jr(r.DEFAULTS,i)),Yze.set(qQ(o),{}),o.searchInput=new Gf(o.hot,{placeholder:jI,className:"htUIMultipleSelectSearch"}),o.selectAllUI=new FH(o.hot,{textContent:HI,className:"htUISelectAll"}),o.clearAllUI=new FH(o.hot,{textContent:BI,className:"htUIClearAll"}),o.items=[],o.itemsBox=null,o.registerHooks(),o}return Hze(r,[{key:"registerHooks",value:function(){var i=this;this.searchInput.addLocalHook("keydown",function(o){return i.onInputKeyDown(o)}),this.searchInput.addLocalHook("input",function(o){return i.onInput(o)}),this.selectAllUI.addLocalHook("click",function(o){return i.onSelectAllClick(o)}),this.clearAllUI.addLocalHook("click",function(o){return i.onClearAllClick(o)})}},{key:"setItems",value:function(i){this.items=i,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(i){this.locale=i}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return HH(this.items)}},{key:"getValue",value:function(){return Qze(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var i=this;Kf(sl(r.prototype),"build",this).call(this);var o=this.hot.rootDocument,a=o.createElement("div"),s=new ol(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(s.element),this._element.appendChild(a);var l=function(c){if(!!i._element){i.itemsBox&&i.itemsBox.destroy(),_e(c,"htUIMultipleSelectHot"),i.itemsBox=new i.hot.constructor(c,{data:i.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(p,m,g,v,w,b){p.title=b.instance.getDataAtRowProp(m,b.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return i.itemsBox.container.scrollWidth-gn(o)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:i.hot.isRtl()?"rtl":"ltr"}),i.itemsBox.init();var f=i.itemsBox.getShortcutManager(),h=f.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(p){i.runLocalHooks("keydown",p,i)},group:Kze})}};l(a),setTimeout(function(){return l(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){!this.isBuilt()||(this.itemsBox.loadData(Xze(this.items,this.options.value)),Kf(sl(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,Kf(sl(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(i){var o=this,a=i.target.value.toLocaleLowerCase(this.getLocale()),s;a===""?s=HH(this.items):s=Ji(this.items,function(l){return"".concat(l.value).toLocaleLowerCase(o.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(s)}},{key:"onInputKeyDown",value:function(i){this.runLocalHooks("keydown",i,this);var o=MK(Ig,i.keyCode);o("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(la(i),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(i){var o=[];i.preventDefault(),ae(this.itemsBox.getSourceData(),function(a,s){a.checked=!0,o.push(UD(a,s)[0])}),this.itemsBox.setSourceDataAtCell(o)}},{key:"onClearAllClick",value:function(i){var o=[];i.preventDefault(),ae(this.itemsBox.getSourceData(),function(a,s){a.checked=!1,o.push(UD(a,s)[0])}),this.itemsBox.setSourceDataAtCell(o)}}],[{key:"DEFAULTS",get:function(){return hi({className:"htUIMultipleSelect",value:[]})}}]),r}(ol);const UH=qze;function Xze(t,e){var r=B1(e);return wt(t,function(n){return n.checked=r(n.value),n})}function Qze(t){var e=[];return ae(t,function(r){r.checked&&e.push(r.value)}),e}function kd(t){return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kd(t)}function Zze(t,e){return rGe(t)||tGe(t,e)||eGe(t,e)||Jze()}function Jze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eGe(t,e){if(!!t){if(typeof t=="string")return VH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VH(t,e)}}function VH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function tGe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function rGe(t){if(Array.isArray(t))return t}function nGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oGe(n.key),n)}}function iGe(t,e,r){return e&&jH(t.prototype,e),r&&jH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function oGe(t){var e=aGe(t,"string");return kd(e)==="symbol"?e:String(e)}function aGe(t,e){if(kd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function h2(){return typeof Reflect<"u"&&Reflect.get?h2=Reflect.get.bind():h2=function(e,r,n){var i=sGe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},h2.apply(this,arguments)}function sGe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=$d(t),t!==null););return t}function lGe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v7(t,e)}function v7(t,e){return v7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},v7(t,e)}function uGe(t){var e=hGe();return function(){var n=$d(t),i;if(e){var o=$d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return cGe(this,i)}}function cGe(t,e){if(e&&(kd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fGe(t)}function fGe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $d(t){return $d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$d(t)}var dGe=function(t){lGe(r,t);var e=uGe(r);function r(n,i){var o;return nGe(this,r),o=e.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.elements.push(new UH(o.hot)),o.registerHooks(),o}return iGe(r,[{key:"registerHooks",value:function(){var i=this;this.getMultipleSelectElement().addLocalHook("keydown",function(o){return i.onInputKeyDown(o)})}},{key:"setState",value:function(i){if(this.reset(),i&&i.command.key===bu){var o=this.getMultipleSelectElement();o.setItems(i.itemsSnapshot),o.setValue(i.args[0]),o.setLocale(i.locale)}}},{key:"getState",value:function(){var i=this.getMultipleSelectElement(),o=i.getItems();return{command:{key:i.isSelectedAllValues()||!o.length?fn:bu},args:[i.getValue()],itemsSnapshot:o}}},{key:"updateState",value:function(i){var o=this,a=function(l,u,c,f,h){var d=Ji(u,function(M){return M.name===bu}),p=Zze(d,1),m=p[0],g={},v=o.hot.getTranslatedPhrase(kw);if(m){var w=u7(wt(f(l,h),function(M){return M.value}));c&&(m.args[0]=c);var b=[],E=RH(w,m.args[0],v,function(M){M.checked&&b.push(M.value)}),A=i.editedConditionStack.column;g.locale=o.hot.getCellMeta(0,A).locale,g.args=[b],g.command=vu(bu),g.itemsSnapshot=E}else g.args=[],g.command=vu(fn);o.state.setValueAtIndex(l,g)};a(i.editedConditionStack.column,i.editedConditionStack.conditions,i.conditionArgsChange,i.filteredRowsFactory),i.dependentConditionStacks.length&&a(i.dependentConditionStacks[0].column,i.dependentConditionStacks[0].conditions,i.conditionArgsChange,i.filteredRowsFactory,i.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof UH})[0]}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(a,s,l,u,c,f){_e(s.parentNode,"htFiltersMenuValue");var h=i.hot.rootDocument.createElement("div");return _e(h,"htFiltersMenuLabel"),h.textContent=f,s.appendChild(h),s.parentNode.hasAttribute("ghost-table")||ae(i.elements,function(d){return s.appendChild(d.element)}),s}}}},{key:"reset",value:function(){var i=this.hot.getTranslatedPhrase(kw),o=u7(this._getColumnVisibleValues()),a=RH(o,o,i);this.getMultipleSelectElement().setItems(a),h2($d(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(o);var s=this.hot.getPlugin("filters").getSelectedColumn();s!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}},{key:"onInputKeyDown",value:function(i){Ig(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),la(i))}},{key:"_getColumnVisibleValues",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn();return i===null?[]:wt(this.hot.getDataAtCol(i.visualIndex),function(o){return UQ(o)})}}]),r}(V6);const pGe=dGe;function Ld(t){return Ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ld(t)}function mGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yGe(n.key),n)}}function gGe(t,e,r){return e&&WH(t.prototype,e),r&&WH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function yGe(t){var e=vGe(t,"string");return Ld(e)==="symbol"?e:String(e)}function vGe(t,e){if(Ld(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bGe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b7(t,e)}function b7(t,e){return b7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},b7(t,e)}function wGe(t){var e=EGe();return function(){var n=jw(t),i;if(e){var o=jw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return SGe(this,i)}}function SGe(t,e){if(e&&(Ld(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RGe(t)}function RGe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function EGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jw(t){return jw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jw(t)}var CGe=function(t){bGe(r,t);var e=wGe(r);function r(n,i){var o;return mGe(this,r),o=e.call(this,n,{id:i.id,stateless:!0}),o.name=i.name,o.elements.push(new Gf(o.hot,{type:"button",value:UI,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),o.elements.push(new Gf(o.hot,{type:"button",value:VI,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),o.registerHooks(),o}return gGe(r,[{key:"registerHooks",value:function(){var i=this;ae(this.elements,function(o){o.addLocalHook("click",function(a,s){return i.onButtonClick(a,s)})})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(a,s){return _e(s.parentNode,"htFiltersMenuActionBar"),s.parentNode.hasAttribute("ghost-table")||ae(i.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(i,o){o.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(V6);const _Ge=CGe;function cv(t){return cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cv(t)}var zH,GH;function YH(t,e){return IGe(t)||AGe(t,e)||OGe(t,e)||TGe()}function TGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OGe(t,e){if(!!t){if(typeof t=="string")return KH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KH(t,e)}}function KH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function AGe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function IGe(t){if(Array.isArray(t))return t}function qH(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function xGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function XH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,NGe(n.key),n)}}function MGe(t,e,r){return e&&XH(t.prototype,e),r&&XH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function NGe(t){var e=PGe(t,"string");return cv(e)==="symbol"?e:String(e)}function PGe(t,e){if(cv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(cv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var QH="ConditionCollection.filteringStates",XQ=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;xGe(this,t),this.hot=e,this.isMapRegistrable=r,this.filteringStates=new _6,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(QH,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return MGe(t,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var i,o=this.filteringStates.getValueAtIndex(n),a=(i=o==null?void 0:o.conditions)!==null&&i!==void 0?i:[],s=o==null?void 0:o.operation;return this.isMatchInConditions(a,r,s)}},{key:"isMatchInConditions",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:il;return r.length?Zje(i)(r,n):!0}},{key:"addCondition",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:il,o=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,r).locale,s=wt(n.args,function(f){return typeof f=="string"?f.toLocaleLowerCase(a):f}),l=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==i)throw Error(Gt(zH||(zH=qH(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(tr(sv[i]))throw new Error(Gt(GH||(GH=qH(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),i));var c=this.getConditions(r);c.length===0?this.filteringStates.setValueAtIndex(r,{operation:i,conditions:[{name:l,args:s,func:gl(l,s)}]},o):c.push({name:l,args:s,func:gl(l,s)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(r))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=YH(r,1),i=n[0];return i})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return Fn(this.filteringStates.getEntries(),function(r,n){var i=YH(n,2),o=i[0],a=i[1],s=a.operation,l=a.conditions;return r.push({column:o,operation:s,conditions:wt(l,function(u){var c=u.name,f=u.args;return{name:c,args:f}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),ae(r,function(i){ae(i.conditions,function(o){return n.addCondition(i.column,o)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var i=this.getConditions(r);return n?i.some(function(o){return o.name===n}):i.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(QH),this.filteringStates=null,this.clearLocalHooks()}}]),t}();ir(XQ,wi);const QQ=XQ;function fv(t){return fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fv(t)}function kGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ZH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,LGe(n.key),n)}}function $Ge(t,e,r){return e&&ZH(t.prototype,e),r&&ZH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function LGe(t){var e=DGe(t,"string");return fv(e)==="symbol"?e:String(e)}function DGe(t,e){if(fv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var FGe=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};kGe(this,t),this.conditionCollection=e,this.columnDataFactory=r}return $Ge(t,[{key:"filter",value:function(){var r=this,n=[];return ae(this.conditionCollection.getFilteredColumns(),function(i,o){var a=r.columnDataFactory(i);o&&(a=r._getIntersectData(a,n)),n=r.filterByColumn(i,a)}),n}},{key:"filterByColumn",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=[];return ae(i,function(a){a!==void 0&&n.conditionCollection.isMatch(a,r)&&o.push(a)}),o}},{key:"_getIntersectData",value:function(r,n){var i=[];return ae(n,function(o){var a=o.meta.visualRow;r[a]!==void 0&&(i[a]=r[a])}),i}}]),t}();const ZQ=FGe;function hv(t){return hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hv(t)}function HGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function JH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,UGe(n.key),n)}}function BGe(t,e,r){return e&&JH(t.prototype,e),r&&JH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function UGe(t){var e=VGe(t,"string");return hv(e)==="symbol"?e:String(e)}function VGe(t,e){if(hv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(hv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var JQ=function(){function t(e,r){var n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};HGe(this,t),this.hot=e,this.conditionCollection=r,this.columnDataFactory=i,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(o){return n._onConditionBeforeModify(o)}),this.conditionCollection.addLocalHook("afterRemove",function(o){return n.updateStatesAtColumn(o)}),this.conditionCollection.addLocalHook("afterAdd",function(o){return n.updateStatesAtColumn(o)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return BGe(t,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,ae(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var i=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var o=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(r);a===-1&&(a=this.latestEditedColumnPosition);var s=o.slice(0,a),l=o.slice(a);l.length&&l[0].column===r&&l.shift();var u=dSe(function(f,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],p=new QQ(i.hot,!1),m=[].concat(f,d);p.importAllConditions(m);var g=i.columnDataFactory(h),v;p.isEmpty()?v=g:v=new ZQ(p,function(b){return i.columnDataFactory(b)}).filter(),v=wt(v,function(b){return b.meta.visualRow});var w=B1(v);return p.destroy(),Ji(g,function(b){return w(b.meta.visualRow)})})(s),c=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:c},dependentConditionStacks:l,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;ae(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),Rt(this,function(n,i){r[i]=null})}}]),t}();ir(JQ,wi);const jGe=JQ;function Dd(t){return Dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dd(t)}var eB;function WGe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function zGe(t,e){return qGe(t)||KGe(t,e)||YGe(t,e)||GGe()}function GGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YGe(t,e){if(!!t){if(typeof t=="string")return tB(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tB(t,e)}}function tB(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function KGe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function qGe(t){if(Array.isArray(t))return t}function XGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ZGe(n.key),n)}}function QGe(t,e,r){return e&&rB(t.prototype,e),r&&rB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZGe(t){var e=JGe(t,"string");return Dd(e)==="symbol"?e:String(e)}function JGe(t,e){if(Dd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qf(){return typeof Reflect<"u"&&Reflect.get?qf=Reflect.get.bind():qf=function(e,r,n){var i=eYe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},qf.apply(this,arguments)}function eYe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ll(t),t!==null););return t}function tYe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w7(t,e)}function w7(t,e){return w7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},w7(t,e)}function rYe(t){var e=iYe();return function(){var n=ll(t),i;if(e){var o=ll(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return nYe(this,i)}}function nYe(t,e){if(e&&(Dd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eZ(t)}function eZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function iYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ll(t){return ll=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ll(t)}var nB="filters",oYe=250,aYe=function(t){tYe(r,t);var e=rYe(r);function r(n){var i;return XGe(this,r),i=e.call(this,n),i.eventManager=new Er(eZ(i)),i.dropdownMenuPlugin=null,i.conditionCollection=null,i.conditionUpdateObserver=null,i.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),i.filtersRowsMap=null,i.hot.addHook("afterGetColHeader",function(o,a){return i.onAfterGetColHeader(o,a)}),i}return QGe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[nB]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new k1),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var o=this.hot.getSettings().dropdownMenu,a=o&&o.uiContainer||this.hot.rootDocument.body,s=function(d){return d.addLocalHook("accept",function(){return i.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return i.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(p){return i.onComponentChange(d,p)}),d},l=function(){return"".concat(i.hot.getTranslatedPhrase(LI),":")},u=function(){return"".concat(i.hot.getTranslatedPhrase(DI),":")};if(!this.components.get("filter_by_condition")){var c=new mC(this.hot,{id:"filter_by_condition",name:l,addSeparator:!1,menuContainer:a});c.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition",s(c))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new dze(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var f=new mC(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});f.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition2",s(f))}this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new pGe(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new _Ge(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new QQ(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new jGe(this.hot,this.conditionCollection,function(h){return i.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return i.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return i.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return i.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return i.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return i.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return i.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),qf(ll(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;if(this.enabled){var o;(o=this.dropdownMenuPlugin)!==null&&o!==void 0&&o.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,s){a.destroy(),i.components.set(s,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}qf(ll(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(i,o,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:il,l=this.hot.toPhysicalColumn(i);this.conditionCollection.addCondition(l,{command:{key:o},args:a},s)}},{key:"removeConditions",value:function(i){var o=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(o)}},{key:"clearConditions",value:function(i){if(i===void 0)this.conditionCollection.clean();else{var o=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(o)}}},{key:"filter",value:function(){var i=this,o=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),s=[],l=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",l);if(u!==!1)if(a){var c=[];this.hot.batchExecution(function(){i.filtersRowsMap.clear(),s=wt(o.filter(),function(h){return h.meta.visualRow});var f=B1(s);Ye(i.hot.countSourceRows()-1,function(h){f(h)||c.push(h)}),ae(c,function(h){i.filtersRowsMap.setValueAtIndex(h,!0)})},!0),s.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",l),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var i,o=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return o?{visualIndex:o.col,physicalIndex:this.hot.toPhysicalColumn(o.col)}:null}},{key:"clearColumnSelection",value:function(){var i=this.getSelectedColumn();i!==null&&this.hot.selectCell(0,i.visualIndex)}},{key:"getDataMapAtColumn",value:function(i){var o=this,a=this.hot.toVisualColumn(i),s=[];return ae(this.hot.getSourceDataAtCol(a),function(l,u){var c,f=o.hot.getCellMeta(u,a),h=f.row,d=f.col,p=f.visualCol,m=f.visualRow,g=f.type,v=f.instance,w=f.dateFormat,b=f.locale,E=(c=o.hot.getDataAtCell(o.hot.toVisualRow(u),a))!==null&&c!==void 0?c:l;s.push({meta:{row:h,col:d,visualCol:p,visualRow:m,type:g,instance:v,dateFormat:w,locale:b},value:UQ(E)})}),s}},{key:"onAfterChange",value:function(i){var o=this;i&&ae(i,function(a){var s=zGe(a,2),l=s[1],u=o.hot.propToCol(l);o.conditionCollection.hasConditions(u)&&o.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(i){var o=this.hot.getDataAtCol(i),a=u7(o);this.conditionUpdateObserver.updateStatesAtColumn(i,a)}},{key:"restoreComponents",value:function(i){var o,a=(o=this.getSelectedColumn())===null||o===void 0?void 0:o.physicalIndex;i.forEach(function(s){s.isHidden()||s.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var i=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){i.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(i){i.items.push({name:vt}),this.components.forEach(function(o){i.items.push(o.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(i,o,a,s){var l=i;return l===Uw&&o.command.key!==fn&&a.command.key!==fn&&s.command.key!==fn?l=ox:s.command.key!==fn&&(o.command.key===fn||a.command.key===fn)&&(l=il),l}},{key:"onActionBarSubmit",value:function(i){var o;if(i==="accept"){var a=this.getSelectedColumn();if(a===null){var s;(s=this.dropdownMenuPlugin)===null||s===void 0||s.close();return}var l=a.physicalIndex,u=this.components.get("filter_by_condition").getState(),c=this.components.get("filter_by_condition2").getState(),f=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,c,f);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(l);d===-1&&(d=void 0),this.conditionCollection.removeConditions(l),u.command.key!==fn&&(this.conditionCollection.addCondition(l,u,h,d),c.command.key!==fn&&this.conditionCollection.addCondition(l,c,h,d)),f.command.key!==fn&&this.conditionCollection.addCondition(l,f,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(p){return p.saveState(l)}),this.filtersRowsMap.clear(),this.filter()}(o=this.dropdownMenuPlugin)===null||o===void 0||o.close()}},{key:"onComponentChange",value:function(i,o){this.updateDependentComponentsVisibility(),i.constructor===mC&&!o.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var i=this.components.get("filter_by_condition"),o=i.getState(),a=o.command,s=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,s):this.hideComponents.apply(this,s)}},{key:"onAfterGetColHeader",value:function(i,o){var a=this.hot.toPhysicalColumn(i);this.enabled&&this.conditionCollection.hasConditions(a)?_e(o,"htFiltersActive"):ut(o,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new ZQ(o,function(a){return i.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(i){var o;if(!!((o=this.dropdownMenuPlugin)!==null&&o!==void 0&&o.enabled)){var a=i.editedConditionStack,s=a.conditions,l=a.column,u=s.filter(function(h){return h.name===bu}),c=s.filter(function(h){return h.name!==bu});if(u.length>=2||c.length>=3)Xt(Gt(eB||(eB=WGe([`The filter conditions have been applied properly, but couldn\u2019t be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldn\u2019t be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var f=this.conditionCollection.getOperation(l);this.components.get("filter_by_condition").updateState(c[0],l),this.components.get("filter_by_condition2").updateState(c[1],l),this.components.get("filter_operators").updateState(f,l),this.components.get("filter_by_value").updateState(i)}}}},{key:"getIndexesOfComponents",value:function(){var i=[];if(!this.dropdownMenuPlugin)return i;for(var o=this.dropdownMenuPlugin.menu,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return ae(s,function(u){ae(o.menuItems,function(c,f){c.key===u.getMenuItemDescriptor().key&&i.push(f)})}),i}},{key:"changeComponentsVisibility",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!!this.dropdownMenuPlugin){for(var o=this.dropdownMenuPlugin.menu,a=o.hotMenu,s=a.getPlugin("hiddenRows"),l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];var f=this.getIndexesOfComponents.apply(this,u);i?s.showRows(f):s.hideRows(f),a.render()}}},{key:"hideComponents",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(o))}},{key:"showComponents",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(o))}},{key:"destroy",value:function(){var i=this;this.enabled&&(this.components.forEach(function(o,a){o!==null&&(o.destroy(),i.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),qf(ll(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return nB}},{key:"PLUGIN_PRIORITY",get:function(){return oYe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(jt);function dv(t){return dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dv(t)}function iB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function sg(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?iB(Object(r),!0).forEach(function(n){sYe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iB(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function sYe(t,e,r){return e=lYe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lYe(t){var e=uYe(t,"string");return dv(e)==="symbol"?e:String(e)}function uYe(t,e){if(dv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(dv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var tZ="internal-use-in-handsontable",cYe={licenseKey:tZ,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function rZ(t){var e,r;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Gn])===null||e===void 0||(r=e.language)===null||r===void 0?void 0:r.langCode}}function nZ(t){return Object.keys(t).reduce(function(e,r){return r!=="hyperformula"&&(e[r]=t[r]),e},{})}function fYe(t){var e,r=t[Gn],n=nZ(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=rZ(t);return sg(sg(sg({},cYe),n),i)}function hYe(t){var e,r=t[Gn],n=nZ(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=rZ(t);return sg(sg({},n),i)}function S7(t){return S7=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S7(t)}function j6(){var t="engine_relationship",e=so(Gn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function ax(){var t="shared_engine_usage",e=so(Gn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function dYe(t){var e=t.getSettings(),r=e[Gn],n=r==null?void 0:r.engine;if(r===!0||tr(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return pYe((i=n.hyperformula)!==null&&i!==void 0?i:n,e,t)}else if(S7(n)==="object"&&tr(n.hyperformula)){var o=j6(),a=ax().get(n);return o.has(n)||o.set(n,[]),o.get(n).push(t),a&&a.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:tZ}),n}return null}function pYe(t,e,r){var n=e[Gn],i=fYe(e),o=j6(),a=ax();mYe(t,n.functions),gYe(t,n.language);var s=t.buildEmpty(i);return o.set(s,[r]),a.set(s,[r.guid]),yYe(s,n.namedExpressions),s.on("sheetAdded",function(){s.rebuildAndRecalculate()}),s.on("sheetRemoved",function(){s.rebuildAndRecalculate()}),s}function oB(t){var e,r=j6(),n=r.size===0?[]:Array.from((e=r.get(t))!==null&&e!==void 0?e:[]);return new Map(n.map(function(i){return[i.getPlugin("formulas").sheetId,i]}))}function aB(t,e){if(t){var r=j6(),n=r.get(t),i=ax(),o=i.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),n.length===0&&r.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function mYe(t,e){e&&e.forEach(function(r){var n=r.name,i=r.plugin,o=r.translations;try{t.registerFunction(n,i,o)}catch(a){Xt(a.message)}})}function gYe(t,e){if(e){var r=e.langCode;try{t.registerLanguage(r,e)}catch(n){Xt(n.message)}}}function yYe(t,e){e&&(t.suspendEvaluation(),e.forEach(function(r){var n=r.name,i=r.expression,o=r.scope,a=r.options;try{t.addNamedExpression(n,i,o,a)}catch(s){Xt(s.message)}}),t.resumeEvaluation())}function vYe(t,e){return(tr(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}function iZ(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function bYe(t){return iZ(t)?t.substr(1):t}function wYe(t){return EYe(t)||RYe(t)||oZ(t)||SYe()}function SYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RYe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function EYe(t){if(Array.isArray(t))return R7(t)}function sB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function lB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sB(Object(r),!0).forEach(function(n){d2(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sB(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function yl(t){return yl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yl(t)}function nf(t,e){return TYe(t)||_Ye(t,e)||oZ(t,e)||CYe()}function CYe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oZ(t,e){if(!!t){if(typeof t=="string")return R7(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R7(t,e)}}function R7(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _Ye(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function TYe(t){if(Array.isArray(t))return t}function OYe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aZ(n.key),n)}}function AYe(t,e,r){return e&&uB(t.prototype,e),r&&uB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wu(){return typeof Reflect<"u"&&Reflect.get?wu=Reflect.get.bind():wu=function(e,r,n){var i=IYe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},wu.apply(this,arguments)}function IYe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ja(t),t!==null););return t}function xYe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&E7(t,e)}function E7(t,e){return E7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},E7(t,e)}function MYe(t){var e=PYe();return function(){var n=Ja(t),i;if(e){var o=Ja(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return NYe(this,i)}}function NYe(t,e){if(e&&(yl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ql(t)}function Ql(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ja(t){return Ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ja(t)}function d2(t,e,r){return e=aZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aZ(t){var e=kYe(t,"string");return yl(e)==="symbol"?e:String(e)}function kYe(t,e){if(yl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(yl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yC(t,e,r){$Ye(t,e),e.set(t,r)}function $Ye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function of(t,e,r){var n=sZ(t,e,"set");return LYe(t,n,r),r}function LYe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function af(t,e){var r=sZ(t,e,"get");return DYe(t,r)}function sZ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function DYe(t,e){return e.get?e.get.call(t):e.value}var Gn="formulas",FYe=260,cB="row_move";Ue.getSingleton().register("afterNamedExpressionAdded");Ue.getSingleton().register("afterNamedExpressionRemoved");Ue.getSingleton().register("afterSheetAdded");Ue.getSingleton().register("afterSheetRemoved");Ue.getSingleton().register("afterSheetRenamed");Ue.getSingleton().register("afterFormulasValuesUpdate");var sf=function(e){return e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto"},Vl=new WeakMap,vC=new WeakMap,wm=new WeakMap,HYe=function(t){xYe(r,t);var e=MYe(r);function r(){var n;OYe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),yC(Ql(n),Vl,{writable:!0,value:!1}),yC(Ql(n),vC,{writable:!0,value:!1}),yC(Ql(n),wm,{writable:!0,value:[["valuesUpdated",function(){var s;return(s=n).onEngineValuesUpdated.apply(s,arguments)}],["namedExpressionAdded",function(){var s;return(s=n).onEngineNamedExpressionsAdded.apply(s,arguments)}],["namedExpressionRemoved",function(){var s;return(s=n).onEngineNamedExpressionsRemoved.apply(s,arguments)}],["sheetAdded",function(){var s;return(s=n).onEngineSheetAdded.apply(s,arguments)}],["sheetRenamed",function(){var s;return(s=n).onEngineSheetRenamed.apply(s,arguments)}],["sheetRemoved",function(){var s;return(s=n).onEngineSheetRemoved.apply(s,arguments)}]]}),d2(Ql(n),"staticRegister",so("formulas")),d2(Ql(n),"engine",null),d2(Ql(n),"sheetName",null),n}return AYe(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Gn]}},{key:"enablePlugin",value:function(){var i,o=this;if(!this.enabled){if(this.engine=(i=dYe(this.hot))!==null&&i!==void 0?i:this.engine,!this.engine){Xt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return o.onBeforeLoadData.apply(o,arguments)}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeUpdateData",function(){return o.onBeforeLoadData.apply(o,arguments)}),this.addHook("afterUpdateData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("modifyData",function(){return o.onModifyData.apply(o,arguments)}),this.addHook("modifySourceData",function(){return o.onModifySourceData.apply(o,arguments)}),this.addHook("beforeValidate",function(){return o.onBeforeValidate.apply(o,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return o.onAfterSetSourceDataAtCell.apply(o,arguments)}),this.addHook("afterSetDataAtCell",function(){return o.onAfterSetDataAtCell.apply(o,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return o.onAfterSetDataAtCell.apply(o,arguments)}),this.addHook("beforeCreateRow",function(){return o.onBeforeCreateRow.apply(o,arguments)}),this.addHook("beforeCreateCol",function(){return o.onBeforeCreateCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("beforeRemoveCol",function(){return o.onBeforeRemoveCol.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("beforeUndo",function(s){(s==null?void 0:s.actionType)!==cB&&o.engine.undo()}),this.addHook("beforeRedo",function(s){(s==null?void 0:s.actionType)!==cB&&o.engine.redo()}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("beforeAutofill",function(){return o.onBeforeAutofill.apply(o,arguments)}),af(this,wm).forEach(function(s){var l=nf(s,2),u=l[0],c=l[1];return o.engine.on(u,c)}),wu(Ja(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;af(this,wm).forEach(function(o){var a=nf(o,2),s=a[0],l=a[1];return i.engine.off(s,l)}),aB(this.engine,this.hot),this.engine=null,wu(Ja(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(i){this.engine.updateConfig(hYe(this.hot.getSettings()));var o=this.hot.getSettings()[Gn];if(He(o)&&He(o.sheetName)&&o.sheetName!==this.sheetName&&this.switchSheet(o.sheetName),!i.data&&this.sheetName===null){var a=this.hot.getSettings()[Gn].sheetName;a&&this.engine.doesSheetExist(a)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(a!=null?a:void 0,this.hot.getSourceDataArray())}wu(Ja(r.prototype),"updatePlugin",this).call(this,i)}},{key:"destroy",value:function(){var i=this;af(this,wm).forEach(function(o){var a,s=nf(o,2),l=s[0],u=s[1];return(a=i.engine)===null||a===void 0?void 0:a.off(l,u)}),of(this,wm,null),aB(this.engine,this.hot),this.engine=null,wu(Ja(r.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(i,o,a,s,l){return!l&&i>=a?s+(i-a):o}},{key:"toPhysicalRowPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalRow(i),this.hot.countRows(),this.hot.countSourceRows(),o)}},{key:"toPhysicalColumnPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalColumn(i),this.hot.countCols(),this.hot.countSourceCols(),o)}},{key:"addSheet",value:function(i,o){if(He(o)&&!_$e(o))return Xt("The provided data should be an array of arrays."),!1;if(i!=null&&this.engine.doesSheetExist(i))return Xt("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(i!=null?i:void 0);return o&&this.engine.setSheetContent(this.engine.getSheetId(a),o),a}catch(s){return Xt(s.message),!1}}},{key:"switchSheet",value:function(i){if(!this.engine.doesSheetExist(i)){G8("The sheet named `".concat(i,"` does not exist, switch aborted."));return}this.sheetName=i;var o=this.engine.getSheetSerialized(this.sheetId);o.length>0&&this.hot.loadData(o,"".concat(ms(Gn),".switchSheet"))}},{key:"getCellType",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(i),l=this.hot.toPhysicalColumn(o);return s!==null&&l!==null?this.engine.getCellType({sheet:a,row:s,col:l}):"EMPTY"}},{key:"isFormulaCellType",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(i),l=this.hot.toPhysicalColumn(o);return s===null||l===null?!1:this.engine.doesCellHaveFormula({sheet:a,row:s,col:l})}},{key:"renderDependentSheets",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=new Set;i.forEach(function(l){var u,c=l==null||(u=l.address)===null||u===void 0?void 0:u.sheet;c!==void 0&&(s.has(c)||s.add(c))}),oB(this.engine).forEach(function(l,u){if((a||u!==o.sheetId)&&s.has(u)){var c;l.render(),(c=l.view)===null||c===void 0||c.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=function(c){var f,h=(f=c==null?void 0:c.address)!==null&&f!==void 0?f:{},d=h.row,p=h.col,m=h.sheet;return He(m)?"".concat(m,":").concat(d,"x").concat(p):""},l=new Set(a.map(function(u){return s(u)}));i.forEach(function(u){var c,f,h=(c=u.address)!==null&&c!==void 0?c:{},d=h.row,p=h.col,m=He(d)?o.hot.toVisualRow(d):null,g=He(p)?o.hot.toVisualColumn(p):null;if(!(m===null||g===null)){var v=u==null||(f=u.address)===null||f===void 0?void 0:f.sheet,w=s(u);if(v!==void 0&&!l.has(w)){var b=oB(o.engine).get(v);if(!b)return;b.validateCell(b.getDataAtCell(m,g),b.getCellMeta(m,g),function(){})}}})}},{key:"syncChangeWithEngine",value:function(i,o,a){var s={row:this.toPhysicalRowPosition(i),col:this.toPhysicalColumnPosition(o),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){Xt("Not possible to set cell data at ".concat(JSON.stringify(s)));return}return this.engine.setCellContents(s,a)}},{key:"onBeforeValidate",value:function(i,o,a){var s=this.hot.propToCol(a);if(this.isFormulaCellType(o,s)){var l={row:this.hot.toPhysicalRow(o),col:this.hot.toPhysicalColumn(s),sheet:this.sheetId},u=this.engine.getCellValue(l);return yl(u)==="object"&&u!==null?u.value:u}return i}},{key:"onBeforeAutofill",value:function(i,o,a){var s=this,l=function(h){return lB(lB({},h),{},{sheet:s.sheetId})},u={start:l(o.getTopStartCorner()),end:l(o.getBottomEndCorner())},c={start:l(a.getTopStartCorner()),end:l(a.getBottomEndCorner())};return this.engine.isItPossibleToSetCellContents(c)===!1?!1:this.engine.getFillRangeData(u,c)}},{key:"onBeforeLoadData",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(ms(Gn))||of(this,vC,tr(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(ms(Gn)))if(this.sheetName=vYe(this.engine,this.hot.getSettings()[Gn].sheetName),af(this,vC))this.switchSheet(this.sheetName);else{var s=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,s)){of(this,Vl,!0);var l=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(l),of(this,Vl,!1)}}}},{key:"onModifyData",value:function(i,o,a,s){if(!(s!=="get"||af(this,Vl)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(i),u=this.isFormulaCellType(l,o);if(!u){var c=this.getCellType(l,o);if(c!=="ARRAY"){iZ(a.value)&&(a.value=bYe(a.value));return}}var f={row:i,col:this.toPhysicalColumnPosition(o),sheet:this.sheetId},h=this.engine.getCellValue(f),d=yl(h)==="object"&&h!==null?h.value:h;a.value=d}}},{key:"onModifySourceData",value:function(i,o,a,s){if(!(s!=="get"||af(this,Vl)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(i),u=this.hot.propToCol(o),c=this.isFormulaCellType(l,u);if(!c){var f=this.getCellType(l,u);if(f!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:i,col:this.toPhysicalColumnPosition(u),sheet:this.sheetId};a.value=this.engine.getCellSerialized(d)}}}},{key:"onAfterSetDataAtCell",value:function(i,o){var a=this;if(!sf(o)){var s=[],l=[],u=this.engine.batch(function(){i.forEach(function(c){var f=nf(c,4),h=f[0],d=f[1],p=f[3],m=a.hot.propToCol(d),g=a.hot.toPhysicalRow(h),v=a.hot.toPhysicalColumn(m),w={row:g,col:v,sheet:a.sheetId};g!==null&&v!==null?a.syncChangeWithEngine(h,m,p):s.push([h,m,p]),l.push({address:w})})});s.length&&this.hot.addHookOnce("afterChange",function(){var c=a.engine.batch(function(){s.forEach(function(f){var h=nf(f,3),d=h[0],p=h[1],m=h[2];a.syncChangeWithEngine(d,p,m)})});a.renderDependentSheets(c,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,l)}}},{key:"onAfterSetSourceDataAtCell",value:function(i,o){var a=this;if(!sf(o)){var s=[],l=[];i.forEach(function(u){var c=nf(u,4),f=c[0],h=c[1],d=c[3],p=a.hot.propToCol(h);if(!!Wi(p)){var m={row:f,col:a.toPhysicalColumnPosition(p),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(m)){Xt("Not possible to set source cell data at ".concat(JSON.stringify(m)));return}l.push({address:m}),s.push.apply(s,wYe(a.engine.setCellContents(m,d)))}}),this.renderDependentSheets(s),this.validateDependentCells(s,l)}}},{key:"onBeforeCreateRow",value:function(i,o){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(i),o]))return!1}},{key:"onBeforeCreateCol",value:function(i,o){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(i),o]))return!1}},{key:"onBeforeRemoveRow",value:function(i,o,a){var s=this,l=a.every(function(u){return s.engine.isItPossibleToRemoveRows(s.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(i,o,a){var s=this,l=a.every(function(u){return s.engine.isItPossibleToRemoveColumns(s.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(i,o,a){if(!sf(a)){var s=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(i),o]);this.renderDependentSheets(s)}}},{key:"onAfterCreateCol",value:function(i,o,a){if(!sf(a)){var s=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(i),o]);this.renderDependentSheets(s)}}},{key:"onAfterRemoveRow",value:function(i,o,a,s){var l=this;if(!sf(s)){var u=a.sort().reverse(),c=this.engine.batch(function(){u.forEach(function(f){l.engine.removeRows(l.sheetId,[f,1])})});this.renderDependentSheets(c)}}},{key:"onAfterRemoveCol",value:function(i,o,a,s){var l=this;if(!sf(s)){var u=a.sort().reverse(),c=this.engine.batch(function(){u.forEach(function(f){l.engine.removeColumns(l.sheetId,[f,1])})});this.renderDependentSheets(c)}}},{key:"onAfterDetachChild",value:function(i,o,a){var s,l=this;of(this,Vl,!0);var u=this.hot.getSourceDataArray(a,0,a+(((s=o.__children)===null||s===void 0?void 0:s.length)||0),this.hot.countSourceCols());of(this,Vl,!1),u.forEach(function(c,f){c.forEach(function(h,d){l.engine.setCellContents({col:d,row:a+f,sheet:l.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(i){this.hot.runHooks("afterFormulasValuesUpdate",i)}},{key:"onEngineNamedExpressionsAdded",value:function(i,o){this.hot.runHooks("afterNamedExpressionAdded",i,o)}},{key:"onEngineNamedExpressionsRemoved",value:function(i,o){this.hot.runHooks("afterNamedExpressionRemoved",i,o)}},{key:"onEngineSheetAdded",value:function(i){this.hot.runHooks("afterSheetAdded",i)}},{key:"onEngineSheetRenamed",value:function(i,o){this.hot.runHooks("afterSheetRenamed",i,o)}},{key:"onEngineSheetRemoved",value:function(i,o){this.hot.runHooks("afterSheetRemoved",i,o)}}],[{key:"PLUGIN_KEY",get:function(){return Gn}},{key:"PLUGIN_PRIORITY",get:function(){return FYe}}]),r}(jt);function BYe(t,e){return WYe(t)||jYe(t,e)||VYe(t,e)||UYe()}function UYe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VYe(t,e){if(!!t){if(typeof t=="string")return fB(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fB(t,e)}}function fB(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function jYe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function WYe(t){if(Array.isArray(t))return t}function zYe(t){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=BYe(r,4),o=i[1],a=i[3];o-a!==0&&(n=1)}return this.getTranslatedPhrase(dI,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,o=Math.max(Math.min(n.col,i.col),0),a=Math.max(n.col,i.col),s=[],l=o;l<=a;l+=1)s.push(l);t.hideColumns(s);var u=s[s.length-1],c=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(c)&&c>=0?this.selectColumns(c):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function K0(t){return qYe(t)||KYe(t)||YYe(t)||GYe()}function GYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YYe(t,e){if(!!t){if(typeof t=="string")return C7(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C7(t,e)}}function KYe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function qYe(t){if(Array.isArray(t))return C7(t)}function C7(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function XYe(t){var e=[];return{key:"hidden_columns_show",name:function(){var n=e.length>1?1:0;return this.getTranslatedPhrase(pI,n)},callback:function(){var n,i;if(e.length!==0){var o=e[0],a=e[e.length-1];o=(n=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&n!==void 0?n:0,a=(i=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0);var s=a-o+1===this.countCols();s||this.selectColumns(o,a)}},disabled:!1,hidden:function(){var n=this,i=wt(t.getHiddenColumns(),function(w){return n.toPhysicalColumn(w)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;e.length=0;var o=this.getSelectedRangeLast(),a=o.getTopStartCorner().col,s=o.getBottomEndCorner().col,l=this.columnIndexMapper,u=l.getRenderableFromVisualIndex(a),c=l.getRenderableFromVisualIndex(s),f=l.getNotTrimmedIndexes(),h=[];if(a!==s){var d=s-a+1,p=c-u+1;if(d>p){var m=f.slice(a,s+1);h.push.apply(h,K0(m.filter(function(w){return i.includes(w)})))}}else if(u===0&&u<a)h.push.apply(h,K0(f.slice(0,a)));else if(u===null)h.push.apply(h,K0(f.slice(0,this.countCols())));else{var g=this.countCols()-1,v=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,-1));c===v&&g>s&&h.push.apply(h,K0(f.slice(s+1)))}return ae(h,function(w){e.push(n.toVisualColumn(w))}),e.length===0}}}function Fd(t){return Fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fd(t)}function QYe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,JYe(n.key),n)}}function ZYe(t,e,r){return e&&hB(t.prototype,e),r&&hB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function JYe(t){var e=eKe(t,"string");return Fd(e)==="symbol"?e:String(e)}function eKe(t,e){if(Fd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Su(){return typeof Reflect<"u"&&Reflect.get?Su=Reflect.get.bind():Su=function(e,r,n){var i=tKe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Su.apply(this,arguments)}function tKe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=es(t),t!==null););return t}function rKe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_7(t,e)}function _7(t,e){return _7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_7(t,e)}function nKe(t){var e=oKe();return function(){var n=es(t),i;if(e){var o=es(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return iKe(this,i)}}function iKe(t,e){if(e&&(Fd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return T7(t)}function T7(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oKe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function es(t){return es=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},es(t)}function dB(t,e,r){aKe(t,e),e.set(t,r)}function aKe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ei(t,e){var r=lZ(t,e,"get");return sKe(t,r)}function sKe(t,e){return e.get?e.get.call(t):e.value}function Sm(t,e,r){var n=lZ(t,e,"set");return lKe(t,n,r),r}function lZ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function lKe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}Ue.getSingleton().register("beforeHideColumns");Ue.getSingleton().register("afterHideColumns");Ue.getSingleton().register("beforeUnhideColumns");Ue.getSingleton().register("afterUnhideColumns");var bC="hiddenColumns",uKe=310,Uo=new WeakMap,Vo=new WeakMap,cKe=function(t){rKe(r,t);var e=nKe(r);function r(){var n;QYe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),dB(T7(n),Uo,{writable:!0,value:{}}),dB(T7(n),Vo,{writable:!0,value:null}),n}return ZYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[bC]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[bC];St(o)&&(Sm(this,Uo,o),tr(o.copyPasteEnabled)&&(o.copyPasteEnabled=!0)),Sm(this,Vo,new C6),Ei(this,Vo).addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,Ei(this,Vo)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(a,s,l){return i.onAfterGetCellMeta(a,s,l)}),this.addHook("modifyColWidth",function(a,s){return i.onModifyColWidth(a,s)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(a){return i.onModifyCopyableRange(a)}),Su(es(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Su(es(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Sm(this,Uo,{}),Su(es(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(i){var o=this,a=this.getHiddenColumns(),s=this.isValidConfig(i),l=a,u=Ei(this,Vo).getValues().slice(),c=i.length>0;if(s&&c){var f=i.map(function(d){return o.hot.toPhysicalColumn(d)});ae(f,function(d){u[d]=!1}),l=Fn(u,function(d,p,m){return p&&d.push(o.hot.toVisualColumn(m)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",a,l,s&&c);h!==!1&&(s&&c&&Ei(this,Vo).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,l,s&&c,s&&l.length<a.length))}},{key:"showColumn",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.showColumns(o)}},{key:"hideColumns",value:function(i){var o=this,a=this.getHiddenColumns(),s=this.isValidConfig(i),l=a;s&&(l=Array.from(new Set(a.concat(i))));var u=this.hot.runHooks("beforeHideColumns",a,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){ae(i,function(c){Ei(o,Vo).setValueAtIndex(o.hot.toPhysicalColumn(c),!0)})},!0),this.hot.runHooks("afterHideColumns",a,l,s,s&&l.length>a.length))}},{key:"hideColumn",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.hideColumns(o)}},{key:"getHiddenColumns",value:function(){var i=this;return wt(Ei(this,Vo).getHiddenIndexes(),function(o){return i.hot.toVisualColumn(o)})}},{key:"isHidden",value:function(i){return Ei(this,Vo).getValueAtIndex(this.hot.toPhysicalColumn(i))||!1}},{key:"isValidConfig",value:function(i){var o=this.hot.countCols();return Array.isArray(i)&&i.length>0?i.every(function(a){return Number.isInteger(a)&&a>=0&&a<o}):!1}},{key:"resetCellsMeta",value:function(){ae(this.hot.getCellsMeta(),function(i){i&&(i.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(i,o){if(this.isHidden(o))return 0;if(Ei(this,Uo).indicators&&(this.isHidden(o+1)||this.isHidden(o-1))&&typeof i=="number"&&this.hot.hasColHeaders())return i+15}},{key:"onAfterGetCellMeta",value:function(i,o,a){if(Ei(this,Uo).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipColumnOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var s=a.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenColumn");l>-1&&s.splice(l,1),a.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var o=this;if(Ei(this,Uo).copyPasteEnabled)return i;var a=[],s=function(u,c,f,h){a.push({startRow:u,endRow:c,startCol:f,endCol:h})};return ae(i,function(l){var u=!0,c=0;Ye(l.startCol,l.endCol,function(f){o.isHidden(f)?(u||s(l.startRow,l.endRow,c,f-1),u=!0):(u&&(c=f),f===l.endCol&&s(l.startRow,l.endRow,c,f),u=!1)})}),a}},{key:"onAfterGetColHeader",value:function(i,o){if(!(!Ei(this,Uo).indicators||i<0)){var a=[];i>=1&&this.isHidden(i-1)&&a.push("afterHiddenColumn"),i<this.hot.countCols()-1&&this.isHidden(i+1)&&a.push("beforeHiddenColumn"),_e(o,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:vt},zYe(this),XYe(this))}},{key:"onMapInit",value:function(){Array.isArray(Ei(this,Uo).columns)&&this.hideColumns(Ei(this,Uo).columns)}},{key:"destroy",value:function(){Sm(this,Uo,null),Sm(this,Vo,null),Su(es(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return bC}},{key:"PLUGIN_PRIORITY",get:function(){return uKe}}]),r}(jt);function fKe(t,e){return mKe(t)||pKe(t,e)||dKe(t,e)||hKe()}function hKe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dKe(t,e){if(!!t){if(typeof t=="string")return pB(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pB(t,e)}}function pB(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function pKe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function mKe(t){if(Array.isArray(t))return t}function gKe(t){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=fKe(r,3),o=i[0],a=i[2];o-a!==0&&(n=1)}return this.getTranslatedPhrase(mI,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,o=Math.max(Math.min(n.row,i.row),0),a=Math.max(n.row,i.row),s=[],l=o;l<=a;l+=1)s.push(l);t.hideRows(s);var u=s[s.length-1],c=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(c)&&c>=0?this.selectRows(c):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function q0(t){return wKe(t)||bKe(t)||vKe(t)||yKe()}function yKe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vKe(t,e){if(!!t){if(typeof t=="string")return O7(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O7(t,e)}}function bKe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function wKe(t){if(Array.isArray(t))return O7(t)}function O7(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function SKe(t){var e=[];return{key:"hidden_rows_show",name:function(){var n=e.length>1?1:0;return this.getTranslatedPhrase(gI,n)},callback:function(){var n,i;if(e.length!==0){var o=e[0],a=e[e.length-1];o=(n=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&n!==void 0?n:0,a=(i=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0);var s=a-o+1===this.countRows();s||this.selectRows(o,a)}},disabled:!1,hidden:function(){var n=this,i=wt(t.getHiddenRows(),function(w){return n.toPhysicalRow(w)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;e.length=0;var o=this.getSelectedRangeLast(),a=o.getTopStartCorner().row,s=o.getBottomEndCorner().row,l=this.rowIndexMapper,u=l.getRenderableFromVisualIndex(a),c=l.getRenderableFromVisualIndex(s),f=l.getNotTrimmedIndexes(),h=[];if(a!==s){var d=s-a+1,p=c-u+1;if(d>p){var m=f.slice(a,s+1);h.push.apply(h,q0(m.filter(function(w){return i.includes(w)})))}}else if(u===0&&u<a)h.push.apply(h,q0(f.slice(0,a)));else if(u===null)h.push.apply(h,q0(f.slice(0,this.countRows())));else{var g=this.countRows()-1,v=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,-1));c===v&&g>s&&h.push.apply(h,q0(f.slice(s+1)))}return ae(h,function(w){e.push(n.toVisualRow(w))}),e.length===0}}}function Hd(t){return Hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hd(t)}function RKe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,CKe(n.key),n)}}function EKe(t,e,r){return e&&mB(t.prototype,e),r&&mB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function CKe(t){var e=_Ke(t,"string");return Hd(e)==="symbol"?e:String(e)}function _Ke(t,e){if(Hd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ru(){return typeof Reflect<"u"&&Reflect.get?Ru=Reflect.get.bind():Ru=function(e,r,n){var i=TKe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ru.apply(this,arguments)}function TKe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ts(t),t!==null););return t}function OKe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&A7(t,e)}function A7(t,e){return A7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},A7(t,e)}function AKe(t){var e=xKe();return function(){var n=ts(t),i;if(e){var o=ts(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return IKe(this,i)}}function IKe(t,e){if(e&&(Hd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return I7(t)}function I7(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xKe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ts(t){return ts=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ts(t)}function gB(t,e,r){MKe(t,e),e.set(t,r)}function MKe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hi(t,e){var r=uZ(t,e,"get");return NKe(t,r)}function NKe(t,e){return e.get?e.get.call(t):e.value}function Rm(t,e,r){var n=uZ(t,e,"set");return PKe(t,n,r),r}function uZ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function PKe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}Ue.getSingleton().register("beforeHideRows");Ue.getSingleton().register("afterHideRows");Ue.getSingleton().register("beforeUnhideRows");Ue.getSingleton().register("afterUnhideRows");var wC="hiddenRows",kKe=320,_a=new WeakMap,jo=new WeakMap,$Ke=function(t){OKe(r,t);var e=AKe(r);function r(){var n;RKe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),gB(I7(n),_a,{writable:!0,value:{}}),gB(I7(n),jo,{writable:!0,value:null}),n}return EKe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[wC]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[wC];St(o)&&(Rm(this,_a,o),tr(o.copyPasteEnabled)&&(o.copyPasteEnabled=!0)),Rm(this,jo,new C6),Hi(this,jo).addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,Hi(this,jo)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(a,s,l){return i.onAfterGetCellMeta(a,s,l)}),this.addHook("modifyRowHeight",function(a,s){return i.onModifyRowHeight(a,s)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(a){return i.onModifyCopyableRange(a)}),Ru(ts(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ru(ts(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Rm(this,_a,{}),Ru(ts(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(i){var o=this,a=this.getHiddenRows(),s=this.isValidConfig(i),l=a,u=Hi(this,jo).getValues().slice(),c=i.length>0;if(s&&c){var f=i.map(function(d){return o.hot.toPhysicalRow(d)});ae(f,function(d){u[d]=!1}),l=Fn(u,function(d,p,m){return p&&d.push(o.hot.toVisualRow(m)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",a,l,s&&c);h!==!1&&(s&&c&&Hi(this,jo).setValues(u),this.hot.runHooks("afterUnhideRows",a,l,s&&c,s&&l.length<a.length))}},{key:"showRow",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.showRows(o)}},{key:"hideRows",value:function(i){var o=this,a=this.getHiddenRows(),s=this.isValidConfig(i),l=a;s&&(l=Array.from(new Set(a.concat(i))));var u=this.hot.runHooks("beforeHideRows",a,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){ae(i,function(c){Hi(o,jo).setValueAtIndex(o.hot.toPhysicalRow(c),!0)})},!0),this.hot.runHooks("afterHideRows",a,l,s,s&&l.length>a.length))}},{key:"hideRow",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.hideRows(o)}},{key:"getHiddenRows",value:function(){var i=this;return wt(Hi(this,jo).getHiddenIndexes(),function(o){return i.hot.toVisualRow(o)})}},{key:"isHidden",value:function(i){return Hi(this,jo).getValueAtIndex(this.hot.toPhysicalRow(i))||!1}},{key:"isValidConfig",value:function(i){var o=this.hot.countRows();return Array.isArray(i)&&i.length>0?i.every(function(a){return Number.isInteger(a)&&a>=0&&a<o}):!1}},{key:"resetCellsMeta",value:function(){ae(this.hot.getCellsMeta(),function(i){i&&(i.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(i,o){return this.isHidden(o)?0:i}},{key:"onAfterGetCellMeta",value:function(i,o,a){if(Hi(this,_a).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipRowOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var s=a.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenRow");l>-1&&s.splice(l,1),a.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var o=this;if(Hi(this,_a).copyPasteEnabled)return i;var a=[],s=function(u,c,f,h){a.push({startRow:u,endRow:c,startCol:f,endCol:h})};return ae(i,function(l){var u=!0,c=0;Ye(l.startRow,l.endRow,function(f){o.isHidden(f)?(u||s(c,f-1,l.startCol,l.endCol),u=!0):(u&&(c=f),f===l.endRow&&s(c,f,l.startCol,l.endCol),u=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(i,o){if(!(!Hi(this,_a).indicators||i<0)){var a=[];i>=1&&this.isHidden(i-1)&&a.push("afterHiddenRow"),i<this.hot.countRows()-1&&this.isHidden(i+1)&&a.push("beforeHiddenRow"),_e(o,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:vt},gKe(this),SKe(this))}},{key:"onMapInit",value:function(){Array.isArray(Hi(this,_a).rows)&&this.hideRows(Hi(this,_a).rows)}},{key:"destroy",value:function(){Rm(this,_a,null),Rm(this,jo,null),Ru(ts(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return wC}},{key:"PLUGIN_PRIORITY",get:function(){return kKe}}]),r}(jt);function LKe(t,e){return BKe(t)||HKe(t,e)||FKe(t,e)||DKe()}function DKe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FKe(t,e){if(!!t){if(typeof t=="string")return yB(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yB(t,e)}}function yB(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function HKe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function BKe(t){if(Array.isArray(t))return t}function UKe(t){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(j3)},callback:function(r,n){var i=LKe(n,1),o=i[0].start.col;t.freezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function VKe(t,e){return GKe(t)||zKe(t,e)||WKe(t,e)||jKe()}function jKe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WKe(t,e){if(!!t){if(typeof t=="string")return vB(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vB(t,e)}}function vB(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zKe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function GKe(t){if(Array.isArray(t))return t}function YKe(t){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(W3)},callback:function(r,n){var i=VKe(n,1),o=i[0].start.col;t.unfreezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Bd(t){return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bd(t)}function KKe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,XKe(n.key),n)}}function qKe(t,e,r){return e&&bB(t.prototype,e),r&&bB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function XKe(t){var e=QKe(t,"string");return Bd(e)==="symbol"?e:String(e)}function QKe(t,e){if(Bd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xf(){return typeof Reflect<"u"&&Reflect.get?Xf=Reflect.get.bind():Xf=function(e,r,n){var i=ZKe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Xf.apply(this,arguments)}function ZKe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ul(t),t!==null););return t}function JKe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x7(t,e)}function x7(t,e){return x7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},x7(t,e)}function eqe(t){var e=rqe();return function(){var n=ul(t),i;if(e){var o=ul(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return tqe(this,i)}}function tqe(t,e){if(e&&(Bd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cZ(t)}function cZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ul(t){return ul=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ul(t)}Ue.getSingleton().register("beforeColumnFreeze");Ue.getSingleton().register("afterColumnFreeze");Ue.getSingleton().register("beforeColumnUnfreeze");Ue.getSingleton().register("afterColumnUnfreeze");var wB="manualColumnFreeze",nqe=110,Em=new WeakMap,iqe=function(t){JKe(r,t);var e=eqe(r);function r(n){var i;return KKe(this,r),i=e.call(this,n),Em.set(cZ(i),{afterFirstUse:!1}),i}return qKe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[wB]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(o){return i.addContextMenuEntry(o)}),this.addHook("beforeColumnMove",function(o,a){return i.onBeforeColumnMove(o,a)}),Xf(ul(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=Em.get(this);i.afterFirstUse=!1,Xf(ul(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Xf(ul(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(i){var o=Em.get(this),a=this.hot.getSettings(),s=a.fixedColumnsStart<this.hot.countCols()&&i>a.fixedColumnsStart-1;o.afterFirstUse||(o.afterFirstUse=!0);var l=this.hot.runHooks("beforeColumnFreeze",i,s);l!==!1&&(s&&(this.hot.columnIndexMapper.moveIndexes(i,a.fixedColumnsStart),a._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",i,s))}},{key:"unfreezeColumn",value:function(i){var o=Em.get(this),a=this.hot.getSettings(),s=a.fixedColumnsStart>0&&i<=a.fixedColumnsStart-1;o.afterFirstUse||(o.afterFirstUse=!0);var l=this.hot.runHooks("beforeColumnUnfreeze",i,s);l!==!1&&(s&&(a._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(i,a.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",i,s))}},{key:"addContextMenuEntry",value:function(i){i.items.push({name:"---------"},UKe(this),YKe(this))}},{key:"onBeforeColumnMove",value:function(i,o){var a=Em.get(this);if(a.afterFirstUse){var s=this.hot.getSettings().fixedColumnsStart;if(o<s||i.some(function(l){return l<s}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return wB}},{key:"PLUGIN_PRIORITY",get:function(){return nqe}}]),r}(jt);function pv(t){return pv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pv(t)}function oqe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function SB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sqe(n.key),n)}}function aqe(t,e,r){return e&&SB(t.prototype,e),r&&SB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function sqe(t){var e=lqe(t,"string");return pv(e)==="symbol"?e:String(e)}function lqe(t,e){if(pv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(pv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var SC=0,RB=1,EB=2,lf="px",uqe=function(){function t(e){oqe(this,t),this.hot=e,this._element=null,this.state=SC,this.inlineProperty=e.isRtl()?"right":"left"}return aqe(t,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=EB}},{key:"build",value:function(){this.state===SC&&(this._element=this.hot.rootDocument.createElement("div"),this.state=RB)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=SC}},{key:"isAppended",value:function(){return this.state===EB}},{key:"isBuilt",value:function(){return this.state>=RB}},{key:"setPosition",value:function(r,n){Wi(r)&&(this._element.style.top=r+lf),Wi(n)&&(this._element.style[this.inlineProperty]=n+lf)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){Wi(r)&&(this._element.style.width=r+lf),Wi(n)&&(this._element.style.height=n+lf)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){Wi(r)&&(this._element.style.marginTop=r+lf),Wi(n)&&(this._element.style["margin".concat(ms(this.inlineProperty))]=n+lf)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(ms(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),t}();const fZ=uqe;function Ud(t){return Ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ud(t)}function cqe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function CB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hqe(n.key),n)}}function fqe(t,e,r){return e&&CB(t.prototype,e),r&&CB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function hqe(t){var e=dqe(t,"string");return Ud(e)==="symbol"?e:String(e)}function dqe(t,e){if(Ud(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function p2(){return typeof Reflect<"u"&&Reflect.get?p2=Reflect.get.bind():p2=function(e,r,n){var i=pqe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},p2.apply(this,arguments)}function pqe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Vd(t),t!==null););return t}function mqe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&M7(t,e)}function M7(t,e){return M7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},M7(t,e)}function gqe(t){var e=bqe();return function(){var n=Vd(t),i;if(e){var o=Vd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return yqe(this,i)}}function yqe(t,e){if(e&&(Ud(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vqe(t)}function vqe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vd(t){return Vd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vd(t)}var wqe="ht__manualColumnMove--backlight",Sqe=function(t){mqe(r,t);var e=gqe(r);function r(){return cqe(this,r),e.apply(this,arguments)}return fqe(r,[{key:"build",value:function(){p2(Vd(r.prototype),"build",this).call(this),_e(this._element,wqe)}}]),r}(fZ);const Rqe=Sqe;function jd(t){return jd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jd(t)}function Eqe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _B(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_qe(n.key),n)}}function Cqe(t,e,r){return e&&_B(t.prototype,e),r&&_B(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _qe(t){var e=Tqe(t,"string");return jd(e)==="symbol"?e:String(e)}function Tqe(t,e){if(jd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(jd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function m2(){return typeof Reflect<"u"&&Reflect.get?m2=Reflect.get.bind():m2=function(e,r,n){var i=Oqe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},m2.apply(this,arguments)}function Oqe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Wd(t),t!==null););return t}function Aqe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&N7(t,e)}function N7(t,e){return N7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},N7(t,e)}function Iqe(t){var e=Nqe();return function(){var n=Wd(t),i;if(e){var o=Wd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return xqe(this,i)}}function xqe(t,e){if(e&&(jd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mqe(t)}function Mqe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Nqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wd(t){return Wd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wd(t)}var Pqe="ht__manualColumnMove--guideline",kqe=function(t){Aqe(r,t);var e=Iqe(r);function r(){return Eqe(this,r),e.apply(this,arguments)}return Cqe(r,[{key:"build",value:function(){m2(Wd(r.prototype),"build",this).call(this),_e(this._element,Pqe)}}]),r}(fZ);const $qe=kqe;function zd(t){return zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zd(t)}function Lqe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fqe(n.key),n)}}function Dqe(t,e,r){return e&&TB(t.prototype,e),r&&TB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fqe(t){var e=Hqe(t,"string");return zd(e)==="symbol"?e:String(e)}function Hqe(t,e){if(zd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(zd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Eu(){return typeof Reflect<"u"&&Reflect.get?Eu=Reflect.get.bind():Eu=function(e,r,n){var i=Bqe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Eu.apply(this,arguments)}function Bqe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=rs(t),t!==null););return t}function Uqe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&P7(t,e)}function P7(t,e){return P7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},P7(t,e)}function Vqe(t){var e=Wqe();return function(){var n=rs(t),i;if(e){var o=rs(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return jqe(this,i)}}function jqe(t,e){if(e&&(zd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return k7(t)}function k7(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Wqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rs(t){return rs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rs(t)}Ue.getSingleton().register("beforeColumnMove");Ue.getSingleton().register("afterColumnMove");var RC="manualColumnMove",zqe=120,$s=new WeakMap,OB="ht__manualColumnMove",X0="show-ui",EC="on-moving--columns",CC="after-selection--columns",Gqe=function(t){Uqe(r,t);var e=Vqe(r);function r(n){var i;return Lqe(this,r),i=e.call(this,n),$s.set(k7(i),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),i.eventManager=new Er(k7(i)),i.backlight=new Rqe(n),i.guideline=new $qe(n),i}return Dqe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[RC]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollVertically",function(){return i.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),_e(this.hot.rootElement,OB),Eu(rs(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),Eu(rs(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){ut(this.hot.rootElement,OB),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Eu(rs(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(i,o){return this.moveColumns([i],o)}},{key:"moveColumns",value:function(i,o){var a=$s.get(this),s=a.cachedDropIndex,l=this.isMovePossible(i,o),u=this.hot.runHooks("beforeColumnMove",i,o,s,l);if(a.cachedDropIndex=void 0,u!==!1){l&&this.hot.columnIndexMapper.moveIndexes(i,o);var c=l&&this.isColumnOrderChanged(i,o);return this.hot.runHooks("afterColumnMove",i,o,s,l,c),c}}},{key:"dragColumn",value:function(i,o){return this.dragColumns([i],o)}},{key:"dragColumns",value:function(i,o){var a=this.countFinalIndex(i,o),s=$s.get(this);return s.cachedDropIndex=o,this.moveColumns(i,a)}},{key:"isMovePossible",value:function(i,o){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=i.length+o>a,l=o<0,u=i.some(function(f){return f<0}),c=i.some(function(f){return f>=a});return!(s||l||u||c)}},{key:"isColumnOrderChanged",value:function(i,o){return i.some(function(a,s){return a-s!==o})}},{key:"countFinalIndex",value:function(i,o){var a=Fn(i,function(s,l){return l<o&&(s+=1),s},0);return o-a}},{key:"getColumnsWidth",value:function(i,o){for(var a=this.hot.columnIndexMapper,s=0,l=i;l<=o;l+=1){var u=a.getRenderableFromVisualIndex(l);l<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(s+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[RC];if(Array.isArray(i))this.moveColumns(i,0);else if(i!==void 0){var o=this.persistentStateLoad();o.length&&this.moveColumns(o,0)}}},{key:"isFixedColumnsStart",value:function(i){return i<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",i),i.value?i.value:[]}},{key:"prepareColumnsToMoving",value:function(i,o){var a=[];return Ye(i,o,function(s){a.push(s)}),a}},{key:"refreshPositions",value:function(){var i=$s.get(this),o=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(i.hoveredColumn)&&o>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1));var a=this.hot.view._wt.wtTable,s=this.hot.view._wt.wtOverlays.scrollableElement,l=typeof s.scrollX=="number"?s.scrollX:s.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,i.hoveredColumn-1),c=a.hider.offsetWidth,f=a.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,p=0,m=0;if(this.hot.isRtl()){var g=this.hot.rootWindow,v=Qt(this.hot.rootElement),w=g.innerWidth-i.rootElementOffset-v;m=g.innerWidth-i.target.eventPageX-w-(s.scrollX===void 0?l:0)}else m=i.target.eventPageX-(i.rootElementOffset-(s.scrollX===void 0?l:0));if(i.hasRowHeaders&&(p=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(i.hoveredColumn)&&(u+=l),u+=p,i.hoveredColumn<0)i.fixedColumnsStart>0?i.target.col=0:i.target.col=o>0?o-1:o;else if(i.target.TD.offsetWidth/2+u<=m){var b=i.hoveredColumn>=i.countCols?i.countCols-1:i.hoveredColumn;i.target.col=b+1,u+=i.target.TD.offsetWidth}else i.target.col=i.hoveredColumn;var E=m,A=u;m+d+h>=c?E=c-d-h:m+h<f+p&&(E=f+p+Math.abs(h)),u>=c-1?A=c-1:A===0?A=1:s.scrollX!==void 0&&i.hoveredColumn<i.fixedColumnsStart&&(A-=i.rootElementOffset<=s.scrollX?i.rootElementOffset:0),this.backlight.setPosition(null,E),this.guideline.setPosition(null,A)}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(a){return i.onMouseMove(a)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){var l=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),c=this.hot.getSelectedRangeLast(),f=$s.get(this),h=at(i.target,"sortAction");if(!c||!u||f.pressed||i.button!==0||h){f.pressed=!1,f.columnsToMove.length=0,ut(this.hot.rootElement,[EC,X0]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),p=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&p&&(this.guideline.appendTo(l.hider),this.backlight.appendTo(l.hider));var m=c.from,g=c.to,v=Math.min(m.col,g.col),w=Math.max(m.col,g.col);if(o.row<0&&o.col>=v&&o.col<=w){s.column=!0,f.pressed=!0,f.target.eventPageX=i.pageX,f.target.eventOffsetX=i.offsetX,f.hoveredColumn=o.col,f.target.TD=a,f.target.col=o.col,f.columnsToMove=this.prepareColumnsToMoving(v,w),f.hasRowHeaders=!!this.hot.getSettings().rowHeaders,f.countCols=this.hot.countCols(),f.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,f.rootElementOffset=Zr(this.hot.rootElement).left;var b=f.hasRowHeaders?-1:0,E=l.holder.scrollTop+l.getColumnHeaderHeight(0)+1,A=o.col<f.fixedColumnsStart,M=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),k=Math.abs(i.offsetX-(this.hot.isRtl()?i.target.offsetWidth:0)),O=this.getColumnsWidth(v,o.col-1)+k,x=this.getColumnsWidth(b,v-1)+(A?M:0)+O;this.backlight.setPosition(E,x),this.backlight.setSize(this.getColumnsWidth(v,w),l.hider.offsetHeight-E),this.backlight.setOffset(null,-O),_e(this.hot.rootElement,EC)}else ut(this.hot.rootElement,CC),f.pressed=!1,f.columnsToMove.length=0}},{key:"onMouseMove",value:function(i){var o=$s.get(this);if(!!o.pressed){if(i.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}o.target.eventPageX=i.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,a,s){var l=this.hot.getSelectedRangeLast(),u=$s.get(this);!l||!u.pressed||(u.columnsToMove.indexOf(o.col)>-1?ut(this.hot.rootElement,X0):_e(this.hot.rootElement,X0),s.row=!0,s.column=!0,s.cell=!0,u.hoveredColumn=o.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var i=$s.get(this),o=i.target.col,a=i.columnsToMove.length;if(i.hoveredColumn=void 0,i.pressed=!1,i.backlightWidth=0,ut(this.hot.rootElement,[EC,X0,CC]),this.hot.selection.isSelectedByColumnHeader()&&_e(this.hot.rootElement,CC),!(a<1||o===void 0)){var s=i.columnsToMove[0],l=this.hot.toPhysicalColumn(s),u=this.dragColumns(i.columnsToMove,o);if(i.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var c=this.hot.toVisualColumn(l),f=c+a-1;this.hot.selectColumns(c,f)}}}},{key:"onAfterScrollVertically",value:function(){var i=this.hot.view._wt.wtTable,o=i.getColumnHeaderHeight(0)+1,a=i.holder.scrollTop,s=o+a;this.backlight.setPosition(s),this.backlight.setSize(null,i.hider.offsetHeight-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Eu(rs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return RC}},{key:"PLUGIN_PRIORITY",get:function(){return zqe}}]),r}(jt);function Gd(t){return Gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gd(t)}function Yqe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qqe(n.key),n)}}function Kqe(t,e,r){return e&&AB(t.prototype,e),r&&AB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function qqe(t){var e=Xqe(t,"string");return Gd(e)==="symbol"?e:String(e)}function Xqe(t,e){if(Gd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cu(){return typeof Reflect<"u"&&Reflect.get?Cu=Reflect.get.bind():Cu=function(e,r,n){var i=Qqe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Cu.apply(this,arguments)}function Qqe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ns(t),t!==null););return t}function Zqe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$7(t,e)}function $7(t,e){return $7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$7(t,e)}function Jqe(t){var e=tXe();return function(){var n=ns(t),i;if(e){var o=ns(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return eXe(this,i)}}function eXe(t,e){if(e&&(Gd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L7(t)}function L7(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tXe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ns(t){return ns=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ns(t)}var Q0="manualColumnResize",rXe=130,IB="manualColumnWidths",_C=new WeakMap,nXe=function(t){Zqe(r,t);var e=Jqe(r);function r(n){var i;Yqe(this,r),i=e.call(this,n);var o=i.hot.rootDocument;return i.currentTH=null,i.currentCol=null,i.selectedCols=[],i.currentWidth=null,i.newSize=null,i.startY=null,i.startWidth=null,i.startOffset=null,i.handle=o.createElement("DIV"),i.guide=o.createElement("DIV"),i.eventManager=new Er(L7(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.columnWidthsMap=void 0,_C.set(L7(i),{config:void 0}),_e(i.handle,"manualColumnResizer"),_e(i.guide,"manualColumnResizerGuide"),i}return Kqe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Q0]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnWidthsMap=new _l,this.columnWidthsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(o,a){return i.onModifyColWidth(o,a)}),this.addHook("beforeStretchingColumnWidth",function(o,a){return i.onBeforeStretchingColumnWidth(o,a)}),this.addHook("beforeColumnResize",function(o,a,s){return i.onBeforeColumnResize(o,a,s)}),this.bindEvents(),Cu(ns(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Cu(ns(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=_C.get(this);i.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),Cu(ns(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",IB,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",IB,i),i.value}},{key:"setManualSize",value:function(i,o){var a=Math.max(o,20),s=this.hot.toPhysicalColumn(i);return this.columnWidthsMap.setValueAtIndex(s,a),a}},{key:"clearManualSize",value:function(i){var o=this.hot.toPhysicalColumn(i);this.columnWidthsMap.setValueAtIndex(o,null)}},{key:"onMapInit",value:function(){var i=this,o=_C.get(this),a=this.hot.getSettings()[Q0],s=this.loadManualColumnWidths();typeof s<"u"?this.hot.batchExecution(function(){s.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0),o.config=a):a===!0&&Array.isArray(o.config)&&this.hot.batchExecution(function(){o.config.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0)}},{key:"setupHandlePosition",value:function(i){var o=this;if(!!i.parentNode){this.currentTH=i;var a=this.hot.view._wt,s=a.wtTable.getCoords(this.currentTH),l=s.col;if(!(l<0)){var u=wr(this.currentTH),c=this.currentTH.getBoundingClientRect(),f=l<a.getSetting("fixedColumnsStart"),h;f&&(h=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),h||(h=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var p=this.hot.getSelectedRange();ae(p,function(m){var g=m.getTopStartCorner().col,v=m.getBottomEndCorner().col;Ye(g,v,function(w){o.selectedCols.includes(w)||o.selectedCols.push(w)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(c.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(wr(this.handle),10),o=parseInt(this.handle.style.top,10)+i,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);_e(this.handle,"active"),_e(this.guide,"active"),this.guide.style.top="".concat(o,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(a-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){ut(this.handle,"active"),ut(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(i){return!!Bu(i,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"onMouseOver",value:function(i){if(!_K(i.target)&&this.checkIfColumnHeader(i.target)){var o=this.getClosestTHParent(i.target);if(!o)return;var a=o.getAttribute("colspan");o&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(o))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},a=function(u,c){var f=i.hot.runHooks("beforeColumnResize",i.newSize,u,!0);f!==void 0&&(i.newSize=f),i.hot.getSettings().stretchH==="all"?i.clearManualSize(u):i.setManualSize(u,i.newSize),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,u,!0),c&&o()};if(this.dblclick>=2){var s=this.selectedCols.length;s>1?(ae(this.selectedCols,function(l){a(l)}),o()):ae(this.selectedCols,function(l){a(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var o=this;at(i.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return o.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=i.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(i){var o=this;if(this.pressed){var a=(i.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+a,ae(this.selectedCols,function(s){o.newSize=o.setManualSize(s,o.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},a=function(u,c){i.hot.runHooks("beforeColumnResize",i.newSize,u,!1),c&&o(),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var s=this.selectedCols.length;s>1?(ae(this.selectedCols,function(l){a(l)}),o()):ae(this.selectedCols,function(l){a(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,o=this.hot,a=o.rootWindow,s=o.rootElement;this.eventManager.addEventListener(s,"mouseover",function(l){return i.onMouseOver(l)}),this.eventManager.addEventListener(s,"mousedown",function(l){return i.onMouseDown(l)}),this.eventManager.addEventListener(a,"mousemove",function(l){return i.onMouseMove(l)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyColWidth",value:function(i,o){var a=i;if(this.enabled){var s=this.hot.toPhysicalColumn(o),l=this.columnWidthsMap.getValueAtIndex(s);this.hot.getSettings()[Q0]&&l&&(a=l)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(i,o){var a=this.columnWidthsMap.getValueAtIndex(o);return a===null&&(a=i),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){Cu(ns(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Q0}},{key:"PLUGIN_PRIORITY",get:function(){return rXe}}]),r}(jt);function mv(t){return mv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mv(t)}function iXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aXe(n.key),n)}}function oXe(t,e,r){return e&&xB(t.prototype,e),r&&xB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function aXe(t){var e=sXe(t,"string");return mv(e)==="symbol"?e:String(e)}function sXe(t,e){if(mv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(mv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var TC=0,MB=1,NB=2,uf="px",lXe=function(){function t(e){iXe(this,t),this.hot=e,this._element=null,this.state=TC}return oXe(t,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=NB}},{key:"build",value:function(){this.state===TC&&(this._element=this.hot.rootDocument.createElement("div"),this.state=MB)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=TC}},{key:"isAppended",value:function(){return this.state===NB}},{key:"isBuilt",value:function(){return this.state>=MB}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+uf),n!==void 0&&(this._element.style.left=n+uf)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+uf),n&&(this._element.style.height=n+uf)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+uf),n&&(this._element.style.marginLeft=n+uf)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),t}();const hZ=lXe;function Yd(t){return Yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yd(t)}function uXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fXe(n.key),n)}}function cXe(t,e,r){return e&&PB(t.prototype,e),r&&PB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function fXe(t){var e=hXe(t,"string");return Yd(e)==="symbol"?e:String(e)}function hXe(t,e){if(Yd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function g2(){return typeof Reflect<"u"&&Reflect.get?g2=Reflect.get.bind():g2=function(e,r,n){var i=dXe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},g2.apply(this,arguments)}function dXe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Kd(t),t!==null););return t}function pXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&D7(t,e)}function D7(t,e){return D7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},D7(t,e)}function mXe(t){var e=vXe();return function(){var n=Kd(t),i;if(e){var o=Kd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return gXe(this,i)}}function gXe(t,e){if(e&&(Yd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yXe(t)}function yXe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function vXe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kd(t){return Kd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kd(t)}var bXe="ht__manualRowMove--backlight",wXe=function(t){pXe(r,t);var e=mXe(r);function r(){return uXe(this,r),e.apply(this,arguments)}return cXe(r,[{key:"build",value:function(){g2(Kd(r.prototype),"build",this).call(this),_e(this._element,bXe)}}]),r}(hZ);const SXe=wXe;function qd(t){return qd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qd(t)}function RXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,CXe(n.key),n)}}function EXe(t,e,r){return e&&kB(t.prototype,e),r&&kB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function CXe(t){var e=_Xe(t,"string");return qd(e)==="symbol"?e:String(e)}function _Xe(t,e){if(qd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(qd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function y2(){return typeof Reflect<"u"&&Reflect.get?y2=Reflect.get.bind():y2=function(e,r,n){var i=TXe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},y2.apply(this,arguments)}function TXe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Xd(t),t!==null););return t}function OXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&F7(t,e)}function F7(t,e){return F7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},F7(t,e)}function AXe(t){var e=MXe();return function(){var n=Xd(t),i;if(e){var o=Xd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return IXe(this,i)}}function IXe(t,e){if(e&&(qd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xXe(t)}function xXe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function MXe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xd(t){return Xd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xd(t)}var NXe="ht__manualRowMove--guideline",PXe=function(t){OXe(r,t);var e=AXe(r);function r(){return RXe(this,r),e.apply(this,arguments)}return EXe(r,[{key:"build",value:function(){y2(Xd(r.prototype),"build",this).call(this),_e(this._element,NXe)}}]),r}(hZ);const kXe=PXe;function Qd(t){return Qd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qd(t)}function $Xe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $B(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,DXe(n.key),n)}}function LXe(t,e,r){return e&&$B(t.prototype,e),r&&$B(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function DXe(t){var e=FXe(t,"string");return Qd(e)==="symbol"?e:String(e)}function FXe(t,e){if(Qd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Qd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _u(){return typeof Reflect<"u"&&Reflect.get?_u=Reflect.get.bind():_u=function(e,r,n){var i=HXe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},_u.apply(this,arguments)}function HXe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=is(t),t!==null););return t}function BXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&H7(t,e)}function H7(t,e){return H7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},H7(t,e)}function UXe(t){var e=jXe();return function(){var n=is(t),i;if(e){var o=is(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return VXe(this,i)}}function VXe(t,e){if(e&&(Qd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B7(t)}function B7(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jXe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function is(t){return is=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},is(t)}Ue.getSingleton().register("beforeRowMove");Ue.getSingleton().register("afterRowMove");var OC="manualRowMove",WXe=140,Ls=new WeakMap,LB="ht__manualRowMove",Z0="show-ui",AC="on-moving--rows",IC="after-selection--rows",zXe=function(t){BXe(r,t);var e=UXe(r);function r(n){var i;return $Xe(this,r),i=e.call(this,n),Ls.set(B7(i),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),i.eventManager=new Er(B7(i)),i.backlight=new SXe(n),i.guideline=new kXe(n),i}return LXe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[OC]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollHorizontally",function(){return i.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),_e(this.hot.rootElement,LB),_u(is(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),_u(is(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){ut(this.hot.rootElement,LB),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),_u(is(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(i,o){return this.moveRows([i],o)}},{key:"moveRows",value:function(i,o){var a=Ls.get(this),s=a.cachedDropIndex,l=this.isMovePossible(i,o),u=this.hot.runHooks("beforeRowMove",i,o,s,l);if(a.cachedDropIndex=void 0,u!==!1){l&&this.hot.rowIndexMapper.moveIndexes(i,o);var c=l&&this.isRowOrderChanged(i,o);return this.hot.runHooks("afterRowMove",i,o,s,l,c),c}}},{key:"dragRow",value:function(i,o){return this.dragRows([i],o)}},{key:"dragRows",value:function(i,o){var a=this.countFinalIndex(i,o),s=Ls.get(this);return s.cachedDropIndex=o,this.moveRows(i,a)}},{key:"isMovePossible",value:function(i,o){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=i.length+o>a,l=o<0,u=i.some(function(f){return f<0}),c=i.some(function(f){return f>=a});return!(s||l||u||c)}},{key:"isRowOrderChanged",value:function(i,o){return i.some(function(a,s){return a-s!==o})}},{key:"countFinalIndex",value:function(i,o){var a=Fn(i,function(s,l){return l<o&&(s+=1),s},0);return o-a}},{key:"getRowsHeight",value:function(i,o){for(var a=this.hot.rowIndexMapper,s=0,l=i;l<=o;l++){var u=a.getRenderableFromVisualIndex(l);u!==null&&(s+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[OC];if(Array.isArray(i))this.moveRows(i,0);else if(i!==void 0){var o=this.persistentStateLoad();o.length&&this.moveRows(o,0)}}},{key:"isFixedRowTop",value:function(i){return i<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(i){return i>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualRowMove",i),i.value?i.value:[]}},{key:"prepareRowsToMoving",value:function(){var i=this.hot.getSelectedRangeLast(),o=[];if(!i)return o;var a=i.from,s=i.to,l=Math.min(a.row,s.row),u=Math.max(a.row,s.row);return Ye(l,u,function(c){o.push(c)}),o}},{key:"refreshPositions",value:function(){var i=Ls.get(this),o=i.target.coords,a=this.hot.view.getFirstFullyVisibleRow(),s=this.hot.view.getLastFullyVisibleRow(),l=this.hot.countRows();this.isFixedRowTop(o.row)&&a>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1)),this.isFixedRowBottom(o.row)&&s<l&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(s+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,c=i.target.TD,f=Zr(this.hot.rootElement),h=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,o.row-1),d=i.target.eventPageY-f.top+u.holder.scrollTop,p=u.hider.offsetHeight,m=u.TBODY.offsetTop,g=this.backlight.getOffset().top,v=this.backlight.getSize().height;this.isFixedRowTop(o.row)&&(h+=u.holder.scrollTop),o.row<0?i.target.row=a>0?a-1:a:c.offsetHeight/2+h<=d?(i.target.row=o.row+1,h+=o.row===0?c.offsetHeight-1:c.offsetHeight):i.target.row=o.row;var w=d,b=h;d+v+g>=p?w=p-v-g:d+g<m&&(w=m+Math.abs(g)),h>=p-1&&(b=p-1),this.backlight.setPosition(w),this.guideline.setPosition(b)}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(a){return i.onMouseMove(a)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){var l=this.hot.view._wt,u=l.wtTable,c=l.wtViewport,f=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=Ls.get(this);if(!h||!f||d.pressed||i.button!==0){d.pressed=!1,d.rowsToMove.length=0,ut(this.hot.rootElement,[AC,Z0]);return}var p=this.guideline.isBuilt()&&!this.guideline.isAppended(),m=this.backlight.isBuilt()&&!this.backlight.isAppended();p&&m&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var g=h.from,v=h.to,w=Math.min(g.row,v.row),b=Math.max(g.row,v.row);if(o.col<0&&o.row>=w&&o.row<=b){s.row=!0,d.pressed=!0,d.target.eventPageY=i.pageY,d.target.coords=o,d.target.TD=a,d.rowsToMove=this.prepareRowsToMoving();var E=u.holder.scrollLeft+c.getRowHeaderWidth();this.backlight.setPosition(null,E),this.backlight.setSize(u.hider.offsetWidth-E,this.getRowsHeight(w,b)),this.backlight.setOffset((this.getRowsHeight(w,o.row-1)+i.offsetY)*-1,null),_e(this.hot.rootElement,AC),this.refreshPositions()}else ut(this.hot.rootElement,IC),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(i){var o=Ls.get(this);if(!!o.pressed){if(i.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}o.target.eventPageY=i.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,a,s){var l=this.hot.getSelectedRangeLast(),u=Ls.get(this);!l||!u.pressed||(u.rowsToMove.indexOf(o.row)>-1?ut(this.hot.rootElement,Z0):_e(this.hot.rootElement,Z0),s.row=!0,s.column=!0,s.cell=!0,u.target.coords=o,u.target.TD=a)}},{key:"onMouseUp",value:function(){var i=Ls.get(this),o=i.target.row,a=i.rowsToMove.length;if(i.pressed=!1,i.backlightHeight=0,ut(this.hot.rootElement,[AC,Z0,IC]),this.hot.selection.isSelectedByRowHeader()&&_e(this.hot.rootElement,IC),!(a<1||o===void 0)){var s=i.rowsToMove[0],l=this.hot.toPhysicalRow(s),u=this.dragRows(i.rowsToMove,o);if(i.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var c=this.hot.toVisualRow(l),f=c+a-1;this.hot.selectRows(c,f)}}}},{key:"onAfterScrollHorizontally",value:function(){var i=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtViewport.getRowHeaderWidth(),a=i.holder.scrollLeft,s=o+a;this.backlight.setPosition(null,s),this.backlight.setSize(i.hider.offsetWidth-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),_u(is(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return OC}},{key:"PLUGIN_PRIORITY",get:function(){return WXe}}]),r}(jt);function Zd(t){return Zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zd(t)}function GXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function DB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,KXe(n.key),n)}}function YXe(t,e,r){return e&&DB(t.prototype,e),r&&DB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function KXe(t){var e=qXe(t,"string");return Zd(e)==="symbol"?e:String(e)}function qXe(t,e){if(Zd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Zd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tu(){return typeof Reflect<"u"&&Reflect.get?Tu=Reflect.get.bind():Tu=function(e,r,n){var i=XXe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Tu.apply(this,arguments)}function XXe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=os(t),t!==null););return t}function QXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&U7(t,e)}function U7(t,e){return U7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},U7(t,e)}function ZXe(t){var e=eQe();return function(){var n=os(t),i;if(e){var o=os(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return JXe(this,i)}}function JXe(t,e){if(e&&(Zd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V7(t)}function V7(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eQe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function os(t){return os=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},os(t)}var J0="manualRowResize",tQe=30,FB="manualRowHeights",xC=new WeakMap,rQe=function(t){QXe(r,t);var e=ZXe(r);function r(n){var i;GXe(this,r),i=e.call(this,n);var o=i.hot.rootDocument;return i.currentTH=null,i.currentRow=null,i.selectedRows=[],i.currentHeight=null,i.newSize=null,i.startY=null,i.startHeight=null,i.startOffset=null,i.handle=o.createElement("DIV"),i.guide=o.createElement("DIV"),i.eventManager=new Er(V7(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.rowHeightsMap=void 0,xC.set(V7(i),{config:void 0}),_e(i.handle,"manualRowResizer"),_e(i.guide,"manualRowResizerGuide"),i}return YXe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[J0]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.rowHeightsMap=new _l,this.rowHeightsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(o,a){return i.onModifyRowHeight(o,a)}),this.bindEvents(),Tu(os(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Tu(os(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=xC.get(this);i.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),Tu(os(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",FB,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",FB,i),i.value}},{key:"setManualSize",value:function(i,o){var a=this.hot.toPhysicalRow(i),s=Math.max(o,uq.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,s),s}},{key:"setupHandlePosition",value:function(i){var o=this;this.currentTH=i;var a=this.hot.view,s=a._wt,l=s.wtTable.getCoords(this.currentTH),u=l.row;if(!(u<0)){var c=Qt(this.currentTH),f=this.currentTH.getBoundingClientRect(),h=u<s.getSetting("fixedRowsTop"),d=u>=a.countNotHiddenRowIndexes(0,1)-s.getSetting("fixedRowsBottom"),p;h?p=s.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col):d&&(p=s.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),p||(p=s.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var m=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&m){var g=this.hot.getSelectedRange();ae(g,function(v){var w=v.getTopStartCorner().row,b=v.getBottomStartCorner().row;Ye(w,b,function(E){o.selectedRows.includes(E)||o.selectedRows.push(E)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=p.top-6,this.startHeight=parseInt(f.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(p.start,"px"),this.handle.style.width="".concat(c,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(Qt(this.handle),10),o=parseInt(this.handle.style[this.inlineDir],10)+i,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);_e(this.handle,"active"),_e(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(o,"px"),this.guide.style.width="".concat(a-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){ut(this.handle,"active"),ut(this.guide,"active")}},{key:"checkIfRowHeader",value:function(i){var o,a,s=Bu(i,["TH"],this.hot.rootElement);return s&&((o=i.parentNode)===null||o===void 0||(a=o.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"getActualRowHeight",value:function(i){var o=this.hot.view._wt.wtTable.getRowHeight(i);return o!==void 0&&this.newSize<o?o:this.newSize}},{key:"onMouseOver",value:function(i){if(!_K(i.target)&&this.checkIfRowHeader(i.target)){var o=this.getClosestTHParent(i.target);o&&(this.pressed||this.setupHandlePosition(o))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},a=function(u,c){var f=i.hot.runHooks("beforeRowResize",i.getActualRowHeight(u),u,!0);f!==void 0&&(i.newSize=f),i.setManualSize(u,i.newSize),i.hot.runHooks("afterRowResize",i.getActualRowHeight(u),u,!0),c&&o()};if(this.dblclick>=2){var s=this.selectedRows.length;s>1?(ae(this.selectedRows,function(l){a(l)}),o()):ae(this.selectedRows,function(l){a(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var o=this;at(i.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return o.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=i.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(i){var o=this;this.pressed&&(this.currentHeight=this.startHeight+(i.pageY-this.startY),ae(this.selectedRows,function(a){o.newSize=o.setManualSize(a,o.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},a=function(u,c){i.hot.runHooks("beforeRowResize",i.getActualRowHeight(u),u,!1),c&&o(),i.saveManualRowHeights(),i.hot.runHooks("afterRowResize",i.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var s=this.selectedRows.length;s>1?(ae(this.selectedRows,function(l){a(l)}),o()):ae(this.selectedRows,function(l){a(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,o=this.hot,a=o.rootElement,s=o.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(l){return i.onMouseOver(l)}),this.eventManager.addEventListener(a,"mousedown",function(l){return i.onMouseDown(l)}),this.eventManager.addEventListener(s,"mousemove",function(l){return i.onMouseMove(l)}),this.eventManager.addEventListener(s,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyRowHeight",value:function(i,o){var a=i;if(this.enabled){var s=this.hot.toPhysicalRow(o),l=this.rowHeightsMap.getValueAtIndex(s);this.hot.getSettings()[J0]&&l&&(a=l)}return a}},{key:"onMapInit",value:function(){var i=this,o=xC.get(this),a=this.hot.getSettings()[J0],s=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof s<"u"?s.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)}):Array.isArray(a)?(a.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)}),o.config=a):a===!0&&Array.isArray(o.config)&&o.config.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)})},!0)}},{key:"destroy",value:function(){Tu(os(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return J0}},{key:"PLUGIN_PRIORITY",get:function(){return tQe}}]),r}(jt);function gv(t){return gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gv(t)}var HB,BB,UB,VB;function eb(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function nQe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oQe(n.key),n)}}function iQe(t,e,r){return e&&jB(t.prototype,e),r&&jB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function oQe(t){var e=aQe(t,"string");return gv(e)==="symbol"?e:String(e)}function aQe(t,e){if(gv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(gv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var sQe=function(){function t(e,r,n,i,o,a){nQe(this,t),this.row=e,this.col=r,this.rowspan=n,this.colspan=i,this.removed=!1,this.cellCoordsFactory=o,this.cellRangeFactory=a}return iQe(t,[{key:"normalize",value:function(r){var n=r.countRows(),i=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var i=r[0]||r[1],o=n+Math.abs(r[0]||r[1])-1,a=r[0]?"colspan":"rowspan",s=r[0]?"col":"row",l=Math.min(n,o),u=Math.max(n,o),c=this[s],f=this[s]+this[a]-1;if(c>=n&&(this[s]+=i),i>0)n<=f&&n>c&&(this[a]+=i);else if(i<0){if(l<=c&&u>=f)return this.removed=!0,!1;if(c>=l&&c<=u){var h=u-c+1,d=Math.abs(i)-h;this[s]-=d+i,this[a]-=h}else if(c<=l&&f>=u)this[a]+=i;else if(c<=l&&f>=l&&f<u){var p=f-l+1;this[a]-=p}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return Gt(HB||(HB=eb(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return Gt(BB||(BB=eb(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return Gt(UB||(UB=eb(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return Gt(VB||(VB=eb(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,i){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=i||r.col+r.colspan-1>=i}}]),t}();const Ko=sQe;function j7(t,e,r,n){e?e.row===r&&e.col===n?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function yv(t){return yv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yv(t)}var WB;function lQe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function zB(t){return hQe(t)||fQe(t)||cQe(t)||uQe()}function uQe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cQe(t,e){if(!!t){if(typeof t=="string")return W7(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W7(t,e)}}function fQe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function hQe(t){if(Array.isArray(t))return W7(t)}function W7(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function dQe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function GB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mQe(n.key),n)}}function pQe(t,e,r){return e&&GB(t.prototype,e),r&&GB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mQe(t){var e=gQe(t,"string");return yv(e)==="symbol"?e:String(e)}function gQe(t,e){if(yv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(yv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yQe=function(){function t(e){dQe(this,t),this.plugin=e,this.mergedCells=[],this.hot=e.hot}return pQe(t,[{key:"get",value:function(r,n){var i=this.mergedCells,o=!1;return ae(i,function(a){return a.row<=r&&a.row+a.rowspan-1>=r&&a.col<=n&&a.col+a.colspan-1>=n?(o=a,!1):!0}),o}},{key:"getByRange",value:function(r){var n=this.mergedCells,i=!1;return ae(n,function(o){return o.row<=r.from.row&&o.row+o.rowspan-1>=r.to.row&&o.col<=r.from.col&&o.col+o.colspan-1>=r.to.col?(i=o,i):!0}),i}},{key:"getWithinRange",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.mergedCells,a=[],s=r;if(!s.includesRange){var l=this.hot._createCellCoords(s.from.row,s.from.col),u=this.hot._createCellCoords(s.to.row,s.to.col);s=this.hot._createCellRange(l,l,u)}return ae(o,function(c){var f=n.hot._createCellCoords(c.row,c.col),h=n.hot._createCellCoords(c.row+c.rowspan-1,c.col+c.colspan-1),d=n.hot._createCellRange(f,f,h);i?s.overlaps(d)&&a.push(c):s.includesRange(d)&&a.push(c)}),a.length?a:!1}},{key:"add",value:function(r){var n=this.mergedCells,i=r.row,o=r.col,a=r.rowspan,s=r.colspan,l=new Ko(i,o,a,s,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(i,o),c=this.isOverlapping(l);return!u&&!c?(this.hot&&l.normalize(this.hot),n.push(l),l):(Xt(t.IS_OVERLAPPING_WARNING(l)),!1)}},{key:"remove",value:function(r,n){var i=this.mergedCells,o=this.get(r,n),a=o?this.mergedCells.indexOf(o):-1;return o&&a!==-1?(i.splice(a,1),o):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,i=[],o=[];ae(n,function(a){var s=r.hot.getCell(a.row,a.col);s&&i.push([s,r.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,ae(i,function(a,s){Ye(0,a.rowspan-1,function(l){Ye(0,a.colspan-1,function(u){if(u!==0||l!==0){var c=r.hot.getCell(a.row+l,a.col+u);c&&o.push([c,null,null,null])}})}),i[s][1]=null}),ae(i,function(a){j7.apply(void 0,zB(a))}),ae(o,function(a){j7.apply(void 0,zB(a))})}},{key:"isOverlapping",value:function(r){var n=this,i=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),o=!1;return ae(this.mergedCells,function(a){var s=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(a.row,a.col),n.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1));return s.overlaps(i)?(o=!0,!1):!0}),o}},{key:"isFirstRenderableMergedCell",value:function(r,n){var i=this.get(r,n);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var i=this.get(r,n);if(!i||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(o,a)}},{key:"shiftCollections",value:function(r,n,i){var o=this,a=[0,0];switch(r){case"right":a[0]+=i;break;case"left":a[0]-=i;break;case"down":a[1]+=i;break;case"up":a[1]-=i;break}ae(this.mergedCells,function(s){s.shift(a,n)}),ET(this.mergedCells.length-1,0,function(s){var l=o.mergedCells[s];l&&l.removed&&o.mergedCells.splice(o.mergedCells.indexOf(l),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return Gt(WB||(WB=lQe(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),t}();const vQe=yQe;function vv(t){return vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vv(t)}function jl(t,e){return RQe(t)||SQe(t,e)||wQe(t,e)||bQe()}function bQe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wQe(t,e){if(!!t){if(typeof t=="string")return YB(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YB(t,e)}}function YB(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function SQe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function RQe(t){if(Array.isArray(t))return t}function EQe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function KB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_Qe(n.key),n)}}function CQe(t,e,r){return e&&KB(t.prototype,e),r&&KB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _Qe(t){var e=TQe(t,"string");return vv(e)==="symbol"?e:String(e)}function TQe(t,e){if(vv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(vv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var OQe=function(){function t(e){EQe(this,t),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return CQe(t,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var i=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?i="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?i="up":n[1]===r[1]&&n[2]===r[2]?i="right":i="left",i}},{key:"snapDragArea",value:function(r,n,i,o){var a=n.slice(0),s=this.getAutofillSize(r,n,i),l=jl(r,4),u=l[0],c=l[1],f=l[2],h=l[3],d=["up","down"].indexOf(i)>-1,p=d?f-u+1:h-c+1,m=Math.floor(s/p)*p,g=s-m,v=this.getFarthestCollection(r,n,i,o);if(v){if(i==="down"){var w=v.row+v.rowspan-u-g,b=a[2]+w;b>=this.plugin.hot.countRows()?a[2]-=g:a[2]+=g?w:0}else if(i==="right"){var E=v.col+v.colspan-c-g,A=a[3]+E;A>=this.plugin.hot.countCols()?a[3]-=g:a[3]+=g?E:0}else if(i==="up"){var M=f-g-v.row+1,k=a[0]+M;k<0?a[0]+=g:a[0]-=g?M:0}else if(i==="left"){var O=h-g-v.col+1,x=a[1]+O;x<0?a[1]+=g:a[1]-=g?O:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:i,foundMergedCells:o,fillSize:s,dragArea:a,cycleLength:p}),a}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),Jr(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,i){var o=jl(r,4),a=o[0],s=o[1],l=o[2],u=o[3],c=jl(n,4),f=c[0],h=c[1],d=c[2],p=c[3];switch(i){case"up":return a-f;case"down":return d-l;case"left":return s-h;case"right":return p-u;default:return null}}},{key:"getDragArea",value:function(r,n,i){var o=jl(r,4),a=o[0],s=o[1],l=o[2],u=o[3],c=jl(n,4),f=c[0],h=c[1],d=c[2],p=c[3];switch(i){case"up":return[f,h,a-1,u];case"down":return[l+1,s,d,u];case"left":return[f,h,l,s-1];case"right":return[a,u+1,d,p];default:return null}}},{key:"getFarthestCollection",value:function(r,n,i,o){var a=jl(r,4),s=a[0],l=a[1],u=a[2],c=a[3],f=["up","down"].indexOf(i)>-1,h=f?u:c,d=f?s:l,p=this.getAutofillSize(r,n,i),m=f?u-s+1:c-l+1,g=Math.floor(p/m)*m,v=p-g,w=null,b=null,E=null;switch(i){case"up":w="includesVertically",E=h-v+1;break;case"left":w="includesHorizontally",E=h-v+1;break;case"down":w="includesVertically",E=d+v-1;break;case"right":w="includesHorizontally",E=d+v-1;break}return ae(o,function(A){A[w](E)&&A.isFarther(b,i)&&(b=A)}),b}},{key:"recreateAfterDataPopulation",value:function(r){if(!!this.currentFillData){var n=this.getRangeFromChanges(r),i=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,a=function(h,d){switch(o){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},s=0,l=null,u=1;do for(var c=0;c<i.length;c+=1){if(l=i[c],s=u*this.currentFillData.cycleLength,a(l,s))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:l.row-s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-s,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+s,colspan:l.colspan});break}c===i.length-1&&(u+=1)}while(a(l,s));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,i={min:null,max:null},o={min:null,max:null};return ae(r,function(a){var s=a[0],l=n.plugin.hot.propToCol(a[1]);(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s),(o.min===null||l<o.min)&&(o.min=l),(o.max===null||l>o.max)&&(o.max=l)}),{from:{row:i.min,column:o.min},to:{row:i.max,column:o.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,i){var o=this.getDragArea(r,n,i),a=jl(o,4),s=a[0],l=a[1],u=a[2],c=a[3],f=this.plugin.hot._createCellCoords(s,l),h=this.plugin.hot._createCellCoords(u,c),d=this.plugin.hot._createCellRange(f,f,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),t}();const AQe=OQe;function bv(t){return bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bv(t)}function IQe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,MQe(n.key),n)}}function xQe(t,e,r){return e&&qB(t.prototype,e),r&&qB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function MQe(t){var e=NQe(t,"string");return bv(e)==="symbol"?e:String(e)}function NQe(t,e){if(bv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(bv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var PQe=function(){function t(e){IQe(this,t),this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return xQe(t,[{key:"snapDelta",value:function(r,n,i){var o=n.to,a=o.row+r.row,s=o.col+r.col;r.row?this.jumpOverMergedCell(r,i,a):r.col&&this.jumpOverMergedCell(r,i,s)}},{key:"jumpOverMergedCell",value:function(r,n,i){var o=r.row||r.col,a=null,s=null,l=null;r.row?(a=n.includesVertically(i),s=n.row,l=n.getLastRow()):r.col&&(a=n.includesHorizontally(i),s=n.col,l=n.getLastColumn()),o!==0&&(o>0?a&&i!==s&&(o+=l-i+1):a&&i!==l&&(o-=i-s+1),r.row?r.row=o:r.col&&(r.col=o))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,i,o){var a=Math.min(i[0],i[2]),s=Math.min(i[1],i[3]),l=Math.max(i[0],i[2]),u=Math.max(i[1],i[3]);if(o!==void 0){var c=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(!!c){var f=this.plugin.mergedCellsCollection.get(r,n);if(!!f){var h=f.getLastRow(),d=f.getLastColumn(),p=a<=f.row&&s<=f.col&&l>=h&&u>=d;if(p)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(o);if(this.plugin.selectionCalculations.isMergeCellFullySelected(f,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var i=[];if(!n||!r)return!1;for(var o=0;o<r.rowspan;o+=1)for(var a=0;a<r.colspan;a+=1)i.push(this.hot._createCellCoords(r.row+o,r.col+a));for(var s=0;s<i.length;s+=1){for(var l=[],u=0;u<n.length;u+=1)l[u]=n[u].includes(i[s]);if(!l.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),t}();const kQe=PQe;function $Qe(t){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=t.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(G3)}return this.getTranslatedPhrase(z3)},callback:function(){t.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=Ko.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function Jd(t){return Jd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jd(t)}function LQe(t,e){return HQe(t)||FQe(t,e)||dZ(t,e)||DQe()}function DQe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FQe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function HQe(t){if(Array.isArray(t))return t}function BQe(t){return jQe(t)||VQe(t)||dZ(t)||UQe()}function UQe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dZ(t,e){if(!!t){if(typeof t=="string")return z7(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z7(t,e)}}function VQe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function jQe(t){if(Array.isArray(t))return z7(t)}function z7(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function WQe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function XB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,GQe(n.key),n)}}function zQe(t,e,r){return e&&XB(t.prototype,e),r&&XB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function GQe(t){var e=YQe(t,"string");return Jd(e)==="symbol"?e:String(e)}function YQe(t,e){if(Jd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Jd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qf(){return typeof Reflect<"u"&&Reflect.get?Qf=Reflect.get.bind():Qf=function(e,r,n){var i=KQe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Qf.apply(this,arguments)}function KQe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=cl(t),t!==null););return t}function qQe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&G7(t,e)}function G7(t,e){return G7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},G7(t,e)}function XQe(t){var e=ZQe();return function(){var n=cl(t),i;if(e){var o=cl(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return QQe(this,i)}}function QQe(t,e){if(e&&(Jd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pZ(t)}function pZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ZQe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cl(t){return cl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cl(t)}Ue.getSingleton().register("beforeMergeCells");Ue.getSingleton().register("afterMergeCells");Ue.getSingleton().register("beforeUnmergeCells");Ue.getSingleton().register("afterUnmergeCells");var Bm="mergeCells",JQe=150,QB=new WeakMap,ZB=Bm,eZe=function(t){qQe(r,t);var e=XQe(r);function r(n){var i;return WQe(this,r),i=e.call(this,n),QB.set(pZ(i),{lastDesiredCoords:null}),i.mergedCellsCollection=null,i.autofillCalculations=null,i.selectionCalculations=null,i}return zQe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Bm]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mergedCellsCollection=new vQe(this),this.autofillCalculations=new AQe(this),this.selectionCalculations=new kQe(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("modifyTransformStart",function(){return i.onModifyTransformStart.apply(i,arguments)}),this.addHook("afterModifyTransformStart",function(){return i.onAfterModifyTransformStart.apply(i,arguments)}),this.addHook("modifyTransformEnd",function(){return i.onModifyTransformEnd.apply(i,arguments)}),this.addHook("modifyGetCellCoords",function(){return i.onModifyGetCellCoords.apply(i,arguments)}),this.addHook("beforeSetRangeStart",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeEnd",function(){return i.onBeforeSetRangeEnd.apply(i,arguments)}),this.addHook("afterIsMultipleSelection",function(){return i.onAfterIsMultipleSelection.apply(i,arguments)}),this.addHook("afterRenderer",function(){return i.onAfterRenderer.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.addMergeActionsToContextMenu.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(){return i.onAfterGetCellMeta.apply(i,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return i.onAfterViewportRowCalculatorOverride.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),this.addHook("modifyAutofillRange",function(){return i.onModifyAutofillRange.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeDrawBorders",function(){return i.onBeforeDrawAreaBorders.apply(i,arguments)}),this.addHook("afterDrawSelection",function(){return i.onAfterDrawSelection.apply(i,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return i.onBeforeRemoveCellClassNames.apply(i,arguments)}),this.addHook("beforeUndoStackChange",function(o,a){if(a==="MergeCells")return!1}),this.registerShortcuts(),Qf(cl(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),Qf(cl(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var i=this.hot.getSettings()[Bm];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(i),Qf(cl(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var i=this;if(!!lK()){var o=[],a=[];this.mergedCellsCollection.mergedCells.forEach(function(s){for(var l=s.row,u=s.rowspan,c=l+1;c<l+u;c++)a.push(c)}),a=BQe(new Set(a)),a.forEach(function(s){var l=i.hot.rowIndexMapper.getRenderableFromVisualIndex(s);i.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var c=u.getRow(l);c&&(c.style.background=Pg(c,"backgroundColor").replace(")",", 0.99)"),o.push(c))})}),this.hot._registerTimeout(function(){o.forEach(function(s){s.style.background=Pg(s,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(i){var o=!0;return i?(Ko.containsNegativeValues(i)?(Xt(Ko.NEGATIVE_VALUES_WARNING(i)),o=!1):Ko.isOutOfBounds(i,this.hot.countRows(),this.hot.countCols())?(Xt(Ko.IS_OUT_OF_BOUNDS_WARNING(i)),o=!1):Ko.isSingleCell(i)?(Xt(Ko.IS_SINGLE_CELL(i)),o=!1):Ko.containsZeroSpan(i)&&(Xt(Ko.ZERO_SPAN_WARNING(i)),o=!1),o):!1}},{key:"generateFromSettings",value:function(i){var o=this;if(Array.isArray(i)){var a=[];if(ae(i,function(s){if(!!o.validateSetting(s)){var l=o.hot._createCellCoords(s.row,s.col),u=o.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),c=o.hot._createCellRange(l,l,u);o.mergeRange(c,!0,!0),Ye(s.row,s.row+s.rowspan-1,function(f){Ye(s.col,s.col+s.colspan-1,function(h){f===s.row&&h===s.col||a.push([f,h,null])})})}}),a.length===0)return;this.hot.setDataAtCell(a)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return o?!0:this.validateSetting(i)}},{key:"toggleMergeOnSelection",value:function(){var i=this.hot.getSelectedRangeLast();if(!!i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var o=i.from,a=i.to;this.toggleMerge(i),this.hot.selectCell(o.row,o.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!!i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var o=i.from,a=i.to;this.unmergeRange(i,!0),this.mergeRange(i),this.hot.selectCell(o.row,o.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!!i){var o=i.from,a=i.to;this.unmergeRange(i,!0),this.hot.selectCell(o.row,o.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=i.getTopStartCorner(),u=i.getBottomEndCorner(),c={row:l.row,col:l.col,rowspan:u.row-l.row+1,colspan:u.col-l.col+1},f=[],h=null;if(!this.canMergeRange(c,a))return!1;this.hot.runHooks("beforeMergeCells",i,a),Ye(0,c.rowspan-1,function(p){Ye(0,c.colspan-1,function(m){var g=null;f[p]||(f[p]=[]),p===0&&m===0?g=o.hot.getSourceDataAtCell(o.hot.toPhysicalRow(c.row),o.hot.toPhysicalColumn(c.col)):o.hot.setCellMeta(c.row+p,c.col+m,"hidden",!0),f[p][m]=g})}),this.hot.setCellMeta(c.row,c.col,"spanned",!0);var d=this.mergedCellsCollection.add(c);return d?(s?h=[c.row,c.col,f]:this.hot.populateFromArray(c.row,c.col,f,void 0,void 0,this.pluginName),a||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",i,c,a),h):!0}},{key:"unmergeRange",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.mergedCellsCollection.getWithinRange(i);!s||(this.hot.runHooks("beforeUnmergeCells",i,a),ae(s,function(l){o.mergedCellsCollection.remove(l.row,l.col),Ye(0,l.rowspan-1,function(u){Ye(0,l.colspan-1,function(c){o.hot.removeCellMeta(l.row+u,l.col+c,"hidden")})}),o.hot.removeCellMeta(l.row,l.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",i,a),this.hot.render())}},{key:"toggleMerge",value:function(i){var o=this.mergedCellsCollection.get(i.from.row,i.from.col),a=o.row===i.from.row&&o.col===i.from.col&&o.row+o.rowspan-1===i.to.row&&o.col+o.colspan-1===i.to.col;a?this.unmergeRange(i):this.mergeSelection(i)}},{key:"merge",value:function(i,o,a,s){var l=this.hot._createCellCoords(i,o),u=this.hot._createCellCoords(a,s);this.mergeRange(this.hot._createCellRange(l,l,u))}},{key:"unmerge",value:function(i,o,a,s){var l=this.hot._createCellCoords(i,o),u=this.hot._createCellCoords(a,s);this.unmergeRange(this.hot._createCellRange(l,l,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[Bm]),this.hot.render()}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),a=o.getContext("grid");a.addShortcut({keys:[["Control","m"]],callback:function(){i.toggleMerge(i.hot.getSelectedRangeLast()),i.hot.render()},runOnlyIf:function(l){return!l.altKey},group:ZB})}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("grid");o.removeShortcutsByGroup(ZB)}},{key:"onAfterIsMultipleSelection",value:function(i){if(i){for(var o=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),s=0;s<o.length;s+=1)if(a.from.row===o[s].row&&a.from.col===o[s].col&&a.to.row===o[s].row+o[s].rowspan-1&&a.to.col===o[s].col+o[s].colspan-1)return!1}return i}},{key:"onModifyTransformStart",value:function(i){var o=QB.get(this),a=this.hot.getSelectedRangeLast(),s={row:i.row,col:i.col},l=null,u=this.hot._createCellCoords(a.highlight.row,a.highlight.col),c=this.mergedCellsCollection.get(u.row,u.col);if(o.lastDesiredCoords||(o.lastDesiredCoords=this.hot._createCellCoords(null,null)),c){var f=this.hot._createCellCoords(c.row,c.col),h=this.hot._createCellCoords(c.row+c.rowspan-1,c.col+c.colspan-1),d=this.hot._createCellRange(f,f,h);d.includes(o.lastDesiredCoords)||(o.lastDesiredCoords=this.hot._createCellCoords(null,null)),s.row=o.lastDesiredCoords.row?o.lastDesiredCoords.row-u.row:s.row,s.col=o.lastDesiredCoords.col?o.lastDesiredCoords.col-u.col:s.col,i.row>0?s.row=c.row+c.rowspan-1-u.row+i.row:i.row<0&&(s.row=u.row-c.row+i.row),i.col>0?s.col=c.col+c.colspan-1-u.col+i.col:i.col<0&&(s.col=u.col-c.col+i.col)}l=this.hot._createCellCoords(a.highlight.row+s.row,a.highlight.col+s.col);var p=this.mergedCellsCollection.get(l.row,l.col);if(p){var m=this.mergedCellsCollection.getFirstRenderableCoords(p.row,p.col);o.lastDesiredCoords=l,s={row:m.row-u.row,col:m.col-u.col}}s.row!==0&&(i.row=s.row),s.col!==0&&(i.col=s.col)}},{key:"onModifyTransformEnd",value:function(i){var o=this,a=this.hot.getSelectedRangeLast(),s=hi(i),l=this.selectionCalculations.getUpdatedSelectionRange(a,i),u=hi(s),c=this.mergedCellsCollection.getWithinRange(l,!0);do u=hi(s),this.selectionCalculations.getUpdatedSelectionRange(a,s),ae(c,function(f){o.selectionCalculations.snapDelta(s,a,f)});while(s.row!==u.row||s.col!==u.col);i.row=s.row,i.col=s.col}},{key:"onModifyGetCellCoords",value:function(i,o){if(!(i<0||o<0)){var a=this.mergedCellsCollection.get(i,o);if(!!a){var s=a.row,l=a.col,u=a.colspan,c=a.rowspan;return[s,l,s+c-1,l+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(i){i.items.push({name:"---------"},$Qe(this))}},{key:"onAfterRenderer",value:function(i,o,a){var s=this.mergedCellsCollection.get(o,a),l=St(s)?hi(s):void 0;if(St(l)){var u=this.hot,c=u.rowIndexMapper,f=u.columnIndexMapper,h=l.row,d=l.col,p=l.colspan,m=l.rowspan,g=this.translateMergedCellToRenderable(h,m,d,p),v=LQe(g,2),w=v[0],b=v[1],E=c.getRenderableFromVisualIndex(o),A=f.getRenderableFromVisualIndex(a),M=w-E+1,k=b-A+1;l.row=c.getNearestNotHiddenIndex(l.row,1),l.col=f.getNearestNotHiddenIndex(l.col,1),l.rowspan=Math.min(l.rowspan,M),l.colspan=Math.min(l.colspan,k)}j7(i,l,o,a)}},{key:"onBeforeSetRangeStart",value:function(i){if(this.mergedCellsCollection.isFirstRenderableMergedCell(i.row,i.col)){var o=this.mergedCellsCollection.get(i.row,i.col),a=[o.row,o.col];i.row=a[0],i.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(i){var o=this.hot.getSelectedRangeLast();o.highlight=this.hot._createCellCoords(o.highlight.row,o.highlight.col),o.to=i;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var s=0;s<this.mergedCellsCollection.mergedCells.length;s+=1){var l=this.mergedCellsCollection.mergedCells[s],u=l.getRange();o.expandByRange(u)&&(i.row=o.to.row,i.col=o.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(i,o,a){var s=this.mergedCellsCollection.get(i,o);s&&(s.row!==i||s.col!==o?a.copyable=!1:(a.rowspan=s.rowspan,a.colspan=s.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(i){var o=this.hot.countCols();this.modifyViewportRowStart(i,o),this.modifyViewportRowEnd(i,o)}},{key:"modifyViewportRowStart",value:function(i,o){for(var a=this.hot.rowIndexMapper,s=a.getVisualFromRenderableIndex(i.startRow),l=0;l<o;l+=1){var u=this.mergedCellsCollection.get(s,l);if(St(u)){var c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.row,1));if(c<i.startRow){i.startRow=c,this.modifyViewportRowStart(i,o);return}}}}},{key:"modifyViewportRowEnd",value:function(i,o){for(var a=this.hot.rowIndexMapper,s=a.getVisualFromRenderableIndex(i.endRow),l=0;l<o;l+=1){var u=this.mergedCellsCollection.get(s,l);if(St(u)){var c=u.row+u.rowspan-1,f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(c,-1));if(f>i.endRow){i.endRow=f,this.modifyViewportRowEnd(i,o);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){var o=this.hot.countRows();this.modifyViewportColumnStart(i,o),this.modifyViewportColumnEnd(i,o)}},{key:"modifyViewportColumnStart",value:function(i,o){for(var a=this.hot.columnIndexMapper,s=a.getVisualFromRenderableIndex(i.startColumn),l=0;l<o;l+=1){var u=this.mergedCellsCollection.get(l,s);if(St(u)){var c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.col,1));if(c<i.startColumn){i.startColumn=c,this.modifyViewportColumnStart(i,o);return}}}}},{key:"modifyViewportColumnEnd",value:function(i,o){for(var a=this.hot.columnIndexMapper,s=a.getVisualFromRenderableIndex(i.endColumn),l=0;l<o;l+=1){var u=this.mergedCellsCollection.get(l,s);if(St(u)){var c=u.col+u.colspan-1,f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(c,-1));if(f>i.endColumn){i.endColumn=f,this.modifyViewportColumnEnd(i,o);return}}}}},{key:"translateMergedCellToRenderable",value:function(i,o,a,s){var l=this.hot,u=l.rowIndexMapper,c=l.columnIndexMapper,f,h;o===0?f=u.getNearestNotHiddenIndex(i,1):f=u.getNearestNotHiddenIndex(i+o-1,-1),s===0?h=c.getNearestNotHiddenIndex(a,1):h=c.getNearestNotHiddenIndex(a+s-1,-1);var d=i>=0?u.getRenderableFromVisualIndex(f):i,p=a>=0?c.getRenderableFromVisualIndex(h):a;return[d,p]}},{key:"onModifyAutofillRange",value:function(i,o){this.autofillCalculations.correctSelectionAreaSize(o);var a=this.autofillCalculations.getDirection(o,i),s=i;if(this.autofillCalculations.dragAreaOverlapsCollections(o,s,a))return s=o,s;var l=this.mergedCellsCollection.getWithinRange({from:{row:o[0],col:o[1]},to:{row:o[2],col:o[3]}});return l&&(s=this.autofillCalculations.snapDragArea(o,s,a,l)),s}},{key:"onAfterCreateCol",value:function(i,o){this.mergedCellsCollection.shiftCollections("right",i,o)}},{key:"onAfterRemoveCol",value:function(i,o){this.mergedCellsCollection.shiftCollections("left",i,o)}},{key:"onAfterCreateRow",value:function(i,o,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",i,o)}},{key:"onAfterRemoveRow",value:function(i,o){this.mergedCellsCollection.shiftCollections("up",i,o)}},{key:"onAfterChange",value:function(i,o){o==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(i)}},{key:"onBeforeDrawAreaBorders",value:function(i,o){if(o&&o==="area"){var a=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getWithinRange(a);ae(s,function(l){a.getBottomEndCorner().row===l.getLastRow()&&a.getBottomEndCorner().col===l.getLastColumn()&&(i[2]=l.row,i[3]=l.col)})}}},{key:"onAfterModifyTransformStart",value:function(i,o,a){if(!!this.enabled){var s=this.mergedCellsCollection.get(i.row,i.col);if(!!s){var l=o>0,u=o<0,c=a<0,f=a>0,h=s.row+s.rowspan-1===this.hot.countRows()-1,d=s.row===0,p=s.col+s.colspan-1===this.hot.countCols()-1,m=s.col===0;(l&&h||u&&d||f&&p||c&&m)&&(i.row=s.row,i.col=s.col)}}}},{key:"onAfterDrawSelection",value:function(i,o,a,s){if(!!a)return this.selectionCalculations.getSelectedMergedCellClassName(i,o,a,s)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return Bm}},{key:"PLUGIN_PRIORITY",get:function(){return JQe}}]),r}(jt);function JB(t){return iZe(t)||nZe(t)||rZe(t)||tZe()}function tZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rZe(t,e){if(!!t){if(typeof t=="string")return eU(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eU(t,e)}}function eU(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function nZe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function iZe(t){if(Array.isArray(t))return t}function oZe(t,e){return function(r,n){var i=JB(r),o=i.slice(1),a=JB(n),s=a.slice(1);return function l(u){var c=t[u],f=e[u],h=o[u],d=s[u],p=f.multiColumnSorting,m=p.compareFunctionFactory?p.compareFunctionFactory:mX(f.type),g=m(c,f,p)(h,d);if(g===oa){var v=u+1;if(typeof e[v]<"u")return l(v)}return g}(0)}}var tU;function aZe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function rU(){Xt(Gt(tU||(tU=aZe(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var mZ="sort";function sZe(t,e,r){var n=[];return r===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push("".concat(mZ,"-").concat(t.getIndexOfColumnInSortQueue(e)+1)),n}function lZe(t){var e=t.className.split(" "),r=new RegExp("^".concat(mZ,"-[0-9]{1,2}$"));return e.filter(function(n){return r.test(n)})}function ep(t){return ep=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ep(t)}function uZe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fZe(n.key),n)}}function cZe(t,e,r){return e&&nU(t.prototype,e),r&&nU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function fZe(t){var e=hZe(t,"string");return ep(e)==="symbol"?e:String(e)}function hZe(t,e){if(ep(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ep(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Oi(){return typeof Reflect<"u"&&Reflect.get?Oi=Reflect.get.bind():Oi=function(e,r,n){var i=dZe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Oi.apply(this,arguments)}function dZe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=zn(t),t!==null););return t}function pZe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Y7(t,e)}function Y7(t,e){return Y7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Y7(t,e)}function mZe(t){var e=vZe();return function(){var n=zn(t),i;if(e){var o=zn(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return gZe(this,i)}}function gZe(t,e){if(e&&(ep(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yZe(t)}function yZe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function vZe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zn(t){return zn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zn(t)}var K7="multiColumnSorting",bZe=170,wZe="append",iU="columnSorting";pX(K7,oZe);var SZe=function(t){pZe(r,t);var e=mZe(r);function r(n){var i;return uZe(this,r),i=e.call(this,n),i.pluginKey=K7,i}return cZe(r,[{key:"isEnabled",value:function(){return Oi(zn(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[iU]&&rU(),Oi(zn(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Oi(zn(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){Oi(zn(r.prototype),"sort",this).call(this,i)}},{key:"clearSort",value:function(){Oi(zn(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Oi(zn(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(i){return Oi(zn(r.prototype),"getSortConfig",this).call(this,i)}},{key:"setSortConfig",value:function(i){Oi(zn(r.prototype),"setSortConfig",this).call(this,i)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i:[i]}},{key:"updateHeaderClasses",value:function(i){for(var o,a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(o=Oi(zn(r.prototype),"updateHeaderClasses",this)).call.apply(o,[this,i].concat(s)),ut(i,lZe(i)),this.enabled!==!1&&_e(i,sZe.apply(void 0,s))}},{key:"onUpdateSettings",value:function(i){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[iU]&&rU(),Oi(zn(r.prototype),"onUpdateSettings",this).call(this,i)}},{key:"onAfterOnCellMouseDown",value:function(i,o){OO(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(o.col),this.sort(this.getNextSortConfig(o.col,wZe))):this.sort(this.getColumnNextConfig(o.col)))}}],[{key:"PLUGIN_KEY",get:function(){return K7}},{key:"PLUGIN_PRIORITY",get:function(){return bZe}}]),r}(yX);function tp(t){return tp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tp(t)}function RZe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,CZe(n.key),n)}}function EZe(t,e,r){return e&&oU(t.prototype,e),r&&oU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function CZe(t){var e=_Ze(t,"string");return tp(e)==="symbol"?e:String(e)}function _Ze(t,e){if(tp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(tp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function v2(){return typeof Reflect<"u"&&Reflect.get?v2=Reflect.get.bind():v2=function(e,r,n){var i=TZe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},v2.apply(this,arguments)}function TZe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=rp(t),t!==null););return t}function OZe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&q7(t,e)}function q7(t,e){return q7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},q7(t,e)}function AZe(t){var e=MZe();return function(){var n=rp(t),i;if(e){var o=rp(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return IZe(this,i)}}function IZe(t,e){if(e&&(tp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xZe(t)}function xZe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function MZe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rp(t){return rp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rp(t)}var NZe="multipleSelectionHandles",PZe=160,kZe=function(t){OZe(r,t);var e=AZe(r);function r(n){var i;return RZe(this,r),i=e.call(this,n),i.dragged=[],i.eventManager=null,i.lastSetCell=null,i}return EZe(r,[{key:"isEnabled",value:function(){return na()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Er(this)),this.registerListeners(),v2(rp(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var i=this,o=this,a=this.hot.rootElement;function s(l){if(o.dragged.length===1)return o.dragged.splice(0,o.dragged.length),!0;var u=o.dragged.indexOf(l);if(u===-1)return!1;u===0?o.dragged=o.dragged.slice(0,1):u===1&&(o.dragged=o.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(l){var u;if(at(l.target,"topSelectionHandle-HitArea"))return u=o.hot.getSelectedRangeLast(),o.dragged.push("top"),o.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1;if(at(l.target,"bottomSelectionHandle-HitArea"))return u=o.hot.getSelectedRangeLast(),o.dragged.push("bottom"),o.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(l){if(at(l.target,"topSelectionHandle-HitArea"))return s.call(o,"top"),o.touchStartRange=void 0,l.preventDefault(),!1;if(at(l.target,"bottomSelectionHandle-HitArea"))return s.call(o,"bottom"),o.touchStartRange=void 0,l.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(l){var u=i.hot.rootDocument,c,f,h,d,p,m;if(o.dragged.length!==0){var g=u.elementFromPoint(l.touches[0].clientX,l.touches[0].clientY);!g||g===o.lastSetCell||((g.nodeName==="TD"||g.nodeName==="TH")&&(c=o.hot.getCoords(g),c.col===-1&&(c.col=0),f=o.hot.getSelectedRangeLast(),h=f.getWidth(),d=f.getHeight(),p=f.getDirection(),h===1&&d===1&&o.hot.selection.setRangeEnd(c),m=o.getCurrentRangeCoords(f,c,o.touchStartRange.direction,p,o.dragged[0]),m.start!==null&&o.hot.selection.setRangeStart(m.start),o.hot.selection.setRangeEnd(m.end),o.lastSetCell=g),l.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(i,o,a,s,l){var u=i.getTopStartCorner(),c=i.getBottomEndCorner(),f=i.getBottomStartCorner(),h=i.getTopEndCorner(),d={start:null,end:null};switch(a){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":l==="top"?d={start:this.hot._createCellCoords(o.row,i.highlight.col),end:this.hot._createCellCoords(f.row,o.col)}:d={start:this.hot._createCellCoords(i.highlight.row,o.col),end:this.hot._createCellCoords(o.row,u.col)};break;case"SE-NW":l==="bottom"&&(d={start:this.hot._createCellCoords(c.row,o.col),end:this.hot._createCellCoords(o.row,u.col)});break}break;case"NW-SE":switch(s){case"NE-SW":l==="top"?d={start:o,end:f}:d.end=o;break;case"NW-SE":l==="top"?d={start:o,end:c}:d.end=o;break;case"SE-NW":l==="top"?d={start:o,end:u}:d.end=o;break;case"SW-NE":l==="top"?d={start:o,end:h}:d.end=o;break}break;case"SW-NE":switch(s){case"NW-SE":l==="bottom"?d={start:this.hot._createCellCoords(o.row,u.col),end:this.hot._createCellCoords(f.row,o.col)}:d={start:this.hot._createCellCoords(u.row,o.col),end:this.hot._createCellCoords(o.row,c.col)};break;case"SW-NE":l==="top"?d={start:this.hot._createCellCoords(i.highlight.row,o.col),end:this.hot._createCellCoords(o.row,c.col)}:d={start:this.hot._createCellCoords(o.row,u.col),end:this.hot._createCellCoords(u.row,o.col)};break;case"SE-NW":l==="bottom"?d={start:this.hot._createCellCoords(o.row,h.col),end:this.hot._createCellCoords(u.row,o.col)}:l==="top"&&(d={start:f,end:o});break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":l==="top"&&(d.end=o);break;case"SE-NW":l==="top"?d.end=o:d={start:o,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return NZe}},{key:"PLUGIN_PRIORITY",get:function(){return PZe}}]),r}(jt);function X7(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.label,r=e===void 0?"":e,n=t.colspan,i=n===void 0?1:n,o=t.origColspan,a=o===void 0?1:o,s=t.collapsible,l=s===void 0?!1:s,u=t.crossHiddenColumns,c=u===void 0?[]:u,f=t.isCollapsed,h=f===void 0?!1:f,d=t.isHidden,p=d===void 0?!1:d,m=t.isRoot,g=m===void 0?!1:m,v=t.isPlaceholder,w=v===void 0?!1:v;return{label:r,colspan:i,origColspan:a,collapsible:l,isCollapsed:h,crossHiddenColumns:c,isHidden:p,isRoot:g,isPlaceholder:w}}function gZ(){return{label:"",isPlaceholder:!0}}function aU(t){return FZe(t)||DZe(t)||LZe(t)||$Ze()}function $Ze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LZe(t,e){if(!!t){if(typeof t=="string")return Q7(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Q7(t,e)}}function DZe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function FZe(t){if(Array.isArray(t))return Q7(t)}function Q7(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function HZe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(e===0)return r;ae(t,function(i){var o=[],a=0;r.push(o),ae(i,function(s){var l=X7();if(St(s)){var u=s.label,c=s.colspan;l.label=Vr(u),typeof c=="number"&&c>1&&(l.colspan=c,l.origColspan=c)}else l.label=Vr(s);a+=l.origColspan;var f=!1;if(a>=e&&(l.colspan=l.origColspan-(a-e),l.origColspan=l.colspan,f=!0),o.push(l),l.colspan>1)for(var h=0;h<l.colspan-1;h++)o.push(gZ());return!f})});var n=Math.max.apply(Math,aU(wt(r,function(i){return i.length})));return ae(r,function(i){if(i.length<n){var o=wt(new Array(n-i.length),function(){return X7()});i.splice.apply(i,[i.length,0].concat(aU(o)))}}),r}function wv(t){return wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wv(t)}var BZe=["row","col"];function sU(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function UZe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sU(Object(r),!0).forEach(function(n){VZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sU(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function VZe(t,e,r){return e=yZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jZe(t,e){if(t==null)return{};var r=WZe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function WZe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function zZe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yZ(n.key),n)}}function GZe(t,e,r){return e&&lU(t.prototype,e),r&&lU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function yZ(t){var e=YZe(t,"string");return wv(e)==="symbol"?e:String(e)}function YZe(t,e){if(wv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(wv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MC(t,e,r){KZe(t,e),e.set(t,r)}function KZe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function po(t,e){var r=vZ(t,e,"get");return qZe(t,r)}function qZe(t,e){return e.get?e.get.call(t):e.value}function Cm(t,e,r){var n=vZ(t,e,"set");return XZe(t,n,r),r}function vZ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function XZe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var uU=["label","collapsible"],Ta=new WeakMap,Wl=new WeakMap,NC=new WeakMap,QZe=function(){function t(){zZe(this,t),MC(this,Ta,{writable:!0,value:[]}),MC(this,Wl,{writable:!0,value:0}),MC(this,NC,{writable:!0,value:1/0})}return GZe(t,[{key:"setColumnsLimit",value:function(r){Cm(this,NC,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Cm(this,Ta,HZe(r,po(this,NC))),Cm(this,Wl,po(this,Ta).length)}},{key:"getData",value:function(){return po(this,Ta)}},{key:"mergeWith",value:function(r){var n=this;ae(r,function(i){var o=i.row,a=i.col,s=jZe(i,BZe),l=n.getHeaderSettings(o,a);l!==null&&Jr(l,s,uU)})}},{key:"map",value:function(r){ae(po(this,Ta),function(n){ae(n,function(i){var o=r(UZe({},i));St(o)&&Jr(i,o,uU)})})}},{key:"getHeaderSettings",value:function(r,n){var i;if(r>=po(this,Wl)||r<0)return null;var o=po(this,Ta)[r];return n>=o.length?null:(i=o[n])!==null&&i!==void 0?i:null}},{key:"getHeadersSettings",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,o=[];if(r>=po(this,Wl)||r<0)return o;for(var a=po(this,Ta)[r],s=0,l=n;l<a.length;l++){var u=a[l];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=u.colspan,o.push(u),u.colspan>1&&(l+=u.colspan-1),s===i)break;if(s>i)throw new Error("The last column settings cannot overlap the other header layers")}return o}},{key:"getLayersCount",value:function(){return po(this,Wl)}},{key:"getColumnsCount",value:function(){return po(this,Wl)>0?po(this,Ta)[0].length:0}},{key:"clear",value:function(){Cm(this,Ta,[]),Cm(this,Wl,0)}}]),t}();function Sv(t){return Sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sv(t)}function cU(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function fU(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cU(Object(r),!0).forEach(function(n){b2(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cU(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ZZe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bZ(n.key),n)}}function JZe(t,e,r){return e&&hU(t.prototype,e),r&&hU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function b2(t,e,r){return e=bZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bZ(t){var e=eJe(t,"string");return Sv(e)==="symbol"?e:String(e)}function eJe(t,e){if(Sv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Sv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tJe(t){return oJe(t)||iJe(t)||nJe(t)||rJe()}function rJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nJe(t,e){if(!!t){if(typeof t=="string")return Z7(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z7(t,e)}}function iJe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function oJe(t){if(Array.isArray(t))return Z7(t)}function Z7(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var aJe="DF-pre-order";function wZ(t,e){for(var r=t.call(e,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=wZ.call(this.childs[n],t,e)}return r}var sJe="DF-post-order";function SZ(t,e){for(var r=0;r<this.childs.length;r++){var n=SZ.call(this.childs[r],t,e);if(n===!1)return!1}return t.call(e,this)}var RZ="BF";function lJe(t,e){var r=[this];function n(){if(r.length!==0){var i=r.shift();r.push.apply(r,tJe(i.childs)),t.call(e,i)!==!1&&n()}}n()}var uJe=RZ,dU=new Map([[aJe,wZ],[sJe,SZ],[RZ,lJe]]),pU=function(){function t(e){ZZe(this,t),b2(this,"data",{}),b2(this,"parent",null),b2(this,"childs",[]),this.data=e}return JZe(t,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new t(fU({},r.data)),i=0;i<r.childs.length;i++)n.addChild(this.cloneTree(r.childs[i]));return n}},{key:"replaceTreeWith",value:function(r){this.data=fU({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uJe;if(!dU.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));dU.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,i=function o(a){var s=r.call(n,a);s!==!1&&a.parent!==null&&o(a.parent)};i(this)}}]),t}();function Rv(t){return Rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rv(t)}function mU(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function gU(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mU(Object(r),!0).forEach(function(n){cJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mU(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function cJe(t,e,r){return e=EZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fJe(t,e){return mJe(t)||pJe(t,e)||dJe(t,e)||hJe()}function hJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dJe(t,e){if(!!t){if(typeof t=="string")return yU(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yU(t,e)}}function yU(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function pJe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function mJe(t){if(Array.isArray(t))return t}function gJe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,EZ(n.key),n)}}function yJe(t,e,r){return e&&vU(t.prototype,e),r&&vU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function EZ(t){var e=vJe(t,"string");return Rv(e)==="symbol"?e:String(e)}function vJe(t,e){if(Rv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Rv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function PC(t,e,r){bJe(t,e),e.set(t,r)}function bJe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Un(t,e){var r=CZ(t,e,"get");return wJe(t,r)}function wJe(t,e){return e.get?e.get.call(t):e.value}function SJe(t,e,r){var n=CZ(t,e,"set");return RJe(t,n,r),r}function CZ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function RJe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var cf=new WeakMap,zl=new WeakMap,ff=new WeakMap,EJe=function(){function t(e){gJe(this,t),PC(this,cf,{writable:!0,value:new Map}),PC(this,zl,{writable:!0,value:new Map}),PC(this,ff,{writable:!0,value:null}),SJe(this,ff,e)}return yJe(t,[{key:"getRoots",value:function(){return Array.from(Un(this,cf).values())}},{key:"getRootByColumn",value:function(r){var n;return Un(this,zl).has(r)&&(n=Un(this,cf).get(Un(this,zl).get(r))),n}},{key:"getNode",value:function(r,n){var i=this.getRootByColumn(n);if(!!i){var o=n-Un(this,zl).get(n),a=0,s;return i.walkDown(function(l){var u=l.data,c=u.origColspan,f=u.headerLevel;if(r===f){if(o>=a&&o<=a+c-1)return s=l,s.data.isRoot=n===s.data.columnIndex,!1;a+=c}}),s}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;Un(this,zl).clear(),ae(Un(this,cf),function(i){for(var o=fJe(i,2),a=o[1].data.colspan,s=n;s<n+a;s++)Un(r,zl).set(s,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var r=Un(this,ff).getColumnsCount(),n=0;n<r;){var i=Un(this,ff).getHeaderSettings(0,n),o=new pU;Un(this,cf).set(n,o),this.buildLeaves(o,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,i){var o=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,s=Un(this,ff).getHeadersSettings(i,n,a);i+=1,ae(s,function(l){var u=gU(gU({},l),{},{headerLevel:i-1,columnIndex:n}),c;i===1?(r.data=u,c=r):(c=new pU(u),r.addChild(c)),i<Un(o,ff).getLayersCount()&&o.buildLeaves(c,n,i,l.origColspan),n+=l.origColspan})}},{key:"clear",value:function(){Un(this,cf).clear(),Un(this,zl).clear()}}]),t}();function _Z(t,e){t.walkDown(function(r){var n=r.data,i=r.childs;if(!n.isHidden&&(e(n.columnIndex),i.length===0))for(var o=1;o<n.colspan;o++)e(n.columnIndex+o)})}function Ww(t,e){var r=t.childs;if(r.length!==0)return r[0].data[e]}function zw(t){return Ww(t,"origColspan")===t.data.origColspan}function sx(t){var e=t.data,r=t.childs;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=zw(t);if(n)return sx(r[0]);e.isCollapsed=!1;var i=r.slice(1),o=new Set,a=0;if(i.length>0)ae(i,function(f){f.replaceTreeWith(f.data.clonedTree),f.data.clonedTree=null;var h=f.data;a+=h.colspan,_Z(f,function(d){o.add(d)})});else{var s=e.colspan,l=e.origColspan,u=e.columnIndex;a=l-s;for(var c=1;c<l;c++)o.add(u+c)}return t.walkUp(function(f){var h=f.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):zw(f)&&(h.isCollapsed=Ww(f,"isCollapsed"))}),{rollbackModification:function(){return lx(t)},affectedColumns:Array.from(o),colspanCompensation:a}}function lx(t){var e,r=t.data,n=t.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var i=zw(t);if(i)return lx(n[0]);r.isCollapsed=!0;var o=n.slice(1),a=new Set;if(o.length>0)ae(o,function(h){_Z(h,function(d){a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var p=d.data;p.isHidden=!0})});else for(var s=r.origColspan,l=r.columnIndex,u=1;u<s;u++){var c=l+u;a.add(c)}var f=r.colspan-((e=Ww(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(function(h){var d=h.data;d.colspan-=f,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):zw(h)&&(d.isCollapsed=Ww(h,"isCollapsed"))}),{rollbackModification:function(){return sx(t)},affectedColumns:Array.from(a),colspanCompensation:f}}var bU;function CJe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function _Je(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Gt(bU||(bU=CJe([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=t.data.crossHiddenColumns;if(!r.includes(e)){var n=!1;t.walkUp(function(i){var o=i.data.collapsible;if(o)return n=!0,!1}),!n&&t.walkUp(function(i){var o=i.data;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}}var wU;function TJe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function OJe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Gt(wU||(wU=TJe([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=t.data.crossHiddenColumns;if(!!r.includes(e)){var n=!1;t.walkUp(function(i){var o=i.data.collapsible;if(o)return n=!0,!1}),!n&&t.walkUp(function(i){var o=i.data;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}}var SU=new Map([["collapse",lx],["expand",sx],["hide-column",_Je],["show-column",OJe]]);function AJe(t,e,r){if(!SU.has(t))throw new Error('The node modifier action ("'.concat(t,'") does not exist.'));return SU.get(t)(e,r)}var IJe=["crossHiddenColumns"];function xJe(t,e){if(t==null)return{};var r=MJe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function MJe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function tb(t){var e=[];return ae(t,function(r){r.walkDown(function(n){for(var i=n.data,o=i.origColspan,a=i.columnIndex,s=i.headerLevel,l=i.crossHiddenColumns,u=PJe(e,s),c=!1,f=a;f<a+o;f++){var h=l.includes(f);if(h||c)u.push(gZ());else{var d=NJe(i);d.isRoot=!0,u.push(d),c=!0}}})}),e}function NJe(t){var e=X7(t);e.crossHiddenColumns;var r=xJe(e,IJe);return r}function PJe(t,e){var r;return Array.isArray(t[e])?r=t[e]:(r=[],t[e]=r),r}function Ev(t){return Ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ev(t)}var kJe=["row"];function RU(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function EU(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?RU(Object(r),!0).forEach(function(n){$Je(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):RU(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $Je(t,e,r){return e=TZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LJe(t,e){if(t==null)return{};var r=DJe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function DJe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function FJe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function CU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,TZ(n.key),n)}}function HJe(t,e,r){return e&&CU(t.prototype,e),r&&CU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function TZ(t){var e=BJe(t,"string");return Ev(e)==="symbol"?e:String(e)}function BJe(t,e){if(Ev(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ev(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kC(t,e,r){UJe(t,e),e.set(t,r)}function UJe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _m(t,e,r){var n=OZ(t,e,"set");return VJe(t,n,r),r}function VJe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function Or(t,e){var r=OZ(t,e,"get");return jJe(t,r)}function OZ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function jJe(t,e){return e.get?e.get.call(t):e.value}var Wo=new WeakMap,Ci=new WeakMap,Gl=new WeakMap,WJe=function(){function t(){FJe(this,t),kC(this,Wo,{writable:!0,value:new QZe}),kC(this,Ci,{writable:!0,value:new EJe(Or(this,Wo))}),kC(this,Gl,{writable:!0,value:[[]]})}return HJe(t,[{key:"setState",value:function(r){Or(this,Wo).setData(r);var n=!1;try{Or(this,Ci).buildTree()}catch{Or(this,Ci).clear(),Or(this,Wo).clear(),n=!0}return _m(this,Gl,tb(Or(this,Ci).getRoots())),n}},{key:"setColumnsLimit",value:function(r){Or(this,Wo).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,i=wt(r,function(o){var a=o.row,s=LJe(o,kJe);return EU({row:a<0?n.rowCoordsToLevel(a):a},s)});Or(this,Wo).mergeWith(i),Or(this,Ci).buildTree(),_m(this,Gl,tb(Or(this,Ci).getRoots()))}},{key:"mapState",value:function(r){Or(this,Wo).map(r),Or(this,Ci).buildTree(),_m(this,Gl,tb(Or(this,Ci).getRoots()))}},{key:"mapNodes",value:function(r){return Fn(Or(this,Ci).getRoots(),function(n,i){return i.walkDown(function(o){var a=r(o.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,i){n<0&&(n=this.rowCoordsToLevel(n));var o=Or(this,Ci).getNode(n,i),a;return o&&(a=AJe(r,o,i),_m(this,Gl,tb(Or(this,Ci).getRoots()))),a}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var i,o;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(i=(o=Or(this,Gl)[r])===null||o===void 0?void 0:o[n])!==null&&i!==void 0?i:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var i=Or(this,Ci).getNode(r,n);return i?EU({},i.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var i,o=(i=this.getHeaderSettings(r,n))!==null&&i!==void 0?i:{isRoot:!0},a=o.isRoot;if(a)return n;for(var s=n-1;s>=0;){var l,u=(l=this.getHeaderSettings(r,s))!==null&&l!==void 0?l:{isRoot:!0},c=u.isRoot;if(c)break;s-=1}return s}},{key:"getLayersCount",value:function(){return Or(this,Wo).getLayersCount()}},{key:"getColumnsCount",value:function(){return Or(this,Wo).getColumnsCount()}},{key:"clear",value:function(){_m(this,Gl,[]),Or(this,Wo).clear(),Or(this,Ci).clear()}}]),t}();function Cv(t){return Cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cv(t)}function zJe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _U(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,AZ(n.key),n)}}function GJe(t,e,r){return e&&_U(t.prototype,e),r&&_U(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tm(t,e,r){return e=AZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AZ(t){var e=YJe(t,"string");return Cv(e)==="symbol"?e:String(e)}function YJe(t,e){if(Cv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Cv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var KJe=function(){function t(e,r){zJe(this,t),Tm(this,"hot",void 0),Tm(this,"nestedHeaderSettingsGetter",void 0),Tm(this,"layersCount",0),Tm(this,"container",void 0),Tm(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return GJe(t,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var i=0;i<n;i++){var o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),a=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(a,r[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,i=n.rootDocument,o=n.columnIndexMapper,a=i.createDocumentFragment(),s=i.createElement("table"),l=!!this.hot.getSettings().dropdownMenu,u=o.getRenderableIndexesLength(),c=0;c<this.layersCount;c++){for(var f=i.createElement("tr"),h=0;h<u;h++){var d=o.getVisualFromRenderableIndex(h);d===null&&(d=h);var p=i.createElement("th"),m=this.nestedHeaderSettingsGetter(c,d);if(m&&(!m.isPlaceholder||m.isHidden)){var g=m.label;l&&(g+='<button class="changeType"></button>'),Fp(p,g),p.colSpan=m.colspan,f.appendChild(p)}}s.appendChild(f)}a.appendChild(s),r.appendChild(a)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),t}();const qJe=KJe;function np(t){return np=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},np(t)}var TU,OU;function AU(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function XJe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function IU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,IZ(n.key),n)}}function QJe(t,e,r){return e&&IU(t.prototype,e),r&&IU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ou(){return typeof Reflect<"u"&&Reflect.get?Ou=Reflect.get.bind():Ou=function(e,r,n){var i=ZJe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ou.apply(this,arguments)}function ZJe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=as(t),t!==null););return t}function JJe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&J7(t,e)}function J7(t,e){return J7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},J7(t,e)}function eet(t){var e=ret();return function(){var n=as(t),i;if(e){var o=as(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return tet(this,i)}}function tet(t,e){if(e&&(np(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Um(t)}function Um(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ret(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function as(t){return as=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},as(t)}function xU(t,e,r){return e=IZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IZ(t){var e=net(t,"string");return np(e)==="symbol"?e:String(e)}function net(t,e){if(np(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(np(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MU(t,e,r){iet(t,e),e.set(t,r)}function iet(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rb(t,e,r){var n=xZ(t,e,"set");return oet(t,n,r),r}function oet(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function gr(t,e){var r=xZ(t,e,"get");return aet(t,r)}function xZ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function aet(t,e){return e.get?e.get.call(t):e.value}var NU="nestedHeaders",set=280,Dr=new WeakMap,Ds=new WeakMap,uet=function(t){JJe(r,t);var e=eet(r);function r(){var n;XJe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),MU(Um(n),Dr,{writable:!0,value:new WJe}),MU(Um(n),Ds,{writable:!0,value:null}),xU(Um(n),"ghostTable",new qJe(n.hot,function(s,l){return n.getHeaderSettings(s,l)})),xU(Um(n),"detectedOverlappedHeaders",!1),n}return QJe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[NU]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),a=o.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&Xt(Gt(TU||(TU=AU([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(){return i.onAfterOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(s){return i.onAfterGetColumnHeaderRenderers(s)}),this.addHook("modifyColWidth",function(){return i.onModifyColWidth.apply(i,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return i.onModifyColumnHeaderValue.apply(i,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return i.onBeforeHighlightingColumnHeader.apply(i,arguments)}),this.addHook("beforeCopy",function(){return i.onBeforeCopy.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),Ou(as(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var i=this;if(!!this.hot.view){var o=this.hot.getSettings(),a=o.nestedHeaders;gr(this,Dr).setColumnsLimit(this.hot.countCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=gr(this,Dr).setState(a)),this.detectedOverlappedHeaders&&Xt(Gt(OU||(OU=AU([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(s,l){var u=s===!0?"hide-column":"show-column";gr(i,Dr).triggerColumnModification(u,l)}),!gr(this,Ds)&&this.enabled&&rb(this,Ds,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(s){s.forEach(function(l){var u=l.op,c=l.index,f=l.newValue;if(u==="replace"){var h=f===!0?"hide-column":"show-column";gr(i,Dr).triggerColumnModification(h,c)}}),i.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),Ou(as(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),gr(this,Dr).clear(),gr(this,Ds).unsubscribe(),rb(this,Ds,null),this.ghostTable.clear(),Ou(as(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return gr(this,Dr)}},{key:"getLayersCount",value:function(){return gr(this,Dr).getLayersCount()}},{key:"getHeaderSettings",value:function(i,o){return gr(this,Dr).getHeaderSettings(i,o)}},{key:"clearColspans",value:function(){if(!!this.hot.view)for(var i=this.hot.view._wt,o=i.getSetting("columnHeaders").length,a=i.wtTable.THEAD,s=i.wtOverlays.topOverlay.clone.wtTable.THEAD,l=i.wtOverlays.topInlineStartCornerOverlay?i.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<o;u++){var c=a.childNodes[u];if(!c)break;for(var f=s.childNodes[u],h=l?l.childNodes[u]:null,d=0,p=c.childNodes.length;d<p;d++)c.childNodes[d].removeAttribute("colspan"),ut(c.childNodes[d],"hiddenHeader"),f&&f.childNodes[d]&&(f.childNodes[d].removeAttribute("colspan"),ut(f.childNodes[d],"hiddenHeader")),l&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),ut(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(i){var o=this,a=this.hot.view._wt.getSetting("fixedColumnsStart");return function(s,l){var u,c=o.hot,f=c.columnIndexMapper,h=c.view,d=f.getVisualFromRenderableIndex(s);d===null&&(d=s),l.removeAttribute("colspan"),ut(l,"hiddenHeader");var p=(u=gr(o,Dr).getHeaderSettings(i,d))!==null&&u!==void 0?u:{label:""},m=p.colspan,g=p.isHidden,v=p.isPlaceholder;if(v||g)_e(l,"hiddenHeader");else if(m>1){var w,b,E=h._wt.wtOverlays,A=(w=E.topInlineStartCornerOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(l),M=(b=E.inlineStartOverlay)===null||b===void 0?void 0:b.clone.wtTable.THEAD.contains(l),k=A||M?Math.min(m,a-s):m;k>1&&l.setAttribute("colspan",k)}o.hot.view.appendColHeader(d,l,function(){return o.getColumnHeaderValue.apply(o,arguments)},i)}}},{key:"getColumnHeaderValue",value:function(i,o){var a,s=(a=gr(this,Dr).getHeaderSettings(o,i))!==null&&a!==void 0?a:{},l=s.isHidden,u=s.isPlaceholder;return u||l?"":this.hot.getColHeader(i,o)}},{key:"onBeforeHighlightingColumnHeader",value:function(i,o,a){var s=gr(this,Dr).getHeaderTreeNodeData(o,i);if(!s)return i;var l=a.classNames,u=a.columnCursor,c=a.selectionType,f=a.selectionWidth,h=gr(this,Dr).getHeaderSettings(o,i),d=h.isRoot,p=h.colspan;if(c===H1){if(!d)return s.columnIndex}else c===F6&&(p>f-u||!d)&&(l.length=0);return i}},{key:"onBeforeCopy",value:function(i,o,a){var s=a.columnHeadersCount;if(s!==0)for(var l=0;l<o.length;l++){var u=o[l],c=u.startRow,f=u.startCol,h=u.endRow,d=u.endCol,p=h-c+1,m=f-d+1;if(c>=0||m===1)break;for(var g=f;g<=d;g++)for(var v=c;v<=h;v++){var w,b=p+v,E=g-f;if(E!==0){var A=(w=gr(this,Dr).getHeaderTreeNodeData(v,g))===null||w===void 0?void 0:w.isRoot;A===!1&&(i[b][E]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){var l=this._getHeaderTreeNodeDataByCoords(o);l&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,o){var a=this._getHeaderTreeNodeDataByCoords(o);if(!!a){var s=this.hot.selection,l=s.isSelected()?s.getSelectedRange().current():null,u=[],c=a.columnIndex,f=a.origColspan,h=!s.inInSelection(o);i.shiftKey&&l?o.col<l.from.col?u.push(l.getTopEndCorner().col,c,o.row):o.col>l.from.col?u.push(l.getTopStartCorner().col,c+f-1,o.row):u.push(c,c+f-1,o.row):(B8(i)||Gu(i)&&h)&&u.push(c,c+f-1,o.row),s.selectColumns.apply(s,u)}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,a,s){var l;if(!!this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(o);if(!!u){var c=u.columnIndex,f=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),p=h.getBottomEndCorner(),m=h.from;s.column=!0,s.cell=!0;var g=[];o.col<m.col?g.push(p.col,c):o.col>m.col?g.push(d.col,c+f-1):g.push(c,c+f-1),(l=this.hot).selectColumns.apply(l,g)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(i){i.length=0;for(var o=0;o<gr(this,Dr).getLayersCount();o++)i.push(this.headerRendererFactory(o))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){for(var o=gr(this,Dr).getLayersCount(),a=i.startColumn,s=!!o,l=0;l<o;l++){var u=gr(this,Dr).findLeftMostColumnIndex(l,i.startColumn),c=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(s=!1),Wi(c)&&c<i.startColumn){a=c;break}}i.startColumn=s?gr(this,Dr).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(i,o){var a=this.ghostTable.getWidth(o);return i>a?i:a}},{key:"onModifyColumnHeaderValue",value:function(i,o,a){var s,l=(s=gr(this,Dr).getHeaderTreeNodeData(a,o))!==null&&s!==void 0?s:{label:""},u=l.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,o){o||this.updatePlugin()}},{key:"destroy",value:function(){rb(this,Dr,null),gr(this,Ds)!==null&&(gr(this,Ds).unsubscribe(),rb(this,Ds,null)),Ou(as(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(i){if(!(i.row>=0||i.col<0))return gr(this,Dr).getHeaderTreeNodeData(i.row,i.col)}}],[{key:"PLUGIN_KEY",get:function(){return NU}},{key:"PLUGIN_PRIORITY",get:function(){return set}}]),r}(jt);function PU(t){return det(t)||het(t)||fet(t)||cet()}function cet(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fet(t,e){if(!!t){if(typeof t=="string")return eA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eA(t,e)}}function het(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function det(t){if(Array.isArray(t))return eA(t)}function eA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ip(t){return ip=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ip(t)}function pet(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,get(n.key),n)}}function met(t,e,r){return e&&kU(t.prototype,e),r&&kU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function get(t){var e=yet(t,"string");return ip(e)==="symbol"?e:String(e)}function yet(t,e){if(ip(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ip(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vet=function(){function t(e,r){pet(this,t),this.hot=r,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return met(t,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ye(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,i){var o=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&ae(r.__children,function(a){o.cacheNode(a,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,i,o){var a=this,s=!1,l=n;if(isNaN(l)&&l.end)return l;var u=r;return u||(u={__children:this.data},s=!0,l-=1),i!=null&&l===i?{result:u,end:!0}:o!=null&&u===o?{result:l,end:!0}:(l+=1,u.__children&&ae(u.__children,function(c){if(a.parentReference.set(c,s?null:u),l=a.readTreeNodes(c,l,i,o),isNaN(l)&&l.end)return!1}),l)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return Rt(this.data[0],function(n,i){r[i]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var i=this.getRowParent(r);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,i=0,o=r;return isNaN(o)||(o=this.getDataObject(o)),!o||!o.__children?0:(ae(o.__children,function(a){i+=1,a.__children&&(i+=n.countChildren(a))}),i)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||ip(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var i;return((i=r.__children)===null||i===void 0?void 0:i[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,i=r;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var i=n;this.hot.runHooks("beforeAddChild",r,i);var o=null;r&&(o=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(r)+1,1);var a=r;r||(a=this.mockParent()),a.__children||(a.__children=[]),i||(i=this.mockNode()),a.__children.push(i),this.rewriteCache();var s=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",r,i)}},{key:"addChildAtIndex",value:function(r,n,i){var o=i,a;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",r,o,n),r){var s=this.getRowIndex(r),l=s+n+1;this.hot.runHooks("beforeCreateRow",l,1),r.__children.splice(n,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),a=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);o=this.getDataObject(a),this.hot.runHooks("afterAddChild",r,o,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",i=this.translateTrimmedRow(r),o=this.getRowParent(i),a=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(o,a+1,null);break;case"above":this.addChildAtIndex(o,a,null);break}}},{key:"detachFromParent",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=null,a=[];Array.isArray(r)?(Ye(r[0],r[2],function(v){var w=n.translateTrimmedRow(v);a.push(n.getDataObject(w))}),Ye(0,a.length-2,function(v){n.detachFromParent(a[v],!1)}),o=a[a.length-1]):o=r;var s=this.getRowIndex(o),l=this.countChildren(o),u=this.getRowIndexWithinParent(o),c=this.getRowParent(o),f=this.getRowParent(c),h=this.getRowIndex(f),d=null;if(this.hot.runHooks("beforeDetachChild",c,o),u!=null){var p=Array.from(new Array(s+l+1).keys()).splice(-1*(l+1));if(this.hot.runHooks("beforeRemoveRow",s,l+1,p,this.plugin.pluginName),c.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,l+1,p,this.plugin.pluginName),f){d=h+this.countChildren(f);var m=this.getChild(f,this.countChildren(f)-1),g=this.getRowIndex(m);this.hot.runHooks("beforeCreateRow",g+1,l+1,this.plugin.pluginName),f.__children.push(o)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,l+1,this.plugin.pluginName),this.data.push(o)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,l+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",c,o,this.getRowIndex(o)),i&&this.hot.render()}},{key:"filterData",value:function(r,n,i){var o=this,a=[];ae(i,function(s){a.push(o.getDataObject(s))}),ae(a,function(s){var l=o.getRowIndexWithinParent(s),u=o.getRowParent(s);u===null?o.data.splice(l,1):u.__children.splice(l,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,i){var o=this.getDataObject(r-1),a=null,s=r;if(o&&o.__children&&o.__children.length===0?(a=o,s=0):r<this.countAllRows()&&(a=this.getRowParent(r),s=this.getRowIndexWithinParent(r)),a)if(i){var l;(l=a.__children).splice.apply(l,[s,n].concat(PU(i)))}else a.__children.splice(s,n);else if(i){var u;(u=this.data).splice.apply(u,[s,n].concat(PU(i)))}else this.data.splice(s,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,i=null;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,i,o){var a=n===this.hot.countRows(),s=this.getRowParent(r),l=this.getRowIndexWithinParent(r),u=s.__children.slice(l,l+1),c=r>n,f=a?this.getRowParent(n-1):this.getRowParent(n);f==null&&(f=this.getRowParent(n-1)),f==null&&(f=this.getDataObject(n-1)),f?f.__children||(f.__children=[]):(f=this.getDataObject(n),f.__children=[]);var h=a||i||o?f.__children.length:this.getRowIndexWithinParent(n),d=s===f;f.__children.splice(h,0,u[0]),s.__children.splice(l+(c&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(f)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),t}();const bet=vet;function _v(t){return _v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_v(t)}function $U(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ret(n.key),n)}}function wet(t,e,r){return e&&$U(t.prototype,e),r&&$U(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ret(t){var e=Eet(t,"string");return _v(e)==="symbol"?e:String(e)}function Eet(t,e){if(_v(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(_v(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cet(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _et=wet(function t(e,r){Cet(this,t),this.hot=r,this.plugin=e});const ux=_et;function op(t){return op=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},op(t)}function Tet(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Aet(n.key),n)}}function Oet(t,e,r){return e&&LU(t.prototype,e),r&&LU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Aet(t){var e=Iet(t,"string");return op(e)==="symbol"?e:String(e)}function Iet(t,e){if(op(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(op(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xet(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tA(t,e)}function tA(t,e){return tA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},tA(t,e)}function Met(t){var e=ket();return function(){var n=Gw(t),i;if(e){var o=Gw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Net(this,i)}}function Net(t,e){if(e&&(op(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pet(t)}function Pet(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ket(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gw(t){return Gw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gw(t)}var $et=function(t){xet(r,t);var e=Met(r);function r(n,i){var o;return Tet(this,r),o=e.call(this,n,i),o.dataManager=o.plugin.dataManager,o.collapsingUI=o.plugin.collapsingUI,o.rowHeaderWidthCache=null,o}return Oet(r,[{key:"appendLevelIndicators",value:function(i,o){var a=this.hot.toPhysicalRow(i),s=this.dataManager.getRowLevel(a),l=this.dataManager.getDataObject(a),u=o.getElementsByTagName("DIV")[0],c=u.querySelector("span.rowHeader"),f=u.querySelectorAll('[class^="ht_nesting"]');if(ae(f,function(m){m&&u.removeChild(m)}),_e(o,r.CSS_CLASSES.indicatorContainer),s){var h=this.hot.rootDocument,d=c.cloneNode(!0);u.innerHTML="",Ye(0,s-1,function(){var m=h.createElement("SPAN");_e(m,r.CSS_CLASSES.emptyIndicator),u.appendChild(m)}),u.appendChild(d)}if(this.dataManager.hasChildren(l)){var p=this.hot.rootDocument.createElement("DIV");_e(o,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?_e(p,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):_e(p,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(p)}}},{key:"updateRowHeaderWidth",value:function(i){var o=i;o||(o=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*o+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(ux);const MZ=$et;function ap(t){return ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ap(t)}function DU(t){return Het(t)||Fet(t)||Det(t)||Let()}function Let(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Det(t,e){if(!!t){if(typeof t=="string")return rA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rA(t,e)}}function Fet(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Het(t){if(Array.isArray(t))return rA(t)}function rA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Bet(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function FU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vet(n.key),n)}}function Uet(t,e,r){return e&&FU(t.prototype,e),r&&FU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Vet(t){var e=jet(t,"string");return ap(e)==="symbol"?e:String(e)}function jet(t,e){if(ap(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ap(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wet(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nA(t,e)}function nA(t,e){return nA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},nA(t,e)}function zet(t){var e=Ket();return function(){var n=Yw(t),i;if(e){var o=Yw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Get(this,i)}}function Get(t,e){if(e&&(ap(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yet(t)}function Yet(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ket(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yw(t){return Yw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yw(t)}var qet=function(t){Wet(r,t);var e=zet(r);function r(n,i){var o;return Bet(this,r),o=e.call(this,n,i),o.dataManager=o.plugin.dataManager,o.collapsedRows=[],o.collapsedRowsStash={stash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,s)},shiftStash:function(s,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;l==null&&(l=1/0),ae(o.lastCollapsedRows,function(c,f){c>=s&&c<l&&(o.lastCollapsedRows[f]=c+u)})},applyStash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;o.collapseMultipleChildren(o.lastCollapsedRows,s),o.lastCollapsedRows=void 0},trimStash:function(s,l){Ye(s,s+l-1,function(u){var c=o.lastCollapsedRows.indexOf(u);c>-1&&o.lastCollapsedRows.splice(c,1)})}},o}return Uet(r,[{key:"collapseChildren",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,c=null,f=null;return isNaN(i)?(u=i,c=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(i),c=i),this.dataManager.hasChildren(u)&&ae(u.__children,function(h){l.push(o.dataManager.getRowIndex(h))}),f=this.collapseRows(l,!0,!1),s&&this.trimRows(f),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(c)===-1&&this.collapsedRows.push(c),f}},{key:"collapseMultipleChildren",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];ae(i,function(u){l.push.apply(l,DU(o.collapseChildren(u,!1,!1)))}),s&&this.trimRows(l),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([i],o)}},{key:"collapseRows",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return ae(i,function(u){l.push(u),a&&o.collapseChildRows(u,l)}),s&&this.trimRows(l),l}},{key:"collapseChildRows",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var l=this.dataManager.getDataObject(i);ae(l.__children,function(u){var c=o.dataManager.getRowIndex(u);a.push(c),o.collapseChildRows(c,a)})}s&&this.trimRows(a)}},{key:"expandRow",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([i],o)}},{key:"expandRows",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return ae(i,function(u){l.push(u),a&&o.expandChildRows(u,l)}),s&&this.untrimRows(l),l}},{key:"expandChildRows",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var l=this.dataManager.getDataObject(i);ae(l.__children,function(u){if(!o.isAnyParentCollapsed(u)){var c=o.dataManager.getRowIndex(u);a.push(c),o.expandChildRows(c,a)}})}s&&this.untrimRows(a)}},{key:"expandChildren",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,c=null,f=null;return isNaN(i)?(u=i,c=this.dataManager.getRowIndex(i)):(u=this.dataManager.getDataObject(i),c=i),this.collapsedRows.splice(this.collapsedRows.indexOf(c),1),this.dataManager.hasChildren(u)&&ae(u.__children,function(h){var d=o.dataManager.getRowIndex(h);l.push(d)}),f=this.expandRows(l,!0,!1),s&&this.untrimRows(f),a&&this.renderAndAdjust(),f}},{key:"expandMultipleChildren",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];ae(i,function(u){l.push.apply(l,DU(o.expandChildren(u,!1,!1)))}),s&&this.untrimRows(l),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var i=this,o=this.dataManager.getData(),a=[];ae(o,function(s){i.dataManager.hasChildren(s)&&a.push(s)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var i=this,o=this.dataManager.getData(),a=[];ae(o,function(s){i.dataManager.hasChildren(s)&&a.push(s)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(i){var o=this;this.hot.batchExecution(function(){ae(i,function(a){o.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(i){var o=this;this.hot.batchExecution(function(){ae(i,function(a){o.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(i){var o=this,a=isNaN(i)?i:this.dataManager.getDataObject(i),s=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&ae(a.__children,function(l){var u=o.dataManager.getRowIndex(l);if(!o.plugin.collapsedRowsMap.getValueAtIndex(u))return s=!1,!1}),s}},{key:"isAnyParentCollapsed",value:function(i){for(var o=i;o!==null;){o=this.dataManager.getRowParent(o);var a=this.dataManager.getRowIndex(o);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(i,o){if(!(o.col>=0)){var a=this.translateTrimmedRow(o.row);at(i.target,MZ.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),la(i))}}},{key:"translateTrimmedRow",value:function(i){return this.hot.toPhysicalRow(i)}},{key:"untranslateTrimmedRow",value:function(i){return this.hot.toVisualRow(i)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(ux);const Xet=qet;function sp(t){return sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sp(t)}function Qet(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function HU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Jet(n.key),n)}}function Zet(t,e,r){return e&&HU(t.prototype,e),r&&HU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Jet(t){var e=ett(t,"string");return sp(e)==="symbol"?e:String(e)}function ett(t,e){if(sp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(sp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ttt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&iA(t,e)}function iA(t,e){return iA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},iA(t,e)}function rtt(t){var e=itt();return function(){var n=Kw(t),i;if(e){var o=Kw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ntt(this,i)}}function ntt(t,e){if(e&&(sp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NZ(t)}function NZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function itt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kw(t){return Kw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kw(t)}var BU=new WeakMap,ott=function(t){ttt(r,t);var e=rtt(r);function r(n,i){var o;return Qet(this,r),o=e.call(this,n,i),BU.set(NZ(o),{row_above:function(s,l){var u=l[l.length-1];o.dataManager.addSibling(u.start.row,"above")},row_below:function(s,l){var u=l[l.length-1];o.dataManager.addSibling(u.start.row,"below")}}),o.dataManager=o.plugin.dataManager,o}return Zet(r,[{key:"appendOptions",value:function(i){var o=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(fI)},callback:function(){var l=o.dataManager.translateTrimmedRow(o.hot.getSelectedLast()[0]),u=o.dataManager.getDataObject(l);o.dataManager.addChild(u)},disabled:function(){var l=o.hot.getSelectedLast();return!l||l[0]<0||o.hot.selection.isSelectedByColumnHeader()||o.hot.countRows()>=o.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(hI)},callback:function(){o.dataManager.detachFromParent(o.hot.getSelectedLast())},disabled:function(){var l=o.hot.getSelectedLast(),u=o.dataManager.translateTrimmedRow(l[0]),c=o.dataManager.getRowParent(u);return!c||!l||l[0]<0||o.hot.selection.isSelectedByColumnHeader()||o.hot.countRows()>=o.hot.getSettings().maxRows}},{name:"---------"}];return Ye(0,i.items.length-1,function(s){if(s===0)return ae(a,function(l,u){i.items.splice(s+u,0,l)}),!1}),this.modifyRowInsertingOptions(i)}},{key:"modifyRowInsertingOptions",value:function(i){var o=BU.get(this);return Ye(0,i.items.length-1,function(a){var s=o[i.items[a].key];s!=null&&(i.items[a].callback=s)}),i}}]),r}(ux);const att=ott;function Tv(t){return Tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tv(t)}var UU;function VU(t){return ctt(t)||utt(t)||ltt(t)||stt()}function stt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ltt(t,e){if(!!t){if(typeof t=="string")return oA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oA(t,e)}}function utt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ctt(t){if(Array.isArray(t))return oA(t)}function oA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ftt(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function htt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ptt(n.key),n)}}function dtt(t,e,r){return e&&jU(t.prototype,e),r&&jU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ptt(t){var e=mtt(t,"string");return Tv(e)==="symbol"?e:String(e)}function mtt(t,e){if(Tv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Tv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gtt=function(){function t(e){htt(this,t),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}return dtt(t,[{key:"onBeforeRowMove",value:function(r,n,i,o){var a=this,s=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:i,movePossible:o});if(s)return!1;this.movedToCollapsed=!1;var l=i===this.hot.countRows(),u=l?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i),c=!0,f=r.map(function(g){if(!c)return!1;var v=a.dataManager.translateTrimmedRow(g);return c=a.shouldAllowMoving(v,u),v}),h=f.indexOf(u)===-1;if(!c||!h)return!1;var d=this.getBaseParent(f),p=this.getTargetParent(l,u),m=d===p;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(p),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(f,u,m),this.moveRows(f,u,p),this.dataManager.rewriteCache(),this.moveCellsMeta(f,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,i,o,o&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,i),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,i=r.finalIndex,o=r.dropIndex,a=r.movePossible,s=!1;return tr(o)&&(Xt(Gt(UU||(UU=ftt([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,i,o,a,!1),s=!0),s}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var i=this.dataManager.getRowParent(r?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,i){i||(Math.max.apply(Math,VU(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,i){var o=this,a=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(function(){r.forEach(function(s){o.dataManager.moveRow(s,n,o.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(r,n){var i=this,o,a=[],s=Math.max.apply(Math,VU(r))<n;r.forEach(function(l){a.push(i.hot.getCellMetaAtRow(l))}),this.hot.spliceCellsMeta(r[0],r.length),(o=this.hot).spliceCellsMeta.apply(o,[n-(s?a.length:0),0].concat(a))}},{key:"selectCells",value:function(r,n){var i=r.length,o=0,a=0,s=null,l=null;if(this.movedToCollapsed){var u=null;r[i-1]<n?u=this.dataManager.translateTrimmedRow(n-i):u=this.dataManager.translateTrimmedRow(n);var c=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),f=this.dataManager.getRowIndex(c);o=this.dataManager.untranslateTrimmedRow(f),a=o}else r[i-1]<n?(a=n-1,o=a-i+1):(o=n,a=o+i-1);s=this.hot.selection,l=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(o,0)),s.setRangeEnd(this.hot._createCellCoords(a,l),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(i,o){return i-o!==n})}}]),t}();function lp(t){return lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lp(t)}function ytt(t){return Stt(t)||wtt(t)||btt(t)||vtt()}function vtt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function btt(t,e){if(!!t){if(typeof t=="string")return aA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aA(t,e)}}function wtt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Stt(t){if(Array.isArray(t))return aA(t)}function aA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Rtt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ctt(n.key),n)}}function Ett(t,e,r){return e&&WU(t.prototype,e),r&&WU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ctt(t){var e=_tt(t,"string");return lp(e)==="symbol"?e:String(e)}function _tt(t,e){if(lp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(lp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Au(){return typeof Reflect<"u"&&Reflect.get?Au=Reflect.get.bind():Au=function(e,r,n){var i=Ttt(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Au.apply(this,arguments)}function Ttt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ss(t),t!==null););return t}function Ott(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sA(t,e)}function sA(t,e){return sA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sA(t,e)}function Att(t){var e=xtt();return function(){var n=ss(t),i;if(e){var o=ss(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Itt(this,i)}}function Itt(t,e){if(e&&(lp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PZ(t)}function PZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xtt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ss(t){return ss=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ss(t)}var $C="nestedRows",Mtt=300,Oa=new WeakMap,Ntt="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",Ptt=function(t){Ott(r,t);var e=Att(r);function r(n){var i;return Rtt(this,r),i=e.call(this,n),i.dataManager=null,i.headersUI=null,i.collapsedRowsMap=null,Oa.set(PZ(i),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),i}return Ett(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[$C]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new k1),this.dataManager=new bet(this,this.hot),this.collapsingUI=new Xet(this,this.hot),this.headersUI=new MZ(this,this.hot),this.contextMenuUI=new att(this,this.hot),this.rowMoveController=new gtt(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("beforeViewRender",function(){return i.onBeforeViewRender.apply(i,arguments)}),this.addHook("modifyRowData",function(){return i.onModifyRowData.apply(i,arguments)}),this.addHook("modifySourceLength",function(){return i.onModifySourceLength.apply(i,arguments)}),this.addHook("beforeDataSplice",function(){return i.onBeforeDataSplice.apply(i,arguments)}),this.addHook("filterData",function(){return i.onFilterData.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("beforeAddChild",function(){return i.onBeforeAddChild.apply(i,arguments)}),this.addHook("afterAddChild",function(){return i.onAfterAddChild.apply(i,arguments)}),this.addHook("beforeDetachChild",function(){return i.onBeforeDetachChild.apply(i,arguments)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return i.onModifyRowHeaderWidth.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("beforeRowMove",function(){return i.onBeforeRowMove.apply(i,arguments)}),this.addHook("beforeLoadData",function(o){return i.onBeforeLoadData(o)}),this.addHook("beforeUpdateData",function(o){return i.onBeforeLoadData(o)}),Au(ss(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),Au(ss(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var i=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(i),Au(ss(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(i,o,a,s){return this.rowMoveController.onBeforeRowMove(i,o,a,s)}},{key:"disableCoreAPIModifiers",value:function(){var i=Oa.get(this);i.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var i=Oa.get(this);i.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a){this.collapsingUI.toggleState(i,o,a)}},{key:"onModifyRowData",value:function(i){var o=Oa.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.getDataObject(i)}},{key:"onModifySourceLength",value:function(){var i=Oa.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(i,o,a){var s=Oa.get(this);return s.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(i)?!0:(this.dataManager.spliceData(i,o,a),!1)}},{key:"onFilterData",value:function(i,o,a){var s=Oa.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],o),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*o),this.dataManager.filterData(i,o,a),s.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(i){return this.contextMenuUI.appendOptions(i)}},{key:"onAfterGetRowHeader",value:function(i,o){this.headersUI.appendLevelIndicators(i,o)}},{key:"onModifyRowHeaderWidth",value:function(i){return this.headersUI.rowHeaderWidthCache||i}},{key:"onAfterRemoveRow",value:function(i,o,a,s){var l=this;if(s!==this.pluginName){var u=Oa.get(this);setTimeout(function(){u.skipRender=null,l.headersUI.updateRowHeaderWidth(),l.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(i,o,a){var s=this,l=Array.from(a.reduce(function(u,c){if(s.dataManager.isParent(c)){var f=s.dataManager.getDataObject(c).__children;return u.add(c),Array.isArray(f)&&f.forEach(function(h){return u.add(s.dataManager.getRowIndex(h))}),u}return u.add(c)},new Set));a.length=0,a.push.apply(a,l)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(i,o){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(o)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(i,o,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var i=Math.max.apply(Math,ytt(this.dataManager.cache.levels));i>0&&this.headersUI.updateRowHeaderWidth(i)}},{key:"onBeforeViewRender",value:function(i,o){var a=Oa.get(this);a.skipRender&&(o.skipRender=!0)}},{key:"destroy",value:function(){Au(ss(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(i){if(!T$e(i)){G8(Ntt),this.hot.getSettings()[$C]=!1,this.disablePlugin();return}this.dataManager.setData(i),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return $C}},{key:"PLUGIN_PRIORITY",get:function(){return Mtt}}]),r}(jt);function Ov(t){return Ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ov(t)}function ktt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ltt(n.key),n)}}function $tt(t,e,r){return e&&zU(t.prototype,e),r&&zU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ltt(t){var e=Dtt(t,"string");return Ov(e)==="symbol"?e:String(e)}function Dtt(t,e){if(Ov(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ov(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ftt=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;ktt(this,t),this.rootWindow=r,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}return $tt(t,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var i=typeof r>"u"?n:r,o=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(i));return o===null?void 0:JSON.parse(o)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;ae(this.savedKeys,function(n,i){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[i]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),t}();const Htt=Ftt;function up(t){return up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},up(t)}function Btt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function GU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vtt(n.key),n)}}function Utt(t,e,r){return e&&GU(t.prototype,e),r&&GU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Vtt(t){var e=jtt(t,"string");return up(e)==="symbol"?e:String(e)}function jtt(t,e){if(up(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(up(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Iu(){return typeof Reflect<"u"&&Reflect.get?Iu=Reflect.get.bind():Iu=function(e,r,n){var i=Wtt(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Iu.apply(this,arguments)}function Wtt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ls(t),t!==null););return t}function ztt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lA(t,e)}function lA(t,e){return lA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lA(t,e)}function Gtt(t){var e=qtt();return function(){var n=ls(t),i;if(e){var o=ls(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ytt(this,i)}}function Ytt(t,e){if(e&&(up(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ktt(t)}function Ktt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qtt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ls(t){return ls=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ls(t)}Ue.getSingleton().register("persistentStateSave");Ue.getSingleton().register("persistentStateLoad");Ue.getSingleton().register("persistentStateReset");var YU="persistentState",Xtt=0,Qtt=function(t){ztt(r,t);var e=Gtt(r);function r(n){var i;return Btt(this,r),i=e.call(this,n),i.storage=void 0,i}return Utt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[YU]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.storage||(this.storage=new Htt(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(o,a){return i.saveValue(o,a)}),this.addHook("persistentStateLoad",function(o,a){return i.loadValue(o,a)}),this.addHook("persistentStateReset",function(){return i.resetValue()}),Iu(ls(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,Iu(ls(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Iu(ls(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(i,o){o.value=this.storage.loadValue(i)}},{key:"saveValue",value:function(i,o){this.storage.saveValue(i,o)}},{key:"resetValue",value:function(i){typeof i>"u"?this.storage.resetAll():this.storage.reset(i)}},{key:"destroy",value:function(){Iu(ls(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return YU}},{key:"PLUGIN_PRIORITY",get:function(){return Xtt}}]),r}(jt);function cp(t){return cp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cp(t)}function Ztt(t){return rrt(t)||trt(t)||ert(t)||Jtt()}function Jtt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ert(t,e){if(!!t){if(typeof t=="string")return uA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uA(t,e)}}function trt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function rrt(t){if(Array.isArray(t))return uA(t)}function uA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function nrt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function KU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ort(n.key),n)}}function irt(t,e,r){return e&&KU(t.prototype,e),r&&KU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ort(t){var e=art(t,"string");return cp(e)==="symbol"?e:String(e)}function art(t,e){if(cp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(cp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xu(){return typeof Reflect<"u"&&Reflect.get?xu=Reflect.get.bind():xu=function(e,r,n){var i=srt(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},xu.apply(this,arguments)}function srt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=us(t),t!==null););return t}function lrt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cA(t,e)}function cA(t,e){return cA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},cA(t,e)}function urt(t){var e=hrt();return function(){var n=us(t),i;if(e){var o=us(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return crt(this,i)}}function crt(t,e){if(e&&(cp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return frt(t)}function frt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hrt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function us(t){return us=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},us(t)}var LC="search",drt=190,prt="htSearchResult",mrt=function(e,r,n,i,o){e.getCellMeta(r,n).isSearchResult=o},grt=function(e,r,n){return tr(e)||e===null||!e.toLocaleLowerCase||e.length===0||tr(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(e.toLocaleLowerCase(n.locale))!==-1},yrt=function(t){lrt(r,t);var e=urt(r);function r(n){var i;return nrt(this,r),i=e.call(this,n),i.callback=mrt,i.queryMethod=grt,i.searchResultClass=prt,i}return irt(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[LC]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[LC];this.updatePluginSettings(o),this.addHook("beforeRenderer",function(){return i.onBeforeRenderer.apply(i,arguments)}),xu(us(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this,o=function(){return i.onBeforeRenderer.apply(i,arguments)};this.hot.addHook("beforeRenderer",o),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("beforeRenderer",o)}),xu(us(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),xu(us(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),l=this.hot.countRows(),u=this.hot.countCols(),c=[],f=this.hot;return Ye(0,l-1,function(h){Ye(0,u-1,function(d){var p=o.hot.getDataAtCell(h,d),m=o.hot.getCellMeta(h,d),g=m.search.callback||a,v=m.search.queryMethod||s,w=v(i,p,m);if(w){var b={row:h,col:d,data:p};c.push(b)}g&&g(f,h,d,p,w)})}),c}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(i){this.callback=i}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(i){this.queryMethod=i}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(i){this.searchResultClass=i}},{key:"updatePluginSettings",value:function(i){St(i)&&(i.searchResultClass&&this.setSearchResultClass(i.searchResultClass),i.queryMethod&&this.setQueryMethod(i.queryMethod),i.callback&&this.setCallback(i.callback))}},{key:"onBeforeRenderer",value:function(i,o,a,s,l,u){var c=u.className||[],f=[];if(typeof c=="string")f=c.split(" ");else{var h;(h=f).push.apply(h,Ztt(c))}this.isEnabled()&&u.isSearchResult?f.includes(this.searchResultClass)||f.push("".concat(this.searchResultClass)):f.includes(this.searchResultClass)&&f.splice(f.indexOf(this.searchResultClass),1),u.className=f.join(" ")}},{key:"destroy",value:function(){xu(us(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return LC}},{key:"PLUGIN_PRIORITY",get:function(){return drt}}]),r}(jt);function fp(t){return fp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fp(t)}function vrt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wrt(n.key),n)}}function brt(t,e,r){return e&&qU(t.prototype,e),r&&qU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wrt(t){var e=Srt(t,"string");return fp(e)==="symbol"?e:String(e)}function Srt(t,e){if(fp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zf(){return typeof Reflect<"u"&&Reflect.get?Zf=Reflect.get.bind():Zf=function(e,r,n){var i=Rrt(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Zf.apply(this,arguments)}function Rrt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=fl(t),t!==null););return t}function Ert(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fA(t,e)}function fA(t,e){return fA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fA(t,e)}function Crt(t){var e=Ort();return function(){var n=fl(t),i;if(e){var o=fl(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _rt(this,i)}}function _rt(t,e){if(e&&(fp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Trt(t)}function Trt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ort(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fl(t){return fl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fl(t)}var Art="touchScroll",Irt=200,xrt=function(t){Ert(r,t);var e=Crt(r);function r(n){var i;return vrt(this,r),i=e.call(this,n),i.scrollbars=[],i.clones=[],i.lockedCollection=!1,i.freezeOverlays=!1,i}return brt(r,[{key:"isEnabled",value:function(){return gK()}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterViewRender",function(){return i.onAfterViewRender()}),this.registerEvents(),Zf(fl(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,Zf(fl(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Zf(fl(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.addHook("beforeTouchScroll",function(){return i.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return i.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var i=this.hot.view._wt.wtOverlays,o=i.topOverlay,a=i.bottomOverlay,s=i.inlineStartOverlay,l=i.topInlineStartCornerOverlay,u=i.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(o),a.clone&&this.scrollbars.push(a),this.scrollbars.push(s),l&&this.scrollbars.push(l),u&&u.clone&&this.scrollbars.push(u),this.clones=[],o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),s.needFullRender&&this.clones.push(s.clone.wtTable.holder.parentNode),l&&this.clones.push(l.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,ae(this.clones,function(i){_e(i,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var i=this;this.freezeOverlays=!1,ae(this.clones,function(o){ut(o,"hide-tween"),_e(o,"show-tween")}),this.hot._registerTimeout(function(){ae(i.clones,function(o){ut(o,"show-tween")})},400),ae(this.scrollbars,function(o){o.refresh(),o.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return Art}},{key:"PLUGIN_PRIORITY",get:function(){return Irt}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(jt);function hp(t){return hp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hp(t)}function Mrt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function XU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Prt(n.key),n)}}function Nrt(t,e,r){return e&&XU(t.prototype,e),r&&XU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Prt(t){var e=krt(t,"string");return hp(e)==="symbol"?e:String(e)}function krt(t,e){if(hp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(hp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mu(){return typeof Reflect<"u"&&Reflect.get?Mu=Reflect.get.bind():Mu=function(e,r,n){var i=$rt(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Mu.apply(this,arguments)}function $rt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=cs(t),t!==null););return t}function Lrt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hA(t,e)}function hA(t,e){return hA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hA(t,e)}function Drt(t){var e=Brt();return function(){var n=cs(t),i;if(e){var o=cs(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Frt(this,i)}}function Frt(t,e){if(e&&(hp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hrt(t)}function Hrt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Brt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cs(t){return cs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cs(t)}var nb="trimRows",Urt=330,Vrt=function(t){Lrt(r,t);var e=Drt(r);function r(n){var i;return Mrt(this,r),i=e.call(this,n),i.trimmedRowsMap=null,i}return Nrt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[nb]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new k1),this.trimmedRowsMap.addLocalHook("init",function(){return i.onMapInit()}),Mu(cs(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var i=this,o=this.hot.getSettings()[nb];Array.isArray(o)&&this.hot.batchExecution(function(){i.trimmedRowsMap.clear(),ae(o,function(a){i.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),Mu(cs(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),Mu(cs(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(i){var o=this,a=this.getTrimmedRows(),s=this.isValidConfig(i),l=a;s&&(l=Array.from(new Set(a.concat(i))));var u=this.hot.runHooks("beforeTrimRow",a,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){ae(i,function(c){o.trimmedRowsMap.setValueAtIndex(c,!0)})},!0),this.hot.runHooks("afterTrimRow",a,l,s,s&&l.length>a.length))}},{key:"trimRow",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.trimRows(o)}},{key:"untrimRows",value:function(i){var o=this.getTrimmedRows(),a=this.isValidConfig(i),s=o,l=this.trimmedRowsMap.getValues().slice(),u=i.length>0;a&&u&&(ae(i,function(f){l[f]=!1}),s=Fn(l,function(f,h,d){return h&&f.push(d),f},[]));var c=this.hot.runHooks("beforeUntrimRow",o,s,a&&u);c!==!1&&(a&&u&&this.trimmedRowsMap.setValues(l),this.hot.runHooks("afterUntrimRow",o,s,a&&u,a&&s.length<o.length))}},{key:"untrimRow",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.untrimRows(o)}},{key:"isTrimmed",value:function(i){return this.trimmedRowsMap.getValueAtIndex(i)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(i){var o=this.hot.countSourceRows();return i.every(function(a){return Number.isInteger(a)&&a>=0&&a<o})}},{key:"onMapInit",value:function(){var i=this,o=this.hot.getSettings()[nb];Array.isArray(o)&&this.hot.batchExecution(function(){ae(o,function(a){i.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){Mu(cs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return nb}},{key:"PLUGIN_PRIORITY",get:function(){return Urt}}]),r}(jt);function dp(t){return dp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dp(t)}function kZ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jrt(n.key),n)}}function $Z(t,e,r){return e&&QU(t.prototype,e),r&&QU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function jrt(t){var e=Wrt(t,"string");return dp(e)==="symbol"?e:String(e)}function Wrt(t,e){if(dp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(dp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function LZ(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dA(t,e)}function dA(t,e){return dA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},dA(t,e)}function DZ(t){var e=Yrt();return function(){var n=qw(t),i;if(e){var o=qw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return zrt(this,i)}}function zrt(t,e){if(e&&(dp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Grt(t)}function Grt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Yrt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qw(t){return qw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qw(t)}function Krt(t){return Qrt(t)||Xrt(t)||HZ(t)||qrt()}function qrt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xrt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Qrt(t){if(Array.isArray(t))return pA(t)}function FZ(t,e){return ent(t)||Jrt(t,e)||HZ(t,e)||Zrt()}function Zrt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HZ(t,e){if(!!t){if(typeof t=="string")return pA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pA(t,e)}}function pA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Jrt(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function ent(t){if(Array.isArray(t))return t}var BZ="undoRedo",tnt="undoRedo";function De(t){var e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(r,n){var i=this,o=r&&r.length;if(!!o){var a=r.find(function(l){var u=FZ(l,4),c=u[2],f=u[3];return c!==f});if(!!a){var s=function(){var u=r.reduce(function(f,h){return f.push(Krt(h)),f},[]);ae(u,function(f){f[1]=t.propToCol(f[1])});var c=o>1?i.getSelected():[[u[0][0],u[0][1]]];return new De.ChangeAction(u,c)};e.done(s,n)}}}),t.addHook("afterCreateRow",function(r,n,i){e.done(function(){return new De.CreateRowAction(r,n)},i)}),t.addHook("beforeRemoveRow",function(r,n,i,o){var a=function(){var l=t.toPhysicalRow(r),u=Qn(e.instance.getSourceData(l,0,l+n-1,e.instance.countSourceCols()-1));return new De.RemoveRowAction(l,u,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(a,o)}),t.addHook("afterCreateCol",function(r,n,i){e.done(function(){return new De.CreateColumnAction(r,n)},i)}),t.addHook("beforeRemoveCol",function(r,n,i,o){var a=function(){var l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+r)%e.instance.countCols(),c=[],f=[],h=[];Ye(l.length-1,function(m){var g=[],v=l[m];Ye(u,u+(n-1),function(w){g.push(v[t.toPhysicalColumn(w)])}),c.push(g)}),Ye(n-1,function(m){h.push(t.toPhysicalColumn(u+m))}),Array.isArray(t.getSettings().colHeaders)&&Ye(n-1,function(m){f.push(t.getSettings().colHeaders[t.toPhysicalColumn(u+m)]||null)});var d=t.columnIndexMapper.getIndexesSequence(),p=t.rowIndexMapper.getIndexesSequence();return new De.RemoveColumnAction(u,h,c,f,d,p,t.getSettings().fixedColumnsStart)};e.done(a,o)}),t.addHook("beforeCellAlignment",function(r,n,i,o){e.done(function(){return new De.CellAlignmentAction(r,n,i,o)})}),t.addHook("beforeFilter",function(r){e.done(function(){return new De.FiltersAction(r)})}),t.addHook("beforeRowMove",function(r,n){r!==!1&&e.done(function(){return new De.RowMoveAction(r,n)})}),t.addHook("beforeMergeCells",function(r,n){n||e.done(function(){return new De.MergeCellsAction(t,r)})}),t.addHook("afterUnmergeCells",function(r,n){n||e.done(function(){return new De.UnmergeCellsAction(t,r)})}),t.addHook("afterInit",function(){e.init()})}De.prototype.done=function(t,e){if(!this.ignoreNewActions){var r=e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto";if(!r){var n=this.doneActions.slice(),i=this.instance.runHooks("beforeUndoStackChange",n,e);if(i!==!1){var o=t(),a=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};De.prototype.undo=function(){if(this.isUndoAvailable()){var t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);var e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());var r=Qn(e),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,function(){i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};De.prototype.redo=function(){if(this.isRedoAvailable()){var t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);var e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());var r=Qn(e),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,function(){i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};De.prototype.isUndoAvailable=function(){return this.doneActions.length>0};De.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};De.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};De.prototype.isEnabled=function(){return this.enabled};De.prototype.enable=function(){if(!this.isEnabled()){var t=this.instance;this.enabled=!0,int(t),this.registerShortcuts(),t.addHook("afterChange",UZ)}};De.prototype.disable=function(){if(!!this.isEnabled()){var t=this.instance;this.enabled=!1,ont(t),this.unregisterShortcuts(),t.removeHook("afterChange",UZ)}};De.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};De.Action=function(){};De.Action.prototype.undo=function(){};De.Action.prototype.redo=function(){};De.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Cl(De.ChangeAction,De.Action);De.ChangeAction.prototype.undo=function(t,e){for(var r=Qn(this.changes),n=t.countEmptyRows(!0),i=t.countEmptyCols(!0),o=0,a=r.length;o<a;o++)r[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.undo");for(var s=0,l=r.length;s<l;s++){var u=FZ(r[s],2),c=u[0],f=u[1];t.getSettings().minSpareRows&&c+1+t.getSettings().minSpareRows===t.countRows()&&n===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(c+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&f+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(f+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};De.ChangeAction.prototype.redo=function(t,e){for(var r=Qn(this.changes),n=0,i=r.length;n<i;n++)r[n].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};De.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Cl(De.CreateRowAction,De.Action);De.CreateRowAction.prototype.undo=function(t,e){var r=t.countRows(),n=t.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};De.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};De.RemoveRowAction=function(t,e,r,n,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=i};Cl(De.RemoveRowAction,De.Action);De.RemoveRowAction.prototype.undo=function(t,e){var r=this,n=t.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(o,a){Object.keys(o).forEach(function(s){var l=parseInt(s,10);i.push([r.index+a,isNaN(l)?s:l,o[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};De.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};De.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Cl(De.CreateColumnAction,De.Action);De.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};De.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};De.RemoveColumnAction=function(t,e,r,n,i,o,a){this.index=t,this.indexes=e,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};Cl(De.RemoveColumnAction,De.Action);De.RemoveColumnAction.prototype.undo=function(t,e){var r=this,n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var i=this.indexes.slice(0).sort(),o=function(h,d,p){return p[r.indexes.indexOf(i[d])]},a=this.data.length,s=[],l=0;l<a;l++)s.push(wt(this.data[l],o));var u=wt(this.headers,o),c=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),ae(t.getSourceDataArray(),function(f,h){ae(i,function(d,p){f[d]=s[h][p],c.push([h,d,f[d]])})}),t.setSourceDataAtCell(c,void 0,void 0,"UndoRedo.undo"),t.columnIndexMapper.insertIndexes(i[0],i.length),typeof this.headers<"u"&&ae(u,function(f,h){t.getSettings().colHeaders[i[h]]=f}),t.batchExecution(function(){t.rowIndexMapper.setIndexesSequence(r.rowPositions),t.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};De.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};De.CellAlignmentAction=function(t,e,r,n){this.stateBefore=t,this.range=e,this.type=r,this.alignment=n};De.CellAlignmentAction.prototype.undo=function(t,e){var r=this;ae(this.range,function(n){n.forAll(function(i,o){i>=0&&o>=0&&t.setCellMeta(i,o,"className",r.stateBefore[i][o]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};De.CellAlignmentAction.prototype.redo=function(t,e){Hs(this.range,this.type,this.alignment,function(r,n){return t.getCellMeta(r,n)},function(r,n,i,o){return t.setCellMeta(r,n,i,o)}),t.addHookOnce("afterViewRender",e),t.render()};De.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};Cl(De.FiltersAction,De.Action);De.FiltersAction.prototype.undo=function(t,e){var r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};De.FiltersAction.prototype.redo=function(t,e){var r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var rnt=function(t){LZ(r,t);var e=DZ(r);function r(n,i){var o;kZ(this,r),o=e.call(this),o.cellRange=i;var a=o.cellRange.getTopStartCorner(),s=o.cellRange.getBottomEndCorner();return o.rangeData=n.getData(a.row,a.col,s.row,s.col),o}return $Z(r,[{key:"undo",value:function(i,o){var a=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),a.unmergeRange(this.cellRange,!0);var s=this.cellRange.getTopStartCorner();i.populateFromArray(s.row,s.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(i,o){var a=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),a.mergeRange(this.cellRange)}}]),r}(De.Action);De.MergeCellsAction=rnt;var nnt=function(t){LZ(r,t);var e=DZ(r);function r(n,i){var o;return kZ(this,r),o=e.call(this),o.cellRange=i,o}return $Z(r,[{key:"undo",value:function(i,o){var a=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(i,o){var a=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),a.unmergeRange(this.cellRange,!0),i.render()}}]),r}(De.Action);De.UnmergeCellsAction=nnt;De.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};Cl(De.RowMoveAction,De.Action);De.RowMoveAction.prototype.undo=function(t,e){var r=this,n=t.getPlugin("manualRowMove"),i=[].concat(this.rows),o=i.filter(function(c){return c>r.finalIndex}),a=i.filter(function(c){return c<=r.finalIndex}),s=o.sort(function(c,f){return f-c}).concat(a.sort(function(c,f){return c-f}));t.addHookOnce("afterViewRender",e);for(var l=0;l<s.length;l+=1){var u=t.toVisualRow(s[l]);n.moveRow(u,s[l])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};De.RowMoveAction.prototype.redo=function(t,e){var r=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),r.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};De.prototype.init=function(){var t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};De.prototype.registerShortcuts=function(){var t=this,e=this.instance.getShortcutManager(),r=e.getContext("grid"),n=function(a){return!a.altKey},i={runOnlyIf:n,group:BZ};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){t.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){t.redo()}}],i)};De.prototype.unregisterShortcuts=function(){var t=this.instance.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(BZ)};function UZ(t,e){var r=this;if(e==="loadData")return r.undoRedo.clear()}function int(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function ont(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}var U1=Ue.getSingleton();U1.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});U1.register("beforeUndo");U1.register("afterUndo");U1.register("beforeRedo");U1.register("afterRedo");De.PLUGIN_KEY=tnt;De.SETTING_KEYS=!0;function ant(){Ht(LIe),Ht(sxe),Ht(_xe),Ht(v9e),Ht(D9e),Ht(yX),Ht(_Ne),Ht(aPe),Ht(pQ),Ht(RBe),Ht(qBe),Ht(aUe),Ht(TQ),Ht(cVe),Ht(aYe),Ht(HYe),Ht(cKe),Ht($Ke),Ht(iqe),Ht(Gqe),Ht(nXe),Ht(zXe),Ht(rQe),Ht(eZe),Ht(SZe),Ht(kZe),Ht(uet),Ht(Ptt),Ht(Qtt),Ht(yrt),Ht(xrt),Ht(Vrt),Ht(De)}function snt(){RRe(),FRe(),nEe(),CEe(),ant()}Yo(QK);xt.editors={BaseEditor:Hp};function xt(t,e){var r=new ZI(t,e||{},KI);return r.init(),r}xt.Core=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new ZI(t,e,KI)};xt.DefaultSettings=nQ();xt.hooks=Ue.getSingleton();xt.CellCoords=rw;xt.CellRange=u3;xt.packageName="handsontable";xt.buildDate="28/03/2023 12:24:11";xt.version="12.3.3";xt.languages={dictionaryKeys:XNe,getLanguageDictionary:YX,getLanguagesDictionaries:Y$e,registerLanguageDictionary:GX,getTranslatedPhrase:KX};function ZU(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function lnt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ZU(Object(r),!0).forEach(function(n){unt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ZU(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Av(t){return Av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Av(t)}function pp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function JU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jZ(n.key),n)}}function mp(t,e,r){return e&&JU(t.prototype,e),r&&JU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function unt(t,e,r){return e=jZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Iv(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mA(t,e)}function Xw(t){return Xw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xw(t)}function mA(t,e){return mA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mA(t,e)}function cnt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function VZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fnt(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VZ(t)}function xv(t){var e=cnt();return function(){var n=Xw(t),i;if(e){var o=Xw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return fnt(this,i)}}function hnt(t){return dnt(t)||pnt(t)||mnt(t)||gnt()}function dnt(t){if(Array.isArray(t))return gA(t)}function pnt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function mnt(t,e){if(!!t){if(typeof t=="string")return gA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gA(t,e)}}function gA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function gnt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ynt(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jZ(t){var e=ynt(t,"string");return typeof e=="symbol"?e:String(e)}var DC=null,vnt="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",bnt="The Handsontable instance bound to this component was destroyed and cannot be used properly.",Qw="global",wnt="hot-wrapper-editor-container";function Snt(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function yA(t,e){var r=ve.Children.toArray(t),n=ve.Children.count(t),i=null;return n!==0&&(n===1&&r[0].props[e]?i=r[0]:i=r.find(function(o){return o.props[e]!==void 0})),i||null}function WZ(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function zZ(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=arguments.length>1?arguments[1]:void 0;if(e===null)return null;var r=YZ(e.props,!1);return r.className="".concat(wnt," ").concat(r.className),bz.createPortal(ve.createElement("div",Object.assign({},r),e),t.body)}function GZ(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Qw,n=yA(t,"hot-editor"),i=WZ(n);return n?ve.cloneElement(n,{emitEditorInstance:function(a,s){e.get(i)||e.set(i,new Map);var l=e.get(i);l.set(s!=null?s:Qw,a)},editorColumnScope:r,isEditor:!0}):null}function Rnt(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;r||(r=document),DC||(DC=r.createDocumentFragment());var n=r.createElement("DIV");DC.appendChild(n);var i=ve.cloneElement(t,lnt({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:bz.createPortal(i,n,"".concat(e.row,"-").concat(e.col,"-").concat(Math.random())),portalContainer:n}}function YZ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}var KZ=function(){function t(){pp(this,t)}return mp(t,null,[{key:"getSettings",value:function(r){var n={};if(r.settings){var i=r.settings;for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])}for(var a in r)a!=="settings"&&a!=="children"&&r.hasOwnProperty(a)&&(n[a]=r[a]);return n}}]),t}(),Ent=function(t){Iv(r,t);var e=xv(r);function r(){return pp(this,r),e.apply(this,arguments)}return mp(r,[{key:"getSettingsProps",value:function(){var i=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(o){return!i.internalProps.includes(o)}).reduce(function(o,a){return o[a]=i.props[a],o},{})}},{key:"getLocalEditorElement",value:function(){return GZ(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var i=this.props._getChildElementByType(this.props.children,"hot-renderer"),o=this.getLocalEditorElement();this.columnSettings=KZ.getSettings(this.getSettingsProps()),i!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(i),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),o!==null&&(this.columnSettings.editor=this.props._getEditorClass(o,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var i=this.props._getOwnerDocument(),o=zZ(i,this.getLocalEditorElement());return ve.createElement(ve.Fragment,null,o)}}]),r}(ve.Component),Cnt=function(t){Iv(r,t);var e=xv(r);function r(){var n;return pp(this,r),n=e.apply(this,arguments),n.state={portals:[]},n}return mp(r,[{key:"render",value:function(){return ve.createElement(ve.Fragment,null,this.state.portals)}}]),r}(ve.Component),_nt="12.3.3";function cx(t,e){return e={exports:{}},t(e,e.exports),e.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wn=typeof Symbol=="function"&&Symbol.for,fx=wn?Symbol.for("react.element"):60103,hx=wn?Symbol.for("react.portal"):60106,W6=wn?Symbol.for("react.fragment"):60107,z6=wn?Symbol.for("react.strict_mode"):60108,G6=wn?Symbol.for("react.profiler"):60114,Y6=wn?Symbol.for("react.provider"):60109,K6=wn?Symbol.for("react.context"):60110,dx=wn?Symbol.for("react.async_mode"):60111,q6=wn?Symbol.for("react.concurrent_mode"):60111,X6=wn?Symbol.for("react.forward_ref"):60112,Q6=wn?Symbol.for("react.suspense"):60113,Tnt=wn?Symbol.for("react.suspense_list"):60120,Z6=wn?Symbol.for("react.memo"):60115,J6=wn?Symbol.for("react.lazy"):60116,Ont=wn?Symbol.for("react.block"):60121,Ant=wn?Symbol.for("react.fundamental"):60117,Int=wn?Symbol.for("react.responder"):60118,xnt=wn?Symbol.for("react.scope"):60119;function Li(t){if(Av(t)==="object"&&t!==null){var e=t.$$typeof;switch(e){case fx:switch(t=t.type,t){case dx:case q6:case W6:case G6:case z6:case Q6:return t;default:switch(t=t&&t.$$typeof,t){case K6:case X6:case J6:case Z6:case Y6:return t;default:return e}}case hx:return e}}}function qZ(t){return Li(t)===q6}var Mnt=dx,Nnt=q6,Pnt=K6,knt=Y6,$nt=fx,Lnt=X6,Dnt=W6,Fnt=J6,Hnt=Z6,Bnt=hx,Unt=G6,Vnt=z6,jnt=Q6,Wnt=function(e){return qZ(e)||Li(e)===dx},znt=qZ,Gnt=function(e){return Li(e)===K6},Ynt=function(e){return Li(e)===Y6},Knt=function(e){return Av(e)==="object"&&e!==null&&e.$$typeof===fx},qnt=function(e){return Li(e)===X6},Xnt=function(e){return Li(e)===W6},Qnt=function(e){return Li(e)===J6},Znt=function(e){return Li(e)===Z6},Jnt=function(e){return Li(e)===hx},eit=function(e){return Li(e)===G6},tit=function(e){return Li(e)===z6},rit=function(e){return Li(e)===Q6},nit=function(e){return typeof e=="string"||typeof e=="function"||e===W6||e===q6||e===G6||e===z6||e===Q6||e===Tnt||Av(e)==="object"&&e!==null&&(e.$$typeof===J6||e.$$typeof===Z6||e.$$typeof===Y6||e.$$typeof===K6||e.$$typeof===X6||e.$$typeof===Ant||e.$$typeof===Int||e.$$typeof===xnt||e.$$typeof===Ont)},iit=Li,oit={AsyncMode:Mnt,ConcurrentMode:Nnt,ContextConsumer:Pnt,ContextProvider:knt,Element:$nt,ForwardRef:Lnt,Fragment:Dnt,Lazy:Fnt,Memo:Hnt,Portal:Bnt,Profiler:Unt,StrictMode:Vnt,Suspense:jnt,isAsyncMode:Wnt,isConcurrentMode:znt,isContextConsumer:Gnt,isContextProvider:Ynt,isElement:Knt,isForwardRef:qnt,isFragment:Xnt,isLazy:Qnt,isMemo:Znt,isPortal:Jnt,isProfiler:eit,isStrictMode:tit,isSuspense:rit,isValidElementType:nit,typeOf:iit},er=cx(function(t,e){});er.AsyncMode;er.ConcurrentMode;er.ContextConsumer;er.ContextProvider;er.Element;er.ForwardRef;er.Fragment;er.Lazy;er.Memo;er.Portal;er.Profiler;er.StrictMode;er.Suspense;er.isAsyncMode;er.isConcurrentMode;er.isContextConsumer;er.isContextProvider;er.isElement;er.isForwardRef;er.isFragment;er.isLazy;er.isMemo;er.isPortal;er.isProfiler;er.isStrictMode;er.isSuspense;er.isValidElementType;er.typeOf;cx(function(t){t.exports=oit});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var eV=Object.getOwnPropertySymbols,ait=Object.prototype.hasOwnProperty,sit=Object.prototype.propertyIsEnumerable;function lit(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function uit(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(e).map(function(o){return e[o]});if(n.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(o){i[o]=o}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}uit();var cit="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",fit=cit;Function.call.bind(Object.prototype.hasOwnProperty);function XZ(){}function QZ(){}QZ.resetWarningCache=XZ;var hit=function(){function e(i,o,a,s,l,u){if(u!==fit){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function r(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:r,element:e,elementType:e,instanceOf:r,node:e,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:QZ,resetWarningCache:XZ};return n.PropTypes=n,n},dit=cx(function(t){t.exports=hit()}),FC=dit,ZZ=function(t){Iv(r,t);var e=xv(r);function r(){var n;return pp(this,r),n=e.apply(this,arguments),n.id=null,n.__hotInstance=null,n.hotElementRef=null,n.columnSettings=[],n.renderersPortalManager=null,n.portalCacheArray=[],n.renderedCellCache=new Map,n.editorCache=new Map,n.componentRendererColumns=new Map,n}return mp(r,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(bnt),null)},set:function(i){this.__hotInstance=i}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(i){this.hotElementRef=i}},{key:"getRendererWrapper",value:function(i){var o=this;return function(a,s,l,u,c,f,h){var d=o.getRenderedCellCache();if(d.has("".concat(l,"-").concat(u))&&(s.innerHTML=d.get("".concat(l,"-").concat(u)).innerHTML),s&&!s.getAttribute("ghost-table")){for(var p=Rnt(i,{TD:s,row:l,col:u,prop:c,value:f,cellProperties:h,isRenderer:!0},s.ownerDocument),m=p.portal,g=p.portalContainer;s.firstChild;)s.removeChild(s.firstChild);s.appendChild(g),o.portalCacheArray.push(m)}return d.set("".concat(l,"-").concat(u),s),s}}},{key:"getEditorClass",value:function(i){var o,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qw,s=WZ(i),l=(o=this.getEditorCache().get(s))===null||o===void 0?void 0:o.get(a);return this.makeEditorClass(l)}},{key:"makeEditorClass",value:function(i){var o=function(a){Iv(l,a);var s=xv(l);function l(u){var c;return pp(this,l),c=s.call(this,u),i.hotCustomEditorInstance=VZ(c),c.editorComponent=i,c}return mp(l,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),l}(xt.editors.BaseEditor);return Object.getOwnPropertyNames(xt.editors.BaseEditor.prototype).forEach(function(a){a!=="constructor"&&(o.prototype[a]=function(){for(var s,l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];return(s=i[a]).call.apply(s,[i].concat(u))})}),o}},{key:"getGlobalRendererElement",value:function(){return yA(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return GZ(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var i=KZ.getSettings(this.props),o=this.getGlobalRendererElement(),a=this.getGlobalEditorElement();return i.columns=this.columnSettings.length?this.columnSettings:i.columns,a?i.editor=this.getEditorClass(a,Qw):i.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),o?(i.renderer=this.getRendererWrapper(o),this.componentRendererColumns.set("global",!0)):i.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),i}},{key:"displayAutoSizeWarning",value:function(i){var o,a;this.hotInstance&&((o=this.hotInstance.getPlugin("autoRowSize"))!==null&&o!==void 0&&o.enabled||(a=this.hotInstance.getPlugin("autoColumnSize"))!==null&&a!==void 0&&a.enabled)&&this.componentRendererColumns.size>0&&Snt(vnt)}},{key:"setHotColumnSettings",value:function(i,o){this.columnSettings[o]=i}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var i=this;this.renderersPortalManager.setState({portals:hnt(this.portalCacheArray)},function(){i.portalCacheArray=[]})}},{key:"updateHot",value:function(i){this.hotInstance&&this.hotInstance.updateSettings(i,!1)}},{key:"setRenderersPortalManagerRef",value:function(i){this.renderersPortalManager=i}},{key:"componentDidMount",value:function(){var i=this,o=this.createNewGlobalSettings();this.hotInstance=new xt.Core(this.hotElementRef,o),this.hotInstance.addHook("beforeViewRender",function(){return i.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return i.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(o)}},{key:"componentDidUpdate",value:function(){this.clearCache();var i=this.createNewGlobalSettings();this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var i=this,o=YZ(this.props),a=function(f){return f.type===Ent},s=ve.Children.toArray(this.props.children),l=s.filter(function(c){return a(c)}).map(function(c,f){return ve.cloneElement(c,{_componentRendererColumns:i.componentRendererColumns,_emitColumnSettings:i.setHotColumnSettings.bind(i),_columnIndex:f,_getChildElementByType:yA.bind(i),_getRendererWrapper:i.getRendererWrapper.bind(i),_getEditorClass:i.getEditorClass.bind(i),_getOwnerDocument:i.getOwnerDocument.bind(i),_getEditorCache:i.getEditorCache.bind(i),children:c.props.children})}),u=zZ(this.getOwnerDocument(),this.getGlobalEditorElement());return ve.createElement(ve.Fragment,null,ve.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},o),l),ve.createElement(Cnt,{ref:this.setRenderersPortalManagerRef.bind(this)}),u)}}],[{key:"version",get:function(){return _nt}}]),r}(ve.Component);ZZ.propTypes={style:FC.object,id:FC.string,className:FC.string};ve.Component;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var Mr;(function(t){t.RELATIVE="RELATIVE",t.ABSOLUTE="ABSOLUTE"})(Mr||(Mr={}));class Yn{constructor(e,r,n){this.type=e,this.col=r,this.sheet=n}static absolute(e,r){return new Yn(Mr.ABSOLUTE,e,r)}static relative(e,r){return new Yn(Mr.RELATIVE,e,r)}static compareByAbsoluteAddress(e){return(r,n)=>r.toSimpleColumnAddress(e).col-n.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===Mr.ABSOLUTE}isColumnRelative(){return this.type===Mr.RELATIVE}isAbsolute(){return this.type===Mr.ABSOLUTE&&this.sheet!==void 0}moved(e,r,n){const i=this.sheet===void 0?void 0:e;return new Yn(this.type,this.col+r,i)}shiftedByColumns(e){return new Yn(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const r=Ao(this,e);let n=this.col;return this.isColumnRelative()&&(n=e.col+this.col),Tee(r,n)}shiftRelativeDimensions(e,r){const n=this.isColumnRelative()?this.col+e:this.col;return new Yn(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,r){const n=this.isColumnAbsolute()?this.col+e:this.col;return new Yn(this.type,n,this.sheet)}withSheet(e){return new Yn(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const r=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case Mr.RELATIVE:return`${r}#COLR${this.col}`;case Mr.ABSOLUTE:return`${r}#COLA${this.col}`}}unparse(e){const r=this.toSimpleColumnAddress(e);if(Wst(r))return;const n=gx(r.col);return`${this.type===Mr.ABSOLUTE?"$":""}${n}`}exceedsSheetSizeLimits(e){return this.col>=e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class $n{constructor(e,r,n){this.type=e,this.row=r,this.sheet=n}static absolute(e,r){return new $n(Mr.ABSOLUTE,e,r)}static relative(e,r){return new $n(Mr.RELATIVE,e,r)}static compareByAbsoluteAddress(e){return(r,n)=>r.toSimpleRowAddress(e).row-n.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===Mr.ABSOLUTE}isRowRelative(){return this.type===Mr.RELATIVE}isAbsolute(){return this.type===Mr.ABSOLUTE&&this.sheet!==void 0}moved(e,r,n){const i=this.sheet===void 0?void 0:e;return new $n(this.type,this.row+n,i)}shiftedByRows(e){return new $n(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const r=Ao(this,e);let n=this.row;return this.isRowRelative()&&(n=e.row+this.row),_ee(r,n)}shiftRelativeDimensions(e,r){const n=this.isRowRelative()?this.row+r:this.row;return new $n(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,r){const n=this.isRowAbsolute()?this.row+r:this.row;return new $n(this.type,n,this.sheet)}withSheet(e){return new $n(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const r=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case Mr.RELATIVE:return`${r}#ROWR${this.row}`;case Mr.ABSOLUTE:return`${r}#ROWA${this.row}`}}unparse(e){const r=this.toSimpleRowAddress(e);return jst(r)?void 0:`${this.type===Mr.ABSOLUTE?"$":""}${r.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var zt;(function(t){t.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",t.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",t.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",t.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"})(zt||(zt={}));class Kt{constructor(e,r,n,i){this.col=e,this.row=r,this.type=n,this.sheet=i}static fromColAndRow(e,r,n){return(e.isColumnAbsolute()&&r.isRowAbsolute()?Kt.absolute.bind(this):e.isColumnAbsolute()?Kt.absoluteCol.bind(this):r.isRowAbsolute()?Kt.absoluteRow.bind(this):Kt.relative.bind(this))(e.col,r.row,n)}static relative(e,r,n){return new Kt(e,r,zt.CELL_REFERENCE_RELATIVE,n)}static absolute(e,r,n){return new Kt(e,r,zt.CELL_REFERENCE_ABSOLUTE,n)}static absoluteCol(e,r,n){return new Kt(e,r,zt.CELL_REFERENCE_ABSOLUTE_COL,n)}static absoluteRow(e,r,n){return new Kt(e,r,zt.CELL_REFERENCE_ABSOLUTE_ROW,n)}toSimpleCellAddress(e){const r=Ao(this,e);return this.type===zt.CELL_REFERENCE_ABSOLUTE?Le(r,this.col,this.row):this.type===zt.CELL_REFERENCE_ABSOLUTE_ROW?Le(r,e.col+this.col,this.row):this.type===zt.CELL_REFERENCE_ABSOLUTE_COL?Le(r,this.col,e.row+this.row):Le(r,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?Mr.RELATIVE:Mr.ABSOLUTE;return new Yn(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?Mr.RELATIVE:Mr.ABSOLUTE;return new $n(e,this.row,this.sheet)}toSimpleColumnAddress(e){const r=Ao(this,e);let n=this.col;return this.isColumnRelative()&&(n+=e.col),Tee(r,n)}toSimpleRowAddress(e){const r=Ao(this,e);let n=this.row;return this.isRowRelative()&&(n+=e.row),_ee(r,n)}isRowAbsolute(){return this.type===zt.CELL_REFERENCE_ABSOLUTE||this.type===zt.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===zt.CELL_REFERENCE_ABSOLUTE||this.type===zt.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===zt.CELL_REFERENCE_RELATIVE||this.type===zt.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===zt.CELL_REFERENCE_RELATIVE||this.type===zt.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===zt.CELL_REFERENCE_ABSOLUTE&&this.sheet!==void 0}shiftedByRows(e){return new Kt(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new Kt(this.col+e,this.row,this.type,this.sheet)}moved(e,r,n){const i=this.sheet===void 0?void 0:e;return new Kt(this.col+r,this.row+n,this.type,i)}withSheet(e){return new Kt(this.col,this.row,this.type,e)}isInvalid(e){return fi(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,r){const n=this.isColumnAbsolute()?this.col:this.col+e,i=this.isRowAbsolute()?this.row:this.row+r;return new Kt(n,i,this.type,this.sheet)}shiftAbsoluteDimensions(e,r){const n=this.isColumnRelative()?this.col:this.col+e,i=this.isRowRelative()?this.row:this.row+r;return new Kt(n,i,this.type,this.sheet)}hash(e){const r=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case zt.CELL_REFERENCE_RELATIVE:return`${r}#${this.row}R${this.col}`;case zt.CELL_REFERENCE_ABSOLUTE:return`${r}#${this.row}A${this.col}`;case zt.CELL_REFERENCE_ABSOLUTE_COL:return`${r}#${this.row}AC${this.col}`;case zt.CELL_REFERENCE_ABSOLUTE_ROW:return`${r}#${this.row}AR${this.col}`}}unparse(e){const r=this.toSimpleCellAddress(e);if(fi(r))return;const n=gx(r.col),i=this.type===zt.CELL_REFERENCE_ABSOLUTE||this.type===zt.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===zt.CELL_REFERENCE_ABSOLUTE||this.type===zt.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${n}${i}${r.row+1}`}exceedsSheetSizeLimits(e,r){return this.row>=r||this.col>=e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const V1=":",Kn="$",pit="\\s+",mit="[ \\t\\n\\r]+",e5="A-Za-z\xC0-\u02AF",px=`${e5}0-9_.`,JZ=`[${e5}0-9_]+`,git="'(((?!').|'')*)'",Wp=`(${JZ}|${git})!`,eJ=`(${Wp})?\\${Kn}?[A-Za-z]+\\${Kn}?[0-9]+`,tV=`(${Wp})?\\${Kn}?[A-Za-z]+`,rV=`(${Wp})?\\${Kn}?[0-9]+`,tJ="[rR][0-9]*[cC][0-9]*",yit=`(${eJ})[^${px}]`,rJ=`[${e5}_][${px}]*`,vit=["0","1","2","3","4","5","6","7","8","9"],nJ=[...Array.from(Array(26)).map((t,e)=>e+"A".charCodeAt(0)),...Array.from(Array(26)).map((t,e)=>e+"a".charCodeAt(0)),...Array.from(Array(687-192+1)).map((t,e)=>e+192)].map(t=>String.fromCharCode(t));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const iJ=new RegExp(`^(${Wp})?(\\${Kn}?)([A-Za-z]+)(\\${Kn}?)([0-9]+)$`),bit=new RegExp(`^(${Wp})?(\\${Kn}?)([A-Za-z]+)$`),wit=new RegExp(`^(${Wp})?(\\${Kn}?)([0-9]+)$`),Sit=new RegExp(`^${JZ}$`),Tf=(t,e,r)=>{const n=iJ.exec(e),i=mx(n[6]);let o=t5(n,t);if(o===void 0)return;o===null&&(o=void 0);const a=Number(n[8])-1;return n[5]===Kn&&n[7]===Kn?Kt.absolute(i,a,o):n[5]===Kn?Kt.absoluteCol(i,a-r.row,o):n[7]===Kn?Kt.absoluteRow(i-r.col,a,o):Kt.relative(i-r.col,a-r.row,o)},Zw=(t,e,r)=>{const n=bit.exec(e);let i=t5(n,t);if(i===void 0)return;i===null&&(i=void 0);const o=mx(n[6]);return n[5]===Kn?Yn.absolute(o,i):Yn.relative(o-r.col,i)},Jw=(t,e,r)=>{const n=wit.exec(e);let i=t5(n,t);if(i===void 0)return;i===null&&(i=void 0);const o=Number(n[6])-1;return n[5]===Kn?$n.absolute(o,i):$n.relative(o-r.row,i)},vA=(t,e,r)=>{const n=iJ.exec(e),i=mx(n[6]);let o=t5(n,t);if(o===void 0)return;o===null&&(o=r);const a=Number(n[8])-1;return Le(o,i,a)},Rit=(t,e,r)=>{const n=e.split(V1);if(n.length!==2)return;const[i,o]=n,a=vA(t,i,r);if(a===void 0)return;const s=vA(t,o,a.sheet);if(s!==void 0&&a.sheet===s.sheet)return kA(a,s)},eS=(t,e,r)=>{const n=gx(e.col),i=oJ(e.sheet,t);if(i!==void 0)return r!==e.sheet?`${i}!${n}${e.row+1}`:`${n}${e.row+1}`},Eit=(t,e,r)=>{const n=eS(t,e.start,r),i=eS(t,e.end,e.start.sheet);if(!(n===void 0||i===void 0))return`${n}${V1}${i}`};function mx(t){return t.length===1?t.toUpperCase().charCodeAt(0)-65:t.split("").reduce((e,r)=>e*26+(r.toUpperCase().charCodeAt(0)-64),0)-1}function gx(t){let e="";for(;t>=0;)e=String.fromCharCode(t%26+97)+e,t=Math.floor(t/26)-1;return e.toUpperCase()}function oJ(t,e){let r=e(t);if(r!==void 0)return Sit.test(r)?r:(r=r.replace(/'/g,"''"),`'${r}'`)}function t5(t,e){var r;let n=(r=t[3])!==null&&r!==void 0?r:t[2];return n?(n=n.replace(/''/g,"'"),e(n)):null}function Zt(t){return t&&t.length===0}function As(t){return t==null?[]:Object.keys(t)}function Dn(t){for(var e=[],r=Object.keys(t),n=0;n<r.length;n++)e.push(t[r[n]]);return e}function Cit(t,e){for(var r=[],n=As(t),i=0;i<n.length;i++){var o=n[i];r.push(e.call(null,t[o],o))}return r}function Fe(t,e){for(var r=[],n=0;n<t.length;n++)r.push(e.call(null,t[n],n));return r}function mi(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];Array.isArray(n)?e=e.concat(mi(n)):e.push(n)}return e}function to(t){return Zt(t)?void 0:t[0]}function aJ(t){var e=t&&t.length;return e?t[e-1]:void 0}function Je(t,e){if(Array.isArray(t))for(var r=0;r<t.length;r++)e.call(null,t[r],r);else if(vx(t))for(var n=As(t),r=0;r<n.length;r++){var i=n[r],o=t[i];e.call(null,o,i)}else throw Error("non exhaustive match")}function ca(t){return typeof t=="string"}function ro(t){return t===void 0}function Tl(t){return t instanceof Function}function Tn(t,e){return e===void 0&&(e=1),t.slice(e,t.length)}function Mv(t,e){return e===void 0&&(e=1),t.slice(0,t.length-e)}function Po(t,e){var r=[];if(Array.isArray(t))for(var n=0;n<t.length;n++){var i=t[n];e.call(null,i)&&r.push(i)}return r}function oc(t,e){return Po(t,function(r){return!e(r)})}function lo(t,e){for(var r=Object.keys(t),n={},i=0;i<r.length;i++){var o=r[i],a=t[o];e(a)&&(n[o]=a)}return n}function Ze(t,e){return vx(t)?t.hasOwnProperty(e):!1}function sn(t,e){return gp(t,function(r){return r===e})!==void 0}function gi(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r]);return e}function j1(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}function gp(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(e.call(null,n))return n}}function _it(t,e){for(var r=[],n=0;n<t.length;n++){var i=t[n];e.call(null,i)&&r.push(i)}return r}function Mn(t,e,r){for(var n=Array.isArray(t),i=n?t:Dn(t),o=n?[]:As(t),a=r,s=0;s<i.length;s++)a=e.call(null,a,i[s],n?s:o[s]);return a}function W1(t){return oc(t,function(e){return e==null})}function yx(t,e){e===void 0&&(e=function(n){return n});var r=[];return Mn(t,function(n,i){var o=e(i);return sn(r,o)?n:(r.push(o),n.concat(i))},[])}function To(t){return Array.isArray(t)}function Rs(t){return t instanceof RegExp}function vx(t){return t instanceof Object}function Qi(t,e){for(var r=0;r<t.length;r++)if(!e(t[r],r))return!1;return!0}function r5(t,e){return oc(t,function(r){return sn(e,r)})}function sJ(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return!0;return!1}function Tit(t,e){for(var r=0;r<t.length;r++)if(t[r]===e)return r;return-1}function ko(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n++)for(var i=e[n],o=As(i),a=0;a<o.length;a++){var s=o[a];t[s]=i[s]}return t}function Oit(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n++){var i=e[n];if(!ro(i))for(var o=As(i),a=0;a<o.length;a++){var s=o[a];Ze(t,s)||(t[s]=i[s])}}return t}function n5(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Oit.apply(null,[{}].concat(t))}function lJ(t,e){var r={};return Je(t,function(n){var i=e(n),o=r[i];o?o.push(n):r[i]=[n]}),r}function nV(t,e){for(var r=j1(t),n=As(e),i=0;i<n.length;i++){var o=n[i],a=e[o];r[o]=a}return r}function un(){}function iV(t){return t}function Ait(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];e.push(n!==void 0?n:void 0)}return e}function bA(t){console&&console.error&&console.error("Error: "+t)}function bx(t){console&&console.warn&&console.warn("Warning: "+t)}function oV(){return typeof Map=="function"}function Iit(t,e){e.forEach(function(r){var n=r.prototype;Object.getOwnPropertyNames(n).forEach(function(i){if(i!=="constructor"){var o=Object.getOwnPropertyDescriptor(n,i);o&&(o.get||o.set)?Object.defineProperty(t.prototype,i,o):t.prototype[i]=r.prototype[i]}})})}function uJ(t){function e(){}e.prototype=t;var r=new e;function n(){return typeof r.bar}return n(),n(),t}function tS(t){return t[t.length-1]}function cJ(t){var e=new Date().getTime(),r=t(),n=new Date().getTime(),i=n-e;return{time:i,value:r}}var zp={exports:{}};(function(t){(function(e,r){t.exports?t.exports=r():e.regexpToAst=r()})(typeof self<"u"?self:uh,function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(m){this.idx=m.idx,this.input=m.input,this.groupIdx=m.groupIdx},e.prototype.pattern=function(m){this.idx=0,this.input=m,this.groupIdx=0,this.consumeChar("/");var g=this.disjunction();this.consumeChar("/");for(var v={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":s(v,"global");break;case"i":s(v,"ignoreCase");break;case"m":s(v,"multiLine");break;case"u":s(v,"unicode");break;case"y":s(v,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:v,value:g}},e.prototype.disjunction=function(){var m=[];for(m.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),m.push(this.alternative());return{type:"Disjunction",value:m}},e.prototype.alternative=function(){for(var m=[];this.isTerm();)m.push(this.term());return{type:"Alternative",value:m}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var m;switch(this.popChar()){case"=":m="Lookahead";break;case"!":m="NegativeLookahead";break}l(m);var g=this.disjunction();return this.consumeChar(")"),{type:m,value:g}}u()},e.prototype.quantifier=function(m){var g;switch(this.popChar()){case"*":g={atLeast:0,atMost:1/0};break;case"+":g={atLeast:1,atMost:1/0};break;case"?":g={atLeast:0,atMost:1};break;case"{":var v=this.integerIncludingZero();switch(this.popChar()){case"}":g={atLeast:v,atMost:v};break;case",":var w;this.isDigit()?(w=this.integerIncludingZero(),g={atLeast:v,atMost:w}):g={atLeast:v,atMost:1/0},this.consumeChar("}");break}if(m===!0&&g===void 0)return;l(g);break}if(!(m===!0&&g===void 0))return l(g),this.peekChar(0)==="?"?(this.consumeChar("?"),g.greedy=!1):g.greedy=!0,g.type="Quantifier",g},e.prototype.atom=function(){var m;switch(this.peekChar()){case".":m=this.dotAll();break;case"\\":m=this.atomEscape();break;case"[":m=this.characterClass();break;case"(":m=this.group();break}return m===void 0&&this.isPatternCharacter()&&(m=this.patternCharacter()),l(m),this.isQuantifier()&&(m.quantifier=this.quantifier()),m},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[o(`
`),o("\r"),o("\u2028"),o("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var m=this.positiveInteger();return{type:"GroupBackReference",value:m}},e.prototype.characterClassEscape=function(){var m,g=!1;switch(this.popChar()){case"d":m=f;break;case"D":m=f,g=!0;break;case"s":m=d;break;case"S":m=d,g=!0;break;case"w":m=h;break;case"W":m=h,g=!0;break}return l(m),{type:"Set",value:m,complement:g}},e.prototype.controlEscapeAtom=function(){var m;switch(this.popChar()){case"f":m=o("\f");break;case"n":m=o(`
`);break;case"r":m=o("\r");break;case"t":m=o("	");break;case"v":m=o("\v");break}return l(m),{type:"Character",value:m}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var m=this.popChar();if(/[a-zA-Z]/.test(m)===!1)throw Error("Invalid ");var g=m.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:g}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:o("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var m=this.popChar();return{type:"Character",value:o(m)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var m=this.popChar();return{type:"Character",value:o(m)}}},e.prototype.characterClass=function(){var m=[],g=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),g=!0);this.isClassAtom();){var v=this.classAtom(),w=v.type==="Character";if(w&&this.isRangeDash()){this.consumeChar("-");var b=this.classAtom(),E=b.type==="Character";if(E){if(b.value<v.value)throw Error("Range out of order in character class");m.push({from:v.value,to:b.value})}else a(v.value,m),m.push(o("-")),a(b.value,m)}else a(v.value,m)}return this.consumeChar("]"),{type:"Set",complement:g,value:m}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:o("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var m=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),m=!1;break;default:this.groupIdx++;break}var g=this.disjunction();this.consumeChar(")");var v={type:"Group",capturing:m,value:g};return m&&(v.idx=this.groupIdx),v},e.prototype.positiveInteger=function(){var m=this.popChar();if(i.test(m)===!1)throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)m+=this.popChar();return parseInt(m,10)},e.prototype.integerIncludingZero=function(){var m=this.popChar();if(n.test(m)===!1)throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)m+=this.popChar();return parseInt(m,10)},e.prototype.patternCharacter=function(){var m=this.popChar();switch(m){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:o(m)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},e.prototype.isDigit=function(){return n.test(this.peekChar(0))},e.prototype.isClassAtom=function(m){switch(m===void 0&&(m=0),this.peekChar(m)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},e.prototype.isQuantifier=function(){var m=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(m)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(m){for(var g="",v=0;v<m;v++){var w=this.popChar();if(r.test(w)===!1)throw Error("Expecting a HexDecimal digits");g+=w}var b=parseInt(g,16);return{type:"Character",value:b}},e.prototype.peekChar=function(m){return m===void 0&&(m=0),this.input[this.idx+m]},e.prototype.popChar=function(){var m=this.peekChar(0);return this.consumeChar(),m},e.prototype.consumeChar=function(m){if(m!==void 0&&this.input[this.idx]!==m)throw Error("Expected: '"+m+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var r=/[0-9a-fA-F]/,n=/[0-9]/,i=/[1-9]/;function o(m){return m.charCodeAt(0)}function a(m,g){m.length!==void 0?m.forEach(function(v){g.push(v)}):g.push(m)}function s(m,g){if(m[g]===!0)throw"duplicate flag "+g;m[g]=!0}function l(m){if(m===void 0)throw Error("Internal Error - Should never get here!")}function u(){throw Error("Internal Error - Should never get here!")}var c,f=[];for(c=o("0");c<=o("9");c++)f.push(c);var h=[o("_")].concat(f);for(c=o("a");c<=o("z");c++)h.push(c);for(c=o("A");c<=o("Z");c++)h.push(c);var d=[o(" "),o("\f"),o(`
`),o("\r"),o("	"),o("\v"),o("	"),o("\xA0"),o("\u1680"),o("\u2000"),o("\u2001"),o("\u2002"),o("\u2003"),o("\u2004"),o("\u2005"),o("\u2006"),o("\u2007"),o("\u2008"),o("\u2009"),o("\u200A"),o("\u2028"),o("\u2029"),o("\u202F"),o("\u205F"),o("\u3000"),o("\uFEFF")];function p(){}return p.prototype.visitChildren=function(m){for(var g in m){var v=m[g];m.hasOwnProperty(g)&&(v.type!==void 0?this.visit(v):Array.isArray(v)&&v.forEach(function(w){this.visit(w)},this))}},p.prototype.visit=function(m){switch(m.type){case"Pattern":this.visitPattern(m);break;case"Flags":this.visitFlags(m);break;case"Disjunction":this.visitDisjunction(m);break;case"Alternative":this.visitAlternative(m);break;case"StartAnchor":this.visitStartAnchor(m);break;case"EndAnchor":this.visitEndAnchor(m);break;case"WordBoundary":this.visitWordBoundary(m);break;case"NonWordBoundary":this.visitNonWordBoundary(m);break;case"Lookahead":this.visitLookahead(m);break;case"NegativeLookahead":this.visitNegativeLookahead(m);break;case"Character":this.visitCharacter(m);break;case"Set":this.visitSet(m);break;case"Group":this.visitGroup(m);break;case"GroupBackReference":this.visitGroupBackReference(m);break;case"Quantifier":this.visitQuantifier(m);break}this.visitChildren(m)},p.prototype.visitPattern=function(m){},p.prototype.visitFlags=function(m){},p.prototype.visitDisjunction=function(m){},p.prototype.visitAlternative=function(m){},p.prototype.visitStartAnchor=function(m){},p.prototype.visitEndAnchor=function(m){},p.prototype.visitWordBoundary=function(m){},p.prototype.visitNonWordBoundary=function(m){},p.prototype.visitLookahead=function(m){},p.prototype.visitNegativeLookahead=function(m){},p.prototype.visitCharacter=function(m){},p.prototype.visitSet=function(m){},p.prototype.visitGroup=function(m){},p.prototype.visitGroupBackReference=function(m){},p.prototype.visitQuantifier=function(m){},{RegExpParser:e,BaseRegExpVisitor:p,VERSION:"0.4.0"}})})(zp);var w2={},xit=new zp.exports.RegExpParser;function i5(t){var e=t.toString();if(w2.hasOwnProperty(e))return w2[e];var r=xit.pattern(e);return w2[e]=r,r}function Mit(){w2={}}var Nit=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),fJ="Complement Sets are not supported for first char optimization",rS=`Unable to use "first char" lexer optimizations:
`;function Pit(t,e){e===void 0&&(e=!1);try{var r=i5(t),n=wA(r.value,{},r.flags.ignoreCase);return n}catch(o){if(o.message===fJ)e&&bx(""+rS+("	Unable to optimize: < "+t.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var i="";e&&(i=`
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),bA(rS+`
`+("	Failed parsing: < "+t.toString()+` >
`)+("	Using the regexp-to-ast library version: "+zp.exports.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+i)}}return[]}function wA(t,e,r){switch(t.type){case"Disjunction":for(var n=0;n<t.value.length;n++)wA(t.value[n],e,r);break;case"Alternative":for(var i=t.value,n=0;n<i.length;n++){var o=i[n];switch(o.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var a=o;switch(a.type){case"Character":ib(a.value,e,r);break;case"Set":if(a.complement===!0)throw Error(fJ);Je(a.value,function(u){if(typeof u=="number")ib(u,e,r);else{var c=u;if(r===!0)for(var f=c.from;f<=c.to;f++)ib(f,e,r);else{for(var f=c.from;f<=c.to&&f<Vm;f++)ib(f,e,r);if(c.to>=Vm)for(var h=c.from>=Vm?c.from:Vm,d=c.to,p=vl(h),m=vl(d),g=p;g<=m;g++)e[g]=g}}});break;case"Group":wA(a.value,e,r);break;default:throw Error("Non Exhaustive Match")}var s=a.quantifier!==void 0&&a.quantifier.atLeast===0;if(a.type==="Group"&&SA(a)===!1||a.type!=="Group"&&s===!1)break}break;default:throw Error("non exhaustive match!")}return Dn(e)}function ib(t,e,r){var n=vl(t);e[n]=n,r===!0&&kit(t,e)}function kit(t,e){var r=String.fromCharCode(t),n=r.toUpperCase();if(n!==r){var i=vl(n.charCodeAt(0));e[i]=i}else{var o=r.toLowerCase();if(o!==r){var i=vl(o.charCodeAt(0));e[i]=i}}}function aV(t,e){return gp(t.value,function(r){if(typeof r=="number")return sn(e,r);var n=r;return gp(e,function(i){return n.from<=i&&i<=n.to})!==void 0})}function SA(t){return t.quantifier&&t.quantifier.atLeast===0?!0:t.value?To(t.value)?Qi(t.value,SA):SA(t.value):!1}var $it=function(t){Nit(e,t);function e(r){var n=t.call(this)||this;return n.targetCharCodes=r,n.found=!1,n}return e.prototype.visitChildren=function(r){if(this.found!==!0){switch(r.type){case"Lookahead":this.visitLookahead(r);return;case"NegativeLookahead":this.visitNegativeLookahead(r);return}t.prototype.visitChildren.call(this,r)}},e.prototype.visitCharacter=function(r){sn(this.targetCharCodes,r.value)&&(this.found=!0)},e.prototype.visitSet=function(r){r.complement?aV(r,this.targetCharCodes)===void 0&&(this.found=!0):aV(r,this.targetCharCodes)!==void 0&&(this.found=!0)},e}(zp.exports.BaseRegExpVisitor);function wx(t,e){if(e instanceof RegExp){var r=i5(e),n=new $it(t);return n.visit(r),n.found}else return gp(e,function(i){return sn(t,i.charCodeAt(0))})!==void 0}var hJ=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),fa="PATTERN",Nu="defaultMode",ob="modes",dJ=typeof new RegExp("(?:)").sticky=="boolean";function Lit(t,e){e=n5(e,{useSticky:dJ,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(w,b){return b()}});var r=e.tracer;r("initCharCodeToOptimizedIndexMap",function(){oot()});var n;r("Reject Lexer.NA",function(){n=oc(t,function(w){return w[fa]===pi.NA})});var i=!1,o;r("Transform Patterns",function(){i=!1,o=Fe(n,function(w){var b=w[fa];if(Rs(b)){var E=b.source;return E.length===1&&E!=="^"&&E!=="$"&&E!=="."?E:E.length===2&&E[0]==="\\"&&!sn(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],E[1])?E[1]:e.useSticky?lV(b):sV(b)}else{if(Tl(b))return i=!0,{exec:b};if(Ze(b,"exec"))return i=!0,b;if(typeof b=="string"){if(b.length===1)return b;var A=b.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),M=new RegExp(A);return e.useSticky?lV(M):sV(M)}else throw Error("non exhaustive match")}})});var a,s,l,u,c;r("misc mapping",function(){a=Fe(n,function(w){return w.tokenTypeIdx}),s=Fe(n,function(w){var b=w.GROUP;if(b!==pi.SKIPPED){if(ca(b))return b;if(ro(b))return!1;throw Error("non exhaustive match")}}),l=Fe(n,function(w){var b=w.LONGER_ALT;if(b){var E=Tit(n,b);return E}}),u=Fe(n,function(w){return w.PUSH_MODE}),c=Fe(n,function(w){return Ze(w,"POP_MODE")})});var f;r("Line Terminator Handling",function(){var w=gJ(e.lineTerminatorCharacters);f=Fe(n,function(b){return!1}),e.positionTracking!=="onlyOffset"&&(f=Fe(n,function(b){if(Ze(b,"LINE_BREAKS"))return b.LINE_BREAKS;if(mJ(b,w)===!1)return wx(w,b.PATTERN)}))});var h,d,p,m;r("Misc Mapping #2",function(){h=Fe(n,pJ),d=Fe(o,rot),p=Mn(n,function(w,b){var E=b.GROUP;return ca(E)&&E!==pi.SKIPPED&&(w[E]=[]),w},{}),m=Fe(o,function(w,b){return{pattern:o[b],longerAlt:l[b],canLineTerminator:f[b],isCustom:h[b],short:d[b],group:s[b],push:u[b],pop:c[b],tokenTypeIdx:a[b],tokenType:n[b]}})});var g=!0,v=[];return e.safeMode||r("First Char Optimization",function(){v=Mn(n,function(w,b,E){if(typeof b.PATTERN=="string"){var A=b.PATTERN.charCodeAt(0),M=vl(A);HC(w,M,m[E])}else if(To(b.START_CHARS_HINT)){var k;Je(b.START_CHARS_HINT,function(x){var C=typeof x=="string"?x.charCodeAt(0):x,I=vl(C);k!==I&&(k=I,HC(w,I,m[E]))})}else if(Rs(b.PATTERN))if(b.PATTERN.unicode)g=!1,e.ensureOptimizations&&bA(""+rS+("	Unable to analyze < "+b.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var O=Pit(b.PATTERN,e.ensureOptimizations);Zt(O)&&(g=!1),Je(O,function(x){HC(w,x,m[E])})}else e.ensureOptimizations&&bA(""+rS+("	TokenType: <"+b.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),g=!1;return w},[])}),r("ArrayPacking",function(){v=Ait(v)}),{emptyGroups:p,patternIdxToConfig:m,charCodeToPatternIdxToConfig:v,hasCustom:i,canBeOptimized:g}}function Dit(t,e){var r=[],n=Hit(t);r=r.concat(n.errors);var i=Bit(n.valid),o=i.valid;return r=r.concat(i.errors),r=r.concat(Fit(o)),r=r.concat(Kit(o)),r=r.concat(qit(o,e)),r=r.concat(Xit(o)),r}function Fit(t){var e=[],r=Po(t,function(n){return Rs(n[fa])});return e=e.concat(Vit(r)),e=e.concat(zit(r)),e=e.concat(Git(r)),e=e.concat(Yit(r)),e=e.concat(jit(r)),e}function Hit(t){var e=Po(t,function(i){return!Ze(i,fa)}),r=Fe(e,function(i){return{message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:jr.MISSING_PATTERN,tokenTypes:[i]}}),n=r5(t,e);return{errors:r,valid:n}}function Bit(t){var e=Po(t,function(i){var o=i[fa];return!Rs(o)&&!Tl(o)&&!Ze(o,"exec")&&!ca(o)}),r=Fe(e,function(i){return{message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:jr.INVALID_PATTERN,tokenTypes:[i]}}),n=r5(t,e);return{errors:r,valid:n}}var Uit=/[^\\][\$]/;function Vit(t){var e=function(i){hJ(o,i);function o(){var a=i!==null&&i.apply(this,arguments)||this;return a.found=!1,a}return o.prototype.visitEndAnchor=function(a){this.found=!0},o}(zp.exports.BaseRegExpVisitor),r=Po(t,function(i){var o=i[fa];try{var a=i5(o),s=new e;return s.visit(a),s.found}catch{return Uit.test(o.source)}}),n=Fe(r,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:jr.EOI_ANCHOR_FOUND,tokenTypes:[i]}});return n}function jit(t){var e=Po(t,function(n){var i=n[fa];return i.test("")}),r=Fe(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' must not match an empty string",type:jr.EMPTY_MATCH_PATTERN,tokenTypes:[n]}});return r}var Wit=/[^\\[][\^]|^\^/;function zit(t){var e=function(i){hJ(o,i);function o(){var a=i!==null&&i.apply(this,arguments)||this;return a.found=!1,a}return o.prototype.visitStartAnchor=function(a){this.found=!0},o}(zp.exports.BaseRegExpVisitor),r=Po(t,function(i){var o=i[fa];try{var a=i5(o),s=new e;return s.visit(a),s.found}catch{return Wit.test(o.source)}}),n=Fe(r,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:jr.SOI_ANCHOR_FOUND,tokenTypes:[i]}});return n}function Git(t){var e=Po(t,function(n){var i=n[fa];return i instanceof RegExp&&(i.multiline||i.global)}),r=Fe(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:jr.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[n]}});return r}function Yit(t){var e=[],r=Fe(t,function(o){return Mn(t,function(a,s){return o.PATTERN.source===s.PATTERN.source&&!sn(e,s)&&s.PATTERN!==pi.NA&&(e.push(s),a.push(s)),a},[])});r=W1(r);var n=Po(r,function(o){return o.length>1}),i=Fe(n,function(o){var a=Fe(o,function(l){return l.name}),s=to(o).PATTERN;return{message:"The same RegExp pattern ->"+s+"<-"+("has been used in all of the following Token Types: "+a.join(", ")+" <-"),type:jr.DUPLICATE_PATTERNS_FOUND,tokenTypes:o}});return i}function Kit(t){var e=Po(t,function(n){if(!Ze(n,"GROUP"))return!1;var i=n.GROUP;return i!==pi.SKIPPED&&i!==pi.NA&&!ca(i)}),r=Fe(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:jr.INVALID_GROUP_TYPE_FOUND,tokenTypes:[n]}});return r}function qit(t,e){var r=Po(t,function(i){return i.PUSH_MODE!==void 0&&!sn(e,i.PUSH_MODE)}),n=Fe(r,function(i){var o="Token Type: ->"+i.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+i.PUSH_MODE+"<-which does not exist";return{message:o,type:jr.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}});return n}function Xit(t){var e=[],r=Mn(t,function(n,i,o){var a=i.PATTERN;return a===pi.NA||(ca(a)?n.push({str:a,idx:o,tokenType:i}):Rs(a)&&Zit(a)&&n.push({str:a.source,idx:o,tokenType:i})),n},[]);return Je(t,function(n,i){Je(r,function(o){var a=o.str,s=o.idx,l=o.tokenType;if(i<s&&Qit(a,n.PATTERN)){var u="Token: ->"+l.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+n.name+"<-")+`in the lexer's definition.
See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:u,type:jr.UNREACHABLE_PATTERN,tokenTypes:[n,l]})}})}),e}function Qit(t,e){if(Rs(e)){var r=e.exec(t);return r!==null&&r.index===0}else{if(Tl(e))return e(t,0,[],{});if(Ze(e,"exec"))return e.exec(t,0,[],{});if(typeof e=="string")return e===t;throw Error("non exhaustive match")}}function Zit(t){var e=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return gp(e,function(r){return t.source.indexOf(r)!==-1})===void 0}function sV(t){var e=t.ignoreCase?"i":"";return new RegExp("^(?:"+t.source+")",e)}function lV(t){var e=t.ignoreCase?"iy":"y";return new RegExp(""+t.source,e)}function Jit(t,e,r){var n=[];return Ze(t,Nu)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+Nu+`> property in its definition
`,type:jr.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Ze(t,ob)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+ob+`> property in its definition
`,type:jr.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Ze(t,ob)&&Ze(t,Nu)&&!Ze(t.modes,t.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+Nu+": <"+t.defaultMode+`>which does not exist
`,type:jr.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Ze(t,ob)&&Je(t.modes,function(i,o){Je(i,function(a,s){ro(a)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+o+"> at index: <"+s+`>
`),type:jr.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),n}function eot(t,e,r){var n=[],i=!1,o=W1(mi(Cit(t.modes,function(l){return l}))),a=oc(o,function(l){return l[fa]===pi.NA}),s=gJ(r);return e&&Je(a,function(l){var u=mJ(l,s);if(u!==!1){var c=iot(l,u),f={message:c,type:u.issue,tokenType:l};n.push(f)}else Ze(l,"LINE_BREAKS")?l.LINE_BREAKS===!0&&(i=!0):wx(s,l.PATTERN)&&(i=!0)}),e&&!i&&n.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:jr.NO_LINE_BREAKS_FLAGS}),n}function tot(t){var e={},r=As(t);return Je(r,function(n){var i=t[n];if(To(i))e[n]=[];else throw Error("non exhaustive match")}),e}function pJ(t){var e=t.PATTERN;if(Rs(e))return!1;if(Tl(e))return!0;if(Ze(e,"exec"))return!0;if(ca(e))return!1;throw Error("non exhaustive match")}function rot(t){return ca(t)&&t.length===1?t.charCodeAt(0):!1}var not={test:function(t){for(var e=t.length,r=this.lastIndex;r<e;r++){var n=t.charCodeAt(r);if(n===10)return this.lastIndex=r+1,!0;if(n===13)return t.charCodeAt(r+1)===10?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function mJ(t,e){if(Ze(t,"LINE_BREAKS"))return!1;if(Rs(t.PATTERN)){try{wx(e,t.PATTERN)}catch(r){return{issue:jr.IDENTIFY_TERMINATOR,errMsg:r.message}}return!1}else{if(ca(t.PATTERN))return!1;if(pJ(t))return{issue:jr.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function iot(t,e){if(e.issue===jr.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+t.name+`> Token Type
`)+("	 Root cause: "+e.errMsg+`.
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===jr.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+t.name+`> Token Type
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function gJ(t){var e=Fe(t,function(r){return ca(r)&&r.length>0?r.charCodeAt(0):r});return e}function HC(t,e,r){t[e]===void 0?t[e]=[r]:t[e].push(r)}var Vm=256;function vl(t){return t<Vm?t:S2[t]}var S2=[];function oot(){if(Zt(S2)){S2=new Array(65536);for(var t=0;t<65536;t++)S2[t]=t>255?255+~~(t/255):t}}function o5(t,e){var r=t.tokenTypeIdx;return r===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[r]===!0}function nS(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}var uV=1,yJ={};function z1(t){var e=aot(t);sot(e),uot(e),lot(e),Je(e,function(r){r.isParent=r.categoryMatches.length>0})}function aot(t){for(var e=gi(t),r=t,n=!0;n;){r=W1(mi(Fe(r,function(o){return o.CATEGORIES})));var i=r5(r,e);e=e.concat(i),Zt(i)?n=!1:r=i}return e}function sot(t){Je(t,function(e){bJ(e)||(yJ[uV]=e,e.tokenTypeIdx=uV++),cV(e)&&!To(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),cV(e)||(e.CATEGORIES=[]),cot(e)||(e.categoryMatches=[]),fot(e)||(e.categoryMatchesMap={})})}function lot(t){Je(t,function(e){e.categoryMatches=[],Je(e.categoryMatchesMap,function(r,n){e.categoryMatches.push(yJ[n].tokenTypeIdx)})})}function uot(t){Je(t,function(e){vJ([],e)})}function vJ(t,e){Je(t,function(r){e.categoryMatchesMap[r.tokenTypeIdx]=!0}),Je(e.CATEGORIES,function(r){var n=t.concat(e);sn(n,r)||vJ(n,r)})}function bJ(t){return Ze(t,"tokenTypeIdx")}function cV(t){return Ze(t,"CATEGORIES")}function cot(t){return Ze(t,"categoryMatches")}function fot(t){return Ze(t,"categoryMatchesMap")}function hot(t){return Ze(t,"tokenTypeIdx")}var dot={buildUnableToPopLexerModeMessage:function(t){return"Unable to pop Lexer Mode after encountering Token ->"+t.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(t,e,r,n,i){return"unexpected character: ->"+t.charAt(e)+"<- at offset: "+e+","+(" skipped "+r+" characters.")}},jr;(function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(jr||(jr={}));var jm={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:dot,traceInitPerf:!1,skipValidations:!1};Object.freeze(jm);var pi=function(){function t(e,r){var n=this;if(r===void 0&&(r=jm),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof r=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=nV(jm,r);var i=this.config.traceInitPerf;i===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof i=="number"&&(this.traceInitMaxIdent=i,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var o,a=!0;n.TRACE_INIT("Lexer Config handling",function(){if(n.config.lineTerminatorsPattern===jm.lineTerminatorsPattern)n.config.lineTerminatorsPattern=not;else if(n.config.lineTerminatorCharacters===jm.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(r.safeMode&&r.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');n.trackStartLines=/full|onlyStart/i.test(n.config.positionTracking),n.trackEndLines=/full/i.test(n.config.positionTracking),To(e)?(o={modes:{}},o.modes[Nu]=gi(e),o[Nu]=Nu):(a=!1,o=j1(e))}),n.config.skipValidations===!1&&(n.TRACE_INIT("performRuntimeChecks",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(Jit(o,n.trackStartLines,n.config.lineTerminatorCharacters))}),n.TRACE_INIT("performWarningRuntimeChecks",function(){n.lexerDefinitionWarning=n.lexerDefinitionWarning.concat(eot(o,n.trackStartLines,n.config.lineTerminatorCharacters))})),o.modes=o.modes?o.modes:{},Je(o.modes,function(c,f){o.modes[f]=oc(c,function(h){return ro(h)})});var s=As(o.modes);if(Je(o.modes,function(c,f){n.TRACE_INIT("Mode: <"+f+"> processing",function(){if(n.modes.push(f),n.config.skipValidations===!1&&n.TRACE_INIT("validatePatterns",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(Dit(c,s))}),Zt(n.lexerDefinitionErrors)){z1(c);var h;n.TRACE_INIT("analyzeTokenTypes",function(){h=Lit(c,{lineTerminatorCharacters:n.config.lineTerminatorCharacters,positionTracking:r.positionTracking,ensureOptimizations:r.ensureOptimizations,safeMode:r.safeMode,tracer:n.TRACE_INIT.bind(n)})}),n.patternIdxToConfig[f]=h.patternIdxToConfig,n.charCodeToPatternIdxToConfig[f]=h.charCodeToPatternIdxToConfig,n.emptyGroups=nV(n.emptyGroups,h.emptyGroups),n.hasCustom=h.hasCustom||n.hasCustom,n.canModeBeOptimized[f]=h.canBeOptimized}})}),n.defaultMode=o.defaultMode,!Zt(n.lexerDefinitionErrors)&&!n.config.deferDefinitionErrorsHandling){var l=Fe(n.lexerDefinitionErrors,function(c){return c.message}),u=l.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+u)}Je(n.lexerDefinitionWarning,function(c){bx(c.message)}),n.TRACE_INIT("Choosing sub-methods implementations",function(){if(dJ?(n.chopInput=iV,n.match=n.matchWithTest):(n.updateLastIndex=un,n.match=n.matchWithExec),a&&(n.handleModes=un),n.trackStartLines===!1&&(n.computeNewColumn=iV),n.trackEndLines===!1&&(n.updateTokenEndLineColumnLocation=un),/full/i.test(n.config.positionTracking))n.createTokenInstance=n.createFullToken;else if(/onlyStart/i.test(n.config.positionTracking))n.createTokenInstance=n.createStartOnlyToken;else if(/onlyOffset/i.test(n.config.positionTracking))n.createTokenInstance=n.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+n.config.positionTracking+'"');n.hasCustom?(n.addToken=n.addTokenUsingPush,n.handlePayload=n.handlePayloadWithCustom):(n.addToken=n.addTokenUsingMemberAccess,n.handlePayload=n.handlePayloadNoCustom)}),n.TRACE_INIT("Failed Optimization Warnings",function(){var c=Mn(n.canModeBeOptimized,function(f,h,d){return h===!1&&f.push(d),f},[]);if(r.ensureOptimizations&&!Zt(c))throw Error("Lexer Modes: < "+c.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),n.TRACE_INIT("clearRegExpParserCache",function(){Mit()}),n.TRACE_INIT("toFastProperties",function(){uJ(n)})})}return t.prototype.tokenize=function(e,r){if(r===void 0&&(r=this.defaultMode),!Zt(this.lexerDefinitionErrors)){var n=Fe(this.lexerDefinitionErrors,function(a){return a.message}),i=n.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}var o=this.tokenizeInternal(e,r);return o},t.prototype.tokenizeInternal=function(e,r){var n=this,i,o,a,s,l,u,c,f,h,d,p,m,g,v,w=e,b=w.length,E=0,A=0,M=this.hasCustom?0:Math.floor(e.length/10),k=new Array(M),O=[],x=this.trackStartLines?1:void 0,C=this.trackStartLines?1:void 0,I=tot(this.emptyGroups),H=this.trackStartLines,j=this.config.lineTerminatorsPattern,q=0,Z=[],ne=[],ie=[],P=[];Object.freeze(P);var y=void 0;function R(){return Z}function _(F){var U=vl(F),Y=ne[U];return Y===void 0?P:Y}var $=function(F){if(ie.length===1&&F.tokenType.PUSH_MODE===void 0){var U=n.config.errorMessageProvider.buildUnableToPopLexerModeMessage(F);O.push({offset:F.startOffset,line:F.startLine!==void 0?F.startLine:void 0,column:F.startColumn!==void 0?F.startColumn:void 0,length:F.image.length,message:U})}else{ie.pop();var Y=aJ(ie);Z=n.patternIdxToConfig[Y],ne=n.charCodeToPatternIdxToConfig[Y],q=Z.length;var fe=n.canModeBeOptimized[Y]&&n.config.safeMode===!1;ne&&fe?y=_:y=R}};function B(F){ie.push(F),ne=this.charCodeToPatternIdxToConfig[F],Z=this.patternIdxToConfig[F],q=Z.length,q=Z.length;var U=this.canModeBeOptimized[F]&&this.config.safeMode===!1;ne&&U?y=_:y=R}B.call(this,r);for(var W;E<b;){l=null;var ee=w.charCodeAt(E),J=y(ee),he=J.length;for(i=0;i<he;i++){W=J[i];var re=W.pattern;u=null;var T=W.short;if(T!==!1?ee===T&&(l=re):W.isCustom===!0?(v=re.exec(w,E,k,I),v!==null?(l=v[0],v.payload!==void 0&&(u=v.payload)):l=null):(this.updateLastIndex(re,E),l=this.match(re,e,E)),l!==null){if(s=W.longerAlt,s!==void 0){var D=Z[s],z=D.pattern;c=null,D.isCustom===!0?(v=z.exec(w,E,k,I),v!==null?(a=v[0],v.payload!==void 0&&(c=v.payload)):a=null):(this.updateLastIndex(z,E),a=this.match(z,e,E)),a&&a.length>l.length&&(l=a,u=c,W=D)}break}}if(l!==null){if(f=l.length,h=W.group,h!==void 0&&(d=W.tokenTypeIdx,p=this.createTokenInstance(l,E,d,W.tokenType,x,C,f),this.handlePayload(p,u),h===!1?A=this.addToken(k,A,p):I[h].push(p)),e=this.chopInput(e,f),E=E+f,C=this.computeNewColumn(C,f),H===!0&&W.canLineTerminator===!0){var K=0,le=void 0,X=void 0;j.lastIndex=0;do le=j.test(l),le===!0&&(X=j.lastIndex-1,K++);while(le===!0);K!==0&&(x=x+K,C=f-X,this.updateTokenEndLineColumnLocation(p,h,X,K,x,C,f))}this.handleModes(W,$,B,p)}else{for(var we=E,Ce=x,Ee=C,Te=!1;!Te&&E<b;)for(w.charCodeAt(E),e=this.chopInput(e,1),E++,o=0;o<q;o++){var Oe=Z[o],re=Oe.pattern,T=Oe.short;if(T!==!1?w.charCodeAt(E)===T&&(Te=!0):Oe.isCustom===!0?Te=re.exec(w,E,k,I)!==null:(this.updateLastIndex(re,E),Te=re.exec(e)!==null),Te===!0)break}m=E-we,g=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(w,we,m,Ce,Ee),O.push({offset:we,line:Ce,column:Ee,length:m,message:g})}}return this.hasCustom||(k.length=A),{tokens:k,groups:I,errors:O}},t.prototype.handleModes=function(e,r,n,i){if(e.pop===!0){var o=e.push;r(i),o!==void 0&&n.call(this,o)}else e.push!==void 0&&n.call(this,e.push)},t.prototype.chopInput=function(e,r){return e.substring(r)},t.prototype.updateLastIndex=function(e,r){e.lastIndex=r},t.prototype.updateTokenEndLineColumnLocation=function(e,r,n,i,o,a,s){var l,u;r!==void 0&&(l=n===s-1,u=l?-1:0,i===1&&l===!0||(e.endLine=o+u,e.endColumn=a-1+-u))},t.prototype.computeNewColumn=function(e,r){return e+r},t.prototype.createTokenInstance=function(){return null},t.prototype.createOffsetOnlyToken=function(e,r,n,i){return{image:e,startOffset:r,tokenTypeIdx:n,tokenType:i}},t.prototype.createStartOnlyToken=function(e,r,n,i,o,a){return{image:e,startOffset:r,startLine:o,startColumn:a,tokenTypeIdx:n,tokenType:i}},t.prototype.createFullToken=function(e,r,n,i,o,a,s){return{image:e,startOffset:r,endOffset:r+s-1,startLine:o,endLine:o,startColumn:a,endColumn:a+s-1,tokenTypeIdx:n,tokenType:i}},t.prototype.addToken=function(e,r,n){return 666},t.prototype.addTokenUsingPush=function(e,r,n){return e.push(n),r},t.prototype.addTokenUsingMemberAccess=function(e,r,n){return e[r]=n,r++,r},t.prototype.handlePayload=function(e,r){},t.prototype.handlePayloadNoCustom=function(e,r){},t.prototype.handlePayloadWithCustom=function(e,r){r!==null&&(e.payload=r)},t.prototype.match=function(e,r,n){return null},t.prototype.matchWithTest=function(e,r,n){var i=e.test(r);return i===!0?r.substring(n,e.lastIndex):null},t.prototype.matchWithExec=function(e,r){var n=e.exec(r);return n!==null?n[0]:n},t.prototype.TRACE_INIT=function(e,r){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+e+">");var i=cJ(r),o=i.time,a=i.value,s=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(n+"<-- <"+e+"> time: "+o+"ms"),this.traceInitIndent--,a}else return r()},t.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",t.NA=/NOT_APPLICABLE/,t}();function Jf(t){return wJ(t)?t.LABEL:t.name}function wJ(t){return ca(t.LABEL)&&t.LABEL!==""}var pot="parent",fV="categories",hV="label",dV="group",pV="push_mode",mV="pop_mode",gV="longer_alt",yV="line_breaks",vV="start_chars_hint";function Pt(t){return mot(t)}function mot(t){var e=t.pattern,r={};if(r.name=t.name,ro(e)||(r.PATTERN=e),Ze(t,pot))throw`The parent property is no longer supported.
See: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.`;return Ze(t,fV)&&(r.CATEGORIES=t[fV]),z1([r]),Ze(t,hV)&&(r.LABEL=t[hV]),Ze(t,dV)&&(r.GROUP=t[dV]),Ze(t,mV)&&(r.POP_MODE=t[mV]),Ze(t,pV)&&(r.PUSH_MODE=t[pV]),Ze(t,gV)&&(r.LONGER_ALT=t[gV]),Ze(t,yV)&&(r.LINE_BREAKS=t[yV]),Ze(t,vV)&&(r.START_CHARS_HINT=t[vV]),r}var ac=Pt({name:"EOF",pattern:pi.NA});z1([ac]);function Sx(t,e,r,n,i,o,a,s){return{image:e,startOffset:r,endOffset:n,startLine:i,endLine:o,startColumn:a,endColumn:s,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function Yt(t,e){return o5(t,e)}var Is=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ba=function(){function t(e){this.definition=e}return t.prototype.accept=function(e){e.visit(this),Je(this.definition,function(r){r.accept(e)})},t}(),Ni=function(t){Is(e,t);function e(r){var n=t.call(this,[])||this;return n.idx=1,ko(n,lo(r,function(i){return i!==void 0})),n}return Object.defineProperty(e.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(r){},enumerable:!0,configurable:!0}),e.prototype.accept=function(r){r.visit(this)},e}(ba),Gp=function(t){Is(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.orgText="",ko(n,lo(r,function(i){return i!==void 0})),n}return e}(ba),yi=function(t){Is(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.ignoreAmbiguities=!1,ko(n,lo(r,function(i){return i!==void 0})),n}return e}(ba),In=function(t){Is(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,ko(n,lo(r,function(i){return i!==void 0})),n}return e}(ba),no=function(t){Is(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,ko(n,lo(r,function(i){return i!==void 0})),n}return e}(ba),io=function(t){Is(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,ko(n,lo(r,function(i){return i!==void 0})),n}return e}(ba),Ur=function(t){Is(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,ko(n,lo(r,function(i){return i!==void 0})),n}return e}(ba),Pi=function(t){Is(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,ko(n,lo(r,function(i){return i!==void 0})),n}return e}(ba),ki=function(t){Is(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,ko(n,lo(r,function(i){return i!==void 0})),n}return e}(ba),Sr=function(){function t(e){this.idx=1,ko(this,lo(e,function(r){return r!==void 0}))}return t.prototype.accept=function(e){e.visit(this)},t}();function got(t){return Fe(t,R2)}function R2(t){function e(i){return Fe(i,R2)}if(t instanceof Ni)return{type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};if(t instanceof yi)return{type:"Flat",definition:e(t.definition)};if(t instanceof In)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof no)return{type:"RepetitionMandatory",name:t.name,idx:t.idx,definition:e(t.definition)};if(t instanceof io)return{type:"RepetitionMandatoryWithSeparator",name:t.name,idx:t.idx,separator:R2(new Sr({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof Pi)return{type:"RepetitionWithSeparator",name:t.name,idx:t.idx,separator:R2(new Sr({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof Ur)return{type:"Repetition",name:t.name,idx:t.idx,definition:e(t.definition)};if(t instanceof ki)return{type:"Alternation",name:t.name,idx:t.idx,definition:e(t.definition)};if(t instanceof Sr){var r={type:"Terminal",name:t.terminalType.name,label:Jf(t.terminalType),idx:t.idx},n=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(r.pattern=Rs(n)?n.source:n),r}else{if(t instanceof Gp)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}}var a5=function(){function t(){}return t.prototype.walk=function(e,r){var n=this;r===void 0&&(r=[]),Je(e.definition,function(i,o){var a=Tn(e.definition,o+1);if(i instanceof Ni)n.walkProdRef(i,a,r);else if(i instanceof Sr)n.walkTerminal(i,a,r);else if(i instanceof yi)n.walkFlat(i,a,r);else if(i instanceof In)n.walkOption(i,a,r);else if(i instanceof no)n.walkAtLeastOne(i,a,r);else if(i instanceof io)n.walkAtLeastOneSep(i,a,r);else if(i instanceof Pi)n.walkManySep(i,a,r);else if(i instanceof Ur)n.walkMany(i,a,r);else if(i instanceof ki)n.walkOr(i,a,r);else throw Error("non exhaustive match")})},t.prototype.walkTerminal=function(e,r,n){},t.prototype.walkProdRef=function(e,r,n){},t.prototype.walkFlat=function(e,r,n){var i=r.concat(n);this.walk(e,i)},t.prototype.walkOption=function(e,r,n){var i=r.concat(n);this.walk(e,i)},t.prototype.walkAtLeastOne=function(e,r,n){var i=[new In({definition:e.definition})].concat(r,n);this.walk(e,i)},t.prototype.walkAtLeastOneSep=function(e,r,n){var i=bV(e,r,n);this.walk(e,i)},t.prototype.walkMany=function(e,r,n){var i=[new In({definition:e.definition})].concat(r,n);this.walk(e,i)},t.prototype.walkManySep=function(e,r,n){var i=bV(e,r,n);this.walk(e,i)},t.prototype.walkOr=function(e,r,n){var i=this,o=r.concat(n);Je(e.definition,function(a){var s=new yi({definition:[a]});i.walk(s,o)})},t}();function bV(t,e,r){var n=[new In({definition:[new Sr({terminalType:t.separator})].concat(t.definition)})],i=n.concat(e,r);return i}var Ac=function(){function t(){}return t.prototype.visit=function(e){var r=e;switch(r.constructor){case Ni:return this.visitNonTerminal(r);case yi:return this.visitFlat(r);case In:return this.visitOption(r);case no:return this.visitRepetitionMandatory(r);case io:return this.visitRepetitionMandatoryWithSeparator(r);case Pi:return this.visitRepetitionWithSeparator(r);case Ur:return this.visitRepetition(r);case ki:return this.visitAlternation(r);case Sr:return this.visitTerminal(r);case Gp:return this.visitRule(r);default:throw Error("non exhaustive match")}},t.prototype.visitNonTerminal=function(e){},t.prototype.visitFlat=function(e){},t.prototype.visitOption=function(e){},t.prototype.visitRepetition=function(e){},t.prototype.visitRepetitionMandatory=function(e){},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){},t.prototype.visitRepetitionWithSeparator=function(e){},t.prototype.visitAlternation=function(e){},t.prototype.visitTerminal=function(e){},t.prototype.visitRule=function(e){},t}(),yot=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();function vot(t){return t instanceof yi||t instanceof In||t instanceof Ur||t instanceof no||t instanceof io||t instanceof Pi||t instanceof Sr||t instanceof Gp}function iS(t,e){e===void 0&&(e=[]);var r=t instanceof In||t instanceof Ur||t instanceof Pi;return r?!0:t instanceof ki?sJ(t.definition,function(n){return iS(n,e)}):t instanceof Ni&&sn(e,t)?!1:t instanceof ba?(t instanceof Ni&&e.push(t),Qi(t.definition,function(n){return iS(n,e)})):!1}function bot(t){return t instanceof ki}function Ro(t){if(t instanceof Ni)return"SUBRULE";if(t instanceof In)return"OPTION";if(t instanceof ki)return"OR";if(t instanceof no)return"AT_LEAST_ONE";if(t instanceof io)return"AT_LEAST_ONE_SEP";if(t instanceof Pi)return"MANY_SEP";if(t instanceof Ur)return"MANY";if(t instanceof Sr)return"CONSUME";throw Error("non exhaustive match")}var wot=function(t){yot(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.separator="-",r.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},r}return e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(r){var n=r.terminalType.name+this.separator+"Terminal";Ze(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(r)},e.prototype.visitNonTerminal=function(r){var n=r.nonTerminalName+this.separator+"Terminal";Ze(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(r)},e.prototype.visitOption=function(r){this.dslMethods.option.push(r)},e.prototype.visitRepetitionWithSeparator=function(r){this.dslMethods.repetitionWithSeparator.push(r)},e.prototype.visitRepetitionMandatory=function(r){this.dslMethods.repetitionMandatory.push(r)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.dslMethods.repetitionMandatoryWithSeparator.push(r)},e.prototype.visitRepetition=function(r){this.dslMethods.repetition.push(r)},e.prototype.visitAlternation=function(r){this.dslMethods.alternation.push(r)},e}(Ac),ab=new wot;function Sot(t){ab.reset(),t.accept(ab);var e=ab.dslMethods;return ab.reset(),e}function G1(t){if(t instanceof Ni)return G1(t.referencedRule);if(t instanceof Sr)return Cot(t);if(vot(t))return Rot(t);if(bot(t))return Eot(t);throw Error("non exhaustive match")}function Rot(t){for(var e=[],r=t.definition,n=0,i=r.length>n,o,a=!0;i&&a;)o=r[n],a=iS(o),e=e.concat(G1(o)),n=n+1,i=r.length>n;return yx(e)}function Eot(t){var e=Fe(t.definition,function(r){return G1(r)});return yx(mi(e))}function Cot(t){return[t.terminalType]}var SJ="_~IN~_",_ot=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Tot=function(t){_ot(e,t);function e(r){var n=t.call(this)||this;return n.topProd=r,n.follows={},n}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(r,n,i){},e.prototype.walkProdRef=function(r,n,i){var o=Aot(r.referencedRule,r.idx)+this.topProd.name,a=n.concat(i),s=new yi({definition:a}),l=G1(s);this.follows[o]=l},e}(a5);function Oot(t){var e={};return Je(t,function(r){var n=new Tot(r).startWalking();ko(e,n)}),e}function Aot(t,e){return t.name+e+SJ}var Iot=4,Ol=8,xot=8,eh=1<<Ol,oS=2<<Ol,lg=3<<Ol,ug=4<<Ol,cg=5<<Ol,$f=6<<Ol;function fg(t,e,r){return r|e|t}var Mot=32-xot;function RJ(t,e,r,n){var i=n+1<<Mot;return fg(t,e,r)|i}var Not=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();function wV(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset)}function SV(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}function Pot(t,e,r){t.children[r]===void 0?t.children[r]=[e]:t.children[r].push(e)}function RV(t,e,r){t.children[e]===void 0?t.children[e]=[r]:t.children[e].push(r)}var Rx=function(t){Not(e,t);function e(r){var n=t.call(this)||this;return n.result=[],n.ruleIdx=r,n}return e.prototype.collectNamedDSLMethod=function(r,n,i){if(!ro(r.name)){var o=void 0;if(r instanceof In||r instanceof Ur||r instanceof no||r instanceof ki)o=new n({definition:r.definition,idx:r.idx});else if(r instanceof io||r instanceof Pi)o=new n({definition:r.definition,idx:r.idx,separator:r.separator});else throw Error("non exhaustive match");var a=[o],s=fg(this.ruleIdx,i,r.idx);this.result.push({def:a,key:s,name:r.name,orgProd:r})}},e.prototype.visitOption=function(r){this.collectNamedDSLMethod(r,In,oS)},e.prototype.visitRepetition=function(r){this.collectNamedDSLMethod(r,Ur,lg)},e.prototype.visitRepetitionMandatory=function(r){this.collectNamedDSLMethod(r,no,ug)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.collectNamedDSLMethod(r,io,$f)},e.prototype.visitRepetitionWithSeparator=function(r){this.collectNamedDSLMethod(r,Pi,cg)},e.prototype.visitAlternation=function(r){var n=this;this.collectNamedDSLMethod(r,ki,eh);var i=r.definition.length>1;Je(r.definition,function(o,a){if(!ro(o.name)){var s=o.definition;i?s=[new In({definition:o.definition})]:s=o.definition;var l=RJ(n.ruleIdx,eh,r.idx,a);n.result.push({def:s,key:l,name:o.name,orgProd:o})}})},e}(Ac);function kot(t,e){var r={allRuleNames:[]};return Je(t,function(n){var i=e[n.name];r.allRuleNames.push(n.name);var o=new Rx(i);n.accept(o),Je(o.result,function(a){a.def,a.key;var s=a.name;r.allRuleNames.push(n.name+s)})}),r}var Ic=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$ot=function(t){Ic(e,t);function e(r,n){var i=t.call(this)||this;return i.topProd=r,i.path=n,i.possibleTokTypes=[],i.nextProductionName="",i.nextProductionOccurrence=0,i.found=!1,i.isAtEndOfPath=!1,i}return e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=gi(this.path.ruleStack).reverse(),this.occurrenceStack=gi(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(r,n){n===void 0&&(n=[]),this.found||t.prototype.walk.call(this,r,n)},e.prototype.walkProdRef=function(r,n,i){if(r.referencedRule.name===this.nextProductionName&&r.idx===this.nextProductionOccurrence){var o=n.concat(i);this.updateExpectedNext(),this.walk(r.referencedRule,o)}},e.prototype.updateExpectedNext=function(){Zt(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(a5),Lot=function(t){Ic(e,t);function e(r,n){var i=t.call(this,r,n)||this;return i.path=n,i.nextTerminalName="",i.nextTerminalOccurrence=0,i.nextTerminalName=i.path.lastTok.name,i.nextTerminalOccurrence=i.path.lastTokOccurrence,i}return e.prototype.walkTerminal=function(r,n,i){if(this.isAtEndOfPath&&r.terminalType.name===this.nextTerminalName&&r.idx===this.nextTerminalOccurrence&&!this.found){var o=n.concat(i),a=new yi({definition:o});this.possibleTokTypes=G1(a),this.found=!0}},e}($ot),s5=function(t){Ic(e,t);function e(r,n){var i=t.call(this)||this;return i.topRule=r,i.occurrence=n,i.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},i}return e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(a5),Dot=function(t){Ic(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.walkMany=function(r,n,i){if(r.idx===this.occurrence){var o=to(n.concat(i));this.result.isEndOfRule=o===void 0,o instanceof Sr&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkMany.call(this,r,n,i)},e}(s5),EV=function(t){Ic(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.walkManySep=function(r,n,i){if(r.idx===this.occurrence){var o=to(n.concat(i));this.result.isEndOfRule=o===void 0,o instanceof Sr&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkManySep.call(this,r,n,i)},e}(s5),Fot=function(t){Ic(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.walkAtLeastOne=function(r,n,i){if(r.idx===this.occurrence){var o=to(n.concat(i));this.result.isEndOfRule=o===void 0,o instanceof Sr&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkAtLeastOne.call(this,r,n,i)},e}(s5),CV=function(t){Ic(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.walkAtLeastOneSep=function(r,n,i){if(r.idx===this.occurrence){var o=to(n.concat(i));this.result.isEndOfRule=o===void 0,o instanceof Sr&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkAtLeastOneSep.call(this,r,n,i)},e}(s5);function RA(t,e,r){r===void 0&&(r=[]),r=gi(r);var n=[],i=0;function o(u){return u.concat(Tn(t,i+1))}function a(u){var c=RA(o(u),e,r);return n.concat(c)}for(;r.length<e&&i<t.length;){var s=t[i];if(s instanceof yi)return a(s.definition);if(s instanceof Ni)return a(s.definition);if(s instanceof In)n=a(s.definition);else if(s instanceof no){var l=s.definition.concat([new Ur({definition:s.definition})]);return a(l)}else if(s instanceof io){var l=[new yi({definition:s.definition}),new Ur({definition:[new Sr({terminalType:s.separator})].concat(s.definition)})];return a(l)}else if(s instanceof Pi){var l=s.definition.concat([new Ur({definition:[new Sr({terminalType:s.separator})].concat(s.definition)})]);n=a(l)}else if(s instanceof Ur){var l=s.definition.concat([new Ur({definition:s.definition})]);n=a(l)}else{if(s instanceof ki)return Je(s.definition,function(u){n=a(u.definition)}),n;if(s instanceof Sr)r.push(s.terminalType);else throw Error("non exhaustive match")}i++}return n.push({partialPath:r,suffixDef:Tn(t,i)}),n}function EJ(t,e,r,n){var i="EXIT_NONE_TERMINAL",o=[i],a="EXIT_ALTERNATIVE",s=!1,l=e.length,u=l-n-1,c=[],f=[];for(f.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!Zt(f);){var h=f.pop();if(h===a){s&&aJ(f).idx<=u&&f.pop();continue}var d=h.def,p=h.idx,m=h.ruleStack,g=h.occurrenceStack;if(!Zt(d)){var v=d[0];if(v===i){var w={idx:p,def:Tn(d),ruleStack:Mv(m),occurrenceStack:Mv(g)};f.push(w)}else if(v instanceof Sr)if(p<l-1){var b=p+1,E=e[b];if(r(E,v.terminalType)){var w={idx:b,def:Tn(d),ruleStack:m,occurrenceStack:g};f.push(w)}}else if(p===l-1)c.push({nextTokenType:v.terminalType,nextTokenOccurrence:v.idx,ruleStack:m,occurrenceStack:g}),s=!0;else throw Error("non exhaustive match");else if(v instanceof Ni){var A=gi(m);A.push(v.nonTerminalName);var M=gi(g);M.push(v.idx);var w={idx:p,def:v.definition.concat(o,Tn(d)),ruleStack:A,occurrenceStack:M};f.push(w)}else if(v instanceof In){var k={idx:p,def:Tn(d),ruleStack:m,occurrenceStack:g};f.push(k),f.push(a);var O={idx:p,def:v.definition.concat(Tn(d)),ruleStack:m,occurrenceStack:g};f.push(O)}else if(v instanceof no){var x=new Ur({definition:v.definition,idx:v.idx}),C=v.definition.concat([x],Tn(d)),w={idx:p,def:C,ruleStack:m,occurrenceStack:g};f.push(w)}else if(v instanceof io){var I=new Sr({terminalType:v.separator}),x=new Ur({definition:[I].concat(v.definition),idx:v.idx}),C=v.definition.concat([x],Tn(d)),w={idx:p,def:C,ruleStack:m,occurrenceStack:g};f.push(w)}else if(v instanceof Pi){var k={idx:p,def:Tn(d),ruleStack:m,occurrenceStack:g};f.push(k),f.push(a);var I=new Sr({terminalType:v.separator}),H=new Ur({definition:[I].concat(v.definition),idx:v.idx}),C=v.definition.concat([H],Tn(d)),O={idx:p,def:C,ruleStack:m,occurrenceStack:g};f.push(O)}else if(v instanceof Ur){var k={idx:p,def:Tn(d),ruleStack:m,occurrenceStack:g};f.push(k),f.push(a);var H=new Ur({definition:v.definition,idx:v.idx}),C=v.definition.concat([H],Tn(d)),O={idx:p,def:C,ruleStack:m,occurrenceStack:g};f.push(O)}else if(v instanceof ki)for(var j=v.definition.length-1;j>=0;j--){var q=v.definition[j],Z={idx:p,def:q.definition.concat(Tn(d)),ruleStack:m,occurrenceStack:g};f.push(Z),f.push(a)}else if(v instanceof yi)f.push({idx:p,def:v.definition.concat(Tn(d)),ruleStack:m,occurrenceStack:g});else if(v instanceof Gp)f.push(Hot(v,p,m,g));else throw Error("non exhaustive match")}}return c}function Hot(t,e,r,n){var i=gi(r);i.push(t.name);var o=gi(n);return o.push(1),{idx:e,def:t.definition,ruleStack:i,occurrenceStack:o}}var CJ=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),rr;(function(t){t[t.OPTION=0]="OPTION",t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"})(rr||(rr={}));function Bot(t){if(t instanceof In)return rr.OPTION;if(t instanceof Ur)return rr.REPETITION;if(t instanceof no)return rr.REPETITION_MANDATORY;if(t instanceof io)return rr.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof Pi)return rr.REPETITION_WITH_SEPARATOR;if(t instanceof ki)return rr.ALTERNATION;throw Error("non exhaustive match")}function Uot(t,e,r,n,i,o){var a=Ex(t,e,r),s=OJ(a)?nS:o5;return o(a,n,s,i)}function Vot(t,e,r,n,i,o){var a=Cx(t,e,i,r),s=OJ(a)?nS:o5;return o(a[0],s,n)}function jot(t,e,r,n){var i=t.length,o=Qi(t,function(l){return Qi(l,function(u){return u.length===1})});if(e)return function(l){for(var u=Fe(l,function(b){return b.GATE}),c=0;c<i;c++){var f=t[c],h=f.length,d=u[c];if(d!==void 0&&d.call(this)===!1)continue;e:for(var p=0;p<h;p++){for(var m=f[p],g=m.length,v=0;v<g;v++){var w=this.LA(v+1);if(r(w,m[v])===!1)continue e}return c}}};if(o&&!n){var a=Fe(t,function(l){return mi(l)}),s=Mn(a,function(l,u,c){return Je(u,function(f){Ze(l,f.tokenTypeIdx)||(l[f.tokenTypeIdx]=c),Je(f.categoryMatches,function(h){Ze(l,h)||(l[h]=c)})}),l},[]);return function(){var l=this.LA(1);return s[l.tokenTypeIdx]}}else return function(){for(var l=0;l<i;l++){var u=t[l],c=u.length;e:for(var f=0;f<c;f++){for(var h=u[f],d=h.length,p=0;p<d;p++){var m=this.LA(p+1);if(r(m,h[p])===!1)continue e}return l}}}}function Wot(t,e,r){var n=Qi(t,function(u){return u.length===1}),i=t.length;if(n&&!r){var o=mi(t);if(o.length===1&&Zt(o[0].categoryMatches)){var a=o[0],s=a.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===s}}else{var l=Mn(o,function(u,c,f){return u[c.tokenTypeIdx]=!0,Je(c.categoryMatches,function(h){u[h]=!0}),u},[]);return function(){var u=this.LA(1);return l[u.tokenTypeIdx]===!0}}}else return function(){e:for(var u=0;u<i;u++){for(var c=t[u],f=c.length,h=0;h<f;h++){var d=this.LA(h+1);if(e(d,c[h])===!1)continue e}return!0}return!1}}var zot=function(t){CJ(e,t);function e(r,n,i){var o=t.call(this)||this;return o.topProd=r,o.targetOccurrence=n,o.targetProdType=i,o}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(r,n,i,o){return r.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=i.concat(o),!0):!1},e.prototype.walkOption=function(r,n,i){this.checkIsTarget(r,rr.OPTION,n,i)||t.prototype.walkOption.call(this,r,n,i)},e.prototype.walkAtLeastOne=function(r,n,i){this.checkIsTarget(r,rr.REPETITION_MANDATORY,n,i)||t.prototype.walkOption.call(this,r,n,i)},e.prototype.walkAtLeastOneSep=function(r,n,i){this.checkIsTarget(r,rr.REPETITION_MANDATORY_WITH_SEPARATOR,n,i)||t.prototype.walkOption.call(this,r,n,i)},e.prototype.walkMany=function(r,n,i){this.checkIsTarget(r,rr.REPETITION,n,i)||t.prototype.walkOption.call(this,r,n,i)},e.prototype.walkManySep=function(r,n,i){this.checkIsTarget(r,rr.REPETITION_WITH_SEPARATOR,n,i)||t.prototype.walkOption.call(this,r,n,i)},e}(a5),_J=function(t){CJ(e,t);function e(r,n,i){var o=t.call(this)||this;return o.targetOccurrence=r,o.targetProdType=n,o.targetRef=i,o.result=[],o}return e.prototype.checkIsTarget=function(r,n){r.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||r===this.targetRef)&&(this.result=r.definition)},e.prototype.visitOption=function(r){this.checkIsTarget(r,rr.OPTION)},e.prototype.visitRepetition=function(r){this.checkIsTarget(r,rr.REPETITION)},e.prototype.visitRepetitionMandatory=function(r){this.checkIsTarget(r,rr.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.checkIsTarget(r,rr.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(r){this.checkIsTarget(r,rr.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(r){this.checkIsTarget(r,rr.ALTERNATION)},e}(Ac);function _V(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=[];return e}function BC(t){for(var e=[""],r=0;r<t.length;r++){for(var n=t[r],i=[],o=0;o<e.length;o++){var a=e[o];i.push(a+"_"+n.tokenTypeIdx);for(var s=0;s<n.categoryMatches.length;s++){var l="_"+n.categoryMatches[s];i.push(a+l)}}e=i}return e}function Got(t,e,r){for(var n=0;n<t.length;n++)if(n!==r)for(var i=t[n],o=0;o<e.length;o++){var a=e[o];if(i[a]===!0)return!1}return!0}function TJ(t,e){for(var r=Fe(t,function(c){return RA([c],1)}),n=_V(r.length),i=Fe(r,function(c){var f={};return Je(c,function(h){var d=BC(h.partialPath);Je(d,function(p){f[p]=!0})}),f}),o=r,a=1;a<=e;a++){var s=o;o=_V(s.length);for(var l=function(c){for(var f=s[c],h=0;h<f.length;h++){var d=f[h].partialPath,p=f[h].suffixDef,m=BC(d),g=Got(i,m,c);if(g||Zt(p)||d.length===e){var v=n[c];if(EA(v,d)===!1){v.push(d);for(var w=0;w<m.length;w++){var b=m[w];i[c][b]=!0}}}else{var E=RA(p,a+1,d);o[c]=o[c].concat(E),Je(E,function(A){var M=BC(A.partialPath);Je(M,function(k){i[c][k]=!0})})}}},u=0;u<s.length;u++)l(u)}return n}function Ex(t,e,r,n){var i=new _J(t,rr.ALTERNATION,n);return e.accept(i),TJ(i.result,r)}function Cx(t,e,r,n){var i=new _J(t,r);e.accept(i);var o=i.result,a=new zot(e,t,r),s=a.startWalking(),l=new yi({definition:o}),u=new yi({definition:s});return TJ([l,u],n)}function EA(t,e){e:for(var r=0;r<t.length;r++){var n=t[r];if(n.length===e.length){for(var i=0;i<n.length;i++){var o=e[i],a=n[i],s=o===a||a.categoryMatchesMap[o.tokenTypeIdx]!==void 0;if(s===!1)continue e}return!0}}return!1}function Yot(t,e){return t.length<e.length&&Qi(t,function(r,n){var i=e[n];return r===i||i.categoryMatchesMap[r.tokenTypeIdx]})}function OJ(t){return Qi(t,function(e){return Qi(e,function(r){return Qi(r,function(n){return Zt(n.categoryMatches)})})})}var _x=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();function Kot(t,e,r,n,i,o){var a=Fe(t,function(w){return Xot(w,i)}),s=Fe(t,function(w){return xJ(w,w,i)}),l=[],u=[],c=[];Qi(s,Zt)&&(l=Fe(t,function(w){return iat(w,i)}),u=Fe(t,function(w){return oat(w,e,n,i)}),c=lat(t,e,i));var f=fat(t,r,i),h=Fe(r,function(w){return tat(w,i)}),d=qot(t,i),p=hat(t,i),m=Fe(t,function(w){return sat(w,i)}),g=Fe(t,function(w){return Jot(w,i)}),v=Fe(t,function(w){return rat(w,t,o,i)});return mi(a.concat(h,d,p,c,s,l,u,f,m,g,v))}function qot(t,e){var r=[];return Je(t,function(n){var i=new Rx("");n.accept(i);var o=Fe(i.result,function(a){return a.orgProd});r.push(Fe(o,function(a){return eat(n,a,e)}))}),mi(r)}function Xot(t,e){var r=new Zot;t.accept(r);var n=r.allProductions,i=lJ(n,Qot),o=lo(i,function(s){return s.length>1}),a=Fe(Dn(o),function(s){var l=to(s),u=e.buildDuplicateFoundError(t,s),c=Ro(l),f={message:u,type:vn.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:c,occurrence:l.idx},h=AJ(l);return h&&(f.parameter=h),f});return a}function Qot(t){return Ro(t)+"_#_"+t.idx+"_#_"+AJ(t)}function AJ(t){return t instanceof Sr?t.terminalType.name:t instanceof Ni?t.nonTerminalName:""}var Zot=function(t){_x(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.allProductions=[],r}return e.prototype.visitNonTerminal=function(r){this.allProductions.push(r)},e.prototype.visitOption=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionWithSeparator=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionMandatory=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.allProductions.push(r)},e.prototype.visitRepetition=function(r){this.allProductions.push(r)},e.prototype.visitAlternation=function(r){this.allProductions.push(r)},e.prototype.visitTerminal=function(r){this.allProductions.push(r)},e}(Ac),sc=/^[a-zA-Z_]\w*$/,IJ=new RegExp(sc.source.replace("^","^\\$"));function Jot(t,e){var r=[],n=t.name;return n.match(sc)||r.push({message:e.buildInvalidRuleNameError({topLevelRule:t,expectedPattern:sc}),type:vn.INVALID_RULE_NAME,ruleName:n}),r}function eat(t,e,r){var n=[],i;return e.name.match(IJ)||(i=r.buildInvalidNestedRuleNameError(t,e),n.push({message:i,type:vn.INVALID_NESTED_RULE_NAME,ruleName:t.name})),n}function tat(t,e){var r=[],n=t.name;return n.match(sc)||r.push({message:e.buildTokenNameError({tokenType:t,expectedPattern:sc}),type:vn.INVALID_TOKEN_NAME}),r}function rat(t,e,r,n){var i=[],o=Mn(e,function(s,l){return l.name===t.name?s+1:s},0);if(o>1){var a=n.buildDuplicateRuleNameError({topLevelRule:t,grammarName:r});i.push({message:a,type:vn.DUPLICATE_RULE_NAME,ruleName:t.name})}return i}function nat(t,e,r){var n=[],i;return sn(e,t)||(i="Invalid rule override, rule: ->"+t+"<- cannot be overridden in the grammar: ->"+r+"<-as it is not defined in any of the super grammars ",n.push({message:i,type:vn.INVALID_RULE_OVERRIDE,ruleName:t})),n}function xJ(t,e,r,n){n===void 0&&(n=[]);var i=[],o=E2(e.definition);if(Zt(o))return[];var a=t.name,s=sn(o,t);s&&i.push({message:r.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:n}),type:vn.LEFT_RECURSION,ruleName:a});var l=r5(o,n.concat([t])),u=Fe(l,function(c){var f=gi(n);return f.push(c),xJ(t,c,r,f)});return i.concat(mi(u))}function E2(t){var e=[];if(Zt(t))return e;var r=to(t);if(r instanceof Ni)e.push(r.referencedRule);else if(r instanceof yi||r instanceof In||r instanceof no||r instanceof io||r instanceof Pi||r instanceof Ur)e=e.concat(E2(r.definition));else if(r instanceof ki)e=mi(Fe(r.definition,function(a){return E2(a.definition)}));else if(!(r instanceof Sr))throw Error("non exhaustive match");var n=iS(r),i=t.length>1;if(n&&i){var o=Tn(t);return e.concat(E2(o))}else return e}var Tx=function(t){_x(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.alternations=[],r}return e.prototype.visitAlternation=function(r){this.alternations.push(r)},e}(Ac);function iat(t,e){var r=new Tx;t.accept(r);var n=r.alternations,i=Mn(n,function(o,a){var s=Mv(a.definition),l=Fe(s,function(u,c){var f=EJ([u],[],null,1);return Zt(f)?{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:a,emptyChoiceIdx:c}),type:vn.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:a.idx,alternative:c+1}:null});return o.concat(W1(l))},[]);return i}function oat(t,e,r,n){var i=new Tx;t.accept(i);var o=i.alternations,a=r[t.name];a&&(o=oc(o,function(l){return a[Ro(l)+(l.idx===0?"":l.idx)]})),o=oc(o,function(l){return l.ignoreAmbiguities===!0});var s=Mn(o,function(l,u){var c=u.idx,f=u.maxLookahead||e,h=Ex(c,t,f,u),d=uat(h,u,t,n),p=cat(h,u,t,n);return l.concat(d,p)},[]);return s}var aat=function(t){_x(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.allProductions=[],r}return e.prototype.visitRepetitionWithSeparator=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionMandatory=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.allProductions.push(r)},e.prototype.visitRepetition=function(r){this.allProductions.push(r)},e}(Ac);function sat(t,e){var r=new Tx;t.accept(r);var n=r.alternations,i=Mn(n,function(o,a){return a.definition.length>255&&o.push({message:e.buildTooManyAlternativesError({topLevelRule:t,alternation:a}),type:vn.TOO_MANY_ALTS,ruleName:t.name,occurrence:a.idx}),o},[]);return i}function lat(t,e,r){var n=[];return Je(t,function(i){var o=new aat;i.accept(o);var a=o.allProductions;Je(a,function(s){var l=Bot(s),u=s.maxLookahead||e,c=s.idx,f=Cx(c,i,l,u),h=f[0];if(Zt(mi(h))){var d=r.buildEmptyRepetitionError({topLevelRule:i,repetition:s});n.push({message:d,type:vn.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),n}function uat(t,e,r,n){var i=[],o=Mn(t,function(s,l,u){return e.definition[u].ignoreAmbiguities===!0||Je(l,function(c){var f=[u];Je(t,function(h,d){u!==d&&EA(h,c)&&e.definition[d].ignoreAmbiguities!==!0&&f.push(d)}),f.length>1&&!EA(i,c)&&(i.push(c),s.push({alts:f,path:c}))}),s},[]),a=Fe(o,function(s){var l=Fe(s.alts,function(c){return c+1}),u=n.buildAlternationAmbiguityError({topLevelRule:r,alternation:e,ambiguityIndices:l,prefixPath:s.path});return{message:u,type:vn.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:e.idx,alternatives:[s.alts]}});return a}function cat(t,e,r,n){var i=[],o=Mn(t,function(a,s,l){var u=Fe(s,function(c){return{idx:l,path:c}});return a.concat(u)},[]);return Je(o,function(a){var s=e.definition[a.idx];if(s.ignoreAmbiguities!==!0){var l=a.idx,u=a.path,c=_it(o,function(h){return e.definition[h.idx].ignoreAmbiguities!==!0&&h.idx<l&&Yot(h.path,u)}),f=Fe(c,function(h){var d=[h.idx+1,l+1],p=e.idx===0?"":e.idx,m=n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:e,ambiguityIndices:d,prefixPath:h.path});return{message:m,type:vn.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:p,alternatives:d}});i=i.concat(f)}}),i}function fat(t,e,r){var n=[],i=Fe(e,function(o){return o.name});return Je(t,function(o){var a=o.name;if(sn(i,a)){var s=r.buildNamespaceConflictError(o);n.push({message:s,type:vn.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:a})}}),n}function hat(t,e){var r=[];return Je(t,function(n){var i=new Rx("");n.accept(i);var o=lJ(i.result,function(s){return s.name}),a=lo(o,function(s){return s.length>1});Je(Dn(a),function(s){var l=Fe(s,function(c){return c.orgProd}),u=e.buildDuplicateNestedRuleNameError(n,l);r.push({message:u,type:vn.DUPLICATE_NESTED_NAME,ruleName:n.name})})}),r}var MJ={buildMismatchTokenMessage:function(t){var e=t.expected,r=t.actual;t.previous,t.ruleName;var n=wJ(e),i=n?"--> "+Jf(e)+" <--":"token of type --> "+e.name+" <--",o="Expecting "+i+" but found --> '"+r.image+"' <--";return o},buildNotAllInputParsedMessage:function(t){var e=t.firstRedundant;return t.ruleName,"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(t){var e=t.expectedPathsPerAlt,r=t.actual;t.previous;var n=t.customUserDescription;t.ruleName;var i="Expecting: ",o=to(r).image,a=`
but found: '`+o+"'";if(n)return i+n+a;var s=Mn(e,function(f,h){return f.concat(h)},[]),l=Fe(s,function(f){return"["+Fe(f,function(h){return Jf(h)}).join(", ")+"]"}),u=Fe(l,function(f,h){return"  "+(h+1)+". "+f}),c=`one of these possible Token sequences:
`+u.join(`
`);return i+c+a},buildEarlyExitMessage:function(t){var e=t.expectedIterationPaths,r=t.actual,n=t.customUserDescription;t.ruleName;var i="Expecting: ",o=to(r).image,a=`
but found: '`+o+"'";if(n)return i+n+a;var s=Fe(e,function(u){return"["+Fe(u,function(c){return Jf(c)}).join(",")+"]"}),l=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+s.join(" ,")+">");return i+l+a}};Object.freeze(MJ);var dat={buildRuleNotFoundError:function(t,e){var r="Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+t.name+"<-";return r}},Ox={buildDuplicateFoundError:function(t,e){function r(c){return c instanceof Sr?c.terminalType.name:c instanceof Ni?c.nonTerminalName:""}var n=t.name,i=to(e),o=i.idx,a=Ro(i),s=r(i),l=o>0,u="->"+a+(l?o:"")+"<- "+(s?"with argument: ->"+s+"<-":"")+`
                  appears more than once (`+e.length+" times) in the top level rule: ->"+n+`<-.                  
                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return u=u.replace(/[ \t]+/g," "),u=u.replace(/\s\s+/g,`
`),u},buildInvalidNestedRuleNameError:function(t,e){var r="Invalid nested rule name: ->"+e.name+"<- inside rule: ->"+t.name+`<-
`+("it must match the pattern: ->"+IJ.toString()+`<-.
`)+"Note that this means a nested rule name must start with the '$'(dollar) sign.";return r},buildDuplicateNestedRuleNameError:function(t,e){var r=to(e).name,n="Duplicate nested rule name: ->"+r+"<- inside rule: ->"+t.name+`<-
A nested name must be unique in the scope of a top level grammar rule.`;return n},buildNamespaceConflictError:function(t){var e=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+t.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return e},buildAlternationPrefixAmbiguityError:function(t){var e=Fe(t.prefixPath,function(i){return Jf(i)}).join(", "),r=t.alternation.idx===0?"":t.alternation.idx,n="Ambiguous alternatives: <"+t.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+r+"> inside <"+t.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`)+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return n},buildAlternationAmbiguityError:function(t){var e=Fe(t.prefixPath,function(i){return Jf(i)}).join(", "),r=t.alternation.idx===0?"":t.alternation.idx,n="Ambiguous Alternatives Detected: <"+t.ambiguityIndices.join(" ,")+"> in <OR"+r+">"+(" inside <"+t.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`);return n=n+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,n},buildEmptyRepetitionError:function(t){var e=Ro(t.repetition);t.repetition.idx!==0&&(e+=t.repetition.idx);var r="The repetition <"+e+"> within Rule <"+t.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return r},buildTokenNameError:function(t){var e=t.tokenType.name,r="Invalid Grammar Token name: ->"+e+"<- it must match the pattern: ->"+t.expectedPattern.toString()+"<-";return r},buildEmptyAlternationError:function(t){var e="Ambiguous empty alternative: <"+(t.emptyChoiceIdx+1)+">"+(" in <OR"+t.alternation.idx+"> inside <"+t.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return e},buildTooManyAlternativesError:function(t){var e=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+t.alternation.idx+"> inside <"+t.topLevelRule.name+`> Rule.
 has `+(t.alternation.definition.length+1)+" alternatives.");return e},buildLeftRecursionError:function(t){var e=t.topLevelRule.name,r=Fe(t.leftRecursionPath,function(o){return o.name}),n=e+" --> "+r.concat([e]).join(" --> "),i=`Left Recursion found in grammar.
`+("rule: <"+e+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+n+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return i},buildInvalidRuleNameError:function(t){var e=t.topLevelRule.name,r=t.expectedPattern.toString(),n="Invalid grammar rule name: ->"+e+"<- it must match the pattern: ->"+r+"<-";return n},buildDuplicateRuleNameError:function(t){var e;t.topLevelRule instanceof Gp?e=t.topLevelRule.name:e=t.topLevelRule;var r="Duplicate definition, rule: ->"+e+"<- is already defined in the grammar: ->"+t.grammarName+"<-";return r}},pat=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();function mat(t,e){var r=new gat(t,e);return r.resolveRefs(),r.errors}var gat=function(t){pat(e,t);function e(r,n){var i=t.call(this)||this;return i.nameToTopRule=r,i.errMsgProvider=n,i.errors=[],i}return e.prototype.resolveRefs=function(){var r=this;Je(Dn(this.nameToTopRule),function(n){r.currTopLevel=n,n.accept(r)})},e.prototype.visitNonTerminal=function(r){var n=this.nameToTopRule[r.nonTerminalName];if(n)r.referencedRule=n;else{var i=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,r);this.errors.push({message:i,type:vn.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:r.nonTerminalName})}},e}(Ac);function yat(t){t=n5(t,{errMsgProvider:dat});var e={};return Je(t.rules,function(r){e[r.name]=r}),mat(e,t.errMsgProvider)}function vat(t){return t=n5(t,{errMsgProvider:Ox,ignoredIssues:{}}),Kot(t.rules,t.maxLookahead,t.tokenTypes,t.ignoredIssues,t.errMsgProvider,t.grammarName)}var NJ="MismatchedTokenException",PJ="NoViableAltException",kJ="EarlyExitException",$J="NotAllInputParsedException",LJ=[NJ,PJ,kJ,$J];Object.freeze(LJ);function aS(t){return sn(LJ,t.name)}function Ax(t,e,r){this.name=NJ,this.message=t,this.token=e,this.previousToken=r,this.resyncedTokens=[]}Ax.prototype=Error.prototype;function DJ(t,e,r){this.name=PJ,this.message=t,this.token=e,this.previousToken=r,this.resyncedTokens=[]}DJ.prototype=Error.prototype;function FJ(t,e){this.name=$J,this.message=t,this.token=e,this.resyncedTokens=[]}FJ.prototype=Error.prototype;function HJ(t,e,r){this.name=kJ,this.message=t,this.token=e,this.previousToken=r,this.resyncedTokens=[]}HJ.prototype=Error.prototype;var UC={},BJ="InRuleRecoveryException";function UJ(t){this.name=BJ,this.message=t}UJ.prototype=Error.prototype;var bat=function(){function t(){}return t.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Ze(e,"recoveryEnabled")?e.recoveryEnabled:ci.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=wat)},t.prototype.getTokenToInsert=function(e){var r=Sx(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return r.isInsertedInRecovery=!0,r},t.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},t.prototype.tryInRepetitionRecovery=function(e,r,n,i){for(var o=this,a=this.findReSyncTokenType(),s=this.exportLexerState(),l=[],u=!1,c=this.LA(1),f=this.LA(1),h=function(){var d=o.LA(0),p=o.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:c,previous:d,ruleName:o.getCurrRuleFullName()}),m=new Ax(p,c,o.LA(0));m.resyncedTokens=Mv(l),o.SAVE_ERROR(m)};!u;)if(this.tokenMatcher(f,i)){h();return}else if(n.call(this)){h(),e.apply(this,r);return}else this.tokenMatcher(f,a)?u=!0:(f=this.SKIP_TOKEN(),this.addToResyncTokens(f,l));this.importLexerState(s)},t.prototype.shouldInRepetitionRecoveryBeTried=function(e,r,n){return!(n===!1||e===void 0||r===void 0||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,r)))},t.prototype.getFollowsForInRuleRecovery=function(e,r){var n=this.getCurrentGrammarPath(e,r),i=this.getNextPossibleTokenTypes(n);return i},t.prototype.tryInRuleRecovery=function(e,r){if(this.canRecoverWithSingleTokenInsertion(e,r)){var n=this.getTokenToInsert(e);return n}if(this.canRecoverWithSingleTokenDeletion(e)){var i=this.SKIP_TOKEN();return this.consumeToken(),i}throw new UJ("sad sad panda")},t.prototype.canPerformInRuleRecovery=function(e,r){return this.canRecoverWithSingleTokenInsertion(e,r)||this.canRecoverWithSingleTokenDeletion(e)},t.prototype.canRecoverWithSingleTokenInsertion=function(e,r){var n=this;if(!this.canTokenTypeBeInsertedInRecovery(e)||Zt(r))return!1;var i=this.LA(1),o=gp(r,function(a){return n.tokenMatcher(i,a)})!==void 0;return o},t.prototype.canRecoverWithSingleTokenDeletion=function(e){var r=this.tokenMatcher(this.LA(2),e);return r},t.prototype.isInCurrentRuleReSyncSet=function(e){var r=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(r);return sn(n,e)},t.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),r=this.LA(1),n=2;;){var i=r.tokenType;if(sn(e,i))return i;r=this.LA(n),n++}},t.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return UC;var e=this.getLastExplicitRuleShortName(),r=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:r,inRule:this.shortRuleNameToFullName(n)}},t.prototype.buildFullFollowKeyStack=function(){var e=this,r=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return Zt(this.LAST_EXPLICIT_RULE_STACK)||(r=Fe(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_STACK[i]}),n=Fe(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_OCCURRENCE_STACK[i]})),Fe(r,function(i,o){return o===0?UC:{ruleName:e.shortRuleNameToFullName(i),idxInCallingRule:n[o],inRule:e.shortRuleNameToFullName(r[o-1])}})},t.prototype.flattenFollowSet=function(){var e=this,r=Fe(this.buildFullFollowKeyStack(),function(n){return e.getFollowSetFromFollowKey(n)});return mi(r)},t.prototype.getFollowSetFromFollowKey=function(e){if(e===UC)return[ac];var r=e.ruleName+e.idxInCallingRule+SJ+e.inRule;return this.resyncFollows[r]},t.prototype.addToResyncTokens=function(e,r){return this.tokenMatcher(e,ac)||r.push(e),r},t.prototype.reSyncTo=function(e){for(var r=[],n=this.LA(1);this.tokenMatcher(n,e)===!1;)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,r);return Mv(r)},t.prototype.attemptInRepetitionRecovery=function(e,r,n,i,o,a,s){},t.prototype.getCurrentGrammarPath=function(e,r){var n=this.getHumanReadableRuleStack(),i=gi(this.RULE_OCCURRENCE_STACK),o={ruleStack:n,occurrenceStack:i,lastTok:e,lastTokOccurrence:r};return o},t.prototype.getHumanReadableRuleStack=function(){var e=this;return Zt(this.LAST_EXPLICIT_RULE_STACK)?Fe(this.RULE_STACK,function(r){return e.shortRuleNameToFullName(r)}):Fe(this.LAST_EXPLICIT_RULE_STACK,function(r){return e.shortRuleNameToFullName(e.RULE_STACK[r])})},t}();function wat(t,e,r,n,i,o,a){var s=this.getKeyForAutomaticLookahead(n,i),l=this.firstAfterRepMap[s];if(l===void 0){var u=this.getCurrRuleFullName(),c=this.getGAstProductions()[u],f=new o(c,i);l=f.startWalking(),this.firstAfterRepMap[s]=l}var h=l.token,d=l.occurrence,p=l.isEndOfRule;this.RULE_STACK.length===1&&p&&h===void 0&&(h=ac,d=1),this.shouldInRepetitionRecoveryBeTried(h,d,a)&&this.tryInRepetitionRecovery(t,e,r,h)}var Sat=function(){function t(){}return t.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=Ze(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:ci.dynamicTokensEnabled,this.maxLookahead=Ze(e,"maxLookahead")?e.maxLookahead:ci.maxLookahead,this.lookAheadFuncsCache=oV()?new Map:[],oV()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},t.prototype.preComputeLookaheadFunctions=function(e){var r=this;Je(e,function(n){r.TRACE_INIT(n.name+" Rule Lookahead",function(){var i=Sot(n),o=i.alternation,a=i.repetition,s=i.option,l=i.repetitionMandatory,u=i.repetitionMandatoryWithSeparator,c=i.repetitionWithSeparator;Je(o,function(f){var h=f.idx===0?"":f.idx;r.TRACE_INIT(""+Ro(f)+h,function(){var d=Uot(f.idx,n,f.maxLookahead||r.maxLookahead,f.hasPredicates,r.dynamicTokensEnabled,r.lookAheadBuilderForAlternatives),p=fg(r.fullRuleNameToShort[n.name],eh,f.idx);r.setLaFuncCache(p,d)})}),Je(a,function(f){r.computeLookaheadFunc(n,f.idx,lg,rr.REPETITION,f.maxLookahead,Ro(f))}),Je(s,function(f){r.computeLookaheadFunc(n,f.idx,oS,rr.OPTION,f.maxLookahead,Ro(f))}),Je(l,function(f){r.computeLookaheadFunc(n,f.idx,ug,rr.REPETITION_MANDATORY,f.maxLookahead,Ro(f))}),Je(u,function(f){r.computeLookaheadFunc(n,f.idx,$f,rr.REPETITION_MANDATORY_WITH_SEPARATOR,f.maxLookahead,Ro(f))}),Je(c,function(f){r.computeLookaheadFunc(n,f.idx,cg,rr.REPETITION_WITH_SEPARATOR,f.maxLookahead,Ro(f))})})})},t.prototype.computeLookaheadFunc=function(e,r,n,i,o,a){var s=this;this.TRACE_INIT(""+a+(r===0?"":r),function(){var l=Vot(r,e,o||s.maxLookahead,s.dynamicTokensEnabled,i,s.lookAheadBuilderForOptional),u=fg(s.fullRuleNameToShort[e.name],n,r);s.setLaFuncCache(u,l)})},t.prototype.lookAheadBuilderForOptional=function(e,r,n){return Wot(e,r,n)},t.prototype.lookAheadBuilderForAlternatives=function(e,r,n,i){return jot(e,r,n,i)},t.prototype.getKeyForAutomaticLookahead=function(e,r){var n=this.getLastExplicitRuleShortName();return fg(n,e,r)},t.prototype.getLaFuncFromCache=function(e){},t.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},t.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},t.prototype.setLaFuncCache=function(e,r){},t.prototype.setLaFuncCacheUsingMap=function(e,r){this.lookAheadFuncsCache.set(e,r)},t.prototype.setLaFuncUsingObj=function(e,r){this.lookAheadFuncsCache[e]=r},t}();function Rat(t){return l5(t.constructor)}var Eat=/^\s*function\s*(\S*)\s*\(/,TV="name";function l5(t){var e=t.name;if(e)return e;var r=t.toString().match(Eat)[1];return r}function VJ(t,e){var r=Object.getOwnPropertyDescriptor(t,TV);return ro(r)||r.configurable?(Object.defineProperty(t,TV,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0):!1}function Cat(t,e){for(var r=As(t),n=r.length,i=0;i<n;i++)for(var o=r[i],a=t[o],s=a.length,l=0;l<s;l++){var u=a[l];u.tokenTypeIdx===void 0&&(u.fullName!==void 0?this[u.fullName](u.children,e):this[u.name](u.children,e))}}function _at(t,e){var r=function(){};VJ(r,t+"BaseSemantics");var n={visit:function(i,o){if(To(i)&&(i=i[0]),!ro(i))return i.fullName!==void 0?this[i.fullName](i.children,o):this[i.name](i.children,o)},validateVisitor:function(){var i=Oat(this,e);if(!Zt(i)){var o=Fe(i,function(a){return a.msg});throw Error("Errors Detected in CST Visitor <"+l5(this.constructor)+`>:
	`+(""+o.join(`

`).replace(/\n/g,`
	`)))}}};return r.prototype=n,r.prototype.constructor=r,r._RULE_NAMES=e,r}function Tat(t,e,r){var n=function(){};VJ(n,t+"BaseSemanticsWithDefaults");var i=Object.create(r.prototype);return Je(e,function(o){i[o]=Cat}),n.prototype=i,n.prototype.constructor=n,n}var sS;(function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"})(sS||(sS={}));function Oat(t,e){var r=Aat(t,e),n=xat(t,e);return r.concat(n)}function Aat(t,e){var r=Fe(e,function(n){if(!Tl(t[n]))return{msg:"Missing visitor method: <"+n+"> on "+l5(t.constructor)+" CST Visitor.",type:sS.MISSING_METHOD,methodName:n}});return W1(r)}var Iat=["constructor","visit","validateVisitor"];function xat(t,e){var r=[];for(var n in t)sc.test(n)&&Tl(t[n])&&!sn(Iat,n)&&!sn(e,n)&&r.push({msg:"Redundant visitor method: <"+n+"> on "+l5(t.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`+("For utility methods on visitor classes use methods names that do not match /"+sc.source+"/."),type:sS.REDUNDANT_METHOD,methodName:n});return r}var Mat=function(){function t(){}return t.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=Ze(e,"outputCst")?e.outputCst:ci.outputCst,this.nodeLocationTracking=Ze(e,"nodeLocationTracking")?e.nodeLocationTracking:ci.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=un,this.cstFinallyStateUpdate=un,this.cstPostTerminal=un,this.cstPostNonTerminal=un,this.cstPostRule=un,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=SV,this.setNodeLocationFromNode=SV,this.cstPostRule=un,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=un,this.setNodeLocationFromNode=un,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=wV,this.setNodeLocationFromNode=wV,this.cstPostRule=un,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=un,this.setNodeLocationFromNode=un,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=un,this.setNodeLocationFromNode=un,this.cstPostRule=un,this.setInitialNodeLocation=un;else throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"')},t.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},t.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},t.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.setInitialNodeLocationFullRegular=function(e){var r=this.LA(1);e.location={startOffset:r.startOffset,startLine:r.startLine,startColumn:r.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.cstNestedInvocationStateUpdate=function(e,r){var n={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},t.prototype.cstInvocationStateUpdate=function(e,r){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var n={name:e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},t.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},t.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},t.prototype.cstPostRuleFull=function(e){var r=this.LA(0),n=e.location;n.startOffset<=r.startOffset?(n.endOffset=r.endOffset,n.endLine=r.endLine,n.endColumn=r.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},t.prototype.cstPostRuleOnlyOffset=function(e){var r=this.LA(0),n=e.location;n.startOffset<=r.startOffset?n.endOffset=r.endOffset:n.startOffset=NaN},t.prototype.cstPostTerminal=function(e,r){var n=this.CST_STACK[this.CST_STACK.length-1];Pot(n,r,e),this.setNodeLocationFromToken(n.location,r)},t.prototype.cstPostNonTerminal=function(e,r){if(this.isBackTracking()!==!0){var n=this.CST_STACK[this.CST_STACK.length-1];RV(n,r,e),this.setNodeLocationFromNode(n.location,e.location)}},t.prototype.getBaseCstVisitorConstructor=function(){if(ro(this.baseCstVisitorConstructor)){var e=_at(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},t.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(ro(this.baseCstVisitorWithDefaultsConstructor)){var e=Tat(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},t.prototype.nestedRuleBeforeClause=function(e,r){var n;if(e.NAME!==void 0)return n=e.NAME,this.nestedRuleInvocationStateUpdate(n,r),n},t.prototype.nestedAltBeforeClause=function(e,r,n,i){var o=this.getLastExplicitRuleShortName(),a=RJ(o,n,r,i),s;if(e.NAME!==void 0)return s=e.NAME,this.nestedRuleInvocationStateUpdate(s,a),{shortName:a,nestedName:s}},t.prototype.nestedRuleFinallyClause=function(e,r){var n=this.CST_STACK,i=n[n.length-1];this.nestedRuleFinallyStateUpdate();var o=n[n.length-1];RV(o,r,i),this.setNodeLocationFromNode(o.location,i.location)},t.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},t.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},t.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},t.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},t.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},t.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},t.prototype.nestedRuleInvocationStateUpdate=function(e,r){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(r),this.cstNestedInvocationStateUpdate(e,r)},t.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},t}(),Nat=function(){function t(){}return t.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(t.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),t.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):uS},t.prototype.LA=function(e){var r=this.currIdx+e;return r<0||this.tokVectorLength<=r?uS:this.tokVector[r]},t.prototype.consumeToken=function(){this.currIdx++},t.prototype.exportLexerState=function(){return this.currIdx},t.prototype.importLexerState=function(e){this.currIdx=e},t.prototype.resetLexerState=function(){this.currIdx=-1},t.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},t.prototype.getLexerPosition=function(){return this.exportLexerState()},t}(),Pat=function(){function t(){}return t.prototype.ACTION=function(e){return e.call(this)},t.prototype.consume=function(e,r,n){return this.consumeInternal(r,e,n)},t.prototype.subrule=function(e,r,n){return this.subruleInternal(r,e,n)},t.prototype.option=function(e,r){return this.optionInternal(r,e)},t.prototype.or=function(e,r){return this.orInternal(r,e)},t.prototype.many=function(e,r){return this.manyInternal(e,r)},t.prototype.atLeastOne=function(e,r){return this.atLeastOneInternal(e,r)},t.prototype.CONSUME=function(e,r){return this.consumeInternal(e,0,r)},t.prototype.CONSUME1=function(e,r){return this.consumeInternal(e,1,r)},t.prototype.CONSUME2=function(e,r){return this.consumeInternal(e,2,r)},t.prototype.CONSUME3=function(e,r){return this.consumeInternal(e,3,r)},t.prototype.CONSUME4=function(e,r){return this.consumeInternal(e,4,r)},t.prototype.CONSUME5=function(e,r){return this.consumeInternal(e,5,r)},t.prototype.CONSUME6=function(e,r){return this.consumeInternal(e,6,r)},t.prototype.CONSUME7=function(e,r){return this.consumeInternal(e,7,r)},t.prototype.CONSUME8=function(e,r){return this.consumeInternal(e,8,r)},t.prototype.CONSUME9=function(e,r){return this.consumeInternal(e,9,r)},t.prototype.SUBRULE=function(e,r){return this.subruleInternal(e,0,r)},t.prototype.SUBRULE1=function(e,r){return this.subruleInternal(e,1,r)},t.prototype.SUBRULE2=function(e,r){return this.subruleInternal(e,2,r)},t.prototype.SUBRULE3=function(e,r){return this.subruleInternal(e,3,r)},t.prototype.SUBRULE4=function(e,r){return this.subruleInternal(e,4,r)},t.prototype.SUBRULE5=function(e,r){return this.subruleInternal(e,5,r)},t.prototype.SUBRULE6=function(e,r){return this.subruleInternal(e,6,r)},t.prototype.SUBRULE7=function(e,r){return this.subruleInternal(e,7,r)},t.prototype.SUBRULE8=function(e,r){return this.subruleInternal(e,8,r)},t.prototype.SUBRULE9=function(e,r){return this.subruleInternal(e,9,r)},t.prototype.OPTION=function(e){return this.optionInternal(e,0)},t.prototype.OPTION1=function(e){return this.optionInternal(e,1)},t.prototype.OPTION2=function(e){return this.optionInternal(e,2)},t.prototype.OPTION3=function(e){return this.optionInternal(e,3)},t.prototype.OPTION4=function(e){return this.optionInternal(e,4)},t.prototype.OPTION5=function(e){return this.optionInternal(e,5)},t.prototype.OPTION6=function(e){return this.optionInternal(e,6)},t.prototype.OPTION7=function(e){return this.optionInternal(e,7)},t.prototype.OPTION8=function(e){return this.optionInternal(e,8)},t.prototype.OPTION9=function(e){return this.optionInternal(e,9)},t.prototype.OR=function(e){return this.orInternal(e,0)},t.prototype.OR1=function(e){return this.orInternal(e,1)},t.prototype.OR2=function(e){return this.orInternal(e,2)},t.prototype.OR3=function(e){return this.orInternal(e,3)},t.prototype.OR4=function(e){return this.orInternal(e,4)},t.prototype.OR5=function(e){return this.orInternal(e,5)},t.prototype.OR6=function(e){return this.orInternal(e,6)},t.prototype.OR7=function(e){return this.orInternal(e,7)},t.prototype.OR8=function(e){return this.orInternal(e,8)},t.prototype.OR9=function(e){return this.orInternal(e,9)},t.prototype.MANY=function(e){this.manyInternal(0,e)},t.prototype.MANY1=function(e){this.manyInternal(1,e)},t.prototype.MANY2=function(e){this.manyInternal(2,e)},t.prototype.MANY3=function(e){this.manyInternal(3,e)},t.prototype.MANY4=function(e){this.manyInternal(4,e)},t.prototype.MANY5=function(e){this.manyInternal(5,e)},t.prototype.MANY6=function(e){this.manyInternal(6,e)},t.prototype.MANY7=function(e){this.manyInternal(7,e)},t.prototype.MANY8=function(e){this.manyInternal(8,e)},t.prototype.MANY9=function(e){this.manyInternal(9,e)},t.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},t.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},t.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},t.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},t.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},t.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},t.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},t.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},t.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},t.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},t.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},t.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},t.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},t.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},t.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},t.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},t.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},t.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},t.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},t.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},t.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},t.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},t.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},t.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},t.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},t.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},t.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},t.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},t.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},t.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},t.prototype.RULE=function(e,r,n){if(n===void 0&&(n=cS),sn(this.definedRulesNames,e)){var i=Ox.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),o={message:i,type:vn.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(o)}this.definedRulesNames.push(e);var a=this.defineRule(e,r,n);return this[e]=a,a},t.prototype.OVERRIDE_RULE=function(e,r,n){n===void 0&&(n=cS);var i=[];i=i.concat(nat(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,i);var o=this.defineRule(e,r,n);return this[e]=o,o},t.prototype.BACKTRACK=function(e,r){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return e.apply(this,r),!0}catch(i){if(aS(i))return!1;throw i}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},t.prototype.getGAstProductions=function(){return this.gastProductionsCache},t.prototype.getSerializedGastProductions=function(){return got(Dn(this.gastProductionsCache))},t}(),kat=function(){function t(){}return t.prototype.initRecognizerEngine=function(e,r){if(this.className=Rat(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=nS,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Ze(r,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(To(e)){if(Zt(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(To(e))this.tokensMap=Mn(e,function(a,s){return a[s.name]=s,a},{});else if(Ze(e,"modes")&&Qi(mi(Dn(e.modes)),hot)){var n=mi(Dn(e.modes)),i=yx(n);this.tokensMap=Mn(i,function(a,s){return a[s.name]=s,a},{})}else if(vx(e))this.tokensMap=j1(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=ac;var o=Qi(Dn(e),function(a){return Zt(a.categoryMatches)});this.tokenMatcher=o?nS:o5,z1(Dn(this.tokensMap))},t.prototype.defineRule=function(e,r,n){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var i=Ze(n,"resyncEnabled")?n.resyncEnabled:cS.resyncEnabled,o=Ze(n,"recoveryValueFunc")?n.recoveryValueFunc:cS.recoveryValueFunc,a=this.ruleShortNameIdx<<Iot+Ol;this.ruleShortNameIdx++,this.shortRuleNameToFull[a]=e,this.fullRuleNameToShort[e]=a;function s(c){try{if(this.outputCst===!0){r.apply(this,c);var f=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(f),f}else return r.apply(this,c)}catch(h){return this.invokeRuleCatch(h,i,o)}finally{this.ruleFinallyStateUpdate()}}var l;l=function(c,f){return c===void 0&&(c=0),this.ruleInvocationStateUpdate(a,e,c),s.call(this,f)};var u="ruleName";return l[u]=e,l.originalGrammarAction=r,l},t.prototype.invokeRuleCatch=function(e,r,n){var i=this.RULE_STACK.length===1,o=r&&!this.isBackTracking()&&this.recoveryEnabled;if(aS(e)){var a=e;if(o){var s=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(s))if(a.resyncedTokens=this.reSyncTo(s),this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];return l.recoveredNode=!0,l}else return n();else{if(this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];l.recoveredNode=!0,a.partialCstResult=l}throw a}}else{if(i)return this.moveToTerminatedState(),n();throw a}}else throw e},t.prototype.optionInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(oS,r),i=this.nestedRuleBeforeClause(e,n);try{return this.optionInternalLogic(e,r,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.optionInternalNoCst=function(e,r){var n=this.getKeyForAutomaticLookahead(oS,r);return this.optionInternalLogic(e,r,n)},t.prototype.optionInternalLogic=function(e,r,n){var i=this,o=this.getLaFuncFromCache(n),a,s;if(e.DEF!==void 0){if(a=e.DEF,s=e.GATE,s!==void 0){var l=o;o=function(){return s.call(i)&&l.call(i)}}}else a=e;if(o.call(this)===!0)return a.call(this)},t.prototype.atLeastOneInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(ug,e),i=this.nestedRuleBeforeClause(r,n);try{return this.atLeastOneInternalLogic(e,r,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.atLeastOneInternalNoCst=function(e,r){var n=this.getKeyForAutomaticLookahead(ug,e);this.atLeastOneInternalLogic(e,r,n)},t.prototype.atLeastOneInternalLogic=function(e,r,n){var i=this,o=this.getLaFuncFromCache(n),a,s;if(r.DEF!==void 0){if(a=r.DEF,s=r.GATE,s!==void 0){var l=o;o=function(){return s.call(i)&&l.call(i)}}}else a=r;if(o.call(this)===!0)for(var u=this.doSingleRepetition(a);o.call(this)===!0&&u===!0;)u=this.doSingleRepetition(a);else throw this.raiseEarlyExitException(e,rr.REPETITION_MANDATORY,r.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,r],o,ug,e,Fot)},t.prototype.atLeastOneSepFirstInternal=function(e,r){var n=this.getKeyForAutomaticLookahead($f,e),i=this.nestedRuleBeforeClause(r,n);try{this.atLeastOneSepFirstInternalLogic(e,r,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.atLeastOneSepFirstInternalNoCst=function(e,r){var n=this.getKeyForAutomaticLookahead($f,e);this.atLeastOneSepFirstInternalLogic(e,r,n)},t.prototype.atLeastOneSepFirstInternalLogic=function(e,r,n){var i=this,o=r.DEF,a=r.SEP,s=this.getLaFuncFromCache(n);if(s.call(this)===!0){o.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),a)};this.tokenMatcher(this.LA(1),a)===!0;)this.CONSUME(a),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,a,l,o,CV],l,$f,e,CV)}else throw this.raiseEarlyExitException(e,rr.REPETITION_MANDATORY_WITH_SEPARATOR,r.ERR_MSG)},t.prototype.manyInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(lg,e),i=this.nestedRuleBeforeClause(r,n);try{return this.manyInternalLogic(e,r,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.manyInternalNoCst=function(e,r){var n=this.getKeyForAutomaticLookahead(lg,e);return this.manyInternalLogic(e,r,n)},t.prototype.manyInternalLogic=function(e,r,n){var i=this,o=this.getLaFuncFromCache(n),a,s;if(r.DEF!==void 0){if(a=r.DEF,s=r.GATE,s!==void 0){var l=o;o=function(){return s.call(i)&&l.call(i)}}}else a=r;for(var u=!0;o.call(this)===!0&&u===!0;)u=this.doSingleRepetition(a);this.attemptInRepetitionRecovery(this.manyInternal,[e,r],o,lg,e,Dot,u)},t.prototype.manySepFirstInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(cg,e),i=this.nestedRuleBeforeClause(r,n);try{this.manySepFirstInternalLogic(e,r,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.manySepFirstInternalNoCst=function(e,r){var n=this.getKeyForAutomaticLookahead(cg,e);this.manySepFirstInternalLogic(e,r,n)},t.prototype.manySepFirstInternalLogic=function(e,r,n){var i=this,o=r.DEF,a=r.SEP,s=this.getLaFuncFromCache(n);if(s.call(this)===!0){o.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),a)};this.tokenMatcher(this.LA(1),a)===!0;)this.CONSUME(a),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,a,l,o,EV],l,cg,e,EV)}},t.prototype.repetitionSepSecondInternal=function(e,r,n,i,o){for(;n();)this.CONSUME(r),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,r,n,i,o],n,$f,e,o)},t.prototype.doSingleRepetition=function(e){var r=this.getLexerPosition();e.call(this);var n=this.getLexerPosition();return n>r},t.prototype.orInternalNoCst=function(e,r){var n=To(e)?e:e.DEF,i=this.getKeyForAutomaticLookahead(eh,r),o=this.getLaFuncFromCache(i),a=o.call(this,n);if(a!==void 0){var s=n[a];return s.ALT.call(this)}this.raiseNoAltException(r,e.ERR_MSG)},t.prototype.orInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(eh,r),i=this.nestedRuleBeforeClause(e,n);try{var o=To(e)?e:e.DEF,a=this.getLaFuncFromCache(n),s=a.call(this,o);if(s!==void 0){var l=o[s],u=this.nestedAltBeforeClause(l,r,eh,s);try{return l.ALT.call(this)}finally{u!==void 0&&this.nestedRuleFinallyClause(u.shortName,u.nestedName)}}this.raiseNoAltException(r,e.ERR_MSG)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var e=this.LA(1),r=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new FJ(r,e))}},t.prototype.subruleInternal=function(e,r,n){var i;try{var o=n!==void 0?n.ARGS:void 0;return i=e.call(this,r,o),this.cstPostNonTerminal(i,n!==void 0&&n.LABEL!==void 0?n.LABEL:e.ruleName),i}catch(a){this.subruleInternalError(a,n,e.ruleName)}},t.prototype.subruleInternalError=function(e,r,n){throw aS(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,r!==void 0&&r.LABEL!==void 0?r.LABEL:n),delete e.partialCstResult),e},t.prototype.consumeInternal=function(e,r,n){var i;try{var o=this.LA(1);this.tokenMatcher(o,e)===!0?(this.consumeToken(),i=o):this.consumeInternalError(e,o,n)}catch(a){i=this.consumeInternalRecovery(e,r,a)}return this.cstPostTerminal(n!==void 0&&n.LABEL!==void 0?n.LABEL:e.name,i),i},t.prototype.consumeInternalError=function(e,r,n){var i,o=this.LA(0);throw n!==void 0&&n.ERR_MSG?i=n.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:r,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new Ax(i,r,o))},t.prototype.consumeInternalRecovery=function(e,r,n){if(this.recoveryEnabled&&n.name==="MismatchedTokenException"&&!this.isBackTracking()){var i=this.getFollowsForInRuleRecovery(e,r);try{return this.tryInRuleRecovery(e,i)}catch(o){throw o.name===BJ?n:o}}else throw n},t.prototype.saveRecogState=function(){var e=this.errors,r=gi(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:r,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},t.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},t.prototype.ruleInvocationStateUpdate=function(e,r,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(r,e)},t.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},t.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},t.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},t.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),ac)},t.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},t}(),$at=function(){function t(){}return t.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=n5(e.errorMessageProvider,ci.errorMessageProvider)},t.prototype.SAVE_ERROR=function(e){if(aS(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:gi(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(t.prototype,"errors",{get:function(){return gi(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),t.prototype.raiseEarlyExitException=function(e,r,n){for(var i=this.getCurrRuleFullName(),o=this.getGAstProductions()[i],a=Cx(e,o,r,this.maxLookahead),s=a[0],l=[],u=1;u<=this.maxLookahead;u++)l.push(this.LA(u));var c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:s,actual:l,previous:this.LA(0),customUserDescription:n,ruleName:i});throw this.SAVE_ERROR(new HJ(c,this.LA(1),this.LA(0)))},t.prototype.raiseNoAltException=function(e,r){for(var n=this.getCurrRuleFullName(),i=this.getGAstProductions()[n],o=Ex(e,i,this.maxLookahead),a=[],s=1;s<=this.maxLookahead;s++)a.push(this.LA(s));var l=this.LA(0),u=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:o,actual:a,previous:l,customUserDescription:r,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new DJ(u,this.LA(1),l))},t}(),Lat=function(){function t(){}return t.prototype.initContentAssist=function(){},t.prototype.computeContentAssist=function(e,r){var n=this.gastProductionsCache[e];if(ro(n))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return EJ([n],r,this.tokenMatcher,this.maxLookahead)},t.prototype.getNextPossibleTokenTypes=function(e){var r=to(e.ruleStack),n=this.getGAstProductions(),i=n[r],o=new Lot(i,e).startWalking();return o},t}(),u5={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(u5);var OV=!0,AV=Math.pow(2,Ol)-1,jJ=Pt({name:"RECORDING_PHASE_TOKEN",pattern:pi.NA});z1([jJ]);var WJ=Sx(jJ,`This IToken indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(WJ);var Dat={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,children:{}},Fat=function(){function t(){}return t.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},t.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var r=function(i){var o=i>0?i:"";e["CONSUME"+o]=function(a,s){return this.consumeInternalRecord(a,i,s)},e["SUBRULE"+o]=function(a,s){return this.subruleInternalRecord(a,i,s)},e["OPTION"+o]=function(a){return this.optionInternalRecord(a,i)},e["OR"+o]=function(a){return this.orInternalRecord(a,i)},e["MANY"+o]=function(a){this.manyInternalRecord(i,a)},e["MANY_SEP"+o]=function(a){this.manySepFirstInternalRecord(i,a)},e["AT_LEAST_ONE"+o]=function(a){this.atLeastOneInternalRecord(i,a)},e["AT_LEAST_ONE_SEP"+o]=function(a){this.atLeastOneSepFirstInternalRecord(i,a)}},n=0;n<10;n++)r(n);e.consume=function(i,o,a){return this.consumeInternalRecord(o,i,a)},e.subrule=function(i,o,a){return this.subruleInternalRecord(o,i,a)},e.option=function(i,o){return this.optionInternalRecord(o,i)},e.or=function(i,o){return this.orInternalRecord(o,i)},e.many=function(i,o){this.manyInternalRecord(i,o)},e.atLeastOne=function(i,o){this.atLeastOneInternalRecord(i,o)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},t.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var r=0;r<10;r++){var n=r>0?r:"";delete e["CONSUME"+n],delete e["SUBRULE"+n],delete e["OPTION"+n],delete e["OR"+n],delete e["MANY"+n],delete e["MANY_SEP"+n],delete e["AT_LEAST_ONE"+n],delete e["AT_LEAST_ONE_SEP"+n]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})},t.prototype.ACTION_RECORD=function(e){},t.prototype.BACKTRACK_RECORD=function(e,r){return function(){return!0}},t.prototype.LA_RECORD=function(e){return uS},t.prototype.topLevelRuleRecord=function(e,r){try{var n=new Gp({definition:[],name:e});return n.name=e,this.recordingProdStack.push(n),r.call(this),this.recordingProdStack.pop(),n}catch(i){if(i.KNOWN_RECORDER_ERROR!==!0)try{i.message=i.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording`}catch{throw i}throw i}},t.prototype.optionInternalRecord=function(e,r){return Om.call(this,In,e,r)},t.prototype.atLeastOneInternalRecord=function(e,r){Om.call(this,no,r,e)},t.prototype.atLeastOneSepFirstInternalRecord=function(e,r){Om.call(this,io,r,e,OV)},t.prototype.manyInternalRecord=function(e,r){Om.call(this,Ur,r,e)},t.prototype.manySepFirstInternalRecord=function(e,r){Om.call(this,Pi,r,e,OV)},t.prototype.orInternalRecord=function(e,r){return Hat.call(this,e,r)},t.prototype.subruleInternalRecord=function(e,r,n){if(lS(r),!e||Ze(e,"ruleName")===!1){var i=new Error("<SUBRULE"+IV(r)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var o=tS(this.recordingProdStack),a=e.ruleName,s=new Ni({idx:r,nonTerminalName:a,referencedRule:void 0});return o.definition.push(s),this.outputCst?Dat:u5},t.prototype.consumeInternalRecord=function(e,r,n){if(lS(r),!bJ(e)){var i=new Error("<CONSUME"+IV(r)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var o=tS(this.recordingProdStack),a=new Sr({idx:r,terminalType:e});return o.definition.push(a),WJ},t}();function Om(t,e,r,n){n===void 0&&(n=!1),lS(r);var i=tS(this.recordingProdStack),o=Tl(e)?e:e.DEF,a=new t({definition:[],idx:r});return Ze(e,"NAME")&&(a.name=e.NAME),n&&(a.separator=e.SEP),Ze(e,"MAX_LOOKAHEAD")&&(a.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(a),o.call(this),i.definition.push(a),this.recordingProdStack.pop(),u5}function Hat(t,e){var r=this;lS(e);var n=tS(this.recordingProdStack),i=To(t)===!1,o=i===!1?t:t.DEF,a=new ki({definition:[],idx:e,ignoreAmbiguities:i&&t.IGNORE_AMBIGUITIES===!0});Ze(t,"NAME")&&(a.name=t.NAME),Ze(t,"MAX_LOOKAHEAD")&&(a.maxLookahead=t.MAX_LOOKAHEAD);var s=sJ(o,function(l){return Tl(l.GATE)});return a.hasPredicates=s,n.definition.push(a),Je(o,function(l){var u=new yi({definition:[]});a.definition.push(u),Ze(l,"NAME")&&(u.name=l.NAME),Ze(l,"IGNORE_AMBIGUITIES")?u.ignoreAmbiguities=l.IGNORE_AMBIGUITIES:Ze(l,"GATE")&&(u.ignoreAmbiguities=!0),r.recordingProdStack.push(u),l.ALT.call(r),r.recordingProdStack.pop()}),u5}function IV(t){return t===0?"":""+t}function lS(t){if(t<0||t>AV){var e=new Error("Invalid DSL Method idx value: <"+t+`>
	`+("Idx value must be a none negative value smaller than "+(AV+1)));throw e.KNOWN_RECORDER_ERROR=!0,e}}var Bat=function(){function t(){}return t.prototype.initPerformanceTracer=function(e){if(Ze(e,"traceInitPerf")){var r=e.traceInitPerf,n=typeof r=="number";this.traceInitMaxIdent=n?r:1/0,this.traceInitPerf=n?r>0:r}else this.traceInitMaxIdent=0,this.traceInitPerf=ci.traceInitPerf;this.traceInitIndent=-1},t.prototype.TRACE_INIT=function(e,r){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+e+">");var i=cJ(r),o=i.time,a=i.value,s=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(n+"<-- <"+e+"> time: "+o+"ms"),this.traceInitIndent--,a}else return r()},t}(),zJ=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),uS=Sx(ac,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(uS);var ci=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:MJ,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),cS=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),vn;(function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",t[t.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"})(vn||(vn={}));function Uat(t){return t===void 0&&(t=void 0),function(){return t}}var Ix=function(){function t(e,r){r===void 0&&(r=ci),this.ignoredIssues=ci.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var n=this;n.initErrorHandler(r),n.initLexerAdapter(),n.initLooksAhead(r),n.initRecognizerEngine(e,r),n.initRecoverable(r),n.initTreeBuilder(r),n.initContentAssist(),n.initGastRecorder(r),n.initPerformanceTracer(r),Ze(r,"ignoredIssues")&&r.ignoredIssues!==ci.ignoredIssues&&bx(`The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.`),this.ignoredIssues=Ze(r,"ignoredIssues")?r.ignoredIssues:ci.ignoredIssues,this.skipValidations=Ze(r,"skipValidations")?r.skipValidations:ci.skipValidations}return t.performSelfAnalysis=function(e){e.performSelfAnalysis()},t.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",function(){var r;e.selfAnalysisDone=!0;var n=e.className;e.TRACE_INIT("toFastProps",function(){uJ(e)}),e.TRACE_INIT("Grammar Recording",function(){try{e.enableRecording(),Je(e.definedRulesNames,function(o){var a=e[o],s=a.originalGrammarAction,l=void 0;e.TRACE_INIT(o+" Rule",function(){l=e.topLevelRuleRecord(o,s)}),e.gastProductionsCache[o]=l})}finally{e.disableRecording()}});var i=[];if(e.TRACE_INIT("Grammar Resolving",function(){i=yat({rules:Dn(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,i)}),e.TRACE_INIT("Grammar Validations",function(){if(Zt(i)&&e.skipValidations===!1){var o=vat({rules:Dn(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:Dn(e.tokensMap),ignoredIssues:e.ignoredIssues,errMsgProvider:Ox,grammarName:n});e.definitionErrors.push.apply(e.definitionErrors,o)}}),Zt(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",function(){var o=Oot(Dn(e.gastProductionsCache));e.resyncFollows=o}),e.TRACE_INIT("ComputeLookaheadFunctions",function(){e.preComputeLookaheadFunctions(Dn(e.gastProductionsCache))})),e.TRACE_INIT("expandAllNestedRuleNames",function(){var o=kot(Dn(e.gastProductionsCache),e.fullRuleNameToShort);e.allRuleNames=o.allRuleNames}),!t.DEFER_DEFINITION_ERRORS_HANDLING&&!Zt(e.definitionErrors))throw r=Fe(e.definitionErrors,function(o){return o.message}),new Error(`Parser Definition Errors detected:
 `+r.join(`
-------------------------------
`))})},t.DEFER_DEFINITION_ERRORS_HANDLING=!1,t}();Iit(Ix,[bat,Sat,Mat,Nat,kat,Pat,$at,Lat,Fat,Bat]);(function(t){zJ(e,t);function e(r,n){n===void 0&&(n=ci);var i=this,o=j1(n);return o.outputCst=!0,i=t.call(this,r,o)||this,i}return e})(Ix);var Vat=function(t){zJ(e,t);function e(r,n){n===void 0&&(n=ci);var i=this,o=j1(n);return o.outputCst=!1,i=t.call(this,r,o)||this,i}return e}(Ix);/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const xV=(t,e)=>({type:t,message:e});var Hr;(function(t){t.LexingError="LexingError",t.ParserError="ParsingError",t.StaticOffsetError="StaticOffsetError",t.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",t.RangeOffsetNotAllowed="RangeOffsetNotAllowed"})(Hr||(Hr={}));var G;(function(t){t.EMPTY="EMPTY",t.NUMBER="NUMBER",t.STRING="STRING",t.MINUS_UNARY_OP="MINUS_UNARY_OP",t.PLUS_UNARY_OP="PLUS_UNARY_OP",t.PERCENT_OP="PERCENT_OP",t.CONCATENATE_OP="CONCATENATE_OP",t.EQUALS_OP="EQUALS_OP",t.NOT_EQUAL_OP="NOT_EQUAL_OP",t.GREATER_THAN_OP="GREATER_THAN_OP",t.LESS_THAN_OP="LESS_THAN_OP",t.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",t.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",t.PLUS_OP="PLUS_OP",t.MINUS_OP="MINUS_OP",t.TIMES_OP="TIMES_OP",t.DIV_OP="DIV_OP",t.POWER_OP="POWER_OP",t.FUNCTION_CALL="FUNCTION_CALL",t.NAMED_EXPRESSION="NAMED_EXPRESSION",t.PARENTHESIS="PARENTHESES",t.CELL_REFERENCE="CELL_REFERENCE",t.CELL_RANGE="CELL_RANGE",t.COLUMN_RANGE="COLUMN_RANGE",t.ROW_RANGE="ROW_RANGE",t.ERROR="ERROR",t.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",t.ARRAY="ARRAY"})(G||(G={}));var Ki;(function(t){t[t.RELATIVE=0]="RELATIVE",t[t.START_ABSOLUTE=1]="START_ABSOLUTE",t[t.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"})(Ki||(Ki={}));const jat=t=>({type:G.EMPTY,leadingWhitespace:t==null?void 0:t.image}),Wat=(t,e)=>({type:G.NUMBER,value:t,leadingWhitespace:e==null?void 0:e.image}),zat=t=>{var e;return{type:G.STRING,value:t.image.slice(1,-1),leadingWhitespace:(e=t.leadingWhitespace)===null||e===void 0?void 0:e.image}},MV=(t,e)=>({type:G.CELL_REFERENCE,reference:t,leadingWhitespace:e==null?void 0:e.image}),NV=(t,e,r,n)=>(xx(t,e,r),{type:G.CELL_RANGE,start:t,end:e,sheetReferenceType:r,leadingWhitespace:n}),Gat=(t,e,r,n)=>(xx(t,e,r),{type:G.COLUMN_RANGE,start:t,end:e,sheetReferenceType:r,leadingWhitespace:n==null?void 0:n.image}),Yat=(t,e,r,n)=>(xx(t,e,r),{type:G.ROW_RANGE,start:t,end:e,sheetReferenceType:r,leadingWhitespace:n==null?void 0:n.image}),Kat=(t,e,r)=>({type:G.CONCATENATE_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),qat=(t,e,r)=>({type:G.EQUALS_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),Xat=(t,e,r)=>({type:G.NOT_EQUAL_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),Qat=(t,e,r)=>({type:G.GREATER_THAN_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),Zat=(t,e,r)=>({type:G.LESS_THAN_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),Jat=(t,e,r)=>({type:G.GREATER_THAN_OR_EQUAL_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),est=(t,e,r)=>({type:G.LESS_THAN_OR_EQUAL_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),tst=(t,e,r)=>({type:G.PLUS_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),rst=(t,e,r)=>({type:G.MINUS_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),nst=(t,e,r)=>({type:G.TIMES_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),ist=(t,e,r)=>({type:G.DIV_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),ost=(t,e,r)=>({type:G.POWER_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),ast=(t,e)=>({type:G.MINUS_UNARY_OP,value:t,leadingWhitespace:e==null?void 0:e.image}),sst=(t,e)=>({type:G.PLUS_UNARY_OP,value:t,leadingWhitespace:e==null?void 0:e.image}),lst=(t,e)=>({type:G.PERCENT_OP,value:t,leadingWhitespace:e==null?void 0:e.image}),ust=(t,e,r,n)=>({type:G.FUNCTION_CALL,procedureName:t,args:e,leadingWhitespace:r==null?void 0:r.image,internalWhitespace:n==null?void 0:n.image}),PV=(t,e,r)=>({type:G.ARRAY,args:t,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:r==null?void 0:r.image}),cst=(t,e)=>({type:G.NAMED_EXPRESSION,expressionName:t,leadingWhitespace:e==null?void 0:e.image}),fst=(t,e,r)=>({type:G.PARENTHESIS,expression:t,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:r==null?void 0:r.image}),Jo=(t,e)=>({type:G.ERROR,error:t,leadingWhitespace:e==null?void 0:e.image}),hf=(t,e,r)=>({type:G.ERROR_WITH_RAW_INPUT,error:e,rawInput:t,leadingWhitespace:r==null?void 0:r.image}),CA=()=>({type:G.ERROR,error:L.parsingError()});function xx(t,e,r){if(t.sheet!==void 0&&e.sheet===void 0||t.sheet===void 0&&e.sheet!==void 0)throw new Error("Start address inconsistent with end address");if(t.sheet===void 0&&r!==Ki.RELATIVE||t.sheet!==void 0&&r===Ki.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function $t(t,e){return(e!=null?e:"")+t}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const GJ={[G.PLUS_OP]:"+",[G.MINUS_OP]:"-",[G.TIMES_OP]:"*",[G.DIV_OP]:"/",[G.CONCATENATE_OP]:"&",[G.POWER_OP]:"^",[G.EQUALS_OP]:"=",[G.NOT_EQUAL_OP]:"<>",[G.GREATER_THAN_OP]:">",[G.GREATER_THAN_OR_EQUAL_OP]:">=",[G.LESS_THAN_OP]:"<",[G.LESS_THAN_OR_EQUAL_OP]:"<="};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const hst=(t,e,r,n)=>({ast:t,relativeDependencies:e,hasVolatileFunction:r,hasStructuralChangeFunction:n});class dst{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,r){const n=f5(r,this.functionRegistry),i=hst(r,n,Bs(r,this.functionRegistry.isFunctionVolatile),Bs(r,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,i),i}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,r){const n=this.cache.get(e);return n!==void 0?n.ast:(this.set(e,r),r)}}const Bs=(t,e)=>{switch(t.type){case G.EMPTY:case G.NUMBER:case G.STRING:case G.ERROR:case G.ERROR_WITH_RAW_INPUT:case G.CELL_REFERENCE:case G.CELL_RANGE:case G.COLUMN_RANGE:case G.ROW_RANGE:case G.NAMED_EXPRESSION:return!1;case G.PERCENT_OP:case G.PLUS_UNARY_OP:case G.MINUS_UNARY_OP:return Bs(t.value,e);case G.CONCATENATE_OP:case G.EQUALS_OP:case G.NOT_EQUAL_OP:case G.LESS_THAN_OP:case G.GREATER_THAN_OP:case G.LESS_THAN_OR_EQUAL_OP:case G.GREATER_THAN_OR_EQUAL_OP:case G.MINUS_OP:case G.PLUS_OP:case G.TIMES_OP:case G.DIV_OP:case G.POWER_OP:return Bs(t.left,e)||Bs(t.right,e);case G.PARENTHESIS:return Bs(t.expression,e);case G.FUNCTION_CALL:return e(t.procedureName)?!0:t.args.some(r=>Bs(r,e));case G.ARRAY:return t.args.some(r=>r.some(n=>Bs(n,e)))}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Q{}Q.DistinctSigns="Distinct signs.";Q.WrongArgNumber="Wrong number of arguments.";Q.EmptyArg="Empty function argument.";Q.EmptyArray="Empty array not allowed.";Q.ArrayDimensions="Array dimensions are not compatible.";Q.NoSpaceForArrayResult="No space for array result.";Q.ValueSmall="Value too small.";Q.ValueLarge="Value too large.";Q.BadCriterion="Incorrect criterion.";Q.RangeManySheets="Range spans more than one sheet.";Q.CellRangeExpected="Cell range expected.";Q.WrongDimension="Wrong range dimension.";Q.ScalarExpected="Cell range not allowed.";Q.NumberCoercion="Value cannot be coerced to number.";Q.NumberExpected="Number argument expected.";Q.IntegerExpected="Value needs to be an integer.";Q.BadMode="Mode not recognized.";Q.DateBounds="Date outside of bounds.";Q.OutOfSheet="Resulting reference is out of the sheet.";Q.WrongType="Wrong type of argument.";Q.NaN="NaN or infinite value encountered.";Q.EqualLength="Ranges need to be of equal length.";Q.Negative="Value cannot be negative.";Q.NotBinary="String does not represent a binary number.";Q.NotOctal="String does not represent an octal number.";Q.NotHex="String does not represent a hexadecimal number.";Q.EndStartPeriod="End period needs to be at least start period.";Q.CellRefExpected="Cell reference expected.";Q.EmptyRange="Empty range not allowed.";Q.BadRef="Address is not correct.";Q.NumberRange="Number-only range expected.";Q.ValueNotFound="Value not found.";Q.ValueBaseLarge="Value in base too large.";Q.ValueBaseSmall="Value in base too small.";Q.ValueBaseLong="Value in base too long.";Q.NegativeLength="Length cannot be negative.";Q.PatternNotFound="Pattern not found.";Q.OneValue="Needs at least one value.";Q.TwoValues="Range needs to contain at least two elements.";Q.ThreeValues="Range needs to contain at least three elements.";Q.IndexBounds="Index out of bounds.";Q.IndexLarge="Index too large.";Q.Formula="Expected formula.";Q.NegativeCount="Count cannot be negative.";Q.ParseError="Parsing error.";Q.SheetRef="Sheet does not exist.";Q.PeriodLong="Period number cannot exceed life length.";Q.InvalidDate="Invalid date.";Q.BitshiftLong="Result of bitshift is too long.";Q.EmptyString="Empty-string argument not allowed.";Q.LengthBounds="Length out of bounds.";Q.NegativeTime="Time cannot be negative.";Q.NoDefault="No default option.";Q.Selector="Selector cannot exceed the number of arguments.";Q.StartEndDate="Start date needs to be earlier than end date.";Q.IncorrectDateTime="String does not represent correct DateTime.";Q.CharacterCodeBounds="Character code out of bounds.";Q.NonZero="Argument cannot be 0.";Q.LessThanOne="Argument cannot be less than 1.";Q.WeekendString="Incorrect weekend bitmask string.";Q.InvalidRoman="Invalid roman numeral.";Q.WrongOrder="Wrong order of values.";Q.ComplexNumberExpected="Complex number expected.";Q.ShouldBeIorJ="Should be 'i' or 'j'.";Q.SizeMismatch="Array dimensions mismatched.";Q.FunctionName=t=>`Function name ${t} not recognized.`;Q.NamedExpressionName=t=>`Named expression ${t} not recognized.`;Q.LicenseKey=t=>`License key is ${t}.`;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class pst{constructor(){this.POSSIBLE_START_CHARACTERS=[...nJ,...vit,Kn,"'","_"],this.cellReferenceRegexp=new RegExp(yit,"y")}match(e,r){this.cellReferenceRegexp.lastIndex=r;const n=this.cellReferenceRegexp.exec(e+"@");return n==null||n[1]==null?null:(n[0]=n[1],n)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class mst{constructor(){this.POSSIBLE_START_CHARACTERS=[...nJ,"_"],this.namedExpressionRegexp=new RegExp(rJ,"y"),this.r1c1CellRefRegexp=new RegExp(`^${tJ}$`)}match(e,r){this.namedExpressionRegexp.lastIndex=r;const n=this.namedExpressionRegexp.exec(e);return n==null||n[0]==null||this.r1c1CellRefRegexp.test(n[0])?null:n}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Nv=Pt({name:"AdditionOp",pattern:pi.NA}),_A=Pt({name:"PlusOp",pattern:/\+/,categories:Nv}),TA=Pt({name:"MinusOp",pattern:/-/,categories:Nv}),c5=Pt({name:"MultiplicationOp",pattern:pi.NA}),YJ=Pt({name:"TimesOp",pattern:/\*/,categories:c5}),KJ=Pt({name:"DivOp",pattern:/\//,categories:c5}),OA=Pt({name:"PowerOp",pattern:/\^/}),qJ=Pt({name:"PercentOp",pattern:/%/}),Al=Pt({name:"BooleanOp",pattern:pi.NA}),AA=Pt({name:"EqualsOp",pattern:/=/,categories:Al}),XJ=Pt({name:"NotEqualOp",pattern:/<>/,categories:Al}),QJ=Pt({name:"GreaterThanOp",pattern:/>/,categories:Al}),ZJ=Pt({name:"LessThanOp",pattern:/</,categories:Al}),JJ=Pt({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:Al}),eee=Pt({name:"LessThanOrEqualOp",pattern:/<=/,categories:Al}),tee=Pt({name:"ConcatenateOp",pattern:/&/}),IA=Pt({name:"LParen",pattern:/\(/}),C2=Pt({name:"RParen",pattern:/\)/}),ree=Pt({name:"ArrayLParen",pattern:/{/}),nee=Pt({name:"ArrayRParen",pattern:/}/}),iee=Pt({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),oee=Pt({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),Pv=Pt({name:"RangeSeparator",pattern:new RegExp(V1)}),Mx=Pt({name:"ColumnRange",pattern:new RegExp(`${tV}${V1}${tV}`)}),Nx=Pt({name:"RowRange",pattern:new RegExp(`${rV}${V1}${rV}`)}),Px=Pt({name:"ProcedureName",pattern:new RegExp(`([${e5}][${px}]*)\\(`)}),VC=new pst,Ys=Pt({name:"CellReference",pattern:VC.match.bind(VC),start_chars_hint:VC.POSSIBLE_START_CHARACTERS,line_breaks:!1}),jC=new mst,aee=Pt({name:"NamedExpression",pattern:jC.match.bind(jC),start_chars_hint:jC.POSSIBLE_START_CHARACTERS,line_breaks:!1}),kx=t=>{const e=t.translationPackage.getFunctionTranslation("OFFSET"),r=t.errorMapping,n=t.translationPackage.buildFunctionMapping(),i=new RegExp(t.ignoreWhiteSpace==="standard"?mit:pit),o=Pt({name:"WhiteSpace",pattern:i}),a=Pt({name:"ArrayRowSep",pattern:t.arrayRowSeparator}),s=Pt({name:"ArrayColSep",pattern:t.arrayColumnSeparator}),l=Pt({name:"NumberLiteral",pattern:new RegExp(`(([${t.decimalSeparator}]\\d+)|(\\d+([${t.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),u=Pt({name:"OffsetProcedureName",pattern:new RegExp(e,"i")});let c,f;t.functionArgSeparator===t.arrayColumnSeparator?(c=s,f=[]):t.functionArgSeparator===t.arrayRowSeparator?(c=a,f=[]):(c=Pt({name:"ArgSeparator",pattern:t.functionArgSeparator}),f=[c]);const h=[o,_A,TA,YJ,KJ,OA,AA,XJ,qJ,JJ,eee,QJ,ZJ,IA,C2,ree,nee,u,Px,Pv,...f,Mx,Nx,l,iee,oee,tee,Al,Nv,c5,Ys,aee,a,s];return{ArgSeparator:c,NumberLiteral:l,OffsetProcedureName:u,ArrayRowSeparator:a,ArrayColSeparator:s,WhiteSpace:o,allTokens:h,errorMapping:r,functionMapping:n,decimalSeparator:t.decimalSeparator,maxColumns:t.maxColumns,maxRows:t.maxRows}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Lf extends Vat{constructor(e,r){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:Uat(jat())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var n;const i=this.CONSUME(Px),o=i.image.toUpperCase().slice(0,-1),a=(n=this.lexerConfig.functionMapping[o])!==null&&n!==void 0?n:o,s=[];let l=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var c;const f=this.CONSUME(this.lexerConfig.ArgSeparator);l.type===G.EMPTY&&(l.leadingWhitespace=(c=f.leadingWhitespace)===null||c===void 0?void 0:c.image),s.push(l),l=this.SUBRULE2(this.booleanExpressionOrEmpty)}),s.push(l),s.length===1&&s[0].type===G.EMPTY&&(s.length=0);const u=this.CONSUME(C2);return ust(a,s,i.leadingWhitespace,u.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{const n=this.CONSUME(aee);return cst(n.image,n.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{const n=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(IA),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{n.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(C2),this.handleOffsetHeuristic(n)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{const n=this.CONSUME(Mx),[i,o]=n.image.split(":"),a=this.ACTION(()=>Zw(this.sheetMapping,i,this.formulaAddress)),s=this.ACTION(()=>Zw(this.sheetMapping,o,this.formulaAddress));if(a===void 0||s===void 0)return Jo(new L(V.REF));if(a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||s.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return hf(n.image,new L(V.NAME),n.leadingWhitespace);if(a.sheet===void 0&&s.sheet!==void 0)return this.parsingError(Hr.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:c}=Lf.fixSheetIdsForRangeEnds(a,s);return Gat(l,u,c,n.leadingWhitespace)}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{const n=this.CONSUME(Nx),[i,o]=n.image.split(":"),a=this.ACTION(()=>Jw(this.sheetMapping,i,this.formulaAddress)),s=this.ACTION(()=>Jw(this.sheetMapping,o,this.formulaAddress));if(a===void 0||s===void 0)return Jo(new L(V.REF));if(a.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||s.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return hf(n.image,new L(V.NAME),n.leadingWhitespace);if(a.sheet===void 0&&s.sheet!==void 0)return this.parsingError(Hr.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:c}=Lf.fixSheetIdsForRangeEnds(a,s);return Yat(l,u,c,n.leadingWhitespace)}),this.cellReference=this.RULE("cellReference",()=>{const n=this.CONSUME(Ys),i=this.ACTION(()=>Tf(this.sheetMapping,n.image,this.formulaAddress));return i===void 0?hf(n.image,new L(V.REF),n.leadingWhitespace):i.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?hf(n.image,new L(V.NAME),n.leadingWhitespace):MV(i,n.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",n=>{var i;const o=this.CONSUME(Ys),a=this.ACTION(()=>Tf(this.sheetMapping,n.image,this.formulaAddress)),s=this.ACTION(()=>Tf(this.sheetMapping,o.image,this.formulaAddress));return a===void 0||s===void 0?this.ACTION(()=>hf(`${n.image}:${o.image}`,new L(V.REF),n.leadingWhitespace)):a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||s.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>hf(`${n.image}:${o.image}`,new L(V.NAME),n.leadingWhitespace)):this.buildCellRange(a,s,(i=n.leadingWhitespace)===null||i===void 0?void 0:i.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",n=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[n]})},{ALT:()=>{var i;const o=this.SUBRULE(this.offsetProcedureExpression),a=this.ACTION(()=>Tf(this.sheetMapping,n.image,this.formulaAddress));return a===void 0?Jo(new L(V.REF)):o.type===G.CELL_REFERENCE?this.buildCellRange(a,o.reference,(i=n.leadingWhitespace)===null||i===void 0?void 0:i.image):this.parsingError(Hr.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{const n=this.CONSUME(Ys);return this.CONSUME2(Pv),this.SUBRULE(this.endOfRangeExpression,{ARGS:[n]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",n=>{const i=this.CONSUME(Ys),o=this.ACTION(()=>Tf(this.sheetMapping,i.image,this.formulaAddress));return o===void 0?this.ACTION(()=>Jo(new L(V.REF))):this.buildCellRange(n.reference,o,n.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",n=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[n]})},{ALT:()=>{const i=this.SUBRULE(this.offsetProcedureExpression);return i.type===G.CELL_REFERENCE?this.buildCellRange(n.reference,i.reference,n.leadingWhitespace):this.parsingError(Hr.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{const n=this.SUBRULE(this.offsetProcedureExpression);let i;return this.OPTION(()=>{this.CONSUME(Pv),n.type===G.CELL_RANGE?i=this.parsingError(Hr.RangeOffsetNotAllowed,"Range offset not allowed here"):i=this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[n]})}),i!==void 0?i:n}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{const n=[[]];return n[n.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),n[n.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),n.push([]),n[n.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),PV(n)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{const n=this.CONSUME(IA),i=this.SUBRULE(this.booleanExpression),o=this.CONSUME(C2);return fst(i,n.leadingWhitespace,o.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{const n=this.CONSUME(ree),i=this.SUBRULE(this.insideArrayExpression),o=this.CONSUME(nee);return PV(i.args,n.leadingWhitespace,o.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=n=>{const i=n.replace(this.lexerConfig.decimalSeparator,".");return Number(i)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var n;return this.OR((n=this.atomicExpCache)!==null&&n!==void 0?n:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const i=this.CONSUME(this.lexerConfig.NumberLiteral);return Wat(this.numericStringToNumber(i.image),i.leadingWhitespace)}},{ALT:()=>{const i=this.CONSUME(iee);return zat(i)}},{ALT:()=>{const i=this.CONSUME(oee),o=i.image.toUpperCase(),a=this.lexerConfig.errorMapping[o];return a?Jo(new L(a),i.leadingWhitespace):this.parsingError(Hr.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{const n=this.SUBRULE(this.positiveAtomicExpression),i=this.OPTION(()=>this.CONSUME(qJ));return i?lst(n,i.leadingWhitespace):n}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{const n=this.CONSUME(Nv),i=this.SUBRULE(this.atomicExpression);return Yt(n,_A)?sst(i,n.leadingWhitespace):Yt(n,TA)?ast(i,n.leadingWhitespace):(this.customParsingError=xV(Hr.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let n=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{const i=this.CONSUME(OA),o=this.SUBRULE2(this.atomicExpression);Yt(i,OA)?n=ost(n,o,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let n=this.SUBRULE(this.powerExpression);return this.MANY(()=>{const i=this.CONSUME(c5),o=this.SUBRULE2(this.powerExpression);Yt(i,YJ)?n=nst(n,o,i.leadingWhitespace):Yt(i,KJ)?n=ist(n,o,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.additionExpression=this.RULE("additionExpression",()=>{let n=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{const i=this.CONSUME(Nv),o=this.SUBRULE2(this.multiplicationExpression);Yt(i,_A)?n=tst(n,o,i.leadingWhitespace):Yt(i,TA)?n=rst(n,o,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let n=this.SUBRULE(this.additionExpression);return this.MANY(()=>{const i=this.CONSUME(tee),o=this.SUBRULE2(this.additionExpression);n=Kat(n,o,i.leadingWhitespace)}),n}),this.booleanExpression=this.RULE("booleanExpression",()=>{let n=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{const i=this.CONSUME(Al),o=this.SUBRULE2(this.concatenateExpression);Yt(i,AA)?n=qat(n,o,i.leadingWhitespace):Yt(i,XJ)?n=Xat(n,o,i.leadingWhitespace):Yt(i,QJ)?n=Qat(n,o,i.leadingWhitespace):Yt(i,ZJ)?n=Zat(n,o,i.leadingWhitespace):Yt(i,JJ)?n=Jat(n,o,i.leadingWhitespace):Yt(i,eee)?n=est(n,o,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.formula=this.RULE("formula",()=>(this.CONSUME(AA),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.sheetMapping=r,this.formulaAddress=Le(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,r){this.input=e;let n=this.formulaWithContext(r),i=[];return this.customParsingError&&i.push(this.customParsingError),i=i.concat(this.errors.map(o=>({type:Hr.ParserError,message:o.message}))),i.length>0&&(n=CA()),{ast:n,errors:i}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,r,n){if(e.sheet===void 0&&r.sheet!==void 0)return this.parsingError(Hr.ParserError,"Malformed range expression");const{firstEnd:i,secondEnd:o,sheetRefType:a}=Lf.fixSheetIdsForRangeEnds(e,r);return NV(i,o,a,n)}static fixSheetIdsForRangeEnds(e,r){const n=Lf.rangeSheetReferenceType(e.sheet,r.sheet),i=e.sheet!==void 0&&r.sheet===void 0?r.withSheet(e.sheet):r;return{firstEnd:e,secondEnd:i,sheetRefType:n}}handleOffsetHeuristic(e){const r=e[0];if(r.type!==G.CELL_REFERENCE)return this.parsingError(Hr.StaticOffsetError,"First argument to OFFSET is not a reference");const n=e[1];let i;if(n.type===G.NUMBER&&Number.isInteger(n.value))i=n.value;else if(n.type===G.PLUS_UNARY_OP&&n.value.type===G.NUMBER&&Number.isInteger(n.value.value))i=n.value.value;else if(n.type===G.MINUS_UNARY_OP&&n.value.type===G.NUMBER&&Number.isInteger(n.value.value))i=-n.value.value;else return this.parsingError(Hr.StaticOffsetError,"Second argument to OFFSET is not a static number");const o=e[2];let a;if(o.type===G.NUMBER&&Number.isInteger(o.value))a=o.value;else if(o.type===G.PLUS_UNARY_OP&&o.value.type===G.NUMBER&&Number.isInteger(o.value.value))a=o.value.value;else if(o.type===G.MINUS_UNARY_OP&&o.value.type===G.NUMBER&&Number.isInteger(o.value.value))a=-o.value.value;else return this.parsingError(Hr.StaticOffsetError,"Third argument to OFFSET is not a static number");const s=e[3];let l;if(s===void 0)l=1;else if(s.type===G.NUMBER){if(l=s.value,l<1)return this.parsingError(Hr.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(l))return this.parsingError(Hr.StaticOffsetError,"Fourth argument to OFFSET is not integer")}else return this.parsingError(Hr.StaticOffsetError,"Fourth argument to OFFSET is not a static number");const u=e[4];let c;if(u===void 0)c=1;else if(u.type===G.NUMBER){if(c=u.value,c<1)return this.parsingError(Hr.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(c))return this.parsingError(Hr.StaticOffsetError,"Fifth argument to OFFSET is not integer")}else return this.parsingError(Hr.StaticOffsetError,"Fifth argument to OFFSET is not a static number");const f=new Kt(r.reference.col+a,r.reference.row+i,r.reference.type);let h=f.col,d=f.row;if((r.reference.type===zt.CELL_REFERENCE_RELATIVE||r.reference.type===zt.CELL_REFERENCE_ABSOLUTE_COL)&&(d=d+this.formulaAddress.row),(r.reference.type===zt.CELL_REFERENCE_RELATIVE||r.reference.type===zt.CELL_REFERENCE_ABSOLUTE_ROW)&&(h=h+this.formulaAddress.col),h<0||d<0)return Jo(new L(V.REF,Q.OutOfSheet));if(c===1&&l===1)return MV(f);{const p=new Kt(f.col+c-1,f.row+l-1,f.type);return NV(f,p,Ki.RELATIVE)}}parsingError(e,r){return this.customParsingError=xV(e,r),CA()}static rangeSheetReferenceType(e,r){return e===void 0?Ki.RELATIVE:r===void 0?Ki.START_ABSOLUTE:Ki.BOTH_ABSOLUTE}}class fS{constructor(e){this.lexerConfig=e,this.lexer=new pi(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const r=this.lexer.tokenize(e);let n=r.tokens;return n=this.trimTrailingWhitespaces(n),n=this.skipWhitespacesInsideRanges(n),n=this.skipWhitespacesBeforeArgSeparators(n),r.tokens=n,r}skipWhitespacesInsideRanges(e){return fS.filterTokensByNeighbors(e,(r,n,i)=>(Yt(r,Ys)||Yt(r,Pv))&&Yt(n,this.lexerConfig.WhiteSpace)&&(Yt(i,Ys)||Yt(i,Pv)))}skipWhitespacesBeforeArgSeparators(e){return fS.filterTokensByNeighbors(e,(r,n,i)=>!Yt(r,this.lexerConfig.ArgSeparator)&&Yt(n,this.lexerConfig.WhiteSpace)&&Yt(i,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,r){if(e.length<3)return e;let n=0;const i=[e[n++]];for(;n<e.length-1;)r(e[n-1],e[n],e[n+1])||i.push(e[n]),++n;return i.push(e[n]),i}trimTrailingWhitespaces(e){return e.length>0&&Yt(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class see{constructor(e,r,n,i){this.config=e,this.lexerConfig=r,this.sheetMappingFn=n,this.namedExpressions=i}unparse(e,r){return"="+this.unparseAst(e,r)}unparseAst(e,r){var n,i;switch(e.type){case G.EMPTY:return $t("",e.leadingWhitespace);case G.NUMBER:return $t(lee(e.value,this.config.decimalSeparator),e.leadingWhitespace);case G.STRING:return $t('"'+e.value+'"',e.leadingWhitespace);case G.FUNCTION_CALL:{const o=e.args.map(l=>l!==void 0?this.unparseAst(l,r):"").join(this.config.functionArgSeparator),s=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+o+$t(")",e.internalWhitespace);return $t(s,e.leadingWhitespace)}case G.NAMED_EXPRESSION:{const o=(n=this.namedExpressions.nearestNamedExpression(e.expressionName,r.sheet))===null||n===void 0?void 0:n.displayName;return $t(o||e.expressionName,e.leadingWhitespace)}case G.CELL_REFERENCE:{let o;return e.reference.sheet!==void 0?o=this.unparseSheetName(e.reference.sheet)+"!":o="",o+=(i=e.reference.unparse(r))!==null&&i!==void 0?i:this.config.translationPackage.getErrorTranslation(V.REF),$t(o,e.leadingWhitespace)}case G.COLUMN_RANGE:case G.ROW_RANGE:case G.CELL_RANGE:return $t(this.formatRange(e,r),e.leadingWhitespace);case G.PLUS_UNARY_OP:{const o=this.unparseAst(e.value,r);return $t("+",e.leadingWhitespace)+o}case G.MINUS_UNARY_OP:{const o=this.unparseAst(e.value,r);return $t("-",e.leadingWhitespace)+o}case G.PERCENT_OP:return this.unparseAst(e.value,r)+$t("%",e.leadingWhitespace);case G.ERROR:{const o=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:V.ERROR);return $t(o,e.leadingWhitespace)}case G.ERROR_WITH_RAW_INPUT:return $t(e.rawInput,e.leadingWhitespace);case G.PARENTHESIS:{const a="("+this.unparseAst(e.expression,r)+$t(")",e.internalWhitespace);return $t(a,e.leadingWhitespace)}case G.ARRAY:{const o="{"+e.args.map(a=>a.map(s=>this.unparseAst(s,r)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+$t("}",e.internalWhitespace);return $t(o,e.leadingWhitespace)}default:{const o=this.unparseAst(e.left,r),a=this.unparseAst(e.right,r);return o+$t(GJ[e.type],e.leadingWhitespace)+a}}}unparseSheetName(e){const r=oJ(e,this.sheetMappingFn);if(r===void 0)throw new yr(e);return r}formatRange(e,r){let n="",i="";e.start.sheet!==void 0&&e.sheetReferenceType!==Ki.RELATIVE&&(n=this.unparseSheetName(e.start.sheet)+"!"),e.end.sheet!==void 0&&e.sheetReferenceType===Ki.BOTH_ABSOLUTE&&(i=this.unparseSheetName(e.end.sheet)+"!");const o=e.start.unparse(r),a=e.end.unparse(r);return o===void 0||a===void 0?this.config.translationPackage.getErrorTranslation(V.REF):`${n}${o}:${i}${a}`}}function lee(t,e){return t.toString().replace(".",e)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class hg{constructor(e,r,n){this.config=e,this.functionRegistry=r,this.sheetMapping=n,this.statsCacheUsed=0,this.lexerConfig=kx(e),this.lexer=new fS(this.lexerConfig),this.formulaParser=new Lf(this.lexerConfig,this.sheetMapping),this.cache=new dst(this.functionRegistry)}parse(e,r){this.formulaAddress=r;const n=this.tokenizeFormula(e);if(n.errors.length>0){const f=n.errors.map(h=>({type:Hr.LexingError,message:h.message}));return{ast:CA(),errors:f,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const i=this.computeHashFromTokens(n.tokens,r);let o=this.cache.get(i);if(o!==void 0)++this.statsCacheUsed;else{const f=this.bindWhitespacesToTokens(n.tokens),h=this.formulaParser.parseFromTokens(f,r);if(h.errors.length>0)return Object.assign(Object.assign({},h),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});o=this.cache.set(i,h.ast)}const{ast:a,hasVolatileFunction:s,hasStructuralChangeFunction:l}=o,u=this.convertReversedRangesToRegularRanges(a),c=f5(u,this.functionRegistry);return{ast:u,errors:[],hasVolatileFunction:s,hasStructuralChangeFunction:l,dependencies:c}}convertReversedRangesToRegularRanges(e){switch(e.type){case G.EMPTY:case G.NUMBER:case G.STRING:case G.ERROR:case G.ERROR_WITH_RAW_INPUT:case G.CELL_REFERENCE:case G.NAMED_EXPRESSION:return e;case G.CELL_RANGE:{const{start:r,end:n}=e,i=this.orderCellRangeEnds(r,n);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case G.COLUMN_RANGE:{const{start:r,end:n}=e,i=this.orderColumnRangeEnds(r,n);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case G.ROW_RANGE:{const{start:r,end:n}=e,i=this.orderRowRangeEnds(r,n);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case G.PERCENT_OP:case G.PLUS_UNARY_OP:case G.MINUS_UNARY_OP:{const r=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:r})}case G.CONCATENATE_OP:case G.EQUALS_OP:case G.NOT_EQUAL_OP:case G.LESS_THAN_OP:case G.GREATER_THAN_OP:case G.LESS_THAN_OR_EQUAL_OP:case G.GREATER_THAN_OR_EQUAL_OP:case G.MINUS_OP:case G.PLUS_OP:case G.TIMES_OP:case G.DIV_OP:case G.POWER_OP:{const r=this.convertReversedRangesToRegularRanges(e.left),n=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:r,right:n})}case G.PARENTHESIS:{const r=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:r})}case G.FUNCTION_CALL:{const r=e.args.map(n=>this.convertReversedRangesToRegularRanges(n));return Object.assign(Object.assign({},e),{args:r})}case G.ARRAY:{const r=e.args.map(n=>n.map(i=>this.convertReversedRangesToRegularRanges(i)));return Object.assign(Object.assign({},e),{args:r})}}}orderCellRangeEnds(e,r){const n=[e,r],[i,o]=n.map(c=>c.toColumnAddress()).sort(Yn.compareByAbsoluteAddress(this.formulaAddress)),[a,s]=n.map(c=>c.toRowAddress()).sort($n.compareByAbsoluteAddress(this.formulaAddress)),[l,u]=n.map(c=>c.sheet).sort(hg.compareSheetIds.bind(this));return{start:Kt.fromColAndRow(i,a,l),end:Kt.fromColAndRow(o,s,u)}}orderColumnRangeEnds(e,r){const n=[e,r],[i,o]=n.sort(Yn.compareByAbsoluteAddress(this.formulaAddress)),[a,s]=n.map(l=>l.sheet).sort(hg.compareSheetIds.bind(this));return{start:new Yn(i.type,i.col,a),end:new Yn(o.type,o.col,s)}}orderRowRangeEnds(e,r){const n=[e,r],[i,o]=n.sort($n.compareByAbsoluteAddress(this.formulaAddress)),[a,s]=n.map(l=>l.sheet).sort(hg.compareSheetIds.bind(this));return{start:new $n(i.type,i.row,a),end:new $n(o.type,o.row,s)}}static compareSheetIds(e,r){return e=e!=null?e:1/0,r=r!=null?r:1/0,e-r}fetchCachedResultForAst(e){const r=this.computeHashFromAst(e);return this.fetchCachedResult(r)}fetchCachedResult(e){const r=this.cache.get(e);if(r===void 0)throw new Error("There is no AST with such key in the cache");{const{ast:n,hasVolatileFunction:i,hasStructuralChangeFunction:o,relativeDependencies:a}=r;return{ast:n,errors:[],hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:a}}}computeHashFromTokens(e,r){var n;let i="",o=0;for(;o<e.length;){const a=e[o];if(Yt(a,Ys)){const s=Tf(this.sheetMapping,a.image,r);s===void 0?i=i.concat(a.image):i=i.concat(s.hash(!0))}else if(Yt(a,Px)){const s=a.image.toUpperCase().slice(0,-1),l=(n=this.lexerConfig.functionMapping[s])!==null&&n!==void 0?n:s;i=i.concat(l,"(")}else if(Yt(a,Mx)){const[s,l]=a.image.split(":"),u=Zw(this.sheetMapping,s,r),c=Zw(this.sheetMapping,l,r);u===void 0||c===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",c.hash(!0))}else if(Yt(a,Nx)){const[s,l]=a.image.split(":"),u=Jw(this.sheetMapping,s,r),c=Jw(this.sheetMapping,l,r);u===void 0||c===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",c.hash(!0))}else i=i.concat(a.image);o++}return i}rememberNewAst(e){const r=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(r,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case G.EMPTY:return e.leadingWhitespace||"";case G.NUMBER:return $t(lee(e.value,this.config.decimalSeparator),e.leadingWhitespace);case G.STRING:return $t('"'+e.value+'"',e.leadingWhitespace);case G.NAMED_EXPRESSION:return $t(e.expressionName,e.leadingWhitespace);case G.FUNCTION_CALL:{const r=e.args.map(i=>this.computeHashOfAstNode(i)).join(this.config.functionArgSeparator),n=e.procedureName+"("+r+$t(")",e.internalWhitespace);return $t(n,e.leadingWhitespace)}case G.CELL_REFERENCE:return $t(e.reference.hash(!0),e.leadingWhitespace);case G.COLUMN_RANGE:case G.ROW_RANGE:case G.CELL_RANGE:{const r=e.start.hash(e.sheetReferenceType!==Ki.RELATIVE),n=e.end.hash(e.sheetReferenceType===Ki.BOTH_ABSOLUTE);return $t(r+":"+n,e.leadingWhitespace)}case G.MINUS_UNARY_OP:return $t("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case G.PLUS_UNARY_OP:return $t("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case G.PERCENT_OP:return this.computeHashOfAstNode(e.value)+$t("%",e.leadingWhitespace);case G.ERROR:{const r=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:V.ERROR);return $t(r,e.leadingWhitespace)}case G.ERROR_WITH_RAW_INPUT:return $t(e.rawInput,e.leadingWhitespace);case G.ARRAY:{const r=e.args.map(n=>n.map(i=>this.computeHashOfAstNode(i)).join(",")).join(";");return $t("{"+r+$t("}",e.internalWhitespace),e.leadingWhitespace)}case G.PARENTHESIS:{const n="("+this.computeHashOfAstNode(e.expression)+$t(")",e.internalWhitespace);return $t(n,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+$t(GJ[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const r=[],n=e[0];Yt(n,this.lexerConfig.WhiteSpace)||r.push(n);for(let i=1;i<e.length;++i){const o=e[i];if(Yt(o,this.lexerConfig.WhiteSpace))continue;const a=e[i-1];Yt(a,this.lexerConfig.WhiteSpace)&&(o.leadingWhitespace=a),r.push(o)}return r}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Of=(t,e,r,n)=>{switch(t.type){case G.EMPTY:case G.NUMBER:case G.STRING:case G.ERROR:return;case G.NAMED_EXPRESSION:{n&&r.push(new Ks(t.expressionName));return}case G.CELL_REFERENCE:{n&&r.push(new uee(t.reference));return}case G.CELL_RANGE:{n&&t.start.sheet===t.end.sheet&&r.push(new gst(t.start,t.end));return}case G.COLUMN_RANGE:{n&&t.start.sheet===t.end.sheet&&r.push(new yst(t.start,t.end));return}case G.ROW_RANGE:{n&&t.start.sheet===t.end.sheet&&r.push(new vst(t.start,t.end));return}case G.PERCENT_OP:case G.PLUS_UNARY_OP:case G.MINUS_UNARY_OP:{Of(t.value,e,r,!0);return}case G.CONCATENATE_OP:case G.EQUALS_OP:case G.NOT_EQUAL_OP:case G.LESS_THAN_OP:case G.GREATER_THAN_OP:case G.LESS_THAN_OR_EQUAL_OP:case G.GREATER_THAN_OR_EQUAL_OP:case G.MINUS_OP:case G.PLUS_OP:case G.TIMES_OP:case G.DIV_OP:case G.POWER_OP:Of(t.left,e,r,!0),Of(t.right,e,r,!0);return;case G.PARENTHESIS:Of(t.expression,e,r,n);return;case G.FUNCTION_CALL:{const i=!e.doesFunctionNeedArgumentToBeComputed(t.procedureName);t.args.forEach(o=>Of(o,e,r,i));return}}},f5=(t,e)=>{const r=new Array;return Of(t,e,r,!0),r};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class uee{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class gst{constructor(e,r){this.start=e,this.end=r}absolutize(e){return new ze(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class yst{constructor(e,r){this.start=e,this.end=r}absolutize(e){const r=this.start.toSimpleColumnAddress(e),n=this.end.toSimpleColumnAddress(e);return new gs(r.sheet,r.col,n.col)}}class vst{constructor(e,r){this.start=e,this.end=r}absolutize(e){const r=this.start.toSimpleRowAddress(e),n=this.end.toSimpleRowAddress(e);return new ys(r.sheet,r.row,n.row)}}class Ks{constructor(e){this.name=e}absolutize(e){return this}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const ea=(t,e)=>t.map(r=>r.absolutize(e)),bst=t=>t.filter(e=>e instanceof Ks?!0:e instanceof ze?!(fi(e.start)||fi(e.end)):!fi(e));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Tt=Symbol("Empty value");function Ne(t){return t instanceof wa?t.val:t}class wa{constructor(e,r){this.val=e,this.format=r}fromNumber(e){return new this.constructor(e)}}function $x(t,e){if(typeof t=="number")return e;{const r=t.fromNumber(e);return r.format=t.format,r}}class Lx extends wa{getDetailedType(){return Be.NUMBER_DATE}}class xA extends wa{getDetailedType(){return Be.NUMBER_CURRENCY}}class Dx extends wa{getDetailedType(){return Be.NUMBER_TIME}}class Fx extends wa{getDetailedType(){return Be.NUMBER_DATETIME}}class _2 extends wa{getDetailedType(){return Be.NUMBER_PERCENT}}function Ft(t){return typeof t=="number"||t instanceof wa}var Be;(function(t){t.NUMBER_RAW="NUMBER_RAW",t.NUMBER_DATE="NUMBER_DATE",t.NUMBER_TIME="NUMBER_TIME",t.NUMBER_DATETIME="NUMBER_DATETIME",t.NUMBER_CURRENCY="NUMBER_CURRENCY",t.NUMBER_PERCENT="NUMBER_PERCENT"})(Be||(Be={}));function wst(t){return t instanceof wa?t.getDetailedType():Be.NUMBER_RAW}function Sst(t){if(t instanceof wa)return t.format}function hS(t){return t instanceof wa?{type:t.getDetailedType(),format:t.format}:{type:Be.NUMBER_RAW}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class je{constructor(e,r,n,i){this._data=e,this.range=r,this.dependencyGraph=n,this._hasOnlyNumbers=i,this.size=e===void 0?new yt(r.effectiveWidth(n),r.effectiveHeight(n)):new yt(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,r,n){return new je(e,r,n,!0)}static onlyNumbers(e){return new je(e,void 0,void 0,!0)}static onlyValues(e){return new je(e,void 0,void 0,void 0)}static onlyRange(e,r){return new je(void 0,e,r,void 0)}static fromScalar(e){return new je([[e]],void 0,void 0,void 0)}isAdHoc(){return this.range===void 0}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let r=0;r<this._data.length;r++)for(let n=0;n<this._data[0].length;n++)e.push(this._data[r][n]);return e}*effectiveAddressesFromData(e){for(let r=0;r<this.data.length;++r){const n=this.data[r];for(let i=0;i<n.length;++i)yield Le(e.sheet,e.col+i,e.row+r)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let r=0;r<this.size.height;++r)for(let n=0;n<this.size.width;++n)yield[this._data[r][n],Le(e.sheet,e.col+n,e.row+r)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(this._hasOnlyNumbers===void 0){this._hasOnlyNumbers=!0;for(const e of this.data)for(const r of e)if(typeof r!="number")return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),(e=this._data)!==null&&e!==void 0?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){this._data===void 0&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{const r=this.dependencyGraph.getCellValue(e);return r instanceof je?(this._hasOnlyNumbers=!1,new L(V.VALUE,Q.ScalarExpected)):(Ft(r)||(this._hasOnlyNumbers=!1),r)}))}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class hl{constructor(){this.changes=new Map}static empty(){return new hl}addAll(e){for(const r of e.changes.values())this.add(r.address,r);return this}addChange(e,r,n){this.addInterpreterValue(e,r,n)}exportChanges(e){let r=[];return this.changes.forEach(n=>{const i=e.exportChange(n);Array.isArray(i)?r=r.concat(i):r.push(i)}),r}getChanges(){return Array.from(this.changes.values())}isEmpty(){return this.changes.size===0}add(e,r){const n=r.value;if(n instanceof je)for(const i of n.effectiveAddressesFromData(e))this.changes.delete(`${i.sheet},${i.col},${i.row}`);this.changes.set(O2(e),r)}addInterpreterValue(e,r,n){this.add(r,{address:r,value:e,oldValue:n})}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class di{constructor(e,r,n){if(this.sheet=e,this.rowStart=r,this.rowEnd=n,r<0)throw Error("Starting row cant be less than 0");if(n<r)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,r,n){return new di(e,r,r+n-1)}static fromRowStartAndEnd(e,r,n){return new di(e,r,n)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const r=Math.max(this.rowStart,e.rowStart),n=Math.min(this.rowEnd,e.rowEnd);return r>n?null:new di(this.sheet,r,n)}firstRow(){return new di(this.sheet,this.rowStart,this.rowStart)}}class xi{constructor(e,r,n){if(this.sheet=e,this.columnStart=r,this.columnEnd=n,r<0)throw Error("Starting column cant be less than 0");if(n<r)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,r,n){return new xi(e,r,r+n-1)}static fromColumnStartAndEnd(e,r,n){return new xi(e,r,n)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const r=Math.max(this.columnStart,e.columnStart),n=Math.min(this.columnEnd,e.columnEnd);return r>n?null:new xi(this.sheet,r,n)}firstColumn(){return new xi(this.sheet,this.columnStart,this.columnStart)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var ot;(function(t){t.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",t.PARSER="PARSER",t.GRAPH_BUILD="GRAPH_BUILD",t.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",t.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",t.TOP_SORT="TOP_SORT",t.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",t.EVALUATION="EVALUATION",t.VLOOKUP="VLOOKUP",t.TRANSFORM_ASTS="TRANSFORM_ASTS",t.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",t.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",t.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",t.ADJUSTING_RANGES="ADJUSTING_RANGES",t.ADJUSTING_GRAPH="ADJUSTING_GRAPH",t.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",t.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(ot||(ot={}));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class cee{constructor(){this.stats=new Map([[ot.CRITERION_FUNCTION_FULL_CACHE_USED,0],[ot.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const r=((e=this.stats.get(ot.CRITERION_FUNCTION_FULL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(ot.CRITERION_FUNCTION_FULL_CACHE_USED,r)}incrementCriterionFunctionPartialCacheUsed(){var e;const r=((e=this.stats.get(ot.CRITERION_FUNCTION_PARTIAL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(ot.CRITERION_FUNCTION_PARTIAL_CACHE_USED,r)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(ot.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(ot.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var r;const n=Date.now(),i=this.startTimes.get(e);if(i){let o=(r=this.stats.get(e))!==null&&r!==void 0?r:0;o+=n-i,this.stats.set(e,o),this.startTimes.delete(e)}else throw Error(`Statistics ${e} not started`)}measure(e,r){this.start(e);const n=r();return this.end(e),n}snapshot(){return new Map(this.stats)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Rst extends cee{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class yr extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class fee extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class kv extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class Vu extends Error{constructor(){super("Sheet size limit exceeded")}}class MA extends Error{constructor(){super("This is not a formula")}}class hee extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class Qr extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class $v extends Error{constructor(e,r){super(`Sheets ${e} and ${r} are not equal.`)}}class dee extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class pee extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class Lv extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class mee extends Error{constructor(){super("There is no operation to undo")}}class gee extends Error{constructor(){super("There is no operation to redo")}}class yee extends Error{constructor(){super("There is nothing to paste")}}function Est(t,e){switch(typeof e){case"function":case"symbol":return e.toString();case"bigint":return"BigInt("+e.toString()+")";default:return e instanceof RegExp?"RegExp("+e.toString()+")":e}}class vee extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,Est,4)}`)}}class Bt extends Error{constructor(e,r){super(`Expected value of type: ${e} for config parameter: ${r}`)}}class Cst extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class bee extends Error{constructor(e,r){super(`Config parameter ${e} should be at least ${r}`)}}class wee extends Error{constructor(e,r){super(`Config parameter ${e} should be at most ${r}`)}}class See extends Error{constructor(e,r){super(`Expected one of ${e} for config parameter: ${r}`)}}class Ree extends Error{constructor(){super("Computations are suspended")}}class Af extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class Eee extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class NA extends Error{constructor(){super("Language not registered.")}}class Cee extends Error{constructor(){super("Language already registered.")}}class yp extends Error{static functionNotDeclaredInPlugin(e,r){return new yp(`Function with id ${e} not declared in plugin ${r}`)}static functionMethodNotFound(e,r){return new yp(`Function method ${e} not found in plugin ${r}`)}}class ju extends Error{static cannotRegisterFunctionWithId(e){return new ju(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new ju(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new ju("Cannot unregister protected plugin")}}class Df extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class dS extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class Hx extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class _st extends Error{constructor(e,r){super(`Alias id ${e} in plugin ${r} already defined as a function or alias.`)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Tst{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const r=this.mapping.get(e.sheet);if(r===void 0)throw new yr(e.sheet);return r.getCell(e)}fetchCell(e){const r=this.mapping.get(e.sheet);if(r===void 0)throw new yr(e.sheet);const n=r.getCell(e);if(!n)throw Error("Vertex for address missing in AddressMapping");return n}strategyFor(e){const r=this.mapping.get(e);if(r===void 0)throw new yr(e);return r}addSheet(e,r){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,r)}autoAddSheet(e,r,n){const{height:i,width:o,fill:a}=n,s=this.policy.call(a);this.addSheet(e,new s(o,i))}getCellValue(e){const r=this.getCell(e);return r===void 0?Tt:r instanceof xr?r.getArrayCellValue(e):r.getCellValue()}getRawValue(e){const r=this.getCell(e);return r instanceof dl?r.getValues().rawValue:r instanceof xr?r.getArrayCellRawValue(e):null}setCell(e,r){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized");n.setCell(e,r)}moveCell(e,r){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized.");if(e.sheet!==r.sheet)throw Error("Cannot move cells between sheets.");if(n.has(r))throw new Error("Cannot move cell. Destination already occupied.");const i=n.getCell(e);if(i===void 0)throw new Error("Cannot move cell. No cell with such address.");this.setCell(r,i),this.removeCell(e)}removeCell(e){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.removeCell(e)}has(e){const r=this.mapping.get(e.sheet);return r===void 0?!1:r.has(e)}getHeight(e){const r=this.mapping.get(e);if(r===void 0)throw new yr(e);return r.getHeight()}getWidth(e){const r=this.mapping.get(e);if(!r)throw new yr(e);return r.getWidth()}addRows(e,r,n){const i=this.mapping.get(e);if(i===void 0)throw new yr(e);i.addRows(r,n)}removeRows(e){const r=this.mapping.get(e.sheet);if(r===void 0)throw new yr(e.sheet);r.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,r,n){const i=this.mapping.get(e);if(i===void 0)throw new yr(e);i.addColumns(r,n)}removeColumns(e){const r=this.mapping.get(e.sheet);if(r===void 0)throw new yr(e.sheet);r.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,r]of this.mapping.entries())yield*r.getEntries(e)}*sheetEntries(e){const r=this.mapping.get(e);if(r!==void 0)yield*r.getEntries(e);else throw new yr(e)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ost{constructor(){this.arrayMapping=new Map}getArray(e){const r=this.getArrayByCorner(e.start);if(r!=null&&r.getRange().sameAs(e))return r}getArrayByCorner(e){return this.arrayMapping.get(O2(e))}setArray(e,r){this.arrayMapping.set(O2(e.start),r)}removeArray(e){typeof e=="string"?this.arrayMapping.delete(e):this.arrayMapping.delete(O2(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[r,n]of this.arrayMapping.entries())n.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[r,n])}*arraysInCols(e){for(const[r,n]of this.arrayMapping.entries())n.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[r,n])}isFormulaArrayInRow(e,r){for(const n of this.arrayMapping.values())if(n.spansThroughSheetRows(e,r))return!0;return!1}isFormulaArrayInAllRows(e){let r=!0;for(const n of e.rows())this.isFormulaArrayInRow(e.sheet,n)||(r=!1);return r}isFormulaArrayInColumn(e,r){for(const n of this.arrayMapping.values())if(n.spansThroughSheetColumn(e,r))return!0;return!1}isFormulaArrayInAllColumns(e){let r=!0;for(const n of e.columns())this.isFormulaArrayInColumn(e.sheet,n)||(r=!1);return r}isFormulaArrayInRange(e){for(const r of this.arrayMapping.values())if(r.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const r of this.arrayMapping.values())if(r.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,r,n){this.updateArrayVerticesInSheet(e,(i,o)=>{const a=o.getRange();return r<=a.start.row?[a.shifted(0,n),o]:void 0})}moveArrayVerticesAfterColumnByColumns(e,r,n){this.updateArrayVerticesInSheet(e,(i,o)=>{const a=o.getRange();return r<=a.start.col?[a.shifted(n,0),o]:void 0})}updateArrayVerticesInSheet(e,r){const n=Array();for(const[i,o]of this.arrayMapping.entries()){if(o.sheet!==e)continue;const a=r(i,o);a!==void 0&&(this.removeArray(i),n.push(a))}n.forEach(([i,o])=>{this.setArray(i,o)})}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Wm{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,r){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class vp{constructor(e){this.size=new yt(e.length>0?e[0].length:0,e.length),this.array=e}static fromInterpreterValue(e){return e instanceof je?new vp(e.data):new vp([[e]])}simpleRangeValue(){return je.onlyValues(this.array)}addRows(e,r){this.array.splice(e,0,...this.nullArrays(r,this.width())),this.size.height+=r}addColumns(e,r){for(let n=0;n<this.height();n++)this.array[n].splice(e,0,...new Array(r).fill(Tt));this.size.width+=r}removeRows(e,r){if(this.outOfBound(0,e)||this.outOfBound(0,r))throw Error("Array index out of bound");const n=r-e+1;this.array.splice(e,n),this.size.height-=n}removeColumns(e,r){if(this.outOfBound(e,0)||this.outOfBound(r,0))throw Error("Array index out of bound");const n=r-e+1;for(const i of this.array)i.splice(e,n);this.size.width-=n}nullArrays(e,r){const n=[];for(let i=0;i<e;++i)n.push(new Array(r).fill(Tt));return n}get(e,r){if(this.outOfBound(e,r))throw Error("Array index out of bound");return this.array[r][e]}set(e,r,n){if(this.outOfBound(e,r))throw Error("Array index out of bound");this.array[r][e]=n}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height||(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width))throw"Resizing to smaller array"}outOfBound(e,r){return e<0||r<0||r>this.size.height-1||e>this.size.width-1}}class WC{constructor(e,r){this.error=e,this.size=r}get(e,r){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Mi{constructor(e,r,n){this.formula=e,this.cellAddress=r,this.version=n}get width(){return 1}get height(){return 1}static fromAst(e,r,n,i){return n.isScalar()?new fs(e,r,i):new xr(e,r,n,i)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[r,n,i]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=r,this.cellAddress=n,this.version=i}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class xr extends Mi{constructor(e,r,n,i=0){super(e,r,i),n.isRef?this.array=new WC(new L(V.REF,Q.NoSpaceForArrayResult),yt.error()):this.array=new Wm(n)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof L)return this.setErrorValue(e),e;const r=vp.fromInterpreterValue(e);return r.resize(this.array.size),this.array=r,e}getCellValue(){if(this.array instanceof Wm)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof Wm))return this.array.simpleRangeValue()}getArrayCellValue(e){const r=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;try{return this.array.get(r,n)}catch{return new L(V.REF)}}getArrayCellRawValue(e){const r=this.getArrayCellValue(e);if(!(r instanceof L||r===Tt))return Ne(r)}setArrayCellValue(e,r){const n=e.col-this.cellAddress.col,i=e.row-this.cellAddress.row;this.array instanceof vp&&this.array.set(n,i,r)}setNoSpace(){return this.array=new WC(new L(V.SPILL,Q.NoSpaceForArrayResult),yt.error()),this.getCellValue()}getRange(){return ze.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return ze.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,r,n=r){return this.cellAddress.sheet===e&&this.cellAddress.row<=n&&r<this.cellAddress.row+this.height}spansThroughSheetColumn(e,r,n=r){return this.cellAddress.sheet===e&&this.cellAddress.col<=n&&r<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof Wm)}columnsFromArray(){return xi.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return di.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return Fv(this.cellAddress,e)}setErrorValue(e){this.array=new WC(e,this.array.size)}}class fs extends Mi{constructor(e,r,n){super(e,r,n)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(this.cachedCellValue!==void 0)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return this.cachedCellValue!==void 0}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class kn{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,r){this.functionCache.set(e,r)}getCriterionFunctionValue(e,r){var n;return(n=this.getCriterionFunctionValues(e).get(r))===null||n===void 0?void 0:n[0]}getCriterionFunctionValues(e){var r;return(r=this.criterionFunctionCache.get(e))!==null&&r!==void 0?r:new Map}setCriterionFunctionValues(e,r){this.criterionFunctionCache.set(e,r)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Ast=(t,e,r,n,i)=>{if(e instanceof kn){const s=e.range.intersectionWith(r);return s!==void 0?Array.from(s.addresses(i)):[]}let o,a;if(e instanceof Mi)o=e.getFormula(n),a=e.getAddress(n);else return[];return f5(o,t).filter(s=>s instanceof uee).map(s=>s.dependency.toSimpleCellAddress(a)).filter(s=>r.addressInRange(s))};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var ka;(function(t){t[t.ON_STACK=0]="ON_STACK",t[t.PROCESSED=1]="PROCESSED",t[t.POPPED=2]="POPPED"})(ka||(ka={}));class Ist{constructor(e){this.dependencyQuery=e,this.nodes=new Set,this.specialNodes=new Set,this.specialNodesStructuralChanges=new Set,this.specialNodesRecentlyChanged=new Set,this.infiniteRanges=new Set,this.edges=new Map}addNode(e){this.nodes.add(e),this.edges.has(e)||this.edges.set(e,new Set)}addEdge(e,r){if(!this.nodes.has(e))throw new Error(`Unknown node ${e}`);if(!this.nodes.has(r))throw new Error(`Unknown node ${r}`);this.edges.get(e).add(r)}removeEdge(e,r){if(this.existsEdge(e,r))this.edges.get(e).delete(r);else throw new Error("Edge does not exist")}softRemoveEdge(e,r){var n;(n=this.edges.get(e))===null||n===void 0||n.delete(r)}removeIncomingEdges(e){this.edges.forEach(r=>{r.delete(e)})}adjacentNodes(e){return this.edges.get(e)}adjacentNodesCount(e){return this.adjacentNodes(e).size}hasNode(e){return this.nodes.has(e)}nodesCount(){return this.nodes.size}edgesCount(){let e=0;return this.edges.forEach(r=>e+=r.size),e}removeNode(e){for(const r of this.adjacentNodes(e).values())this.markNodeAsSpecialRecentlyChanged(r);return this.edges.delete(e),this.nodes.delete(e),this.specialNodes.delete(e),this.specialNodesRecentlyChanged.delete(e),this.specialNodesStructuralChanges.delete(e),this.infiniteRanges.delete(e),this.removeDependencies(e)}markNodeAsSpecial(e){this.specialNodes.add(e)}markNodeAsSpecialRecentlyChanged(e){this.nodes.has(e)&&this.specialNodesRecentlyChanged.add(e)}markNodeAsChangingWithStructure(e){this.specialNodesStructuralChanges.add(e)}clearSpecialNodesRecentlyChanged(){this.specialNodesRecentlyChanged.clear()}markNodeAsInfiniteRange(e){this.infiniteRanges.add(e)}existsEdge(e,r){var n,i;return(i=(n=this.edges.get(e))===null||n===void 0?void 0:n.has(r))!==null&&i!==void 0?i:!1}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(Array.from(this.nodes),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,r,n){const i=new Map,o=new Map,a=new Map,s=new Set,l=new Map,u=[];let c=0;const f=new Set;e.reverse(),e.forEach(m=>{if(l.get(m)!==void 0)return;const g=[m],v=[];for(l.set(m,ka.ON_STACK);g.length>0;){const w=g[g.length-1];switch(l.get(w)){case ka.ON_STACK:{i.set(w,c),o.set(w,c),v.push(w),c++,this.adjacentNodes(w).forEach(b=>{i.get(b)===void 0&&(g.push(b),a.set(b,w),l.set(b,ka.ON_STACK))}),l.set(w,ka.PROCESSED);break}case ka.PROCESSED:{let b;if(b=i.get(w),this.adjacentNodes(w).forEach(E=>{s.has(E)||(a.get(E)===w?b=Math.min(b,o.get(E)):b=Math.min(b,i.get(E)))}),o.set(w,b),b===i.get(w)){const E=[];do E.push(v[v.length-1]),v.pop();while(E[E.length-1]!==w);E.forEach(A=>{s.add(A)}),u.push(...E),E.length>1&&E.forEach(A=>{f.add(A)})}g.pop(),l.set(w,ka.POPPED);break}case ka.POPPED:{g.pop();break}}}});const h=new Set(e),d=[],p=[];return u.reverse(),u.forEach(m=>{f.has(m)||this.adjacentNodes(m).has(m)?(p.push(m),n(m),this.adjacentNodes(m).forEach(g=>h.add(g))):(d.push(m),h.has(m)&&r(m)&&this.adjacentNodes(m).forEach(g=>h.add(g)))}),{sorted:d,cycled:p}}getDependencies(e){const r=[];return this.edges.forEach((n,i)=>{n.has(e)&&r.push(i)}),r}removeDependencies(e){const r=this.dependencyQuery(e);for(const n of r)this.softRemoveEdge(n,e);return r}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class xst{constructor(){this.rangeMapping=new Map}getMappingSize(e){var r,n;return(n=(r=this.rangeMapping.get(e))===null||r===void 0?void 0:r.size)!==null&&n!==void 0?n:0}setRange(e){let r=this.rangeMapping.get(e.getStart().sheet);r===void 0&&(r=new Map,this.rangeMapping.set(e.getStart().sheet,r));const n=T2(e.getStart(),e.getEnd());r.set(n,e)}removeRange(e){const r=e.getStart().sheet,n=this.rangeMapping.get(r);if(n===void 0)return;const i=T2(e.getStart(),e.getEnd());n.delete(i),n.size===0&&this.rangeMapping.delete(r)}getRange(e,r){const n=this.rangeMapping.get(e.sheet),i=T2(e,r);return n==null?void 0:n.get(i)}fetchRange(e,r){const n=this.getRange(e,r);if(!n)throw Error("Range does not exist");return n}truncateRanges(e,r){const n=Array(),i=Array(),o=Array(),a=e.sheet;for(const[l,u]of this.entriesFromSheet(e.sheet)){const c=u.range;e.start<=r(u.range.end)&&(c.removeSpan(e),c.shouldBeRemoved()?(this.removeByKey(a,l),n.push(u)):i.push([l,u]),o.push(u))}const s=[];i.sort((l,u)=>Nst(l[1],u[1],r));for(const[l,u]of i){const c=Mst(u.range);if(c===l)continue;const f=this.getByKey(a,c);this.removeByKey(a,l),f!==void 0&&u!=f?s.push([f,u]):this.setRange(u)}return{verticesToRemove:n,verticesToMerge:s,verticesWithChangedSize:o}}moveAllRangesInSheetAfterRowByRows(e,r,n){return this.updateVerticesFromSheet(e,(i,o)=>r<=o.start.row?(o.range.shiftByRows(n),{changedSize:!1,vertex:o}):r>o.start.row&&r<=o.end.row?(o.range.expandByRows(n),{changedSize:!0,vertex:o}):void 0)}moveAllRangesInSheetAfterColumnByColumns(e,r,n){return this.updateVerticesFromSheet(e,(i,o)=>r<=o.start.col?(o.range.shiftByColumns(n),{changedSize:!1,vertex:o}):r>o.start.col&&r<=o.end.col?(o.range.expandByColumns(n),{changedSize:!0,vertex:o}):void 0)}moveRangesInsideSourceRange(e,r,n,i){this.updateVerticesFromSheet(e.sheet,(o,a)=>{if(e.containsRange(a.range))return a.range.shiftByColumns(r),a.range.shiftByRows(n),a.range.moveToSheet(i),{changedSize:!1,vertex:a}})}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const r=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),r}return[][Symbol.iterator]()}*rangesInSheet(e){const r=this.rangeMapping.get(e);!r||(yield*r.values())}*rangeVerticesContainedInRange(e){for(const r of this.rangesInSheet(e.sheet))e.containsRange(r.range)&&(yield r)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const r=Le(e.end.sheet,e.end.col,e.end.row-1),n=this.getRange(e.start,r);if(n!==void 0){const i=ze.fromSimpleCellAddresses(Le(e.start.sheet,e.start.col,e.end.row),e.end);return{smallerRangeVertex:n,restRange:i}}}return{restRange:e}}*entriesFromSheet(e){const r=this.rangeMapping.get(e);!r||(yield*r.entries())}removeByKey(e,r){this.rangeMapping.get(e).delete(r)}getByKey(e,r){var n;return(n=this.rangeMapping.get(e))===null||n===void 0?void 0:n.get(r)}updateVerticesFromSheet(e,r){const n=Array();for(const[i,o]of this.entriesFromSheet(e)){const a=r(i,o);a!==void 0&&(this.removeByKey(e,i),n.push(a))}return n.forEach(i=>{this.setRange(i.vertex)}),{verticesWithChangedSize:n.filter(i=>i.changedSize).map(i=>i.vertex)}}}function T2(t,e){return`${t.col},${t.row},${e.col},${e.row}`}function Mst(t){return T2(t.start,t.end)}const Nst=(t,e,r)=>{const n=r(t.range.start),i=r(t.range.start);if(n===i){const o=r(t.range.end),a=r(e.range.end);return o-a}else return n-i};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Pst{constructor(e,r,n){this.functions=e,this.errors=r,this.ui=n,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,r)=>(e[this.functions[r]]=r,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,r)=>(e[this.errors[r]]=r,e),{})}isFunctionTranslated(e){return this.functions[e]!==void 0}getFunctionTranslations(e){const r=[];for(const n of e)this.isFunctionTranslated(n)&&r.push(this.functions[n]);return r}getFunctionTranslation(e){const r=this.functions[e];if(r===void 0)throw new Af(`functions.${e}`);return r}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===V.LIC)return`#${V.LIC}!`;const r=this.errors[e];if(r===void 0)throw new Af(`errors.${e}`);return r}getUITranslation(e){const r=this.ui[e];if(r===void 0)throw new Af(`ui.${e}`);return r}checkUI(){for(const e of Object.values(Dv))if(!(e in this.ui))throw new Af(`ui.${e}`)}checkErrors(){for(const e of Object.values(V))if(!(e in this.errors)&&e!==V.LIC)throw new Af(`errors.${e}`)}checkFunctionTranslations(e){const r=new Set(Object.getOwnPropertyNames(e));for(const n of Object.getOwnPropertyNames(this._protectedTranslations))if(r.has(n))throw new Eee(n)}}function kst(t){return new Pst(Object.assign({},t.functions),Object.assign({},t.errors),Object.assign({},t.ui))}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var Dv;(function(t){t.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"})(Dv||(Dv={}));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function If(t){return t.toLowerCase()}class $st{constructor(e,r){this.id=e,this.displayName=r}get canonicalName(){return If(this.displayName)}}class Lst{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=r=>{const n=this.mappingFromCanonicalName.get(If(r));if(n===void 0)throw new fee(r);return n.id},this.get=r=>{var n;return(n=this.mappingFromCanonicalName.get(If(r)))===null||n===void 0?void 0:n.id},this.fetchDisplayName=r=>this.fetchSheetById(r).displayName,this.sheetNamePrefix=e.getUITranslation(Dv.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const r=If(e);if(this.mappingFromCanonicalName.has(r))throw new kv(e);this.lastSheetId++;const n=new $st(this.lastSheetId,e);return this.store(n),n.id}removeSheet(e){const r=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(r.canonicalName),this.mappingFromId.delete(r.id)}getDisplayName(e){var r;return(r=this.mappingFromId.get(e))===null||r===void 0?void 0:r.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(If(e))}renameSheet(e,r){const n=this.fetchSheetById(e),i=n.displayName;if(i===r)return;const o=this.mappingFromCanonicalName.get(If(r));if(o!==void 0&&o.id!==n.id)throw new kv(r);const a=n.canonicalName;return this.mappingFromCanonicalName.delete(a),n.displayName=r,this.store(n),i}sheetNames(){return Array.from(this.mappingFromId.values()).map(e=>e.displayName)}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const r=this.mappingFromId.get(e);if(r===void 0)throw new yr(e);return r}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Bx{constructor(e,r,n,i,o,a,s,l){this.addressMapping=e,this.rangeMapping=r,this.sheetMapping=n,this.arrayMapping=i,this.stats=o,this.lazilyTransformingAstService=a,this.functionRegistry=s,this.namedExpressions=l,this.changes=hl.empty(),this.dependencyQueryAddresses=u=>{if(u instanceof kn)return this.rangeDependencyQuery(u).map(([c,f])=>c);{const c=this.formulaDependencyQuery(u);if(c!==void 0){const[f,h]=c;return h.map(d=>d instanceof Ks?this.namedExpressions.namedExpressionOrPlaceholder(d.name,f.sheet).address:Br(d)?d:kA(d.start,d.end))}else return[]}},this.dependencyQueryVertices=u=>{if(u instanceof kn)return this.rangeDependencyQuery(u).map(([c,f])=>f);{const c=this.formulaDependencyQuery(u);if(c!==void 0){const[f,h]=c;return h.map(d=>{if(d instanceof ze)return this.rangeMapping.fetchRange(d.start,d.end);if(d instanceof Ks){const p=this.namedExpressions.namedExpressionOrPlaceholder(d.name,f.sheet);return this.addressMapping.fetchCell(p.address)}else return this.addressMapping.fetchCell(d)})}else return[]}},this.rangeDependencyQuery=u=>{const c=[],{smallerRangeVertex:f,restRange:h}=this.rangeMapping.findSmallerRange(u.range);let d;f!==void 0&&this.graph.adjacentNodes(f).has(u)?(d=h,c.push([new ze(f.start,f.end),f])):d=u.range;for(const p of d.addresses(this)){const m=this.addressMapping.getCell(p);m instanceof Ha&&(m.address=p),m!==void 0&&c.push([p,m])}return c},this.formulaDependencyQuery=u=>{let c,f;if(u instanceof Mi)f=u.getAddress(this.lazilyTransformingAstService),c=u.getFormula(this.lazilyTransformingAstService);else return;const h=f5(c,this.functionRegistry);return[f,ea(h,f)]},this.graph=new Ist(this.dependencyQueryVertices)}static buildEmpty(e,r,n,i,o){return new Bx(new Tst(r.chooseAddressMappingPolicy),new xst,new Lst(r.translationPackage),new Ost,o,e,n,i)}setFormulaToCell(e,r,n,i,o,a){const s=Mi.fromAst(r,e,i,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(s),this.processCellDependencies(n,s),this.graph.markNodeAsSpecialRecentlyChanged(s),o&&this.markAsVolatile(s),a&&this.markAsDependentOnStructureChange(s),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,r){const n=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(n,r),this.addressMapping.setCell(e,r),this.graph.markNodeAsSpecialRecentlyChanged(r),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,r){const n=this.shrinkPossibleArrayAndGetCell(e);if(n instanceof xr&&this.arrayMapping.removeArray(n.getRange()),n instanceof dl)n.getValues().rawValue!==r.rawValue&&(n.setValues(r),this.graph.markNodeAsSpecialRecentlyChanged(n));else{const i=new dl(r.parsedValue,r.rawValue);this.exchangeOrAddGraphNode(n,i),this.addressMapping.setCell(e,i),this.graph.markNodeAsSpecialRecentlyChanged(i)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const r=this.shrinkPossibleArrayAndGetCell(e);if(r===void 0)return hl.empty();if(this.graph.adjacentNodes(r).size>0){const n=new Ha(e);this.exchangeGraphNode(r,n),this.graph.adjacentNodesCount(n)===0?(this.removeVertex(n),this.addressMapping.removeCell(e)):(this.graph.markNodeAsSpecialRecentlyChanged(n),this.addressMapping.setCell(e,n))}else this.removeVertex(r),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}ensureThatVertexIsNonArrayCellVertex(e){if(e instanceof xr)throw new Error("Illegal operation")}clearRecentlyChangedVertices(){this.graph.clearSpecialNodesRecentlyChanged()}verticesToRecompute(){return new Set([...this.graph.specialNodesRecentlyChanged,...this.volatileVertices()])}processCellDependencies(e,r){e.forEach(n=>{if(n instanceof ze){const i=n;let o=this.getRange(i.start,i.end);o===void 0&&(o=new kn(i),this.rangeMapping.setRange(o)),this.graph.addNode(o),i.isFinite()||this.graph.markNodeAsInfiniteRange(o);const{smallerRangeVertex:a,restRange:s}=this.rangeMapping.findSmallerRange(i);if(a!==void 0){if(this.graph.addEdge(a,o),o.bruteForce){o.bruteForce=!1;for(const u of i.addresses(this))this.graph.removeEdge(this.fetchCell(u),o)}}else o.bruteForce=!0;const l=this.arrayMapping.getArray(s);if(l!==void 0)this.graph.addEdge(l,o);else for(const u of s.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(u),o);this.graph.addEdge(o,r),i.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(o)}else if(n instanceof Ks){const i=r.getAddress(this.lazilyTransformingAstService).sheet,o=this.fetchNamedExpressionVertex(n.name,i);this.graph.addEdge(o,r)}else this.graph.addEdge(this.fetchCellOrCreateEmpty(n),r)})}fetchNamedExpressionVertex(e,r){const n=this.namedExpressions.namedExpressionOrPlaceholder(e,r);return this.fetchCellOrCreateEmpty(n.address)}exchangeNode(e,r){const n=this.fetchCellOrCreateEmpty(e),i=this.fetchCellOrCreateEmpty(r);this.addressMapping.removeCell(e),this.exchangeGraphNode(n,i)}correctInfiniteRangesDependency(e){let r;for(const n of this.graph.infiniteRanges){const i=n;i.range.addressInRange(e)&&(r=r!=null?r:this.fetchCellOrCreateEmpty(e),this.graph.addEdge(r,i))}}fetchCellOrCreateEmpty(e){let r=this.addressMapping.getCell(e);return r===void 0&&(r=new Ha(e),this.graph.addNode(r),this.addressMapping.setCell(e,r)),r}removeRows(e){this.stats.measure(ot.ADJUSTING_GRAPH,()=>{for(const[n,i]of this.addressMapping.entriesFromRowsSpan(e)){for(const o of this.graph.adjacentNodes(i))this.graph.markNodeAsSpecialRecentlyChanged(o);if(i instanceof xr)if(i.isLeftCorner(n))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(ot.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(e)});const r=this.stats.measure(ot.ADJUSTING_RANGES,()=>{const n=this.truncateRanges(e,i=>i.row);return this.getArrayVerticesRelatedToRanges(n)});return this.stats.measure(ot.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:r,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){this.clearSheet(e);for(const[r,n]of this.addressMapping.sheetEntries(e)){for(const i of this.graph.adjacentNodes(n))this.graph.markNodeAsSpecialRecentlyChanged(i);this.removeVertex(n),this.addressMapping.removeCell(r)}this.stats.measure(ot.ADJUSTING_RANGES,()=>{const r=this.rangeMapping.removeRangesInSheet(e);for(const n of r)this.removeVertex(n);this.stats.measure(ot.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeSheet(e)})})}clearSheet(e){const r=new Set;for(const[n,i]of this.addressMapping.sheetEntries(e))i instanceof xr?r.add(i):this.setCellEmpty(n);for(const n of r.values())this.setArrayEmpty(n);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(ot.ADJUSTING_GRAPH,()=>{for(const[n,i]of this.addressMapping.entriesFromColumnsSpan(e)){for(const o of this.graph.adjacentNodes(i))this.graph.markNodeAsSpecialRecentlyChanged(o);if(i instanceof xr)if(i.isLeftCorner(n))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(ot.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(e)});const r=this.stats.measure(ot.ADJUSTING_RANGES,()=>{const n=this.truncateRanges(e,i=>i.col);return this.getArrayVerticesRelatedToRanges(n)});return this.stats.measure(ot.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:r,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(ot.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});const r=this.stats.measure(ot.ADJUSTING_RANGES,()=>{const n=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(n.verticesWithChangedSize)});this.stats.measure(ot.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)});for(const n of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsSpecialRecentlyChanged(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:r}}addColumns(e){this.stats.measure(ot.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});const r=this.stats.measure(ot.ADJUSTING_RANGES,()=>{const n=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(n.verticesWithChangedSize)});this.stats.measure(ot.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns));for(const n of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsSpecialRecentlyChanged(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:r,contentChanges:this.getAndClearContentChanges()}}ensureNoArrayInRange(e){if(this.arrayMapping.isFormulaArrayInRange(e))throw Error("It is not possible to move / replace cells with array")}isThereSpaceForArray(e){const r=e.getRangeOrUndef();if(r===void 0)return!1;for(const n of r.addresses(this)){const i=this.addressMapping.getCell(n);if(i!==void 0&&!(i instanceof Ha)&&i!==e)return!1}return!0}moveCells(e,r,n,i){for(const o of e.addressesWithDirection(r,n,this)){const a=Le(i,o.col+r,o.row+n);let s=this.addressMapping.getCell(o);const l=this.addressMapping.getCell(a);if(this.addressMapping.removeCell(o),s!==void 0){this.graph.markNodeAsSpecialRecentlyChanged(s),this.addressMapping.setCell(a,s);let u;for(const c of this.graph.adjacentNodes(s))c instanceof kn&&!e.containsRange(c.range)&&(u=u!=null?u:this.fetchCellOrCreateEmpty(o),this.graph.addEdge(u,c),this.graph.removeEdge(s,c));u&&(this.graph.markNodeAsSpecialRecentlyChanged(u),this.addressMapping.setCell(o,u))}if(l!==void 0){s===void 0&&this.addressMapping.removeCell(a);for(const u of this.graph.adjacentNodes(l))s=s!=null?s:this.fetchCellOrCreateEmpty(a),this.graph.addEdge(s,u),this.graph.markNodeAsSpecialRecentlyChanged(s);this.removeVertex(l)}}for(const o of this.rangeMapping.rangeVerticesContainedInRange(e))for(const a of this.graph.adjacentNodes(o))if(a instanceof kn&&!e.containsRange(a.range)){this.graph.removeEdge(o,a);for(const s of o.range.addresses(this)){const l=this.fetchCellOrCreateEmpty(s);this.graph.addEdge(l,a),this.addressMapping.setCell(s,l),this.graph.markNodeAsSpecialRecentlyChanged(l)}}this.rangeMapping.moveRangesInsideSourceRange(e,r,n,i)}setArrayEmpty(e){const r=ze.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),n=this.graph.adjacentNodes(e);for(const i of r.addresses(this))this.addressMapping.removeCell(i);for(const i of n.values()){const o=Ast(this.functionRegistry,i,e.getRange(),this.lazilyTransformingAstService,this);for(const a of o){const s=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(s,i)}o.length>0&&this.graph.markNodeAsSpecialRecentlyChanged(i)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,r){this.graph.addNode(r),this.addressMapping.setCell(e,r)}addArrayVertex(e,r){this.graph.addNode(r),this.setAddressMappingForArrayVertex(r,e)}*arrayFormulaNodes(){for(const e of this.graph.nodes)e instanceof xr&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}existsVertex(e){return this.addressMapping.has(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const r=this.addressMapping.getCellValue(e);return r instanceof je?new L(V.VALUE,Q.ScalarExpected):r}existsEdge(e,r){return this.graph.existsEdge(e,r)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}setArray(e,r){this.arrayMapping.setArray(e,r)}getRange(e,r){return this.rangeMapping.getRange(e,r)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsSpecial(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.nodes.values())e instanceof fs&&e.ensureRecentData(this.lazilyTransformingAstService)}volatileVertices(){return this.graph.specialNodes}getArrayVerticesRelatedToRanges(e){const r=e.map(n=>this.graph.hasNode(n)?Array.from(this.graph.adjacentNodes(n)).filter(i=>i instanceof xr):[]);return new Set(...r)}*rawValuesFromRange(e){for(const r of e.addresses(this)){const n=this.getScalarValue(r);n!==Tt&&(yield[Ne(n),r])}}*entriesFromRange(e){for(const r of e.addresses(this))yield[r,this.getCell(r)]}exchangeGraphNode(e,r){this.graph.addNode(r);const n=this.graph.adjacentNodes(e);this.removeVertex(e),n.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(r,i)})}exchangeOrAddGraphNode(e,r){e?this.exchangeGraphNode(e,r):this.graph.addNode(r)}computeListOfValuesInRange(e){const r=[];for(const n of e.addresses(this)){const i=this.getScalarValue(n);r.push(i)}return r}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const r of this.adjacentArrayVertices(e)){let n;r instanceof Mi?n=this.formulaDirectDependenciesToArray(r,e):n=this.rangeDirectDependenciesToArray(r,e);let i=!1;for(const[o,a]of n)e.isLeftCorner(o)&&(i=!0),this.graph.addEdge(a,r),this.graph.markNodeAsSpecialRecentlyChanged(a);i||this.graph.removeEdge(e,r)}this.graph.markNodeAsSpecialRecentlyChanged(e)}isArrayInternalCell(e){const r=this.getCell(e);return r instanceof xr&&!r.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=hl.empty(),e}getAdjacentNodesAddresses(e){const r=this.graph.adjacentNodes(e),n=[];return r.forEach(i=>{const o=i;o instanceof kn?n.push(kA(o.start,o.end)):n.push(o.getAddress(this.lazilyTransformingAstService))}),n}correctInfiniteRangesDependenciesByRangeVertex(e){for(const r of this.graph.infiniteRanges){const n=r,i=e.range.intersectionWith(n.range);if(i!==void 0)for(const o of i.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(o),r)}}cleanAddressMappingUnderArray(e){const r=e.getRange();for(const n of r.addresses(this)){const i=e.getArrayCellValue(n);this.getCell(n)===e?e.isLeftCorner(n)?this.changes.addChange(new L(V.REF),n,i):(this.addressMapping.removeCell(n),this.changes.addChange(Tt,n,i)):this.changes.addChange(Tt,n,i)}}*formulaDirectDependenciesToArray(e,r){var n;const[,i]=(n=this.formulaDependencyQuery(e))!==null&&n!==void 0?n:[];if(i!==void 0){for(const o of i)if(!(o instanceof Ks||o instanceof ze)&&r.getRange().addressInRange(o)){const a=this.fetchCellOrCreateEmpty(o);yield[o,a]}}}*rangeDirectDependenciesToArray(e,r){const{restRange:n}=this.rangeMapping.findSmallerRange(e.range);for(const i of n.addresses(this))if(r.getRange().addressInRange(i)){const o=this.fetchCellOrCreateEmpty(i);yield[i,o]}}*adjacentArrayVertices(e){const r=this.graph.adjacentNodes(e);for(const n of r)(n instanceof Mi||n instanceof kn)&&(yield n)}addStructuralNodesToChangeSet(){for(const e of this.graph.specialNodesStructuralChanges)this.graph.markNodeAsSpecialRecentlyChanged(e)}fixRangesWhenAddingRows(e,r,n){const i=Array.from(this.rangeMapping.rangesInSheet(e));for(const o of i)if(o.range.includesRow(r+n))if(o.bruteForce){const a=o.range.rangeWithSameWidth(r,n);for(const s of a.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(s),o)}else{let a=o,s=this.rangeMapping.findSmallerRange(a.range);if(s.smallerRangeVertex!==void 0)continue;for(;s.smallerRangeVertex===void 0;){const l=new kn(ze.spanFrom(a.range.start,a.range.width(),a.range.height()-1));this.rangeMapping.setRange(l),this.graph.addNode(l);const u=new ze(Le(a.range.start.sheet,a.range.start.col,a.range.end.row),a.range.end);this.addAllFromRange(u,a),this.graph.addEdge(l,a),a=l,s=this.rangeMapping.findSmallerRange(a.range)}this.graph.addEdge(s.smallerRangeVertex,a),this.addAllFromRange(s.restRange,a),this.graph.removeEdge(s.smallerRangeVertex,o)}}addAllFromRange(e,r){for(const n of e.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(n),r)}fixRangesWhenAddingColumns(e,r,n){for(const i of this.rangeMapping.rangesInSheet(e))if(i.range.includesColumn(r+n)){let o;i.bruteForce?o=i.range.rangeWithSameHeight(r,n):o=ze.spanFrom(Le(e,r,i.range.end.row),n,1);for(const a of o.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(a),i)}}exchangeOrAddFormulaVertex(e){const r=e.getAddress(this.lazilyTransformingAstService),n=ze.spanFrom(r,e.width,e.height),i=this.shrinkPossibleArrayAndGetCell(r);if(e instanceof xr&&this.setArray(n,e),this.exchangeOrAddGraphNode(i,e),this.addressMapping.setCell(r,e),e instanceof xr){if(!this.isThereSpaceForArray(e))return;for(const o of n.addresses(this)){if(e.isLeftCorner(o))continue;const a=this.getCell(o);this.exchangeOrAddGraphNode(a,e)}}for(const o of n.addresses(this))this.addressMapping.setCell(o,e)}setAddressMappingForArrayVertex(e,r){if(this.addressMapping.setCell(r,e),!(e instanceof xr))return;const n=ze.spanFromOrUndef(r,e.width,e.height);if(n!==void 0&&(this.setArray(n,e),!!this.isThereSpaceForArray(e)))for(const i of n.addresses(this))this.addressMapping.setCell(i,e)}truncateRanges(e,r){const{verticesToRemove:n,verticesToMerge:i,verticesWithChangedSize:o}=this.rangeMapping.truncateRanges(e,r);for(const[a,s]of i)this.mergeRangeVertices(a,s);for(const a of n)this.removeVertexAndCleanupDependencies(a);return o}fixArraysAfterAddingRow(e,r,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,r,n),!(r<=0))for(const[,i]of this.arrayMapping.arraysInRows(di.fromRowStartAndEnd(e,r-1,r-1))){const o=i.getRange();for(let a=o.start.col;a<=o.end.col;++a)for(let s=r;s<=o.end.row;++s){const l=Le(e,a,s),u=Le(e,a,s+n),c=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(Tt,u,c)}}}fixArraysAfterRemovingRows(e,r,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,r,-n),!(r<=0))for(const[,i]of this.arrayMapping.arraysInRows(di.fromRowStartAndEnd(e,r-1,r-1)))if(this.isThereSpaceForArray(i))for(const o of i.getRange().addresses(this))this.addressMapping.setCell(o,i);else this.setNoSpaceIfArray(i)}fixArraysAfterAddingColumn(e,r,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,r,n),!(r<=0))for(const[,i]of this.arrayMapping.arraysInCols(xi.fromColumnStartAndEnd(e,r-1,r-1))){const o=i.getRange();for(let a=o.start.row;a<=o.end.row;++a)for(let s=r;s<=o.end.col;++s){const l=Le(e,s,a),u=Le(e,s+n,a),c=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(Tt,u,c)}}}fixArraysAfterRemovingColumns(e,r,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,r,-n),!(r<=0))for(const[,i]of this.arrayMapping.arraysInCols(xi.fromColumnStartAndEnd(e,r-1,r-1)))if(this.isThereSpaceForArray(i))for(const o of i.getRange().addresses(this))this.addressMapping.setCell(o,i);else this.setNoSpaceIfArray(i)}shrinkPossibleArrayAndGetCell(e){const r=this.getCell(e);return r instanceof xr?(this.setNoSpaceIfArray(r),this.getCell(e)):r}setNoSpaceIfArray(e){e instanceof xr&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof kn&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,r){const n=this.graph.adjacentNodes(r);this.removeVertexAndCleanupDependencies(r),this.graph.softRemoveEdge(e,r),n.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(e,i)})}removeVertexAndCleanupDependencies(e){const r=new Set(this.graph.removeNode(e));for(;r.size>0;){const n=r.values().next().value;r.delete(n),this.graph.hasNode(n)&&this.graph.adjacentNodesCount(n)===0&&((n instanceof kn||n instanceof Ha)&&this.graph.removeNode(n).forEach(i=>r.add(i)),n instanceof kn?this.rangeMapping.removeRange(n):n instanceof Ha&&this.addressMapping.removeCell(n.address))}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ha{constructor(e){this.address=e}getCellValue(){return Tt}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class dl{constructor(e,r){this.parsedValue=e,this.rawValue=r}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}setCellValue(e){throw"SetCellValue is deprecated for ValueCellVertex"}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class th{constructor(e,r){this.errors=e,this.rawInput=r}getCellValue(){return L.parsingError()}getFormula(){return this.rawInput}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Dst{constructor(e,r){this.width=e,this.height=r,this.mapping=new Map}getCell(e){var r;return(r=this.mapping.get(e.col))===null||r===void 0?void 0:r.get(e.row)}setCell(e,r){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let n=this.mapping.get(e.col);n||(n=new Map,this.mapping.set(e.col,n)),n.set(e.row,r)}has(e){var r;return!!(!((r=this.mapping.get(e.col))===null||r===void 0)&&r.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var r;(r=this.mapping.get(e.col))===null||r===void 0||r.delete(e.row)}addRows(e,r){this.mapping.forEach(n=>{const i=new Map;n.forEach((o,a)=>{a>=e&&(i.set(a+r,o),n.delete(a))}),i.forEach((o,a)=>{n.set(a,o)})}),this.height+=r}addColumns(e,r){const n=new Map;this.mapping.forEach((i,o)=>{o>=e&&(n.set(o+r,i),this.mapping.delete(o))}),n.forEach((i,o)=>{this.mapping.set(o,i)}),this.width+=r}removeRows(e){this.mapping.forEach(i=>{const o=new Map;i.forEach((a,s)=>{s>=e.rowStart&&(i.delete(s),s>e.rowEnd&&o.set(s-e.numberOfRows,a))}),o.forEach((a,s)=>{i.set(s,a)})});const r=Math.min(this.height-1,e.rowEnd),n=Math.max(0,r-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){const r=new Map;this.mapping.forEach((o,a)=>{a>=e.columnStart&&(this.mapping.delete(a),a>e.columnEnd&&r.set(a-e.numberOfColumns,o))}),r.forEach((o,a)=>{this.mapping.set(a,o)});const n=Math.min(this.width-1,e.columnEnd),i=Math.max(0,n-e.columnStart+1);this.width=Math.max(0,this.width-i)}*getEntries(e){for(const[r,n]of this.mapping)for(const[i,o]of n)yield[Le(e,r,i),o]}*verticesFromColumn(e){const r=this.mapping.get(e);if(r!==void 0)for(const[n,i]of r)yield i}*verticesFromRow(e){for(const r of this.mapping.values()){const n=r.get(e);n!==void 0&&(yield n)}}*verticesFromColumnsSpan(e){for(const r of e.columns()){const n=this.mapping.get(r);if(n!==void 0)for(const[i,o]of n)yield o}}*verticesFromRowsSpan(e){for(const r of this.mapping.values())for(const n of e.rows()){const i=r.get(n);i!==void 0&&(yield i)}}*entriesFromRowsSpan(e){for(const[r,n]of this.mapping.entries())for(const i of e.rows()){const o=n.get(i);o!==void 0&&(yield[Le(e.sheet,r,i),o])}}*entriesFromColumnsSpan(e){for(const r of e.columns()){const n=this.mapping.get(r);if(n!==void 0)for(const[i,o]of n.entries())yield[Le(e.sheet,r,i),o]}}*vertices(){for(const[e,r]of this.mapping)for(const[n,i]of r)i!==void 0&&(yield i)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Fst{constructor(e,r){this.width=e,this.height=r,this.mapping=new Array(r);for(let n=0;n<r;n++)this.mapping[n]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,r){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=r}has(e){const r=this.mapping[e.row];return r?!!r[e.col]:!1}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){this.mapping[e.row]!==void 0&&delete this.mapping[e.row][e.col]}addRows(e,r){const n=[];for(let i=0;i<r;i++)n.push(new Array(this.width));this.mapping.splice(e,0,...n),this.height+=r}addColumns(e,r){for(let n=0;n<this.height;n++)this.mapping[n].splice(e,0,...new Array(r));this.width+=r}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const r=Math.min(this.height-1,e.rowEnd),n=Math.max(0,r-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){for(let i=0;i<this.height;i++)this.mapping[i].splice(e.columnStart,e.numberOfColumns);const r=Math.min(this.width-1,e.columnEnd),n=Math.max(0,r-e.columnStart+1);this.width=Math.max(0,this.width-n)}*getEntries(e){for(let r=0;r<this.height;++r)for(let n=0;n<this.width;++n){const i=this.getCellVertex(n,r);i&&(yield[Le(e,n,r),i])}}*verticesFromColumn(e){for(let r=0;r<this.height;++r){const n=this.getCellVertex(e,r);n&&(yield n)}}*verticesFromRow(e){for(let r=0;r<this.width;++r){const n=this.getCellVertex(r,e);n&&(yield n)}}*verticesFromColumnsSpan(e){for(let r=e.columnStart;r<=e.columnEnd;++r)for(let n=0;n<this.height;++n){const i=this.getCellVertex(r,n);i&&(yield i)}}*verticesFromRowsSpan(e){for(let r=0;r<this.width;++r)for(let n=e.rowStart;n<=e.rowEnd;++n){const i=this.getCellVertex(r,n);i&&(yield i)}}*entriesFromRowsSpan(e){for(let r=0;r<this.width;++r)for(let n=e.rowStart;n<=e.rowEnd;++n){const i=this.getCellVertex(r,n);i&&(yield[Le(e.sheet,r,n),i])}}*entriesFromColumnsSpan(e){for(let r=0;r<this.height;++r)for(let n=e.columnStart;n<=e.columnEnd;++n){const i=this.getCellVertex(n,r);i&&(yield[Le(e.sheet,n,r),i])}}*vertices(){for(let e=0;e<this.height;++e)for(let r=0;r<this.width;++r){const n=this.getCellVertex(r,e);n&&(yield n)}}getCellVertex(e,r){var n;return(n=this.mapping[r])===null||n===void 0?void 0:n[e]}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var V;(function(t){t.DIV_BY_ZERO="DIV_BY_ZERO",t.NAME="NAME",t.VALUE="VALUE",t.NUM="NUM",t.NA="NA",t.CYCLE="CYCLE",t.REF="REF",t.SPILL="SPILL",t.LIC="LIC",t.ERROR="ERROR"})(V||(V={}));var li;(function(t){t.FORMULA="FORMULA",t.VALUE="VALUE",t.ARRAY="ARRAY",t.EMPTY="EMPTY",t.ARRAYFORMULA="ARRAYFORMULA"})(li||(li={}));const Hst=(t,e)=>t instanceof xr?t.isLeftCorner(e)?li.ARRAYFORMULA:li.ARRAY:t instanceof fs||t instanceof th?li.FORMULA:t instanceof dl?li.VALUE:li.EMPTY;var pS;(function(t){t.EMPTY="EMPTY",t.NUMBER="NUMBER",t.STRING="STRING",t.BOOLEAN="BOOLEAN",t.ERROR="ERROR"})(pS||(pS={}));var PA;(function(t){t.NUMBER="NUMBER"})(PA||(PA={}));const _o=Object.assign(Object.assign({},pS),PA),Bst=Object.assign(Object.assign({},pS),Be),kV=t=>{switch(t){case _o.EMPTY:return 0;case _o.NUMBER:return 1;case _o.STRING:return 2;case _o.BOOLEAN:return 3;case _o.ERROR:return 4}throw new Error("Cell value not computed")},mS=t=>{if(t===Tt)return _o.EMPTY;if(t instanceof L||t instanceof je)return _o.ERROR;if(typeof t=="string")return _o.STRING;if(Ft(t))return _o.NUMBER;if(typeof t=="boolean")return _o.BOOLEAN;throw new Error("Cell value not computed")},Ust=t=>Ft(t)?wst(t):mS(t),Vst=t=>{if(Ft(t))return Sst(t)};class L{constructor(e,r,n){this.type=e,this.message=r,this.root=n}static parsingError(){return new L(V.ERROR,Q.ParseError)}attachRootVertex(e){return this.root===void 0?new L(this.type,this.message,e):this}}const _ee=(t,e)=>({sheet:t,row:e}),jst=t=>t.row<0,Tee=(t,e)=>({sheet:t,col:e}),Wst=t=>t.col<0,Le=(t,e,r)=>({sheet:t,col:e,row:r}),fi=t=>t.col<0||t.row<0,zst=(t,e,r,n)=>Le(e,t.col+r,t.row+n),O2=t=>`${t.sheet},${t.row},${t.col}`;function Br(t){return t&&(typeof t=="object"||typeof t=="function")?"col"in t&&typeof t.col=="number"&&"row"in t&&typeof t.row=="number"&&"sheet"in t&&typeof t.sheet=="number":!1}const Ao=(t,e)=>{var r;return(r=t.sheet)!==null&&r!==void 0?r:e.sheet},Fv=(t,e)=>t.sheet===e.sheet&&t.col===e.col&&t.row===e.row;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Gst="AbsoluteCellRange: Wrong range size";function _i(t){return t&&(typeof t=="object"||typeof t=="function")?"start"in t&&Br(t.start)&&"end"in t&&Br(t.end):!1}const kA=(t,e)=>({start:t,end:e});class ze{constructor(e,r){if(e.sheet!==r.sheet)throw new $v(e.sheet,r.sheet);this.start=Le(e.sheet,e.col,e.row),this.end=Le(r.sheet,r.col,r.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,r){if(e.sheet!==r.sheet)throw new $v(e.sheet,r.sheet);const n=r.col-e.col,i=r.row-e.row;return Number.isFinite(i)&&Number.isFinite(n)?new ze(e,r):Number.isFinite(i)?new ys(e.sheet,e.row,r.row):new gs(e.sheet,e.col,r.col)}static fromAst(e,r){return e.type===G.CELL_RANGE?ze.fromCellRange(e,r):e.type===G.COLUMN_RANGE?gs.fromColumnRange(e,r):ys.fromRowRangeAst(e,r)}static fromAstOrUndef(e,r){try{return ze.fromAst(e,r)}catch{return}}static fromCellRange(e,r){return new ze(e.start.toSimpleCellAddress(r),e.end.toSimpleCellAddress(r))}static spanFrom(e,r,n){const i=ze.spanFromOrUndef(e,r,n);if(i===void 0)throw new Error(Gst);return i}static spanFromOrUndef(e,r,n){if(!Number.isFinite(r)&&Number.isFinite(n))return e.col!==0?void 0:new ys(e.sheet,e.row,e.row+n-1);if(!Number.isFinite(n)&&Number.isFinite(r))return e.row!==0?void 0:new gs(e.sheet,e.col,e.col+r-1);if(Number.isFinite(n)&&Number.isFinite(r))return new ze(e,Le(e.sheet,e.col+r-1,e.row+n-1))}static fromCoordinates(e,r,n,i,o){return new ze(Le(e,r,n),Le(e,i,o))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet!==e.sheet?!1:this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const r=Math.max(this.start.row,e.start.row),n=Math.min(this.end.row,e.end.row),i=Math.max(this.start.col,e.start.col),o=Math.min(this.end.col,e.end.col);if(!(r>n||i>o))return new ze(Le(this.sheet,i,r),Le(this.sheet,o,n))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,r){return ze.spanFrom(Le(this.sheet,this.start.col+e,this.start.row+r),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof di?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,r){return ze.spanFrom(Le(this.sheet,this.start.col,e),this.width(),r)}rangeWithSameHeight(e,r){return ze.spanFrom(Le(this.sheet,e,this.start.row),r,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let r=0;r<this.height();++r){e[r]=[];for(let n=0;n<this.width();++n){const i=Le(this.sheet,this.start.col+n,this.start.row+r);e[r].push(i)}}return e}withStart(e){return new ze(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return Fv(this.start,e.start)&&Fv(this.end,e.end)}addressesArrayMap(e,r){const n=[];let i=this.start.row;for(;i<=this.effectiveEndRow(e);){let o=this.start.col;const a=[];for(;o<=this.effectiveEndColumn(e);)a.push(r(Le(this.start.sheet,o,i))),o++;n.push(a),i++}return n}addresses(e){const r=[];let n=this.start.row;const i=this.effectiveEndRow(e),o=this.effectiveEndColumn(e);for(;n<=i;){let a=this.start.col;for(;a<=o;)r.push(Le(this.start.sheet,a,n)),a++;n++}return r}*addressesWithDirection(e,r,n){if(e>0)if(r>0){let i=this.effectiveEndRow(n);for(;i>=this.start.row;){let o=this.effectiveEndColumn(n);for(;o>=this.start.col;)yield Le(this.start.sheet,o,i),o-=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(n);){let o=this.effectiveEndColumn(n);for(;o>=this.start.col;)yield Le(this.start.sheet,o,i),o-=1;i+=1}}else if(r>0){let i=this.effectiveEndRow(n);for(;i>=this.start.row;){let o=this.start.col;for(;o<=this.effectiveEndColumn(n);)yield Le(this.start.sheet,o,i),o+=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(n);){let o=this.start.col;for(;o<=this.effectiveEndColumn(n);)yield Le(this.start.sheet,o,i),o+=1;i+=1}}}getAddress(e,r){if(e<0||r<0||r>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return Le(this.start.sheet,this.start.col+e,this.start.row+r)}exceedsSheetSizeLimits(e,r){return this.end.col>=e||this.end.row>=r}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,r){if(!(e>this.end.row)){if(r<this.start.row){const n=r-e+1;return this.shiftByRows(-n)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(r,this.end.row)-e+1}}removeColumns(e,r){if(!(e>this.end.col)){if(r<this.start.col){const n=r-e+1;return this.shiftByColumns(-n)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(r,this.end.col)-e+1}}}class gs extends ze{constructor(e,r,n){super(Le(e,r,0),Le(e,n,Number.POSITIVE_INFINITY))}static fromColumnRange(e,r){const n=e.start.toSimpleColumnAddress(r),i=e.end.toSimpleColumnAddress(r);if(n.sheet!==i.sheet)throw new $v(n.sheet,i.sheet);return new gs(n.sheet,n.col,i.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,r){return new gs(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,r){return new gs(this.sheet,e,e+r-1)}exceedsSheetSizeLimits(e,r){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,r){}}class ys extends ze{constructor(e,r,n){super(Le(e,0,r),Le(e,Number.POSITIVE_INFINITY,n))}static fromRowRangeAst(e,r){const n=e.start.toSimpleRowAddress(r),i=e.end.toSimpleRowAddress(r);if(n.sheet!==i.sheet)throw new $v(n.sheet,i.sheet);return new ys(n.sheet,n.row,i.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,r){return new ys(this.sheet,this.start.row+r,this.end.row+r)}rangeWithSameWidth(e,r){return new ys(this.sheet,e,e+r-1)}exceedsSheetSizeLimits(e,r){return this.end.row>=r}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,r){}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class aa{constructor(e,r,n){this.formulaAddress=e,this.arraysFlag=r,this.formulaVertex=n}}var Oee={exports:{}};(function(t){(function(e){for(var r=[null,0,{}],n=10,i=44032,o=4352,a=4449,s=4519,l=19,u=21,c=28,f=u*c,h=l*f,d=function(P,y){this.codepoint=P,this.feature=y},p={},m=[],g=0;g<=255;++g)m[g]=0;function v(P,y,R){var _=p[y];return _||(_=P(y,R),!!_.feature&&++m[y>>8&255]>n&&(p[y]=_)),_}function w(P,y,R){var _=y&65280,$=d.udata[_]||{},B=$[y];return B?new d(y,B):new d(y,r)}function b(P,y,R){return R?P(y,R):new d(y,null)}function E(P,y,R){var _;if(y<o||o+l<=y&&y<i||i+h<y)return P(y,R);if(o<=y&&y<o+l){var $={},B=(y-o)*u;for(_=0;_<u;++_)$[a+_]=i+c*(_+B);return new d(y,[,,$])}var W=y-i,ee=W%c,J=[];if(ee!==0)J[0]=[i+W-ee,s+ee];else for(J[0]=[o+Math.floor(W/f),a+Math.floor(W%f/c)],J[2]={},_=1;_<c;++_)J[2][s+_]=y+_;return new d(y,J)}function A(P,y,R){return y<60||13311<y&&y<42607?new d(y,r):P(y,R)}var M=[A,v,b,E,w];d.fromCharCode=M.reduceRight(function(P,y){return function(R,_){return y(P,R,_)}},null),d.isHighSurrogate=function(P){return P>=55296&&P<=56319},d.isLowSurrogate=function(P){return P>=56320&&P<=57343},d.prototype.prepFeature=function(){this.feature||(this.feature=d.fromCharCode(this.codepoint,!0).feature)},d.prototype.toString=function(){if(this.codepoint<65536)return String.fromCharCode(this.codepoint);var P=this.codepoint-65536;return String.fromCharCode(Math.floor(P/1024)+55296,P%1024+56320)},d.prototype.getDecomp=function(){return this.prepFeature(),this.feature[0]||null},d.prototype.isCompatibility=function(){return this.prepFeature(),!!this.feature[1]&&this.feature[1]&1<<8},d.prototype.isExclude=function(){return this.prepFeature(),!!this.feature[1]&&this.feature[1]&1<<9},d.prototype.getCanonicalClass=function(){return this.prepFeature(),this.feature[1]?this.feature[1]&255:0},d.prototype.getComposite=function(P){if(this.prepFeature(),!this.feature[2])return null;var y=this.feature[2][P.codepoint];return y?d.fromCharCode(y):null};var k=function(P){this.str=P,this.cursor=0};k.prototype.next=function(){if(!!this.str&&this.cursor<this.str.length){var P=this.str.charCodeAt(this.cursor++),y;return d.isHighSurrogate(P)&&this.cursor<this.str.length&&d.isLowSurrogate(y=this.str.charCodeAt(this.cursor))&&(P=(P-55296)*1024+(y-56320)+65536,++this.cursor),d.fromCharCode(P)}else return this.str=null,null};var O=function(P,y){this.it=P,this.canonical=y,this.resBuf=[]};O.prototype.next=function(){function P(R,_){var $=_.getDecomp();if(!!$&&!(R&&_.isCompatibility())){for(var B=[],W=0;W<$.length;++W){var ee=P(R,d.fromCharCode($[W]));B=B.concat(ee)}return B}else return[_]}if(this.resBuf.length===0){var y=this.it.next();if(!y)return null;this.resBuf=P(this.canonical,y)}return this.resBuf.shift()};var x=function(P){this.it=P,this.resBuf=[]};x.prototype.next=function(){var P;if(this.resBuf.length===0)do{var y=this.it.next();if(!y)break;P=y.getCanonicalClass();var R=this.resBuf.length;if(P!==0)for(;R>0;--R){var _=this.resBuf[R-1],$=_.getCanonicalClass();if($<=P)break}this.resBuf.splice(R,0,y)}while(P!==0);return this.resBuf.shift()};var C=function(P){this.it=P,this.procBuf=[],this.resBuf=[],this.lastClass=null};C.prototype.next=function(){for(;this.resBuf.length===0;){var P=this.it.next();if(!P){this.resBuf=this.procBuf,this.procBuf=[];break}if(this.procBuf.length===0)this.lastClass=P.getCanonicalClass(),this.procBuf.push(P);else{var y=this.procBuf[0],R=y.getComposite(P),_=P.getCanonicalClass();!!R&&(this.lastClass<_||this.lastClass===0)?this.procBuf[0]=R:(_===0&&(this.resBuf=this.procBuf,this.procBuf=[]),this.lastClass=_,this.procBuf.push(P))}}return this.resBuf.shift()};var I=function(P,y){switch(P){case"NFD":return new x(new O(new k(y),!0));case"NFKD":return new x(new O(new k(y),!1));case"NFC":return new C(new x(new O(new k(y),!0)));case"NFKC":return new C(new x(new O(new k(y),!1)))}throw P+" is invalid"},H=function(P,y){for(var R=I(P,y),_="",$;$=R.next();)_+=$.toString();return _};function j(P){return H("NFD",P)}function q(P){return H("NFKD",P)}function Z(P){return H("NFC",P)}function ne(P){return H("NFKC",P)}d.udata={0:{60:[,,{824:8814}],61:[,,{824:8800}],62:[,,{824:8815}],65:[,,{768:192,769:193,770:194,771:195,772:256,774:258,775:550,776:196,777:7842,778:197,780:461,783:512,785:514,803:7840,805:7680,808:260}],66:[,,{775:7682,803:7684,817:7686}],67:[,,{769:262,770:264,775:266,780:268,807:199}],68:[,,{775:7690,780:270,803:7692,807:7696,813:7698,817:7694}],69:[,,{768:200,769:201,770:202,771:7868,772:274,774:276,775:278,776:203,777:7866,780:282,783:516,785:518,803:7864,807:552,808:280,813:7704,816:7706}],70:[,,{775:7710}],71:[,,{769:500,770:284,772:7712,774:286,775:288,780:486,807:290}],72:[,,{770:292,775:7714,776:7718,780:542,803:7716,807:7720,814:7722}],73:[,,{768:204,769:205,770:206,771:296,772:298,774:300,775:304,776:207,777:7880,780:463,783:520,785:522,803:7882,808:302,816:7724}],74:[,,{770:308}],75:[,,{769:7728,780:488,803:7730,807:310,817:7732}],76:[,,{769:313,780:317,803:7734,807:315,813:7740,817:7738}],77:[,,{769:7742,775:7744,803:7746}],78:[,,{768:504,769:323,771:209,775:7748,780:327,803:7750,807:325,813:7754,817:7752}],79:[,,{768:210,769:211,770:212,771:213,772:332,774:334,775:558,776:214,777:7886,779:336,780:465,783:524,785:526,795:416,803:7884,808:490}],80:[,,{769:7764,775:7766}],82:[,,{769:340,775:7768,780:344,783:528,785:530,803:7770,807:342,817:7774}],83:[,,{769:346,770:348,775:7776,780:352,803:7778,806:536,807:350}],84:[,,{775:7786,780:356,803:7788,806:538,807:354,813:7792,817:7790}],85:[,,{768:217,769:218,770:219,771:360,772:362,774:364,776:220,777:7910,778:366,779:368,780:467,783:532,785:534,795:431,803:7908,804:7794,808:370,813:7798,816:7796}],86:[,,{771:7804,803:7806}],87:[,,{768:7808,769:7810,770:372,775:7814,776:7812,803:7816}],88:[,,{775:7818,776:7820}],89:[,,{768:7922,769:221,770:374,771:7928,772:562,775:7822,776:376,777:7926,803:7924}],90:[,,{769:377,770:7824,775:379,780:381,803:7826,817:7828}],97:[,,{768:224,769:225,770:226,771:227,772:257,774:259,775:551,776:228,777:7843,778:229,780:462,783:513,785:515,803:7841,805:7681,808:261}],98:[,,{775:7683,803:7685,817:7687}],99:[,,{769:263,770:265,775:267,780:269,807:231}],100:[,,{775:7691,780:271,803:7693,807:7697,813:7699,817:7695}],101:[,,{768:232,769:233,770:234,771:7869,772:275,774:277,775:279,776:235,777:7867,780:283,783:517,785:519,803:7865,807:553,808:281,813:7705,816:7707}],102:[,,{775:7711}],103:[,,{769:501,770:285,772:7713,774:287,775:289,780:487,807:291}],104:[,,{770:293,775:7715,776:7719,780:543,803:7717,807:7721,814:7723,817:7830}],105:[,,{768:236,769:237,770:238,771:297,772:299,774:301,776:239,777:7881,780:464,783:521,785:523,803:7883,808:303,816:7725}],106:[,,{770:309,780:496}],107:[,,{769:7729,780:489,803:7731,807:311,817:7733}],108:[,,{769:314,780:318,803:7735,807:316,813:7741,817:7739}],109:[,,{769:7743,775:7745,803:7747}],110:[,,{768:505,769:324,771:241,775:7749,780:328,803:7751,807:326,813:7755,817:7753}],111:[,,{768:242,769:243,770:244,771:245,772:333,774:335,775:559,776:246,777:7887,779:337,780:466,783:525,785:527,795:417,803:7885,808:491}],112:[,,{769:7765,775:7767}],114:[,,{769:341,775:7769,780:345,783:529,785:531,803:7771,807:343,817:7775}],115:[,,{769:347,770:349,775:7777,780:353,803:7779,806:537,807:351}],116:[,,{775:7787,776:7831,780:357,803:7789,806:539,807:355,813:7793,817:7791}],117:[,,{768:249,769:250,770:251,771:361,772:363,774:365,776:252,777:7911,778:367,779:369,780:468,783:533,785:535,795:432,803:7909,804:7795,808:371,813:7799,816:7797}],118:[,,{771:7805,803:7807}],119:[,,{768:7809,769:7811,770:373,775:7815,776:7813,778:7832,803:7817}],120:[,,{775:7819,776:7821}],121:[,,{768:7923,769:253,770:375,771:7929,772:563,775:7823,776:255,777:7927,778:7833,803:7925}],122:[,,{769:378,770:7825,775:380,780:382,803:7827,817:7829}],160:[[32],256],168:[[32,776],256,{768:8173,769:901,834:8129}],170:[[97],256],175:[[32,772],256],178:[[50],256],179:[[51],256],180:[[32,769],256],181:[[956],256],184:[[32,807],256],185:[[49],256],186:[[111],256],188:[[49,8260,52],256],189:[[49,8260,50],256],190:[[51,8260,52],256],192:[[65,768]],193:[[65,769]],194:[[65,770],,{768:7846,769:7844,771:7850,777:7848}],195:[[65,771]],196:[[65,776],,{772:478}],197:[[65,778],,{769:506}],198:[,,{769:508,772:482}],199:[[67,807],,{769:7688}],200:[[69,768]],201:[[69,769]],202:[[69,770],,{768:7872,769:7870,771:7876,777:7874}],203:[[69,776]],204:[[73,768]],205:[[73,769]],206:[[73,770]],207:[[73,776],,{769:7726}],209:[[78,771]],210:[[79,768]],211:[[79,769]],212:[[79,770],,{768:7890,769:7888,771:7894,777:7892}],213:[[79,771],,{769:7756,772:556,776:7758}],214:[[79,776],,{772:554}],216:[,,{769:510}],217:[[85,768]],218:[[85,769]],219:[[85,770]],220:[[85,776],,{768:475,769:471,772:469,780:473}],221:[[89,769]],224:[[97,768]],225:[[97,769]],226:[[97,770],,{768:7847,769:7845,771:7851,777:7849}],227:[[97,771]],228:[[97,776],,{772:479}],229:[[97,778],,{769:507}],230:[,,{769:509,772:483}],231:[[99,807],,{769:7689}],232:[[101,768]],233:[[101,769]],234:[[101,770],,{768:7873,769:7871,771:7877,777:7875}],235:[[101,776]],236:[[105,768]],237:[[105,769]],238:[[105,770]],239:[[105,776],,{769:7727}],241:[[110,771]],242:[[111,768]],243:[[111,769]],244:[[111,770],,{768:7891,769:7889,771:7895,777:7893}],245:[[111,771],,{769:7757,772:557,776:7759}],246:[[111,776],,{772:555}],248:[,,{769:511}],249:[[117,768]],250:[[117,769]],251:[[117,770]],252:[[117,776],,{768:476,769:472,772:470,780:474}],253:[[121,769]],255:[[121,776]]},256:{256:[[65,772]],257:[[97,772]],258:[[65,774],,{768:7856,769:7854,771:7860,777:7858}],259:[[97,774],,{768:7857,769:7855,771:7861,777:7859}],260:[[65,808]],261:[[97,808]],262:[[67,769]],263:[[99,769]],264:[[67,770]],265:[[99,770]],266:[[67,775]],267:[[99,775]],268:[[67,780]],269:[[99,780]],270:[[68,780]],271:[[100,780]],274:[[69,772],,{768:7700,769:7702}],275:[[101,772],,{768:7701,769:7703}],276:[[69,774]],277:[[101,774]],278:[[69,775]],279:[[101,775]],280:[[69,808]],281:[[101,808]],282:[[69,780]],283:[[101,780]],284:[[71,770]],285:[[103,770]],286:[[71,774]],287:[[103,774]],288:[[71,775]],289:[[103,775]],290:[[71,807]],291:[[103,807]],292:[[72,770]],293:[[104,770]],296:[[73,771]],297:[[105,771]],298:[[73,772]],299:[[105,772]],300:[[73,774]],301:[[105,774]],302:[[73,808]],303:[[105,808]],304:[[73,775]],306:[[73,74],256],307:[[105,106],256],308:[[74,770]],309:[[106,770]],310:[[75,807]],311:[[107,807]],313:[[76,769]],314:[[108,769]],315:[[76,807]],316:[[108,807]],317:[[76,780]],318:[[108,780]],319:[[76,183],256],320:[[108,183],256],323:[[78,769]],324:[[110,769]],325:[[78,807]],326:[[110,807]],327:[[78,780]],328:[[110,780]],329:[[700,110],256],332:[[79,772],,{768:7760,769:7762}],333:[[111,772],,{768:7761,769:7763}],334:[[79,774]],335:[[111,774]],336:[[79,779]],337:[[111,779]],340:[[82,769]],341:[[114,769]],342:[[82,807]],343:[[114,807]],344:[[82,780]],345:[[114,780]],346:[[83,769],,{775:7780}],347:[[115,769],,{775:7781}],348:[[83,770]],349:[[115,770]],350:[[83,807]],351:[[115,807]],352:[[83,780],,{775:7782}],353:[[115,780],,{775:7783}],354:[[84,807]],355:[[116,807]],356:[[84,780]],357:[[116,780]],360:[[85,771],,{769:7800}],361:[[117,771],,{769:7801}],362:[[85,772],,{776:7802}],363:[[117,772],,{776:7803}],364:[[85,774]],365:[[117,774]],366:[[85,778]],367:[[117,778]],368:[[85,779]],369:[[117,779]],370:[[85,808]],371:[[117,808]],372:[[87,770]],373:[[119,770]],374:[[89,770]],375:[[121,770]],376:[[89,776]],377:[[90,769]],378:[[122,769]],379:[[90,775]],380:[[122,775]],381:[[90,780]],382:[[122,780]],383:[[115],256,{775:7835}],416:[[79,795],,{768:7900,769:7898,771:7904,777:7902,803:7906}],417:[[111,795],,{768:7901,769:7899,771:7905,777:7903,803:7907}],431:[[85,795],,{768:7914,769:7912,771:7918,777:7916,803:7920}],432:[[117,795],,{768:7915,769:7913,771:7919,777:7917,803:7921}],439:[,,{780:494}],452:[[68,381],256],453:[[68,382],256],454:[[100,382],256],455:[[76,74],256],456:[[76,106],256],457:[[108,106],256],458:[[78,74],256],459:[[78,106],256],460:[[110,106],256],461:[[65,780]],462:[[97,780]],463:[[73,780]],464:[[105,780]],465:[[79,780]],466:[[111,780]],467:[[85,780]],468:[[117,780]],469:[[220,772]],470:[[252,772]],471:[[220,769]],472:[[252,769]],473:[[220,780]],474:[[252,780]],475:[[220,768]],476:[[252,768]],478:[[196,772]],479:[[228,772]],480:[[550,772]],481:[[551,772]],482:[[198,772]],483:[[230,772]],486:[[71,780]],487:[[103,780]],488:[[75,780]],489:[[107,780]],490:[[79,808],,{772:492}],491:[[111,808],,{772:493}],492:[[490,772]],493:[[491,772]],494:[[439,780]],495:[[658,780]],496:[[106,780]],497:[[68,90],256],498:[[68,122],256],499:[[100,122],256],500:[[71,769]],501:[[103,769]],504:[[78,768]],505:[[110,768]],506:[[197,769]],507:[[229,769]],508:[[198,769]],509:[[230,769]],510:[[216,769]],511:[[248,769]],66045:[,220]},512:{512:[[65,783]],513:[[97,783]],514:[[65,785]],515:[[97,785]],516:[[69,783]],517:[[101,783]],518:[[69,785]],519:[[101,785]],520:[[73,783]],521:[[105,783]],522:[[73,785]],523:[[105,785]],524:[[79,783]],525:[[111,783]],526:[[79,785]],527:[[111,785]],528:[[82,783]],529:[[114,783]],530:[[82,785]],531:[[114,785]],532:[[85,783]],533:[[117,783]],534:[[85,785]],535:[[117,785]],536:[[83,806]],537:[[115,806]],538:[[84,806]],539:[[116,806]],542:[[72,780]],543:[[104,780]],550:[[65,775],,{772:480}],551:[[97,775],,{772:481}],552:[[69,807],,{774:7708}],553:[[101,807],,{774:7709}],554:[[214,772]],555:[[246,772]],556:[[213,772]],557:[[245,772]],558:[[79,775],,{772:560}],559:[[111,775],,{772:561}],560:[[558,772]],561:[[559,772]],562:[[89,772]],563:[[121,772]],658:[,,{780:495}],688:[[104],256],689:[[614],256],690:[[106],256],691:[[114],256],692:[[633],256],693:[[635],256],694:[[641],256],695:[[119],256],696:[[121],256],728:[[32,774],256],729:[[32,775],256],730:[[32,778],256],731:[[32,808],256],732:[[32,771],256],733:[[32,779],256],736:[[611],256],737:[[108],256],738:[[115],256],739:[[120],256],740:[[661],256],66272:[,220]},768:{768:[,230],769:[,230],770:[,230],771:[,230],772:[,230],773:[,230],774:[,230],775:[,230],776:[,230,{769:836}],777:[,230],778:[,230],779:[,230],780:[,230],781:[,230],782:[,230],783:[,230],784:[,230],785:[,230],786:[,230],787:[,230],788:[,230],789:[,232],790:[,220],791:[,220],792:[,220],793:[,220],794:[,232],795:[,216],796:[,220],797:[,220],798:[,220],799:[,220],800:[,220],801:[,202],802:[,202],803:[,220],804:[,220],805:[,220],806:[,220],807:[,202],808:[,202],809:[,220],810:[,220],811:[,220],812:[,220],813:[,220],814:[,220],815:[,220],816:[,220],817:[,220],818:[,220],819:[,220],820:[,1],821:[,1],822:[,1],823:[,1],824:[,1],825:[,220],826:[,220],827:[,220],828:[,220],829:[,230],830:[,230],831:[,230],832:[[768],230],833:[[769],230],834:[,230],835:[[787],230],836:[[776,769],230],837:[,240],838:[,230],839:[,220],840:[,220],841:[,220],842:[,230],843:[,230],844:[,230],845:[,220],846:[,220],848:[,230],849:[,230],850:[,230],851:[,220],852:[,220],853:[,220],854:[,220],855:[,230],856:[,232],857:[,220],858:[,220],859:[,230],860:[,233],861:[,234],862:[,234],863:[,233],864:[,234],865:[,234],866:[,233],867:[,230],868:[,230],869:[,230],870:[,230],871:[,230],872:[,230],873:[,230],874:[,230],875:[,230],876:[,230],877:[,230],878:[,230],879:[,230],884:[[697]],890:[[32,837],256],894:[[59]],900:[[32,769],256],901:[[168,769]],902:[[913,769]],903:[[183]],904:[[917,769]],905:[[919,769]],906:[[921,769]],908:[[927,769]],910:[[933,769]],911:[[937,769]],912:[[970,769]],913:[,,{768:8122,769:902,772:8121,774:8120,787:7944,788:7945,837:8124}],917:[,,{768:8136,769:904,787:7960,788:7961}],919:[,,{768:8138,769:905,787:7976,788:7977,837:8140}],921:[,,{768:8154,769:906,772:8153,774:8152,776:938,787:7992,788:7993}],927:[,,{768:8184,769:908,787:8008,788:8009}],929:[,,{788:8172}],933:[,,{768:8170,769:910,772:8169,774:8168,776:939,788:8025}],937:[,,{768:8186,769:911,787:8040,788:8041,837:8188}],938:[[921,776]],939:[[933,776]],940:[[945,769],,{837:8116}],941:[[949,769]],942:[[951,769],,{837:8132}],943:[[953,769]],944:[[971,769]],945:[,,{768:8048,769:940,772:8113,774:8112,787:7936,788:7937,834:8118,837:8115}],949:[,,{768:8050,769:941,787:7952,788:7953}],951:[,,{768:8052,769:942,787:7968,788:7969,834:8134,837:8131}],953:[,,{768:8054,769:943,772:8145,774:8144,776:970,787:7984,788:7985,834:8150}],959:[,,{768:8056,769:972,787:8e3,788:8001}],961:[,,{787:8164,788:8165}],965:[,,{768:8058,769:973,772:8161,774:8160,776:971,787:8016,788:8017,834:8166}],969:[,,{768:8060,769:974,787:8032,788:8033,834:8182,837:8179}],970:[[953,776],,{768:8146,769:912,834:8151}],971:[[965,776],,{768:8162,769:944,834:8167}],972:[[959,769]],973:[[965,769]],974:[[969,769],,{837:8180}],976:[[946],256],977:[[952],256],978:[[933],256,{769:979,776:980}],979:[[978,769]],980:[[978,776]],981:[[966],256],982:[[960],256],1008:[[954],256],1009:[[961],256],1010:[[962],256],1012:[[920],256],1013:[[949],256],1017:[[931],256],66422:[,230],66423:[,230],66424:[,230],66425:[,230],66426:[,230]},1024:{1024:[[1045,768]],1025:[[1045,776]],1027:[[1043,769]],1030:[,,{776:1031}],1031:[[1030,776]],1036:[[1050,769]],1037:[[1048,768]],1038:[[1059,774]],1040:[,,{774:1232,776:1234}],1043:[,,{769:1027}],1045:[,,{768:1024,774:1238,776:1025}],1046:[,,{774:1217,776:1244}],1047:[,,{776:1246}],1048:[,,{768:1037,772:1250,774:1049,776:1252}],1049:[[1048,774]],1050:[,,{769:1036}],1054:[,,{776:1254}],1059:[,,{772:1262,774:1038,776:1264,779:1266}],1063:[,,{776:1268}],1067:[,,{776:1272}],1069:[,,{776:1260}],1072:[,,{774:1233,776:1235}],1075:[,,{769:1107}],1077:[,,{768:1104,774:1239,776:1105}],1078:[,,{774:1218,776:1245}],1079:[,,{776:1247}],1080:[,,{768:1117,772:1251,774:1081,776:1253}],1081:[[1080,774]],1082:[,,{769:1116}],1086:[,,{776:1255}],1091:[,,{772:1263,774:1118,776:1265,779:1267}],1095:[,,{776:1269}],1099:[,,{776:1273}],1101:[,,{776:1261}],1104:[[1077,768]],1105:[[1077,776]],1107:[[1075,769]],1110:[,,{776:1111}],1111:[[1110,776]],1116:[[1082,769]],1117:[[1080,768]],1118:[[1091,774]],1140:[,,{783:1142}],1141:[,,{783:1143}],1142:[[1140,783]],1143:[[1141,783]],1155:[,230],1156:[,230],1157:[,230],1158:[,230],1159:[,230],1217:[[1046,774]],1218:[[1078,774]],1232:[[1040,774]],1233:[[1072,774]],1234:[[1040,776]],1235:[[1072,776]],1238:[[1045,774]],1239:[[1077,774]],1240:[,,{776:1242}],1241:[,,{776:1243}],1242:[[1240,776]],1243:[[1241,776]],1244:[[1046,776]],1245:[[1078,776]],1246:[[1047,776]],1247:[[1079,776]],1250:[[1048,772]],1251:[[1080,772]],1252:[[1048,776]],1253:[[1080,776]],1254:[[1054,776]],1255:[[1086,776]],1256:[,,{776:1258}],1257:[,,{776:1259}],1258:[[1256,776]],1259:[[1257,776]],1260:[[1069,776]],1261:[[1101,776]],1262:[[1059,772]],1263:[[1091,772]],1264:[[1059,776]],1265:[[1091,776]],1266:[[1059,779]],1267:[[1091,779]],1268:[[1063,776]],1269:[[1095,776]],1272:[[1067,776]],1273:[[1099,776]]},1280:{1415:[[1381,1410],256],1425:[,220],1426:[,230],1427:[,230],1428:[,230],1429:[,230],1430:[,220],1431:[,230],1432:[,230],1433:[,230],1434:[,222],1435:[,220],1436:[,230],1437:[,230],1438:[,230],1439:[,230],1440:[,230],1441:[,230],1442:[,220],1443:[,220],1444:[,220],1445:[,220],1446:[,220],1447:[,220],1448:[,230],1449:[,230],1450:[,220],1451:[,230],1452:[,230],1453:[,222],1454:[,228],1455:[,230],1456:[,10],1457:[,11],1458:[,12],1459:[,13],1460:[,14],1461:[,15],1462:[,16],1463:[,17],1464:[,18],1465:[,19],1466:[,19],1467:[,20],1468:[,21],1469:[,22],1471:[,23],1473:[,24],1474:[,25],1476:[,230],1477:[,220],1479:[,18]},1536:{1552:[,230],1553:[,230],1554:[,230],1555:[,230],1556:[,230],1557:[,230],1558:[,230],1559:[,230],1560:[,30],1561:[,31],1562:[,32],1570:[[1575,1619]],1571:[[1575,1620]],1572:[[1608,1620]],1573:[[1575,1621]],1574:[[1610,1620]],1575:[,,{1619:1570,1620:1571,1621:1573}],1608:[,,{1620:1572}],1610:[,,{1620:1574}],1611:[,27],1612:[,28],1613:[,29],1614:[,30],1615:[,31],1616:[,32],1617:[,33],1618:[,34],1619:[,230],1620:[,230],1621:[,220],1622:[,220],1623:[,230],1624:[,230],1625:[,230],1626:[,230],1627:[,230],1628:[,220],1629:[,230],1630:[,230],1631:[,220],1648:[,35],1653:[[1575,1652],256],1654:[[1608,1652],256],1655:[[1735,1652],256],1656:[[1610,1652],256],1728:[[1749,1620]],1729:[,,{1620:1730}],1730:[[1729,1620]],1746:[,,{1620:1747}],1747:[[1746,1620]],1749:[,,{1620:1728}],1750:[,230],1751:[,230],1752:[,230],1753:[,230],1754:[,230],1755:[,230],1756:[,230],1759:[,230],1760:[,230],1761:[,230],1762:[,230],1763:[,220],1764:[,230],1767:[,230],1768:[,230],1770:[,220],1771:[,230],1772:[,230],1773:[,220]},1792:{1809:[,36],1840:[,230],1841:[,220],1842:[,230],1843:[,230],1844:[,220],1845:[,230],1846:[,230],1847:[,220],1848:[,220],1849:[,220],1850:[,230],1851:[,220],1852:[,220],1853:[,230],1854:[,220],1855:[,230],1856:[,230],1857:[,230],1858:[,220],1859:[,230],1860:[,220],1861:[,230],1862:[,220],1863:[,230],1864:[,220],1865:[,230],1866:[,230],2027:[,230],2028:[,230],2029:[,230],2030:[,230],2031:[,230],2032:[,230],2033:[,230],2034:[,220],2035:[,230]},2048:{2070:[,230],2071:[,230],2072:[,230],2073:[,230],2075:[,230],2076:[,230],2077:[,230],2078:[,230],2079:[,230],2080:[,230],2081:[,230],2082:[,230],2083:[,230],2085:[,230],2086:[,230],2087:[,230],2089:[,230],2090:[,230],2091:[,230],2092:[,230],2093:[,230],2137:[,220],2138:[,220],2139:[,220],2276:[,230],2277:[,230],2278:[,220],2279:[,230],2280:[,230],2281:[,220],2282:[,230],2283:[,230],2284:[,230],2285:[,220],2286:[,220],2287:[,220],2288:[,27],2289:[,28],2290:[,29],2291:[,230],2292:[,230],2293:[,230],2294:[,220],2295:[,230],2296:[,230],2297:[,220],2298:[,220],2299:[,230],2300:[,230],2301:[,230],2302:[,230],2303:[,230]},2304:{2344:[,,{2364:2345}],2345:[[2344,2364]],2352:[,,{2364:2353}],2353:[[2352,2364]],2355:[,,{2364:2356}],2356:[[2355,2364]],2364:[,7],2381:[,9],2385:[,230],2386:[,220],2387:[,230],2388:[,230],2392:[[2325,2364],512],2393:[[2326,2364],512],2394:[[2327,2364],512],2395:[[2332,2364],512],2396:[[2337,2364],512],2397:[[2338,2364],512],2398:[[2347,2364],512],2399:[[2351,2364],512],2492:[,7],2503:[,,{2494:2507,2519:2508}],2507:[[2503,2494]],2508:[[2503,2519]],2509:[,9],2524:[[2465,2492],512],2525:[[2466,2492],512],2527:[[2479,2492],512]},2560:{2611:[[2610,2620],512],2614:[[2616,2620],512],2620:[,7],2637:[,9],2649:[[2582,2620],512],2650:[[2583,2620],512],2651:[[2588,2620],512],2654:[[2603,2620],512],2748:[,7],2765:[,9],68109:[,220],68111:[,230],68152:[,230],68153:[,1],68154:[,220],68159:[,9],68325:[,230],68326:[,220]},2816:{2876:[,7],2887:[,,{2878:2891,2902:2888,2903:2892}],2888:[[2887,2902]],2891:[[2887,2878]],2892:[[2887,2903]],2893:[,9],2908:[[2849,2876],512],2909:[[2850,2876],512],2962:[,,{3031:2964}],2964:[[2962,3031]],3014:[,,{3006:3018,3031:3020}],3015:[,,{3006:3019}],3018:[[3014,3006]],3019:[[3015,3006]],3020:[[3014,3031]],3021:[,9]},3072:{3142:[,,{3158:3144}],3144:[[3142,3158]],3149:[,9],3157:[,84],3158:[,91],3260:[,7],3263:[,,{3285:3264}],3264:[[3263,3285]],3270:[,,{3266:3274,3285:3271,3286:3272}],3271:[[3270,3285]],3272:[[3270,3286]],3274:[[3270,3266],,{3285:3275}],3275:[[3274,3285]],3277:[,9]},3328:{3398:[,,{3390:3402,3415:3404}],3399:[,,{3390:3403}],3402:[[3398,3390]],3403:[[3399,3390]],3404:[[3398,3415]],3405:[,9],3530:[,9],3545:[,,{3530:3546,3535:3548,3551:3550}],3546:[[3545,3530]],3548:[[3545,3535],,{3530:3549}],3549:[[3548,3530]],3550:[[3545,3551]]},3584:{3635:[[3661,3634],256],3640:[,103],3641:[,103],3642:[,9],3656:[,107],3657:[,107],3658:[,107],3659:[,107],3763:[[3789,3762],256],3768:[,118],3769:[,118],3784:[,122],3785:[,122],3786:[,122],3787:[,122],3804:[[3755,3737],256],3805:[[3755,3745],256]},3840:{3852:[[3851],256],3864:[,220],3865:[,220],3893:[,220],3895:[,220],3897:[,216],3907:[[3906,4023],512],3917:[[3916,4023],512],3922:[[3921,4023],512],3927:[[3926,4023],512],3932:[[3931,4023],512],3945:[[3904,4021],512],3953:[,129],3954:[,130],3955:[[3953,3954],512],3956:[,132],3957:[[3953,3956],512],3958:[[4018,3968],512],3959:[[4018,3969],256],3960:[[4019,3968],512],3961:[[4019,3969],256],3962:[,130],3963:[,130],3964:[,130],3965:[,130],3968:[,130],3969:[[3953,3968],512],3970:[,230],3971:[,230],3972:[,9],3974:[,230],3975:[,230],3987:[[3986,4023],512],3997:[[3996,4023],512],4002:[[4001,4023],512],4007:[[4006,4023],512],4012:[[4011,4023],512],4025:[[3984,4021],512],4038:[,220]},4096:{4133:[,,{4142:4134}],4134:[[4133,4142]],4151:[,7],4153:[,9],4154:[,9],4237:[,220],4348:[[4316],256],69702:[,9],69759:[,9],69785:[,,{69818:69786}],69786:[[69785,69818]],69787:[,,{69818:69788}],69788:[[69787,69818]],69797:[,,{69818:69803}],69803:[[69797,69818]],69817:[,9],69818:[,7]},4352:{69888:[,230],69889:[,230],69890:[,230],69934:[[69937,69927]],69935:[[69938,69927]],69937:[,,{69927:69934}],69938:[,,{69927:69935}],69939:[,9],69940:[,9],70003:[,7],70080:[,9]},4608:{70197:[,9],70198:[,7],70377:[,7],70378:[,9]},4864:{4957:[,230],4958:[,230],4959:[,230],70460:[,7],70471:[,,{70462:70475,70487:70476}],70475:[[70471,70462]],70476:[[70471,70487]],70477:[,9],70502:[,230],70503:[,230],70504:[,230],70505:[,230],70506:[,230],70507:[,230],70508:[,230],70512:[,230],70513:[,230],70514:[,230],70515:[,230],70516:[,230]},5120:{70841:[,,{70832:70844,70842:70843,70845:70846}],70843:[[70841,70842]],70844:[[70841,70832]],70846:[[70841,70845]],70850:[,9],70851:[,7]},5376:{71096:[,,{71087:71098}],71097:[,,{71087:71099}],71098:[[71096,71087]],71099:[[71097,71087]],71103:[,9],71104:[,7]},5632:{71231:[,9],71350:[,9],71351:[,7]},5888:{5908:[,9],5940:[,9],6098:[,9],6109:[,230]},6144:{6313:[,228]},6400:{6457:[,222],6458:[,230],6459:[,220]},6656:{6679:[,230],6680:[,220],6752:[,9],6773:[,230],6774:[,230],6775:[,230],6776:[,230],6777:[,230],6778:[,230],6779:[,230],6780:[,230],6783:[,220],6832:[,230],6833:[,230],6834:[,230],6835:[,230],6836:[,230],6837:[,220],6838:[,220],6839:[,220],6840:[,220],6841:[,220],6842:[,220],6843:[,230],6844:[,230],6845:[,220]},6912:{6917:[,,{6965:6918}],6918:[[6917,6965]],6919:[,,{6965:6920}],6920:[[6919,6965]],6921:[,,{6965:6922}],6922:[[6921,6965]],6923:[,,{6965:6924}],6924:[[6923,6965]],6925:[,,{6965:6926}],6926:[[6925,6965]],6929:[,,{6965:6930}],6930:[[6929,6965]],6964:[,7],6970:[,,{6965:6971}],6971:[[6970,6965]],6972:[,,{6965:6973}],6973:[[6972,6965]],6974:[,,{6965:6976}],6975:[,,{6965:6977}],6976:[[6974,6965]],6977:[[6975,6965]],6978:[,,{6965:6979}],6979:[[6978,6965]],6980:[,9],7019:[,230],7020:[,220],7021:[,230],7022:[,230],7023:[,230],7024:[,230],7025:[,230],7026:[,230],7027:[,230],7082:[,9],7083:[,9],7142:[,7],7154:[,9],7155:[,9]},7168:{7223:[,7],7376:[,230],7377:[,230],7378:[,230],7380:[,1],7381:[,220],7382:[,220],7383:[,220],7384:[,220],7385:[,220],7386:[,230],7387:[,230],7388:[,220],7389:[,220],7390:[,220],7391:[,220],7392:[,230],7394:[,1],7395:[,1],7396:[,1],7397:[,1],7398:[,1],7399:[,1],7400:[,1],7405:[,220],7412:[,230],7416:[,230],7417:[,230]},7424:{7468:[[65],256],7469:[[198],256],7470:[[66],256],7472:[[68],256],7473:[[69],256],7474:[[398],256],7475:[[71],256],7476:[[72],256],7477:[[73],256],7478:[[74],256],7479:[[75],256],7480:[[76],256],7481:[[77],256],7482:[[78],256],7484:[[79],256],7485:[[546],256],7486:[[80],256],7487:[[82],256],7488:[[84],256],7489:[[85],256],7490:[[87],256],7491:[[97],256],7492:[[592],256],7493:[[593],256],7494:[[7426],256],7495:[[98],256],7496:[[100],256],7497:[[101],256],7498:[[601],256],7499:[[603],256],7500:[[604],256],7501:[[103],256],7503:[[107],256],7504:[[109],256],7505:[[331],256],7506:[[111],256],7507:[[596],256],7508:[[7446],256],7509:[[7447],256],7510:[[112],256],7511:[[116],256],7512:[[117],256],7513:[[7453],256],7514:[[623],256],7515:[[118],256],7516:[[7461],256],7517:[[946],256],7518:[[947],256],7519:[[948],256],7520:[[966],256],7521:[[967],256],7522:[[105],256],7523:[[114],256],7524:[[117],256],7525:[[118],256],7526:[[946],256],7527:[[947],256],7528:[[961],256],7529:[[966],256],7530:[[967],256],7544:[[1085],256],7579:[[594],256],7580:[[99],256],7581:[[597],256],7582:[[240],256],7583:[[604],256],7584:[[102],256],7585:[[607],256],7586:[[609],256],7587:[[613],256],7588:[[616],256],7589:[[617],256],7590:[[618],256],7591:[[7547],256],7592:[[669],256],7593:[[621],256],7594:[[7557],256],7595:[[671],256],7596:[[625],256],7597:[[624],256],7598:[[626],256],7599:[[627],256],7600:[[628],256],7601:[[629],256],7602:[[632],256],7603:[[642],256],7604:[[643],256],7605:[[427],256],7606:[[649],256],7607:[[650],256],7608:[[7452],256],7609:[[651],256],7610:[[652],256],7611:[[122],256],7612:[[656],256],7613:[[657],256],7614:[[658],256],7615:[[952],256],7616:[,230],7617:[,230],7618:[,220],7619:[,230],7620:[,230],7621:[,230],7622:[,230],7623:[,230],7624:[,230],7625:[,230],7626:[,220],7627:[,230],7628:[,230],7629:[,234],7630:[,214],7631:[,220],7632:[,202],7633:[,230],7634:[,230],7635:[,230],7636:[,230],7637:[,230],7638:[,230],7639:[,230],7640:[,230],7641:[,230],7642:[,230],7643:[,230],7644:[,230],7645:[,230],7646:[,230],7647:[,230],7648:[,230],7649:[,230],7650:[,230],7651:[,230],7652:[,230],7653:[,230],7654:[,230],7655:[,230],7656:[,230],7657:[,230],7658:[,230],7659:[,230],7660:[,230],7661:[,230],7662:[,230],7663:[,230],7664:[,230],7665:[,230],7666:[,230],7667:[,230],7668:[,230],7669:[,230],7676:[,233],7677:[,220],7678:[,230],7679:[,220]},7680:{7680:[[65,805]],7681:[[97,805]],7682:[[66,775]],7683:[[98,775]],7684:[[66,803]],7685:[[98,803]],7686:[[66,817]],7687:[[98,817]],7688:[[199,769]],7689:[[231,769]],7690:[[68,775]],7691:[[100,775]],7692:[[68,803]],7693:[[100,803]],7694:[[68,817]],7695:[[100,817]],7696:[[68,807]],7697:[[100,807]],7698:[[68,813]],7699:[[100,813]],7700:[[274,768]],7701:[[275,768]],7702:[[274,769]],7703:[[275,769]],7704:[[69,813]],7705:[[101,813]],7706:[[69,816]],7707:[[101,816]],7708:[[552,774]],7709:[[553,774]],7710:[[70,775]],7711:[[102,775]],7712:[[71,772]],7713:[[103,772]],7714:[[72,775]],7715:[[104,775]],7716:[[72,803]],7717:[[104,803]],7718:[[72,776]],7719:[[104,776]],7720:[[72,807]],7721:[[104,807]],7722:[[72,814]],7723:[[104,814]],7724:[[73,816]],7725:[[105,816]],7726:[[207,769]],7727:[[239,769]],7728:[[75,769]],7729:[[107,769]],7730:[[75,803]],7731:[[107,803]],7732:[[75,817]],7733:[[107,817]],7734:[[76,803],,{772:7736}],7735:[[108,803],,{772:7737}],7736:[[7734,772]],7737:[[7735,772]],7738:[[76,817]],7739:[[108,817]],7740:[[76,813]],7741:[[108,813]],7742:[[77,769]],7743:[[109,769]],7744:[[77,775]],7745:[[109,775]],7746:[[77,803]],7747:[[109,803]],7748:[[78,775]],7749:[[110,775]],7750:[[78,803]],7751:[[110,803]],7752:[[78,817]],7753:[[110,817]],7754:[[78,813]],7755:[[110,813]],7756:[[213,769]],7757:[[245,769]],7758:[[213,776]],7759:[[245,776]],7760:[[332,768]],7761:[[333,768]],7762:[[332,769]],7763:[[333,769]],7764:[[80,769]],7765:[[112,769]],7766:[[80,775]],7767:[[112,775]],7768:[[82,775]],7769:[[114,775]],7770:[[82,803],,{772:7772}],7771:[[114,803],,{772:7773}],7772:[[7770,772]],7773:[[7771,772]],7774:[[82,817]],7775:[[114,817]],7776:[[83,775]],7777:[[115,775]],7778:[[83,803],,{775:7784}],7779:[[115,803],,{775:7785}],7780:[[346,775]],7781:[[347,775]],7782:[[352,775]],7783:[[353,775]],7784:[[7778,775]],7785:[[7779,775]],7786:[[84,775]],7787:[[116,775]],7788:[[84,803]],7789:[[116,803]],7790:[[84,817]],7791:[[116,817]],7792:[[84,813]],7793:[[116,813]],7794:[[85,804]],7795:[[117,804]],7796:[[85,816]],7797:[[117,816]],7798:[[85,813]],7799:[[117,813]],7800:[[360,769]],7801:[[361,769]],7802:[[362,776]],7803:[[363,776]],7804:[[86,771]],7805:[[118,771]],7806:[[86,803]],7807:[[118,803]],7808:[[87,768]],7809:[[119,768]],7810:[[87,769]],7811:[[119,769]],7812:[[87,776]],7813:[[119,776]],7814:[[87,775]],7815:[[119,775]],7816:[[87,803]],7817:[[119,803]],7818:[[88,775]],7819:[[120,775]],7820:[[88,776]],7821:[[120,776]],7822:[[89,775]],7823:[[121,775]],7824:[[90,770]],7825:[[122,770]],7826:[[90,803]],7827:[[122,803]],7828:[[90,817]],7829:[[122,817]],7830:[[104,817]],7831:[[116,776]],7832:[[119,778]],7833:[[121,778]],7834:[[97,702],256],7835:[[383,775]],7840:[[65,803],,{770:7852,774:7862}],7841:[[97,803],,{770:7853,774:7863}],7842:[[65,777]],7843:[[97,777]],7844:[[194,769]],7845:[[226,769]],7846:[[194,768]],7847:[[226,768]],7848:[[194,777]],7849:[[226,777]],7850:[[194,771]],7851:[[226,771]],7852:[[7840,770]],7853:[[7841,770]],7854:[[258,769]],7855:[[259,769]],7856:[[258,768]],7857:[[259,768]],7858:[[258,777]],7859:[[259,777]],7860:[[258,771]],7861:[[259,771]],7862:[[7840,774]],7863:[[7841,774]],7864:[[69,803],,{770:7878}],7865:[[101,803],,{770:7879}],7866:[[69,777]],7867:[[101,777]],7868:[[69,771]],7869:[[101,771]],7870:[[202,769]],7871:[[234,769]],7872:[[202,768]],7873:[[234,768]],7874:[[202,777]],7875:[[234,777]],7876:[[202,771]],7877:[[234,771]],7878:[[7864,770]],7879:[[7865,770]],7880:[[73,777]],7881:[[105,777]],7882:[[73,803]],7883:[[105,803]],7884:[[79,803],,{770:7896}],7885:[[111,803],,{770:7897}],7886:[[79,777]],7887:[[111,777]],7888:[[212,769]],7889:[[244,769]],7890:[[212,768]],7891:[[244,768]],7892:[[212,777]],7893:[[244,777]],7894:[[212,771]],7895:[[244,771]],7896:[[7884,770]],7897:[[7885,770]],7898:[[416,769]],7899:[[417,769]],7900:[[416,768]],7901:[[417,768]],7902:[[416,777]],7903:[[417,777]],7904:[[416,771]],7905:[[417,771]],7906:[[416,803]],7907:[[417,803]],7908:[[85,803]],7909:[[117,803]],7910:[[85,777]],7911:[[117,777]],7912:[[431,769]],7913:[[432,769]],7914:[[431,768]],7915:[[432,768]],7916:[[431,777]],7917:[[432,777]],7918:[[431,771]],7919:[[432,771]],7920:[[431,803]],7921:[[432,803]],7922:[[89,768]],7923:[[121,768]],7924:[[89,803]],7925:[[121,803]],7926:[[89,777]],7927:[[121,777]],7928:[[89,771]],7929:[[121,771]]},7936:{7936:[[945,787],,{768:7938,769:7940,834:7942,837:8064}],7937:[[945,788],,{768:7939,769:7941,834:7943,837:8065}],7938:[[7936,768],,{837:8066}],7939:[[7937,768],,{837:8067}],7940:[[7936,769],,{837:8068}],7941:[[7937,769],,{837:8069}],7942:[[7936,834],,{837:8070}],7943:[[7937,834],,{837:8071}],7944:[[913,787],,{768:7946,769:7948,834:7950,837:8072}],7945:[[913,788],,{768:7947,769:7949,834:7951,837:8073}],7946:[[7944,768],,{837:8074}],7947:[[7945,768],,{837:8075}],7948:[[7944,769],,{837:8076}],7949:[[7945,769],,{837:8077}],7950:[[7944,834],,{837:8078}],7951:[[7945,834],,{837:8079}],7952:[[949,787],,{768:7954,769:7956}],7953:[[949,788],,{768:7955,769:7957}],7954:[[7952,768]],7955:[[7953,768]],7956:[[7952,769]],7957:[[7953,769]],7960:[[917,787],,{768:7962,769:7964}],7961:[[917,788],,{768:7963,769:7965}],7962:[[7960,768]],7963:[[7961,768]],7964:[[7960,769]],7965:[[7961,769]],7968:[[951,787],,{768:7970,769:7972,834:7974,837:8080}],7969:[[951,788],,{768:7971,769:7973,834:7975,837:8081}],7970:[[7968,768],,{837:8082}],7971:[[7969,768],,{837:8083}],7972:[[7968,769],,{837:8084}],7973:[[7969,769],,{837:8085}],7974:[[7968,834],,{837:8086}],7975:[[7969,834],,{837:8087}],7976:[[919,787],,{768:7978,769:7980,834:7982,837:8088}],7977:[[919,788],,{768:7979,769:7981,834:7983,837:8089}],7978:[[7976,768],,{837:8090}],7979:[[7977,768],,{837:8091}],7980:[[7976,769],,{837:8092}],7981:[[7977,769],,{837:8093}],7982:[[7976,834],,{837:8094}],7983:[[7977,834],,{837:8095}],7984:[[953,787],,{768:7986,769:7988,834:7990}],7985:[[953,788],,{768:7987,769:7989,834:7991}],7986:[[7984,768]],7987:[[7985,768]],7988:[[7984,769]],7989:[[7985,769]],7990:[[7984,834]],7991:[[7985,834]],7992:[[921,787],,{768:7994,769:7996,834:7998}],7993:[[921,788],,{768:7995,769:7997,834:7999}],7994:[[7992,768]],7995:[[7993,768]],7996:[[7992,769]],7997:[[7993,769]],7998:[[7992,834]],7999:[[7993,834]],8e3:[[959,787],,{768:8002,769:8004}],8001:[[959,788],,{768:8003,769:8005}],8002:[[8e3,768]],8003:[[8001,768]],8004:[[8e3,769]],8005:[[8001,769]],8008:[[927,787],,{768:8010,769:8012}],8009:[[927,788],,{768:8011,769:8013}],8010:[[8008,768]],8011:[[8009,768]],8012:[[8008,769]],8013:[[8009,769]],8016:[[965,787],,{768:8018,769:8020,834:8022}],8017:[[965,788],,{768:8019,769:8021,834:8023}],8018:[[8016,768]],8019:[[8017,768]],8020:[[8016,769]],8021:[[8017,769]],8022:[[8016,834]],8023:[[8017,834]],8025:[[933,788],,{768:8027,769:8029,834:8031}],8027:[[8025,768]],8029:[[8025,769]],8031:[[8025,834]],8032:[[969,787],,{768:8034,769:8036,834:8038,837:8096}],8033:[[969,788],,{768:8035,769:8037,834:8039,837:8097}],8034:[[8032,768],,{837:8098}],8035:[[8033,768],,{837:8099}],8036:[[8032,769],,{837:8100}],8037:[[8033,769],,{837:8101}],8038:[[8032,834],,{837:8102}],8039:[[8033,834],,{837:8103}],8040:[[937,787],,{768:8042,769:8044,834:8046,837:8104}],8041:[[937,788],,{768:8043,769:8045,834:8047,837:8105}],8042:[[8040,768],,{837:8106}],8043:[[8041,768],,{837:8107}],8044:[[8040,769],,{837:8108}],8045:[[8041,769],,{837:8109}],8046:[[8040,834],,{837:8110}],8047:[[8041,834],,{837:8111}],8048:[[945,768],,{837:8114}],8049:[[940]],8050:[[949,768]],8051:[[941]],8052:[[951,768],,{837:8130}],8053:[[942]],8054:[[953,768]],8055:[[943]],8056:[[959,768]],8057:[[972]],8058:[[965,768]],8059:[[973]],8060:[[969,768],,{837:8178}],8061:[[974]],8064:[[7936,837]],8065:[[7937,837]],8066:[[7938,837]],8067:[[7939,837]],8068:[[7940,837]],8069:[[7941,837]],8070:[[7942,837]],8071:[[7943,837]],8072:[[7944,837]],8073:[[7945,837]],8074:[[7946,837]],8075:[[7947,837]],8076:[[7948,837]],8077:[[7949,837]],8078:[[7950,837]],8079:[[7951,837]],8080:[[7968,837]],8081:[[7969,837]],8082:[[7970,837]],8083:[[7971,837]],8084:[[7972,837]],8085:[[7973,837]],8086:[[7974,837]],8087:[[7975,837]],8088:[[7976,837]],8089:[[7977,837]],8090:[[7978,837]],8091:[[7979,837]],8092:[[7980,837]],8093:[[7981,837]],8094:[[7982,837]],8095:[[7983,837]],8096:[[8032,837]],8097:[[8033,837]],8098:[[8034,837]],8099:[[8035,837]],8100:[[8036,837]],8101:[[8037,837]],8102:[[8038,837]],8103:[[8039,837]],8104:[[8040,837]],8105:[[8041,837]],8106:[[8042,837]],8107:[[8043,837]],8108:[[8044,837]],8109:[[8045,837]],8110:[[8046,837]],8111:[[8047,837]],8112:[[945,774]],8113:[[945,772]],8114:[[8048,837]],8115:[[945,837]],8116:[[940,837]],8118:[[945,834],,{837:8119}],8119:[[8118,837]],8120:[[913,774]],8121:[[913,772]],8122:[[913,768]],8123:[[902]],8124:[[913,837]],8125:[[32,787],256],8126:[[953]],8127:[[32,787],256,{768:8141,769:8142,834:8143}],8128:[[32,834],256],8129:[[168,834]],8130:[[8052,837]],8131:[[951,837]],8132:[[942,837]],8134:[[951,834],,{837:8135}],8135:[[8134,837]],8136:[[917,768]],8137:[[904]],8138:[[919,768]],8139:[[905]],8140:[[919,837]],8141:[[8127,768]],8142:[[8127,769]],8143:[[8127,834]],8144:[[953,774]],8145:[[953,772]],8146:[[970,768]],8147:[[912]],8150:[[953,834]],8151:[[970,834]],8152:[[921,774]],8153:[[921,772]],8154:[[921,768]],8155:[[906]],8157:[[8190,768]],8158:[[8190,769]],8159:[[8190,834]],8160:[[965,774]],8161:[[965,772]],8162:[[971,768]],8163:[[944]],8164:[[961,787]],8165:[[961,788]],8166:[[965,834]],8167:[[971,834]],8168:[[933,774]],8169:[[933,772]],8170:[[933,768]],8171:[[910]],8172:[[929,788]],8173:[[168,768]],8174:[[901]],8175:[[96]],8178:[[8060,837]],8179:[[969,837]],8180:[[974,837]],8182:[[969,834],,{837:8183}],8183:[[8182,837]],8184:[[927,768]],8185:[[908]],8186:[[937,768]],8187:[[911]],8188:[[937,837]],8189:[[180]],8190:[[32,788],256,{768:8157,769:8158,834:8159}]},8192:{8192:[[8194]],8193:[[8195]],8194:[[32],256],8195:[[32],256],8196:[[32],256],8197:[[32],256],8198:[[32],256],8199:[[32],256],8200:[[32],256],8201:[[32],256],8202:[[32],256],8209:[[8208],256],8215:[[32,819],256],8228:[[46],256],8229:[[46,46],256],8230:[[46,46,46],256],8239:[[32],256],8243:[[8242,8242],256],8244:[[8242,8242,8242],256],8246:[[8245,8245],256],8247:[[8245,8245,8245],256],8252:[[33,33],256],8254:[[32,773],256],8263:[[63,63],256],8264:[[63,33],256],8265:[[33,63],256],8279:[[8242,8242,8242,8242],256],8287:[[32],256],8304:[[48],256],8305:[[105],256],8308:[[52],256],8309:[[53],256],8310:[[54],256],8311:[[55],256],8312:[[56],256],8313:[[57],256],8314:[[43],256],8315:[[8722],256],8316:[[61],256],8317:[[40],256],8318:[[41],256],8319:[[110],256],8320:[[48],256],8321:[[49],256],8322:[[50],256],8323:[[51],256],8324:[[52],256],8325:[[53],256],8326:[[54],256],8327:[[55],256],8328:[[56],256],8329:[[57],256],8330:[[43],256],8331:[[8722],256],8332:[[61],256],8333:[[40],256],8334:[[41],256],8336:[[97],256],8337:[[101],256],8338:[[111],256],8339:[[120],256],8340:[[601],256],8341:[[104],256],8342:[[107],256],8343:[[108],256],8344:[[109],256],8345:[[110],256],8346:[[112],256],8347:[[115],256],8348:[[116],256],8360:[[82,115],256],8400:[,230],8401:[,230],8402:[,1],8403:[,1],8404:[,230],8405:[,230],8406:[,230],8407:[,230],8408:[,1],8409:[,1],8410:[,1],8411:[,230],8412:[,230],8417:[,230],8421:[,1],8422:[,1],8423:[,230],8424:[,220],8425:[,230],8426:[,1],8427:[,1],8428:[,220],8429:[,220],8430:[,220],8431:[,220],8432:[,230]},8448:{8448:[[97,47,99],256],8449:[[97,47,115],256],8450:[[67],256],8451:[[176,67],256],8453:[[99,47,111],256],8454:[[99,47,117],256],8455:[[400],256],8457:[[176,70],256],8458:[[103],256],8459:[[72],256],8460:[[72],256],8461:[[72],256],8462:[[104],256],8463:[[295],256],8464:[[73],256],8465:[[73],256],8466:[[76],256],8467:[[108],256],8469:[[78],256],8470:[[78,111],256],8473:[[80],256],8474:[[81],256],8475:[[82],256],8476:[[82],256],8477:[[82],256],8480:[[83,77],256],8481:[[84,69,76],256],8482:[[84,77],256],8484:[[90],256],8486:[[937]],8488:[[90],256],8490:[[75]],8491:[[197]],8492:[[66],256],8493:[[67],256],8495:[[101],256],8496:[[69],256],8497:[[70],256],8499:[[77],256],8500:[[111],256],8501:[[1488],256],8502:[[1489],256],8503:[[1490],256],8504:[[1491],256],8505:[[105],256],8507:[[70,65,88],256],8508:[[960],256],8509:[[947],256],8510:[[915],256],8511:[[928],256],8512:[[8721],256],8517:[[68],256],8518:[[100],256],8519:[[101],256],8520:[[105],256],8521:[[106],256],8528:[[49,8260,55],256],8529:[[49,8260,57],256],8530:[[49,8260,49,48],256],8531:[[49,8260,51],256],8532:[[50,8260,51],256],8533:[[49,8260,53],256],8534:[[50,8260,53],256],8535:[[51,8260,53],256],8536:[[52,8260,53],256],8537:[[49,8260,54],256],8538:[[53,8260,54],256],8539:[[49,8260,56],256],8540:[[51,8260,56],256],8541:[[53,8260,56],256],8542:[[55,8260,56],256],8543:[[49,8260],256],8544:[[73],256],8545:[[73,73],256],8546:[[73,73,73],256],8547:[[73,86],256],8548:[[86],256],8549:[[86,73],256],8550:[[86,73,73],256],8551:[[86,73,73,73],256],8552:[[73,88],256],8553:[[88],256],8554:[[88,73],256],8555:[[88,73,73],256],8556:[[76],256],8557:[[67],256],8558:[[68],256],8559:[[77],256],8560:[[105],256],8561:[[105,105],256],8562:[[105,105,105],256],8563:[[105,118],256],8564:[[118],256],8565:[[118,105],256],8566:[[118,105,105],256],8567:[[118,105,105,105],256],8568:[[105,120],256],8569:[[120],256],8570:[[120,105],256],8571:[[120,105,105],256],8572:[[108],256],8573:[[99],256],8574:[[100],256],8575:[[109],256],8585:[[48,8260,51],256],8592:[,,{824:8602}],8594:[,,{824:8603}],8596:[,,{824:8622}],8602:[[8592,824]],8603:[[8594,824]],8622:[[8596,824]],8653:[[8656,824]],8654:[[8660,824]],8655:[[8658,824]],8656:[,,{824:8653}],8658:[,,{824:8655}],8660:[,,{824:8654}]},8704:{8707:[,,{824:8708}],8708:[[8707,824]],8712:[,,{824:8713}],8713:[[8712,824]],8715:[,,{824:8716}],8716:[[8715,824]],8739:[,,{824:8740}],8740:[[8739,824]],8741:[,,{824:8742}],8742:[[8741,824]],8748:[[8747,8747],256],8749:[[8747,8747,8747],256],8751:[[8750,8750],256],8752:[[8750,8750,8750],256],8764:[,,{824:8769}],8769:[[8764,824]],8771:[,,{824:8772}],8772:[[8771,824]],8773:[,,{824:8775}],8775:[[8773,824]],8776:[,,{824:8777}],8777:[[8776,824]],8781:[,,{824:8813}],8800:[[61,824]],8801:[,,{824:8802}],8802:[[8801,824]],8804:[,,{824:8816}],8805:[,,{824:8817}],8813:[[8781,824]],8814:[[60,824]],8815:[[62,824]],8816:[[8804,824]],8817:[[8805,824]],8818:[,,{824:8820}],8819:[,,{824:8821}],8820:[[8818,824]],8821:[[8819,824]],8822:[,,{824:8824}],8823:[,,{824:8825}],8824:[[8822,824]],8825:[[8823,824]],8826:[,,{824:8832}],8827:[,,{824:8833}],8828:[,,{824:8928}],8829:[,,{824:8929}],8832:[[8826,824]],8833:[[8827,824]],8834:[,,{824:8836}],8835:[,,{824:8837}],8836:[[8834,824]],8837:[[8835,824]],8838:[,,{824:8840}],8839:[,,{824:8841}],8840:[[8838,824]],8841:[[8839,824]],8849:[,,{824:8930}],8850:[,,{824:8931}],8866:[,,{824:8876}],8872:[,,{824:8877}],8873:[,,{824:8878}],8875:[,,{824:8879}],8876:[[8866,824]],8877:[[8872,824]],8878:[[8873,824]],8879:[[8875,824]],8882:[,,{824:8938}],8883:[,,{824:8939}],8884:[,,{824:8940}],8885:[,,{824:8941}],8928:[[8828,824]],8929:[[8829,824]],8930:[[8849,824]],8931:[[8850,824]],8938:[[8882,824]],8939:[[8883,824]],8940:[[8884,824]],8941:[[8885,824]]},8960:{9001:[[12296]],9002:[[12297]]},9216:{9312:[[49],256],9313:[[50],256],9314:[[51],256],9315:[[52],256],9316:[[53],256],9317:[[54],256],9318:[[55],256],9319:[[56],256],9320:[[57],256],9321:[[49,48],256],9322:[[49,49],256],9323:[[49,50],256],9324:[[49,51],256],9325:[[49,52],256],9326:[[49,53],256],9327:[[49,54],256],9328:[[49,55],256],9329:[[49,56],256],9330:[[49,57],256],9331:[[50,48],256],9332:[[40,49,41],256],9333:[[40,50,41],256],9334:[[40,51,41],256],9335:[[40,52,41],256],9336:[[40,53,41],256],9337:[[40,54,41],256],9338:[[40,55,41],256],9339:[[40,56,41],256],9340:[[40,57,41],256],9341:[[40,49,48,41],256],9342:[[40,49,49,41],256],9343:[[40,49,50,41],256],9344:[[40,49,51,41],256],9345:[[40,49,52,41],256],9346:[[40,49,53,41],256],9347:[[40,49,54,41],256],9348:[[40,49,55,41],256],9349:[[40,49,56,41],256],9350:[[40,49,57,41],256],9351:[[40,50,48,41],256],9352:[[49,46],256],9353:[[50,46],256],9354:[[51,46],256],9355:[[52,46],256],9356:[[53,46],256],9357:[[54,46],256],9358:[[55,46],256],9359:[[56,46],256],9360:[[57,46],256],9361:[[49,48,46],256],9362:[[49,49,46],256],9363:[[49,50,46],256],9364:[[49,51,46],256],9365:[[49,52,46],256],9366:[[49,53,46],256],9367:[[49,54,46],256],9368:[[49,55,46],256],9369:[[49,56,46],256],9370:[[49,57,46],256],9371:[[50,48,46],256],9372:[[40,97,41],256],9373:[[40,98,41],256],9374:[[40,99,41],256],9375:[[40,100,41],256],9376:[[40,101,41],256],9377:[[40,102,41],256],9378:[[40,103,41],256],9379:[[40,104,41],256],9380:[[40,105,41],256],9381:[[40,106,41],256],9382:[[40,107,41],256],9383:[[40,108,41],256],9384:[[40,109,41],256],9385:[[40,110,41],256],9386:[[40,111,41],256],9387:[[40,112,41],256],9388:[[40,113,41],256],9389:[[40,114,41],256],9390:[[40,115,41],256],9391:[[40,116,41],256],9392:[[40,117,41],256],9393:[[40,118,41],256],9394:[[40,119,41],256],9395:[[40,120,41],256],9396:[[40,121,41],256],9397:[[40,122,41],256],9398:[[65],256],9399:[[66],256],9400:[[67],256],9401:[[68],256],9402:[[69],256],9403:[[70],256],9404:[[71],256],9405:[[72],256],9406:[[73],256],9407:[[74],256],9408:[[75],256],9409:[[76],256],9410:[[77],256],9411:[[78],256],9412:[[79],256],9413:[[80],256],9414:[[81],256],9415:[[82],256],9416:[[83],256],9417:[[84],256],9418:[[85],256],9419:[[86],256],9420:[[87],256],9421:[[88],256],9422:[[89],256],9423:[[90],256],9424:[[97],256],9425:[[98],256],9426:[[99],256],9427:[[100],256],9428:[[101],256],9429:[[102],256],9430:[[103],256],9431:[[104],256],9432:[[105],256],9433:[[106],256],9434:[[107],256],9435:[[108],256],9436:[[109],256],9437:[[110],256],9438:[[111],256],9439:[[112],256],9440:[[113],256],9441:[[114],256],9442:[[115],256],9443:[[116],256],9444:[[117],256],9445:[[118],256],9446:[[119],256],9447:[[120],256],9448:[[121],256],9449:[[122],256],9450:[[48],256]},10752:{10764:[[8747,8747,8747,8747],256],10868:[[58,58,61],256],10869:[[61,61],256],10870:[[61,61,61],256],10972:[[10973,824],512]},11264:{11388:[[106],256],11389:[[86],256],11503:[,230],11504:[,230],11505:[,230]},11520:{11631:[[11617],256],11647:[,9],11744:[,230],11745:[,230],11746:[,230],11747:[,230],11748:[,230],11749:[,230],11750:[,230],11751:[,230],11752:[,230],11753:[,230],11754:[,230],11755:[,230],11756:[,230],11757:[,230],11758:[,230],11759:[,230],11760:[,230],11761:[,230],11762:[,230],11763:[,230],11764:[,230],11765:[,230],11766:[,230],11767:[,230],11768:[,230],11769:[,230],11770:[,230],11771:[,230],11772:[,230],11773:[,230],11774:[,230],11775:[,230]},11776:{11935:[[27597],256],12019:[[40863],256]},12032:{12032:[[19968],256],12033:[[20008],256],12034:[[20022],256],12035:[[20031],256],12036:[[20057],256],12037:[[20101],256],12038:[[20108],256],12039:[[20128],256],12040:[[20154],256],12041:[[20799],256],12042:[[20837],256],12043:[[20843],256],12044:[[20866],256],12045:[[20886],256],12046:[[20907],256],12047:[[20960],256],12048:[[20981],256],12049:[[20992],256],12050:[[21147],256],12051:[[21241],256],12052:[[21269],256],12053:[[21274],256],12054:[[21304],256],12055:[[21313],256],12056:[[21340],256],12057:[[21353],256],12058:[[21378],256],12059:[[21430],256],12060:[[21448],256],12061:[[21475],256],12062:[[22231],256],12063:[[22303],256],12064:[[22763],256],12065:[[22786],256],12066:[[22794],256],12067:[[22805],256],12068:[[22823],256],12069:[[22899],256],12070:[[23376],256],12071:[[23424],256],12072:[[23544],256],12073:[[23567],256],12074:[[23586],256],12075:[[23608],256],12076:[[23662],256],12077:[[23665],256],12078:[[24027],256],12079:[[24037],256],12080:[[24049],256],12081:[[24062],256],12082:[[24178],256],12083:[[24186],256],12084:[[24191],256],12085:[[24308],256],12086:[[24318],256],12087:[[24331],256],12088:[[24339],256],12089:[[24400],256],12090:[[24417],256],12091:[[24435],256],12092:[[24515],256],12093:[[25096],256],12094:[[25142],256],12095:[[25163],256],12096:[[25903],256],12097:[[25908],256],12098:[[25991],256],12099:[[26007],256],12100:[[26020],256],12101:[[26041],256],12102:[[26080],256],12103:[[26085],256],12104:[[26352],256],12105:[[26376],256],12106:[[26408],256],12107:[[27424],256],12108:[[27490],256],12109:[[27513],256],12110:[[27571],256],12111:[[27595],256],12112:[[27604],256],12113:[[27611],256],12114:[[27663],256],12115:[[27668],256],12116:[[27700],256],12117:[[28779],256],12118:[[29226],256],12119:[[29238],256],12120:[[29243],256],12121:[[29247],256],12122:[[29255],256],12123:[[29273],256],12124:[[29275],256],12125:[[29356],256],12126:[[29572],256],12127:[[29577],256],12128:[[29916],256],12129:[[29926],256],12130:[[29976],256],12131:[[29983],256],12132:[[29992],256],12133:[[3e4],256],12134:[[30091],256],12135:[[30098],256],12136:[[30326],256],12137:[[30333],256],12138:[[30382],256],12139:[[30399],256],12140:[[30446],256],12141:[[30683],256],12142:[[30690],256],12143:[[30707],256],12144:[[31034],256],12145:[[31160],256],12146:[[31166],256],12147:[[31348],256],12148:[[31435],256],12149:[[31481],256],12150:[[31859],256],12151:[[31992],256],12152:[[32566],256],12153:[[32593],256],12154:[[32650],256],12155:[[32701],256],12156:[[32769],256],12157:[[32780],256],12158:[[32786],256],12159:[[32819],256],12160:[[32895],256],12161:[[32905],256],12162:[[33251],256],12163:[[33258],256],12164:[[33267],256],12165:[[33276],256],12166:[[33292],256],12167:[[33307],256],12168:[[33311],256],12169:[[33390],256],12170:[[33394],256],12171:[[33400],256],12172:[[34381],256],12173:[[34411],256],12174:[[34880],256],12175:[[34892],256],12176:[[34915],256],12177:[[35198],256],12178:[[35211],256],12179:[[35282],256],12180:[[35328],256],12181:[[35895],256],12182:[[35910],256],12183:[[35925],256],12184:[[35960],256],12185:[[35997],256],12186:[[36196],256],12187:[[36208],256],12188:[[36275],256],12189:[[36523],256],12190:[[36554],256],12191:[[36763],256],12192:[[36784],256],12193:[[36789],256],12194:[[37009],256],12195:[[37193],256],12196:[[37318],256],12197:[[37324],256],12198:[[37329],256],12199:[[38263],256],12200:[[38272],256],12201:[[38428],256],12202:[[38582],256],12203:[[38585],256],12204:[[38632],256],12205:[[38737],256],12206:[[38750],256],12207:[[38754],256],12208:[[38761],256],12209:[[38859],256],12210:[[38893],256],12211:[[38899],256],12212:[[38913],256],12213:[[39080],256],12214:[[39131],256],12215:[[39135],256],12216:[[39318],256],12217:[[39321],256],12218:[[39340],256],12219:[[39592],256],12220:[[39640],256],12221:[[39647],256],12222:[[39717],256],12223:[[39727],256],12224:[[39730],256],12225:[[39740],256],12226:[[39770],256],12227:[[40165],256],12228:[[40565],256],12229:[[40575],256],12230:[[40613],256],12231:[[40635],256],12232:[[40643],256],12233:[[40653],256],12234:[[40657],256],12235:[[40697],256],12236:[[40701],256],12237:[[40718],256],12238:[[40723],256],12239:[[40736],256],12240:[[40763],256],12241:[[40778],256],12242:[[40786],256],12243:[[40845],256],12244:[[40860],256],12245:[[40864],256]},12288:{12288:[[32],256],12330:[,218],12331:[,228],12332:[,232],12333:[,222],12334:[,224],12335:[,224],12342:[[12306],256],12344:[[21313],256],12345:[[21316],256],12346:[[21317],256],12358:[,,{12441:12436}],12363:[,,{12441:12364}],12364:[[12363,12441]],12365:[,,{12441:12366}],12366:[[12365,12441]],12367:[,,{12441:12368}],12368:[[12367,12441]],12369:[,,{12441:12370}],12370:[[12369,12441]],12371:[,,{12441:12372}],12372:[[12371,12441]],12373:[,,{12441:12374}],12374:[[12373,12441]],12375:[,,{12441:12376}],12376:[[12375,12441]],12377:[,,{12441:12378}],12378:[[12377,12441]],12379:[,,{12441:12380}],12380:[[12379,12441]],12381:[,,{12441:12382}],12382:[[12381,12441]],12383:[,,{12441:12384}],12384:[[12383,12441]],12385:[,,{12441:12386}],12386:[[12385,12441]],12388:[,,{12441:12389}],12389:[[12388,12441]],12390:[,,{12441:12391}],12391:[[12390,12441]],12392:[,,{12441:12393}],12393:[[12392,12441]],12399:[,,{12441:12400,12442:12401}],12400:[[12399,12441]],12401:[[12399,12442]],12402:[,,{12441:12403,12442:12404}],12403:[[12402,12441]],12404:[[12402,12442]],12405:[,,{12441:12406,12442:12407}],12406:[[12405,12441]],12407:[[12405,12442]],12408:[,,{12441:12409,12442:12410}],12409:[[12408,12441]],12410:[[12408,12442]],12411:[,,{12441:12412,12442:12413}],12412:[[12411,12441]],12413:[[12411,12442]],12436:[[12358,12441]],12441:[,8],12442:[,8],12443:[[32,12441],256],12444:[[32,12442],256],12445:[,,{12441:12446}],12446:[[12445,12441]],12447:[[12424,12426],256],12454:[,,{12441:12532}],12459:[,,{12441:12460}],12460:[[12459,12441]],12461:[,,{12441:12462}],12462:[[12461,12441]],12463:[,,{12441:12464}],12464:[[12463,12441]],12465:[,,{12441:12466}],12466:[[12465,12441]],12467:[,,{12441:12468}],12468:[[12467,12441]],12469:[,,{12441:12470}],12470:[[12469,12441]],12471:[,,{12441:12472}],12472:[[12471,12441]],12473:[,,{12441:12474}],12474:[[12473,12441]],12475:[,,{12441:12476}],12476:[[12475,12441]],12477:[,,{12441:12478}],12478:[[12477,12441]],12479:[,,{12441:12480}],12480:[[12479,12441]],12481:[,,{12441:12482}],12482:[[12481,12441]],12484:[,,{12441:12485}],12485:[[12484,12441]],12486:[,,{12441:12487}],12487:[[12486,12441]],12488:[,,{12441:12489}],12489:[[12488,12441]],12495:[,,{12441:12496,12442:12497}],12496:[[12495,12441]],12497:[[12495,12442]],12498:[,,{12441:12499,12442:12500}],12499:[[12498,12441]],12500:[[12498,12442]],12501:[,,{12441:12502,12442:12503}],12502:[[12501,12441]],12503:[[12501,12442]],12504:[,,{12441:12505,12442:12506}],12505:[[12504,12441]],12506:[[12504,12442]],12507:[,,{12441:12508,12442:12509}],12508:[[12507,12441]],12509:[[12507,12442]],12527:[,,{12441:12535}],12528:[,,{12441:12536}],12529:[,,{12441:12537}],12530:[,,{12441:12538}],12532:[[12454,12441]],12535:[[12527,12441]],12536:[[12528,12441]],12537:[[12529,12441]],12538:[[12530,12441]],12541:[,,{12441:12542}],12542:[[12541,12441]],12543:[[12467,12488],256]},12544:{12593:[[4352],256],12594:[[4353],256],12595:[[4522],256],12596:[[4354],256],12597:[[4524],256],12598:[[4525],256],12599:[[4355],256],12600:[[4356],256],12601:[[4357],256],12602:[[4528],256],12603:[[4529],256],12604:[[4530],256],12605:[[4531],256],12606:[[4532],256],12607:[[4533],256],12608:[[4378],256],12609:[[4358],256],12610:[[4359],256],12611:[[4360],256],12612:[[4385],256],12613:[[4361],256],12614:[[4362],256],12615:[[4363],256],12616:[[4364],256],12617:[[4365],256],12618:[[4366],256],12619:[[4367],256],12620:[[4368],256],12621:[[4369],256],12622:[[4370],256],12623:[[4449],256],12624:[[4450],256],12625:[[4451],256],12626:[[4452],256],12627:[[4453],256],12628:[[4454],256],12629:[[4455],256],12630:[[4456],256],12631:[[4457],256],12632:[[4458],256],12633:[[4459],256],12634:[[4460],256],12635:[[4461],256],12636:[[4462],256],12637:[[4463],256],12638:[[4464],256],12639:[[4465],256],12640:[[4466],256],12641:[[4467],256],12642:[[4468],256],12643:[[4469],256],12644:[[4448],256],12645:[[4372],256],12646:[[4373],256],12647:[[4551],256],12648:[[4552],256],12649:[[4556],256],12650:[[4558],256],12651:[[4563],256],12652:[[4567],256],12653:[[4569],256],12654:[[4380],256],12655:[[4573],256],12656:[[4575],256],12657:[[4381],256],12658:[[4382],256],12659:[[4384],256],12660:[[4386],256],12661:[[4387],256],12662:[[4391],256],12663:[[4393],256],12664:[[4395],256],12665:[[4396],256],12666:[[4397],256],12667:[[4398],256],12668:[[4399],256],12669:[[4402],256],12670:[[4406],256],12671:[[4416],256],12672:[[4423],256],12673:[[4428],256],12674:[[4593],256],12675:[[4594],256],12676:[[4439],256],12677:[[4440],256],12678:[[4441],256],12679:[[4484],256],12680:[[4485],256],12681:[[4488],256],12682:[[4497],256],12683:[[4498],256],12684:[[4500],256],12685:[[4510],256],12686:[[4513],256],12690:[[19968],256],12691:[[20108],256],12692:[[19977],256],12693:[[22235],256],12694:[[19978],256],12695:[[20013],256],12696:[[19979],256],12697:[[30002],256],12698:[[20057],256],12699:[[19993],256],12700:[[19969],256],12701:[[22825],256],12702:[[22320],256],12703:[[20154],256]},12800:{12800:[[40,4352,41],256],12801:[[40,4354,41],256],12802:[[40,4355,41],256],12803:[[40,4357,41],256],12804:[[40,4358,41],256],12805:[[40,4359,41],256],12806:[[40,4361,41],256],12807:[[40,4363,41],256],12808:[[40,4364,41],256],12809:[[40,4366,41],256],12810:[[40,4367,41],256],12811:[[40,4368,41],256],12812:[[40,4369,41],256],12813:[[40,4370,41],256],12814:[[40,4352,4449,41],256],12815:[[40,4354,4449,41],256],12816:[[40,4355,4449,41],256],12817:[[40,4357,4449,41],256],12818:[[40,4358,4449,41],256],12819:[[40,4359,4449,41],256],12820:[[40,4361,4449,41],256],12821:[[40,4363,4449,41],256],12822:[[40,4364,4449,41],256],12823:[[40,4366,4449,41],256],12824:[[40,4367,4449,41],256],12825:[[40,4368,4449,41],256],12826:[[40,4369,4449,41],256],12827:[[40,4370,4449,41],256],12828:[[40,4364,4462,41],256],12829:[[40,4363,4457,4364,4453,4523,41],256],12830:[[40,4363,4457,4370,4462,41],256],12832:[[40,19968,41],256],12833:[[40,20108,41],256],12834:[[40,19977,41],256],12835:[[40,22235,41],256],12836:[[40,20116,41],256],12837:[[40,20845,41],256],12838:[[40,19971,41],256],12839:[[40,20843,41],256],12840:[[40,20061,41],256],12841:[[40,21313,41],256],12842:[[40,26376,41],256],12843:[[40,28779,41],256],12844:[[40,27700,41],256],12845:[[40,26408,41],256],12846:[[40,37329,41],256],12847:[[40,22303,41],256],12848:[[40,26085,41],256],12849:[[40,26666,41],256],12850:[[40,26377,41],256],12851:[[40,31038,41],256],12852:[[40,21517,41],256],12853:[[40,29305,41],256],12854:[[40,36001,41],256],12855:[[40,31069,41],256],12856:[[40,21172,41],256],12857:[[40,20195,41],256],12858:[[40,21628,41],256],12859:[[40,23398,41],256],12860:[[40,30435,41],256],12861:[[40,20225,41],256],12862:[[40,36039,41],256],12863:[[40,21332,41],256],12864:[[40,31085,41],256],12865:[[40,20241,41],256],12866:[[40,33258,41],256],12867:[[40,33267,41],256],12868:[[21839],256],12869:[[24188],256],12870:[[25991],256],12871:[[31631],256],12880:[[80,84,69],256],12881:[[50,49],256],12882:[[50,50],256],12883:[[50,51],256],12884:[[50,52],256],12885:[[50,53],256],12886:[[50,54],256],12887:[[50,55],256],12888:[[50,56],256],12889:[[50,57],256],12890:[[51,48],256],12891:[[51,49],256],12892:[[51,50],256],12893:[[51,51],256],12894:[[51,52],256],12895:[[51,53],256],12896:[[4352],256],12897:[[4354],256],12898:[[4355],256],12899:[[4357],256],12900:[[4358],256],12901:[[4359],256],12902:[[4361],256],12903:[[4363],256],12904:[[4364],256],12905:[[4366],256],12906:[[4367],256],12907:[[4368],256],12908:[[4369],256],12909:[[4370],256],12910:[[4352,4449],256],12911:[[4354,4449],256],12912:[[4355,4449],256],12913:[[4357,4449],256],12914:[[4358,4449],256],12915:[[4359,4449],256],12916:[[4361,4449],256],12917:[[4363,4449],256],12918:[[4364,4449],256],12919:[[4366,4449],256],12920:[[4367,4449],256],12921:[[4368,4449],256],12922:[[4369,4449],256],12923:[[4370,4449],256],12924:[[4366,4449,4535,4352,4457],256],12925:[[4364,4462,4363,4468],256],12926:[[4363,4462],256],12928:[[19968],256],12929:[[20108],256],12930:[[19977],256],12931:[[22235],256],12932:[[20116],256],12933:[[20845],256],12934:[[19971],256],12935:[[20843],256],12936:[[20061],256],12937:[[21313],256],12938:[[26376],256],12939:[[28779],256],12940:[[27700],256],12941:[[26408],256],12942:[[37329],256],12943:[[22303],256],12944:[[26085],256],12945:[[26666],256],12946:[[26377],256],12947:[[31038],256],12948:[[21517],256],12949:[[29305],256],12950:[[36001],256],12951:[[31069],256],12952:[[21172],256],12953:[[31192],256],12954:[[30007],256],12955:[[22899],256],12956:[[36969],256],12957:[[20778],256],12958:[[21360],256],12959:[[27880],256],12960:[[38917],256],12961:[[20241],256],12962:[[20889],256],12963:[[27491],256],12964:[[19978],256],12965:[[20013],256],12966:[[19979],256],12967:[[24038],256],12968:[[21491],256],12969:[[21307],256],12970:[[23447],256],12971:[[23398],256],12972:[[30435],256],12973:[[20225],256],12974:[[36039],256],12975:[[21332],256],12976:[[22812],256],12977:[[51,54],256],12978:[[51,55],256],12979:[[51,56],256],12980:[[51,57],256],12981:[[52,48],256],12982:[[52,49],256],12983:[[52,50],256],12984:[[52,51],256],12985:[[52,52],256],12986:[[52,53],256],12987:[[52,54],256],12988:[[52,55],256],12989:[[52,56],256],12990:[[52,57],256],12991:[[53,48],256],12992:[[49,26376],256],12993:[[50,26376],256],12994:[[51,26376],256],12995:[[52,26376],256],12996:[[53,26376],256],12997:[[54,26376],256],12998:[[55,26376],256],12999:[[56,26376],256],13e3:[[57,26376],256],13001:[[49,48,26376],256],13002:[[49,49,26376],256],13003:[[49,50,26376],256],13004:[[72,103],256],13005:[[101,114,103],256],13006:[[101,86],256],13007:[[76,84,68],256],13008:[[12450],256],13009:[[12452],256],13010:[[12454],256],13011:[[12456],256],13012:[[12458],256],13013:[[12459],256],13014:[[12461],256],13015:[[12463],256],13016:[[12465],256],13017:[[12467],256],13018:[[12469],256],13019:[[12471],256],13020:[[12473],256],13021:[[12475],256],13022:[[12477],256],13023:[[12479],256],13024:[[12481],256],13025:[[12484],256],13026:[[12486],256],13027:[[12488],256],13028:[[12490],256],13029:[[12491],256],13030:[[12492],256],13031:[[12493],256],13032:[[12494],256],13033:[[12495],256],13034:[[12498],256],13035:[[12501],256],13036:[[12504],256],13037:[[12507],256],13038:[[12510],256],13039:[[12511],256],13040:[[12512],256],13041:[[12513],256],13042:[[12514],256],13043:[[12516],256],13044:[[12518],256],13045:[[12520],256],13046:[[12521],256],13047:[[12522],256],13048:[[12523],256],13049:[[12524],256],13050:[[12525],256],13051:[[12527],256],13052:[[12528],256],13053:[[12529],256],13054:[[12530],256]},13056:{13056:[[12450,12497,12540,12488],256],13057:[[12450,12523,12501,12449],256],13058:[[12450,12531,12506,12450],256],13059:[[12450,12540,12523],256],13060:[[12452,12491,12531,12464],256],13061:[[12452,12531,12481],256],13062:[[12454,12457,12531],256],13063:[[12456,12473,12463,12540,12489],256],13064:[[12456,12540,12459,12540],256],13065:[[12458,12531,12473],256],13066:[[12458,12540,12512],256],13067:[[12459,12452,12522],256],13068:[[12459,12521,12483,12488],256],13069:[[12459,12525,12522,12540],256],13070:[[12460,12525,12531],256],13071:[[12460,12531,12510],256],13072:[[12462,12460],256],13073:[[12462,12491,12540],256],13074:[[12461,12517,12522,12540],256],13075:[[12462,12523,12480,12540],256],13076:[[12461,12525],256],13077:[[12461,12525,12464,12521,12512],256],13078:[[12461,12525,12513,12540,12488,12523],256],13079:[[12461,12525,12527,12483,12488],256],13080:[[12464,12521,12512],256],13081:[[12464,12521,12512,12488,12531],256],13082:[[12463,12523,12476,12452,12525],256],13083:[[12463,12525,12540,12493],256],13084:[[12465,12540,12473],256],13085:[[12467,12523,12490],256],13086:[[12467,12540,12509],256],13087:[[12469,12452,12463,12523],256],13088:[[12469,12531,12481,12540,12512],256],13089:[[12471,12522,12531,12464],256],13090:[[12475,12531,12481],256],13091:[[12475,12531,12488],256],13092:[[12480,12540,12473],256],13093:[[12487,12471],256],13094:[[12489,12523],256],13095:[[12488,12531],256],13096:[[12490,12494],256],13097:[[12494,12483,12488],256],13098:[[12495,12452,12484],256],13099:[[12497,12540,12475,12531,12488],256],13100:[[12497,12540,12484],256],13101:[[12496,12540,12524,12523],256],13102:[[12500,12450,12473,12488,12523],256],13103:[[12500,12463,12523],256],13104:[[12500,12467],256],13105:[[12499,12523],256],13106:[[12501,12449,12521,12483,12489],256],13107:[[12501,12451,12540,12488],256],13108:[[12502,12483,12471,12455,12523],256],13109:[[12501,12521,12531],256],13110:[[12504,12463,12479,12540,12523],256],13111:[[12506,12477],256],13112:[[12506,12491,12498],256],13113:[[12504,12523,12484],256],13114:[[12506,12531,12473],256],13115:[[12506,12540,12472],256],13116:[[12505,12540,12479],256],13117:[[12509,12452,12531,12488],256],13118:[[12508,12523,12488],256],13119:[[12507,12531],256],13120:[[12509,12531,12489],256],13121:[[12507,12540,12523],256],13122:[[12507,12540,12531],256],13123:[[12510,12452,12463,12525],256],13124:[[12510,12452,12523],256],13125:[[12510,12483,12495],256],13126:[[12510,12523,12463],256],13127:[[12510,12531,12471,12519,12531],256],13128:[[12511,12463,12525,12531],256],13129:[[12511,12522],256],13130:[[12511,12522,12496,12540,12523],256],13131:[[12513,12460],256],13132:[[12513,12460,12488,12531],256],13133:[[12513,12540,12488,12523],256],13134:[[12516,12540,12489],256],13135:[[12516,12540,12523],256],13136:[[12518,12450,12531],256],13137:[[12522,12483,12488,12523],256],13138:[[12522,12521],256],13139:[[12523,12500,12540],256],13140:[[12523,12540,12502,12523],256],13141:[[12524,12512],256],13142:[[12524,12531,12488,12466,12531],256],13143:[[12527,12483,12488],256],13144:[[48,28857],256],13145:[[49,28857],256],13146:[[50,28857],256],13147:[[51,28857],256],13148:[[52,28857],256],13149:[[53,28857],256],13150:[[54,28857],256],13151:[[55,28857],256],13152:[[56,28857],256],13153:[[57,28857],256],13154:[[49,48,28857],256],13155:[[49,49,28857],256],13156:[[49,50,28857],256],13157:[[49,51,28857],256],13158:[[49,52,28857],256],13159:[[49,53,28857],256],13160:[[49,54,28857],256],13161:[[49,55,28857],256],13162:[[49,56,28857],256],13163:[[49,57,28857],256],13164:[[50,48,28857],256],13165:[[50,49,28857],256],13166:[[50,50,28857],256],13167:[[50,51,28857],256],13168:[[50,52,28857],256],13169:[[104,80,97],256],13170:[[100,97],256],13171:[[65,85],256],13172:[[98,97,114],256],13173:[[111,86],256],13174:[[112,99],256],13175:[[100,109],256],13176:[[100,109,178],256],13177:[[100,109,179],256],13178:[[73,85],256],13179:[[24179,25104],256],13180:[[26157,21644],256],13181:[[22823,27491],256],13182:[[26126,27835],256],13183:[[26666,24335,20250,31038],256],13184:[[112,65],256],13185:[[110,65],256],13186:[[956,65],256],13187:[[109,65],256],13188:[[107,65],256],13189:[[75,66],256],13190:[[77,66],256],13191:[[71,66],256],13192:[[99,97,108],256],13193:[[107,99,97,108],256],13194:[[112,70],256],13195:[[110,70],256],13196:[[956,70],256],13197:[[956,103],256],13198:[[109,103],256],13199:[[107,103],256],13200:[[72,122],256],13201:[[107,72,122],256],13202:[[77,72,122],256],13203:[[71,72,122],256],13204:[[84,72,122],256],13205:[[956,8467],256],13206:[[109,8467],256],13207:[[100,8467],256],13208:[[107,8467],256],13209:[[102,109],256],13210:[[110,109],256],13211:[[956,109],256],13212:[[109,109],256],13213:[[99,109],256],13214:[[107,109],256],13215:[[109,109,178],256],13216:[[99,109,178],256],13217:[[109,178],256],13218:[[107,109,178],256],13219:[[109,109,179],256],13220:[[99,109,179],256],13221:[[109,179],256],13222:[[107,109,179],256],13223:[[109,8725,115],256],13224:[[109,8725,115,178],256],13225:[[80,97],256],13226:[[107,80,97],256],13227:[[77,80,97],256],13228:[[71,80,97],256],13229:[[114,97,100],256],13230:[[114,97,100,8725,115],256],13231:[[114,97,100,8725,115,178],256],13232:[[112,115],256],13233:[[110,115],256],13234:[[956,115],256],13235:[[109,115],256],13236:[[112,86],256],13237:[[110,86],256],13238:[[956,86],256],13239:[[109,86],256],13240:[[107,86],256],13241:[[77,86],256],13242:[[112,87],256],13243:[[110,87],256],13244:[[956,87],256],13245:[[109,87],256],13246:[[107,87],256],13247:[[77,87],256],13248:[[107,937],256],13249:[[77,937],256],13250:[[97,46,109,46],256],13251:[[66,113],256],13252:[[99,99],256],13253:[[99,100],256],13254:[[67,8725,107,103],256],13255:[[67,111,46],256],13256:[[100,66],256],13257:[[71,121],256],13258:[[104,97],256],13259:[[72,80],256],13260:[[105,110],256],13261:[[75,75],256],13262:[[75,77],256],13263:[[107,116],256],13264:[[108,109],256],13265:[[108,110],256],13266:[[108,111,103],256],13267:[[108,120],256],13268:[[109,98],256],13269:[[109,105,108],256],13270:[[109,111,108],256],13271:[[80,72],256],13272:[[112,46,109,46],256],13273:[[80,80,77],256],13274:[[80,82],256],13275:[[115,114],256],13276:[[83,118],256],13277:[[87,98],256],13278:[[86,8725,109],256],13279:[[65,8725,109],256],13280:[[49,26085],256],13281:[[50,26085],256],13282:[[51,26085],256],13283:[[52,26085],256],13284:[[53,26085],256],13285:[[54,26085],256],13286:[[55,26085],256],13287:[[56,26085],256],13288:[[57,26085],256],13289:[[49,48,26085],256],13290:[[49,49,26085],256],13291:[[49,50,26085],256],13292:[[49,51,26085],256],13293:[[49,52,26085],256],13294:[[49,53,26085],256],13295:[[49,54,26085],256],13296:[[49,55,26085],256],13297:[[49,56,26085],256],13298:[[49,57,26085],256],13299:[[50,48,26085],256],13300:[[50,49,26085],256],13301:[[50,50,26085],256],13302:[[50,51,26085],256],13303:[[50,52,26085],256],13304:[[50,53,26085],256],13305:[[50,54,26085],256],13306:[[50,55,26085],256],13307:[[50,56,26085],256],13308:[[50,57,26085],256],13309:[[51,48,26085],256],13310:[[51,49,26085],256],13311:[[103,97,108],256]},27136:{92912:[,1],92913:[,1],92914:[,1],92915:[,1],92916:[,1]},27392:{92976:[,230],92977:[,230],92978:[,230],92979:[,230],92980:[,230],92981:[,230],92982:[,230]},42496:{42607:[,230],42612:[,230],42613:[,230],42614:[,230],42615:[,230],42616:[,230],42617:[,230],42618:[,230],42619:[,230],42620:[,230],42621:[,230],42652:[[1098],256],42653:[[1100],256],42655:[,230],42736:[,230],42737:[,230]},42752:{42864:[[42863],256],43e3:[[294],256],43001:[[339],256]},43008:{43014:[,9],43204:[,9],43232:[,230],43233:[,230],43234:[,230],43235:[,230],43236:[,230],43237:[,230],43238:[,230],43239:[,230],43240:[,230],43241:[,230],43242:[,230],43243:[,230],43244:[,230],43245:[,230],43246:[,230],43247:[,230],43248:[,230],43249:[,230]},43264:{43307:[,220],43308:[,220],43309:[,220],43347:[,9],43443:[,7],43456:[,9]},43520:{43696:[,230],43698:[,230],43699:[,230],43700:[,220],43703:[,230],43704:[,230],43710:[,230],43711:[,230],43713:[,230],43766:[,9]},43776:{43868:[[42791],256],43869:[[43831],256],43870:[[619],256],43871:[[43858],256],44013:[,9]},48128:{113822:[,1]},53504:{119134:[[119127,119141],512],119135:[[119128,119141],512],119136:[[119135,119150],512],119137:[[119135,119151],512],119138:[[119135,119152],512],119139:[[119135,119153],512],119140:[[119135,119154],512],119141:[,216],119142:[,216],119143:[,1],119144:[,1],119145:[,1],119149:[,226],119150:[,216],119151:[,216],119152:[,216],119153:[,216],119154:[,216],119163:[,220],119164:[,220],119165:[,220],119166:[,220],119167:[,220],119168:[,220],119169:[,220],119170:[,220],119173:[,230],119174:[,230],119175:[,230],119176:[,230],119177:[,230],119178:[,220],119179:[,220],119210:[,230],119211:[,230],119212:[,230],119213:[,230],119227:[[119225,119141],512],119228:[[119226,119141],512],119229:[[119227,119150],512],119230:[[119228,119150],512],119231:[[119227,119151],512],119232:[[119228,119151],512]},53760:{119362:[,230],119363:[,230],119364:[,230]},54272:{119808:[[65],256],119809:[[66],256],119810:[[67],256],119811:[[68],256],119812:[[69],256],119813:[[70],256],119814:[[71],256],119815:[[72],256],119816:[[73],256],119817:[[74],256],119818:[[75],256],119819:[[76],256],119820:[[77],256],119821:[[78],256],119822:[[79],256],119823:[[80],256],119824:[[81],256],119825:[[82],256],119826:[[83],256],119827:[[84],256],119828:[[85],256],119829:[[86],256],119830:[[87],256],119831:[[88],256],119832:[[89],256],119833:[[90],256],119834:[[97],256],119835:[[98],256],119836:[[99],256],119837:[[100],256],119838:[[101],256],119839:[[102],256],119840:[[103],256],119841:[[104],256],119842:[[105],256],119843:[[106],256],119844:[[107],256],119845:[[108],256],119846:[[109],256],119847:[[110],256],119848:[[111],256],119849:[[112],256],119850:[[113],256],119851:[[114],256],119852:[[115],256],119853:[[116],256],119854:[[117],256],119855:[[118],256],119856:[[119],256],119857:[[120],256],119858:[[121],256],119859:[[122],256],119860:[[65],256],119861:[[66],256],119862:[[67],256],119863:[[68],256],119864:[[69],256],119865:[[70],256],119866:[[71],256],119867:[[72],256],119868:[[73],256],119869:[[74],256],119870:[[75],256],119871:[[76],256],119872:[[77],256],119873:[[78],256],119874:[[79],256],119875:[[80],256],119876:[[81],256],119877:[[82],256],119878:[[83],256],119879:[[84],256],119880:[[85],256],119881:[[86],256],119882:[[87],256],119883:[[88],256],119884:[[89],256],119885:[[90],256],119886:[[97],256],119887:[[98],256],119888:[[99],256],119889:[[100],256],119890:[[101],256],119891:[[102],256],119892:[[103],256],119894:[[105],256],119895:[[106],256],119896:[[107],256],119897:[[108],256],119898:[[109],256],119899:[[110],256],119900:[[111],256],119901:[[112],256],119902:[[113],256],119903:[[114],256],119904:[[115],256],119905:[[116],256],119906:[[117],256],119907:[[118],256],119908:[[119],256],119909:[[120],256],119910:[[121],256],119911:[[122],256],119912:[[65],256],119913:[[66],256],119914:[[67],256],119915:[[68],256],119916:[[69],256],119917:[[70],256],119918:[[71],256],119919:[[72],256],119920:[[73],256],119921:[[74],256],119922:[[75],256],119923:[[76],256],119924:[[77],256],119925:[[78],256],119926:[[79],256],119927:[[80],256],119928:[[81],256],119929:[[82],256],119930:[[83],256],119931:[[84],256],119932:[[85],256],119933:[[86],256],119934:[[87],256],119935:[[88],256],119936:[[89],256],119937:[[90],256],119938:[[97],256],119939:[[98],256],119940:[[99],256],119941:[[100],256],119942:[[101],256],119943:[[102],256],119944:[[103],256],119945:[[104],256],119946:[[105],256],119947:[[106],256],119948:[[107],256],119949:[[108],256],119950:[[109],256],119951:[[110],256],119952:[[111],256],119953:[[112],256],119954:[[113],256],119955:[[114],256],119956:[[115],256],119957:[[116],256],119958:[[117],256],119959:[[118],256],119960:[[119],256],119961:[[120],256],119962:[[121],256],119963:[[122],256],119964:[[65],256],119966:[[67],256],119967:[[68],256],119970:[[71],256],119973:[[74],256],119974:[[75],256],119977:[[78],256],119978:[[79],256],119979:[[80],256],119980:[[81],256],119982:[[83],256],119983:[[84],256],119984:[[85],256],119985:[[86],256],119986:[[87],256],119987:[[88],256],119988:[[89],256],119989:[[90],256],119990:[[97],256],119991:[[98],256],119992:[[99],256],119993:[[100],256],119995:[[102],256],119997:[[104],256],119998:[[105],256],119999:[[106],256],12e4:[[107],256],120001:[[108],256],120002:[[109],256],120003:[[110],256],120005:[[112],256],120006:[[113],256],120007:[[114],256],120008:[[115],256],120009:[[116],256],120010:[[117],256],120011:[[118],256],120012:[[119],256],120013:[[120],256],120014:[[121],256],120015:[[122],256],120016:[[65],256],120017:[[66],256],120018:[[67],256],120019:[[68],256],120020:[[69],256],120021:[[70],256],120022:[[71],256],120023:[[72],256],120024:[[73],256],120025:[[74],256],120026:[[75],256],120027:[[76],256],120028:[[77],256],120029:[[78],256],120030:[[79],256],120031:[[80],256],120032:[[81],256],120033:[[82],256],120034:[[83],256],120035:[[84],256],120036:[[85],256],120037:[[86],256],120038:[[87],256],120039:[[88],256],120040:[[89],256],120041:[[90],256],120042:[[97],256],120043:[[98],256],120044:[[99],256],120045:[[100],256],120046:[[101],256],120047:[[102],256],120048:[[103],256],120049:[[104],256],120050:[[105],256],120051:[[106],256],120052:[[107],256],120053:[[108],256],120054:[[109],256],120055:[[110],256],120056:[[111],256],120057:[[112],256],120058:[[113],256],120059:[[114],256],120060:[[115],256],120061:[[116],256],120062:[[117],256],120063:[[118],256]},54528:{120064:[[119],256],120065:[[120],256],120066:[[121],256],120067:[[122],256],120068:[[65],256],120069:[[66],256],120071:[[68],256],120072:[[69],256],120073:[[70],256],120074:[[71],256],120077:[[74],256],120078:[[75],256],120079:[[76],256],120080:[[77],256],120081:[[78],256],120082:[[79],256],120083:[[80],256],120084:[[81],256],120086:[[83],256],120087:[[84],256],120088:[[85],256],120089:[[86],256],120090:[[87],256],120091:[[88],256],120092:[[89],256],120094:[[97],256],120095:[[98],256],120096:[[99],256],120097:[[100],256],120098:[[101],256],120099:[[102],256],120100:[[103],256],120101:[[104],256],120102:[[105],256],120103:[[106],256],120104:[[107],256],120105:[[108],256],120106:[[109],256],120107:[[110],256],120108:[[111],256],120109:[[112],256],120110:[[113],256],120111:[[114],256],120112:[[115],256],120113:[[116],256],120114:[[117],256],120115:[[118],256],120116:[[119],256],120117:[[120],256],120118:[[121],256],120119:[[122],256],120120:[[65],256],120121:[[66],256],120123:[[68],256],120124:[[69],256],120125:[[70],256],120126:[[71],256],120128:[[73],256],120129:[[74],256],120130:[[75],256],120131:[[76],256],120132:[[77],256],120134:[[79],256],120138:[[83],256],120139:[[84],256],120140:[[85],256],120141:[[86],256],120142:[[87],256],120143:[[88],256],120144:[[89],256],120146:[[97],256],120147:[[98],256],120148:[[99],256],120149:[[100],256],120150:[[101],256],120151:[[102],256],120152:[[103],256],120153:[[104],256],120154:[[105],256],120155:[[106],256],120156:[[107],256],120157:[[108],256],120158:[[109],256],120159:[[110],256],120160:[[111],256],120161:[[112],256],120162:[[113],256],120163:[[114],256],120164:[[115],256],120165:[[116],256],120166:[[117],256],120167:[[118],256],120168:[[119],256],120169:[[120],256],120170:[[121],256],120171:[[122],256],120172:[[65],256],120173:[[66],256],120174:[[67],256],120175:[[68],256],120176:[[69],256],120177:[[70],256],120178:[[71],256],120179:[[72],256],120180:[[73],256],120181:[[74],256],120182:[[75],256],120183:[[76],256],120184:[[77],256],120185:[[78],256],120186:[[79],256],120187:[[80],256],120188:[[81],256],120189:[[82],256],120190:[[83],256],120191:[[84],256],120192:[[85],256],120193:[[86],256],120194:[[87],256],120195:[[88],256],120196:[[89],256],120197:[[90],256],120198:[[97],256],120199:[[98],256],120200:[[99],256],120201:[[100],256],120202:[[101],256],120203:[[102],256],120204:[[103],256],120205:[[104],256],120206:[[105],256],120207:[[106],256],120208:[[107],256],120209:[[108],256],120210:[[109],256],120211:[[110],256],120212:[[111],256],120213:[[112],256],120214:[[113],256],120215:[[114],256],120216:[[115],256],120217:[[116],256],120218:[[117],256],120219:[[118],256],120220:[[119],256],120221:[[120],256],120222:[[121],256],120223:[[122],256],120224:[[65],256],120225:[[66],256],120226:[[67],256],120227:[[68],256],120228:[[69],256],120229:[[70],256],120230:[[71],256],120231:[[72],256],120232:[[73],256],120233:[[74],256],120234:[[75],256],120235:[[76],256],120236:[[77],256],120237:[[78],256],120238:[[79],256],120239:[[80],256],120240:[[81],256],120241:[[82],256],120242:[[83],256],120243:[[84],256],120244:[[85],256],120245:[[86],256],120246:[[87],256],120247:[[88],256],120248:[[89],256],120249:[[90],256],120250:[[97],256],120251:[[98],256],120252:[[99],256],120253:[[100],256],120254:[[101],256],120255:[[102],256],120256:[[103],256],120257:[[104],256],120258:[[105],256],120259:[[106],256],120260:[[107],256],120261:[[108],256],120262:[[109],256],120263:[[110],256],120264:[[111],256],120265:[[112],256],120266:[[113],256],120267:[[114],256],120268:[[115],256],120269:[[116],256],120270:[[117],256],120271:[[118],256],120272:[[119],256],120273:[[120],256],120274:[[121],256],120275:[[122],256],120276:[[65],256],120277:[[66],256],120278:[[67],256],120279:[[68],256],120280:[[69],256],120281:[[70],256],120282:[[71],256],120283:[[72],256],120284:[[73],256],120285:[[74],256],120286:[[75],256],120287:[[76],256],120288:[[77],256],120289:[[78],256],120290:[[79],256],120291:[[80],256],120292:[[81],256],120293:[[82],256],120294:[[83],256],120295:[[84],256],120296:[[85],256],120297:[[86],256],120298:[[87],256],120299:[[88],256],120300:[[89],256],120301:[[90],256],120302:[[97],256],120303:[[98],256],120304:[[99],256],120305:[[100],256],120306:[[101],256],120307:[[102],256],120308:[[103],256],120309:[[104],256],120310:[[105],256],120311:[[106],256],120312:[[107],256],120313:[[108],256],120314:[[109],256],120315:[[110],256],120316:[[111],256],120317:[[112],256],120318:[[113],256],120319:[[114],256]},54784:{120320:[[115],256],120321:[[116],256],120322:[[117],256],120323:[[118],256],120324:[[119],256],120325:[[120],256],120326:[[121],256],120327:[[122],256],120328:[[65],256],120329:[[66],256],120330:[[67],256],120331:[[68],256],120332:[[69],256],120333:[[70],256],120334:[[71],256],120335:[[72],256],120336:[[73],256],120337:[[74],256],120338:[[75],256],120339:[[76],256],120340:[[77],256],120341:[[78],256],120342:[[79],256],120343:[[80],256],120344:[[81],256],120345:[[82],256],120346:[[83],256],120347:[[84],256],120348:[[85],256],120349:[[86],256],120350:[[87],256],120351:[[88],256],120352:[[89],256],120353:[[90],256],120354:[[97],256],120355:[[98],256],120356:[[99],256],120357:[[100],256],120358:[[101],256],120359:[[102],256],120360:[[103],256],120361:[[104],256],120362:[[105],256],120363:[[106],256],120364:[[107],256],120365:[[108],256],120366:[[109],256],120367:[[110],256],120368:[[111],256],120369:[[112],256],120370:[[113],256],120371:[[114],256],120372:[[115],256],120373:[[116],256],120374:[[117],256],120375:[[118],256],120376:[[119],256],120377:[[120],256],120378:[[121],256],120379:[[122],256],120380:[[65],256],120381:[[66],256],120382:[[67],256],120383:[[68],256],120384:[[69],256],120385:[[70],256],120386:[[71],256],120387:[[72],256],120388:[[73],256],120389:[[74],256],120390:[[75],256],120391:[[76],256],120392:[[77],256],120393:[[78],256],120394:[[79],256],120395:[[80],256],120396:[[81],256],120397:[[82],256],120398:[[83],256],120399:[[84],256],120400:[[85],256],120401:[[86],256],120402:[[87],256],120403:[[88],256],120404:[[89],256],120405:[[90],256],120406:[[97],256],120407:[[98],256],120408:[[99],256],120409:[[100],256],120410:[[101],256],120411:[[102],256],120412:[[103],256],120413:[[104],256],120414:[[105],256],120415:[[106],256],120416:[[107],256],120417:[[108],256],120418:[[109],256],120419:[[110],256],120420:[[111],256],120421:[[112],256],120422:[[113],256],120423:[[114],256],120424:[[115],256],120425:[[116],256],120426:[[117],256],120427:[[118],256],120428:[[119],256],120429:[[120],256],120430:[[121],256],120431:[[122],256],120432:[[65],256],120433:[[66],256],120434:[[67],256],120435:[[68],256],120436:[[69],256],120437:[[70],256],120438:[[71],256],120439:[[72],256],120440:[[73],256],120441:[[74],256],120442:[[75],256],120443:[[76],256],120444:[[77],256],120445:[[78],256],120446:[[79],256],120447:[[80],256],120448:[[81],256],120449:[[82],256],120450:[[83],256],120451:[[84],256],120452:[[85],256],120453:[[86],256],120454:[[87],256],120455:[[88],256],120456:[[89],256],120457:[[90],256],120458:[[97],256],120459:[[98],256],120460:[[99],256],120461:[[100],256],120462:[[101],256],120463:[[102],256],120464:[[103],256],120465:[[104],256],120466:[[105],256],120467:[[106],256],120468:[[107],256],120469:[[108],256],120470:[[109],256],120471:[[110],256],120472:[[111],256],120473:[[112],256],120474:[[113],256],120475:[[114],256],120476:[[115],256],120477:[[116],256],120478:[[117],256],120479:[[118],256],120480:[[119],256],120481:[[120],256],120482:[[121],256],120483:[[122],256],120484:[[305],256],120485:[[567],256],120488:[[913],256],120489:[[914],256],120490:[[915],256],120491:[[916],256],120492:[[917],256],120493:[[918],256],120494:[[919],256],120495:[[920],256],120496:[[921],256],120497:[[922],256],120498:[[923],256],120499:[[924],256],120500:[[925],256],120501:[[926],256],120502:[[927],256],120503:[[928],256],120504:[[929],256],120505:[[1012],256],120506:[[931],256],120507:[[932],256],120508:[[933],256],120509:[[934],256],120510:[[935],256],120511:[[936],256],120512:[[937],256],120513:[[8711],256],120514:[[945],256],120515:[[946],256],120516:[[947],256],120517:[[948],256],120518:[[949],256],120519:[[950],256],120520:[[951],256],120521:[[952],256],120522:[[953],256],120523:[[954],256],120524:[[955],256],120525:[[956],256],120526:[[957],256],120527:[[958],256],120528:[[959],256],120529:[[960],256],120530:[[961],256],120531:[[962],256],120532:[[963],256],120533:[[964],256],120534:[[965],256],120535:[[966],256],120536:[[967],256],120537:[[968],256],120538:[[969],256],120539:[[8706],256],120540:[[1013],256],120541:[[977],256],120542:[[1008],256],120543:[[981],256],120544:[[1009],256],120545:[[982],256],120546:[[913],256],120547:[[914],256],120548:[[915],256],120549:[[916],256],120550:[[917],256],120551:[[918],256],120552:[[919],256],120553:[[920],256],120554:[[921],256],120555:[[922],256],120556:[[923],256],120557:[[924],256],120558:[[925],256],120559:[[926],256],120560:[[927],256],120561:[[928],256],120562:[[929],256],120563:[[1012],256],120564:[[931],256],120565:[[932],256],120566:[[933],256],120567:[[934],256],120568:[[935],256],120569:[[936],256],120570:[[937],256],120571:[[8711],256],120572:[[945],256],120573:[[946],256],120574:[[947],256],120575:[[948],256]},55040:{120576:[[949],256],120577:[[950],256],120578:[[951],256],120579:[[952],256],120580:[[953],256],120581:[[954],256],120582:[[955],256],120583:[[956],256],120584:[[957],256],120585:[[958],256],120586:[[959],256],120587:[[960],256],120588:[[961],256],120589:[[962],256],120590:[[963],256],120591:[[964],256],120592:[[965],256],120593:[[966],256],120594:[[967],256],120595:[[968],256],120596:[[969],256],120597:[[8706],256],120598:[[1013],256],120599:[[977],256],120600:[[1008],256],120601:[[981],256],120602:[[1009],256],120603:[[982],256],120604:[[913],256],120605:[[914],256],120606:[[915],256],120607:[[916],256],120608:[[917],256],120609:[[918],256],120610:[[919],256],120611:[[920],256],120612:[[921],256],120613:[[922],256],120614:[[923],256],120615:[[924],256],120616:[[925],256],120617:[[926],256],120618:[[927],256],120619:[[928],256],120620:[[929],256],120621:[[1012],256],120622:[[931],256],120623:[[932],256],120624:[[933],256],120625:[[934],256],120626:[[935],256],120627:[[936],256],120628:[[937],256],120629:[[8711],256],120630:[[945],256],120631:[[946],256],120632:[[947],256],120633:[[948],256],120634:[[949],256],120635:[[950],256],120636:[[951],256],120637:[[952],256],120638:[[953],256],120639:[[954],256],120640:[[955],256],120641:[[956],256],120642:[[957],256],120643:[[958],256],120644:[[959],256],120645:[[960],256],120646:[[961],256],120647:[[962],256],120648:[[963],256],120649:[[964],256],120650:[[965],256],120651:[[966],256],120652:[[967],256],120653:[[968],256],120654:[[969],256],120655:[[8706],256],120656:[[1013],256],120657:[[977],256],120658:[[1008],256],120659:[[981],256],120660:[[1009],256],120661:[[982],256],120662:[[913],256],120663:[[914],256],120664:[[915],256],120665:[[916],256],120666:[[917],256],120667:[[918],256],120668:[[919],256],120669:[[920],256],120670:[[921],256],120671:[[922],256],120672:[[923],256],120673:[[924],256],120674:[[925],256],120675:[[926],256],120676:[[927],256],120677:[[928],256],120678:[[929],256],120679:[[1012],256],120680:[[931],256],120681:[[932],256],120682:[[933],256],120683:[[934],256],120684:[[935],256],120685:[[936],256],120686:[[937],256],120687:[[8711],256],120688:[[945],256],120689:[[946],256],120690:[[947],256],120691:[[948],256],120692:[[949],256],120693:[[950],256],120694:[[951],256],120695:[[952],256],120696:[[953],256],120697:[[954],256],120698:[[955],256],120699:[[956],256],120700:[[957],256],120701:[[958],256],120702:[[959],256],120703:[[960],256],120704:[[961],256],120705:[[962],256],120706:[[963],256],120707:[[964],256],120708:[[965],256],120709:[[966],256],120710:[[967],256],120711:[[968],256],120712:[[969],256],120713:[[8706],256],120714:[[1013],256],120715:[[977],256],120716:[[1008],256],120717:[[981],256],120718:[[1009],256],120719:[[982],256],120720:[[913],256],120721:[[914],256],120722:[[915],256],120723:[[916],256],120724:[[917],256],120725:[[918],256],120726:[[919],256],120727:[[920],256],120728:[[921],256],120729:[[922],256],120730:[[923],256],120731:[[924],256],120732:[[925],256],120733:[[926],256],120734:[[927],256],120735:[[928],256],120736:[[929],256],120737:[[1012],256],120738:[[931],256],120739:[[932],256],120740:[[933],256],120741:[[934],256],120742:[[935],256],120743:[[936],256],120744:[[937],256],120745:[[8711],256],120746:[[945],256],120747:[[946],256],120748:[[947],256],120749:[[948],256],120750:[[949],256],120751:[[950],256],120752:[[951],256],120753:[[952],256],120754:[[953],256],120755:[[954],256],120756:[[955],256],120757:[[956],256],120758:[[957],256],120759:[[958],256],120760:[[959],256],120761:[[960],256],120762:[[961],256],120763:[[962],256],120764:[[963],256],120765:[[964],256],120766:[[965],256],120767:[[966],256],120768:[[967],256],120769:[[968],256],120770:[[969],256],120771:[[8706],256],120772:[[1013],256],120773:[[977],256],120774:[[1008],256],120775:[[981],256],120776:[[1009],256],120777:[[982],256],120778:[[988],256],120779:[[989],256],120782:[[48],256],120783:[[49],256],120784:[[50],256],120785:[[51],256],120786:[[52],256],120787:[[53],256],120788:[[54],256],120789:[[55],256],120790:[[56],256],120791:[[57],256],120792:[[48],256],120793:[[49],256],120794:[[50],256],120795:[[51],256],120796:[[52],256],120797:[[53],256],120798:[[54],256],120799:[[55],256],120800:[[56],256],120801:[[57],256],120802:[[48],256],120803:[[49],256],120804:[[50],256],120805:[[51],256],120806:[[52],256],120807:[[53],256],120808:[[54],256],120809:[[55],256],120810:[[56],256],120811:[[57],256],120812:[[48],256],120813:[[49],256],120814:[[50],256],120815:[[51],256],120816:[[52],256],120817:[[53],256],120818:[[54],256],120819:[[55],256],120820:[[56],256],120821:[[57],256],120822:[[48],256],120823:[[49],256],120824:[[50],256],120825:[[51],256],120826:[[52],256],120827:[[53],256],120828:[[54],256],120829:[[55],256],120830:[[56],256],120831:[[57],256]},59392:{125136:[,220],125137:[,220],125138:[,220],125139:[,220],125140:[,220],125141:[,220],125142:[,220]},60928:{126464:[[1575],256],126465:[[1576],256],126466:[[1580],256],126467:[[1583],256],126469:[[1608],256],126470:[[1586],256],126471:[[1581],256],126472:[[1591],256],126473:[[1610],256],126474:[[1603],256],126475:[[1604],256],126476:[[1605],256],126477:[[1606],256],126478:[[1587],256],126479:[[1593],256],126480:[[1601],256],126481:[[1589],256],126482:[[1602],256],126483:[[1585],256],126484:[[1588],256],126485:[[1578],256],126486:[[1579],256],126487:[[1582],256],126488:[[1584],256],126489:[[1590],256],126490:[[1592],256],126491:[[1594],256],126492:[[1646],256],126493:[[1722],256],126494:[[1697],256],126495:[[1647],256],126497:[[1576],256],126498:[[1580],256],126500:[[1607],256],126503:[[1581],256],126505:[[1610],256],126506:[[1603],256],126507:[[1604],256],126508:[[1605],256],126509:[[1606],256],126510:[[1587],256],126511:[[1593],256],126512:[[1601],256],126513:[[1589],256],126514:[[1602],256],126516:[[1588],256],126517:[[1578],256],126518:[[1579],256],126519:[[1582],256],126521:[[1590],256],126523:[[1594],256],126530:[[1580],256],126535:[[1581],256],126537:[[1610],256],126539:[[1604],256],126541:[[1606],256],126542:[[1587],256],126543:[[1593],256],126545:[[1589],256],126546:[[1602],256],126548:[[1588],256],126551:[[1582],256],126553:[[1590],256],126555:[[1594],256],126557:[[1722],256],126559:[[1647],256],126561:[[1576],256],126562:[[1580],256],126564:[[1607],256],126567:[[1581],256],126568:[[1591],256],126569:[[1610],256],126570:[[1603],256],126572:[[1605],256],126573:[[1606],256],126574:[[1587],256],126575:[[1593],256],126576:[[1601],256],126577:[[1589],256],126578:[[1602],256],126580:[[1588],256],126581:[[1578],256],126582:[[1579],256],126583:[[1582],256],126585:[[1590],256],126586:[[1592],256],126587:[[1594],256],126588:[[1646],256],126590:[[1697],256],126592:[[1575],256],126593:[[1576],256],126594:[[1580],256],126595:[[1583],256],126596:[[1607],256],126597:[[1608],256],126598:[[1586],256],126599:[[1581],256],126600:[[1591],256],126601:[[1610],256],126603:[[1604],256],126604:[[1605],256],126605:[[1606],256],126606:[[1587],256],126607:[[1593],256],126608:[[1601],256],126609:[[1589],256],126610:[[1602],256],126611:[[1585],256],126612:[[1588],256],126613:[[1578],256],126614:[[1579],256],126615:[[1582],256],126616:[[1584],256],126617:[[1590],256],126618:[[1592],256],126619:[[1594],256],126625:[[1576],256],126626:[[1580],256],126627:[[1583],256],126629:[[1608],256],126630:[[1586],256],126631:[[1581],256],126632:[[1591],256],126633:[[1610],256],126635:[[1604],256],126636:[[1605],256],126637:[[1606],256],126638:[[1587],256],126639:[[1593],256],126640:[[1601],256],126641:[[1589],256],126642:[[1602],256],126643:[[1585],256],126644:[[1588],256],126645:[[1578],256],126646:[[1579],256],126647:[[1582],256],126648:[[1584],256],126649:[[1590],256],126650:[[1592],256],126651:[[1594],256]},61696:{127232:[[48,46],256],127233:[[48,44],256],127234:[[49,44],256],127235:[[50,44],256],127236:[[51,44],256],127237:[[52,44],256],127238:[[53,44],256],127239:[[54,44],256],127240:[[55,44],256],127241:[[56,44],256],127242:[[57,44],256],127248:[[40,65,41],256],127249:[[40,66,41],256],127250:[[40,67,41],256],127251:[[40,68,41],256],127252:[[40,69,41],256],127253:[[40,70,41],256],127254:[[40,71,41],256],127255:[[40,72,41],256],127256:[[40,73,41],256],127257:[[40,74,41],256],127258:[[40,75,41],256],127259:[[40,76,41],256],127260:[[40,77,41],256],127261:[[40,78,41],256],127262:[[40,79,41],256],127263:[[40,80,41],256],127264:[[40,81,41],256],127265:[[40,82,41],256],127266:[[40,83,41],256],127267:[[40,84,41],256],127268:[[40,85,41],256],127269:[[40,86,41],256],127270:[[40,87,41],256],127271:[[40,88,41],256],127272:[[40,89,41],256],127273:[[40,90,41],256],127274:[[12308,83,12309],256],127275:[[67],256],127276:[[82],256],127277:[[67,68],256],127278:[[87,90],256],127280:[[65],256],127281:[[66],256],127282:[[67],256],127283:[[68],256],127284:[[69],256],127285:[[70],256],127286:[[71],256],127287:[[72],256],127288:[[73],256],127289:[[74],256],127290:[[75],256],127291:[[76],256],127292:[[77],256],127293:[[78],256],127294:[[79],256],127295:[[80],256],127296:[[81],256],127297:[[82],256],127298:[[83],256],127299:[[84],256],127300:[[85],256],127301:[[86],256],127302:[[87],256],127303:[[88],256],127304:[[89],256],127305:[[90],256],127306:[[72,86],256],127307:[[77,86],256],127308:[[83,68],256],127309:[[83,83],256],127310:[[80,80,86],256],127311:[[87,67],256],127338:[[77,67],256],127339:[[77,68],256],127376:[[68,74],256]},61952:{127488:[[12411,12363],256],127489:[[12467,12467],256],127490:[[12469],256],127504:[[25163],256],127505:[[23383],256],127506:[[21452],256],127507:[[12487],256],127508:[[20108],256],127509:[[22810],256],127510:[[35299],256],127511:[[22825],256],127512:[[20132],256],127513:[[26144],256],127514:[[28961],256],127515:[[26009],256],127516:[[21069],256],127517:[[24460],256],127518:[[20877],256],127519:[[26032],256],127520:[[21021],256],127521:[[32066],256],127522:[[29983],256],127523:[[36009],256],127524:[[22768],256],127525:[[21561],256],127526:[[28436],256],127527:[[25237],256],127528:[[25429],256],127529:[[19968],256],127530:[[19977],256],127531:[[36938],256],127532:[[24038],256],127533:[[20013],256],127534:[[21491],256],127535:[[25351],256],127536:[[36208],256],127537:[[25171],256],127538:[[31105],256],127539:[[31354],256],127540:[[21512],256],127541:[[28288],256],127542:[[26377],256],127543:[[26376],256],127544:[[30003],256],127545:[[21106],256],127546:[[21942],256],127552:[[12308,26412,12309],256],127553:[[12308,19977,12309],256],127554:[[12308,20108,12309],256],127555:[[12308,23433,12309],256],127556:[[12308,28857,12309],256],127557:[[12308,25171,12309],256],127558:[[12308,30423,12309],256],127559:[[12308,21213,12309],256],127560:[[12308,25943,12309],256],127568:[[24471],256],127569:[[21487],256]},63488:{194560:[[20029]],194561:[[20024]],194562:[[20033]],194563:[[131362]],194564:[[20320]],194565:[[20398]],194566:[[20411]],194567:[[20482]],194568:[[20602]],194569:[[20633]],194570:[[20711]],194571:[[20687]],194572:[[13470]],194573:[[132666]],194574:[[20813]],194575:[[20820]],194576:[[20836]],194577:[[20855]],194578:[[132380]],194579:[[13497]],194580:[[20839]],194581:[[20877]],194582:[[132427]],194583:[[20887]],194584:[[20900]],194585:[[20172]],194586:[[20908]],194587:[[20917]],194588:[[168415]],194589:[[20981]],194590:[[20995]],194591:[[13535]],194592:[[21051]],194593:[[21062]],194594:[[21106]],194595:[[21111]],194596:[[13589]],194597:[[21191]],194598:[[21193]],194599:[[21220]],194600:[[21242]],194601:[[21253]],194602:[[21254]],194603:[[21271]],194604:[[21321]],194605:[[21329]],194606:[[21338]],194607:[[21363]],194608:[[21373]],194609:[[21375]],194610:[[21375]],194611:[[21375]],194612:[[133676]],194613:[[28784]],194614:[[21450]],194615:[[21471]],194616:[[133987]],194617:[[21483]],194618:[[21489]],194619:[[21510]],194620:[[21662]],194621:[[21560]],194622:[[21576]],194623:[[21608]],194624:[[21666]],194625:[[21750]],194626:[[21776]],194627:[[21843]],194628:[[21859]],194629:[[21892]],194630:[[21892]],194631:[[21913]],194632:[[21931]],194633:[[21939]],194634:[[21954]],194635:[[22294]],194636:[[22022]],194637:[[22295]],194638:[[22097]],194639:[[22132]],194640:[[20999]],194641:[[22766]],194642:[[22478]],194643:[[22516]],194644:[[22541]],194645:[[22411]],194646:[[22578]],194647:[[22577]],194648:[[22700]],194649:[[136420]],194650:[[22770]],194651:[[22775]],194652:[[22790]],194653:[[22810]],194654:[[22818]],194655:[[22882]],194656:[[136872]],194657:[[136938]],194658:[[23020]],194659:[[23067]],194660:[[23079]],194661:[[23e3]],194662:[[23142]],194663:[[14062]],194664:[[14076]],194665:[[23304]],194666:[[23358]],194667:[[23358]],194668:[[137672]],194669:[[23491]],194670:[[23512]],194671:[[23527]],194672:[[23539]],194673:[[138008]],194674:[[23551]],194675:[[23558]],194676:[[24403]],194677:[[23586]],194678:[[14209]],194679:[[23648]],194680:[[23662]],194681:[[23744]],194682:[[23693]],194683:[[138724]],194684:[[23875]],194685:[[138726]],194686:[[23918]],194687:[[23915]],194688:[[23932]],194689:[[24033]],194690:[[24034]],194691:[[14383]],194692:[[24061]],194693:[[24104]],194694:[[24125]],194695:[[24169]],194696:[[14434]],194697:[[139651]],194698:[[14460]],194699:[[24240]],194700:[[24243]],194701:[[24246]],194702:[[24266]],194703:[[172946]],194704:[[24318]],194705:[[140081]],194706:[[140081]],194707:[[33281]],194708:[[24354]],194709:[[24354]],194710:[[14535]],194711:[[144056]],194712:[[156122]],194713:[[24418]],194714:[[24427]],194715:[[14563]],194716:[[24474]],194717:[[24525]],194718:[[24535]],194719:[[24569]],194720:[[24705]],194721:[[14650]],194722:[[14620]],194723:[[24724]],194724:[[141012]],194725:[[24775]],194726:[[24904]],194727:[[24908]],194728:[[24910]],194729:[[24908]],194730:[[24954]],194731:[[24974]],194732:[[25010]],194733:[[24996]],194734:[[25007]],194735:[[25054]],194736:[[25074]],194737:[[25078]],194738:[[25104]],194739:[[25115]],194740:[[25181]],194741:[[25265]],194742:[[25300]],194743:[[25424]],194744:[[142092]],194745:[[25405]],194746:[[25340]],194747:[[25448]],194748:[[25475]],194749:[[25572]],194750:[[142321]],194751:[[25634]],194752:[[25541]],194753:[[25513]],194754:[[14894]],194755:[[25705]],194756:[[25726]],194757:[[25757]],194758:[[25719]],194759:[[14956]],194760:[[25935]],194761:[[25964]],194762:[[143370]],194763:[[26083]],194764:[[26360]],194765:[[26185]],194766:[[15129]],194767:[[26257]],194768:[[15112]],194769:[[15076]],194770:[[20882]],194771:[[20885]],194772:[[26368]],194773:[[26268]],194774:[[32941]],194775:[[17369]],194776:[[26391]],194777:[[26395]],194778:[[26401]],194779:[[26462]],194780:[[26451]],194781:[[144323]],194782:[[15177]],194783:[[26618]],194784:[[26501]],194785:[[26706]],194786:[[26757]],194787:[[144493]],194788:[[26766]],194789:[[26655]],194790:[[26900]],194791:[[15261]],194792:[[26946]],194793:[[27043]],194794:[[27114]],194795:[[27304]],194796:[[145059]],194797:[[27355]],194798:[[15384]],194799:[[27425]],194800:[[145575]],194801:[[27476]],194802:[[15438]],194803:[[27506]],194804:[[27551]],194805:[[27578]],194806:[[27579]],194807:[[146061]],194808:[[138507]],194809:[[146170]],194810:[[27726]],194811:[[146620]],194812:[[27839]],194813:[[27853]],194814:[[27751]],194815:[[27926]]},63744:{63744:[[35912]],63745:[[26356]],63746:[[36554]],63747:[[36040]],63748:[[28369]],63749:[[20018]],63750:[[21477]],63751:[[40860]],63752:[[40860]],63753:[[22865]],63754:[[37329]],63755:[[21895]],63756:[[22856]],63757:[[25078]],63758:[[30313]],63759:[[32645]],63760:[[34367]],63761:[[34746]],63762:[[35064]],63763:[[37007]],63764:[[27138]],63765:[[27931]],63766:[[28889]],63767:[[29662]],63768:[[33853]],63769:[[37226]],63770:[[39409]],63771:[[20098]],63772:[[21365]],63773:[[27396]],63774:[[29211]],63775:[[34349]],63776:[[40478]],63777:[[23888]],63778:[[28651]],63779:[[34253]],63780:[[35172]],63781:[[25289]],63782:[[33240]],63783:[[34847]],63784:[[24266]],63785:[[26391]],63786:[[28010]],63787:[[29436]],63788:[[37070]],63789:[[20358]],63790:[[20919]],63791:[[21214]],63792:[[25796]],63793:[[27347]],63794:[[29200]],63795:[[30439]],63796:[[32769]],63797:[[34310]],63798:[[34396]],63799:[[36335]],63800:[[38706]],63801:[[39791]],63802:[[40442]],63803:[[30860]],63804:[[31103]],63805:[[32160]],63806:[[33737]],63807:[[37636]],63808:[[40575]],63809:[[35542]],63810:[[22751]],63811:[[24324]],63812:[[31840]],63813:[[32894]],63814:[[29282]],63815:[[30922]],63816:[[36034]],63817:[[38647]],63818:[[22744]],63819:[[23650]],63820:[[27155]],63821:[[28122]],63822:[[28431]],63823:[[32047]],63824:[[32311]],63825:[[38475]],63826:[[21202]],63827:[[32907]],63828:[[20956]],63829:[[20940]],63830:[[31260]],63831:[[32190]],63832:[[33777]],63833:[[38517]],63834:[[35712]],63835:[[25295]],63836:[[27138]],63837:[[35582]],63838:[[20025]],63839:[[23527]],63840:[[24594]],63841:[[29575]],63842:[[30064]],63843:[[21271]],63844:[[30971]],63845:[[20415]],63846:[[24489]],63847:[[19981]],63848:[[27852]],63849:[[25976]],63850:[[32034]],63851:[[21443]],63852:[[22622]],63853:[[30465]],63854:[[33865]],63855:[[35498]],63856:[[27578]],63857:[[36784]],63858:[[27784]],63859:[[25342]],63860:[[33509]],63861:[[25504]],63862:[[30053]],63863:[[20142]],63864:[[20841]],63865:[[20937]],63866:[[26753]],63867:[[31975]],63868:[[33391]],63869:[[35538]],63870:[[37327]],63871:[[21237]],63872:[[21570]],63873:[[22899]],63874:[[24300]],63875:[[26053]],63876:[[28670]],63877:[[31018]],63878:[[38317]],63879:[[39530]],63880:[[40599]],63881:[[40654]],63882:[[21147]],63883:[[26310]],63884:[[27511]],63885:[[36706]],63886:[[24180]],63887:[[24976]],63888:[[25088]],63889:[[25754]],63890:[[28451]],63891:[[29001]],63892:[[29833]],63893:[[31178]],63894:[[32244]],63895:[[32879]],63896:[[36646]],63897:[[34030]],63898:[[36899]],63899:[[37706]],63900:[[21015]],63901:[[21155]],63902:[[21693]],63903:[[28872]],63904:[[35010]],63905:[[35498]],63906:[[24265]],63907:[[24565]],63908:[[25467]],63909:[[27566]],63910:[[31806]],63911:[[29557]],63912:[[20196]],63913:[[22265]],63914:[[23527]],63915:[[23994]],63916:[[24604]],63917:[[29618]],63918:[[29801]],63919:[[32666]],63920:[[32838]],63921:[[37428]],63922:[[38646]],63923:[[38728]],63924:[[38936]],63925:[[20363]],63926:[[31150]],63927:[[37300]],63928:[[38584]],63929:[[24801]],63930:[[20102]],63931:[[20698]],63932:[[23534]],63933:[[23615]],63934:[[26009]],63935:[[27138]],63936:[[29134]],63937:[[30274]],63938:[[34044]],63939:[[36988]],63940:[[40845]],63941:[[26248]],63942:[[38446]],63943:[[21129]],63944:[[26491]],63945:[[26611]],63946:[[27969]],63947:[[28316]],63948:[[29705]],63949:[[30041]],63950:[[30827]],63951:[[32016]],63952:[[39006]],63953:[[20845]],63954:[[25134]],63955:[[38520]],63956:[[20523]],63957:[[23833]],63958:[[28138]],63959:[[36650]],63960:[[24459]],63961:[[24900]],63962:[[26647]],63963:[[29575]],63964:[[38534]],63965:[[21033]],63966:[[21519]],63967:[[23653]],63968:[[26131]],63969:[[26446]],63970:[[26792]],63971:[[27877]],63972:[[29702]],63973:[[30178]],63974:[[32633]],63975:[[35023]],63976:[[35041]],63977:[[37324]],63978:[[38626]],63979:[[21311]],63980:[[28346]],63981:[[21533]],63982:[[29136]],63983:[[29848]],63984:[[34298]],63985:[[38563]],63986:[[40023]],63987:[[40607]],63988:[[26519]],63989:[[28107]],63990:[[33256]],63991:[[31435]],63992:[[31520]],63993:[[31890]],63994:[[29376]],63995:[[28825]],63996:[[35672]],63997:[[20160]],63998:[[33590]],63999:[[21050]],194816:[[27966]],194817:[[28023]],194818:[[27969]],194819:[[28009]],194820:[[28024]],194821:[[28037]],194822:[[146718]],194823:[[27956]],194824:[[28207]],194825:[[28270]],194826:[[15667]],194827:[[28363]],194828:[[28359]],194829:[[147153]],194830:[[28153]],194831:[[28526]],194832:[[147294]],194833:[[147342]],194834:[[28614]],194835:[[28729]],194836:[[28702]],194837:[[28699]],194838:[[15766]],194839:[[28746]],194840:[[28797]],194841:[[28791]],194842:[[28845]],194843:[[132389]],194844:[[28997]],194845:[[148067]],194846:[[29084]],194847:[[148395]],194848:[[29224]],194849:[[29237]],194850:[[29264]],194851:[[149e3]],194852:[[29312]],194853:[[29333]],194854:[[149301]],194855:[[149524]],194856:[[29562]],194857:[[29579]],194858:[[16044]],194859:[[29605]],194860:[[16056]],194861:[[16056]],194862:[[29767]],194863:[[29788]],194864:[[29809]],194865:[[29829]],194866:[[29898]],194867:[[16155]],194868:[[29988]],194869:[[150582]],194870:[[30014]],194871:[[150674]],194872:[[30064]],194873:[[139679]],194874:[[30224]],194875:[[151457]],194876:[[151480]],194877:[[151620]],194878:[[16380]],194879:[[16392]],194880:[[30452]],194881:[[151795]],194882:[[151794]],194883:[[151833]],194884:[[151859]],194885:[[30494]],194886:[[30495]],194887:[[30495]],194888:[[30538]],194889:[[16441]],194890:[[30603]],194891:[[16454]],194892:[[16534]],194893:[[152605]],194894:[[30798]],194895:[[30860]],194896:[[30924]],194897:[[16611]],194898:[[153126]],194899:[[31062]],194900:[[153242]],194901:[[153285]],194902:[[31119]],194903:[[31211]],194904:[[16687]],194905:[[31296]],194906:[[31306]],194907:[[31311]],194908:[[153980]],194909:[[154279]],194910:[[154279]],194911:[[31470]],194912:[[16898]],194913:[[154539]],194914:[[31686]],194915:[[31689]],194916:[[16935]],194917:[[154752]],194918:[[31954]],194919:[[17056]],194920:[[31976]],194921:[[31971]],194922:[[32e3]],194923:[[155526]],194924:[[32099]],194925:[[17153]],194926:[[32199]],194927:[[32258]],194928:[[32325]],194929:[[17204]],194930:[[156200]],194931:[[156231]],194932:[[17241]],194933:[[156377]],194934:[[32634]],194935:[[156478]],194936:[[32661]],194937:[[32762]],194938:[[32773]],194939:[[156890]],194940:[[156963]],194941:[[32864]],194942:[[157096]],194943:[[32880]],194944:[[144223]],194945:[[17365]],194946:[[32946]],194947:[[33027]],194948:[[17419]],194949:[[33086]],194950:[[23221]],194951:[[157607]],194952:[[157621]],194953:[[144275]],194954:[[144284]],194955:[[33281]],194956:[[33284]],194957:[[36766]],194958:[[17515]],194959:[[33425]],194960:[[33419]],194961:[[33437]],194962:[[21171]],194963:[[33457]],194964:[[33459]],194965:[[33469]],194966:[[33510]],194967:[[158524]],194968:[[33509]],194969:[[33565]],194970:[[33635]],194971:[[33709]],194972:[[33571]],194973:[[33725]],194974:[[33767]],194975:[[33879]],194976:[[33619]],194977:[[33738]],194978:[[33740]],194979:[[33756]],194980:[[158774]],194981:[[159083]],194982:[[158933]],194983:[[17707]],194984:[[34033]],194985:[[34035]],194986:[[34070]],194987:[[160714]],194988:[[34148]],194989:[[159532]],194990:[[17757]],194991:[[17761]],194992:[[159665]],194993:[[159954]],194994:[[17771]],194995:[[34384]],194996:[[34396]],194997:[[34407]],194998:[[34409]],194999:[[34473]],195e3:[[34440]],195001:[[34574]],195002:[[34530]],195003:[[34681]],195004:[[34600]],195005:[[34667]],195006:[[34694]],195007:[[17879]],195008:[[34785]],195009:[[34817]],195010:[[17913]],195011:[[34912]],195012:[[34915]],195013:[[161383]],195014:[[35031]],195015:[[35038]],195016:[[17973]],195017:[[35066]],195018:[[13499]],195019:[[161966]],195020:[[162150]],195021:[[18110]],195022:[[18119]],195023:[[35488]],195024:[[35565]],195025:[[35722]],195026:[[35925]],195027:[[162984]],195028:[[36011]],195029:[[36033]],195030:[[36123]],195031:[[36215]],195032:[[163631]],195033:[[133124]],195034:[[36299]],195035:[[36284]],195036:[[36336]],195037:[[133342]],195038:[[36564]],195039:[[36664]],195040:[[165330]],195041:[[165357]],195042:[[37012]],195043:[[37105]],195044:[[37137]],195045:[[165678]],195046:[[37147]],195047:[[37432]],195048:[[37591]],195049:[[37592]],195050:[[37500]],195051:[[37881]],195052:[[37909]],195053:[[166906]],195054:[[38283]],195055:[[18837]],195056:[[38327]],195057:[[167287]],195058:[[18918]],195059:[[38595]],195060:[[23986]],195061:[[38691]],195062:[[168261]],195063:[[168474]],195064:[[19054]],195065:[[19062]],195066:[[38880]],195067:[[168970]],195068:[[19122]],195069:[[169110]],195070:[[38923]],195071:[[38923]]},64e3:{64e3:[[20999]],64001:[[24230]],64002:[[25299]],64003:[[31958]],64004:[[23429]],64005:[[27934]],64006:[[26292]],64007:[[36667]],64008:[[34892]],64009:[[38477]],64010:[[35211]],64011:[[24275]],64012:[[20800]],64013:[[21952]],64016:[[22618]],64018:[[26228]],64021:[[20958]],64022:[[29482]],64023:[[30410]],64024:[[31036]],64025:[[31070]],64026:[[31077]],64027:[[31119]],64028:[[38742]],64029:[[31934]],64030:[[32701]],64032:[[34322]],64034:[[35576]],64037:[[36920]],64038:[[37117]],64042:[[39151]],64043:[[39164]],64044:[[39208]],64045:[[40372]],64046:[[37086]],64047:[[38583]],64048:[[20398]],64049:[[20711]],64050:[[20813]],64051:[[21193]],64052:[[21220]],64053:[[21329]],64054:[[21917]],64055:[[22022]],64056:[[22120]],64057:[[22592]],64058:[[22696]],64059:[[23652]],64060:[[23662]],64061:[[24724]],64062:[[24936]],64063:[[24974]],64064:[[25074]],64065:[[25935]],64066:[[26082]],64067:[[26257]],64068:[[26757]],64069:[[28023]],64070:[[28186]],64071:[[28450]],64072:[[29038]],64073:[[29227]],64074:[[29730]],64075:[[30865]],64076:[[31038]],64077:[[31049]],64078:[[31048]],64079:[[31056]],64080:[[31062]],64081:[[31069]],64082:[[31117]],64083:[[31118]],64084:[[31296]],64085:[[31361]],64086:[[31680]],64087:[[32244]],64088:[[32265]],64089:[[32321]],64090:[[32626]],64091:[[32773]],64092:[[33261]],64093:[[33401]],64094:[[33401]],64095:[[33879]],64096:[[35088]],64097:[[35222]],64098:[[35585]],64099:[[35641]],64100:[[36051]],64101:[[36104]],64102:[[36790]],64103:[[36920]],64104:[[38627]],64105:[[38911]],64106:[[38971]],64107:[[24693]],64108:[[148206]],64109:[[33304]],64112:[[20006]],64113:[[20917]],64114:[[20840]],64115:[[20352]],64116:[[20805]],64117:[[20864]],64118:[[21191]],64119:[[21242]],64120:[[21917]],64121:[[21845]],64122:[[21913]],64123:[[21986]],64124:[[22618]],64125:[[22707]],64126:[[22852]],64127:[[22868]],64128:[[23138]],64129:[[23336]],64130:[[24274]],64131:[[24281]],64132:[[24425]],64133:[[24493]],64134:[[24792]],64135:[[24910]],64136:[[24840]],64137:[[24974]],64138:[[24928]],64139:[[25074]],64140:[[25140]],64141:[[25540]],64142:[[25628]],64143:[[25682]],64144:[[25942]],64145:[[26228]],64146:[[26391]],64147:[[26395]],64148:[[26454]],64149:[[27513]],64150:[[27578]],64151:[[27969]],64152:[[28379]],64153:[[28363]],64154:[[28450]],64155:[[28702]],64156:[[29038]],64157:[[30631]],64158:[[29237]],64159:[[29359]],64160:[[29482]],64161:[[29809]],64162:[[29958]],64163:[[30011]],64164:[[30237]],64165:[[30239]],64166:[[30410]],64167:[[30427]],64168:[[30452]],64169:[[30538]],64170:[[30528]],64171:[[30924]],64172:[[31409]],64173:[[31680]],64174:[[31867]],64175:[[32091]],64176:[[32244]],64177:[[32574]],64178:[[32773]],64179:[[33618]],64180:[[33775]],64181:[[34681]],64182:[[35137]],64183:[[35206]],64184:[[35222]],64185:[[35519]],64186:[[35576]],64187:[[35531]],64188:[[35585]],64189:[[35582]],64190:[[35565]],64191:[[35641]],64192:[[35722]],64193:[[36104]],64194:[[36664]],64195:[[36978]],64196:[[37273]],64197:[[37494]],64198:[[38524]],64199:[[38627]],64200:[[38742]],64201:[[38875]],64202:[[38911]],64203:[[38923]],64204:[[38971]],64205:[[39698]],64206:[[40860]],64207:[[141386]],64208:[[141380]],64209:[[144341]],64210:[[15261]],64211:[[16408]],64212:[[16441]],64213:[[152137]],64214:[[154832]],64215:[[163539]],64216:[[40771]],64217:[[40846]],195072:[[38953]],195073:[[169398]],195074:[[39138]],195075:[[19251]],195076:[[39209]],195077:[[39335]],195078:[[39362]],195079:[[39422]],195080:[[19406]],195081:[[170800]],195082:[[39698]],195083:[[4e4]],195084:[[40189]],195085:[[19662]],195086:[[19693]],195087:[[40295]],195088:[[172238]],195089:[[19704]],195090:[[172293]],195091:[[172558]],195092:[[172689]],195093:[[40635]],195094:[[19798]],195095:[[40697]],195096:[[40702]],195097:[[40709]],195098:[[40719]],195099:[[40726]],195100:[[40763]],195101:[[173568]]},64256:{64256:[[102,102],256],64257:[[102,105],256],64258:[[102,108],256],64259:[[102,102,105],256],64260:[[102,102,108],256],64261:[[383,116],256],64262:[[115,116],256],64275:[[1396,1398],256],64276:[[1396,1381],256],64277:[[1396,1387],256],64278:[[1406,1398],256],64279:[[1396,1389],256],64285:[[1497,1460],512],64286:[,26],64287:[[1522,1463],512],64288:[[1506],256],64289:[[1488],256],64290:[[1491],256],64291:[[1492],256],64292:[[1499],256],64293:[[1500],256],64294:[[1501],256],64295:[[1512],256],64296:[[1514],256],64297:[[43],256],64298:[[1513,1473],512],64299:[[1513,1474],512],64300:[[64329,1473],512],64301:[[64329,1474],512],64302:[[1488,1463],512],64303:[[1488,1464],512],64304:[[1488,1468],512],64305:[[1489,1468],512],64306:[[1490,1468],512],64307:[[1491,1468],512],64308:[[1492,1468],512],64309:[[1493,1468],512],64310:[[1494,1468],512],64312:[[1496,1468],512],64313:[[1497,1468],512],64314:[[1498,1468],512],64315:[[1499,1468],512],64316:[[1500,1468],512],64318:[[1502,1468],512],64320:[[1504,1468],512],64321:[[1505,1468],512],64323:[[1507,1468],512],64324:[[1508,1468],512],64326:[[1510,1468],512],64327:[[1511,1468],512],64328:[[1512,1468],512],64329:[[1513,1468],512],64330:[[1514,1468],512],64331:[[1493,1465],512],64332:[[1489,1471],512],64333:[[1499,1471],512],64334:[[1508,1471],512],64335:[[1488,1500],256],64336:[[1649],256],64337:[[1649],256],64338:[[1659],256],64339:[[1659],256],64340:[[1659],256],64341:[[1659],256],64342:[[1662],256],64343:[[1662],256],64344:[[1662],256],64345:[[1662],256],64346:[[1664],256],64347:[[1664],256],64348:[[1664],256],64349:[[1664],256],64350:[[1658],256],64351:[[1658],256],64352:[[1658],256],64353:[[1658],256],64354:[[1663],256],64355:[[1663],256],64356:[[1663],256],64357:[[1663],256],64358:[[1657],256],64359:[[1657],256],64360:[[1657],256],64361:[[1657],256],64362:[[1700],256],64363:[[1700],256],64364:[[1700],256],64365:[[1700],256],64366:[[1702],256],64367:[[1702],256],64368:[[1702],256],64369:[[1702],256],64370:[[1668],256],64371:[[1668],256],64372:[[1668],256],64373:[[1668],256],64374:[[1667],256],64375:[[1667],256],64376:[[1667],256],64377:[[1667],256],64378:[[1670],256],64379:[[1670],256],64380:[[1670],256],64381:[[1670],256],64382:[[1671],256],64383:[[1671],256],64384:[[1671],256],64385:[[1671],256],64386:[[1677],256],64387:[[1677],256],64388:[[1676],256],64389:[[1676],256],64390:[[1678],256],64391:[[1678],256],64392:[[1672],256],64393:[[1672],256],64394:[[1688],256],64395:[[1688],256],64396:[[1681],256],64397:[[1681],256],64398:[[1705],256],64399:[[1705],256],64400:[[1705],256],64401:[[1705],256],64402:[[1711],256],64403:[[1711],256],64404:[[1711],256],64405:[[1711],256],64406:[[1715],256],64407:[[1715],256],64408:[[1715],256],64409:[[1715],256],64410:[[1713],256],64411:[[1713],256],64412:[[1713],256],64413:[[1713],256],64414:[[1722],256],64415:[[1722],256],64416:[[1723],256],64417:[[1723],256],64418:[[1723],256],64419:[[1723],256],64420:[[1728],256],64421:[[1728],256],64422:[[1729],256],64423:[[1729],256],64424:[[1729],256],64425:[[1729],256],64426:[[1726],256],64427:[[1726],256],64428:[[1726],256],64429:[[1726],256],64430:[[1746],256],64431:[[1746],256],64432:[[1747],256],64433:[[1747],256],64467:[[1709],256],64468:[[1709],256],64469:[[1709],256],64470:[[1709],256],64471:[[1735],256],64472:[[1735],256],64473:[[1734],256],64474:[[1734],256],64475:[[1736],256],64476:[[1736],256],64477:[[1655],256],64478:[[1739],256],64479:[[1739],256],64480:[[1733],256],64481:[[1733],256],64482:[[1737],256],64483:[[1737],256],64484:[[1744],256],64485:[[1744],256],64486:[[1744],256],64487:[[1744],256],64488:[[1609],256],64489:[[1609],256],64490:[[1574,1575],256],64491:[[1574,1575],256],64492:[[1574,1749],256],64493:[[1574,1749],256],64494:[[1574,1608],256],64495:[[1574,1608],256],64496:[[1574,1735],256],64497:[[1574,1735],256],64498:[[1574,1734],256],64499:[[1574,1734],256],64500:[[1574,1736],256],64501:[[1574,1736],256],64502:[[1574,1744],256],64503:[[1574,1744],256],64504:[[1574,1744],256],64505:[[1574,1609],256],64506:[[1574,1609],256],64507:[[1574,1609],256],64508:[[1740],256],64509:[[1740],256],64510:[[1740],256],64511:[[1740],256]},64512:{64512:[[1574,1580],256],64513:[[1574,1581],256],64514:[[1574,1605],256],64515:[[1574,1609],256],64516:[[1574,1610],256],64517:[[1576,1580],256],64518:[[1576,1581],256],64519:[[1576,1582],256],64520:[[1576,1605],256],64521:[[1576,1609],256],64522:[[1576,1610],256],64523:[[1578,1580],256],64524:[[1578,1581],256],64525:[[1578,1582],256],64526:[[1578,1605],256],64527:[[1578,1609],256],64528:[[1578,1610],256],64529:[[1579,1580],256],64530:[[1579,1605],256],64531:[[1579,1609],256],64532:[[1579,1610],256],64533:[[1580,1581],256],64534:[[1580,1605],256],64535:[[1581,1580],256],64536:[[1581,1605],256],64537:[[1582,1580],256],64538:[[1582,1581],256],64539:[[1582,1605],256],64540:[[1587,1580],256],64541:[[1587,1581],256],64542:[[1587,1582],256],64543:[[1587,1605],256],64544:[[1589,1581],256],64545:[[1589,1605],256],64546:[[1590,1580],256],64547:[[1590,1581],256],64548:[[1590,1582],256],64549:[[1590,1605],256],64550:[[1591,1581],256],64551:[[1591,1605],256],64552:[[1592,1605],256],64553:[[1593,1580],256],64554:[[1593,1605],256],64555:[[1594,1580],256],64556:[[1594,1605],256],64557:[[1601,1580],256],64558:[[1601,1581],256],64559:[[1601,1582],256],64560:[[1601,1605],256],64561:[[1601,1609],256],64562:[[1601,1610],256],64563:[[1602,1581],256],64564:[[1602,1605],256],64565:[[1602,1609],256],64566:[[1602,1610],256],64567:[[1603,1575],256],64568:[[1603,1580],256],64569:[[1603,1581],256],64570:[[1603,1582],256],64571:[[1603,1604],256],64572:[[1603,1605],256],64573:[[1603,1609],256],64574:[[1603,1610],256],64575:[[1604,1580],256],64576:[[1604,1581],256],64577:[[1604,1582],256],64578:[[1604,1605],256],64579:[[1604,1609],256],64580:[[1604,1610],256],64581:[[1605,1580],256],64582:[[1605,1581],256],64583:[[1605,1582],256],64584:[[1605,1605],256],64585:[[1605,1609],256],64586:[[1605,1610],256],64587:[[1606,1580],256],64588:[[1606,1581],256],64589:[[1606,1582],256],64590:[[1606,1605],256],64591:[[1606,1609],256],64592:[[1606,1610],256],64593:[[1607,1580],256],64594:[[1607,1605],256],64595:[[1607,1609],256],64596:[[1607,1610],256],64597:[[1610,1580],256],64598:[[1610,1581],256],64599:[[1610,1582],256],64600:[[1610,1605],256],64601:[[1610,1609],256],64602:[[1610,1610],256],64603:[[1584,1648],256],64604:[[1585,1648],256],64605:[[1609,1648],256],64606:[[32,1612,1617],256],64607:[[32,1613,1617],256],64608:[[32,1614,1617],256],64609:[[32,1615,1617],256],64610:[[32,1616,1617],256],64611:[[32,1617,1648],256],64612:[[1574,1585],256],64613:[[1574,1586],256],64614:[[1574,1605],256],64615:[[1574,1606],256],64616:[[1574,1609],256],64617:[[1574,1610],256],64618:[[1576,1585],256],64619:[[1576,1586],256],64620:[[1576,1605],256],64621:[[1576,1606],256],64622:[[1576,1609],256],64623:[[1576,1610],256],64624:[[1578,1585],256],64625:[[1578,1586],256],64626:[[1578,1605],256],64627:[[1578,1606],256],64628:[[1578,1609],256],64629:[[1578,1610],256],64630:[[1579,1585],256],64631:[[1579,1586],256],64632:[[1579,1605],256],64633:[[1579,1606],256],64634:[[1579,1609],256],64635:[[1579,1610],256],64636:[[1601,1609],256],64637:[[1601,1610],256],64638:[[1602,1609],256],64639:[[1602,1610],256],64640:[[1603,1575],256],64641:[[1603,1604],256],64642:[[1603,1605],256],64643:[[1603,1609],256],64644:[[1603,1610],256],64645:[[1604,1605],256],64646:[[1604,1609],256],64647:[[1604,1610],256],64648:[[1605,1575],256],64649:[[1605,1605],256],64650:[[1606,1585],256],64651:[[1606,1586],256],64652:[[1606,1605],256],64653:[[1606,1606],256],64654:[[1606,1609],256],64655:[[1606,1610],256],64656:[[1609,1648],256],64657:[[1610,1585],256],64658:[[1610,1586],256],64659:[[1610,1605],256],64660:[[1610,1606],256],64661:[[1610,1609],256],64662:[[1610,1610],256],64663:[[1574,1580],256],64664:[[1574,1581],256],64665:[[1574,1582],256],64666:[[1574,1605],256],64667:[[1574,1607],256],64668:[[1576,1580],256],64669:[[1576,1581],256],64670:[[1576,1582],256],64671:[[1576,1605],256],64672:[[1576,1607],256],64673:[[1578,1580],256],64674:[[1578,1581],256],64675:[[1578,1582],256],64676:[[1578,1605],256],64677:[[1578,1607],256],64678:[[1579,1605],256],64679:[[1580,1581],256],64680:[[1580,1605],256],64681:[[1581,1580],256],64682:[[1581,1605],256],64683:[[1582,1580],256],64684:[[1582,1605],256],64685:[[1587,1580],256],64686:[[1587,1581],256],64687:[[1587,1582],256],64688:[[1587,1605],256],64689:[[1589,1581],256],64690:[[1589,1582],256],64691:[[1589,1605],256],64692:[[1590,1580],256],64693:[[1590,1581],256],64694:[[1590,1582],256],64695:[[1590,1605],256],64696:[[1591,1581],256],64697:[[1592,1605],256],64698:[[1593,1580],256],64699:[[1593,1605],256],64700:[[1594,1580],256],64701:[[1594,1605],256],64702:[[1601,1580],256],64703:[[1601,1581],256],64704:[[1601,1582],256],64705:[[1601,1605],256],64706:[[1602,1581],256],64707:[[1602,1605],256],64708:[[1603,1580],256],64709:[[1603,1581],256],64710:[[1603,1582],256],64711:[[1603,1604],256],64712:[[1603,1605],256],64713:[[1604,1580],256],64714:[[1604,1581],256],64715:[[1604,1582],256],64716:[[1604,1605],256],64717:[[1604,1607],256],64718:[[1605,1580],256],64719:[[1605,1581],256],64720:[[1605,1582],256],64721:[[1605,1605],256],64722:[[1606,1580],256],64723:[[1606,1581],256],64724:[[1606,1582],256],64725:[[1606,1605],256],64726:[[1606,1607],256],64727:[[1607,1580],256],64728:[[1607,1605],256],64729:[[1607,1648],256],64730:[[1610,1580],256],64731:[[1610,1581],256],64732:[[1610,1582],256],64733:[[1610,1605],256],64734:[[1610,1607],256],64735:[[1574,1605],256],64736:[[1574,1607],256],64737:[[1576,1605],256],64738:[[1576,1607],256],64739:[[1578,1605],256],64740:[[1578,1607],256],64741:[[1579,1605],256],64742:[[1579,1607],256],64743:[[1587,1605],256],64744:[[1587,1607],256],64745:[[1588,1605],256],64746:[[1588,1607],256],64747:[[1603,1604],256],64748:[[1603,1605],256],64749:[[1604,1605],256],64750:[[1606,1605],256],64751:[[1606,1607],256],64752:[[1610,1605],256],64753:[[1610,1607],256],64754:[[1600,1614,1617],256],64755:[[1600,1615,1617],256],64756:[[1600,1616,1617],256],64757:[[1591,1609],256],64758:[[1591,1610],256],64759:[[1593,1609],256],64760:[[1593,1610],256],64761:[[1594,1609],256],64762:[[1594,1610],256],64763:[[1587,1609],256],64764:[[1587,1610],256],64765:[[1588,1609],256],64766:[[1588,1610],256],64767:[[1581,1609],256]},64768:{64768:[[1581,1610],256],64769:[[1580,1609],256],64770:[[1580,1610],256],64771:[[1582,1609],256],64772:[[1582,1610],256],64773:[[1589,1609],256],64774:[[1589,1610],256],64775:[[1590,1609],256],64776:[[1590,1610],256],64777:[[1588,1580],256],64778:[[1588,1581],256],64779:[[1588,1582],256],64780:[[1588,1605],256],64781:[[1588,1585],256],64782:[[1587,1585],256],64783:[[1589,1585],256],64784:[[1590,1585],256],64785:[[1591,1609],256],64786:[[1591,1610],256],64787:[[1593,1609],256],64788:[[1593,1610],256],64789:[[1594,1609],256],64790:[[1594,1610],256],64791:[[1587,1609],256],64792:[[1587,1610],256],64793:[[1588,1609],256],64794:[[1588,1610],256],64795:[[1581,1609],256],64796:[[1581,1610],256],64797:[[1580,1609],256],64798:[[1580,1610],256],64799:[[1582,1609],256],64800:[[1582,1610],256],64801:[[1589,1609],256],64802:[[1589,1610],256],64803:[[1590,1609],256],64804:[[1590,1610],256],64805:[[1588,1580],256],64806:[[1588,1581],256],64807:[[1588,1582],256],64808:[[1588,1605],256],64809:[[1588,1585],256],64810:[[1587,1585],256],64811:[[1589,1585],256],64812:[[1590,1585],256],64813:[[1588,1580],256],64814:[[1588,1581],256],64815:[[1588,1582],256],64816:[[1588,1605],256],64817:[[1587,1607],256],64818:[[1588,1607],256],64819:[[1591,1605],256],64820:[[1587,1580],256],64821:[[1587,1581],256],64822:[[1587,1582],256],64823:[[1588,1580],256],64824:[[1588,1581],256],64825:[[1588,1582],256],64826:[[1591,1605],256],64827:[[1592,1605],256],64828:[[1575,1611],256],64829:[[1575,1611],256],64848:[[1578,1580,1605],256],64849:[[1578,1581,1580],256],64850:[[1578,1581,1580],256],64851:[[1578,1581,1605],256],64852:[[1578,1582,1605],256],64853:[[1578,1605,1580],256],64854:[[1578,1605,1581],256],64855:[[1578,1605,1582],256],64856:[[1580,1605,1581],256],64857:[[1580,1605,1581],256],64858:[[1581,1605,1610],256],64859:[[1581,1605,1609],256],64860:[[1587,1581,1580],256],64861:[[1587,1580,1581],256],64862:[[1587,1580,1609],256],64863:[[1587,1605,1581],256],64864:[[1587,1605,1581],256],64865:[[1587,1605,1580],256],64866:[[1587,1605,1605],256],64867:[[1587,1605,1605],256],64868:[[1589,1581,1581],256],64869:[[1589,1581,1581],256],64870:[[1589,1605,1605],256],64871:[[1588,1581,1605],256],64872:[[1588,1581,1605],256],64873:[[1588,1580,1610],256],64874:[[1588,1605,1582],256],64875:[[1588,1605,1582],256],64876:[[1588,1605,1605],256],64877:[[1588,1605,1605],256],64878:[[1590,1581,1609],256],64879:[[1590,1582,1605],256],64880:[[1590,1582,1605],256],64881:[[1591,1605,1581],256],64882:[[1591,1605,1581],256],64883:[[1591,1605,1605],256],64884:[[1591,1605,1610],256],64885:[[1593,1580,1605],256],64886:[[1593,1605,1605],256],64887:[[1593,1605,1605],256],64888:[[1593,1605,1609],256],64889:[[1594,1605,1605],256],64890:[[1594,1605,1610],256],64891:[[1594,1605,1609],256],64892:[[1601,1582,1605],256],64893:[[1601,1582,1605],256],64894:[[1602,1605,1581],256],64895:[[1602,1605,1605],256],64896:[[1604,1581,1605],256],64897:[[1604,1581,1610],256],64898:[[1604,1581,1609],256],64899:[[1604,1580,1580],256],64900:[[1604,1580,1580],256],64901:[[1604,1582,1605],256],64902:[[1604,1582,1605],256],64903:[[1604,1605,1581],256],64904:[[1604,1605,1581],256],64905:[[1605,1581,1580],256],64906:[[1605,1581,1605],256],64907:[[1605,1581,1610],256],64908:[[1605,1580,1581],256],64909:[[1605,1580,1605],256],64910:[[1605,1582,1580],256],64911:[[1605,1582,1605],256],64914:[[1605,1580,1582],256],64915:[[1607,1605,1580],256],64916:[[1607,1605,1605],256],64917:[[1606,1581,1605],256],64918:[[1606,1581,1609],256],64919:[[1606,1580,1605],256],64920:[[1606,1580,1605],256],64921:[[1606,1580,1609],256],64922:[[1606,1605,1610],256],64923:[[1606,1605,1609],256],64924:[[1610,1605,1605],256],64925:[[1610,1605,1605],256],64926:[[1576,1582,1610],256],64927:[[1578,1580,1610],256],64928:[[1578,1580,1609],256],64929:[[1578,1582,1610],256],64930:[[1578,1582,1609],256],64931:[[1578,1605,1610],256],64932:[[1578,1605,1609],256],64933:[[1580,1605,1610],256],64934:[[1580,1581,1609],256],64935:[[1580,1605,1609],256],64936:[[1587,1582,1609],256],64937:[[1589,1581,1610],256],64938:[[1588,1581,1610],256],64939:[[1590,1581,1610],256],64940:[[1604,1580,1610],256],64941:[[1604,1605,1610],256],64942:[[1610,1581,1610],256],64943:[[1610,1580,1610],256],64944:[[1610,1605,1610],256],64945:[[1605,1605,1610],256],64946:[[1602,1605,1610],256],64947:[[1606,1581,1610],256],64948:[[1602,1605,1581],256],64949:[[1604,1581,1605],256],64950:[[1593,1605,1610],256],64951:[[1603,1605,1610],256],64952:[[1606,1580,1581],256],64953:[[1605,1582,1610],256],64954:[[1604,1580,1605],256],64955:[[1603,1605,1605],256],64956:[[1604,1580,1605],256],64957:[[1606,1580,1581],256],64958:[[1580,1581,1610],256],64959:[[1581,1580,1610],256],64960:[[1605,1580,1610],256],64961:[[1601,1605,1610],256],64962:[[1576,1581,1610],256],64963:[[1603,1605,1605],256],64964:[[1593,1580,1605],256],64965:[[1589,1605,1605],256],64966:[[1587,1582,1610],256],64967:[[1606,1580,1610],256],65008:[[1589,1604,1746],256],65009:[[1602,1604,1746],256],65010:[[1575,1604,1604,1607],256],65011:[[1575,1603,1576,1585],256],65012:[[1605,1581,1605,1583],256],65013:[[1589,1604,1593,1605],256],65014:[[1585,1587,1608,1604],256],65015:[[1593,1604,1610,1607],256],65016:[[1608,1587,1604,1605],256],65017:[[1589,1604,1609],256],65018:[[1589,1604,1609,32,1575,1604,1604,1607,32,1593,1604,1610,1607,32,1608,1587,1604,1605],256],65019:[[1580,1604,32,1580,1604,1575,1604,1607],256],65020:[[1585,1740,1575,1604],256]},65024:{65040:[[44],256],65041:[[12289],256],65042:[[12290],256],65043:[[58],256],65044:[[59],256],65045:[[33],256],65046:[[63],256],65047:[[12310],256],65048:[[12311],256],65049:[[8230],256],65056:[,230],65057:[,230],65058:[,230],65059:[,230],65060:[,230],65061:[,230],65062:[,230],65063:[,220],65064:[,220],65065:[,220],65066:[,220],65067:[,220],65068:[,220],65069:[,220],65072:[[8229],256],65073:[[8212],256],65074:[[8211],256],65075:[[95],256],65076:[[95],256],65077:[[40],256],65078:[[41],256],65079:[[123],256],65080:[[125],256],65081:[[12308],256],65082:[[12309],256],65083:[[12304],256],65084:[[12305],256],65085:[[12298],256],65086:[[12299],256],65087:[[12296],256],65088:[[12297],256],65089:[[12300],256],65090:[[12301],256],65091:[[12302],256],65092:[[12303],256],65095:[[91],256],65096:[[93],256],65097:[[8254],256],65098:[[8254],256],65099:[[8254],256],65100:[[8254],256],65101:[[95],256],65102:[[95],256],65103:[[95],256],65104:[[44],256],65105:[[12289],256],65106:[[46],256],65108:[[59],256],65109:[[58],256],65110:[[63],256],65111:[[33],256],65112:[[8212],256],65113:[[40],256],65114:[[41],256],65115:[[123],256],65116:[[125],256],65117:[[12308],256],65118:[[12309],256],65119:[[35],256],65120:[[38],256],65121:[[42],256],65122:[[43],256],65123:[[45],256],65124:[[60],256],65125:[[62],256],65126:[[61],256],65128:[[92],256],65129:[[36],256],65130:[[37],256],65131:[[64],256],65136:[[32,1611],256],65137:[[1600,1611],256],65138:[[32,1612],256],65140:[[32,1613],256],65142:[[32,1614],256],65143:[[1600,1614],256],65144:[[32,1615],256],65145:[[1600,1615],256],65146:[[32,1616],256],65147:[[1600,1616],256],65148:[[32,1617],256],65149:[[1600,1617],256],65150:[[32,1618],256],65151:[[1600,1618],256],65152:[[1569],256],65153:[[1570],256],65154:[[1570],256],65155:[[1571],256],65156:[[1571],256],65157:[[1572],256],65158:[[1572],256],65159:[[1573],256],65160:[[1573],256],65161:[[1574],256],65162:[[1574],256],65163:[[1574],256],65164:[[1574],256],65165:[[1575],256],65166:[[1575],256],65167:[[1576],256],65168:[[1576],256],65169:[[1576],256],65170:[[1576],256],65171:[[1577],256],65172:[[1577],256],65173:[[1578],256],65174:[[1578],256],65175:[[1578],256],65176:[[1578],256],65177:[[1579],256],65178:[[1579],256],65179:[[1579],256],65180:[[1579],256],65181:[[1580],256],65182:[[1580],256],65183:[[1580],256],65184:[[1580],256],65185:[[1581],256],65186:[[1581],256],65187:[[1581],256],65188:[[1581],256],65189:[[1582],256],65190:[[1582],256],65191:[[1582],256],65192:[[1582],256],65193:[[1583],256],65194:[[1583],256],65195:[[1584],256],65196:[[1584],256],65197:[[1585],256],65198:[[1585],256],65199:[[1586],256],65200:[[1586],256],65201:[[1587],256],65202:[[1587],256],65203:[[1587],256],65204:[[1587],256],65205:[[1588],256],65206:[[1588],256],65207:[[1588],256],65208:[[1588],256],65209:[[1589],256],65210:[[1589],256],65211:[[1589],256],65212:[[1589],256],65213:[[1590],256],65214:[[1590],256],65215:[[1590],256],65216:[[1590],256],65217:[[1591],256],65218:[[1591],256],65219:[[1591],256],65220:[[1591],256],65221:[[1592],256],65222:[[1592],256],65223:[[1592],256],65224:[[1592],256],65225:[[1593],256],65226:[[1593],256],65227:[[1593],256],65228:[[1593],256],65229:[[1594],256],65230:[[1594],256],65231:[[1594],256],65232:[[1594],256],65233:[[1601],256],65234:[[1601],256],65235:[[1601],256],65236:[[1601],256],65237:[[1602],256],65238:[[1602],256],65239:[[1602],256],65240:[[1602],256],65241:[[1603],256],65242:[[1603],256],65243:[[1603],256],65244:[[1603],256],65245:[[1604],256],65246:[[1604],256],65247:[[1604],256],65248:[[1604],256],65249:[[1605],256],65250:[[1605],256],65251:[[1605],256],65252:[[1605],256],65253:[[1606],256],65254:[[1606],256],65255:[[1606],256],65256:[[1606],256],65257:[[1607],256],65258:[[1607],256],65259:[[1607],256],65260:[[1607],256],65261:[[1608],256],65262:[[1608],256],65263:[[1609],256],65264:[[1609],256],65265:[[1610],256],65266:[[1610],256],65267:[[1610],256],65268:[[1610],256],65269:[[1604,1570],256],65270:[[1604,1570],256],65271:[[1604,1571],256],65272:[[1604,1571],256],65273:[[1604,1573],256],65274:[[1604,1573],256],65275:[[1604,1575],256],65276:[[1604,1575],256]},65280:{65281:[[33],256],65282:[[34],256],65283:[[35],256],65284:[[36],256],65285:[[37],256],65286:[[38],256],65287:[[39],256],65288:[[40],256],65289:[[41],256],65290:[[42],256],65291:[[43],256],65292:[[44],256],65293:[[45],256],65294:[[46],256],65295:[[47],256],65296:[[48],256],65297:[[49],256],65298:[[50],256],65299:[[51],256],65300:[[52],256],65301:[[53],256],65302:[[54],256],65303:[[55],256],65304:[[56],256],65305:[[57],256],65306:[[58],256],65307:[[59],256],65308:[[60],256],65309:[[61],256],65310:[[62],256],65311:[[63],256],65312:[[64],256],65313:[[65],256],65314:[[66],256],65315:[[67],256],65316:[[68],256],65317:[[69],256],65318:[[70],256],65319:[[71],256],65320:[[72],256],65321:[[73],256],65322:[[74],256],65323:[[75],256],65324:[[76],256],65325:[[77],256],65326:[[78],256],65327:[[79],256],65328:[[80],256],65329:[[81],256],65330:[[82],256],65331:[[83],256],65332:[[84],256],65333:[[85],256],65334:[[86],256],65335:[[87],256],65336:[[88],256],65337:[[89],256],65338:[[90],256],65339:[[91],256],65340:[[92],256],65341:[[93],256],65342:[[94],256],65343:[[95],256],65344:[[96],256],65345:[[97],256],65346:[[98],256],65347:[[99],256],65348:[[100],256],65349:[[101],256],65350:[[102],256],65351:[[103],256],65352:[[104],256],65353:[[105],256],65354:[[106],256],65355:[[107],256],65356:[[108],256],65357:[[109],256],65358:[[110],256],65359:[[111],256],65360:[[112],256],65361:[[113],256],65362:[[114],256],65363:[[115],256],65364:[[116],256],65365:[[117],256],65366:[[118],256],65367:[[119],256],65368:[[120],256],65369:[[121],256],65370:[[122],256],65371:[[123],256],65372:[[124],256],65373:[[125],256],65374:[[126],256],65375:[[10629],256],65376:[[10630],256],65377:[[12290],256],65378:[[12300],256],65379:[[12301],256],65380:[[12289],256],65381:[[12539],256],65382:[[12530],256],65383:[[12449],256],65384:[[12451],256],65385:[[12453],256],65386:[[12455],256],65387:[[12457],256],65388:[[12515],256],65389:[[12517],256],65390:[[12519],256],65391:[[12483],256],65392:[[12540],256],65393:[[12450],256],65394:[[12452],256],65395:[[12454],256],65396:[[12456],256],65397:[[12458],256],65398:[[12459],256],65399:[[12461],256],65400:[[12463],256],65401:[[12465],256],65402:[[12467],256],65403:[[12469],256],65404:[[12471],256],65405:[[12473],256],65406:[[12475],256],65407:[[12477],256],65408:[[12479],256],65409:[[12481],256],65410:[[12484],256],65411:[[12486],256],65412:[[12488],256],65413:[[12490],256],65414:[[12491],256],65415:[[12492],256],65416:[[12493],256],65417:[[12494],256],65418:[[12495],256],65419:[[12498],256],65420:[[12501],256],65421:[[12504],256],65422:[[12507],256],65423:[[12510],256],65424:[[12511],256],65425:[[12512],256],65426:[[12513],256],65427:[[12514],256],65428:[[12516],256],65429:[[12518],256],65430:[[12520],256],65431:[[12521],256],65432:[[12522],256],65433:[[12523],256],65434:[[12524],256],65435:[[12525],256],65436:[[12527],256],65437:[[12531],256],65438:[[12441],256],65439:[[12442],256],65440:[[12644],256],65441:[[12593],256],65442:[[12594],256],65443:[[12595],256],65444:[[12596],256],65445:[[12597],256],65446:[[12598],256],65447:[[12599],256],65448:[[12600],256],65449:[[12601],256],65450:[[12602],256],65451:[[12603],256],65452:[[12604],256],65453:[[12605],256],65454:[[12606],256],65455:[[12607],256],65456:[[12608],256],65457:[[12609],256],65458:[[12610],256],65459:[[12611],256],65460:[[12612],256],65461:[[12613],256],65462:[[12614],256],65463:[[12615],256],65464:[[12616],256],65465:[[12617],256],65466:[[12618],256],65467:[[12619],256],65468:[[12620],256],65469:[[12621],256],65470:[[12622],256],65474:[[12623],256],65475:[[12624],256],65476:[[12625],256],65477:[[12626],256],65478:[[12627],256],65479:[[12628],256],65482:[[12629],256],65483:[[12630],256],65484:[[12631],256],65485:[[12632],256],65486:[[12633],256],65487:[[12634],256],65490:[[12635],256],65491:[[12636],256],65492:[[12637],256],65493:[[12638],256],65494:[[12639],256],65495:[[12640],256],65498:[[12641],256],65499:[[12642],256],65500:[[12643],256],65504:[[162],256],65505:[[163],256],65506:[[172],256],65507:[[175],256],65508:[[166],256],65509:[[165],256],65510:[[8361],256],65512:[[9474],256],65513:[[8592],256],65514:[[8593],256],65515:[[8594],256],65516:[[8595],256],65517:[[9632],256],65518:[[9675],256]}};var ie={nfc:Z,nfd:j,nfkc:ne,nfkd:q};t.exports=ie,ie.shimApplied=!1,String.prototype.normalize||(Object.defineProperty(String.prototype,"normalize",{enumerable:!1,configurable:!0,writable:!0,value:function(){var y=""+this,R=arguments[0]===void 0?"NFC":arguments[0];if(this===null||this===void 0)throw new TypeError("Cannot call method on "+Object.prototype.toString.call(this));if(R==="NFC")return ie.nfc(y);if(R==="NFD")return ie.nfd(y);if(R==="NFKC")return ie.nfkc(y);if(R==="NFKD")return ie.nfkd(y);throw new RangeError("Invalid normalization form: "+R)}}),ie.shimApplied=!0)})()})(Oee);const Yst=Oee.exports;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Kst(t){const e=t.caseSensitive?t.accentSensitive?"variant":"case":t.accentSensitive?"accent":"base",r=t.caseFirst,n=t.ignorePunctuation;return new Intl.Collator(t.localeLang,{sensitivity:e,caseFirst:r,ignorePunctuation:n})}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const qst="i",Xst=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class Qst{constructor(e,r,n){this.config=e,this.dateTimeHelper=r,this.numberLiteralsHelper=n,this.lt=(i,o)=>this.compare(i,o)<0,this.leq=(i,o)=>this.compare(i,o)<=0,this.gt=(i,o)=>this.compare(i,o)>0,this.geq=(i,o)=>this.compare(i,o)>=0,this.eq=(i,o)=>this.compare(i,o)===0,this.neq=(i,o)=>this.compare(i,o)!==0,this.pow=(i,o)=>Math.pow(Ne(i),Ne(o)),this.addWithEpsilonRaw=(i,o)=>{const a=i+o;return Math.abs(a)<this.actualEps*Math.abs(i)?0:a},this.addWithEpsilon=(i,o)=>{const a=DV(i,o);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(Ne(i),Ne(o)),a)},this.unaryMinus=i=>$x(i,-Ne(i)),this.unaryPlus=i=>i,this.unaryPercent=i=>new _2(Ne(i)/100),this.concat=(i,o)=>i.concat(o),this.nonstrictadd=(i,o)=>i instanceof L?i:o instanceof L?o:typeof i=="number"?typeof o=="number"?this.addWithEpsilonRaw(i,o):i:typeof o=="number"?o:0,this.subtract=(i,o)=>{const a=DV(i,o),s=Ne(i),l=Ne(o);let u=s-l;return Math.abs(u)<this.actualEps*Math.abs(s)&&(u=0),this.ExtendedNumberFactory(u,a)},this.divide=(i,o)=>{const a=Ne(i),s=Ne(o);if(s===0)return new L(V.DIV_BY_ZERO);{const l=FV(i,o);return this.ExtendedNumberFactory(a/s,l)}},this.multiply=(i,o)=>{const a=FV(i,o);return this.ExtendedNumberFactory(Ne(i)*Ne(o),a)},this.manyToExactComplex=i=>{const o=[];for(const a of i){if(a instanceof L)return a;if(Ft(a)||typeof a=="string"){const s=this.coerceScalarToComplex(a);s instanceof L||o.push(s)}}return o},this.coerceNumbersExactRanges=i=>this.manyToNumbers(i,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=i=>this.manyToNumbers(i,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=i=>{const o=[];for(const a of i){if(a instanceof L)return a;Ft(a)&&o.push(Ne(a))}return o},this.manyToOnlyNumbersDropNulls=i=>{const o=[];for(const a of i){if(a instanceof L)return a;if(Ft(a))o.push(Ne(a));else if(a!==Tt)return new L(V.VALUE,Q.NumberExpected)}return o},this.manyToCoercedNumbersDropNulls=i=>{const o=[];for(const a of i){if(a instanceof L)return a;if(a===Tt)continue;const s=this.coerceScalarToNumberOrError(a);Ft(s)&&o.push(Ne(s))}return o},this.collator=Kst(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const r=this.buildRegex(e);return n=>typeof n=="string"&&r.test(this.normalizeString(n))}neqMatcherFunction(e){const r=this.buildRegex(e);return n=>typeof n!="string"||!r.test(this.normalizeString(n))}searchString(e,r){var n;const o=this.buildRegex(e,!1).exec(r);return(n=o==null?void 0:o.index)!==null&&n!==void 0?n:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let r=0;r<e.length;r++){const n=e.charAt(r);if(Hv(n)||this.config.useRegularExpressions&&Bv(n))return!0}return!1}floatCmp(e,r){const n=Ne(e),i=Ne(r),o=1+this.actualEps;return i>=0&&n*o>=i&&n<=i*o||i<=0&&n*o<=i&&n>=i*o?0:n>i?1:-1}coerceScalarToNumberOrError(e){var r;return e instanceof L?e:(r=this.coerceToMaybeNumber(e))!==null&&r!==void 0?r:new L(V.VALUE,Q.NumberCoercion)}coerceToMaybeNumber(e){var r;return(r=this.coerceNonDateScalarToMaybeNumber(e))!==null&&r!==void 0?r:typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===Tt)return 0;if(typeof e=="string"){if(e==="")return 0;const r=this.coerceStringToMaybePercentNumber(e);if(r!==void 0)return r;const n=this.coerceStringToMaybeCurrencyNumber(e);return n!==void 0?n:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}else return Ft(e)?e:typeof e=="boolean"?Number(e):void 0}coerceStringToMaybePercentNumber(e){const r=e.trim();if(r.endsWith("%")){const n=r.slice(0,r.length-1).trim(),i=this.numberLiteralsHelper.numericStringToMaybeNumber(n);if(i!==void 0)return new _2(i/100)}}coerceStringToMaybeCurrencyNumber(e){const r=this.currencyMatcher(e.trim());if(r!==void 0){const[n,i]=r,o=this.numberLiteralsHelper.numericStringToMaybeNumber(i);if(o!==void 0)return new xA(o,n)}}currencyMatcher(e){for(const r of this.config.currencySymbol){if(e.startsWith(r))return[r,e.slice(r.length).trim()];if(e.endsWith(r))return[r,e.slice(0,e.length-r.length).trim()]}}coerceComplexExactRanges(e){const r=[];for(const i of e)if(i instanceof je)r.push(i);else if(i!==Tt){const o=this.coerceScalarToComplex(i);if(o instanceof L)return o;r.push(o)}const n=[];for(const i of r)if(i instanceof je){const o=this.manyToExactComplex(i.valuesFromTopLeftCorner());if(o instanceof L)return o;n.push(...o)}else n.push(i);return n}coerceScalarToComplex(e){return e instanceof L?e:e===Tt?[0,0]:Ft(e)?[Ne(e),0]:typeof e=="string"?this.coerceStringToComplex(e):new L(V.NUM,Q.ComplexNumberExpected)}ExtendedNumberFactory(e,r){const{type:n,format:i}=r;switch(n){case Be.NUMBER_RAW:return e;case Be.NUMBER_CURRENCY:return new xA(e,i!=null?i:this.config.currencySymbol[0]);case Be.NUMBER_DATE:return new Lx(e,i);case Be.NUMBER_DATETIME:return new Fx(e,i);case Be.NUMBER_TIME:return new Dx(e,i);case Be.NUMBER_PERCENT:return new _2(e,i)}}buildRegex(e,r=!0){e=this.normalizeString(e);let n,i=this.config.useWildcards,o=this.config.useRegularExpressions;if(o)try{RegExp(e)}catch{o=!1,i=!1}return o?n=tlt(e,this.config.caseSensitive):i?n=Jst(e,this.config.caseSensitive):n=elt(e,this.config.caseSensitive),this.config.matchWholeCell&&r?RegExp("^("+n+")$"):RegExp(n)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=Nee(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,r){if(typeof e=="string"||typeof r=="string"){const n=typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):e,i=typeof r=="string"?this.dateTimeHelper.dateStringToDateNumber(r):r;if(Ft(n)&&Ft(i))return this.floatCmp(n,i)}return e===Tt?e=$V(r):r===Tt&&(r=$V(e)),typeof e=="string"&&typeof r=="string"?this.stringCmp(e,r):typeof e=="boolean"&&typeof r=="boolean"?LV($A(e),$A(r)):Ft(e)&&Ft(r)?this.floatCmp(e,r):e===Tt&&r===Tt?0:LV(kV(mS(e)),kV(mS(r)))}stringCmp(e,r){return this.collator.compare(e,r)}manyToNumbers(e,r){const n=[];for(const o of e)if(o instanceof je)n.push(o);else{const a=Ne(this.coerceScalarToNumberOrError(o));if(a instanceof L)return a;n.push(a)}const i=[];for(const o of n)if(o instanceof je){const a=r(o.valuesFromTopLeftCorner());if(a instanceof L)return a;i.push(...a)}else i.push(o);return i}coerceStringToComplex(e){const r=Xst.exec(e);if(r===null)return new L(V.NUM,Q.ComplexNumberExpected);let n;if(r[6]!==void 0?n=r[1]==="-"?[0,-1]:[0,1]:n=this.parseComplexToken(r[1]+r[3],r[5]),n instanceof L||r[8]===void 0)return n;let i;return r[14]!==void 0?i=r[9]==="-"?[0,-1]:[0,1]:i=this.parseComplexToken(r[9]+r[11],r[13]),i instanceof L?i:r[5]!==""||r[13]===""?new L(V.NUM,Q.ComplexNumberExpected):r[8]==="+"?[n[0]+i[0],n[1]+i[1]]:[n[0]-i[0],n[1]-i[1]]}parseComplexToken(e,r){const n=Ne(this.coerceNonDateScalarToMaybeNumber(e));return n===void 0?new L(V.NUM,Q.ComplexNumberExpected):r===""?[n,0]:[0,n]}}function Ar([t,e],r){if(!isFinite(t)||!isFinite(e))return new L(V.NUM,Q.NaN);if(r=r!=null?r:qst,e===0)return`${t}`;const n=`${e===-1||e===1?"":Math.abs(e)}${r}`;return t===0?`${e<0?"-":""}${n}`:`${t}${e<0?"-":"+"}${n}`}function Aee(t){return t instanceof je?t:je.fromScalar(t)}function $A(t){return Number(t)}function $V(t){return typeof t=="string"?"":Ft(t)?0:typeof t=="boolean"?!1:Tt}function Iee(t){if(t instanceof L||typeof t=="boolean")return t;if(t===Tt)return!1;if(Ft(t))return Ne(t)!==0;{const e=t.toUpperCase();return e==="TRUE"?!0:e==="FALSE"||e===""?!1:void 0}}function LA(t){return t instanceof L||typeof t=="string"?t:t===Tt?"":Ft(t)?Ne(t).toString():t?"TRUE":"FALSE"}function zC(t){return t===Tt?0:t}function LV(t,e){const r=Ne(t),n=Ne(e);return r>n?1:r<n?-1:0}function xee(t){return isNaN(t)||t===1/0||t===-1/0}function Mee(t){return t===0?0:t}function Hv(t){return["*","?"].includes(t)}const Zst=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function Bv(t){return Zst.includes(t)}function Jst(t,e){let r="";for(let n=0;n<t.length;n++){const i=t.charAt(n);if(i==="~"){if(n==t.length-1){r+="~";continue}const o=t.charAt(n+1);Hv(o)||Bv(o)?(r+="\\"+o,n++):(r+=o,n++)}else Hv(i)?r+="."+i:Bv(i)?r+="\\"+i:e?r+=i:r+=i.toLowerCase()}return r}function elt(t,e){let r="";for(let n=0;n<t.length;n++){const i=t.charAt(n);Hv(i)||Bv(i)?r+="\\"+i:e?r+=i:r+=i.toLowerCase()}return r}function tlt(t,e){let r="";for(let n=0;n<t.length;n++){const i=t.charAt(n);Hv(i)||Bv(i)||e?r+=i:r+=i.toLowerCase()}return r}function DV(t,e){const{type:r,format:n}=hS(t),{type:i,format:o}=hS(e);if(r===Be.NUMBER_RAW)return{type:i,format:o};if(i===Be.NUMBER_RAW)return{type:r,format:n};if((r===Be.NUMBER_DATETIME||r===Be.NUMBER_DATE)&&(i===Be.NUMBER_DATETIME||i===Be.NUMBER_DATE))return{type:Be.NUMBER_RAW};if(r===Be.NUMBER_TIME){if(i===Be.NUMBER_DATE)return{type:Be.NUMBER_DATETIME,format:o+" "+n};if(i===Be.NUMBER_DATETIME)return{type:Be.NUMBER_DATETIME,format:o}}if(i===Be.NUMBER_TIME){if(r===Be.NUMBER_DATE)return{type:Be.NUMBER_DATETIME,format:n+" "+o};if(r===Be.NUMBER_DATETIME)return{type:Be.NUMBER_DATETIME,format:n}}return{type:r,format:n}}function FV(t,e){let{type:r,format:n}=hS(t),{type:i,format:o}=hS(e);return r===Be.NUMBER_PERCENT&&(r=Be.NUMBER_RAW,n=void 0),i===Be.NUMBER_PERCENT&&(i=Be.NUMBER_RAW,o=void 0),r===Be.NUMBER_RAW?{type:i,format:o}:i===Be.NUMBER_RAW?{type:r,format:n}:{type:Be.NUMBER_RAW}}function dg(t){return Nee(t.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function A2(t,e){var r;if(t.isAdHoc())return(r=t.data[0])===null||r===void 0?void 0:r[0];const n=t.range;if(e.formulaAddress.sheet===n.sheet){if(n.width()===1){const i=e.formulaAddress.row-n.start.row;if(i>=0&&i<n.height())return t.data[i][0]}else if(n.height()===1){const i=e.formulaAddress.col-n.start.col;if(i>=0&&i<n.width())return t.data[0][i]}}}function Nee(t,e){return typeof t.normalize=="function"?t.normalize(e.toUpperCase()):Yst[e](t)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var S;(function(t){t.STRING="STRING",t.NUMBER="NUMBER",t.BOOLEAN="BOOLEAN",t.SCALAR="SCALAR",t.NOERROR="NOERROR",t.RANGE="RANGE",t.INTEGER="INTEGER",t.COMPLEX="COMPLEX",t.ANY="ANY"})(S||(S={}));class pt{constructor(e){this.coerceScalarToNumberOrError=r=>this.arithmeticHelper.coerceScalarToNumberOrError(r),this.runFunction=(r,n,i,o)=>{const a=this.evaluateArguments(r,n,i),s=a.map(([p,m])=>p),l=a.map(([p,m])=>m),u=this.buildMetadataForEachArgumentValue(s.length,i),c=n.arraysFlag&&!i.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(u,s.length))return new L(V.NA,Q.WrongArgNumber);const[f,h]=c?this.calculateSizeOfVectorizedResultArray(s,u):[1,1];if(f===1&&h===1){const p=this.vectorizeAndBroadcastArgumentsIfNecessary(c,s,u,0,0);return this.calculateSingleCellOfResultArray(n,p,u,l,o,i.returnNumberType)}const d=[...Array(f).keys()].map(p=>[...Array(h).keys()].map(m=>{const g=this.vectorizeAndBroadcastArgumentsIfNecessary(c,s,u,p,m),v=this.calculateSingleCellOfResultArray(n,g,u,l,o,i.returnNumberType);if(v instanceof je)throw new Error("Function returning array cannot be vectorized.");return v}));return je.onlyValues(d)},this.runFunctionWithReferenceArgument=(r,n,i,o,a,s=()=>new L(V.NA,Q.CellRefExpected))=>{if(r.length===0)return this.returnNumberWrapper(o(),i.returnNumberType);if(r.length>1)return new L(V.NA,Q.WrongArgNumber);let l=r[0];for(;l.type===G.PARENTHESIS;)l=l.expression;let u;if(l.type===G.CELL_REFERENCE)u=l.reference.toSimpleCellAddress(n.formulaAddress);else if(l.type===G.CELL_RANGE||l.type===G.COLUMN_RANGE||l.type===G.ROW_RANGE)try{u=ze.fromAst(l,n.formulaAddress).start}catch{return new L(V.REF,Q.CellRefExpected)}return u!==void 0?this.returnNumberWrapper(a(u),i.returnNumberType):this.runFunction(r,n,i,s)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,r){return this.interpreter.evaluateAst(e,r)}arraySizeForAst(e,r){return this.arraySizePredictor.checkArraySizeForAst(e,r)}listOfScalarValues(e,r){const n=[];for(const i of e){const o=this.evaluateAst(i,r);if(o instanceof je)for(const a of o.valuesFromTopLeftCorner())n.push([a,!0]);else n.push([o,!1])}return n}coerceToType(e,r,n){let i;if(e instanceof je)switch(r.argumentType){case S.RANGE:case S.ANY:i=e;break;default:{const o=A2(e,n);if(o===void 0)return;e=o}}if(!(e instanceof je))switch(r.argumentType){case S.INTEGER:case S.NUMBER:const o=this.coerceScalarToNumberOrError(e);if(!Ft(o)){i=o;break}const a=Ne(o);if(r.maxValue!==void 0&&a>r.maxValue)return new L(V.NUM,Q.ValueLarge);if(r.minValue!==void 0&&a<r.minValue)return new L(V.NUM,Q.ValueSmall);if(r.lessThan!==void 0&&a>=r.lessThan)return new L(V.NUM,Q.ValueLarge);if(r.greaterThan!==void 0&&a<=r.greaterThan)return new L(V.NUM,Q.ValueSmall);if(r.argumentType===S.INTEGER&&!Number.isInteger(a))return new L(V.NUM,Q.IntegerExpected);i=o;break;case S.STRING:i=LA(e);break;case S.BOOLEAN:i=Iee(e);break;case S.SCALAR:case S.NOERROR:case S.ANY:i=e;break;case S.RANGE:if(e instanceof L)return e;i=Aee(e);break;case S.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(Ne(e))}return r.passSubtype||i===void 0?i:Ne(i)}calculateSingleCellOfResultArray(e,r,n,i,o,a){const s=this.coerceArgumentsToRequiredTypes(e,r,n,i);if(s instanceof L)return s;const l=o(...s);return this.returnNumberWrapper(l,a)}coerceArgumentsToRequiredTypes(e,r,n,i){const o=[];for(let a=0;a<n.length;a++){const s=n[a],l=r[a]!==void 0?r[a]:s==null?void 0:s.defaultValue;if(l===void 0){o.push(void 0);continue}const u=this.coerceToType(l,s,e);if(u===void 0&&!i[a])return new L(V.VALUE,Q.WrongType);if(u instanceof L&&s.argumentType!==S.SCALAR)return u;o.push(u)}return o}vectorizeAndBroadcastArgumentsIfNecessary(e,r,n,i,o){return r.map((a,s)=>e&&this.isRangePassedAsAScalarArgument(a,n[s])?this.vectorizeAndBroadcastRangeArgument(a,i,o):a)}vectorizeAndBroadcastRangeArgument(e,r,n){var i;const o=e.height()===1?0:r,a=e.width()===1?0:n;return(i=e.data[o])===null||i===void 0?void 0:i[a]}evaluateArguments(e,r,n){return n.expandRanges?this.listOfScalarValues(e,r):e.map(i=>[this.evaluateAst(i,r),!1])}buildMetadataForEachArgumentValue(e,r){const n=r.parameters?[...r.parameters]:[];if(r.repeatLastArgs!==void 0&&Number.isInteger(r.repeatLastArgs)&&r.repeatLastArgs>0)for(;e>n.length;)n.push(...n.slice(n.length-r.repeatLastArgs));return n}isNumberOfArgumentValuesValid(e,r){return r>e.length?!1:r<e.length?e.slice(r).every(o=>(o==null?void 0:o.optionalArg)||(o==null?void 0:o.defaultValue)!==void 0):!0}calculateSizeOfVectorizedResultArray(e,r){const n=e.filter((a,s)=>this.isRangePassedAsAScalarArgument(a,r[s])),i=Math.max(1,...n.map(a=>a.height())),o=Math.max(1,...n.map(a=>a.width()));return[i,o]}isRangePassedAsAScalarArgument(e,r){return e==null||r==null?!1:e instanceof je&&![S.RANGE,S.ANY].includes(r.argumentType)}metadata(e){const r=this.constructor.implementedFunctions[e];if(r!==void 0)return r;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,r,n){return r!==void 0&&Ft(e)?this.arithmeticHelper.ExtendedNumberFactory(Ne(e),{type:r,format:n}):e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class yt{constructor(e,r,n=!1){if(this.width=e,this.height=r,this.isRef=n,e<=0||r<=0)throw Error("Incorrect array size")}static fromArray(e){return new yt(e.length>0?e[0].length:0,e.length)}static error(){return new yt(1,1,!0)}static scalar(){return new yt(1,1,!1)}isScalar(){return this.width<=1&&this.height<=1||this.isRef}}function rlt(t,e){return new yt(Math.max(t.width,e.width),Math.max(t.height,e.height))}function nlt(t){return new yt(t.width,t.height)}class ilt{constructor(e,r){this.config=e,this.functionRegistry=r}checkArraySize(e,r){return this.checkArraySizeForAst(e,{formulaAddress:r,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,r){switch(e.type){case G.FUNCTION_CALL:return this.checkArraySizeForFunction(e,r);case G.COLUMN_RANGE:case G.ROW_RANGE:case G.CELL_RANGE:{const n=ze.fromAstOrUndef(e,r.formulaAddress);return n===void 0?yt.error():new yt(n.width(),n.height(),!0)}case G.ARRAY:{const n=[],i=[];for(const s of e.args){const l=s.map(f=>this.checkArraySizeForAst(f,r)),u=Math.min(...l.map(f=>f.height)),c=l.reduce((f,h)=>f+h.width,0);n.push(u),i.push(c)}const o=n.reduce((s,l)=>s+l,0),a=Math.min(...i);return new yt(a,o)}case G.STRING:case G.NUMBER:return yt.scalar();case G.CELL_REFERENCE:return new yt(1,1,!0);case G.DIV_OP:case G.CONCATENATE_OP:case G.EQUALS_OP:case G.GREATER_THAN_OP:case G.GREATER_THAN_OR_EQUAL_OP:case G.LESS_THAN_OP:case G.LESS_THAN_OR_EQUAL_OP:case G.MINUS_OP:case G.NOT_EQUAL_OP:case G.PLUS_OP:case G.POWER_OP:case G.TIMES_OP:{const n=this.checkArraySizeForAst(e.left,r),i=this.checkArraySizeForAst(e.right,r);return!r.arraysFlag&&(n.height>1||n.width>1||i.height>1||i.width>1)?yt.error():rlt(n,i)}case G.MINUS_UNARY_OP:case G.PLUS_UNARY_OP:case G.PERCENT_OP:{const n=this.checkArraySizeForAst(e.value,r);return!r.arraysFlag&&(n.height>1||n.width>1)?yt.error():nlt(n)}case G.PARENTHESIS:return this.checkArraySizeForAst(e.expression,r);case G.EMPTY:return yt.error();default:return yt.error()}}checkArraySizeForFunction(e,r){const n=this.functionRegistry.getMetadata(e.procedureName),i=this.functionRegistry.getArraySizeFunction(e.procedureName);if(i!==void 0)return i(e,r);const o=e.args.map(u=>{var c;return this.checkArraySizeForAst(u,new aa(r.formulaAddress,r.arraysFlag||((c=n==null?void 0:n.arrayFunction)!==null&&c!==void 0?c:!1)))});if(n===void 0||n.expandRanges||!r.arraysFlag||n.vectorizationForbidden||n.parameters===void 0)return new yt(1,1);const a=[...n.parameters];if(n.repeatLastArgs===void 0&&a.length<o.length||n.repeatLastArgs!==void 0&&a.length<o.length&&(o.length-a.length)%n.repeatLastArgs!==0)return yt.error();for(;a.length<o.length;)a.push(...a.slice(a.length-n.repeatLastArgs));let s=1,l=1;for(let u=0;u<o.length;u++)a[u].argumentType!==S.RANGE&&a[u].argumentType!==S.ANY&&(l=Math.max(l,o[u].height),s=Math.max(s,o[u].width));return new yt(s,l)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Pee{constructor(e,r,n){var i;this.value=r,this.address=n,this.type=e.type,this.message=(i=e.message)!==null&&i!==void 0?i:""}toString(){return this.value}valueOf(){return this.value}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Vt(t,e,r){if(typeof t>"u")return An.defaultConfig[r];if(typeof e=="string"){if(typeof t===e)return t;throw new Bt(e,r)}else{if(e.includes(t))return t;throw new See(e.map(n=>`'${n}'`).join(" "),r)}}function df(t,e,r){if(t<r)throw new bee(e,r)}function olt(t,e,r){if(t>r)throw new wee(e,r)}function sb(t,e,r,n){if(e(t))return t;if(typeof t>"u")return An.defaultConfig[n];throw new Bt(r,n)}function HV(...t){const e=new Map;t.forEach(n=>{const i=e.get(n.value)||[];i.push(n.name),e.set(n.value,i)});const r=[];for(const n of e.values())n.length>1&&r.push(n);if(r.length>0){r.forEach(i=>i.sort());const n=r.map(i=>`[${i}]`).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${n}`)}}function Ie(t,e,r){if(typeof t!==e)throw new Bt(e,r)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function alt(t,e,r){t=t.replace(/\s\s+/g," ").trim().toLowerCase();let n=t.substring(t.length-2);n==="am"||n==="pm"?t=t.substring(0,t.length-2).trim():(n=t.substring(t.length-1),n==="a"||n==="p"?t=t.substring(0,t.length-1).trim():n=void 0);const i=t.split(/[ /.-]/g);i.length>=2&&i[i.length-2].includes(":")&&(i[i.length-2]=i[i.length-2]+"."+i[i.length-1],i.pop());const o=i[i.length-1].split(":");if(n!==void 0&&o.push(n),i.length===1)return BV(o,r);if(o.length===1)return UV(i,e);const a=UV(i.slice(0,i.length-1),e),s=BV(o,r);if(a!==void 0)return s===void 0?void 0:Object.assign(Object.assign({},a),s)}const Ux=/^ss(\.(s+|0+))?$/;function BV(t,e){if(e===void 0)return;e=e.toLowerCase(),e.endsWith("am/pm")?e=e.substring(0,e.length-5).trim():e.endsWith("a/p")&&(e=e.substring(0,e.length-3).trim());const n=e.split(":");let i;if(t[t.length-1]==="am"||t[t.length-1]==="a"?(i=!1,t.pop()):(t[t.length-1]==="pm"||t[t.length-1]==="p")&&(i=!0,t.pop()),t.length!==n.length)return;const o=n.indexOf("hh"),a=n.indexOf("mm"),s=n.findIndex(p=>Ux.test(p)),l=o!==-1?t[o]:"0";if(!/^\d+$/.test(l))return;let u=Number(l);if(i!==void 0){if(u<0||u>12)return;u=u%12,i&&(u=u+12)}const c=a!==-1?t[a]:"0";if(!/^\d+$/.test(c))return;const f=Number(c),h=s!==-1?t[s]:"0";if(!/^\d+(\.\d+)?$/.test(h))return;const d=Math.round(Number(h)*1e3)/1e3;return{hours:u,minutes:f,seconds:d}}function UV(t,e){if(e===void 0)return;const r=e.toLowerCase().split(/[ /.-]/g);if(t.length!==r.length)return;const n=r.indexOf("mm"),i=r.indexOf("dd"),o=r.indexOf("yyyy"),a=r.indexOf("yy");if(!(n in t)||!(i in t)||!(o in t)&&!(a in t)||o in t&&a in t)return;let s;if(o in t){const h=t[o];if(/^\d+$/.test(h)){if(s=Number(h),s<1e3||s>9999)return}else return}else{const h=t[a];if(/^\d+$/.test(h)){if(s=Number(h),s<0||s>99)return}else return}const l=t[n];if(!/^\d+$/.test(l))return;const u=Number(l),c=t[i];if(!/^\d+$/.test(c))return;const f=Number(c);return{year:s,month:u,day:f}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const DA=[31,28,31,30,31,30,31,31,30,31,30,31],Ff=[0,31,59,90,120,151,181,212,243,273,304,334],lb=60,ub=60,FA=24;function pg(t){return t&&(typeof t=="object"||typeof t=="function")?"year"in t&&typeof t.year=="number"&&"month"in t&&typeof t.month=="number"&&"day"in t&&typeof t.day=="number":!1}function kee(t){return t&&(typeof t=="object"||typeof t=="function")?"hours"in t&&typeof t.hours=="number"&&"minutes"in t&&typeof t.minutes=="number"&&"seconds"in t&&typeof t.seconds=="number":!1}const slt={year:9999,month:12,day:31};class llt{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(slt),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:r,dateFormat:n="",timeFormat:i=""}=this.parseDateTimeFromConfigFormats(e);if(r!==void 0)return kee(r)?pg(r)?new Fx(nh(r)+this.dateToNumber(r),n+" "+i):new Dx(nh(r),i):pg(r)?new Lx(this.dateToNumber(r),n):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1?!1:this.isLeapYear(e.year)&&e.month===2?e.day<=29:e.day<=DA[e.month-1]}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const r=Math.floor(e)+this.minDateAbsoluteValue;let n=Math.floor(r/365.2425);this.dateToNumberFromZero({year:n+1,month:1,day:1})<=r?n++:this.dateToNumberFromZero({year:n-1,month:1,day:1})>r&&n--;const i=r-this.dateToNumberFromZero({year:n,month:1,day:1}),o=ult(i-(this.isLeapYear(n)&&i>=59?1:0)),a=i-Ff[o]-(this.isLeapYear(n)&&o>1?1:0);return{year:n,month:o+1,day:a+1}}numberToSimpleDateTime(e){const r=rh(e%1),n=Math.floor(r.hours/FA);r.hours=r.hours%FA;const i=this.numberToSimpleDate(Math.floor(e)+n);return Object.assign(Object.assign({},i),r)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,r){return this.isLeapYear(e)&&r===2?29:DA[r-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,r){return e.day===31&&(e.day=30),e.day===30&&r.day===31&&(r.day=30),e.month===2&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,r.month===2&&r.day===this.daysInMonth(r.year,r.month)&&(r.day=30)),[e,r]}yearLengthForBasis(e,r){return e.year!==r.year?e.year+1!==r.year||e.month<r.month||e.month===r.month&&e.day<r.day?(this.leapYearsCount(r.year)-this.leapYearsCount(e.year-1))/(r.year-e.year+1)+365:this.countLeapDays(r)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,r,n){const i=this.parseDateTime(e,r,n);if(!(pg(i)&&(i.year>=0&&i.year<100&&(i.year<this.getNullYear()?i.year+=2e3:i.year+=1900),!this.isValidDate(i))))return i}parseDateTimeFromFormats(e,r,n){const i=r.length===0?[void 0]:r,o=n.length===0?[void 0]:n;for(const a of i)for(const s of o){const l=this.parseSingleFormat(e,a,s);if(l!==void 0)return{dateTime:l,timeFormat:s,dateFormat:a}}return{}}countLeapDays(e){return e.month>2||e.month===2&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+Ff[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return e%4?!1:e%100?!0:e%400?e===1900&&this.config.leapYear1900:!0}}function ult(t){let e=0;return Ff[e+6]<=t&&(e+=6),Ff[e+3]<=t&&(e+=3),Ff[e+2]<=t?e+=2:Ff[e+1]<=t&&(e+=1),e}function VV(t,e){const r=12*t.year+t.month-1+e;return{year:Math.floor(r/12),month:r%12+1,day:t.day}}function clt(t){return{year:t.year,month:t.month,day:Math.min(t.day,DA[t.month-1])}}function GC(t){return Math.round(t*3600*24)/(3600*24)}function flt(t,e=1){return Math.round(t*e)/e}function rh(t){const e=t*FA*ub*lb,r=flt(e%lb,1e5)%lb,n=(e-r)/lb,i=Math.round(n%ub)%ub,o=(n-i)/ub;return{hours:Math.round(o),minutes:i,seconds:r}}function nh(t){return((t.seconds/60+t.minutes)/60+t.hours)/24}function jV(t){return{year:t.year,month:t.month,day:Math.min(30,t.day)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class hlt{call(){return Fst}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const WV=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,zV=/(\\.|[#0]+(\.[#0]*)?)/g;var ia;(function(t){t.FORMAT="FORMAT",t.FREE_TEXT="FREE_TEXT"})(ia||(ia={}));function cb(t,e){return{type:t,value:e}}var gS;(function(t){t.DATE="DATE",t.NUMBER="NUMBER",t.STRING="STRING"})(gS||(gS={}));function dlt(t){WV.lastIndex=0;const e=[];let r;do r=WV.exec(t),r!==null&&e.push(r);while(r);return e}function plt(t){zV.lastIndex=0;const e=zV.exec(t);return e!==null?[e]:[]}function $ee(t,e){const r=[];let n=0;for(let o=0;o<t.length;++o){const a=t[o];if(a.index!==n){const s=e.substr(n,a.index-n);r.push(cb(ia.FREE_TEXT,s))}a[0].startsWith("\\")?r.push(cb(ia.FREE_TEXT,a[0])):r.push(cb(ia.FORMAT,a[0])),n=a.index+a[0].length}const i=t[t.length-1];if(i.index+i[0].length<e.length){const o=e.substr(i.index+i[0].length,e.length);r.push(cb(ia.FREE_TEXT,o))}return r}function Lee(t){const e=dlt(t);if(!e.every(r=>Dee(r)))return{type:gS.DATE,tokens:$ee(e,t)}}function mlt(t){const e=plt(t);if(!e.every(r=>Dee(r)))return{type:gS.NUMBER,tokens:$ee(e,t)}}function Dee(t){return t[0].startsWith("\\")}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function glt(t,e,r,n){const i=r.stringifyDateTime(n.numberToSimpleDateTime(t),e);if(i!==void 0)return i;const o=r.stringifyDuration(rh(t),e);if(o!==void 0)return o;const a=mlt(e);return a!==void 0?vlt(a.tokens,t):e}function ui(t,e){let r=t+"";for(;r.length<e;)r="0"+r;return r}function ylt(t,e){let r=t+"";for(;r.length<e;)r=r+"0";return r}function GV(t,e){return t.split(e).length-1}function vlt(t,e){let r="";for(let n=0;n<t.length;++n){const i=t[n];if(i.type===ia.FREE_TEXT){r+=i.value;continue}const o=i.value.split("."),a=o[0],s=o[1]||"",l=o[1]?".":"",u=Number(e.toFixed(s.length)).toString().split(".");let c=u[0]||"",f=u[1]||"";if(a.length>c.length){const d=GV(a.substr(0,a.length-c.length),"0");c=ui(c,d+c.length)}const h=GV(s.substr(f.length,s.length-f.length),"0");f=ylt(f,h+f.length),r+=c+l+f}return r}function blt(t,e){const r=Lee(e);if(r===void 0)return;const n=r.tokens;let i="";for(const o of n){if(o.type===ia.FREE_TEXT){i+=o.value;continue}switch(o.value.toLowerCase()){case"h":case"hh":{i+=ui(t.hours,o.value.length),t.hours=0;break}case"[hh]":{i+=ui(t.hours,o.value.length-2),t.hours=0;break}case"m":case"mm":{i+=ui(t.minutes,o.value.length),t.minutes=0;break}case"[mm]":{i+=ui(t.minutes+60*t.hours,o.value.length-2),t.minutes=0,t.hours=0;break}case"s":case"ss":{i+=ui(Math.floor(t.seconds),o.value.length);break}default:{if(Ux.test(o.value)){const a=Math.max(o.value.length-3,0);i+=(t.seconds<10?"0":"")+Math.floor(t.seconds*Math.pow(10,a))/Math.pow(10,a);continue}return}}}return i}function wlt(t,e){const r=Lee(e);if(r===void 0)return;const n=r.tokens;let i="",o=!1;const a=n.some(s=>s.type===ia.FORMAT&&(s.value==="a/p"||s.value==="A/P"||s.value==="am/pm"||s.value==="AM/PM"));for(let s=0;s<n.length;s++){const l=n[s];if(l.type===ia.FREE_TEXT){i+=l.value;continue}switch(l.value.toLowerCase()){case"h":case"hh":{o=!0,i+=ui(a?(t.hours+11)%12+1:t.hours,l.value.length);break}case"d":case"dd":{i+=ui(t.day,l.value.length);break}case"s":case"ss":{i+=ui(Math.floor(t.seconds),l.value.length);break}case"m":case"mm":{s+1<n.length&&n[s+1].value.startsWith(":")&&(o=!0),o?i+=ui(t.minutes,l.value.length):i+=ui(t.month,l.value.length),o=!0;break}case"yy":{i+=ui(t.year%100,l.value.length);break}case"yyyy":{i+=t.year;break}case"am/pm":case"a/p":{const[u,c]=l.value.split("/");i+=t.hours<12?u:c;break}default:{if(Ux.test(l.value)){const u=l.value.length-3;i+=(t.seconds<10?"0":"")+Math.floor(t.seconds*Math.pow(10,u))/Math.pow(10,u);continue}return}}}return i}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const HA="length",mg=t=>parseInt(t,16),YV=t=>parseInt(t,10),YC=t=>(t+"").replace(/\-/g,""),yS=(t,e,r)=>t.substr(e,r),yo=t=>t.codePointAt(0)-65;function Slt(t){return YC(t)[HA]===25?mg(yS(YC(t),mg("12"),yo("F")))/(mg(yS(YC(t),yo("C"),yo("Y")>>4))||(~~![][HA]<<3)+1):0}function Rlt(t){if(t=(t+"").replace(/\-/g,""),t[HA]!==yo("Z"))return!1;let e=0;return[[0,yo("G")+1],[yo("H"),yo("H")-1],[yo("G")+yo("H"),yo("G")]].reduce((r,[n,i],o)=>(r|=(YV(`${YV(mg(yS(t,e+n-(o===0?0:2),i+(o?2:0)))+(mg(yS(t,e+n+i,2))+[]).padStart(2,"0"))}`)%97||2)>>1,e+=2,r),yo("A"))===[]+1>>1}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Elt={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:t})=>`The license key for HyperFormula expired on ${t}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let KV=!1;function Clt(t){const e={template:"missing",vars:{}};if(t==="gpl-v3"||t==="internal-use-in-handsontable")e.template="valid";else if(typeof t=="string"&&Rlt(t)){const[r,n,i]="03/03/2023".split("/"),o=Math.floor(new Date(`${n}/${r}/${i}`).getTime()/864e5),a=Slt(t);e.vars.keyValidityDate=_lt(new Date((a+1)*864e5)),o>a?e.template="expired":e.template="valid"}else t!==""&&(e.template="invalid");return!KV&&e.template!=="valid"&&(console.warn(Elt[e.template](e.vars)),KV=!0),e.template}function _lt(t){const r=["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()],n=t.getDate(),i=t.getFullYear();return`${r} ${n}, ${i}`}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var hr;(function(t){class e{constructor(l){this.value=l,this.value=$x(this.value,Mee(Ne(this.value)))}}t.Number=e;class r{constructor(l){this.value=l}}t.String=r;class n{constructor(l){this.value=l}}t.Boolean=n;class i{static getSingletonInstance(){return i.instance||(i.instance=new i),i.instance}}t.Empty=i;class o{constructor(l){this.formula=l}}t.Formula=o;class a{constructor(l,u){this.value=new L(l,u)}}t.Error=a})(hr||(hr={}));function Tlt(t){return t.startsWith("=")}function Olt(t){const e=t.toLowerCase();return e==="true"||e==="false"}function Alt(t,e){const r=t.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(r)&&Object.prototype.hasOwnProperty.call(e,r)}class Ilt{constructor(e,r,n){this.config=e,this.dateHelper=r,this.numberLiteralsHelper=n}parse(e){if(e==null)return hr.Empty.getSingletonInstance();if(typeof e=="number")return xee(e)?new hr.Error(V.NUM,Q.ValueLarge):new hr.Number(e);if(typeof e=="boolean")return new hr.Boolean(e);if(e instanceof Date){const r=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),n=nh({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3}),i=r+n;return i<0?new hr.Error(V.NUM,Q.DateBounds):i%1===0?new hr.Number(new Lx(i,"Date()")):i<1?new hr.Number(new Dx(i,"Date()")):new hr.Number(new Fx(i,"Date()"))}else if(typeof e=="string"){if(Olt(e))return new hr.Boolean(e.toLowerCase()==="true");if(Tlt(e))return new hr.Formula(e);if(Alt(e,this.config.errorMapping))return new hr.Error(this.config.errorMapping[e.toUpperCase()]);{let r=e.trim(),n=0,i;if(r.endsWith("%"))n=1,r=r.slice(0,r.length-1);else{const s=this.currencyMatcher(r);s!==void 0&&(n=2,[i,r]=s)}const o=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(o!==void 0){let s;return n===1?s=new _2(o/100):n===2?s=new xA(o,i):s=o,new hr.Number(s)}const a=this.dateHelper.dateStringToDateNumber(r);return a!==void 0?new hr.Number(a):new hr.String(e.startsWith("'")?e.slice(1):e)}}else throw new vee(e)}currencyMatcher(e){for(const r of this.config.currencySymbol){if(e.startsWith(r))return[r,e.slice(r.length)];if(e.endsWith(r))return[r,e.slice(0,e.length-r.length)]}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var nu;(function(t){t[t.COPY=0]="COPY",t[t.CUT=1]="CUT"})(nu||(nu={}));var _n;(function(t){t[t.VALUE=0]="VALUE",t[t.EMPTY=1]="EMPTY",t[t.FORMULA=2]="FORMULA",t[t.PARSING_ERROR=3]="PARSING_ERROR"})(_n||(_n={}));class qV{constructor(e,r,n,i,o){this.sourceLeftCorner=e,this.width=r,this.height=n,this.type=i,this.content=o}*getContent(e){if(this.content!==void 0)for(let r=0;r<this.height;++r)for(let n=0;n<this.width;++n)yield[Le(e.sheet,e.col+n,e.row+r),this.content[r][n]]}}class xlt{constructor(e,r,n){this.dependencyGraph=r,this.operations=n,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,r,n){this.clipboard=new qV(e,r,n,nu.CUT)}copy(e,r,n){const i=[];for(let o=0;o<n;++o){i[o]=[];for(let a=0;a<r;++a){const s=this.operations.getClipboardCell(Le(e.sheet,e.col+a,e.row+o));i[o].push(s)}}this.clipboard=new qV(e,r,n,nu.COPY,i)}abortCut(){this.clipboard&&this.clipboard.type===nu.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(this.clipboard===void 0)return;if(fi(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new Qr("a valid target address.");const r=ze.spanFrom(e,this.clipboard.width,this.clipboard.height);if(r.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Vu;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(r))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return this.clipboard!==void 0&&this.clipboard.type===nu.CUT}isCopyClipboard(){return this.clipboard!==void 0&&this.clipboard.type===nu.COPY}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class vS{constructor(e,r,n,i){this.displayName=e,this.address=r,this.added=n,this.options=i}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new vS(this.displayName,this.address,this.added,this.options)}}class Mlt{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const r=this.normalizeExpressionName(e),n=this.mapping.get(r);return!(n&&n.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const r=this.mapping.get(this.normalizeExpressionName(e));if(r&&r.added)return r}remove(e){const r=this.normalizeExpressionName(e),n=this.mapping.get(r);n&&(n.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class XV{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){const r=this.normalizeExpressionName(e);return!this.mapping.has(r)}remove(e){const r=this.normalizeExpressionName(e);this.mapping.get(r)&&this.mapping.delete(r)}normalizeExpressionName(e){return e.toLowerCase()}}class lc{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new Mlt,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,r){var n,i;return r===void 0?this.workbookStore.isNameAvailable(e):(i=(n=this.worksheetStore(r))===null||n===void 0?void 0:n.isNameAvailable(e))!==null&&i!==void 0?i:!0}namedExpressionInAddress(e){const r=this.addressCache.get(e);if(r&&r.added)return r}namedExpressionForScope(e,r){var n;return r===void 0?this.workbookStore.getExisting(e):(n=this.worksheetStore(r))===null||n===void 0?void 0:n.get(e)}nearestNamedExpression(e,r){var n,i;return(i=(n=this.worksheetStore(r))===null||n===void 0?void 0:n.get(e))!==null&&i!==void 0?i:this.workbookStore.getExisting(e)}isExpressionInScope(e,r){var n,i;return(i=(n=this.worksheetStore(r))===null||n===void 0?void 0:n.has(e))!==null&&i!==void 0?i:!1}isNameValid(e){const r=new RegExp(`^${eJ}$`),n=new RegExp(`^${tJ}$`),i=new RegExp(`^${rJ}$`);return r.test(e)||n.test(e)?!1:i.test(e)}addNamedExpression(e,r,n){const i=r===void 0?this.workbookStore:this.worksheetStoreOrCreate(r);let o=i.get(e);return o!==void 0?(o.added=!0,o.displayName=e,o.options=n):(o=new vS(e,this.nextAddress(),!0,n),i.add(o)),this.addressCache.set(o.address.row,o),o}restoreNamedExpression(e,r){const n=r===void 0?this.workbookStore:this.worksheetStoreOrCreate(r);return e.added=!0,n.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,r){var n;return(n=this.worksheetStoreOrCreate(r).get(e))!==null&&n!==void 0?n:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let r=this.workbookStore.get(e);return r===void 0&&(r=new vS(e,this.nextAddress(),!1),this.workbookStore.add(r)),r}remove(e,r){let n;r===void 0?n=this.workbookStore:n=this.worksheetStore(r);const i=n==null?void 0:n.get(e);if(n===void 0||i===void 0||!i.added)throw"Named expression does not exist";n.remove(e),n instanceof XV&&n.mapping.size===0&&this.worksheetStores.delete(r),this.addressCache.delete(i.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter(({scope:r})=>r===e).map(r=>r.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach(r=>{e.push({expression:r,scope:void 0})}),this.worksheetStores.forEach((r,n)=>{r.getAllNamedExpressions().forEach(i=>{e.push({expression:i,scope:n})})}),e}getAllNamedExpressionsForScope(e){var r,n;return e===void 0?this.workbookStore.getAllNamedExpressions():(n=(r=this.worksheetStores.get(e))===null||r===void 0?void 0:r.getAllNamedExpressions())!==null&&n!==void 0?n:[]}worksheetStoreOrCreate(e){let r=this.worksheetStores.get(e);return r||(r=new XV,this.worksheetStores.set(e,r)),r}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return Le(lc.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}lc.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const Us=t=>{switch(t.type){case G.EMPTY:case G.NUMBER:case G.STRING:case G.ERROR:case G.ERROR_WITH_RAW_INPUT:return!1;case G.CELL_REFERENCE:return!t.reference.isAbsolute();case G.CELL_RANGE:case G.COLUMN_RANGE:case G.ROW_RANGE:return!t.start.isAbsolute();case G.NAMED_EXPRESSION:return!1;case G.PERCENT_OP:case G.PLUS_UNARY_OP:case G.MINUS_UNARY_OP:return Us(t.value);case G.CONCATENATE_OP:case G.EQUALS_OP:case G.NOT_EQUAL_OP:case G.LESS_THAN_OP:case G.GREATER_THAN_OP:case G.LESS_THAN_OR_EQUAL_OP:case G.GREATER_THAN_OR_EQUAL_OP:case G.MINUS_OP:case G.PLUS_OP:case G.TIMES_OP:case G.DIV_OP:case G.POWER_OP:return Us(t.left)||Us(t.right);case G.PARENTHESIS:return Us(t.expression);case G.FUNCTION_CALL:return t.args.some(e=>Us(e));case G.ARRAY:return t.args.some(e=>e.some(r=>Us(r)))}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Il{performEagerTransformations(e,r){for(const n of e.arrayFormulaNodes()){const[i,o]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService)),a=r.rememberNewAst(i);n.setFormula(a),n.setAddress(o)}}transformSingleAst(e,r){const n=this.transformAst(e,r),i=this.fixNodeAddress(r);return[n,i]}transformAst(e,r){switch(e.type){case G.CELL_REFERENCE:return this.transformCellReferenceAst(e,r);case G.CELL_RANGE:return this.transformCellRangeAst(e,r);case G.COLUMN_RANGE:return this.transformColumnRangeAst(e,r);case G.ROW_RANGE:return this.transformRowRangeAst(e,r);case G.EMPTY:case G.ERROR:case G.NUMBER:case G.NAMED_EXPRESSION:case G.ERROR_WITH_RAW_INPUT:case G.STRING:return e;case G.PERCENT_OP:case G.MINUS_UNARY_OP:case G.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,r)});case G.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(n=>this.transformAst(n,r))});case G.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,r)});case G.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(n=>n.map(i=>this.transformAst(i,r)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,r),right:this.transformAst(e.right,r)})}}transformCellReferenceAst(e,r){const n=this.transformCellAddress(e.reference,r);return n instanceof Kt?Object.assign(Object.assign({},e),{reference:n}):n===V.REF?Jo(new L(V.REF)):e}transformCellRangeAst(e,r){const n=this.transformCellRange(e.start,e.end,r);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===V.REF?Jo(new L(V.REF)):e}transformColumnRangeAst(e,r){const n=this.transformColumnRange(e.start,e.end,r);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===V.REF?Jo(new L(V.REF)):e}transformRowRangeAst(e,r){const n=this.transformRowRange(e.start,e.end,r);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===V.REF?Jo(new L(V.REF)):e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Nlt extends Il{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,r){return e}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){throw Error("Not implemented")}transformColumnRange(e,r,n){return this.transformRange(e,r,n)}transformCellAddress(e,r){const n=Ao(e,r);if(n!==this.columnsSpan.sheet&&r.sheet!==this.columnsSpan.sheet)return!1;const i=e.toSimpleColumnAddress(r);return n===this.columnsSpan.sheet&&r.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=i.col?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1:r.sheet===this.columnsSpan.sheet&&n!==this.columnsSpan.sheet?e.isColumnAbsolute()||r.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?e.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(r).col<this.columnsSpan.columnStart?r.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):r.col<this.columnsSpan.columnStart?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,r,n){const i=this.transformCellAddress(e,n),o=this.transformCellAddress(r,n);return i===V.REF||o===V.REF?V.REF:i||o?[i||e,o||r]:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class BA extends Il{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,r){return e}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){return this.transformRange(e,r,n)}transformColumnRange(e,r,n){throw Error("Not implemented")}transformCellAddress(e,r){const n=Ao(e,r);if(n!==this.rowsSpan.sheet&&r.sheet!==this.rowsSpan.sheet)return!1;const i=e.toSimpleRowAddress(r);return n===this.rowsSpan.sheet&&r.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=i.row?e.shiftedByRows(this.rowsSpan.numberOfRows):!1:r.sheet===this.rowsSpan.sheet&&n!==this.rowsSpan.sheet?e.isRowAbsolute()||r.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?e.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(this.rowsSpan.numberOfRows):i.row<this.rowsSpan.rowStart?r.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):r.row<this.rowsSpan.rowStart?e.shiftedByRows(this.rowsSpan.numberOfRows):!1}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,r,n){const i=this.transformCellAddress(e,n),o=this.transformCellAddress(r,n);return i===V.REF||o===V.REF?V.REF:i||o?[i||e,o||r]:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Plt extends Il{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,r){return e.isInvalid(r)?V.REF:!1}transformCellRange(e,r,n){return e.isInvalid(n)||r.isInvalid(n)?V.REF:!1}transformColumnRange(e,r,n){return e.isInvalid(n)||r.isInvalid(n)?V.REF:!1}transformRowRange(e,r,n){return e.isInvalid(n)||r.isInvalid(n)?V.REF:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class klt extends Il{constructor(e,r,n,i){super(),this.sourceRange=e,this.toRight=r,this.toBottom=n,this.toSheet=i,this.dependentFormulaTransformer=new $lt(e,r,n,i)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,r){return this.sourceRange.addressInRange(r)?[this.transformAst(e,r),this.fixNodeAddress(r)]:this.dependentFormulaTransformer.transformSingleAst(e,r)}fixNodeAddress(e){return Le(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,r){return this.transformAddress(e,r)}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformColumnRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){return this.transformRange(e,r,n)}transformAddress(e,r){const n=this.sourceRange;if(e instanceof Kt){const i=e.toSimpleCellAddress(r);if(n.addressInRange(i))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,r,n){const i=this.sourceRange;if(e instanceof Kt&&r instanceof Kt){const o=e.toSimpleCellAddress(n),a=r.toSimpleCellAddress(n);if(i.addressInRange(o)&&i.addressInRange(a))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),r.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),r.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class $lt extends Il{constructor(e,r,n,i){super(),this.sourceRange=e,this.toRight=r,this.toBottom=n,this.toSheet=i}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,r){return this.shouldMove(e,r)?e.moved(this.toSheet,this.toRight,this.toBottom):!1}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformColumnRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){return this.transformRange(e,r,n)}shouldMove(e,r){return e instanceof Kt?this.sourceRange.addressInRange(e.toSimpleCellAddress(r)):e instanceof $n?this.sourceRange.rowInRange(e.toSimpleRowAddress(r))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(r))&&!this.sourceRange.isFinite()}transformRange(e,r,n){const i=this.transformCellAddress(e,n),o=this.transformCellAddress(r,n);return i&&o?[i,o]:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Llt extends Il{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,r){return e}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){throw Error("Not implemented")}transformColumnRange(e,r,n){return this.transformRange(e,r,n)}transformCellAddress(e,r){const n=Ao(e,r);if(this.columnsSpan.sheet!==r.sheet&&this.columnsSpan.sheet!==n)return!1;if(this.columnsSpan.sheet!==r.sheet&&this.columnsSpan.sheet===n){const i=e.toSimpleColumnAddress(r);if(i.col<this.columnsSpan.columnStart)return!1;if(i.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===r.sheet&&this.columnsSpan.sheet!==n){if(e.isColumnAbsolute())return!1;if(r.col<this.columnsSpan.columnStart)return!1;if(r.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===r.sheet&&this.columnsSpan.sheet===n)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const i=e.toSimpleColumnAddress(r);if(i.col<this.columnsSpan.columnStart){if(r.col<this.columnsSpan.columnStart)return!1;if(r.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(i.col>this.columnsSpan.columnEnd){if(r.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(r.col>this.columnsSpan.columnEnd)return!1}}return V.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,r,n){const i=Ao(e,n);let o=e,a=r;if(this.columnsSpan.sheet===i){const u=e.toSimpleColumnAddress(n),c=r.toSimpleColumnAddress(n);if(this.columnsSpan.columnStart<=u.col&&this.columnsSpan.columnEnd>=c.col)return V.REF;u.col>=this.columnsSpan.columnStart&&u.col<=this.columnsSpan.columnEnd&&(o=e.shiftedByColumns(this.columnsSpan.columnEnd-u.col+1)),c.col>=this.columnsSpan.columnStart&&c.col<=this.columnsSpan.columnEnd&&(a=r.shiftedByColumns(-(c.col-this.columnsSpan.columnStart+1)))}const s=this.transformCellAddress(o,n),l=this.transformCellAddress(a,n);if(s===!1&&l===!1)return[o,a];if(s===V.REF||l===V.REF)throw Error("Cannot happen");return[s||o,l||a]}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class UA extends Il{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,r){return e}transformCellAddress(e,r){const n=Ao(e,r);if(this.rowsSpan.sheet!==r.sheet&&this.rowsSpan.sheet!==n)return!1;if(this.rowsSpan.sheet!==r.sheet&&this.rowsSpan.sheet===n){const i=e.toSimpleRowAddress(r);if(i.row<this.rowsSpan.rowStart)return!1;if(i.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===r.sheet&&this.rowsSpan.sheet!==n){if(e.isRowAbsolute())return!1;if(r.row<this.rowsSpan.rowStart)return!1;if(r.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===r.sheet&&this.rowsSpan.sheet===n)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const i=e.toSimpleRowAddress(r);if(i.row<this.rowsSpan.rowStart){if(r.row<this.rowsSpan.rowStart)return!1;if(r.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(i.row>this.rowsSpan.rowEnd){if(r.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(r.row>this.rowsSpan.rowEnd)return!1}}return V.REF}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){return this.transformRange(e,r,n)}transformColumnRange(e,r,n){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,r,n){const i=Ao(e,n);let o=e,a=r;if(this.rowsSpan.sheet===i){const u=e.toSimpleRowAddress(n),c=r.toSimpleRowAddress(n);if(this.rowsSpan.rowStart<=u.row&&this.rowsSpan.rowEnd>=c.row)return V.REF;u.row>=this.rowsSpan.rowStart&&u.row<=this.rowsSpan.rowEnd&&(o=e.shiftedByRows(this.rowsSpan.rowEnd-u.row+1)),c.row>=this.rowsSpan.rowStart&&c.row<=this.rowsSpan.rowEnd&&(a=r.shiftedByRows(-(c.row-this.rowsSpan.rowStart+1)))}const s=this.transformCellAddress(o,n),l=this.transformCellAddress(a,n);return s===!1&&l===!1?[o,a]:s===V.REF||l===V.REF?V.REF:[s||o,l||a]}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Dlt extends Il{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,r){for(const n of e.arrayFormulaNodes()){const[i]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService));n.setFormula(i)}}fixNodeAddress(e){return e}transformCellAddress(e,r){return this.transformAddress(e)}transformCellRange(e,r,n){return this.transformAddress(e)}transformColumnRange(e,r,n){return this.transformAddress(e)}transformRowRange(e,r,n){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet?V.REF:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Fee(t){if(!Array.isArray(t))throw new Qr("an array of arrays.");for(let e=0;e<t.length;e++)if(!Array.isArray(t[e]))throw new Qr("an array of arrays.")}function bS(t){let e=0,r=0,n=0;for(let o=0;o<t.length;o++){let a=0;for(let s=0;s<t[o].length;s++){const l=t[o][s];l!=null&&(a=s+1,++n)}e=Math.max(e,a),a>0&&(r=o+1)}const i=e*r;return{height:r,width:e,fill:i===0?0:n/i}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Hee{constructor(e,r){this.sheet=e,this.indexes=r}normalizedIndexes(){return wS(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>di.fromNumberOfRows(this.sheet,e[0],e[1]))}}class Bee{constructor(e,r){this.sheet=e,this.indexes=r}normalizedIndexes(){return SS(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>di.fromNumberOfRows(this.sheet,e[0],e[1]))}}class Uee{constructor(e,r){this.sheet=e,this.indexes=r}normalizedIndexes(){return SS(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>xi.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class Vee{constructor(e,r){this.sheet=e,this.indexes=r}normalizedIndexes(){return wS(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>xi.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class Flt{constructor(e,r,n,i,o,a,s,l,u){this.dependencyGraph=r,this.columnSearch=n,this.cellContentParser=i,this.parser=o,this.stats=a,this.lazilyTransformingAstService=s,this.namedExpressions=l,this.arraySizePredictor=u,this.changes=hl.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const r=[];for(const n of e.rowsSpans()){const i=this.doRemoveRows(n);i&&r.push(i)}return r}addRows(e){for(const r of e.rowsSpans())this.doAddRows(r)}addColumns(e){for(const r of e.columnsSpans())this.doAddColumns(r)}removeColumns(e){const r=[];for(const n of e.columnsSpans()){const i=this.doRemoveColumns(n);i&&r.push(i)}return r}removeSheet(e){this.dependencyGraph.removeSheet(e);let r;this.stats.measure(ot.TRANSFORM_ASTS,()=>{const i=new Dlt(e);i.performEagerTransformations(this.dependencyGraph,this.parser),r=this.lazilyTransformingAstService.addTransformation(i)}),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const n=this.namedExpressions.getAllNamedExpressionsForScope(e).map(i=>this.removeNamedExpression(i.normalizeExpressionName(),e));return{version:r,scopedNamedExpressions:n}}removeSheetByName(e){const r=this.sheetMapping.fetch(e);return this.removeSheet(r)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const r=this.sheetMapping.addSheet(e),n=[];return this.dependencyGraph.addressMapping.autoAddSheet(r,n,bS(n)),this.sheetMapping.fetchDisplayName(r)}renameSheet(e,r){return this.sheetMapping.renameSheet(e,r)}moveRows(e,r,n,i){const o=di.fromNumberOfRows(e,i,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(o),i<r&&(r+=n);const a=Le(e,0,r),s=Le(e,0,i);this.moveCells(a,Number.POSITIVE_INFINITY,n,s);const l=di.fromNumberOfRows(e,r,n);return this.doRemoveRows(l),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,r,n,i){const o=xi.fromNumberOfColumns(e,i,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(o),i<r&&(r+=n);const a=Le(e,r,0),s=Le(e,i,0);this.moveCells(a,n,Number.POSITIVE_INFINITY,s);const l=xi.fromNumberOfColumns(e,r,n);return this.doRemoveColumns(l),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,r,n,i){this.ensureItIsPossibleToMoveCells(e,r,n,i);const o=ze.spanFrom(e,r,n),a=ze.spanFrom(i,r,n),s=i.col-e.col,l=i.row-e.row,u=i.sheet,c=this.getRangeClipboardCells(a),f=this.dependencyGraph.rawValuesFromRange(a);this.columnSearch.removeValues(f);const h=this.dependencyGraph.rawValuesFromRange(o);this.columnSearch.moveValues(h,s,l,u);let d;this.stats.measure(ot.TRANSFORM_ASTS,()=>{const m=new klt(o,s,l,u);m.performEagerTransformations(this.dependencyGraph,this.parser),d=this.lazilyTransformingAstService.addTransformation(m)}),this.dependencyGraph.moveCells(o,s,l,u);const p=this.updateNamedExpressionsForMovedCells(e,r,n,i);return{version:d,overwrittenCellsData:c,addedGlobalNamedExpressions:p}}setRowOrder(e,r){const n=[];let i=[];for(const[o,a]of r)if(o!==a){const s=ze.spanFrom({sheet:e,col:0,row:o},1/0,1),l=this.getRangeClipboardCells(s);i=i.concat(l),n.push(l.map(([{sheet:u,col:c},f])=>[{sheet:u,col:c,row:a},f]))}return n.forEach(o=>this.restoreClipboardCells(e,o.values())),i}setColumnOrder(e,r){const n=[];let i=[];for(const[o,a]of r)if(o!==a){const s=ze.spanFrom({sheet:e,col:o,row:0},1,1/0),l=this.getRangeClipboardCells(s);i=i.concat(l),n.push(l.map(([{sheet:u,col:c,row:f},h])=>[{sheet:u,col:a,row:f},h]))}return n.forEach(o=>this.restoreClipboardCells(e,o.values())),i}addNamedExpression(e,r,n,i){const o=this.namedExpressions.addNamedExpression(e,n,i);this.storeNamedExpressionInCell(o.address,r),this.adjustNamedExpressionEdges(o,e,n)}restoreNamedExpression(e,r,n){const i=e.displayName;this.restoreCell(e.address,r);const o=this.namedExpressions.restoreNamedExpression(e,n);this.adjustNamedExpressionEdges(o,i,n)}changeNamedExpressionExpression(e,r,n,i){const o=this.namedExpressions.namedExpressionForScope(e,n);if(!o)throw new Lv(e);const a=o.copy();o.options=i;const s=this.getClipboardCell(o.address);return this.storeNamedExpressionInCell(o.address,r),[a,s]}removeNamedExpression(e,r){const n=this.namedExpressions.namedExpressionForScope(e,r);if(!n)throw new Lv(e);this.namedExpressions.remove(n.displayName,r);const i=this.getClipboardCell(n.address);if(r!==void 0){const o=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(n.address,o.address)}else this.dependencyGraph.setCellEmpty(n.address);return[n,i]}ensureItIsPossibleToMoveCells(e,r,n,i){if(fi(e)||!(RS(r)&&RS(n)||Hlt(e,r,n))||fi(i)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(i.sheet))throw new Qr("a valid range of cells to move.");const o=ze.spanFrom(e,r,n),a=ze.spanFrom(i,r,n);if(a.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Vu;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new Df;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new dS}restoreClipboardCells(e,r){const n=[];for(const[i,o]of r)if(this.restoreCell(i,o),o.type===_n.FORMULA){const{dependencies:a}=this.parser.fetchCachedResult(o.hash);n.push(...this.updateNamedExpressionsForTargetAddress(e,i,a))}return n}restoreCell(e,r){switch(r.type){case _n.VALUE:{this.setValueToCell(r,e);break}case _n.FORMULA:{this.setFormulaToCellFromCache(r.hash,e);break}case _n.EMPTY:{this.setCellEmpty(e);break}case _n.PARSING_ERROR:{this.setParsingErrorToCell(r.rawInput,r.errors,e);break}}}getOldContent(e){const r=this.dependencyGraph.getCell(e);if(r===void 0||r instanceof Ha)return[e,{type:_n.EMPTY}];if(r instanceof dl)return[e,Object.assign({type:_n.VALUE},r.getValues())];if(r instanceof Mi)return[r.getAddress(this.lazilyTransformingAstService),{type:_n.FORMULA,hash:this.parser.computeHashFromAst(r.getFormula(this.lazilyTransformingAstService))}];if(r instanceof th)return[e,{type:_n.PARSING_ERROR,rawInput:r.rawInput,errors:r.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const r=this.dependencyGraph.getCell(e);if(r===void 0||r instanceof Ha)return{type:_n.EMPTY};if(r instanceof dl)return Object.assign({type:_n.VALUE},r.getValues());if(r instanceof xr){const n=r.getArrayCellValue(e);return n===Tt?{type:_n.EMPTY}:{type:_n.VALUE,parsedValue:n,rawValue:r.getArrayCellRawValue(e)}}else{if(r instanceof fs)return{type:_n.FORMULA,hash:this.parser.computeHashFromAst(r.getFormula(this.lazilyTransformingAstService))};if(r instanceof th)return{type:_n.PARSING_ERROR,rawInput:r.rawInput,errors:r.errors}}throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const r=this.dependencyGraph.getSheetHeight(e),n=this.dependencyGraph.getSheetWidth(e),i=new Array(r);for(let o=0;o<r;o++){i[o]=new Array(n);for(let a=0;a<n;a++){const s=Le(e,a,o);i[o][a]=this.getClipboardCell(s)}}return i}getRangeClipboardCells(e){const r=[];for(const n of e.addresses(this.dependencyGraph))r.push([n,this.getClipboardCell(n)]);return r}setCellContent(e,r){const n=this.cellContentParser.parse(r),i=this.getOldContent(e);if(n instanceof hr.Formula){const o=this.parser.parse(n.formula,e),{ast:a,errors:s}=o;if(s.length>0)this.setParsingErrorToCell(n.formula,s,e);else{const l=this.arraySizePredictor.checkArraySize(a,e);this.setFormulaToCell(e,l,o)}}else n instanceof hr.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:r},e);return i}setSheetContent(e,r){this.clearSheet(e);for(let n=0;n<r.length;n++)for(let i=0;i<r[n].length;i++){const o=Le(e,i,n);this.setCellContent(o,r[n][i])}}setParsingErrorToCell(e,r,n){const i=this.dependencyGraph.getCellValue(n),o=new th(r,e),a=this.dependencyGraph.setParsingErrorToCell(n,o);this.columnSearch.remove(Ne(i),n),this.columnSearch.applyChanges(a.getChanges()),this.changes.addAll(a),this.changes.addChange(o.getCellValue(),n)}setFormulaToCell(e,r,{ast:n,hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:a}){const s=this.dependencyGraph.getCellValue(e),l=this.dependencyGraph.setFormulaToCell(e,n,ea(a,e),r,i,o);this.columnSearch.remove(Ne(s),e),this.columnSearch.applyChanges(l.getChanges()),this.changes.addAll(l)}setValueToCell(e,r){const n=this.dependencyGraph.getCellValue(r),i=this.dependencyGraph.setValueToCell(r,e);this.columnSearch.change(Ne(n),Ne(e.parsedValue),r),this.columnSearch.applyChanges(i.getChanges().filter(o=>!Fv(o.address,r))),this.changes.addAll(i),this.changes.addChange(e.parsedValue,r)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const r=this.dependencyGraph.getCellValue(e),n=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(Ne(r),e),this.columnSearch.applyChanges(n.getChanges()),this.changes.addAll(n),this.changes.addChange(Tt,e)}setFormulaToCellFromCache(e,r){const{ast:n,hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:a}=this.parser.fetchCachedResult(e),s=ea(a,r),[l]=new Plt(r.sheet).transformSingleAst(n,r);this.parser.rememberNewAst(l);const u=bst(s),c=this.arraySizePredictor.checkArraySize(n,r);this.dependencyGraph.setFormulaToCell(r,l,u,c,i,o)}rowEffectivelyNotInSheet(e,r){const n=this.dependencyGraph.addressMapping.getHeight(r);return e>=n}getAndClearContentChanges(){const e=this.changes;return this.changes=hl.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const r=[];for(const[a]of this.dependencyGraph.entriesFromRowsSpan(e))r.push({address:a,cellType:this.getClipboardCell(a)});const{affectedArrays:n,contentChanges:i}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(i.getChanges());let o;return this.stats.measure(ot.TRANSFORM_ASTS,()=>{const a=new UA(e);a.performEagerTransformations(this.dependencyGraph,this.parser),o=this.lazilyTransformingAstService.addTransformation(a)}),this.rewriteAffectedArrays(n),{version:o,removedCells:r,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const r=[];for(const[a]of this.dependencyGraph.entriesFromColumnsSpan(e))r.push({address:a,cellType:this.getClipboardCell(a)});const{affectedArrays:n,contentChanges:i}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(i.getChanges()),this.columnSearch.removeColumns(e);let o;return this.stats.measure(ot.TRANSFORM_ASTS,()=>{const a=new Llt(e);a.performEagerTransformations(this.dependencyGraph,this.parser),o=this.lazilyTransformingAstService.addTransformation(a)}),this.rewriteAffectedArrays(n),{version:o,removedCells:r,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:r}=this.dependencyGraph.addRows(e);this.stats.measure(ot.TRANSFORM_ASTS,()=>{const n=new BA(e);n.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(n)}),this.rewriteAffectedArrays(r)}rewriteAffectedArrays(e){for(const r of e.values()){if(r.array.size.isRef)continue;const n=r.getFormula(this.lazilyTransformingAstService),i=r.getAddress(this.lazilyTransformingAstService),o=this.parser.computeHashFromAst(n);this.setFormulaToCellFromCache(o,i)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:r,contentChanges:n}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(n.getChanges()),this.stats.measure(ot.TRANSFORM_ASTS,()=>{const i=new Nlt(e);i.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(i)}),this.rewriteAffectedArrays(r)}columnEffectivelyNotInSheet(e,r){const n=this.dependencyGraph.addressMapping.getWidth(r);return e>=n}adjustNamedExpressionEdges(e,r,n){if(n===void 0)return;const i=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),o=this.namedExpressions.workbookNamedExpressionOrPlaceholder(r),a=this.dependencyGraph.fetchCellOrCreateEmpty(o.address);for(const s of this.dependencyGraph.graph.adjacentNodes(a))if(s instanceof fs&&s.getAddress(this.lazilyTransformingAstService).sheet===n){const l=s.getFormula(this.lazilyTransformingAstService),u=s.getAddress(this.lazilyTransformingAstService),{dependencies:c}=this.parser.fetchCachedResultForAst(l);for(const f of ea(c,u))f instanceof Ks&&f.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(a,s),this.dependencyGraph.graph.addEdge(i,s))}}storeNamedExpressionInCell(e,r){const n=this.cellContentParser.parse(r);if(n instanceof hr.Formula){const i=this.parser.parse(n.formula,Le(-1,0,0));if(Us(i.ast))throw new Hx;const{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:s,dependencies:l}=i;this.dependencyGraph.setFormulaToCell(e,o,ea(l,e),yt.scalar(),a,s)}else n instanceof hr.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:r},e)}updateNamedExpressionsForMovedCells(e,r,n,i){if(e.sheet===i.sheet)return[];const o=[],a=ze.spanFrom(i,r,n);for(const s of a.addresses(this.dependencyGraph)){const l=this.addressMapping.fetchCell(s);if(l instanceof fs&&s.sheet!==e.sheet){const u=l.getFormula(this.lazilyTransformingAstService),{dependencies:c}=this.parser.fetchCachedResultForAst(u);o.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,s,c))}}return o}updateNamedExpressionsForTargetAddress(e,r,n){if(e===r.sheet)return[];const i=[],o=this.addressMapping.fetchCell(r);for(const a of ea(n,r)){if(!(a instanceof Ks))continue;const s=a.name,l=this.dependencyGraph.fetchNamedExpressionVertex(s,e),c=this.namedExpressions.isExpressionInScope(s,r.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(s,r.sheet):this.copyOrFetchGlobalNamedExpressionVertex(s,l,i);c!==l&&(this.dependencyGraph.graph.softRemoveEdge(l,o),this.dependencyGraph.graph.addEdge(c,o))}return i}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(lc.SHEET_FOR_WORKBOOK_EXPRESSIONS,new Dst(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,r,n){let i=this.namedExpressions.namedExpressionForScope(e);if(i===void 0)if(i=this.namedExpressions.addNamedExpression(e),n.push(i.normalizeExpressionName()),r instanceof fs){const o=this.parser.fetchCachedResultForAst(r.getFormula(this.lazilyTransformingAstService)),{ast:a,hasVolatileFunction:s,hasStructuralChangeFunction:l,dependencies:u}=o;this.dependencyGraph.setFormulaToCell(i.address,a,ea(u,i.address),yt.scalar(),s,l)}else r instanceof Ha?this.setCellEmpty(i.address):r instanceof dl&&this.setValueToCell(r.getValues(),i.address);return this.dependencyGraph.fetchCellOrCreateEmpty(i.address)}}function wS(t){if(t.length<=1)return t;const e=[...t].sort(([i],[o])=>i-o),r=e.reduce((i,[o,a])=>{const s=i[i.length-1],l=s[0]+s[1];return o<=l?s[1]+=Math.max(0,a-(l-o)):i.push([o,a]),i},[e[0]]);let n=0;for(let i=0;i<r.length;++i)r[i][0]-=n,n+=r[i][1];return r}function SS(t){if(t.length<=1)return t;const e=[...t].sort(([i],[o])=>i-o),r=e.reduce((i,[o,a])=>{const s=i[i.length-1];return o===s[0]?s[1]=Math.max(s[1],a):i.push([o,a]),i},[e[0]]);let n=0;for(let i=0;i<r.length;++i)r[i][0]+=n,n+=r[i][1];return r}function RS(t){return Number.isInteger(t)&&t>0}function Hlt(t,e,r){return t.row===0&&RS(e)&&r===Number.POSITIVE_INFINITY||t.col===0&&RS(r)&&e===Number.POSITIVE_INFINITY}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class tn{}class Blt extends tn{constructor(e,r){super(),this.command=e,this.rowsRemovals=r}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class Ult extends tn{constructor(e,r,n,i,o,a,s){super(),this.sourceLeftCorner=e,this.width=r,this.height=n,this.destinationLeftCorner=i,this.overwrittenCellsData=o,this.addedGlobalNamedExpressions=a,this.version=s}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class Vlt extends tn{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class jlt extends tn{constructor(e,r,n){super(),this.sheetId=e,this.rowMapping=r,this.oldContent=n}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class Wlt extends tn{constructor(e,r,n){super(),this.sheetId=e,this.columnMapping=r,this.oldContent=n}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class zlt extends tn{constructor(e,r,n){super(),this.sheetId=e,this.oldSheetContent=r,this.newSheetContent=n}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class Glt extends tn{constructor(e,r,n,i,o){super(),this.sheet=e,this.startRow=r,this.numberOfRows=n,this.targetRow=i,this.version=o,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class Ylt extends tn{constructor(e,r,n,i,o){super(),this.sheet=e,this.startColumn=r,this.numberOfColumns=n,this.targetColumn=i,this.version=o,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class Klt extends tn{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class qlt extends tn{constructor(e,r){super(),this.command=e,this.columnsRemovals=r}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class Xlt extends tn{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class Qlt extends tn{constructor(e,r,n,i,o){super(),this.sheetName=e,this.sheetId=r,this.oldSheetContent=n,this.scopedNamedExpressions=i,this.version=o}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class Zlt extends tn{constructor(e,r,n){super(),this.sheetId=e,this.oldName=r,this.newName=n}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class Jlt extends tn{constructor(e,r){super(),this.sheetId=e,this.oldSheetContent=r}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class eut extends tn{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class tut extends tn{constructor(e,r,n,i){super(),this.targetLeftCorner=e,this.oldContent=r,this.newContent=n,this.addedGlobalNamedExpressions=i}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class rut extends tn{constructor(e,r,n,i){super(),this.name=e,this.newContent=r,this.scope=n,this.options=i}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class nut extends tn{constructor(e,r,n){super(),this.namedExpression=e,this.content=r,this.scope=n}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class iut extends tn{constructor(e,r,n,i,o){super(),this.namedExpression=e,this.newContent=r,this.oldContent=n,this.scope=i,this.options=o}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class out extends tn{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class aut{constructor(e,r){this.operations=r,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){this.batchUndoEntry!==void 0?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new out}commitBatchMode(){if(this.batchUndoEntry===void 0)throw"Batch mode wasn't started";this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,r,n){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([r,n])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return this.undoStack.length===0}isRedoStackEmpty(){return this.redoStack.length===0}undo(){const e=this.undoStack.pop();if(!e)throw"Attempted to undo without operation on stack";this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const r of e.reversedOperations())this.undoEntry(r)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:r},rowsRemovals:n}=e;for(let i=n.length-1;i>=0;--i){const o=n[i];this.operations.addRows(new Bee(r,[[o.rowFrom,o.rowCount]]));for(const{address:a,cellType:s}of o.removedCells)this.operations.restoreCell(a,s);this.restoreOldDataFromVersion(o.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:r},columnsRemovals:n}=e;for(let i=n.length-1;i>=0;--i){const o=n[i];this.operations.addColumns(new Uee(r,[[o.columnFrom,o.columnCount]]));for(const{address:a,cellType:s}of o.removedCells)this.operations.restoreCell(a,s);this.restoreOldDataFromVersion(o.version-1)}}undoAddRows(e){const r=e.command.rowsSpans();for(let n=r.length-1;n>=0;--n){const i=r[n];this.operations.removeRows(new Hee(e.command.sheet,[[i.rowStart,i.numberOfRows]]))}}undoAddColumns(e){const r=e.command.columnsSpans();for(let n=r.length-1;n>=0;--n){const i=r[n];this.operations.removeColumns(new Vee(e.command.sheet,[[i.columnStart,i.numberOfColumns]]))}}undoSetCellContents(e){for(const r of e.cellContents){const n=r.address,[i,o]=r.oldContent;Fv(n,i)||this.operations.setCellEmpty(n),this.operations.restoreCell(i,o)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const r of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(r)}undoMoveRows(e){const{sheet:r}=e;this.operations.moveRows(r,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:r}=e;this.operations.moveColumns(r,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const r of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(r)}undoAddSheet(e){const{sheetName:r}=e;this.operations.removeSheetByName(r)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:r,sheetId:n}=e;this.operations.addSheet(e.sheetName);for(let i=0;i<r.length;i++){const o=r[i];for(let a=0;a<o.length;a++){const s=o[a],l=Le(n,a,i);this.operations.restoreCell(l,s)}}for(const[i,o]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(i,o,n);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:r,sheetId:n}=e;for(let i=0;i<r.length;i++){const o=r[i];for(let a=0;a<o.length;a++){const s=o[a],l=Le(n,a,i);this.operations.restoreCell(l,s)}}}undoSetSheetContent(e){const{oldSheetContent:r,sheetId:n}=e;this.operations.clearSheet(n);for(let i=0;i<r.length;i++){const o=r[i];for(let a=0;a<o.length;a++){const s=o[a],l=Le(n,a,i);this.operations.restoreCell(l,s)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw"Attempted to redo without operation on stack";this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const r of e.operations)this.redoEntry(r)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:r,newContent:n}=e,i=n.length,o=n[0].length;for(let a=0;a<i;++a)for(let s=0;s<o;++s){const l=Le(r.sheet,r.col+s,r.row+a);this.operations.restoreCell(l,n[a][s])}}redoSetCellContents(e){for(const r of e.cellContents)this.operations.setCellContent(r.address,r.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:r,newSheetContent:n}=e;this.operations.setSheetContent(r,n)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[r,n]of e)this.operations.restoreCell(r,n)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const r=this.oldData.get(e)||[];for(const n of r){const[i,o]=n;this.operations.setFormulaToCellFromCache(o,i)}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class sut{constructor(e,r,n,i,o,a,s,l,u,c){this.operations=r,this.undoRedo=n,this.clipboardOperations=i,this.dependencyGraph=o,this.columnSearch=a,this.parser=s,this.cellContentParser=l,this.lazilyTransformingAstService=u,this.namedExpressions=c,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...r){const n=new Bee(e,r);this.ensureItIsPossibleToAddRows(e,...r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(n),this.undoRedo.saveOperation(new Vlt(n))}removeRows(e,...r){const n=new Hee(e,r);this.ensureItIsPossibleToRemoveRows(e,...r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeRows(n);this.undoRedo.saveOperation(new Blt(n,i))}addColumns(e,...r){const n=new Uee(e,r);this.ensureItIsPossibleToAddColumns(e,...r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(n),this.undoRedo.saveOperation(new Klt(n))}removeColumns(e,...r){const n=new Vee(e,r);this.ensureItIsPossibleToRemoveColumns(e,...r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeColumns(n);this.undoRedo.saveOperation(new qlt(n,i))}moveCells(e,r,n,i){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:o,overwrittenCellsData:a,addedGlobalNamedExpressions:s}=this.operations.moveCells(e,r,n,i);this.undoRedo.saveOperation(new Ult(e,r,n,i,a,s,o))}moveRows(e,r,n,i){this.ensureItIsPossibleToMoveRows(e,r,n,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const o=this.operations.moveRows(e,r,n,i);this.undoRedo.saveOperation(new Glt(e,r,n,i,o))}moveColumns(e,r,n,i){this.ensureItIsPossibleToMoveColumns(e,r,n,i),this.undoRedo.clearRedoStack();const o=this.operations.moveColumns(e,r,n,i);this.undoRedo.saveOperation(new Ylt(e,r,n,i,o))}cut(e,r,n){this.clipboardOperations.cut(e,r,n)}ensureItIsPossibleToCopy(e,r,n){if(!pf(r))throw new Qr("width to be positive integer.");if(!pf(n))throw new Qr("height to be positive integer.")}copy(e,r,n){this.ensureItIsPossibleToCopy(e,r,n),this.clipboardOperations.copy(e,r,n)}paste(e){const r=this.clipboardOperations.clipboard;if(r===void 0)throw new yee;if(this.clipboardOperations.isCutClipboard())this.moveCells(r.sourceLeftCorner,r.width,r.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const n=ze.spanFrom(e,r.width,r.height),i=this.operations.getRangeClipboardCells(n);this.undoRedo.clearRedoStack();const o=this.operations.restoreClipboardCells(r.sourceLeftCorner.sheet,r.getContent(e));this.undoRedo.saveOperation(new tut(e,i,r.content,o))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return this.clipboardOperations.clipboard===void 0}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){e!==void 0&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const r=this.operations.addSheet(e);return this.undoRedo.saveOperation(new Xlt(r)),r}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.sheetMapping.fetchDisplayName(e),n=this.operations.getSheetClipboardCells(e),{version:i,scopedNamedExpressions:o}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new Qlt(r,e,n,o,i))}renameSheet(e,r){this.ensureItIsPossibleToRenameSheet(e,r);const n=this.operations.renameSheet(e,r);return n!==void 0&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new Zlt(e,n,r))),n}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new Jlt(e,r))}setCellContents(e,r){if(!(r instanceof Array))r=[[r]];else for(let i=0;i<r.length;i++)if(!(r[i]instanceof Array))throw new Qr("an array of arrays or a raw cell value.");this.ensureItIsPossibleToChangeCellContents(e,r),this.undoRedo.clearRedoStack();const n=[];for(let i=0;i<r.length;i++)for(let o=0;o<r[i].length;o++){const a={sheet:e.sheet,row:e.row+i,col:e.col+o},s=r[i][o];this.clipboardOperations.abortCut();const l=this.operations.setCellContent(a,s);n.push({address:a,newContent:s,oldContent:l})}this.undoRedo.saveOperation(new eut(n))}setSheetContent(e,r){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,r),Fee(r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,r),this.undoRedo.saveOperation(new zlt(e,n,r))}setRowOrder(e,r){this.validateSwapRowIndexes(e,r),this.testRowOrderForArrays(e,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setRowOrder(e,r);this.undoRedo.saveOperation(new jlt(e,r,n))}validateSwapRowIndexes(e,r){if(!this.sheetMapping.hasSheetWithId(e))throw new yr(e);this.validateRowOrColumnMapping(e,r,"row")}testColumnOrderForArrays(e,r){for(const[n,i]of r)if(n!==i){const o=ze.spanFrom({sheet:e,col:n,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new Df}}setColumnOrder(e,r){this.validateSwapColumnIndexes(e,r),this.testColumnOrderForArrays(e,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setColumnOrder(e,r);this.undoRedo.saveOperation(new Wlt(e,r,n))}validateSwapColumnIndexes(e,r){if(!this.sheetMapping.hasSheetWithId(e))throw new yr(e);this.validateRowOrColumnMapping(e,r,"column")}testRowOrderForArrays(e,r){for(const[n,i]of r)if(n!==i){const o=ze.spanFrom({sheet:e,col:0,row:n},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new Df}}mappingFromOrder(e,r,n){if(!this.sheetMapping.hasSheetWithId(e))throw new yr(e);const i=n==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(r.length!==i)throw new Qr(`number of ${n}s provided to be sheet ${n==="row"?"height":"width"}.`);const o=[];for(let a=0;a<i;a++)r[a]!==a&&o.push([a,r[a]]);return o}undo(){if(this.undoRedo.isUndoStackEmpty())throw new mee;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new gee;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,r,n,i){this.ensureItIsPossibleToAddNamedExpression(e,r,n),this.operations.addNamedExpression(e,r,n,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new rut(e,r,n,i))}changeNamedExpressionExpression(e,r,n,i){this.ensureItIsPossibleToChangeNamedExpression(e,n,r);const[o,a]=this.operations.changeNamedExpressionExpression(e,n,r,i);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new iut(o,n,a,r,i))}removeNamedExpression(e,r){this.ensureScopeIdIsValid(r);const[n,i]=this.operations.removeNamedExpression(e,r);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new nut(n,i,r)),n}ensureItIsPossibleToAddNamedExpression(e,r,n){this.ensureScopeIdIsValid(n),this.ensureNamedExpressionNameIsValid(e,n),this.ensureNamedExpressionIsValid(r)}ensureItIsPossibleToChangeNamedExpression(e,r,n){if(this.ensureScopeIdIsValid(n),this.namedExpressions.namedExpressionForScope(e,n)===void 0)throw new Lv(e);this.ensureNamedExpressionIsValid(r)}isItPossibleToRemoveNamedExpression(e,r){if(this.ensureScopeIdIsValid(r),this.namedExpressions.namedExpressionForScope(e,r)===void 0)throw new Lv(e)}ensureItIsPossibleToAddRows(e,...r){if(!this.sheetMapping.hasSheetWithId(e))throw new yr(e);const n=this.dependencyGraph.getSheetHeight(e),i=r.map(o=>o[1]).reduce((o,a)=>o+a,0);if(n+i>this.maxRows)throw new Vu;for(const[o,a]of r)if(!Yl(o)||!pf(a))throw new Qr("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...r){for(const[n,i]of r){const o=n+i-1;if(!Yl(n)||!Yl(o))throw new Qr("starting and ending row to be nonnegative.");if(o<n)throw new Qr("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new yr(e)}}ensureItIsPossibleToAddColumns(e,...r){if(!this.sheetMapping.hasSheetWithId(e))throw new yr(e);const n=this.dependencyGraph.getSheetWidth(e),i=r.map(o=>o[1]).reduce((o,a)=>o+a,0);if(n+i>this.maxColumns)throw new Vu;for(const[o,a]of r)if(!Yl(o)||!pf(a))throw new Qr("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...r){for(const[n,i]of r){const o=n+i-1;if(!Yl(n)||!Yl(o))throw new Qr("starting and ending column to be nonnegative.");if(o<n)throw new Qr("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new yr(e)}}ensureItIsPossibleToMoveRows(e,r,n,i){this.ensureItIsPossibleToAddRows(e,[i,n]);const o=Le(e,0,r),a=Le(e,0,i);if(!this.sheetMapping.hasSheetWithId(e)||fi(o)||fi(a)||!pf(n)||i<=r+n&&i>=r)throw new Qr("a valid range of rows to move.");const s=this.dependencyGraph.getSheetWidth(e),l=ze.spanFrom(o,s,n);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new Df;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(di.fromNumberOfRows(e,i-1,2)))throw new dS}ensureItIsPossibleToMoveColumns(e,r,n,i){this.ensureItIsPossibleToAddColumns(e,[i,n]);const o=Le(e,r,0),a=Le(e,i,0);if(!this.sheetMapping.hasSheetWithId(e)||fi(o)||fi(a)||!pf(n)||i<=r+n&&i>=r)throw new Qr("a valid range of columns to move.");const s=this.dependencyGraph.getSheetHeight(e),l=ze.spanFrom(o,n,s);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new Df;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(xi.fromNumberOfColumns(e,i-1,2)))throw new dS}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new kv(e)}ensureItIsPossibleToRenameSheet(e,r){if(!this.sheetMapping.hasSheetWithId(e))throw new yr(e);const n=this.sheetMapping.get(r);if(n!==void 0&&n!==e)throw new kv(r)}ensureItIsPossibleToChangeContent(e){if(fi(e))throw new hee(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new yr(e.sheet)}ensureItIsPossibleToChangeCellContents(e,r){const n=bS(r),i=ze.spanFrom(e,n.width,n.height);this.ensureRangeInSizeLimits(i);for(const o of i.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(o)}ensureItIsPossibleToChangeSheetContents(e,r){const n=bS(r),i=ze.spanFrom(Le(e,0,0),n.width,n.height);this.ensureRangeInSizeLimits(i)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Vu}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(e!==void 0&&!this.sheetMapping.hasSheetWithId(e))throw new yr(e)}validateRowOrColumnMapping(e,r,n){const i=n==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),o=r.map(([s,l])=>s).sort((s,l)=>s-l),a=r.map(([s,l])=>l).sort((s,l)=>s-l);for(let s=0;s<o.length;s++){if(!Yl(o[s])||o[s]>=i)throw new Qr(`${n} numbers to be nonnegative integers and less than sheet ${n==="row"?"height":"width"}.`);if(o[s]===o[s+1])throw new Qr(`source ${n} numbers to be unique.`);if(o[s]!==a[s])throw new Qr(`target ${n} numbers to be permutation of source ${n} numbers.`)}}ensureNamedExpressionNameIsValid(e,r){if(!this.namedExpressions.isNameValid(e))throw new pee(e);if(!this.namedExpressions.isNameAvailable(e,r))throw new dee(e)}ensureNamedExpressionIsValid(e){const r=this.cellContentParser.parse(e);if(r instanceof hr.Formula){const n=this.parser.parse(r.formula,Le(-1,0,0));if(Us(n.ast))throw new Hx}}}function pf(t){return Number.isInteger(t)&&t>0}function Yl(t){return Number.isInteger(t)&&t>=0}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class lut{constructor(e,r,n,i,o,a){this.config=e,this.stats=r,this.interpreter=n,this.lazilyTransformingAstService=i,this.dependencyGraph=o,this.columnSearch=a}run(){this.stats.start(ot.TOP_SORT);const{sorted:e,cycled:r}=this.dependencyGraph.topSortWithScc();this.stats.end(ot.TOP_SORT),this.stats.measure(ot.EVALUATION,()=>{this.recomputeFormulas(r,e)})}partialRun(e){const r=hl.empty();return this.stats.measure(ot.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,n=>{if(n instanceof Mi){const i=n.isComputed()?n.getCellValue():void 0,o=this.recomputeFormulaVertexValue(n);if(o!==i){const a=n.getAddress(this.lazilyTransformingAstService);return r.addChange(o,a),this.columnSearch.change(Ne(i),Ne(o),a),!0}return!1}else return n instanceof kn&&n.clearCache(),!0},n=>{if(n instanceof kn)n.clearCache();else if(n instanceof Mi){const i=n.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(Ne(n.valueOrUndef()),i);const o=new L(V.CYCLE,void 0,n);n.setCellValue(o),r.addChange(o,i)}})}),r}runAndForget(e,r,n){const i=[];for(const a of ea(n,r))if(a instanceof ze){const s=a;if(this.dependencyGraph.getRange(s.start,s.end)===void 0){const l=new kn(s);this.dependencyGraph.rangeMapping.setRange(l),i.push(l)}}const o=this.evaluateAstToCellValue(e,new aa(r,this.config.useArrayArithmetic));return i.forEach(a=>{this.dependencyGraph.rangeMapping.removeRange(a)}),o}recomputeFormulas(e,r){e.forEach(n=>{n instanceof Mi&&n.setCellValue(new L(V.CYCLE,void 0,n))}),r.forEach(n=>{if(n instanceof Mi){const i=this.recomputeFormulaVertexValue(n),o=n.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(Ne(i),o)}else n instanceof kn&&n.clearCache()})}recomputeFormulaVertexValue(e){const r=e.getAddress(this.lazilyTransformingAstService);if(e instanceof xr&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const n=e.getFormula(this.lazilyTransformingAstService),i=this.evaluateAstToCellValue(n,new aa(r,this.config.useArrayArithmetic,e));return e.setCellValue(i)}}evaluateAstToCellValue(e,r){const n=this.interpreter.evaluateAst(e,r);return n instanceof je?n:n===Tt&&this.config.evaluateNullToZero?0:n}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class VA{constructor(e,r){this.address=e,this.newValue=r}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class jee{constructor(e,r){this.name=e,this.newValue=r}}class uut{constructor(e,r,n,i){this.config=e,this.namedExpressions=r,this.sheetIndexMapping=n,this.lazilyTransformingService=i}exportChange(e){const r=e.value,n=e.address;if(n.sheet===lc.SHEET_FOR_WORKBOOK_EXPRESSIONS){const i=this.namedExpressions.namedExpressionInAddress(n.row);if(!i)throw new Error("Missing named expression");return new jee(i.displayName,this.exportScalarOrRange(r))}else if(r instanceof je){const i=[];for(const[o,a]of r.entriesFromTopLeftCorner(n))i.push(new VA(a,this.exportValue(o)));return i}else return new VA(n,this.exportValue(r))}exportValue(e){return e instanceof je?this.detailedError(new L(V.VALUE,Q.ScalarExpected)):this.config.smartRounding&&Ft(e)?this.cellValueRounding(Ne(e)):e instanceof L?this.detailedError(e):e===Tt?null:Ne(e)}exportScalarOrRange(e){return e instanceof je?e.rawData().map(r=>r.map(n=>this.exportValue(n))):this.exportValue(e)}detailedError(e){var r,n;let i;const o=(r=e.root)===null||r===void 0?void 0:r.getAddress(this.lazilyTransformingService);return o!==void 0&&(o.sheet===lc.SHEET_FOR_WORKBOOK_EXPRESSIONS?i=(n=this.namedExpressions.namedExpressionInAddress(o.row))===null||n===void 0?void 0:n.displayName:i=eS(this.sheetIndexMapping,o,-1)),new Pee(e,this.config.translationPackage.getErrorTranslation(e.type),i)}cellValueRounding(e){if(e===0)return e;const r=Math.floor(Math.log10(Math.abs(e))),n=Math.pow(10,this.config.precisionRounding-r);return e<0?-Math.round(-e*n)/n:Math.round(e*n)/n}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class cut{constructor(e,r,n,i,o,a){this.dependencyGraph=e,this.columnSearch=r,this.parser=n,this.cellContentParser=i,this.stats=o,this.arraySizePredictor=a,this.buildStrategy=new fut(e,r,n,o,i,a)}buildGraph(e,r){const n=r.measure(ot.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),r.measure(ot.PROCESS_DEPENDENCIES,()=>this.processDependencies(n))}processDependencies(e){e.forEach((r,n)=>{this.dependencyGraph.processCellDependencies(r,n)})}}class fut{constructor(e,r,n,i,o,a){this.dependencyGraph=e,this.columnIndex=r,this.parser=n,this.stats=i,this.cellContentParser=o,this.arraySizePredictor=a}run(e){const r=new Map;for(const n in e){const i=this.dependencyGraph.getSheetId(n),o=e[n];for(let a=0;a<o.length;++a){const s=o[a];for(let l=0;l<s.length;++l){const u=s[l],c=Le(i,l,a),f=this.cellContentParser.parse(u);if(f instanceof hr.Formula){const h=this.stats.measure(ot.PARSER,()=>this.parser.parse(f.formula,c));if(h.errors.length>0){this.shrinkArrayIfNeeded(c);const d=new th(h.errors,f.formula);this.dependencyGraph.addVertex(c,d)}else{this.shrinkArrayIfNeeded(c);const d=this.arraySizePredictor.checkArraySize(h.ast,c);if(d.isScalar()){const p=new fs(h.ast,c,0);r.set(p,ea(h.dependencies,c)),this.dependencyGraph.addVertex(c,p),h.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(p),h.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(p)}else{const p=new xr(h.ast,c,new yt(d.width,d.height));r.set(p,ea(h.dependencies,c)),this.dependencyGraph.addArrayVertex(c,p)}}}else if(!(f instanceof hr.Empty)){this.shrinkArrayIfNeeded(c);const h=new dl(f.value,u);this.columnIndex.add(Ne(f.value),c),this.dependencyGraph.addVertex(c,h)}}}}return r}shrinkArrayIfNeeded(e){const r=this.dependencyGraph.getCell(e);r instanceof xr&&this.dependencyGraph.shrinkArrayToCorner(r)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const fb=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class Wee extends pt{version(e,r){return this.runFunction(e.args,r,this.metadata("VERSION"),()=>{const{licenseKeyValidityState:n,licenseKey:i}=this.config;let o;return fb.has(i)?o=fb.get(i):fb.has(n)?o=fb.get(n):n==="valid"&&(o=i.slice(-5)),`HyperFormula v${Nn.version}, ${o}`})}}Wee.implementedFunctions={VERSION:{method:"version",parameters:[]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function KC(t,e){var r;let n=e.implementedFunctions[t];const i=(r=e.aliases)===null||r===void 0?void 0:r[t];if(i!==void 0){if(n!==void 0)throw new _st(t,e.name);n=e.implementedFunctions[i]}if(n===void 0)throw yp.functionNotDeclaredInPlugin(t,e.name);return n}class nn{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=r=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(r),this.isFunctionVolatile=r=>this.volatileFunctions.has(r),this.isArrayFunction=r=>this.arrayFunctions.has(r),this.isFunctionDependentOnSheetStructureChange=r=>this.structuralChangeFunctions.has(r),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const r of e.functionPlugins)nn.loadPluginFunctions(r,this.instancePlugins)}else this.instancePlugins=new Map(nn.plugins);for(const[r,n]of nn.protectedFunctions())nn.loadFunctionUnprotected(n,r,this.instancePlugins);for(const[r,n]of this.instancePlugins.entries())this.categorizeFunction(r,KC(r,n))}static registerFunctionPlugin(e,r){this.loadPluginFunctions(e,this.plugins),r!==void 0&&this.loadTranslations(r)}static registerFunction(e,r,n){this.loadPluginFunction(r,e,this.plugins),n!==void 0&&this.loadTranslations(n)}static unregisterFunction(e){if(this.functionIsProtected(e))throw ju.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const r of this.protectedPlugins())if(r===e)throw ju.cannotUnregisterProtectedPlugin();for(const[r,n]of this.plugins.entries())n===e&&this.plugins.delete(r)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const r=new Set(Nn.getRegisteredLanguagesCodes());Object.keys(e).forEach(n=>{r.has(n)&&Nn.getLanguage(n).extendFunctions(e[n])})}static loadPluginFunctions(e,r){Object.keys(e.implementedFunctions).forEach(n=>{this.loadPluginFunction(e,n,r)}),e.aliases!==void 0&&Object.keys(e.aliases).forEach(n=>{this.loadPluginFunction(e,n,r)})}static loadPluginFunction(e,r,n){if(this.functionIsProtected(r))throw ju.cannotRegisterFunctionWithId(r);this.loadFunctionUnprotected(e,r,n)}static loadFunctionUnprotected(e,r,n){const i=KC(r,e).method;if(Object.prototype.hasOwnProperty.call(e.prototype,i))n.set(r,e);else throw yp.functionMethodNotFound(i,e.name)}static*protectedFunctions(){for(const[e,r]of this._protectedPlugins)r!==void 0&&(yield[e,r])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)e!==void 0&&(yield e)}initializePlugins(e){const r=[];for(const[n,i]of this.instancePlugins.entries()){let o=r.find(u=>u instanceof i);o===void 0&&(o=new i(e),r.push(o));const a=KC(n,i),s=a.method;this.functions.set(n,[s,o]);const l=a.arraySizeMethod;l!==void 0&&this.arraySizeFunctions.set(n,[l,o])}}getFunctionPlugin(e){if(!nn.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const r=this.functions.get(e);if(r!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[n,i]=r;return(o,a)=>i[n](o,a)}else return}getArraySizeFunction(e){const r=this.arraySizeFunctions.get(e);if(r!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[n,i]=r;return(o,a)=>i[n](o,a)}else return}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[r,n]of this.instancePlugins)nn.functionIsProtected(r)||e.add(n);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,r){r.isVolatile&&this.volatileFunctions.add(e),r.arrayFunction&&this.arrayFunctions.add(e),r.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),r.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,r)}}nn.plugins=new Map;nn._protectedPlugins=new Map([["VERSION",Wee],["OFFSET",void 0]]);/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var pn;(function(t){t.GREATER_THAN="GREATER_THAN",t.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",t.LESS_THAN="LESS_THAN",t.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",t.NOT_EQUAL="NOT_EQUAL",t.EQUAL="EQUAL"})(pn||(pn={}));const hb=(t,e)=>({operator:t,value:e});class hut{constructor(e){var r,n,i,o;this.trueString=(n=(r=e.translationPackage.getMaybeFunctionTranslation("TRUE"))===null||r===void 0?void 0:r.toLowerCase())!==null&&n!==void 0?n:"true",this.falseString=(o=(i=e.translationPackage.getMaybeFunctionTranslation("FALSE"))===null||i===void 0?void 0:i.toLowerCase())!==null&&o!==void 0?o:"false"}fromCellValue(e,r){if(typeof e!="string"&&typeof e!="boolean"&&typeof e!="number")return;const n=this.parseCriterion(e,r);if(n!==void 0)return{raw:e,lambda:mut(n,r)}}parseCriterion(e,r){if(typeof e=="number"||typeof e=="boolean")return hb(pn.EQUAL,e);if(typeof e=="string"){const n=dut.exec(e);let i,o;n?(o=put(n[1]),i=n[2]):(o=pn.EQUAL,i=e);const a=r.coerceToMaybeNumber(i),s=i.toLowerCase()===this.trueString?!0:i.toLowerCase()===this.falseString?!1:void 0;if(o===void 0)return;if(i==="")return hb(o,null);if(a===void 0){if(o===pn.EQUAL||o===pn.NOT_EQUAL)return hb(o,s!=null?s:i)}else return hb(o,Ne(a))}}}const dut=/([<>=]+)(.*)/;function put(t){switch(t){case">":return pn.GREATER_THAN;case">=":return pn.GREATER_THAN_OR_EQUAL;case"<":return pn.LESS_THAN;case"<=":return pn.LESS_THAN_OR_EQUAL;case"<>":return pn.NOT_EQUAL;case"=":return pn.EQUAL;default:return}}const mut=(t,e)=>{switch(t.operator){case pn.GREATER_THAN:return typeof t.value=="number"?r=>typeof r=="number"&&e.floatCmp(r,t.value)>0:r=>!1;case pn.GREATER_THAN_OR_EQUAL:return typeof t.value=="number"?r=>typeof r=="number"&&e.floatCmp(r,t.value)>=0:r=>!1;case pn.LESS_THAN:return typeof t.value=="number"?r=>typeof r=="number"&&e.floatCmp(r,t.value)<0:r=>!1;case pn.LESS_THAN_OR_EQUAL:return typeof t.value=="number"?r=>typeof r=="number"&&e.floatCmp(r,t.value)<=0:r=>!1;case pn.EQUAL:return typeof t.value=="number"?r=>{if(typeof r=="number")return e.floatCmp(r,t.value)===0;if(typeof r=="string"){if(r==="")return!1;const n=e.coerceToMaybeNumber(r);return n===void 0?!1:e.floatCmp(n,t.value)===0}else return!1}:typeof t.value=="string"?e.eqMatcherFunction(t.value):typeof t.value=="boolean"?r=>typeof r=="boolean"&&r===t.value:r=>r===Tt;case pn.NOT_EQUAL:return typeof t.value=="number"?r=>{if(typeof r=="number")return e.floatCmp(r,t.value)!==0;if(typeof r=="string"){if(r==="")return!0;const n=e.coerceToMaybeNumber(r);return n===void 0?!0:e.floatCmp(n,t.value)!==0}else return!0}:typeof t.value=="string"?e.neqMatcherFunction(t.value):typeof t.value=="boolean"?r=>typeof r!="boolean"||r!==t.value:r=>r!==Tt}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class gut{constructor(e,r,n,i,o,a,s,l,u,c){this.config=e,this.dependencyGraph=r,this.columnSearch=n,this.stats=i,this.arithmeticHelper=o,this.functionRegistry=a,this.namedExpressions=s,this.serialization=l,this.arraySizePredictor=u,this.dateTimeHelper=c,this.equalOp=(f,h)=>Bi(this.arithmeticHelper.eq,f,h),this.notEqualOp=(f,h)=>Bi(this.arithmeticHelper.neq,f,h),this.greaterThanOp=(f,h)=>Bi(this.arithmeticHelper.gt,f,h),this.lessThanOp=(f,h)=>Bi(this.arithmeticHelper.lt,f,h),this.greaterThanOrEqualOp=(f,h)=>Bi(this.arithmeticHelper.geq,f,h),this.lessThanOrEqualOp=(f,h)=>Bi(this.arithmeticHelper.leq,f,h),this.concatOp=(f,h)=>Bi(this.arithmeticHelper.concat,LA(f),LA(h)),this.plusOp=(f,h)=>Bi(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.minusOp=(f,h)=>Bi(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.timesOp=(f,h)=>Bi(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.powerOp=(f,h)=>Bi(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.divOp=(f,h)=>Bi(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.unaryMinusOp=f=>QV(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(f)),this.percentOp=f=>QV(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(f)),this.unaryPlusOp=f=>this.arithmeticHelper.unaryPlus(f),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new hut(e)}evaluateAst(e,r){let n=this.evaluateAstWithoutPostprocessing(e,r);if(Ft(n)){if(xee(Ne(n)))return new L(V.NUM,Q.NaN);n=$x(n,Mee(Ne(n)))}return n instanceof je&&n.height()===1&&n.width()===1&&([[n]]=n.data),yut(n,r.formulaVertex)}evaluateAstWithoutPostprocessing(e,r){switch(e.type){case G.EMPTY:return Tt;case G.CELL_REFERENCE:{const n=e.reference.toSimpleCellAddress(r.formulaAddress);return fi(n)?new L(V.REF,Q.BadRef):this.dependencyGraph.getCellValue(n)}case G.NUMBER:case G.STRING:return e.value;case G.CONCATENATE_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.concatOp,n,i,r)}case G.EQUALS_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.equalOp,n,i,r)}case G.NOT_EQUAL_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.notEqualOp,n,i,r)}case G.GREATER_THAN_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.greaterThanOp,n,i,r)}case G.LESS_THAN_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.lessThanOp,n,i,r)}case G.GREATER_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,n,i,r)}case G.LESS_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.lessThanOrEqualOp,n,i,r)}case G.PLUS_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.plusOp,n,i,r)}case G.MINUS_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.minusOp,n,i,r)}case G.TIMES_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.timesOp,n,i,r)}case G.POWER_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.powerOp,n,i,r)}case G.DIV_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.divOp,n,i,r)}case G.PLUS_UNARY_OP:{const n=this.evaluateAst(e.value,r);return this.unaryRangeWrapper(this.unaryPlusOp,n,r)}case G.MINUS_UNARY_OP:{const n=this.evaluateAst(e.value,r);return this.unaryRangeWrapper(this.unaryMinusOp,n,r)}case G.PERCENT_OP:{const n=this.evaluateAst(e.value,r);return this.unaryRangeWrapper(this.percentOp,n,r)}case G.FUNCTION_CALL:{if(this.config.licenseKeyValidityState!=="valid"&&!nn.functionIsProtected(e.procedureName))return new L(V.LIC,Q.LicenseKey(this.config.licenseKeyValidityState));const n=this.functionRegistry.getFunction(e.procedureName);return n!==void 0?n(e,new aa(r.formulaAddress,r.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),r.formulaVertex)):new L(V.NAME,Q.FunctionName(e.procedureName))}case G.NAMED_EXPRESSION:{const n=this.namedExpressions.nearestNamedExpression(e.expressionName,r.formulaAddress.sheet);return n?this.dependencyGraph.getCellValue(n.address):new L(V.NAME,Q.NamedExpressionName(e.expressionName))}case G.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new L(V.REF,Q.RangeManySheets);const n=ze.fromCellRange(e,r.formulaAddress),i=this.dependencyGraph.getArray(n);if(i){const o=i.array;if(o instanceof Wm)throw new Error("Array should be already computed");if(o instanceof L)return o;if(o instanceof vp)return je.fromRange(o.raw(),n,this.dependencyGraph);throw new Error("Unknown array")}else return je.onlyRange(n,this.dependencyGraph)}case G.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new L(V.REF,Q.RangeManySheets);const n=gs.fromColumnRange(e,r.formulaAddress);return je.onlyRange(n,this.dependencyGraph)}case G.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new L(V.REF,Q.RangeManySheets);const n=ys.fromRowRangeAst(e,r.formulaAddress);return je.onlyRange(n,this.dependencyGraph)}case G.PARENTHESIS:return this.evaluateAst(e.expression,r);case G.ARRAY:{let n;const i=[];for(const o of e.args){let a;const s=[];for(const u of o){const c=Aee(this.evaluateAst(u,r)),f=c.height();if(a===void 0)a=f,s.push(...c.data);else if(a===f)for(let h=0;h<f;h++)s[h].push(...c.data[h]);else return new L(V.REF,Q.SizeMismatch)}const l=s[0].length;if(n===void 0)n=l,i.push(...s);else if(n===l)i.push(...s);else return new L(V.REF,Q.SizeMismatch)}return je.onlyValues(i)}case G.ERROR_WITH_RAW_INPUT:case G.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,r,n){var i;if(r instanceof je&&!n.arraysFlag&&(r=(i=A2(r,n))!==null&&i!==void 0?i:new L(V.VALUE,Q.ScalarExpected)),r instanceof L)return r;if(r instanceof je){const o=r.data.map(a=>a.map(e));return je.onlyValues(o)}return e(r)}binaryRangeWrapper(e,r,n,i){var o,a;if(r instanceof je&&!i.arraysFlag&&(r=(o=A2(r,i))!==null&&o!==void 0?o:new L(V.VALUE,Q.ScalarExpected)),r instanceof L)return r;if(n instanceof je&&!i.arraysFlag&&(n=(a=A2(n,i))!==null&&a!==void 0?a:new L(V.VALUE,Q.ScalarExpected)),n instanceof L)return n;if(r instanceof je||n instanceof je){if(!(r instanceof je))if(n.isAdHoc()){const c=n.data;for(let f=0;f<c.length;f++)for(let h=0;h<c[0].length;h++)c[f][h]=e(r,c[f][h]);return je.onlyValues(c)}else r=je.fromScalar(r);if(!(n instanceof je))if(r.isAdHoc()){const c=r.data;for(let f=0;f<c.length;f++)for(let h=0;h<c[0].length;h++)c[f][h]=e(c[f][h],n);return je.onlyValues(c)}else n=je.fromScalar(n);if(r.width()===n.width()&&r.height()===n.height()){if(r.isAdHoc()){const c=r.data,f=n.data;for(let h=0;h<c.length;h++)for(let d=0;d<c[0].length;d++)c[h][d]=e(c[h][d],f[h][d]);return je.onlyValues(c)}if(n.isAdHoc()){const c=r.data,f=n.data;for(let h=0;h<c.length;h++)for(let d=0;d<c[0].length;d++)f[h][d]=e(c[h][d],f[h][d]);return je.onlyValues(f)}}const s=Math.max(r.width(),n.width()),l=Math.max(r.height(),n.height()),u=Array(l);for(let c=0;c<l;c++)u[c]=Array(s);for(let c=0;c<l;c++){const f=r.height()!==1?c:0,h=n.height()!==1?c:0;for(let d=0;d<s;d++){const p=r.width()!==1?d:0,m=n.width()!==1?d:0;f<r.height()&&h<n.height()&&p<r.width()&&m<n.width()?u[c][d]=e(r.data[f][p],n.data[h][m]):u[c][d]=new L(V.NA)}}return je.onlyValues(u)}return e(r,n)}}function QV(t,e){return e instanceof L?e:t(e)}function Bi(t,e,r){return e instanceof L?e:r instanceof L?r:t(e,r)}function yut(t,e){return t instanceof L&&e!==void 0?t.attachRootVertex(e):t}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class vut{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,r){this.transformations.forEach(n=>n.performEagerTransformations(e,r))}transformSingleAst(e,r){let[n,i]=[e,r];return this.transformations.forEach(o=>{[n,i]=o.transformSingleAst(n,i)}),[n,i]}isIrreversible(){return!0}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class but{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return this.combinedTransformer!==void 0?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new vut(e)}commitCombinedMode(){if(this.combinedTransformer===void 0)throw"Combined mode wasn't started";return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,r,n){this.stats.start(ot.TRANSFORM_ASTS_POSTPONED);for(let o=n;o<this.transformations.length;o++){const a=this.transformations[o];a.isIrreversible()&&(this.undoRedo.storeDataForVersion(o,r,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[s,l]=a.transformSingleAst(e,r);e=s,r=l}const i=this.parser.rememberNewAst(e);return this.stats.end(ot.TRANSFORM_ASTS_POSTPONED),[i,r,this.transformations.length]}*getTransformationsFrom(e,r){for(let n=e;n<this.transformations.length;n++){const i=this.transformations[n];(!r||r(i))&&(yield i)}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const I2=-1;function wut(t,e,{searchCoordinate:r,orderingDirection:n,matchExactly:i},o){const a=e.start[r],s=r==="col"?e.effectiveEndColumn(o):e.effectiveEndRow(o),l=r==="col"?h=>Ne(o.getCellValue(Le(e.sheet,h,e.start.row))):h=>Ne(o.getCellValue(Le(e.sheet,e.start.col,h))),u=n==="asc"?(h,d)=>ZV(h,d):(h,d)=>-ZV(h,d),c=Sut(h=>u(t,l(h))>=0,a,s),f=l(c);return c===I2||typeof f!=typeof t||i&&f!==t?I2:c-a}function Sut(t,e,r){let n=e,i=r;for(;n<i;){const o=Math.ceil((n+i)/2);t(o)?n=o:i=o-1}return n===i&&t(n)?n:I2}function ZV(t,e){return typeof t==typeof e?t===Tt?0:t<e?-1:t>e?1:0:t===Tt?-1:e===Tt?1:e instanceof L||typeof t=="number"&&typeof e=="string"||typeof t=="number"&&typeof e=="boolean"?-1:typeof t=="string"&&typeof e=="number"?1:typeof t=="string"&&typeof e=="boolean"?-1:1}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class zee{constructor(e){this.dependencyGraph=e}advancedFind(e,r){let n;const i=r.range;i===void 0?n=r.valuesFromTopLeftCorner():n=this.dependencyGraph.computeListOfValuesInRange(i);for(let o=0;o<n.length;o++)if(e(Ne(n[o])))return o;return-1}basicFind(e,r,n,{ordering:i,matchExactly:o}){const a=typeof e=="string"?dg(e):e,s=r.range;return s===void 0?this.findNormalizedValue(a,r.valuesFromTopLeftCorner()):i==="none"?this.findNormalizedValue(a,this.dependencyGraph.computeListOfValuesInRange(s)):wut(a,s,{searchCoordinate:n,orderingDirection:i,matchExactly:o},this.dependencyGraph)}findNormalizedValue(e,r){return r.map(Ne).map(n=>typeof n=="string"?dg(n):n).indexOf(e)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Gee extends zee{constructor(e){super(e),this.dependencyGraph=e}add(e,r){}remove(e,r){}change(e,r,n){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,r,n,i){}removeValues(e){}find(e,r,n){return this.basicFind(e,r,"row",n)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class iu{constructor(e,r,n){this.dependencyGraph=e,this.config=r,this.stats=n,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new Gee(e)}add(e,r){if(!(e===Tt||e instanceof L))if(e instanceof je)for(const[n,i]of e.entriesFromTopLeftCorner(r))this.addSingleCellValue(Ne(n),i);else this.addSingleCellValue(e,r)}remove(e,r){if(e!==void 0)if(e instanceof je)for(const[n,i]of e.entriesFromTopLeftCorner(r))this.removeSingleValue(Ne(n),i);else this.removeSingleValue(e,r)}change(e,r,n){e!==r&&(this.remove(e,n),this.add(r,n))}applyChanges(e){for(const r of e)r.oldValue!==void 0&&this.change(Ne(r.oldValue),Ne(r.value),r.address)}moveValues(e,r,n,i){for(const[o,a]of e){const s=zst(a,i,r,n);this.remove(o,a),this.add(o,s)}}removeValues(e){for(const[r,n]of e)this.remove(r,n)}find(e,r,{ordering:n,matchExactly:i}){const o=i===!0?"findFirst":"findLast",a=this.findUsingColumnIndex(e,r,o);return a!==void 0?a:this.binarySearchStrategy.find(e,r,{ordering:n,matchExactly:i})}findUsingColumnIndex(e,r,n){const i=r.range;if(i===void 0)return;this.ensureRecentData(i.sheet,i.start.col,e);const o=this.getColumnMap(i.sheet,i.start.col);if(!o)return-1;const a=typeof e=="string"?dg(e):e,s=o.get(a);if(!s||!s.index||s.index.length===0)return;const l=iu.findRowBelongingToRange(s,i,n);return l!==void 0?l-i.start.row:void 0}static findRowBelongingToRange(e,r,n){const i=r.start.row,o=r.end.row,a=n==="findFirst"?Kl(i,e.index,"upperBound"):Kl(o,e.index,"lowerBound");if(a===-1)return;const s=e.index[a];return s>=i&&s<=o?s:void 0}advancedFind(e,r){return this.binarySearchStrategy.advancedFind(e,r)}addColumns(e){const r=this.index.get(e.sheet);!r||r.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const r=this.index.get(e.sheet);!r||r.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,r){this.index.has(e)||this.index.set(e,[]);const n=this.index.get(e);let i=n[r];return i||(i=new Map,n[r]=i),i}getValueIndex(e,r,n){const i=this.getColumnMap(e,r);let o=this.getColumnMap(e,r).get(n);return o||(o={version:this.transformingService.version(),index:[]},i.set(n,o)),o}ensureRecentData(e,r,n){const i=this.getValueIndex(e,r,n),o=this.transformingService.version();if(i.version===o)return;const a=this.transformingService.getTransformationsFrom(i.version,s=>s.sheet===e&&(s instanceof BA||s instanceof UA));for(const s of a)s instanceof BA?this.addRows(r,s.rowsSpan,n):s instanceof UA&&this.removeRows(r,s.rowsSpan,n);i.version=o}addSingleCellValue(e,r){this.stats.measure(ot.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(r.sheet,r.col,e),typeof e=="string"&&(e=dg(e));const n=this.getValueIndex(r.sheet,r.col,e);iu.addValue(n,r.row)})}removeSingleValue(e,r){this.stats.measure(ot.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(r.sheet,r.col,e);const n=this.getColumnMap(r.sheet,r.col);typeof e=="string"&&(e=dg(e));const i=n.get(e);if(!i)return;const o=Kl(r.row,i.index);o>-1&&i.index.splice(o,1),i.index.length===0&&n.delete(e),n.size===0&&delete this.index.get(r.sheet)[r.col]})}addRows(e,r,n){const i=this.getValueIndex(r.sheet,e,n);iu.shiftRows(i,r.rowStart,r.numberOfRows)}removeRows(e,r,n){const i=this.getValueIndex(r.sheet,e,n);iu.removeRowsFromValues(i,r),iu.shiftRows(i,r.rowEnd+1,-r.numberOfRows)}static addValue(e,r){const n=Kl(r,e.index,"lowerBound");e.index[n]===r||e.index.splice(n+1,0,r)}static removeRowsFromValues(e,r){const n=Kl(r.rowStart,e.index,"upperBound"),i=Kl(r.rowEnd,e.index,"lowerBound");n>-1&&i>-1&&n<=i&&e.index[n]<=r.rowEnd&&e.index.splice(n,i-n+1)}static shiftRows(e,r,n){const i=Kl(r,e.index,"upperBound");if(i!==-1)for(let o=i;o<e.index.length;++o)e.index[o]+=n}}function Kl(t,e,r="upperBound"){let n=0,i=e.length-1;for(;n<=i;){const s=Math.floor((n+i)/2);if(t>e[s])n=s+1;else if(t<e[s])i=s-1;else return s}const o=r==="lowerBound"?i:n;return o>=0&&o<=e.length?o:-1}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Rut(t,e,r){return e.useColumnIndex?new iu(t,e,r):new Gee(t)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Eut{constructor(e){this.config=e;const r=this.config.thousandSeparator==="."?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,n=this.config.decimalSeparator==="."?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${n}\\d+)|(\\d+(${r}\\d{3,})*(${n}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${r}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const r=this.numericStringToNumber(e);return isNaN(r)?void 0:r}}numericStringToNumber(e){const r=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(r)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Vx{constructor(e,r,n){this.dependencyGraph=e,this.unparser=r,this.exporter=n}getCellFormula(e,r){const n=this.dependencyGraph.getCell(e);if(n instanceof fs){const i=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);return r=r!=null?r:e,this.unparser.unparse(i,r)}else if(n instanceof xr){const i=n.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(i.row!==e.row||i.col!==e.col||i.sheet!==e.sheet)return;r=r!=null?r:e;const o=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(o!==void 0)return this.unparser.unparse(o,r)}else if(n instanceof th)return n.getFormula()}getCellSerialized(e,r){var n;return(n=this.getCellFormula(e,r))!==null&&n!==void 0?n:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,r=>this.getCellValue(r))}getSheetFormulas(e){return this.genericSheetGetter(e,r=>this.getCellFormula(r))}genericSheetGetter(e,r){const n=this.dependencyGraph.getSheetHeight(e),i=this.dependencyGraph.getSheetWidth(e),o=new Array(n);for(let a=0;a<n;a++){o[a]=new Array(i);for(let s=0;s<i;s++){const l=Le(e,s,a);o[a][s]=r(l)}for(let s=i-1;s>=0&&(o[a][s]===null||o[a][s]===void 0);s--)o[a].pop()}for(let a=n-1;a>=0&&o[a].length===0;a--)o.pop();return o}genericAllSheetsGetter(e){const r={};for(const n of this.dependencyGraph.sheetMapping.displayNames()){const i=this.dependencyGraph.sheetMapping.fetch(n);r[n]=e(i)}return r}getSheetSerialized(e){return this.genericSheetGetter(e,r=>this.getCellSerialized(r))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){const e=[];let r=0;for(const n of this.dependencyGraph.sheetMapping.displayNames()){const i=this.dependencyGraph.sheetMapping.fetch(n);e[i]=r,r++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(n=>({name:n.expression.displayName,expression:this.getCellSerialized(n.expression.address),scope:n.scope!==void 0?e[n.scope]:void 0,options:n.expression.options}))}withNewConfig(e,r){const n=new see(e,kx(e),this.dependencyGraph.sheetMapping.fetchDisplayName,r);return new Vx(this.dependencyGraph,n,this.exporter)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class db{static buildFromSheets(e,r={},n=[]){const i=new An(r);return this.buildEngine(i,e,n)}static buildFromSheet(e,r={},n=[]){const i=new An(r),o=i.translationPackage.getUITranslation(Dv.NEW_SHEET_PREFIX)+"1";return this.buildEngine(i,{[o]:e},n)}static buildEmpty(e={},r=[]){return this.buildEngine(new An(e),{},r)}static rebuildWithConfig(e,r,n,i){return this.buildEngine(e,r,n,i)}static buildEngine(e,r={},n=[],i=e.useStats?new cee:new Rst){i.start(ot.BUILD_ENGINE_TOTAL);const o=new lc,a=new nn(e),s=new but(i),l=Bx.buildEmpty(s,e,a,o,i),u=Rut(l,e,i),c=l.sheetMapping,f=l.addressMapping;for(const I in r)if(Object.prototype.hasOwnProperty.call(r,I)){const H=r[I];Fee(H);const j=bS(H);if(j.height>e.maxRows||j.width>e.maxColumns)throw new Vu;const q=c.addSheet(I);f.autoAddSheet(q,H,j)}const h=new hg(e,a,c.get);s.parser=h;const d=new see(e,kx(e),c.fetchDisplayName,o),p=new llt(e),m=new Eut(e),g=new Qst(e,p,m),v=new Ilt(e,p,m),w=new ilt(e,a),b=new Flt(e,l,u,v,h,i,s,o,w),E=new aut(e,b);s.undoRedo=E;const A=new xlt(e,l,b),M=new sut(e,b,E,A,l,u,h,v,s,o);n.forEach(I=>{M.ensureItIsPossibleToAddNamedExpression(I.name,I.expression,I.scope),M.operations.addNamedExpression(I.name,I.expression,I.scope,I.options)});const k=new uut(e,o,c.fetchDisplayName,s),O=new Vx(l,d,k),x=new gut(e,l,u,i,g,a,o,O,w,p);i.measure(ot.GRAPH_BUILD,()=>{new cut(l,u,h,v,i,w).buildGraph(r,i)});const C=new lut(e,i,x,s,l,u);return C.run(),i.end(ot.BUILD_ENGINE_TOTAL),{config:e,stats:i,dependencyGraph:l,columnSearch:u,parser:h,unparser:d,cellContentParser:v,evaluator:C,lazilyTransformingAstService:s,crudOperations:M,exporter:k,namedExpressions:o,serialization:O,functionRegistry:a}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Cut(t){for(const[e,r]of Object.entries(t))r instanceof Function?t[e]=_ut(r):delete t[e]}function _ut(t){return()=>{throw new Error(`The "${t}" method cannot be called because this HyperFormula instance has been destroyed`)}}var Yee={exports:{}};function jx(){}jx.prototype={on:function(t,e,r){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:e,ctx:r}),this},once:function(t,e,r){var n=this;function i(){n.off(t,i),e.apply(r,arguments)}return i._=e,this.on(t,i,r)},emit:function(t){var e=[].slice.call(arguments,1),r=((this.e||(this.e={}))[t]||[]).slice(),n=0,i=r.length;for(n;n<i;n++)r[n].fn.apply(r[n].ctx,e);return this},off:function(t,e){var r=this.e||(this.e={}),n=r[t],i=[];if(n&&e)for(var o=0,a=n.length;o<a;o++)n[o].fn!==e&&n[o].fn._!==e&&i.push(n[o]);return i.length?r[t]=i:delete r[t],this}};Yee.exports=jx;var Tut=Yee.exports.TinyEmitter=jx;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var qo;(function(t){t.SheetAdded="sheetAdded",t.SheetRemoved="sheetRemoved",t.SheetRenamed="sheetRenamed",t.NamedExpressionAdded="namedExpressionAdded",t.NamedExpressionRemoved="namedExpressionRemoved",t.ValuesUpdated="valuesUpdated",t.EvaluationSuspended="evaluationSuspended",t.EvaluationResumed="evaluationResumed"})(qo||(qo={}));class Out extends Tut{emit(e,...r){return super.emit(e,...r),this}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Nn{constructor(e,r,n,i,o,a,s,l,u,c,f,h,d,p){this._config=e,this._stats=r,this._dependencyGraph=n,this._columnSearch=i,this._parser=o,this._unparser=a,this._cellContentParser=s,this._evaluator=l,this._lazilyTransformingAstService=u,this._crudOperations=c,this._exporter=f,this._namedExpressions=h,this._serialization=d,this._functionRegistry=p,this._emitter=new Out,this._evaluationSuspended=!1}static get defaultConfig(){return Aut()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,r={},n=[]){return this.buildFromEngineState(db.buildFromSheet(e,r,n))}static buildFromSheets(e,r={},n=[]){return this.buildFromEngineState(db.buildFromSheets(e,r,n))}static buildEmpty(e={},r=[]){return this.buildFromEngineState(db.buildEmpty(e,r))}static getLanguage(e){Ie(e,"string","languageCode");const r=this.registeredLanguages.get(e);if(r===void 0)throw new NA;return r}static registerLanguage(e,r){if(Ie(e,"string","languageCode"),this.registeredLanguages.has(e))throw new Cee;this.registeredLanguages.set(e,kst(r))}static unregisterLanguage(e){if(Ie(e,"string","languageCode"),this.registeredLanguages.has(e))this.registeredLanguages.delete(e);else throw new NA}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,r){nn.registerFunctionPlugin(e,r)}static unregisterFunctionPlugin(e){nn.unregisterFunctionPlugin(e)}static registerFunction(e,r,n){Ie(e,"string","functionId"),nn.registerFunction(e,r,n)}static unregisterFunction(e){Ie(e,"string","functionId"),nn.unregisterFunction(e)}static unregisterAllFunctions(){nn.unregisterAll()}static getRegisteredFunctionNames(e){Ie(e,"string","code");const r=nn.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(r)}static getFunctionPlugin(e){return Ie(e,"string","functionId"),nn.getFunctionPlugin(e)}static getAllFunctionPlugins(){return nn.getPlugins()}static buildFromEngineState(e){return new Nn(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellSerialized(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return Ie(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return Ie(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return Ie(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return Ie(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){const r=this._config.mergeConfig(e),n=this._config.mergeConfig({language:e.language}),i=this._serialization.withNewConfig(n,this._namedExpressions).getAllSheetsSerialized(),o=this._serialization.getAllNamedExpressionsSerialized(),a=db.rebuildWithConfig(r,i,o,this._stats);this._config=a.config,this._stats=a.stats,this._dependencyGraph=a.dependencyGraph,this._columnSearch=a.columnSearch,this._parser=a.parser,this._unparser=a.unparser,this._cellContentParser=a.cellContentParser,this._evaluator=a.evaluator,this._lazilyTransformingAstService=a.lazilyTransformingAstService,this._crudOperations=a.crudOperations,this._exporter=a.exporter,this._namedExpressions=a.namedExpressions,this._serialization=a.serialization,this._functionRegistry=a.functionRegistry}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.updateConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let r;if(Br(e))r=new ze(e,e);else if(_i(e))r=new ze(e.start,e.end);else throw new Bt("SimpleCellAddress | SimpleCellRange","address");try{this._crudOperations.ensureRangeInSizeLimits(r);for(const n of r.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(n)}catch{return!1}return!0}setCellContents(e,r){return this._crudOperations.setCellContents(e,r),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,r){return Ie(e,"number","sheetId"),this._crudOperations.setRowOrder(e,r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,r){Ie(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,r),this._crudOperations.testRowOrderForArrays(e,r),!0}catch{return!1}}setRowOrder(e,r){Ie(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,r,"row");return this.swapRowIndexes(e,n)}isItPossibleToSetRowOrder(e,r){Ie(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,r,"row");return this._crudOperations.validateSwapRowIndexes(e,n),this._crudOperations.testRowOrderForArrays(e,n),!0}catch{return!1}}swapColumnIndexes(e,r){return Ie(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,r){Ie(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,r),this._crudOperations.testColumnOrderForArrays(e,r),!0}catch{return!1}}setColumnOrder(e,r){Ie(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,r,"column");return this.swapColumnIndexes(e,n)}isItPossibleToSetColumnOrder(e,r){Ie(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,r,"column");return this._crudOperations.validateSwapColumnIndexes(e,n),this._crudOperations.testColumnOrderForArrays(e,n),!0}catch{return!1}}isItPossibleToAddRows(e,...r){Ie(e,"number","sheetId");const n=SS(r);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...n),!0}catch{return!1}}addRows(e,...r){return Ie(e,"number","sheetId"),this._crudOperations.addRows(e,...r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...r){Ie(e,"number","sheetId");const n=wS(r);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...n),!0}catch{return!1}}removeRows(e,...r){return Ie(e,"number","sheetId"),this._crudOperations.removeRows(e,...r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...r){Ie(e,"number","sheetId");const n=SS(r);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...n),!0}catch{return!1}}addColumns(e,...r){return Ie(e,"number","sheetId"),this._crudOperations.addColumns(e,...r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...r){Ie(e,"number","sheetId");const n=wS(r);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...n),!0}catch{return!1}}removeColumns(e,...r){return Ie(e,"number","sheetId"),this._crudOperations.removeColumns(e,...r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,r){if(!Br(r))throw new Bt("SimpleCellAddress","destinationLeftCorner");if(!_i(e))throw new Bt("SimpleCellRange","source");try{const n=new ze(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(n.start,n.width(),n.height(),r),!0}catch{return!1}}moveCells(e,r){if(!Br(r))throw new Bt("SimpleCellAddress","destinationLeftCorner");if(!_i(e))throw new Bt("SimpleCellRange","source");const n=new ze(e.start,e.end);return this._crudOperations.moveCells(n.start,n.width(),n.height(),r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,r,n,i){Ie(e,"number","sheetId"),Ie(r,"number","startRow"),Ie(n,"number","numberOfRows"),Ie(i,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,r,n,i),!0}catch{return!1}}moveRows(e,r,n,i){return Ie(e,"number","sheetId"),Ie(r,"number","startRow"),Ie(n,"number","numberOfRows"),Ie(i,"number","targetRow"),this._crudOperations.moveRows(e,r,n,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,r,n,i){Ie(e,"number","sheetId"),Ie(r,"number","startColumn"),Ie(n,"number","numberOfColumns"),Ie(i,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,r,n,i),!0}catch{return!1}}moveColumns(e,r,n,i){return Ie(e,"number","sheetId"),Ie(r,"number","startColumn"),Ie(n,"number","numberOfColumns"),Ie(i,"number","targetColumn"),this._crudOperations.moveColumns(e,r,n,i),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!_i(e))throw new Bt("SimpleCellRange","source");const r=new ze(e.start,e.end);return this._crudOperations.copy(r.start,r.width(),r.height()),this.getRangeValues(e)}cut(e){if(!_i(e))throw new Bt("SimpleCellRange","source");const r=new ze(e.start,e.end);return this._crudOperations.cut(r.start,r.width(),r.height()),this.getRangeValues(e)}paste(e){if(!Br(e))throw new Bt("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!_i(e))throw new Bt("SimpleCellRange","source");return new ze(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(i=>this.getCellValue(i)))}getRangeFormulas(e){if(!_i(e))throw new Bt("SimpleCellRange","source");return new ze(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(i=>this.getCellFormula(i)))}getRangeSerialized(e){if(!_i(e))throw new Bt("SimpleCellRange","source");return new ze(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(i=>this.getCellSerialized(i)))}getFillRangeData(e,r,n=!1){if(!_i(e))throw new Bt("SimpleCellRange","source");if(!_i(r))throw new Bt("SimpleCellRange","target");const i=new ze(e.start,e.end),o=new ze(r.start,r.end);return this.ensureEvaluationIsNotSuspended(),o.arrayOfAddressesInRange().map(a=>a.map(s=>{const l=((s.row-(n?r:e).start.row)%i.height()+i.height())%i.height()+e.start.row,u=((s.col-(n?r:e).start.col)%i.width()+i.width())%i.width()+e.start.col;return this._serialization.getCellSerialized({row:l,col:u,sheet:i.sheet},s)}))}isItPossibleToAddSheet(e){Ie(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch{return!1}}addSheet(e){e!==void 0&&Ie(e,"string","sheetName");const r=this._crudOperations.addSheet(e);return this._emitter.emit(qo.SheetAdded,r),r}isItPossibleToRemoveSheet(e){Ie(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}removeSheet(e){Ie(e,"number","sheetId");const r=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const n=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(qo.SheetRemoved,r,n),n}isItPossibleToClearSheet(e){Ie(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}clearSheet(e){return Ie(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,r){Ie(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,r),!0}catch{return!1}}setSheetContent(e,r){return Ie(e,"number","sheetId"),this._crudOperations.setSheetContent(e,r),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,r){return Ie(e,"string","cellAddress"),Ie(r,"number","sheetId"),vA(this.sheetMapping.get,e,r)}simpleCellRangeFromString(e,r){return Ie(e,"string","cellRange"),Ie(r,"number","sheetId"),Rit(this.sheetMapping.get,e,r)}simpleCellAddressToString(e,r){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");return Ie(r,"number","sheetId"),eS(this.sheetMapping.fetchDisplayName,e,r)}simpleCellRangeToString(e,r){if(!_i(e))throw new Bt("SimpleCellRange","cellRange");return Ie(r,"number","sheetId"),Eit(this.sheetMapping.fetchDisplayName,e,r)}getCellDependents(e){let r;if(Br(e))r=this._dependencyGraph.addressMapping.getCell(e);else if(_i(e))r=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new Bt("SimpleCellAddress | SimpleCellRange",e);return r===void 0?[]:this._dependencyGraph.getAdjacentNodesAddresses(r)}getCellPrecedents(e){let r;if(Br(e))r=this._dependencyGraph.addressMapping.getCell(e);else if(_i(e))r=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new Bt("SimpleCellAddress | SimpleCellRange",e);return r===void 0?[]:this._dependencyGraph.dependencyQueryAddresses(r)}getSheetName(e){return Ie(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return Ie(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return Ie(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");const r=this.dependencyGraph.getCell(e);return Hst(r,e)}doesCellHaveSimpleValue(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");return this.getCellType(e)===li.VALUE}doesCellHaveFormula(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");const r=this.getCellType(e);return r===li.FORMULA||r===li.ARRAYFORMULA}isCellEmpty(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");return this.getCellType(e)===li.EMPTY}isCellPartOfArray(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");const r=this.getCellType(e);return r===li.ARRAY||r===li.ARRAYFORMULA}getCellValueType(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const r=this.dependencyGraph.getCellValue(e);return mS(r)}getCellValueDetailedType(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const r=this.dependencyGraph.getCellValue(e);return Ust(r)}getCellValueFormat(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const r=this.dependencyGraph.getCellValue(e);return Vst(r)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,r){Ie(e,"number","sheetId"),Ie(r,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,r),!0}catch{return!1}}renameSheet(e,r){Ie(e,"number","sheetId"),Ie(r,"string","newName");const n=this._crudOperations.renameSheet(e,r);n!==void 0&&this._emitter.emit(qo.SheetRenamed,n,r)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(r){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),r}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(qo.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(qo.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,r,n){Ie(e,"string","expressionName"),n!==void 0&&Ie(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,r,n),!0}catch{return!1}}addNamedExpression(e,r,n,i){Ie(e,"string","expressionName"),n!==void 0&&Ie(n,"number","scope"),this._crudOperations.addNamedExpression(e,r,n,i);const o=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(qo.NamedExpressionAdded,e,o),o}getNamedExpressionValue(e,r){Ie(e,"string","expressionName"),r!==void 0&&Ie(r,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(r);const n=this._namedExpressions.namedExpressionForScope(e,r);if(n)return this._serialization.getCellValue(n.address)}getNamedExpressionFormula(e,r){Ie(e,"string","expressionName"),r!==void 0&&Ie(r,"number","scope"),this._crudOperations.ensureScopeIdIsValid(r);const n=this._namedExpressions.namedExpressionForScope(e,r);if(n!==void 0)return this._serialization.getCellFormula(n.address)}getNamedExpression(e,r){Ie(e,"string","expressionName"),r!==void 0&&Ie(r,"number","scope");const n=this._namedExpressions.namedExpressionForScope(e,r);if(n===void 0)return;const i=this._serialization.getCellFormula(n.address);return{name:e,scope:r,expression:i,options:n.options}}isItPossibleToChangeNamedExpression(e,r,n){Ie(e,"string","expressionName"),n!==void 0&&Ie(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,r,n),!0}catch{return!1}}changeNamedExpression(e,r,n,i){return Ie(e,"string","expressionName"),n!==void 0&&Ie(n,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,n,r,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,r){Ie(e,"string","expressionName"),r!==void 0&&Ie(r,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,r),!0}catch{return!1}}removeNamedExpression(e,r){Ie(e,"string","expressionName"),r!==void 0&&Ie(r,"number","scope");const n=this._crudOperations.removeNamedExpression(e,r);if(n){const i=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(qo.NamedExpressionRemoved,n.displayName,i),i}else return[]}listNamedExpressions(e){return e!==void 0&&Ie(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){Ie(e,"string","formulaString");const{ast:r,address:n}=this.extractTemporaryFormula(e);if(r===void 0)throw new MA;return this._unparser.unparse(r,n)}calculateFormula(e,r){Ie(e,"string","formulaString"),Ie(r,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(r);const{ast:n,address:i,dependencies:o}=this.extractTemporaryFormula(e,r);if(n===void 0)throw new MA;const a=this.evaluator.runAndForget(n,i,o);return this._exporter.exportScalarOrRange(a)}validateFormula(e){Ie(e,"string","formulaString");const{ast:r}=this.extractTemporaryFormula(e);return!(r===void 0||r.type===G.ERROR&&!r.error)}getRegisteredFunctionNames(){return Nn.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return Ie(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return Ie(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return Ie(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return Ie(e,"number","val"),rh(e)}on(e,r){this._emitter.on(e,r)}once(e,r){this._emitter.once(e,r)}off(e,r){this._emitter.off(e,r)}destroy(){Cut(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new Ree}extractTemporaryFormula(e,r=1){const n=this._cellContentParser.parse(e),i={sheet:r,col:0,row:0};if(!(n instanceof hr.Formula))return{address:i,dependencies:[]};const{ast:o,errors:a,dependencies:s}=this._parser.parse(n.formula,i);return a.length>0?{address:i,dependencies:[]}:{ast:o,address:i,dependencies:s}}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),r=Array.from(this.dependencyGraph.verticesToRecompute());this.dependencyGraph.clearRecentlyChangedVertices(),r.length>0&&e.addAll(this.evaluator.partialRun(r));const n=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(qo.ValuesUpdated,n),n}}}Nn.version="2.3.1";Nn.buildDate="03/03/2023 09:26:52";Nn.releaseDate="03/03/2023";Nn.languages={};Nn.registeredLanguages=new Map;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const JV=new WeakMap;class An{constructor(e={},r=!0){const{accentSensitive:n,binarySearchThreshold:i,caseSensitive:o,caseFirst:a,chooseAddressMappingPolicy:s,currencySymbol:l,dateFormats:u,decimalSeparator:c,evaluateNullToZero:f,functionArgSeparator:h,functionPlugins:d,ignorePunctuation:p,leapYear1900:m,localeLang:g,language:v,ignoreWhiteSpace:w,licenseKey:b,matchWholeCell:E,arrayColumnSeparator:A,arrayRowSeparator:M,maxRows:k,maxColumns:O,nullYear:x,nullDate:C,parseDateTime:I,precisionEpsilon:H,precisionRounding:j,stringifyDateTime:q,stringifyDuration:Z,smartRounding:ne,timeFormats:ie,thousandSeparator:P,useArrayArithmetic:y,useStats:R,undoLimit:_,useColumnIndex:$,useRegularExpressions:B,useWildcards:W}=e;r&&An.warnDeprecatedOptions(e),this.useArrayArithmetic=Vt(y,"boolean","useArrayArithmetic"),this.accentSensitive=Vt(n,"boolean","accentSensitive"),this.caseSensitive=Vt(o,"boolean","caseSensitive"),this.caseFirst=Vt(a,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=Vt(p,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=s!=null?s:An.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...sb(u,Array.isArray,"array","dateFormats")],this.timeFormats=[...sb(ie,Array.isArray,"array","timeFormats")],this.functionArgSeparator=Vt(h,"string","functionArgSeparator"),this.decimalSeparator=Vt(c,[".",","],"decimalSeparator"),this.language=Vt(v,"string","language"),this.ignoreWhiteSpace=Vt(w,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=Vt(b,"string","licenseKey"),this.thousandSeparator=Vt(P,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=Vt(A,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=Vt(M,[";","|"],"arrayRowSeparator"),this.localeLang=Vt(g,"string","localeLang"),this.functionPlugins=[...d!=null?d:An.defaultConfig.functionPlugins],this.smartRounding=Vt(ne,"boolean","smartRounding"),this.evaluateNullToZero=Vt(f,"boolean","evaluateNullToZero"),this.nullYear=Vt(x,"number","nullYear"),df(this.nullYear,"nullYear",0),olt(this.nullYear,"nullYear",100),this.precisionRounding=Vt(j,"number","precisionRounding"),df(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=Vt(H,"number","precisionEpsilon"),df(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=Vt($,"boolean","useColumnIndex"),this.useStats=Vt(R,"boolean","useStats"),this.binarySearchThreshold=i!=null?i:An.defaultConfig.binarySearchThreshold,this.parseDateTime=Vt(I,"function","parseDateTime"),this.stringifyDateTime=Vt(q,"function","stringifyDateTime"),this.stringifyDuration=Vt(Z,"function","stringifyDuration"),this.translationPackage=Nn.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=sb(C,pg,"IDate","nullDate"),this.leapYear1900=Vt(m,"boolean","leapYear1900"),this.undoLimit=Vt(_,"number","undoLimit"),this.useRegularExpressions=Vt(B,"boolean","useRegularExpressions"),this.useWildcards=Vt(W,"boolean","useWildcards"),this.matchWholeCell=Vt(E,"boolean","matchWholeCell"),df(this.undoLimit,"undoLimit",0),this.maxRows=Vt(k,"number","maxRows"),df(this.maxRows,"maxRows",1),this.maxColumns=Vt(O,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(l),df(this.maxColumns,"maxColumns",1),JV.set(this,{licenseKeyValidityState:Clt(this.licenseKey)}),HV({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),HV({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const r=[...sb(e,Array.isArray,"array","currencySymbol")];return r.forEach(n=>{if(typeof n!="string")throw new Bt("string[]","currencySymbol");if(n==="")throw new Cst("currencySymbol")}),r}get licenseKeyValidityState(){return JV.get(this).licenseKeyValidityState}getConfig(){return Kee(this)}mergeConfig(e){const r=Object.assign({},this.getConfig(),e);return An.warnDeprecatedOptions(e),new An(r,!1)}static warnDeprecatedOptions(e){An.warnDeprecatedIfUsed(e.binarySearchThreshold,"binarySearchThreshold","1.1")}static warnDeprecatedIfUsed(e,r,n,i){e!==void 0&&console.warn(i===void 0?`${r} option is deprecated since ${n}`:`${r} option is deprecated since ${n}, please use ${i}`)}}An.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",chooseAddressMappingPolicy:new hlt,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:alt,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:wlt,stringifyDuration:blt,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};function Kee(t){var e;const r={};for(const n in An.defaultConfig){const i=(e=t[n])!==null&&e!==void 0?e:An.defaultConfig[n];Array.isArray(i)?r[n]=[...i]:r[n]=i}return r}function Aut(){return Kee({})}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const jA={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class qee extends pt{arrayformula(e,r){return this.runFunction(e.args,r,this.metadata("ARRAYFORMULA"),n=>n)}arrayformulaArraySize(e,r){if(e.args.length!==1)return yt.error();const n=this.metadata("ARRAYFORMULA");return e.args.map(o=>{var a;return this.arraySizeForAst(o,new aa(r.formulaAddress,r.arraysFlag||((a=n==null?void 0:n.arrayFunction)!==null&&a!==void 0?a:!1)))})[0]}arrayconstrain(e,r){return this.runFunction(e.args,r,this.metadata("ARRAY_CONSTRAIN"),(n,i,o)=>{i=Math.min(i,n.height()),o=Math.min(o,n.width());const a=n.data,s=[];for(let l=0;l<i;l++)s.push(a[l].slice(0,o));return je.onlyValues(s)})}arrayconstrainArraySize(e,r){if(e.args.length!==3)return yt.error();const n=this.metadata("ARRAY_CONSTRAIN"),i=e.args.map(s=>{var l;return this.arraySizeForAst(s,new aa(r.formulaAddress,r.arraysFlag||((l=n==null?void 0:n.arrayFunction)!==null&&l!==void 0?l:!1)))});let{height:o,width:a}=i[0];return e.args[1].type===G.NUMBER&&(o=Math.min(o,e.args[1].value)),e.args[2].type===G.NUMBER&&(a=Math.min(a,e.args[2].value)),o<1||a<1||!Number.isInteger(o)||!Number.isInteger(a)?yt.error():new yt(a,o)}filter(e,r){return this.runFunction(e.args,r,this.metadata("FILTER"),(n,...i)=>{for(const s of i)if(n.width()!==s.width()||n.height()!==s.height())return new L(V.NA,Q.EqualLength);if(n.width()>1&&n.height()>1)return new L(V.NA,Q.WrongDimension);const o=n.data,a=[];for(let s=0;s<n.height();s++){const l=[];for(let u=0;u<n.width();u++){let c=!0;for(const f of i)if(Iee(f.data[s][u])!==!0){c=!1;break}c&&l.push(o[s][u])}l.length>0&&a.push(l)}return a.length>0?je.onlyValues(a):new L(V.NA,Q.EmptyRange)})}filterArraySize(e,r){if(e.args.length<=1)return yt.error();const n=this.metadata("FILTER"),i=e.args.map(s=>{var l;return this.arraySizeForAst(s,new aa(r.formulaAddress,r.arraysFlag||((l=n==null?void 0:n.arrayFunction)!==null&&l!==void 0?l:!1)))}),o=Math.max(...i.map(s=>s.width)),a=Math.max(...i.map(s=>s.height));return new yt(o,a)}}qee.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:S.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:S.RANGE},{argumentType:S.INTEGER,minValue:1},{argumentType:S.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Xee extends pt{abs(e,r){return this.runFunction(e.args,r,this.metadata("ABS"),Math.abs)}}Xee.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:S.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Iut=0xffffffffffff,ej=-53,tj=53;class Qee extends pt{bitlshift(e,r){return this.runFunction(e.args,r,this.metadata("BITLSHIFT"),Zee)}bitrshift(e,r){return this.runFunction(e.args,r,this.metadata("BITRSHIFT"),Jee)}}Qee.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:S.INTEGER,minValue:0},{argumentType:S.INTEGER,minValue:ej,maxValue:tj}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:S.INTEGER,minValue:0},{argumentType:S.INTEGER,minValue:ej,maxValue:tj}]}};function Zee(t,e){return e<0?Jee(t,-e):ete(t*Math.pow(2,e))}function Jee(t,e){return e<0?Zee(t,-e):ete(Math.floor(t/Math.pow(2,e)))}function ete(t){return t>Iut?new L(V.NUM,Q.BitshiftLong):t}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class tte extends pt{bitand(e,r){return this.runFunction(e.args,r,this.metadata("BITAND"),(n,i)=>n&i)}bitor(e,r){return this.runFunction(e.args,r,this.metadata("BITOR"),(n,i)=>n|i)}bitxor(e,r){return this.runFunction(e.args,r,this.metadata("BITXOR"),(n,i)=>n^i)}}tte.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:S.INTEGER,minValue:0},{argumentType:S.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:S.INTEGER,minValue:0},{argumentType:S.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:S.INTEGER,minValue:0},{argumentType:S.INTEGER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class rte extends pt{literalTrue(e,r){return this.runFunction(e.args,r,this.metadata("TRUE"),()=>!0)}literalFalse(e,r){return this.runFunction(e.args,r,this.metadata("FALSE"),()=>!1)}conditionalIf(e,r){return this.runFunction(e.args,r,this.metadata("IF"),(n,i,o)=>n?i:o)}and(e,r){return this.runFunction(e.args,r,this.metadata("AND"),(...n)=>n.filter(i=>i!==void 0).every(i=>!!i))}or(e,r){return this.runFunction(e.args,r,this.metadata("OR"),(...n)=>n.filter(i=>i!==void 0).some(i=>i))}not(e,r){return this.runFunction(e.args,r,this.metadata("NOT"),n=>!n)}xor(e,r){return this.runFunction(e.args,r,this.metadata("XOR"),(...n)=>{let i=0;return n.filter(o=>o!==void 0).forEach(o=>{o&&i++}),i%2===1})}switch(e,r){return this.runFunction(e.args,r,this.metadata("SWITCH"),(n,...i)=>{const o=i.length;let a=0;for(;a+1<o;a+=2)if(!(i[a]instanceof L)&&this.arithmeticHelper.eq(n,i[a]))return i[a+1];return a<o?i[a]:new L(V.NA,Q.NoDefault)})}iferror(e,r){return this.runFunction(e.args,r,this.metadata("IFERROR"),(n,i)=>n instanceof L?i:n)}ifna(e,r){return this.runFunction(e.args,r,this.metadata("IFNA"),(n,i)=>n instanceof L&&n.type===V.NA?i:n)}choose(e,r){return this.runFunction(e.args,r,this.metadata("CHOOSE"),(n,...i)=>n>i.length?new L(V.NUM,Q.Selector):i[n-1])}}rte.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:S.BOOLEAN},{argumentType:S.SCALAR,passSubtype:!0},{argumentType:S.SCALAR,defaultValue:!1,passSubtype:!0}]},AND:{method:"and",parameters:[{argumentType:S.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:S.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:S.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:S.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:S.NOERROR},{argumentType:S.SCALAR,passSubtype:!0},{argumentType:S.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:S.SCALAR,passSubtype:!0},{argumentType:S.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:S.SCALAR,passSubtype:!0},{argumentType:S.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:S.INTEGER,minValue:1},{argumentType:S.SCALAR,passSubtype:!0}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class nte extends pt{char(e,r){return this.runFunction(e.args,r,this.metadata("CHAR"),n=>n<1||n>=256?new L(V.VALUE,Q.CharacterCodeBounds):String.fromCharCode(Math.trunc(n)))}unichar(e,r){return this.runFunction(e.args,r,this.metadata("CHAR"),n=>n<1||n>=1114112?new L(V.VALUE,Q.CharacterCodeBounds):String.fromCodePoint(Math.trunc(n)))}}nte.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:S.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:S.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ite extends pt{code(e,r){return this.runFunction(e.args,r,this.metadata("CODE"),n=>n.length===0?new L(V.VALUE,Q.EmptyString):n.charCodeAt(0))}unicode(e,r){return this.runFunction(e.args,r,this.metadata("UNICODE"),n=>{var i;return(i=n.codePointAt(0))!==null&&i!==void 0?i:new L(V.VALUE,Q.EmptyString)})}}ite.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:S.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:S.STRING}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ote extends pt{countblank(e,r){return this.runFunction(e.args,r,this.metadata("COUNTBLANK"),(...n)=>{let i=0;return n.forEach(o=>{o===Tt&&i++}),i})}}ote.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:S.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ate extends pt{countunique(e,r){return this.runFunction(e.args,r,this.metadata("COUNTUNIQUE"),(...n)=>{const i=new Set,o=new Set;for(const a of n)a instanceof L?o.add(a.type):a!==""&&i.add(a);return i.size+o.size})}}ate.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:S.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ste extends pt{constructor(){super(...arguments),this.isoweeknumCore=e=>{const r=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),n=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.dateToNumber({year:n.year,month:1,day:1}),o=this.dateTimeHelper.relativeNumberToAbsoluteNumber(i),a=o+((4-o)%7+7)%7,s=Math.floor((r-1)/7)-Math.floor((a-1)/7)+1;return s===0?this.isoweeknumCore(e-7)+1:s},this.days360Core=(e,r,n)=>{const i=this.dateTimeHelper.numberToSimpleDate(e),o=this.dateTimeHelper.numberToSimpleDate(r);let a,s;return n?(a=jV(i),s=jV(o)):[a,s]=this.dateTimeHelper.toBasisUS(i,o),360*(s.year-a.year)+30*(s.month-a.month)+s.day-a.day}}date(e,r){return this.runFunction(e.args,r,this.metadata("DATE"),(n,i,o)=>{const a=Math.trunc(o);let s=Math.trunc(i),l=Math.trunc(n);l<this.dateTimeHelper.getEpochYearZero()&&(l+=this.dateTimeHelper.getEpochYearZero());const u=Math.floor((s-1)/12);l+=u,s-=u*12;const c={year:l,month:s,day:1};if(this.dateTimeHelper.isValidDate(c)){let f=this.dateTimeHelper.dateToNumber(c)+(a-1);return f=this.dateTimeHelper.getWithinBounds(f),f===void 0?new L(V.NUM,Q.DateBounds):f}return new L(V.VALUE,Q.InvalidDate)})}time(e,r){return this.runFunction(e.args,r,this.metadata("TIME"),(n,i,o)=>{const a=nh({hours:Math.trunc(n),minutes:Math.trunc(i),seconds:Math.trunc(o)});return a<0?new L(V.NUM,Q.NegativeTime):a%1})}eomonth(e,r){return this.runFunction(e.args,r,this.metadata("EOMONTH"),(n,i)=>{const o=this.dateTimeHelper.numberToSimpleDate(n);let a=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(VV(o,i)));return a=this.dateTimeHelper.getWithinBounds(a),a===void 0?new L(V.NUM,Q.DateBounds):a})}day(e,r){return this.runFunction(e.args,r,this.metadata("DAY"),n=>this.dateTimeHelper.numberToSimpleDate(n).day)}days(e,r){return this.runFunction(e.args,r,this.metadata("DAYS"),(n,i)=>Math.trunc(n)-Math.trunc(i))}month(e,r){return this.runFunction(e.args,r,this.metadata("MONTH"),n=>this.dateTimeHelper.numberToSimpleDate(n).month)}year(e,r){return this.runFunction(e.args,r,this.metadata("YEAR"),n=>this.dateTimeHelper.numberToSimpleDate(n).year)}hour(e,r){return this.runFunction(e.args,r,this.metadata("HOUR"),n=>rh(GC(n)%1).hours)}minute(e,r){return this.runFunction(e.args,r,this.metadata("MINUTE"),n=>rh(GC(n)%1).minutes)}second(e,r){return this.runFunction(e.args,r,this.metadata("SECOND"),n=>rh(GC(n)%1).seconds)}text(e,r){return this.runFunction(e.args,r,this.metadata("TEXT"),(n,i)=>glt(n,i,this.config,this.dateTimeHelper))}weekday(e,r){return this.runFunction(e.args,r,this.metadata("WEEKDAY"),(n,i)=>{const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(n));if(i===3)return(o-1)%7;const a=ij.get(i);return a===void 0?new L(V.NUM,Q.BadMode):(o-a)%7+1})}weeknum(e,r){return this.runFunction(e.args,r,this.metadata("WEEKNUM"),(n,i)=>{const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(n)),a=this.dateTimeHelper.numberToSimpleDate(n),s=this.dateTimeHelper.dateToNumber({year:a.year,month:1,day:1}),l=this.dateTimeHelper.relativeNumberToAbsoluteNumber(s);if(i===21)return this.isoweeknumCore(n);const u=ij.get(i);return u===void 0?new L(V.NUM,Q.BadMode):Math.floor((o-u)/7)-Math.floor((l-u)/7)+1})}isoweeknum(e,r){return this.runFunction(e.args,r,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,r){return this.runFunction(e.args,r,this.metadata("DATEVALUE"),n=>{const{dateTime:i}=this.dateTimeHelper.parseDateTimeFromConfigFormats(n);return i===void 0?new L(V.VALUE,Q.IncorrectDateTime):pg(i)?(kee(i)?Math.trunc(nh(i)):0)+this.dateTimeHelper.dateToNumber(i):0})}timevalue(e,r){return this.runFunction(e.args,r,this.metadata("TIMEVALUE"),n=>{const i=this.dateTimeHelper.dateStringToDateNumber(n);return i===void 0?new L(V.VALUE,Q.IncorrectDateTime):Ne(i)%1})}now(e,r){return this.runFunction(e.args,r,this.metadata("NOW"),()=>{const n=new Date(Date.now());return nh({hours:n.getHours(),minutes:n.getMinutes(),seconds:n.getSeconds()})+this.dateTimeHelper.dateToNumber({year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()})})}today(e,r){return this.runFunction(e.args,r,this.metadata("TODAY"),()=>{const n=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()})})}edate(e,r){return this.runFunction(e.args,r,this.metadata("EDATE"),(n,i)=>{const o=this.dateTimeHelper.numberToSimpleDate(n),a=clt(VV(o,i));let s=this.dateTimeHelper.dateToNumber(a);return s=this.dateTimeHelper.getWithinBounds(s),s===void 0?new L(V.NUM,Q.DateBounds):s})}datedif(e,r){return this.runFunction(e.args,r,this.metadata("DATEDIF"),(n,i,o)=>{if(n>i)return new L(V.NUM,Q.StartEndDate);if(o==="D")return Math.floor(i)-Math.floor(n);const a=this.dateTimeHelper.numberToSimpleDate(n),s=this.dateTimeHelper.numberToSimpleDate(i);switch(o){case"M":return(s.year-a.year)*12+(s.month-a.month)-(s.day<a.day?1:0);case"YM":return(12+(s.month-a.month)-(s.day<a.day?1:0))%12;case"Y":return s.month>a.month||s.month===a.month&&s.day>=a.day?s.year-a.year:s.year-a.year-1;case"MD":if(s.day>=a.day)return s.day-a.day;{const l=s.month===1?12:s.month-1,u=s.month===1?s.year-1:s.year;return this.dateTimeHelper.daysInMonth(u,l)+s.day-a.day}case"YD":return s.month>a.month||s.month===a.month&&s.day>=a.day?Math.floor(i)-this.dateTimeHelper.dateToNumber({year:s.year,month:a.month,day:a.day}):Math.floor(i)-Math.floor(n)-365*(s.year-a.year-1)-this.dateTimeHelper.leapYearsCount(s.year-1)+this.dateTimeHelper.leapYearsCount(a.year);default:return new L(V.NUM,Q.BadMode)}})}days360(e,r){return this.runFunction(e.args,r,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,r){return this.runFunction(e.args,r,this.metadata("YEARFRAC"),(n,i,o)=>{switch(n=Math.trunc(n),i=Math.trunc(i),n>i&&([n,i]=[i,n]),o){case 0:return this.days360Core(n,i,!1)/360;case 1:return(i-n)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(n),this.dateTimeHelper.numberToSimpleDate(i));case 2:return(i-n)/360;case 3:return(i-n)/365;case 4:return this.days360Core(n,i,!0)/360}throw new Error("Should not be reachable.")})}interval(e,r){return this.runFunction(e.args,r,this.metadata("INTERVAL"),n=>{n=Math.trunc(n);const i=n%60;n=Math.trunc(n/60);const o=n%60;n=Math.trunc(n/60);const a=n%24;n=Math.trunc(n/24);const s=n%30;n=Math.trunc(n/30);const l=n%12,u=Math.trunc(n/12);return"P"+(u>0?u+"Y":"")+(l>0?l+"M":"")+(s>0?s+"D":"")+"T"+(a>0?a+"H":"")+(o>0?o+"M":"")+(i>0?i+"S":"")})}networkdays(e,r){return this.runFunction(e.args,r,this.metadata("NETWORKDAYS"),(n,i,o)=>this.networkdayscore(n,i,1,o))}networkdaysintl(e,r){return this.runFunction(e.args,r,this.metadata("NETWORKDAYS.INTL"),(n,i,o,a)=>this.networkdayscore(n,i,o,a))}workday(e,r){return this.runFunction(e.args,r,this.metadata("WORKDAY"),(n,i,o)=>this.workdaycore(n,i,1,o))}workdayintl(e,r){return this.runFunction(e.args,r,this.metadata("WORKDAY.INTL"),(n,i,o,a)=>this.workdaycore(n,i,o,a))}networkdayscore(e,r,n,i){e=Math.trunc(e),r=Math.trunc(r);let o=1;e>r&&([e,r]=[r,e],o=-1);const a=nj(n);if(a instanceof L)return a;const s=this.simpleRangeToFilteredHolidays(a,i);return s instanceof L?s:o*this.countWorkdays(e,r,a,s)}workdaycore(e,r,n,i){e=Math.trunc(e),r=Math.trunc(r);const o=nj(n);if(o instanceof L)return o;const a=this.simpleRangeToFilteredHolidays(o,i);if(a instanceof L)return a;if(r>0){let s=1;for(;this.countWorkdays(e+1,e+s,o,a)<r;)s*=2;let l=1;for(;l+1<s;){const u=Math.trunc((l+s)/2);this.countWorkdays(e+1,e+u,o,a)<r?l=u:s=u}return e+s}else if(r<0){r*=-1;let s=1;for(;this.countWorkdays(e-s,e-1,o,a)<r;)s*=2;let l=1;for(;l+1<s;){const u=Math.trunc((l+s)/2);this.countWorkdays(e-u,e-1,o,a)<r?l=u:s=u}return e-s}else return e}countWorkdays(e,r,n,i){const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(r)),a=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let s=0;for(let l=0;l<7;l++)n.charAt(l)==="0"&&(s+=Math.floor((o+6-l)/7),s-=Math.floor((a-1+6-l)/7));return s-=rj(r+1,i)-rj(e,i),s}simpleRangeToFilteredHolidays(e,r){var n;const i=(n=r==null?void 0:r.valuesFromTopLeftCorner())!==null&&n!==void 0?n:[];for(const a of i)if(a instanceof L)return a;const o=[];for(const a of i)if(a!==Tt)if(Ft(a))o.push(Math.trunc(Ne(a)));else return new L(V.VALUE,Q.WrongType);return[...new Set(o)].sort((a,s)=>a-s).filter(a=>{const l=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(a)-1)%7;return e.charAt(l)==="0"})}}ste.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER}],returnNumberType:Be.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER}],returnNumberType:Be.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:S.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:S.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:S.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:S.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:S.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:S.NUMBER},{argumentType:S.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER}],returnNumberType:Be.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:S.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:S.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:S.STRING}],returnNumberType:Be.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:S.STRING}],returnNumberType:Be.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:Be.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:Be.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER}],returnNumberType:Be.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:0},{argumentType:S.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:0},{argumentType:S.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:0},{argumentType:S.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:S.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:0},{argumentType:S.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:0},{argumentType:S.NOERROR,defaultValue:1},{argumentType:S.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER},{argumentType:S.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER},{argumentType:S.NOERROR,defaultValue:1},{argumentType:S.RANGE,optionalArg:!0}]}};function rj(t,e){if(e.length===0||t<=e[0])return 0;if(e[e.length-1]<t)return e.length;let r=0,n=e.length-1;for(;r+1<n;){const i=Math.floor((n+r)/2);e[i]>=t?n=i:r=i}return n}function nj(t){var e;return typeof t!="number"&&typeof t!="string"?new L(V.VALUE,Q.WrongType):typeof t=="string"?t.length!==7||!/^(0|1)*$/.test(t)||t==="1111111"?new L(V.NUM,Q.WeekendString):t:(e=xut.get(t))!==null&&e!==void 0?e:new L(V.NUM,Q.BadMode)}const ij=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),xut=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class lte extends pt{degrees(e,r){return this.runFunction(e.args,r,this.metadata("DEGREES"),n=>n*(180/Math.PI))}}lte.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:S.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ute extends pt{delta(e,r){return this.runFunction(e.args,r,this.metadata("DELTA"),(n,i)=>n===i?1:0)}}ute.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,defaultValue:0}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class cte extends pt{exp(e,r){return this.runFunction(e.args,r,this.metadata("EXP"),Math.exp)}}cte.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:S.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class fte extends pt{pmt(e,r){return this.runFunction(e.args,r,this.metadata("PMT"),Wx)}ipmt(e,r){return this.runFunction(e.args,r,this.metadata("IPMT"),WA)}ppmt(e,r){return this.runFunction(e.args,r,this.metadata("PPMT"),oj)}fv(e,r){return this.runFunction(e.args,r,this.metadata("FV"),zA)}cumipmt(e,r){return this.runFunction(e.args,r,this.metadata("CUMIPMT"),(n,i,o,a,s,l)=>{if(a>s)return new L(V.NUM,Q.EndStartPeriod);let u=0;for(let c=a;c<=s;c++)u+=WA(n,c,i,o,0,l);return u})}cumprinc(e,r){return this.runFunction(e.args,r,this.metadata("CUMPRINC"),(n,i,o,a,s,l)=>{if(a>s)return new L(V.NUM,Q.EndStartPeriod);let u=0;for(let c=a;c<=s;c++)u+=oj(n,c,i,o,0,l);return u})}db(e,r){return this.runFunction(e.args,r,this.metadata("DB"),(n,i,o,a,s)=>{if(s===12&&a>o||a>o+1)return new L(V.NUM,Q.PeriodLong);if(i>=n)return 0;const l=Math.round((1-Math.pow(i/n,1/o))*1e3)/1e3,u=n*l*s/12;if(a===1)return u;let c=u;for(let f=0;f<a-2;f++)c+=(n-c)*l;return a===o+1?(n-c)*l*(12-s)/12:(n-c)*l})}ddb(e,r){return this.runFunction(e.args,r,this.metadata("DDB"),(n,i,o,a,s)=>{if(a>o)return new L(V.NUM);let l=s/o,u;l>=1?(l=1,a===1?u=n:u=0):u=n*Math.pow(1-l,a-1);const c=n*Math.pow(1-l,a);return Math.max(u-Math.max(i,c),0)})}dollarde(e,r){return this.runFunction(e.args,r,this.metadata("DOLLARDE"),(n,i)=>{if(i<1)return new L(V.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(n)+(n-Math.trunc(n))*10/i})}dollarfr(e,r){return this.runFunction(e.args,r,this.metadata("DOLLARFR"),(n,i)=>{if(i<1)return new L(V.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(n)+(n-Math.trunc(n))*i/10})}effect(e,r){return this.runFunction(e.args,r,this.metadata("EFFECT"),(n,i)=>(i=Math.trunc(i),Math.pow(1+n/i,i)-1))}ispmt(e,r){return this.runFunction(e.args,r,this.metadata("ISPMT"),(n,i,o,a)=>o===0?new L(V.DIV_BY_ZERO):a*n*(i/o-1))}nominal(e,r){return this.runFunction(e.args,r,this.metadata("NOMINAL"),(n,i)=>(i=Math.trunc(i),(Math.pow(n+1,1/i)-1)*i))}nper(e,r){return this.runFunction(e.args,r,this.metadata("NPER"),(n,i,o,a,s)=>n===0?i===0?new L(V.DIV_BY_ZERO):(-o-a)/i:(s&&(i*=1+n),Math.log((i-a*n)/(o*n+i))/Math.log(1+n)))}rate(e,r){return this.runFunction(e.args,r,this.metadata("RATE"),(n,i,o,a,s,l)=>{if(l<=-1)return new L(V.VALUE);const u=1e-7,c=50;let f=l;s=s?1:0;for(let h=0;h<c;h++){if(f<=-1)return new L(V.NUM);let d;if(Math.abs(f)<u)d=o*(1+n*f)+i*(1+f*s)*n+a;else{const m=Math.pow(1+f,n);d=o*m+i*(1/f+s)*(m-1)+a}if(Math.abs(d)<u)return f;let p;if(Math.abs(f)<u)p=o*n+i*s*n;else{const m=Math.pow(1+f,n),g=n*Math.pow(1+f,n-1);p=o*g+i*(1/f+s)*g+i*(-1/(f*f))*(m-1)}f-=d/p}return new L(V.NUM)})}pv(e,r){return this.runFunction(e.args,r,this.metadata("PV"),(n,i,o,a,s)=>(s=s?1:0,n===-1?i===0?new L(V.NUM):new L(V.DIV_BY_ZERO):n===0?-o*i-a:((1-Math.pow(1+n,i))*o*(1+n*s)/n-a)/Math.pow(1+n,i)))}rri(e,r){return this.runFunction(e.args,r,this.metadata("RRI"),(n,i,o)=>i===0||o<0&&i>0||o>0&&i<0?new L(V.NUM):Math.pow(o/i,1/n)-1)}sln(e,r){return this.runFunction(e.args,r,this.metadata("SLN"),(n,i,o)=>o===0?new L(V.DIV_BY_ZERO):(n-i)/o)}syd(e,r){return this.runFunction(e.args,r,this.metadata("SYD"),(n,i,o,a)=>a>o?new L(V.NUM):(n-i)*(o-a+1)*2/(o*(o+1)))}tbilleq(e,r){return this.runFunction(e.args,r,this.metadata("TBILLEQ"),(n,i,o)=>{if(n=Math.round(n),i=Math.round(i),n>=i)return new L(V.NUM);const a=this.dateTimeHelper.numberToSimpleDate(n),s=this.dateTimeHelper.numberToSimpleDate(i);if(s.year>a.year+1||s.year===a.year+1&&(s.month>a.month||s.month===a.month&&s.day>a.day))return new L(V.NUM);const l=360-o*(i-n);return l===0?0:l<0?new L(V.NUM):365*o/l})}tbillprice(e,r){return this.runFunction(e.args,r,this.metadata("TBILLPRICE"),(n,i,o)=>{if(n=Math.round(n),i=Math.round(i),n>=i)return new L(V.NUM);const a=this.dateTimeHelper.numberToSimpleDate(n),s=this.dateTimeHelper.numberToSimpleDate(i);if(s.year>a.year+1||s.year===a.year+1&&(s.month>a.month||s.month===a.month&&s.day>a.day))return new L(V.NUM);const l=360-o*(i-n);return l===0?0:l<0?new L(V.NUM):100*(1-o*(i-n)/360)})}tbillyield(e,r){return this.runFunction(e.args,r,this.metadata("TBILLYIELD"),(n,i,o)=>{if(n=Math.round(n),i=Math.round(i),n>=i)return new L(V.NUM);const a=this.dateTimeHelper.numberToSimpleDate(n),s=this.dateTimeHelper.numberToSimpleDate(i);return s.year>a.year+1||s.year===a.year+1&&(s.month>a.month||s.month===a.month&&s.day>a.day)?new L(V.NUM):(100-o)*360/(o*(i-n))})}fvschedule(e,r){return this.runFunction(e.args,r,this.metadata("FVSCHEDULE"),(n,i)=>{const o=i.valuesFromTopLeftCorner();for(const a of o)if(a instanceof L)return a;for(const a of o)if(Ft(a))n*=1+Ne(a);else if(a!==Tt)return new L(V.VALUE,Q.NumberExpected);return n})}npv(e,r){return this.runFunction(e.args,r,this.metadata("NPV"),(n,...i)=>{const o=this.arithmeticHelper.coerceNumbersExactRanges(i);return o instanceof L?o:qC(n,o)})}mirr(e,r){return this.runFunction(e.args,r,this.metadata("MIRR"),(n,i,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());if(a instanceof L)return a;let s=!1,l=!1;const u=[],c=[];for(const p of a)p>0?(s=!0,u.push(p),c.push(0)):p<0?(l=!0,c.push(p),u.push(0)):(c.push(0),u.push(0));if(!s||!l)return new L(V.DIV_BY_ZERO);const f=a.length,h=qC(o,u);if(h instanceof L)return h;const d=qC(i,c);return d instanceof L?d:Math.pow(-h*Math.pow(1+o,f)/d/(1+i),1/(f-1))-1})}pduration(e,r){return this.runFunction(e.args,r,this.metadata("PDURATION"),(n,i,o)=>(Math.log(o)-Math.log(i))/Math.log(1+n))}xnpv(e,r){return this.runFunction(e.args,r,this.metadata("XNPV"),(n,i,o)=>{const a=i.valuesFromTopLeftCorner();for(const h of a)if(typeof h!="number")return new L(V.VALUE,Q.NumberExpected);const s=a,l=o.valuesFromTopLeftCorner();for(const h of l)if(typeof h!="number")return new L(V.VALUE,Q.NumberExpected);const u=l;if(u.length!==s.length)return new L(V.NUM,Q.EqualLength);const c=u.length;let f=0;if(u[0]<0)return new L(V.NUM,Q.ValueSmall);for(let h=0;h<c;h++){if(u[h]=Math.floor(u[h]),u[h]<u[0])return new L(V.NUM,Q.ValueSmall);f+=s[h]/Math.pow(1+n,(u[h]-u[0])/365)}return f})}}fte.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER,defaultValue:0},{argumentType:S.NUMBER,defaultValue:0}],returnNumberType:Be.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER,defaultValue:0},{argumentType:S.NUMBER,defaultValue:0}],returnNumberType:Be.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER,defaultValue:0},{argumentType:S.NUMBER,defaultValue:0}],returnNumberType:Be.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER,defaultValue:0},{argumentType:S.NUMBER,defaultValue:0}],returnNumberType:Be.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.INTEGER,minValue:1},{argumentType:S.INTEGER,minValue:1},{argumentType:S.INTEGER,minValue:0,maxValue:1}],returnNumberType:Be.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.INTEGER,minValue:1},{argumentType:S.INTEGER,minValue:1},{argumentType:S.INTEGER,minValue:0,maxValue:1}],returnNumberType:Be.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:0},{argumentType:S.INTEGER,minValue:0},{argumentType:S.INTEGER,minValue:0},{argumentType:S.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:Be.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:0},{argumentType:S.INTEGER,minValue:0},{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:Be.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:1}],returnNumberType:Be.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:1}],returnNumberType:Be.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER,defaultValue:0},{argumentType:S.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER,defaultValue:0},{argumentType:S.NUMBER,defaultValue:0}],returnNumberType:Be.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER,defaultValue:0},{argumentType:S.NUMBER,defaultValue:0},{argumentType:S.NUMBER,defaultValue:.1}],returnNumberType:Be.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER},{argumentType:S.NUMBER}],returnNumberType:Be.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER}],returnNumberType:Be.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,greaterThan:0}],returnNumberType:Be.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,greaterThan:0}],returnNumberType:Be.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,greaterThan:0}],returnNumberType:Be.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,greaterThan:0}],returnNumberType:Be.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:S.NUMBER},{argumentType:S.RANGE}],returnNumberType:Be.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:S.NUMBER},{argumentType:S.ANY}],repeatLastArgs:1,returnNumberType:Be.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:S.RANGE},{argumentType:S.NUMBER},{argumentType:S.NUMBER}],returnNumberType:Be.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:S.NUMBER,greaterThan:-1},{argumentType:S.RANGE},{argumentType:S.RANGE}]}};function Wx(t,e,r,n,i){if(t===0)return(-r-n)/e;{const o=Math.pow(1+t,e);return(n*t+r*t*o)*(i?1/(1+t):1)/(1-o)}}function WA(t,e,r,n,i,o){const a=Wx(t,r,n,i,o);return e===1?t*(o?0:-n):t*(o?zA(t,e-2,a,n,o)-a:zA(t,e-1,a,n,o))}function zA(t,e,r,n,i){if(t===0)return-n-r*e;{const o=Math.pow(1+t,e);return r*(i?1+t:1)*(1-o)/t-n*o}}function oj(t,e,r,n,i,o){return Wx(t,r,n,i,o)-WA(t,e,r,n,i,o)}function qC(t,e){let r=0;for(let n=e.length-1;n>=0;n--){if(r+=e[n],t===-1){if(r===0)continue;return new L(V.DIV_BY_ZERO)}r/=1+t}return r}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class hte extends pt{formulatext(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("FORMULATEXT"),()=>new L(V.NA,Q.WrongArgNumber),n=>{var i;return(i=this.serialization.getCellFormula(n))!==null&&i!==void 0?i:new L(V.NA,Q.Formula)})}}hte.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:S.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class dte extends pt{isbinary(e,r){return this.runFunction(e.args,r,this.metadata("ISBINARY"),n=>/^[01]{1,10}$/.test(n))}iserr(e,r){return this.runFunction(e.args,r,this.metadata("ISERR"),n=>n instanceof L&&n.type!==V.NA)}iserror(e,r){return this.runFunction(e.args,r,this.metadata("ISERROR"),n=>n instanceof L)}isformula(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("ISFORMULA"),()=>new L(V.NA,Q.WrongArgNumber),n=>this.dependencyGraph.addressMapping.getCell(n)instanceof Mi)}isblank(e,r){return this.runFunction(e.args,r,this.metadata("ISBLANK"),n=>n===Tt)}isna(e,r){return this.runFunction(e.args,r,this.metadata("ISNA"),n=>n instanceof L&&n.type==V.NA)}isnumber(e,r){return this.runFunction(e.args,r,this.metadata("ISNUMBER"),Ft)}islogical(e,r){return this.runFunction(e.args,r,this.metadata("ISLOGICAL"),n=>typeof n=="boolean")}isref(e,r){return this.runFunction(e.args,r,this.metadata("ISREF"),n=>n instanceof L&&(n.type==V.REF||n.type==V.CYCLE))}istext(e,r){return this.runFunction(e.args,r,this.metadata("ISTEXT"),n=>typeof n=="string")}isnontext(e,r){return this.runFunction(e.args,r,this.metadata("ISNONTEXT"),n=>typeof n!="string")}column(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("COLUMN"),()=>r.formulaAddress.col+1,n=>n.col+1)}columns(e,r){if(e.args.length!==1)return new L(V.NA,Q.WrongArgNumber);if(e.args.some(i=>i.type===G.EMPTY))return new L(V.NUM,Q.EmptyArg);let n=e.args[0];for(;n.type===G.PARENTHESIS;)n=n.expression;if(n.type===G.CELL_RANGE||n.type===G.COLUMN_RANGE)return n.end.col-n.start.col+1;if(n.type===G.CELL_REFERENCE)return 1;if(n.type===G.ROW_RANGE)return this.config.maxColumns;{const i=this.evaluateAst(n,r);return i instanceof je?i.width():i instanceof L?i:1}}row(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("ROW"),()=>r.formulaAddress.row+1,n=>n.row+1)}rows(e,r){if(e.args.length!==1)return new L(V.NA,Q.WrongArgNumber);if(e.args.some(i=>i.type===G.EMPTY))return new L(V.NUM,Q.EmptyArg);let n=e.args[0];for(;n.type===G.PARENTHESIS;)n=n.expression;if(n.type===G.CELL_RANGE||n.type===G.ROW_RANGE)return n.end.row-n.start.row+1;if(n.type===G.CELL_REFERENCE)return 1;if(n.type===G.COLUMN_RANGE)return this.config.maxRows;{const i=this.evaluateAst(n,r);return i instanceof je?i.height():i instanceof L?i:1}}index(e,r){return this.runFunction(e.args,r,this.metadata("INDEX"),(n,i,o)=>{var a,s,l,u,c,f;return o<1||i<1?new L(V.VALUE,Q.LessThanOne):o>n.width()||i>n.height()?new L(V.NUM,Q.ValueLarge):(f=(l=(s=(a=n==null?void 0:n.data)===null||a===void 0?void 0:a[i-1])===null||s===void 0?void 0:s[o-1])!==null&&l!==void 0?l:(c=(u=n==null?void 0:n.data)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c[0])!==null&&f!==void 0?f:new L(V.VALUE,Q.CellRangeExpected)})}na(e,r){return new L(V.NA)}sheet(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("SHEET"),()=>r.formulaAddress.sheet+1,n=>n.sheet+1,n=>{const i=this.dependencyGraph.sheetMapping.get(n);return i!==void 0?i+1:new L(V.NA,Q.SheetRef)})}sheets(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new L(V.VALUE,Q.CellRefExpected))}}dte.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:S.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:S.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:S.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:S.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:S.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:S.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:S.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:S.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:S.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:S.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:S.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:S.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:S.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:S.RANGE},{argumentType:S.NUMBER},{argumentType:S.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:S.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:S.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:S.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:S.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class pte extends pt{iseven(e,r){return this.runFunction(e.args,r,this.metadata("ISEVEN"),n=>n%2===0)}}pte.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:S.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class mte extends pt{isodd(e,r){return this.runFunction(e.args,r,this.metadata("ISODD"),n=>n%2===1)}}mte.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:S.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class gte extends pt{log10(e,r){return this.runFunction(e.args,r,this.metadata("LOG10"),Math.log10)}log(e,r){return this.runFunction(e.args,r,this.metadata("LOG"),(n,i)=>Math.log(n)/Math.log(i))}ln(e,r){return this.runFunction(e.args,r,this.metadata("LN"),Math.log)}}gte.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:S.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:S.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const GA=parseFloat(Math.PI.toFixed(14));class yte extends pt{pi(e,r){return this.runFunction(e.args,r,this.metadata("PI"),()=>GA)}sqrtpi(e,r){return this.runFunction(e.args,r,this.metadata("SQRTPI"),n=>Math.sqrt(GA*n))}}yte.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:S.NUMBER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function aj(t,e){return new yt(e.width,t.height)}function XC(t,e,r){return new yt(1+(t.width-e)/r,1+(t.height-e)/r)}class vte extends pt{mmult(e,r){return this.runFunction(e.args,r,this.metadata("MMULT"),(n,i)=>{if(!n.hasOnlyNumbers()||!i.hasOnlyNumbers())return new L(V.VALUE,Q.NumberRange);if(i.height()!==n.width())return new L(V.VALUE,Q.ArrayDimensions);const o=aj(n.size,i.size),a=this.createKernel(function(s,l,u){let c=0;for(let f=0;f<u;++f)c+=s[this.thread.y][f]*l[f][this.thread.x];return c},o)(n.rawNumbers(),i.rawNumbers(),n.width());return je.onlyNumbers(a)})}mmultArraySize(e,r){if(e.args.length!==2)return yt.error();const n=this.metadata("MMULT"),i=e.args.map(s=>{var l;return this.arraySizeForAst(s,new aa(r.formulaAddress,r.arraysFlag||((l=n==null?void 0:n.arrayFunction)!==null&&l!==void 0?l:!1)))}),[o,a]=i;return aj(o,a)}maxpool(e,r){return this.runFunction(e.args,r,this.metadata("MAXPOOL"),(n,i,o=i)=>{if(!n.hasOnlyNumbers())return new L(V.VALUE,Q.NumberRange);const a=XC(n.size,i,o),s=this.createKernel(function(l,u,c){const f=this.thread.x*c,h=this.thread.y*c;let d=l[h][f];for(let p=0;p<u;p++)for(let m=0;m<u;m++)d=Math.max(d,l[h+p][f+m]);return d},a)(n.rawNumbers(),i,o);return je.onlyNumbers(s)})}medianpool(e,r){return this.runFunction(e.args,r,this.metadata("MEDIANPOOL"),(n,i,o=i)=>{if(!n.hasOnlyNumbers())return new L(V.VALUE,Q.NumberRange);const a=XC(n.size,i,o),s=this.createKernel(function(l,u,c){const f=this.thread.x*c,h=this.thread.y*c;let d=l[h][f];for(let b=0;b<u;b++)for(let E=0;E<u;E++)d=Math.max(d,l[h+b][f+E]);let p=l[h][f];for(let b=0;b<u;b++)for(let E=0;E<u;E++)p=Math.min(p,l[h+b][f+E]);const m=u*u;let g=p,v=d,w=42;for(let b=0;b<32;b++){const E=(g+v)/2;let A=0;for(let M=0;M<u;M++)for(let k=0;k<u;k++)l[h+M][f+k]>E&&A++;if(u%2===0)if(A===m/2){w=E;break}else A>m/2?g=E:v=E;else if(A===(m-1)/2){w=E;break}else A>(m-1)/2?g=E:v=E}return w},a)(n.rawNumbers(),i,o);return je.onlyNumbers(s)})}maxpoolArraySize(e,r){if(e.args.length<2||e.args.length>3)return yt.error();const n=this.metadata("MAXPOOL"),o=e.args.map(u=>{var c;return this.arraySizeForAst(u,new aa(r.formulaAddress,r.arraysFlag||((c=n==null?void 0:n.arrayFunction)!==null&&c!==void 0?c:!1)))})[0],a=e.args[1];let s;a.type===G.NUMBER?s=a.value:s=1;let l=s;if(e.args.length===3){const u=e.args[2];u.type===G.NUMBER?l=u.value:l=1}return s>o.width||s>o.height||l>s||(o.width-s)%l!==0||(o.height-s)%l!==0?yt.error():XC(o,s,l)}medianpoolArraySize(e,r){return this.maxpoolArraySize(e,r)}transpose(e,r){return this.runFunction(e.args,r,this.metadata("TRANSPOSE"),n=>{const i=n.rawData(),o=n.size,a=[];for(let s=0;s<o.width;++s){a[s]=[];for(let l=0;l<o.height;++l)a[s][l]=i[l][s]}return je.onlyValues(a)})}transposeArraySize(e,r){if(e.args.length!==1)return yt.error();const n=this.metadata("MMULT"),i=e.args.map(a=>{var s;return this.arraySizeForAst(a,new aa(r.formulaAddress,r.arraysFlag||((s=n==null?void 0:n.arrayFunction)!==null&&s!==void 0?s:!1)))}),[o]=i;return new yt(o.height,o.width)}createKernel(e,r){return function(...n){const i=[];for(let o=0;o<r.height;++o){i.push([]);for(let a=0;a<r.width;++a)i[o][a]=e.apply({thread:{x:a,y:o}},n)}return i}}}vte.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:S.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:S.RANGE},{argumentType:S.NUMBER},{argumentType:S.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:S.RANGE},{argumentType:S.NUMBER},{argumentType:S.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class bte extends pt{median(e,r){return this.runFunction(e.args,r,this.metadata("MEDIAN"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);return i instanceof L?i:i.length===0?new L(V.NUM,Q.OneValue):(i.sort((o,a)=>o-a),i.length%2===0?(i[i.length/2-1]+i[i.length/2])/2:i[Math.floor(i.length/2)])})}large(e,r){return this.runFunction(e.args,r,this.metadata("LARGE"),(n,i)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());return o instanceof L?o:(o.sort((a,s)=>a-s),i=Math.trunc(i),i>o.length?new L(V.NUM,Q.ValueLarge):o[o.length-i])})}small(e,r){return this.runFunction(e.args,r,this.metadata("SMALL"),(n,i)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());return o instanceof L?o:(o.sort((a,s)=>a-s),i=Math.trunc(i),i>o.length?new L(V.NUM,Q.ValueLarge):o[i-1])})}}bte.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:S.RANGE},{argumentType:S.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:S.RANGE},{argumentType:S.NUMBER,minValue:1}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class wte extends pt{mod(e,r){return this.runFunction(e.args,r,this.metadata("MOD"),(n,i)=>i===0?new L(V.DIV_BY_ZERO):n%i)}}wte.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function pb(t){return Ft(t)&&!Number.isFinite(Ne(t))?0:t}class Eo{constructor(e,r,n){this.sumsq=e,this.sum=r,this.count=n}static single(e){return new Eo(e*e,e,1)}compose(e){return new Eo(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}varSValue(){if(this.count>1)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}varPValue(){if(this.count>0)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}Eo.empty=new Eo(0,0,0);class zx extends pt{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,r)=>this.arithmeticHelper.addWithEpsilonRaw(e,r)}sum(e,r){return this.doSum(e.args,r)}sumsq(e,r){return this.reduce(e.args,r,0,"SUMSQ",this.addWithEpsilonRaw,n=>Math.pow(Ne(n),2),mf)}max(e,r){return this.doMax(e.args,r)}maxa(e,r){const n=this.reduce(e.args,r,Number.NEGATIVE_INFINITY,"MAXA",(i,o)=>Math.max(i,o),Ne,mb);return pb(n)}min(e,r){return this.doMin(e.args,r)}mina(e,r){const n=this.reduce(e.args,r,Number.POSITIVE_INFINITY,"MINA",(i,o)=>Math.min(i,o),Ne,mb);return pb(n)}count(e,r){return this.doCount(e.args,r)}counta(e,r){return this.doCounta(e.args,r)}average(e,r){return this.doAverage(e.args,r)}averagea(e,r){var n;const i=this.reduce(e.args,r,Eo.empty,"_AGGREGATE_A",(o,a)=>o.compose(a),o=>Eo.single(Ne(o)),mb);return i instanceof L?i:(n=i.averageValue())!==null&&n!==void 0?n:new L(V.DIV_BY_ZERO)}vars(e,r){return this.doVarS(e.args,r)}varp(e,r){return this.doVarP(e.args,r)}vara(e,r){var n;const i=this.reduceAggregateA(e.args,r);return i instanceof L?i:(n=i.varSValue())!==null&&n!==void 0?n:new L(V.DIV_BY_ZERO)}varpa(e,r){var n;const i=this.reduceAggregateA(e.args,r);return i instanceof L?i:(n=i.varPValue())!==null&&n!==void 0?n:new L(V.DIV_BY_ZERO)}stdevs(e,r){return this.doStdevS(e.args,r)}stdevp(e,r){return this.doStdevP(e.args,r)}stdeva(e,r){const n=this.reduceAggregateA(e.args,r);if(n instanceof L)return n;{const i=n.varSValue();return i===void 0?new L(V.DIV_BY_ZERO):Math.sqrt(i)}}stdevpa(e,r){const n=this.reduceAggregateA(e.args,r);if(n instanceof L)return n;{const i=n.varPValue();return i===void 0?new L(V.DIV_BY_ZERO):Math.sqrt(i)}}product(e,r){return this.doProduct(e.args,r)}subtotal(e,r){if(e.args.length<2)return new L(V.NA,Q.WrongArgNumber);const n=this.coerceToType(this.evaluateAst(e.args[0],r),{argumentType:S.NUMBER},r),i=e.args.slice(1);switch(n){case 1:case 101:return this.doAverage(i,r);case 2:case 102:return this.doCount(i,r);case 3:case 103:return this.doCounta(i,r);case 4:case 104:return this.doMax(i,r);case 5:case 105:return this.doMin(i,r);case 6:case 106:return this.doProduct(i,r);case 7:case 107:return this.doStdevS(i,r);case 8:case 108:return this.doStdevP(i,r);case 9:case 109:return this.doSum(i,r);case 10:case 110:return this.doVarS(i,r);case 11:case 111:return this.doVarP(i,r);default:return new L(V.VALUE,Q.BadMode)}}reduceAggregate(e,r){return this.reduce(e,r,Eo.empty,"_AGGREGATE",(n,i)=>n.compose(i),n=>Eo.single(Ne(n)),mf)}reduceAggregateA(e,r){return this.reduce(e,r,Eo.empty,"_AGGREGATE_A",(n,i)=>n.compose(i),n=>Eo.single(Ne(n)),mb)}doAverage(e,r){var n;const i=this.reduceAggregate(e,r);return i instanceof L?i:(n=i.averageValue())!==null&&n!==void 0?n:new L(V.DIV_BY_ZERO)}doVarS(e,r){var n;const i=this.reduceAggregate(e,r);return i instanceof L?i:(n=i.varSValue())!==null&&n!==void 0?n:new L(V.DIV_BY_ZERO)}doVarP(e,r){var n;const i=this.reduceAggregate(e,r);return i instanceof L?i:(n=i.varPValue())!==null&&n!==void 0?n:new L(V.DIV_BY_ZERO)}doStdevS(e,r){const n=this.reduceAggregate(e,r);if(n instanceof L)return n;{const i=n.varSValue();return i===void 0?new L(V.DIV_BY_ZERO):Math.sqrt(i)}}doStdevP(e,r){const n=this.reduceAggregate(e,r);if(n instanceof L)return n;{const i=n.varPValue();return i===void 0?new L(V.DIV_BY_ZERO):Math.sqrt(i)}}doCount(e,r){return this.reduce(e,r,0,"COUNT",(n,i)=>n+i,Ne,n=>Ft(n)?1:0)}doCounta(e,r){return this.reduce(e,r,0,"COUNTA",(n,i)=>n+i,Ne,n=>n===Tt?0:1)}doMax(e,r){const n=this.reduce(e,r,Number.NEGATIVE_INFINITY,"MAX",(i,o)=>Math.max(i,o),Ne,mf);return pb(n)}doMin(e,r){const n=this.reduce(e,r,Number.POSITIVE_INFINITY,"MIN",(i,o)=>Math.min(i,o),Ne,mf);return pb(n)}doSum(e,r){return this.reduce(e,r,0,"SUM",this.addWithEpsilonRaw,Ne,mf)}doProduct(e,r){return this.reduce(e,r,1,"PRODUCT",(n,i)=>n*i,Ne,mf)}reduce(e,r,n,i,o,a,s){return e.length<1?new L(V.NA,Q.WrongArgNumber):e.reduce((l,u)=>{if(l instanceof L)return l;if(u.type===G.CELL_RANGE||u.type===G.COLUMN_RANGE||u.type===G.ROW_RANGE){const f=this.evaluateRange(u,r,n,i,o,a,s);return f instanceof L?f:o(f,l)}let c;if(c=this.evaluateAst(u,r),c instanceof je)return Array.from(c.valuesFromTopLeftCorner()).map(s).filter(h=>h!==void 0).map(h=>h instanceof L?h:a(h)).reduce((h,d)=>h instanceof L?h:d instanceof L?d:o(h,d),l);if(u.type===G.CELL_REFERENCE){if(c=s(c),c===void 0)return l}else if(c=this.coerceScalarToNumberOrError(c),c=s(c),c===void 0)return l;return c instanceof L?c:o(l,a(c))},n)}evaluateRange(e,r,n,i,o,a,s){let l;try{l=ze.fromAst(e,r.formulaAddress)}catch(f){if(f instanceof $v)return new L(V.REF,Q.RangeManySheets);throw f}const u=this.dependencyGraph.getRange(l.start,l.end);if(u===void 0)throw new Error("Range does not exists in graph");let c=u.getFunctionValue(i);return c===void 0&&(c=this.getRangeValues(i,l,u,a,s).reduce((h,d)=>h instanceof L?h:d instanceof L?d:o(h,d),n),u.setFunctionValue(i,c)),c}getRangeValues(e,r,n,i,o){const a=[],{smallerRangeVertex:s,restRange:l}=this.dependencyGraph.rangeMapping.findSmallerRange(r);let u;if(s!==void 0&&this.dependencyGraph.existsEdge(s,n)){const c=s.getFunctionValue(e);if(c!==void 0)a.push(c);else for(const f of s.range.addresses(this.dependencyGraph)){const h=o(this.dependencyGraph.getScalarValue(f));h instanceof L?a.push(h):h!==void 0&&a.push(i(h))}u=l}else u=r;for(const c of u.addresses(this.dependencyGraph)){const f=o(this.dependencyGraph.getScalarValue(c));f instanceof L?a.push(f):f!==void 0&&a.push(i(f))}return a}}zx.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:S.NUMBER},{argumentType:S.ANY}],repeatLastArgs:1}};zx.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};function mf(t){if(Ft(t)||t instanceof L)return t}function mb(t){return typeof t=="boolean"?$A(t):Ft(t)||t instanceof L?t:typeof t=="string"?0:void 0}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ste extends pt{power(e,r){return this.runFunction(e.args,r,this.metadata("POWER"),Math.pow)}}Ste.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Rte extends pt{radians(e,r){return this.runFunction(e.args,r,this.metadata("RADIANS"),n=>n*(Math.PI/180))}}Rte.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:S.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const hn=10,Ete=255,sj=2,lj=36,Mut="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";class Cte extends pt{dec2bin(e,r){return this.runFunction(e.args,r,this.metadata("DEC2BIN"),(n,i)=>Aa(n,2,i))}dec2oct(e,r){return this.runFunction(e.args,r,this.metadata("DEC2OCT"),(n,i)=>Aa(n,8,i))}dec2hex(e,r){return this.runFunction(e.args,r,this.metadata("DEC2HEX"),(n,i)=>Aa(n,16,i))}bin2dec(e,r){return this.runFunction(e.args,r,this.metadata("BIN2DEC"),n=>{const i=zo(n,2,hn);return i===void 0?new L(V.NUM,Q.NotBinary):Ia(i,2)})}bin2oct(e,r){return this.runFunction(e.args,r,this.metadata("BIN2OCT"),(n,i)=>{const o=zo(n,2,hn);return o===void 0?new L(V.NUM,Q.NotBinary):Aa(Ia(o,2),8,i)})}bin2hex(e,r){return this.runFunction(e.args,r,this.metadata("BIN2HEX"),(n,i)=>{const o=zo(n,2,hn);return o===void 0?new L(V.NUM,Q.NotBinary):Aa(Ia(o,2),16,i)})}oct2dec(e,r){return this.runFunction(e.args,r,this.metadata("OCT2DEC"),n=>{const i=zo(n,8,hn);return i===void 0?new L(V.NUM,Q.NotOctal):Ia(i,8)})}oct2bin(e,r){return this.runFunction(e.args,r,this.metadata("OCT2BIN"),(n,i)=>{const o=zo(n,8,hn);return o===void 0?new L(V.NUM,Q.NotOctal):Aa(Ia(o,8),2,i)})}oct2hex(e,r){return this.runFunction(e.args,r,this.metadata("OCT2HEX"),(n,i)=>{const o=zo(n,8,hn);return o===void 0?new L(V.NUM,Q.NotOctal):Aa(Ia(o,8),16,i)})}hex2dec(e,r){return this.runFunction(e.args,r,this.metadata("HEX2DEC"),n=>{const i=zo(n,16,hn);return i===void 0?new L(V.NUM,Q.NotHex):Ia(i,16)})}hex2bin(e,r){return this.runFunction(e.args,r,this.metadata("HEX2BIN"),(n,i)=>{const o=zo(n,16,hn);return o===void 0?new L(V.NUM,Q.NotHex):Aa(Ia(o,16),2,i)})}hex2oct(e,r){return this.runFunction(e.args,r,this.metadata("HEX2OCT"),(n,i)=>{const o=zo(n,16,hn);return o===void 0?new L(V.NUM,Q.NotHex):Aa(Ia(o,16),8,i)})}base(e,r){return this.runFunction(e.args,r,this.metadata("BASE"),Put)}decimal(e,r){return this.runFunction(e.args,r,this.metadata("DECIMAL"),(n,i)=>{const o=zo(n,i,Ete);return o===void 0?new L(V.NUM,Q.NotHex):parseInt(o,i)})}}Cte.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:S.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:S.STRING},{argumentType:S.NUMBER,optionalArg:!0,minValue:0,maxValue:hn}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:S.STRING},{argumentType:S.NUMBER,optionalArg:!0,minValue:0,maxValue:hn}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:S.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:S.STRING},{argumentType:S.NUMBER,optionalArg:!0,minValue:0,maxValue:hn}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:S.STRING},{argumentType:S.NUMBER,optionalArg:!0,minValue:0,maxValue:hn}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:S.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:S.STRING},{argumentType:S.NUMBER,optionalArg:!0,minValue:0,maxValue:hn}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:S.STRING},{argumentType:S.NUMBER,optionalArg:!0,minValue:0,maxValue:hn}]},DECIMAL:{method:"decimal",parameters:[{argumentType:S.STRING},{argumentType:S.NUMBER,minValue:sj,maxValue:lj}]},BASE:{method:"base",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:sj,maxValue:lj},{argumentType:S.NUMBER,optionalArg:!0,minValue:0,maxValue:Ete}]}};function zo(t,e,r){const n=Mut.substr(0,e),i=new RegExp(`^[${n}]+$`);if(!(t.length>r||!i.test(t)))return t}function Aa(t,e,r){if(t>Nut(e))return new L(V.NUM,Q.ValueBaseLarge);if(t<_te(e))return new L(V.NUM,Q.ValueBaseSmall);const n=Tte(t,e);return r===void 0||t<0?n:n.length>r?new L(V.NUM,Q.ValueBaseLong):ui(n,r)}function _te(t){return-Math.pow(t,hn)/2}function Nut(t){return-_te(t)-1}function Put(t,e,r){const n=Tte(t,e);return r!==void 0&&r>n.length?ui(n,r):n}function Tte(t,e){const r=t<0?Math.pow(e,hn):0;return(t+r).toString(e).toUpperCase()}function Ia(t,e){const r=parseInt(t,e),n=Math.pow(e,hn);return r>=n/2?r-n:r}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ote extends pt{rand(e,r){return this.runFunction(e.args,r,this.metadata("RAND"),Math.random)}randbetween(e,r){return this.runFunction(e.args,r,this.metadata("RANDBETWEEN"),(n,i)=>i<n?new L(V.NUM,Q.WrongOrder):(n=Math.ceil(n),i=Math.floor(i)+1,n===i&&(i+=1),n+Math.floor(Math.random()*(i-n))))}}Ote.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER}],isVolatile:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function uj(t){const e=Math.ceil(t);return e%2===1?e:e+1}function cj(t){const e=Math.ceil(t);return e%2===0?e:e+1}class Gx extends pt{roundup(e,r){return this.runFunction(e.args,r,this.metadata("ROUNDDOWN"),(n,i)=>{const o=Math.pow(10,i);return n<0?-Math.ceil(-n*o)/o:Math.ceil(n*o)/o})}rounddown(e,r){return this.runFunction(e.args,r,this.metadata("ROUNDDOWN"),(n,i)=>{const o=Math.pow(10,i);return n<0?-Math.floor(-n*o)/o:Math.floor(n*o)/o})}round(e,r){return this.runFunction(e.args,r,this.metadata("ROUND"),(n,i)=>{const o=Math.pow(10,i);return n<0?-Math.round(-n*o)/o:Math.round(n*o)/o})}intFunc(e,r){return this.runFunction(e.args,r,this.metadata("INT"),n=>n<0?-Math.floor(-n):Math.floor(n))}even(e,r){return this.runFunction(e.args,r,this.metadata("EVEN"),n=>n<0?-cj(-n):cj(n))}odd(e,r){return this.runFunction(e.args,r,this.metadata("ODD"),n=>n<0?-uj(-n):uj(n))}ceilingmath(e,r){return this.runFunction(e.args,r,this.metadata("CEILING.MATH"),(n,i,o)=>i===0||n===0?0:(i=Math.abs(i),o===1&&n<0&&(i=-i),Math.ceil(n/i)*i))}ceiling(e,r){return this.runFunction(e.args,r,this.metadata("CEILING"),(n,i)=>n===0?0:i===0?new L(V.DIV_BY_ZERO):n>0&&i<0?new L(V.NUM,Q.DistinctSigns):Math.ceil(n/i)*i)}ceilingprecise(e,r){return this.runFunction(e.args,r,this.metadata("CEILING.PRECISE"),(n,i)=>i===0||n===0?0:(i=Math.abs(i),Math.ceil(n/i)*i))}floormath(e,r){return this.runFunction(e.args,r,this.metadata("FLOOR.MATH"),(n,i,o)=>i===0||n===0?0:(i=Math.abs(i),o===1&&n<0&&(i*=-1),Math.floor(n/i)*i))}floor(e,r){return this.runFunction(e.args,r,this.metadata("FLOOR"),(n,i)=>n===0?0:i===0?new L(V.DIV_BY_ZERO):n>0&&i<0?new L(V.NUM,Q.DistinctSigns):Math.floor(n/i)*i)}floorprecise(e,r){return this.runFunction(e.args,r,this.metadata("FLOOR.PRECISE"),(n,i)=>i===0||n===0?0:(i=Math.abs(i),Math.floor(n/i)*i))}}Gx.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:S.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:S.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:S.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,defaultValue:1},{argumentType:S.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,defaultValue:1},{argumentType:S.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,defaultValue:1}]}};Gx.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ate extends pt{sqrt(e,r){return this.runFunction(e.args,r,this.metadata("SQRT"),Math.sqrt)}}Ate.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:S.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function*kut(){}function $ut(t){const e=t[Symbol.iterator](),{done:r,value:n}=e.next();return r?{rest:kut()}:{value:n,rest:e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Lut=(t,e,r)=>{if(r.end.row>r.start.row){const n=Le(r.end.sheet,r.end.col,r.end.row-1),i=t.getRange(r.start,n);if(i!==void 0)return{smallerRangeVertex:i,restValuesRange:r.withStart(Le(r.start.sheet,r.start.col,r.end.row)),restConditionRanges:e.map(o=>o.withStart(Le(o.start.sheet,o.start.col,o.end.row)))}}return{restValuesRange:r,restConditionRanges:e}};class Dut{constructor(e,r,n,i,o){this.interpreter=e,this.cacheKey=r,this.reduceInitialValue=n,this.composeFunction=i,this.mapFunction=o,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,r){for(const o of r)if(!o.conditionRange.sameDimensionsAs(e))return new L(V.VALUE,Q.EqualLength);const n=this.tryToGetRangeVertexForRangeValue(e),i=r.map(o=>this.tryToGetRangeVertexForRangeValue(o.conditionRange));if(n&&i.every(o=>o!==void 0)){const o=r.map(l=>l.criterionPackage.raw).join(","),a=this.findAlreadyComputedValueInCache(n,this.cacheKey(r),o);if(a!==void 0)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),a;const s=this.buildNewCriterionCache(this.cacheKey(r),r.map(l=>l.conditionRange.range),e.range);return s.has(o)||s.set(o,[this.evaluateRangeValue(e,r),r.map(l=>l.criterionPackage.lambda)]),n.setCriterionFunctionValues(this.cacheKey(r),s),i.forEach(l=>{l!==void 0&&l.addDependentCacheRange(n)}),s.get(o)[0]}else return this.evaluateRangeValue(e,r)}tryToGetRangeVertexForRangeValue(e){const r=e.range;if(r!==void 0)return this.dependencyGraph.getRange(r.start,r.end)}reduceFunction(e){let r=this.reduceInitialValue;for(const n of e)r=this.composeFunction(r,n);return r}findAlreadyComputedValueInCache(e,r,n){return e.getCriterionFunctionValue(r,n)}evaluateRangeValue(e,r){const n=r.map(s=>s.criterionPackage.lambda),i=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),o=r.map(s=>s.conditionRange.iterateValuesFromTopLeftCorner()),a=hj(n,o,i);return this.reduceFunction(a)}buildNewCriterionCache(e,r,n){const i=this.dependencyGraph.getRange(n.start,n.end),{smallerRangeVertex:o,restConditionRanges:a,restValuesRange:s}=Lut(this.dependencyGraph,r,n);let l;o!==void 0&&this.dependencyGraph.existsEdge(o,i)?l=o.getCriterionFunctionValues(e):l=new Map;const u=new Map;return l.forEach(([c,f],h)=>{const d=hj(f,a.map(m=>fj(this.dependencyGraph,m)),Array.from(fj(this.dependencyGraph,s)).map(this.mapFunction)[Symbol.iterator]()),p=this.composeFunction(c,this.reduceFunction(d));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),u.set(h,[p,f])}),u}}class Fut{constructor(e,r){this.conditionRange=e,this.criterionPackage=r}}function*fj(t,e){for(const r of e.addresses(t))yield Ne(t.getScalarValue(r))}function*hj(t,e,r){for(const n of r){const i=e.map(a=>$ut(a));if(!i.every(a=>Object.prototype.hasOwnProperty.call(a,"value")))return;const o=i.map(a=>Ne(a.value));Hut(o,t).every(([a,s])=>s(a))&&(yield n),e=i.map(a=>a.rest)}}function Hut(t,e){const r=[];for(let n=0;n<Math.min(t.length,e.length);n++)r.push([t[n],e[n]]);return r}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class pl{constructor(e,r){this.sum=e,this.count=r}static single(e){return new pl(e,1)}compose(e){return new pl(this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}}pl.empty=new pl(0,0);function But(t){return e=>{const r=e.map(n=>`${n.conditionRange.range.sheet},${n.conditionRange.range.start.col},${n.conditionRange.range.start.row}`);return[t,...r].join(",")}}function dj(t){return Ft(t)&&!Number.isFinite(Ne(t))?0:t}function gb(t){if(t instanceof L)return t;if(Ft(t))return Ne(t)}class Ite extends pt{sumif(e,r){const n="SUMIF",i=(o,a,s)=>this.computeConditionalAggregationFunction(s!=null?s:o,[o,a],n,0,(l,u)=>this.arithmeticHelper.nonstrictadd(l,u),gb);return this.runFunction(e.args,r,this.metadata(n),i)}sumifs(e,r){const n="SUMIFS",i=(o,...a)=>this.computeConditionalAggregationFunction(o,a,n,0,(s,l)=>this.arithmeticHelper.nonstrictadd(s,l),gb);return this.runFunction(e.args,r,this.metadata(n),i)}averageif(e,r){const n="AVERAGEIF",i=(o,a,s)=>{const l=this.computeConditionalAggregationFunction(s!=null?s:o,[o,a],n,pl.empty,(u,c)=>u.compose(c),u=>Ft(u)?pl.single(Ne(u)):pl.empty);return l instanceof L?l:l.averageValue()||new L(V.DIV_BY_ZERO)};return this.runFunction(e.args,r,this.metadata(n),i)}countif(e,r){const n="COUNTIF",i=(o,a)=>this.computeConditionalAggregationFunction(o,[o,a],n,0,(s,l)=>s+l,()=>1);return this.runFunction(e.args,r,this.metadata(n),i)}countifs(e,r){const n="COUNTIFS",i=(...o)=>this.computeConditionalAggregationFunction(o[0],o,n,0,(a,s)=>a+s,()=>1);return this.runFunction(e.args,r,this.metadata(n),i)}minifs(e,r){const n="MINIFS",i=(a,s)=>s===void 0||a===void 0?s===void 0?a:s:Math.min(a,s),o=(a,...s)=>{const l=this.computeConditionalAggregationFunction(a,s,n,Number.POSITIVE_INFINITY,i,gb);return dj(l)};return this.runFunction(e.args,r,this.metadata(n),o)}maxifs(e,r){const n="MAXIFS",i=(a,s)=>s===void 0||a===void 0?s===void 0?a:s:Math.max(a,s),o=(a,...s)=>{const l=this.computeConditionalAggregationFunction(a,s,n,Number.NEGATIVE_INFINITY,i,gb);return dj(l)};return this.runFunction(e.args,r,this.metadata(n),o)}computeConditionalAggregationFunction(e,r,n,i,o,a){const s=[];for(let l=0;l<r.length;l+=2){const u=r[l],c=this.interpreter.criterionBuilder.fromCellValue(r[l+1],this.arithmeticHelper);if(c===void 0)return new L(V.VALUE,Q.BadCriterion);s.push(new Fut(u,c))}return new Dut(this.interpreter,But(n),i,o,a).compute(e,s)}}Ite.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:S.RANGE},{argumentType:S.NOERROR},{argumentType:S.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:S.RANGE},{argumentType:S.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:S.RANGE},{argumentType:S.NOERROR},{argumentType:S.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE},{argumentType:S.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:S.RANGE},{argumentType:S.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE},{argumentType:S.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE},{argumentType:S.NOERROR}],repeatLastArgs:2}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class xte extends pt{sumproduct(e,r){return this.runFunction(e.args,r,this.metadata("SUMPRODUCT"),(...n)=>{const i=n[0].width(),o=n[0].height();for(const l of n)if(l.width()!==i||l.height()!==o)return new L(V.VALUE,Q.EqualLength);let a=0;const s=n.map(l=>l.iterateValuesFromTopLeftCorner());for(let l=0;l<i*o;l++){let u=1;for(const c of s){const f=c.next().value;if(f instanceof L)return f;const h=this.coerceScalarToNumberOrError(f);Ft(h)?u*=Ne(h):u=0}a+=u}return a})}}xte.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:S.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Mte extends pt{concatenate(e,r){return this.runFunction(e.args,r,this.metadata("CONCATENATE"),(...n)=>"".concat(...n))}split(e,r){return this.runFunction(e.args,r,this.metadata("SPLIT"),(n,i)=>{const o=n.split(" ");return i>=o.length||i<0?new L(V.VALUE,Q.IndexBounds):o[i]})}len(e,r){return this.runFunction(e.args,r,this.metadata("LEN"),n=>n.length)}lower(e,r){return this.runFunction(e.args,r,this.metadata("LOWER"),n=>n.toLowerCase())}trim(e,r){return this.runFunction(e.args,r,this.metadata("TRIM"),n=>n.replace(/^ +| +$/g,"").replace(/ +/g," "))}proper(e,r){return this.runFunction(e.args,r,this.metadata("PROPER"),n=>n.replace(/\p{L}+/gu,i=>i.charAt(0).toUpperCase()+i.substring(1).toLowerCase()))}clean(e,r){return this.runFunction(e.args,r,this.metadata("CLEAN"),n=>n.replace(/[\u0000-\u001F]/g,""))}exact(e,r){return this.runFunction(e.args,r,this.metadata("EXACT"),(n,i)=>n===i)}rept(e,r){return this.runFunction(e.args,r,this.metadata("REPT"),(n,i)=>i<0?new L(V.VALUE,Q.NegativeCount):n.repeat(i))}right(e,r){return this.runFunction(e.args,r,this.metadata("RIGHT"),(n,i)=>i<0?new L(V.VALUE,Q.NegativeLength):i===0?"":n.slice(-i))}left(e,r){return this.runFunction(e.args,r,this.metadata("LEFT"),(n,i)=>i<0?new L(V.VALUE,Q.NegativeLength):n.slice(0,i))}mid(e,r){return this.runFunction(e.args,r,this.metadata("MID"),(n,i,o)=>i<1?new L(V.VALUE,Q.LessThanOne):o<0?new L(V.VALUE,Q.NegativeLength):n.substring(i-1,i+o-1))}replace(e,r){return this.runFunction(e.args,r,this.metadata("REPLACE"),(n,i,o,a)=>i<1?new L(V.VALUE,Q.LessThanOne):o<0?new L(V.VALUE,Q.NegativeLength):n.substring(0,i-1)+a+n.substring(i+o-1))}search(e,r){return this.runFunction(e.args,r,this.metadata("SEARCH"),(n,i,o)=>{if(o<1||o>i.length)return new L(V.VALUE,Q.LengthBounds);const a=i.substring(o-1).toLowerCase();let s;return this.arithmeticHelper.requiresRegex(n)?s=this.arithmeticHelper.searchString(n,a):s=a.indexOf(n.toLowerCase()),s=s+o,s>0?s:new L(V.VALUE,Q.PatternNotFound)})}substitute(e,r){return this.runFunction(e.args,r,this.metadata("SUBSTITUTE"),(n,i,o,a)=>{const s=new RegExp(i,"g");if(a===void 0)return n.replace(s,o);if(a<1)return new L(V.VALUE,Q.LessThanOne);let l,u=0;for(;(l=s.exec(n))!==null;)if(a===++u)return n.substring(0,l.index)+o+n.substring(s.lastIndex);return n})}find(e,r){return this.runFunction(e.args,r,this.metadata("FIND"),(n,i,o)=>{if(o<1||o>i.length)return new L(V.VALUE,Q.IndexBounds);const s=i.substring(o-1).indexOf(n)+o;return s>0?s:new L(V.VALUE,Q.PatternNotFound)})}t(e,r){return this.runFunction(e.args,r,this.metadata("T"),n=>n instanceof L||typeof n=="string"?n:"")}upper(e,r){return this.runFunction(e.args,r,this.metadata("UPPER"),n=>n.toUpperCase())}}Mte.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:S.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:S.STRING},{argumentType:S.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:S.STRING},{argumentType:S.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:S.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:S.STRING}]},MID:{method:"mid",parameters:[{argumentType:S.STRING},{argumentType:S.NUMBER},{argumentType:S.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:S.STRING}]},T:{method:"t",parameters:[{argumentType:S.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:S.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:S.STRING}]},REPT:{method:"rept",parameters:[{argumentType:S.STRING},{argumentType:S.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:S.STRING},{argumentType:S.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:S.STRING},{argumentType:S.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:S.STRING},{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:S.STRING},{argumentType:S.STRING},{argumentType:S.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:S.STRING},{argumentType:S.STRING},{argumentType:S.STRING},{argumentType:S.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:S.STRING},{argumentType:S.STRING},{argumentType:S.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:S.STRING}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Nte extends pt{acos(e,r){return this.runFunction(e.args,r,this.metadata("ACOS"),Math.acos)}asin(e,r){return this.runFunction(e.args,r,this.metadata("ASIN"),Math.asin)}cos(e,r){return this.runFunction(e.args,r,this.metadata("COS"),Math.cos)}sin(e,r){return this.runFunction(e.args,r,this.metadata("SIN"),Math.sin)}tan(e,r){return this.runFunction(e.args,r,this.metadata("TAN"),Math.tan)}atan(e,r){return this.runFunction(e.args,r,this.metadata("ATAN"),Math.atan)}atan2(e,r){return this.runFunction(e.args,r,this.metadata("ATAN2"),(n,i)=>n===0&&i===0?new L(V.DIV_BY_ZERO):Math.atan2(i,n))}cot(e,r){return this.runFunction(e.args,r,this.metadata("COT"),n=>n===0?new L(V.DIV_BY_ZERO):1/Math.tan(n))}acot(e,r){return this.runFunction(e.args,r,this.metadata("ACOT"),n=>n===0?GA/2:Math.atan(1/n))}sec(e,r){return this.runFunction(e.args,r,this.metadata("SEC"),n=>1/Math.cos(n))}csc(e,r){return this.runFunction(e.args,r,this.metadata("CSC"),n=>n===0?new L(V.DIV_BY_ZERO):1/Math.sin(n))}sinh(e,r){return this.runFunction(e.args,r,this.metadata("SINH"),Math.sinh)}asinh(e,r){return this.runFunction(e.args,r,this.metadata("ASINH"),Math.asinh)}cosh(e,r){return this.runFunction(e.args,r,this.metadata("COSH"),Math.cosh)}acosh(e,r){return this.runFunction(e.args,r,this.metadata("ACOSH"),Math.acosh)}tanh(e,r){return this.runFunction(e.args,r,this.metadata("TANH"),Math.tanh)}atanh(e,r){return this.runFunction(e.args,r,this.metadata("ATANH"),Math.atanh)}coth(e,r){return this.runFunction(e.args,r,this.metadata("COTH"),n=>n===0?new L(V.DIV_BY_ZERO):1/Math.tanh(n))}acoth(e,r){return this.runFunction(e.args,r,this.metadata("ACOTH"),n=>n===0?new L(V.NUM,Q.NonZero):Math.atanh(1/n))}sech(e,r){return this.runFunction(e.args,r,this.metadata("SECH"),n=>1/Math.cosh(n))}csch(e,r){return this.runFunction(e.args,r,this.metadata("CSCH"),n=>n===0?new L(V.DIV_BY_ZERO):1/Math.sinh(n))}}Nte.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:S.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:S.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:S.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:S.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:S.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:S.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:S.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:S.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:S.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:S.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:S.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:S.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:S.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:S.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:S.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:S.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:S.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:S.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:S.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:S.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Uut extends zee{constructor(e){super(e),this.dependencyGraph=e}find(e,r,n){return this.basicFind(e,r,"col",n)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Pte extends pt{constructor(){super(...arguments),this.rowSearch=new Uut(this.dependencyGraph)}vlookup(e,r){return this.runFunction(e.args,r,this.metadata("VLOOKUP"),(n,i,o,a)=>{const s=i.range;return s===void 0?new L(V.VALUE,Q.WrongType):o<1?new L(V.VALUE,Q.LessThanOne):o>s.width()?new L(V.REF,Q.IndexLarge):this.doVlookup(zC(n),i,o-1,a)})}hlookup(e,r){return this.runFunction(e.args,r,this.metadata("HLOOKUP"),(n,i,o,a)=>{const s=i.range;return s===void 0?new L(V.VALUE,Q.WrongType):o<1?new L(V.VALUE,Q.LessThanOne):o>s.height()?new L(V.REF,Q.IndexLarge):this.doHlookup(zC(n),i,o-1,a)})}match(e,r){return this.runFunction(e.args,r,this.metadata("MATCH"),(n,i,o)=>this.doMatch(zC(n),i,o))}searchInRange(e,r,n,i){if(!n&&typeof e=="string"&&this.arithmeticHelper.requiresRegex(e))return i.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),r);{const o=n?{ordering:"asc"}:{ordering:"none",matchExactly:!0};return i.find(e,r,o)}}doVlookup(e,r,n,i){this.dependencyGraph.stats.start(ot.VLOOKUP);const o=r.range;let a;o===void 0?a=je.onlyValues(r.data.map(u=>[u[0]])):a=je.onlyRange(ze.spanFrom(o.start,1,o.height()),this.dependencyGraph);const s=this.searchInRange(e,a,i,this.columnSearch);if(this.dependencyGraph.stats.end(ot.VLOOKUP),s===-1)return new L(V.NA,Q.ValueNotFound);let l;if(o===void 0)l=r.data[s][n];else{const u=Le(o.sheet,o.start.col+n,o.start.row+s);l=this.dependencyGraph.getCellValue(u)}return l instanceof je?new L(V.VALUE,Q.WrongType):l}doHlookup(e,r,n,i){const o=r.range;let a;o===void 0?a=je.onlyValues([r.data[0]]):a=je.onlyRange(ze.spanFrom(o.start,o.width(),1),this.dependencyGraph);const s=this.searchInRange(e,a,i,this.rowSearch);if(s===-1)return new L(V.NA,Q.ValueNotFound);let l;if(o===void 0)l=r.data[n][s];else{const u=Le(o.sheet,o.start.col+s,o.start.row+n);l=this.dependencyGraph.getCellValue(u)}return l instanceof je?new L(V.VALUE,Q.WrongType):l}doMatch(e,r,n){if(![-1,0,1].includes(n))return new L(V.VALUE,Q.BadMode);if(r.width()>1&&r.height()>1)return new L(V.NA);const i=r.width()===1?this.columnSearch:this.rowSearch,o=n===0?{ordering:"none",matchExactly:!0}:{ordering:n===-1?"desc":"asc"},a=i.find(e,r,o);return a===-1?new L(V.NA,Q.ValueNotFound):a+1}}Pte.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:S.NOERROR},{argumentType:S.RANGE},{argumentType:S.NUMBER},{argumentType:S.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:S.NOERROR},{argumentType:S.RANGE},{argumentType:S.NUMBER},{argumentType:S.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:S.NOERROR},{argumentType:S.RANGE},{argumentType:S.NUMBER,defaultValue:1}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class kte extends pt{roman(e,r){return this.runFunction(e.args,r,this.metadata("ROMAN"),(n,i)=>(n=Math.trunc(n),i===!1?i=4:i===!0&&(i=0),i=Ne(this.coerceScalarToNumberOrError(i)),i instanceof L?i:(i=Math.trunc(i),i<0?new L(V.VALUE,Q.ValueSmall):i>4?new L(V.VALUE,Q.ValueLarge):Vut(n,i))))}arabic(e,r){return this.runFunction(e.args,r,this.metadata("ARABIC"),n=>{n=n.trim().toUpperCase();let i=!1;if(n.startsWith("-")&&(n=n.slice(1),i=!0,n===""))return new L(V.VALUE,Q.InvalidRoman);const o={input:n,acc:0};return Go(o,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),Go(o,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),Go(o,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),Go(o,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),Go(o,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),Go(o,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),Go(o,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),Go(o,{token:"IX",val:9}),Go(o,{token:"V",val:5},{token:"IV",val:4}),Go(o,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),o.input!==""?new L(V.VALUE,Q.InvalidRoman):i?-o.acc:o.acc})}}kte.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:S.NUMBER,minValue:1,lessThan:4e3},{argumentType:S.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:S.STRING}]}};function Go(t,...e){for(const r of e)if(t.input.startsWith(r.token)){t.input=t.input.slice(r.token.length),t.acc+=r.val;break}}function Vut(t,e){const r={val:t%1e3,acc:"M".repeat(Math.floor(t/1e3))};return e===4&&(Fr(r,"IM",999,1e3),Fr(r,"ID",499,500)),e>=3&&(Fr(r,"VM",995,1e3),Fr(r,"VD",495,500)),e>=2&&(Fr(r,"XM",990,1e3),Fr(r,"XD",490,500)),e>=1&&(Fr(r,"LM",950,1e3),Fr(r,"LD",450,500)),Fr(r,"CM",900,1e3),Fr(r,"CD",400,500),Fr(r,"D",500,900),r.acc+="C".repeat(Math.floor(r.val/100)),r.val%=100,e>=2&&(Fr(r,"IC",99,100),Fr(r,"IL",49,50)),e>=1&&(Fr(r,"VC",95,100),Fr(r,"VL",45,50)),Fr(r,"XC",90,100),Fr(r,"XL",40,50),Fr(r,"L",50,90),r.acc+="X".repeat(Math.floor(r.val/10)),r.val%=10,Fr(r,"IX",9,10),Fr(r,"IV",4,5),Fr(r,"V",5,9),r.acc+="I".repeat(r.val),r.acc}function Fr(t,e,r,n){t.val>=r&&t.val<n&&(t.val-=r,t.acc+=e)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class $te extends pt{add(e,r){return this.runFunction(e.args,r,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,r){return this.runFunction(e.args,r,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,r){return this.runFunction(e.args,r,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,r){return this.runFunction(e.args,r,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,r){return this.runFunction(e.args,r,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,r){return this.runFunction(e.args,r,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,r){return this.runFunction(e.args,r,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,r){return this.runFunction(e.args,r,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,r){return this.runFunction(e.args,r,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,r){return this.runFunction(e.args,r,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,r){return this.runFunction(e.args,r,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,r){return this.runFunction(e.args,r,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,r){return this.runFunction(e.args,r,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,r){return this.runFunction(e.args,r,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,r){return this.runFunction(e.args,r,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}$te.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:S.NUMBER,passSubtype:!0},{argumentType:S.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:S.STRING,passSubtype:!0},{argumentType:S.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:S.NUMBER,passSubtype:!0},{argumentType:S.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:S.NOERROR,passSubtype:!0},{argumentType:S.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:S.NOERROR,passSubtype:!0},{argumentType:S.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:S.NOERROR,passSubtype:!0},{argumentType:S.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:S.NOERROR,passSubtype:!0},{argumentType:S.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:S.NOERROR,passSubtype:!0},{argumentType:S.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:S.NUMBER,passSubtype:!0},{argumentType:S.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:S.NUMBER,passSubtype:!0},{argumentType:S.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:S.NOERROR,passSubtype:!0},{argumentType:S.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:S.NUMBER,passSubtype:!0},{argumentType:S.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:S.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:S.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:S.NUMBER,passSubtype:!0}]}};/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */var ft=Math;function dr(t,e){for(var r=0,n=0;r<t.length;++r)n=e*n+t[r];return n}function Lte(t,e,r,n,i){if(e===0)return r;if(e===1)return n;for(var o=2/t,a=n,s=1;s<e;++s)a=n*s*o+i*r,r=n,n=a;return a}function Dte(t,e,r,n,i){return function(a,s){if(n){if(a===0)return n==1?-1/0:1/0;if(a<0)return NaN}if(s===0)return t(a);if(s===1)return e(a);if(s<0)return NaN;s|=0;var l=t(a),u=e(a);return Lte(a,s,l,u,i)}}var YA=function(){var t=.636619772,e=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),r=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function o(f){var h=0,d=0,p=0,m=f*f;if(f<8)d=dr(e,m),p=dr(r,m),h=d/p;else{var g=f-.785398164;m=64/m,d=dr(n,m),p=dr(i,m),h=ft.sqrt(t/f)*(ft.cos(g)*d-ft.sin(g)*p*8/f)}return h}var a=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),s=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(f){var h=0,d=0,p=0,m=f*f,g=ft.abs(f)-2.356194491;return Math.abs(f)<8?(d=f*dr(a,m),p=dr(s,m),h=d/p):(m=64/m,d=dr(l,m),p=dr(u,m),h=ft.sqrt(t/ft.abs(f))*(ft.cos(g)*d-ft.sin(g)*p*8/ft.abs(f)),f<0&&(h=-h)),h}return function f(h,d){if(d=Math.round(d),!isFinite(h))return isNaN(h)?h:0;if(d<0)return(d%2?-1:1)*f(h,-d);if(h<0)return(d%2?-1:1)*f(-h,d);if(d===0)return o(h);if(d===1)return c(h);if(h===0)return 0;var p=0;if(h>d)p=Lte(h,d,o(h),c(h),-1);else{for(var m=2*ft.floor((d+ft.floor(ft.sqrt(40*d)))/2),g=!1,v=0,w=0,b=1,E=0,A=2/h,M=m;M>0;M--)E=M*A*b-v,v=b,b=E,ft.abs(b)>1e10&&(b*=1e-10,v*=1e-10,p*=1e-10,w*=1e-10),g&&(w+=b),g=!g,M==d&&(p=v);w=2*w-b,p/=w}return p}}(),jut=function(){var t=.636619772,e=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),r=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function o(f){var h=0,d=0,p=0,m=f*f,g=f-.785398164;return f<8?(d=dr(e,m),p=dr(r,m),h=d/p+t*YA(f,0)*ft.log(f)):(m=64/m,d=dr(n,m),p=dr(i,m),h=ft.sqrt(t/f)*(ft.sin(g)*d+ft.cos(g)*p*8/f)),h}var a=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),s=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(f){var h=0,d=0,p=0,m=f*f,g=f-2.356194491;return f<8?(d=f*dr(a,m),p=dr(s,m),h=d/p+t*(YA(f,1)*ft.log(f)-1/f)):(m=64/m,d=dr(l,m),p=dr(u,m),h=ft.sqrt(t/f)*(ft.sin(g)*d+ft.cos(g)*p*8/f)),h}return Dte(o,c,"BESSELY",1,-1)}(),KA=function(){var t=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function r(a){return a<=3.75?dr(t,a*a/(3.75*3.75)):ft.exp(ft.abs(a))/ft.sqrt(ft.abs(a))*dr(e,3.75/ft.abs(a))}var n=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),i=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function o(a){return a<3.75?a*dr(n,a*a/(3.75*3.75)):(a<0?-1:1)*ft.exp(ft.abs(a))/ft.sqrt(ft.abs(a))*dr(i,3.75/ft.abs(a))}return function a(s,l){if(l=Math.round(l),l===0)return r(s);if(l===1)return o(s);if(l<0)return NaN;if(ft.abs(s)===0)return 0;if(s==1/0)return 1/0;var u=0,c,f=2/ft.abs(s),h=0,d=1,p=0,m=2*ft.round((l+ft.round(ft.sqrt(40*l)))/2);for(c=m;c>0;c--)p=c*f*d+h,h=d,d=p,ft.abs(d)>1e10&&(d*=1e-10,h*=1e-10,u*=1e-10),c==l&&(u=h);return u*=a(s,0)/d,s<0&&l%2?-u:u}}(),Wut=function(){var t=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),e=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function r(a){return a<=2?-ft.log(a/2)*KA(a,0)+dr(t,a*a/4):ft.exp(-a)/ft.sqrt(a)*dr(e,2/a)}var n=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),i=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function o(a){return a<=2?ft.log(a/2)*KA(a,1)+1/a*dr(n,a*a/4):ft.exp(-a)/ft.sqrt(a)*dr(i,2/a)}return Dte(r,o,"BESSELK",2,1)}();/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */function ih(t){const e=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let r=e.length-1,n=!1,i=0,o=0,a,s,l,u;if(t===0)return 0;for(t<0&&(t=-t,n=!0),a=2/(2+t),s=4*a-2;r>0;r--)l=i,i=s*i-o+e[r],o=l;return u=a*Math.exp(-t*t+.5*(e[0]+s*i)-o),n?u-1:1-u}function Fte(t){return 1-ih(t)}function Hte(t){let e=0,r,n,i,o;if(t>=2)return-100;if(t<=0)return 100;for(o=t<1?t:2-t,i=Math.sqrt(-2*Math.log(o/2)),r=-.70711*((2.30753+i*.27061)/(1+i*(.99229+i*.04481))-i);e<2;e++)n=Fte(r)-o,r+=n/(1.1283791670955126*Math.exp(-r*r)-r*n);return t<1?r:-r}const pj={pdf:(t,e)=>t<0?0:e*Math.exp(-e*t),cdf:(t,e)=>t<0?0:1-Math.exp(-e*t)};function gg(t){const e=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],r=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let n=!1,i=0,o=0,a=0,s=t,l,u,c,f;if(t>171.6243769536076)return 1/0;if(s<=0)if(f=s%1,f)n=(s&1?-1:1)*Math.PI/Math.sin(Math.PI*f),s=1-s;else return 1/0;for(c=s,s<1?u=s++:u=(s-=i=(s|0)-1)-1,l=0;l<8;++l)a=(a+e[l])*u,o=o*u+r[l];if(f=a/o+1,c<s)f/=c;else if(c>s)for(l=0;l<i;++l)f*=s,s++;return n&&(f=n/f),f}const QC={pdf:function(e,r,n){return e<0?0:e===0&&r===1?1/n:Math.exp((r-1)*Math.log(e)-e/n-yn(r)-r*Math.log(n))},cdf:function(e,r,n){return e<0?0:Yx(r,e/n)},inv:function(t,e,r){return Bte(t,e)*r}};function yn(t){let e=0;const r=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let n=1.000000000190015,i,o,a;for(a=(o=i=t)+5.5,a-=(i+.5)*Math.log(a);e<6;e++)n+=r[e]/++o;return Math.log(2.5066282746310007*n/i)-a}function Yx(t,e){const r=yn(t);let n=t,i=1/t,o=i,a=e+1-t,s=1/1e-30,l=1/a,u=l,c=1;const f=-~(Math.log(t>=1?t:1/t)*8.5+t*.4+17);let h;if(e<0||t<=0)return NaN;if(e<t+1){for(;c<=f;c++)i+=o*=e/++n;return i*Math.exp(-e+t*Math.log(e)-r)}for(;c<=f;c++)h=-c*(c-t),a+=2,l=h*l+a,s=a+h/s,l=1/l,u*=l*s;return 1-u*Math.exp(-e+t*Math.log(e)-r)}function Bte(t,e){let r=0;const n=e-1,i=1e-8,o=yn(e);let a,s,l,u,c,f,h;if(t>=1)return Math.max(100,e+100*Math.sqrt(e));if(t<=0)return 0;for(e>1?(f=Math.log(n),h=Math.exp(n*(f-1)-o),c=t<.5?t:1-t,l=Math.sqrt(-2*Math.log(c)),a=(2.30753+l*.27061)/(1+l*(.99229+l*.04481))-l,t<.5&&(a=-a),a=Math.max(.001,e*Math.pow(1-1/(9*e)-a/(3*Math.sqrt(e)),3))):(l=1-e*(.253+e*.12),t<l?a=Math.pow(t/l,1/e):a=1-Math.log(1-(t-l)/(1-l)));r<12;r++){if(a<=0)return 0;if(s=Yx(e,a)-t,e>1?l=h*Math.exp(-(a-n)+n*(Math.log(a)-f)):l=Math.exp(-a+n*Math.log(a)-o),u=s/l,a-=l=u/(1-.5*Math.min(1,u*((e-1)/a-1))),a<=0&&(a=.5*(a+l)),Math.abs(l)<i*a)break}return a}const vo={pdf:function(e,r,n){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(e-r,2)/(2*n*n))},cdf:function(e,r,n){return .5*(1+ih((e-r)/Math.sqrt(2*n*n)))},inv:function(t,e,r){return-1.4142135623730951*r*Hte(2*t)+e}},ZC={pdf:function(e,r,n){return e>1||e<0?0:r==1&&n==1?1:r<512&&n<512?Math.pow(e,r-1)*Math.pow(1-e,n-1)/Kx(r,n):Math.exp((r-1)*Math.log(e)+(n-1)*Math.log(1-e)-Ute(r,n))},cdf:function(e,r,n){return e>1||e<0?+(e>1):h5(e,r,n)},inv:function(e,r,n){return qx(e,r,n)}};function Kx(t,e){if(!(t<=0||e<=0))return t+e>170?Math.exp(Ute(t,e)):gg(t)*gg(e)/gg(t+e)}function Ute(t,e){return yn(t)+yn(e)-yn(t+e)}function qx(t,e,r){var n=1e-8,i=e-1,o=r-1,a=0,s,l,u,c,f,h,d,p,m,g,v;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&r>=1?(u=t<.5?t:1-t,c=Math.sqrt(-2*Math.log(u)),d=(2.30753+c*.27061)/(1+c*(.99229+c*.04481))-c,t<.5&&(d=-d),p=(d*d-3)/6,m=2/(1/(2*e-1)+1/(2*r-1)),g=d*Math.sqrt(p+m)/m-(1/(2*r-1)-1/(2*e-1))*(p+5/6-2/(3*m)),d=e/(e+r*Math.exp(2*g))):(s=Math.log(e/(e+r)),l=Math.log(r/(e+r)),c=Math.exp(e*s)/e,f=Math.exp(r*l)/r,g=c+f,t<c/g?d=Math.pow(e*g*t,1/e):d=1-Math.pow(r*g*(1-t),1/r)),v=-yn(e)-yn(r)+yn(e+r);a<10;a++){if(d===0||d===1)return d;if(h=h5(d,e,r)-t,c=Math.exp(i*Math.log(d)+o*Math.log(1-d)+v),f=h/c,d-=c=f/(1-.5*Math.min(1,f*(i/d-o/(1-d)))),d<=0&&(d=.5*(d+c)),d>=1&&(d=.5*(d+c+1)),Math.abs(c)<n*d&&a>0)break}return d}function h5(t,e,r){var n=t===0||t===1?0:Math.exp(yn(e+r)-yn(e)-yn(r)+e*Math.log(t)+r*Math.log(1-t));return t<0||t>1?!1:t<(e+1)/(e+r+2)?n*mj(t,e,r)/e:1-n*mj(1-t,r,e)/r}function mj(t,e,r){var n=1e-30,i=1,o=e+r,a=e+1,s=e-1,l=1,u=1-o*t/a,c,f,h,d;for(Math.abs(u)<n&&(u=n),u=1/u,d=u;i<=100&&(c=2*i,f=i*(r-i)*t/((s+c)*(e+c)),u=1+f*u,Math.abs(u)<n&&(u=n),l=1+f/l,Math.abs(l)<n&&(l=n),u=1/u,d*=u*l,f=-(e+i)*(o+i)*t/((e+c)*(a+c)),u=1+f*u,Math.abs(u)<n&&(u=n),l=1+f/l,Math.abs(l)<n&&(l=n),u=1/u,h=u*l,d*=h,!(Math.abs(h-1)<3e-7));i++);return d}const x2={pdf:function(t,e,r){return r===0||r===1?e*r===t?1:0:Vte(e,t)*Math.pow(r,t)*Math.pow(1-r,e-t)},cdf:function(t,e,r){var n,i=1e-10;if(t<0)return 0;if(t>=e)return 1;if(r<0||r>1||e<=0)return NaN;t=Math.floor(t);var o=r,a=t+1,s=e-t,l=a+s,u=Math.exp(yn(l)-yn(s)-yn(a)+a*Math.log(o)+s*Math.log(1-o));return o<(a+1)/(l+2)?n=u*gj(o,a,s,i):n=1-u*gj(1-o,s,a,i),Math.round((1-n)*(1/i))/(1/i)}};function gj(t,e,r,n){for(var i=0,o=1,a=1,s=1,l=0,u=0,c;Math.abs((a-u)/a)>n;)u=a,c=-(e+l)*(e+r+l)*t/(e+2*l)/(e+2*l+1),i=a+c*i,o=s+c*o,l=l+1,c=l*(r-l)*t/(e+2*l-1)/(e+2*l),a=i+c*a,s=o+c*s,i=i/s,o=o/s,a=a/s,s=1;return a/e}function Vte(t,e){return t>170||e>170?Math.exp(zut(t,e)):M2(t)/M2(e)/M2(t-e)}function zut(t,e){return JC(t)-JC(e)-JC(t-e)}function JC(t){return t<0?NaN:yn(t+1)}function M2(t){return t<0?NaN:gg(t+1)}const xf={pdf:function(e,r){return e<0?0:e===0&&r===2?.5:Math.exp((r/2-1)*Math.log(e)-e/2-r/2*Math.log(2)-yn(r/2))},cdf:function(e,r){return e<0?0:Yx(r/2,e/2)},inv:function(t,e){return 2*Bte(t,.5*e)}},Mf={pdf:function(e,r,n){var i,o,a;return e<0?0:r<=2?e===0&&r<2?1/0:e===0&&r===2?1:1/Kx(r/2,n/2)*Math.pow(r/n,r/2)*Math.pow(e,r/2-1)*Math.pow(1+r/n*e,-(r+n)/2):(i=r*e/(n+e*r),o=n/(n+e*r),a=r*o/2,a*x2.pdf((r-2)/2,(r+n-2)/2,i))},cdf:function(e,r,n){return e<0?0:h5(r*e/(r*e+n),r/2,n/2)},inv:function(e,r,n){return n/(r*(1/qx(e,r/2,n/2)-1))}},yj={pdf:function(e,r,n){return e<0||r<0||n<0?0:n/r*Math.pow(e/r,n-1)*Math.exp(-Math.pow(e/r,n))},cdf:function(e,r,n){return e<0?0:1-Math.exp(-Math.pow(e/r,n))}},qA={pdf:function(e,r){return r<0||e%1!==0||e<0?0:Math.pow(r,e)*Math.exp(-r)/M2(e)},cdf:function(e,r){var n=0;if(e<0)return 0;for(var i=0;n<=e;n++)i+=qA.pdf(n,r);return i}},$a={pdf:function(e,r,n,i){if(e<0||e<n-(r-i))return 0;if(e>i||e>n)return 0;if(n*2>r)return i*2>r?$a.pdf(r-n-i+e,r,r-n,r-i):$a.pdf(i-e,r,r-n,i);if(i*2>r)return $a.pdf(n-e,r,n,r-i);if(n<i)return $a.pdf(e,r,i,n);for(var o=1,a=0,s=0;s<e;s++){for(;o>1&&a<i;)o*=1-n/(r-a),a++;o*=(i-s)*(n-s)/((s+1)*(r-n-i+s+1))}for(;a<i;a++)o*=1-n/(r-a);return Math.min(1,Math.max(0,o))},cdf:function t(e,r,n,i){if(e<0||e<n-(r-i))return 0;if(e>=i||e>=n)return 1;if(n*2>r)return i*2>r?t(r-n-i+e,r,r-n,r-i):1-$a.cdf(i-e-1,r,r-n,i);if(i*2>r)return 1-$a.cdf(n-e-1,r,n,r-i);if(n<i)return $a.cdf(e,r,i,n);for(var o=1,a=1,s=0,l=0;l<e;l++){for(;o>1&&s<i;){var u=1-n/(r-s);a*=u,o*=u,s++}a*=(i-l)*(n-l)/((l+1)*(r-n-i+l+1)),o+=a}for(;s<i;s++)o*=1-n/(r-s);return Math.min(1,Math.max(0,o))}},ji={pdf:function(e,r){return r=r>1e100?1e100:r,1/(Math.sqrt(r)*Kx(.5,r/2))*Math.pow(1+e*e/r,-((r+1)/2))},cdf:function(e,r){var n=r/2;return h5((e+Math.sqrt(e*e+r))/(2*Math.sqrt(e*e+r)),n,n)},inv:function(t,e){var r=qx(2*Math.min(t,1-t),.5*e,.5);return r=Math.sqrt(e*(1-r)/r),t>.5?r:-r}},e_={pdf:function(e,r,n){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(Math.log(e)-r,2)/(2*n*n))},cdf:function(e,r,n){return e<0?0:.5+.5*ih((Math.log(e)-r)/Math.sqrt(2*n*n))},inv:function(t,e,r){return Math.exp(-1.4142135623730951*r*Hte(2*t)+e)}},XA={pdf:function(e,r,n){return e!==e>>>0?!1:e<0?0:Vte(e+r-1,r-1)*Math.pow(1-n,e)*Math.pow(n,r)},cdf:function(e,r,n){var i=0,o=0;if(e<0)return 0;for(;o<=e;o++)i+=XA.pdf(o,r,n);return i}};function jte(t){for(var e=0,r=t.length;--r>=0;)e+=t[r];return e}function Ui(t){return jte(t)/t.length}function Zl(t){for(var e=Ui(t),r=0,n=t.length,i;--n>=0;)i=t[n]-e,r+=i*i;return r}function zm(t,e){return Zl(t)/(t.length-(e?1:0))}function qs(t,e){return Math.sqrt(zm(t,e))}function Gut(){var t=[].slice.call(arguments),e=new Array(2),r;return t.length===4?r=Math.abs(vo.inv(t[1]/2,0,1)*t[2]/Math.sqrt(t[3])):r=Math.abs(vo.inv(t[1]/2,0,1)*qs(t[2])/Math.sqrt(t[2].length)),e[0]=t[0]-r,e[1]=t[0]+r,e}function Yut(){var t=[].slice.call(arguments),e=new Array(2),r;return t.length===4?r=Math.abs(ji.inv(t[1]/2,t[3]-1)*t[2]/Math.sqrt(t[3])):r=Math.abs(ji.inv(t[1]/2,t[2].length-1)*qs(t[2],!0)/Math.sqrt(t[2].length)),e[0]=t[0]-r,e[1]=t[0]+r,e}function Kut(t){for(var e=1,r=t.length;--r>=0;)e*=t[r];return e}function qut(t){return Math.pow(Kut(t),1/t.length)}function Gm(t,e){var r=Ui(t),n=Ui(e),i=t.length,o=new Array(i),a;for(a=0;a<i;a++)o[a]=(t[a]-r)*(e[a]-n);return jte(o)/(i-1)}function vj(t,e){return Gm(t,e)/qs(t,1)/qs(e,1)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Xx extends pt{erf(e,r){return this.runFunction(e.args,r,this.metadata("ERF"),(n,i)=>i===void 0?ih(n):ih(i)-ih(n))}erfc(e,r){return this.runFunction(e.args,r,this.metadata("ERFC"),Fte)}expondist(e,r){return this.runFunction(e.args,r,this.metadata("EXPON.DIST"),(n,i,o)=>o?pj.cdf(n,i):pj.pdf(n,i))}fisher(e,r){return this.runFunction(e.args,r,this.metadata("FISHER"),n=>Math.log((1+n)/(1-n))/2)}fisherinv(e,r){return this.runFunction(e.args,r,this.metadata("FISHERINV"),n=>1-2/(Math.exp(2*n)+1))}gamma(e,r){return this.runFunction(e.args,r,this.metadata("GAMMA"),gg)}gammadist(e,r){return this.runFunction(e.args,r,this.metadata("GAMMA.DIST"),(n,i,o,a)=>a?QC.cdf(n,i,o):QC.pdf(n,i,o))}gammaln(e,r){return this.runFunction(e.args,r,this.metadata("GAMMALN"),yn)}gammainv(e,r){return this.runFunction(e.args,r,this.metadata("GAMMA.INV"),QC.inv)}gauss(e,r){return this.runFunction(e.args,r,this.metadata("GAUSS"),n=>vo.cdf(n,0,1)-.5)}betadist(e,r){return this.runFunction(e.args,r,this.metadata("BETA.DIST"),(n,i,o,a,s,l)=>n<=s?new L(V.NUM,Q.ValueSmall):n>=l?new L(V.NUM,Q.ValueLarge):(n=(n-s)/(l-s),a?ZC.cdf(n,i,o):ZC.pdf(n,i,o)))}betainv(e,r){return this.runFunction(e.args,r,this.metadata("BETA.INV"),(n,i,o,a,s)=>a>=s?new L(V.NUM,Q.WrongOrder):ZC.inv(n,i,o)*(s-a)+a)}binomialdist(e,r){return this.runFunction(e.args,r,this.metadata("BINOM.DIST"),(n,i,o,a)=>n>i?new L(V.NUM,Q.WrongOrder):(n=Math.trunc(n),i=Math.trunc(i),a?x2.cdf(n,i,o):x2.pdf(n,i,o)))}binomialinv(e,r){return this.runFunction(e.args,r,this.metadata("BINOM.INV"),(n,i,o)=>{n=Math.trunc(n);let a=-1,s=n;for(;s>a+1;){const l=Math.trunc((a+s)/2);x2.cdf(l,n,i)>=o?s=l:a=l}return s})}besselifn(e,r){return this.runFunction(e.args,r,this.metadata("BESSELI"),(n,i)=>KA(n,Math.trunc(i)))}besseljfn(e,r){return this.runFunction(e.args,r,this.metadata("BESSELJ"),(n,i)=>YA(n,Math.trunc(i)))}besselkfn(e,r){return this.runFunction(e.args,r,this.metadata("BESSELK"),(n,i)=>Wut(n,Math.trunc(i)))}besselyfn(e,r){return this.runFunction(e.args,r,this.metadata("BESSELY"),(n,i)=>jut(n,Math.trunc(i)))}chisqdist(e,r){return this.runFunction(e.args,r,this.metadata("CHISQ.DIST"),(n,i,o)=>(i=Math.trunc(i),o?xf.cdf(n,i):xf.pdf(n,i)))}chisqdistrt(e,r){return this.runFunction(e.args,r,this.metadata("CHISQ.DIST.RT"),(n,i)=>1-xf.cdf(n,Math.trunc(i)))}chisqinv(e,r){return this.runFunction(e.args,r,this.metadata("CHISQ.INV"),(n,i)=>xf.inv(n,Math.trunc(i)))}chisqinvrt(e,r){return this.runFunction(e.args,r,this.metadata("CHISQ.INV.RT"),(n,i)=>xf.inv(1-n,Math.trunc(i)))}fdist(e,r){return this.runFunction(e.args,r,this.metadata("F.DIST"),(n,i,o,a)=>(i=Math.trunc(i),o=Math.trunc(o),a?Mf.cdf(n,i,o):Mf.pdf(n,i,o)))}fdistrt(e,r){return this.runFunction(e.args,r,this.metadata("F.DIST.RT"),(n,i,o)=>1-Mf.cdf(n,Math.trunc(i),Math.trunc(o)))}finv(e,r){return this.runFunction(e.args,r,this.metadata("F.INV"),(n,i,o)=>Mf.inv(n,Math.trunc(i),Math.trunc(o)))}finvrt(e,r){return this.runFunction(e.args,r,this.metadata("F.INV.RT"),(n,i,o)=>Mf.inv(1-n,Math.trunc(i),Math.trunc(o)))}weibulldist(e,r){return this.runFunction(e.args,r,this.metadata("WEIBULL.DIST"),(n,i,o,a)=>a?yj.cdf(n,o,i):yj.pdf(n,o,i))}poissondist(e,r){return this.runFunction(e.args,r,this.metadata("POISSON.DIST"),(n,i,o)=>(n=Math.trunc(n),o?qA.cdf(n,i):qA.pdf(n,i)))}hypgeomdist(e,r){return this.runFunction(e.args,r,this.metadata("HYPGEOM.DIST"),(n,i,o,a,s)=>n>i||n>o||i>a||o>a?new L(V.NUM,Q.ValueLarge):n+a<o+i?new L(V.NUM,Q.ValueLarge):(n=Math.trunc(n),i=Math.trunc(i),o=Math.trunc(o),a=Math.trunc(a),s?$a.cdf(n,a,o,i):$a.pdf(n,a,o,i)))}tdist(e,r){return this.runFunction(e.args,r,this.metadata("T.DIST"),(n,i,o)=>(i=Math.trunc(i),o?ji.cdf(n,i):ji.pdf(n,i)))}tdist2t(e,r){return this.runFunction(e.args,r,this.metadata("T.DIST.2T"),(n,i)=>(1-ji.cdf(n,Math.trunc(i)))*2)}tdistrt(e,r){return this.runFunction(e.args,r,this.metadata("T.DIST.RT"),(n,i)=>1-ji.cdf(n,Math.trunc(i)))}tdistold(e,r){return this.runFunction(e.args,r,this.metadata("TDIST"),(n,i,o)=>o*(1-ji.cdf(n,Math.trunc(i))))}tinv(e,r){return this.runFunction(e.args,r,this.metadata("T.INV"),(n,i)=>ji.inv(n,Math.trunc(i)))}tinv2t(e,r){return this.runFunction(e.args,r,this.metadata("T.INV.2T"),(n,i)=>ji.inv(1-n/2,Math.trunc(i)))}lognormdist(e,r){return this.runFunction(e.args,r,this.metadata("LOGNORM.DIST"),(n,i,o,a)=>a?e_.cdf(n,i,o):e_.pdf(n,i,o))}lognorminv(e,r){return this.runFunction(e.args,r,this.metadata("LOGNORM.INV"),(n,i,o)=>e_.inv(n,i,o))}normdist(e,r){return this.runFunction(e.args,r,this.metadata("NORM.DIST"),(n,i,o,a)=>a?vo.cdf(n,i,o):vo.pdf(n,i,o))}norminv(e,r){return this.runFunction(e.args,r,this.metadata("NORM.INV"),(n,i,o)=>vo.inv(n,i,o))}normsdist(e,r){return this.runFunction(e.args,r,this.metadata("NORM.S.DIST"),(n,i)=>i?vo.cdf(n,0,1):vo.pdf(n,0,1))}normsinv(e,r){return this.runFunction(e.args,r,this.metadata("NORM.S.INV"),n=>vo.inv(n,0,1))}phi(e,r){return this.runFunction(e.args,r,this.metadata("PHI"),n=>vo.pdf(n,0,1))}negbinomdist(e,r){return this.runFunction(e.args,r,this.metadata("NEGBINOM.DIST"),(n,i,o,a)=>(n=Math.trunc(n),i=Math.trunc(i),a?XA.cdf(n,i,o):XA.pdf(n,i,o)))}confidencenorm(e,r){return this.runFunction(e.args,r,this.metadata("CONFIDENCE.NORM"),(n,i,o)=>Gut(1,n,i,Math.trunc(o))[1]-1)}confidencet(e,r){return this.runFunction(e.args,r,this.metadata("CONFIDENCE.T"),(n,i,o)=>(o=Math.trunc(o),o===1?new L(V.DIV_BY_ZERO):Yut(1,n,i,o)[1]-1))}standardize(e,r){return this.runFunction(e.args,r,this.metadata("STANDARDIZE"),(n,i,o)=>(n-i)/o)}}Xx.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:S.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:S.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:S.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:S.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:S.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:S.NUMBER,minValue:0,lessThan:1},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:S.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.BOOLEAN},{argumentType:S.NUMBER,defaultValue:0},{argumentType:S.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:S.NUMBER,greaterThan:0,maxValue:1},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,defaultValue:0},{argumentType:S.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:0,maxValue:1},{argumentType:S.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:0,maxValue:1},{argumentType:S.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,minValue:1,maxValue:1e10},{argumentType:S.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:S.NUMBER,minValue:0,maxValue:1},{argumentType:S.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:S.NUMBER,minValue:0,maxValue:1},{argumentType:S.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:1},{argumentType:S.NUMBER,minValue:1},{argumentType:S.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:1},{argumentType:S.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:S.NUMBER,minValue:0,maxValue:1},{argumentType:S.NUMBER,minValue:1},{argumentType:S.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:S.NUMBER,minValue:0,maxValue:1},{argumentType:S.NUMBER,minValue:1},{argumentType:S.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:0},{argumentType:S.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,minValue:1},{argumentType:S.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:1},{argumentType:S.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:S.NUMBER,greaterThan:0,lessThan:1},{argumentType:S.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:S.NUMBER,greaterThan:0,maxValue:1},{argumentType:S.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:S.NUMBER,greaterThan:0,lessThan:1},{argumentType:S.NUMBER},{argumentType:S.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:S.NUMBER,greaterThan:0,lessThan:1},{argumentType:S.NUMBER},{argumentType:S.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:S.NUMBER},{argumentType:S.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:S.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:S.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:1},{argumentType:S.NUMBER,minValue:0,maxValue:1},{argumentType:S.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:S.NUMBER,greaterThan:0,lessThan:1},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:S.NUMBER,greaterThan:0,lessThan:1},{argumentType:S.NUMBER,greaterThan:0},{argumentType:S.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER,greaterThan:0}]}};Xx.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Wte extends pt{fact(e,r){return this.runFunction(e.args,r,this.metadata("FACT"),n=>{n=Math.trunc(n);let i=1;for(let o=1;o<=n;o++)i*=o;return i})}factdouble(e,r){return this.runFunction(e.args,r,this.metadata("FACTDOUBLE"),n=>{n=Math.trunc(n);let i=1;for(let o=n;o>=1;o-=2)i*=o;return i})}combin(e,r){return this.runFunction(e.args,r,this.metadata("COMBIN"),(n,i)=>i>n?new L(V.NUM,Q.WrongOrder):(n=Math.trunc(n),i=Math.trunc(i),bj(n,i)))}combina(e,r){return this.runFunction(e.args,r,this.metadata("COMBINA"),(n,i)=>(n=Math.trunc(n),i=Math.trunc(i),n+i-1>=1030?new L(V.NUM,Q.ValueLarge):n===0&&i===0?1:bj(n+i-1,i)))}gcd(e,r){return this.runFunction(e.args,r,this.metadata("GCD"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(n);if(i instanceof L)return i;let o=0;for(const a of i){if(a<0)return new L(V.NUM,Q.ValueSmall);o=zte(o,Math.trunc(a))}return o>Number.MAX_SAFE_INTEGER?new L(V.NUM,Q.ValueLarge):o})}lcm(e,r){return this.runFunction(e.args,r,this.metadata("LCM"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(n);if(i instanceof L)return i;let o=1;for(const a of i){if(a<0)return new L(V.NUM,Q.ValueSmall);o=Xut(o,Math.trunc(a))}return o>Number.MAX_SAFE_INTEGER?new L(V.NUM,Q.ValueLarge):o})}mround(e,r){return this.runFunction(e.args,r,this.metadata("MROUND"),(n,i)=>i===0?0:n>0&&i<0||n<0&&i>0?new L(V.NUM,Q.DistinctSigns):Math.round(n/i)*i)}multinomial(e,r){return this.runFunction(e.args,r,this.metadata("MULTINOMIAL"),(...n)=>{let i=0,o=1;for(let a of n){if(a<0)return new L(V.NUM,Q.ValueSmall);a=Math.trunc(a);for(let s=1;s<=a;s++)o*=(i+s)/s;i+=a}return Math.round(o)})}quotient(e,r){return this.runFunction(e.args,r,this.metadata("QUOTIENT"),(n,i)=>i===0?new L(V.DIV_BY_ZERO):Math.trunc(n/i))}seriessum(e,r){return this.runFunction(e.args,r,this.metadata("SERIESSUM"),(n,i,o,a)=>{const s=this.arithmeticHelper.manyToOnlyNumbersDropNulls(a.valuesFromTopLeftCorner());if(s instanceof L)return s;let l=0;s.reverse();for(const u of s)l*=Math.pow(n,o),l+=u;return l*Math.pow(n,i)})}sign(e,r){return this.runFunction(e.args,r,this.metadata("SIGN"),n=>n>0?1:n<0?-1:0)}sumx2my2(e,r){return this.runFunction(e.args,r,this.metadata("SUMX2MY2"),(n,i)=>{const o=n.valuesFromTopLeftCorner(),a=i.valuesFromTopLeftCorner();if(o.length!==a.length)return new L(V.NA,Q.EqualLength);const s=o.length;let l=0;for(let u=0;u<s;u++){const c=o[u],f=a[u];if(c instanceof L)return c;if(f instanceof L)return f;typeof c=="number"&&typeof f=="number"&&(l+=Math.pow(c,2)-Math.pow(f,2))}return l})}sumx2py2(e,r){return this.runFunction(e.args,r,this.metadata("SUMX2PY2"),(n,i)=>{const o=n.valuesFromTopLeftCorner(),a=i.valuesFromTopLeftCorner();if(o.length!==a.length)return new L(V.NA,Q.EqualLength);const s=o.length;let l=0;for(let u=0;u<s;u++){const c=o[u],f=a[u];if(c instanceof L)return c;if(f instanceof L)return f;typeof c=="number"&&typeof f=="number"&&(l+=Math.pow(c,2)+Math.pow(f,2))}return l})}sumxmy2(e,r){return this.runFunction(e.args,r,this.metadata("SUMXMY2"),(n,i)=>{const o=n.valuesFromTopLeftCorner(),a=i.valuesFromTopLeftCorner();if(o.length!==a.length)return new L(V.NA,Q.EqualLength);const s=o.length;let l=0;for(let u=0;u<s;u++){const c=o[u],f=a[u];if(c instanceof L)return c;if(f instanceof L)return f;typeof c=="number"&&typeof f=="number"&&(l+=Math.pow(c-f,2))}return l})}}Wte.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:S.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:S.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:S.NUMBER,minValue:0,lessThan:1030},{argumentType:S.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:S.NUMBER,minValue:0},{argumentType:S.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:S.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:S.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE}]}};function bj(t,e){2*e>t&&(e=t-e);let r=1;for(let n=1;n<=e;n++)r*=(t-e+n)/n;return Math.round(r)}function zte(t,e){for(t<e&&([t,e]=[e,t]);e>0;)[t,e]=[e,t%e];return t}function Xut(t,e){return t===0||e===0?0:t*(e/zte(t,e))}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Gte extends pt{complex(e,r){return this.runFunction(e.args,r,this.metadata("COMPLEX"),(n,i,o)=>o!=="i"&&o!=="j"?new L(V.VALUE,Q.ShouldBeIorJ):Ar([n,i],o))}imabs(e,r){return this.runFunction(e.args,r,this.metadata("IMABS"),qte)}imaginary(e,r){return this.runFunction(e.args,r,this.metadata("IMAGINARY"),([n,i])=>i)}imreal(e,r){return this.runFunction(e.args,r,this.metadata("IMREAL"),([n,i])=>n)}imargument(e,r){return this.runFunction(e.args,r,this.metadata("IMARGUMENT"),([n,i])=>n===0&&i===0?new L(V.DIV_BY_ZERO):Math.atan2(i,n))}imconjugate(e,r){return this.runFunction(e.args,r,this.metadata("IMCONJUGATE"),([n,i])=>Ar([n,-i]))}imcos(e,r){return this.runFunction(e.args,r,this.metadata("IMCOS"),n=>Ar(yb(n)))}imcosh(e,r){return this.runFunction(e.args,r,this.metadata("IMCOSH"),n=>Ar(wj(n)))}imcot(e,r){return this.runFunction(e.args,r,this.metadata("IMCOT"),n=>Ar(ql(yb(n),vb(n))))}imcsc(e,r){return this.runFunction(e.args,r,this.metadata("IMCSC"),n=>Ar(ql([1,0],vb(n))))}imcsch(e,r){return this.runFunction(e.args,r,this.metadata("IMCSCH"),n=>Ar(ql([1,0],Sj(n))))}imsec(e,r){return this.runFunction(e.args,r,this.metadata("IMSEC"),n=>Ar(ql([1,0],yb(n))))}imsech(e,r){return this.runFunction(e.args,r,this.metadata("IMSECH"),n=>Ar(ql([1,0],wj(n))))}imsin(e,r){return this.runFunction(e.args,r,this.metadata("IMSIN"),n=>Ar(vb(n)))}imsinh(e,r){return this.runFunction(e.args,r,this.metadata("IMSINH"),n=>Ar(Sj(n)))}imtan(e,r){return this.runFunction(e.args,r,this.metadata("IMTAN"),n=>Ar(ql(vb(n),yb(n))))}imdiv(e,r){return this.runFunction(e.args,r,this.metadata("IMDIV"),(n,i)=>Ar(ql(n,i)))}improduct(e,r){return this.runFunction(e.args,r,this.metadata("IMPRODUCT"),(...n)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(n);if(i instanceof L)return i;let o=[1,0];for(const a of i)o=Yte(o,a);return Ar(o)})}imsum(e,r){return this.runFunction(e.args,r,this.metadata("IMSUM"),(...n)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(n);if(i instanceof L)return i;let o=[0,0];for(const a of i)o=Qut(o,a);return Ar(o)})}imsub(e,r){return this.runFunction(e.args,r,this.metadata("IMSUB"),(n,i)=>Ar(Zut(n,i)))}imexp(e,r){return this.runFunction(e.args,r,this.metadata("IMEXP"),n=>Ar(Kte(n)))}imln(e,r){return this.runFunction(e.args,r,this.metadata("IMLN"),n=>Ar(N2(n)))}imlog10(e,r){return this.runFunction(e.args,r,this.metadata("IMLOG10"),n=>{const[i,o]=N2(n),a=Math.log(10);return Ar([i/a,o/a])})}imlog2(e,r){return this.runFunction(e.args,r,this.metadata("IMLOG2"),n=>{const[i,o]=N2(n),a=Math.log(2);return Ar([i/a,o/a])})}impower(e,r){return this.runFunction(e.args,r,this.metadata("IMPOWER"),(n,i)=>Ar(Rj(n,i)))}imsqrt(e,r){return this.runFunction(e.args,r,this.metadata("IMSQRT"),n=>Ar(Rj(n,.5)))}}Gte.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:S.NUMBER},{argumentType:S.NUMBER},{argumentType:S.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:S.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:S.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:S.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:S.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:S.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:S.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:S.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:S.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:S.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:S.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:S.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:S.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:S.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:S.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:S.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:S.COMPLEX},{argumentType:S.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:S.COMPLEX},{argumentType:S.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:S.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:S.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:S.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:S.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:S.COMPLEX},{argumentType:S.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:S.COMPLEX}]}};function Qut([t,e],[r,n]){return[t+r,e+n]}function Zut([t,e],[r,n]){return[t-r,e-n]}function Yte([t,e],[r,n]){return[t*r-e*n,t*n+r*e]}function ql([t,e],[r,n]){const i=Math.pow(r,2)+Math.pow(n,2),[o,a]=Yte([t,e],[r,-n]);return[o/i,a/i]}function yb([t,e]){return[Math.cos(t)*Math.cosh(e),-Math.sin(t)*Math.sinh(e)]}function wj([t,e]){return[Math.cosh(t)*Math.cos(e),Math.sinh(t)*Math.sin(e)]}function vb([t,e]){return[Math.sin(t)*Math.cosh(e),Math.cos(t)*Math.sinh(e)]}function Sj([t,e]){return[Math.sinh(t)*Math.cos(e),Math.cosh(t)*Math.sin(e)]}function Kte([t,e]){return[Math.exp(t)*Math.cos(e),Math.exp(t)*Math.sin(e)]}function qte([t,e]){return Math.sqrt(t*t+e*e)}function N2([t,e]){return[Math.log(qte([t,e])),Math.atan2(e,t)]}function Rj(t,e){const[r,n]=N2(t);return Kte([e*r,e*n])}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Qx extends pt{avedev(e,r){return this.runFunction(e.args,r,this.metadata("AVEDEV"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof L)return i;if(i.length===0)return new L(V.DIV_BY_ZERO);const o=Ui(i);return i.reduce((a,s)=>a+Math.abs(s-o),0)/i.length})}devsq(e,r){return this.runFunction(e.args,r,this.metadata("DEVSQ"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);return i instanceof L?i:i.length===0?0:Zl(i)})}geomean(e,r){return this.runFunction(e.args,r,this.metadata("GEOMEAN"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof L)return i;if(i.length===0)return new L(V.NUM,Q.OneValue);for(const o of i)if(o<=0)return new L(V.NUM,Q.ValueSmall);return qut(i)})}harmean(e,r){return this.runFunction(e.args,r,this.metadata("HARMEAN"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof L)return i;if(i.length===0)return new L(V.NUM,Q.OneValue);for(const o of i)if(o<=0)return new L(V.NUM,Q.ValueSmall);return i.length/i.reduce((o,a)=>o+1/a,0)})}correl(e,r){return this.runFunction(e.args,r,this.metadata("CORREL"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new L(V.NA,Q.EqualLength);const o=Xl(n,i);return o instanceof L?o:o[0].length<=1?new L(V.DIV_BY_ZERO,Q.TwoValues):vj(o[0],o[1])})}rsq(e,r){return this.runFunction(e.args,r,this.metadata("RSQ"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new L(V.NA,Q.EqualLength);const o=Xl(n,i);return o instanceof L?o:o[0].length<=1?new L(V.DIV_BY_ZERO,Q.TwoValues):Math.pow(vj(o[0],o[1]),2)})}covariancep(e,r){return this.runFunction(e.args,r,this.metadata("COVARIANCE.P"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new L(V.NA,Q.EqualLength);const o=Xl(n,i);if(o instanceof L)return o;const a=o[0].length;return a<1?new L(V.DIV_BY_ZERO,Q.OneValue):a===1?0:Gm(o[0],o[1])*(a-1)/a})}covariances(e,r){return this.runFunction(e.args,r,this.metadata("COVARIANCE.S"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new L(V.NA,Q.EqualLength);const o=Xl(n,i);return o instanceof L?o:o[0].length<=1?new L(V.DIV_BY_ZERO,Q.TwoValues):Gm(o[0],o[1])})}ztest(e,r){return this.runFunction(e.args,r,this.metadata("Z.TEST"),(n,i,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());if(a instanceof L)return a;const s=a.length;if(o===void 0){if(s<2)return new L(V.DIV_BY_ZERO,Q.TwoValues);o=qs(a,!0)}return s<1?new L(V.NA,Q.OneValue):o===0?new L(V.DIV_BY_ZERO):1-vo.cdf((Ui(a)-i)/(o/Math.sqrt(s)),0,1)})}ftest(e,r){return this.runFunction(e.args,r,this.metadata("F.TEST"),(n,i)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner()),a=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(o instanceof L)return o;if(a instanceof L)return a;if(o.length<=1||a.length<=1)return new L(V.DIV_BY_ZERO);const s=zm(o,!0),l=zm(a,!0);if(s===0||l===0)return new L(V.DIV_BY_ZERO);const u=s/l,c=Mf.cdf(u,o.length-1,a.length-1);return 2*Math.min(c,1-c)})}steyx(e,r){return this.runFunction(e.args,r,this.metadata("STEYX"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new L(V.NA,Q.EqualLength);const o=Xl(n,i);if(o instanceof L)return o;const a=o[0].length;return a<=2?new L(V.DIV_BY_ZERO,Q.ThreeValues):Math.sqrt((Zl(o[0])-Math.pow(Gm(o[0],o[1])*(a-1),2)/Zl(o[1]))/(a-2))})}slope(e,r){return this.runFunction(e.args,r,this.metadata("SLOPE"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new L(V.NA,Q.EqualLength);const o=Xl(n,i);if(o instanceof L)return o;const a=o[0].length;return a<=1?new L(V.DIV_BY_ZERO,Q.TwoValues):Gm(o[0],o[1])*(a-1)/Zl(o[1])})}chisqtest(e,r){return this.runFunction(e.args,r,this.metadata("CHISQ.TEST"),(n,i)=>{const o=n.height(),a=n.width();if(i.height()!==o||i.width()!==a)return new L(V.NA,Q.EqualLength);const s=Xl(n,i);if(s instanceof L)return s;if(s[0].length<=1)return new L(V.DIV_BY_ZERO,Q.TwoValues);let l=0;for(let u=0;u<s[0].length;u++){if(s[1][u]===0)return new L(V.DIV_BY_ZERO);l+=Math.pow(s[0][u]-s[1][u],2)/s[1][u]}return l<0?new L(V.NUM,Q.NaN):1-xf.cdf(l,o>1&&a>1?(o-1)*(a-1):o*a-1)})}ttest(e,r){return this.runFunction(e.args,r,this.metadata("T.TEST"),(n,i,o,a)=>{const s=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner()),l=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(s instanceof L)return s;if(l instanceof L)return l;const u=s.length,c=l.length;if(a===1){if(c!==u)return new L(V.NA,Q.EqualLength);if(u<=1)return new L(V.DIV_BY_ZERO,Q.TwoValues);const f=Array(u);for(let p=0;p<u;p++)f[p]=s[p]-l[p];const h=qs(f,!0);if(h===0)return new L(V.DIV_BY_ZERO);const d=Math.abs(Math.sqrt(u)*Ui(f)/h);return o*(1-ji.cdf(d,u-1))}else if(a===2){if(u<=1||c<=1)return new L(V.DIV_BY_ZERO,Q.TwoValues);const f=(Zl(s)+Zl(l))/(u+c-2);if(f===0)return new L(V.DIV_BY_ZERO);const h=Math.abs((Ui(s)-Ui(l))/Math.sqrt(f*(1/u+1/c)));return o*(1-ji.cdf(h,u+c-2))}else{if(u<=1||c<=1)return new L(V.DIV_BY_ZERO,Q.TwoValues);const f=zm(s,!0),h=zm(l,!0);if(f===0&&h===0)return new L(V.DIV_BY_ZERO);const d=Math.abs((Ui(s)-Ui(l))/Math.sqrt(f/u+h/c)),p=Math.pow(f/u+h/c,2)/(Math.pow(f/u,2)/(u-1)+Math.pow(h/c,2)/(c-1));return o*(1-ji.cdf(d,p))}})}skew(e,r){return this.runFunction(e.args,r,this.metadata("SKEW"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof L)return i;const o=i.length;if(o<3)return new L(V.DIV_BY_ZERO,Q.ThreeValues);const a=Ui(i),s=qs(i,!0);return s===0?new L(V.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-a)/s,3),0)*o/(o-1)/(o-2)})}skewp(e,r){return this.runFunction(e.args,r,this.metadata("SKEW.P"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof L)return i;const o=i.length;if(o<3)return new L(V.DIV_BY_ZERO,Q.ThreeValues);const a=Ui(i),s=qs(i,!1);return s===0?new L(V.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-a)/s,3),0)/o})}}Qx.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:S.RANGE},{argumentType:S.NUMBER},{argumentType:S.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:S.RANGE},{argumentType:S.RANGE},{argumentType:S.INTEGER,minValue:1,maxValue:2},{argumentType:S.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:S.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:S.ANY}],repeatLastArgs:1}};Qx.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};function Xl(t,e){const r=t.iterateValuesFromTopLeftCorner(),n=e.iterateValuesFromTopLeftCorner();let i,o;const a=[],s=[];for(;i=r.next(),o=n.next(),!i.done&&!o.done;){const l=i.value,u=o.value;if(l instanceof L)return l;if(u instanceof L)return u;Ft(l)&&Ft(u)&&(a.push(Ne(l)),s.push(Ne(u)))}return[a,s]}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Ej=Object.freeze(Object.defineProperty({__proto__:null,ArrayPlugin:qee,AbsPlugin:Xee,BitShiftPlugin:Qee,BitwiseLogicOperationsPlugin:tte,BooleanPlugin:rte,CharPlugin:nte,CodePlugin:ite,CountBlankPlugin:ote,CountUniquePlugin:ate,DateTimePlugin:ste,DegreesPlugin:lte,DeltaPlugin:ute,ExpPlugin:cte,FinancialPlugin:fte,FormulaTextPlugin:hte,InformationPlugin:dte,IsEvenPlugin:pte,IsOddPlugin:mte,LogarithmPlugin:gte,MathConstantsPlugin:yte,MatrixPlugin:vte,MedianPlugin:bte,ModuloPlugin:wte,NumericAggregationPlugin:zx,PowerPlugin:Ste,RadiansPlugin:Rte,RadixConversionPlugin:Cte,RandomPlugin:Ote,RoundingPlugin:Gx,SqrtPlugin:Ate,ConditionalAggregationPlugin:Ite,SumprodPlugin:xte,TextPlugin:Mte,TrigonometryPlugin:Nte,LookupPlugin:Pte,RomanPlugin:kte,SimpleArithmerticPlugin:$te,StatisticalPlugin:Xx,MathPlugin:Wte,ComplexPlugin:Gte,StatisticalAggregationPlugin:Qx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class It extends Nn{}It.HyperFormula=Nn;It.ErrorType=V;It.CellType=li;It.CellValueType=_o;It.CellValueDetailedType=Bst;It.DetailedCellError=Pee;It.ExportedCellChange=VA;It.ExportedNamedExpressionChange=jee;It.ConfigValueTooBigError=wee;It.ConfigValueTooSmallError=bee;It.EvaluationSuspendedError=Ree;It.ExpectedOneOfValuesError=See;It.ExpectedValueOfTypeError=Bt;It.ArraySize=yt;It.FunctionPlugin=pt;It.FunctionArgumentType=S;It.FunctionPluginValidationError=yp;It.InvalidAddressError=hee;It.InvalidArgumentsError=Qr;It.LanguageNotRegisteredError=NA;It.LanguageAlreadyRegisteredError=Cee;It.MissingTranslationError=Af;It.NamedExpressionDoesNotExistError=Lv;It.NamedExpressionNameIsAlreadyTakenError=dee;It.NamedExpressionNameIsInvalidError=pee;It.NoOperationToRedoError=gee;It.NoOperationToUndoError=mee;It.NoRelativeAddressesAllowedError=Hx;It.NoSheetWithIdError=yr;It.NoSheetWithNameError=fee;It.NotAFormulaError=MA;It.NothingToPasteError=yee;It.ProtectedFunctionTranslationError=Eee;It.SheetNameAlreadyTakenError=kv;It.SheetSizeLimitExceededError=Vu;It.SourceLocationHasArrayError=Df;It.TargetLocationHasArrayError=dS;It.UnableToParseError=vee;const Jut=An.defaultConfig.language;Nn.registerLanguage(Jut,jA);Nn.languages[jA.langCode]=jA;for(const t of Object.getOwnPropertyNames(Ej))t.startsWith("_")||Nn.registerFunctionPlugin(Ej[t]);snt();const ect=It.buildEmpty({licenseKey:"internal-use-in-handsontable"}),Xte={startDate:At().toString(),endDate:At().add(1,"M").toString(),expenditure:[["Line item name","Amount"]],income:[["Line item name","Amount"]],total:[["Total","=sum(income!B1:B9999) - sum(expenditure!B1:B9999)"]]},tct=wz("dataAtom",Xte),rct=()=>{YS(o=>o.database);const[t,e]=Es(tct);return ce.exports.useEffect(()=>{t.total.length>1&&e({...t,total:Xte.total})},[]),ve.createElement(bt,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",sx:{width:"90vw"},spacing:1},ve.createElement(bt,{item:!0,xs:6},ve.createElement(n,{value:t.startDate,label:"Start Date",dataKey:"startDate"})),ve.createElement(bt,{item:!0,xs:6},ve.createElement(n,{value:t.endDate,label:"End Date",dataKey:"endDate"})),ve.createElement(bt,{item:!0,xs:12},ve.createElement(i,{data:t.expenditure,reducerKey:"expenditure",updateData:r})),ve.createElement(bt,{item:!0,xs:12},ve.createElement(i,{data:t.income,reducerKey:"income",updateData:r})),ve.createElement(bt,{item:!0,xs:12},ve.createElement(i,{data:t.total,reducerKey:"total",updateData:r,minSpareRows:0,rowHeaders:!1,readOnly:!0})));function r(o){const{type:a,payload:s}=o,l=e;switch(o.type){case"startDate":case"endDate":case"expenditure":case"income":l({...t,[a]:s});break}}function n({dataKey:o,label:a,value:s}){return ve.createElement(Tz,{dateAdapter:Oz},ve.createElement(Az,{inputFormat:"DD MMM YYYY",label:a,onChange:l=>r({type:o,payload:l}),value:At(s),renderInput:l=>ve.createElement(eu,{fullWidth:!0,...l})}))}function i({reducerKey:o,data:a,updateData:s,minSpareRows:l=1,rowHeaders:u=!0,readOnly:c=!1}){function f(h,d,p,m,g,v,w){Os.apply(this,arguments),d.style.fontWeight="bold",d.style.color=(()=>{switch(o){case"expenditure":return"red";case"income":return"green";case"total":default:return"black"}})(),d.style.textAlign="center"}return ve.createElement(jae,{sx:{width:"90vw"}},ve.createElement(ZZ,{stretchH:"all",width:"100%",data:a,rowHeaders:u,minSpareRows:l,readOnly:c,licenseKey:"non-commercial-and-evaluation",formulas:{engine:ect,sheetName:o},cells:(h,d)=>{const p={};return h===0&&(p.readOnly=!0,p.renderer=f),p},beforeChange:h=>{let d=Zi.exports.cloneDeep(a);h.forEach(p=>{if(p===null)return;const[m,g,v,w]=p;console.log({row:m,col:g,oldVal:v,newVal:w}),m>a.length&&Zi.exports.concat(d,new Array(a.length-m).fill("")),typeof g=="number"&&(d[m][g]=w)}),s({type:o,payload:d})}}))}},nct=Sl(ye.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add"),ict=Sl(ye.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}),"ArrowBack"),oct=Sl(ye.jsx("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward"),act=Sl(ye.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear"),sct=Sl(ye.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),lct=Sl(ye.jsx("path",{d:"M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2H6zm10 14.5V20H8v-3.5l4-4 4 4zm-4-5-4-4V4h8v3.5l-4 4z"}),"HourglassEmpty"),uct=Sl(ye.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm.88 15.76V19h-1.75v-1.29c-.74-.18-2.39-.77-3.02-2.96l1.65-.67c.06.22.58 2.09 2.4 2.09.93 0 1.98-.48 1.98-1.61 0-.96-.7-1.46-2.28-2.03-1.1-.39-3.35-1.03-3.35-3.31 0-.1.01-2.4 2.62-2.96V5h1.75v1.24c1.84.32 2.51 1.79 2.66 2.23l-1.58.67c-.11-.35-.59-1.34-1.9-1.34-.7 0-1.81.37-1.81 1.39 0 .95.86 1.31 2.64 1.9 2.4.83 3.01 2.05 3.01 3.45 0 2.63-2.5 3.13-3.02 3.22z"}),"Paid"),cct=Sl(ye.jsx("path",{d:"M19 13H5v-2h14v2z"}),"Remove");var Io={exports:{}};const fct=vz(joe);(function(t,e){(function(r,n){n(e,fct,ce.exports)})(uh,function(r,n,i){function o(c){return c&&typeof c=="object"&&"default"in c?c:{default:c}}var a=o(i);function s(c,f,h){var d,p;typeof c=="function"?(d=f||[],p=h):(d=[],p=f);var m=a.default.useRef({hasResult:!1,result:p,error:null}),g=a.default.useReducer(function(b){return b+1},0);g[0];var v=g[1],w=a.default.useMemo(function(){var b=typeof c=="function"?c():c;if(!b||typeof b.subscribe!="function")throw c===b?new TypeError("Given argument to useObservable() was neither a valid observable nor a function."):new TypeError("Observable factory given to useObservable() did not return a valid observable.");if(!m.current.hasResult)if(typeof b.getValue=="function")m.current.result=b.getValue(),m.current.hasResult=!0;else{var E=b.subscribe(function(A){m.current.result=A,m.current.hasResult=!0});typeof E=="function"?E():E.unsubscribe()}return b},d);if(a.default.useDebugValue(m.current.result),a.default.useEffect(function(){var b=w.subscribe(function(E){var A=m.current;(A.error!==null||A.result!==E)&&(A.error=null,A.result=E,A.hasResult=!0,v())},function(E){var A=m.current;A.error!==E&&(A.error=E,v())});return typeof b=="function"?b:b.unsubscribe.bind(b)},d),m.current.error)throw m.current.error;return m.current.result}function l(c,f,h){return s(function(){return n.liveQuery(c)},f||[],h)}function u(c,f,h){if(!c)throw new TypeError("Invalid arguments to usePermissions(): undefined or null");var d;if(arguments.length>=3){if(!("transaction"in c))throw new TypeError("Invalid arguments to usePermission(db, table, obj): 1st arg must be a Dexie instance");if(typeof f!="string")throw new TypeError("Invalid arguments to usePermission(db, table, obj): 2nd arg must be string");if(!h||typeof h!="object")throw new TypeError("Invalid arguments to usePermission(db, table, obj): 3rd arg must be an object");d=c}else{if(c instanceof n.Dexie)throw new TypeError("Invalid arguments to usePermission(db, table, obj): Missing table and obj arguments.");if(typeof c.table=="function"&&typeof c.db=="object")d=c.db,h=c,f=c.table();else throw new TypeError("Invalid arguments to usePermissions(). Expected usePermissions(entity: DexieCloudEntity) or usePermissions(db: Dexie, table: string, obj: DexieCloudObject)")}if(!("cloud"in d))throw new Error("usePermissions() is only for Dexie Cloud but there's no dexie-cloud-addon active in given db.");if(!("permissions"in d.cloud))throw new Error("usePermissions() requires a newer version of dexie-cloud-addon. Please upgrade it.");return s(function(){return d.cloud.permissions(h,f)},[h.realmId,h.owner,f])}r.useLiveQuery=l,r.useObservable=s,r.usePermissions=u,Object.defineProperty(r,"__esModule",{value:!0})})})(Io,Io.exports);const Qte=Sz({show:!1,message:"",severity:"info"}),hct=()=>{const[t,e]=Es(Qte),r=(i,o)=>{o!=="clickaway"&&e({...t,show:!1})},n=ve.createElement(ve.Fragment,null,ve.createElement(Cg,{size:"small","aria-label":"close",color:"inherit",onClick:r},ve.createElement(sct,{fontSize:"small"})));return ve.createElement(Joe,{open:t.show,autoHideDuration:3e3,onClose:r,action:n},ve.createElement(eae,{severity:t.severity},t.message))},dct=hct,t_={[ur.category]:[],[ur.name]:"",[ur.amount]:"",[ur.datetime]:At().unix(),[ur.transactionType]:dn.CREDIT,[ur.creditCard]:""},pct=()=>{const t=YS(p=>p.database),[,e]=Es(Qte),r=Io.exports.useLiveQuery(async()=>{const p=await t.expenditure.toArray(),m=await t.recurring.toArray(),g=p.reduce((E,A)=>[...E,...JSON.parse(A[ur.category])],[]),v=m.reduce((E,A)=>[...E,A.name],[]),w=p.map(E=>E[ur.creditCard]),b=m.map(E=>E.credit_card);return{categories:Zi.exports.uniq([...g,...v]).filter(E=>E!==void 0),creditCards:Zi.exports.uniq([...w,...b]).filter(E=>E!==void 0)}}),[n,i]=ce.exports.useState(t_),[o,a]=ce.exports.useState(!1),[s,l]=ce.exports.useState("monthly");function u(p,m){i({...n,[p]:m})}function c(p){if(!!Object.values(n).some(v=>v===""||v===null||v===void 0)){e({show:!1,message:"Please fill in all fields first.",severity:"error"});return}const g=JSON.stringify(n.category);if(p===dn.RECURRING){if(o===!1){a(!0);return}let v=At.unix(n.datetime),w;switch(s){case"weekly":w=`${s} ${v.day()}`;break;case"monthly":w=`${s} ${v.date()}`;break;case"yearly":w=`${s} ${v.format("DD-MM")}`;break;default:w=`${s} ${v.day()}`;break}t.recurring.add({name:n.name,amount:parseFloat(n.amount),cron:w,start:n.datetime,category:g,credit_card:n.credit_card}).then(()=>{e({message:"Recorded!",severity:"success",show:!0}),i({...t_,[ur.datetime]:At().unix()})});return}t.expenditure.add({...n,category:g,[ur.transactionType]:p}).then(()=>{e({message:"Recorded!",severity:"success",show:!0}),i({...t_,[ur.datetime]:At().unix()})})}const f=[{endIcon:ve.createElement(uct,null),type:dn.SALARY,color:"info"},{endIcon:ve.createElement(nct,null),type:dn.DEBIT,color:"success"},{endIcon:ve.createElement(lct,null),type:dn.RECURRING,color:"warning"},{endIcon:ve.createElement(cct,null),type:dn.CREDIT,color:"error"}],h={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"75vw",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},d=()=>{const p=m=>{let g=parseInt(m);return g===1?"st":g===2?"nd":g===3?"rd":"th"};return ve.createElement(kae,{open:o,onClose:()=>a(!1)},ve.createElement(Zs,{sx:h},ve.createElement($ae,null,ve.createElement(Lae,null,"Type of reccurence"),ve.createElement(Koe,{value:s,onChange:m=>l(m.target.value)},ve.createElement(mR,{value:"weekly",control:ve.createElement(dR,null),label:"Weekly"}),ve.createElement(mR,{value:"monthly",control:ve.createElement(dR,null),label:"Monthly"}),ve.createElement(mR,{value:"yearly",control:ve.createElement(dR,null),label:"Yearly"}))),ve.createElement(ps,null,"This will recur ",s,s==="yearly"?` on ${At.unix(n.datetime).format("D MMMM")}`:s==="monthly"?` on the ${At.unix(n.datetime).format("D")}${p(At.unix(n.datetime).format("D"))} day`:` every ${At.unix(n.datetime).format("dddd")}`),ve.createElement(B2,{onClick:()=>{c(dn.RECURRING),a(!1)}},"confirm")))};return ve.createElement("div",null,ve.createElement(bt,{container:!0,justifyContent:"center",alignItems:"center",direction:"column",spacing:2},ve.createElement(bt,{item:!0},ve.createElement(I_,{size:"small",clearOnEscape:!0,freeSolo:!0,autoSelect:!0,autoComplete:!0,options:(r==null?void 0:r.creditCards)||[],sx:{width:"80vw"},value:n[ur.creditCard],onChange:(p,m)=>u(ur.creditCard,m),renderInput:p=>ve.createElement(eu,{...p,label:"Source"})})),ve.createElement(bt,{item:!0},ve.createElement(I_,{size:"small",clearOnEscape:!0,freeSolo:!0,autoSelect:!0,autoComplete:!0,multiple:!0,options:(r==null?void 0:r.categories)||[],sx:{width:"80vw"},value:n[ur.category],onChange:(p,m)=>u(ur.category,m),renderInput:p=>ve.createElement(eu,{...p,label:"Categories"})})),ve.createElement(bt,{item:!0},ve.createElement(eu,{size:"small",label:"Name",sx:{width:"80vw"},value:n[ur.name],onChange:p=>u(ur.name,p.target.value),inputProps:{autoCapitalize:"none"},InputProps:{endAdornment:ve.createElement(Hae,{position:"end"},n.name!==""&&ve.createElement(Cg,{size:"small",onClick:()=>u(ur.name,"")},ve.createElement(act,null)))}})),ve.createElement(bt,{item:!0},ve.createElement(Bae,{size:"small",style:{width:"80vw"},value:n[ur.amount],onChange:p=>u(ur.amount,Number(p.target.value.replace(/[^0-9.]/g,""))),prefix:"$",thousandSeparator:!0,customInput:eu,label:"Amount",inputProps:{inputMode:"decimal"}})),ve.createElement(bt,{item:!0},ve.createElement(Tz,{dateAdapter:Oz,adapterLocale:"en-sg"},ve.createElement(Az,{label:"Date",value:At.unix(n[ur.datetime]),onChange:p=>u(ur.datetime,p===null?null:p.unix()),renderInput:p=>ve.createElement(eu,{sx:{width:"80vw"},...p})}))),ve.createElement(bt,{item:!0},ve.createElement(bt,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:2},f.map((p,m)=>ve.createElement(bt,{item:!0,xs:6,key:m},ve.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},ve.createElement(B2,{variant:"contained",color:p.color,endIcon:p.endIcon,size:"small",onClick:()=>c(p.type)},p.type))))))),ve.createElement(d,null))},mct=({title:t})=>ve.createElement(ps,{variant:"body1"},t),gf=({title:t,value:e,color:r})=>ve.createElement("div",null,ve.createElement(mct,{title:t}),ve.createElement(ps,{variant:"h6",style:{color:r}},e)),gct=async(t,e)=>{var c;const r=await Ba.expenditure.toArray(),n=r.filter(f=>f.datetime>=t&&f.datetime<=e);let i=n.reduce((f,h)=>f+Number(h.amount)*(Woe.includes(h.txn_type)?1:-1),0),o=Zi.exports.sortBy(n.filter(f=>zoe.includes(f.txn_type)),["datetime"]).reduce((f,h)=>f+h.amount,0);const a=Uv(await Ba.recurring.where("start").belowOrEqual(At().unix()).toArray(),t,At().unix()).filter(f=>f.datetime>=t&&f.datetime<e).reduce((f,h)=>f+h.amount,0),s=((c=await Ba.expenditure.where({txn_type:dn.SALARY}).first())==null?void 0:c.datetime)||0,l=Uv(await Ba.recurring.where("start").belowOrEqual(At().unix()).toArray(),s,At().unix()).reduce((f,h)=>f+h.amount,0);return{total:r.reduce((f,{amount:h,txn_type:d})=>f+([dn.CREDIT,dn.RECURRING].includes(d)?Number(h)*-1:Number(h)),0)-l,spending:o+a,saving:i-a}},yct=wz("showBigNumbers",!1);function r_(t,e,r){return t.push({category:e.category,name:e.name,amount:e.amount,txn_type:dn.RECURRING,datetime:r.unix(),recurringId:e.id,credit_card:e.credit_card}),t}function Uv(t,e,r){return t.reduce((n,i)=>{if(r<i.start)return n;let o=i.cron.split(" ")[0],a=i.cron.split(" ")[1],s=[],l=At.unix(e);switch(o){case"weekly":let u=parseInt(a),c=l.day(),f=Math.abs(c-u);for(c<u?l=l.add(f,"d"):l=l.add(7-f,"d");l.unix()<r;)s=r_(s,i,l),l=l.add(1,"w");break;case"monthly":let h=parseInt(a),d=Math.abs(parseInt(a)-At.unix(e).date());for(At.unix(e).date()<At.unix(i.start).date()?l=l.add(d,"d"):l=At.unix(e).set("D",h);l.unix()<r;)s=r_(s,i,l),l=l.add(1,"M");break;case"yearly":let p=Zi.exports.max([At.unix(e).year(),At.unix(r).year()]),m=At(a,"DD-MM").set("year",p||At().year());m.unix()<r&&m.unix()>=e&&(l=At.unix(i.start),s=r_(s,i,l));break}return[...n,...s]},[])}const vct=()=>{const{startDate:t,endDate:e}=Zx(),[r,n]=Es(yct),i=qoe(),o=Xoe(),a=Io.exports.useLiveQuery(()=>gct(t,e),[t,e]);return ve.createElement("div",null,ve.createElement(bt,{container:!0,justifyContent:"center",alignItems:"center",direction:"row",style:{textAlign:"center"},spacing:1,onClick:()=>n(!r)},ve.createElement(bt,{item:!0,xs:6,md:3},ve.createElement(gf,{value:r?`$${a==null?void 0:a.total.toLocaleString()}`:"*****",title:"Total funds",color:r?Number(a==null?void 0:a.total.toLocaleString())<0?"red":"green":void 0})),ve.createElement(bt,{item:!0,xs:6,md:3},ve.createElement(gf,{value:At.unix(t).format("DD MMM"),title:"Pay day",color:"orange"})),ve.createElement(bt,{item:!0,xs:6,md:3},ve.createElement(gf,{title:"Monthly Spend",value:r?`$${a==null?void 0:a.spending.toLocaleString()}`||"$0":"*****"})),ve.createElement(bt,{item:!0,xs:6,md:3},ve.createElement(gf,{title:"Monthly Save",value:r?`$${a==null?void 0:a.saving.toLocaleString()}`||"$0":"*****"})),ve.createElement(bt,{item:!0,xs:6,md:3},ve.createElement(gf,{title:"Total Portfolio",value:r?`$${Zi.exports.round(o,2).toLocaleString()}`||"$0":"*****"})),ve.createElement(bt,{item:!0,xs:6,md:3},ve.createElement(gf,{title:"Total Portfolio (%)",value:r?`${i}%`||"0%":"*****",color:r?i<0?"red":"green":void 0}))))},Zte=Sz(0);function Zx(){var s,l,u,c,f;const t=YS(h=>h.database),[e]=Es(Zte),r=(s=Io.exports.useLiveQuery(async()=>{var h;return(h=await t.expenditure.orderBy("datetime").last())==null?void 0:h.datetime}))!=null?s:0,n=(l=Io.exports.useLiveQuery(async()=>(await t.expenditure.where({txn_type:dn.SALARY})).toArray()))!=null?l:[],i=n.length||0,o=(c=(u=n[i-e-1])==null?void 0:u.datetime)!=null?c:r,a=e===0?At().unix():(f=n[i-e])==null?void 0:f.datetime;return{minDate:r,totalMonths:i,paydays:n,startDate:o,endDate:a}}const bct=()=>{const t=Goe();return ce.exports.useEffect(()=>{Yoe(t)}),ve.createElement("div",null,ve.createElement(bt,{container:!0,justifyContent:"center",alignItems:"center",direction:"column",spacing:2},ve.createElement(bt,{item:!0},ve.createElement(vct,null)),ve.createElement(bt,{item:!0},ve.createElement(pct,null))))};let Jx=K1();const ht=t=>Y1(t,Jx);let e9=K1();ht.write=t=>Y1(t,e9);let d5=K1();ht.onStart=t=>Y1(t,d5);let t9=K1();ht.onFrame=t=>Y1(t,t9);let r9=K1();ht.onFinish=t=>Y1(t,r9);let oh=[];ht.setTimeout=(t,e)=>{let r=ht.now()+e,n=()=>{let o=oh.findIndex(a=>a.cancel==n);~o&&oh.splice(o,1),Qs-=~o?1:0},i={time:r,handler:t,cancel:n};return oh.splice(Jte(r),0,i),Qs+=1,ere(),i};let Jte=t=>~(~oh.findIndex(e=>e.time>t)||~oh.length);ht.cancel=t=>{d5.delete(t),t9.delete(t),Jx.delete(t),e9.delete(t),r9.delete(t)};ht.sync=t=>{QA=!0,ht.batchedUpdates(t),QA=!1};ht.throttle=t=>{let e;function r(){try{t(...e)}finally{e=null}}function n(...i){e=i,ht.onStart(r)}return n.handler=t,n.cancel=()=>{d5.delete(r),e=null},n};let n9=typeof window<"u"?window.requestAnimationFrame:()=>{};ht.use=t=>n9=t;ht.now=typeof performance<"u"?()=>performance.now():Date.now;ht.batchedUpdates=t=>t();ht.catch=console.error;ht.frameLoop="always";ht.advance=()=>{ht.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):rre()};let Xs=-1,Qs=0,QA=!1;function Y1(t,e){QA?(e.delete(t),t(0)):(e.add(t),ere())}function ere(){Xs<0&&(Xs=0,ht.frameLoop!=="demand"&&n9(tre))}function wct(){Xs=-1}function tre(){~Xs&&(n9(tre),ht.batchedUpdates(rre))}function rre(){let t=Xs;Xs=ht.now();let e=Jte(Xs);e&&(nre(oh.splice(0,e),r=>r.handler()),Qs-=e),d5.flush(),Jx.flush(t?Math.min(64,Xs-t):16.667),t9.flush(),e9.flush(),r9.flush(),Qs||wct()}function K1(){let t=new Set,e=t;return{add(r){Qs+=e==t&&!t.has(r)?1:0,t.add(r)},delete(r){return Qs-=e==t&&t.has(r)?1:0,t.delete(r)},flush(r){e.size&&(t=new Set,Qs-=e.size,nre(e,n=>n(r)&&t.add(n)),Qs+=t.size,e=t)}}}function nre(t,e){t.forEach(r=>{try{e(r)}catch(n){ht.catch(n)}})}function ZA(){}const Sct=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,configurable:!0}),Ae={arr:Array.isArray,obj:t=>!!t&&t.constructor.name==="Object",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",und:t=>t===void 0};function La(t,e){if(Ae.arr(t)){if(!Ae.arr(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return t===e}const lt=(t,e)=>t.forEach(e);function ha(t,e,r){if(Ae.arr(t)){for(let n=0;n<t.length;n++)e.call(r,t[n],`${n}`);return}for(const n in t)t.hasOwnProperty(n)&&e.call(r,t[n],n)}const qn=t=>Ae.und(t)?[]:Ae.arr(t)?t:[t];function yg(t,e){if(t.size){const r=Array.from(t);t.clear(),lt(r,e)}}const Ym=(t,...e)=>yg(t,r=>r(...e)),ire=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent);let i9,ore,ml=null,are=!1,o9=ZA;const Rct=t=>{t.to&&(ore=t.to),t.now&&(ht.now=t.now),t.colors!==void 0&&(ml=t.colors),t.skipAnimation!=null&&(are=t.skipAnimation),t.createStringInterpolator&&(i9=t.createStringInterpolator),t.requestAnimationFrame&&ht.use(t.requestAnimationFrame),t.batchedUpdates&&(ht.batchedUpdates=t.batchedUpdates),t.willAdvance&&(o9=t.willAdvance),t.frameLoop&&(ht.frameLoop=t.frameLoop)};var da=Object.freeze({__proto__:null,get createStringInterpolator(){return i9},get to(){return ore},get colors(){return ml},get skipAnimation(){return are},get willAdvance(){return o9},assign:Rct});const vg=new Set;let Gi=[],n_=[],ES=0;const p5={get idle(){return!vg.size&&!Gi.length},start(t){ES>t.priority?(vg.add(t),ht.onStart(Ect)):(sre(t),ht(JA))},advance:JA,sort(t){if(ES)ht.onFrame(()=>p5.sort(t));else{const e=Gi.indexOf(t);~e&&(Gi.splice(e,1),lre(t))}},clear(){Gi=[],vg.clear()}};function Ect(){vg.forEach(sre),vg.clear(),ht(JA)}function sre(t){Gi.includes(t)||lre(t)}function lre(t){Gi.splice(Cct(Gi,e=>e.priority>t.priority),0,t)}function JA(t){const e=n_;for(let r=0;r<Gi.length;r++){const n=Gi[r];ES=n.priority,n.idle||(o9(n),n.advance(t),n.idle||e.push(n))}return ES=0,n_=Gi,n_.length=0,Gi=e,Gi.length>0}function Cct(t,e){const r=t.findIndex(e);return r<0?t.length:r}const _ct={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},Oo="[-+]?\\d*\\.?\\d+",CS=Oo+"%";function m5(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}const Tct=new RegExp("rgb"+m5(Oo,Oo,Oo)),Oct=new RegExp("rgba"+m5(Oo,Oo,Oo,Oo)),Act=new RegExp("hsl"+m5(Oo,CS,CS)),Ict=new RegExp("hsla"+m5(Oo,CS,CS,Oo)),xct=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Mct=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Nct=/^#([0-9a-fA-F]{6})$/,Pct=/^#([0-9a-fA-F]{8})$/;function kct(t){let e;return typeof t=="number"?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=Nct.exec(t))?parseInt(e[1]+"ff",16)>>>0:ml&&ml[t]!==void 0?ml[t]:(e=Tct.exec(t))?(yf(e[1])<<24|yf(e[2])<<16|yf(e[3])<<8|255)>>>0:(e=Oct.exec(t))?(yf(e[1])<<24|yf(e[2])<<16|yf(e[3])<<8|Tj(e[4]))>>>0:(e=xct.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=Pct.exec(t))?parseInt(e[1],16)>>>0:(e=Mct.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=Act.exec(t))?(Cj(_j(e[1]),bb(e[2]),bb(e[3]))|255)>>>0:(e=Ict.exec(t))?(Cj(_j(e[1]),bb(e[2]),bb(e[3]))|Tj(e[4]))>>>0:null}function i_(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function Cj(t,e,r){const n=r<.5?r*(1+e):r+e-r*e,i=2*r-n,o=i_(i,n,t+1/3),a=i_(i,n,t),s=i_(i,n,t-1/3);return Math.round(o*255)<<24|Math.round(a*255)<<16|Math.round(s*255)<<8}function yf(t){const e=parseInt(t,10);return e<0?0:e>255?255:e}function _j(t){return(parseFloat(t)%360+360)%360/360}function Tj(t){const e=parseFloat(t);return e<0?0:e>1?255:Math.round(e*255)}function bb(t){const e=parseFloat(t);return e<0?0:e>100?1:e/100}function Oj(t){let e=kct(t);if(e===null)return t;e=e||0;let r=(e&4278190080)>>>24,n=(e&16711680)>>>16,i=(e&65280)>>>8,o=(e&255)/255;return`rgba(${r}, ${n}, ${i}, ${o})`}const Vv=(t,e,r)=>{if(Ae.fun(t))return t;if(Ae.arr(t))return Vv({range:t,output:e,extrapolate:r});if(Ae.str(t.output[0]))return i9(t);const n=t,i=n.output,o=n.range||[0,1],a=n.extrapolateLeft||n.extrapolate||"extend",s=n.extrapolateRight||n.extrapolate||"extend",l=n.easing||(u=>u);return u=>{const c=Lct(u,o);return $ct(u,o[c],o[c+1],i[c],i[c+1],l,a,s,n.map)}};function $ct(t,e,r,n,i,o,a,s,l){let u=l?l(t):t;if(u<e){if(a==="identity")return u;a==="clamp"&&(u=e)}if(u>r){if(s==="identity")return u;s==="clamp"&&(u=r)}return n===i?n:e===r?t<=e?n:i:(e===-1/0?u=-u:r===1/0?u=u-e:u=(u-e)/(r-e),u=o(u),n===-1/0?u=-u:i===1/0?u=u+n:u=u*(i-n)+n,u)}function Lct(t,e){for(var r=1;r<e.length-1&&!(e[r]>=t);++r);return r-1}function e4(){return e4=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},e4.apply(this,arguments)}const bp=Symbol.for("FluidValue.get"),uc=Symbol.for("FluidValue.observers"),zi=t=>Boolean(t&&t[bp]),oi=t=>t&&t[bp]?t[bp]():t,Aj=t=>t[uc]||null;function Dct(t,e){t.eventObserved?t.eventObserved(e):t(e)}function jv(t,e){let r=t[uc];r&&r.forEach(n=>{Dct(n,e)})}class ure{constructor(e){if(this[bp]=void 0,this[uc]=void 0,!e&&!(e=this.get))throw Error("Unknown getter");Fct(this,e)}}const Fct=(t,e)=>cre(t,bp,e);function Yp(t,e){if(t[bp]){let r=t[uc];r||cre(t,uc,r=new Set),r.has(e)||(r.add(e),t.observerAdded&&t.observerAdded(r.size,e))}return e}function Wv(t,e){let r=t[uc];if(r&&r.has(e)){const n=r.size-1;n?r.delete(e):t[uc]=null,t.observerRemoved&&t.observerRemoved(n,e)}}const cre=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,configurable:!0}),P2=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Hct=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,Ij=new RegExp(`(${P2.source})(%|[a-z]+)`,"i"),Bct=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,g5=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,fre=t=>{const[e,r]=Uct(t);if(!e||ire())return t;const n=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(n)return n.trim();if(r&&r.startsWith("--")){const i=window.getComputedStyle(document.documentElement).getPropertyValue(r);return i||t}else{if(r&&g5.test(r))return fre(r);if(r)return r}return t},Uct=t=>{const e=g5.exec(t);if(!e)return[,];const[,r,n]=e;return[r,n]};let o_;const Vct=(t,e,r,n,i)=>`rgba(${Math.round(e)}, ${Math.round(r)}, ${Math.round(n)}, ${i})`,hre=t=>{o_||(o_=ml?new RegExp(`(${Object.keys(ml).join("|")})(?!\\w)`,"g"):/^\b$/);const e=t.output.map(o=>oi(o).replace(g5,fre).replace(Hct,Oj).replace(o_,Oj)),r=e.map(o=>o.match(P2).map(Number)),i=r[0].map((o,a)=>r.map(s=>{if(!(a in s))throw Error('The arity of each "output" value must be equal');return s[a]})).map(o=>Vv(e4({},t,{output:o})));return o=>{var a;const s=!Ij.test(e[0])&&((a=e.find(u=>Ij.test(u)))==null?void 0:a.replace(P2,""));let l=0;return e[0].replace(P2,()=>`${i[l++](o)}${s||""}`).replace(Bct,Vct)}},a9="react-spring: ",dre=t=>{const e=t;let r=!1;if(typeof e!="function")throw new TypeError(`${a9}once requires a function parameter`);return(...n)=>{r||(e(...n),r=!0)}},jct=dre(console.warn);function Wct(){jct(`${a9}The "interpolate" function is deprecated in v9 (use "to" instead)`)}const zct=dre(console.warn);function Gct(){zct(`${a9}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function y5(t){return Ae.str(t)&&(t[0]=="#"||/\d/.test(t)||!ire()&&g5.test(t)||t in(ml||{}))}const Pu=typeof window<"u"&&window.document&&window.document.createElement?ce.exports.useLayoutEffect:ce.exports.useEffect,Yct=()=>{const t=ce.exports.useRef(!1);return Pu(()=>(t.current=!0,()=>{t.current=!1}),[]),t};function s9(){const t=ce.exports.useState()[1],e=Yct();return()=>{e.current&&t(Math.random())}}function Kct(t,e){const[r]=ce.exports.useState(()=>({inputs:e,result:t()})),n=ce.exports.useRef(),i=n.current;let o=i;return o?Boolean(e&&o.inputs&&qct(e,o.inputs))||(o={inputs:e,result:t()}):o=r,ce.exports.useEffect(()=>{n.current=o,i==r&&(r.inputs=r.result=void 0)},[o]),o.result}function qct(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}const l9=t=>ce.exports.useEffect(t,Xct),Xct=[];function t4(t){const e=ce.exports.useRef();return ce.exports.useEffect(()=>{e.current=t}),e.current}const zv=Symbol.for("Animated:node"),Qct=t=>!!t&&t[zv]===t,Zo=t=>t&&t[zv],u9=(t,e)=>Sct(t,zv,e),v5=t=>t&&t[zv]&&t[zv].getPayload();class pre{constructor(){this.payload=void 0,u9(this,this)}getPayload(){return this.payload||[]}}class Kp extends pre{constructor(e){super(),this.done=!0,this.elapsedTime=void 0,this.lastPosition=void 0,this.lastVelocity=void 0,this.v0=void 0,this.durationProgress=0,this._value=e,Ae.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new Kp(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,r){return Ae.num(e)&&(this.lastPosition=e,r&&(e=Math.round(e/r)*r,this.done&&(this.lastPosition=e))),this._value===e?!1:(this._value=e,!0)}reset(){const{done:e}=this;this.done=!1,Ae.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}}class wp extends Kp{constructor(e){super(0),this._string=null,this._toString=void 0,this._toString=Vv({output:[e,e]})}static create(e){return new wp(e)}getValue(){let e=this._string;return e==null?this._string=this._toString(this._value):e}setValue(e){if(Ae.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else if(super.setValue(e))this._string=null;else return!1;return!0}reset(e){e&&(this._toString=Vv({output:[this.getValue(),e]})),this._value=0,super.reset()}}const _S={dependencies:null};class b5 extends pre{constructor(e){super(),this.source=e,this.setValue(e)}getValue(e){const r={};return ha(this.source,(n,i)=>{Qct(n)?r[i]=n.getValue(e):zi(n)?r[i]=oi(n):e||(r[i]=n)}),r}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&lt(this.payload,e=>e.reset())}_makePayload(e){if(e){const r=new Set;return ha(e,this._addToPayload,r),Array.from(r)}}_addToPayload(e){_S.dependencies&&zi(e)&&_S.dependencies.add(e);const r=v5(e);r&&lt(r,n=>this.add(n))}}class c9 extends b5{constructor(e){super(e)}static create(e){return new c9(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){const r=this.getPayload();return e.length==r.length?r.map((n,i)=>n.setValue(e[i])).some(Boolean):(super.setValue(e.map(Zct)),!0)}}function Zct(t){return(y5(t)?wp:Kp).create(t)}function r4(t){const e=Zo(t);return e?e.constructor:Ae.arr(t)?c9:y5(t)?wp:Kp}function TS(){return TS=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},TS.apply(this,arguments)}const xj=(t,e)=>{const r=!Ae.fun(t)||t.prototype&&t.prototype.isReactComponent;return ce.exports.forwardRef((n,i)=>{const o=ce.exports.useRef(null),a=r&&ce.exports.useCallback(p=>{o.current=tft(i,p)},[i]),[s,l]=eft(n,e),u=s9(),c=()=>{const p=o.current;if(r&&!p)return;(p?e.applyAnimatedValues(p,s.getValue(!0)):!1)===!1&&u()},f=new Jct(c,l),h=ce.exports.useRef();Pu(()=>(h.current=f,lt(l,p=>Yp(p,f)),()=>{h.current&&(lt(h.current.deps,p=>Wv(p,h.current)),ht.cancel(h.current.update))})),ce.exports.useEffect(c,[]),l9(()=>()=>{const p=h.current;lt(p.deps,m=>Wv(m,p))});const d=e.getComponentProps(s.getValue());return ce.exports.createElement(t,TS({},d,{ref:a}))})};class Jct{constructor(e,r){this.update=e,this.deps=r}eventObserved(e){e.type=="change"&&ht.write(this.update)}}function eft(t,e){const r=new Set;return _S.dependencies=r,t.style&&(t=TS({},t,{style:e.createAnimatedStyle(t.style)})),t=new b5(t),_S.dependencies=null,[t,r]}function tft(t,e){return t&&(Ae.fun(t)?t(e):t.current=e),e}const Mj=Symbol.for("AnimatedComponent"),rft=(t,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:r=i=>new b5(i),getComponentProps:n=i=>i}={})=>{const i={applyAnimatedValues:e,createAnimatedStyle:r,getComponentProps:n},o=a=>{const s=Nj(a)||"Anonymous";return Ae.str(a)?a=o[a]||(o[a]=xj(a,i)):a=a[Mj]||(a[Mj]=xj(a,i)),a.displayName=`Animated(${s})`,a};return ha(t,(a,s)=>{Ae.arr(t)&&(s=Nj(a)),o[s]=o(a)}),{animated:o}},Nj=t=>Ae.str(t)?t:t&&Ae.str(t.displayName)?t.displayName:Ae.fun(t)&&t.name||null;function Pr(){return Pr=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Pr.apply(this,arguments)}function ai(t,...e){return Ae.fun(t)?t(...e):t}const bg=(t,e)=>t===!0||!!(e&&t&&(Ae.fun(t)?t(e):qn(t).includes(e))),mre=(t,e)=>Ae.obj(t)?e&&t[e]:t,gre=(t,e)=>t.default===!0?t[e]:t.default?t.default[e]:void 0,nft=t=>t,w5=(t,e=nft)=>{let r=ift;t.default&&t.default!==!0&&(t=t.default,r=Object.keys(t));const n={};for(const i of r){const o=e(t[i],i);Ae.und(o)||(n[i]=o)}return n},ift=["config","onProps","onStart","onChange","onPause","onResume","onRest"],oft={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function aft(t){const e={};let r=0;if(ha(t,(n,i)=>{oft[i]||(e[i]=n,r++)}),r)return e}function f9(t){const e=aft(t);if(e){const r={to:e};return ha(t,(n,i)=>i in e||(r[i]=n)),r}return Pr({},t)}function Gv(t){return t=oi(t),Ae.arr(t)?t.map(Gv):y5(t)?da.createStringInterpolator({range:[0,1],output:[t,t]})(1):t}function yre(t){for(const e in t)return!0;return!1}function n4(t){return Ae.fun(t)||Ae.arr(t)&&Ae.obj(t[0])}function i4(t,e){var r;(r=t.ref)==null||r.delete(t),e==null||e.delete(t)}function vre(t,e){if(e&&t.ref!==e){var r;(r=t.ref)==null||r.delete(t),e.add(t),t.ref=e}}const h9={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},OS=1.70158,wb=OS*1.525,Pj=OS+1,kj=2*Math.PI/3,$j=2*Math.PI/4.5,Sb=t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,sft={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>1-(1-t)*(1-t),easeInOutQuad:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeInCubic:t=>t*t*t,easeOutCubic:t=>1-Math.pow(1-t,3),easeInOutCubic:t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1-Math.pow(1-t,4),easeInOutQuart:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1-Math.pow(1-t,5),easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t===0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t===1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeInCirc:t=>1-Math.sqrt(1-Math.pow(t,2)),easeOutCirc:t=>Math.sqrt(1-Math.pow(t-1,2)),easeInOutCirc:t=>t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2,easeInBack:t=>Pj*t*t*t-OS*t*t,easeOutBack:t=>1+Pj*Math.pow(t-1,3)+OS*Math.pow(t-1,2),easeInOutBack:t=>t<.5?Math.pow(2*t,2)*((wb+1)*2*t-wb)/2:(Math.pow(2*t-2,2)*((wb+1)*(t*2-2)+wb)+2)/2,easeInElastic:t=>t===0?0:t===1?1:-Math.pow(2,10*t-10)*Math.sin((t*10-10.75)*kj),easeOutElastic:t=>t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t*10-.75)*kj)+1,easeInOutElastic:t=>t===0?0:t===1?1:t<.5?-(Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*$j))/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*$j)/2+1,easeInBounce:t=>1-Sb(1-t),easeOutBounce:Sb,easeInOutBounce:t=>t<.5?(1-Sb(1-2*t))/2:(1+Sb(2*t-1))/2},o4=Pr({},h9.default,{mass:1,damping:1,easing:sft.linear,clamp:!1});class lft{constructor(){this.tension=void 0,this.friction=void 0,this.frequency=void 0,this.damping=void 0,this.mass=void 0,this.velocity=0,this.restVelocity=void 0,this.precision=void 0,this.progress=void 0,this.duration=void 0,this.easing=void 0,this.clamp=void 0,this.bounce=void 0,this.decay=void 0,this.round=void 0,Object.assign(this,o4)}}function uft(t,e,r){r&&(r=Pr({},r),Lj(r,e),e=Pr({},r,e)),Lj(t,e),Object.assign(t,e);for(const a in o4)t[a]==null&&(t[a]=o4[a]);let{mass:n,frequency:i,damping:o}=t;return Ae.und(i)||(i<.01&&(i=.01),o<0&&(o=0),t.tension=Math.pow(2*Math.PI/i,2)*n,t.friction=4*Math.PI*o*n/i),t}function Lj(t,e){if(!Ae.und(e.decay))t.duration=void 0;else{const r=!Ae.und(e.tension)||!Ae.und(e.friction);(r||!Ae.und(e.frequency)||!Ae.und(e.damping)||!Ae.und(e.mass))&&(t.duration=void 0,t.decay=void 0),r&&(t.frequency=void 0)}}const Dj=[];class cft{constructor(){this.changed=!1,this.values=Dj,this.toValues=null,this.fromValues=Dj,this.to=void 0,this.from=void 0,this.config=new lft,this.immediate=!1}}function bre(t,{key:e,props:r,defaultProps:n,state:i,actions:o}){return new Promise((a,s)=>{var l;let u,c,f=bg((l=r.cancel)!=null?l:n==null?void 0:n.cancel,e);if(f)p();else{Ae.und(r.pause)||(i.paused=bg(r.pause,e));let m=n==null?void 0:n.pause;m!==!0&&(m=i.paused||bg(m,e)),u=ai(r.delay||0,e),m?(i.resumeQueue.add(d),o.pause()):(o.resume(),d())}function h(){i.resumeQueue.add(d),i.timeouts.delete(c),c.cancel(),u=c.time-ht.now()}function d(){u>0&&!da.skipAnimation?(i.delayed=!0,c=ht.setTimeout(p,u),i.pauseQueue.add(h),i.timeouts.add(c)):p()}function p(){i.delayed&&(i.delayed=!1),i.pauseQueue.delete(h),i.timeouts.delete(c),t<=(i.cancelId||0)&&(f=!0);try{o.start(Pr({},r,{callId:t,cancel:f}),a)}catch(m){s(m)}}})}const d9=(t,e)=>e.length==1?e[0]:e.some(r=>r.cancelled)?ah(t.get()):e.every(r=>r.noop)?wre(t.get()):Co(t.get(),e.every(r=>r.finished)),wre=t=>({value:t,noop:!0,finished:!0,cancelled:!1}),Co=(t,e,r=!1)=>({value:t,finished:e,cancelled:r}),ah=t=>({value:t,cancelled:!0,finished:!1});function Sre(t,e,r,n){const{callId:i,parentId:o,onRest:a}=e,{asyncTo:s,promise:l}=r;return!o&&t===s&&!e.reset?l:r.promise=(async()=>{r.asyncId=i,r.asyncTo=t;const u=w5(e,(g,v)=>v==="onRest"?void 0:g);let c,f;const h=new Promise((g,v)=>(c=g,f=v)),d=g=>{const v=i<=(r.cancelId||0)&&ah(n)||i!==r.asyncId&&Co(n,!1);if(v)throw g.result=v,f(g),g},p=(g,v)=>{const w=new Fj,b=new Hj;return(async()=>{if(da.skipAnimation)throw Yv(r),b.result=Co(n,!1),f(b),b;d(w);const E=Ae.obj(g)?Pr({},g):Pr({},v,{to:g});E.parentId=i,ha(u,(M,k)=>{Ae.und(E[k])&&(E[k]=M)});const A=await n.start(E);return d(w),r.paused&&await new Promise(M=>{r.resumeQueue.add(M)}),A})()};let m;if(da.skipAnimation)return Yv(r),Co(n,!1);try{let g;Ae.arr(t)?g=(async v=>{for(const w of v)await p(w)})(t):g=Promise.resolve(t(p,n.stop.bind(n))),await Promise.all([g.then(c),h]),m=Co(n.get(),!0,!1)}catch(g){if(g instanceof Fj)m=g.result;else if(g instanceof Hj)m=g.result;else throw g}finally{i==r.asyncId&&(r.asyncId=o,r.asyncTo=o?s:void 0,r.promise=o?l:void 0)}return Ae.fun(a)&&ht.batchedUpdates(()=>{a(m,n,n.item)}),m})()}function Yv(t,e){yg(t.timeouts,r=>r.cancel()),t.pauseQueue.clear(),t.resumeQueue.clear(),t.asyncId=t.asyncTo=t.promise=void 0,e&&(t.cancelId=e)}class Fj extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise."),this.result=void 0}}class Hj extends Error{constructor(){super("SkipAnimationSignal"),this.result=void 0}}const a4=t=>t instanceof p9;let fft=1;class p9 extends ure{constructor(...e){super(...e),this.id=fft++,this.key=void 0,this._priority=0}get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){const e=Zo(this);return e&&e.getValue()}to(...e){return da.to(this,e)}interpolate(...e){return Wct(),da.to(this,e)}toJSON(){return this.get()}observerAdded(e){e==1&&this._attach()}observerRemoved(e){e==0&&this._detach()}_attach(){}_detach(){}_onChange(e,r=!1){jv(this,{type:"change",parent:this,value:e,idle:r})}_onPriorityChange(e){this.idle||p5.sort(this),jv(this,{type:"priority",parent:this,priority:e})}}const cc=Symbol.for("SpringPhase"),Rre=1,s4=2,l4=4,a_=t=>(t[cc]&Rre)>0,Fs=t=>(t[cc]&s4)>0,Am=t=>(t[cc]&l4)>0,Bj=(t,e)=>e?t[cc]|=s4|Rre:t[cc]&=~s4,Uj=(t,e)=>e?t[cc]|=l4:t[cc]&=~l4;class hft extends p9{constructor(e,r){if(super(),this.key=void 0,this.animation=new cft,this.queue=void 0,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!Ae.und(e)||!Ae.und(r)){const n=Ae.obj(e)?Pr({},e):Pr({},r,{from:e});Ae.und(n.default)&&(n.default=!0),this.start(n)}}get idle(){return!(Fs(this)||this._state.asyncTo)||Am(this)}get goal(){return oi(this.animation.to)}get velocity(){const e=Zo(this);return e instanceof Kp?e.lastVelocity||0:e.getPayload().map(r=>r.lastVelocity||0)}get hasAnimated(){return a_(this)}get isAnimating(){return Fs(this)}get isPaused(){return Am(this)}get isDelayed(){return this._state.delayed}advance(e){let r=!0,n=!1;const i=this.animation;let{config:o,toValues:a}=i;const s=v5(i.to);!s&&zi(i.to)&&(a=qn(oi(i.to))),i.values.forEach((c,f)=>{if(c.done)return;const h=c.constructor==wp?1:s?s[f].lastPosition:a[f];let d=i.immediate,p=h;if(!d){if(p=c.lastPosition,o.tension<=0){c.done=!0;return}let m=c.elapsedTime+=e;const g=i.fromValues[f],v=c.v0!=null?c.v0:c.v0=Ae.arr(o.velocity)?o.velocity[f]:o.velocity;let w;if(Ae.und(o.duration))if(o.decay){const b=o.decay===!0?.998:o.decay,E=Math.exp(-(1-b)*m);p=g+v/(1-b)*(1-E),d=Math.abs(c.lastPosition-p)<.1,w=v*E}else{w=c.lastVelocity==null?v:c.lastVelocity;const b=o.precision||(g==h?.005:Math.min(1,Math.abs(h-g)*.001)),E=o.restVelocity||b/10,A=o.clamp?0:o.bounce,M=!Ae.und(A),k=g==h?c.v0>0:g<h;let O,x=!1;const C=1,I=Math.ceil(e/C);for(let H=0;H<I&&(O=Math.abs(w)>E,!(!O&&(d=Math.abs(h-p)<=b,d)));++H){M&&(x=p==h||p>h==k,x&&(w=-w*A,p=h));const j=-o.tension*1e-6*(p-h),q=-o.friction*.001*w,Z=(j+q)/o.mass;w=w+Z*C,p=p+w*C}}else{let b=1;o.duration>0&&(this._memoizedDuration!==o.duration&&(this._memoizedDuration=o.duration,c.durationProgress>0&&(c.elapsedTime=o.duration*c.durationProgress,m=c.elapsedTime+=e)),b=(o.progress||0)+m/this._memoizedDuration,b=b>1?1:b<0?0:b,c.durationProgress=b),p=g+o.easing(b)*(h-g),w=(p-c.lastPosition)/e,d=b==1}c.lastVelocity=w,Number.isNaN(p)&&(console.warn("Got NaN while animating:",this),d=!0)}s&&!s[f].done&&(d=!1),d?c.done=!0:r=!1,c.setValue(p,o.round)&&(n=!0)});const l=Zo(this),u=l.getValue();if(r){const c=oi(i.to);(u!==c||n)&&!o.decay?(l.setValue(c),this._onChange(c)):n&&o.decay&&this._onChange(u),this._stop()}else n&&this._onChange(u)}set(e){return ht.batchedUpdates(()=>{this._stop(),this._focus(e),this._set(e)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(Fs(this)){const{to:e,config:r}=this.animation;ht.batchedUpdates(()=>{this._onStart(),r.decay||this._set(e,!1),this._stop()})}return this}update(e){return(this.queue||(this.queue=[])).push(e),this}start(e,r){let n;return Ae.und(e)?(n=this.queue||[],this.queue=[]):n=[Ae.obj(e)?e:Pr({},r,{to:e})],Promise.all(n.map(i=>this._update(i))).then(i=>d9(this,i))}stop(e){const{to:r}=this.animation;return this._focus(this.get()),Yv(this._state,e&&this._lastCallId),ht.batchedUpdates(()=>this._stop(r,e)),this}reset(){this._update({reset:!0})}eventObserved(e){e.type=="change"?this._start():e.type=="priority"&&(this.priority=e.priority+1)}_prepareNode(e){const r=this.key||"";let{to:n,from:i}=e;n=Ae.obj(n)?n[r]:n,(n==null||n4(n))&&(n=void 0),i=Ae.obj(i)?i[r]:i,i==null&&(i=void 0);const o={to:n,from:i};return a_(this)||(e.reverse&&([n,i]=[i,n]),i=oi(i),Ae.und(i)?Zo(this)||this._set(n):this._set(i)),o}_update(e,r){let n=Pr({},e);const{key:i,defaultProps:o}=this;n.default&&Object.assign(o,w5(n,(l,u)=>/^on/.test(u)?mre(l,i):l)),jj(this,n,"onProps"),xm(this,"onProps",n,this);const a=this._prepareNode(n);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const s=this._state;return bre(++this._lastCallId,{key:i,props:n,defaultProps:o,state:s,actions:{pause:()=>{Am(this)||(Uj(this,!0),Ym(s.pauseQueue),xm(this,"onPause",Co(this,Im(this,this.animation.to)),this))},resume:()=>{Am(this)&&(Uj(this,!1),Fs(this)&&this._resume(),Ym(s.resumeQueue),xm(this,"onResume",Co(this,Im(this,this.animation.to)),this))},start:this._merge.bind(this,a)}}).then(l=>{if(n.loop&&l.finished&&!(r&&l.noop)){const u=Ere(n);if(u)return this._update(u,!0)}return l})}_merge(e,r,n){if(r.cancel)return this.stop(!0),n(ah(this));const i=!Ae.und(e.to),o=!Ae.und(e.from);if(i||o)if(r.callId>this._lastToId)this._lastToId=r.callId;else return n(ah(this));const{key:a,defaultProps:s,animation:l}=this,{to:u,from:c}=l;let{to:f=u,from:h=c}=e;o&&!i&&(!r.default||Ae.und(f))&&(f=h),r.reverse&&([f,h]=[h,f]);const d=!La(h,c);d&&(l.from=h),h=oi(h);const p=!La(f,u);p&&this._focus(f);const m=n4(r.to),{config:g}=l,{decay:v,velocity:w}=g;(i||o)&&(g.velocity=0),r.config&&!m&&uft(g,ai(r.config,a),r.config!==s.config?ai(s.config,a):void 0);let b=Zo(this);if(!b||Ae.und(f))return n(Co(this,!0));const E=Ae.und(r.reset)?o&&!r.default:!Ae.und(h)&&bg(r.reset,a),A=E?h:this.get(),M=Gv(f),k=Ae.num(M)||Ae.arr(M)||y5(M),O=!m&&(!k||bg(s.immediate||r.immediate,a));if(p){const H=r4(f);if(H!==b.constructor)if(O)b=this._set(M);else throw Error(`Cannot animate between ${b.constructor.name} and ${H.name}, as the "to" prop suggests`)}const x=b.constructor;let C=zi(f),I=!1;if(!C){const H=E||!a_(this)&&d;(p||H)&&(I=La(Gv(A),M),C=!I),(!La(l.immediate,O)&&!O||!La(g.decay,v)||!La(g.velocity,w))&&(C=!0)}if(I&&Fs(this)&&(l.changed&&!E?C=!0:C||this._stop(u)),!m&&((C||zi(u))&&(l.values=b.getPayload(),l.toValues=zi(f)?null:x==wp?[1]:qn(M)),l.immediate!=O&&(l.immediate=O,!O&&!E&&this._set(u)),C)){const{onRest:H}=l;lt(pft,q=>jj(this,r,q));const j=Co(this,Im(this,u));Ym(this._pendingCalls,j),this._pendingCalls.add(n),l.changed&&ht.batchedUpdates(()=>{l.changed=!E,H==null||H(j,this),E?ai(s.onRest,j):l.onStart==null||l.onStart(j,this)})}E&&this._set(A),m?n(Sre(r.to,r,this._state,this)):C?this._start():Fs(this)&&!p?this._pendingCalls.add(n):n(wre(A))}_focus(e){const r=this.animation;e!==r.to&&(Aj(this)&&this._detach(),r.to=e,Aj(this)&&this._attach())}_attach(){let e=0;const{to:r}=this.animation;zi(r)&&(Yp(r,this),a4(r)&&(e=r.priority+1)),this.priority=e}_detach(){const{to:e}=this.animation;zi(e)&&Wv(e,this)}_set(e,r=!0){const n=oi(e);if(!Ae.und(n)){const i=Zo(this);if(!i||!La(n,i.getValue())){const o=r4(n);!i||i.constructor!=o?u9(this,o.create(n)):i.setValue(n),i&&ht.batchedUpdates(()=>{this._onChange(n,r)})}}return Zo(this)}_onStart(){const e=this.animation;e.changed||(e.changed=!0,xm(this,"onStart",Co(this,Im(this,e.to)),this))}_onChange(e,r){r||(this._onStart(),ai(this.animation.onChange,e,this)),ai(this.defaultProps.onChange,e,this),super._onChange(e,r)}_start(){const e=this.animation;Zo(this).reset(oi(e.to)),e.immediate||(e.fromValues=e.values.map(r=>r.lastPosition)),Fs(this)||(Bj(this,!0),Am(this)||this._resume())}_resume(){da.skipAnimation?this.finish():p5.start(this)}_stop(e,r){if(Fs(this)){Bj(this,!1);const n=this.animation;lt(n.values,o=>{o.done=!0}),n.toValues&&(n.onChange=n.onPause=n.onResume=void 0),jv(this,{type:"idle",parent:this});const i=r?ah(this.get()):Co(this.get(),Im(this,e!=null?e:n.to));Ym(this._pendingCalls,i),n.changed&&(n.changed=!1,xm(this,"onRest",i,this))}}}function Im(t,e){const r=Gv(e),n=Gv(t.get());return La(n,r)}function Ere(t,e=t.loop,r=t.to){let n=ai(e);if(n){const i=n!==!0&&f9(n),o=(i||t).reverse,a=!i||i.reset;return Kv(Pr({},t,{loop:e,default:!1,pause:void 0,to:!o||n4(r)?r:void 0,from:a?t.from:void 0,reset:a},i))}}function Kv(t){const{to:e,from:r}=t=f9(t),n=new Set;return Ae.obj(e)&&Vj(e,n),Ae.obj(r)&&Vj(r,n),t.keys=n.size?Array.from(n):null,t}function dft(t){const e=Kv(t);return Ae.und(e.default)&&(e.default=w5(e)),e}function Vj(t,e){ha(t,(r,n)=>r!=null&&e.add(n))}const pft=["onStart","onRest","onChange","onPause","onResume"];function jj(t,e,r){t.animation[r]=e[r]!==gre(e,r)?mre(e[r],t.key):void 0}function xm(t,e,...r){var n,i,o,a;(n=(i=t.animation)[e])==null||n.call(i,...r),(o=(a=t.defaultProps)[e])==null||o.call(a,...r)}const mft=["onStart","onChange","onRest"];let gft=1;class Cre{constructor(e,r){this.id=gft++,this.springs={},this.queue=[],this.ref=void 0,this._flush=void 0,this._initialProps=void 0,this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._item=void 0,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),r&&(this._flush=r),e&&this.start(Pr({default:!0},e))}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(e=>e.idle&&!e.isDelayed&&!e.isPaused)}get item(){return this._item}set item(e){this._item=e}get(){const e={};return this.each((r,n)=>e[n]=r.get()),e}set(e){for(const r in e){const n=e[r];Ae.und(n)||this.springs[r].set(n)}}update(e){return e&&this.queue.push(Kv(e)),this}start(e){let{queue:r}=this;return e?r=qn(e).map(Kv):this.queue=[],this._flush?this._flush(this,r):(Ire(this,r),u4(this,r))}stop(e,r){if(e!==!!e&&(r=e),r){const n=this.springs;lt(qn(r),i=>n[i].stop(!!e))}else Yv(this._state,this._lastAsyncId),this.each(n=>n.stop(!!e));return this}pause(e){if(Ae.und(e))this.start({pause:!0});else{const r=this.springs;lt(qn(e),n=>r[n].pause())}return this}resume(e){if(Ae.und(e))this.start({pause:!1});else{const r=this.springs;lt(qn(e),n=>r[n].resume())}return this}each(e){ha(this.springs,e)}_onFrame(){const{onStart:e,onChange:r,onRest:n}=this._events,i=this._active.size>0,o=this._changed.size>0;(i&&!this._started||o&&!this._started)&&(this._started=!0,yg(e,([l,u])=>{u.value=this.get(),l(u,this,this._item)}));const a=!i&&this._started,s=o||a&&n.size?this.get():null;o&&r.size&&yg(r,([l,u])=>{u.value=s,l(u,this,this._item)}),a&&(this._started=!1,yg(n,([l,u])=>{u.value=s,l(u,this,this._item)}))}eventObserved(e){if(e.type=="change")this._changed.add(e.parent),e.idle||this._active.add(e.parent);else if(e.type=="idle")this._active.delete(e.parent);else return;ht.onFrame(this._onFrame)}}function u4(t,e){return Promise.all(e.map(r=>_re(t,r))).then(r=>d9(t,r))}async function _re(t,e,r){const{keys:n,to:i,from:o,loop:a,onRest:s,onResolve:l}=e,u=Ae.obj(e.default)&&e.default;a&&(e.loop=!1),i===!1&&(e.to=null),o===!1&&(e.from=null);const c=Ae.arr(i)||Ae.fun(i)?i:void 0;c?(e.to=void 0,e.onRest=void 0,u&&(u.onRest=void 0)):lt(mft,m=>{const g=e[m];if(Ae.fun(g)){const v=t._events[m];e[m]=({finished:w,cancelled:b})=>{const E=v.get(g);E?(w||(E.finished=!1),b&&(E.cancelled=!0)):v.set(g,{value:null,finished:w||!1,cancelled:b||!1})},u&&(u[m]=e[m])}});const f=t._state;e.pause===!f.paused?(f.paused=e.pause,Ym(e.pause?f.pauseQueue:f.resumeQueue)):f.paused&&(e.pause=!0);const h=(n||Object.keys(t.springs)).map(m=>t.springs[m].start(e)),d=e.cancel===!0||gre(e,"cancel")===!0;(c||d&&f.asyncId)&&h.push(bre(++t._lastAsyncId,{props:e,state:f,actions:{pause:ZA,resume:ZA,start(m,g){d?(Yv(f,t._lastAsyncId),g(ah(t))):(m.onRest=s,g(Sre(c,m,f,t)))}}})),f.paused&&await new Promise(m=>{f.resumeQueue.add(m)});const p=d9(t,await Promise.all(h));if(a&&p.finished&&!(r&&p.noop)){const m=Ere(e,a,i);if(m)return Ire(t,[m]),_re(t,m,!0)}return l&&ht.batchedUpdates(()=>l(p,t,t.item)),p}function c4(t,e){const r=Pr({},t.springs);return e&&lt(qn(e),n=>{Ae.und(n.keys)&&(n=Kv(n)),Ae.obj(n.to)||(n=Pr({},n,{to:void 0})),Are(r,n,i=>Ore(i))}),Tre(t,r),r}function Tre(t,e){ha(e,(r,n)=>{t.springs[n]||(t.springs[n]=r,Yp(r,t))})}function Ore(t,e){const r=new hft;return r.key=t,e&&Yp(r,e),r}function Are(t,e,r){e.keys&&lt(e.keys,n=>{(t[n]||(t[n]=r(n)))._prepareNode(e)})}function Ire(t,e){lt(e,r=>{Are(t.springs,r,n=>Ore(n,t))})}function yft(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}const vft=["children"],q1=t=>{let{children:e}=t,r=yft(t,vft);const n=ce.exports.useContext(AS),i=r.pause||!!n.pause,o=r.immediate||!!n.immediate;r=Kct(()=>({pause:i,immediate:o}),[i,o]);const{Provider:a}=AS;return ce.exports.createElement(a,{value:r},e)},AS=bft(q1,{});q1.Provider=AS.Provider;q1.Consumer=AS.Consumer;function bft(t,e){return Object.assign(t,ce.exports.createContext(e)),t.Provider._context=t,t.Consumer._context=t,t}const xre=()=>{const t=[],e=function(i){Gct();const o=[];return lt(t,(a,s)=>{if(Ae.und(i))o.push(a.start());else{const l=r(i,a,s);l&&o.push(a.start(l))}}),o};e.current=t,e.add=function(n){t.includes(n)||t.push(n)},e.delete=function(n){const i=t.indexOf(n);~i&&t.splice(i,1)},e.pause=function(){return lt(t,n=>n.pause(...arguments)),this},e.resume=function(){return lt(t,n=>n.resume(...arguments)),this},e.set=function(n){lt(t,i=>i.set(n))},e.start=function(n){const i=[];return lt(t,(o,a)=>{if(Ae.und(n))i.push(o.start());else{const s=this._getProps(n,o,a);s&&i.push(o.start(s))}}),i},e.stop=function(){return lt(t,n=>n.stop(...arguments)),this},e.update=function(n){return lt(t,(i,o)=>i.update(this._getProps(n,i,o))),this};const r=function(i,o,a){return Ae.fun(i)?i(a,o):i};return e._getProps=r,e};function wft(t,e,r){const n=Ae.fun(e)&&e;n&&!r&&(r=[]);const i=ce.exports.useMemo(()=>n||arguments.length==3?xre():void 0,[]),o=ce.exports.useRef(0),a=s9(),s=ce.exports.useMemo(()=>({ctrls:[],queue:[],flush(v,w){const b=c4(v,w);return o.current>0&&!s.queue.length&&!Object.keys(b).some(A=>!v.springs[A])?u4(v,w):new Promise(A=>{Tre(v,b),s.queue.push(()=>{A(u4(v,w))}),a()})}}),[]),l=ce.exports.useRef([...s.ctrls]),u=[],c=t4(t)||0;ce.exports.useMemo(()=>{lt(l.current.slice(t,c),v=>{i4(v,i),v.stop(!0)}),l.current.length=t,f(c,t)},[t]),ce.exports.useMemo(()=>{f(0,Math.min(c,t))},r);function f(v,w){for(let b=v;b<w;b++){const E=l.current[b]||(l.current[b]=new Cre(null,s.flush)),A=n?n(b,E):e[b];A&&(u[b]=dft(A))}}const h=l.current.map((v,w)=>c4(v,u[w])),d=ce.exports.useContext(q1),p=t4(d),m=d!==p&&yre(d);Pu(()=>{o.current++,s.ctrls=l.current;const{queue:v}=s;v.length&&(s.queue=[],lt(v,w=>w())),lt(l.current,(w,b)=>{i==null||i.add(w),m&&w.start({default:d});const E=u[b];E&&(vre(w,E.ref),w.ref?w.queue.push(E):w.start(E))})}),l9(()=>()=>{lt(s.ctrls,v=>v.stop(!0))});const g=h.map(v=>Pr({},v));return i?[g,i]:g}function Sa(t,e){const r=Ae.fun(t),[[n],i]=wft(1,r?t:[t],r?e||[]:e);return r||arguments.length==2?[n,i]:n}let Wn;(function(t){t.MOUNT="mount",t.ENTER="enter",t.UPDATE="update",t.LEAVE="leave"})(Wn||(Wn={}));function m9(t,e,r){const n=Ae.fun(e)&&e,{reset:i,sort:o,trail:a=0,expires:s=!0,exitBeforeEnter:l=!1,onDestroyed:u,ref:c,config:f}=n?n():e,h=ce.exports.useMemo(()=>n||arguments.length==3?xre():void 0,[]),d=qn(t),p=[],m=ce.exports.useRef(null),g=i?null:m.current;Pu(()=>{m.current=p}),l9(()=>(lt(m.current,q=>{var Z;(Z=q.ctrl.ref)==null||Z.add(q.ctrl);const ne=k.get(q);ne&&q.ctrl.start(ne.payload)}),()=>{lt(m.current,q=>{q.expired&&clearTimeout(q.expirationId),i4(q.ctrl,h),q.ctrl.stop(!0)})}));const v=Rft(d,n?n():e,g),w=i&&m.current||[];Pu(()=>lt(w,({ctrl:q,item:Z,key:ne})=>{i4(q,h),ai(u,Z,ne)}));const b=[];if(g&&lt(g,(q,Z)=>{q.expired?(clearTimeout(q.expirationId),w.push(q)):(Z=b[Z]=v.indexOf(q.key),~Z&&(p[Z]=q))}),lt(d,(q,Z)=>{p[Z]||(p[Z]={key:v[Z],item:q,phase:Wn.MOUNT,ctrl:new Cre},p[Z].ctrl.item=q)}),b.length){let q=-1;const{leave:Z}=n?n():e;lt(b,(ne,ie)=>{const P=g[ie];~ne?(q=p.indexOf(P),p[q]=Pr({},P,{item:d[ne]})):Z&&p.splice(++q,0,P)})}Ae.fun(o)&&p.sort((q,Z)=>o(q.item,Z.item));let E=-a;const A=s9(),M=w5(e),k=new Map,O=ce.exports.useRef(new Map),x=ce.exports.useRef(!1);lt(p,(q,Z)=>{const ne=q.key,ie=q.phase,P=n?n():e;let y,R,_=ai(P.delay||0,ne);if(ie==Wn.MOUNT)y=P.enter,R=Wn.ENTER;else{const ee=v.indexOf(ne)<0;if(ie!=Wn.LEAVE)if(ee)y=P.leave,R=Wn.LEAVE;else if(y=P.update)R=Wn.UPDATE;else return;else if(!ee)y=P.enter,R=Wn.ENTER;else return}if(y=ai(y,q.item,Z),y=Ae.obj(y)?f9(y):{to:y},!y.config){const ee=f||M.config;y.config=ai(ee,q.item,Z,R)}E+=a;const $=Pr({},M,{delay:_+E,ref:c,immediate:P.immediate,reset:!1},y);if(R==Wn.ENTER&&Ae.und($.from)){const ee=n?n():e,J=Ae.und(ee.initial)||g?ee.from:ee.initial;$.from=ai(J,q.item,Z)}const{onResolve:B}=$;$.onResolve=ee=>{ai(B,ee);const J=m.current,he=J.find(re=>re.key===ne);if(!!he&&!(ee.cancelled&&he.phase!=Wn.UPDATE)&&he.ctrl.idle){const re=J.every(T=>T.ctrl.idle);if(he.phase==Wn.LEAVE){const T=ai(s,he.item);if(T!==!1){const D=T===!0?0:T;if(he.expired=!0,!re&&D>0){D<=2147483647&&(he.expirationId=setTimeout(A,D));return}}}re&&J.some(T=>T.expired)&&(O.current.delete(he),l&&(x.current=!0),A())}};const W=c4(q.ctrl,$);R===Wn.LEAVE&&l?O.current.set(q,{phase:R,springs:W,payload:$}):k.set(q,{phase:R,springs:W,payload:$})});const C=ce.exports.useContext(q1),I=t4(C),H=C!==I&&yre(C);Pu(()=>{H&&lt(p,q=>{q.ctrl.start({default:C})})},[C]),lt(k,(q,Z)=>{if(O.current.size){const ne=p.findIndex(ie=>ie.key===Z.key);p.splice(ne,1)}}),Pu(()=>{lt(O.current.size?O.current:k,({phase:q,payload:Z},ne)=>{const{ctrl:ie}=ne;ne.phase=q,h==null||h.add(ie),H&&q==Wn.ENTER&&ie.start({default:C}),Z&&(vre(ie,Z.ref),ie.ref&&!x.current?ie.update(Z):(ie.start(Z),x.current&&(x.current=!1)))})},i?void 0:r);const j=q=>ce.exports.createElement(ce.exports.Fragment,null,p.map((Z,ne)=>{const{springs:ie}=k.get(Z)||Z.ctrl,P=q(Pr({},ie),Z.item,Z,ne);return P&&P.type?ce.exports.createElement(P.type,Pr({},P.props,{key:Ae.str(Z.key)||Ae.num(Z.key)?Z.key:Z.ctrl.id,ref:P.ref})):P}));return h?[j,h]:j}let Sft=1;function Rft(t,{key:e,keys:r=e},n){if(r===null){const i=new Set;return t.map(o=>{const a=n&&n.find(s=>s.item===o&&s.phase!==Wn.LEAVE&&!i.has(s));return a?(i.add(a),a.key):Sft++})}return Ae.und(r)?t:Ae.fun(r)?t.map(r):qn(r)}class Mre extends p9{constructor(e,r){super(),this.key=void 0,this.idle=!0,this.calc=void 0,this._active=new Set,this.source=e,this.calc=Vv(...r);const n=this._get(),i=r4(n);u9(this,i.create(n))}advance(e){const r=this._get(),n=this.get();La(r,n)||(Zo(this).setValue(r),this._onChange(r,this.idle)),!this.idle&&Wj(this._active)&&s_(this)}_get(){const e=Ae.arr(this.source)?this.source.map(oi):qn(oi(this.source));return this.calc(...e)}_start(){this.idle&&!Wj(this._active)&&(this.idle=!1,lt(v5(this),e=>{e.done=!1}),da.skipAnimation?(ht.batchedUpdates(()=>this.advance()),s_(this)):p5.start(this))}_attach(){let e=1;lt(qn(this.source),r=>{zi(r)&&Yp(r,this),a4(r)&&(r.idle||this._active.add(r),e=Math.max(e,r.priority+1))}),this.priority=e,this._start()}_detach(){lt(qn(this.source),e=>{zi(e)&&Wv(e,this)}),this._active.clear(),s_(this)}eventObserved(e){e.type=="change"?e.idle?this.advance():(this._active.add(e.parent),this._start()):e.type=="idle"?this._active.delete(e.parent):e.type=="priority"&&(this.priority=qn(this.source).reduce((r,n)=>Math.max(r,(a4(n)?n.priority:0)+1),0))}}function Eft(t){return t.idle!==!1}function Wj(t){return!t.size||Array.from(t).every(Eft)}function s_(t){t.idle||(t.idle=!0,lt(v5(t),e=>{e.done=!0}),jv(t,{type:"idle",parent:t}))}const f4=(t,...e)=>new Mre(t,e);da.assign({createStringInterpolator:hre,to:(t,e)=>new Mre(t,e)});function g9(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}const Cft=["style","children","scrollTop","scrollLeft"],Nre=/^--/;function _ft(t,e){return e==null||typeof e=="boolean"||e===""?"":typeof e=="number"&&e!==0&&!Nre.test(t)&&!(wg.hasOwnProperty(t)&&wg[t])?e+"px":(""+e).trim()}const zj={};function Tft(t,e){if(!t.nodeType||!t.setAttribute)return!1;const r=t.nodeName==="filter"||t.parentNode&&t.parentNode.nodeName==="filter",n=e,{style:i,children:o,scrollTop:a,scrollLeft:s}=n,l=g9(n,Cft),u=Object.values(l),c=Object.keys(l).map(f=>r||t.hasAttribute(f)?f:zj[f]||(zj[f]=f.replace(/([A-Z])/g,h=>"-"+h.toLowerCase())));o!==void 0&&(t.textContent=o);for(let f in i)if(i.hasOwnProperty(f)){const h=_ft(f,i[f]);Nre.test(f)?t.style.setProperty(f,h):t.style[f]=h}c.forEach((f,h)=>{t.setAttribute(f,u[h])}),a!==void 0&&(t.scrollTop=a),s!==void 0&&(t.scrollLeft=s)}let wg={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};const Oft=(t,e)=>t+e.charAt(0).toUpperCase()+e.substring(1),Aft=["Webkit","Ms","Moz","O"];wg=Object.keys(wg).reduce((t,e)=>(Aft.forEach(r=>t[Oft(r,e)]=t[e]),t),wg);const Ift=["x","y","z"],xft=/^(matrix|translate|scale|rotate|skew)/,Mft=/^(translate)/,Nft=/^(rotate|skew)/,l_=(t,e)=>Ae.num(t)&&t!==0?t+e:t,k2=(t,e)=>Ae.arr(t)?t.every(r=>k2(r,e)):Ae.num(t)?t===e:parseFloat(t)===e;class Pft extends b5{constructor(e){let{x:r,y:n,z:i}=e,o=g9(e,Ift);const a=[],s=[];(r||n||i)&&(a.push([r||0,n||0,i||0]),s.push(l=>[`translate3d(${l.map(u=>l_(u,"px")).join(",")})`,k2(l,0)])),ha(o,(l,u)=>{if(u==="transform")a.push([l||""]),s.push(c=>[c,c===""]);else if(xft.test(u)){if(delete o[u],Ae.und(l))return;const c=Mft.test(u)?"px":Nft.test(u)?"deg":"";a.push(qn(l)),s.push(u==="rotate3d"?([f,h,d,p])=>[`rotate3d(${f},${h},${d},${l_(p,c)})`,k2(p,0)]:f=>[`${u}(${f.map(h=>l_(h,c)).join(",")})`,k2(f,u.startsWith("scale")?1:0)])}}),a.length&&(o.transform=new kft(a,s)),super(o)}}class kft extends ure{constructor(e,r){super(),this._value=null,this.inputs=e,this.transforms=r}get(){return this._value||(this._value=this._get())}_get(){let e="",r=!0;return lt(this.inputs,(n,i)=>{const o=oi(n[0]),[a,s]=this.transforms[i](Ae.arr(o)?o:n.map(oi));e+=" "+a,r=r&&s}),r?"none":e}observerAdded(e){e==1&&lt(this.inputs,r=>lt(r,n=>zi(n)&&Yp(n,this)))}observerRemoved(e){e==0&&lt(this.inputs,r=>lt(r,n=>zi(n)&&Wv(n,this)))}eventObserved(e){e.type=="change"&&(this._value=null),jv(this,e)}}const $ft=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],Lft=["scrollTop","scrollLeft"];da.assign({batchedUpdates:Rz.exports.unstable_batchedUpdates,createStringInterpolator:hre,colors:_ct});const Dft=rft($ft,{applyAnimatedValues:Tft,createAnimatedStyle:t=>new Pft(t),getComponentProps:t=>g9(t,Lft)}),kr=Dft.animated;function fc(){return fc=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},fc.apply(this,arguments)}var Fft={pointerEvents:"none",position:"absolute",zIndex:10,top:0,left:0},Gj=function(t,e){return"translate("+t+"px, "+e+"px)"},Pre=ce.exports.memo(function(t){var e,r=t.position,n=t.anchor,i=t.children,o=pr(),a=uo(),s=a.animate,l=a.config,u=cie(),c=u[0],f=u[1],h=ce.exports.useRef(!1),d=void 0,p=!1,m=f.width>0&&f.height>0,g=Math.round(r[0]),v=Math.round(r[1]);m&&(n==="top"?(g-=f.width/2,v-=f.height+14):n==="right"?(g+=14,v-=f.height/2):n==="bottom"?(g-=f.width/2,v+=14):n==="left"?(g-=f.width+14,v-=f.height/2):n==="center"&&(g-=f.width/2,v-=f.height/2),d={transform:Gj(g,v)},h.current||(p=!0),h.current=[g,v]);var w=Sa({to:d,config:l,immediate:!s||p}),b=fc({},Fft,o.tooltip,{transform:(e=w.transform)!=null?e:Gj(g,v)});return ye.jsx(kr.div,{ref:c,style:b,children:i})});Pre.displayName="TooltipWrapper";var kre=ce.exports.memo(function(t){var e=t.size,r=e===void 0?12:e,n=t.color,i=t.style;return ye.jsx("span",{style:fc({display:"block",width:r,height:r,background:n},i===void 0?{}:i)})}),$re=ce.exports.memo(function(t){var e,r=t.id,n=t.value,i=t.format,o=t.enableChip,a=o!==void 0&&o,s=t.color,l=t.renderContent,u=pr(),c=BS(i);if(typeof l=="function")e=l();else{var f=n;c!==void 0&&f!==void 0&&(f=c(f)),e=ye.jsxs("div",{style:u.tooltip.basic,children:[a&&ye.jsx(kre,{color:s,style:u.tooltip.chip}),f!==void 0?ye.jsxs("span",{children:[r,": ",ye.jsx("strong",{children:""+f})]}):r]})}return ye.jsx("div",{style:u.tooltip.container,children:e})}),Hft={width:"100%",borderCollapse:"collapse"},Lre=ce.exports.memo(function(t){var e,r=t.title,n=t.rows,i=n===void 0?[]:n,o=t.renderContent,a=pr();return i.length?(e=typeof o=="function"?o():ye.jsxs("div",{children:[r&&r,ye.jsx("table",{style:fc({},Hft,a.tooltip.table),children:ye.jsx("tbody",{children:i.map(function(s,l){return ye.jsx("tr",{children:s.map(function(u,c){return ye.jsx("td",{style:a.tooltip.tableCell,children:u},c)})},l)})})})]}),ye.jsx("div",{style:a.tooltip.container,children:e})):null});Lre.displayName="TableTooltip";var h4=ce.exports.memo(function(t){var e=t.x0,r=t.x1,n=t.y0,i=t.y1,o=pr(),a=uo(),s=a.animate,l=a.config,u=ce.exports.useMemo(function(){return fc({},o.crosshair.line,{pointerEvents:"none"})},[o.crosshair.line]),c=Sa({x1:e,x2:r,y1:n,y2:i,config:l,immediate:!s});return ye.jsx(kr.line,fc({},c,{fill:"none",style:u}))});h4.displayName="CrosshairLine";var d4=ce.exports.memo(function(t){var e,r,n=t.width,i=t.height,o=t.type,a=t.x,s=t.y;return o==="cross"?(e={x0:a,x1:a,y0:0,y1:i},r={x0:0,x1:n,y0:s,y1:s}):o==="top-left"?(e={x0:a,x1:a,y0:0,y1:s},r={x0:0,x1:a,y0:s,y1:s}):o==="top"?e={x0:a,x1:a,y0:0,y1:s}:o==="top-right"?(e={x0:a,x1:a,y0:0,y1:s},r={x0:a,x1:n,y0:s,y1:s}):o==="right"?r={x0:a,x1:n,y0:s,y1:s}:o==="bottom-right"?(e={x0:a,x1:a,y0:s,y1:i},r={x0:a,x1:n,y0:s,y1:s}):o==="bottom"?e={x0:a,x1:a,y0:s,y1:i}:o==="bottom-left"?(e={x0:a,x1:a,y0:s,y1:i},r={x0:0,x1:a,y0:s,y1:s}):o==="left"?r={x0:0,x1:a,y0:s,y1:s}:o==="x"?e={x0:a,x1:a,y0:0,y1:i}:o==="y"&&(r={x0:0,x1:n,y0:s,y1:s}),ye.jsxs(ye.Fragment,{children:[e&&ye.jsx(h4,{x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1}),r&&ye.jsx(h4,{x0:r.x0,x1:r.x1,y0:r.y0,y1:r.y1})]})});d4.displayName="Crosshair";var Dre=ce.exports.createContext({showTooltipAt:function(){},showTooltipFromEvent:function(){},hideTooltip:function(){}}),p4={isVisible:!1,position:[null,null],content:null,anchor:null},Fre=ce.exports.createContext(p4),Bft=function(t){var e=ce.exports.useState(p4),r=e[0],n=e[1],i=ce.exports.useCallback(function(s,l,u){var c=l[0],f=l[1];u===void 0&&(u="top"),n({isVisible:!0,position:[c,f],anchor:u,content:s})},[n]),o=ce.exports.useCallback(function(s,l,u){u===void 0&&(u="top");var c=t.current.getBoundingClientRect(),f=t.current.offsetWidth,h=f===c.width?1:f/c.width,d=(l.clientX-c.left)*h,p=(l.clientY-c.top)*h;u!=="left"&&u!=="right"||(u=d<c.width/2?"right":"left"),n({isVisible:!0,position:[d,p],anchor:u,content:s})},[t,n]),a=ce.exports.useCallback(function(){n(p4)},[n]);return{actions:ce.exports.useMemo(function(){return{showTooltipAt:i,showTooltipFromEvent:o,hideTooltip:a}},[i,o,a]),state:r}},X1=function(){var t=ce.exports.useContext(Dre);if(t===void 0)throw new Error("useTooltip must be used within a TooltipProvider");return t},Uft=function(){var t=ce.exports.useContext(Fre);if(t===void 0)throw new Error("useTooltipState must be used within a TooltipProvider");return t},Vft=function(t){return t.isVisible},jft=function(){var t=Uft();return Vft(t)?ye.jsx(Pre,{position:t.position,anchor:t.anchor,children:t.content}):null},Wft=function(t){var e=t.container,r=t.children,n=Bft(e),i=n.actions,o=n.state;return ye.jsx(Dre.Provider,{value:i,children:ye.jsx(Fre.Provider,{value:o,children:r})})},zft=H4,Gft=Iz;function Yft(t,e,r){(r!==void 0&&!Gft(t[e],r)||r===void 0&&!(e in t))&&zft(t,e,r)}var Hre=Yft,IS={exports:{}};(function(t,e){var r=tae,n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,o=i&&i.exports===n,a=o?r.Buffer:void 0,s=a?a.allocUnsafe:void 0;function l(u,c){if(c)return u.slice();var f=u.length,h=s?s(f):new u.constructor(f);return u.copy(h),h}t.exports=l})(IS,IS.exports);var Yj=rae;function Kft(t){var e=new t.constructor(t.byteLength);return new Yj(e).set(new Yj(t)),e}var y9=Kft,qft=y9;function Xft(t,e){var r=e?qft(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var Bre=Xft;function Qft(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var Ure=Qft,Zft=xp,Kj=Object.create,Jft=function(){function t(){}return function(e){if(!Zft(e))return{};if(Kj)return Kj(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),eht=Jft,tht=nae,rht=tht(Object.getPrototypeOf,Object),v9=rht,nht=eht,iht=v9,oht=xz;function aht(t){return typeof t.constructor=="function"&&!oht(t)?nht(iht(t)):{}}var Vre=aht,sht=Mz,lht=r1;function uht(t){return lht(t)&&sht(t)}var jre=uht,cht=Nz,fht=v9,hht=r1,dht="[object Object]",pht=Function.prototype,mht=Object.prototype,Wre=pht.toString,ght=mht.hasOwnProperty,yht=Wre.call(Object);function vht(t){if(!hht(t)||cht(t)!=dht)return!1;var e=fht(t);if(e===null)return!0;var r=ght.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&Wre.call(r)==yht}var Q1=vht;function bht(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var zre=bht,wht=H4,Sht=Iz,Rht=Object.prototype,Eht=Rht.hasOwnProperty;function Cht(t,e,r){var n=t[e];(!(Eht.call(t,e)&&Sht(n,r))||r===void 0&&!(e in t))&&wht(t,e,r)}var b9=Cht,_ht=b9,Tht=H4;function Oht(t,e,r,n){var i=!r;r||(r={});for(var o=-1,a=e.length;++o<a;){var s=e[o],l=n?n(r[s],t[s],s,r,t):void 0;l===void 0&&(l=t[s]),i?Tht(r,s,l):_ht(r,s,l)}return r}var qp=Oht;function Aht(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var Iht=Aht,xht=xp,Mht=xz,Nht=Iht,Pht=Object.prototype,kht=Pht.hasOwnProperty;function $ht(t){if(!xht(t))return Nht(t);var e=Mht(t),r=[];for(var n in t)n=="constructor"&&(e||!kht.call(t,n))||r.push(n);return r}var Lht=$ht,Dht=iae,Fht=Lht,Hht=Mz;function Bht(t){return Hht(t)?Dht(t,!0):Fht(t)}var Z1=Bht,Uht=qp,Vht=Z1;function jht(t){return Uht(t,Vht(t))}var Wht=jht,qj=Hre,zht=IS.exports,Ght=Bre,Yht=Ure,Kht=Vre,Xj=oae,Qj=B4,qht=jre,Xht=Pz.exports,Qht=Eg,Zht=xp,Jht=Q1,edt=aae,Zj=zre,tdt=Wht;function rdt(t,e,r,n,i,o,a){var s=Zj(t,r),l=Zj(e,r),u=a.get(l);if(u){qj(t,r,u);return}var c=o?o(s,l,r+"",t,e,a):void 0,f=c===void 0;if(f){var h=Qj(l),d=!h&&Xht(l),p=!h&&!d&&edt(l);c=l,h||d||p?Qj(s)?c=s:qht(s)?c=Yht(s):d?(f=!1,c=zht(l,!0)):p?(f=!1,c=Ght(l,!0)):c=[]:Jht(l)||Xj(l)?(c=s,Xj(s)?c=tdt(s):(!Zht(s)||Qht(s))&&(c=Kht(l))):f=!1}f&&(a.set(l,c),i(c,l,n,o,a),a.delete(l)),qj(t,r,c)}var ndt=rdt,idt=kz,odt=Hre,adt=sae,sdt=ndt,ldt=xp,udt=Z1,cdt=zre;function Gre(t,e,r,n,i){t!==e&&adt(e,function(o,a){if(i||(i=new idt),ldt(o))sdt(t,e,a,r,Gre,n,i);else{var s=n?n(cdt(t,a),o,a+"",t,e,i):void 0;s===void 0&&(s=o),odt(t,a,s)}},udt)}var fdt=Gre,hdt=$z,ddt=lae;function pdt(t){return hdt(function(e,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,a=i>2?r[2]:void 0;for(o=t.length>3&&typeof o=="function"?(i--,o):void 0,a&&ddt(r[0],r[1],a)&&(o=i<3?void 0:o,i=1),e=Object(e);++n<i;){var s=r[n];s&&t(e,s,n,o)}return e})}var mdt=pdt,gdt=fdt,ydt=mdt,vdt=ydt(function(t,e,r){gdt(t,e,r)}),bdt=vdt,wdt=b9,Sdt=KS,Rdt=uae,Jj=xp,Edt=Lz;function Cdt(t,e,r,n){if(!Jj(t))return t;e=Sdt(e,t);for(var i=-1,o=e.length,a=o-1,s=t;s!=null&&++i<o;){var l=Edt(e[i]),u=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return t;if(i!=a){var c=s[l];u=n?n(c,l,s):void 0,u===void 0&&(u=Jj(c)?c:Rdt(e[i+1])?[]:{})}wdt(s,l,u),s=s[l]}return t}var Yre=Cdt,_dt=Yre;function Tdt(t,e,r){return t==null?t:_dt(t,e,r)}var ku=Tdt;function S5(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function w9(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Xp(){}var hc=.7,Sp=1/hc,sh="\\s*([+-]?\\d+)\\s*",qv="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",sa="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Odt=/^#([0-9a-f]{3,8})$/,Adt=new RegExp("^rgb\\("+[sh,sh,sh]+"\\)$"),Idt=new RegExp("^rgb\\("+[sa,sa,sa]+"\\)$"),xdt=new RegExp("^rgba\\("+[sh,sh,sh,qv]+"\\)$"),Mdt=new RegExp("^rgba\\("+[sa,sa,sa,qv]+"\\)$"),Ndt=new RegExp("^hsl\\("+[qv,sa,sa]+"\\)$"),Pdt=new RegExp("^hsla\\("+[qv,sa,sa,qv]+"\\)$"),eW={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};S5(Xp,Xv,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:tW,formatHex:tW,formatHsl:kdt,formatRgb:rW,toString:rW});function tW(){return this.rgb().formatHex()}function kdt(){return qre(this).formatHsl()}function rW(){return this.rgb().formatRgb()}function Xv(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=Odt.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?nW(e):r===3?new Xn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Rb(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Rb(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Adt.exec(t))?new Xn(e[1],e[2],e[3],1):(e=Idt.exec(t))?new Xn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=xdt.exec(t))?Rb(e[1],e[2],e[3],e[4]):(e=Mdt.exec(t))?Rb(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Ndt.exec(t))?aW(e[1],e[2]/100,e[3]/100,1):(e=Pdt.exec(t))?aW(e[1],e[2]/100,e[3]/100,e[4]):eW.hasOwnProperty(t)?nW(eW[t]):t==="transparent"?new Xn(NaN,NaN,NaN,0):null}function nW(t){return new Xn(t>>16&255,t>>8&255,t&255,1)}function Rb(t,e,r,n){return n<=0&&(t=e=r=NaN),new Xn(t,e,r,n)}function Kre(t){return t instanceof Xp||(t=Xv(t)),t?(t=t.rgb(),new Xn(t.r,t.g,t.b,t.opacity)):new Xn}function Rp(t,e,r,n){return arguments.length===1?Kre(t):new Xn(t,e,r,n==null?1:n)}function Xn(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}S5(Xn,Rp,w9(Xp,{brighter:function(t){return t=t==null?Sp:Math.pow(Sp,t),new Xn(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?hc:Math.pow(hc,t),new Xn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:iW,formatHex:iW,formatRgb:oW,toString:oW}));function iW(){return"#"+u_(this.r)+u_(this.g)+u_(this.b)}function oW(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function u_(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function aW(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new ra(t,e,r,n)}function qre(t){if(t instanceof ra)return new ra(t.h,t.s,t.l,t.opacity);if(t instanceof Xp||(t=Xv(t)),!t)return new ra;if(t instanceof ra)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),o=Math.max(e,r,n),a=NaN,s=o-i,l=(o+i)/2;return s?(e===o?a=(r-n)/s+(r<n)*6:r===o?a=(n-e)/s+2:a=(e-r)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new ra(a,s,l,t.opacity)}function $dt(t,e,r,n){return arguments.length===1?qre(t):new ra(t,e,r,n==null?1:n)}function ra(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}S5(ra,$dt,w9(Xp,{brighter:function(t){return t=t==null?Sp:Math.pow(Sp,t),new ra(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?hc:Math.pow(hc,t),new ra(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new Xn(c_(t>=240?t-240:t+120,i,n),c_(t,i,n),c_(t<120?t+240:t-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function c_(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const Ldt=Math.PI/180,Ddt=180/Math.PI;var Xre=-.14861,S9=1.78277,R9=-.29227,R5=-.90649,Qv=1.97294,sW=Qv*R5,lW=Qv*S9,uW=S9*R9-R5*Xre;function Fdt(t){if(t instanceof Wu)return new Wu(t.h,t.s,t.l,t.opacity);t instanceof Xn||(t=Kre(t));var e=t.r/255,r=t.g/255,n=t.b/255,i=(uW*n+sW*e-lW*r)/(uW+sW-lW),o=n-i,a=(Qv*(r-i)-R9*o)/R5,s=Math.sqrt(a*a+o*o)/(Qv*i*(1-i)),l=s?Math.atan2(a,o)*Ddt-120:NaN;return new Wu(l<0?l+360:l,s,i,t.opacity)}function pa(t,e,r,n){return arguments.length===1?Fdt(t):new Wu(t,e,r,n==null?1:n)}function Wu(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}S5(Wu,pa,w9(Xp,{brighter:function(t){return t=t==null?Sp:Math.pow(Sp,t),new Wu(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?hc:Math.pow(hc,t),new Wu(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Ldt,e=+this.l,r=isNaN(this.s)?0:this.s*e*(1-e),n=Math.cos(t),i=Math.sin(t);return new Xn(255*(e+r*(Xre*n+S9*i)),255*(e+r*(R9*n+R5*i)),255*(e+r*(Qv*n)),this.opacity)}}));function Hdt(t,e,r,n,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*r+(1+3*t+3*o-3*a)*n+a*i)/6}function Bdt(t){var e=t.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,e-1):Math.floor(r*e),i=t[n],o=t[n+1],a=n>0?t[n-1]:2*i-o,s=n<e-1?t[n+2]:2*o-i;return Hdt((r-n/e)*e,a,i,o,s)}}const E5=t=>()=>t;function Qre(t,e){return function(r){return t+r*e}}function Udt(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function Vdt(t,e){var r=e-t;return r?Qre(t,r>180||r<-180?r-360*Math.round(r/360):r):E5(isNaN(t)?e:t)}function jdt(t){return(t=+t)==1?lh:function(e,r){return r-e?Udt(e,r,t):E5(isNaN(e)?r:e)}}function lh(t,e){var r=e-t;return r?Qre(t,r):E5(isNaN(t)?e:t)}const cW=function t(e){var r=jdt(e);function n(i,o){var a=r((i=Rp(i)).r,(o=Rp(o)).r),s=r(i.g,o.g),l=r(i.b,o.b),u=lh(i.opacity,o.opacity);return function(c){return i.r=a(c),i.g=s(c),i.b=l(c),i.opacity=u(c),i+""}}return n.gamma=t,n}(1);function Wdt(t){return function(e){var r=e.length,n=new Array(r),i=new Array(r),o=new Array(r),a,s;for(a=0;a<r;++a)s=Rp(e[a]),n[a]=s.r||0,i[a]=s.g||0,o[a]=s.b||0;return n=t(n),i=t(i),o=t(o),s.opacity=1,function(l){return s.r=n(l),s.g=i(l),s.b=o(l),s+""}}}var zdt=Wdt(Bdt);function Gdt(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),i;return function(o){for(i=0;i<r;++i)n[i]=t[i]*(1-o)+e[i]*o;return n}}function Ydt(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Kdt(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,i=new Array(n),o=new Array(r),a;for(a=0;a<n;++a)i[a]=E9(t[a],e[a]);for(;a<r;++a)o[a]=e[a];return function(s){for(a=0;a<n;++a)o[a]=i[a](s);return o}}function qdt(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function xS(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function Xdt(t,e){var r={},n={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?r[i]=E9(t[i],e[i]):n[i]=e[i];return function(o){for(i in r)n[i]=r[i](o);return n}}var m4=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,f_=new RegExp(m4.source,"g");function Qdt(t){return function(){return t}}function Zdt(t){return function(e){return t(e)+""}}function Zre(t,e){var r=m4.lastIndex=f_.lastIndex=0,n,i,o,a=-1,s=[],l=[];for(t=t+"",e=e+"";(n=m4.exec(t))&&(i=f_.exec(e));)(o=i.index)>r&&(o=e.slice(r,o),s[a]?s[a]+=o:s[++a]=o),(n=n[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,l.push({i:a,x:xS(n,i)})),r=f_.lastIndex;return r<e.length&&(o=e.slice(r),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?Zdt(l[0].x):Qdt(e):(e=l.length,function(u){for(var c=0,f;c<e;++c)s[(f=l[c]).i]=f.x(u);return s.join("")})}function E9(t,e){var r=typeof e,n;return e==null||r==="boolean"?E5(e):(r==="number"?xS:r==="string"?(n=Xv(e))?(e=n,cW):Zre:e instanceof Xv?cW:e instanceof Date?qdt:Ydt(e)?Gdt:Array.isArray(e)?Kdt:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Xdt:xS)(t,e)}function Jdt(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function Jre(t){return function e(r){r=+r;function n(i,o){var a=t((i=pa(i)).h,(o=pa(o)).h),s=lh(i.s,o.s),l=lh(i.l,o.l),u=lh(i.opacity,o.opacity);return function(c){return i.h=a(c),i.s=s(c),i.l=l(Math.pow(c,r)),i.opacity=u(c),i+""}}return n.gamma=e,n}(1)}Jre(Vdt);var C9=Jre(lh);function ene(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function _9(t){let e=t,r=t;t.length===1&&(e=(a,s)=>t(a)-s,r=ept(t));function n(a,s,l,u){for(l==null&&(l=0),u==null&&(u=a.length);l<u;){const c=l+u>>>1;r(a[c],s)<0?l=c+1:u=c}return l}function i(a,s,l,u){for(l==null&&(l=0),u==null&&(u=a.length);l<u;){const c=l+u>>>1;r(a[c],s)>0?u=c:l=c+1}return l}function o(a,s,l,u){l==null&&(l=0),u==null&&(u=a.length);const c=n(a,s,l,u-1);return c>l&&e(a[c-1],s)>-e(a[c],s)?c-1:c}return{left:n,center:o,right:i}}function ept(t){return(e,r)=>ene(t(e),r)}function tpt(t){return t===null?NaN:+t}const rpt=_9(ene),npt=rpt.right;_9(tpt).center;const ipt=npt;var g4=Math.sqrt(50),y4=Math.sqrt(10),v4=Math.sqrt(2);function b4(t,e,r){var n,i=-1,o,a,s;if(e=+e,t=+t,r=+r,t===e&&r>0)return[t];if((n=e<t)&&(o=t,t=e,e=o),(s=tne(t,e,r))===0||!isFinite(s))return[];if(s>0){let l=Math.round(t/s),u=Math.round(e/s);for(l*s<t&&++l,u*s>e&&--u,a=new Array(o=u-l+1);++i<o;)a[i]=(l+i)*s}else{s=-s;let l=Math.round(t*s),u=Math.round(e*s);for(l/s<t&&++l,u/s>e&&--u,a=new Array(o=u-l+1);++i<o;)a[i]=(l+i)/s}return n&&a.reverse(),a}function tne(t,e,r){var n=(e-t)/Math.max(0,r),i=Math.floor(Math.log(n)/Math.LN10),o=n/Math.pow(10,i);return i>=0?(o>=g4?10:o>=y4?5:o>=v4?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=g4?10:o>=y4?5:o>=v4?2:1)}function w4(t,e,r){var n=Math.abs(e-t)/Math.max(0,r),i=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),o=n/i;return o>=g4?i*=10:o>=y4?i*=5:o>=v4&&(i*=2),e<t?-i:i}function opt(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((e-t)/r))|0,o=new Array(i);++n<i;)o[n]=t+n*r;return o}function xc(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const fW=Symbol("implicit");function $u(){var t=new Map,e=[],r=[],n=fW;function i(o){var a=o+"",s=t.get(a);if(!s){if(n!==fW)return n;t.set(a,s=e.push(o))}return r[(s-1)%r.length]}return i.domain=function(o){if(!arguments.length)return e.slice();e=[],t=new Map;for(const a of o){const s=a+"";t.has(s)||t.set(s,e.push(a))}return i},i.range=function(o){return arguments.length?(r=Array.from(o),i):r.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return $u(e,r).unknown(n)},xc.apply(i,arguments),i}function T9(){var t=$u().unknown(void 0),e=t.domain,r=t.range,n=0,i=1,o,a,s=!1,l=0,u=0,c=.5;delete t.unknown;function f(){var h=e().length,d=i<n,p=d?i:n,m=d?n:i;o=(m-p)/Math.max(1,h-l+u*2),s&&(o=Math.floor(o)),p+=(m-p-o*(h-l))*c,a=o*(1-l),s&&(p=Math.round(p),a=Math.round(a));var g=opt(h).map(function(v){return p+o*v});return r(d?g.reverse():g)}return t.domain=function(h){return arguments.length?(e(h),f()):e()},t.range=function(h){return arguments.length?([n,i]=h,n=+n,i=+i,f()):[n,i]},t.rangeRound=function(h){return[n,i]=h,n=+n,i=+i,s=!0,f()},t.bandwidth=function(){return a},t.step=function(){return o},t.round=function(h){return arguments.length?(s=!!h,f()):s},t.padding=function(h){return arguments.length?(l=Math.min(1,u=+h),f()):l},t.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),f()):l},t.paddingOuter=function(h){return arguments.length?(u=+h,f()):u},t.align=function(h){return arguments.length?(c=Math.max(0,Math.min(1,h)),f()):c},t.copy=function(){return T9(e(),[n,i]).round(s).paddingInner(l).paddingOuter(u).align(c)},xc.apply(f(),arguments)}function rne(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return rne(e())},t}function apt(){return rne(T9.apply(null,arguments).paddingInner(1))}function spt(t){return function(){return t}}function lpt(t){return+t}var hW=[0,1];function Hf(t){return t}function S4(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:spt(isNaN(e)?NaN:.5)}function upt(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function cpt(t,e,r){var n=t[0],i=t[1],o=e[0],a=e[1];return i<n?(n=S4(i,n),o=r(a,o)):(n=S4(n,i),o=r(o,a)),function(s){return o(n(s))}}function fpt(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),o=new Array(n),a=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<n;)i[a]=S4(t[a],t[a+1]),o[a]=r(e[a],e[a+1]);return function(s){var l=ipt(t,s,1,n)-1;return o[l](i[l](s))}}function C5(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function O9(){var t=hW,e=hW,r=E9,n,i,o,a=Hf,s,l,u;function c(){var h=Math.min(t.length,e.length);return a!==Hf&&(a=upt(t[0],t[h-1])),s=h>2?fpt:cpt,l=u=null,f}function f(h){return h==null||isNaN(h=+h)?o:(l||(l=s(t.map(n),e,r)))(n(a(h)))}return f.invert=function(h){return a(i((u||(u=s(e,t.map(n),xS)))(h)))},f.domain=function(h){return arguments.length?(t=Array.from(h,lpt),c()):t.slice()},f.range=function(h){return arguments.length?(e=Array.from(h),c()):e.slice()},f.rangeRound=function(h){return e=Array.from(h),r=Jdt,c()},f.clamp=function(h){return arguments.length?(a=h?!0:Hf,c()):a!==Hf},f.interpolate=function(h){return arguments.length?(r=h,c()):r},f.unknown=function(h){return arguments.length?(o=h,f):o},function(h,d){return n=h,i=d,c()}}function nne(){return O9()(Hf,Hf)}function hpt(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function MS(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Ep(t){return t=MS(Math.abs(t)),t?t[1]:NaN}function dpt(t,e){return function(r,n){for(var i=r.length,o=[],a=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),o.push(r.substring(i-=s,i+s)),!((l+=s+1)>n));)s=t[a=(a+1)%t.length];return o.reverse().join(e)}}function ppt(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var mpt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function NS(t){if(!(e=mpt.exec(t)))throw new Error("invalid format: "+t);var e;return new A9({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}NS.prototype=A9.prototype;function A9(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}A9.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function gpt(t){e:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var ine;function ypt(t,e){var r=MS(t,e);if(!r)return t+"";var n=r[0],i=r[1],o=i-(ine=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=n.length;return o===a?n:o>a?n+new Array(o-a+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+MS(t,Math.max(0,e+o-1))[0]}function dW(t,e){var r=MS(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const pW={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:hpt,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>dW(t*100,e),r:dW,s:ypt,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function mW(t){return t}var gW=Array.prototype.map,yW=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function vpt(t){var e=t.grouping===void 0||t.thousands===void 0?mW:dpt(gW.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?mW:ppt(gW.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"\u2212":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(f){f=NS(f);var h=f.fill,d=f.align,p=f.sign,m=f.symbol,g=f.zero,v=f.width,w=f.comma,b=f.precision,E=f.trim,A=f.type;A==="n"?(w=!0,A="g"):pW[A]||(b===void 0&&(b=12),E=!0,A="g"),(g||h==="0"&&d==="=")&&(g=!0,h="0",d="=");var M=m==="$"?r:m==="#"&&/[boxX]/.test(A)?"0"+A.toLowerCase():"",k=m==="$"?n:/[%p]/.test(A)?a:"",O=pW[A],x=/[defgprs%]/.test(A);b=b===void 0?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function C(I){var H=M,j=k,q,Z,ne;if(A==="c")j=O(I)+j,I="";else{I=+I;var ie=I<0||1/I<0;if(I=isNaN(I)?l:O(Math.abs(I),b),E&&(I=gpt(I)),ie&&+I==0&&p!=="+"&&(ie=!1),H=(ie?p==="("?p:s:p==="-"||p==="("?"":p)+H,j=(A==="s"?yW[8+ine/3]:"")+j+(ie&&p==="("?")":""),x){for(q=-1,Z=I.length;++q<Z;)if(ne=I.charCodeAt(q),48>ne||ne>57){j=(ne===46?i+I.slice(q+1):I.slice(q))+j,I=I.slice(0,q);break}}}w&&!g&&(I=e(I,1/0));var P=H.length+I.length+j.length,y=P<v?new Array(v-P+1).join(h):"";switch(w&&g&&(I=e(y+I,y.length?v-j.length:1/0),y=""),d){case"<":I=H+I+j+y;break;case"=":I=H+y+I+j;break;case"^":I=y.slice(0,P=y.length>>1)+H+I+j+y.slice(P);break;default:I=y+H+I+j;break}return o(I)}return C.toString=function(){return f+""},C}function c(f,h){var d=u((f=NS(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(Ep(h)/3)))*3,m=Math.pow(10,-p),g=yW[8+p/3];return function(v){return d(m*v)+g}}return{format:u,formatPrefix:c}}var Eb,I9,one;bpt({thousands:",",grouping:[3],currency:["$",""]});function bpt(t){return Eb=vpt(t),I9=Eb.format,one=Eb.formatPrefix,Eb}function wpt(t){return Math.max(0,-Ep(Math.abs(t)))}function Spt(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ep(e)/3)))*3-Ep(Math.abs(t)))}function Rpt(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Ep(e)-Ep(t))+1}function Ept(t,e,r,n){var i=w4(t,e,r),o;switch(n=NS(n==null?",f":n),n.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(o=Spt(i,a))&&(n.precision=o),one(n,a)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(o=Rpt(i,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=o-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(o=wpt(i))&&(n.precision=o-(n.type==="%")*2);break}}return I9(n)}function ane(t){var e=t.domain;return t.ticks=function(r){var n=e();return b4(n[0],n[n.length-1],r==null?10:r)},t.tickFormat=function(r,n){var i=e();return Ept(i[0],i[i.length-1],r==null?10:r,n)},t.nice=function(r){r==null&&(r=10);var n=e(),i=0,o=n.length-1,a=n[i],s=n[o],l,u,c=10;for(s<a&&(u=a,a=s,s=u,u=i,i=o,o=u);c-- >0;){if(u=tne(a,s,r),u===l)return n[i]=a,n[o]=s,e(n);if(u>0)a=Math.floor(a/u)*u,s=Math.ceil(s/u)*u;else if(u<0)a=Math.ceil(a*u)/u,s=Math.floor(s*u)/u;else break;l=u}return t},t}function sne(){var t=nne();return t.copy=function(){return C5(t,sne())},xc.apply(t,arguments),ane(t)}function lne(t,e){t=t.slice();var r=0,n=t.length-1,i=t[r],o=t[n],a;return o<i&&(a=r,r=n,n=a,a=i,i=o,o=a),t[r]=e.floor(i),t[n]=e.ceil(o),t}function vW(t){return Math.log(t)}function bW(t){return Math.exp(t)}function Cpt(t){return-Math.log(-t)}function _pt(t){return-Math.exp(-t)}function Tpt(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Opt(t){return t===10?Tpt:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function Apt(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function wW(t){return function(e){return-t(-e)}}function Ipt(t){var e=t(vW,bW),r=e.domain,n=10,i,o;function a(){return i=Apt(n),o=Opt(n),r()[0]<0?(i=wW(i),o=wW(o),t(Cpt,_pt)):t(vW,bW),e}return e.base=function(s){return arguments.length?(n=+s,a()):n},e.domain=function(s){return arguments.length?(r(s),a()):r()},e.ticks=function(s){var l=r(),u=l[0],c=l[l.length-1],f;(f=c<u)&&(h=u,u=c,c=h);var h=i(u),d=i(c),p,m,g,v=s==null?10:+s,w=[];if(!(n%1)&&d-h<v){if(h=Math.floor(h),d=Math.ceil(d),u>0){for(;h<=d;++h)for(m=1,p=o(h);m<n;++m)if(g=p*m,!(g<u)){if(g>c)break;w.push(g)}}else for(;h<=d;++h)for(m=n-1,p=o(h);m>=1;--m)if(g=p*m,!(g<u)){if(g>c)break;w.push(g)}w.length*2<v&&(w=b4(u,c,v))}else w=b4(h,d,Math.min(d-h,v)).map(o);return f?w.reverse():w},e.tickFormat=function(s,l){if(l==null&&(l=n===10?".0e":","),typeof l!="function"&&(l=I9(l)),s===1/0)return l;s==null&&(s=10);var u=Math.max(1,n*s/e.ticks().length);return function(c){var f=c/o(Math.round(i(c)));return f*n<n-.5&&(f*=n),f<=u?l(c):""}},e.nice=function(){return r(lne(r(),{floor:function(s){return o(Math.floor(i(s)))},ceil:function(s){return o(Math.ceil(i(s)))}}))},e}function une(){var t=Ipt(O9()).domain([1,10]);return t.copy=function(){return C5(t,une()).base(t.base())},xc.apply(t,arguments),t}function SW(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function RW(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function xpt(t){var e=1,r=t(SW(e),RW(e));return r.constant=function(n){return arguments.length?t(SW(e=+n),RW(e)):e},ane(r)}function cne(){var t=xpt(O9());return t.copy=function(){return C5(t,cne()).constant(t.constant())},xc.apply(t,arguments)}var h_=new Date,d_=new Date;function Sn(t,e,r,n){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=function(o){return t(o=new Date(+o)),o},i.ceil=function(o){return t(o=new Date(o-1)),e(o,1),t(o),o},i.round=function(o){var a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=function(o,a){return e(o=new Date(+o),a==null?1:Math.floor(a)),o},i.range=function(o,a,s){var l=[],u;if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return l;do l.push(u=new Date(+o)),e(o,s),t(o);while(u<o&&o<a);return l},i.filter=function(o){return Sn(function(a){if(a>=a)for(;t(a),!o(a);)a.setTime(a-1)},function(a,s){if(a>=a)if(s<0)for(;++s<=0;)for(;e(a,-1),!o(a););else for(;--s>=0;)for(;e(a,1),!o(a););})},r&&(i.count=function(o,a){return h_.setTime(+o),d_.setTime(+a),t(h_),t(d_),Math.floor(r(h_,d_))},i.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(n?function(a){return n(a)%o===0}:function(a){return i.count(0,a)%o===0}):i}),i}var PS=Sn(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});PS.every=function(t){return t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Sn(function(e){e.setTime(Math.floor(e/t)*t)},function(e,r){e.setTime(+e+r*t)},function(e,r){return(r-e)/t}):PS};const Mpt=PS;PS.range;const hs=1e3,qi=hs*60,ds=qi*60,dc=ds*24,x9=dc*7,EW=dc*30,p_=dc*365;var fne=Sn(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+e*hs)},function(t,e){return(e-t)/hs},function(t){return t.getUTCSeconds()});const Bf=fne;fne.range;var hne=Sn(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*hs)},function(t,e){t.setTime(+t+e*qi)},function(t,e){return(e-t)/qi},function(t){return t.getMinutes()});const dne=hne;hne.range;var pne=Sn(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*hs-t.getMinutes()*qi)},function(t,e){t.setTime(+t+e*ds)},function(t,e){return(e-t)/ds},function(t){return t.getHours()});const mne=pne;pne.range;var gne=Sn(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*qi)/dc,t=>t.getDate()-1);const _5=gne;gne.range;function Mc(t){return Sn(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,r){e.setDate(e.getDate()+r*7)},function(e,r){return(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*qi)/x9})}var T5=Mc(0),kS=Mc(1),Npt=Mc(2),Ppt=Mc(3),Cp=Mc(4),kpt=Mc(5),$pt=Mc(6);T5.range;kS.range;Npt.range;Ppt.range;Cp.range;kpt.range;$pt.range;var yne=Sn(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12},function(t){return t.getMonth()});const vne=yne;yne.range;var M9=Sn(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});M9.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:Sn(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,r){e.setFullYear(e.getFullYear()+r*t)})};const pc=M9;M9.range;var bne=Sn(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*qi)},function(t,e){return(e-t)/qi},function(t){return t.getUTCMinutes()});const wne=bne;bne.range;var Sne=Sn(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*ds)},function(t,e){return(e-t)/ds},function(t){return t.getUTCHours()});const Rne=Sne;Sne.range;var Ene=Sn(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/dc},function(t){return t.getUTCDate()-1});const O5=Ene;Ene.range;function Nc(t){return Sn(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCDate(e.getUTCDate()+r*7)},function(e,r){return(r-e)/x9})}var A5=Nc(0),$S=Nc(1),Lpt=Nc(2),Dpt=Nc(3),_p=Nc(4),Fpt=Nc(5),Hpt=Nc(6);A5.range;$S.range;Lpt.range;Dpt.range;_p.range;Fpt.range;Hpt.range;var Cne=Sn(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12},function(t){return t.getUTCMonth()});const _ne=Cne;Cne.range;var N9=Sn(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});N9.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:Sn(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCFullYear(e.getUTCFullYear()+r*t)})};const mc=N9;N9.range;function Tne(t,e,r,n,i,o){const a=[[Bf,1,hs],[Bf,5,5*hs],[Bf,15,15*hs],[Bf,30,30*hs],[o,1,qi],[o,5,5*qi],[o,15,15*qi],[o,30,30*qi],[i,1,ds],[i,3,3*ds],[i,6,6*ds],[i,12,12*ds],[n,1,dc],[n,2,2*dc],[r,1,x9],[e,1,EW],[e,3,3*EW],[t,1,p_]];function s(u,c,f){const h=c<u;h&&([u,c]=[c,u]);const d=f&&typeof f.range=="function"?f:l(u,c,f),p=d?d.range(u,+c+1):[];return h?p.reverse():p}function l(u,c,f){const h=Math.abs(c-u)/f,d=_9(([,,g])=>g).right(a,h);if(d===a.length)return t.every(w4(u/p_,c/p_,f));if(d===0)return Mpt.every(Math.max(w4(u,c,f),1));const[p,m]=a[h/a[d-1][2]<a[d][2]/h?d-1:d];return p.every(m)}return[s,l]}const[Bpt,Upt]=Tne(mc,_ne,A5,O5,Rne,wne),[Vpt,jpt]=Tne(pc,vne,T5,_5,mne,dne);function m_(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function g_(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Mm(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function Wpt(t){var e=t.dateTime,r=t.date,n=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,l=t.shortMonths,u=Nm(i),c=Pm(i),f=Nm(o),h=Pm(o),d=Nm(a),p=Pm(a),m=Nm(s),g=Pm(s),v=Nm(l),w=Pm(l),b={a:ie,A:P,b:y,B:R,c:null,d:IW,e:IW,f:dmt,g:Emt,G:_mt,H:cmt,I:fmt,j:hmt,L:One,m:pmt,M:mmt,p:_,q:$,Q:NW,s:PW,S:gmt,u:ymt,U:vmt,V:bmt,w:wmt,W:Smt,x:null,X:null,y:Rmt,Y:Cmt,Z:Tmt,"%":MW},E={a:B,A:W,b:ee,B:J,c:null,d:xW,e:xW,f:xmt,g:Bmt,G:Vmt,H:Omt,I:Amt,j:Imt,L:Ine,m:Mmt,M:Nmt,p:he,q:re,Q:NW,s:PW,S:Pmt,u:kmt,U:$mt,V:Lmt,w:Dmt,W:Fmt,x:null,X:null,y:Hmt,Y:Umt,Z:jmt,"%":MW},A={a:C,A:I,b:H,B:j,c:q,d:OW,e:OW,f:amt,g:TW,G:_W,H:AW,I:AW,j:rmt,L:omt,m:tmt,M:nmt,p:x,q:emt,Q:lmt,s:umt,S:imt,u:qpt,U:Xpt,V:Qpt,w:Kpt,W:Zpt,x:Z,X:ne,y:TW,Y:_W,Z:Jpt,"%":smt};b.x=M(r,b),b.X=M(n,b),b.c=M(e,b),E.x=M(r,E),E.X=M(n,E),E.c=M(e,E);function M(T,D){return function(z){var K=[],le=-1,X=0,we=T.length,Ce,Ee,Te;for(z instanceof Date||(z=new Date(+z));++le<we;)T.charCodeAt(le)===37&&(K.push(T.slice(X,le)),(Ee=CW[Ce=T.charAt(++le)])!=null?Ce=T.charAt(++le):Ee=Ce==="e"?" ":"0",(Te=D[Ce])&&(Ce=Te(z,Ee)),K.push(Ce),X=le+1);return K.push(T.slice(X,le)),K.join("")}}function k(T,D){return function(z){var K=Mm(1900,void 0,1),le=O(K,T,z+="",0),X,we;if(le!=z.length)return null;if("Q"in K)return new Date(K.Q);if("s"in K)return new Date(K.s*1e3+("L"in K?K.L:0));if(D&&!("Z"in K)&&(K.Z=0),"p"in K&&(K.H=K.H%12+K.p*12),K.m===void 0&&(K.m="q"in K?K.q:0),"V"in K){if(K.V<1||K.V>53)return null;"w"in K||(K.w=1),"Z"in K?(X=g_(Mm(K.y,0,1)),we=X.getUTCDay(),X=we>4||we===0?$S.ceil(X):$S(X),X=O5.offset(X,(K.V-1)*7),K.y=X.getUTCFullYear(),K.m=X.getUTCMonth(),K.d=X.getUTCDate()+(K.w+6)%7):(X=m_(Mm(K.y,0,1)),we=X.getDay(),X=we>4||we===0?kS.ceil(X):kS(X),X=_5.offset(X,(K.V-1)*7),K.y=X.getFullYear(),K.m=X.getMonth(),K.d=X.getDate()+(K.w+6)%7)}else("W"in K||"U"in K)&&("w"in K||(K.w="u"in K?K.u%7:"W"in K?1:0),we="Z"in K?g_(Mm(K.y,0,1)).getUTCDay():m_(Mm(K.y,0,1)).getDay(),K.m=0,K.d="W"in K?(K.w+6)%7+K.W*7-(we+5)%7:K.w+K.U*7-(we+6)%7);return"Z"in K?(K.H+=K.Z/100|0,K.M+=K.Z%100,g_(K)):m_(K)}}function O(T,D,z,K){for(var le=0,X=D.length,we=z.length,Ce,Ee;le<X;){if(K>=we)return-1;if(Ce=D.charCodeAt(le++),Ce===37){if(Ce=D.charAt(le++),Ee=A[Ce in CW?D.charAt(le++):Ce],!Ee||(K=Ee(T,z,K))<0)return-1}else if(Ce!=z.charCodeAt(K++))return-1}return K}function x(T,D,z){var K=u.exec(D.slice(z));return K?(T.p=c.get(K[0].toLowerCase()),z+K[0].length):-1}function C(T,D,z){var K=d.exec(D.slice(z));return K?(T.w=p.get(K[0].toLowerCase()),z+K[0].length):-1}function I(T,D,z){var K=f.exec(D.slice(z));return K?(T.w=h.get(K[0].toLowerCase()),z+K[0].length):-1}function H(T,D,z){var K=v.exec(D.slice(z));return K?(T.m=w.get(K[0].toLowerCase()),z+K[0].length):-1}function j(T,D,z){var K=m.exec(D.slice(z));return K?(T.m=g.get(K[0].toLowerCase()),z+K[0].length):-1}function q(T,D,z){return O(T,e,D,z)}function Z(T,D,z){return O(T,r,D,z)}function ne(T,D,z){return O(T,n,D,z)}function ie(T){return a[T.getDay()]}function P(T){return o[T.getDay()]}function y(T){return l[T.getMonth()]}function R(T){return s[T.getMonth()]}function _(T){return i[+(T.getHours()>=12)]}function $(T){return 1+~~(T.getMonth()/3)}function B(T){return a[T.getUTCDay()]}function W(T){return o[T.getUTCDay()]}function ee(T){return l[T.getUTCMonth()]}function J(T){return s[T.getUTCMonth()]}function he(T){return i[+(T.getUTCHours()>=12)]}function re(T){return 1+~~(T.getUTCMonth()/3)}return{format:function(T){var D=M(T+="",b);return D.toString=function(){return T},D},parse:function(T){var D=k(T+="",!1);return D.toString=function(){return T},D},utcFormat:function(T){var D=M(T+="",E);return D.toString=function(){return T},D},utcParse:function(T){var D=k(T+="",!0);return D.toString=function(){return T},D}}}var CW={"-":"",_:" ",0:"0"},Rn=/^\s*\d+/,zpt=/^%/,Gpt=/[\\^$*+?|[\]().{}]/g;function Ut(t,e,r){var n=t<0?"-":"",i=(n?-t:t)+"",o=i.length;return n+(o<r?new Array(r-o+1).join(e)+i:i)}function Ypt(t){return t.replace(Gpt,"\\$&")}function Nm(t){return new RegExp("^(?:"+t.map(Ypt).join("|")+")","i")}function Pm(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function Kpt(t,e,r){var n=Rn.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function qpt(t,e,r){var n=Rn.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function Xpt(t,e,r){var n=Rn.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function Qpt(t,e,r){var n=Rn.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function Zpt(t,e,r){var n=Rn.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function _W(t,e,r){var n=Rn.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function TW(t,e,r){var n=Rn.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function Jpt(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function emt(t,e,r){var n=Rn.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function tmt(t,e,r){var n=Rn.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function OW(t,e,r){var n=Rn.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function rmt(t,e,r){var n=Rn.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function AW(t,e,r){var n=Rn.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function nmt(t,e,r){var n=Rn.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function imt(t,e,r){var n=Rn.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function omt(t,e,r){var n=Rn.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function amt(t,e,r){var n=Rn.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function smt(t,e,r){var n=zpt.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function lmt(t,e,r){var n=Rn.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function umt(t,e,r){var n=Rn.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function IW(t,e){return Ut(t.getDate(),e,2)}function cmt(t,e){return Ut(t.getHours(),e,2)}function fmt(t,e){return Ut(t.getHours()%12||12,e,2)}function hmt(t,e){return Ut(1+_5.count(pc(t),t),e,3)}function One(t,e){return Ut(t.getMilliseconds(),e,3)}function dmt(t,e){return One(t,e)+"000"}function pmt(t,e){return Ut(t.getMonth()+1,e,2)}function mmt(t,e){return Ut(t.getMinutes(),e,2)}function gmt(t,e){return Ut(t.getSeconds(),e,2)}function ymt(t){var e=t.getDay();return e===0?7:e}function vmt(t,e){return Ut(T5.count(pc(t)-1,t),e,2)}function Ane(t){var e=t.getDay();return e>=4||e===0?Cp(t):Cp.ceil(t)}function bmt(t,e){return t=Ane(t),Ut(Cp.count(pc(t),t)+(pc(t).getDay()===4),e,2)}function wmt(t){return t.getDay()}function Smt(t,e){return Ut(kS.count(pc(t)-1,t),e,2)}function Rmt(t,e){return Ut(t.getFullYear()%100,e,2)}function Emt(t,e){return t=Ane(t),Ut(t.getFullYear()%100,e,2)}function Cmt(t,e){return Ut(t.getFullYear()%1e4,e,4)}function _mt(t,e){var r=t.getDay();return t=r>=4||r===0?Cp(t):Cp.ceil(t),Ut(t.getFullYear()%1e4,e,4)}function Tmt(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ut(e/60|0,"0",2)+Ut(e%60,"0",2)}function xW(t,e){return Ut(t.getUTCDate(),e,2)}function Omt(t,e){return Ut(t.getUTCHours(),e,2)}function Amt(t,e){return Ut(t.getUTCHours()%12||12,e,2)}function Imt(t,e){return Ut(1+O5.count(mc(t),t),e,3)}function Ine(t,e){return Ut(t.getUTCMilliseconds(),e,3)}function xmt(t,e){return Ine(t,e)+"000"}function Mmt(t,e){return Ut(t.getUTCMonth()+1,e,2)}function Nmt(t,e){return Ut(t.getUTCMinutes(),e,2)}function Pmt(t,e){return Ut(t.getUTCSeconds(),e,2)}function kmt(t){var e=t.getUTCDay();return e===0?7:e}function $mt(t,e){return Ut(A5.count(mc(t)-1,t),e,2)}function xne(t){var e=t.getUTCDay();return e>=4||e===0?_p(t):_p.ceil(t)}function Lmt(t,e){return t=xne(t),Ut(_p.count(mc(t),t)+(mc(t).getUTCDay()===4),e,2)}function Dmt(t){return t.getUTCDay()}function Fmt(t,e){return Ut($S.count(mc(t)-1,t),e,2)}function Hmt(t,e){return Ut(t.getUTCFullYear()%100,e,2)}function Bmt(t,e){return t=xne(t),Ut(t.getUTCFullYear()%100,e,2)}function Umt(t,e){return Ut(t.getUTCFullYear()%1e4,e,4)}function Vmt(t,e){var r=t.getUTCDay();return t=r>=4||r===0?_p(t):_p.ceil(t),Ut(t.getUTCFullYear()%1e4,e,4)}function jmt(){return"+0000"}function MW(){return"%"}function NW(t){return+t}function PW(t){return Math.floor(+t/1e3)}var vf,I5,Mne,Nne,Pne;Wmt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Wmt(t){return vf=Wpt(t),I5=vf.format,Mne=vf.parse,Nne=vf.utcFormat,Pne=vf.utcParse,vf}function zmt(t){return new Date(t)}function Gmt(t){return t instanceof Date?+t:+new Date(+t)}function P9(t,e,r,n,i,o,a,s,l,u){var c=nne(),f=c.invert,h=c.domain,d=u(".%L"),p=u(":%S"),m=u("%I:%M"),g=u("%I %p"),v=u("%a %d"),w=u("%b %d"),b=u("%B"),E=u("%Y");function A(M){return(l(M)<M?d:s(M)<M?p:a(M)<M?m:o(M)<M?g:n(M)<M?i(M)<M?v:w:r(M)<M?b:E)(M)}return c.invert=function(M){return new Date(f(M))},c.domain=function(M){return arguments.length?h(Array.from(M,Gmt)):h().map(zmt)},c.ticks=function(M){var k=h();return t(k[0],k[k.length-1],M==null?10:M)},c.tickFormat=function(M,k){return k==null?A:u(k)},c.nice=function(M){var k=h();return(!M||typeof M.range!="function")&&(M=e(k[0],k[k.length-1],M==null?10:M)),M?h(lne(k,M)):c},c.copy=function(){return C5(c,P9(t,e,r,n,i,o,a,s,l,u))},c}function Ymt(){return xc.apply(P9(Vpt,jpt,pc,vne,T5,_5,mne,dne,Bf,I5).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Kmt(){return xc.apply(P9(Bpt,Upt,mc,_ne,A5,O5,Rne,wne,Bf,Nne).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Ot(t){for(var e=t.length/6|0,r=new Array(e),n=0;n<e;)r[n]="#"+t.slice(n*6,++n*6);return r}const kne=Ot("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),$ne=Ot("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Lne=Ot("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Dne=Ot("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Fne=Ot("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Hne=Ot("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Bne=Ot("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Une=Ot("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),k9=Ot("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),or=t=>zdt(t[t.length-1]);var x5=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Ot);const qmt=or(x5);var M5=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Ot);const Xmt=or(M5);var N5=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Ot);const Qmt=or(N5);var P5=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Ot);const Zmt=or(P5);var k5=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Ot);const Jmt=or(k5);var $5=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Ot);const egt=or($5);var L5=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Ot);const tgt=or(L5);var D5=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Ot);const rgt=or(D5);var F5=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Ot);const ngt=or(F5);var H5=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Ot);const igt=or(H5);var B5=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Ot);const ogt=or(B5);var U5=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Ot);const agt=or(U5);var V5=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Ot);const sgt=or(V5);var j5=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Ot);const lgt=or(j5);var W5=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Ot);const ugt=or(W5);var z5=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Ot);const cgt=or(z5);var G5=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Ot);const fgt=or(G5);var Y5=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Ot);const hgt=or(Y5);var K5=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Ot);const dgt=or(K5);var q5=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Ot);const pgt=or(q5);var X5=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Ot);const mgt=or(X5);var Q5=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Ot);const ggt=or(Q5);var Z5=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Ot);const ygt=or(Z5);var J5=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Ot);const vgt=or(J5);var eR=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Ot);const bgt=or(eR);var tR=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Ot);const wgt=or(tR);var rR=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Ot);const Sgt=or(rR);function Rgt(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-t*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-t*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-t*2475.67)))))))+")"}const Egt=C9(pa(300,.5,0),pa(-240,.5,1));var Cgt=C9(pa(-100,.75,.35),pa(80,1.5,.8)),_gt=C9(pa(260,.75,.35),pa(80,1.5,.8)),Cb=pa();function Tgt(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return Cb.h=360*t-100,Cb.s=1.5-1.5*e,Cb.l=.8-.9*e,Cb+""}var _b=Rp(),Ogt=Math.PI/3,Agt=Math.PI*2/3;function Igt(t){var e;return t=(.5-t)*Math.PI,_b.r=255*(e=Math.sin(t))*e,_b.g=255*(e=Math.sin(t+Ogt))*e,_b.b=255*(e=Math.sin(t+Agt))*e,_b+""}function xgt(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-t*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+t*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-t*6838.66)))))))+")"}function nR(t){var e=t.length;return function(r){return t[Math.max(0,Math.min(e-1,Math.floor(r*e)))]}}const Mgt=nR(Ot("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var Ngt=nR(Ot("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Pgt=nR(Ot("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),kgt=nR(Ot("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),$gt=cae,Lgt=fae,Dgt=hae,Fgt=Dz,Hgt=qS,Bgt=dae,Ugt=200;function Vgt(t,e,r,n){var i=-1,o=Lgt,a=!0,s=t.length,l=[],u=e.length;if(!s)return l;r&&(e=Fgt(e,Hgt(r))),n?(o=Dgt,a=!1):e.length>=Ugt&&(o=Bgt,a=!1,e=new $gt(e));e:for(;++i<s;){var c=t[i],f=r==null?c:r(c);if(c=n||c!==0?c:0,a&&f===f){for(var h=u;h--;)if(e[h]===f)continue e;l.push(c)}else o(e,f,n)||l.push(c)}return l}var jgt=Vgt,Wgt=jgt,zgt=$z,Ggt=jre,Ygt=zgt(function(t,e){return Ggt(t)?Wgt(t,e):[]}),Vne=Ygt,R4=Math.PI,E4=2*R4,Jl=1e-6,Kgt=E4-Jl;function C4(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function $9(){return new C4}C4.prototype=$9.prototype={constructor:C4,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,r,n){this._+="Q"+ +t+","+ +e+","+(this._x1=+r)+","+(this._y1=+n)},bezierCurveTo:function(t,e,r,n,i,o){this._+="C"+ +t+","+ +e+","+ +r+","+ +n+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,r,n,i){t=+t,e=+e,r=+r,n=+n,i=+i;var o=this._x1,a=this._y1,s=r-t,l=n-e,u=o-t,c=a-e,f=u*u+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(f>Jl)if(!(Math.abs(c*s-l*u)>Jl)||!i)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var h=r-o,d=n-a,p=s*s+l*l,m=h*h+d*d,g=Math.sqrt(p),v=Math.sqrt(f),w=i*Math.tan((R4-Math.acos((p+f-m)/(2*g*v)))/2),b=w/v,E=w/g;Math.abs(b-1)>Jl&&(this._+="L"+(t+b*u)+","+(e+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*h>u*d)+","+(this._x1=t+E*s)+","+(this._y1=e+E*l)}},arc:function(t,e,r,n,i,o){t=+t,e=+e,r=+r,o=!!o;var a=r*Math.cos(n),s=r*Math.sin(n),l=t+a,u=e+s,c=1^o,f=o?n-i:i-n;if(r<0)throw new Error("negative radius: "+r);this._x1===null?this._+="M"+l+","+u:(Math.abs(this._x1-l)>Jl||Math.abs(this._y1-u)>Jl)&&(this._+="L"+l+","+u),r&&(f<0&&(f=f%E4+E4),f>Kgt?this._+="A"+r+","+r+",0,1,"+c+","+(t-a)+","+(e-s)+"A"+r+","+r+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):f>Jl&&(this._+="A"+r+","+r+",0,"+ +(f>=R4)+","+c+","+(this._x1=t+r*Math.cos(i))+","+(this._y1=e+r*Math.sin(i))))},rect:function(t,e,r,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +r+"v"+ +n+"h"+-r+"Z"},toString:function(){return this._}};function On(t){return function(){return t}}var kW=1e-12;function jne(t){this._context=t}jne.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function L9(t){return new jne(t)}function Wne(t){return t[0]}function zne(t){return t[1]}function Gne(){var t=Wne,e=zne,r=On(!0),n=null,i=L9,o=null;function a(s){var l,u=s.length,c,f=!1,h;for(n==null&&(o=i(h=$9())),l=0;l<=u;++l)!(l<u&&r(c=s[l],l,s))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(c,l,s),+e(c,l,s));if(h)return o=null,h+""||null}return a.x=function(s){return arguments.length?(t=typeof s=="function"?s:On(+s),a):t},a.y=function(s){return arguments.length?(e=typeof s=="function"?s:On(+s),a):e},a.defined=function(s){return arguments.length?(r=typeof s=="function"?s:On(!!s),a):r},a.curve=function(s){return arguments.length?(i=s,n!=null&&(o=i(n)),a):i},a.context=function(s){return arguments.length?(s==null?n=o=null:o=i(n=s),a):n},a}function qgt(){var t=Wne,e=null,r=On(0),n=zne,i=On(!0),o=null,a=L9,s=null;function l(c){var f,h,d,p=c.length,m,g=!1,v,w=new Array(p),b=new Array(p);for(o==null&&(s=a(v=$9())),f=0;f<=p;++f){if(!(f<p&&i(m=c[f],f,c))===g)if(g=!g)h=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=f-1;d>=h;--d)s.point(w[d],b[d]);s.lineEnd(),s.areaEnd()}g&&(w[f]=+t(m,f,c),b[f]=+r(m,f,c),s.point(e?+e(m,f,c):w[f],n?+n(m,f,c):b[f]))}if(v)return s=null,v+""||null}function u(){return Gne().defined(i).curve(a).context(o)}return l.x=function(c){return arguments.length?(t=typeof c=="function"?c:On(+c),e=null,l):t},l.x0=function(c){return arguments.length?(t=typeof c=="function"?c:On(+c),l):t},l.x1=function(c){return arguments.length?(e=c==null?null:typeof c=="function"?c:On(+c),l):e},l.y=function(c){return arguments.length?(r=typeof c=="function"?c:On(+c),n=null,l):r},l.y0=function(c){return arguments.length?(r=typeof c=="function"?c:On(+c),l):r},l.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:On(+c),l):n},l.lineX0=l.lineY0=function(){return u().x(t).y(r)},l.lineY1=function(){return u().x(t).y(n)},l.lineX1=function(){return u().x(e).y(r)},l.defined=function(c){return arguments.length?(i=typeof c=="function"?c:On(!!c),l):i},l.curve=function(c){return arguments.length?(a=c,o!=null&&(s=a(o)),l):a},l.context=function(c){return arguments.length?(c==null?o=s=null:s=a(o=c),l):o},l}var $W=Array.prototype.slice;function bl(){}function LS(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function iR(t){this._context=t}iR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:LS(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:LS(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Xgt(t){return new iR(t)}function Yne(t){this._context=t}Yne.prototype={areaStart:bl,areaEnd:bl,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:LS(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Qgt(t){return new Yne(t)}function Kne(t){this._context=t}Kne.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:LS(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Zgt(t){return new Kne(t)}function qne(t,e){this._basis=new iR(t),this._beta=e}qne.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,r=t.length-1;if(r>0)for(var n=t[0],i=e[0],o=t[r]-n,a=e[r]-i,s=-1,l;++s<=r;)l=s/r,this._basis.point(this._beta*t[s]+(1-this._beta)*(n+l*o),this._beta*e[s]+(1-this._beta)*(i+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const Jgt=function t(e){function r(n){return e===1?new iR(n):new qne(n,e)}return r.beta=function(n){return t(+n)},r}(.85);function DS(t,e,r){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-r),t._x2,t._y2)}function D9(t,e){this._context=t,this._k=(1-e)/6}D9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:DS(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:DS(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const eyt=function t(e){function r(n){return new D9(n,e)}return r.tension=function(n){return t(+n)},r}(0);function F9(t,e){this._context=t,this._k=(1-e)/6}F9.prototype={areaStart:bl,areaEnd:bl,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:DS(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const tyt=function t(e){function r(n){return new F9(n,e)}return r.tension=function(n){return t(+n)},r}(0);function H9(t,e){this._context=t,this._k=(1-e)/6}H9.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:DS(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const ryt=function t(e){function r(n){return new H9(n,e)}return r.tension=function(n){return t(+n)},r}(0);function B9(t,e,r){var n=t._x1,i=t._y1,o=t._x2,a=t._y2;if(t._l01_a>kW){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);n=(n*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>kW){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*u+t._x1*t._l23_2a-e*t._l12_2a)/c,a=(a*u+t._y1*t._l23_2a-r*t._l12_2a)/c}t._context.bezierCurveTo(n,i,o,a,t._x2,t._y2)}function Xne(t,e){this._context=t,this._alpha=e}Xne.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var r=this._x2-t,n=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:B9(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const nyt=function t(e){function r(n){return e?new Xne(n,e):new D9(n,0)}return r.alpha=function(n){return t(+n)},r}(.5);function Qne(t,e){this._context=t,this._alpha=e}Qne.prototype={areaStart:bl,areaEnd:bl,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){if(t=+t,e=+e,this._point){var r=this._x2-t,n=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:B9(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const iyt=function t(e){function r(n){return e?new Qne(n,e):new F9(n,0)}return r.alpha=function(n){return t(+n)},r}(.5);function Zne(t,e){this._context=t,this._alpha=e}Zne.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var r=this._x2-t,n=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:B9(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const oyt=function t(e){function r(n){return e?new Zne(n,e):new H9(n,0)}return r.alpha=function(n){return t(+n)},r}(.5);function Jne(t){this._context=t}Jne.prototype={areaStart:bl,areaEnd:bl,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function ayt(t){return new Jne(t)}function LW(t){return t<0?-1:1}function DW(t,e,r){var n=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(n||i<0&&-0),a=(r-t._y1)/(i||n<0&&-0),s=(o*i+a*n)/(n+i);return(LW(o)+LW(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function FW(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function y_(t,e,r){var n=t._x0,i=t._y0,o=t._x1,a=t._y1,s=(o-n)/3;t._context.bezierCurveTo(n+s,i+s*e,o-s,a-s*r,o,a)}function FS(t){this._context=t}FS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:y_(this,this._t0,FW(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,y_(this,FW(this,r=DW(this,t,e)),r);break;default:y_(this,this._t0,r=DW(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function eie(t){this._context=new tie(t)}(eie.prototype=Object.create(FS.prototype)).point=function(t,e){FS.prototype.point.call(this,e,t)};function tie(t){this._context=t}tie.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,i,o){this._context.bezierCurveTo(e,t,n,r,o,i)}};function syt(t){return new FS(t)}function lyt(t){return new eie(t)}function rie(t){this._context=t}rie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=HW(t),i=HW(e),o=0,a=1;a<r;++o,++a)this._context.bezierCurveTo(n[0][o],i[0][o],n[1][o],i[1][o],t[a],e[a]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function HW(t){var e,r=t.length-1,n,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,a[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/o[e-1],o[e]-=n,a[e]-=n*a[e-1];for(i[r-1]=a[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(a[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}function uyt(t){return new rie(t)}function oR(t,e){this._context=t,this._t=e}oR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function cyt(t){return new oR(t,.5)}function fyt(t){return new oR(t,0)}function hyt(t){return new oR(t,1)}function Tp(t,e){if((a=t.length)>1)for(var r=1,n,i,o=t[e[0]],a,s=o.length;r<a;++r)for(i=o,o=t[e[r]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function Op(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function dyt(t,e){return t[e]}function pyt(){var t=On([]),e=Op,r=Tp,n=dyt;function i(o){var a=t.apply(this,arguments),s,l=o.length,u=a.length,c=new Array(u),f;for(s=0;s<u;++s){for(var h=a[s],d=c[s]=new Array(l),p=0,m;p<l;++p)d[p]=m=[0,+n(o[p],h,p,o)],m.data=o[p];d.key=h}for(s=0,f=e(c);s<u;++s)c[f[s]].index=s;return r(c,f),c}return i.keys=function(o){return arguments.length?(t=typeof o=="function"?o:On($W.call(o)),i):t},i.value=function(o){return arguments.length?(n=typeof o=="function"?o:On(+o),i):n},i.order=function(o){return arguments.length?(e=o==null?Op:typeof o=="function"?o:On($W.call(o)),i):e},i.offset=function(o){return arguments.length?(r=o==null?Tp:o,i):r},i}function myt(t,e){if((n=t.length)>0){for(var r,n,i=0,o=t[0].length,a;i<o;++i){for(a=r=0;r<n;++r)a+=t[r][i][1]||0;if(a)for(r=0;r<n;++r)t[r][i][1]/=a}Tp(t,e)}}function nie(t,e){if((l=t.length)>0)for(var r,n=0,i,o,a,s,l,u=t[e[0]].length;n<u;++n)for(a=s=0,r=0;r<l;++r)(o=(i=t[e[r]][n])[1]-i[0])>0?(i[0]=a,i[1]=a+=o):o<0?(i[1]=s,i[0]=s+=o):(i[0]=0,i[1]=o)}function gyt(t,e){if((i=t.length)>0){for(var r=0,n=t[e[0]],i,o=n.length;r<o;++r){for(var a=0,s=0;a<i;++a)s+=t[a][r][1]||0;n[r][1]+=n[r][0]=-s/2}Tp(t,e)}}function yyt(t,e){if(!(!((a=t.length)>0)||!((o=(i=t[e[0]]).length)>0))){for(var r=0,n=1,i,o,a;n<o;++n){for(var s=0,l=0,u=0;s<a;++s){for(var c=t[e[s]],f=c[n][1]||0,h=c[n-1][1]||0,d=(f-h)/2,p=0;p<s;++p){var m=t[e[p]],g=m[n][1]||0,v=m[n-1][1]||0;d+=g-v}l+=f,u+=d*f}i[n-1][1]+=i[n-1][0]=r,l&&(r-=u/l)}i[n-1][1]+=i[n-1][0]=r,Tp(t,e)}}function vyt(t){var e=t.map(byt);return Op(t).sort(function(r,n){return e[r]-e[n]})}function byt(t){for(var e=-1,r=0,n=t.length,i,o=-1/0;++e<n;)(i=+t[e][1])>o&&(o=i,r=e);return r}function iie(t){var e=t.map(oie);return Op(t).sort(function(r,n){return e[r]-e[n]})}function oie(t){for(var e=0,r=-1,n=t.length,i;++r<n;)(i=+t[r][1])&&(e+=i);return e}function wyt(t){return iie(t).reverse()}function Syt(t){var e=t.length,r,n,i=t.map(oie),o=vyt(t),a=0,s=0,l=[],u=[];for(r=0;r<e;++r)n=o[r],a<s?(a+=i[n],l.push(n)):(s+=i[n],u.push(n));return u.reverse().concat(l)}function Ryt(t){return Op(t).reverse()}function Eyt(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function HS(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Cyt(t){return t=HS(Math.abs(t)),t?t[1]:NaN}function _yt(t,e){return function(r,n){for(var i=r.length,o=[],a=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),o.push(r.substring(i-=s,i+s)),!((l+=s+1)>n));)s=t[a=(a+1)%t.length];return o.reverse().join(e)}}function Tyt(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var Oyt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function _4(t){if(!(e=Oyt.exec(t)))throw new Error("invalid format: "+t);var e;return new U9({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}_4.prototype=U9.prototype;function U9(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}U9.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ayt(t){e:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var aie;function Iyt(t,e){var r=HS(t,e);if(!r)return t+"";var n=r[0],i=r[1],o=i-(aie=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=n.length;return o===a?n:o>a?n+new Array(o-a+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+HS(t,Math.max(0,e+o-1))[0]}function BW(t,e){var r=HS(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const UW={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:Eyt,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return BW(t*100,e)},r:BW,s:Iyt,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function VW(t){return t}var jW=Array.prototype.map,WW=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function xyt(t){var e=t.grouping===void 0||t.thousands===void 0?VW:_yt(jW.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?VW:Tyt(jW.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"-":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(f){f=_4(f);var h=f.fill,d=f.align,p=f.sign,m=f.symbol,g=f.zero,v=f.width,w=f.comma,b=f.precision,E=f.trim,A=f.type;A==="n"?(w=!0,A="g"):UW[A]||(b===void 0&&(b=12),E=!0,A="g"),(g||h==="0"&&d==="=")&&(g=!0,h="0",d="=");var M=m==="$"?r:m==="#"&&/[boxX]/.test(A)?"0"+A.toLowerCase():"",k=m==="$"?n:/[%p]/.test(A)?a:"",O=UW[A],x=/[defgprs%]/.test(A);b=b===void 0?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function C(I){var H=M,j=k,q,Z,ne;if(A==="c")j=O(I)+j,I="";else{I=+I;var ie=I<0||1/I<0;if(I=isNaN(I)?l:O(Math.abs(I),b),E&&(I=Ayt(I)),ie&&+I==0&&p!=="+"&&(ie=!1),H=(ie?p==="("?p:s:p==="-"||p==="("?"":p)+H,j=(A==="s"?WW[8+aie/3]:"")+j+(ie&&p==="("?")":""),x){for(q=-1,Z=I.length;++q<Z;)if(ne=I.charCodeAt(q),48>ne||ne>57){j=(ne===46?i+I.slice(q+1):I.slice(q))+j,I=I.slice(0,q);break}}}w&&!g&&(I=e(I,1/0));var P=H.length+I.length+j.length,y=P<v?new Array(v-P+1).join(h):"";switch(w&&g&&(I=e(y+I,y.length?v-j.length:1/0),y=""),d){case"<":I=H+I+j+y;break;case"=":I=H+y+I+j;break;case"^":I=y.slice(0,P=y.length>>1)+H+I+j+y.slice(P);break;default:I=y+H+I+j;break}return o(I)}return C.toString=function(){return f+""},C}function c(f,h){var d=u((f=_4(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(Cyt(h)/3)))*3,m=Math.pow(10,-p),g=WW[8+p/3];return function(v){return d(m*v)+g}}return{format:u,formatPrefix:c}}var Tb,aR;Myt({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Myt(t){return Tb=xyt(t),aR=Tb.format,Tb.formatPrefix,Tb}var Nyt=Fz,Pyt=Yre,kyt=KS;function $yt(t,e,r){for(var n=-1,i=e.length,o={};++n<i;){var a=e[n],s=Nyt(t,a);r(s,a)&&Pyt(o,kyt(a,t),s)}return o}var Lyt=$yt,Dyt=Lyt,Fyt=pae;function Hyt(t,e){return Dyt(t,e,function(r,n){return Fyt(t,n)})}var Byt=Hyt,Uyt=mae;function Vyt(t){var e=t==null?0:t.length;return e?Uyt(t,1):[]}var jyt=Vyt,Wyt=jyt,zyt=gae,Gyt=yae;function Yyt(t){return Gyt(zyt(t,void 0,Wyt),t+"")}var sie=Yyt,Kyt=Byt,qyt=sie,Xyt=qyt(function(t,e){return t==null?{}:Kyt(t,e)}),Qyt=Xyt;function an(){return an=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},an.apply(this,arguments)}function T4(t,e){return T4=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},T4(t,e)}function V9(t,e){if(t==null)return{};var r,n,i={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(i[r]=t[r]);return i}var wl={fill:N.exports.string,fontSize:N.exports.number,fontFamily:N.exports.string},Zyt=N.exports.shape({domain:N.exports.shape({line:N.exports.shape({stroke:N.exports.string.isRequired,strokeWidth:N.exports.number.isRequired,strokeDasharray:N.exports.string}).isRequired}).isRequired,ticks:N.exports.shape({line:N.exports.shape({stroke:N.exports.string.isRequired,strokeWidth:N.exports.number.isRequired,strokeDasharray:N.exports.string}).isRequired,text:N.exports.shape(an({},wl)).isRequired}).isRequired,legend:N.exports.shape({text:N.exports.shape(an({},wl)).isRequired}).isRequired}),Jyt=N.exports.shape({line:N.exports.shape({stroke:N.exports.string.isRequired,strokeWidth:N.exports.number.isRequired,strokeDasharray:N.exports.string}).isRequired}),evt=N.exports.shape({hidden:N.exports.shape({symbol:N.exports.shape({fill:N.exports.string.isRequired,opacity:N.exports.number}).isRequired,text:N.exports.shape(an({},wl,{opacity:N.exports.number})).isRequired}).isRequired,text:N.exports.shape(an({},wl)).isRequired}),tvt=N.exports.shape({text:N.exports.shape(an({},wl)).isRequired}),rvt=N.exports.shape({text:N.exports.shape(an({},wl)).isRequired}),nvt=N.exports.shape({text:N.exports.shape(an({},wl)).isRequired}),ivt=N.exports.shape({line:N.exports.shape({stroke:N.exports.string.isRequired,strokeWidth:N.exports.number.isRequired,strokeDasharray:N.exports.string}).isRequired}),ovt=N.exports.shape({text:N.exports.shape(an({},wl,{outlineWidth:N.exports.number.isRequired,outlineColor:N.exports.string.isRequired})).isRequired,link:N.exports.shape({stroke:N.exports.string.isRequired,strokeWidth:N.exports.number.isRequired,outlineWidth:N.exports.number.isRequired,outlineColor:N.exports.string.isRequired}).isRequired,outline:N.exports.shape({stroke:N.exports.string.isRequired,strokeWidth:N.exports.number.isRequired,outlineWidth:N.exports.number.isRequired,outlineColor:N.exports.string.isRequired}).isRequired,symbol:N.exports.shape({fill:N.exports.string.isRequired,outlineWidth:N.exports.number.isRequired,outlineColor:N.exports.string.isRequired}).isRequired});N.exports.shape({background:N.exports.string.isRequired,fontFamily:N.exports.string.isRequired,fontSize:N.exports.number.isRequired,textColor:N.exports.string.isRequired,axis:Zyt.isRequired,grid:Jyt.isRequired,legends:evt.isRequired,labels:tvt.isRequired,dots:rvt.isRequired,markers:nvt,crosshair:ivt.isRequired,annotations:ovt.isRequired});var avt={background:"transparent",fontFamily:"sans-serif",fontSize:11,textColor:"#333333",axis:{domain:{line:{stroke:"transparent",strokeWidth:1}},ticks:{line:{stroke:"#777777",strokeWidth:1},text:{}},legend:{text:{fontSize:12}}},grid:{line:{stroke:"#dddddd",strokeWidth:1}},legends:{hidden:{symbol:{fill:"#333333",opacity:.6},text:{fill:"#333333",opacity:.6}},text:{},ticks:{line:{stroke:"#777777",strokeWidth:1},text:{fontSize:10}},title:{text:{}}},labels:{text:{}},markers:{lineColor:"#000000",lineStrokeWidth:1,text:{}},dots:{text:{}},tooltip:{container:{background:"white",color:"inherit",fontSize:"inherit",borderRadius:"2px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.25)",padding:"5px 9px"},basic:{whiteSpace:"pre",display:"flex",alignItems:"center"},chip:{marginRight:7},table:{},tableCell:{padding:"3px 5px"},tableCellValue:{fontWeight:"bold"}},crosshair:{line:{stroke:"#000000",strokeWidth:1,strokeOpacity:.75,strokeDasharray:"6 6"}},annotations:{text:{fontSize:13,outlineWidth:2,outlineColor:"#ffffff",outlineOpacity:1},link:{stroke:"#000000",strokeWidth:1,outlineWidth:2,outlineColor:"#ffffff",outlineOpacity:1},outline:{fill:"none",stroke:"#000000",strokeWidth:2,outlineWidth:2,outlineColor:"#ffffff",outlineOpacity:1},symbol:{fill:"#000000",outlineWidth:2,outlineColor:"#ffffff",outlineOpacity:1}}},svt=["axis.ticks.text","axis.legend.text","legends.title.text","legends.text","legends.ticks.text","legends.title.text","labels.text","dots.text","markers.text","annotations.text"],lvt=function(t,e){var r=bdt({},t,e);return svt.forEach(function(n){Xi(r,n+".fontFamily")===void 0&&ku(r,n+".fontFamily",r.fontFamily),Xi(r,n+".fontSize")===void 0&&ku(r,n+".fontSize",r.fontSize),Xi(r,n+".fill")===void 0&&ku(r,n+".fill",r.textColor)}),r},lie=ce.exports.createContext(),j9=function(t){var e=t.children,r=t.animate,n=t.stiffness,i=t.damping,o=t.config,a=ce.exports.useMemo(function(){var s=vae(o)?h9[o]:o;return{animate:r,springConfig:{stiffness:n,damping:i},config:s}},[r,n,i,o]);return ye.jsx(lie.Provider,{value:a,children:e})},Km={animate:N.exports.bool,motionStiffness:N.exports.number,motionDamping:N.exports.number,motionConfig:N.exports.oneOfType([N.exports.oneOf(Object.keys(h9)),N.exports.shape({mass:N.exports.number,tension:N.exports.number,friction:N.exports.number,clamp:N.exports.bool,precision:N.exports.number,velocity:N.exports.number,duration:N.exports.number,easing:N.exports.func})])};j9.propTypes={children:N.exports.node.isRequired,animate:Km.animate,stiffness:Km.motionStiffness,damping:Km.motionDamping,config:Km.motionConfig};var uvt={animate:!0,stiffness:90,damping:15,config:"default"};j9.defaultProps=uvt;var uo=function(){return ce.exports.useContext(lie)},W9=function(t){var e=uo(),r=e.animate,n=e.config,i=function(s){var l=ce.exports.useRef();return ce.exports.useEffect(function(){l.current=s},[s]),l.current}(t),o=ce.exports.useMemo(function(){return Zre(i,t)},[i,t]),a=Sa({from:{value:0},to:{value:1},reset:!0,config:n,immediate:!r}).value;return f4(a,o)},cvt={nivo:["#d76445","#f47560","#e8c1a0","#97e3d5","#61cdbb","#00b0a7"],BrBG:Qe(x5),PRGn:Qe(M5),PiYG:Qe(N5),PuOr:Qe(P5),RdBu:Qe(k5),RdGy:Qe($5),RdYlBu:Qe(L5),RdYlGn:Qe(D5),spectral:Qe(F5),blues:Qe(Q5),greens:Qe(Z5),greys:Qe(J5),oranges:Qe(rR),purples:Qe(eR),reds:Qe(tR),BuGn:Qe(H5),BuPu:Qe(B5),GnBu:Qe(U5),OrRd:Qe(V5),PuBuGn:Qe(j5),PuBu:Qe(W5),PuRd:Qe(z5),RdPu:Qe(G5),YlGnBu:Qe(Y5),YlGn:Qe(K5),YlOrBr:Qe(q5),YlOrRd:Qe(X5)},fvt=Object.keys(cvt);Qe(x5),Qe(M5),Qe(N5),Qe(P5),Qe(k5),Qe($5),Qe(L5),Qe(D5),Qe(F5),Qe(Q5),Qe(Z5),Qe(J5),Qe(rR),Qe(eR),Qe(tR),Qe(H5),Qe(B5),Qe(U5),Qe(V5),Qe(j5),Qe(W5),Qe(z5),Qe(G5),Qe(Y5),Qe(K5),Qe(q5),Qe(X5);N.exports.oneOfType([N.exports.oneOf(fvt),N.exports.func,N.exports.arrayOf(N.exports.string)]);var O4={basis:Xgt,basisClosed:Qgt,basisOpen:Zgt,bundle:Jgt,cardinal:eyt,cardinalClosed:tyt,cardinalOpen:ryt,catmullRom:nyt,catmullRomClosed:iyt,catmullRomOpen:oyt,linear:L9,linearClosed:ayt,monotoneX:syt,monotoneY:lyt,natural:uyt,step:cyt,stepAfter:hyt,stepBefore:fyt},sR=Object.keys(O4);N.exports.oneOf(sR);sR.filter(function(t){return t.endsWith("Closed")});Vne(sR,"bundle","basisClosed","basisOpen","cardinalClosed","cardinalOpen","catmullRomClosed","catmullRomOpen","linearClosed");var hvt=Vne(sR,"bundle","basisClosed","basisOpen","cardinalClosed","cardinalOpen","catmullRomClosed","catmullRomOpen","linearClosed"),dvt=N.exports.oneOf(hvt),uie=function(t){if(!O4[t])throw new TypeError("'"+t+"', is not a valid curve interpolator identifier.");return O4[t]},pvt={defs:N.exports.arrayOf(N.exports.shape({id:N.exports.string.isRequired})).isRequired,fill:N.exports.arrayOf(N.exports.shape({id:N.exports.string.isRequired,match:N.exports.oneOfType([N.exports.oneOf(["*"]),N.exports.object,N.exports.func]).isRequired})).isRequired},mvt={ascending:iie,descending:wyt,insideOut:Syt,none:Op,reverse:Ryt},gvt=Object.keys(mvt);N.exports.oneOf(gvt);var yvt={expand:myt,diverging:nie,none:Tp,silhouette:gyt,wiggle:yyt},vvt=Object.keys(yvt);N.exports.oneOf(vvt);N.exports.shape({top:N.exports.number,right:N.exports.number,bottom:N.exports.number,left:N.exports.number}).isRequired;var bvt=["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],z9=N.exports.oneOf(bvt);$u(k9);var wvt={top:0,right:0,bottom:0,left:0},lR=function(t,e,r){return r===void 0&&(r={}),ce.exports.useMemo(function(){var n=an({},wvt,r);return{margin:n,innerWidth:t-n.left-n.right,innerHeight:e-n.top-n.bottom,outerWidth:t,outerHeight:e}},[t,e,r.top,r.right,r.bottom,r.left])},cie=function(){var t=ce.exports.useRef(null),e=ce.exports.useState({left:0,top:0,width:0,height:0}),r=e[0],n=e[1],i=ce.exports.useState(function(){return typeof window<"u"?new ResizeObserver(function(o){var a=o[0];return n(a.contentRect)}):null})[0];return ce.exports.useEffect(function(){return t.current&&i!==null&&i.observe(t.current),function(){i!==null&&i.disconnect()}},[]),[t,r]},Svt=function(t){return ce.exports.useMemo(function(){return lvt(avt,t)},[t])},Rvt=function(t){return typeof t=="function"?t:typeof t=="string"?t.indexOf("time:")===0?I5(t.slice("5")):aR(t):function(e){return""+e}},BS=function(t){return ce.exports.useMemo(function(){return Rvt(t)},[t])},fie=ce.exports.createContext(),Evt={},hie=function(t){var e=t.theme,r=e===void 0?Evt:e,n=t.children,i=Svt(r);return ye.jsx(fie.Provider,{value:i,children:n})};hie.propTypes={children:N.exports.node.isRequired,theme:N.exports.object};var pr=function(){return ce.exports.useContext(fie)},die=function(t){var e=t.children,r=t.condition,n=t.wrapper;return r?ce.exports.cloneElement(n,{},e):e};die.propTypes={children:N.exports.node.isRequired,condition:N.exports.bool.isRequired,wrapper:N.exports.element.isRequired};var Cvt={position:"relative"},uR=function(t){var e=t.children,r=t.theme,n=t.renderWrapper,i=n===void 0||n,o=t.isInteractive,a=o===void 0||o,s=t.animate,l=t.motionStiffness,u=t.motionDamping,c=t.motionConfig,f=ce.exports.useRef(null);return ye.jsx(hie,{theme:r,children:ye.jsx(j9,{animate:s,stiffness:l,damping:u,config:c,children:ye.jsx(Wft,{container:f,children:ye.jsxs(die,{condition:i,wrapper:ye.jsx("div",{style:Cvt,ref:f}),children:[e,a&&ye.jsx(jft,{})]})})})})};uR.propTypes={children:N.exports.element.isRequired,isInteractive:N.exports.bool,renderWrapper:N.exports.bool,theme:N.exports.object,animate:N.exports.bool,motionStiffness:N.exports.number,motionDamping:N.exports.number,motionConfig:N.exports.string};N.exports.func.isRequired,N.exports.bool,N.exports.bool,N.exports.object.isRequired,N.exports.bool.isRequired,N.exports.number,N.exports.number,N.exports.string;var J1=function(t){var e=t.children,r=cie(),n=r[0],i=r[1],o=i.width>0&&i.height>0;return ye.jsx("div",{ref:n,style:{width:"100%",height:"100%"},children:o&&e({width:i.width,height:i.height})})};J1.propTypes={children:N.exports.func.isRequired};var _vt=["id","colors"],pie=function(t){var e=t.id,r=t.colors,n=V9(t,_vt);return ye.jsx("linearGradient",an({id:e,x1:0,x2:0,y1:0,y2:1},n,{children:r.map(function(i){var o=i.offset,a=i.color,s=i.opacity;return ye.jsx("stop",{offset:o+"%",stopColor:a,stopOpacity:s!==void 0?s:1},o)})}))};pie.propTypes={id:N.exports.string.isRequired,colors:N.exports.arrayOf(N.exports.shape({offset:N.exports.number.isRequired,color:N.exports.string.isRequired,opacity:N.exports.number})).isRequired,gradientTransform:N.exports.string};var mie={linearGradient:pie},$2=ce.exports.memo(function(t){var e=t.id,r=t.background,n=t.color,i=t.size,o=t.padding,a=t.stagger,s=i+o,l=i/2,u=o/2;return a===!0&&(s=2*i+2*o),ye.jsxs("pattern",{id:e,width:s,height:s,patternUnits:"userSpaceOnUse",children:[ye.jsx("rect",{width:s,height:s,fill:r}),ye.jsx("circle",{cx:u+l,cy:u+l,r:l,fill:n}),a&&ye.jsx("circle",{cx:1.5*o+i+l,cy:1.5*o+i+l,r:l,fill:n})]})});$2.displayName="PatternDots",$2.propTypes={id:N.exports.string.isRequired,color:N.exports.string.isRequired,background:N.exports.string.isRequired,size:N.exports.number.isRequired,padding:N.exports.number.isRequired,stagger:N.exports.bool.isRequired},$2.defaultProps={color:"#000000",background:"#ffffff",size:4,padding:4,stagger:!1};var Zv=function(t){return t*Math.PI/180},Tvt=function(t){return 180*t/Math.PI},Ovt=function(t,e){return{x:Math.cos(t)*e,y:Math.sin(t)*e}},Avt=function(t){var e=t%360;return e<0&&(e+=360),e},Ivt={svg:{align:{left:"start",center:"middle",right:"end",start:"start",middle:"middle",end:"end"},baseline:{top:"text-before-edge",center:"central",bottom:"alphabetic"}},canvas:{align:{left:"left",center:"center",right:"right",start:"left",middle:"center",end:"right"},baseline:{top:"top",center:"middle",bottom:"bottom"}}},L2=ce.exports.memo(function(t){var e=t.id,r=t.spacing,n=t.rotation,i=t.background,o=t.color,a=t.lineWidth,s=Math.round(n)%360,l=Math.abs(r);s>180?s-=360:s>90?s-=180:s<-180?s+=360:s<-90&&(s+=180);var u,c=l,f=l;return s===0?u=`
                M 0 0 L `+c+` 0
                M 0 `+f+" L "+c+" "+f+`
            `:s===90?u=`
                M 0 0 L 0 `+f+`
                M `+c+" 0 L "+c+" "+f+`
            `:(c=Math.abs(l/Math.sin(Zv(s))),f=l/Math.sin(Zv(90-s)),u=s>0?`
                    M 0 `+-f+" L "+2*c+" "+f+`
                    M `+-c+" "+-f+" L "+c+" "+f+`
                    M `+-c+" 0 L "+c+" "+2*f+`
                `:`
                    M `+-c+" "+f+" L "+c+" "+-f+`
                    M `+-c+" "+2*f+" L "+2*c+" "+-f+`
                    M 0 `+2*f+" L "+2*c+` 0
                `),ye.jsxs("pattern",{id:e,width:c,height:f,patternUnits:"userSpaceOnUse",children:[ye.jsx("rect",{width:c,height:f,fill:i,stroke:"rgba(255, 0, 0, 0.1)",strokeWidth:0}),ye.jsx("path",{d:u,strokeWidth:a,stroke:o,strokeLinecap:"square"})]})});L2.displayName="PatternLines",L2.propTypes={id:N.exports.string.isRequired,spacing:N.exports.number.isRequired,rotation:N.exports.number.isRequired,background:N.exports.string.isRequired,color:N.exports.string.isRequired,lineWidth:N.exports.number.isRequired},L2.defaultProps={spacing:5,rotation:0,color:"#000000",background:"#ffffff",lineWidth:2};var D2=ce.exports.memo(function(t){var e=t.id,r=t.background,n=t.color,i=t.size,o=t.padding,a=t.stagger,s=i+o,l=o/2;return a===!0&&(s=2*i+2*o),ye.jsxs("pattern",{id:e,width:s,height:s,patternUnits:"userSpaceOnUse",children:[ye.jsx("rect",{width:s,height:s,fill:r}),ye.jsx("rect",{x:l,y:l,width:i,height:i,fill:n}),a&&ye.jsx("rect",{x:1.5*o+i,y:1.5*o+i,width:i,height:i,fill:n})]})});D2.displayName="PatternSquares",D2.propTypes={id:N.exports.string.isRequired,color:N.exports.string.isRequired,background:N.exports.string.isRequired,size:N.exports.number.isRequired,padding:N.exports.number.isRequired,stagger:N.exports.bool.isRequired},D2.defaultProps={color:"#000000",background:"#ffffff",size:4,padding:4,stagger:!1};var gie={patternDots:$2,patternLines:L2,patternSquares:D2},xvt=["type"],A4=an({},mie,gie),yie=function(t){var e=t.defs;return!e||e.length<1?null:ye.jsx("defs",{"aria-hidden":!0,children:e.map(function(r){var n=r.type,i=V9(r,xvt);return A4[n]?ce.exports.createElement(A4[n],an({key:i.id},i)):null})})};yie.propTypes={defs:N.exports.arrayOf(N.exports.shape({type:N.exports.oneOf(Object.keys(A4)).isRequired,id:N.exports.string.isRequired}))};var Mvt=ce.exports.memo(yie),G9=function(t){var e=t.width,r=t.height,n=t.margin,i=t.defs,o=t.children,a=t.role,s=t.ariaLabel,l=t.ariaLabelledBy,u=t.ariaDescribedBy,c=t.isFocusable,f=pr();return ye.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:r,role:a,"aria-label":s,"aria-labelledby":l,"aria-describedby":u,focusable:c,tabIndex:c?0:void 0,children:[ye.jsx(Mvt,{defs:i}),ye.jsx("rect",{width:e,height:r,fill:f.background}),ye.jsx("g",{transform:"translate("+n.left+","+n.top+")",children:o})]})};G9.propTypes={width:N.exports.number.isRequired,height:N.exports.number.isRequired,margin:N.exports.shape({top:N.exports.number.isRequired,left:N.exports.number.isRequired}).isRequired,defs:N.exports.array,children:N.exports.oneOfType([N.exports.arrayOf(N.exports.node),N.exports.node]).isRequired,role:N.exports.string,isFocusable:N.exports.bool,ariaLabel:N.exports.string,ariaLabelledBy:N.exports.string,ariaDescribedBy:N.exports.string};var vie=function(t){var e=t.size,r=t.color,n=t.borderWidth,i=t.borderColor;return ye.jsx("circle",{r:e/2,fill:r,stroke:i,strokeWidth:n,style:{pointerEvents:"none"}})};vie.propTypes={size:N.exports.number.isRequired,color:N.exports.string.isRequired,borderWidth:N.exports.number.isRequired,borderColor:N.exports.string.isRequired};var Nvt=ce.exports.memo(vie),bie=function(t){var e=t.x,r=t.y,n=t.symbol,i=n===void 0?Nvt:n,o=t.size,a=t.datum,s=t.color,l=t.borderWidth,u=t.borderColor,c=t.label,f=t.labelTextAnchor,h=f===void 0?"middle":f,d=t.labelYOffset,p=d===void 0?-12:d,m=pr(),g=uo(),v=g.animate,w=g.config,b=Sa({transform:"translate("+e+", "+r+")",config:w,immediate:!v});return ye.jsxs(kr.g,{transform:b.transform,style:{pointerEvents:"none"},children:[ce.exports.createElement(i,{size:o,color:s,datum:a,borderWidth:l,borderColor:u}),c&&ye.jsx("text",{textAnchor:h,y:p,style:m.dots.text,children:c})]})};bie.propTypes={x:N.exports.number.isRequired,y:N.exports.number.isRequired,datum:N.exports.object.isRequired,size:N.exports.number.isRequired,color:N.exports.string.isRequired,borderWidth:N.exports.number.isRequired,borderColor:N.exports.string.isRequired,symbol:N.exports.oneOfType([N.exports.func,N.exports.object]),label:N.exports.oneOfType([N.exports.string,N.exports.number]),labelTextAnchor:N.exports.oneOf(["start","middle","end"]),labelYOffset:N.exports.number};var Pvt=ce.exports.memo(bie),I4=function(t){var e=t.width,r=t.height,n=t.axis,i=t.scale,o=t.value,a=t.lineStyle,s=t.textStyle,l=t.legend,u=t.legendPosition,c=t.legendOffsetX,f=t.legendOffsetY,h=t.legendOrientation,d=pr(),p=0,m=0,g=0,v=0;n==="y"?(g=i(o),m=e):(p=i(o),v=r);var w=null;if(l){var b=function(E){var A=E.axis,M=E.width,k=E.height,O=E.position,x=E.offsetX,C=E.offsetY,I=E.orientation,H=0,j=0,q=I==="vertical"?-90:0,Z="start";if(A==="x")switch(O){case"top-left":H=-x,j=C,Z="end";break;case"top":j=-C,Z=I==="horizontal"?"middle":"start";break;case"top-right":H=x,j=C,Z=I==="horizontal"?"start":"end";break;case"right":H=x,j=k/2,Z=I==="horizontal"?"start":"middle";break;case"bottom-right":H=x,j=k-C,Z="start";break;case"bottom":j=k+C,Z=I==="horizontal"?"middle":"end";break;case"bottom-left":j=k-C,H=-x,Z=I==="horizontal"?"end":"start";break;case"left":H=-x,j=k/2,Z=I==="horizontal"?"end":"middle"}else switch(O){case"top-left":H=x,j=-C,Z="start";break;case"top":H=M/2,j=-C,Z=I==="horizontal"?"middle":"start";break;case"top-right":H=M-x,j=-C,Z=I==="horizontal"?"end":"start";break;case"right":H=M+x,Z=I==="horizontal"?"start":"middle";break;case"bottom-right":H=M-x,j=C,Z="end";break;case"bottom":H=M/2,j=C,Z=I==="horizontal"?"middle":"end";break;case"bottom-left":H=x,j=C,Z=I==="horizontal"?"start":"end";break;case"left":H=-x,Z=I==="horizontal"?"end":"middle"}return{x:H,y:j,rotation:q,textAnchor:Z}}({axis:n,width:e,height:r,position:u,offsetX:c,offsetY:f,orientation:h});w=ye.jsx("text",{transform:"translate("+b.x+", "+b.y+") rotate("+b.rotation+")",textAnchor:b.textAnchor,dominantBaseline:"central",style:s,children:l})}return ye.jsxs("g",{transform:"translate("+p+", "+g+")",children:[ye.jsx("line",{x1:0,x2:m,y1:0,y2:v,stroke:d.markers.lineColor,strokeWidth:d.markers.lineStrokeWidth,style:a}),w]})};I4.propTypes={width:N.exports.number.isRequired,height:N.exports.number.isRequired,axis:N.exports.oneOf(["x","y"]).isRequired,scale:N.exports.func.isRequired,value:N.exports.oneOfType([N.exports.number,N.exports.string,N.exports.instanceOf(Date)]).isRequired,lineStyle:N.exports.object,textStyle:N.exports.object,legend:N.exports.string,legendPosition:N.exports.oneOf(["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"]),legendOffsetX:N.exports.number.isRequired,legendOffsetY:N.exports.number.isRequired,legendOrientation:N.exports.oneOf(["horizontal","vertical"]).isRequired},I4.defaultProps={legendPosition:"top-right",legendOffsetX:14,legendOffsetY:14,legendOrientation:"horizontal"};var kvt=ce.exports.memo(I4),wie=function(t){var e=t.markers,r=t.width,n=t.height,i=t.xScale,o=t.yScale;return e&&e.length!==0?e.map(function(a,s){return ye.jsx(kvt,an({},a,{width:r,height:n,scale:a.axis==="y"?o:i}),s)}):null};wie.propTypes={width:N.exports.number.isRequired,height:N.exports.number.isRequired,xScale:N.exports.func.isRequired,yScale:N.exports.func.isRequired,markers:N.exports.arrayOf(N.exports.shape({axis:N.exports.oneOf(["x","y"]).isRequired,value:N.exports.oneOfType([N.exports.number,N.exports.string,N.exports.instanceOf(Date)]).isRequired,lineStyle:N.exports.object,textStyle:N.exports.object}))};var Sie=ce.exports.memo(wie),$vt=["theme","renderWrapper","animate","motionStiffness","motionDamping","motionConfig"],Rie=function(t){return function(e){var r,n;function i(){return e.apply(this,arguments)||this}return n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,T4(r,n),i.prototype.render=function(){var o=this.props,a=o.theme,s=o.renderWrapper,l=o.animate,u=o.motionStiffness,c=o.motionDamping,f=o.motionConfig,h=V9(o,$vt);return ye.jsx(uR,{theme:a,renderWrapper:s,isInteractive:h.isInteractive,animate:l,motionStiffness:u,motionDamping:c,motionConfig:f,children:ye.jsx(t,an({},h))})},i}(ce.exports.Component)},Lvt=function(t,e){var r,n=Eg(t)?t:function(i){return Xi(i,t)};return e&&(r=Eg(e)?e:aR(e)),r?function(i){return r(n(i))}:n},Eie=function(t){return Eg(t)?t:function(e){return Xi(e,t)}},v_=function(t){return ce.exports.useMemo(function(){return Eie(t)},[t])},Cie=function(t,e,r,n,i,o){return t<=i&&i<=t+r&&e<=o&&o<=e+n},Sg=function(t,e){var r=e.clientX,n=e.clientY,i=t.getBoundingClientRect(),o=t.getBBox(),a=o.width===i.width?1:o.width/i.width;return[(r-i.left)*a,(n-i.top)*a]},Dvt=Object.keys(mie),Fvt=Object.keys(gie),Hvt=function(t,e,r){if(t==="*")return!0;if(Eg(t))return t(e);if(Q1(t)){var n=r?Xi(e,r):e;return bae(Qyt(n,Object.keys(t)),t)}return!1},_ie=function(t,e,r,n){var i=n===void 0?{}:n,o=i.dataKey,a=i.colorKey,s=a===void 0?"color":a,l=i.targetKey,u=l===void 0?"fill":l,c=[],f={};return t.length&&e.length&&(c=[].concat(t),e.forEach(function(h){for(var d=function(m){var g=r[m],v=g.id,w=g.match;if(Hvt(w,h,o)){var b=t.find(function(I){return I.id===v});if(b){if(Fvt.includes(b.type))if(b.background==="inherit"||b.color==="inherit"){var E=Xi(h,s),A=b.background,M=b.color,k=v;b.background==="inherit"&&(k=k+".bg."+E,A=E),b.color==="inherit"&&(k=k+".fg."+E,M=E),ku(h,u,"url(#"+k+")"),f[k]||(c.push(an({},b,{id:k,background:A,color:M})),f[k]=1)}else ku(h,u,"url(#"+v+")");else if(Dvt.includes(b.type))if(b.colors.map(function(I){return I.color}).includes("inherit")){var O=Xi(h,s),x=v,C=an({},b,{colors:b.colors.map(function(I,H){return I.color!=="inherit"?I:(x=x+"."+H+"."+O,an({},I,{color:I.color==="inherit"?O:I.color}))})});C.id=x,ku(h,u,"url(#"+x+")"),f[x]||(c.push(C),f[x]=1)}else ku(h,u,"url(#"+v+")")}return"break"}},p=0;p<r.length&&d(p)!=="break";p++);})),c},Bvt=wae;function Uvt(t){return t&&t.length?Bvt(t):[]}var zW=Uvt,Vvt=Nz,jvt=r1,Wvt="[object Date]";function zvt(t){return jvt(t)&&Vvt(t)==Wvt}var Gvt=zvt,Yvt=Gvt,Kvt=qS,GW=U4.exports,YW=GW&&GW.isDate,qvt=YW?Kvt(YW):Yvt,Xvt=qvt,b_=new Date,w_=new Date;function bn(t,e,r,n){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=function(o){return t(o=new Date(+o)),o},i.ceil=function(o){return t(o=new Date(o-1)),e(o,1),t(o),o},i.round=function(o){var a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=function(o,a){return e(o=new Date(+o),a==null?1:Math.floor(a)),o},i.range=function(o,a,s){var l=[],u;if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return l;do l.push(u=new Date(+o)),e(o,s),t(o);while(u<o&&o<a);return l},i.filter=function(o){return bn(function(a){if(a>=a)for(;t(a),!o(a);)a.setTime(a-1)},function(a,s){if(a>=a)if(s<0)for(;++s<=0;)for(;e(a,-1),!o(a););else for(;--s>=0;)for(;e(a,1),!o(a););})},r&&(i.count=function(o,a){return b_.setTime(+o),w_.setTime(+a),t(b_),t(w_),Math.floor(r(b_,w_))},i.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(n?function(a){return n(a)%o===0}:function(a){return i.count(0,a)%o===0}):i}),i}var US=bn(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});US.every=function(t){return t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?bn(function(e){e.setTime(Math.floor(e/t)*t)},function(e,r){e.setTime(+e+r*t)},function(e,r){return(r-e)/t}):US};const KW=US;US.range;var VS=1e3,Ap=6e4,jS=36e5,Tie=6048e5,Oie=bn(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+e*VS)},function(t,e){return(e-t)/VS},function(t){return t.getUTCSeconds()});const qW=Oie;Oie.range;var Aie=bn(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*VS)},function(t,e){t.setTime(+t+e*Ap)},function(t,e){return(e-t)/Ap},function(t){return t.getMinutes()});const Qvt=Aie;Aie.range;var Iie=bn(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*VS-t.getMinutes()*Ap)},function(t,e){t.setTime(+t+e*jS)},function(t,e){return(e-t)/jS},function(t){return t.getHours()});const Zvt=Iie;Iie.range;function Pc(t){return bn(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,r){e.setDate(e.getDate()+r*7)},function(e,r){return(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Ap)/Tie})}var x4=Pc(0),xie=Pc(1),Mie=Pc(2),Nie=Pc(3),Pie=Pc(4),kie=Pc(5),$ie=Pc(6);x4.range;xie.range;Mie.range;Nie.range;Pie.range;kie.range;$ie.range;var Lie=bn(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12},function(t){return t.getMonth()});const Jvt=Lie;Lie.range;var Y9=bn(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});Y9.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:bn(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,r){e.setFullYear(e.getFullYear()+r*t)})};const e1t=Y9;Y9.range;var Die=bn(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*Ap)},function(t,e){return(e-t)/Ap},function(t){return t.getUTCMinutes()});const t1t=Die;Die.range;var Fie=bn(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*jS)},function(t,e){return(e-t)/jS},function(t){return t.getUTCHours()});const r1t=Fie;Fie.range;function kc(t){return bn(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCDate(e.getUTCDate()+r*7)},function(e,r){return(r-e)/Tie})}var M4=kc(0),Hie=kc(1),Bie=kc(2),Uie=kc(3),Vie=kc(4),jie=kc(5),Wie=kc(6);M4.range;Hie.range;Bie.range;Uie.range;Vie.range;jie.range;Wie.range;var zie=bn(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12},function(t){return t.getUTCMonth()});const n1t=zie;zie.range;var K9=bn(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});K9.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:bn(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCFullYear(e.getUTCFullYear()+r*t)})};const i1t=K9;K9.range;function ou(){return ou=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ou.apply(this,arguments)}var bf=[function(t){return t.setMilliseconds(0)},function(t){return t.setSeconds(0)},function(t){return t.setMinutes(0)},function(t){return t.setHours(0)},function(t){return t.setDate(1)},function(t){return t.setMonth(0)}],o1t={millisecond:[],second:bf.slice(0,1),minute:bf.slice(0,2),hour:bf.slice(0,3),day:bf.slice(0,4),month:bf.slice(0,5),year:bf.slice(0,6)},a1t=function(t){return function(e){return o1t[t].forEach(function(r){r(e)}),e}},Gie=function(t){var e=t.format,r=e===void 0?"native":e,n=t.precision,i=n===void 0?"millisecond":n,o=t.useUTC,a=o===void 0||o,s=a1t(i);return function(l){if(l===void 0)return l;if(r==="native"||l instanceof Date)return s(l);var u=a?Pne(r):Mne(r);return s(u(l))}},s1t=function(t,e,r,n){var i,o,a,s,l=t.min,u=l===void 0?0:l,c=t.max,f=c===void 0?"auto":c,h=t.stacked,d=h!==void 0&&h,p=t.reverse,m=p!==void 0&&p,g=t.clamp,v=g!==void 0&&g,w=t.nice,b=w!==void 0&&w;u==="auto"?i=d===!0?(o=e.minStacked)!=null?o:0:e.min:i=u,f==="auto"?a=d===!0?(s=e.maxStacked)!=null?s:0:e.max:a=f;var E=sne().rangeRound(n==="x"?[0,r]:[r,0]).domain(m?[a,i]:[i,a]).clamp(v);return b===!0?E.nice():typeof b=="number"&&E.nice(b),l1t(E,d)},l1t=function(t,e){e===void 0&&(e=!1);var r=t;return r.type="linear",r.stacked=e,r},u1t=function(t,e,r){var n=apt().range([0,r]).domain(e.all);return n.type="point",n},c1t=function(t,e,r,n){var i=t.round,o=i===void 0||i,a=T9().range(n==="x"?[0,r]:[r,0]).domain(e.all).round(o);return f1t(a)},f1t=function(t){var e=t;return e.type="band",e},h1t=function(t,e,r){var n,i,o=t.format,a=o===void 0?"native":o,s=t.precision,l=s===void 0?"millisecond":s,u=t.min,c=u===void 0?"auto":u,f=t.max,h=f===void 0?"auto":f,d=t.useUTC,p=d===void 0||d,m=t.nice,g=m!==void 0&&m,v=Gie({format:a,precision:l,useUTC:p});n=c==="auto"?v(e.min):a!=="native"?v(c):c,i=h==="auto"?v(e.max):a!=="native"?v(h):h;var w=p?Kmt():Ymt();w.range([0,r]),n&&i&&w.domain([n,i]),g===!0?w.nice():typeof g!="object"&&typeof g!="number"||w.nice(g);var b=w;return b.type="time",b.useUTC=p,b},d1t=function(t,e,r,n){var i,o=t.base,a=o===void 0?10:o,s=t.min,l=s===void 0?"auto":s,u=t.max,c=u===void 0?"auto":u;if(e.all.some(function(m){return m===0}))throw new Error("a log scale domain must not include or cross zero");var f,h,d=!1;if(e.all.filter(function(m){return m!=null}).forEach(function(m){d||(i===void 0?i=Math.sign(m):Math.sign(m)!==i&&(d=!0))}),d)throw new Error("a log scale domain must be strictly-positive or strictly-negative");f=l==="auto"?e.min:l,h=c==="auto"?e.max:c;var p=une().domain([f,h]).rangeRound(n==="x"?[0,r]:[r,0]).base(a).nice();return p.type="log",p},p1t=function(t,e,r,n){var i,o,a=t.constant,s=a===void 0?1:a,l=t.min,u=l===void 0?"auto":l,c=t.max,f=c===void 0?"auto":c,h=t.reverse,d=h!==void 0&&h;i=u==="auto"?e.min:u,o=f==="auto"?e.max:f;var p=cne().constant(s).rangeRound(n==="x"?[0,r]:[r,0]).nice();d===!0?p.domain([o,i]):p.domain([i,o]);var m=p;return m.type="symlog",m},m1t=function(t){return t==="x"?"y":"x"},g1t=function(t,e){return t===e},y1t=function(t,e){return t.getTime()===e.getTime()};function Jv(t,e,r,n){switch(t.type){case"linear":return s1t(t,e,r,n);case"point":return u1t(0,e,r);case"band":return c1t(t,e,r,n);case"time":return h1t(t,e,r);case"log":return d1t(t,e,r,n);case"symlog":return p1t(t,e,r,n);default:throw new Error("invalid scale spec")}}var XW=function(t,e,r){var n;if("stacked"in r&&r.stacked){var i=t.data[e==="x"?"xStacked":"yStacked"];return i==null?null:r(i)}return(n=r(t.data[e]))!=null?n:null},v1t=function(t,e,r,n,i){var o=t.map(function(c){return function(f){return ou({},f,{data:f.data.map(function(h){return{data:ou({},h)}})})}(c)}),a=b1t(o,e,r);"stacked"in e&&e.stacked===!0&&w1t(a,o),"stacked"in r&&r.stacked===!0&&S1t(a,o);var s=Jv(e,a.x,n,"x"),l=Jv(r,a.y,i,"y"),u=o.map(function(c){return ou({},c,{data:c.data.map(function(f){return ou({},f,{position:{x:XW(f,"x",s),y:XW(f,"y",l)}})})})});return ou({},a,{series:u,xScale:s,yScale:l})},b1t=function(t,e,r){return{x:QW(t,"x",e),y:QW(t,"y",r)}},QW=function(t,e,r,n){var i=n===void 0?{}:n,o=i.getValue,a=o===void 0?function(p){return p.data[e]}:o,s=i.setValue,l=s===void 0?function(p,m){p.data[e]=m}:s;if(r.type==="linear")t.forEach(function(p){p.data.forEach(function(m){var g=a(m);g&&l(m,parseFloat(String(g)))})});else if(r.type==="time"&&r.format!=="native"){var u=Gie(r);t.forEach(function(p){p.data.forEach(function(m){var g=a(m);g&&l(m,u(g))})})}var c=[];switch(t.forEach(function(p){p.data.forEach(function(m){c.push(a(m))})}),r.type){case"linear":var f=Sae(zW(c).filter(function(p){return p!==null}),function(p){return p});return{all:f,min:Math.min.apply(Math,f),max:Math.max.apply(Math,f)};case"time":var h=A_(c,function(p){return p.getTime()}).slice(0).sort(function(p,m){return m.getTime()-p.getTime()}).reverse();return{all:h,min:h[0],max:Qe(h)};default:var d=zW(c);return{all:d,min:d[0],max:Qe(d)}}},Yie=function(t,e,r){var n=m1t(t),i=[];e[n].all.forEach(function(o){var a=Xvt(o)?y1t:g1t,s=[];r.forEach(function(l){var u=l.data.find(function(d){return a(d.data[n],o)}),c=null,f=null;if(u!==void 0){if((c=u.data[t])!==null){var h=Qe(s);h===void 0?f=c:h!==null&&(f=h+c)}u.data[t==="x"?"xStacked":"yStacked"]=f}s.push(f),f!==null&&i.push(f)})}),e[t].minStacked=Math.min.apply(Math,i),e[t].maxStacked=Math.max.apply(Math,i)},w1t=function(t,e){return Yie("x",t,e)},S1t=function(t,e){return Yie("y",t,e)},Kie=function(t){var e=t.bandwidth();if(e===0)return t;var r=e/2;return t.round()&&(r=Math.round(r)),function(n){var i;return((i=t(n))!=null?i:0)+r}},qie={millisecond:[KW,KW],second:[qW,qW],minute:[Qvt,t1t],hour:[Zvt,r1t],day:[bn(function(t){return t.setHours(0,0,0,0)},function(t,e){return t.setDate(t.getDate()+e)},function(t,e){return(e.getTime()-t.getTime())/864e5},function(t){return Math.floor(t.getTime()/864e5)}),bn(function(t){return t.setUTCHours(0,0,0,0)},function(t,e){return t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e.getTime()-t.getTime())/864e5},function(t){return Math.floor(t.getTime()/864e5)})],week:[x4,M4],sunday:[x4,M4],monday:[xie,Hie],tuesday:[Mie,Bie],wednesday:[Nie,Uie],thursday:[Pie,Vie],friday:[kie,jie],saturday:[$ie,Wie],month:[Jvt,n1t],year:[e1t,i1t]},R1t=Object.keys(qie),E1t=new RegExp("^every\\s*(\\d+)?\\s*("+R1t.join("|")+")s?$","i"),Xie=function(t,e){if(Array.isArray(e))return e;if(typeof e=="string"&&"useUTC"in t){var r=e.match(E1t);if(r){var n=r[1],i=r[2],o=qie[i][t.useUTC?1:0];if(i==="day"){var a,s,l=t.domain(),u=l[0],c=l[1],f=new Date(c);return f.setDate(f.getDate()+1),(a=(s=o.every(Number(n!=null?n:1)))==null?void 0:s.range(u,f))!=null?a:[]}if(n===void 0)return t.ticks(o);var h=o.every(Number(n));if(h)return t.ticks(h)}throw new Error("Invalid tickValues: "+e)}if("ticks"in t){if(e===void 0)return t.ticks();if(typeof(d=e)=="number"&&isFinite(d)&&Math.floor(d)===d)return t.ticks(e)}var d;return t.domain()};function Mo(){return Mo=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Mo.apply(this,arguments)}var Qie=function(t){var e,r=t.axis,n=t.scale,i=t.ticksPosition,o=t.tickValues,a=t.tickSize,s=t.tickPadding,l=t.tickRotation,u=t.engine,c=u===void 0?"svg":u,f=Xie(n,o),h=Ivt[c],d="bandwidth"in n?Kie(n):n,p={lineX:0,lineY:0},m={textX:0,textY:0},g=typeof document=="object"&&document.dir==="rtl",v=h.align.center,w=h.baseline.center;return r==="x"?(e=function(b){var E;return{x:(E=d(b))!=null?E:0,y:0}},p.lineY=a*(i==="after"?1:-1),m.textY=(a+s)*(i==="after"?1:-1),w=i==="after"?h.baseline.top:h.baseline.bottom,l===0?v=h.align.center:i==="after"&&l<0||i==="before"&&l>0?(v=h.align[g?"left":"right"],w=h.baseline.center):(i==="after"&&l>0||i==="before"&&l<0)&&(v=h.align[g?"right":"left"],w=h.baseline.center)):(e=function(b){var E;return{x:0,y:(E=d(b))!=null?E:0}},p.lineX=a*(i==="after"?1:-1),m.textX=(a+s)*(i==="after"?1:-1),v=i==="after"?h.align.left:h.align.right),{ticks:f.map(function(b){return Mo({key:b instanceof Date?""+b.valueOf():""+b,value:b},e(b),p,m)}),textAlign:v,textBaseline:w}},Zie=function(t,e){if(t===void 0||typeof t=="function")return t;if(e.type==="time"){var r=I5(t);return function(n){return r(n instanceof Date?n:new Date(n))}}return aR(t)},N4=function(t){var e,r=t.width,n=t.height,i=t.scale,o=t.axis,a=t.values,s=(e=a,(Array.isArray(e)?a:void 0)||Xie(i,a)),l="bandwidth"in i?Kie(i):i,u=o==="x"?s.map(function(c){var f,h;return{key:c instanceof Date?""+c.valueOf():""+c,x1:(f=l(c))!=null?f:0,x2:(h=l(c))!=null?h:0,y1:0,y2:n}}):s.map(function(c){var f,h;return{key:c instanceof Date?""+c.valueOf():""+c,x1:0,x2:r,y1:(f=l(c))!=null?f:0,y2:(h=l(c))!=null?h:0}});return u},C1t=ce.exports.memo(function(t){var e,r=t.value,n=t.format,i=t.lineX,o=t.lineY,a=t.onClick,s=t.textBaseline,l=t.textAnchor,u=t.animatedProps,c=pr(),f=(e=n==null?void 0:n(r))!=null?e:r,h=ce.exports.useMemo(function(){var d={opacity:u.opacity};return a?{style:Mo({},d,{cursor:"pointer"}),onClick:function(p){return a(p,f)}}:{style:d}},[u.opacity,a,f]);return ye.jsxs(kr.g,Mo({transform:u.transform},h,{children:[ye.jsx("line",{x1:0,x2:i,y1:0,y2:o,style:c.axis.ticks.line}),ye.jsx(kr.text,{dominantBaseline:s,textAnchor:l,transform:u.textTransform,style:c.axis.ticks.text,children:f})]}))}),_1t=ce.exports.memo(function(t){var e=t.axis,r=t.scale,n=t.x,i=n===void 0?0:n,o=t.y,a=o===void 0?0:o,s=t.length,l=t.ticksPosition,u=t.tickValues,c=t.tickSize,f=c===void 0?5:c,h=t.tickPadding,d=h===void 0?5:h,p=t.tickRotation,m=p===void 0?0:p,g=t.format,v=t.renderTick,w=v===void 0?C1t:v,b=t.legend,E=t.legendPosition,A=E===void 0?"end":E,M=t.legendOffset,k=M===void 0?0:M,O=t.onClick,x=t.ariaHidden,C=pr(),I=ce.exports.useMemo(function(){return Zie(g,r)},[g,r]),H=Qie({axis:e,scale:r,ticksPosition:l,tickValues:u,tickSize:f,tickPadding:d,tickRotation:m}),j=H.ticks,q=H.textAlign,Z=H.textBaseline,ne=null;if(b!==void 0){var ie,P=0,y=0,R=0;e==="y"?(R=-90,P=k,A==="start"?(ie="start",y=s):A==="middle"?(ie="middle",y=s/2):A==="end"&&(ie="end")):(y=k,A==="start"?ie="start":A==="middle"?(ie="middle",P=s/2):A==="end"&&(ie="end",P=s)),ne=ye.jsx("text",{transform:"translate("+P+", "+y+") rotate("+R+")",textAnchor:ie,style:Mo({dominantBaseline:"central"},C.axis.legend.text),children:b})}var _=uo(),$=_.animate,B=_.config,W=Sa({transform:"translate("+i+","+a+")",lineX2:e==="x"?s:0,lineY2:e==="x"?0:s,config:B,immediate:!$}),ee=m9(j,{keys:function(J){return J.key},initial:function(J){return{opacity:1,transform:"translate("+J.x+","+J.y+")",textTransform:"translate("+J.textX+","+J.textY+") rotate("+m+")"}},from:function(J){return{opacity:0,transform:"translate("+J.x+","+J.y+")",textTransform:"translate("+J.textX+","+J.textY+") rotate("+m+")"}},enter:function(J){return{opacity:1,transform:"translate("+J.x+","+J.y+")",textTransform:"translate("+J.textX+","+J.textY+") rotate("+m+")"}},update:function(J){return{opacity:1,transform:"translate("+J.x+","+J.y+")",textTransform:"translate("+J.textX+","+J.textY+") rotate("+m+")"}},leave:{opacity:0},config:B,immediate:!$});return ye.jsxs(kr.g,{transform:W.transform,"aria-hidden":x,children:[ee(function(J,he,re,T){return ce.exports.createElement(w,Mo({tickIndex:T,format:I,rotate:m,textBaseline:Z,textAnchor:q,animatedProps:J},he,O?{onClick:O}:{}))}),ye.jsx(kr.line,{style:C.axis.domain.line,x1:0,x2:W.lineX2,y1:0,y2:W.lineY2}),ne]})}),T1t={ticksPosition:N.exports.oneOf(["before","after"]),tickValues:N.exports.oneOfType([N.exports.number,N.exports.arrayOf(N.exports.oneOfType([N.exports.number,N.exports.string,N.exports.instanceOf(Date)])),N.exports.string]),tickSize:N.exports.number,tickPadding:N.exports.number,tickRotation:N.exports.number,format:N.exports.oneOfType([N.exports.func,N.exports.string]),renderTick:N.exports.func,legend:N.exports.node,legendPosition:N.exports.oneOf(["start","middle","end"]),legendOffset:N.exports.number,ariaHidden:N.exports.bool},Ob=N.exports.shape(T1t),Jie=["top","right","bottom","left"],eoe=ce.exports.memo(function(t){var e=t.xScale,r=t.yScale,n=t.width,i=t.height,o={top:t.top,right:t.right,bottom:t.bottom,left:t.left};return ye.jsx(ye.Fragment,{children:Jie.map(function(a){var s=o[a];if(!s)return null;var l=a==="top"||a==="bottom";return ye.jsx(_1t,Mo({},s,{axis:l?"x":"y",x:a==="right"?n:0,y:a==="bottom"?i:0,scale:l?e:r,length:l?n:i,ticksPosition:a==="top"||a==="left"?"before":"after"}),a)})})}),O1t=ce.exports.memo(function(t){var e=t.animatedProps,r=pr();return ye.jsx(kr.line,Mo({},e,r.grid.line))}),ZW=ce.exports.memo(function(t){var e=t.lines,r=uo(),n=r.animate,i=r.config,o=m9(e,{keys:function(a){return a.key},initial:function(a){return{opacity:1,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2}},from:function(a){return{opacity:0,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2}},enter:function(a){return{opacity:1,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2}},update:function(a){return{opacity:1,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2}},leave:{opacity:0},config:i,immediate:!n});return ye.jsx("g",{children:o(function(a,s){return ce.exports.createElement(O1t,Mo({},s,{key:s.key,animatedProps:a}))})})}),toe=ce.exports.memo(function(t){var e=t.width,r=t.height,n=t.xScale,i=t.yScale,o=t.xValues,a=t.yValues,s=ce.exports.useMemo(function(){return!!n&&N4({width:e,height:r,scale:n,axis:"x",values:o})},[n,o,e,r]),l=ce.exports.useMemo(function(){return!!i&&N4({width:e,height:r,scale:i,axis:"y",values:a})},[r,e,i,a]);return ye.jsxs(ye.Fragment,{children:[s&&ye.jsx(ZW,{lines:s}),l&&ye.jsx(ZW,{lines:l})]})}),A1t=function(t,e){var r,n=e.axis,i=e.scale,o=e.x,a=o===void 0?0:o,s=e.y,l=s===void 0?0:s,u=e.length,c=e.ticksPosition,f=e.tickValues,h=e.tickSize,d=h===void 0?5:h,p=e.tickPadding,m=p===void 0?5:p,g=e.tickRotation,v=g===void 0?0:g,w=e.format,b=e.legend,E=e.legendPosition,A=E===void 0?"end":E,M=e.legendOffset,k=M===void 0?0:M,O=e.theme,x=Qie({axis:n,scale:i,ticksPosition:c,tickValues:f,tickSize:d,tickPadding:m,tickRotation:v,engine:"canvas"}),C=x.ticks,I=x.textAlign,H=x.textBaseline;t.save(),t.translate(a,l),t.textAlign=I,t.textBaseline=H,t.font=(O.axis.ticks.text.fontWeight?O.axis.ticks.text.fontWeight+" ":"")+O.axis.ticks.text.fontSize+"px "+O.axis.ticks.text.fontFamily,((r=O.axis.domain.line.strokeWidth)!=null?r:0)>0&&(t.lineWidth=Number(O.axis.domain.line.strokeWidth),t.lineCap="square",O.axis.domain.line.stroke&&(t.strokeStyle=O.axis.domain.line.stroke),t.beginPath(),t.moveTo(0,0),t.lineTo(n==="x"?u:0,n==="x"?0:u),t.stroke());var j=typeof w=="function"?w:function(P){return""+P};if(C.forEach(function(P){var y;((y=O.axis.ticks.line.strokeWidth)!=null?y:0)>0&&(t.lineWidth=Number(O.axis.ticks.line.strokeWidth),t.lineCap="square",O.axis.ticks.line.stroke&&(t.strokeStyle=O.axis.ticks.line.stroke),t.beginPath(),t.moveTo(P.x,P.y),t.lineTo(P.x+P.lineX,P.y+P.lineY),t.stroke());var R=j(P.value);t.save(),t.translate(P.x+P.textX,P.y+P.textY),t.rotate(Zv(v)),O.axis.ticks.text.fill&&(t.fillStyle=O.axis.ticks.text.fill),t.fillText(String(R),0,0),t.restore()}),b!==void 0){var q=0,Z=0,ne=0,ie="center";n==="y"?(ne=-90,q=k,A==="start"?(ie="start",Z=u):A==="middle"?(ie="center",Z=u/2):A==="end"&&(ie="end")):(Z=k,A==="start"?ie="start":A==="middle"?(ie="center",q=u/2):A==="end"&&(ie="end",q=u)),t.translate(q,Z),t.rotate(Zv(ne)),t.font=(O.axis.legend.text.fontWeight?O.axis.legend.text.fontWeight+" ":"")+O.axis.legend.text.fontSize+"px "+O.axis.legend.text.fontFamily,O.axis.legend.text.fill&&(t.fillStyle=O.axis.legend.text.fill),t.textAlign=ie,t.textBaseline="middle",t.fillText(b,0,0)}t.restore()},roe=function(t,e){var r=e.xScale,n=e.yScale,i=e.width,o=e.height,a=e.top,s=e.right,l=e.bottom,u=e.left,c=e.theme,f={top:a,right:s,bottom:l,left:u};Jie.forEach(function(h){var d=f[h];if(!d)return null;var p=h==="top"||h==="bottom",m=h==="top"||h==="left"?"before":"after",g=p?r:n,v=Zie(d.format,g);A1t(t,Mo({},d,{axis:p?"x":"y",x:h==="right"?i:0,y:h==="bottom"?o:0,scale:g,format:v,length:p?i:o,ticksPosition:m,theme:c}))})},WS=function(t,e){var r=e.width,n=e.height,i=e.scale,o=e.axis,a=e.values;N4({width:r,height:n,scale:i,axis:o,values:a}).forEach(function(s){t.beginPath(),t.moveTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.stroke()})};function I1t(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var x1t=I1t,M1t=qp,N1t=Hz;function P1t(t,e){return t&&M1t(e,N1t(e),t)}var k1t=P1t,$1t=qp,L1t=Z1;function D1t(t,e){return t&&$1t(e,L1t(e),t)}var F1t=D1t,H1t=qp,B1t=Bz;function U1t(t,e){return H1t(t,B1t(t),e)}var V1t=U1t,j1t=Rae,W1t=v9,z1t=Bz,G1t=Eae,Y1t=Object.getOwnPropertySymbols,K1t=Y1t?function(t){for(var e=[];t;)j1t(e,z1t(t)),t=W1t(t);return e}:G1t,noe=K1t,q1t=qp,X1t=noe;function Q1t(t,e){return q1t(t,X1t(t),e)}var Z1t=Q1t,J1t=Cae,e0t=noe,t0t=Z1;function r0t(t){return J1t(t,t0t,e0t)}var ioe=r0t,n0t=Object.prototype,i0t=n0t.hasOwnProperty;function o0t(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&i0t.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var a0t=o0t,s0t=y9;function l0t(t,e){var r=e?s0t(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var u0t=l0t,c0t=/\w*$/;function f0t(t){var e=new t.constructor(t.source,c0t.exec(t));return e.lastIndex=t.lastIndex,e}var h0t=f0t,JW=_ae,ez=JW?JW.prototype:void 0,tz=ez?ez.valueOf:void 0;function d0t(t){return tz?Object(tz.call(t)):{}}var p0t=d0t,m0t=y9,g0t=u0t,y0t=h0t,v0t=p0t,b0t=Bre,w0t="[object Boolean]",S0t="[object Date]",R0t="[object Map]",E0t="[object Number]",C0t="[object RegExp]",_0t="[object Set]",T0t="[object String]",O0t="[object Symbol]",A0t="[object ArrayBuffer]",I0t="[object DataView]",x0t="[object Float32Array]",M0t="[object Float64Array]",N0t="[object Int8Array]",P0t="[object Int16Array]",k0t="[object Int32Array]",$0t="[object Uint8Array]",L0t="[object Uint8ClampedArray]",D0t="[object Uint16Array]",F0t="[object Uint32Array]";function H0t(t,e,r){var n=t.constructor;switch(e){case A0t:return m0t(t);case w0t:case S0t:return new n(+t);case I0t:return g0t(t,r);case x0t:case M0t:case N0t:case P0t:case k0t:case $0t:case L0t:case D0t:case F0t:return b0t(t,r);case R0t:return new n;case E0t:case T0t:return new n(t);case C0t:return y0t(t);case _0t:return new n;case O0t:return v0t(t)}}var B0t=H0t,U0t=V4,V0t=r1,j0t="[object Map]";function W0t(t){return V0t(t)&&U0t(t)==j0t}var z0t=W0t,G0t=z0t,Y0t=qS,rz=U4.exports,nz=rz&&rz.isMap,K0t=nz?Y0t(nz):G0t,q0t=K0t,X0t=V4,Q0t=r1,Z0t="[object Set]";function J0t(t){return Q0t(t)&&X0t(t)==Z0t}var ebt=J0t,tbt=ebt,rbt=qS,iz=U4.exports,oz=iz&&iz.isSet,nbt=oz?rbt(oz):tbt,ibt=nbt,obt=kz,abt=x1t,sbt=b9,lbt=k1t,ubt=F1t,cbt=IS.exports,fbt=Ure,hbt=V1t,dbt=Z1t,pbt=Tae,mbt=ioe,gbt=V4,ybt=a0t,vbt=B0t,bbt=Vre,wbt=B4,Sbt=Pz.exports,Rbt=q0t,Ebt=xp,Cbt=ibt,_bt=Hz,Tbt=Z1,Obt=1,Abt=2,Ibt=4,ooe="[object Arguments]",xbt="[object Array]",Mbt="[object Boolean]",Nbt="[object Date]",Pbt="[object Error]",aoe="[object Function]",kbt="[object GeneratorFunction]",$bt="[object Map]",Lbt="[object Number]",soe="[object Object]",Dbt="[object RegExp]",Fbt="[object Set]",Hbt="[object String]",Bbt="[object Symbol]",Ubt="[object WeakMap]",Vbt="[object ArrayBuffer]",jbt="[object DataView]",Wbt="[object Float32Array]",zbt="[object Float64Array]",Gbt="[object Int8Array]",Ybt="[object Int16Array]",Kbt="[object Int32Array]",qbt="[object Uint8Array]",Xbt="[object Uint8ClampedArray]",Qbt="[object Uint16Array]",Zbt="[object Uint32Array]",ar={};ar[ooe]=ar[xbt]=ar[Vbt]=ar[jbt]=ar[Mbt]=ar[Nbt]=ar[Wbt]=ar[zbt]=ar[Gbt]=ar[Ybt]=ar[Kbt]=ar[$bt]=ar[Lbt]=ar[soe]=ar[Dbt]=ar[Fbt]=ar[Hbt]=ar[Bbt]=ar[qbt]=ar[Xbt]=ar[Qbt]=ar[Zbt]=!0;ar[Pbt]=ar[aoe]=ar[Ubt]=!1;function F2(t,e,r,n,i,o){var a,s=e&Obt,l=e&Abt,u=e&Ibt;if(r&&(a=i?r(t,n,i,o):r(t)),a!==void 0)return a;if(!Ebt(t))return t;var c=wbt(t);if(c){if(a=ybt(t),!s)return fbt(t,a)}else{var f=gbt(t),h=f==aoe||f==kbt;if(Sbt(t))return cbt(t,s);if(f==soe||f==ooe||h&&!i){if(a=l||h?{}:bbt(t),!s)return l?dbt(t,ubt(a,t)):hbt(t,lbt(a,t))}else{if(!ar[f])return i?t:{};a=vbt(t,f,s)}}o||(o=new obt);var d=o.get(t);if(d)return d;o.set(t,a),Cbt(t)?t.forEach(function(g){a.add(F2(g,e,r,g,t,o))}):Rbt(t)&&t.forEach(function(g,v){a.set(v,F2(g,e,r,v,t,o))});var p=u?l?mbt:pbt:l?Tbt:_bt,m=c?void 0:p(t);return abt(m||t,function(g,v){m&&(v=g,g=t[v]),sbt(a,v,F2(g,e,r,v,t,o))}),a}var Jbt=F2,e2t=Fz,t2t=Oae;function r2t(t,e){return e.length<2?t:e2t(t,t2t(e,0,-1))}var n2t=r2t,i2t=KS,o2t=Qe,a2t=n2t,s2t=Lz;function l2t(t,e){return e=i2t(e,t),t=a2t(t,e),t==null||delete t[s2t(o2t(e))]}var u2t=l2t,c2t=Q1;function f2t(t){return c2t(t)?void 0:t}var h2t=f2t,d2t=Dz,p2t=Jbt,m2t=u2t,g2t=KS,y2t=qp,v2t=h2t,b2t=sie,w2t=ioe,S2t=1,R2t=2,E2t=4,C2t=b2t(function(t,e){var r={};if(t==null)return r;var n=!1;e=d2t(e,function(o){return o=g2t(o,t),n||(n=o.length>1),o}),y2t(t,w2t(t),r),n&&(r=p2t(r,S2t|R2t|E2t,v2t));for(var i=e.length;i--;)m2t(r,e[i]);return r}),loe=C2t,_2t=Aae;function T2t(t,e){var r=[];return _2t(t,function(n,i,o){e(n,i,o)&&r.push(n)}),r}var O2t=T2t,A2t=xae,I2t=O2t,x2t=Iae,M2t=B4;function N2t(t,e){var r=M2t(t)?A2t:I2t;return r(t,x2t(e))}var P2t=N2t;function ma(){return ma=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ma.apply(this,arguments)}var P4={dotSize:4,noteWidth:120,noteTextOffset:8,animate:!0,motionStiffness:90,motionDamping:13},k2t=function(t){var e=typeof t;return ce.exports.isValidElement(t)||e==="string"||e==="function"||e==="object"},$2t=function(t){var e=typeof t;return e==="string"||e==="function"},e1=function(t){return t.type==="circle"},k4=function(t){return t.type==="dot"},t1=function(t){return t.type==="rect"},L2t=function(t){var e=t.data,r=t.annotations,n=t.getPosition,i=t.getDimensions;return r.reduce(function(o,a){var s=a.offset||0;return[].concat(o,P2t(e,a.match).map(function(l){var u=n(l),c=i(l);return(e1(a)||t1(a))&&(c.size=c.size+2*s,c.width=c.width+2*s,c.height=c.height+2*s),ma({},loe(a,["match","offset"]),u,c,{size:a.size||c.size,datum:l})}))},[])},D2t=function(t,e,r,n){var i=Math.atan2(n-e,r-t);return Avt(Tvt(i))},uoe=function(t){var e,r,n=t.x,i=t.y,o=t.noteX,a=t.noteY,s=t.noteWidth,l=s===void 0?P4.noteWidth:s,u=t.noteTextOffset,c=u===void 0?P4.noteTextOffset:u;if(tM(o))e=n+o;else{if(o.abs===void 0)throw new Error("noteX should be either a number or an object containing an 'abs' property");e=o.abs}if(tM(a))r=i+a;else{if(a.abs===void 0)throw new Error("noteY should be either a number or an object containing an 'abs' property");r=a.abs}var f=n,h=i,d=D2t(n,i,e,r);if(e1(t)){var p=Ovt(Zv(d),t.size/2);f+=p.x,h+=p.y}if(t1(t)){var m=Math.round((d+90)/45)%8;m===0&&(h-=t.height/2),m===1&&(f+=t.width/2,h-=t.height/2),m===2&&(f+=t.width/2),m===3&&(f+=t.width/2,h+=t.height/2),m===4&&(h+=t.height/2),m===5&&(f-=t.width/2,h+=t.height/2),m===6&&(f-=t.width/2),m===7&&(f-=t.width/2,h-=t.height/2)}var g=e,v=e;return(d+90)%360>180?(g-=l,v-=l):v+=l,{points:[[f,h],[e,r],[v,r]],text:[g,r-c],angle:d+90}},coe=function(t){var e=t.data,r=t.annotations,n=t.getPosition,i=t.getDimensions;return ce.exports.useMemo(function(){return L2t({data:e,annotations:r,getPosition:n,getDimensions:i})},[e,r,n,i])},F2t=function(t){var e=t.annotations;return ce.exports.useMemo(function(){return e.map(function(r){return ma({},r,{computed:uoe(ma({},r))})})},[e])},H2t=function(t){return ce.exports.useMemo(function(){return uoe(t)},[t])},B2t=function(t){var e=t.datum,r=t.x,n=t.y,i=t.note,o=pr(),a=uo(),s=a.animate,l=a.config,u=Sa({x:r,y:n,config:l,immediate:!s});return typeof i=="function"?ce.exports.createElement(i,{x:r,y:n,datum:e}):ye.jsxs(ye.Fragment,{children:[o.annotations.text.outlineWidth>0&&ye.jsx(kr.text,{x:u.x,y:u.y,style:ma({},o.annotations.text,{strokeLinejoin:"round",strokeWidth:2*o.annotations.text.outlineWidth,stroke:o.annotations.text.outlineColor}),children:i}),ye.jsx(kr.text,{x:u.x,y:u.y,style:loe(o.annotations.text,["outlineWidth","outlineColor"]),children:i})]})},az=function(t){var e=t.points,r=t.isOutline,n=r!==void 0&&r,i=pr(),o=ce.exports.useMemo(function(){var l=e[0];return e.slice(1).reduce(function(u,c){return u+" L"+c[0]+","+c[1]},"M"+l[0]+","+l[1])},[e]),a=W9(o);if(n&&i.annotations.link.outlineWidth<=0)return null;var s=ma({},i.annotations.link);return n&&(s.strokeLinecap="square",s.strokeWidth=i.annotations.link.strokeWidth+2*i.annotations.link.outlineWidth,s.stroke=i.annotations.link.outlineColor,s.opacity=i.annotations.link.outlineOpacity),ye.jsx(kr.path,{fill:"none",d:a,style:s})},U2t=function(t){var e=t.x,r=t.y,n=t.size,i=pr(),o=uo(),a=o.animate,s=o.config,l=Sa({x:e,y:r,radius:n/2,config:s,immediate:!a});return ye.jsxs(ye.Fragment,{children:[i.annotations.outline.outlineWidth>0&&ye.jsx(kr.circle,{cx:l.x,cy:l.y,r:l.radius,style:ma({},i.annotations.outline,{fill:"none",strokeWidth:i.annotations.outline.strokeWidth+2*i.annotations.outline.outlineWidth,stroke:i.annotations.outline.outlineColor,opacity:i.annotations.outline.outlineOpacity})}),ye.jsx(kr.circle,{cx:l.x,cy:l.y,r:l.radius,style:i.annotations.outline})]})},V2t=function(t){var e=t.x,r=t.y,n=t.size,i=n===void 0?P4.dotSize:n,o=pr(),a=uo(),s=a.animate,l=a.config,u=Sa({x:e,y:r,radius:i/2,config:l,immediate:!s});return ye.jsxs(ye.Fragment,{children:[o.annotations.outline.outlineWidth>0&&ye.jsx(kr.circle,{cx:u.x,cy:u.y,r:u.radius,style:ma({},o.annotations.outline,{fill:"none",strokeWidth:2*o.annotations.outline.outlineWidth,stroke:o.annotations.outline.outlineColor,opacity:o.annotations.outline.outlineOpacity})}),ye.jsx(kr.circle,{cx:u.x,cy:u.y,r:u.radius,style:o.annotations.symbol})]})},j2t=function(t){var e=t.x,r=t.y,n=t.width,i=t.height,o=t.borderRadius,a=o===void 0?6:o,s=pr(),l=uo(),u=l.animate,c=l.config,f=Sa({x:e-n/2,y:r-i/2,width:n,height:i,config:c,immediate:!u});return ye.jsxs(ye.Fragment,{children:[s.annotations.outline.outlineWidth>0&&ye.jsx(kr.rect,{x:f.x,y:f.y,rx:a,ry:a,width:f.width,height:f.height,style:ma({},s.annotations.outline,{fill:"none",strokeWidth:s.annotations.outline.strokeWidth+2*s.annotations.outline.outlineWidth,stroke:s.annotations.outline.outlineColor,opacity:s.annotations.outline.outlineOpacity})}),ye.jsx(kr.rect,{x:f.x,y:f.y,rx:a,ry:a,width:f.width,height:f.height,style:s.annotations.outline})]})},W2t=function(t){var e=t.datum,r=t.x,n=t.y,i=t.note,o=H2t(t);if(!k2t(i))throw new Error("note should be a valid react element");return ye.jsxs(ye.Fragment,{children:[ye.jsx(az,{points:o.points,isOutline:!0}),e1(t)&&ye.jsx(U2t,{x:r,y:n,size:t.size}),k4(t)&&ye.jsx(V2t,{x:r,y:n,size:t.size}),t1(t)&&ye.jsx(j2t,{x:r,y:n,width:t.width,height:t.height,borderRadius:t.borderRadius}),ye.jsx(az,{points:o.points}),ye.jsx(B2t,{datum:e,x:o.text[0],y:o.text[1],note:i})]})},sz=function(t,e){e.forEach(function(r,n){var i=r[0],o=r[1];n===0?t.moveTo(i,o):t.lineTo(i,o)})},z2t=function(t,e){var r=e.annotations,n=e.theme;r.length!==0&&(t.save(),r.forEach(function(i){if(!$2t(i.note))throw new Error("note is invalid for canvas implementation");n.annotations.link.outlineWidth>0&&(t.lineCap="square",t.strokeStyle=n.annotations.link.outlineColor,t.lineWidth=n.annotations.link.strokeWidth+2*n.annotations.link.outlineWidth,t.beginPath(),sz(t,i.computed.points),t.stroke(),t.lineCap="butt"),e1(i)&&n.annotations.outline.outlineWidth>0&&(t.strokeStyle=n.annotations.outline.outlineColor,t.lineWidth=n.annotations.outline.strokeWidth+2*n.annotations.outline.outlineWidth,t.beginPath(),t.arc(i.x,i.y,i.size/2,0,2*Math.PI),t.stroke()),k4(i)&&n.annotations.symbol.outlineWidth>0&&(t.strokeStyle=n.annotations.symbol.outlineColor,t.lineWidth=2*n.annotations.symbol.outlineWidth,t.beginPath(),t.arc(i.x,i.y,i.size/2,0,2*Math.PI),t.stroke()),t1(i)&&n.annotations.outline.outlineWidth>0&&(t.strokeStyle=n.annotations.outline.outlineColor,t.lineWidth=n.annotations.outline.strokeWidth+2*n.annotations.outline.outlineWidth,t.beginPath(),t.rect(i.x-i.width/2,i.y-i.height/2,i.width,i.height),t.stroke()),t.strokeStyle=n.annotations.link.stroke,t.lineWidth=n.annotations.link.strokeWidth,t.beginPath(),sz(t,i.computed.points),t.stroke(),e1(i)&&(t.strokeStyle=n.annotations.outline.stroke,t.lineWidth=n.annotations.outline.strokeWidth,t.beginPath(),t.arc(i.x,i.y,i.size/2,0,2*Math.PI),t.stroke()),k4(i)&&(t.fillStyle=n.annotations.symbol.fill,t.beginPath(),t.arc(i.x,i.y,i.size/2,0,2*Math.PI),t.fill()),t1(i)&&(t.strokeStyle=n.annotations.outline.stroke,t.lineWidth=n.annotations.outline.strokeWidth,t.beginPath(),t.rect(i.x-i.width/2,i.y-i.height/2,i.width,i.height),t.stroke()),typeof i.note=="function"?i.note(t,{datum:i.datum,x:i.computed.text[0],y:i.computed.text[1],theme:n}):(t.font=n.annotations.text.fontSize+"px "+n.annotations.text.fontFamily,t.textAlign="left",t.textBaseline="alphabetic",t.fillStyle=n.annotations.text.fill,t.strokeStyle=n.annotations.text.outlineColor,t.lineWidth=2*n.annotations.text.outlineWidth,n.annotations.text.outlineWidth>0&&(t.lineJoin="round",t.strokeText(i.note,i.computed.text[0],i.computed.text[1]),t.lineJoin="miter"),t.fillText(i.note,i.computed.text[0],i.computed.text[1]))}),t.restore())};function zS(){return zS=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zS.apply(this,arguments)}function lz(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function G2t(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=function(i,o){if(i){if(typeof i=="string")return lz(i,o);var a=Object.prototype.toString.call(i).slice(8,-1);return a==="Object"&&i.constructor&&(a=i.constructor.name),a==="Map"||a==="Set"?Array.from(i):a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?lz(i,o):void 0}}(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var foe={nivo:["#e8c1a0","#f47560","#f1e15b","#e8a838","#61cdbb","#97e3d5"],category10:kne,accent:$ne,dark2:Lne,paired:Dne,pastel1:Fne,pastel2:Hne,set1:Bne,set2:Une,set3:k9},Y2t=Object.keys(foe),hoe={brown_blueGreen:x5,purpleRed_green:M5,pink_yellowGreen:N5,purple_orange:P5,red_blue:k5,red_grey:$5,red_yellow_blue:L5,red_yellow_green:D5,spectral:F5},K2t=Object.keys(hoe),q2t={brown_blueGreen:qmt,purpleRed_green:Xmt,pink_yellowGreen:Qmt,purple_orange:Zmt,red_blue:Jmt,red_grey:egt,red_yellow_blue:tgt,red_yellow_green:rgt,spectral:ngt},doe={blues:Q5,greens:Z5,greys:J5,oranges:rR,purples:eR,reds:tR,blue_green:H5,blue_purple:B5,green_blue:U5,orange_red:V5,purple_blue_green:j5,purple_blue:W5,purple_red:z5,red_purple:G5,yellow_green_blue:Y5,yellow_green:K5,yellow_orange_brown:q5,yellow_orange_red:X5},X2t=Object.keys(doe),Q2t={blues:ggt,greens:ygt,greys:vgt,oranges:Sgt,purples:bgt,reds:wgt,turbo:xgt,viridis:Mgt,inferno:Pgt,magma:Ngt,plasma:kgt,cividis:Rgt,warm:Cgt,cool:_gt,cubehelixDefault:Egt,blue_green:igt,blue_purple:ogt,green_blue:agt,orange_red:sgt,purple_blue_green:lgt,purple_blue:ugt,purple_red:cgt,red_purple:fgt,yellow_green_blue:hgt,yellow_green:dgt,yellow_orange_brown:pgt,yellow_orange_red:mgt},H2=zS({},foe,hoe,doe),Z2t=Object.keys(H2),J2t=function(t){return Y2t.includes(t)},ewt=function(t){return K2t.includes(t)},twt=function(t){return X2t.includes(t)},rwt={rainbow:Tgt,sinebow:Igt};zS({},q2t,Q2t,rwt);var nwt=function(t,e){if(typeof t=="function")return t;if(Q1(t)){if(function(l){return l.theme!==void 0}(t)){if(e===void 0)throw new Error("Unable to use color from theme as no theme was provided");var r=Xi(e,t.theme);if(r===void 0)throw new Error("Color from theme is undefined at path: '"+t.theme+"'");return function(){return r}}if(function(l){return l.from!==void 0}(t)){var n=function(l){return Xi(l,t.from)};if(Array.isArray(t.modifiers)){for(var i,o=[],a=function(){var l=i.value,u=l[0],c=l[1];if(u==="brighter")o.push(function(f){return f.brighter(c)});else if(u==="darker")o.push(function(f){return f.darker(c)});else{if(u!=="opacity")throw new Error("Invalid color modifier: '"+u+"', must be one of: 'brighter', 'darker', 'opacity'");o.push(function(f){return f.opacity=c,f})}},s=G2t(t.modifiers);!(i=s()).done;)a();return o.length===0?n:function(l){return o.reduce(function(u,c){return c(u)},Rp(n(l))).toString()}}return n}throw new Error("Invalid color spec, you should either specify 'theme' or 'from' when using a config object")}return function(){return t}},Ip=function(t,e){return ce.exports.useMemo(function(){return nwt(t,e)},[t,e])},iwt=N.exports.oneOfType([N.exports.func,N.exports.arrayOf(N.exports.string),N.exports.shape({scheme:N.exports.oneOf(Z2t).isRequired,size:N.exports.number}),N.exports.shape({datum:N.exports.string.isRequired}),N.exports.string]);N.exports.oneOfType([N.exports.string,N.exports.func,N.exports.shape({theme:N.exports.string.isRequired}),N.exports.shape({from:N.exports.string.isRequired,modifiers:N.exports.arrayOf(N.exports.array)})]);var owt=function(t,e){if(typeof t=="function")return t;var r=typeof e=="function"?e:function(f){return Xi(f,e)};if(Array.isArray(t)){var n=$u(t),i=function(f){return n(r(f))};return i.scale=n,i}if(Q1(t)){if(function(f){return f.datum!==void 0}(t))return function(f){return Xi(f,t.datum)};if(function(f){return f.scheme!==void 0}(t)){if(J2t(t.scheme)){var o=$u(H2[t.scheme]),a=function(f){return o(r(f))};return a.scale=o,a}if(ewt(t.scheme)){if(t.size!==void 0&&(t.size<3||t.size>11))throw new Error("Invalid size '"+t.size+"' for diverging color scheme '"+t.scheme+"', must be between 3~11");var s=$u(H2[t.scheme][t.size||11]),l=function(f){return s(r(f))};return l.scale=s,l}if(twt(t.scheme)){if(t.size!==void 0&&(t.size<3||t.size>9))throw new Error("Invalid size '"+t.size+"' for sequential color scheme '"+t.scheme+"', must be between 3~9");var u=$u(H2[t.scheme][t.size||9]),c=function(f){return u(r(f))};return c.scale=u,c}}throw new Error("Invalid colors, when using an object, you should either pass a 'datum' or a 'scheme' property")}return function(){return t}},poe=function(t,e){return ce.exports.useMemo(function(){return owt(t,e)},[t,e])},awt=function(t){var e=t.x,r=t.y,n=t.size,i=t.fill,o=t.opacity,a=o===void 0?1:o,s=t.borderWidth,l=s===void 0?0:s,u=t.borderColor;return ye.jsx("circle",{r:n/2,cx:e+n/2,cy:r+n/2,fill:i,opacity:a,strokeWidth:l,stroke:u===void 0?"transparent":u,style:{pointerEvents:"none"}})},swt=function(t){var e=t.x,r=t.y,n=t.size,i=t.fill,o=t.opacity,a=o===void 0?1:o,s=t.borderWidth,l=s===void 0?0:s,u=t.borderColor;return ye.jsx("g",{transform:"translate("+e+","+r+")",children:ye.jsx("path",{d:`
                    M`+n/2+` 0
                    L`+.8*n+" "+n/2+`
                    L`+n/2+" "+n+`
                    L`+.2*n+" "+n/2+`
                    L`+n/2+` 0
                `,fill:i,opacity:a,strokeWidth:l,stroke:u===void 0?"transparent":u,style:{pointerEvents:"none"}})})},lwt=function(t){var e=t.x,r=t.y,n=t.size,i=t.fill,o=t.opacity,a=o===void 0?1:o,s=t.borderWidth,l=s===void 0?0:s,u=t.borderColor;return ye.jsx("rect",{x:e,y:r,fill:i,opacity:a,strokeWidth:l,stroke:u===void 0?"transparent":u,width:n,height:n,style:{pointerEvents:"none"}})},uwt=function(t){var e=t.x,r=t.y,n=t.size,i=t.fill,o=t.opacity,a=o===void 0?1:o,s=t.borderWidth,l=s===void 0?0:s,u=t.borderColor;return ye.jsx("g",{transform:"translate("+e+","+r+")",children:ye.jsx("path",{d:`
                M`+n/2+` 0
                L`+n+" "+n+`
                L0 `+n+`
                L`+n/2+` 0
            `,fill:i,opacity:a,strokeWidth:l,stroke:u===void 0?"transparent":u,style:{pointerEvents:"none"}})})};function Lu(){return Lu=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Lu.apply(this,arguments)}var cwt={top:0,right:0,bottom:0,left:0},q9=function(t){var e,r=t.direction,n=t.itemsSpacing,i=t.padding,o=t.itemCount,a=t.itemWidth,s=t.itemHeight;if(typeof i!="number"&&(typeof(e=i)!="object"||Array.isArray(e)||e===null))throw new Error("Invalid property padding, must be one of: number, object");var l=typeof i=="number"?{top:i,right:i,bottom:i,left:i}:Lu({},cwt,i),u=l.left+l.right,c=l.top+l.bottom,f=a+u,h=s+c,d=(o-1)*n;return r==="row"?f=a*o+d+u:r==="column"&&(h=s*o+d+c),{width:f,height:h,padding:l}},moe=function(t){var e=t.anchor,r=t.translateX,n=t.translateY,i=t.containerWidth,o=t.containerHeight,a=t.width,s=t.height,l=r,u=n;switch(e){case"top":l+=(i-a)/2;break;case"top-right":l+=i-a;break;case"right":l+=i-a,u+=(o-s)/2;break;case"bottom-right":l+=i-a,u+=o-s;break;case"bottom":l+=(i-a)/2,u+=o-s;break;case"bottom-left":u+=o-s;break;case"left":u+=(o-s)/2;break;case"center":l+=(i-a)/2,u+=(o-s)/2}return{x:l,y:u}},goe=function(t){var e,r,n,i,o,a,s=t.direction,l=t.justify,u=t.symbolSize,c=t.symbolSpacing,f=t.width,h=t.height;switch(s){case"left-to-right":e=0,r=(h-u)/2,i=h/2,a="central",l?(n=f,o="end"):(n=u+c,o="start");break;case"right-to-left":e=f-u,r=(h-u)/2,i=h/2,a="central",l?(n=0,o="start"):(n=f-u-c,o="end");break;case"top-to-bottom":e=(f-u)/2,r=0,n=f/2,o="middle",l?(i=h,a="alphabetic"):(i=u+c,a="text-before-edge");break;case"bottom-to-top":e=(f-u)/2,r=h-u,n=f/2,o="middle",l?(i=0,a="text-before-edge"):(i=h-u-c,a="alphabetic")}return{symbolX:e,symbolY:r,labelX:n,labelY:i,labelAnchor:o,labelAlignment:a}},fwt={circle:awt,diamond:swt,square:lwt,triangle:uwt},hwt=function(t){var e,r,n,i,o,a,s,l,u,c,f,h=t.x,d=t.y,p=t.width,m=t.height,g=t.data,v=t.direction,w=v===void 0?"left-to-right":v,b=t.justify,E=b!==void 0&&b,A=t.textColor,M=t.background,k=M===void 0?"transparent":M,O=t.opacity,x=O===void 0?1:O,C=t.symbolShape,I=C===void 0?"square":C,H=t.symbolSize,j=H===void 0?16:H,q=t.symbolSpacing,Z=q===void 0?8:q,ne=t.symbolBorderWidth,ie=ne===void 0?0:ne,P=t.symbolBorderColor,y=P===void 0?"transparent":P,R=t.onClick,_=t.onMouseEnter,$=t.onMouseLeave,B=t.toggleSerie,W=t.effects,ee=ce.exports.useState({}),J=ee[0],he=ee[1],re=pr(),T=ce.exports.useCallback(function(F){if(W){var U=W.filter(function(Y){return Y.on==="hover"}).reduce(function(Y,fe){return Lu({},Y,fe.style)},{});he(U)}_==null||_(g,F)},[_,g,W]),D=ce.exports.useCallback(function(F){if(W){var U=W.filter(function(Y){return Y.on!=="hover"}).reduce(function(Y,fe){return Lu({},Y,fe.style)},{});he(U)}$==null||$(g,F)},[$,g,W]),z=goe({direction:w,justify:E,symbolSize:(e=J.symbolSize)!=null?e:j,symbolSpacing:Z,width:p,height:m}),K=z.symbolX,le=z.symbolY,X=z.labelX,we=z.labelY,Ce=z.labelAnchor,Ee=z.labelAlignment,Te=[R,_,$,B].some(function(F){return F!==void 0}),Oe=typeof I=="function"?I:fwt[I];return ye.jsxs("g",{transform:"translate("+h+","+d+")",style:{opacity:(r=J.itemOpacity)!=null?r:x},children:[ye.jsx("rect",{width:p,height:m,fill:(n=J.itemBackground)!=null?n:k,style:{cursor:Te?"pointer":"auto"},onClick:function(F){R==null||R(g,F),B==null||B(g.id)},onMouseEnter:T,onMouseLeave:D}),ce.exports.createElement(Oe,Lu({id:g.id,x:K,y:le,size:(i=J.symbolSize)!=null?i:j,fill:(o=(a=g.fill)!=null?a:g.color)!=null?o:"black",borderWidth:(s=J.symbolBorderWidth)!=null?s:ie,borderColor:(l=J.symbolBorderColor)!=null?l:y},g.hidden?re.legends.hidden.symbol:void 0)),ye.jsx("text",{textAnchor:Ce,style:Lu({},re.legends.text,{fill:(u=(c=(f=J.itemTextColor)!=null?f:A)!=null?c:re.legends.text.fill)!=null?u:"black",dominantBaseline:Ee,pointerEvents:"none",userSelect:"none"},g.hidden?re.legends.hidden.text:void 0),x:X,y:we,children:g.label})]})},dwt=function(t){var e=t.data,r=t.x,n=t.y,i=t.direction,o=t.padding,a=o===void 0?0:o,s=t.justify,l=t.effects,u=t.itemWidth,c=t.itemHeight,f=t.itemDirection,h=f===void 0?"left-to-right":f,d=t.itemsSpacing,p=d===void 0?0:d,m=t.itemTextColor,g=t.itemBackground,v=g===void 0?"transparent":g,w=t.itemOpacity,b=w===void 0?1:w,E=t.symbolShape,A=t.symbolSize,M=t.symbolSpacing,k=t.symbolBorderWidth,O=t.symbolBorderColor,x=t.onClick,C=t.onMouseEnter,I=t.onMouseLeave,H=t.toggleSerie,j=q9({itemCount:e.length,itemWidth:u,itemHeight:c,itemsSpacing:p,direction:i,padding:a}).padding,q=i==="row"?u+p:0,Z=i==="column"?c+p:0;return ye.jsx("g",{transform:"translate("+r+","+n+")",children:e.map(function(ne,ie){return ye.jsx(hwt,{data:ne,x:ie*q+j.left,y:ie*Z+j.top,width:u,height:c,direction:h,justify:s,effects:l,textColor:m,background:v,opacity:b,symbolShape:E,symbolSize:A,symbolSpacing:M,symbolBorderWidth:k,symbolBorderColor:O,onClick:x,onMouseEnter:C,onMouseLeave:I,toggleSerie:H},ie)})})},yoe=function(t){var e=t.data,r=t.containerWidth,n=t.containerHeight,i=t.translateX,o=i===void 0?0:i,a=t.translateY,s=a===void 0?0:a,l=t.anchor,u=t.direction,c=t.padding,f=c===void 0?0:c,h=t.justify,d=t.itemsSpacing,p=d===void 0?0:d,m=t.itemWidth,g=t.itemHeight,v=t.itemDirection,w=t.itemTextColor,b=t.itemBackground,E=t.itemOpacity,A=t.symbolShape,M=t.symbolSize,k=t.symbolSpacing,O=t.symbolBorderWidth,x=t.symbolBorderColor,C=t.onClick,I=t.onMouseEnter,H=t.onMouseLeave,j=t.toggleSerie,q=t.effects,Z=q9({itemCount:e.length,itemsSpacing:p,itemWidth:m,itemHeight:g,direction:u,padding:f}),ne=Z.width,ie=Z.height,P=moe({anchor:l,translateX:o,translateY:s,containerWidth:r,containerHeight:n,width:ne,height:ie}),y=P.x,R=P.y;return ye.jsx(dwt,{data:e,x:y,y:R,direction:u,padding:f,justify:h,effects:q,itemsSpacing:p,itemWidth:m,itemHeight:g,itemDirection:v,itemTextColor:w,itemBackground:b,itemOpacity:E,symbolShape:A,symbolSize:M,symbolSpacing:k,symbolBorderWidth:O,symbolBorderColor:x,onClick:C,onMouseEnter:I,onMouseLeave:H,toggleSerie:typeof j=="boolean"?void 0:j})},pwt={start:"left",middle:"center",end:"right"},voe=function(t,e){var r=e.data,n=e.containerWidth,i=e.containerHeight,o=e.translateX,a=o===void 0?0:o,s=e.translateY,l=s===void 0?0:s,u=e.anchor,c=e.direction,f=e.padding,h=f===void 0?0:f,d=e.justify,p=d!==void 0&&d,m=e.itemsSpacing,g=m===void 0?0:m,v=e.itemWidth,w=e.itemHeight,b=e.itemDirection,E=b===void 0?"left-to-right":b,A=e.itemTextColor,M=e.symbolSize,k=M===void 0?16:M,O=e.symbolSpacing,x=O===void 0?8:O,C=e.theme,I=q9({itemCount:r.length,itemWidth:v,itemHeight:w,itemsSpacing:g,direction:c,padding:h}),H=I.width,j=I.height,q=I.padding,Z=moe({anchor:u,translateX:a,translateY:l,containerWidth:n,containerHeight:i,width:H,height:j}),ne=Z.x,ie=Z.y,P=c==="row"?v+g:0,y=c==="column"?w+g:0;t.save(),t.translate(ne,ie),t.font=C.legends.text.fontSize+"px "+(C.legends.text.fontFamily||"sans-serif"),r.forEach(function(R,_){var $,B,W=_*P+q.left,ee=_*y+q.top,J=goe({direction:E,justify:p,symbolSize:k,symbolSpacing:x,width:v,height:w}),he=J.symbolX,re=J.symbolY,T=J.labelX,D=J.labelY,z=J.labelAnchor,K=J.labelAlignment;t.fillStyle=($=R.color)!=null?$:"black",t.fillRect(W+he,ee+re,k,k),t.textAlign=pwt[z],K==="central"&&(t.textBaseline="middle"),t.fillStyle=(B=A!=null?A:C.legends.text.fill)!=null?B:"black",t.fillText(String(R.label),W+T,ee+D)}),t.restore()},mwt={data:N.exports.arrayOf(N.exports.object),anchor:N.exports.oneOf(["top","top-right","right","bottom-right","bottom","bottom-left","left","top-left","center"]).isRequired,translateX:N.exports.number,translateY:N.exports.number,direction:N.exports.oneOf(["row","column"]).isRequired,itemsSpacing:N.exports.number,itemWidth:N.exports.number.isRequired,itemHeight:N.exports.number.isRequired,itemDirection:N.exports.oneOf(["left-to-right","right-to-left","top-to-bottom","bottom-to-top"]),itemTextColor:N.exports.string,itemBackground:N.exports.string,itemOpacity:N.exports.number,symbolShape:N.exports.oneOfType([N.exports.oneOf(["circle","diamond","square","triangle"]),N.exports.func]),symbolSize:N.exports.number,symbolSpacing:N.exports.number,symbolBorderWidth:N.exports.number,symbolBorderColor:N.exports.string,onClick:N.exports.func,onMouseEnter:N.exports.func,onMouseLeave:N.exports.func,effects:N.exports.arrayOf(N.exports.shape({on:N.exports.oneOfType([N.exports.oneOf(["hover"])]).isRequired,style:N.exports.shape({itemTextColor:N.exports.string,itemBackground:N.exports.string,itemOpacity:N.exports.number,symbolSize:N.exports.number,symbolBorderWidth:N.exports.number,symbolBorderColor:N.exports.string}).isRequired}))};function Jt(){return Jt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Jt.apply(this,arguments)}function Qp(t,e){if(t==null)return{};var r,n,i={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(i[r]=t[r]);return i}var uz,gwt=function(t){var e=t.bars,r=t.annotations,n=coe({data:e,annotations:r,getPosition:function(i){return{x:i.x+i.width/2,y:i.y+i.height/2}},getDimensions:function(i){var o=i.height,a=i.width;return{width:a,height:o,size:Math.max(a,o)}}});return ye.jsx(ye.Fragment,{children:n.map(function(i,o){return ye.jsx(W2t,Jt({},i),o)})})},ywt=function(t){var e=t.width,r=t.height,n=t.legends,i=t.toggleSerie;return ye.jsx(ye.Fragment,{children:n.map(function(o,a){var s,l=o[0],u=o[1];return ye.jsx(yoe,Jt({},l,{containerWidth:e,containerHeight:r,data:(s=l.data)!=null?s:u,toggleSerie:l.toggleSerie&&l.dataFrom==="keys"?i:void 0}),a)})})},vwt=["data"],bwt=function(t){var e,r=t.bar,n=r.data,i=Qp(r,vwt),o=t.style,a=o.borderColor,s=o.color,l=o.height,u=o.labelColor,c=o.labelOpacity,f=o.labelX,h=o.labelY,d=o.transform,p=o.width,m=t.borderRadius,g=t.borderWidth,v=t.label,w=t.shouldRenderLabel,b=t.isInteractive,E=t.onClick,A=t.onMouseEnter,M=t.onMouseLeave,k=t.tooltip,O=t.isFocusable,x=t.ariaLabel,C=t.ariaLabelledBy,I=t.ariaDescribedBy,H=pr(),j=X1(),q=j.showTooltipFromEvent,Z=j.showTooltipAt,ne=j.hideTooltip,ie=ce.exports.useMemo(function(){return function(){return ce.exports.createElement(k,Jt({},i,n))}},[k,i,n]),P=ce.exports.useCallback(function(W){E==null||E(Jt({color:i.color},n),W)},[i,n,E]),y=ce.exports.useCallback(function(W){return q(ie(),W)},[q,ie]),R=ce.exports.useCallback(function(W){A==null||A(n,W),q(ie(),W)},[n,A,q,ie]),_=ce.exports.useCallback(function(W){M==null||M(n,W),ne()},[n,ne,M]),$=ce.exports.useCallback(function(){Z(ie(),[i.absX+i.width/2,i.absY])},[Z,ie,i]),B=ce.exports.useCallback(function(){ne()},[ne]);return ye.jsxs(kr.g,{transform:d,children:[ye.jsx(kr.rect,{width:f4(p,function(W){return Math.max(W,0)}),height:f4(l,function(W){return Math.max(W,0)}),rx:m,ry:m,fill:(e=n.fill)!=null?e:s,strokeWidth:g,stroke:a,focusable:O,tabIndex:O?0:void 0,"aria-label":x?x(n):void 0,"aria-labelledby":C?C(n):void 0,"aria-describedby":I?I(n):void 0,onMouseEnter:b?R:void 0,onMouseMove:b?y:void 0,onMouseLeave:b?_:void 0,onClick:b?P:void 0,onFocus:b&&O?$:void 0,onBlur:b&&O?B:void 0}),w&&ye.jsx(kr.text,{x:f,y:h,textAnchor:"middle",dominantBaseline:"central",fillOpacity:c,style:Jt({},H.labels.text,{pointerEvents:"none",fill:u}),children:v})]})},wwt=["color","label"],fr={indexBy:"id",keys:["value"],groupMode:"stacked",layout:"vertical",reverse:!1,minValue:"auto",maxValue:"auto",valueScale:{type:"linear"},indexScale:{type:"band",round:!0},padding:.1,innerPadding:0,axisBottom:{},axisLeft:{},enableGridX:!1,enableGridY:!0,enableLabel:!0,label:"formattedValue",labelSkipWidth:0,labelSkipHeight:0,labelTextColor:{from:"theme",theme:"labels.text.fill"},colorBy:"id",colors:{scheme:"nivo"},borderRadius:0,borderWidth:0,borderColor:{from:"color"},isInteractive:!0,tooltip:function(t){var e=t.color,r=t.label,n=Qp(t,wwt);return ye.jsx($re,{id:r,value:n.formattedValue,enableChip:!0,color:e})},tooltipLabel:function(t){return t.id+" - "+t.indexValue},legends:[],initialHiddenIds:[],annotations:[],markers:[]},Ir=Jt({},fr,{layers:["grid","axes","bars","markers","legends","annotations"],barComponent:bwt,defs:[],fill:[],animate:!0,motionConfig:"default",role:"img",isFocusable:!1}),ri=Jt({},fr,{layers:["grid","axes","bars","legends","annotations"],pixelRatio:typeof window<"u"&&(uz=window.devicePixelRatio)!=null?uz:1}),boe=function(t,e,r,n,i,o){return Jv(n,{all:t.map(e),min:0,max:0},i,o).padding(r)},woe=function(t,e){return t.map(function(r){return Jt({},e.reduce(function(n,i){return n[i]=null,n},{}),r)})},cR=function(t){return Object.keys(t).reduce(function(e,r){return t[r]&&(e[r]=t[r]),e},{})},fR=function(t){return[t,Number(t)]},Swt=["layout","minValue","maxValue","reverse","width","height","padding","innerPadding","valueScale","indexScale","hiddenIds"],X9=function(t,e){return t>e},Soe=function(t,e){return t<e},Roe=function(t,e){return Array.from(" ".repeat(e-t),function(r,n){return t+n})},Rwt=function(t){return X9(t,0)?0:t},Ewt=function(t,e,r,n){var i=t.data,o=t.formatValue,a=t.getColor,s=t.getIndex,l=t.getTooltipLabel,u=t.innerPadding,c=u===void 0?0:u,f=t.keys,h=t.xScale,d=t.yScale,p=t.margin,m=r?Soe:X9,g=i.map(cR),v=[];return f.forEach(function(w,b){return Roe(0,h.domain().length).forEach(function(E){var A,M,k,O=fR(i[E][w]),x=O[0],C=O[1],I=s(i[E]),H=((A=h(I))!=null?A:0)+e*b+c*b,j=m(M=C,0)?(k=d(M))!=null?k:0:n,q=function(ne,ie){var P;return m(ne,0)?n-ie:((P=d(ne))!=null?P:0)-n}(C,j),Z={id:w,value:x===null?x:C,formattedValue:o(C),hidden:!1,index:E,indexValue:I,data:g[E]};v.push({key:w+"."+Z.indexValue,index:v.length,data:Z,x:H,y:j,absX:p.left+H,absY:p.top+j,width:e,height:q,color:a(Z),label:l(Z)})})}),v},Cwt=function(t,e,r,n){var i=t.data,o=t.formatValue,a=t.getIndex,s=t.getColor,l=t.getTooltipLabel,u=t.keys,c=t.innerPadding,f=c===void 0?0:c,h=t.xScale,d=t.yScale,p=t.margin,m=r?Soe:X9,g=i.map(cR),v=[];return u.forEach(function(w,b){return Roe(0,d.domain().length).forEach(function(E){var A,M,k,O=fR(i[E][w]),x=O[0],C=O[1],I=a(i[E]),H=m(M=C,0)?n:(k=h(M))!=null?k:0,j=((A=d(I))!=null?A:0)+e*b+f*b,q=function(ne,ie){var P;return m(ne,0)?((P=h(ne))!=null?P:0)-n:n-ie}(C,H),Z={id:w,value:x===null?x:C,formattedValue:o(C),hidden:!1,index:E,indexValue:I,data:g[E]};v.push({key:w+"."+Z.indexValue,index:v.length,data:Z,x:H,y:j,absX:p.left+H,absY:p.top+j,width:q,height:e,color:s(Z),label:l(Z)})})}),v},_wt=function(t){var e,r,n=t.layout,i=t.minValue,o=t.maxValue,a=t.reverse,s=t.width,l=t.height,u=t.padding,c=u===void 0?0:u,f=t.innerPadding,h=f===void 0?0:f,d=t.valueScale,p=t.indexScale,m=t.hiddenIds,g=m===void 0?[]:m,v=Qp(t,Swt),w=v.keys.filter(function(R){return!g.includes(R)}),b=woe(v.data,w),E=n==="vertical"?["y","x",s]:["x","y",l],A=E[0],M=E[1],k=E[2],O=boe(b,v.getIndex,c,p,k,M),x=Jt({max:o,min:i,reverse:a},d),C=x.min==="auto"?Rwt:function(R){return R},I=b.reduce(function(R,_){return[].concat(R,w.map(function($){return _[$]}))},[]).filter(Boolean),H=C(Math.min.apply(Math,I)),j=(r=Math.max.apply(Math,I),isFinite(r)?r:0),q=Jv(x,{all:I,min:H,max:j},A==="x"?s:l,A),Z=n==="vertical"?[O,q]:[q,O],ne=Z[0],ie=Z[1],P=(O.bandwidth()-h*(w.length-1))/w.length,y=[Jt({},v,{data:b,keys:w,innerPadding:h,xScale:ne,yScale:ie}),P,x.reverse,(e=q(0))!=null?e:0];return{xScale:ne,yScale:ie,bars:P>0?n==="vertical"?Ewt.apply(void 0,y):Cwt.apply(void 0,y):[]}},Twt=["data","layout","minValue","maxValue","reverse","width","height","padding","valueScale","indexScale","hiddenIds"],Owt=function t(e){var r;return e.some(Array.isArray)?t((r=[]).concat.apply(r,e)):e},Awt=function(t,e,r){var n=t.formatValue,i=t.getColor,o=t.getIndex,a=t.getTooltipLabel,s=t.innerPadding,l=t.stackedData,u=t.xScale,c=t.yScale,f=t.margin,h=[];return l.forEach(function(d){return u.domain().forEach(function(p,m){var g,v,w=d[m],b=(g=u(o(w.data)))!=null?g:0,E=((v=function(C){return c(C[r?0:1])}(w))!=null?v:0)+.5*s,A=function(C,I){var H;return((H=c(C[r?1:0]))!=null?H:0)-I}(w,E)-s,M=fR(w.data[d.key]),k=M[0],O=M[1],x={id:d.key,value:k===null?k:O,formattedValue:n(O),hidden:!1,index:m,indexValue:p,data:cR(w.data)};h.push({key:d.key+"."+p,index:h.length,data:x,x:b,y:E,absX:f.left+b,absY:f.top+E,width:e,height:A,color:i(x),label:a(x)})})}),h},Iwt=function(t,e,r){var n=t.formatValue,i=t.getColor,o=t.getIndex,a=t.getTooltipLabel,s=t.innerPadding,l=t.stackedData,u=t.xScale,c=t.yScale,f=t.margin,h=[];return l.forEach(function(d){return c.domain().forEach(function(p,m){var g,v,w=d[m],b=(g=c(o(w.data)))!=null?g:0,E=((v=function(C){return u(C[r?1:0])}(w))!=null?v:0)+.5*s,A=function(C,I){var H;return((H=u(C[r?0:1]))!=null?H:0)-I}(w,E)-s,M=fR(w.data[d.key]),k=M[0],O=M[1],x={id:d.key,value:k===null?k:O,formattedValue:n(O),hidden:!1,index:m,indexValue:p,data:cR(w.data)};h.push({key:d.key+"."+p,index:h.length,data:x,x:E,y:b,absX:f.left+E,absY:f.top+b,width:A,height:e,color:i(x),label:a(x)})})}),h},xwt=function(t){var e,r=t.data,n=t.layout,i=t.minValue,o=t.maxValue,a=t.reverse,s=t.width,l=t.height,u=t.padding,c=u===void 0?0:u,f=t.valueScale,h=t.indexScale,d=t.hiddenIds,p=d===void 0?[]:d,m=Qp(t,Twt),g=m.keys.filter(function(P){return!p.includes(P)}),v=pyt().keys(g).offset(nie)(woe(r,g)),w=n==="vertical"?["y","x",s]:["x","y",l],b=w[0],E=w[1],A=w[2],M=boe(r,m.getIndex,c,h,A,E),k=Jt({max:o,min:i,reverse:a},f),O=(e=Owt(v),f.type==="log"?e.filter(function(P){return P!==0}):e),x=Math.min.apply(Math,O),C=Math.max.apply(Math,O),I=Jv(k,{all:O,min:x,max:C},b==="x"?s:l,b),H=n==="vertical"?[M,I]:[I,M],j=H[0],q=H[1],Z=m.innerPadding>0?m.innerPadding:0,ne=M.bandwidth(),ie=[Jt({},m,{innerPadding:Z,stackedData:v,xScale:j,yScale:q}),ne,k.reverse];return{xScale:j,yScale:q,bars:ne>0?n==="vertical"?Awt.apply(void 0,ie):Iwt.apply(void 0,ie):[]}},Mwt=function(t){var e=t.bars,r=t.direction,n=t.from,i=t.groupMode,o=t.layout,a=t.legendLabel,s=t.reverse,l=Eie(a!=null?a:n==="indexes"?"indexValue":"id");return n==="indexes"?function(u,c,f){var h=A_(u.map(function(d){var p,m;return{id:(p=d.data.indexValue)!=null?p:"",label:f(d.data),hidden:d.data.hidden,color:(m=d.color)!=null?m:"#000"}}),function(d){return d.id});return c==="horizontal"&&h.reverse(),h}(e,o,l):function(u,c,f,h,d,p){var m=A_(u.map(function(g){var v;return{id:g.data.id,label:p(g.data),hidden:g.data.hidden,color:(v=g.color)!=null?v:"#000"}}),function(g){return g.id});return(c==="vertical"&&h==="stacked"&&f==="column"&&d!==!0||c==="horizontal"&&h==="stacked"&&d===!0)&&m.reverse(),m}(e,o,r,i,s,l)},Eoe=function(t){var e=t.indexBy,r=e===void 0?fr.indexBy:e,n=t.keys,i=n===void 0?fr.keys:n,o=t.label,a=o===void 0?fr.label:o,s=t.tooltipLabel,l=s===void 0?fr.tooltipLabel:s,u=t.valueFormat,c=t.colors,f=c===void 0?fr.colors:c,h=t.colorBy,d=h===void 0?fr.colorBy:h,p=t.borderColor,m=p===void 0?fr.borderColor:p,g=t.labelTextColor,v=g===void 0?fr.labelTextColor:g,w=t.groupMode,b=w===void 0?fr.groupMode:w,E=t.layout,A=E===void 0?fr.layout:E,M=t.reverse,k=M===void 0?fr.reverse:M,O=t.data,x=t.minValue,C=x===void 0?fr.minValue:x,I=t.maxValue,H=I===void 0?fr.maxValue:I,j=t.margin,q=t.width,Z=t.height,ne=t.padding,ie=ne===void 0?fr.padding:ne,P=t.innerPadding,y=P===void 0?fr.innerPadding:P,R=t.valueScale,_=R===void 0?fr.valueScale:R,$=t.indexScale,B=$===void 0?fr.indexScale:$,W=t.initialHiddenIds,ee=W===void 0?fr.initialHiddenIds:W,J=t.enableLabel,he=J===void 0?fr.enableLabel:J,re=t.labelSkipWidth,T=re===void 0?fr.labelSkipWidth:re,D=t.labelSkipHeight,z=D===void 0?fr.labelSkipHeight:D,K=t.legends,le=K===void 0?fr.legends:K,X=t.legendLabel,we=ce.exports.useState(ee!=null?ee:[]),Ce=we[0],Ee=we[1],Te=ce.exports.useCallback(function(ke){Ee(function(We){return We.indexOf(ke)>-1?We.filter(function(Ke){return Ke!==ke}):[].concat(We,[ke])})},[]),Oe=v_(r),F=v_(a),U=v_(l),Y=BS(u),fe=pr(),oe=poe(f,d),pe=Ip(m,fe),ue=Ip(v,fe),se=(b==="grouped"?_wt:xwt)({layout:A,reverse:k,data:O,getIndex:Oe,keys:i,minValue:C,maxValue:H,width:q,height:Z,getColor:oe,padding:ie,innerPadding:y,valueScale:_,indexScale:B,hiddenIds:Ce,formatValue:Y,getTooltipLabel:U,margin:j}),me=se.bars,te=se.xScale,de=se.yScale,Se=ce.exports.useMemo(function(){return me.filter(function(ke){return ke.data.value!==null}).map(function(ke,We){return Jt({},ke,{index:We})})},[me]),Re=ce.exports.useCallback(function(ke){var We=ke.width,Ke=ke.height;return!!he&&!(T>0&&We<T)&&!(z>0&&Ke<z)},[he,T,z]),Me=ce.exports.useMemo(function(){return i.map(function(ke){var We=me.find(function(Ke){return Ke.data.id===ke});return Jt({},We,{data:Jt({id:ke},We==null?void 0:We.data,{hidden:Ce.includes(ke)})})})},[Ce,i,me]),qe=ce.exports.useMemo(function(){return le.map(function(ke){return[ke,Mwt({bars:ke.dataFrom==="keys"?Me:me,direction:ke.direction,from:ke.dataFrom,groupMode:b,layout:A,legendLabel:X,reverse:k})]})},[le,Me,me,b,A,X,k]);return{bars:me,barsWithValue:Se,xScale:te,yScale:de,getIndex:Oe,getLabel:F,getTooltipLabel:U,formatValue:Y,getColor:oe,getBorderColor:pe,getLabelColor:ue,shouldRenderBarLabel:Re,hiddenIds:Ce,toggleSerie:Te,legendsWithData:qe}},Nwt=["isInteractive","animate","motionConfig","theme","renderWrapper"],Pwt=function(t){var e=t.data,r=t.indexBy,n=t.keys,i=t.margin,o=t.width,a=t.height,s=t.groupMode,l=t.layout,u=t.reverse,c=t.minValue,f=t.maxValue,h=t.valueScale,d=t.indexScale,p=t.padding,m=t.innerPadding,g=t.axisTop,v=t.axisRight,w=t.axisBottom,b=w===void 0?Ir.axisBottom:w,E=t.axisLeft,A=E===void 0?Ir.axisLeft:E,M=t.enableGridX,k=M===void 0?Ir.enableGridX:M,O=t.enableGridY,x=O===void 0?Ir.enableGridY:O,C=t.gridXValues,I=t.gridYValues,H=t.layers,j=H===void 0?Ir.layers:H,q=t.barComponent,Z=q===void 0?Ir.barComponent:q,ne=t.enableLabel,ie=ne===void 0?Ir.enableLabel:ne,P=t.label,y=t.labelSkipWidth,R=y===void 0?Ir.labelSkipWidth:y,_=t.labelSkipHeight,$=_===void 0?Ir.labelSkipHeight:_,B=t.labelTextColor,W=t.markers,ee=W===void 0?Ir.markers:W,J=t.colorBy,he=t.colors,re=t.defs,T=re===void 0?Ir.defs:re,D=t.fill,z=D===void 0?Ir.fill:D,K=t.borderRadius,le=K===void 0?Ir.borderRadius:K,X=t.borderWidth,we=X===void 0?Ir.borderWidth:X,Ce=t.borderColor,Ee=t.annotations,Te=Ee===void 0?Ir.annotations:Ee,Oe=t.legendLabel,F=t.tooltipLabel,U=t.valueFormat,Y=t.isInteractive,fe=Y===void 0?Ir.isInteractive:Y,oe=t.tooltip,pe=oe===void 0?Ir.tooltip:oe,ue=t.onClick,se=t.onMouseEnter,me=t.onMouseLeave,te=t.legends,de=t.role,Se=de===void 0?Ir.role:de,Re=t.ariaLabel,Me=t.ariaLabelledBy,qe=t.ariaDescribedBy,ke=t.isFocusable,We=ke===void 0?Ir.isFocusable:ke,Ke=t.barAriaLabel,Xe=t.barAriaLabelledBy,nt=t.barAriaDescribedBy,Et=t.initialHiddenIds,it=uo(),st=it.animate,rt=it.config,Lt=lR(o,a,i),kt=Lt.outerWidth,Mt=Lt.outerHeight,gt=Lt.margin,Kr=Lt.innerWidth,rn=Lt.innerHeight,Lr=Eoe({indexBy:r,label:P,tooltipLabel:F,valueFormat:U,colors:he,colorBy:J,borderColor:Ce,labelTextColor:B,groupMode:s,layout:l,reverse:u,data:e,keys:n,minValue:c,maxValue:f,margin:gt,width:Kr,height:rn,padding:p,innerPadding:m,valueScale:h,indexScale:d,enableLabel:ie,labelSkipWidth:R,labelSkipHeight:$,legends:te,legendLabel:Oe,initialHiddenIds:Et}),co=Lr.bars,Zp=Lr.barsWithValue,En=Lr.xScale,et=Lr.yScale,Ct=Lr.getLabel,Wt=Lr.getTooltipLabel,mr=Lr.getBorderColor,Nt=Lr.getLabelColor,_r=Lr.shouldRenderBarLabel,qr=Lr.toggleSerie,Tr=Lr.legendsWithData,$c=m9(Zp,{keys:function(be){return be.key},from:function(be){return Jt({borderColor:mr(be),color:be.color,height:0,labelColor:Nt(be),labelOpacity:0,labelX:be.width/2,labelY:be.height/2,transform:"translate("+be.x+", "+(be.y+be.height)+")",width:be.width},l==="vertical"?{}:{height:be.height,transform:"translate("+be.x+", "+be.y+")",width:0})},enter:function(be){return{borderColor:mr(be),color:be.color,height:be.height,labelColor:Nt(be),labelOpacity:1,labelX:be.width/2,labelY:be.height/2,transform:"translate("+be.x+", "+be.y+")",width:be.width}},update:function(be){return{borderColor:mr(be),color:be.color,height:be.height,labelColor:Nt(be),labelOpacity:1,labelX:be.width/2,labelY:be.height/2,transform:"translate("+be.x+", "+be.y+")",width:be.width}},leave:function(be){return Jt({borderColor:mr(be),color:be.color,height:0,labelColor:Nt(be),labelOpacity:0,labelX:be.width/2,labelY:0,transform:"translate("+be.x+", "+(be.y+be.height)+")",width:be.width},l==="vertical"?{}:{labelX:0,labelY:be.height/2,height:be.height,transform:"translate("+be.x+", "+be.y+")",width:0})},config:rt,immediate:!st}),Ra=ce.exports.useMemo(function(){return{borderRadius:le,borderWidth:we,enableLabel:ie,isInteractive:fe,labelSkipWidth:R,labelSkipHeight:$,onClick:ue,onMouseEnter:se,onMouseLeave:me,getTooltipLabel:Wt,tooltip:pe,isFocusable:We,ariaLabel:Ke,ariaLabelledBy:Xe,ariaDescribedBy:nt}},[le,we,ie,Wt,fe,$,R,ue,se,me,pe,We,Ke,Xe,nt]),xl=_ie(T,co,z,{dataKey:"data",targetKey:"data.fill"}),Ve={annotations:null,axes:null,bars:null,grid:null,legends:null,markers:null};j.includes("annotations")&&(Ve.annotations=ye.jsx(gwt,{bars:co,annotations:Te},"annotations")),j.includes("axes")&&(Ve.axes=ye.jsx(eoe,{xScale:En,yScale:et,width:Kr,height:rn,top:g,right:v,bottom:b,left:A},"axes")),j.includes("bars")&&(Ve.bars=ye.jsx(ce.exports.Fragment,{children:$c(function(be,xe){return ce.exports.createElement(Z,Jt({},Ra,{bar:xe,style:be,shouldRenderLabel:_r(xe),label:Ct(xe.data)}))})},"bars")),j.includes("grid")&&(Ve.grid=ye.jsx(toe,{width:Kr,height:rn,xScale:k?En:null,yScale:x?et:null,xValues:C,yValues:I},"grid")),j.includes("legends")&&(Ve.legends=ye.jsx(ywt,{width:Kr,height:rn,legends:Tr,toggleSerie:qr},"legends")),j.includes("markers")&&(Ve.markers=ye.jsx(Sie,{markers:ee,width:Kr,height:rn,xScale:En,yScale:et},"markers"));var ge=ce.exports.useMemo(function(){return Jt({},Ra,{margin:gt,width:o,height:a,innerWidth:Kr,innerHeight:rn,bars:co,legendData:Tr,enableLabel:ie,xScale:En,yScale:et,tooltip:pe,getTooltipLabel:Wt,onClick:ue,onMouseEnter:se,onMouseLeave:me})},[Ra,gt,o,a,Kr,rn,co,Tr,ie,En,et,pe,Wt,ue,se,me]);return ye.jsx(G9,{width:kt,height:Mt,margin:gt,defs:xl,role:Se,ariaLabel:Re,ariaLabelledBy:Me,ariaDescribedBy:qe,isFocusable:We,children:j.map(function(be,xe){var Dt;return typeof be=="function"?ye.jsx(ce.exports.Fragment,{children:ce.exports.createElement(be,ge)},xe):(Dt=Ve==null?void 0:Ve[be])!=null?Dt:null})})},kwt=function(t){var e=t.isInteractive,r=e===void 0?Ir.isInteractive:e,n=t.animate,i=n===void 0?Ir.animate:n,o=t.motionConfig,a=o===void 0?Ir.motionConfig:o,s=t.theme,l=t.renderWrapper,u=Qp(t,Nwt);return ye.jsx(uR,{animate:i,isInteractive:r,motionConfig:a,renderWrapper:l,theme:s,children:ye.jsx(Pwt,Jt({isInteractive:r},u))})},$wt=["isInteractive","renderWrapper","theme"],S_=function(t,e,r,n){return t.find(function(i){return Cie(i.x+e.left,i.y+e.top,i.width,i.height,r,n)})},Lwt=function(t){var e=t.data,r=t.indexBy,n=t.keys,i=t.margin,o=t.width,a=t.height,s=t.groupMode,l=t.layout,u=t.reverse,c=t.minValue,f=t.maxValue,h=t.valueScale,d=t.indexScale,p=t.padding,m=t.innerPadding,g=t.axisTop,v=t.axisRight,w=t.axisBottom,b=w===void 0?ri.axisBottom:w,E=t.axisLeft,A=E===void 0?ri.axisLeft:E,M=t.enableGridX,k=M===void 0?ri.enableGridX:M,O=t.enableGridY,x=O===void 0?ri.enableGridY:O,C=t.gridXValues,I=t.gridYValues,H=t.layers,j=H===void 0?ri.layers:H,q=t.renderBar,Z=q===void 0?function(et,Ct){var Wt=Ct.bar,mr=Wt.color,Nt=Wt.height,_r=Wt.width,qr=Wt.x,Tr=Wt.y,$c=Ct.borderColor,Ra=Ct.borderRadius,xl=Ct.borderWidth,Ve=Ct.label,ge=Ct.labelColor,be=Ct.shouldRenderLabel;if(et.fillStyle=mr,xl>0&&(et.strokeStyle=$c,et.lineWidth=xl),et.beginPath(),Ra>0){var xe=Math.min(Ra,Nt);et.moveTo(qr+xe,Tr),et.lineTo(qr+_r-xe,Tr),et.quadraticCurveTo(qr+_r,Tr,qr+_r,Tr+xe),et.lineTo(qr+_r,Tr+Nt-xe),et.quadraticCurveTo(qr+_r,Tr+Nt,qr+_r-xe,Tr+Nt),et.lineTo(qr+xe,Tr+Nt),et.quadraticCurveTo(qr,Tr+Nt,qr,Tr+Nt-xe),et.lineTo(qr,Tr+xe),et.quadraticCurveTo(qr,Tr,qr+xe,Tr),et.closePath()}else et.rect(qr,Tr,_r,Nt);et.fill(),xl>0&&et.stroke(),be&&(et.textBaseline="middle",et.textAlign="center",et.fillStyle=ge,et.fillText(Ve,qr+_r/2,Tr+Nt/2))}:q,ne=t.enableLabel,ie=ne===void 0?ri.enableLabel:ne,P=t.label,y=t.labelSkipWidth,R=y===void 0?ri.labelSkipWidth:y,_=t.labelSkipHeight,$=_===void 0?ri.labelSkipHeight:_,B=t.labelTextColor,W=t.colorBy,ee=t.colors,J=t.borderRadius,he=J===void 0?ri.borderRadius:J,re=t.borderWidth,T=re===void 0?ri.borderWidth:re,D=t.borderColor,z=t.annotations,K=z===void 0?ri.annotations:z,le=t.legendLabel,X=t.tooltipLabel,we=t.valueFormat,Ce=t.isInteractive,Ee=Ce===void 0?ri.isInteractive:Ce,Te=t.tooltip,Oe=Te===void 0?ri.tooltip:Te,F=t.onClick,U=t.onMouseEnter,Y=t.onMouseLeave,fe=t.legends,oe=t.pixelRatio,pe=oe===void 0?ri.pixelRatio:oe,ue=t.canvasRef,se=ce.exports.useRef(null),me=pr(),te=lR(o,a,i),de=te.margin,Se=te.innerWidth,Re=te.innerHeight,Me=te.outerWidth,qe=te.outerHeight,ke=Eoe({indexBy:r,label:P,tooltipLabel:X,valueFormat:we,colors:ee,colorBy:W,borderColor:D,labelTextColor:B,groupMode:s,layout:l,reverse:u,data:e,keys:n,minValue:c,maxValue:f,margin:de,width:Se,height:Re,padding:p,innerPadding:m,valueScale:h,indexScale:d,enableLabel:ie,labelSkipWidth:R,labelSkipHeight:$,legends:fe,legendLabel:le}),We=ke.bars,Ke=ke.barsWithValue,Xe=ke.xScale,nt=ke.yScale,Et=ke.getLabel,it=ke.getTooltipLabel,st=ke.getBorderColor,rt=ke.getLabelColor,Lt=ke.shouldRenderBarLabel,kt=ke.legendsWithData,Mt=X1(),gt=Mt.showTooltipFromEvent,Kr=Mt.hideTooltip,rn=F2t({annotations:coe({data:We,annotations:K,getPosition:function(et){return{x:et.x,y:et.y}},getDimensions:function(et){var Ct=et.width,Wt=et.height;return{width:Ct,height:Wt,size:Math.max(Ct,Wt)}}})}),Lr=ce.exports.useMemo(function(){return{borderRadius:he,borderWidth:T,isInteractive:Ee,isFocusable:!1,labelSkipWidth:R,labelSkipHeight:$,margin:de,width:o,height:a,innerWidth:Se,innerHeight:Re,bars:We,legendData:kt,enableLabel:ie,xScale:Xe,yScale:nt,tooltip:Oe,getTooltipLabel:it,onClick:F,onMouseEnter:U,onMouseLeave:Y}},[he,T,Ee,R,$,de,o,a,Se,Re,We,kt,ie,Xe,nt,Oe,it,F,U,Y]);ce.exports.useEffect(function(){var et,Ct=(et=se.current)==null?void 0:et.getContext("2d");se.current&&Ct&&(se.current.width=Me*pe,se.current.height=qe*pe,Ct.scale(pe,pe),Ct.fillStyle=me.background,Ct.fillRect(0,0,Me,qe),Ct.translate(de.left,de.top),j.forEach(function(Wt){Wt==="grid"?typeof me.grid.line.strokeWidth=="number"&&me.grid.line.strokeWidth>0&&(Ct.lineWidth=me.grid.line.strokeWidth,Ct.strokeStyle=me.grid.line.stroke,k&&WS(Ct,{width:o,height:a,scale:Xe,axis:"x",values:C}),x&&WS(Ct,{width:o,height:a,scale:nt,axis:"y",values:I})):Wt==="axes"?roe(Ct,{xScale:Xe,yScale:nt,width:Se,height:Re,top:g,right:v,bottom:b,left:A,theme:me}):Wt==="bars"?Ke.forEach(function(mr){Z(Ct,{bar:mr,borderColor:st(mr),borderRadius:he,borderWidth:T,label:Et(mr.data),labelColor:rt(mr),shouldRenderLabel:Lt(mr)})}):Wt==="legends"?kt.forEach(function(mr){var Nt=mr[0],_r=mr[1];voe(Ct,Jt({},Nt,{data:_r,containerWidth:Se,containerHeight:Re,theme:me}))}):Wt==="annotations"?z2t(Ct,{annotations:rn,theme:me}):typeof Wt=="function"&&Wt(Ct,Lr)}),Ct.save())},[b,A,v,g,Ke,he,T,rn,k,x,st,Et,rt,C,I,s,a,Re,Se,Lr,j,l,kt,de.left,de.top,qe,Me,pe,Z,Xe,nt,u,Lt,me,o]);var co=ce.exports.useCallback(function(et){if(We&&se.current){var Ct=Sg(se.current,et),Wt=Ct[0],mr=Ct[1],Nt=S_(We,de,Wt,mr);Nt!==void 0?(gt(ce.exports.createElement(Oe,Jt({},Nt.data,{color:Nt.color,label:Nt.label,value:Number(Nt.data.value)})),et),et.type==="mouseenter"&&(U==null||U(Nt.data,et))):Kr()}},[Kr,de,U,We,gt,Oe]),Zp=ce.exports.useCallback(function(et){if(We&&se.current){Kr();var Ct=Sg(se.current,et),Wt=Ct[0],mr=Ct[1],Nt=S_(We,de,Wt,mr);Nt&&(Y==null||Y(Nt.data,et))}},[Kr,de,Y,We]),En=ce.exports.useCallback(function(et){if(We&&se.current){var Ct=Sg(se.current,et),Wt=Ct[0],mr=Ct[1],Nt=S_(We,de,Wt,mr);Nt!==void 0&&(F==null||F(Jt({},Nt.data,{color:Nt.color}),et))}},[de,F,We]);return ye.jsx("canvas",{ref:function(et){se.current=et,ue&&"current"in ue&&(ue.current=et)},width:Me*pe,height:qe*pe,style:{width:Me,height:qe,cursor:Ee?"auto":"normal"},onMouseEnter:Ee?co:void 0,onMouseMove:Ee?co:void 0,onMouseLeave:Ee?Zp:void 0,onClick:Ee?En:void 0})},Dwt=ce.exports.forwardRef(function(t,e){var r=t.isInteractive,n=t.renderWrapper,i=t.theme,o=Qp(t,$wt);return ye.jsx(uR,{isInteractive:r,renderWrapper:n,theme:i,animate:!1,children:ye.jsx(Lwt,Jt({},o,{canvasRef:e}))})}),Fwt=function(t){return ye.jsx(J1,{children:function(e){var r=e.width,n=e.height;return ye.jsx(kwt,Jt({width:r,height:n},t))}})};ce.exports.forwardRef(function(t,e){return ye.jsx(J1,{children:function(r){var n=r.width,i=r.height;return ye.jsx(Dwt,Jt({width:n,height:i},t,{ref:e}))}})});function Hwt(){const{startDate:t,endDate:e}=Zx(),[r]=Es(F4),n=Io.exports.useLiveQuery(async()=>{const i=await Ba.expenditure.where(ur.datetime).between(t,e||1/0,!0,!0).toArray(),o=Uv(await Ba.recurring.toArray(),t,e),a=kb([...i,...o]).filter(u=>u.txn_type===dn.CREDIT).groupBy(ur.creditCard).mapValues(u=>u.reduce((c,f)=>c+Number(f.amount),0)).value(),s=[];return{chartData:Object.entries(a).reduce((u,c)=>{const[f,h]=c;return s.push(f),[...u,{source:f,[f]:h}]},[]),banks:Zi.exports.uniq(s)}},[t,e]);return ve.createElement(Zs,{sx:Uoe},ve.createElement(ps,{variant:"h6"},"Spending by Card"),ve.createElement(Fwt,{data:(n==null?void 0:n.chartData)||[],indexBy:"source",keys:(n==null?void 0:n.banks)||[],tooltip:i=>ve.createElement(Voe,null,`${i.id} $${i.value.toLocaleString()}`),margin:{top:10,right:10,bottom:40,left:40},theme:{axis:{legend:{text:{fill:r?"#939393":"#000"}},ticks:{text:{fill:r?"#939393":"#000"}}},labels:{text:{fill:r?"#fff":"#000",textShadow:`1px 1px ${r?"black":"white"}`}}}}))}var Q9={},Bwt=_z.exports;Object.defineProperty(Q9,"__esModule",{value:!0});var Coe=Q9.default=void 0,Uwt=Bwt(Ez()),Vwt=Cz(),jwt=(0,Uwt.default)((0,Vwt.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12 1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteForever");Coe=Q9.default=jwt;var Wwt=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Xr=globalThis&&globalThis.__assign||function(){return Xr=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Xr.apply(this,arguments)},cz={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},fz={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},Ab={width:"20px",height:"20px",position:"absolute"},zwt={top:Xr(Xr({},cz),{top:"-5px"}),right:Xr(Xr({},fz),{left:void 0,right:"-5px"}),bottom:Xr(Xr({},cz),{top:void 0,bottom:"-5px"}),left:Xr(Xr({},fz),{left:"-5px"}),topRight:Xr(Xr({},Ab),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:Xr(Xr({},Ab),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:Xr(Xr({},Ab),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:Xr(Xr({},Ab),{left:"-10px",top:"-10px",cursor:"nw-resize"})},Gwt=function(t){Wwt(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.onMouseDown=function(n){r.props.onResizeStart(n,r.props.direction)},r.onTouchStart=function(n){r.props.onResizeStart(n,r.props.direction)},r}return e.prototype.render=function(){return ce.exports.createElement("div",{className:this.props.className||"",style:Xr(Xr({position:"absolute",userSelect:"none"},zwt[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},e}(ce.exports.PureComponent),Ywt=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Xo=globalThis&&globalThis.__assign||function(){return Xo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Xo.apply(this,arguments)},Kwt={width:"auto",height:"auto"},Ib=function(t,e,r){return Math.max(Math.min(t,r),e)},hz=function(t,e){return Math.round(t/e)*e},wf=function(t,e){return new RegExp(t,"i").test(e)},xb=function(t){return Boolean(t.touches&&t.touches.length)},qwt=function(t){return Boolean((t.clientX||t.clientX===0)&&(t.clientY||t.clientY===0))},dz=function(t,e,r){r===void 0&&(r=0);var n=e.reduce(function(o,a,s){return Math.abs(a-t)<Math.abs(e[o]-t)?s:o},0),i=Math.abs(e[n]-t);return r===0||i<r?e[n]:t},R_=function(t){return t=t.toString(),t==="auto"||t.endsWith("px")||t.endsWith("%")||t.endsWith("vh")||t.endsWith("vw")||t.endsWith("vmax")||t.endsWith("vmin")?t:t+"px"},Mb=function(t,e,r,n){if(t&&typeof t=="string"){if(t.endsWith("px"))return Number(t.replace("px",""));if(t.endsWith("%")){var i=Number(t.replace("%",""))/100;return e*i}if(t.endsWith("vw")){var i=Number(t.replace("vw",""))/100;return r*i}if(t.endsWith("vh")){var i=Number(t.replace("vh",""))/100;return n*i}}return t},Xwt=function(t,e,r,n,i,o,a){return n=Mb(n,t.width,e,r),i=Mb(i,t.height,e,r),o=Mb(o,t.width,e,r),a=Mb(a,t.height,e,r),{maxWidth:typeof n>"u"?void 0:Number(n),maxHeight:typeof i>"u"?void 0:Number(i),minWidth:typeof o>"u"?void 0:Number(o),minHeight:typeof a>"u"?void 0:Number(a)}},Qwt=["as","style","className","grid","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],pz="__resizable_base__",Zwt=function(t){Ywt(e,t);function e(r){var n=t.call(this,r)||this;return n.ratio=1,n.resizable=null,n.parentLeft=0,n.parentTop=0,n.resizableLeft=0,n.resizableRight=0,n.resizableTop=0,n.resizableBottom=0,n.targetLeft=0,n.targetTop=0,n.appendBase=function(){if(!n.resizable||!n.window)return null;var i=n.parentNode;if(!i)return null;var o=n.window.document.createElement("div");return o.style.width="100%",o.style.height="100%",o.style.position="absolute",o.style.transform="scale(0, 0)",o.style.left="0",o.style.flex="0 0 100%",o.classList?o.classList.add(pz):o.className+=pz,i.appendChild(o),o},n.removeBase=function(i){var o=n.parentNode;!o||o.removeChild(i)},n.ref=function(i){i&&(n.resizable=i)},n.state={isResizing:!1,width:typeof(n.propsSize&&n.propsSize.width)>"u"?"auto":n.propsSize&&n.propsSize.width,height:typeof(n.propsSize&&n.propsSize.height)>"u"?"auto":n.propsSize&&n.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},n.onResizeStart=n.onResizeStart.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n}return Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){return!this.resizable||!this.resizable.ownerDocument?null:this.resizable.ownerDocument.defaultView},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||Kwt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){var r=0,n=0;if(this.resizable&&this.window){var i=this.resizable.offsetWidth,o=this.resizable.offsetHeight,a=this.resizable.style.position;a!=="relative"&&(this.resizable.style.position="relative"),r=this.resizable.style.width!=="auto"?this.resizable.offsetWidth:i,n=this.resizable.style.height!=="auto"?this.resizable.offsetHeight:o,this.resizable.style.position=a}return{width:r,height:n}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sizeStyle",{get:function(){var r=this,n=this.props.size,i=function(s){if(typeof r.state[s]>"u"||r.state[s]==="auto")return"auto";if(r.propsSize&&r.propsSize[s]&&r.propsSize[s].toString().endsWith("%")){if(r.state[s].toString().endsWith("%"))return r.state[s].toString();var l=r.getParentSize(),u=Number(r.state[s].toString().replace("px","")),c=u/l[s]*100;return c+"%"}return R_(r.state[s])},o=n&&typeof n.width<"u"&&!this.state.isResizing?R_(n.width):i("width"),a=n&&typeof n.height<"u"&&!this.state.isResizing?R_(n.height):i("height");return{width:o,height:a}},enumerable:!1,configurable:!0}),e.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var r=this.appendBase();if(!r)return{width:0,height:0};var n=!1,i=this.parentNode.style.flexWrap;i!=="wrap"&&(n=!0,this.parentNode.style.flexWrap="wrap"),r.style.position="relative",r.style.minWidth="100%",r.style.minHeight="100%";var o={width:r.offsetWidth,height:r.offsetHeight};return n&&(this.parentNode.style.flexWrap=i),this.removeBase(r),o},e.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},e.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},e.prototype.componentDidMount=function(){if(!(!this.resizable||!this.window)){var r=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:r.flexBasis!=="auto"?r.flexBasis:void 0})}},e.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},e.prototype.createSizeForCssProperty=function(r,n){var i=this.propsSize&&this.propsSize[n];return this.state[n]==="auto"&&this.state.original[n]===r&&(typeof i>"u"||i==="auto")?"auto":r},e.prototype.calculateNewMaxFromBoundary=function(r,n){var i=this.props.boundsByDirection,o=this.state.direction,a=i&&wf("left",o),s=i&&wf("top",o),l,u;if(this.props.bounds==="parent"){var c=this.parentNode;c&&(l=a?this.resizableRight-this.parentLeft:c.offsetWidth+(this.parentLeft-this.resizableLeft),u=s?this.resizableBottom-this.parentTop:c.offsetHeight+(this.parentTop-this.resizableTop))}else this.props.bounds==="window"?this.window&&(l=a?this.resizableRight:this.window.innerWidth-this.resizableLeft,u=s?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(l=a?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),u=s?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return l&&Number.isFinite(l)&&(r=r&&r<l?r:l),u&&Number.isFinite(u)&&(n=n&&n<u?n:u),{maxWidth:r,maxHeight:n}},e.prototype.calculateNewSizeFromDirection=function(r,n){var i=this.props.scale||1,o=this.props.resizeRatio||1,a=this.state,s=a.direction,l=a.original,u=this.props,c=u.lockAspectRatio,f=u.lockAspectRatioExtraHeight,h=u.lockAspectRatioExtraWidth,d=l.width,p=l.height,m=f||0,g=h||0;return wf("right",s)&&(d=l.width+(r-l.x)*o/i,c&&(p=(d-g)/this.ratio+m)),wf("left",s)&&(d=l.width-(r-l.x)*o/i,c&&(p=(d-g)/this.ratio+m)),wf("bottom",s)&&(p=l.height+(n-l.y)*o/i,c&&(d=(p-m)*this.ratio+g)),wf("top",s)&&(p=l.height-(n-l.y)*o/i,c&&(d=(p-m)*this.ratio+g)),{newWidth:d,newHeight:p}},e.prototype.calculateNewSizeFromAspectRatio=function(r,n,i,o){var a=this.props,s=a.lockAspectRatio,l=a.lockAspectRatioExtraHeight,u=a.lockAspectRatioExtraWidth,c=typeof o.width>"u"?10:o.width,f=typeof i.width>"u"||i.width<0?r:i.width,h=typeof o.height>"u"?10:o.height,d=typeof i.height>"u"||i.height<0?n:i.height,p=l||0,m=u||0;if(s){var g=(h-p)*this.ratio+m,v=(d-p)*this.ratio+m,w=(c-m)/this.ratio+p,b=(f-m)/this.ratio+p,E=Math.max(c,g),A=Math.min(f,v),M=Math.max(h,w),k=Math.min(d,b);r=Ib(r,E,A),n=Ib(n,M,k)}else r=Ib(r,c,f),n=Ib(n,h,d);return{newWidth:r,newHeight:n}},e.prototype.setBoundingClientRect=function(){if(this.props.bounds==="parent"){var r=this.parentNode;if(r){var n=r.getBoundingClientRect();this.parentLeft=n.left,this.parentTop=n.top}}if(this.props.bounds&&typeof this.props.bounds!="string"){var i=this.props.bounds.getBoundingClientRect();this.targetLeft=i.left,this.targetTop=i.top}if(this.resizable){var o=this.resizable.getBoundingClientRect(),a=o.left,s=o.top,l=o.right,u=o.bottom;this.resizableLeft=a,this.resizableRight=l,this.resizableTop=s,this.resizableBottom=u}},e.prototype.onResizeStart=function(r,n){if(!(!this.resizable||!this.window)){var i=0,o=0;if(r.nativeEvent&&qwt(r.nativeEvent)?(i=r.nativeEvent.clientX,o=r.nativeEvent.clientY):r.nativeEvent&&xb(r.nativeEvent)&&(i=r.nativeEvent.touches[0].clientX,o=r.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable){var a=this.props.onResizeStart(r,n,this.resizable);if(a===!1)return}this.props.size&&(typeof this.props.size.height<"u"&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),typeof this.props.size.width<"u"&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio=typeof this.props.lockAspectRatio=="number"?this.props.lockAspectRatio:this.size.width/this.size.height;var s,l=this.window.getComputedStyle(this.resizable);if(l.flexBasis!=="auto"){var u=this.parentNode;if(u){var c=this.window.getComputedStyle(u).flexDirection;this.flexDir=c.startsWith("row")?"row":"column",s=l.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var f={original:{x:i,y:o,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:Xo(Xo({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(r.target).cursor||"auto"}),direction:n,flexBasis:s};this.setState(f)}},e.prototype.onMouseMove=function(r){var n=this;if(!(!this.state.isResizing||!this.resizable||!this.window)){if(this.window.TouchEvent&&xb(r))try{r.preventDefault(),r.stopPropagation()}catch{}var i=this.props,o=i.maxWidth,a=i.maxHeight,s=i.minWidth,l=i.minHeight,u=xb(r)?r.touches[0].clientX:r.clientX,c=xb(r)?r.touches[0].clientY:r.clientY,f=this.state,h=f.direction,d=f.original,p=f.width,m=f.height,g=this.getParentSize(),v=Xwt(g,this.window.innerWidth,this.window.innerHeight,o,a,s,l);o=v.maxWidth,a=v.maxHeight,s=v.minWidth,l=v.minHeight;var w=this.calculateNewSizeFromDirection(u,c),b=w.newHeight,E=w.newWidth,A=this.calculateNewMaxFromBoundary(o,a);this.props.snap&&this.props.snap.x&&(E=dz(E,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(b=dz(b,this.props.snap.y,this.props.snapGap));var M=this.calculateNewSizeFromAspectRatio(E,b,{width:A.maxWidth,height:A.maxHeight},{width:s,height:l});if(E=M.newWidth,b=M.newHeight,this.props.grid){var k=hz(E,this.props.grid[0]),O=hz(b,this.props.grid[1]),x=this.props.snapGap||0;E=x===0||Math.abs(k-E)<=x?k:E,b=x===0||Math.abs(O-b)<=x?O:b}var C={width:E-d.width,height:b-d.height};if(p&&typeof p=="string"){if(p.endsWith("%")){var I=E/g.width*100;E=I+"%"}else if(p.endsWith("vw")){var H=E/this.window.innerWidth*100;E=H+"vw"}else if(p.endsWith("vh")){var j=E/this.window.innerHeight*100;E=j+"vh"}}if(m&&typeof m=="string"){if(m.endsWith("%")){var I=b/g.height*100;b=I+"%"}else if(m.endsWith("vw")){var H=b/this.window.innerWidth*100;b=H+"vw"}else if(m.endsWith("vh")){var j=b/this.window.innerHeight*100;b=j+"vh"}}var q={width:this.createSizeForCssProperty(E,"width"),height:this.createSizeForCssProperty(b,"height")};this.flexDir==="row"?q.flexBasis=q.width:this.flexDir==="column"&&(q.flexBasis=q.height),Rz.exports.flushSync(function(){n.setState(q)}),this.props.onResize&&this.props.onResize(r,h,this.resizable,C)}},e.prototype.onMouseUp=function(r){var n=this.state,i=n.isResizing,o=n.direction,a=n.original;if(!(!i||!this.resizable)){var s={width:this.size.width-a.width,height:this.size.height-a.height};this.props.onResizeStop&&this.props.onResizeStop(r,o,this.resizable,s),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:Xo(Xo({},this.state.backgroundStyle),{cursor:"auto"})})}},e.prototype.updateSize=function(r){this.setState({width:r.width,height:r.height})},e.prototype.renderResizer=function(){var r=this,n=this.props,i=n.enable,o=n.handleStyles,a=n.handleClasses,s=n.handleWrapperStyle,l=n.handleWrapperClass,u=n.handleComponent;if(!i)return null;var c=Object.keys(i).map(function(f){return i[f]!==!1?ce.exports.createElement(Gwt,{key:f,direction:f,onResizeStart:r.onResizeStart,replaceStyles:o&&o[f],className:a&&a[f]},u&&u[f]?u[f]:null):null});return ce.exports.createElement("div",{className:l,style:s},c)},e.prototype.render=function(){var r=this,n=Object.keys(this.props).reduce(function(a,s){return Qwt.indexOf(s)!==-1||(a[s]=r.props[s]),a},{}),i=Xo(Xo(Xo({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(i.flexBasis=this.state.flexBasis);var o=this.props.as||"div";return ce.exports.createElement(o,Xo({ref:this.ref,style:i,className:this.props.className},n),this.state.isResizing&&ce.exports.createElement("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer())},e.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},e}(ce.exports.PureComponent),Z9={},Jwt=_z.exports;Object.defineProperty(Z9,"__esModule",{value:!0});var _oe=Z9.default=void 0,eSt=Jwt(Ez()),tSt=Cz(),rSt=(0,eSt.default)((0,tSt.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"FileDownload");_oe=Z9.default=rSt;const nSt=(t,e)=>{const r=JSON.stringify(t,null,2),n=new Blob([r],{type:"application/json"}),i=URL.createObjectURL(n),o=document.createElement("a");o.href=i,o.download=e+".json",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)},iSt=()=>{const t=YS(f=>f.database),e="90vw",[r,n]=ce.exports.useState(400),[i,o]=ce.exports.useState(0),[a,s]=ce.exports.useState(""),l=Io.exports.useLiveQuery(async()=>{const f=await t.expenditure.toArray();let{minDate:h,maxDate:d}=f.reduce((g,v)=>({minDate:Math.min(v.datetime,g.minDate),maxDate:Math.max(v.datetime,g.maxDate)}),{minDate:1/0,maxDate:0});const p=f.reduce((g,v)=>Math.max(g,v.id||0),0),m=Uv(await t.recurring.where("start").belowOrEqual(d).toArray(),h,d).map((g,v)=>({...g,id:p+v}));return Zi.exports.sortBy([...f,...m],["datetime"])}),u=ce.exports.useCallback(f=>{let h=f.row.id,d=f.field,p=f.value;t.expenditure.update(h,{[d]:d==="amount"?parseFloat(p):p}).then().finally()},[]),c=[{field:"datetime",renderCell:f=>`${At.unix(f.row.datetime).format("YYYY MMM DD")}`},{field:"category",editable:!0,renderCell:f=>{let h=[];try{h=JSON.parse(f.row.category)}catch(d){console.error(d)}return ve.createElement(ve.Fragment,null,h.map(d=>ve.createElement(Uae,{label:d})))}},{field:"credit_card"},{field:"name",editable:!0},{field:"amount",editable:!0},{field:"delete",renderCell:f=>ve.createElement(Cg,{onClick:async()=>{f.row.recurringId?await t.recurring.delete(f.row.recurringId):await t.expenditure.delete(f.row.id)}},ve.createElement(Coe,null))},{field:"txn_type"}];return ve.createElement("div",null,ve.createElement(Zwt,{size:{width:e,height:r},onResizeStop:(f,h,d,p)=>{n(r+p.height)},minWidth:e,maxWidth:e,minHeight:220},ve.createElement(Mae,{sx:{[`& .${dn.DEBIT}`]:{bgcolor:"green"},[`& .${dn.CREDIT}`]:{bgcolor:"red"},[`& .${dn.SALARY}`]:{bgcolor:"blue"},[`& .${dn.RECURRING}`]:{bgcolor:"orange",color:"grey"}},onCellEditCommit:u,disableSelectionOnClick:!0,columns:c,rows:l||[],getRowClassName:f=>f.row[ur.transactionType],initialState:{sorting:{sortModel:[{field:"datetime",sort:"desc"}]}}})),ve.createElement(bt,{style:{width:"100%"},container:!0,direction:"row",justifyContent:"space-between",alignItems:"flex-start"},ve.createElement(bt,{item:!0},ve.createElement(B2,{variant:"contained",startIcon:ve.createElement(_oe,null),onClick:async()=>{const f=await t.expenditure.toArray(),h=await t.recurring.toArray();nSt({expenditure:f,recurring:h},"expenditure")}},"export")),ve.createElement(bt,{item:!0},ve.createElement(ps,{variant:"subtitle2",onClick:()=>o(i+1)},"*psst this table is resizable"))),i>=10&&ve.createElement("div",null,ve.createElement(B2,{size:"small",onClick:()=>{const f=JSON.parse(a);"expenditure"in f&&t.expenditure.clear().then(()=>{t.expenditure.bulkAdd(f.expenditure)}),"recurring"in f&&t.recurring.clear().then(()=>{t.recurring.bulkAdd(f.recurring)})}},"upload"),ve.createElement("input",{type:"file",accept:"application/json",onChange:f=>{let h=new FileReader;f.target.files!==null&&(h.readAsText(f.target.files[0],"UTF-8"),h.onload=d=>{var p;s((p=d.target)==null?void 0:p.result)})}})))};var Toe={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(){return function r(n,i,o){function a(u,c){if(!i[u]){if(!n[u]){var f=typeof Ws=="function"&&Ws;if(!c&&f)return f(u,!0);if(s)return s(u,!0);throw new Error("Cannot find module '"+u+"'")}c=i[u]={exports:{}},n[u][0].call(c.exports,function(h){var d=n[u][1][h];return a(d||h)},c,c.exports,r,n,i,o)}return i[u].exports}for(var s=typeof Ws=="function"&&Ws,l=0;l<o.length;l++)a(o[l]);return a}({1:[function(r,n,i){(function(o,a,s,l,u,c,f,h,d){var p=r("crypto");function m(M,k){k=w(M,k);var O;return(O=k.algorithm!=="passthrough"?p.createHash(k.algorithm):new A).write===void 0&&(O.write=O.update,O.end=O.update),E(k,O).dispatch(M),O.update||O.end(""),O.digest?O.digest(k.encoding==="buffer"?void 0:k.encoding):(M=O.read(),k.encoding!=="buffer"?M.toString(k.encoding):M)}(i=n.exports=m).sha1=function(M){return m(M)},i.keys=function(M){return m(M,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},i.MD5=function(M){return m(M,{algorithm:"md5",encoding:"hex"})},i.keysMD5=function(M){return m(M,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var g=p.getHashes?p.getHashes().slice():["sha1","md5"],v=(g.push("passthrough"),["buffer","hex","binary","base64"]);function w(M,k){var O={};if(O.algorithm=(k=k||{}).algorithm||"sha1",O.encoding=k.encoding||"hex",O.excludeValues=!!k.excludeValues,O.algorithm=O.algorithm.toLowerCase(),O.encoding=O.encoding.toLowerCase(),O.ignoreUnknown=k.ignoreUnknown===!0,O.respectType=k.respectType!==!1,O.respectFunctionNames=k.respectFunctionNames!==!1,O.respectFunctionProperties=k.respectFunctionProperties!==!1,O.unorderedArrays=k.unorderedArrays===!0,O.unorderedSets=k.unorderedSets!==!1,O.unorderedObjects=k.unorderedObjects!==!1,O.replacer=k.replacer||void 0,O.excludeKeys=k.excludeKeys||void 0,M===void 0)throw new Error("Object argument required.");for(var x=0;x<g.length;++x)g[x].toLowerCase()===O.algorithm.toLowerCase()&&(O.algorithm=g[x]);if(g.indexOf(O.algorithm)===-1)throw new Error('Algorithm "'+O.algorithm+'"  not supported. supported values: '+g.join(", "));if(v.indexOf(O.encoding)===-1&&O.algorithm!=="passthrough")throw new Error('Encoding "'+O.encoding+'"  not supported. supported values: '+v.join(", "));return O}function b(M){if(typeof M=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(M))!=null}function E(M,k,O){O=O||[];function x(C){return k.update?k.update(C,"utf8"):k.write(C,"utf8")}return{dispatch:function(C){return this["_"+((C=M.replacer?M.replacer(C):C)===null?"null":typeof C)](C)},_object:function(C){var I,H=Object.prototype.toString.call(C),j=/\[object (.*)\]/i.exec(H);if(j=(j=j?j[1]:"unknown:["+H+"]").toLowerCase(),0<=(H=O.indexOf(C)))return this.dispatch("[CIRCULAR:"+H+"]");if(O.push(C),s!==void 0&&s.isBuffer&&s.isBuffer(C))return x("buffer:"),x(C);if(j==="object"||j==="function"||j==="asyncfunction")return H=Object.keys(C),M.unorderedObjects&&(H=H.sort()),M.respectType===!1||b(C)||H.splice(0,0,"prototype","__proto__","constructor"),M.excludeKeys&&(H=H.filter(function(q){return!M.excludeKeys(q)})),x("object:"+H.length+":"),I=this,H.forEach(function(q){I.dispatch(q),x(":"),M.excludeValues||I.dispatch(C[q]),x(",")});if(!this["_"+j]){if(M.ignoreUnknown)return x("["+j+"]");throw new Error('Unknown object type "'+j+'"')}this["_"+j](C)},_array:function(C,q){q=q!==void 0?q:M.unorderedArrays!==!1;var H=this;if(x("array:"+C.length+":"),!q||C.length<=1)return C.forEach(function(Z){return H.dispatch(Z)});var j=[],q=C.map(function(Z){var ne=new A,ie=O.slice();return E(M,ne,ie).dispatch(Z),j=j.concat(ie.slice(O.length)),ne.read().toString()});return O=O.concat(j),q.sort(),this._array(q,!1)},_date:function(C){return x("date:"+C.toJSON())},_symbol:function(C){return x("symbol:"+C.toString())},_error:function(C){return x("error:"+C.toString())},_boolean:function(C){return x("bool:"+C.toString())},_string:function(C){x("string:"+C.length+":"),x(C.toString())},_function:function(C){x("fn:"),b(C)?this.dispatch("[native]"):this.dispatch(C.toString()),M.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(C.name)),M.respectFunctionProperties&&this._object(C)},_number:function(C){return x("number:"+C.toString())},_xml:function(C){return x("xml:"+C.toString())},_null:function(){return x("Null")},_undefined:function(){return x("Undefined")},_regexp:function(C){return x("regex:"+C.toString())},_uint8array:function(C){return x("uint8array:"),this.dispatch(Array.prototype.slice.call(C))},_uint8clampedarray:function(C){return x("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(C))},_int8array:function(C){return x("int8array:"),this.dispatch(Array.prototype.slice.call(C))},_uint16array:function(C){return x("uint16array:"),this.dispatch(Array.prototype.slice.call(C))},_int16array:function(C){return x("int16array:"),this.dispatch(Array.prototype.slice.call(C))},_uint32array:function(C){return x("uint32array:"),this.dispatch(Array.prototype.slice.call(C))},_int32array:function(C){return x("int32array:"),this.dispatch(Array.prototype.slice.call(C))},_float32array:function(C){return x("float32array:"),this.dispatch(Array.prototype.slice.call(C))},_float64array:function(C){return x("float64array:"),this.dispatch(Array.prototype.slice.call(C))},_arraybuffer:function(C){return x("arraybuffer:"),this.dispatch(new Uint8Array(C))},_url:function(C){return x("url:"+C.toString())},_map:function(C){return x("map:"),C=Array.from(C),this._array(C,M.unorderedSets!==!1)},_set:function(C){return x("set:"),C=Array.from(C),this._array(C,M.unorderedSets!==!1)},_file:function(C){return x("file:"),this.dispatch([C.name,C.size,C.type,C.lastModfied])},_blob:function(){if(M.ignoreUnknown)return x("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return x("domwindow")},_bigint:function(C){return x("bigint:"+C.toString())},_process:function(){return x("process")},_timer:function(){return x("timer")},_pipe:function(){return x("pipe")},_tcp:function(){return x("tcp")},_udp:function(){return x("udp")},_tty:function(){return x("tty")},_statwatcher:function(){return x("statwatcher")},_securecontext:function(){return x("securecontext")},_connection:function(){return x("connection")},_zlib:function(){return x("zlib")},_context:function(){return x("context")},_nodescript:function(){return x("nodescript")},_httpparser:function(){return x("httpparser")},_dataview:function(){return x("dataview")},_signal:function(){return x("signal")},_fsevent:function(){return x("fsevent")},_tlswrap:function(){return x("tlswrap")}}}function A(){return{buf:"",write:function(M){this.buf+=M},end:function(M){this.buf+=M},read:function(){return this.buf}}}i.writeToStream=function(M,k,O){return O===void 0&&(O=k,k={}),E(k=w(M,k),O).dispatch(M)}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(r,n,i){(function(o,a,s,l,u,c,f,h,d){(function(p){var m=typeof Uint8Array<"u"?Uint8Array:Array,g="+".charCodeAt(0),v="/".charCodeAt(0),w="0".charCodeAt(0),b="a".charCodeAt(0),E="A".charCodeAt(0),A="-".charCodeAt(0),M="_".charCodeAt(0);function k(O){return O=O.charCodeAt(0),O===g||O===A?62:O===v||O===M?63:O<w?-1:O<w+10?O-w+26+26:O<E+26?O-E:O<b+26?O-b+26:void 0}p.toByteArray=function(O){var x,C;if(0<O.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var I=O.length,I=O.charAt(I-2)==="="?2:O.charAt(I-1)==="="?1:0,H=new m(3*O.length/4-I),j=0<I?O.length-4:O.length,q=0;function Z(ne){H[q++]=ne}for(x=0;x<j;x+=4,0)Z((16711680&(C=k(O.charAt(x))<<18|k(O.charAt(x+1))<<12|k(O.charAt(x+2))<<6|k(O.charAt(x+3))))>>16),Z((65280&C)>>8),Z(255&C);return I==2?Z(255&(C=k(O.charAt(x))<<2|k(O.charAt(x+1))>>4)):I==1&&(Z((C=k(O.charAt(x))<<10|k(O.charAt(x+1))<<4|k(O.charAt(x+2))>>2)>>8&255),Z(255&C)),H},p.fromByteArray=function(O){var x,C,I,H,j=O.length%3,q="";function Z(ne){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(ne)}for(x=0,I=O.length-j;x<I;x+=3)C=(O[x]<<16)+(O[x+1]<<8)+O[x+2],q+=Z((H=C)>>18&63)+Z(H>>12&63)+Z(H>>6&63)+Z(63&H);switch(j){case 1:q=(q+=Z((C=O[O.length-1])>>2))+Z(C<<4&63)+"==";break;case 2:q=(q=(q+=Z((C=(O[O.length-2]<<8)+O[O.length-1])>>10))+Z(C>>4&63))+Z(C<<2&63)+"="}return q}})(i===void 0?this.base64js={}:i)}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(r,n,i){(function(o,a,g,l,u,c,f,h,d){var p=r("base64-js"),m=r("ieee754");function g(T,D,z){if(!(this instanceof g))return new g(T,D,z);var K,le,X,we,Ce=typeof T;if(D==="base64"&&Ce=="string")for(T=(we=T).trim?we.trim():we.replace(/^\s+|\s+$/g,"");T.length%4!=0;)T+="=";if(Ce=="number")K=P(T);else if(Ce=="string")K=g.byteLength(T,D);else{if(Ce!="object")throw new Error("First argument needs to be a number, array or string.");K=P(T.length)}if(g._useTypedArrays?le=g._augment(new Uint8Array(K)):((le=this).length=K,le._isBuffer=!0),g._useTypedArrays&&typeof T.byteLength=="number")le._set(T);else if(y(we=T)||g.isBuffer(we)||we&&typeof we=="object"&&typeof we.length=="number")for(X=0;X<K;X++)g.isBuffer(T)?le[X]=T.readUInt8(X):le[X]=T[X];else if(Ce=="string")le.write(T,0,D);else if(Ce=="number"&&!g._useTypedArrays&&!z)for(X=0;X<K;X++)le[X]=0;return le}function v(T,D,z,K){return g._charsWritten=B(function(le){for(var X=[],we=0;we<le.length;we++)X.push(255&le.charCodeAt(we));return X}(D),T,z,K)}function w(T,D,z,K){return g._charsWritten=B(function(le){for(var X,we,Ce=[],Ee=0;Ee<le.length;Ee++)we=le.charCodeAt(Ee),X=we>>8,we=we%256,Ce.push(we),Ce.push(X);return Ce}(D),T,z,K)}function b(T,D,z){var K="";z=Math.min(T.length,z);for(var le=D;le<z;le++)K+=String.fromCharCode(T[le]);return K}function E(T,D,z,X){X||(re(typeof z=="boolean","missing or invalid endian"),re(D!=null,"missing offset"),re(D+1<T.length,"Trying to read beyond buffer length"));var le,X=T.length;if(!(X<=D))return z?(le=T[D],D+1<X&&(le|=T[D+1]<<8)):(le=T[D]<<8,D+1<X&&(le|=T[D+1])),le}function A(T,D,z,X){X||(re(typeof z=="boolean","missing or invalid endian"),re(D!=null,"missing offset"),re(D+3<T.length,"Trying to read beyond buffer length"));var le,X=T.length;if(!(X<=D))return z?(D+2<X&&(le=T[D+2]<<16),D+1<X&&(le|=T[D+1]<<8),le|=T[D],D+3<X&&(le+=T[D+3]<<24>>>0)):(D+1<X&&(le=T[D+1]<<16),D+2<X&&(le|=T[D+2]<<8),D+3<X&&(le|=T[D+3]),le+=T[D]<<24>>>0),le}function M(T,D,z,K){if(K||(re(typeof z=="boolean","missing or invalid endian"),re(D!=null,"missing offset"),re(D+1<T.length,"Trying to read beyond buffer length")),!(T.length<=D))return K=E(T,D,z,!0),32768&K?-1*(65535-K+1):K}function k(T,D,z,K){if(K||(re(typeof z=="boolean","missing or invalid endian"),re(D!=null,"missing offset"),re(D+3<T.length,"Trying to read beyond buffer length")),!(T.length<=D))return K=A(T,D,z,!0),2147483648&K?-1*(4294967295-K+1):K}function O(T,D,z,K){return K||(re(typeof z=="boolean","missing or invalid endian"),re(D+3<T.length,"Trying to read beyond buffer length")),m.read(T,D,z,23,4)}function x(T,D,z,K){return K||(re(typeof z=="boolean","missing or invalid endian"),re(D+7<T.length,"Trying to read beyond buffer length")),m.read(T,D,z,52,8)}function C(T,D,z,K,le){if(le||(re(D!=null,"missing value"),re(typeof K=="boolean","missing or invalid endian"),re(z!=null,"missing offset"),re(z+1<T.length,"trying to write beyond buffer length"),ee(D,65535)),le=T.length,!(le<=z))for(var X=0,we=Math.min(le-z,2);X<we;X++)T[z+X]=(D&255<<8*(K?X:1-X))>>>8*(K?X:1-X)}function I(T,D,z,K,le){if(le||(re(D!=null,"missing value"),re(typeof K=="boolean","missing or invalid endian"),re(z!=null,"missing offset"),re(z+3<T.length,"trying to write beyond buffer length"),ee(D,4294967295)),le=T.length,!(le<=z))for(var X=0,we=Math.min(le-z,4);X<we;X++)T[z+X]=D>>>8*(K?X:3-X)&255}function H(T,D,z,K,le){le||(re(D!=null,"missing value"),re(typeof K=="boolean","missing or invalid endian"),re(z!=null,"missing offset"),re(z+1<T.length,"Trying to write beyond buffer length"),J(D,32767,-32768)),T.length<=z||C(T,0<=D?D:65535+D+1,z,K,le)}function j(T,D,z,K,le){le||(re(D!=null,"missing value"),re(typeof K=="boolean","missing or invalid endian"),re(z!=null,"missing offset"),re(z+3<T.length,"Trying to write beyond buffer length"),J(D,2147483647,-2147483648)),T.length<=z||I(T,0<=D?D:4294967295+D+1,z,K,le)}function q(T,D,z,K,le){le||(re(D!=null,"missing value"),re(typeof K=="boolean","missing or invalid endian"),re(z!=null,"missing offset"),re(z+3<T.length,"Trying to write beyond buffer length"),he(D,34028234663852886e22,-34028234663852886e22)),T.length<=z||m.write(T,D,z,K,23,4)}function Z(T,D,z,K,le){le||(re(D!=null,"missing value"),re(typeof K=="boolean","missing or invalid endian"),re(z!=null,"missing offset"),re(z+7<T.length,"Trying to write beyond buffer length"),he(D,17976931348623157e292,-17976931348623157e292)),T.length<=z||m.write(T,D,z,K,52,8)}i.Buffer=g,i.SlowBuffer=g,i.INSPECT_MAX_BYTES=50,g.poolSize=8192,g._useTypedArrays=function(){try{var T=new ArrayBuffer(0),D=new Uint8Array(T);return D.foo=function(){return 42},D.foo()===42&&typeof D.subarray=="function"}catch{return!1}}(),g.isEncoding=function(T){switch(String(T).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},g.isBuffer=function(T){return!(T==null||!T._isBuffer)},g.byteLength=function(T,D){var z;switch(T+="",D||"utf8"){case"hex":z=T.length/2;break;case"utf8":case"utf-8":z=_(T).length;break;case"ascii":case"binary":case"raw":z=T.length;break;case"base64":z=$(T).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":z=2*T.length;break;default:throw new Error("Unknown encoding")}return z},g.concat=function(T,D){if(re(y(T),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),T.length===0)return new g(0);if(T.length===1)return T[0];if(typeof D!="number")for(le=D=0;le<T.length;le++)D+=T[le].length;for(var z=new g(D),K=0,le=0;le<T.length;le++){var X=T[le];X.copy(z,K),K+=X.length}return z},g.prototype.write=function(T,D,z,K){isFinite(D)?isFinite(z)||(K=z,z=void 0):(Ee=K,K=D,D=z,z=Ee),D=Number(D)||0;var le,X,we,Ce,Ee=this.length-D;switch((!z||Ee<(z=Number(z)))&&(z=Ee),K=String(K||"utf8").toLowerCase()){case"hex":le=function(Te,Oe,F,U){F=Number(F)||0;var Y=Te.length-F;(!U||Y<(U=Number(U)))&&(U=Y),re((Y=Oe.length)%2==0,"Invalid hex string"),Y/2<U&&(U=Y/2);for(var fe=0;fe<U;fe++){var oe=parseInt(Oe.substr(2*fe,2),16);re(!isNaN(oe),"Invalid hex string"),Te[F+fe]=oe}return g._charsWritten=2*fe,fe}(this,T,D,z);break;case"utf8":case"utf-8":X=this,we=D,Ce=z,le=g._charsWritten=B(_(T),X,we,Ce);break;case"ascii":case"binary":le=v(this,T,D,z);break;case"base64":X=this,we=D,Ce=z,le=g._charsWritten=B($(T),X,we,Ce);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":le=w(this,T,D,z);break;default:throw new Error("Unknown encoding")}return le},g.prototype.toString=function(T,D,z){var K,le,X,we,Ce=this;if(T=String(T||"utf8").toLowerCase(),D=Number(D)||0,(z=z!==void 0?Number(z):Ce.length)===D)return"";switch(T){case"hex":K=function(Ee,Te,Oe){var F=Ee.length;(!Te||Te<0)&&(Te=0),(!Oe||Oe<0||F<Oe)&&(Oe=F);for(var U="",Y=Te;Y<Oe;Y++)U+=R(Ee[Y]);return U}(Ce,D,z);break;case"utf8":case"utf-8":K=function(Ee,Te,Oe){var F="",U="";Oe=Math.min(Ee.length,Oe);for(var Y=Te;Y<Oe;Y++)Ee[Y]<=127?(F+=W(U)+String.fromCharCode(Ee[Y]),U=""):U+="%"+Ee[Y].toString(16);return F+W(U)}(Ce,D,z);break;case"ascii":case"binary":K=b(Ce,D,z);break;case"base64":le=Ce,we=z,K=(X=D)===0&&we===le.length?p.fromByteArray(le):p.fromByteArray(le.slice(X,we));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":K=function(Ee,Te,Oe){for(var F=Ee.slice(Te,Oe),U="",Y=0;Y<F.length;Y+=2)U+=String.fromCharCode(F[Y]+256*F[Y+1]);return U}(Ce,D,z);break;default:throw new Error("Unknown encoding")}return K},g.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},g.prototype.copy=function(T,D,z,K){if(D=D||0,(K=K||K===0?K:this.length)!==(z=z||0)&&T.length!==0&&this.length!==0){re(z<=K,"sourceEnd < sourceStart"),re(0<=D&&D<T.length,"targetStart out of bounds"),re(0<=z&&z<this.length,"sourceStart out of bounds"),re(0<=K&&K<=this.length,"sourceEnd out of bounds"),K>this.length&&(K=this.length);var le=(K=T.length-D<K-z?T.length-D+z:K)-z;if(le<100||!g._useTypedArrays)for(var X=0;X<le;X++)T[X+D]=this[X+z];else T._set(this.subarray(z,z+le),D)}},g.prototype.slice=function(T,D){var z=this.length;if(T=ie(T,z,0),D=ie(D,z,z),g._useTypedArrays)return g._augment(this.subarray(T,D));for(var K=D-T,le=new g(K,void 0,!0),X=0;X<K;X++)le[X]=this[X+T];return le},g.prototype.get=function(T){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(T)},g.prototype.set=function(T,D){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(T,D)},g.prototype.readUInt8=function(T,D){if(D||(re(T!=null,"missing offset"),re(T<this.length,"Trying to read beyond buffer length")),!(T>=this.length))return this[T]},g.prototype.readUInt16LE=function(T,D){return E(this,T,!0,D)},g.prototype.readUInt16BE=function(T,D){return E(this,T,!1,D)},g.prototype.readUInt32LE=function(T,D){return A(this,T,!0,D)},g.prototype.readUInt32BE=function(T,D){return A(this,T,!1,D)},g.prototype.readInt8=function(T,D){if(D||(re(T!=null,"missing offset"),re(T<this.length,"Trying to read beyond buffer length")),!(T>=this.length))return 128&this[T]?-1*(255-this[T]+1):this[T]},g.prototype.readInt16LE=function(T,D){return M(this,T,!0,D)},g.prototype.readInt16BE=function(T,D){return M(this,T,!1,D)},g.prototype.readInt32LE=function(T,D){return k(this,T,!0,D)},g.prototype.readInt32BE=function(T,D){return k(this,T,!1,D)},g.prototype.readFloatLE=function(T,D){return O(this,T,!0,D)},g.prototype.readFloatBE=function(T,D){return O(this,T,!1,D)},g.prototype.readDoubleLE=function(T,D){return x(this,T,!0,D)},g.prototype.readDoubleBE=function(T,D){return x(this,T,!1,D)},g.prototype.writeUInt8=function(T,D,z){z||(re(T!=null,"missing value"),re(D!=null,"missing offset"),re(D<this.length,"trying to write beyond buffer length"),ee(T,255)),D>=this.length||(this[D]=T)},g.prototype.writeUInt16LE=function(T,D,z){C(this,T,D,!0,z)},g.prototype.writeUInt16BE=function(T,D,z){C(this,T,D,!1,z)},g.prototype.writeUInt32LE=function(T,D,z){I(this,T,D,!0,z)},g.prototype.writeUInt32BE=function(T,D,z){I(this,T,D,!1,z)},g.prototype.writeInt8=function(T,D,z){z||(re(T!=null,"missing value"),re(D!=null,"missing offset"),re(D<this.length,"Trying to write beyond buffer length"),J(T,127,-128)),D>=this.length||(0<=T?this.writeUInt8(T,D,z):this.writeUInt8(255+T+1,D,z))},g.prototype.writeInt16LE=function(T,D,z){H(this,T,D,!0,z)},g.prototype.writeInt16BE=function(T,D,z){H(this,T,D,!1,z)},g.prototype.writeInt32LE=function(T,D,z){j(this,T,D,!0,z)},g.prototype.writeInt32BE=function(T,D,z){j(this,T,D,!1,z)},g.prototype.writeFloatLE=function(T,D,z){q(this,T,D,!0,z)},g.prototype.writeFloatBE=function(T,D,z){q(this,T,D,!1,z)},g.prototype.writeDoubleLE=function(T,D,z){Z(this,T,D,!0,z)},g.prototype.writeDoubleBE=function(T,D,z){Z(this,T,D,!1,z)},g.prototype.fill=function(T,D,z){if(D=D||0,z=z||this.length,re(typeof(T=typeof(T=T||0)=="string"?T.charCodeAt(0):T)=="number"&&!isNaN(T),"value is not a number"),re(D<=z,"end < start"),z!==D&&this.length!==0){re(0<=D&&D<this.length,"start out of bounds"),re(0<=z&&z<=this.length,"end out of bounds");for(var K=D;K<z;K++)this[K]=T}},g.prototype.inspect=function(){for(var T=[],D=this.length,z=0;z<D;z++)if(T[z]=R(this[z]),z===i.INSPECT_MAX_BYTES){T[z+1]="...";break}return"<Buffer "+T.join(" ")+">"},g.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(g._useTypedArrays)return new g(this).buffer;for(var T=new Uint8Array(this.length),D=0,z=T.length;D<z;D+=1)T[D]=this[D];return T.buffer};var ne=g.prototype;function ie(T,D,z){return typeof T!="number"?z:D<=(T=~~T)?D:0<=T||0<=(T+=D)?T:0}function P(T){return(T=~~Math.ceil(+T))<0?0:T}function y(T){return(Array.isArray||function(D){return Object.prototype.toString.call(D)==="[object Array]"})(T)}function R(T){return T<16?"0"+T.toString(16):T.toString(16)}function _(T){for(var D=[],z=0;z<T.length;z++){var K=T.charCodeAt(z);if(K<=127)D.push(T.charCodeAt(z));else for(var le=z,X=(55296<=K&&K<=57343&&z++,encodeURIComponent(T.slice(le,z+1)).substr(1).split("%")),we=0;we<X.length;we++)D.push(parseInt(X[we],16))}return D}function $(T){return p.toByteArray(T)}function B(T,D,z,K){for(var le=0;le<K&&!(le+z>=D.length||le>=T.length);le++)D[le+z]=T[le];return le}function W(T){try{return decodeURIComponent(T)}catch{return String.fromCharCode(65533)}}function ee(T,D){re(typeof T=="number","cannot write a non-number as a number"),re(0<=T,"specified a negative value for writing an unsigned value"),re(T<=D,"value is larger than maximum value for type"),re(Math.floor(T)===T,"value has a fractional component")}function J(T,D,z){re(typeof T=="number","cannot write a non-number as a number"),re(T<=D,"value larger than maximum allowed value"),re(z<=T,"value smaller than minimum allowed value"),re(Math.floor(T)===T,"value has a fractional component")}function he(T,D,z){re(typeof T=="number","cannot write a non-number as a number"),re(T<=D,"value larger than maximum allowed value"),re(z<=T,"value smaller than minimum allowed value")}function re(T,D){if(!T)throw new Error(D||"Failed assertion")}g._augment=function(T){return T._isBuffer=!0,T._get=T.get,T._set=T.set,T.get=ne.get,T.set=ne.set,T.write=ne.write,T.toString=ne.toString,T.toLocaleString=ne.toString,T.toJSON=ne.toJSON,T.copy=ne.copy,T.slice=ne.slice,T.readUInt8=ne.readUInt8,T.readUInt16LE=ne.readUInt16LE,T.readUInt16BE=ne.readUInt16BE,T.readUInt32LE=ne.readUInt32LE,T.readUInt32BE=ne.readUInt32BE,T.readInt8=ne.readInt8,T.readInt16LE=ne.readInt16LE,T.readInt16BE=ne.readInt16BE,T.readInt32LE=ne.readInt32LE,T.readInt32BE=ne.readInt32BE,T.readFloatLE=ne.readFloatLE,T.readFloatBE=ne.readFloatBE,T.readDoubleLE=ne.readDoubleLE,T.readDoubleBE=ne.readDoubleBE,T.writeUInt8=ne.writeUInt8,T.writeUInt16LE=ne.writeUInt16LE,T.writeUInt16BE=ne.writeUInt16BE,T.writeUInt32LE=ne.writeUInt32LE,T.writeUInt32BE=ne.writeUInt32BE,T.writeInt8=ne.writeInt8,T.writeInt16LE=ne.writeInt16LE,T.writeInt16BE=ne.writeInt16BE,T.writeInt32LE=ne.writeInt32LE,T.writeInt32BE=ne.writeInt32BE,T.writeFloatLE=ne.writeFloatLE,T.writeFloatBE=ne.writeFloatBE,T.writeDoubleLE=ne.writeDoubleLE,T.writeDoubleBE=ne.writeDoubleBE,T.fill=ne.fill,T.inspect=ne.inspect,T.toArrayBuffer=ne.toArrayBuffer,T}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(r,n,i){(function(o,a,p,l,u,c,f,h,d){var p=r("buffer").Buffer,m=4,g=new p(m);g.fill(0),n.exports={hash:function(v,w,b,E){for(var A=w(function(C,I){C.length%m!=0&&(H=C.length+(m-C.length%m),C=p.concat([C,g],H));for(var H,j=[],q=I?C.readInt32BE:C.readInt32LE,Z=0;Z<C.length;Z+=m)j.push(q.call(C,Z));return j}(v=p.isBuffer(v)?v:new p(v),E),8*v.length),w=E,M=new p(b),k=w?M.writeInt32BE:M.writeInt32LE,O=0;O<A.length;O++)k.call(M,A[O],4*O,!0);return M}}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(r,n,i){(function(o,a,p,l,u,c,f,h,d){var p=r("buffer").Buffer,m=r("./sha"),g=r("./sha256"),v=r("./rng"),w={sha1:m,sha256:g,md5:r("./md5")},b=64,E=new p(b);function A(C,I){var H=w[C=C||"sha1"],j=[];return H||M("algorithm:",C,"is not yet supported"),{update:function(q){return p.isBuffer(q)||(q=new p(q)),j.push(q),q.length,this},digest:function(q){var Z=p.concat(j),Z=I?function(ne,ie,P){p.isBuffer(ie)||(ie=new p(ie)),p.isBuffer(P)||(P=new p(P)),ie.length>b?ie=ne(ie):ie.length<b&&(ie=p.concat([ie,E],b));for(var y=new p(b),R=new p(b),_=0;_<b;_++)y[_]=54^ie[_],R[_]=92^ie[_];return P=ne(p.concat([y,P])),ne(p.concat([R,P]))}(H,I,Z):H(Z);return j=null,q?Z.toString(q):Z}}}function M(){var C=[].slice.call(arguments).join(" ");throw new Error([C,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}E.fill(0),i.createHash=function(C){return A(C)},i.createHmac=A,i.randomBytes=function(C,I){if(!I||!I.call)return new p(v(C));try{I.call(this,void 0,new p(v(C)))}catch(H){I(H)}};var k,O=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],x=function(C){i[C]=function(){M("sorry,",C,"is not implemented yet")}};for(k in O)x(O[k])}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(r,n,i){(function(o,a,s,l,u,c,f,h,d){var p=r("./helpers");function m(M,k){M[k>>5]|=128<<k%32,M[14+(k+64>>>9<<4)]=k;for(var O=1732584193,x=-271733879,C=-1732584194,I=271733878,H=0;H<M.length;H+=16){var j=O,q=x,Z=C,ne=I,O=v(O,x,C,I,M[H+0],7,-680876936),I=v(I,O,x,C,M[H+1],12,-389564586),C=v(C,I,O,x,M[H+2],17,606105819),x=v(x,C,I,O,M[H+3],22,-1044525330);O=v(O,x,C,I,M[H+4],7,-176418897),I=v(I,O,x,C,M[H+5],12,1200080426),C=v(C,I,O,x,M[H+6],17,-1473231341),x=v(x,C,I,O,M[H+7],22,-45705983),O=v(O,x,C,I,M[H+8],7,1770035416),I=v(I,O,x,C,M[H+9],12,-1958414417),C=v(C,I,O,x,M[H+10],17,-42063),x=v(x,C,I,O,M[H+11],22,-1990404162),O=v(O,x,C,I,M[H+12],7,1804603682),I=v(I,O,x,C,M[H+13],12,-40341101),C=v(C,I,O,x,M[H+14],17,-1502002290),O=w(O,x=v(x,C,I,O,M[H+15],22,1236535329),C,I,M[H+1],5,-165796510),I=w(I,O,x,C,M[H+6],9,-1069501632),C=w(C,I,O,x,M[H+11],14,643717713),x=w(x,C,I,O,M[H+0],20,-373897302),O=w(O,x,C,I,M[H+5],5,-701558691),I=w(I,O,x,C,M[H+10],9,38016083),C=w(C,I,O,x,M[H+15],14,-660478335),x=w(x,C,I,O,M[H+4],20,-405537848),O=w(O,x,C,I,M[H+9],5,568446438),I=w(I,O,x,C,M[H+14],9,-1019803690),C=w(C,I,O,x,M[H+3],14,-187363961),x=w(x,C,I,O,M[H+8],20,1163531501),O=w(O,x,C,I,M[H+13],5,-1444681467),I=w(I,O,x,C,M[H+2],9,-51403784),C=w(C,I,O,x,M[H+7],14,1735328473),O=b(O,x=w(x,C,I,O,M[H+12],20,-1926607734),C,I,M[H+5],4,-378558),I=b(I,O,x,C,M[H+8],11,-2022574463),C=b(C,I,O,x,M[H+11],16,1839030562),x=b(x,C,I,O,M[H+14],23,-35309556),O=b(O,x,C,I,M[H+1],4,-1530992060),I=b(I,O,x,C,M[H+4],11,1272893353),C=b(C,I,O,x,M[H+7],16,-155497632),x=b(x,C,I,O,M[H+10],23,-1094730640),O=b(O,x,C,I,M[H+13],4,681279174),I=b(I,O,x,C,M[H+0],11,-358537222),C=b(C,I,O,x,M[H+3],16,-722521979),x=b(x,C,I,O,M[H+6],23,76029189),O=b(O,x,C,I,M[H+9],4,-640364487),I=b(I,O,x,C,M[H+12],11,-421815835),C=b(C,I,O,x,M[H+15],16,530742520),O=E(O,x=b(x,C,I,O,M[H+2],23,-995338651),C,I,M[H+0],6,-198630844),I=E(I,O,x,C,M[H+7],10,1126891415),C=E(C,I,O,x,M[H+14],15,-1416354905),x=E(x,C,I,O,M[H+5],21,-57434055),O=E(O,x,C,I,M[H+12],6,1700485571),I=E(I,O,x,C,M[H+3],10,-1894986606),C=E(C,I,O,x,M[H+10],15,-1051523),x=E(x,C,I,O,M[H+1],21,-2054922799),O=E(O,x,C,I,M[H+8],6,1873313359),I=E(I,O,x,C,M[H+15],10,-30611744),C=E(C,I,O,x,M[H+6],15,-1560198380),x=E(x,C,I,O,M[H+13],21,1309151649),O=E(O,x,C,I,M[H+4],6,-145523070),I=E(I,O,x,C,M[H+11],10,-1120210379),C=E(C,I,O,x,M[H+2],15,718787259),x=E(x,C,I,O,M[H+9],21,-343485551),O=A(O,j),x=A(x,q),C=A(C,Z),I=A(I,ne)}return Array(O,x,C,I)}function g(M,k,O,x,C,I){return A((k=A(A(k,M),A(x,I)))<<C|k>>>32-C,O)}function v(M,k,O,x,C,I,H){return g(k&O|~k&x,M,k,C,I,H)}function w(M,k,O,x,C,I,H){return g(k&x|O&~x,M,k,C,I,H)}function b(M,k,O,x,C,I,H){return g(k^O^x,M,k,C,I,H)}function E(M,k,O,x,C,I,H){return g(O^(k|~x),M,k,C,I,H)}function A(M,k){var O=(65535&M)+(65535&k);return(M>>16)+(k>>16)+(O>>16)<<16|65535&O}n.exports=function(M){return p.hash(M,m,16)}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(r,n,i){(function(o,a,s,l,u,c,f,h,d){n.exports=function(p){for(var m,g=new Array(p),v=0;v<p;v++)(3&v)==0&&(m=4294967296*Math.random()),g[v]=m>>>((3&v)<<3)&255;return g}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(r,n,i){(function(o,a,s,l,u,c,f,h,d){var p=r("./helpers");function m(w,b){w[b>>5]|=128<<24-b%32,w[15+(b+64>>9<<4)]=b;for(var E,A,M,k=Array(80),O=1732584193,x=-271733879,C=-1732584194,I=271733878,H=-1009589776,j=0;j<w.length;j+=16){for(var q=O,Z=x,ne=C,ie=I,P=H,y=0;y<80;y++){k[y]=y<16?w[j+y]:v(k[y-3]^k[y-8]^k[y-14]^k[y-16],1);var R=g(g(v(O,5),(R=x,A=C,M=I,(E=y)<20?R&A|~R&M:!(E<40)&&E<60?R&A|R&M|A&M:R^A^M)),g(g(H,k[y]),(E=y)<20?1518500249:E<40?1859775393:E<60?-1894007588:-899497514)),H=I,I=C,C=v(x,30),x=O,O=R}O=g(O,q),x=g(x,Z),C=g(C,ne),I=g(I,ie),H=g(H,P)}return Array(O,x,C,I,H)}function g(w,b){var E=(65535&w)+(65535&b);return(w>>16)+(b>>16)+(E>>16)<<16|65535&E}function v(w,b){return w<<b|w>>>32-b}n.exports=function(w){return p.hash(w,m,20,!0)}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(r,n,i){(function(o,a,s,l,u,c,f,h,d){function p(b,E){var A=(65535&b)+(65535&E);return(b>>16)+(E>>16)+(A>>16)<<16|65535&A}function m(b,E){var A,M=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),k=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),O=new Array(64);b[E>>5]|=128<<24-E%32,b[15+(E+64>>9<<4)]=E;for(var x,C,I=0;I<b.length;I+=16){for(var H=k[0],j=k[1],q=k[2],Z=k[3],ne=k[4],ie=k[5],P=k[6],y=k[7],R=0;R<64;R++)O[R]=R<16?b[R+I]:p(p(p((C=O[R-2],v(C,17)^v(C,19)^w(C,10)),O[R-7]),(C=O[R-15],v(C,7)^v(C,18)^w(C,3))),O[R-16]),A=p(p(p(p(y,v(C=ne,6)^v(C,11)^v(C,25)),ne&ie^~ne&P),M[R]),O[R]),x=p(v(x=H,2)^v(x,13)^v(x,22),H&j^H&q^j&q),y=P,P=ie,ie=ne,ne=p(Z,A),Z=q,q=j,j=H,H=p(A,x);k[0]=p(H,k[0]),k[1]=p(j,k[1]),k[2]=p(q,k[2]),k[3]=p(Z,k[3]),k[4]=p(ne,k[4]),k[5]=p(ie,k[5]),k[6]=p(P,k[6]),k[7]=p(y,k[7])}return k}var g=r("./helpers"),v=function(b,E){return b>>>E|b<<32-E},w=function(b,E){return b>>>E};n.exports=function(b){return g.hash(b,m,32,!0)}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(r,n,i){(function(o,a,s,l,u,c,f,h,d){i.read=function(p,m,g,v,I){var b,E,A=8*I-v-1,M=(1<<A)-1,k=M>>1,O=-7,x=g?I-1:0,C=g?-1:1,I=p[m+x];for(x+=C,b=I&(1<<-O)-1,I>>=-O,O+=A;0<O;b=256*b+p[m+x],x+=C,O-=8);for(E=b&(1<<-O)-1,b>>=-O,O+=v;0<O;E=256*E+p[m+x],x+=C,O-=8);if(b===0)b=1-k;else{if(b===M)return E?NaN:1/0*(I?-1:1);E+=Math.pow(2,v),b-=k}return(I?-1:1)*E*Math.pow(2,b-v)},i.write=function(p,m,g,v,w,H){var E,A,M=8*H-w-1,k=(1<<M)-1,O=k>>1,x=w===23?Math.pow(2,-24)-Math.pow(2,-77):0,C=v?0:H-1,I=v?1:-1,H=m<0||m===0&&1/m<0?1:0;for(m=Math.abs(m),isNaN(m)||m===1/0?(A=isNaN(m)?1:0,E=k):(E=Math.floor(Math.log(m)/Math.LN2),m*(v=Math.pow(2,-E))<1&&(E--,v*=2),2<=(m+=1<=E+O?x/v:x*Math.pow(2,1-O))*v&&(E++,v/=2),k<=E+O?(A=0,E=k):1<=E+O?(A=(m*v-1)*Math.pow(2,w),E+=O):(A=m*Math.pow(2,O-1)*Math.pow(2,w),E=0));8<=w;p[g+C]=255&A,C+=I,A/=256,w-=8);for(E=E<<w|A,M+=w;0<M;p[g+C]=255&E,C+=I,E/=256,M-=8);p[g+C-I]|=128*H}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(r,n,i){(function(o,a,s,l,u,c,f,h,d){var p,m,g;function v(){}(o=n.exports={}).nextTick=(m=typeof window<"u"&&window.setImmediate,g=typeof window<"u"&&window.postMessage&&window.addEventListener,m?function(w){return window.setImmediate(w)}:g?(p=[],window.addEventListener("message",function(w){var b=w.source;b!==window&&b!==null||w.data!=="process-tick"||(w.stopPropagation(),0<p.length&&p.shift()())},!0),function(w){p.push(w),window.postMessage("process-tick","*")}):function(w){setTimeout(w,0)}),o.title="browser",o.browser=!0,o.env={},o.argv=[],o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.binding=function(w){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(w){throw new Error("process.chdir is not supported")}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(Toe);const oSt=Toe.exports,E_=6,Rg="MMM YYYY",aSt=()=>{var r;const t=Io.exports.useLiveQuery(()=>Ba.expenditure.toArray(),[],[]),e=Uv(Io.exports.useLiveQuery(()=>Ba.recurring.where("start").belowOrEqual(At().unix()).toArray(),[],[]),((r=Io.exports.useLiveQuery(()=>Ba.expenditure.where({txn_type:dn.SALARY}).toArray(),[],[]))==null?void 0:r.map(n=>n.datetime)[0])||At().unix(),At().unix());return[...t,...e]};function C_({tags:t,dates:e,ALL_DB:r}){var n;return kb((n=kb(r))==null?void 0:n.sortBy(i=>i.datetime).map(i=>({...i,category:(()=>{try{return JSON.parse(i.category)}catch{return[]}})()})).filter(i=>i.category.every(o=>t.includes(o))&&e.includes(At.unix(i.datetime).format(Rg))).reduce((i,o)=>(o.category.forEach(a=>{a in i||(i[a]=[]),i[a].push(o)}),i),{})).toPairs().map(([i,o])=>({id:i,data:kb(o).groupBy(a=>At.unix(a.datetime).format(Rg)).toPairs().map(([a,s])=>({x:At(a,Rg).format("MMM"),y:s.reduce((l,u)=>Zi.exports.round(l+u.amount,2),0)})).value()})).value()}const mz=Math.pow(2,-52),Nb=new Uint32Array(512);class GS{static from(e,r=fSt,n=hSt){const i=e.length,o=new Float64Array(i*2);for(let a=0;a<i;a++){const s=e[a];o[2*a]=r(s),o[2*a+1]=n(s)}return new GS(o)}constructor(e){const r=e.length>>1;if(r>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*r-5,0);this._triangles=new Uint32Array(n*3),this._halfedges=new Int32Array(n*3),this._hashSize=Math.ceil(Math.sqrt(r)),this._hullPrev=new Uint32Array(r),this._hullNext=new Uint32Array(r),this._hullTri=new Uint32Array(r),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(r),this._dists=new Float64Array(r),this.update()}update(){const{coords:e,_hullPrev:r,_hullNext:n,_hullTri:i,_hullHash:o}=this,a=e.length>>1;let s=1/0,l=1/0,u=-1/0,c=-1/0;for(let C=0;C<a;C++){const I=e[2*C],H=e[2*C+1];I<s&&(s=I),H<l&&(l=H),I>u&&(u=I),H>c&&(c=H),this._ids[C]=C}const f=(s+u)/2,h=(l+c)/2;let d=1/0,p,m,g;for(let C=0;C<a;C++){const I=__(f,h,e[2*C],e[2*C+1]);I<d&&(p=C,d=I)}const v=e[2*p],w=e[2*p+1];d=1/0;for(let C=0;C<a;C++){if(C===p)continue;const I=__(v,w,e[2*C],e[2*C+1]);I<d&&I>0&&(m=C,d=I)}let b=e[2*m],E=e[2*m+1],A=1/0;for(let C=0;C<a;C++){if(C===p||C===m)continue;const I=uSt(v,w,b,E,e[2*C],e[2*C+1]);I<A&&(g=C,A=I)}let M=e[2*g],k=e[2*g+1];if(A===1/0){for(let H=0;H<a;H++)this._dists[H]=e[2*H]-e[0]||e[2*H+1]-e[1];Uf(this._ids,this._dists,0,a-1);const C=new Uint32Array(a);let I=0;for(let H=0,j=-1/0;H<a;H++){const q=this._ids[H];this._dists[q]>j&&(C[I++]=q,j=this._dists[q])}this.hull=C.subarray(0,I),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Pb(v,w,b,E,M,k)){const C=m,I=b,H=E;m=g,b=M,E=k,g=C,M=I,k=H}const O=cSt(v,w,b,E,M,k);this._cx=O.x,this._cy=O.y;for(let C=0;C<a;C++)this._dists[C]=__(e[2*C],e[2*C+1],O.x,O.y);Uf(this._ids,this._dists,0,a-1),this._hullStart=p;let x=3;n[p]=r[g]=m,n[m]=r[p]=g,n[g]=r[m]=p,i[p]=0,i[m]=1,i[g]=2,o.fill(-1),o[this._hashKey(v,w)]=p,o[this._hashKey(b,E)]=m,o[this._hashKey(M,k)]=g,this.trianglesLen=0,this._addTriangle(p,m,g,-1,-1,-1);for(let C=0,I,H;C<this._ids.length;C++){const j=this._ids[C],q=e[2*j],Z=e[2*j+1];if(C>0&&Math.abs(q-I)<=mz&&Math.abs(Z-H)<=mz||(I=q,H=Z,j===p||j===m||j===g))continue;let ne=0;for(let _=0,$=this._hashKey(q,Z);_<this._hashSize&&(ne=o[($+_)%this._hashSize],!(ne!==-1&&ne!==n[ne]));_++);ne=r[ne];let ie=ne,P;for(;P=n[ie],!Pb(q,Z,e[2*ie],e[2*ie+1],e[2*P],e[2*P+1]);)if(ie=P,ie===ne){ie=-1;break}if(ie===-1)continue;let y=this._addTriangle(ie,j,n[ie],-1,-1,i[ie]);i[j]=this._legalize(y+2),i[ie]=y,x++;let R=n[ie];for(;P=n[R],Pb(q,Z,e[2*R],e[2*R+1],e[2*P],e[2*P+1]);)y=this._addTriangle(R,j,P,i[j],-1,i[R]),i[j]=this._legalize(y+2),n[R]=R,x--,R=P;if(ie===ne)for(;P=r[ie],Pb(q,Z,e[2*P],e[2*P+1],e[2*ie],e[2*ie+1]);)y=this._addTriangle(P,j,ie,-1,i[ie],i[P]),this._legalize(y+2),i[P]=y,n[ie]=ie,x--,ie=P;this._hullStart=r[j]=ie,n[ie]=r[R]=j,n[j]=R,o[this._hashKey(q,Z)]=j,o[this._hashKey(e[2*ie],e[2*ie+1])]=ie}this.hull=new Uint32Array(x);for(let C=0,I=this._hullStart;C<x;C++)this.hull[C]=I,I=n[I];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,r){return Math.floor(sSt(e-this._cx,r-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:r,_halfedges:n,coords:i}=this;let o=0,a=0;for(;;){const s=n[e],l=e-e%3;if(a=l+(e+2)%3,s===-1){if(o===0)break;e=Nb[--o];continue}const u=s-s%3,c=l+(e+1)%3,f=u+(s+2)%3,h=r[a],d=r[e],p=r[c],m=r[f];if(lSt(i[2*h],i[2*h+1],i[2*d],i[2*d+1],i[2*p],i[2*p+1],i[2*m],i[2*m+1])){r[e]=m,r[s]=h;const v=n[f];if(v===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=e;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(e,v),this._link(s,n[a]),this._link(a,f);const w=u+(s+1)%3;o<Nb.length&&(Nb[o++]=w)}else{if(o===0)break;e=Nb[--o]}}return a}_link(e,r){this._halfedges[e]=r,r!==-1&&(this._halfedges[r]=e)}_addTriangle(e,r,n,i,o,a){const s=this.trianglesLen;return this._triangles[s]=e,this._triangles[s+1]=r,this._triangles[s+2]=n,this._link(s,i),this._link(s+1,o),this._link(s+2,a),this.trianglesLen+=3,s}}function sSt(t,e){const r=t/(Math.abs(t)+Math.abs(e));return(e>0?3-r:1+r)/4}function __(t,e,r,n){const i=t-r,o=e-n;return i*i+o*o}function T_(t,e,r,n,i,o){const a=(n-e)*(i-t),s=(r-t)*(o-e);return Math.abs(a-s)>=33306690738754716e-32*Math.abs(a+s)?a-s:0}function Pb(t,e,r,n,i,o){return(T_(i,o,t,e,r,n)||T_(t,e,r,n,i,o)||T_(r,n,i,o,t,e))<0}function lSt(t,e,r,n,i,o,a,s){const l=t-a,u=e-s,c=r-a,f=n-s,h=i-a,d=o-s,p=l*l+u*u,m=c*c+f*f,g=h*h+d*d;return l*(f*g-m*d)-u*(c*g-m*h)+p*(c*d-f*h)<0}function uSt(t,e,r,n,i,o){const a=r-t,s=n-e,l=i-t,u=o-e,c=a*a+s*s,f=l*l+u*u,h=.5/(a*u-s*l),d=(u*c-s*f)*h,p=(a*f-l*c)*h;return d*d+p*p}function cSt(t,e,r,n,i,o){const a=r-t,s=n-e,l=i-t,u=o-e,c=a*a+s*s,f=l*l+u*u,h=.5/(a*u-s*l),d=t+(u*c-s*f)*h,p=e+(a*f-l*c)*h;return{x:d,y:p}}function Uf(t,e,r,n){if(n-r<=20)for(let i=r+1;i<=n;i++){const o=t[i],a=e[o];let s=i-1;for(;s>=r&&e[t[s]]>a;)t[s+1]=t[s--];t[s+1]=o}else{const i=r+n>>1;let o=r+1,a=n;km(t,i,o),e[t[r]]>e[t[n]]&&km(t,r,n),e[t[o]]>e[t[n]]&&km(t,o,n),e[t[r]]>e[t[o]]&&km(t,r,o);const s=t[o],l=e[s];for(;;){do o++;while(e[t[o]]<l);do a--;while(e[t[a]]>l);if(a<o)break;km(t,o,a)}t[r+1]=t[a],t[a]=s,n-o+1>=a-r?(Uf(t,e,o,n),Uf(t,e,r,a-1)):(Uf(t,e,r,a-1),Uf(t,e,o,n))}}function km(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function fSt(t){return t[0]}function hSt(t){return t[1]}const gz=1e-6;class Du{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,r){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,r){this._+=`L${this._x1=+e},${this._y1=+r}`}arc(e,r,n){e=+e,r=+r,n=+n;const i=e+n,o=r;if(n<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${o}`:(Math.abs(this._x1-i)>gz||Math.abs(this._y1-o)>gz)&&(this._+="L"+i+","+o),n&&(this._+=`A${n},${n},0,1,1,${e-n},${r}A${n},${n},0,1,1,${this._x1=i},${this._y1=o}`)}rect(e,r,n,i){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${+n}v${+i}h${-n}Z`}value(){return this._||null}}class $4{constructor(){this._=[]}moveTo(e,r){this._.push([e,r])}closePath(){this._.push(this._[0].slice())}lineTo(e,r){this._.push([e,r])}value(){return this._.length?this._:null}}class dSt{constructor(e,[r,n,i,o]=[0,0,960,500]){if(!((i=+i)>=(r=+r))||!((o=+o)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=i,this.xmin=r,this.ymax=o,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:r,triangles:n},vectors:i}=this,o=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let d=0,p=0,m=n.length,g,v;d<m;d+=3,p+=2){const w=n[d]*2,b=n[d+1]*2,E=n[d+2]*2,A=e[w],M=e[w+1],k=e[b],O=e[b+1],x=e[E],C=e[E+1],I=k-A,H=O-M,j=x-A,q=C-M,Z=I*I+H*H,ne=j*j+q*q,ie=(I*q-H*j)*2;if(!ie)g=(A+x)/2-1e8*q,v=(M+C)/2+1e8*j;else if(Math.abs(ie)<1e-8)g=(A+x)/2,v=(M+C)/2;else{const P=1/ie;g=A+(q*Z-H*ne)*P,v=M+(I*ne-j*Z)*P}o[p]=g,o[p+1]=v}let a=r[r.length-1],s,l=a*4,u,c=e[2*a],f,h=e[2*a+1];i.fill(0);for(let d=0;d<r.length;++d)a=r[d],s=l,u=c,f=h,l=a*4,c=e[2*a],h=e[2*a+1],i[s+2]=i[l]=f-h,i[s+3]=i[l+1]=c-u}render(e){const r=e==null?e=new Du:void 0,{delaunay:{halfedges:n,inedges:i,hull:o},circumcenters:a,vectors:s}=this;if(o.length<=1)return null;for(let c=0,f=n.length;c<f;++c){const h=n[c];if(h<c)continue;const d=Math.floor(c/3)*2,p=Math.floor(h/3)*2,m=a[d],g=a[d+1],v=a[p],w=a[p+1];this._renderSegment(m,g,v,w,e)}let l,u=o[o.length-1];for(let c=0;c<o.length;++c){l=u,u=o[c];const f=Math.floor(i[u]/3)*2,h=a[f],d=a[f+1],p=l*4,m=this._project(h,d,s[p+2],s[p+3]);m&&this._renderSegment(h,d,m[0],m[1],e)}return r&&r.value()}renderBounds(e){const r=e==null?e=new Du:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),r&&r.value()}renderCell(e,r){const n=r==null?r=new Du:void 0,i=this._clip(e);if(i===null||!i.length)return;r.moveTo(i[0],i[1]);let o=i.length;for(;i[0]===i[o-2]&&i[1]===i[o-1]&&o>1;)o-=2;for(let a=2;a<o;a+=2)(i[a]!==i[a-2]||i[a+1]!==i[a-1])&&r.lineTo(i[a],i[a+1]);return r.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let r=0,n=e.length/2;r<n;++r){const i=this.cellPolygon(r);i&&(i.index=r,yield i)}}cellPolygon(e){const r=new $4;return this.renderCell(e,r),r.value()}_renderSegment(e,r,n,i,o){let a;const s=this._regioncode(e,r),l=this._regioncode(n,i);s===0&&l===0?(o.moveTo(e,r),o.lineTo(n,i)):(a=this._clipSegment(e,r,n,i,s,l))&&(o.moveTo(a[0],a[1]),o.lineTo(a[2],a[3]))}contains(e,r,n){return r=+r,r!==r||(n=+n,n!==n)?!1:this.delaunay._step(e,r,n)===e}*neighbors(e){const r=this._clip(e);if(r)for(const n of this.delaunay.neighbors(e)){const i=this._clip(n);if(i){e:for(let o=0,a=r.length;o<a;o+=2)for(let s=0,l=i.length;s<l;s+=2)if(r[o]==i[s]&&r[o+1]==i[s+1]&&r[(o+2)%a]==i[(s+l-2)%l]&&r[(o+3)%a]==i[(s+l-1)%l]){yield n;break e}}}}_cell(e){const{circumcenters:r,delaunay:{inedges:n,halfedges:i,triangles:o}}=this,a=n[e];if(a===-1)return null;const s=[];let l=a;do{const u=Math.floor(l/3);if(s.push(r[u*2],r[u*2+1]),l=l%3===2?l-2:l+1,o[l]!==e)break;l=i[l]}while(l!==a&&l!==-1);return s}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const r=this._cell(e);if(r===null)return null;const{vectors:n}=this,i=e*4;return n[i]||n[i+1]?this._clipInfinite(e,r,n[i],n[i+1],n[i+2],n[i+3]):this._clipFinite(e,r)}_clipFinite(e,r){const n=r.length;let i=null,o,a,s=r[n-2],l=r[n-1],u,c=this._regioncode(s,l),f,h;for(let d=0;d<n;d+=2)if(o=s,a=l,s=r[d],l=r[d+1],u=c,c=this._regioncode(s,l),u===0&&c===0)f=h,h=0,i?i.push(s,l):i=[s,l];else{let p,m,g,v,w;if(u===0){if((p=this._clipSegment(o,a,s,l,u,c))===null)continue;[m,g,v,w]=p}else{if((p=this._clipSegment(s,l,o,a,c,u))===null)continue;[v,w,m,g]=p,f=h,h=this._edgecode(m,g),f&&h&&this._edge(e,f,h,i,i.length),i?i.push(m,g):i=[m,g]}f=h,h=this._edgecode(v,w),f&&h&&this._edge(e,f,h,i,i.length),i?i.push(v,w):i=[v,w]}if(i)f=h,h=this._edgecode(i[0],i[1]),f&&h&&this._edge(e,f,h,i,i.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(e,r,n,i,o,a){for(;;){if(o===0&&a===0)return[e,r,n,i];if(o&a)return null;let s,l,u=o||a;u&8?(s=e+(n-e)*(this.ymax-r)/(i-r),l=this.ymax):u&4?(s=e+(n-e)*(this.ymin-r)/(i-r),l=this.ymin):u&2?(l=r+(i-r)*(this.xmax-e)/(n-e),s=this.xmax):(l=r+(i-r)*(this.xmin-e)/(n-e),s=this.xmin),o?(e=s,r=l,o=this._regioncode(e,r)):(n=s,i=l,a=this._regioncode(n,i))}}_clipInfinite(e,r,n,i,o,a){let s=Array.from(r),l;if((l=this._project(s[0],s[1],n,i))&&s.unshift(l[0],l[1]),(l=this._project(s[s.length-2],s[s.length-1],o,a))&&s.push(l[0],l[1]),s=this._clipFinite(e,s))for(let u=0,c=s.length,f,h=this._edgecode(s[c-2],s[c-1]);u<c;u+=2)f=h,h=this._edgecode(s[u],s[u+1]),f&&h&&(u=this._edge(e,f,h,s,u),c=s.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(e,r,n,i,o){for(;r!==n;){let a,s;switch(r){case 5:r=4;continue;case 4:r=6,a=this.xmax,s=this.ymin;break;case 6:r=2;continue;case 2:r=10,a=this.xmax,s=this.ymax;break;case 10:r=8;continue;case 8:r=9,a=this.xmin,s=this.ymax;break;case 9:r=1;continue;case 1:r=5,a=this.xmin,s=this.ymin;break}(i[o]!==a||i[o+1]!==s)&&this.contains(e,a,s)&&(i.splice(o,0,a,s),o+=2)}if(i.length>4)for(let a=0;a<i.length;a+=2){const s=(a+2)%i.length,l=(a+4)%i.length;(i[a]===i[s]&&i[s]===i[l]||i[a+1]===i[s+1]&&i[s+1]===i[l+1])&&(i.splice(s,2),a-=2)}return o}_project(e,r,n,i){let o=1/0,a,s,l;if(i<0){if(r<=this.ymin)return null;(a=(this.ymin-r)/i)<o&&(l=this.ymin,s=e+(o=a)*n)}else if(i>0){if(r>=this.ymax)return null;(a=(this.ymax-r)/i)<o&&(l=this.ymax,s=e+(o=a)*n)}if(n>0){if(e>=this.xmax)return null;(a=(this.xmax-e)/n)<o&&(s=this.xmax,l=r+(o=a)*i)}else if(n<0){if(e<=this.xmin)return null;(a=(this.xmin-e)/n)<o&&(s=this.xmin,l=r+(o=a)*i)}return[s,l]}_edgecode(e,r){return(e===this.xmin?1:e===this.xmax?2:0)|(r===this.ymin?4:r===this.ymax?8:0)}_regioncode(e,r){return(e<this.xmin?1:e>this.xmax?2:0)|(r<this.ymin?4:r>this.ymax?8:0)}}const pSt=2*Math.PI,Sf=Math.pow;function mSt(t){return t[0]}function gSt(t){return t[1]}function ySt(t){const{triangles:e,coords:r}=t;for(let n=0;n<e.length;n+=3){const i=2*e[n],o=2*e[n+1],a=2*e[n+2];if((r[a]-r[i])*(r[o+1]-r[i+1])-(r[o]-r[i])*(r[a+1]-r[i+1])>1e-10)return!1}return!0}function vSt(t,e,r){return[t+Math.sin(t+e)*r,e+Math.cos(t-e)*r]}class J9{static from(e,r=mSt,n=gSt,i){return new J9("length"in e?bSt(e,r,n,i):Float64Array.from(wSt(e,r,n,i)))}constructor(e){this._delaunator=new GS(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,r=this.points;if(e.hull&&e.hull.length>2&&ySt(e)){this.collinear=Int32Array.from({length:r.length/2},(h,d)=>d).sort((h,d)=>r[2*h]-r[2*d]||r[2*h+1]-r[2*d+1]);const l=this.collinear[0],u=this.collinear[this.collinear.length-1],c=[r[2*l],r[2*l+1],r[2*u],r[2*u+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let h=0,d=r.length/2;h<d;++h){const p=vSt(r[2*h],r[2*h+1],f);r[2*h]=p[0],r[2*h+1]=p[1]}this._delaunator=new GS(r)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let l=0,u=n.length;l<u;++l){const c=o[l%3===2?l-2:l+1];(n[l]===-1||a[c]===-1)&&(a[c]=l)}for(let l=0,u=i.length;l<u;++l)s[i[l]]=l;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],a[i[0]]=1,i.length===2&&(a[i[1]]=0))}voronoi(e){return new dSt(this,e)}*neighbors(e){const{inedges:r,hull:n,_hullIndex:i,halfedges:o,triangles:a,collinear:s}=this;if(s){const f=s.indexOf(e);f>0&&(yield s[f-1]),f<s.length-1&&(yield s[f+1]);return}const l=r[e];if(l===-1)return;let u=l,c=-1;do{if(yield c=a[u],u=u%3===2?u-2:u+1,a[u]!==e)return;if(u=o[u],u===-1){const f=n[(i[e]+1)%n.length];f!==c&&(yield f);return}}while(u!==l)}find(e,r,n=0){if(e=+e,e!==e||(r=+r,r!==r))return-1;const i=n;let o;for(;(o=this._step(n,e,r))>=0&&o!==n&&o!==i;)n=o;return o}_step(e,r,n){const{inedges:i,hull:o,_hullIndex:a,halfedges:s,triangles:l,points:u}=this;if(i[e]===-1||!u.length)return(e+1)%(u.length>>1);let c=e,f=Sf(r-u[e*2],2)+Sf(n-u[e*2+1],2);const h=i[e];let d=h;do{let p=l[d];const m=Sf(r-u[p*2],2)+Sf(n-u[p*2+1],2);if(m<f&&(f=m,c=p),d=d%3===2?d-2:d+1,l[d]!==e)break;if(d=s[d],d===-1){if(d=o[(a[e]+1)%o.length],d!==p&&Sf(r-u[d*2],2)+Sf(n-u[d*2+1],2)<f)return d;break}}while(d!==h);return c}render(e){const r=e==null?e=new Du:void 0,{points:n,halfedges:i,triangles:o}=this;for(let a=0,s=i.length;a<s;++a){const l=i[a];if(l<a)continue;const u=o[a]*2,c=o[l]*2;e.moveTo(n[u],n[u+1]),e.lineTo(n[c],n[c+1])}return this.renderHull(e),r&&r.value()}renderPoints(e,r=2){const n=e==null?e=new Du:void 0,{points:i}=this;for(let o=0,a=i.length;o<a;o+=2){const s=i[o],l=i[o+1];e.moveTo(s+r,l),e.arc(s,l,r,0,pSt)}return n&&n.value()}renderHull(e){const r=e==null?e=new Du:void 0,{hull:n,points:i}=this,o=n[0]*2,a=n.length;e.moveTo(i[o],i[o+1]);for(let s=1;s<a;++s){const l=2*n[s];e.lineTo(i[l],i[l+1])}return e.closePath(),r&&r.value()}hullPolygon(){const e=new $4;return this.renderHull(e),e.value()}renderTriangle(e,r){const n=r==null?r=new Du:void 0,{points:i,triangles:o}=this,a=o[e*=3]*2,s=o[e+1]*2,l=o[e+2]*2;return r.moveTo(i[a],i[a+1]),r.lineTo(i[s],i[s+1]),r.lineTo(i[l],i[l+1]),r.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:e}=this;for(let r=0,n=e.length/3;r<n;++r)yield this.trianglePolygon(r)}trianglePolygon(e){const r=new $4;return this.renderTriangle(e,r),r.value()}}function bSt(t,e,r,n){const i=t.length,o=new Float64Array(i*2);for(let a=0;a<i;++a){const s=t[a];o[a*2]=e.call(n,s,a,t),o[a*2+1]=r.call(n,s,a,t)}return o}function*wSt(t,e,r,n){let i=0;for(const o of t)yield e.call(n,o,i,t),yield r.call(n,o,i,t),++i}var yz=function(t){return typeof t=="function"?t:function(e){return e[t]}},SSt=function(t){var e=t.points,r=t.x,n=r===void 0?"x":r,i=t.y,o=i===void 0?"y":i,a=yz(n),s=yz(o);return e.map(function(l){return[a(l),s(l)]})},RSt=function(t){var e=t.points,r=t.width,n=t.height,i=t.debug,o=J9.from(e),a=i?o.voronoi([0,0,r,n]):void 0;return{delaunay:o,voronoi:a}},Ooe=function(t){var e=t.points,r=t.x,n=t.y,i=t.width,o=t.height,a=t.debug,s=ce.exports.useMemo(function(){return SSt({points:e,x:r,y:n})},[e,r,n]);return ce.exports.useMemo(function(){return RSt({points:s,width:i,height:o,debug:a})},[s,i,o,a])},ESt=function(t){var e=t.nodes,r=t.width,n=t.height,i=t.x,o=t.y,a=t.onMouseEnter,s=t.onMouseMove,l=t.onMouseLeave,u=t.onClick,c=t.debug,f=ce.exports.useRef(null),h=ce.exports.useState(null),d=h[0],p=h[1],m=Ooe({points:e,x:i,y:o,width:r,height:n,debug:c}),g=m.delaunay,v=m.voronoi,w=ce.exports.useMemo(function(){if(c&&v)return v.render()},[c,v]),b=ce.exports.useCallback(function(O){if(!f.current)return[null,null];var x=Sg(f.current,O),C=x[0],I=x[1],H=g.find(C,I);return[H,H!==void 0?e[H]:null]},[f,g]),E=ce.exports.useCallback(function(O){var x=b(O),C=x[0],I=x[1];p(C),I&&(a==null||a(I,O))},[b,p,a]),A=ce.exports.useCallback(function(O){var x=b(O),C=x[0],I=x[1];p(C),I&&(s==null||s(I,O))},[b,p,s]),M=ce.exports.useCallback(function(O){if(p(null),l){var x=void 0;d!==null&&(x=e[d]),x&&l(x,O)}},[p,d,l,e]),k=ce.exports.useCallback(function(O){var x=b(O),C=x[0],I=x[1];p(C),I&&(u==null||u(I,O))},[b,p,u]);return ye.jsxs("g",{ref:f,children:[c&&v&&ye.jsxs(ye.Fragment,{children:[ye.jsx("path",{d:w,stroke:"red",strokeWidth:1,opacity:.75}),d!==null&&ye.jsx("path",{fill:"pink",opacity:.35,d:v.renderCell(d)})]}),ye.jsx("rect",{width:r,height:n,fill:"red",opacity:0,style:{cursor:"auto"},onMouseEnter:E,onMouseMove:A,onMouseLeave:M,onClick:k})]})},CSt=function(t,e){t.save(),t.globalAlpha=.75,t.beginPath(),e.render(t),t.strokeStyle="red",t.lineWidth=1,t.stroke(),t.restore()},_St=function(t,e,r){t.save(),t.globalAlpha=.35,t.beginPath(),e.renderCell(r,t),t.fillStyle="red",t.fill(),t.restore()};function xn(){return xn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},xn.apply(this,arguments)}var Aoe=function(t){var e=t.point;return ye.jsx($re,{id:ye.jsxs("span",{children:["x: ",ye.jsx("strong",{children:e.data.xFormatted}),", y:"," ",ye.jsx("strong",{children:e.data.yFormatted})]}),enableChip:!0,color:e.serieColor})};Aoe.propTypes={point:N.exports.object.isRequired};var TSt=ce.exports.memo(Aoe),Ioe=function(t){var e=t.slice,r=t.axis,n=pr(),i=r==="x"?"y":"x";return ye.jsx(Lre,{rows:e.points.map(function(o){return[ye.jsx(kre,{color:o.serieColor,style:n.tooltip.chip},"chip"),o.serieId,ye.jsx("span",{style:n.tooltip.tableCellValue,children:o.data[i+"Formatted"]},"value")]})})};Ioe.propTypes={slice:N.exports.object.isRequired,axis:N.exports.oneOf(["x","y"]).isRequired};var OSt=ce.exports.memo(Ioe),xoe={data:N.exports.arrayOf(N.exports.shape({id:N.exports.oneOfType([N.exports.string,N.exports.number]).isRequired,data:N.exports.arrayOf(N.exports.shape({x:N.exports.oneOfType([N.exports.number,N.exports.string,N.exports.instanceOf(Date)]),y:N.exports.oneOfType([N.exports.number,N.exports.string,N.exports.instanceOf(Date)])})).isRequired})).isRequired,xScale:N.exports.object.isRequired,xFormat:N.exports.oneOfType([N.exports.func,N.exports.string]),yScale:N.exports.object.isRequired,yFormat:N.exports.oneOfType([N.exports.func,N.exports.string]),layers:N.exports.arrayOf(N.exports.oneOfType([N.exports.oneOf(["grid","markers","axes","areas","crosshair","lines","slices","points","mesh","legends"]),N.exports.func])).isRequired,curve:dvt.isRequired,axisTop:Ob,axisRight:Ob,axisBottom:Ob,axisLeft:Ob,enableGridX:N.exports.bool.isRequired,enableGridY:N.exports.bool.isRequired,gridXValues:N.exports.oneOfType([N.exports.number,N.exports.arrayOf(N.exports.oneOfType([N.exports.number,N.exports.string,N.exports.instanceOf(Date)]))]),gridYValues:N.exports.oneOfType([N.exports.number,N.exports.arrayOf(N.exports.oneOfType([N.exports.number,N.exports.string,N.exports.instanceOf(Date)]))]),enablePoints:N.exports.bool.isRequired,pointSymbol:N.exports.func,pointSize:N.exports.number.isRequired,pointColor:N.exports.any.isRequired,pointBorderWidth:N.exports.number.isRequired,pointBorderColor:N.exports.any.isRequired,enablePointLabel:N.exports.bool.isRequired,pointLabel:N.exports.oneOfType([N.exports.string,N.exports.func]).isRequired,markers:N.exports.arrayOf(N.exports.shape({axis:N.exports.oneOf(["x","y"]).isRequired,value:N.exports.oneOfType([N.exports.number,N.exports.string,N.exports.instanceOf(Date)]).isRequired,style:N.exports.object})),colors:iwt.isRequired,enableArea:N.exports.bool.isRequired,areaOpacity:N.exports.number.isRequired,areaBlendMode:z9.isRequired,areaBaselineValue:N.exports.oneOfType([N.exports.number,N.exports.string,N.exports.instanceOf(Date)]).isRequired,lineWidth:N.exports.number.isRequired,legends:N.exports.arrayOf(N.exports.shape(mwt)).isRequired,isInteractive:N.exports.bool.isRequired,debugMesh:N.exports.bool.isRequired,tooltip:N.exports.oneOfType([N.exports.func,N.exports.object]).isRequired,enableSlices:N.exports.oneOf(["x","y",!1]).isRequired,debugSlices:N.exports.bool.isRequired,sliceTooltip:N.exports.oneOfType([N.exports.func,N.exports.object]).isRequired,enableCrosshair:N.exports.bool.isRequired,crosshairType:N.exports.string.isRequired},ASt=xn({},xoe,{enablePointLabel:N.exports.bool.isRequired,role:N.exports.string.isRequired,useMesh:N.exports.bool.isRequired},Km,pvt),ISt=xn({pixelRatio:N.exports.number.isRequired},xoe),Moe={curve:"linear",xScale:{type:"point"},yScale:{type:"linear",min:0,max:"auto"},layers:["grid","markers","axes","areas","crosshair","lines","points","slices","mesh","legends"],axisBottom:{},axisLeft:{},enableGridX:!0,enableGridY:!0,enablePoints:!0,pointSize:6,pointColor:{from:"color"},pointBorderWidth:0,pointBorderColor:{theme:"background"},enablePointLabel:!1,pointLabel:"yFormatted",colors:{scheme:"nivo"},enableArea:!1,areaBaselineValue:0,areaOpacity:.2,areaBlendMode:"normal",lineWidth:2,legends:[],isInteractive:!0,tooltip:TSt,enableSlices:!1,debugSlices:!1,sliceTooltip:OSt,debugMesh:!1,enableCrosshair:!0,crosshairType:"bottom-left"},Ma=xn({},Moe,{enablePointLabel:!1,useMesh:!1,animate:!0,motionConfig:"gentle",defs:[],fill:[],role:"img"}),xSt=xn({},Moe,{pixelRatio:typeof window<"u"&&window.devicePixelRatio||1}),MSt=function(t){var e=t.curve;return ce.exports.useMemo(function(){return Gne().defined(function(r){return r.x!==null&&r.y!==null}).x(function(r){return r.x}).y(function(r){return r.y}).curve(uie(e))},[e])},NSt=function(t){var e=t.curve,r=t.yScale,n=t.areaBaselineValue;return ce.exports.useMemo(function(){return qgt().defined(function(i){return i.x!==null&&i.y!==null}).x(function(i){return i.x}).y1(function(i){return i.y}).curve(uie(e)).y0(r(n))},[e,r,n])},PSt=function(t){var e=t.enableSlices,r=t.points,n=t.width,i=t.height;return ce.exports.useMemo(function(){if(e===!1)return[];if(e==="x"){var o=new Map;return r.forEach(function(s){s.data.x!==null&&s.data.y!==null&&(o.has(s.x)?o.get(s.x).push(s):o.set(s.x,[s]))}),Array.from(o.entries()).sort(function(s,l){return s[0]-l[0]}).map(function(s,l,u){var c,f=s[0],h=s[1],d=u[l-1],p=u[l+1];return{id:f,x0:c=d?f-(f-d[0])/2:f,x:f,y0:0,y:0,width:p?f-c+(p[0]-f)/2:n-c,height:i,points:h.reverse()}})}if(e==="y"){var a=new Map;return r.forEach(function(s){s.data.x!==null&&s.data.y!==null&&(a.has(s.y)?a.get(s.y).push(s):a.set(s.y,[s]))}),Array.from(a.entries()).sort(function(s,l){return s[0]-l[0]}).map(function(s,l,u){var c,f,h=s[0],d=s[1],p=u[l-1],m=u[l+1];return c=p?h-(h-p[0])/2:h,f=m?h-c+(m[0]-h)/2:i-c,{id:h,x0:0,x:0,y0:c,y:h,width:n,height:f,points:d.reverse()}})}},[e,r])},Noe=function(t){var e=t.data,r=t.xScale,n=r===void 0?Ma.xScale:r,i=t.xFormat,o=t.yScale,a=o===void 0?Ma.yScale:o,s=t.yFormat,l=t.width,u=t.height,c=t.colors,f=c===void 0?Ma.colors:c,h=t.curve,d=h===void 0?Ma.curve:h,p=t.areaBaselineValue,m=p===void 0?Ma.areaBaselineValue:p,g=t.pointColor,v=g===void 0?Ma.pointColor:g,w=t.pointBorderColor,b=w===void 0?Ma.pointBorderColor:w,E=t.enableSlices,A=E===void 0?Ma.enableSlicesTooltip:E,M=BS(i),k=BS(s),O=poe(f,"id"),x=pr(),C=Ip(v,x),I=Ip(b,x),H=ce.exports.useState([]),j=H[0],q=H[1],Z=ce.exports.useMemo(function(){return v1t(e.filter(function(ee){return j.indexOf(ee.id)===-1}),n,a,l,u)},[e,j,n,a,l,u]),ne=Z.xScale,ie=Z.yScale,P=Z.series,y=ce.exports.useMemo(function(){var ee=e.map(function(he){return{id:he.id,label:he.id,color:O(he)}}),J=ee.map(function(he){return xn({},P.find(function(re){return re.id===he.id}),{color:he.color})}).filter(function(he){return Boolean(he.id)});return{legendData:ee.map(function(he){return xn({},he,{hidden:!J.find(function(re){return re.id===he.id})})}).reverse(),series:J}},[e,P,O]),R=y.legendData,_=y.series,$=ce.exports.useCallback(function(ee){q(function(J){return J.indexOf(ee)>-1?J.filter(function(he){return he!==ee}):[].concat(J,[ee])})},[]),B=function(ee){var J=ee.series,he=ee.getPointColor,re=ee.getPointBorderColor,T=ee.formatX,D=ee.formatY;return ce.exports.useMemo(function(){return J.reduce(function(z,K){return[].concat(z,K.data.filter(function(le){return le.position.x!==null&&le.position.y!==null}).map(function(le,X){var we={id:K.id+"."+X,index:z.length+X,serieId:K.id,serieColor:K.color,x:le.position.x,y:le.position.y};return we.color=he(K),we.borderColor=re(we),we.data=xn({},le.data,{xFormatted:T(le.data.x),yFormatted:D(le.data.y)}),we}))},[])},[J,he,re,T,D])}({series:_,getPointColor:C,getPointBorderColor:I,formatX:M,formatY:k}),W=PSt({enableSlices:A,points:B,width:l,height:u});return{legendData:R,toggleSerie:$,lineGenerator:MSt({curve:d}),areaGenerator:NSt({curve:d,yScale:ie,areaBaselineValue:m}),getColor:O,series:_,xScale:ne,yScale:ie,slices:W,points:B}},Poe=function(t){var e=t.areaBlendMode,r=t.areaOpacity,n=t.color,i=t.fill,o=t.path,a=uo(),s=a.animate,l=a.config,u=W9(o),c=Sa({color:n,config:l,immediate:!s});return ye.jsx(kr.path,{d:u,fill:i||c.color,fillOpacity:r,strokeWidth:0,style:{mixBlendMode:e}})};Poe.propTypes={areaBlendMode:z9.isRequired,areaOpacity:N.exports.number.isRequired,color:N.exports.string,fill:N.exports.string,path:N.exports.string.isRequired};var koe=function(t){var e=t.areaGenerator,r=t.areaOpacity,n=t.areaBlendMode,i=t.lines.slice(0).reverse();return ye.jsx("g",{children:i.map(function(o){return ye.jsx(Poe,xn({path:e(o.data.map(function(a){return a.position}))},xn({areaOpacity:r,areaBlendMode:n},o)),o.id)})})};koe.propTypes={areaGenerator:N.exports.func.isRequired,areaOpacity:N.exports.number.isRequired,areaBlendMode:z9.isRequired,lines:N.exports.arrayOf(N.exports.object).isRequired};var kSt=ce.exports.memo(koe),$oe=function(t){var e=t.lineGenerator,r=t.points,n=t.color,i=t.thickness,o=ce.exports.useMemo(function(){return e(r)},[e,r]),a=W9(o);return ye.jsx(kr.path,{d:a,fill:"none",strokeWidth:i,stroke:n})};$oe.propTypes={points:N.exports.arrayOf(N.exports.shape({x:N.exports.oneOfType([N.exports.string,N.exports.number]),y:N.exports.oneOfType([N.exports.string,N.exports.number])})),lineGenerator:N.exports.func.isRequired,color:N.exports.string.isRequired,thickness:N.exports.number.isRequired};var $St=ce.exports.memo($oe),Loe=function(t){var e=t.lines,r=t.lineGenerator,n=t.lineWidth;return e.slice(0).reverse().map(function(i){var o=i.id,a=i.data,s=i.color;return ye.jsx($St,{id:o,points:a.map(function(l){return l.position}),lineGenerator:r,color:s,thickness:n},o)})};Loe.propTypes={lines:N.exports.arrayOf(N.exports.shape({id:N.exports.oneOfType([N.exports.string,N.exports.number]).isRequired,color:N.exports.string.isRequired,data:N.exports.arrayOf(N.exports.shape({data:N.exports.shape({x:N.exports.oneOfType([N.exports.string,N.exports.number,N.exports.instanceOf(Date)]),y:N.exports.oneOfType([N.exports.string,N.exports.number,N.exports.instanceOf(Date)])}).isRequired,position:N.exports.shape({x:N.exports.number,y:N.exports.number}).isRequired})).isRequired})).isRequired,lineWidth:N.exports.number.isRequired,lineGenerator:N.exports.func.isRequired};var LSt=ce.exports.memo(Loe),Doe=function(t){var e=t.slice,r=t.axis,n=t.debug,i=t.tooltip,o=t.isCurrent,a=t.setCurrent,s=X1(),l=s.showTooltipFromEvent,u=s.hideTooltip,c=ce.exports.useCallback(function(d){l(ce.exports.createElement(i,{slice:e,axis:r}),d,"right"),a(e)},[l,i,e]),f=ce.exports.useCallback(function(d){l(ce.exports.createElement(i,{slice:e,axis:r}),d,"right")},[l,i,e]),h=ce.exports.useCallback(function(){u(),a(null)},[u]);return ye.jsx("rect",{x:e.x0,y:e.y0,width:e.width,height:e.height,stroke:"red",strokeWidth:n?1:0,strokeOpacity:.75,fill:"red",fillOpacity:o&&n?.35:0,onMouseEnter:c,onMouseMove:f,onMouseLeave:h})};Doe.propTypes={slice:N.exports.object.isRequired,axis:N.exports.oneOf(["x","y"]).isRequired,debug:N.exports.bool.isRequired,height:N.exports.number.isRequired,tooltip:N.exports.oneOfType([N.exports.func,N.exports.object]),isCurrent:N.exports.bool.isRequired,setCurrent:N.exports.func.isRequired};var DSt=ce.exports.memo(Doe),Foe=function(t){var e=t.slices,r=t.axis,n=t.debug,i=t.height,o=t.tooltip,a=t.current,s=t.setCurrent;return e.map(function(l){return ye.jsx(DSt,{slice:l,axis:r,debug:n,height:i,tooltip:o,setCurrent:s,isCurrent:a!==null&&a.id===l.id},l.id)})};Foe.propTypes={slices:N.exports.arrayOf(N.exports.shape({id:N.exports.oneOfType([N.exports.number,N.exports.string,N.exports.instanceOf(Date)]).isRequired,x:N.exports.number.isRequired,y:N.exports.number.isRequired,points:N.exports.arrayOf(N.exports.object).isRequired})).isRequired,axis:N.exports.oneOf(["x","y"]).isRequired,debug:N.exports.bool.isRequired,height:N.exports.number.isRequired,tooltip:N.exports.oneOfType([N.exports.func,N.exports.object]).isRequired,current:N.exports.object,setCurrent:N.exports.func.isRequired};var FSt=ce.exports.memo(Foe),Hoe=function(t){var e=t.points,r=t.symbol,n=t.size,i=t.borderWidth,o=t.enableLabel,a=t.label,s=t.labelYOffset,l=pr(),u=Lvt(a),c=e.slice(0).reverse().map(function(f){return{id:f.id,x:f.x,y:f.y,datum:f.data,fill:f.color,stroke:f.borderColor,label:o?u(f.data):null}});return ye.jsx("g",{children:c.map(function(f){return ye.jsx(Pvt,{x:f.x,y:f.y,datum:f.datum,symbol:r,size:n,color:f.fill,borderWidth:i,borderColor:f.stroke,label:f.label,labelYOffset:s,theme:l},f.id)})})};Hoe.propTypes={points:N.exports.arrayOf(N.exports.object),symbol:N.exports.func,size:N.exports.number.isRequired,color:N.exports.func.isRequired,borderWidth:N.exports.number.isRequired,borderColor:N.exports.func.isRequired,enableLabel:N.exports.bool.isRequired,label:N.exports.oneOfType([N.exports.string,N.exports.func]).isRequired,labelYOffset:N.exports.number};var HSt=ce.exports.memo(Hoe),Boe=function(t){var e=t.points,r=t.width,n=t.height,i=t.margin,o=t.setCurrent,a=t.onMouseEnter,s=t.onMouseMove,l=t.onMouseLeave,u=t.onClick,c=t.tooltip,f=t.debug,h=X1(),d=h.showTooltipAt,p=h.hideTooltip,m=ce.exports.useCallback(function(b,E){d(ce.exports.createElement(c,{point:b}),[b.x+i.left,b.y+i.top],"top"),o(b),a&&a(b,E)},[o,d,c,a,i]),g=ce.exports.useCallback(function(b,E){d(ce.exports.createElement(c,{point:b}),[b.x+i.left,b.y+i.top],"top"),o(b),s&&s(b,E)},[o,d,c,s]),v=ce.exports.useCallback(function(b,E){p(),o(null),l&&l(b,E)},[p,o,l]),w=ce.exports.useCallback(function(b,E){u&&u(b,E)},[u]);return ye.jsx(ESt,{nodes:e,width:r,height:n,onMouseEnter:m,onMouseMove:g,onMouseLeave:v,onClick:w,debug:f})};Boe.propTypes={points:N.exports.arrayOf(N.exports.object).isRequired,width:N.exports.number.isRequired,height:N.exports.number.isRequired,margin:N.exports.object.isRequired,setCurrent:N.exports.func.isRequired,onMouseEnter:N.exports.func,onMouseMove:N.exports.func,onMouseLeave:N.exports.func,onClick:N.exports.func,tooltip:N.exports.oneOfType([N.exports.func,N.exports.object]).isRequired,debug:N.exports.bool.isRequired};var BSt=ce.exports.memo(Boe),L4=function(t){var e=t.data,r=t.xScale,n=t.xFormat,i=t.yScale,o=t.yFormat,a=t.layers,s=t.curve,l=t.areaBaselineValue,u=t.colors,c=t.margin,f=t.width,h=t.height,d=t.axisTop,p=t.axisRight,m=t.axisBottom,g=t.axisLeft,v=t.enableGridX,w=t.enableGridY,b=t.gridXValues,E=t.gridYValues,A=t.lineWidth,M=t.enableArea,k=t.areaOpacity,O=t.areaBlendMode,x=t.enablePoints,C=t.pointSymbol,I=t.pointSize,H=t.pointColor,j=t.pointBorderWidth,q=t.pointBorderColor,Z=t.enablePointLabel,ne=t.pointLabel,ie=t.pointLabelYOffset,P=t.defs,y=t.fill,R=t.markers,_=t.legends,$=t.isInteractive,B=t.useMesh,W=t.debugMesh,ee=t.onMouseEnter,J=t.onMouseMove,he=t.onMouseLeave,re=t.onClick,T=t.tooltip,D=t.enableSlices,z=t.debugSlices,K=t.sliceTooltip,le=t.enableCrosshair,X=t.crosshairType,we=t.role,Ce=lR(f,h,c),Ee=Ce.margin,Te=Ce.innerWidth,Oe=Ce.innerHeight,F=Ce.outerWidth,U=Ce.outerHeight,Y=Noe({data:e,xScale:r,xFormat:n,yScale:i,yFormat:o,width:Te,height:Oe,colors:u,curve:s,areaBaselineValue:l,pointColor:H,pointBorderColor:q,enableSlices:D}),fe=Y.legendData,oe=Y.toggleSerie,pe=Y.lineGenerator,ue=Y.areaGenerator,se=Y.series,me=Y.xScale,te=Y.yScale,de=Y.slices,Se=Y.points,Re=pr(),Me=Ip(H,Re),qe=Ip(q,Re),ke=ce.exports.useState(null),We=ke[0],Ke=ke[1],Xe=ce.exports.useState(null),nt=Xe[0],Et=Xe[1],it={grid:ye.jsx(toe,{theme:Re,width:Te,height:Oe,xScale:v?me:null,yScale:w?te:null,xValues:b,yValues:E},"grid"),markers:ye.jsx(Sie,{markers:R,width:Te,height:Oe,xScale:me,yScale:te,theme:Re},"markers"),axes:ye.jsx(eoe,{xScale:me,yScale:te,width:Te,height:Oe,theme:Re,top:d,right:p,bottom:m,left:g},"axes"),areas:null,lines:ye.jsx(LSt,{lines:se,lineGenerator:pe,lineWidth:A},"lines"),slices:null,points:null,crosshair:null,mesh:null,legends:_.map(function(rt,Lt){return ye.jsx(yoe,xn({},rt,{containerWidth:Te,containerHeight:Oe,data:rt.data||fe,theme:Re,toggleSerie:rt.toggleSerie?oe:void 0}),"legend."+Lt)})},st=_ie(P,se,y);return M&&(it.areas=ye.jsx(kSt,{areaGenerator:ue,areaOpacity:k,areaBlendMode:O,lines:se},"areas")),$&&D!==!1&&(it.slices=ye.jsx(FSt,{slices:de,axis:D,debug:z,height:Oe,tooltip:K,current:nt,setCurrent:Et},"slices")),x&&(it.points=ye.jsx(HSt,{points:Se,symbol:C,size:I,color:Me,borderWidth:j,borderColor:qe,enableLabel:Z,label:ne,labelYOffset:ie},"points")),$&&le&&(We!==null&&(it.crosshair=ye.jsx(d4,{width:Te,height:Oe,x:We.x,y:We.y,type:X},"crosshair")),nt!==null&&(it.crosshair=ye.jsx(d4,{width:Te,height:Oe,x:nt.x,y:nt.y,type:D},"crosshair"))),$&&B&&D===!1&&(it.mesh=ye.jsx(BSt,{points:Se,width:Te,height:Oe,margin:Ee,current:We,setCurrent:Ke,onMouseEnter:ee,onMouseMove:J,onMouseLeave:he,onClick:re,tooltip:T,debug:W},"mesh")),ye.jsx(G9,{defs:st,width:F,height:U,margin:Ee,role:we,children:a.map(function(rt,Lt){return typeof rt=="function"?ye.jsx(ce.exports.Fragment,{children:rt(xn({},t,{innerWidth:Te,innerHeight:Oe,series:se,slices:de,points:Se,xScale:me,yScale:te,lineGenerator:pe,areaGenerator:ue,currentPoint:We,setCurrentPoint:Ke,currentSlice:nt,setCurrentSlice:Et}))},Lt):it[rt]})})};L4.propTypes=ASt,L4.defaultProps=Ma;var USt=Rie(L4),VSt=function(t){return ye.jsx(J1,{children:function(e){var r=e.width,n=e.height;return ye.jsx(USt,xn({width:r,height:n},t))}})},D4=function(t){var e=t.width,r=t.height,n=t.margin,i=t.pixelRatio,o=t.data,a=t.xScale,s=t.xFormat,l=t.yScale,u=t.yFormat,c=t.curve,f=t.layers,h=t.colors,d=t.lineWidth,p=t.enableArea,m=t.areaBaselineValue,g=t.areaOpacity,v=t.enablePoints,w=t.pointSize,b=t.pointColor,E=t.pointBorderWidth,A=t.pointBorderColor,M=t.enableGridX,k=t.gridXValues,O=t.enableGridY,x=t.gridYValues,C=t.axisTop,I=t.axisRight,H=t.axisBottom,j=t.axisLeft,q=t.legends,Z=t.isInteractive,ne=t.debugMesh,ie=t.onMouseLeave,P=t.onClick,y=t.tooltip,R=t.canvasRef,_=ce.exports.useRef(null),$=lR(e,r,n),B=$.margin,W=$.innerWidth,ee=$.innerHeight,J=$.outerWidth,he=$.outerHeight,re=pr(),T=ce.exports.useState(null),D=T[0],z=T[1],K=Noe({data:o,xScale:a,xFormat:s,yScale:l,yFormat:u,width:W,height:ee,colors:h,curve:c,areaBaselineValue:m,pointColor:b,pointBorderColor:A}),le=K.lineGenerator,X=K.areaGenerator,we=K.series,Ce=K.xScale,Ee=K.yScale,Te=K.points,Oe=Ooe({points:Te,width:W,height:ee,debug:ne}),F=Oe.delaunay,U=Oe.voronoi;ce.exports.useEffect(function(){R&&(R.current=_.current),_.current.width=J*i,_.current.height=he*i;var te=_.current.getContext("2d");te.scale(i,i),te.fillStyle=re.background,te.fillRect(0,0,J,he),te.translate(B.left,B.top),f.forEach(function(de){if(typeof de=="function"&&de({ctx:te,innerWidth:W,innerHeight:ee,series:we,points:Te,xScale:Ce,yScale:Ee,lineWidth:d,lineGenerator:le,areaGenerator:X,currentPoint:D,setCurrentPoint:z}),de==="grid"&&re.grid.line.strokeWidth>0&&(te.lineWidth=re.grid.line.strokeWidth,te.strokeStyle=re.grid.line.stroke,M&&WS(te,{width:W,height:ee,scale:Ce,axis:"x",values:k}),O&&WS(te,{width:W,height:ee,scale:Ee,axis:"y",values:x})),de==="axes"&&roe(te,{xScale:Ce,yScale:Ee,width:W,height:ee,top:C,right:I,bottom:H,left:j,theme:re}),de==="areas"&&p===!0&&(te.save(),te.globalAlpha=g,X.context(te),we.forEach(function(Re){te.fillStyle=Re.color,te.beginPath(),X(Re.data.map(function(Me){return Me.position})),te.fill()}),te.restore()),de==="lines"&&(le.context(te),we.forEach(function(Re){te.strokeStyle=Re.color,te.lineWidth=d,te.beginPath(),le(Re.data.map(function(Me){return Me.position})),te.stroke()})),de==="points"&&v===!0&&w>0&&Te.forEach(function(Re){te.fillStyle=Re.color,te.beginPath(),te.arc(Re.x,Re.y,w/2,0,2*Math.PI),te.fill(),E>0&&(te.strokeStyle=Re.borderColor,te.lineWidth=E,te.stroke())}),de==="mesh"&&ne===!0&&(CSt(te,U),D&&_St(te,U,D.index)),de==="legends"){var Se=we.map(function(Re){return{id:Re.id,label:Re.id,color:Re.color}}).reverse();q.forEach(function(Re){voe(te,xn({},Re,{data:Re.data||Se,containerWidth:W,containerHeight:ee,theme:re}))})}})},[_,J,he,f,re,le,we,Ce,Ee,M,k,O,x,C,I,H,j,q,Te,v,w,D]);var Y=ce.exports.useCallback(function(te){var de=Sg(_.current,te),Se=de[0],Re=de[1];if(!Cie(B.left,B.top,W,ee,Se,Re))return null;var Me=F.find(Se-B.left,Re-B.top);return Te[Me]},[_,B,W,ee,F]),fe=X1(),oe=fe.showTooltipFromEvent,pe=fe.hideTooltip,ue=ce.exports.useCallback(function(te){var de=Y(te);z(de),de?oe(ce.exports.createElement(y,{point:de}),te):pe()},[Y,z,oe,pe,y]),se=ce.exports.useCallback(function(te){pe(),z(null),D&&ie&&ie(D,te)},[pe,z,ie]),me=ce.exports.useCallback(function(te){if(P){var de=Y(te);de&&P(de,te)}},[Y,P]);return ye.jsx("canvas",{ref:_,width:J*i,height:he*i,style:{width:J,height:he,cursor:Z?"auto":"normal"},onMouseEnter:Z?ue:void 0,onMouseMove:Z?ue:void 0,onMouseLeave:Z?se:void 0,onClick:Z?me:void 0})};D4.propTypes=ISt,D4.defaultProps=xSt;var jSt=Rie(D4),WSt=ce.exports.forwardRef(function(t,e){return ye.jsx(jSt,xn({},t,{canvasRef:e}))});ce.exports.forwardRef(function(t,e){return ye.jsx(J1,{children:function(r){var n=r.width,i=r.height;return ye.jsx(WSt,xn({width:n,height:i},t,{ref:e}))}})});function zSt(){const[t]=Es(F4),e=aSt(),r=Zi.exports.uniq(e.reduce((a,s)=>[...a,...JSON.parse(s.category)],[])),[n,i]=ce.exports.useState({data:[],tags:[],dates:new Array(E_).fill("").map((a,s)=>At().subtract(s,"month").format(Rg)).reverse(),months:E_});function o({type:a,payload:s}){const l=(()=>{switch(a){case"tags":return{...n,tags:s,data:C_({tags:s,dates:n.dates,ALL_DB:e})};case"months":const u=new Array(s).fill("").map((c,f)=>At().subtract(f,"month").format(Rg)).reverse();return{...n,months:s,dates:u,data:C_({tags:n.tags,dates:u,ALL_DB:e})};default:return n}})();i(l)}return ce.exports.useEffect(()=>{o({type:"data",payload:C_({tags:n.tags,dates:n.dates,ALL_DB:e})})},[oSt(e)]),ve.createElement(Zs,{sx:{width:"80vw",textAlign:"center"}},ve.createElement(bt,{container:!0,direction:"column",spacing:1},ve.createElement(bt,{item:!0},ve.createElement(ps,{variant:"h6"},"Overall Savings and Spending")),ve.createElement(bt,{item:!0},ve.createElement(I_,{multiple:!0,id:"tags-standard",options:r,value:n.tags,onChange:(a,s)=>o({type:"tags",payload:s}),renderInput:a=>ve.createElement(eu,{...a,size:"small",variant:"outlined",label:"Categories",placeholder:"Categories"})})),ve.createElement(bt,{item:!0},ve.createElement(Dae,{fullWidth:!0,size:"small",variant:"outlined",value:n.months,onChange:a=>o({type:"months",payload:a.target.value})},ve.createElement(pR,{value:4},"Less"),ve.createElement(pR,{value:E_},"Normal"),ve.createElement(pR,{value:11},"More"))),ve.createElement(bt,{item:!0},n.tags.length>0?ve.createElement(Zs,{sx:Zi.exports.omit(Uoe,["m"])},ve.createElement(VSt,{data:n.data,margin:{top:10,right:10,bottom:50,left:50},xScale:{type:"point"},yScale:{type:"linear",min:"auto",max:"auto"},theme:{axis:{legend:{text:{fill:t?"#939393":"#000"}},ticks:{text:{fill:t?"#939393":"#000"}}}},yFormat:" >-.2f",pointSize:10,pointColor:{theme:"background"},pointBorderWidth:2,pointBorderColor:{from:"serieColor"},pointLabelYOffset:-12,useMesh:!0,tooltip:a=>ve.createElement(Voe,null,ve.createElement(ps,null,a.point.serieId.replace("/","")),ve.createElement(ps,null,a.point.data.x,": ",a.point.data.y))})):ve.createElement(Zs,null,"Please choose some filters"))))}const GSt=()=>ve.createElement(bt,{container:!0,justifyContent:"center",alignItems:"center",direction:"column",spacing:2},ve.createElement(bt,{item:!0},ve.createElement(Hwt,null)),ve.createElement(bt,{item:!0},ve.createElement(zSt,null)),ve.createElement(bt,{item:!0},ve.createElement(iSt,null))),Uoe={m:4,height:"40vh",width:"80vw",textAlign:"center"},Voe=({children:t})=>{const[e]=Es(F4);return ve.createElement(Zs,{sx:{backgroundColor:e?"#000":"#fff",padding:"5px 10px 5px 10px",borderRadius:"25px"}},t)};function YSt(){const{minDate:t,totalMonths:e}=Zx(),[r,n]=Es(Zte);return ve.createElement(bt,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",style:{width:"80vw"}},ve.createElement(bt,{item:!0},ve.createElement(Cg,{onClick:()=>n(Math.min(e-1,r+1))},ve.createElement(ict,null))),ve.createElement(bt,{item:!0},ve.createElement(ps,null,At.unix(t!=null?t:At().unix()).subtract(r,"month").format("MMM YYYY"))),ve.createElement(bt,{item:!0},ve.createElement(Cg,{onClick:()=>n(Math.max(0,r-1))},ve.createElement(oct,null))))}var KSt={exports:{}};(function(t,e){(function(r,n){t.exports=n(Qoe())})(uh,function(r){function n(a){return a&&typeof a=="object"&&"default"in a?a:{default:a}}var i=n(r),o={name:"en-sg",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),weekStart:1,weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),ordinal:function(a){return a},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"}};return i.default.locale(o,null,!0),o})})(KSt);const O_=[{name:"Input",component:bct},{name:"Insights",component:GSt},{name:"Goals",component:rct}],l6t=()=>{const[t,e]=ce.exports.useState(O_[1].name);return ve.createElement(Zs,{sx:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"}},ve.createElement(YSt,null),ve.createElement(Nae,{value:t,onChange:(r,n)=>e(n)},O_.map((r,n)=>ve.createElement(Pae,{label:r.name,key:n,value:r.name}))),ve.createElement(Zs,{sx:{mt:2,mb:6}},O_.map((r,n)=>{if(t===r.name)return ve.createElement(r.component,{key:n})})),ve.createElement(dct,null))};export{l6t as default};
