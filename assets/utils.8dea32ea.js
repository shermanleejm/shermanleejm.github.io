import{r as y}from"./index.b5c20838.js";let pt=0;function Et(s,d){const u=`atom${++pt}`,l={toString:()=>u};return typeof s=="function"?l.read=s:(l.init=s,l.read=p=>p(l),l.write=(p,S,a)=>S(l,typeof a=="function"?a(p(l)):a)),d&&(l.write=d),l}const g=Symbol(),G=s=>!!s[g],x=s=>!s[g].c,v=s=>{var d;const{b:u,c:l}=s[g];l&&(l(),(d=wt.get(u))==null||d())},U=(s,d)=>{const u=s[g].o,l=d[g].o;return u===l||s===l||G(u)&&U(u,d)},j=(s,d)=>{const u={b:s,o:d,c:null},l=new Promise(p=>{u.c=()=>{u.c=null,p()},d.finally(u.c)});return l[g]=u,l},St=s=>j(s[g].b,s[g].o),wt=new WeakMap,I=s=>"init"in s,J="r",$="w",C="c",q="s",it="h",At="n",mt="l",ht="a",Mt="m",Ot=s=>{const d=new WeakMap,u=new WeakMap,l=new Map;let p,S;if(({BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&(p=new Set,S=new Set),s)for(const[e,t]of s){const n={v:t,r:0,y:!0,d:new Map};({BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&(Object.freeze(n),I(e)||console.warn("Found initial value for derived atom which can cause unexpected behavior",e)),d.set(e,n)}const a=new WeakMap,E=(e,t,n)=>{let r=a.get(t);r||(r=new Map,a.set(t,r)),n.then(()=>{r.get(e)===n&&(r.delete(e),r.size||a.delete(t))}),r.set(e,n)},h=e=>{const t=new Set,n=a.get(e);return n&&(a.delete(e),n.forEach((r,o)=>{v(r),t.add(o)})),t},M=new WeakMap,_=e=>{let t=M.get(e);return t||(t=new Map,M.set(e,t)),t},w=(e,t)=>{if(e){const n=_(e);let r=n.get(t);return r||(r=w(e.p,t),r&&"p"in r&&x(r.p)&&(r=void 0),r&&n.set(t,r)),r}return d.get(t)},A=(e,t,n)=>{if(({BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&Object.freeze(n),e)_(e).set(t,n);else{const r=d.get(t);d.set(t,n),l.has(t)||l.set(t,r)}},m=(e,t=new Map,n)=>{if(!n)return t;const r=new Map;let o=!1;return n.forEach(i=>{var c;const f=((c=w(e,i))==null?void 0:c.r)||0;r.set(i,f),t.get(i)!==f&&(o=!0)}),t.size===r.size&&!o?t:r},R=(e,t,n,r,o)=>{const i=w(e,t);if(i){if(o&&(!("p"in i)||!U(i.p,o)))return i;"p"in i&&v(i.p)}const c={v:n,r:(i==null?void 0:i.r)||0,y:!0,d:m(e,i==null?void 0:i.d,r)};let f=!(i!=null&&i.y);return!i||!("v"in i)||!Object.is(i.v,n)?(f=!0,++c.r,c.d.has(t)&&(c.d=new Map(c.d).set(t,c.r))):c.d!==i.d&&(c.d.size!==i.d.size||!Array.from(c.d.keys()).every(D=>i.d.has(D)))&&(f=!0,Promise.resolve().then(()=>{b(e)})),i&&!f?i:(A(e,t,c),c)},Q=(e,t,n,r,o)=>{const i=w(e,t);if(i){if(o&&(!("p"in i)||!U(i.p,o)))return i;"p"in i&&v(i.p)}const c={e:n,r:((i==null?void 0:i.r)||0)+1,y:!0,d:m(e,i==null?void 0:i.d,r)};return A(e,t,c),c},X=(e,t,n,r)=>{const o=w(e,t);if(o&&"p"in o){if(U(o.p,n)&&!x(o.p))return o.y?o:{...o,y:!0};v(o.p)}E(e,t,n);const i={p:n,r:((o==null?void 0:o.r)||0)+1,y:!0,d:m(e,o==null?void 0:o.d,r)};return A(e,t,i),i},T=(e,t,n,r)=>{if(n instanceof Promise){const o=j(n,n.then(i=>{R(e,t,i,r,o)}).catch(i=>{if(i instanceof Promise)return G(i)?i.then(()=>{P(e,t,!0)}):i;Q(e,t,i,r,o)}));return X(e,t,o,r)}return R(e,t,n,r)},ct=(e,t)=>{const n=w(e,t);if(n){const r={...n,y:!1};A(e,t,r)}else({BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&console.warn("[Bug] could not invalidate non existing atom",t)},P=(e,t,n)=>{if(!n){const o=w(e,t);if(o){if(o.y&&"p"in o&&!x(o.p))return o;if(o.d.forEach((i,c)=>{if(c!==t)if(!u.has(c))P(e,c);else{const f=w(e,c);f&&!f.y&&P(e,c)}}),Array.from(o.d).every(([i,c])=>{const f=w(e,i);return f&&!("p"in f)&&f.r===c}))return o.y?o:{...o,y:!0}}}const r=new Set;try{const o=t.read(i=>{r.add(i);const c=i===t?w(e,i):P(e,i);if(c){if("e"in c)throw c.e;if("p"in c)throw c.p;return c.v}if(I(i))return i.init;throw new Error("no atom init")});return T(e,t,o,r)}catch(o){if(o instanceof Promise){const i=G(o)&&x(o)?St(o):j(o,o);return X(e,t,i,r)}return Q(e,t,o,r)}},Y=(e,t)=>P(t,e),ut=(e,t)=>{let n=u.get(t);return n||(n=N(e,t)),n},B=(e,t)=>!t.l.size&&(!t.t.size||t.t.size===1&&t.t.has(e)),ft=(e,t)=>{const n=u.get(t);n&&B(t,n)&&W(e,t)},L=(e,t)=>{const n=u.get(t);n==null||n.t.forEach(r=>{r!==t&&(ct(e,r),L(e,r))})},Z=(e,t,n)=>{let r=!0;const o=(f,D)=>{const O=P(e,f);if("e"in O)throw O.e;if("p"in O){if(D!=null&&D.unstable_promise)return O.p.then(()=>{const V=w(e,f);return V&&"p"in V&&V.p===O.p?new Promise(k=>setTimeout(k)).then(()=>o(f,D)):o(f,D)});throw({BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&console.info("Reading pending atom state in write operation. We throw a promise for now.",f),O.p}if("v"in O)return O.v;throw({BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&console.warn("[Bug] no value found while reading atom in write operation. This is probably a bug.",f),new Error("no value found")},i=(f,D)=>{let O;if(f===t){if(!I(f))throw new Error("atom not writable");h(f).forEach(rt=>{rt!==e&&T(rt,f,D)});const k=w(e,f),at=T(e,f,D);k!==at&&L(e,f)}else O=Z(e,f,D);return r||b(e),O},c=t.write(o,i,n);return r=!1,c},z=(e,t,n)=>{const r=Z(n,e,t);return b(n),r},dt=e=>!!e.write,N=(e,t,n)=>{const r={t:new Set(n&&[n]),l:new Set};if(u.set(t,r),({BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&S.add(t),P(void 0,t).d.forEach((i,c)=>{const f=u.get(c);f?f.t.add(t):c!==t&&N(e,c,t)}),dt(t)&&t.onMount){const i=f=>z(t,f,e),c=t.onMount(i);e=void 0,c&&(r.u=c)}return r},W=(e,t)=>{var n;const r=(n=u.get(t))==null?void 0:n.u;r&&r(),u.delete(t),({BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&S.delete(t);const o=w(e,t);o?("p"in o&&v(o.p),o.d.forEach((i,c)=>{if(c!==t){const f=u.get(c);f&&(f.t.delete(t),B(c,f)&&W(e,c))}})):({BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&console.warn("[Bug] could not find atom state to unmount",t)},tt=(e,t,n,r)=>{const o=new Set(n.d.keys());r==null||r.forEach((i,c)=>{if(o.has(c)){o.delete(c);return}const f=u.get(c);f&&(f.t.delete(t),B(c,f)&&W(e,c))}),o.forEach(i=>{const c=u.get(i);c?c.t.add(t):u.has(t)&&N(e,i,t)})},b=e=>{if(e){_(e).forEach((n,r)=>{const o=d.get(r);if(n!==o){const i=u.get(r);i==null||i.l.forEach(c=>c(e))}});return}for(;l.size;){const t=Array.from(l);l.clear(),t.forEach(([n,r])=>{const o=w(void 0,n);if(o&&o.d!==(r==null?void 0:r.d)&&tt(void 0,n,o,r==null?void 0:r.d),r&&!r.y&&(o==null?void 0:o.y))return;const i=u.get(n);i==null||i.l.forEach(c=>c())})}({BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&p.forEach(t=>t())},lt=e=>{_(e).forEach((n,r)=>{const o=d.get(r);(!o||n.r>o.r||n.y!==o.y||n.r===o.r&&n.d!==o.d)&&(d.set(r,n),n.d!==(o==null?void 0:o.d)&&tt(e,r,n,o==null?void 0:o.d))})},et=(e,t)=>{t&&lt(t),b(void 0)},nt=(e,t,n)=>{const o=ut(n,e).l;return o.add(t),()=>{o.delete(t),ft(n,e)}},ot=(e,t)=>{for(const[n,r]of e)I(n)&&(T(t,n,r),L(t,n));b(t)};return({BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"?{[J]:Y,[$]:z,[C]:et,[q]:nt,[it]:ot,[At]:e=>(p.add(e),()=>{p.delete(e)}),[mt]:()=>S.values(),[ht]:e=>d.get(e),[Mt]:e=>u.get(e)}:{[J]:Y,[$]:z,[C]:et,[q]:nt,[it]:ot}},Dt=(s,d)=>({s:d?d(s).SECRET_INTERNAL_store:Ot(s)}),F=new Map,st=s=>(F.has(s)||F.set(s,y.exports.createContext(Dt())),F.get(s));function H(s,d){return Et(s,d)}function _t(s,d){const u=st(d),l=y.exports.useContext(u),{s:p,v:S}=l,a=A=>{const m=p[J](s,A);if(({BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&!m.y)throw new Error("should not be invalidated");if("e"in m)throw m.e;if("p"in m)throw m.p;if("v"in m)return m.v;throw new Error("no atom value")},[[E,h,M],_]=y.exports.useReducer((A,m)=>{const R=a(m);return Object.is(A[1],R)&&A[2]===s?A:[m,R,s]},S,A=>{const m=a(A);return[A,m,s]});let w=h;return M!==s&&(_(E),w=a(E)),y.exports.useEffect(()=>{const{v:A}=l;A&&p[C](s,A);const m=p[q](s,_,A);return _(A),m},[p,s,l]),y.exports.useEffect(()=>{p[C](s,E)}),y.exports.useDebugValue(w),w}function yt(s,d){const u=st(d),{s:l,w:p}=y.exports.useContext(u);return y.exports.useCallback(a=>{if(({BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}&&"production")!=="production"&&!("write"in s))throw new Error("not writable atom");const E=h=>l[$](s,a,h);return p?p(E):E()},[l,p,s])}function vt(s,d){return"scope"in s&&(console.warn("atom.scope is deprecated. Please do useAtom(atom, scope) instead."),d=s.scope),[_t(s,d),yt(s,d)]}const gt=Symbol(),K=Symbol();H(()=>[]);function Pt(s){let d,u;const l={getItem:p=>{var S,a;const E=M=>{if(M=M||"",d!==M){try{u=JSON.parse(M)}catch{return K}d=M}return u},h=(a=(S=s())==null?void 0:S.getItem(p))!=null?a:null;return h instanceof Promise?h.then(E):E(h)},setItem:(p,S)=>{var a;return(a=s())==null?void 0:a.setItem(p,JSON.stringify(S))},removeItem:p=>{var S;return(S=s())==null?void 0:S.removeItem(p)}};return typeof window<"u"&&typeof window.addEventListener=="function"&&(l.subscribe=(p,S)=>{const a=E=>{E.key===p&&E.newValue&&S(JSON.parse(E.newValue))};return window.addEventListener("storage",a),()=>{window.removeEventListener("storage",a)}}),l}const Rt=Pt(()=>typeof window<"u"?window.localStorage:void 0);function Tt(s,d,u=Rt){const l=()=>{const a=u.getItem(s);return a instanceof Promise?a.then(E=>E===K?d:E):a===K?d:a},p=H(u.delayInit?d:l());return p.onMount=a=>{let E;if(u.subscribe&&(E=u.subscribe(s,a),a(l())),u.delayInit){const h=l();h instanceof Promise?h.then(a):a(h)}return E},H(a=>a(p),(a,E,h)=>{const M=typeof h=="function"?h(a(p)):h;return M===gt?(E(p,d),u.removeItem(s)):(E(p,M),u.setItem(s,M))})}export{H as a,Tt as b,vt as u};
