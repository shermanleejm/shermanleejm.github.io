import{g as Rg,a as Tg,s as ca,_ as Fn,r as ie,u as Ag,d as dk,b as xg,c as fk,e as mk,j as ce,f as Hh,h as Mg,i as pk,B as gk,k as Go,l as iA,R as we,m as sA,n as N5,o as rs,G as gt,p as ha,q as yk,t as I5,F as Nt,T as Gn,v as np,w as fo,x as wk,y as vk,z as Ck,A as Ek,C as oA,D as O5,E as aA,H as lA,I as uA}from"./index.f7f8e16d.js";import{d as St,L as cA,A as hA,D as dA,R as bk,a as U0,c as Sk,t as Rk,r as Tk}from"./hooks.3da02f9d.js";import{h as It,m as Ak}from"./moment.a565bb48.js";import{c as zo,u as Ng,S as xk,A as Mk,_ as _5,e as fA,a as Nk,b as Ik,i as fc,d as Ok,f as mA,g as pA,h as Md,j as gA,k as _k,l as Lk,m as L5,n as yA,o as Uh,p as Pk,q as wA,r as Dk,s as vA,t as kk,v as Ig,w as Fk,x as CA,y as Hk,z as EA,B as Og,C as Uk,D as Bk,E as Vk,F as bA,G as $k,H as Wk,I as Gk,J as zk,K as je,L as Yk,M as Ni,N as jk,O as Kk,P as P5,Q as py,R as qk,T as SA,U as RA,V as Xk,W as Qk,X as Zk,Y as Jk,Z as D5,$ as eF,a0 as tF,a1 as nF,a2 as rF,a3 as iF,a4 as SS,a5 as sF,a6 as oF,a7 as aF}from"./DataGrid.8742f703.js";import{l as Co,_ as Or}from"./lodash.47bc7909.js";import{T as lF,g as RS,a as Ba,M as uF,b as cF,F as hF}from"./TextField.bfbb7d9a.js";import{c as dF,B as Gu}from"./Box.3fdb167d.js";import{I as fF,N as mF,F as B0}from"./index.d81e0106.js";import{I as Bh,A as gy,T as TS}from"./TableCell.6df9dfc5.js";import{P as pF,T as yo}from"./Typography.fbd78a3f.js";import{T as gF,a as yF,b as wF}from"./TableRow.e1caabec.js";import{p as M}from"./index.4b380921.js";const vF=dF(),CF=vF;function EF(n){return Rg("MuiCollapse",n)}Tg("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const bF=["addEndListener","children","className","collapsedSize","component","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","orientation","style","timeout","TransitionComponent"],SF=n=>{const{orientation:e,classes:t}=n,r={root:["root",`${e}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${e}`],wrapperInner:["wrapperInner",`${e}`]};return Mg(r,EF,t)},RF=ca("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:t}=n;return[e.root,e[t.orientation],t.state==="entered"&&e.entered,t.state==="exited"&&!t.in&&t.collapsedSize==="0px"&&e.hidden]}})(({theme:n,ownerState:e})=>Fn({height:0,overflow:"hidden",transition:n.transitions.create("height")},e.orientation==="horizontal"&&{height:"auto",width:0,transition:n.transitions.create("width")},e.state==="entered"&&Fn({height:"auto",overflow:"visible"},e.orientation==="horizontal"&&{width:"auto"}),e.state==="exited"&&!e.in&&e.collapsedSize==="0px"&&{visibility:"hidden"})),TF=ca("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:(n,e)=>e.wrapper})(({ownerState:n})=>Fn({display:"flex",width:"100%"},n.orientation==="horizontal"&&{width:"auto",height:"100%"})),AF=ca("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:(n,e)=>e.wrapperInner})(({ownerState:n})=>Fn({width:"100%"},n.orientation==="horizontal"&&{width:"auto",height:"100%"})),TA=ie.exports.forwardRef(function(e,t){const r=Ag({props:e,name:"MuiCollapse"}),{addEndListener:i,children:s,className:o,collapsedSize:a="0px",component:l,easing:u,in:c,onEnter:h,onEntered:d,onEntering:f,onExit:m,onExited:p,onExiting:y,orientation:C="vertical",style:b,timeout:v=dk.standard,TransitionComponent:S=lF}=r,L=xg(r,bF),_=Fn({},r,{orientation:C,collapsedSize:a}),P=SF(_),x=fk(),I=ie.exports.useRef(),R=ie.exports.useRef(null),N=ie.exports.useRef(),H=typeof a=="number"?`${a}px`:a,K=C==="horizontal",X=K?"width":"height";ie.exports.useEffect(()=>()=>{clearTimeout(I.current)},[]);const J=ie.exports.useRef(null),ue=mk(t,J),se=j=>ye=>{if(j){const ee=J.current;ye===void 0?j(ee):j(ee,ye)}},O=()=>R.current?R.current[K?"clientWidth":"clientHeight"]:0,g=se((j,ye)=>{R.current&&K&&(R.current.style.position="absolute"),j.style[X]=H,h&&h(j,ye)}),E=se((j,ye)=>{const ee=O();R.current&&K&&(R.current.style.position="");const{duration:T,easing:F}=RS({style:b,timeout:v,easing:u},{mode:"enter"});if(v==="auto"){const Y=x.transitions.getAutoHeightDuration(ee);j.style.transitionDuration=`${Y}ms`,N.current=Y}else j.style.transitionDuration=typeof T=="string"?T:`${T}ms`;j.style[X]=`${ee}px`,j.style.transitionTimingFunction=F,f&&f(j,ye)}),A=se((j,ye)=>{j.style[X]="auto",d&&d(j,ye)}),U=se(j=>{j.style[X]=`${O()}px`,m&&m(j)}),G=se(p),V=se(j=>{const ye=O(),{duration:ee,easing:T}=RS({style:b,timeout:v,easing:u},{mode:"exit"});if(v==="auto"){const F=x.transitions.getAutoHeightDuration(ye);j.style.transitionDuration=`${F}ms`,N.current=F}else j.style.transitionDuration=typeof ee=="string"?ee:`${ee}ms`;j.style[X]=H,j.style.transitionTimingFunction=T,y&&y(j)}),oe=j=>{v==="auto"&&(I.current=setTimeout(j,N.current||0)),i&&i(J.current,j)};return ce.jsx(S,Fn({in:c,onEnter:g,onEntered:A,onEntering:E,onExit:U,onExited:G,onExiting:V,addEndListener:oe,nodeRef:J,timeout:v==="auto"?null:v},L,{children:(j,ye)=>ce.jsx(RF,Fn({as:l,className:Hh(P.root,o,{entered:P.entered,exited:!c&&H==="0px"&&P.hidden}[j]),style:Fn({[K?"minWidth":"minHeight"]:H},b),ownerState:Fn({},_,{state:j}),ref:ue},ye,{children:ce.jsx(TF,{ownerState:Fn({},_,{state:j}),className:P.wrapper,ref:R,children:ce.jsx(AF,{ownerState:Fn({},_,{state:j}),className:P.wrapperInner,children:s})})}))}))});TA.muiSupportAuto=!0;const xF=TA,MF=ie.exports.createContext({}),AA=MF;function NF(n){return Rg("MuiAccordion",n)}const IF=Tg("MuiAccordion",["root","rounded","expanded","disabled","gutters","region"]),of=IF,OF=["children","className","defaultExpanded","disabled","disableGutters","expanded","onChange","square","TransitionComponent","TransitionProps"],_F=n=>{const{classes:e,square:t,expanded:r,disabled:i,disableGutters:s}=n;return Mg({root:["root",!t&&"rounded",r&&"expanded",i&&"disabled",!s&&"gutters"],region:["region"]},NF,e)},LF=ca(pF,{name:"MuiAccordion",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:t}=n;return[{[`& .${of.region}`]:e.region},e.root,!t.square&&e.rounded,!t.disableGutters&&e.gutters]}})(({theme:n})=>{const e={duration:n.transitions.duration.shortest};return{position:"relative",transition:n.transitions.create(["margin"],e),overflowAnchor:"none","&:before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(n.vars||n).palette.divider,transition:n.transitions.create(["opacity","background-color"],e)},"&:first-of-type":{"&:before":{display:"none"}},[`&.${of.expanded}`]:{"&:before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&:before":{display:"none"}}},[`&.${of.disabled}`]:{backgroundColor:(n.vars||n).palette.action.disabledBackground}}},({theme:n,ownerState:e})=>Fn({},!e.square&&{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(n.vars||n).shape.borderRadius,borderTopRightRadius:(n.vars||n).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(n.vars||n).shape.borderRadius,borderBottomRightRadius:(n.vars||n).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}},!e.disableGutters&&{[`&.${of.expanded}`]:{margin:"16px 0"}})),PF=ie.exports.forwardRef(function(e,t){const r=Ag({props:e,name:"MuiAccordion"}),{children:i,className:s,defaultExpanded:o=!1,disabled:a=!1,disableGutters:l=!1,expanded:u,onChange:c,square:h=!1,TransitionComponent:d=xF,TransitionProps:f}=r,m=xg(r,OF),[p,y]=pk({controlled:u,default:o,name:"Accordion",state:"expanded"}),C=ie.exports.useCallback(P=>{y(!p),c&&c(P,!p)},[p,c,y]),[b,...v]=ie.exports.Children.toArray(i),S=ie.exports.useMemo(()=>({expanded:p,disabled:a,disableGutters:l,toggle:C}),[p,a,l,C]),L=Fn({},r,{square:h,disabled:a,disableGutters:l,expanded:p}),_=_F(L);return ce.jsxs(LF,Fn({className:Hh(_.root,s),ref:t,ownerState:L,square:h},m,{children:[ce.jsx(AA.Provider,{value:S,children:b}),ce.jsx(d,Fn({in:p,timeout:"auto"},f,{children:ce.jsx("div",{"aria-labelledby":b.props.id,id:b.props["aria-controls"],role:"region",className:_.region,children:v})}))]}))}),DF=PF;function kF(n){return Rg("MuiAccordionDetails",n)}Tg("MuiAccordionDetails",["root"]);const FF=["className"],HF=n=>{const{classes:e}=n;return Mg({root:["root"]},kF,e)},UF=ca("div",{name:"MuiAccordionDetails",slot:"Root",overridesResolver:(n,e)=>e.root})(({theme:n})=>({padding:n.spacing(1,2,2)})),BF=ie.exports.forwardRef(function(e,t){const r=Ag({props:e,name:"MuiAccordionDetails"}),{className:i}=r,s=xg(r,FF),o=r,a=HF(o);return ce.jsx(UF,Fn({className:Hh(a.root,i),ref:t,ownerState:o},s))}),VF=BF;function $F(n){return Rg("MuiAccordionSummary",n)}const WF=Tg("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),bu=WF,GF=["children","className","expandIcon","focusVisibleClassName","onClick"],zF=n=>{const{classes:e,expanded:t,disabled:r,disableGutters:i}=n;return Mg({root:["root",t&&"expanded",r&&"disabled",!i&&"gutters"],focusVisible:["focusVisible"],content:["content",t&&"expanded",!i&&"contentGutters"],expandIconWrapper:["expandIconWrapper",t&&"expanded"]},$F,e)},YF=ca(gk,{name:"MuiAccordionSummary",slot:"Root",overridesResolver:(n,e)=>e.root})(({theme:n,ownerState:e})=>{const t={duration:n.transitions.duration.shortest};return Fn({display:"flex",minHeight:48,padding:n.spacing(0,2),transition:n.transitions.create(["min-height","background-color"],t),[`&.${bu.focusVisible}`]:{backgroundColor:(n.vars||n).palette.action.focus},[`&.${bu.disabled}`]:{opacity:(n.vars||n).palette.action.disabledOpacity},[`&:hover:not(.${bu.disabled})`]:{cursor:"pointer"}},!e.disableGutters&&{[`&.${bu.expanded}`]:{minHeight:64}})}),jF=ca("div",{name:"MuiAccordionSummary",slot:"Content",overridesResolver:(n,e)=>e.content})(({theme:n,ownerState:e})=>Fn({display:"flex",flexGrow:1,margin:"12px 0"},!e.disableGutters&&{transition:n.transitions.create(["margin"],{duration:n.transitions.duration.shortest}),[`&.${bu.expanded}`]:{margin:"20px 0"}})),KF=ca("div",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper",overridesResolver:(n,e)=>e.expandIconWrapper})(({theme:n})=>({display:"flex",color:(n.vars||n).palette.action.active,transform:"rotate(0deg)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shortest}),[`&.${bu.expanded}`]:{transform:"rotate(180deg)"}})),qF=ie.exports.forwardRef(function(e,t){const r=Ag({props:e,name:"MuiAccordionSummary"}),{children:i,className:s,expandIcon:o,focusVisibleClassName:a,onClick:l}=r,u=xg(r,GF),{disabled:c=!1,disableGutters:h,expanded:d,toggle:f}=ie.exports.useContext(AA),m=C=>{f&&f(C),l&&l(C)},p=Fn({},r,{expanded:d,disabled:c,disableGutters:h}),y=zF(p);return ce.jsxs(YF,Fn({focusRipple:!1,disableRipple:!0,disabled:c,component:"div","aria-expanded":d,className:Hh(y.root,s),focusVisibleClassName:Hh(y.focusVisible,a),onClick:m,ref:t,ownerState:p},u,{children:[ce.jsx(jF,{className:y.content,ownerState:p,children:i}),o&&ce.jsx(KF,{className:y.expandIconWrapper,ownerState:p,children:o})]}))}),XF=qF;var Ic=function(n){return n&&n.Math===Math&&n},Rr=Ic(typeof globalThis=="object"&&globalThis)||Ic(typeof window=="object"&&window)||Ic(typeof self=="object"&&self)||Ic(typeof Go=="object"&&Go)||Ic(typeof Go=="object"&&Go)||function(){return this}()||Function("return this")(),k5={},Fi=function(n){try{return!!n()}catch{return!0}},QF=Fi,Gs=!QF(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),ZF=Fi,_g=!ZF(function(){var n=function(){}.bind();return typeof n!="function"||n.hasOwnProperty("prototype")}),JF=_g,af=Function.prototype.call,Lg=JF?af.bind(af):function(){return af.apply(af,arguments)},xA={},MA={}.propertyIsEnumerable,NA=Object.getOwnPropertyDescriptor,eH=NA&&!MA.call({1:2},1);xA.f=eH?function(e){var t=NA(this,e);return!!t&&t.enumerable}:MA;var F5=function(n,e){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:e}},IA=_g,OA=Function.prototype,yy=OA.call,tH=IA&&OA.bind.bind(yy,yy),Hr=IA?tH:function(n){return function(){return yy.apply(n,arguments)}},_A=Hr,nH=_A({}.toString),rH=_A("".slice),mc=function(n){return rH(nH(n),8,-1)},iH=Hr,sH=Fi,oH=mc,V0=Object,aH=iH("".split),lH=sH(function(){return!V0("z").propertyIsEnumerable(0)})?function(n){return oH(n)==="String"?aH(n,""):V0(n)}:V0,LA=function(n){return n==null},uH=LA,cH=TypeError,PA=function(n){if(uH(n))throw new cH("Can't call method on "+n);return n},hH=lH,dH=PA,Pg=function(n){return hH(dH(n))},wy=typeof document=="object"&&document.all,fH=typeof wy>"u"&&wy!==void 0,DA={all:wy,IS_HTMLDDA:fH},kA=DA,mH=kA.all,yr=kA.IS_HTMLDDA?function(n){return typeof n=="function"||n===mH}:function(n){return typeof n=="function"},AS=yr,FA=DA,pH=FA.all,bl=FA.IS_HTMLDDA?function(n){return typeof n=="object"?n!==null:AS(n)||n===pH}:function(n){return typeof n=="object"?n!==null:AS(n)},$0=Rr,gH=yr,yH=function(n){return gH(n)?n:void 0},Nd=function(n,e){return arguments.length<2?yH($0[n]):$0[n]&&$0[n][e]},wH=Hr,HA=wH({}.isPrototypeOf),H5=typeof navigator<"u"&&String(navigator.userAgent)||"",UA=Rr,W0=H5,xS=UA.process,MS=UA.Deno,NS=xS&&xS.versions||MS&&MS.version,IS=NS&&NS.v8,Ki,rp;IS&&(Ki=IS.split("."),rp=Ki[0]>0&&Ki[0]<4?1:+(Ki[0]+Ki[1]));!rp&&W0&&(Ki=W0.match(/Edge\/(\d+)/),(!Ki||Ki[1]>=74)&&(Ki=W0.match(/Chrome\/(\d+)/),Ki&&(rp=+Ki[1])));var vH=rp,OS=vH,CH=Fi,EH=Rr,bH=EH.String,U5=!!Object.getOwnPropertySymbols&&!CH(function(){var n=Symbol("symbol detection");return!bH(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&OS&&OS<41}),SH=U5,BA=SH&&!Symbol.sham&&typeof Symbol.iterator=="symbol",RH=Nd,TH=yr,AH=HA,xH=BA,MH=Object,B5=xH?function(n){return typeof n=="symbol"}:function(n){var e=RH("Symbol");return TH(e)&&AH(e.prototype,MH(n))},NH=String,VA=function(n){try{return NH(n)}catch{return"Object"}},IH=yr,OH=VA,_H=TypeError,V5=function(n){if(IH(n))return n;throw new _H(OH(n)+" is not a function")},LH=V5,PH=LA,DH=function(n,e){var t=n[e];return PH(t)?void 0:LH(t)},G0=Lg,z0=yr,Y0=bl,kH=TypeError,FH=function(n,e){var t,r;if(e==="string"&&z0(t=n.toString)&&!Y0(r=G0(t,n))||z0(t=n.valueOf)&&!Y0(r=G0(t,n))||e!=="string"&&z0(t=n.toString)&&!Y0(r=G0(t,n)))return r;throw new kH("Can't convert object to primitive value")},$5={exports:{}},_S=Rr,HH=Object.defineProperty,W5=function(n,e){try{HH(_S,n,{value:e,configurable:!0,writable:!0})}catch{_S[n]=e}return e},UH=Rr,BH=W5,LS="__core-js_shared__",VH=UH[LS]||BH(LS,{}),G5=VH,PS=G5;($5.exports=function(n,e){return PS[n]||(PS[n]=e!==void 0?e:{})})("versions",[]).push({version:"3.33.3",mode:"global",copyright:"\xA9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.3/LICENSE",source:"https://github.com/zloirock/core-js"});var $H=PA,WH=Object,Dg=function(n){return WH($H(n))},GH=Hr,zH=Dg,YH=GH({}.hasOwnProperty),So=Object.hasOwn||function(e,t){return YH(zH(e),t)},jH=Hr,KH=0,qH=Math.random(),XH=jH(1 .toString),$A=function(n){return"Symbol("+(n===void 0?"":n)+")_"+XH(++KH+qH,36)},QH=Rr,ZH=$5.exports,DS=So,JH=$A,eU=U5,tU=BA,Su=QH.Symbol,j0=ZH("wks"),nU=tU?Su.for||Su:Su&&Su.withoutSetter||JH,kg=function(n){return DS(j0,n)||(j0[n]=eU&&DS(Su,n)?Su[n]:nU("Symbol."+n)),j0[n]},rU=Lg,kS=bl,FS=B5,iU=DH,sU=FH,oU=kg,aU=TypeError,lU=oU("toPrimitive"),uU=function(n,e){if(!kS(n)||FS(n))return n;var t=iU(n,lU),r;if(t){if(e===void 0&&(e="default"),r=rU(t,n,e),!kS(r)||FS(r))return r;throw new aU("Can't convert object to primitive value")}return e===void 0&&(e="number"),sU(n,e)},cU=uU,hU=B5,WA=function(n){var e=cU(n,"string");return hU(e)?e:e+""},dU=Rr,HS=bl,vy=dU.document,fU=HS(vy)&&HS(vy.createElement),z5=function(n){return fU?vy.createElement(n):{}},mU=Gs,pU=Fi,gU=z5,GA=!mU&&!pU(function(){return Object.defineProperty(gU("div"),"a",{get:function(){return 7}}).a!==7}),yU=Gs,wU=Lg,vU=xA,CU=F5,EU=Pg,bU=WA,SU=So,RU=GA,US=Object.getOwnPropertyDescriptor;k5.f=yU?US:function(e,t){if(e=EU(e),t=bU(t),RU)try{return US(e,t)}catch{}if(SU(e,t))return CU(!wU(vU.f,e,t),e[t])};var Sl={},TU=Gs,AU=Fi,zA=TU&&AU(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),xU=bl,MU=String,NU=TypeError,Id=function(n){if(xU(n))return n;throw new NU(MU(n)+" is not an object")},IU=Gs,OU=GA,_U=zA,lf=Id,BS=WA,LU=TypeError,K0=Object.defineProperty,PU=Object.getOwnPropertyDescriptor,q0="enumerable",X0="configurable",Q0="writable";Sl.f=IU?_U?function(e,t,r){if(lf(e),t=BS(t),lf(r),typeof e=="function"&&t==="prototype"&&"value"in r&&Q0 in r&&!r[Q0]){var i=PU(e,t);i&&i[Q0]&&(e[t]=r.value,r={configurable:X0 in r?r[X0]:i[X0],enumerable:q0 in r?r[q0]:i[q0],writable:!1})}return K0(e,t,r)}:K0:function(e,t,r){if(lf(e),t=BS(t),lf(r),OU)try{return K0(e,t,r)}catch{}if("get"in r||"set"in r)throw new LU("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var DU=Gs,kU=Sl,FU=F5,Od=DU?function(n,e,t){return kU.f(n,e,FU(1,t))}:function(n,e,t){return n[e]=t,n},YA={exports:{}},Cy=Gs,HU=So,jA=Function.prototype,UU=Cy&&Object.getOwnPropertyDescriptor,Y5=HU(jA,"name"),BU=Y5&&function(){}.name==="something",VU=Y5&&(!Cy||Cy&&UU(jA,"name").configurable),$U={EXISTS:Y5,PROPER:BU,CONFIGURABLE:VU},WU=Hr,GU=yr,Ey=G5,zU=WU(Function.toString);GU(Ey.inspectSource)||(Ey.inspectSource=function(n){return zU(n)});var YU=Ey.inspectSource,jU=Rr,KU=yr,VS=jU.WeakMap,qU=KU(VS)&&/native code/.test(String(VS)),XU=$5.exports,QU=$A,$S=XU("keys"),KA=function(n){return $S[n]||($S[n]=QU(n))},j5={},ZU=qU,qA=Rr,JU=bl,eB=Od,Z0=So,J0=G5,tB=KA,nB=j5,WS="Object already initialized",by=qA.TypeError,rB=qA.WeakMap,ip,Vh,sp,iB=function(n){return sp(n)?Vh(n):ip(n,{})},sB=function(n){return function(e){var t;if(!JU(e)||(t=Vh(e)).type!==n)throw new by("Incompatible receiver, "+n+" required");return t}};if(ZU||J0.state){var ls=J0.state||(J0.state=new rB);ls.get=ls.get,ls.has=ls.has,ls.set=ls.set,ip=function(n,e){if(ls.has(n))throw new by(WS);return e.facade=n,ls.set(n,e),e},Vh=function(n){return ls.get(n)||{}},sp=function(n){return ls.has(n)}}else{var Hl=tB("state");nB[Hl]=!0,ip=function(n,e){if(Z0(n,Hl))throw new by(WS);return e.facade=n,eB(n,Hl,e),e},Vh=function(n){return Z0(n,Hl)?n[Hl]:{}},sp=function(n){return Z0(n,Hl)}}var oB={set:ip,get:Vh,has:sp,enforce:iB,getterFor:sB},K5=Hr,aB=Fi,lB=yr,uf=So,Sy=Gs,uB=$U.CONFIGURABLE,cB=YU,XA=oB,hB=XA.enforce,dB=XA.get,GS=String,Am=Object.defineProperty,fB=K5("".slice),mB=K5("".replace),pB=K5([].join),gB=Sy&&!aB(function(){return Am(function(){},"length",{value:8}).length!==8}),yB=String(String).split("String"),wB=YA.exports=function(n,e,t){fB(GS(e),0,7)==="Symbol("&&(e="["+mB(GS(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),t&&t.getter&&(e="get "+e),t&&t.setter&&(e="set "+e),(!uf(n,"name")||uB&&n.name!==e)&&(Sy?Am(n,"name",{value:e,configurable:!0}):n.name=e),gB&&t&&uf(t,"arity")&&n.length!==t.arity&&Am(n,"length",{value:t.arity});try{t&&uf(t,"constructor")&&t.constructor?Sy&&Am(n,"prototype",{writable:!1}):n.prototype&&(n.prototype=void 0)}catch{}var r=hB(n);return uf(r,"source")||(r.source=pB(yB,typeof e=="string"?e:"")),n};Function.prototype.toString=wB(function(){return lB(this)&&dB(this).source||cB(this)},"toString");var vB=yr,CB=Sl,EB=YA.exports,bB=W5,SB=function(n,e,t,r){r||(r={});var i=r.enumerable,s=r.name!==void 0?r.name:e;if(vB(t)&&EB(t,s,r),r.global)i?n[e]=t:bB(e,t);else{try{r.unsafe?n[e]&&(i=!0):delete n[e]}catch{}i?n[e]=t:CB.f(n,e,{value:t,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return n},QA={},RB=Math.ceil,TB=Math.floor,AB=Math.trunc||function(e){var t=+e;return(t>0?TB:RB)(t)},xB=AB,q5=function(n){var e=+n;return e!==e||e===0?0:xB(e)},MB=q5,NB=Math.max,IB=Math.min,OB=function(n,e){var t=MB(n);return t<0?NB(t+e,0):IB(t,e)},_B=q5,LB=Math.min,PB=function(n){return n>0?LB(_B(n),9007199254740991):0},DB=PB,Fg=function(n){return DB(n.length)},kB=Pg,FB=OB,HB=Fg,zS=function(n){return function(e,t,r){var i=kB(e),s=HB(i),o=FB(r,s),a;if(n&&t!==t){for(;s>o;)if(a=i[o++],a!==a)return!0}else for(;s>o;o++)if((n||o in i)&&i[o]===t)return n||o||0;return!n&&-1}},UB={includes:zS(!0),indexOf:zS(!1)},BB=Hr,e2=So,VB=Pg,$B=UB.indexOf,WB=j5,YS=BB([].push),ZA=function(n,e){var t=VB(n),r=0,i=[],s;for(s in t)!e2(WB,s)&&e2(t,s)&&YS(i,s);for(;e.length>r;)e2(t,s=e[r++])&&(~$B(i,s)||YS(i,s));return i},X5=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],GB=ZA,zB=X5,YB=zB.concat("length","prototype");QA.f=Object.getOwnPropertyNames||function(e){return GB(e,YB)};var JA={};JA.f=Object.getOwnPropertySymbols;var jB=Nd,KB=Hr,qB=QA,XB=JA,QB=Id,ZB=KB([].concat),JB=jB("Reflect","ownKeys")||function(e){var t=qB.f(QB(e)),r=XB.f;return r?ZB(t,r(e)):t},jS=So,eV=JB,tV=k5,nV=Sl,ex=function(n,e,t){for(var r=eV(e),i=nV.f,s=tV.f,o=0;o<r.length;o++){var a=r[o];!jS(n,a)&&!(t&&jS(t,a))&&i(n,a,s(e,a))}},rV=Fi,iV=yr,sV=/#|\.prototype\./,_d=function(n,e){var t=aV[oV(n)];return t===uV?!0:t===lV?!1:iV(e)?rV(e):!!e},oV=_d.normalize=function(n){return String(n).replace(sV,".").toLowerCase()},aV=_d.data={},lV=_d.NATIVE="N",uV=_d.POLYFILL="P",cV=_d,t2=Rr,hV=k5.f,dV=Od,fV=SB,mV=W5,pV=ex,gV=cV,Rl=function(n,e){var t=n.target,r=n.global,i=n.stat,s,o,a,l,u,c;if(r?o=t2:i?o=t2[t]||mV(t,{}):o=(t2[t]||{}).prototype,o)for(a in e){if(u=e[a],n.dontCallGetSet?(c=hV(o,a),l=c&&c.value):l=o[a],s=gV(r?a:t+(i?".":"#")+a,n.forced),!s&&l!==void 0){if(typeof u==typeof l)continue;pV(u,l)}(n.sham||l&&l.sham)&&dV(u,"sham",!0),fV(o,a,u,n)}},yV=mc,tx=Array.isArray||function(e){return yV(e)==="Array"},wV=Gs,vV=tx,CV=TypeError,EV=Object.getOwnPropertyDescriptor,bV=wV&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(n){return n instanceof TypeError}}(),nx=bV?function(n,e){if(vV(n)&&!EV(n,"length").writable)throw new CV("Cannot set read only .length");return n.length=e}:function(n,e){return n.length=e},SV=TypeError,RV=9007199254740991,rx=function(n){if(n>RV)throw SV("Maximum allowed index exceeded");return n},TV=Rl,AV=Dg,xV=Fg,MV=nx,NV=rx,IV=Fi,OV=IV(function(){return[].push.call({length:4294967296},1)!==4294967297}),_V=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(n){return n instanceof TypeError}},LV=OV||!_V();TV({target:"Array",proto:!0,arity:1,forced:LV},{push:function(e){var t=AV(this),r=xV(t),i=arguments.length;NV(r+i);for(var s=0;s<i;s++)t[r]=arguments[s],r++;return MV(t,r),r}});var PV=_g,ix=Function.prototype,KS=ix.apply,qS=ix.call,Hg=typeof Reflect=="object"&&Reflect.apply||(PV?qS.bind(KS):function(){return qS.apply(KS,arguments)}),DV=Hr,kV=V5,FV=function(n,e,t){try{return DV(kV(Object.getOwnPropertyDescriptor(n,e)[t]))}catch{}},HV=yr,UV=String,BV=TypeError,VV=function(n){if(typeof n=="object"||HV(n))return n;throw new BV("Can't set "+UV(n)+" as a prototype")},$V=FV,WV=Id,GV=VV,sx=Object.setPrototypeOf||("__proto__"in{}?function(){var n=!1,e={},t;try{t=$V(Object.prototype,"__proto__","set"),t(e,[]),n=e instanceof Array}catch{}return function(i,s){return WV(i),GV(s),n?t(i,s):i.__proto__=s,i}}():void 0),zV=Sl.f,YV=function(n,e,t){t in n||zV(n,t,{configurable:!0,get:function(){return e[t]},set:function(r){e[t]=r}})},jV=yr,KV=bl,XS=sx,qV=function(n,e,t){var r,i;return XS&&jV(r=e.constructor)&&r!==t&&KV(i=r.prototype)&&i!==t.prototype&&XS(n,i),n},XV=kg,QV=XV("toStringTag"),ox={};ox[QV]="z";var ZV=String(ox)==="[object z]",JV=ZV,e$=yr,xm=mc,t$=kg,n$=t$("toStringTag"),r$=Object,i$=xm(function(){return arguments}())==="Arguments",s$=function(n,e){try{return n[e]}catch{}},o$=JV?xm:function(n){var e,t,r;return n===void 0?"Undefined":n===null?"Null":typeof(t=s$(e=r$(n),n$))=="string"?t:i$?xm(e):(r=xm(e))==="Object"&&e$(e.callee)?"Arguments":r},a$=o$,l$=String,ax=function(n){if(a$(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return l$(n)},u$=ax,c$=function(n,e){return n===void 0?arguments.length<2?"":e:u$(n)},h$=bl,d$=Od,f$=function(n,e){h$(e)&&"cause"in e&&d$(n,"cause",e.cause)},m$=Hr,lx=Error,p$=m$("".replace),g$=function(n){return String(new lx(n).stack)}("zxcasd"),ux=/\n\s*at [^:]*:[^\n]*/,y$=ux.test(g$),w$=function(n,e){if(y$&&typeof n=="string"&&!lx.prepareStackTrace)for(;e--;)n=p$(n,ux,"");return n},v$=Fi,C$=F5,E$=!v$(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",C$(1,7)),n.stack!==7):!0}),b$=Od,S$=w$,R$=E$,QS=Error.captureStackTrace,T$=function(n,e,t,r){R$&&(QS?QS(n,e):b$(n,"stack",S$(t,r)))},ZS=Nd,A$=So,JS=Od,x$=HA,eR=sx,tR=ex,nR=YV,M$=qV,N$=c$,I$=f$,O$=T$,_$=Gs,L$=function(n,e,t,r){var i="stackTraceLimit",s=r?2:1,o=n.split("."),a=o[o.length-1],l=ZS.apply(null,o);if(!!l){var u=l.prototype;if(A$(u,"cause")&&delete u.cause,!t)return l;var c=ZS("Error"),h=e(function(d,f){var m=N$(r?f:d,void 0),p=r?new l(d):new l;return m!==void 0&&JS(p,"message",m),O$(p,h,p.stack,2),this&&x$(u,this)&&M$(p,this,h),arguments.length>s&&I$(p,arguments[s]),p});h.prototype=u,a!=="Error"?eR?eR(h,c):tR(h,c,{name:!0}):_$&&i in l&&(nR(h,l,i),nR(h,l,"prepareStackTrace")),tR(h,l);try{u.name!==a&&JS(u,"name",a),u.constructor=h}catch{}return h}},cx=Rl,P$=Rr,zs=Hg,hx=L$,Ry="WebAssembly",rR=P$[Ry],op=new Error("e",{cause:7}).cause!==7,Tl=function(n,e){var t={};t[n]=hx(n,e,op),cx({global:!0,constructor:!0,arity:1,forced:op},t)},Q5=function(n,e){if(rR&&rR[n]){var t={};t[n]=hx(Ry+"."+n,e,op),cx({target:Ry,stat:!0,constructor:!0,arity:1,forced:op},t)}};Tl("Error",function(n){return function(t){return zs(n,this,arguments)}});Tl("EvalError",function(n){return function(t){return zs(n,this,arguments)}});Tl("RangeError",function(n){return function(t){return zs(n,this,arguments)}});Tl("ReferenceError",function(n){return function(t){return zs(n,this,arguments)}});Tl("SyntaxError",function(n){return function(t){return zs(n,this,arguments)}});Tl("TypeError",function(n){return function(t){return zs(n,this,arguments)}});Tl("URIError",function(n){return function(t){return zs(n,this,arguments)}});Q5("CompileError",function(n){return function(t){return zs(n,this,arguments)}});Q5("LinkError",function(n){return function(t){return zs(n,this,arguments)}});Q5("RuntimeError",function(n){return function(t){return zs(n,this,arguments)}});function D$(n){const e=n.length;let t=0;for(;t<e;)n[t]=[n[t]],t+=1}function iR(n,e){const t=e.length;let r=0;for(;r<t;)n.push(e[r]),r+=1}function Mm(n){const e=[];if(!n||n.length===0||!n[0]||n[0].length===0)return e;const t=n.length,r=n[0].length;for(let i=0;i<t;i++)for(let s=0;s<r;s++)e[s]||(e[s]=[]),e[s][i]=n[i][s];return e}function Tr(n,e,t,r){let i=-1,s=n,o=t;Array.isArray(n)||(s=Array.from(n));const a=s.length;for(r&&a&&(i+=1,o=s[i]),i+=1;i<a;)o=e(o,s[i],i,s),i+=1;return o}function Oi(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const i=r.length,s=[];let o=-1;for(;t<i;){const a=r[t];e(a,t,r)&&(o+=1,s[o]=a),t+=1}return s}function ct(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const i=r.length,s=[];let o=-1;for(;t<i;){const a=r[t];o+=1,s[o]=e(a,t,r),t+=1}return s}function re(n,e){let t=0,r=n;Array.isArray(n)||(r=Array.from(n));const i=r.length;for(;t<i&&e(r[t],t,r)!==!1;)t+=1;return n}function dx(n){const e=[];return re(n,t=>{e.indexOf(t)===-1&&e.push(t)}),e}function sR(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[r,...i]=[...e];let s=r;return re(i,o=>{s=s.filter(a=>!o.includes(a))}),s}function oR(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return n.split(e)}function Vt(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return Tr(n,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),u=t[a]?t[a]:"";return s+l+u},"").trim()}function In(n){let e;switch(typeof n){case"string":case"number":e=`${n}`;break;case"object":e=n===null?"":n.toString();break;case"undefined":e="";break;default:e=n.toString();break}return e}function De(n){return typeof n<"u"}function Qt(n){return typeof n>"u"}function zn(n){return n===null||n===""||Qt(n)}function k$(n){return Object.prototype.toString.call(n)==="[object RegExp]"}const nh="length",fh=n=>parseInt(n,16),aR=n=>parseInt(n,10),ap=(n,e,t)=>n.substr(e,t),mh=n=>n.codePointAt(0)-65,Ty=n=>`${n}`.replace(/\-/g,""),F$=n=>fh(ap(Ty(n),fh("12"),mh("F")))/(fh(ap(Ty(n),mh("B"),~~![][nh]))||9),H$=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let lR=!1;const uR={invalid:()=>Vt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return Vt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Vt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},cR={invalid:()=>Vt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return Vt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Vt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function U$(n,e){const t=!zn(n),r=typeof n=="string"&&n.toLowerCase()==="non-commercial-and-evaluation",i="13.1.0";let s,o="invalid",a="invalid";n=Ty(n||"");const l=B$(n);if(t||r||l)if(l){const u=It("31/08/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=F$(n);s=It((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(o="expired",a="expired"):(o="valid",a="valid")}else r?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(H$()&&(o="valid",a="valid"),!lR&&o!=="valid"&&(uR[o]({keyValidityDate:s,hotVersion:i})&&console[o==="non_commercial"?"info":"warn"](uR[o]({keyValidityDate:s,hotVersion:i})),lR=!0),a!=="valid"&&e.parentNode&&cR[a]({keyValidityDate:s,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=cR[a]({keyValidityDate:s,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function B$(n){let e=[][nh],t=e;if(n[nh]!==mh("Z"))return!1;for(let r="",i="B<H4P+".split(""),s=mh(i.shift());s;s=mh(i.shift()||"A"))--s<""[nh]?t=t|(aR(`${aR(fh(r)+(fh(ap(n,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=ap(n,s,s?i[nh]===1?9:8:6);return t===e}var V$=Hr,Z5=V$([].slice),$$=Hr,hR=tx,W$=yr,dR=mc,G$=ax,fR=$$([].push),z$=function(n){if(W$(n))return n;if(!!hR(n)){for(var e=n.length,t=[],r=0;r<e;r++){var i=n[r];typeof i=="string"?fR(t,i):(typeof i=="number"||dR(i)==="Number"||dR(i)==="String")&&fR(t,G$(i))}var s=t.length,o=!0;return function(a,l){if(o)return o=!1,l;if(hR(this))return l;for(var u=0;u<s;u++)if(t[u]===a)return l}}},Y$=Rl,fx=Nd,mx=Hg,j$=Lg,Ld=Hr,px=Fi,mR=yr,pR=B5,gx=Z5,K$=z$,q$=U5,X$=String,Zo=fx("JSON","stringify"),cf=Ld(/./.exec),gR=Ld("".charAt),Q$=Ld("".charCodeAt),Z$=Ld("".replace),J$=Ld(1 .toString),eW=/[\uD800-\uDFFF]/g,yR=/^[\uD800-\uDBFF]$/,wR=/^[\uDC00-\uDFFF]$/,vR=!q$||px(function(){var n=fx("Symbol")("stringify detection");return Zo([n])!=="[null]"||Zo({a:n})!=="{}"||Zo(Object(n))!=="{}"}),CR=px(function(){return Zo("\uDF06\uD834")!=='"\\udf06\\ud834"'||Zo("\uDEAD")!=='"\\udead"'}),tW=function(n,e){var t=gx(arguments),r=K$(e);if(!(!mR(r)&&(n===void 0||pR(n))))return t[1]=function(i,s){if(mR(r)&&(s=j$(r,this,X$(i),s)),!pR(s))return s},mx(Zo,null,t)},nW=function(n,e,t){var r=gR(t,e-1),i=gR(t,e+1);return cf(yR,n)&&!cf(wR,i)||cf(wR,n)&&!cf(yR,r)?"\\u"+J$(Q$(n,0),16):n};Zo&&Y$({target:"JSON",stat:!0,arity:3,forced:vR||CR},{stringify:function(e,t,r){var i=gx(arguments),s=mx(vR?tW:Zo,null,i);return CR&&typeof s=="string"?Z$(s,eW,nW):s}});function $h(n){let e;return Array.isArray(n)?e=n.length?new Array(n.length).fill(null):[]:(e={},ft(n,(t,r)=>{r!=="__children"&&(t&&typeof t=="object"&&!Array.isArray(t)?e[r]=$h(t):Array.isArray(t)?t.length&&typeof t[0]=="object"&&!Array.isArray(t[0])?e[r]=[$h(t[0])]:e[r]=[]:e[r]=null)})),e}function da(n,e){return e.prototype.constructor=e,n.prototype=new e,n.prototype.constructor=n,n}function Un(n,e,t){const r=Array.isArray(t);return ft(e,(i,s)=>{(r===!1||t.includes(s))&&(n[s]=i)}),n}function Ug(n,e){ft(e,(t,r)=>{e[r]&&typeof e[r]=="object"?(n[r]||(Array.isArray(e[r])?n[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?n[r]=e[r]:n[r]={}),Ug(n[r],e[r])):n[r]=e[r]})}function kr(n){return typeof n=="object"?JSON.parse(JSON.stringify(n)):n}function Xr(n){const e={};return ft(n,(t,r)=>{e[r]=t}),e}function Yt(n){n.MIXINS||(n.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return re(t,i=>{n.MIXINS.push(i.MIXIN_NAME),ft(i,(s,o)=>{if(n.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")n.prototype[o]=s;else{const a=function(c,h){const d=`_${c}`,f=m=>{let p=m;return(Array.isArray(p)||dt(p))&&(p=kr(p)),p};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(n.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),n}function J5(n,e){return JSON.stringify(n)===JSON.stringify(e)}function dt(n){return Object.prototype.toString.call(n)==="[object Object]"}function Ro(n,e,t,r){r.value=t,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(n,e,r)}function ft(n,e){for(const t in n)if((!n.hasOwnProperty||n.hasOwnProperty&&Object.prototype.hasOwnProperty.call(n,t))&&e(n[t],t,n)===!1)break;return n}function rW(n,e){const t=e.split(".");let r=n;return ft(t,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function n2(n,e,t){const r=e.split(".");let i=n;r.forEach((s,o)=>{o!==r.length-1?(Sn(i,s)||(i[s]={}),i=i[s]):i[s]=t})}function ev(n){if(!dt(n))return 0;const e=function(t){let r=0;return dt(t)?ft(t,(i,s)=>{s!=="__children"&&(r+=e(i))}):r+=1,r};return e(n)}function zu(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const t=`_${e}`,r={_touched:!1,[t]:n,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[t]},set(i){this._touched=!0,this[t]=i},enumerable:!0,configurable:!0}),r}function Sn(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const bi=n=>{const e={value:!1};return e.test=(t,r)=>{e.value=n(t,r)},e},Al={chrome:bi((n,e)=>/Chrome/.test(n)&&/Google/.test(e)),chromeWebKit:bi(n=>/CriOS/.test(n)),edge:bi(n=>/Edge/.test(n)),edgeWebKit:bi(n=>/EdgiOS/.test(n)),firefox:bi(n=>/Firefox/.test(n)),firefoxWebKit:bi(n=>/FxiOS/.test(n)),mobile:bi(n=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n)),safari:bi((n,e)=>/Safari/.test(n)&&/Apple Computer/.test(e))},Pd={mac:bi(n=>/^Mac/.test(n)),win:bi(n=>/^Win/.test(n)),linux:bi(n=>/^Linux/.test(n)),ios:bi(n=>/iPhone|iPad|iPod/i.test(n))};function iW(){let{userAgent:n=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ft(Al,t=>{let{test:r}=t;return void r(n,e)})}function sW(){let{platform:n=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ft(Pd,e=>{let{test:t}=e;return void t(n)})}iW();sW();function yx(){return Al.chrome.value}function oW(){return Al.chromeWebKit.value}function r2(){return Al.firefox.value}function aW(){return Al.firefoxWebKit.value}function lW(){return Al.edge.value}function Ns(){return Al.mobile.value}function wx(){return Pd.ios.value}function vx(){let{maxTouchPoints:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return n>2&&Pd.mac.value}function ER(){return Pd.win.value}function bR(){return Pd.mac.value}const Ge={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:r2()?182:174,AUDIO_MUTE:r2()?181:173,AUDIO_UP:r2()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},uW=[Ge.ALT,Ge.ARROW_DOWN,Ge.ARROW_LEFT,Ge.ARROW_RIGHT,Ge.ARROW_UP,Ge.AUDIO_DOWN,Ge.AUDIO_MUTE,Ge.AUDIO_UP,Ge.BACKSPACE,Ge.CAPS_LOCK,Ge.DELETE,Ge.END,Ge.ENTER,Ge.ESCAPE,Ge.F1,Ge.F2,Ge.F3,Ge.F4,Ge.F5,Ge.F6,Ge.F7,Ge.F8,Ge.F9,Ge.F10,Ge.F11,Ge.F12,Ge.F13,Ge.F14,Ge.F15,Ge.F16,Ge.F17,Ge.F18,Ge.F19,Ge.HOME,Ge.INSERT,Ge.MEDIA_NEXT,Ge.MEDIA_PLAY_PAUSE,Ge.MEDIA_PREV,Ge.MEDIA_STOP,Ge.NULL,Ge.NUM_LOCK,Ge.PAGE_DOWN,Ge.PAGE_UP,Ge.PAUSE,Ge.SCROLL_LOCK,Ge.SHIFT,Ge.TAB];function cW(n){return n===32||n>=48&&n<=57||n>=96&&n<=111||n>=186&&n<=192||n>=219&&n<=222||n>=226||n>=65&&n<=90}function Cx(n){return uW.includes(n)}function hW(n){return[Ge.CONTROL,Ge.COMMAND_LEFT,Ge.COMMAND_RIGHT,Ge.COMMAND_FIREFOX].includes(n)}function Wh(n,e){const t=e.split("|");let r=!1;return re(t,i=>{if(n===Ge[i])return r=!0,!1}),r}function Ds(n){n.isImmediatePropagationEnabled=!1,n.cancelBubble=!0}function pu(n){return n.isImmediatePropagationEnabled===!1}function sl(n){return n.button===2}function tv(n){return n.button===0}/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function $o(n){return $o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$o(n)}function Ay(n,e){return Ay=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Ay(n,e)}function dW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nm(n,e,t){return dW()?Nm=Reflect.construct:Nm=function(i,s,o){var a=[null];a.push.apply(a,s);var l=Function.bind.apply(i,a),u=new l;return o&&Ay(u,o.prototype),u},Nm.apply(null,arguments)}function zi(n){return fW(n)||mW(n)||pW(n)||gW()}function fW(n){if(Array.isArray(n))return xy(n)}function mW(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function pW(n,e){if(!!n){if(typeof n=="string")return xy(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return xy(n,e)}}function xy(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function gW(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var yW=Object.hasOwnProperty,SR=Object.setPrototypeOf,wW=Object.isFrozen,vW=Object.getPrototypeOf,CW=Object.getOwnPropertyDescriptor,Fr=Object.freeze,is=Object.seal,EW=Object.create,Ex=typeof Reflect<"u"&&Reflect,lp=Ex.apply,My=Ex.construct;lp||(lp=function(e,t,r){return e.apply(t,r)});Fr||(Fr=function(e){return e});is||(is=function(e){return e});My||(My=function(e,t){return Nm(e,zi(t))});var bW=_i(Array.prototype.forEach),RR=_i(Array.prototype.pop),Oc=_i(Array.prototype.push),Im=_i(String.prototype.toLowerCase),i2=_i(String.prototype.toString),SW=_i(String.prototype.match),$i=_i(String.prototype.replace),RW=_i(String.prototype.indexOf),TW=_i(String.prototype.trim),xr=_i(RegExp.prototype.test),s2=AW(TypeError);function _i(n){return function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return lp(n,e,r)}}function AW(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return My(n,t)}}function pt(n,e,t){t=t||Im,SR&&SR(n,null);for(var r=e.length;r--;){var i=e[r];if(typeof i=="string"){var s=t(i);s!==i&&(wW(e)||(e[r]=s),i=s)}n[i]=!0}return n}function va(n){var e=EW(null),t;for(t in n)lp(yW,n,[t])===!0&&(e[t]=n[t]);return e}function hf(n,e){for(;n!==null;){var t=CW(n,e);if(t){if(t.get)return _i(t.get);if(typeof t.value=="function")return _i(t.value)}n=vW(n)}function r(i){return console.warn("fallback value for",i),null}return r}var TR=Fr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),o2=Fr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),a2=Fr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),xW=Fr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),l2=Fr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),MW=Fr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),AR=Fr(["#text"]),xR=Fr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),u2=Fr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),MR=Fr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),df=Fr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),NW=is(/\{\{[\w\W]*|[\w\W]*\}\}/gm),IW=is(/<%[\w\W]*|[\w\W]*%>/gm),OW=is(/\${[\w\W]*}/gm),_W=is(/^data-[\-\w.\u00B7-\uFFFF]/),LW=is(/^aria-[\-\w]+$/),PW=is(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),DW=is(/^(?:\w+script|data):/i),kW=is(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),FW=is(/^html$/i),HW=function(){return typeof window>"u"?null:window},UW=function(e,t){if($o(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(i)&&(r=t.currentScript.getAttribute(i));var s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}};function bx(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:HW(),e=function(ge){return bx(ge)};if(e.version="2.4.5",e.removed=[],!n||!n.document||n.document.nodeType!==9)return e.isSupported=!1,e;var t=n.document,r=n.document,i=n.DocumentFragment,s=n.HTMLTemplateElement,o=n.Node,a=n.Element,l=n.NodeFilter,u=n.NamedNodeMap,c=u===void 0?n.NamedNodeMap||n.MozNamedAttrMap:u,h=n.HTMLFormElement,d=n.DOMParser,f=n.trustedTypes,m=a.prototype,p=hf(m,"cloneNode"),y=hf(m,"nextSibling"),C=hf(m,"childNodes"),b=hf(m,"parentNode");if(typeof s=="function"){var v=r.createElement("template");v.content&&v.content.ownerDocument&&(r=v.content.ownerDocument)}var S=UW(f,t),L=S?S.createHTML(""):"",_=r,P=_.implementation,x=_.createNodeIterator,I=_.createDocumentFragment,R=_.getElementsByTagName,N=t.importNode,H={};try{H=va(r).documentMode?r.documentMode:{}}catch{}var K={};e.isSupported=typeof b=="function"&&P&&typeof P.createHTMLDocument<"u"&&H!==9;var X=NW,J=IW,ue=OW,se=_W,O=LW,g=DW,E=kW,A=PW,U=null,G=pt({},[].concat(zi(TR),zi(o2),zi(a2),zi(l2),zi(AR))),V=null,oe=pt({},[].concat(zi(xR),zi(u2),zi(MR),zi(df))),j=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ye=null,ee=null,T=!0,F=!0,Y=!1,q=!0,me=!1,Z=!1,Ce=!1,Re=!1,Ee=!1,Me=!1,Te=!1,k=!0,B=!1,z="user-content-",de=!0,ne=!1,fe={},le=null,ae=pt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),pe=null,te=pt({},["audio","video","img","source","image","track"]),he=null,Se=pt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),be="http://www.w3.org/1998/Math/MathML",_e="http://www.w3.org/2000/svg",$e="http://www.w3.org/1999/xhtml",Oe=$e,Ye=!1,Xe=null,ot=pt({},[be,_e,$e],i2),wt,Br=["application/xhtml+xml","text/html"],Vn="text/html",Ft,Pt=null,Ln=r.createElement("form"),mn=function(ge){return ge instanceof RegExp||ge instanceof Function},Jt=function(ge){Pt&&Pt===ge||((!ge||$o(ge)!=="object")&&(ge={}),ge=va(ge),wt=Br.indexOf(ge.PARSER_MEDIA_TYPE)===-1?wt=Vn:wt=ge.PARSER_MEDIA_TYPE,Ft=wt==="application/xhtml+xml"?i2:Im,U="ALLOWED_TAGS"in ge?pt({},ge.ALLOWED_TAGS,Ft):G,V="ALLOWED_ATTR"in ge?pt({},ge.ALLOWED_ATTR,Ft):oe,Xe="ALLOWED_NAMESPACES"in ge?pt({},ge.ALLOWED_NAMESPACES,i2):ot,he="ADD_URI_SAFE_ATTR"in ge?pt(va(Se),ge.ADD_URI_SAFE_ATTR,Ft):Se,pe="ADD_DATA_URI_TAGS"in ge?pt(va(te),ge.ADD_DATA_URI_TAGS,Ft):te,le="FORBID_CONTENTS"in ge?pt({},ge.FORBID_CONTENTS,Ft):ae,ye="FORBID_TAGS"in ge?pt({},ge.FORBID_TAGS,Ft):{},ee="FORBID_ATTR"in ge?pt({},ge.FORBID_ATTR,Ft):{},fe="USE_PROFILES"in ge?ge.USE_PROFILES:!1,T=ge.ALLOW_ARIA_ATTR!==!1,F=ge.ALLOW_DATA_ATTR!==!1,Y=ge.ALLOW_UNKNOWN_PROTOCOLS||!1,q=ge.ALLOW_SELF_CLOSE_IN_ATTR!==!1,me=ge.SAFE_FOR_TEMPLATES||!1,Z=ge.WHOLE_DOCUMENT||!1,Ee=ge.RETURN_DOM||!1,Me=ge.RETURN_DOM_FRAGMENT||!1,Te=ge.RETURN_TRUSTED_TYPE||!1,Re=ge.FORCE_BODY||!1,k=ge.SANITIZE_DOM!==!1,B=ge.SANITIZE_NAMED_PROPS||!1,de=ge.KEEP_CONTENT!==!1,ne=ge.IN_PLACE||!1,A=ge.ALLOWED_URI_REGEXP||A,Oe=ge.NAMESPACE||$e,j=ge.CUSTOM_ELEMENT_HANDLING||{},ge.CUSTOM_ELEMENT_HANDLING&&mn(ge.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(j.tagNameCheck=ge.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ge.CUSTOM_ELEMENT_HANDLING&&mn(ge.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(j.attributeNameCheck=ge.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ge.CUSTOM_ELEMENT_HANDLING&&typeof ge.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(j.allowCustomizedBuiltInElements=ge.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),me&&(F=!1),Me&&(Ee=!0),fe&&(U=pt({},zi(AR)),V=[],fe.html===!0&&(pt(U,TR),pt(V,xR)),fe.svg===!0&&(pt(U,o2),pt(V,u2),pt(V,df)),fe.svgFilters===!0&&(pt(U,a2),pt(V,u2),pt(V,df)),fe.mathMl===!0&&(pt(U,l2),pt(V,MR),pt(V,df))),ge.ADD_TAGS&&(U===G&&(U=va(U)),pt(U,ge.ADD_TAGS,Ft)),ge.ADD_ATTR&&(V===oe&&(V=va(V)),pt(V,ge.ADD_ATTR,Ft)),ge.ADD_URI_SAFE_ATTR&&pt(he,ge.ADD_URI_SAFE_ATTR,Ft),ge.FORBID_CONTENTS&&(le===ae&&(le=va(le)),pt(le,ge.FORBID_CONTENTS,Ft)),de&&(U["#text"]=!0),Z&&pt(U,["html","head","body"]),U.table&&(pt(U,["tbody"]),delete ye.tbody),Fr&&Fr(ge),Pt=ge)},xt=pt({},["mi","mo","mn","ms","mtext"]),Ar=pt({},["foreignobject","desc","title","annotation-xml"]),gi=pt({},["title","style","font","a","script"]),$n=pt({},o2);pt($n,a2),pt($n,xW);var Vi=pt({},l2);pt(Vi,MW);var Nc=function(ge){var ve=b(ge);(!ve||!ve.tagName)&&(ve={namespaceURI:Oe,tagName:"template"});var Ie=Im(ge.tagName),Rt=Im(ve.tagName);return Xe[ge.namespaceURI]?ge.namespaceURI===_e?ve.namespaceURI===$e?Ie==="svg":ve.namespaceURI===be?Ie==="svg"&&(Rt==="annotation-xml"||xt[Rt]):Boolean($n[Ie]):ge.namespaceURI===be?ve.namespaceURI===$e?Ie==="math":ve.namespaceURI===_e?Ie==="math"&&Ar[Rt]:Boolean(Vi[Ie]):ge.namespaceURI===$e?ve.namespaceURI===_e&&!Ar[Rt]||ve.namespaceURI===be&&!xt[Rt]?!1:!Vi[Ie]&&(gi[Ie]||!$n[Ie]):!!(wt==="application/xhtml+xml"&&Xe[ge.namespaceURI]):!1},ar=function(ge){Oc(e.removed,{element:ge});try{ge.parentNode.removeChild(ge)}catch{try{ge.outerHTML=L}catch{ge.remove()}}},Qe=function(ge,ve){try{Oc(e.removed,{attribute:ve.getAttributeNode(ge),from:ve})}catch{Oc(e.removed,{attribute:null,from:ve})}if(ve.removeAttribute(ge),ge==="is"&&!V[ge])if(Ee||Me)try{ar(ve)}catch{}else try{ve.setAttribute(ge,"")}catch{}},mt=function(ge){var ve,Ie;if(Re)ge="<remove></remove>"+ge;else{var Rt=SW(ge,/^[\r\n\t ]+/);Ie=Rt&&Rt[0]}wt==="application/xhtml+xml"&&Oe===$e&&(ge='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ge+"</body></html>");var Vr=S?S.createHTML(ge):ge;if(Oe===$e)try{ve=new d().parseFromString(Vr,wt)}catch{}if(!ve||!ve.documentElement){ve=P.createDocument(Oe,"template",null);try{ve.documentElement.innerHTML=Ye?L:Vr}catch{}}var wr=ve.body||ve.documentElement;return ge&&Ie&&wr.insertBefore(r.createTextNode(Ie),wr.childNodes[0]||null),Oe===$e?R.call(ve,Z?"html":"body")[0]:Z?ve.documentElement:wr},Dt=function(ge){return x.call(ge.ownerDocument||ge,ge,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},sn=function(ge){return ge instanceof h&&(typeof ge.nodeName!="string"||typeof ge.textContent!="string"||typeof ge.removeChild!="function"||!(ge.attributes instanceof c)||typeof ge.removeAttribute!="function"||typeof ge.setAttribute!="function"||typeof ge.namespaceURI!="string"||typeof ge.insertBefore!="function"||typeof ge.hasChildNodes!="function")},Ct=function(ge){return $o(o)==="object"?ge instanceof o:ge&&$o(ge)==="object"&&typeof ge.nodeType=="number"&&typeof ge.nodeName=="string"},pn=function(ge,ve,Ie){!K[ge]||bW(K[ge],function(Rt){Rt.call(e,ve,Ie,Pt)})},Pn=function(ge){var ve;if(pn("beforeSanitizeElements",ge,null),sn(ge)||xr(/[\u0080-\uFFFF]/,ge.nodeName))return ar(ge),!0;var Ie=Ft(ge.nodeName);if(pn("uponSanitizeElement",ge,{tagName:Ie,allowedTags:U}),ge.hasChildNodes()&&!Ct(ge.firstElementChild)&&(!Ct(ge.content)||!Ct(ge.content.firstElementChild))&&xr(/<[/\w]/g,ge.innerHTML)&&xr(/<[/\w]/g,ge.textContent)||Ie==="select"&&xr(/<template/i,ge.innerHTML))return ar(ge),!0;if(!U[Ie]||ye[Ie]){if(!ye[Ie]&&Fl(Ie)&&(j.tagNameCheck instanceof RegExp&&xr(j.tagNameCheck,Ie)||j.tagNameCheck instanceof Function&&j.tagNameCheck(Ie)))return!1;if(de&&!le[Ie]){var Rt=b(ge)||ge.parentNode,Vr=C(ge)||ge.childNodes;if(Vr&&Rt)for(var wr=Vr.length,lr=wr-1;lr>=0;--lr)Rt.insertBefore(p(Vr[lr],!0),y(ge))}return ar(ge),!0}return ge instanceof a&&!Nc(ge)||(Ie==="noscript"||Ie==="noembed")&&xr(/<\/no(script|embed)/i,ge.innerHTML)?(ar(ge),!0):(me&&ge.nodeType===3&&(ve=ge.textContent,ve=$i(ve,X," "),ve=$i(ve,J," "),ve=$i(ve,ue," "),ge.textContent!==ve&&(Oc(e.removed,{element:ge.cloneNode()}),ge.textContent=ve)),pn("afterSanitizeElements",ge,null),!1)},gn=function(ge,ve,Ie){if(k&&(ve==="id"||ve==="name")&&(Ie in r||Ie in Ln))return!1;if(!(F&&!ee[ve]&&xr(se,ve))){if(!(T&&xr(O,ve))){if(!V[ve]||ee[ve]){if(!(Fl(ge)&&(j.tagNameCheck instanceof RegExp&&xr(j.tagNameCheck,ge)||j.tagNameCheck instanceof Function&&j.tagNameCheck(ge))&&(j.attributeNameCheck instanceof RegExp&&xr(j.attributeNameCheck,ve)||j.attributeNameCheck instanceof Function&&j.attributeNameCheck(ve))||ve==="is"&&j.allowCustomizedBuiltInElements&&(j.tagNameCheck instanceof RegExp&&xr(j.tagNameCheck,Ie)||j.tagNameCheck instanceof Function&&j.tagNameCheck(Ie))))return!1}else if(!he[ve]){if(!xr(A,$i(Ie,E,""))){if(!((ve==="src"||ve==="xlink:href"||ve==="href")&&ge!=="script"&&RW(Ie,"data:")===0&&pe[ge])){if(!(Y&&!xr(g,$i(Ie,E,"")))){if(Ie)return!1}}}}}}return!0},Fl=function(ge){return ge.indexOf("-")>0},qs=function(ge){var ve,Ie,Rt,Vr;pn("beforeSanitizeAttributes",ge,null);var wr=ge.attributes;if(!!wr){var lr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:V};for(Vr=wr.length;Vr--;){ve=wr[Vr];var sf=ve,Kn=sf.name,H0=sf.namespaceURI;if(Ie=Kn==="value"?ve.value:TW(ve.value),Rt=Ft(Kn),lr.attrName=Rt,lr.attrValue=Ie,lr.keepAttr=!0,lr.forceKeepAttr=void 0,pn("uponSanitizeAttribute",ge,lr),Ie=lr.attrValue,!lr.forceKeepAttr&&(Qe(Kn,ge),!!lr.keepAttr)){if(!q&&xr(/\/>/i,Ie)){Qe(Kn,ge);continue}me&&(Ie=$i(Ie,X," "),Ie=$i(Ie,J," "),Ie=$i(Ie,ue," "));var bS=Ft(ge.nodeName);if(!!gn(bS,Rt,Ie)){if(B&&(Rt==="id"||Rt==="name")&&(Qe(Kn,ge),Ie=z+Ie),S&&$o(f)==="object"&&typeof f.getAttributeType=="function"&&!H0)switch(f.getAttributeType(bS,Rt)){case"TrustedHTML":Ie=S.createHTML(Ie);break;case"TrustedScriptURL":Ie=S.createScriptURL(Ie);break}try{H0?ge.setAttributeNS(H0,Kn,Ie):ge.setAttribute(Kn,Ie),RR(e.removed)}catch{}}}}pn("afterSanitizeAttributes",ge,null)}},wa=function Ve(ge){var ve,Ie=Dt(ge);for(pn("beforeSanitizeShadowDOM",ge,null);ve=Ie.nextNode();)pn("uponSanitizeShadowNode",ve,null),!Pn(ve)&&(ve.content instanceof i&&Ve(ve.content),qs(ve));pn("afterSanitizeShadowDOM",ge,null)};return e.sanitize=function(Ve){var ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ve,Ie,Rt,Vr,wr;if(Ye=!Ve,Ye&&(Ve="<!-->"),typeof Ve!="string"&&!Ct(Ve)){if(typeof Ve.toString!="function")throw s2("toString is not a function");if(Ve=Ve.toString(),typeof Ve!="string")throw s2("dirty is not a string, aborting")}if(!e.isSupported){if($o(n.toStaticHTML)==="object"||typeof n.toStaticHTML=="function"){if(typeof Ve=="string")return n.toStaticHTML(Ve);if(Ct(Ve))return n.toStaticHTML(Ve.outerHTML)}return Ve}if(Ce||Jt(ge),e.removed=[],typeof Ve=="string"&&(ne=!1),ne){if(Ve.nodeName){var lr=Ft(Ve.nodeName);if(!U[lr]||ye[lr])throw s2("root node is forbidden and cannot be sanitized in-place")}}else if(Ve instanceof o)ve=mt("<!---->"),Ie=ve.ownerDocument.importNode(Ve,!0),Ie.nodeType===1&&Ie.nodeName==="BODY"||Ie.nodeName==="HTML"?ve=Ie:ve.appendChild(Ie);else{if(!Ee&&!me&&!Z&&Ve.indexOf("<")===-1)return S&&Te?S.createHTML(Ve):Ve;if(ve=mt(Ve),!ve)return Ee?null:Te?L:""}ve&&Re&&ar(ve.firstChild);for(var sf=Dt(ne?Ve:ve);Rt=sf.nextNode();)Rt.nodeType===3&&Rt===Vr||Pn(Rt)||(Rt.content instanceof i&&wa(Rt.content),qs(Rt),Vr=Rt);if(Vr=null,ne)return Ve;if(Ee){if(Me)for(wr=I.call(ve.ownerDocument);ve.firstChild;)wr.appendChild(ve.firstChild);else wr=ve;return(V.shadowroot||V.shadowrootmod)&&(wr=N.call(t,wr,!0)),wr}var Kn=Z?ve.outerHTML:ve.innerHTML;return Z&&U["!doctype"]&&ve.ownerDocument&&ve.ownerDocument.doctype&&ve.ownerDocument.doctype.name&&xr(FW,ve.ownerDocument.doctype.name)&&(Kn="<!DOCTYPE "+ve.ownerDocument.doctype.name+`>
`+Kn),me&&(Kn=$i(Kn,X," "),Kn=$i(Kn,J," "),Kn=$i(Kn,ue," ")),S&&Te?S.createHTML(Kn):Kn},e.setConfig=function(Ve){Jt(Ve),Ce=!0},e.clearConfig=function(){Pt=null,Ce=!1},e.isValidAttribute=function(Ve,ge,ve){Pt||Jt({});var Ie=Ft(Ve),Rt=Ft(ge);return gn(Ie,Rt,ve)},e.addHook=function(Ve,ge){typeof ge=="function"&&(K[Ve]=K[Ve]||[],Oc(K[Ve],ge))},e.removeHook=function(Ve){if(K[Ve])return RR(K[Ve])},e.removeHooks=function(Ve){K[Ve]&&(K[Ve]=[])},e.removeAllHooks=function(){K={}},e}var BW=bx();function ts(n){return n[0].toUpperCase()+n.substr(1)}function Sx(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()}function Rx(n){return/^([0-9][0-9]?%$)|(^100%$)/.test(n)}function Tx(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${n}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,r)=>t.charAt(0)==="\\"?t.substr(1,t.length-1):e[r]===void 0?"":e[r])}function NR(n){return nv(`${n}`,{ALLOWED_TAGS:[]})}function nv(n,e){return BW.sanitize(n,e)}function VW(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,r=null,i=n;for(;i!==null;){if(t===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(t+=1,i=i.parentNode)}return r}function $W(n){return Object.getPrototypeOf(n.parent)&&n.frameElement}function up(n){return $W(n)&&n.parent}function el(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=n;for(;s!=null&&s!==t;){const{nodeType:o,nodeName:a}=s;if(o===r&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===i?s=l:s=s.parentNode}return null}function ff(n,e,t){const r=[];let i=n;for(;i&&(i=el(i,e,t),!(!i||t&&!t.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const s=r.length;return s?r[s-1]:null}function tl(n,e){let t=n.parentNode,r=[];for(typeof e=="string"?n.defaultView?r=Array.prototype.slice.call(n.querySelectorAll(e),0):r=Array.prototype.slice.call(n.ownerDocument.querySelectorAll(e),0):r.push(e);t!==null;){if(r.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function WW(n){let e=0,t=n;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}function Ca(n,e,t){const r=t.parentElement.querySelector(`.ht_clone_${n}`);return r?r.contains(e):null}function Ax(n){return!n||!n.length?[]:n.filter(e=>!!e)}function Je(n,e){return n.classList===void 0||typeof e!="string"||e===""?!1:n.classList.contains(e)}function Ae(n,e){typeof e=="string"&&(e=e.split(" ")),e=Ax(e),e.length>0&&n.classList.add(...e)}function tt(n,e){typeof e=="string"&&(e=e.split(" ")),e=Ax(e),e.length>0&&n.classList.remove(...e)}function xx(n){if(n.nodeType===3)n.parentNode.removeChild(n);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(n.nodeName)>-1){const e=n.childNodes;for(let t=e.length-1;t>=0;t--)xx(e[t])}}function ks(n){let e;for(;e=n.lastChild;)n.removeChild(e)}const GW=/(<(.*)>|&(.*);)/;function pc(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;GW.test(e)?n.innerHTML=t?nv(e):e:ol(n,e)}function ol(n,e){const t=n.firstChild;t&&t.nodeType===3&&t.nextSibling===null?t.textContent=e:(ks(n),n.appendChild(n.ownerDocument.createTextNode(e)))}function Gh(n){const e=n.ownerDocument.documentElement;let t=n;for(;t!==e;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return Gh(t.host.impl);if(t.host)return Gh(t.host);throw new Error("Lost in Web Components world")}else return!1;else if(t.style&&t.style.display==="none")return!1;t=t.parentNode}return!0}function Hn(n){const e=n.ownerDocument,t=e.defaultView,r=e.documentElement;let i=n,s,o,a;for(s=i.offsetLeft,o=i.offsetTop,a=i;(i=i.offsetParent)&&i!==e.body;)s+=i.offsetLeft,o+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(s+=t.pageXOffset||r.scrollLeft,o+=t.pageYOffset||r.scrollTop),{left:s,top:o}}function zh(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Yu(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function cp(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?zh(e):n.scrollTop}function Ny(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?Yu(e):n.scrollLeft}function hp(n){let e=n.ownerDocument,t=e?e.defaultView:void 0;e||(e=n.document?n.document:n,t=e.defaultView);const r=["auto","scroll"];let i=n.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:o,overflowY:a}=i.style;if([s,o,a].includes("scroll"))return i;if({overflow:s,overflowX:o,overflowY:a}=t.getComputedStyle(i),r.includes(s)||r.includes(o)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(s))||i.clientWidth<=i.scrollWidth+1&&(r.includes(o)||r.includes(s)))return i;i=i.parentNode}return t}function ju(n){const e=n.ownerDocument,t=e.defaultView;let r=n.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=al(r,t),s=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return r;r=r.parentNode}return t}function Yh(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(n){if(n===t)return e==="width"?`${t.innerWidth}px`:e==="height"?`${t.innerHeight}px`:void 0}else return;const r=n.style[e];if(r!==""&&r!==void 0)return r;const i=al(n,t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function al(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n.currentStyle||e.getComputedStyle(n)}function Bt(n){return n.offsetWidth}function cn(n){return n.offsetHeight}function Yo(n){return n.clientHeight||n.innerHeight}function Om(n){return n.clientWidth||n.innerWidth}function Mx(n){return n.selectionStart?n.selectionStart:0}function zW(n){return n.selectionEnd?n.selectionEnd:0}function YW(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=n.document;let t="";return n.getSelection?t=n.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(t=e.selection.createRange().text),t}function IR(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;n.getSelection&&(n.getSelection().empty?n.getSelection().empty():n.getSelection().removeAllRanges&&n.getSelection().removeAllRanges())}function Bg(n,e,t){if(t===void 0&&(t=e),n.setSelectionRange){n.focus();try{n.setSelectionRange(e,t)}catch{const i=n.parentNode,s=i.style.display;i.style.display="block",n.setSelectionRange(e,t),i.style.display=s}}}let c2;function jW(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=n.createElement("div");e.style.height="200px",e.style.width="100%";const t=n.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(n.body||n.documentElement).appendChild(t);const r=e.offsetWidth;t.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=t.clientWidth),(n.body||n.documentElement).removeChild(t),r-i}function er(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return c2===void 0&&(c2=jW(n)),c2}function KW(n){return n.offsetWidth!==n.clientWidth}function qW(n){return n.offsetHeight!==n.clientHeight}function rv(n,e,t){n.style.transform=`translate3d(${e},${t},0)`}function Vg(n){n.style.transform&&n.style.transform!==""&&(n.style.transform="")}function dp(n){return n&&(["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||n.contentEditable==="true")}function iv(n){return dp(n)&&n.hasAttribute("data-hot-input")===!1}function XW(n){const e=n.ownerDocument.activeElement;iv(e)||n.select()}function Nx(n){return!n.parentNode}function QW(n,e){new IntersectionObserver((r,i)=>{r.forEach(s=>{s.isIntersecting&&n.offsetParent!==null&&(e(),i.unobserve(n))})},{root:n.ownerDocument.body}).observe(n)}function Xt(){De(console)&&console.warn(...arguments)}function sv(){De(console)&&console.error(...arguments)}function qt(n){return typeof n=="function"}function Ix(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,r;function i(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t&&clearTimeout(t),t=setTimeout(()=>{r=n.apply(this,o)},e),r}return i}function Ox(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n.apply(this,t.concat(o))}}function ZW(n){const e=n.length;function t(r){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=r.concat(o);let u;return l.length>=e?u=n.apply(this,l):u=t(l),u}}return t([])}function Iy(n,e,t,r,i,s,o,a){return De(a)?n.call(e,t,r,i,s,o,a):De(o)?n.call(e,t,r,i,s,o):De(s)?n.call(e,t,r,i,s):De(i)?n.call(e,t,r,i):De(r)?n.call(e,t,r):De(t)?n.call(e,t):n.call(e)}const Ul=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],JW=Vt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,h2=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),d2=new Map([]);class _x{static getSingleton(){return tG()}constructor(){this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return re(Ul,t=>e[t]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(t))re(t,i=>this.add(e,i,r));else{h2.has(e)&&Xt(Tx(JW,{hookName:e,removedInVersion:h2.get(e)})),d2.has(e)&&Xt(d2.get(e));const i=this.getBucket(r);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),t.skip=!1,i[e].indexOf(t)===-1){let s=!1;t.initialHook&&re(i[e],(o,a)=>{if(o.initialHook)return i[e][a]=t,s=!0,!1}),s||i[e].push(t)}}return this}once(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(t)?re(t,i=>this.once(e,i,r)):(t.runOnce=!0,this.add(e,t,r))}remove(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(t)>=0?(t.skip=!0,!0):!1}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(t);return!!(r[e]!==void 0&&r[e].length)}run(e,t,r,i,s,o,a,l){{const u=this.globalBucket[t],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Iy(u[h],e,r,i,s,o,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(t,u[h]),h+=1}}{const u=this.getBucket(e)[t],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Iy(u[h],e,r,i,s,o,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(t,u[h],e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ft(this.getBucket(e),(t,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||Ul.push(e)}deregister(e){this.isRegistered(e)&&Ul.splice(Ul.indexOf(e),1)}isDeprecated(e){return d2.has(e)||h2.has(e)}isRegistered(e){return Ul.indexOf(e)>=0}getRegistered(){return Ul}}const eG=new _x;function tG(){return eG}const Ue=_x,f2=new Map;function Hi(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";f2.has(n)||f2.set(n,new Map);const e=f2.get(n);function t(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function s(){return[...e.keys()]}function o(){return[...e.values()]}return{register:t,getItem:r,hasItem:i,getNames:s,getValues:o}}const Oy=new WeakMap,{register:nG,getItem:Lx,hasItem:Px,getNames:gCe,getValues:yCe}=Hi("editors");function rG(n){const e={},t=n;this.getConstructor=function(){return n},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new t(r)),e[r.guid]},Ue.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function Dx(n,e){let t;if(typeof n=="function")Oy.get(n)||li(null,n),t=Oy.get(n);else if(typeof n=="string")t=Lx(n);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error(`No editor registered under name "${n}"`);return t.getInstance(e)}function OR(n){if(typeof n=="function")return n;if(!Px(n))throw Error(`No registered editor found under "${n}" name`);return Lx(n).getConstructor()}function li(n,e){n&&typeof n!="string"&&(e=n,n=e.EDITOR_TYPE);const t=new rG(e);typeof n=="string"&&nG(n,t),Oy.set(e,t)}class iG{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){r.call(this,sG(o))}return this.context.eventListeners.push({element:e,event:t,callback:r,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(t,s,i),()=>{this.removeEventListener(e,t,r)}}removeEventListener(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===t&&o.element===e){if(r&&r!==o.callback||i&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const r=this.context.eventListeners[t];e&&r.eventManager!==this||(this.context.eventListeners.splice(t,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const s={bubbles:!0,cancelable:t!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let o;r.createEvent?(o=r.createEvent("MouseEvents"),o.initMouseEvent(t,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,r.body.parentNode)):o=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${t}`,o)}}function sG(n){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=function(){e.apply(this),Ds(this)},n}const dn=iG,$g="editorManager.navigation",ph="editorManager.handlingEditor";class _y{constructor(e,t,r){this.instance=e,this.tableMeta=t,this.selection=r,this.eventManager=new dn(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.getShortcutManager().addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",s=>this.onAfterDocumentKeyDown(s)),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",s=>{!this.destroyed&&this.instance.isListening()&&this.openEditor("",s)}),this.instance.view._wt.update("onCellDblClick",(s,o,a)=>this.onCellDblClick(s,o,a))}registerShortcuts(){const e=this.instance.getShortcutManager(),t=e.getContext("grid"),r=e.getContext("editor"),i={group:ph};r.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(s,o)=>{this.closeEditorAndSaveChanges(e.isCtrlPressed()),this.moveSelectionAfterEnter(o.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>{this.closeEditorAndRestoreOriginalValue(e.isCtrlPressed()),this.activeEditor.focus()}}],i),t.addShortcuts([{keys:[["F2"]],callback:s=>{this.openEditor(null,s,!0)}},{keys:[["Backspace"],["Delete"]],callback:()=>{this.instance.emptySelectedCells(),this.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:(s,o)=>{this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.openEditor(null,s,!0):this.moveSelectionAfterEnter(o.includes("shift")),Ds(s)}}],{...i,runOnlyIf:()=>De(this.instance.getSelected())})}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,l=>{l&&this.prepareEditor()});return}const{row:e,col:t}=this.instance.getSelectedRangeLast().highlight,r=this.instance.runHooks("modifyGetCellCoords",e,t);let i=e,s=t;Array.isArray(r)&&([i,s]=r),this.cellProperties=this.instance.getCellMeta(i,s);const{activeElement:o}=this.instance.rootDocument;if(o&&iv(o)&&o.blur(),!this.isCellEditable()){this.clearActiveEditor();return}const a=this.instance.getCell(e,t,!0);if(a){const l=this.instance.getCellEditor(this.cellProperties),u=this.instance.colToProp(s),c=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(i),s);this.activeEditor=Dx(l,this.instance),this.activeEditor.prepare(e,t,u,a,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){const{row:i,col:s}=this.instance.getSelectedRangeLast().highlight,o=this.instance.rowIndexMapper.getRenderableFromVisualIndex(i),a=this.instance.columnIndexMapper.getRenderableFromVisualIndex(s);this.instance.view.scrollViewport(this.instance._createCellCoords(o,a)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,r){this.activeEditor?this.activeEditor.finishEditing(e,t,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.instance.getCellEditor(this.cellProperties),{row:t,col:r}=this.instance.getSelectedRangeLast().highlight,{rowIndexMapper:i,columnIndexMapper:s}=this.instance,o=i.isHidden(this.instance.toPhysicalRow(t))||s.isHidden(this.instance.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!e||o)}moveSelectionAfterEnter(e){const t=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}onAfterDocumentKeyDown(e){if(!this.instance.isListening())return;const{keyCode:t}=e;if(!this.selection.isSelected())return;const r=(e.ctrlKey||e.metaKey)&&!e.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Cx(t)&&!hW(t)&&!r&&!this.isEditorOpened()){const s=this.instance.getShortcutManager().getContext("editor"),o={runOnlyIf:()=>De(this.instance.getSelected()),group:$g};s.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.instance.selection.transformStart(0,-1*this.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.instance.selection.transformStart(0,this.instance.getDirectionFactor())}}],o),this.openEditor("",e)}}onCellDblClick(e,t,r){r.nodeName==="TD"&&this.openEditor(null,e,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}const _R=new WeakMap;_y.getInstance=function(n,e,t){let r=_R.get(n);return r||(r=new _y(n,e,t),_R.set(n,r)),r};const oG=_y,aG="hooksRefRegisterer",kx={_hooksStorage:Object.create(null),addHook(n,e){return this._hooksStorage[n]||(this._hooksStorage[n]=[]),this.hot.addHook(n,e),this._hooksStorage[n].push(e),this},removeHooksByKey(n){re(this._hooksStorage[n]||[],e=>{this.hot.removeHook(n,e)})},clearHooks(){ft(this._hooksStorage,(n,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Ro(kx,"MIXIN_NAME",aG,{writable:!1,enumerable:!1});const lG=kx,uG="base",Xn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Ly="baseEditor";class gc{static get EDITOR_TYPE(){return uG}constructor(e){this.hot=e,this.instance=e,this.state=Xn.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,r,i,s,o){this.TD=i,this.row=e,this.col=t,this.prop=r,this.originalValue=s,this.cellProperties=o,this.state=Xn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let r,i,s,o;if(t){const h=this.hot.getSelectedLast();r=Math.max(Math.min(h[0],h[2]),0),i=Math.max(Math.min(h[1],h[3]),0),s=Math.max(h[0],h[2]),o=Math.max(h[1],h[3])}else[r,i,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>De(this.hot.getSelected()),group:Ly};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,i,e,s,o,"edit")}beginEditing(e,t){if(this.state!==Xn.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,s)),this.state=Xn.EDITING,this.isInFullEditMode()){const o=typeof e=="string"?e:In(this.originalValue);this.setValue(o)}this.open(t),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,r){let i;if(r){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),r(l),this.hot.view.render()}}if(this.isWaiting())return;const o=this.hot.getShortcutManager().getContext("editor");if(o.removeShortcutsByGroup(Ly),o.removeShortcutsByGroup($g),this.state===Xn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Xn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=Xn.WAITING,this.saveValue(i,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=Xn.FINISHED,this.discardEditor(l)}):(this.state=Xn.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=Xn.FINISHED,this.discardEditor()}discardEditor(e){this.state===Xn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Xn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Xn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Xn.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,o=Hn(t),a=Bt(t),l=Hn(this.hot.rootElement),u=Bt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==s?c.scrollTop:0,f=h!==s?h.scrollLeft:0,m=s.innerWidth-l.left-u,{wtTable:p}=(e=r.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,y=p.name,C=["master","inline_start"].includes(y)?d:0,b=["master","top","bottom"].includes(y)?f:0,v=o.top===l.top?0:1;let S=o.top-l.top-v-C,L=0;this.hot.isRtl()?L=s.innerWidth-o.left-a-m-1+b:L=o.left-l.left-1-b,["top","top_inline_start_corner"].includes(y)&&(S+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(L+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const _=this.hot.hasColHeaders(),P=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),x=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),R=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(_&&P<=0||P===R)&&(S+=1),x<=0&&(L+=1);const N=i.rowsRenderCalculator.startPosition,H=i.columnsRenderCalculator.startPosition,K=Math.abs(r.inlineStartOverlay.getScrollPosition()),X=r.topOverlay.getScrollPosition(),J=er(this.hot.rootDocument),ue=t.offsetTop+N-X;let se=0;if(this.hot.isRtl()){const ee=t.offsetLeft;ee>=0?se=p.getWidth()-t.offsetLeft:se=Math.abs(ee),se+=H-K-a}else se=t.offsetLeft+H-K;const O=al(this.TD,this.hot.rootWindow),g=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",E=parseInt(O[g],10)>0?0:1,A=parseInt(O.borderTopWidth,10)>0?0:1,U=Bt(t)+E,G=cn(t)+A,V=KW(c)?J:0,oe=qW(h)?J:0,j=this.hot.view.maximumVisibleElementWidth(se)-V+E,ye=Math.max(this.hot.view.maximumVisibleElementHeight(ue)-oe+A,23);return{top:S,start:L,height:G,maxHeight:ye,width:U,maxWidth:j}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}Yt(gc,lG);function zr(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=typeof n;if(t==="number")return!isNaN(n)&&isFinite(n);if(t==="string"){if(n.length===0)return!1;if(n.length===1)return/\d/.test(n);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(n.trim())}else if(t==="object")return!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date);return!1}function cG(n){return zr(n,[","])}function ze(n,e,t){let r=-1;for(typeof e=="function"?(t=e,e=n):r=n-1;++r<=e&&t(r)!==!1;);}function Py(n,e,t){let r=n+1;for(typeof e=="function"&&(t=e,e=0);--r>=e&&t(r)!==!1;);}function Fx(n,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(n*e/100,10)}function hG(){var n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},e,t=document.body,r=document.createTextNode(""),i=document.createElement("SPAN"),s=function(d,f,m){d.addEventListener(f,m,!1)},o=function(d,f,m){d.removeEventListener(f,m,!1)},a=function(d){var f,m;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",r.textContent!==void 0?r.textContent=e.value+d:r.data=e.value+d,i.style.position="absolute",i.style.fontSize=h(e).fontSize,i.style.fontFamily=h(e).fontFamily,i.style.whiteSpace="pre",t.appendChild(i),f=i.clientWidth+2,t.removeChild(i),e.style.height=n.minHeight+"px",n.minWidth>f?e.style.width=n.minWidth+"px":f>n.maxWidth?e.style.width=n.maxWidth+"px":e.style.width=f+"px",m=e.scrollHeight?e.scrollHeight-1:0,n.minHeight>m?e.style.height=n.minHeight+"px":n.maxHeight<m?(e.style.height=n.maxHeight+"px",e.style.overflowY="visible"):e.style.height=m+"px"},l=function(){window.setTimeout(a,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")n.minHeight=e.clientHeight;else{var f=parseInt(d.minHeight);isNaN(f)||(n.minHeight=f)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")n.maxHeight=e.clientHeight;else{var m=parseInt(d.maxHeight);isNaN(m)||(n.maxHeight=m)}if(d&&d.minWidth)if(d.minWidth=="inherit")n.minWidth=e.clientWidth;else{var p=parseInt(d.minWidth);isNaN(p)||(n.minWidth=p)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")n.maxWidth=e.clientWidth;else{var y=parseInt(d.maxWidth);isNaN(y)||(n.maxWidth=y)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))},c=function(d,f,m){e=d,u(f),e.nodeName=="TEXTAREA"&&(e.style.resize="none",e.style.overflowY="",e.style.height=n.minHeight+"px",e.style.minWidth=n.minWidth+"px",e.style.maxWidth=n.maxWidth+"px",e.style.overflowY="hidden"),m&&(s(e,"change",a),s(e,"cut",l),s(e,"paste",l),s(e,"drop",l),s(e,"keydown",l),s(e,"focus",a),s(e,"compositionstart",l),s(e,"compositionupdate",l),s(e,"compositionend",l)),a()};function h(d){return d.currentStyle||document.defaultView.getComputedStyle(d)}return{init:function(d,f,m){c(d,f,m)},unObserve:function(){o(e,"change",a),o(e,"cut",l),o(e,"paste",l),o(e,"drop",l),o(e,"keydown",l),o(e,"focus",a),o(e,"compositionstart",l),o(e,"compositionupdate",l),o(e,"compositionend",l)},resize:a}}function LR(n,e){const t=Mx(e),r=e.value.split(`
`);let i=t,s=0;for(let o=0;o<r.length;o++){const a=r[o];o!==0&&(s+=r[o-1].length+1);const l=s+a.length;if(n==="home"?i=s:n==="end"&&(i=l),t<=l)break}Bg(e,i)}const dG="ht_editor_visible",mf="ht_editor_hidden",PR="textEditor",fG="text";class xl extends gc{static get EDITOR_TYPE(){return fG}constructor(e){super(e),this.eventManager=new dn(this),this.autoResize=hG(),this.TEXTAREA=void 0,this.textareaStyle=void 0,this.TEXTAREA_PARENT=void 0,this.textareaParentStyle=void 0,this.layerClass=void 0,this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",t=>this.onAfterDocumentKeyDown(t)),this.registerShortcuts()}close(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(e,t,r,i,s,o){const a=this.state;if(super.prepare(e,t,r,i,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l,fragmentSelection:u}=o;l&&(this.TEXTAREA.value=""),a!==Xn.FINISHED&&this.hideEditableElement(),!u&&!Ns()&&this.focus()}}beginEditing(e,t){this.state===Xn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),Bg(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Ae(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Ae(this.TEXTAREA_PARENT,"handsontableInputHolder"),Je(this.TEXTAREA_PARENT,this.layerClass)&&tt(this.TEXTAREA_PARENT,this.layerClass),Ae(this.TEXTAREA_PARENT,mf),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){lW()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",tt(this.TEXTAREA_PARENT,this.layerClass),Ae(this.TEXTAREA_PARENT,mf)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;ze(e.length-1,r=>{const i=e[r];if(Je(i,"handsontableEditor"))return t=!0,!1}),Je(this.TEXTAREA_PARENT,mf)&&tt(this.TEXTAREA_PARENT,mf),t?(this.layerClass=dG,Ae(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Ae(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Xn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:t,start:r,width:i,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=al(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=al(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),h=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),d=i-c,f=o-h,m=s-c,p=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,m),minHeight:Math.min(f,p),maxWidth:m,maxHeight:p},!0)}bindEvents(){this.eventManager.addEventListener(this.TEXTAREA,"cut",e=>e.stopPropagation()),this.eventManager.addEventListener(this.TEXTAREA,"paste",e=>e.stopPropagation()),wx()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>De(this.hot.getSelected()),group:PR},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Tab"]],callback:s=>{const o=this.hot.getSettings(),a=typeof o.tabMoves=="function"?o.tabMoves(s):o.tabMoves;this.hot.selection.transformStart(a.row,a.col,!0)}},{keys:[["Shift","Tab"]],callback:s=>{const o=this.hot.getSettings(),a=typeof o.tabMoves=="function"?o.tabMoves(s):o.tabMoves;this.hot.selection.transformStart(-a.row,-a.col)}},{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey,relativeToGroup:ph,position:"before"},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple(),relativeToGroup:ph,position:"before"},{keys:[["Alt","Enter"]],callback:()=>(i(),!1),relativeToGroup:ph,position:"before"},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;LR(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;LR(a,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}}],r)}unregisterShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");t.removeShortcutsByGroup($g),t.removeShortcutsByGroup(PR),t.removeShortcutsByGroup(Ly)}onAfterDocumentKeyDown(e){[Ge.ARROW_UP,Ge.ARROW_RIGHT,Ge.ARROW_DOWN,Ge.ARROW_LEFT].indexOf(e.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}const DR="handsontableEditor",mG="handsontable";class ov extends xl{static get EDITOR_TYPE(){return mG}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Bg(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Un(l,o.handsontable),this.htOptions=l}beginEditing(e,t){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getInstance().getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,t,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:DR,relativeToGroup:$g,position:"before"},i=(s,o)=>{const a=this.htEditor.getInstance();if(s!==void 0&&(s<0||a.flipped&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),Ds(o),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor.getInstance();let a,l;return!o.getSelectedLast()&&o.flipped?a=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(l=o.getSelectedLast()[0],a=Math.max(0,l-1)):(l=o.getSelectedLast()[0],a=l-1)),i(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor.getInstance();let a,l;if(!o.getSelectedLast()&&!o.flipped)a=0;else if(o.getSelectedLast()){if(o.flipped)a=o.getSelectedLast()[0]+1;else if(!o.flipped){const u=o.countRows()-1;l=o.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,s)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(DR)}}const pG="base";function Dd(n,e,t,r,i,s,o){const a=[],l=[];o.className&&Ae(e,o.className),o.readOnly&&a.push(o.readOnlyCellClassName),o.valid===!1&&o.invalidCellClassName?a.push(o.invalidCellClassName):l.push(o.invalidCellClassName),o.wordWrap===!1&&o.noWordWrapClassName&&a.push(o.noWordWrapClassName),!s&&o.placeholder&&a.push(o.placeholderCellClassName),tt(e,l),Ae(e,a)}Dd.RENDERER_TYPE=pG;const gG="text";function To(n,e,t,r,i,s,o){Dd.apply(this,[n,e,t,r,i,s,o]);let a=s;if(!a&&o.placeholder&&(a=o.placeholder),a=In(a),o.trimWhitespace&&(a=a.trim()),o.rendererTemplate){ks(e);const l=n.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=n.getSourceDataAtRow(t),e.appendChild(l)}else ol(e,a)}To.RENDERER_TYPE=gG;function yG(n,e,t){return e=wG(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wG(n){var e=vG(n,"string");return typeof e=="symbol"?e:String(e)}function vG(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const m2=new WeakMap,CG="autocomplete";class av extends ov{static get EDITOR_TYPE(){return CG}constructor(e){super(e),yG(this,"sortByRelevance",function(t,r,i){const s=[],o=[],a=t.length;let l=r.length,u,c,h,d;if(a===0){for(h=0;h<l;h++)o.push(h);return o}for(h=0;h<l;h++){if(c=NR(In(r[h])),i)d=c.indexOf(t);else{const f=this.cellProperties.locale;d=c.toLocaleLowerCase(f).indexOf(t.toLocaleLowerCase(f))}d!==-1&&(u=c.length-d-a,s.push({baseIndex:h,index:d,charsLeft:u,value:c}))}for(s.sort((f,m)=>{if(m.index===-1)return-1;if(f.index===-1)return 1;if(f.index<m.index)return-1;if(m.index<f.index)return 1;if(f.index===m.index){if(f.charsLeft<m.charsLeft)return-1;if(f.charsLeft>m.charsLeft)return 1}return 0}),h=0,l=s.length;h<l;h++)o.push(s[h].baseIndex);return o}),this.query=null,this.strippedChoices=[],this.rawChoices=[],m2.set(this,{skipOne:!1,isMacOS:this.hot.rootWindow.navigator.platform.indexOf("Mac")>-1})}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return De(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Ae(this.htContainer,"autocompleteEditor"),Ae(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}open(){const e=m2.get(this);super.open();const t=this.htEditor.getInstance(),r=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();let i=er();i===0&&e.isMacOS&&(i+=15),this.addHook("beforeKeyDown",s=>this.onBeforeKeyDown(s)),t.updateSettings({colWidths:r?[Bt(this.TEXTAREA)-2]:void 0,width:r?Bt(this.TEXTAREA)+i:void 0,renderer:(s,o,a,l,u,c,h)=>{To(s,o,a,l,u,c,h);const{filteringCaseSensitive:d,allowHtml:f,locale:m}=this.cellProperties,p=this.query;let y=In(c),C,b;y&&!f&&(C=d===!0?y.indexOf(p):y.toLocaleLowerCase(m).indexOf(p.toLocaleLowerCase(m)),C!==-1&&(b=y.substr(C,p.length),y=y.replace(b,`<strong>${b}</strong>`))),o.innerHTML=y},autoColumnSize:!0}),e.skipOne&&(e.skipOne=!1),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close()}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=Mx(this.TEXTAREA),r=zW(this.TEXTAREA),i=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let o=null,a=null,l=e;i&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(o)?o.length:0;if(s===!1)u&&(a=o[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[o[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(Mm([l])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a),this.hot.listen(),Bg(this.TEXTAREA,t,t===r?void 0:r)}flipDropdownIfNeeded(){const e=ju(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(t||!t&&(r||r==="horizontal"))return!1;const i=Hn(this.TEXTAREA),s=cn(this.TEXTAREA),o=this.getDropdownHeight(),a=e.scrollTop,l=cn(this.hot.view._wt.wtTable.THEAD),u=Hn(e),c=i.top-u.top-l+a,h=e.scrollHeight-c-l-s,d=o>h&&c>h;return d?this.flipDropdown(o):this.unflipDropdown(),this.limitDropdownIfNeeded(d?c:h,o),d}limitDropdownIfNeeded(e,t){if(t>e){let r=0,i=0,s=0,o=null;do s=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=s,i+=1;while(r<e);o=r-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-o}px`),this.setDropdownHeight(r-s)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+er(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,r=ct(e,s=>In(s));return ct(r,s=>t?s:NR(s))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),r={row:t?t.from.row:-1};let i=!1;return e===Ge.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===Ge.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){const t=m2.get(this);if(t.skipOne=!1,cW(e.keyCode)||e.keyCode===Ge.BACKSPACE||e.keyCode===Ge.DELETE||e.keyCode===Ge.INSERT){let r=10;if(e.keyCode===Ge.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value),t.skipOne=!0},r)}}}const EG="checkbox";class Hx extends gc{static get EDITOR_TYPE(){return EG}beginEditing(e,t){if(t&&t.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');Je(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var Ux={exports:{}};const bG=iA(Ak);/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(n,e){(function(t,r){var i;{try{i=bG}catch{}n.exports=r(i)}})(Go,function(t){var r=typeof t=="function",i=!!window.addEventListener,s=window.document,o=window.setTimeout,a=function(O,g,E,A){i?O.addEventListener(g,E,!!A):O.attachEvent("on"+g,E)},l=function(O,g,E,A){i?O.removeEventListener(g,E,!!A):O.detachEvent("on"+g,E)},u=function(O){return O.trim?O.trim():O.replace(/^\s+|\s+$/g,"")},c=function(O,g){return(" "+O.className+" ").indexOf(" "+g+" ")!==-1},h=function(O,g){c(O,g)||(O.className=O.className===""?g:O.className+" "+g)},d=function(O,g){O.className=u((" "+O.className+" ").replace(" "+g+" "," "))},f=function(O){return/Array/.test(Object.prototype.toString.call(O))},m=function(O){return/Date/.test(Object.prototype.toString.call(O))&&!isNaN(O.getTime())},p=function(O){var g=O.getDay();return g===0||g===6},y=function(O){return O%4===0&&O%100!==0||O%400===0},C=function(O,g){return[31,y(O)?29:28,31,30,31,30,31,31,30,31,30,31][g]},b=function(O){m(O)&&O.setHours(0,0,0,0)},v=function(O,g){return O.getTime()===g.getTime()},S=function(O,g,E){var A,U;for(A in g)U=O[A]!==void 0,U&&typeof g[A]=="object"&&g[A]!==null&&g[A].nodeName===void 0?m(g[A])?E&&(O[A]=new Date(g[A].getTime())):f(g[A])?E&&(O[A]=g[A].slice(0)):O[A]=S({},g[A],E):(E||!U)&&(O[A]=g[A]);return O},L=function(O,g,E){var A;s.createEvent?(A=s.createEvent("HTMLEvents"),A.initEvent(g,!0,!1),A=S(A,E),O.dispatchEvent(A)):s.createEventObject&&(A=s.createEventObject(),A=S(A,E),O.fireEvent("on"+g,A))},_=function(O){return O.month<0&&(O.year-=Math.ceil(Math.abs(O.month)/12),O.month+=12),O.month>11&&(O.year+=Math.floor(Math.abs(O.month)/12),O.month-=12),O},P={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},x=function(O,g,E){for(g+=O.firstDay;g>=7;)g-=7;return E?O.i18n.weekdaysShort[g]:O.i18n.weekdays[g]},I=function(O){var g=[],E="false";if(O.isEmpty)if(O.showDaysInNextAndPreviousMonths)g.push("is-outside-current-month"),O.enableSelectionDaysInNextAndPreviousMonths||g.push("is-selection-disabled");else return'<td class="is-empty"></td>';return O.isDisabled&&g.push("is-disabled"),O.isToday&&g.push("is-today"),O.isSelected&&(g.push("is-selected"),E="true"),O.hasEvent&&g.push("has-event"),O.isInRange&&g.push("is-inrange"),O.isStartRange&&g.push("is-startrange"),O.isEndRange&&g.push("is-endrange"),'<td data-day="'+O.day+'" class="'+g.join(" ")+'" aria-selected="'+E+'"><button class="pika-button pika-day" type="button" data-pika-year="'+O.year+'" data-pika-month="'+O.month+'" data-pika-day="'+O.day+'">'+O.day+"</button></td>"},R=function(O,g){O.setHours(0,0,0,0);var E=O.getDate(),A=O.getDay(),U=g,G=U-1,V=7,oe=function(F){return(F+V-1)%V};O.setDate(E+G-oe(A));var j=new Date(O.getFullYear(),0,U),ye=24*60*60*1e3,ee=(O.getTime()-j.getTime())/ye,T=1+Math.round((ee-G+oe(j.getDay()))/V);return T},N=function(O,g,E,A){var U=new Date(E,g,O),G=r?t(U).isoWeek():R(U,A);return'<td class="pika-week">'+G+"</td>"},H=function(O,g,E,A){return'<tr class="pika-row'+(E?" pick-whole-week":"")+(A?" is-selected":"")+'">'+(g?O.reverse():O).join("")+"</tr>"},K=function(O){return"<tbody>"+O.join("")+"</tbody>"},X=function(O){var g,E=[];for(O.showWeekNumber&&E.push("<th></th>"),g=0;g<7;g++)E.push('<th scope="col"><abbr title="'+x(O,g)+'">'+x(O,g,!0)+"</abbr></th>");return"<thead><tr>"+(O.isRTL?E.reverse():E).join("")+"</tr></thead>"},J=function(O,g,E,A,U,G){var V,oe,j,ye=O._o,ee=E===ye.minYear,T=E===ye.maxYear,F='<div id="'+G+'" class="pika-title" role="heading" aria-live="assertive">',Y,q,me=!0,Z=!0;for(j=[],V=0;V<12;V++)j.push('<option value="'+(E===U?V-g:12+V-g)+'"'+(V===A?' selected="selected"':"")+(ee&&V<ye.minMonth||T&&V>ye.maxMonth?' disabled="disabled"':"")+">"+ye.i18n.months[V]+"</option>");for(Y='<div class="pika-label">'+ye.i18n.months[A]+'<select class="pika-select pika-select-month" tabindex="-1">'+j.join("")+"</select></div>",f(ye.yearRange)?(V=ye.yearRange[0],oe=ye.yearRange[1]+1):(V=E-ye.yearRange,oe=1+E+ye.yearRange),j=[];V<oe&&V<=ye.maxYear;V++)V>=ye.minYear&&j.push('<option value="'+V+'"'+(V===E?' selected="selected"':"")+">"+V+"</option>");return q='<div class="pika-label">'+E+ye.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+j.join("")+"</select></div>",ye.showMonthAfterYear?F+=q+Y:F+=Y+q,ee&&(A===0||ye.minMonth>=A)&&(me=!1),T&&(A===11||ye.maxMonth<=A)&&(Z=!1),g===0&&(F+='<button class="pika-prev'+(me?"":" is-disabled")+'" type="button">'+ye.i18n.previousMonth+"</button>"),g===O._o.numberOfMonths-1&&(F+='<button class="pika-next'+(Z?"":" is-disabled")+'" type="button">'+ye.i18n.nextMonth+"</button>"),F+="</div>"},ue=function(O,g,E){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+E+'">'+X(O)+K(g)+"</table>"},se=function(O){var g=this,E=g.config(O);g._onMouseDown=function(U){if(!!g._v){U=U||window.event;var G=U.target||U.srcElement;if(!!G)if(c(G,"is-disabled")||(c(G,"pika-button")&&!c(G,"is-empty")&&!c(G.parentNode,"is-disabled")?(g.setDate(new Date(G.getAttribute("data-pika-year"),G.getAttribute("data-pika-month"),G.getAttribute("data-pika-day"))),E.bound&&o(function(){g.hide(),E.blurFieldOnSelect&&E.field&&E.field.blur()},100)):c(G,"pika-prev")?g.prevMonth():c(G,"pika-next")&&g.nextMonth()),c(G,"pika-select"))g._c=!0;else if(U.preventDefault)U.preventDefault();else return U.returnValue=!1,!1}},g._onChange=function(U){U=U||window.event;var G=U.target||U.srcElement;!G||(c(G,"pika-select-month")?g.gotoMonth(G.value):c(G,"pika-select-year")&&g.gotoYear(G.value))},g._onKeyChange=function(U){if(U=U||window.event,g.isVisible())switch(U.keyCode){case 13:case 27:E.field&&E.field.blur();break;case 37:g.adjustDate("subtract",1);break;case 38:g.adjustDate("subtract",7);break;case 39:g.adjustDate("add",1);break;case 40:g.adjustDate("add",7);break;case 8:case 46:g.setDate(null);break}},g._parseFieldValue=function(){if(E.parse)return E.parse(E.field.value,E.format);if(r){var U=t(E.field.value,E.format,E.formatStrict);return U&&U.isValid()?U.toDate():null}else return new Date(Date.parse(E.field.value))},g._onInputChange=function(U){var G;U.firedBy!==g&&(G=g._parseFieldValue(),m(G)&&g.setDate(G),g._v||g.show())},g._onInputFocus=function(){g.show()},g._onInputClick=function(){g.show()},g._onInputBlur=function(){var U=s.activeElement;do if(c(U,"pika-single"))return;while(U=U.parentNode);g._c||(g._b=o(function(){g.hide()},50)),g._c=!1},g._onClick=function(U){U=U||window.event;var G=U.target||U.srcElement,V=G;if(!!G){!i&&c(G,"pika-select")&&(G.onchange||(G.setAttribute("onchange","return;"),a(G,"change",g._onChange)));do if(c(V,"pika-single")||V===E.trigger)return;while(V=V.parentNode);g._v&&G!==E.trigger&&V!==E.trigger&&g.hide()}},g.el=s.createElement("div"),g.el.className="pika-single"+(E.isRTL?" is-rtl":"")+(E.theme?" "+E.theme:""),a(g.el,"mousedown",g._onMouseDown,!0),a(g.el,"touchend",g._onMouseDown,!0),a(g.el,"change",g._onChange),E.keyboardInput&&a(s,"keydown",g._onKeyChange),E.field&&(E.container?E.container.appendChild(g.el):E.bound?s.body.appendChild(g.el):E.field.parentNode.insertBefore(g.el,E.field.nextSibling),a(E.field,"change",g._onInputChange),E.defaultDate||(E.defaultDate=g._parseFieldValue(),E.setDefaultDate=!0));var A=E.defaultDate;m(A)?E.setDefaultDate?g.setDate(A,!0):g.gotoDate(A):g.gotoDate(new Date),E.bound?(this.hide(),g.el.className+=" is-bound",a(E.trigger,"click",g._onInputClick),a(E.trigger,"focus",g._onInputFocus),a(E.trigger,"blur",g._onInputBlur)):this.show()};return se.prototype={config:function(O){this._o||(this._o=S({},P,!0));var g=S(this._o,O,!0);g.isRTL=!!g.isRTL,g.field=g.field&&g.field.nodeName?g.field:null,g.theme=typeof g.theme=="string"&&g.theme?g.theme:null,g.bound=!!(g.bound!==void 0?g.field&&g.bound:g.field),g.trigger=g.trigger&&g.trigger.nodeName?g.trigger:g.field,g.disableWeekends=!!g.disableWeekends,g.disableDayFn=typeof g.disableDayFn=="function"?g.disableDayFn:null;var E=parseInt(g.numberOfMonths,10)||1;if(g.numberOfMonths=E>4?4:E,m(g.minDate)||(g.minDate=!1),m(g.maxDate)||(g.maxDate=!1),g.minDate&&g.maxDate&&g.maxDate<g.minDate&&(g.maxDate=g.minDate=!1),g.minDate&&this.setMinDate(g.minDate),g.maxDate&&this.setMaxDate(g.maxDate),f(g.yearRange)){var A=new Date().getFullYear()-10;g.yearRange[0]=parseInt(g.yearRange[0],10)||A,g.yearRange[1]=parseInt(g.yearRange[1],10)||A}else g.yearRange=Math.abs(parseInt(g.yearRange,10))||P.yearRange,g.yearRange>100&&(g.yearRange=100);return g},toString:function(O){return O=O||this._o.format,m(this._d)?this._o.toString?this._o.toString(this._d,O):r?t(this._d).format(O):this._d.toDateString():""},getMoment:function(){return r?t(this._d):null},setMoment:function(O,g){r&&t.isMoment(O)&&this.setDate(O.toDate(),g)},getDate:function(){return m(this._d)?new Date(this._d.getTime()):null},setDate:function(O,g){if(!O)return this._d=null,this._o.field&&(this._o.field.value="",L(this._o.field,"change",{firedBy:this})),this.draw();if(typeof O=="string"&&(O=new Date(Date.parse(O))),!!m(O)){var E=this._o.minDate,A=this._o.maxDate;m(E)&&O<E?O=E:m(A)&&O>A&&(O=A),this._d=new Date(O.getTime()),b(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),L(this._o.field,"change",{firedBy:this})),!g&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(O){var g=!0;if(!!m(O)){if(this.calendars){var E=new Date(this.calendars[0].year,this.calendars[0].month,1),A=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),U=O.getTime();A.setMonth(A.getMonth()+1),A.setDate(A.getDate()-1),g=U<E.getTime()||A.getTime()<U}g&&(this.calendars=[{month:O.getMonth(),year:O.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(O,g){var E=this.getDate()||new Date,A=parseInt(g)*24*60*60*1e3,U;O==="add"?U=new Date(E.valueOf()+A):O==="subtract"&&(U=new Date(E.valueOf()-A)),this.setDate(U)},adjustCalendars:function(){this.calendars[0]=_(this.calendars[0]);for(var O=1;O<this._o.numberOfMonths;O++)this.calendars[O]=_({month:this.calendars[0].month+O,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(O){isNaN(O)||(this.calendars[0].month=parseInt(O,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(O){isNaN(O)||(this.calendars[0].year=parseInt(O,10),this.adjustCalendars())},setMinDate:function(O){O instanceof Date?(b(O),this._o.minDate=O,this._o.minYear=O.getFullYear(),this._o.minMonth=O.getMonth()):(this._o.minDate=P.minDate,this._o.minYear=P.minYear,this._o.minMonth=P.minMonth,this._o.startRange=P.startRange),this.draw()},setMaxDate:function(O){O instanceof Date?(b(O),this._o.maxDate=O,this._o.maxYear=O.getFullYear(),this._o.maxMonth=O.getMonth()):(this._o.maxDate=P.maxDate,this._o.maxYear=P.maxYear,this._o.maxMonth=P.maxMonth,this._o.endRange=P.endRange),this.draw()},setStartRange:function(O){this._o.startRange=O},setEndRange:function(O){this._o.endRange=O},draw:function(O){if(!(!this._v&&!O)){var g=this._o,E=g.minYear,A=g.maxYear,U=g.minMonth,G=g.maxMonth,V="",oe;this._y<=E&&(this._y=E,!isNaN(U)&&this._m<U&&(this._m=U)),this._y>=A&&(this._y=A,!isNaN(G)&&this._m>G&&(this._m=G));for(var j=0;j<g.numberOfMonths;j++)oe="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),V+='<div class="pika-lendar">'+J(this,j,this.calendars[j].year,this.calendars[j].month,this.calendars[0].year,oe)+this.render(this.calendars[j].year,this.calendars[j].month,oe)+"</div>";this.el.innerHTML=V,g.bound&&g.field.type!=="hidden"&&o(function(){g.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),g.bound&&g.field.setAttribute("aria-label",g.ariaLabel)}},adjustPosition:function(){var O,g,E,A,U,G,V,oe,j,ye,ee,T;if(!this._o.container){if(this.el.style.position="absolute",O=this._o.trigger,g=O,E=this.el.offsetWidth,A=this.el.offsetHeight,U=window.innerWidth||s.documentElement.clientWidth,G=window.innerHeight||s.documentElement.clientHeight,V=window.pageYOffset||s.body.scrollTop||s.documentElement.scrollTop,ee=!0,T=!0,typeof O.getBoundingClientRect=="function")ye=O.getBoundingClientRect(),oe=ye.left+window.pageXOffset,j=ye.bottom+window.pageYOffset;else for(oe=g.offsetLeft,j=g.offsetTop+g.offsetHeight;g=g.offsetParent;)oe+=g.offsetLeft,j+=g.offsetTop;(this._o.reposition&&oe+E>U||this._o.position.indexOf("right")>-1&&oe-E+O.offsetWidth>0)&&(oe=oe-E+O.offsetWidth,ee=!1),(this._o.reposition&&j+A>G+V||this._o.position.indexOf("top")>-1&&j-A-O.offsetHeight>0)&&(j=j-A-O.offsetHeight,T=!1),this.el.style.left=oe+"px",this.el.style.top=j+"px",h(this.el,ee?"left-aligned":"right-aligned"),h(this.el,T?"bottom-aligned":"top-aligned"),d(this.el,ee?"right-aligned":"left-aligned"),d(this.el,T?"top-aligned":"bottom-aligned")}},render:function(O,g,E){var A=this._o,U=new Date,G=C(O,g),V=new Date(O,g,1).getDay(),oe=[],j=[];b(U),A.firstDay>0&&(V-=A.firstDay,V<0&&(V+=7));for(var ye=g===0?11:g-1,ee=g===11?0:g+1,T=g===0?O-1:O,F=g===11?O+1:O,Y=C(T,ye),q=G+V,me=q;me>7;)me-=7;q+=7-me;for(var Z=!1,Ce=0,Re=0;Ce<q;Ce++){var Ee=new Date(O,g,1+(Ce-V)),Me=m(this._d)?v(Ee,this._d):!1,Te=v(Ee,U),k=A.events.indexOf(Ee.toDateString())!==-1,B=Ce<V||Ce>=G+V,z=1+(Ce-V),de=g,ne=O,fe=A.startRange&&v(A.startRange,Ee),le=A.endRange&&v(A.endRange,Ee),ae=A.startRange&&A.endRange&&A.startRange<Ee&&Ee<A.endRange,pe=A.minDate&&Ee<A.minDate||A.maxDate&&Ee>A.maxDate||A.disableWeekends&&p(Ee)||A.disableDayFn&&A.disableDayFn(Ee);B&&(Ce<V?(z=Y+z,de=ye,ne=T):(z=z-G,de=ee,ne=F));var te={day:z,month:de,year:ne,hasEvent:k,isSelected:Me,isToday:Te,isDisabled:pe,isEmpty:B,isStartRange:fe,isEndRange:le,isInRange:ae,showDaysInNextAndPreviousMonths:A.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:A.enableSelectionDaysInNextAndPreviousMonths};A.pickWholeWeek&&Me&&(Z=!0),j.push(I(te)),++Re===7&&(A.showWeekNumber&&j.unshift(N(Ce-V,g,O,A.firstWeekOfYearMinDays)),oe.push(H(j,A.isRTL,A.pickWholeWeek,Z)),j=[],Re=0,Z=!1)}return ue(A,oe,E)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),d(this.el,"is-hidden"),this._o.bound&&(a(s,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var O=this._v;O!==!1&&(this._o.bound&&l(s,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),h(this.el,"is-hidden"),this._v=!1,O!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var O=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),O.keyboardInput&&l(s,"keydown",this._onKeyChange),O.field&&(l(O.field,"change",this._onInputChange),O.bound&&(l(O.trigger,"click",this._onInputClick),l(O.trigger,"focus",this._onInputFocus),l(O.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},se})})(Ux);const kR=Ux.exports,Bx="date",FR="dateEditor";class Vx extends xl{static get EDITOR_TYPE(){return Bx}constructor(e){super(e),this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,this.$datePicker=null}init(){if(typeof It!="function")throw new Error("You need to include moment.js to your project.");if(typeof kR!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.instance.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Ae(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),new dn(this).addEventListener(this.datePicker,"mousedown",t=>t.stopPropagation())}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),r.addShortcut({keys:[["Enter"]],callback:i=>{i.stopPropagation()},group:FR})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(()=>{this.instance._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(FR),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const r=this.originalValue;r!==void 0&&this.setValue(r)}super.finishEditing(e,t)}showDatepicker(e){const t=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.instance.view.isMouseDown(),s=e?Cx(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new kR(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+t.top+cn(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=t.right-Bt(this.datePicker):a=t.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(o=this.originalValue,It(o,r,!0).isValid()&&this.$datePicker.setMoment(It(o,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!i&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,It(o,r,!0).isValid()&&this.$datePicker.setMoment(It(o,r),!0),!s&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&Ug(t,this.cellProperties.datePickerConfig);const r=t.onSelect,i=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=s=>{let o=s;isNaN(o.getTime())||(o=It(o).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(o),this.hideDatepicker(),r&&r()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},t}}const SG="dropdown";class lv extends av{static get EDITOR_TYPE(){return SG}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}Ue.getSingleton().add("beforeValidate",function(n,e,t){const r=this.getCellMeta(e,this.propToCol(t));r.editor===lv&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const RG="numeric";class $x extends xl{static get EDITOR_TYPE(){return RG}}const TG="password";class Wx extends xl{static get EDITOR_TYPE(){return TG}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,ks(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const p2="ht_editor_visible",HR="selectEditor",AG="select";class xG extends gc{static get EDITOR_TYPE(){return AG}init(){this.select=this.hot.rootDocument.createElement("SELECT"),Ae(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Je(this.select,p2)&&tt(this.select,p2),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),ks(this.select),ft(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,pc(h,u),this.select.appendChild(h)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)t[e[r]]=e[r];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Xn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:r,height:i}=this.getEditedCellRect(),s=this.select.style;s.height=`${i}px`,s.width=`${r}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${t}px`,s.margin="0px",Ae(this.select,p2)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),r={group:HR};this.isInFullEditMode()!==!1&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(HR)}}const MG="time";class Gx extends xl{static get EDITOR_TYPE(){return MG}prepare(e,t,r,i,s,o){super.prepare(e,t,r,i,s,o),this.TEXTAREA.dir="ltr"}}function NG(){li(gc),li(av),li(Hx),li(Vx),li(lv),li(ov),li($x),li(Wx),li(xG),li(xl),li(Gx)}const IG="html";function uv(n,e,t,r,i,s,o){Dd.apply(this,[n,e,t,r,i,s,o]),pc(e,s==null?"":s,!1)}uv.RENDERER_TYPE=IG;const OG="autocomplete";function yc(n,e,t,r,i,s,o){const{rootDocument:a}=n,l=o.allowHtml?uv:To,u=a.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[n,e,t,r,i,s,o]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),Ae(e,"htAutocomplete"),!n.acArrowListener){const c=new dn(n);n.acArrowListener=function(h){Je(h.target,"htAutocompleteArrow")&&n.view._wt.getSetting("onCellDblClick",null,n._createCellCoords(t,r),e)},c.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",()=>{c.destroy()})}}yc.RENDERER_TYPE=OG;const UR=new WeakMap,BR=new WeakMap,_G="htBadValue",Ku="data-row",qu="data-col",LG="checkboxRenderer",zx="checkbox";Ue.getSingleton().add("modifyAutoColumnSizeSeed",function(n,e,t){const{label:r,type:i,row:s,column:o,prop:a}=e;if(i===zx){if(r){const{value:l,property:u}=r;let c=t;if(l)c=typeof l=="function"?l(s,o,a,t):l;else if(u){const h=this.getDataAtRowProp(s,u);c=h!==null?h:t}n=c}return n}});function cv(n,e,t,r,i,s,o){const{rootDocument:a}=n;Dd.apply(this,[n,e,t,r,i,s,o]),PG(n);let l=DG(a);const u=o.label;let c=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),ks(e),s===o.checkedTemplate||In(s).toLocaleLowerCase(o.locale)===In(o.checkedTemplate).toLocaleLowerCase(o.locale)?l.checked=!0:s===o.uncheckedTemplate||In(s).toLocaleLowerCase(o.locale)===In(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?l.checked=!1:zn(s)?Ae(l,"noValue"):(l.style.display="none",Ae(l,_G),c=!0),l.setAttribute(Ku,t),l.setAttribute(qu,r),!c&&u){let m="";if(u.value)m=typeof u.value=="function"?u.value.call(this,t,r,i,s):u.value;else if(u.property){const y=n.getDataAtRowProp(t,u.property);m=y!==null?y:""}const p=kG(a,m,u.separated!==!0);u.position==="before"?u.separated?(e.appendChild(p),e.appendChild(l)):(p.appendChild(l),l=p):(!u.position||u.position==="after")&&(u.separated?(e.appendChild(l),e.appendChild(p)):(p.insertBefore(l,p.firstChild),l=p))}(!u||u&&!u.separated)&&e.appendChild(l),c&&e.appendChild(a.createTextNode("#bad-value#")),UR.has(n)||(UR.set(n,!0),h());function h(){const p=n.getShortcutManager().getContext("grid"),y={group:LG};p.addShortcuts([{keys:[["space"]],callback:()=>(d(),!f())},{keys:[["enter"]],callback:()=>(d(),!f()),runOnlyIf:()=>n.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(d(!0),!f()),relativeToGroup:ph,position:"before"}],y)}function d(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const p=n.getSelectedRange();if(!!p)for(let y=0;y<p.length;y++){const{row:C,col:b}=p[y].getTopStartCorner(),{row:v,col:S}=p[y].getBottomEndCorner(),L=[];for(let _=C;_<=v;_+=1)for(let P=b;P<=S;P+=1){const x=n.getCellMeta(_,P);if(x.type!=="checkbox")return;if(x.readOnly===!0)continue;typeof x.checkedTemplate>"u"&&(x.checkedTemplate=!0),typeof x.uncheckedTemplate>"u"&&(x.uncheckedTemplate=!1);const I=n.getDataAtCell(_,P);m===!1?[x.checkedTemplate,x.checkedTemplate.toString()].includes(I)?L.push([_,P,x.uncheckedTemplate]):[x.uncheckedTemplate,x.uncheckedTemplate.toString(),null,void 0].includes(I)&&L.push([_,P,x.checkedTemplate]):L.push([_,P,x.uncheckedTemplate])}L.length>0&&n.setDataAtCell(L)}}function f(){const m=n.getSelectedRange();if(!!m){for(let p=0;p<m.length;p++){const y=m[p].getTopStartCorner(),C=m[p].getBottomEndCorner();for(let b=y.row;b<=C.row;b++)for(let v=y.col;v<=C.col;v++){const S=n.getCellMeta(b,v);if(S.type!=="checkbox")return!1;const L=n.getCell(b,v);if(L==null)return!0;if(L.querySelectorAll("input[type=checkbox]").length>0&&!S.readOnly)return!0}}return!1}}}cv.RENDERER_TYPE=zx;function PG(n){let e=BR.get(n);if(!e){const{rootElement:t}=n;e=new dn(n),e.addEventListener(t,"click",r=>HG(r,n)),e.addEventListener(t,"mouseup",r=>FG(r,n)),e.addEventListener(t,"change",r=>UG(r,n)),BR.set(n,e)}return e}function DG(n){const e=n.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function kG(n,e,t){const r=n.createElement("label");return r.className=`htCheckboxRendererLabel ${t?"fullWidth":""}`,r.appendChild(n.createTextNode(e)),r.cloneNode(!0)}function FG(n,e){const{target:t}=n;!hv(t)||!t.hasAttribute(Ku)||!t.hasAttribute(qu)||setTimeout(e.listen,10)}function HG(n,e){const{target:t}=n;if(!hv(t)||!t.hasAttribute(Ku)||!t.hasAttribute(qu))return;const r=parseInt(t.getAttribute(Ku),10),i=parseInt(t.getAttribute(qu),10);e.getCellMeta(r,i).readOnly&&n.preventDefault()}function UG(n,e){const{target:t}=n;if(!hv(t)||!t.hasAttribute(Ku)||!t.hasAttribute(qu))return;const r=parseInt(t.getAttribute(Ku),10),i=parseInt(t.getAttribute(qu),10),s=e.getCellMeta(r,i);if(!s.readOnly){let o=null;n.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(r,i,o)}}function hv(n){return n.tagName==="INPUT"&&n.getAttribute("type")==="checkbox"}var Yx={exports:{}};(function(n,e){(function(t){n.exports=t()})(function(){return function t(r,i,s){function o(u,c){if(!i[u]){if(!r[u]){var h=typeof zo=="function"&&zo;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var f=i[u]={exports:{}};r[u][0].call(f.exports,function(m){return o(r[u][1][m]||m)},f,f.exports,t,r,i,s)}return i[u].exports}for(var a=typeof zo=="function"&&zo,l=0;l<s.length;l++)o(s[l]);return o}({1:[function(t,r,i){(function(s){var o,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",d=1e14,f=14,m=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],y=1e7,C=1e9;function b(I){var R=0|I;return 0<I||I===R?R:R-1}function v(I){for(var R,N,H=1,K=I.length,X=I[0]+"";H<K;){for(R=I[H++]+"",N=f-R.length;N--;R="0"+R);X+=R}for(K=X.length;X.charCodeAt(--K)===48;);return X.slice(0,K+1||1)}function S(I,R){var N,H,K=I.c,X=R.c,J=I.s,ue=R.s,se=I.e,O=R.e;if(!J||!ue)return null;if(N=K&&!K[0],H=X&&!X[0],N||H)return N?H?0:-ue:J;if(J!=ue)return J;if(N=J<0,H=se==O,!K||!X)return H?0:!K^N?1:-1;if(!H)return O<se^N?1:-1;for(ue=(se=K.length)<(O=X.length)?se:O,J=0;J<ue;J++)if(K[J]!=X[J])return K[J]>X[J]^N?1:-1;return se==O?0:O<se^N?1:-1}function L(I,R,N,H){if(I<R||N<I||I!==(I<0?l(I):u(I)))throw Error(c+(H||"Argument")+(typeof I=="number"?I<R||N<I?" out of range: ":" not an integer: ":" not a primitive number: ")+String(I))}function _(I){var R=I.c.length-1;return b(I.e/f)==R&&I.c[R]%2!=0}function P(I,R){return(1<I.length?I.charAt(0)+"."+I.slice(1):I)+(R<0?"e":"e+")+R}function x(I,R,N){var H,K;if(R<0){for(K=N+".";++R;K+=N);I=K+I}else if(++R>(H=I.length)){for(K=N,R-=H;--R;K+=N);I+=K}else R<H&&(I=I.slice(0,R)+"."+I.slice(R));return I}(o=function I(R){var N,H,K,X,J,ue,se,O,g,E,A=Z.prototype={constructor:Z,toString:null,valueOf:null},U=new Z(1),G=20,V=4,oe=-7,j=21,ye=-1e7,ee=1e7,T=!1,F=1,Y=0,q={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},me="0123456789abcdefghijklmnopqrstuvwxyz";function Z(k,B){var z,de,ne,fe,le,ae,pe,te,he=this;if(!(he instanceof Z))return new Z(k,B);if(B==null){if(k instanceof Z)return he.s=k.s,he.e=k.e,void(he.c=(k=k.c)?k.slice():k);if((ae=typeof k=="number")&&0*k==0){if(he.s=1/k<0?(k=-k,-1):1,k===~~k){for(fe=0,le=k;10<=le;le/=10,fe++);return he.e=fe,void(he.c=[k])}te=String(k)}else{if(te=String(k),!a.test(te))return K(he,te,ae);he.s=te.charCodeAt(0)==45?(te=te.slice(1),-1):1}-1<(fe=te.indexOf("."))&&(te=te.replace(".","")),0<(le=te.search(/e/i))?(fe<0&&(fe=le),fe+=+te.slice(le+1),te=te.substring(0,le)):fe<0&&(fe=te.length)}else{if(L(B,2,me.length,"Base"),te=String(k),B==10)return Me(he=new Z(k instanceof Z?k:te),G+he.e+1,V);if(ae=typeof k=="number"){if(0*k!=0)return K(he,te,ae,B);if(he.s=1/k<0?(te=te.slice(1),-1):1,Z.DEBUG&&15<te.replace(/^0\.0*|\./,"").length)throw Error(h+k);ae=!1}else he.s=te.charCodeAt(0)===45?(te=te.slice(1),-1):1;for(z=me.slice(0,B),fe=le=0,pe=te.length;le<pe;le++)if(z.indexOf(de=te.charAt(le))<0){if(de=="."){if(fe<le){fe=pe;continue}}else if(!ne&&(te==te.toUpperCase()&&(te=te.toLowerCase())||te==te.toLowerCase()&&(te=te.toUpperCase()))){ne=!0,le=-1,fe=0;continue}return K(he,String(k),ae,B)}-1<(fe=(te=H(te,B,10,he.s)).indexOf("."))?te=te.replace(".",""):fe=te.length}for(le=0;te.charCodeAt(le)===48;le++);for(pe=te.length;te.charCodeAt(--pe)===48;);if(te=te.slice(le,++pe)){if(pe-=le,ae&&Z.DEBUG&&15<pe&&(m<k||k!==u(k)))throw Error(h+he.s*k);if(ee<(fe=fe-le-1))he.c=he.e=null;else if(fe<ye)he.c=[he.e=0];else{if(he.e=fe,he.c=[],le=(fe+1)%f,fe<0&&(le+=f),le<pe){for(le&&he.c.push(+te.slice(0,le)),pe-=f;le<pe;)he.c.push(+te.slice(le,le+=f));te=te.slice(le),le=f-te.length}else le-=pe;for(;le--;te+="0");he.c.push(+te)}}else he.c=[he.e=0]}function Ce(k,B,z,de){var ne,fe,le,ae,pe;if(z==null?z=V:L(z,0,8),!k.c)return k.toString();if(ne=k.c[0],le=k.e,B==null)pe=v(k.c),pe=de==1||de==2&&(le<=oe||j<=le)?P(pe,le):x(pe,le,"0");else if(fe=(k=Me(new Z(k),B,z)).e,ae=(pe=v(k.c)).length,de==1||de==2&&(B<=fe||fe<=oe)){for(;ae<B;pe+="0",ae++);pe=P(pe,fe)}else if(B-=le,pe=x(pe,fe,"0"),ae<fe+1){if(0<--B)for(pe+=".";B--;pe+="0");}else if(0<(B+=fe-ae))for(fe+1==ae&&(pe+=".");B--;pe+="0");return k.s<0&&ne?"-"+pe:pe}function Re(k,B){for(var z,de=1,ne=new Z(k[0]);de<k.length;de++){if(!(z=new Z(k[de])).s){ne=z;break}B.call(ne,z)&&(ne=z)}return ne}function Ee(k,B,z){for(var de=1,ne=B.length;!B[--ne];B.pop());for(ne=B[0];10<=ne;ne/=10,de++);return(z=de+z*f-1)>ee?k.c=k.e=null:k.c=z<ye?[k.e=0]:(k.e=z,B),k}function Me(k,B,z,de){var ne,fe,le,ae,pe,te,he,Se=k.c,be=p;if(Se){e:{for(ne=1,ae=Se[0];10<=ae;ae/=10,ne++);if((fe=B-ne)<0)fe+=f,le=B,he=(pe=Se[te=0])/be[ne-le-1]%10|0;else if((te=l((fe+1)/f))>=Se.length){if(!de)break e;for(;Se.length<=te;Se.push(0));pe=he=0,le=(fe%=f)-f+(ne=1)}else{for(pe=ae=Se[te],ne=1;10<=ae;ae/=10,ne++);he=(le=(fe%=f)-f+ne)<0?0:pe/be[ne-le-1]%10|0}if(de=de||B<0||Se[te+1]!=null||(le<0?pe:pe%be[ne-le-1]),de=z<4?(he||de)&&(z==0||z==(k.s<0?3:2)):5<he||he==5&&(z==4||de||z==6&&(0<fe?0<le?pe/be[ne-le]:0:Se[te-1])%10&1||z==(k.s<0?8:7)),B<1||!Se[0])return Se.length=0,de?(B-=k.e+1,Se[0]=be[(f-B%f)%f],k.e=-B||0):Se[0]=k.e=0,k;if(fe==0?(Se.length=te,ae=1,te--):(Se.length=te+1,ae=be[f-fe],Se[te]=0<le?u(pe/be[ne-le]%be[le])*ae:0),de)for(;;){if(te==0){for(fe=1,le=Se[0];10<=le;le/=10,fe++);for(le=Se[0]+=ae,ae=1;10<=le;le/=10,ae++);fe!=ae&&(k.e++,Se[0]==d&&(Se[0]=1));break}if(Se[te]+=ae,Se[te]!=d)break;Se[te--]=0,ae=1}for(fe=Se.length;Se[--fe]===0;Se.pop());}k.e>ee?k.c=k.e=null:k.e<ye&&(k.c=[k.e=0])}return k}function Te(k){var B,z=k.e;return z===null?k.toString():(B=v(k.c),B=z<=oe||j<=z?P(B,z):x(B,z,"0"),k.s<0?"-"+B:B)}return Z.clone=I,Z.ROUND_UP=0,Z.ROUND_DOWN=1,Z.ROUND_CEIL=2,Z.ROUND_FLOOR=3,Z.ROUND_HALF_UP=4,Z.ROUND_HALF_DOWN=5,Z.ROUND_HALF_EVEN=6,Z.ROUND_HALF_CEIL=7,Z.ROUND_HALF_FLOOR=8,Z.EUCLID=9,Z.config=Z.set=function(k){var B,z;if(k!=null){if(typeof k!="object")throw Error(c+"Object expected: "+k);if(k.hasOwnProperty(B="DECIMAL_PLACES")&&(L(z=k[B],0,C,B),G=z),k.hasOwnProperty(B="ROUNDING_MODE")&&(L(z=k[B],0,8,B),V=z),k.hasOwnProperty(B="EXPONENTIAL_AT")&&((z=k[B])&&z.pop?(L(z[0],-C,0,B),L(z[1],0,C,B),oe=z[0],j=z[1]):(L(z,-C,C,B),oe=-(j=z<0?-z:z))),k.hasOwnProperty(B="RANGE"))if((z=k[B])&&z.pop)L(z[0],-C,-1,B),L(z[1],1,C,B),ye=z[0],ee=z[1];else{if(L(z,-C,C,B),!z)throw Error(c+B+" cannot be zero: "+z);ye=-(ee=z<0?-z:z)}if(k.hasOwnProperty(B="CRYPTO")){if((z=k[B])!==!!z)throw Error(c+B+" not true or false: "+z);if(z){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw T=!z,Error(c+"crypto unavailable");T=z}else T=z}if(k.hasOwnProperty(B="MODULO_MODE")&&(L(z=k[B],0,9,B),F=z),k.hasOwnProperty(B="POW_PRECISION")&&(L(z=k[B],0,C,B),Y=z),k.hasOwnProperty(B="FORMAT")){if(typeof(z=k[B])!="object")throw Error(c+B+" not an object: "+z);q=z}if(k.hasOwnProperty(B="ALPHABET")){if(typeof(z=k[B])!="string"||/^.$|[+-.\s]|(.).*\1/.test(z))throw Error(c+B+" invalid: "+z);me=z}}return{DECIMAL_PLACES:G,ROUNDING_MODE:V,EXPONENTIAL_AT:[oe,j],RANGE:[ye,ee],CRYPTO:T,MODULO_MODE:F,POW_PRECISION:Y,FORMAT:q,ALPHABET:me}},Z.isBigNumber=function(k){return k instanceof Z||k&&k._isBigNumber===!0||!1},Z.maximum=Z.max=function(){return Re(arguments,A.lt)},Z.minimum=Z.min=function(){return Re(arguments,A.gt)},Z.random=(X=9007199254740992,J=Math.random()*X&2097151?function(){return u(Math.random()*X)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(k){var B,z,de,ne,fe,le=0,ae=[],pe=new Z(U);if(k==null?k=G:L(k,0,C),ne=l(k/f),T)if(crypto.getRandomValues){for(B=crypto.getRandomValues(new Uint32Array(ne*=2));le<ne;)9e15<=(fe=131072*B[le]+(B[le+1]>>>11))?(z=crypto.getRandomValues(new Uint32Array(2)),B[le]=z[0],B[le+1]=z[1]):(ae.push(fe%1e14),le+=2);le=ne/2}else{if(!crypto.randomBytes)throw T=!1,Error(c+"crypto unavailable");for(B=crypto.randomBytes(ne*=7);le<ne;)9e15<=(fe=281474976710656*(31&B[le])+1099511627776*B[le+1]+4294967296*B[le+2]+16777216*B[le+3]+(B[le+4]<<16)+(B[le+5]<<8)+B[le+6])?crypto.randomBytes(7).copy(B,le):(ae.push(fe%1e14),le+=7);le=ne/7}if(!T)for(;le<ne;)(fe=J())<9e15&&(ae[le++]=fe%1e14);for(ne=ae[--le],k%=f,ne&&k&&(fe=p[f-k],ae[le]=u(ne/fe)*fe);ae[le]===0;ae.pop(),le--);if(le<0)ae=[de=0];else{for(de=-1;ae[0]===0;ae.splice(0,1),de-=f);for(le=1,fe=ae[0];10<=fe;fe/=10,le++);le<f&&(de-=f-le)}return pe.e=de,pe.c=ae,pe}),Z.sum=function(){for(var k=1,B=arguments,z=new Z(B[0]);k<B.length;)z=z.plus(B[k++]);return z},H=function(){var k="0123456789";function B(z,de,ne,fe){for(var le,ae,pe=[0],te=0,he=z.length;te<he;){for(ae=pe.length;ae--;pe[ae]*=de);for(pe[0]+=fe.indexOf(z.charAt(te++)),le=0;le<pe.length;le++)pe[le]>ne-1&&(pe[le+1]==null&&(pe[le+1]=0),pe[le+1]+=pe[le]/ne|0,pe[le]%=ne)}return pe.reverse()}return function(z,de,ne,fe,le){var ae,pe,te,he,Se,be,_e,$e,Oe=z.indexOf("."),Ye=G,Xe=V;for(0<=Oe&&(he=Y,Y=0,z=z.replace(".",""),be=($e=new Z(de)).pow(z.length-Oe),Y=he,$e.c=B(x(v(be.c),be.e,"0"),10,ne,k),$e.e=$e.c.length),te=he=(_e=B(z,de,ne,le?(ae=me,k):(ae=k,me))).length;_e[--he]==0;_e.pop());if(!_e[0])return ae.charAt(0);if(Oe<0?--te:(be.c=_e,be.e=te,be.s=fe,_e=(be=N(be,$e,Ye,Xe,ne)).c,Se=be.r,te=be.e),Oe=_e[pe=te+Ye+1],he=ne/2,Se=Se||pe<0||_e[pe+1]!=null,Se=Xe<4?(Oe!=null||Se)&&(Xe==0||Xe==(be.s<0?3:2)):he<Oe||Oe==he&&(Xe==4||Se||Xe==6&&1&_e[pe-1]||Xe==(be.s<0?8:7)),pe<1||!_e[0])z=Se?x(ae.charAt(1),-Ye,ae.charAt(0)):ae.charAt(0);else{if(_e.length=pe,Se)for(--ne;++_e[--pe]>ne;)_e[pe]=0,pe||(++te,_e=[1].concat(_e));for(he=_e.length;!_e[--he];);for(Oe=0,z="";Oe<=he;z+=ae.charAt(_e[Oe++]));z=x(z,te,ae.charAt(0))}return z}}(),N=function(){function k(de,ne,fe){var le,ae,pe,te,he=0,Se=de.length,be=ne%y,_e=ne/y|0;for(de=de.slice();Se--;)he=((ae=be*(pe=de[Se]%y)+(le=_e*pe+(te=de[Se]/y|0)*be)%y*y+he)/fe|0)+(le/y|0)+_e*te,de[Se]=ae%fe;return he&&(de=[he].concat(de)),de}function B(de,ne,fe,le){var ae,pe;if(fe!=le)pe=le<fe?1:-1;else for(ae=pe=0;ae<fe;ae++)if(de[ae]!=ne[ae]){pe=de[ae]>ne[ae]?1:-1;break}return pe}function z(de,ne,fe,le){for(var ae=0;fe--;)de[fe]-=ae,ae=de[fe]<ne[fe]?1:0,de[fe]=ae*le+de[fe]-ne[fe];for(;!de[0]&&1<de.length;de.splice(0,1));}return function(de,ne,fe,le,ae){var pe,te,he,Se,be,_e,$e,Oe,Ye,Xe,ot,wt,Br,Vn,Ft,Pt,Ln,mn=de.s==ne.s?1:-1,Jt=de.c,xt=ne.c;if(!(Jt&&Jt[0]&&xt&&xt[0]))return new Z(de.s&&ne.s&&(Jt?!xt||Jt[0]!=xt[0]:xt)?Jt&&Jt[0]==0||!xt?0*mn:mn/0:NaN);for(Ye=(Oe=new Z(mn)).c=[],mn=fe+(te=de.e-ne.e)+1,ae||(ae=d,te=b(de.e/f)-b(ne.e/f),mn=mn/f|0),he=0;xt[he]==(Jt[he]||0);he++);if(xt[he]>(Jt[he]||0)&&te--,mn<0)Ye.push(1),Se=!0;else{for(Vn=Jt.length,Pt=xt.length,mn+=2,1<(be=u(ae/(xt[he=0]+1)))&&(xt=k(xt,be,ae),Jt=k(Jt,be,ae),Pt=xt.length,Vn=Jt.length),Br=Pt,ot=(Xe=Jt.slice(0,Pt)).length;ot<Pt;Xe[ot++]=0);Ln=xt.slice(),Ln=[0].concat(Ln),Ft=xt[0],xt[1]>=ae/2&&Ft++;do{if(be=0,(pe=B(xt,Xe,Pt,ot))<0){if(wt=Xe[0],Pt!=ot&&(wt=wt*ae+(Xe[1]||0)),1<(be=u(wt/Ft)))for(ae<=be&&(be=ae-1),$e=(_e=k(xt,be,ae)).length,ot=Xe.length;B(_e,Xe,$e,ot)==1;)be--,z(_e,Pt<$e?Ln:xt,$e,ae),$e=_e.length,pe=1;else be==0&&(pe=be=1),$e=(_e=xt.slice()).length;if($e<ot&&(_e=[0].concat(_e)),z(Xe,_e,ot,ae),ot=Xe.length,pe==-1)for(;B(xt,Xe,Pt,ot)<1;)be++,z(Xe,Pt<ot?Ln:xt,ot,ae),ot=Xe.length}else pe===0&&(be++,Xe=[0]);Ye[he++]=be,Xe[0]?Xe[ot++]=Jt[Br]||0:(Xe=[Jt[Br]],ot=1)}while((Br++<Vn||Xe[0]!=null)&&mn--);Se=Xe[0]!=null,Ye[0]||Ye.splice(0,1)}if(ae==d){for(he=1,mn=Ye[0];10<=mn;mn/=10,he++);Me(Oe,fe+(Oe.e=he+te*f-1)+1,le,Se)}else Oe.e=te,Oe.r=+Se;return Oe}}(),ue=/^(-?)0([xbo])(?=\w[\w.]*$)/i,se=/^([^.]+)\.$/,O=/^\.([^.]+)$/,g=/^-?(Infinity|NaN)$/,E=/^\s*\+(?=[\w.])|^\s+|\s+$/g,K=function(k,B,z,de){var ne,fe=z?B:B.replace(E,"");if(g.test(fe))k.s=isNaN(fe)?null:fe<0?-1:1,k.c=k.e=null;else{if(!z&&(fe=fe.replace(ue,function(le,ae,pe){return ne=(pe=pe.toLowerCase())=="x"?16:pe=="b"?2:8,de&&de!=ne?le:ae}),de&&(ne=de,fe=fe.replace(se,"$1").replace(O,"0.$1")),B!=fe))return new Z(fe,ne);if(Z.DEBUG)throw Error(c+"Not a"+(de?" base "+de:"")+" number: "+B);k.c=k.e=k.s=null}},A.absoluteValue=A.abs=function(){var k=new Z(this);return k.s<0&&(k.s=1),k},A.comparedTo=function(k,B){return S(this,new Z(k,B))},A.decimalPlaces=A.dp=function(k,B){var z,de,ne;if(k!=null)return L(k,0,C),B==null?B=V:L(B,0,8),Me(new Z(this),k+this.e+1,B);if(!(z=this.c))return null;if(de=((ne=z.length-1)-b(this.e/f))*f,ne=z[ne])for(;ne%10==0;ne/=10,de--);return de<0&&(de=0),de},A.dividedBy=A.div=function(k,B){return N(this,new Z(k,B),G,V)},A.dividedToIntegerBy=A.idiv=function(k,B){return N(this,new Z(k,B),0,1)},A.exponentiatedBy=A.pow=function(k,B){var z,de,ne,fe,le,ae,pe,te,he=this;if((k=new Z(k)).c&&!k.isInteger())throw Error(c+"Exponent not an integer: "+Te(k));if(B!=null&&(B=new Z(B)),le=14<k.e,!he.c||!he.c[0]||he.c[0]==1&&!he.e&&he.c.length==1||!k.c||!k.c[0])return te=new Z(Math.pow(+Te(he),le?2-_(k):+Te(k))),B?te.mod(B):te;if(ae=k.s<0,B){if(B.c?!B.c[0]:!B.s)return new Z(NaN);(de=!ae&&he.isInteger()&&B.isInteger())&&(he=he.mod(B))}else{if(9<k.e&&(0<he.e||he.e<-1||(he.e==0?1<he.c[0]||le&&24e7<=he.c[1]:he.c[0]<8e13||le&&he.c[0]<=9999975e7)))return fe=he.s<0&&_(k)?-0:0,-1<he.e&&(fe=1/fe),new Z(ae?1/fe:fe);Y&&(fe=l(Y/f+2))}for(pe=le?(z=new Z(.5),ae&&(k.s=1),_(k)):(ne=Math.abs(+Te(k)))%2,te=new Z(U);;){if(pe){if(!(te=te.times(he)).c)break;fe?te.c.length>fe&&(te.c.length=fe):de&&(te=te.mod(B))}if(ne){if((ne=u(ne/2))===0)break;pe=ne%2}else if(Me(k=k.times(z),k.e+1,1),14<k.e)pe=_(k);else{if((ne=+Te(k))==0)break;pe=ne%2}he=he.times(he),fe?he.c&&he.c.length>fe&&(he.c.length=fe):de&&(he=he.mod(B))}return de?te:(ae&&(te=U.div(te)),B?te.mod(B):fe?Me(te,Y,V,void 0):te)},A.integerValue=function(k){var B=new Z(this);return k==null?k=V:L(k,0,8),Me(B,B.e+1,k)},A.isEqualTo=A.eq=function(k,B){return S(this,new Z(k,B))===0},A.isFinite=function(){return!!this.c},A.isGreaterThan=A.gt=function(k,B){return 0<S(this,new Z(k,B))},A.isGreaterThanOrEqualTo=A.gte=function(k,B){return(B=S(this,new Z(k,B)))===1||B===0},A.isInteger=function(){return!!this.c&&b(this.e/f)>this.c.length-2},A.isLessThan=A.lt=function(k,B){return S(this,new Z(k,B))<0},A.isLessThanOrEqualTo=A.lte=function(k,B){return(B=S(this,new Z(k,B)))===-1||B===0},A.isNaN=function(){return!this.s},A.isNegative=function(){return this.s<0},A.isPositive=function(){return 0<this.s},A.isZero=function(){return!!this.c&&this.c[0]==0},A.minus=function(k,B){var z,de,ne,fe,le=this,ae=le.s;if(B=(k=new Z(k,B)).s,!ae||!B)return new Z(NaN);if(ae!=B)return k.s=-B,le.plus(k);var pe=le.e/f,te=k.e/f,he=le.c,Se=k.c;if(!pe||!te){if(!he||!Se)return he?(k.s=-B,k):new Z(Se?le:NaN);if(!he[0]||!Se[0])return Se[0]?(k.s=-B,k):new Z(he[0]?le:V==3?-0:0)}if(pe=b(pe),te=b(te),he=he.slice(),ae=pe-te){for((ne=(fe=ae<0)?(ae=-ae,he):(te=pe,Se)).reverse(),B=ae;B--;ne.push(0));ne.reverse()}else for(de=(fe=(ae=he.length)<(B=Se.length))?ae:B,ae=B=0;B<de;B++)if(he[B]!=Se[B]){fe=he[B]<Se[B];break}if(fe&&(ne=he,he=Se,Se=ne,k.s=-k.s),0<(B=(de=Se.length)-(z=he.length)))for(;B--;he[z++]=0);for(B=d-1;ae<de;){if(he[--de]<Se[de]){for(z=de;z&&!he[--z];he[z]=B);--he[z],he[de]+=d}he[de]-=Se[de]}for(;he[0]==0;he.splice(0,1),--te);return he[0]?Ee(k,he,te):(k.s=V==3?-1:1,k.c=[k.e=0],k)},A.modulo=A.mod=function(k,B){var z,de,ne=this;return k=new Z(k,B),!ne.c||!k.s||k.c&&!k.c[0]?new Z(NaN):!k.c||ne.c&&!ne.c[0]?new Z(ne):(F==9?(de=k.s,k.s=1,z=N(ne,k,0,3),k.s=de,z.s*=de):z=N(ne,k,0,F),(k=ne.minus(z.times(k))).c[0]||F!=1||(k.s=ne.s),k)},A.multipliedBy=A.times=function(k,B){var z,de,ne,fe,le,ae,pe,te,he,Se,be,_e,$e,Oe,Ye,Xe=this,ot=Xe.c,wt=(k=new Z(k,B)).c;if(!(ot&&wt&&ot[0]&&wt[0]))return!Xe.s||!k.s||ot&&!ot[0]&&!wt||wt&&!wt[0]&&!ot?k.c=k.e=k.s=null:(k.s*=Xe.s,ot&&wt?(k.c=[0],k.e=0):k.c=k.e=null),k;for(de=b(Xe.e/f)+b(k.e/f),k.s*=Xe.s,(pe=ot.length)<(Se=wt.length)&&($e=ot,ot=wt,wt=$e,ne=pe,pe=Se,Se=ne),ne=pe+Se,$e=[];ne--;$e.push(0));for(Oe=d,Ye=y,ne=Se;0<=--ne;){for(z=0,be=wt[ne]%Ye,_e=wt[ne]/Ye|0,fe=ne+(le=pe);ne<fe;)z=((te=be*(te=ot[--le]%Ye)+(ae=_e*te+(he=ot[le]/Ye|0)*be)%Ye*Ye+$e[fe]+z)/Oe|0)+(ae/Ye|0)+_e*he,$e[fe--]=te%Oe;$e[fe]=z}return z?++de:$e.splice(0,1),Ee(k,$e,de)},A.negated=function(){var k=new Z(this);return k.s=-k.s||null,k},A.plus=function(k,B){var z,de=this,ne=de.s;if(B=(k=new Z(k,B)).s,!ne||!B)return new Z(NaN);if(ne!=B)return k.s=-B,de.minus(k);var fe=de.e/f,le=k.e/f,ae=de.c,pe=k.c;if(!fe||!le){if(!ae||!pe)return new Z(ne/0);if(!ae[0]||!pe[0])return pe[0]?k:new Z(ae[0]?de:0*ne)}if(fe=b(fe),le=b(le),ae=ae.slice(),ne=fe-le){for((z=0<ne?(le=fe,pe):(ne=-ne,ae)).reverse();ne--;z.push(0));z.reverse()}for((ne=ae.length)-(B=pe.length)<0&&(z=pe,pe=ae,ae=z,B=ne),ne=0;B;)ne=(ae[--B]=ae[B]+pe[B]+ne)/d|0,ae[B]=d===ae[B]?0:ae[B]%d;return ne&&(ae=[ne].concat(ae),++le),Ee(k,ae,le)},A.precision=A.sd=function(k,B){var z,de,ne;if(k!=null&&k!==!!k)return L(k,1,C),B==null?B=V:L(B,0,8),Me(new Z(this),k,B);if(!(z=this.c))return null;if(de=(ne=z.length-1)*f+1,ne=z[ne]){for(;ne%10==0;ne/=10,de--);for(ne=z[0];10<=ne;ne/=10,de++);}return k&&this.e+1>de&&(de=this.e+1),de},A.shiftedBy=function(k){return L(k,-m,m),this.times("1e"+k)},A.squareRoot=A.sqrt=function(){var k,B,z,de,ne,fe=this,le=fe.c,ae=fe.s,pe=fe.e,te=G+4,he=new Z("0.5");if(ae!==1||!le||!le[0])return new Z(!ae||ae<0&&(!le||le[0])?NaN:le?fe:1/0);if((z=(ae=Math.sqrt(+Te(fe)))==0||ae==1/0?(((B=v(le)).length+pe)%2==0&&(B+="0"),ae=Math.sqrt(+B),pe=b((pe+1)/2)-(pe<0||pe%2),new Z(B=ae==1/0?"1e"+pe:(B=ae.toExponential()).slice(0,B.indexOf("e")+1)+pe)):new Z(ae+"")).c[0]){for((ae=(pe=z.e)+te)<3&&(ae=0);;)if(ne=z,z=he.times(ne.plus(N(fe,ne,te,1))),v(ne.c).slice(0,ae)===(B=v(z.c)).slice(0,ae)){if(z.e<pe&&--ae,(B=B.slice(ae-3,ae+1))!="9999"&&(de||B!="4999")){+B&&(+B.slice(1)||B.charAt(0)!="5")||(Me(z,z.e+G+2,1),k=!z.times(z).eq(fe));break}if(!de&&(Me(ne,ne.e+G+2,0),ne.times(ne).eq(fe))){z=ne;break}te+=4,ae+=4,de=1}}return Me(z,z.e+G+1,V,k)},A.toExponential=function(k,B){return k!=null&&(L(k,0,C),k++),Ce(this,k,B,1)},A.toFixed=function(k,B){return k!=null&&(L(k,0,C),k=k+this.e+1),Ce(this,k,B)},A.toFormat=function(k,B,z){var de;if(z==null)k!=null&&B&&typeof B=="object"?(z=B,B=null):k&&typeof k=="object"?(z=k,k=B=null):z=q;else if(typeof z!="object")throw Error(c+"Argument not an object: "+z);if(de=this.toFixed(k,B),this.c){var ne,fe=de.split("."),le=+z.groupSize,ae=+z.secondaryGroupSize,pe=z.groupSeparator||"",te=fe[0],he=fe[1],Se=this.s<0,be=Se?te.slice(1):te,_e=be.length;if(ae&&(ne=le,le=ae,_e-=ae=ne),0<le&&0<_e){for(ne=_e%le||le,te=be.substr(0,ne);ne<_e;ne+=le)te+=pe+be.substr(ne,le);0<ae&&(te+=pe+be.slice(ne)),Se&&(te="-"+te)}de=he?te+(z.decimalSeparator||"")+((ae=+z.fractionGroupSize)?he.replace(new RegExp("\\d{"+ae+"}\\B","g"),"$&"+(z.fractionGroupSeparator||"")):he):te}return(z.prefix||"")+de+(z.suffix||"")},A.toFraction=function(k){var B,z,de,ne,fe,le,ae,pe,te,he,Se,be,_e=this,$e=_e.c;if(k!=null&&(!(ae=new Z(k)).isInteger()&&(ae.c||ae.s!==1)||ae.lt(U)))throw Error(c+"Argument "+(ae.isInteger()?"out of range: ":"not an integer: ")+Te(ae));if(!$e)return new Z(_e);for(B=new Z(U),te=z=new Z(U),de=pe=new Z(U),be=v($e),fe=B.e=be.length-_e.e-1,B.c[0]=p[(le=fe%f)<0?f+le:le],k=!k||0<ae.comparedTo(B)?0<fe?B:te:ae,le=ee,ee=1/0,ae=new Z(be),pe.c[0]=0;he=N(ae,B,0,1),(ne=z.plus(he.times(de))).comparedTo(k)!=1;)z=de,de=ne,te=pe.plus(he.times(ne=te)),pe=ne,B=ae.minus(he.times(ne=B)),ae=ne;return ne=N(k.minus(z),de,0,1),pe=pe.plus(ne.times(te)),z=z.plus(ne.times(de)),pe.s=te.s=_e.s,Se=N(te,de,fe*=2,V).minus(_e).abs().comparedTo(N(pe,z,fe,V).minus(_e).abs())<1?[te,de]:[pe,z],ee=le,Se},A.toNumber=function(){return+Te(this)},A.toPrecision=function(k,B){return k!=null&&L(k,1,C),Ce(this,k,B,2)},A.toString=function(k){var B,z=this,de=z.s,ne=z.e;return ne===null?de?(B="Infinity",de<0&&(B="-"+B)):B="NaN":(B=k==null?ne<=oe||j<=ne?P(v(z.c),ne):x(v(z.c),ne,"0"):k===10?x(v((z=Me(new Z(z),G+ne+1,V)).c),z.e,"0"):(L(k,2,me.length,"Base"),H(x(v(z.c),ne,"0"),10,k,de,!0)),de<0&&z.c[0]&&(B="-"+B)),B},A.valueOf=A.toJSON=function(){return Te(this)},A._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(A[Symbol.toStringTag]="BigNumber",A[Symbol.for("nodejs.util.inspect.custom")]=A.valueOf),R!=null&&Z.set(R),Z}()).default=o.BigNumber=o,r!==void 0&&r.exports?r.exports=o:(s||(s=typeof self<"u"&&self?self:window),s.BigNumber=o)})(this)},{}],2:[function(t,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(s){var o=s%10;return~~(s%100/10)==1?"th":o===1?"st":o===2?"nd":o===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,r,i){function s(b,v){return function(S){if(Array.isArray(S))return S}(b)||function(S,L){var _=[],P=!0,x=!1,I=void 0;try{for(var R,N=S[Symbol.iterator]();!(P=(R=N.next()).done)&&(_.push(R.value),!L||_.length!==L);P=!0);}catch(H){x=!0,I=H}finally{try{P||N.return==null||N.return()}finally{if(x)throw I}}return _}(b,v)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=t("./globalState"),a=t("./validating"),l=t("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function d(b){var v=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},S=2<arguments.length?arguments[2]:void 0;if(typeof v=="string"&&(v=l.parseFormat(v)),!a.validateFormat(v))return"ERROR: invalid format";var L=v.prefix||"",_=v.postfix||"",P=function(x,I,R){switch(I.output){case"currency":return I=C(I,o.currentCurrencyDefaultFormat()),function(me,Z,Ce){var Re=Ce.currentCurrency(),Ee=Object.assign({},h,Z),Me=void 0,Te="",k=!!Ee.totalLength||!!Ee.forceAverage||Ee.average,B=Z.currencyPosition||Re.position,z=Z.currencySymbol||Re.symbol;Ee.spaceSeparated&&(Te=" "),B==="infix"&&(Me=Te+z+Te);var de=y({instance:me,providedFormat:Z,state:Ce,decimalSeparator:Me});return B==="prefix"&&(de=me._value<0&&Ee.negative==="sign"?"-".concat(Te).concat(z).concat(de.slice(1)):z+Te+de),B&&B!=="postfix"||(de=de+(Te=k?"":Te)+z),de}(x,I,o);case"percent":return I=C(I,o.currentPercentageDefaultFormat()),function(me,Z,Ce,Re){var Ee=Z.prefixSymbol,Me=y({instance:Re(100*me._value),providedFormat:Z,state:Ce}),Te=Object.assign({},h,Z);return Ee?"%".concat(Te.spaceSeparated?" ":"").concat(Me):"".concat(Me).concat(Te.spaceSeparated?" ":"","%")}(x,I,o,R);case"byte":return I=C(I,o.currentByteDefaultFormat()),U=x,V=o,oe=R,j=(G=I).base||"binary",ye=c[j],ee=f(U._value,ye.suffixes,ye.scale),T=ee.value,F=ee.suffix,Y=y({instance:oe(T),providedFormat:G,state:V,defaults:V.currentByteDefaultFormat()}),q=V.currentAbbreviations(),"".concat(Y).concat(q.spaced?" ":"").concat(F);case"time":return I=C(I,o.currentTimeDefaultFormat()),O=x,g=Math.floor(O._value/60/60),E=Math.floor((O._value-60*g*60)/60),A=Math.round(O._value-60*g*60-60*E),"".concat(g,":").concat(E<10?"0":"").concat(E,":").concat(A<10?"0":"").concat(A);case"ordinal":return I=C(I,o.currentOrdinalDefaultFormat()),N=x,H=I,X=(K=o).currentOrdinal(),J=Object.assign({},h,H),ue=y({instance:N,providedFormat:H,state:K}),se=X(N._value),"".concat(ue).concat(J.spaceSeparated?" ":"").concat(se);case"number":default:return y({instance:x,providedFormat:I,numbro:R})}var N,H,K,X,J,ue,se,O,g,E,A,U,G,V,oe,j,ye,ee,T,F,Y,q}(b,v,S);return P=(P=L+P)+_}function f(b,v,S){var L=v[0],_=Math.abs(b);if(S<=_){for(var P=1;P<v.length;++P){var x=Math.pow(S,P),I=Math.pow(S,P+1);if(x<=_&&_<I){L=v[P],b/=x;break}}L===v[0]&&(b/=Math.pow(S,v.length-1),L=v[v.length-1])}return{value:b,suffix:L}}function m(b){for(var v="",S=0;S<b;S++)v+="0";return v}function p(b,v){return b.toString().indexOf("e")!==-1?function(S,L){var _=S.toString(),P=s(_.split("e"),2),x=P[0],I=P[1],R=s(x.split("."),2),N=R[0],H=R[1],K=H===void 0?"":H;if(0<+I)_=N+K+m(I-K.length);else{var X=".";X=+N<0?"-0".concat(X):"0".concat(X);var J=(m(-I-1)+Math.abs(N)+K).substr(0,L);J.length<L&&(J+=m(L-J.length)),_=X+J}return 0<+I&&0<L&&(_+=".".concat(m(L))),_}(b,v):(Math.round(+"".concat(b,"e+").concat(v))/Math.pow(10,v)).toFixed(v)}function y(b){var v=b.instance,S=b.providedFormat,L=b.state,_=L===void 0?o:L,P=b.decimalSeparator,x=b.defaults,I=x===void 0?_.currentDefaults():x,R=v._value;if(R===0&&_.hasZeroFormat())return _.getZeroFormat();if(!isFinite(R))return R.toString();var N,H,K,X,J,ue,se,O,g=Object.assign({},h,I,S),E=g.totalLength,A=E?0:g.characteristic,U=g.optionalCharacteristic,G=g.forceAverage,V=!!E||!!G||g.average,oe=E?-1:V&&S.mantissa===void 0?0:g.mantissa,j=!E&&(S.optionalMantissa===void 0?oe===-1:g.optionalMantissa),ye=g.trimMantissa,ee=g.thousandSeparated,T=g.spaceSeparated,F=g.negative,Y=g.forceSign,q=g.exponential,me="";if(V){var Z=function(k){var B=k.value,z=k.forceAverage,de=k.abbreviations,ne=k.spaceSeparated,fe=ne!==void 0&&ne,le=k.totalLength,ae=le===void 0?0:le,pe="",te=Math.abs(B),he=-1;if(te>=Math.pow(10,12)&&!z||z==="trillion"?(pe=de.trillion,B/=Math.pow(10,12)):te<Math.pow(10,12)&&te>=Math.pow(10,9)&&!z||z==="billion"?(pe=de.billion,B/=Math.pow(10,9)):te<Math.pow(10,9)&&te>=Math.pow(10,6)&&!z||z==="million"?(pe=de.million,B/=Math.pow(10,6)):(te<Math.pow(10,6)&&te>=Math.pow(10,3)&&!z||z==="thousand")&&(pe=de.thousand,B/=Math.pow(10,3)),pe&&(pe=(fe?" ":"")+pe),ae){var Se=B.toString().split(".")[0];he=Math.max(ae-Se.length,0)}return{value:B,abbreviation:pe,mantissaPrecision:he}}({value:R,forceAverage:G,abbreviations:_.currentAbbreviations(),spaceSeparated:T,totalLength:E});R=Z.value,me+=Z.abbreviation,E&&(oe=Z.mantissaPrecision)}if(q){var Ce=(H=(N={value:R,characteristicPrecision:A}).value,K=N.characteristicPrecision,X=K===void 0?0:K,J=s(H.toExponential().split("e"),2),ue=J[0],se=J[1],O=+ue,X&&1<X&&(O*=Math.pow(10,X-1),se=0<=(se=+se-(X-1))?"+".concat(se):se),{value:O,abbreviation:"e".concat(se)});R=Ce.value,me=Ce.abbreviation+me}var Re,Ee,Me,Te=function(k,B,z,de,ne){if(de===-1)return k;var fe=p(B,de),le=s(fe.toString().split("."),2),ae=le[0],pe=le[1],te=pe===void 0?"":pe;if(te.match(/^0+$/)&&(z||ne))return ae;var he=te.match(/0+$/);return ne&&he?"".concat(ae,".").concat(te.toString().slice(0,he.index)):fe.toString()}(R.toString(),R,j,oe,ye);return Te=function(k,B,z,de,ne){var fe=de.currentDelimiters(),le=fe.thousands;ne=ne||fe.decimal;var ae=fe.thousandsSize||3,pe=k.toString(),te=pe.split(".")[0],he=pe.split(".")[1];return z&&(B<0&&(te=te.slice(1)),function(Se,be){for(var _e=[],$e=0,Oe=Se;0<Oe;Oe--)$e===be&&(_e.unshift(Oe),$e=0),$e++;return _e}(te.length,ae).forEach(function(Se,be){te=te.slice(0,Se+be)+le+te.slice(Se+be)}),B<0&&(te="-".concat(te))),pe=he?te+ne+he:te}(Te=function(k,B,z,de){var ne=k,fe=s(ne.toString().split("."),2),le=fe[0],ae=fe[1];if(le.match(/^-?0$/)&&z)return ae?"".concat(le.replace("0",""),".").concat(ae):le.replace("0","");if(le.length<de)for(var pe=de-le.length,te=0;te<pe;te++)ne="0".concat(ne);return ne.toString()}(Te,0,U,A),R,ee,_,P),(V||q)&&(Te=Te+me),(Y||R<0)&&(Re=Te,Me=F,Te=(Ee=R)===0?Re:+Re==0?Re.replace("-",""):0<Ee?"+".concat(Re):Me==="sign"?Re:"(".concat(Re.replace("-",""),")")),Te}function C(b,v){if(!b)return v;var S=Object.keys(b);return S.length===1&&S[0]==="output"?v:b}r.exports=function(b){return{format:function(){for(var v=arguments.length,S=new Array(v),L=0;L<v;L++)S[L]=arguments[L];return d.apply(void 0,S.concat([b]))},getByteUnit:function(){for(var v=arguments.length,S=new Array(v),L=0;L<v;L++)S[L]=arguments[L];return function(_){var P=c.general;return f(_._value,P.suffixes,P.scale).suffix}.apply(void 0,S.concat([b]))},getBinaryByteUnit:function(){for(var v=arguments.length,S=new Array(v),L=0;L<v;L++)S[L]=arguments[L];return function(_){var P=c.binary;return f(_._value,P.suffixes,P.scale).suffix}.apply(void 0,S.concat([b]))},getDecimalByteUnit:function(){for(var v=arguments.length,S=new Array(v),L=0;L<v;L++)S[L]=arguments[L];return function(_){var P=c.decimal;return f(_._value,P.suffixes,P.scale).suffix}.apply(void 0,S.concat([b]))},formatOrDefault:C}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,r,i){var s=t("./en-US"),o=t("./validating"),a=t("./parsing"),l={},u=void 0,c={},h=null,d={};function f(p){u=p}function m(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return m().currency},l.currentAbbreviations=function(){return m().abbreviations},l.currentDelimiters=function(){return m().delimiters},l.currentOrdinal=function(){return m().ordinal},l.currentDefaults=function(){return Object.assign({},m().defaults,d)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().timeFormat)},l.setDefaults=function(p){p=a.parseFormat(p),o.validateFormat(p)&&(d=p)},l.getZeroFormat=function(){return h},l.setZeroFormat=function(p){return h=typeof p=="string"?p:null},l.hasZeroFormat=function(){return h!==null},l.languageData=function(p){if(p){if(c[p])return c[p];throw new Error('Unknown tag "'.concat(p,'"'))}return m()},l.registerLanguage=function(p){var y=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!o.validateLanguage(p))throw new Error("Invalid language data");c[p.languageTag]=p,y&&f(p.languageTag)},l.setLanguage=function(p){var y=1<arguments.length&&arguments[1]!==void 0?arguments[1]:s.languageTag;if(!c[p]){var C=p.split("-")[0],b=Object.keys(c).find(function(v){return v.split("-")[0]===C});return c[b]?void f(b):void f(y)}f(p)},l.registerLanguage(s),u=s.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,r,i){r.exports=function(s){return{loadLanguagesInNode:function(o){return a=s,void o.forEach(function(l){var u=void 0;try{u=t("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(t,r,i){var s=t("bignumber.js");function o(a,l,u){var c=new s(a._value),h=l;return u.isNumbro(l)&&(h=l._value),h=new s(h),a._value=c.minus(h).toNumber(),a}r.exports=function(a){return{add:function(l,u){return h=u,d=a,f=new s((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new s(m),c._value=f.plus(m).toNumber(),c;var c,h,d,f,m},subtract:function(l,u){return o(l,u,a)},multiply:function(l,u){return h=u,d=a,f=new s((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new s(m),c._value=f.times(m).toNumber(),c;var c,h,d,f,m},divide:function(l,u){return h=u,d=a,f=new s((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new s(m),c._value=f.dividedBy(m).toNumber(),c;var c,h,d,f,m},set:function(l,u){return c=l,d=h=u,a.isNumbro(h)&&(d=h._value),c._value=d,c;var c,h,d},difference:function(l,u){return c=u,o(d=(h=a)(l._value),c,h),Math.abs(d._value);var c,h,d}}}},{"bignumber.js":1}],7:[function(t,r,i){function s(y,C){for(var b=0;b<C.length;b++){var v=C[b];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(y,v.key,v)}}var o=t("./globalState"),a=t("./validating"),l=t("./loading")(p),u=t("./unformatting"),c=t("./formatting")(p),h=t("./manipulating")(p),d=t("./parsing"),f=function(){function y(v){(function(S,L){if(!(S instanceof L))throw new TypeError("Cannot call a class as a function")})(this,y),this._value=v}var C,b;return C=y,(b=[{key:"clone",value:function(){return p(this._value)}},{key:"format",value:function(){var v=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,v)}},{key:"formatCurrency",value:function(v){return typeof v=="string"&&(v=d.parseFormat(v)),(v=c.formatOrDefault(v,o.currentCurrencyDefaultFormat())).output="currency",c.format(this,v)}},{key:"formatTime",value:function(){var v=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return v.output="time",c.format(this,v)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(v){return h.difference(this,v)}},{key:"add",value:function(v){return h.add(this,v)}},{key:"subtract",value:function(v){return h.subtract(this,v)}},{key:"multiply",value:function(v){return h.multiply(this,v)}},{key:"divide",value:function(v){return h.divide(this,v)}},{key:"set",value:function(v){return h.set(this,m(v))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&s(C.prototype,b),y}();function m(y){var C=y;return p.isNumbro(y)?C=y._value:typeof y=="string"?C=p.unformat(y):isNaN(y)&&(C=NaN),C}function p(y){return new f(m(y))}p.version="2.1.2",p.isNumbro=function(y){return y instanceof f},p.language=o.currentLanguage,p.registerLanguage=o.registerLanguage,p.setLanguage=o.setLanguage,p.languages=o.languages,p.languageData=o.languageData,p.zeroFormat=o.setZeroFormat,p.defaultFormat=o.currentDefaults,p.setDefaults=o.setDefaults,p.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,p.validate=a.validate,p.loadLanguagesInNode=l.loadLanguagesInNode,p.unformat=u.unformat,r.exports=p},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,r,i){r.exports={parseFormat:function(s){var o,a,l,u,c,h,d,f,m,p,y,C,b,v,S,L,_,P,x,I,R=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof s!="string"?s:(a=R,s=(l=(o=s).match(/^{([^}]*)}/))?(a.prefix=l[1],o.slice(l[0].length)):o,c=R,function(N,H){if(N.indexOf("$")===-1){if(N.indexOf("%")===-1)return N.indexOf("bd")!==-1?(H.output="byte",H.base="general"):N.indexOf("b")!==-1?(H.output="byte",H.base="binary"):N.indexOf("d")!==-1?(H.output="byte",H.base="decimal"):N.indexOf(":")===-1?N.indexOf("o")!==-1&&(H.output="ordinal"):H.output="time";H.output="percent"}else H.output="currency"}(s=(h=(u=s).match(/{([^}]*)}$/))?(c.postfix=h[1],u.slice(0,-h[0].length)):u,R),d=R,(f=s.match(/[1-9]+[0-9]*/))&&(d.totalLength=+f[0]),m=R,(p=s.split(".")[0].match(/0+/))&&(m.characteristic=p[0].length),function(N,H){if(N.indexOf(".")!==-1){var K=N.split(".")[0];H.optionalCharacteristic=K.indexOf("0")===-1}}(s,R),y=R,s.indexOf("a")!==-1&&(y.average=!0),b=R,(C=s).indexOf("K")!==-1?b.forceAverage="thousand":C.indexOf("M")!==-1?b.forceAverage="million":C.indexOf("B")!==-1?b.forceAverage="billion":C.indexOf("T")!==-1&&(b.forceAverage="trillion"),function(N,H){var K=N.split(".")[1];if(K){var X=K.match(/0+/);X&&(H.mantissa=X[0].length)}}(s,R),S=R,(v=s).match(/\[\.]/)?S.optionalMantissa=!0:v.match(/\./)&&(S.optionalMantissa=!1),L=R,s.indexOf(",")!==-1&&(L.thousandSeparated=!0),_=R,s.indexOf(" ")!==-1&&(_.spaceSeparated=!0),x=R,(P=s).match(/^\+?\([^)]*\)$/)&&(x.negative="parenthesis"),P.match(/^\+?-/)&&(x.negative="sign"),I=R,s.match(/^\+/)&&(I.forceSign=!0),R)}}},{}],9:[function(t,r,i){var s=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function o(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,d=4<arguments.length?arguments[4]:void 0,f=5<arguments.length?arguments[5]:void 0,m=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===d?0:function p(y,C){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",v=3<arguments.length?arguments[3]:void 0,S=4<arguments.length?arguments[4]:void 0,L=5<arguments.length?arguments[5]:void 0,_=6<arguments.length?arguments[6]:void 0;if(!isNaN(+y))return+y;var P="",x=y.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(x!==y)return-1*p(x,C,b,v,S,L,_);for(var I=0;I<s.length;I++){var R=s[I];if((P=y.replace(R.key,""))!==y)return p(P,C,b,v,S,L,_)*R.factor}if((P=y.replace("%",""))!==y)return p(P,C,b,v,S,L,_)/100;var N=parseFloat(y);if(!isNaN(N)){var H=v(N);if(H&&H!=="."&&(P=y.replace(new RegExp("".concat(o(H),"$")),""))!==y)return p(P,C,b,v,S,L,_);var K={};Object.keys(L).forEach(function(E){K[L[E]]=E});for(var X=Object.keys(K).sort().reverse(),J=X.length,ue=0;ue<J;ue++){var se=X[ue],O=K[se];if((P=y.replace(se,""))!==y){var g=void 0;switch(O){case"thousand":g=Math.pow(10,3);break;case"million":g=Math.pow(10,6);break;case"billion":g=Math.pow(10,9);break;case"trillion":g=Math.pow(10,12)}return p(P,C,b,v,S,L,_)*g}}}}(function(p,y){var C=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",b=p.replace(C,"");return b=(b=b.replace(new RegExp("([0-9])".concat(o(y.thousands),"([0-9])"),"g"),"$1$2")).replace(y.decimal,".")}(l,u,c),u,c,h,d,f,m)}r.exports={unformat:function(l,u){var c,h,d,f=t("./globalState"),m=f.currentDelimiters(),p=f.currentCurrency().symbol,y=f.currentOrdinal(),C=f.getZeroFormat(),b=f.currentAbbreviations(),v=void 0;if(typeof l=="string")v=function(S,L){if(!S.indexOf(":")||L.thousands===":")return!1;var _=S.split(":");if(_.length!==3)return!1;var P=+_[0],x=+_[1],I=+_[2];return!isNaN(P)&&!isNaN(x)&&!isNaN(I)}(l,m)?(c=l.split(":"),h=+c[0],d=+c[1],+c[2]+60*d+3600*h):a(l,m,p,y,C,b,u);else{if(typeof l!="number")return;v=l}if(v!==void 0)return v}}},{"./globalState":4}],10:[function(t,r,i){function s(m){return function(p){if(Array.isArray(p)){for(var y=0,C=new Array(p.length);y<p.length;y++)C[y]=p[y];return C}}(m)||function(p){if(Symbol.iterator in Object(p)||Object.prototype.toString.call(p)==="[object Arguments]")return Array.from(p)}(m)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(m){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(m)}var a=t("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(m,p){return p.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(m){return m.output==="byte"}},characteristic:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(m){return 0<=m},message:"value must be positive"},{restriction:function(m,p){return!p.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(m,p){return p.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(m){return m.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(m){return!!a.unformat(m)}function d(m,p,y){var C=3<arguments.length&&arguments[3]!==void 0&&arguments[3],b=Object.keys(m).map(function(v){if(!p[v])return console.error("".concat(y," Invalid key: ").concat(v)),!1;var S=m[v],L=p[v];if(typeof L=="string"&&(L={type:L}),L.type==="format"){if(!d(S,u,"[Validate ".concat(v,"]"),!0))return!1}else if(o(S)!==L.type)return console.error("".concat(y," ").concat(v,' type mismatched: "').concat(L.type,'" expected, "').concat(o(S),'" provided')),!1;if(L.restrictions&&L.restrictions.length)for(var _=L.restrictions.length,P=0;P<_;P++){var x=L.restrictions[P],I=x.restriction,R=x.message;if(!I(S,m))return console.error("".concat(y," ").concat(v," invalid value: ").concat(R)),!1}return L.restriction&&!L.restriction(S,m)?(console.error("".concat(y," ").concat(v," invalid value: ").concat(L.message)),!1):L.validValues&&L.validValues.indexOf(S)===-1?(console.error("".concat(y," ").concat(v," invalid value: must be among ").concat(JSON.stringify(L.validValues),', "').concat(S,'" provided')),!1):!(L.children&&!d(S,L.children,"[Validate ".concat(v,"]")))});return C||b.push.apply(b,s(Object.keys(p).map(function(v){var S=p[v];if(typeof S=="string"&&(S={type:S}),S.mandatory){var L=S.mandatory;if(typeof L=="function"&&(L=L(m)),L&&m[v]===void 0)return console.error("".concat(y,' Missing mandatory key "').concat(v,'"')),!1}return!0}))),b.reduce(function(v,S){return v&&S},!0)}function f(m){return d(m,u,"[Validate format]")}r.exports={validate:function(m,p){var y=h(m),C=f(p);return y&&C},validateFormat:f,validateInput:h,validateLanguage:function(m){return d(m,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(Yx);const Ea=Yx.exports,BG="numeric";function dv(n,e,t,r,i,s,o){let a=s;if(zr(a)){const l=o.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,h=o.className||"",d=h.length?h.split(" "):[];if(typeof u<"u"&&!Ea.languages()[u]){const f=u.replace("-",""),m=Ea.allLanguages?Ea.allLanguages[u]:Ea[f];m&&Ea.registerLanguage(m)}Ea.setLanguage(u),a=Ea(a).format(c||"0"),d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),o.className=d.join(" "),e.dir="ltr"}To(n,e,t,r,i,a,o)}dv.RENDERER_TYPE=BG;const VG="password";function fv(n,e,t,r,i,s,o){To.apply(this,[n,e,t,r,i,s,o]);const a=o.hashLength||e.innerHTML.length,l=o.hashSymbol||"*";let u="";ze(a-1,()=>{u+=l}),pc(e,u)}fv.RENDERER_TYPE=VG;const $G="time";function mv(n,e,t,r,i,s,o){To.apply(this,[n,e,t,r,i,s,o]),e.dir="ltr"}mv.RENDERER_TYPE=$G;const{register:WG,getItem:GG,hasItem:jx,getNames:vCe,getValues:CCe}=Hi("renderers");function VR(n){if(typeof n=="function")return n;if(!jx(n))throw Error(`No registered renderer found under "${n}" name`);return GG(n)}function so(n,e){typeof n!="string"&&(e=n,n=e.RENDERER_TYPE),WG(n,e)}function zG(){so(yc),so(Dd),so(cv),so(uv),so(dv),so(fv),so(To),so(mv)}const YG="autocomplete";function Wg(n,e){let t=n;if(t==null&&(t=""),this.allowEmpty&&t===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,$R(t,e)):$R(t,e)(this.source):e(!0)}Wg.VALIDATOR_TYPE=YG;function $R(n,e){const t=n;return function(r){let i=!1;for(let s=0,o=r.length;s<o;s++)if(t===r[s]){i=!0;break}e(i)}}function jG(n){const e=new Date(n);return isNaN(new Date(`${n}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const KG="date";function pv(n,e){const t=Dx(Bx,this.instance);let r=n,i=!0;r==null&&(r="");let s=It(r,this.dateFormat||t.defaultDateFormat,!0).isValid(),o=It(new Date(r)).isValid()||s;if(this.allowEmpty&&r===""&&(o=!0,s=!0),o||(i=!1),!o&&s&&(i=!0),o&&!s)if(this.correctFormat===!0){const a=qG(r,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),i=!0}else i=!1;e(i)}pv.VALIDATOR_TYPE=KG;function qG(n,e){const t=It(jG(n)),r=It(n,e),i=n.search(/[A-z]/g)>-1;let s;return t.isValid()&&t.format("x")===r.format("x")||!r.isValid()||i?s=t:s=r,s.format(e)}const XG="numeric";function gv(n,e){let t=n;t==null&&(t=""),this.allowEmpty&&t===""?e(!0):e(t===""?!1:zr(n))}gv.VALIDATOR_TYPE=XG;const QG=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],ZG="time";function yv(n,e){const t=this.timeFormat||"h:mm:ss a";let r=!0,i=n;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const o=It(i,QG,!0).isValid()?It(i):It(i,t);let a=o.isValid(),l=It(i,t,!0).isValid()&&!s;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=o.format(t),c=this.instance.toVisualRow(this.row),h=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,h,u,"timeValidator"),r=!0}else r=!1;e(r)}yv.VALIDATOR_TYPE=ZG;const{register:JG,getItem:ez,hasItem:Kx,getNames:ECe,getValues:bCe}=Hi("validators");function tz(n){if(typeof n=="function")return n;if(!Kx(n))throw Error(`No registered validator found under "${n}" name`);return ez(n)}function rh(n,e){typeof n!="string"&&(e=n,n=e.VALIDATOR_TYPE),JG(n,e)}function nz(){rh(Wg),rh(pv),rh(gv),rh(yv)}const rz="autocomplete",iz={CELL_TYPE:rz,editor:av,renderer:yc,validator:Wg},sz="checkbox",oz={CELL_TYPE:sz,editor:Hx,renderer:cv},az="date",lz={CELL_TYPE:az,editor:Vx,renderer:yc,validator:pv},uz="dropdown",cz={CELL_TYPE:uz,editor:lv,renderer:yc,validator:Wg},hz="handsontable",dz={CELL_TYPE:hz,editor:ov,renderer:yc},fz="numeric",mz={CELL_TYPE:fz,editor:$x,renderer:dv,validator:gv,dataType:"number"},pz="password",gz={CELL_TYPE:pz,editor:Wx,renderer:fv,copyable:!1},yz="text",qx={CELL_TYPE:yz,editor:xl,renderer:To},wz="time",vz={CELL_TYPE:wz,editor:Gx,renderer:mv,validator:yv},{register:Cz,getItem:Ez,hasItem:Xx,getNames:SCe,getValues:RCe}=Hi("cellTypes");function bz(n){if(!Xx(n))throw Error(`You declared cell type "${n}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Ez(n)}function vs(n,e){typeof n!="string"&&(e=n,n=e.CELL_TYPE);const{editor:t,renderer:r,validator:i}=e;t&&li(n,t),r&&so(n,r),i&&rh(n,i),Cz(n,e)}function Sz(){vs(iz),vs(oz),vs(lz),vs(cz),vs(dz),vs(mz),vs(gz),vs(qx),vs(vz)}const Dy="asc",Rz="desc",WR=new Map([[Dy,[-1,1]],[Rz,[1,-1]]]),Tz=n=>`The priority '${n}' is already declared in a map.`,Az=n=>`The priority '${n}' is not a number.`;function xz(){let{errorPriorityExists:n,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Map;n=qt(n)?n:Tz,e=qt(e)?e:Az;function r(s,o){if(!zr(s))throw new Error(e(s));if(t.has(s))throw new Error(n(s));t.set(s,o)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Dy;const[o,a]=WR.get(s)||WR.get(Dy);return[...t].sort((l,u)=>l[0]<u[0]?o:a).map(l=>l[1])}return{addItem:r,getItems:i}}const Mz=n=>`The id '${n}' is already declared in a map.`;function Gg(){let{errorIdExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;n=qt(n)?n:Mz;function t(u,c){if(l(u))throw new Error(n(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function s(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function o(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:t,clear:i,getId:s,getItem:o,getItems:a,hasItem:l,removeItem:r}}const Nz=n=>`'${n}' value is already declared in a unique set.`;function Iz(){let{errorItemExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;n=qt(n)?n:Nz;function t(s){if(e.has(s))throw new Error(n(s));e.add(s)}function r(){return[...e]}function i(){e.clear()}return{addItem:t,clear:i,getItems:r}}const wv=n=>`There is already registered "${n}" plugin.`,Oz=n=>`There is already registered plugin on priority "${n}".`,_z=n=>`The priority "${n}" is not a number.`,Qx=xz({errorPriorityExists:Oz,errorPriorityNaN:_z}),Zx=Iz({errorItemExists:wv}),ky=Gg({errorIdExists:wv});function Jx(){return[...Qx.getItems(),...Zx.getItems()]}function vv(n){const e=ts(n);return ky.getItem(e)}function Lz(n){return!!vv(n)}function Mt(n,e,t){[n,e,t]=Dz(n,e,t),vv(n)===void 0&&Pz(n,e,t)}function Pz(n,e,t){const r=ts(n);if(ky.hasItem(r))throw new Error(wv(r));t===void 0?Zx.addItem(r):Qx.addItem(t,r),ky.addItem(r,e)}function Dz(n,e,t){return typeof n=="function"&&(e=n,n=e.PLUGIN_KEY,t=e.PLUGIN_PRIORITY),[n,e,t]}function kz(n,e){Fz(n,e),e.add(n)}function Fz(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hz(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}const GR=new Map([["plugin",Lz],["cell-type",Xx],["editor",Px],["renderer",jx],["validator",Kx]]),Uz="base",ba=new WeakMap,g2=[];let us=null;var zR=new WeakSet;class Lt{static get PLUGIN_KEY(){return Uz}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){kz(this,zR),Ro(this,"hot",e,{writable:!1}),ba.set(this,{hooks:{}}),us=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const i=[];if(t.forEach(s=>{const[o,a]=s.split(":");if(!GR.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);GR.get(o)(a)||i.push(` - ${a} (${o})`)}),i.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");g2.push(s)}}if(us||(us=Jx()),us.indexOf("UndoRedo")>=0&&us.splice(us.indexOf("UndoRedo"),1),us.indexOf(this.pluginName)>=0&&us.splice(us.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),us.length===0){if(g2.length>0){const i=[`${g2.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t){ba.get(this).hooks[e]=ba.get(this).hooks[e]||[];const r=ba.get(this).hooks[e];this.hot.addHook(e,t),r.push(t),ba.get(this).hooks[e]=r}removeHooks(e){re(ba.get(this).hooks[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=ba.get(this).hooks;ft(e,(t,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){re(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=Hz(this,zR,Bz).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){this.eventManager&&this.eventManager.destroy(),this.clearHooks(),ft(this,(e,t)=>{t!=="hot"&&(this[t]=null)}),delete this.t,delete this.hot}}function Bz(n){if(!n)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let t=0;t<e.length;t++)if(n[e[t]]!==void 0)return!0;return!1}function Cv(n){return window.requestAnimationFrame(n)}function fp(n){window.cancelAnimationFrame(n)}function e9(){return"ontouchstart"in window}let Bl;function Vz(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Bl||(typeof Intl=="object"?Bl=new Intl.Collator(n,e).compare:typeof String.prototype.localeCompare=="function"?Bl=(t,r)=>`${t}`.localeCompare(r):Bl=(t,r)=>t===r?0:t>r?-1:1,Bl)}class $z{constructor(e){this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(t!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),re(this.rows,t=>{e(t.row,cn(t.table)-1)})}getWidths(e){this.injected||this.injectTable(),re(this.columns,t=>{const{width:r}=t.table.getBoundingClientRect();e(t.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(){const e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1)),this.samples.forEach(t=>{re(t.strings,r=>{e.appendChild(this.createColElement(r.col))})}),e}createRow(e){const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(s=>{re(s.strings,o=>{const a=o.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=t.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),o.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),t.appendChild(i)}this.samples.forEach(i=>{re(i.strings,s=>{const o=s.col,a=e.createElement("th");r.push([o,a]),t.appendChild(a)})}),this.table.tHead.appendChild(t),re(r,i=>{const[s,o]=i;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:t}=this.hot,r=t.createDocumentFragment();return this.samples.forEach(i=>{re(i.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e);a.col=e,a.row=o;const l=this.hot.getCellRenderer(a),u=t.createElement("td"),c=t.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,o,e,this.hot.colToProp(e),s.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e){const t=this.hot.rootDocument.createElement("col");return t.style.width=`${this.hot.view._wt.wtTable.getStretchedColumnWidth(e)}px`,t}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("table"),s=t.createElement("thead"),o=t.createElement("tbody"),a=t.createElement("colgroup"),l=t.createElement("tr"),u=t.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),s.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(s),this.isVertical()&&o.appendChild(l),i.appendChild(o),Ae(i,e),r.appendChild(i),{fragment:r,table:i,tHead:s,tBody:o,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return Ae(i,s),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}const t9=$z;class Ev{static get SAMPLE_COUNT(){return 3}constructor(e){this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}getSampleCount(){return this.customSampleCount?this.customSampleCount:Ev.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,r){const i=new Map,{from:s,to:o}=typeof r=="number"?{from:r,to:r}:r;return ze(s,o,a=>{const l=this.generateSample(e,t,a);i.set(a,l)}),i}generateSample(e,t,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,s=e==="row"?"col":"row",o=[];return ze(t.from,t.to,a=>{const{value:l,bundleSeed:u}=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r),c=typeof u=="string"&&u.length>0;let h;c?h=u:dt(l)?h=`${Object.keys(l).length}`:Array.isArray(l)?h=`${l.length}`:h=`${In(l).length}`,i.has(h)||i.set(h,{needed:this.getSampleCount(),strings:[]});const d=i.get(h);d.needed&&(!(o.indexOf(l)>-1)||this.allowDuplicates||c)&&(d.strings.push({value:l,[s]:a}),o.push(l),d.needed-=1)}),i}}const n9=Ev;var r9={},Wz=ZA,Gz=X5,zz=Object.keys||function(e){return Wz(e,Gz)},Yz=Gs,jz=zA,Kz=Sl,qz=Id,Xz=Pg,Qz=zz;r9.f=Yz&&!jz?Object.defineProperties:function(e,t){qz(e);for(var r=Xz(t),i=Qz(t),s=i.length,o=0,a;s>o;)Kz.f(e,a=i[o++],r[a]);return e};var Zz=Nd,i9=Zz("document","documentElement"),Jz=Id,eY=r9,YR=X5,tY=j5,nY=i9,rY=z5,iY=KA,jR=">",KR="<",Fy="prototype",Hy="script",s9=iY("IE_PROTO"),y2=function(){},o9=function(n){return KR+Hy+jR+n+KR+"/"+Hy+jR},qR=function(n){n.write(o9("")),n.close();var e=n.parentWindow.Object;return n=null,e},sY=function(){var n=rY("iframe"),e="java"+Hy+":",t;return n.style.display="none",nY.appendChild(n),n.src=String(e),t=n.contentWindow.document,t.open(),t.write(o9("document.F=Object")),t.close(),t.F},pf,_m=function(){try{pf=new ActiveXObject("htmlfile")}catch{}_m=typeof document<"u"?document.domain&&pf?qR(pf):sY():qR(pf);for(var n=YR.length;n--;)delete _m[Fy][YR[n]];return _m()};tY[s9]=!0;var oY=Object.create||function(e,t){var r;return e!==null?(y2[Fy]=Jz(e),r=new y2,y2[Fy]=null,r[s9]=e):r=_m(),t===void 0?r:eY.f(r,t)},aY=kg,lY=oY,uY=Sl.f,Uy=aY("unscopables"),By=Array.prototype;By[Uy]===void 0&&uY(By,Uy,{configurable:!0,value:lY(null)});var cY=function(n){By[Uy][n]=!0},hY=Rl,dY=Dg,fY=Fg,mY=q5,pY=cY;hY({target:"Array",proto:!0},{at:function(e){var t=dY(this),r=fY(t),i=mY(e),s=i>=0?i:r+i;return s<0||s>=r?void 0:t[s]}});pY("at");const Va=1,br=2,Vl=new WeakMap;class bv{static get DEFAULT_WIDTH(){return 50}constructor(){let{viewportSize:e,scrollOffset:t,totalItems:r,itemSizeFn:i,overrideFn:s,calculationType:o,stretchMode:a,stretchingItemWidthFn:l=c=>c,inlineStartOffset:u}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Vl.set(this,{viewportWidth:e,scrollOffset:t,totalColumns:r,columnWidthFn:i,overrideFn:s,calculationType:o,stretchingColumnWidthFn:l,inlineStartOffset:u}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=a,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}calculate(){let e=0,t=!0;const r=[];let i,s=0,o=0;const a=Vl.get(this),l=a.calculationType,u=a.overrideFn,c=a.scrollOffset,h=Math.max(a.scrollOffset,0),d=a.totalColumns,f=a.viewportWidth,m=h>0?f+1:f;for(let b=0;b<d;b++)if(i=this._getColumnWidth(b),e<=h&&l!==br&&(this.startColumn=b,s=i),e>=h&&e+(l===br?i:0)<=h+m&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=b,s=i),this.endColumn=b),r.push(e),e+=i,o=i,l!==br&&(this.endColumn=b),e>=h+f){t=!1;break}const p=c+f-m,y=l===br?0:o,C=l===br?s:0;if(p<-1*a.inlineStartOffset||c>r.at(-1)+y||-1*a.scrollOffset-a.viewportWidth>-1*C?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&t)for(this.startColumn=this.endColumn;this.startColumn>0;){const b=r[this.endColumn]+i-r[this.startColumn-1];if((b<=f||l!==br)&&(this.startColumn-=1),b>f)break}l===Va&&this.startColumn!==null&&u&&u(this),this.startPosition=r[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(this.stretch==="none")return;let t=e;this.totalTargetWidth=t;const r=Vl.get(this),i=r.totalColumns;let s=0;for(let a=0;a<i;a++){const l=this._getColumnWidth(a),u=r.stretchingColumnWidthFn(void 0,a);typeof u=="number"?t-=u:s+=l}const o=t-s;if(this.stretch==="all"&&o>0)this.stretchAllRatio=t/s,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&t!==1/0){const a=this._getColumnWidth(i-1),l=o+a;this.stretchLastWidth=l>=0?l:a}}getStretchedColumnWidth(e,t){let r=null;return this.stretch==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,t):this.stretch==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,t){let r=0;const i=Vl.get(this),s=i.totalColumns;if(!this.stretchAllColumnsWidth[e]){const o=Math.round(t*this.stretchAllRatio),a=i.stretchingColumnWidthFn(o,e);a===void 0?this.stretchAllColumnsWidth[e]=o:this.stretchAllColumnsWidth[e]=isNaN(a)?this._getColumnWidth(e):a}if(this.stretchAllColumnsWidth.length===s&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let o=0;o<this.stretchAllColumnsWidth.length;o++)r+=this.stretchAllColumnsWidth[o];r!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const r=Vl.get(this).totalColumns;return e===r-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=Vl.get(this).columnWidthFn(e);return isNaN(t)&&(t=bv.DEFAULT_WIDTH),t}}const Sv=bv,XR=new WeakMap;class Rv{static get DEFAULT_HEIGHT(){return 23}constructor(){let{viewportSize:e,scrollOffset:t,totalItems:r,itemSizeFn:i,overrideFn:s,calculationType:o,scrollbarHeight:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};XR.set(this,{viewportHeight:e,scrollOffset:t,totalRows:r,rowHeightFn:i,overrideFn:s,calculationType:o,horizontalScrollbarHeight:a}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}calculate(){const e=XR.get(this),t=e.calculationType,r=e.overrideFn,i=e.rowHeightFn,s=e.scrollOffset,o=Math.max(e.scrollOffset,0),a=e.totalRows,l=e.viewportHeight,u=e.horizontalScrollbarHeight||0;let c=0,h=!0;const d=[];let f,m=0,p=0;for(let v=0;v<a;v++)if(f=i(v),isNaN(f)&&(f=Rv.DEFAULT_HEIGHT),c<=o&&t!==br&&(this.startRow=v,m=f),c>=o&&c+(t===br?f:0)<=o+l-u&&(this.startRow===null&&(this.startRow=v,m=f),this.endRow=v),d.push(c),c+=f,p=f,t!==br&&(this.endRow=v),c>=o+l-u){h=!1;break}const y=s+l-u,C=t===br?m:0,b=t===br?0:p;if(y<C||s>d.at(-1)+b?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===a-1&&h)for(this.startRow=this.endRow;this.startRow>0;){const v=d[this.endRow]+f-d[this.startRow-1];if((v<=l-u||t!==br)&&(this.startRow-=1),v>=l-u)break}t===Va&&this.startRow!==null&&r&&r(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}const a9=Rv;function gY(n,e,t){yY(n,e),e.set(n,t)}function yY(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QR(n,e,t){return e=wY(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wY(n){var e=vY(n,"string");return typeof e=="symbol"?e:String(e)}function vY(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function _c(n,e){var t=l9(n,e,"get");return CY(n,t)}function CY(n,e){return e.get?e.get.call(n):e.value}function EY(n,e,t){var r=l9(n,e,"set");return bY(n,r,t),t}function l9(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function bY(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Sa=new WeakMap;class Tv{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;QR(this,"row",null),QR(this,"col",null),gY(this,Sa,{writable:!0,value:!1}),EY(this,Sa,r),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isSouthEastOf(e){return this.row>=e.row&&(_c(this,Sa)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(_c(this,Sa)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(_c(this,Sa)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(_c(this,Sa)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}clone(){return new Tv(this.row,this.col,_c(this,Sa))}toObject(){return{row:this.row,col:this.col}}}const mp=Tv;function SY(n,e,t){RY(n,e),e.set(n,t)}function RY(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function w2(n,e,t){return e=TY(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function TY(n){var e=AY(n,"string");return typeof e=="symbol"?e:String(e)}function AY(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function cs(n,e){var t=u9(n,e,"get");return xY(n,t)}function xY(n,e){return e.get?e.get.call(n):e.value}function MY(n,e,t){var r=u9(n,e,"set");return NY(n,r,t),t}function u9(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function NY(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var yi=new WeakMap;class Av{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;w2(this,"highlight",null),w2(this,"from",null),w2(this,"to",null),SY(this,yi,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=t.clone(),this.to=r.clone(),MY(this,yi,i)}setHighlight(e){return this.highlight=e.clone().normalize(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:r}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=t&&s.row>=t&&i.col<=r&&s.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<t.row||e.col<t.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),s=e.getOuterTopStartCorner(),o=e.getOuterBottomEndCorner(),a=Math.min(t.row,s.row),l=Math.min(t.col,s.col),u=Math.max(r.row,o.row),c=Math.max(r.col,o.col),h=this._createCellCoords(a,l),d=this._createCellCoords(u,c);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return cs(this,yi)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return cs(this,yi)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return cs(this,yi)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return cs(this,yi)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return cs(this,yi)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return cs(this,yi)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return cs(this,yi)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return cs(this,yi)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,t){return t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(t.to.row,t.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,t){if(!(e instanceof mp))return!1;if(t){const{from:r,to:i}=t;if(t.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(r.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,r.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return t.top===r.top&&i.push("top"),t.right===r.right&&i.push("right"),t.bottom===r.bottom&&i.push("bottom"),t.left===r.left&&i.push("left"),i}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=t.row;i++)for(let s=e.col;s<=t.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&r.push(this._createCellCoords(i,s));return r}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=t.row;i++)for(let s=e.col;s<=t.col;s++)e.row===i&&e.col===s?r.push(e):t.row===i&&t.col===s?r.push(t):r.push(this._createCellCoords(i,s));return r}forAll(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=t.row;i<=r.row;i++)for(let s=t.col;s<=r.col;s++)if(e(i,s)===!1)return}clone(){return new Av(this.highlight,this.from,this.to,cs(this,yi))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new mp(e,t,cs(this,yi))}}const xv=Av,$l=new WeakMap;class IY{constructor(e,t,r,i,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;this.wtSettings=r,this.domBindings=t,this.wtTable=s,this.selections=o,this.parent=a,this.eventManager=i,this.facadeGetter=e,$l.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}registerEvents(){this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",r=>this.onContextMenu(r)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",r=>this.onMouseOver(r)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{this.eventManager.addEventListener(this.wtTable.holder,"touchstart",r=>this.onTouchStart(r)),this.eventManager.addEventListener(this.wtTable.holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),this.eventManager.addEventListener(this.wtTable.holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||this.wtSettings.getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,this.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},t=()=>{this.eventManager.addEventListener(this.wtTable.holder,"mouseup",r=>this.onMouseUp(r)),this.eventManager.addEventListener(this.wtTable.holder,"mousedown",r=>this.onMouseDown(r))};Ns()?e():(e9()&&e(),t())}selectedCellWasTouched(e){const t=$l.get(this),i=this.parentCell(e).coords;if(t.selectedCellBeforeTouchEnd&&i){const[s,o]=[i.row,t.selectedCellBeforeTouchEnd.from.row],[a,l]=[i.col,t.selectedCellBeforeTouchEnd.from.col];return s===o&&a===l}return!1}parentCell(e){const t={},r=this.wtTable.TABLE,i=ff(e,["TD","TH"],r);return i?(t.coords=this.wtTable.getCoords(i),t.TD=i):Je(e,"wtBorder")&&Je(e,"current")?(t.coords=this.selections.getCell().cellRange.highlight,t.TD=this.wtTable.getCell(t.coords)):Je(e,"wtBorder")&&Je(e,"area")&&this.selections.createOrGetArea().cellRange&&(t.coords=this.selections.createOrGetArea().cellRange.to,t.TD=this.wtTable.getCell(t.coords)),t}onMouseDown(e){const t=$l.get(this),r=this.domBindings.rootDocument.activeElement,i=Ox(VW,e.target),s=e.target;if(s===r||i(0)===r||i(1)===r)return;const o=this.parentCell(s);Je(s,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,s):o.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(t.dblClickOrigin[0]=o.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout(()=>{t.dblClickOrigin[0]=null},1e3))}onContextMenu(e){if(this.wtSettings.has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!this.wtSettings.has("onCellMouseOver"))return;const t=this.wtTable.TABLE,r=ff(e.target,["TD","TH"],t),i=this.parent||this;r&&r!==i.lastMouseOver&&tl(r,t)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(r),r))}onMouseOut(e){if(!this.wtSettings.has("onCellMouseOut"))return;const t=this.wtTable.TABLE,r=ff(e.target,["TD","TH"],t),i=ff(e.relatedTarget,["TD","TH"],t),s=this.parent||this;r&&r!==i&&tl(r,t)&&(this.callListener("onCellMouseOut",e,this.wtTable.getCoords(r),r),i===null&&(s.lastMouseOver=null))}onMouseUp(e){const t=$l.get(this),r=this.parentCell(e.target);r.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===t.dblClickOrigin[0]&&r.TD===t.dblClickOrigin[1]?(Je(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):r.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=r.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout(()=>{t.dblClickOrigin[1]=null},500)))}onTouchStart(e){const t=$l.get(this);t.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const r=e.target,i=(t=this.parentCell(r))===null||t===void 0?void 0:t.coords,s=De(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&this.wtSettings.getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];wx()&&(oW()||aW())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,r,i){const s=this.wtSettings.getSettingPure(e);s&&s(t,r,i,this.facadeGetter())}destroy(){const e=$l.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}}const c9=IY;class OY{constructor(e,t,r){this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const _Y=OY;class LY{constructor(e,t,r){this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const PY=LY,DY=0,pp=1,gp=2;class ZR{constructor(){this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}class kY{constructor(){this.size=new ZR,this.workingSpace=DY,this.sharedSize=null}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof ZR}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=pp,e.workingSpace=gp,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=gp,e.workingSpace=pp,this.sharedSize=e.getViewSize()}}class h9{constructor(e,t,r){this.rootNode=e,this.nodesPool=t,this.sizeSet=new kY,this.childNodeType=r.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(t.isPlaceOn(pp))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,r=this.isSharedViewSet(),{nextSize:i}=t.getViewSize();let s=this.getRenderedChildCount();for(;s<i;){const a=this.nodesPool();!r||r&&t.isPlaceOn(gp)?e.appendChild(a):e.insertBefore(a,e.firstChild),s+=1}const o=r&&t.isPlaceOn(pp);for(;s>i;)e.removeChild(o?e.firstChild:e.lastChild),s-=1}render(){const{rootNode:e,sizeSet:t}=this;let r=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(gp)&&(r+=t.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const s=this.nodesPool();e.replaceChild(s,i),i=s}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class d9 extends h9{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}class FY{constructor(e){this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}class kd{constructor(e,t){this.nodesPool=typeof e=="string"?new FY(e):null,this.nodeType=e,this.rootNode=t,this.table=null,this.renderedNodes=0}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}class HY extends kd{constructor(){super("TH"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new d9(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:r,rows:i,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=i.getRenderedNode(o);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=s.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<r;h++){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),t[h](a,d,h)}u.end()}}}class UY extends kd{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,s=i+t;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<s;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)r.removeChild(r.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&ks(r)}render(){const{columnHeadersCount:e}=this.table;for(let t=0;t<e;t+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[t];for(let a=-1*s;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=o.childNodes[a+s];u.className="",u.removeAttribute("style"),r[t](l,u,t)}}}}class BY extends kd{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,r=e+t;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;for(let i=0;i<t;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${o}px`}for(let i=0;i<e;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getStretchedColumnWidth(s);this.rootNode.childNodes[i+t].style.width=`${o}px`}const r=this.rootNode.firstChild;r&&Ae(r,"rowHeader")}}let JR=!1;class VY extends kd{constructor(e){super("TR",e),this.orderView=new h9(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!JR&&e>1e3&&(JR=!0,Xt(Vt`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let t=0;t<e;t++)this.orderView.render();this.orderView.end()}}class $Y extends kd{constructor(){super("TD"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new d9(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:r,rowHeaders:i}=this.table;for(let s=0;s<e;s++){const o=this.table.renderedRowToSource(s),a=r.getRenderedNode(s);this.sourceRowIndex=o;const l=this.obtainOrderView(a),u=i.obtainOrderView(a);l.prependView(u).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let c=0;c<t;c++){l.render();const h=l.getCurrentNode(),d=this.table.renderedColumnToSource(c);Je(h,"hide")||(h.className=""),h.removeAttribute("style"),h.removeAttribute("dir"),this.table.cellRenderer(o,d,h)}l.end()}}}class WY{constructor(e){let{cellRenderer:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=t}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:r,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),r.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=r,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let r=0;r<e;r++){const i=t.getRenderedNode(r);if(i.firstChild){const s=this.renderedRowToSource(r),o=this.rowUtils.getHeight(s);o?i.firstChild.style.height=`${o-1}px`:i.firstChild.style.height=""}}}}class GY{constructor(){let{TABLE:e,THEAD:t,COLGROUP:r,TBODY:i,rowUtils:s,columnUtils:o,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new WY(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new HY,columnHeaders:new UY(t),colGroup:new BY(r),rows:new VY(i),cells:new $Y}),this.renderer.setAxisUtils(s,o)}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}class zY{constructor(e,t){this.dataAccessObject=e,this.wtSettings=t,this.headerWidths=new Map}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const t=this.dataAccessObject.wtViewport.columnsRenderCalculator;let r=this.getWidth(e);if(t){const i=t.getStretchedColumnWidth(e,r);i&&(r=i)}return r}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(t=t?Math.max(t,r):r),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:t,wtViewport:r,cloneSource:i}=this.dataAccessObject,s=i?i.wtTable.holder:t.holder,o=s.offsetHeight<s.scrollHeight?er():0;let a=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-o),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){const l=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth");for(let c=0;c<l;c++){let h=Array.isArray(a)?a[c]:a;h=h==null?u:h,this.headerWidths.set(c,h)}}}}class YY{constructor(e,t){this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(t=t===void 0?r:Math.max(t,r)),t}}function hs(n,e,t){return e=jY(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function jY(n){var e=KY(n,"string");return typeof e=="symbol"?e:String(e)}function KY(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class qY{constructor(e,t,r,i,s){hs(this,"wtSettings",null),hs(this,"domBindings",void 0),hs(this,"TBODY",null),hs(this,"THEAD",null),hs(this,"COLGROUP",null),hs(this,"hasTableHeight",!0),hs(this,"hasTableWidth",!0),hs(this,"isTableVisible",!1),hs(this,"tableOffset",0),hs(this,"holderOffset",0),this.domBindings=r,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,xx(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new YY(this.dataAccessObject,this.wtSettings),this.columnUtils=new zY(this.dataAccessObject,this.wtSettings),this.tableRenderer=new GY({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Je(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",t&&t.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",r}createHider(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Je(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",t&&t.insertBefore(r,e),r.appendChild(e)),r}createHolder(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Je(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",t&&t.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),r.appendChild(e)),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,s=t.getSetting("totalRows"),o=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),l=a.length,u=t.getSetting("columnHeaders"),c=u.length;let h=!1,d=e;if(this.isMaster&&(this.holderOffset=Hn(this.holder),d=i.createRenderCalculators(d),l&&!t.getSetting("fixedColumnsStart"))){const m=r.inlineStartOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=m!==0,p!==this.correctHeaderWidth&&(d=!1)}if(this.isMaster&&(h=r.updateStateOfRendering()),d)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=Hn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const m=s>0?this.getFirstRenderedRow():0,p=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new PY(m,s,c),this.columnFilter=new _Y(p,o,l);let y=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),y=C.skipRender!==!0}if(y){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(xs)||this.is(Jo))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let C;if(this.isMaster&&(C=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(xs))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const b=Bt(this.hider),v=Bt(this.TABLE);b!==0&&v!==b&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),C!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(xs)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let f=!1;return this.isMaster&&(f=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(f=r.bottomOverlay.resetFixedPosition()||f),f=r.inlineStartOverlay.resetFixedPosition()||f,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),f?(r.refreshAll(),r.adjustElementsSize()):this.refreshSelections(d),h&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,s=this.getColumnHeaderHeight(r),o=this.getColumnHeader(t,r),o&&(a=Yo(o),(!s&&i<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,o=i.length;s<o;s++)if(r[s]){if(!t[s]||t[s].childNodes.length===0)return;t[s].childNodes[0].style.height=`${r[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(xs))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const s=this.rowFilter.renderedToSource(i);t.oversizedRows&&t.oversizedRows[s]&&(t.oversizedRows[s]=void 0)}}}removeClassFromCells(e){const t=this.TABLE.querySelectorAll(`.${e}`);for(let r=0,i=t.length;r<i;r++)tt(t[r],e)}refreshSelections(e){const{wtSettings:t}=this,{selections:r}=this.dataAccessObject;if(!r)return;const i=Array.from(r),s=i.length;if(e){const o=[];for(let u=0;u<s;u++){const{highlightHeaderClassName:c,highlightRowClassName:h,highlightColumnClassName:d}=i[u].settings,f=i[u].classNames,m=f.length;for(let p=0;p<m;p++)o.includes(f[p])||o.push(f[p]);c&&!o.includes(c)&&o.push(c),h&&!o.includes(h)&&o.push(h),d&&!o.includes(d)&&o.push(d)}const a=t.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(a))for(let u=0;u<a.length;u++)o.push(a[u]);const l=o.length;for(let u=0;u<l;u++)this.removeClassFromCells(o[u])}for(let o=0;o<s;o++)i[o].draw(this.facadeGetter(),e)}getCell(e){let t=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",t,r);if(i&&Array.isArray(i)&&([t,r]=i),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const s=this.getRow(t);if(!s&&t>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!o&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let t=null,r=null;if(e<0){var i;t=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var s;t=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),r=this.TBODY}return t!==void 0&&r!==void 0?r.childNodes.length<t+1?!1:r.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[t];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const s=i.childNodes[r];s&&t.push(s)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return;const r=this.wtSettings.getSetting("rowHeaders").length;if(t>=r)return;const i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return i==null?void 0:i.childNodes[t]}getRowHeaders(e){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];const t=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s==null?void 0:s.childNodes[i];o&&t.push(o)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=el(t,["TD","TH"])),t===null)return null;const r=t.parentNode,i=r.parentNode;let s=WW(r),o=t.cellIndex;return Ca(cl,t,this.wtRootElement)||Ca(ll,t,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):Ca(Jo,t,this.wtRootElement)||Ca(xs,t,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):s=this.rowFilter.renderedToSource(s),Ca(cl,t,this.wtRootElement)||Ca(ul,t,this.wtRootElement)||Ca(Jo,t,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.wtSettings.getSetting("defaultRowHeight"),r=Yo(this.TBODY)-1;let i,s,o,a,l;if(!(t===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,o=this.rowFilter.renderedToSource(e),i=this.getRowHeight(o),a=this.getTrForRow(o),l=a.querySelector("th"),l?s=Yo(l):s=Yo(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<s||i<s)&&(s+=1,this.dataAccessObject.wtViewport.oversizedRows[o]=s)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Bt(this.TABLE)}getHeight(){return cn(this.TABLE)}getTotalWidth(){const e=Bt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=cn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Gh(this.TABLE)}_modifyRowHeaderWidth(e){let t=qt(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}const wc=qY,XY="stickyRowsBottom",f9={getFirstRenderedRow(){const n=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=n-e;return n===0||e===0?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};Ro(f9,"MIXIN_NAME",XY,{writable:!1,enumerable:!1});const m9=f9,QY="stickyColumnsStart",p9={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const n=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),n)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()}};Ro(p9,"MIXIN_NAME",QY,{writable:!1,enumerable:!1});const Mv=p9;class Nv extends wc{constructor(e,t,r,i){super(e,t,r,i,Jo)}}Yt(Nv,m9);Yt(Nv,Mv);const ZY=Nv,ll="top",xs="bottom",ul="inline_start",cl="top_inline_start_corner",Jo="bottom_inline_start_corner",JY=[ll,xs,ul,cl,Jo],ej=new Map([[ll,`ht_clone_${ll}`],[xs,`ht_clone_${xs}`],[ul,`ht_clone_${ul} ht_clone_left`],[cl,`ht_clone_${cl} ht_clone_top_left_corner`],[Jo,`ht_clone_${Jo} ht_clone_bottom_left_corner`]]);function v2(n,e,t){return e=tj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tj(n){var e=nj(n,"string");return typeof e=="symbol"?e:String(e)}function nj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class rj{constructor(e){v2(this,"dataAccessObject",void 0),v2(this,"lastScrolledColumnPos",-1),v2(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,t,r,i,s){const o=this.scrollViewportHorizontally(e.col,r,s),a=this.scrollViewportVertically(e.row,t,i);return o||a}scrollViewportHorizontally(e,t,r){const{drawn:i,totalColumns:s}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>s)return!1;const o=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=t===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let h=!1;return o===-1?h=c.scrollTo(e,l?e>this.lastScrolledColumnPos:t):(l&&(e<o||e>a)||!l)&&(h=c.scrollTo(e,l?e>a:t)),h&&(this.lastScrolledColumnPos=e),h}scrollViewportVertically(e,t,r){const{drawn:i,totalRows:s}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>s)return!1;const o=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=t===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:h}=this.dataAccessObject;if(l&&(e<c||e>s-u-1))return!1;let d=!1;return o===-1?d=h.scrollTo(e,l?e>this.lastScrolledRowPos:r):(l&&(e<o||e>a)||!l)&&(d=h.scrollTo(e,l?e>a:r)),d&&(this.lastScrolledRowPos=e),d}getFirstVisibleRow(){const{topOverlay:e,wtTable:t,wtViewport:r,totalRows:i,fixedRowsTop:s,rootWindow:o}=this.dataAccessObject;let a=t.getFirstVisibleRow();if(e.mainTableScrollableElement===o){const l=Hn(t.wtRootElement),u=Yo(t.hider),c=Yo(o),h=cp(o,o);if(l.top+u-c<=h){let d=r.getColumnHeaderHeight();d+=e.sumCellSizes(0,s);for(let f=i;f>0;f--)if(d+=e.sumCellSizes(f-1,f),l.top+u-d<=h){a=f;break}}}return a}getLastVisibleRow(){const{topOverlay:e,wtTable:t,wtViewport:r,totalRows:i,rootWindow:s}=this.dataAccessObject;let o=t.getLastVisibleRow();if(e.mainTableScrollableElement===s){const a=Hn(t.wtRootElement),l=cp(s,s);if(a.top>l){const u=Yo(s);let c=r.getColumnHeaderHeight();for(let h=1;h<=i;h++)if(c+=e.sumCellSizes(h-1,h),a.top+c-l>=u){o=h-2;break}}}return o}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:t,wtViewport:r,totalColumns:i,rootWindow:s}=this.dataAccessObject;let o=t.getFirstVisibleColumn();if(e.mainTableScrollableElement===s){const a=Hn(t.wtRootElement),l=Om(t.hider),u=Om(s),c=Math.abs(Ny(s,s));if(a.left+l-u<=c){let h=r.getRowHeaderWidth();for(let d=i;d>0;d--)if(h+=e.sumCellSizes(d-1,d),a.left+l-h<=c){o=d;break}}}return o}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:t,wtTable:r,wtViewport:i,totalColumns:s,rootWindow:o}=this.dataAccessObject;let a=r.getLastVisibleColumn();if(t.mainTableScrollableElement===o){const l=e.getSetting("rtlMode");let u=null;if(l){const h=r.TABLE.getBoundingClientRect(),f=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(h.right-f)}else u=Hn(r.wtRootElement).left;const c=Math.abs(Ny(o,o));if(u>c){const h=Om(o);let d=i.getRowHeaderWidth();for(let f=1;f<=s;f++)if(d+=t.sumCellSizes(f-1,f),u+d-c>=h){a=f-2;break}}}return a}}const ij=rj;function Wi(n,e,t){return e=sj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sj(n){var e=oj(n,"string");return typeof e=="symbol"?e:String(e)}function oj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Iv{get eventManager(){return new dn(this)}constructor(e,t){Wi(this,"wtTable",void 0),Wi(this,"wtScroll",void 0),Wi(this,"wtViewport",void 0),Wi(this,"wtOverlays",void 0),Wi(this,"selections",void 0),Wi(this,"wtEvent",void 0),Wi(this,"guid",`wt_${Sx()}`),Wi(this,"drawInterrupted",!1),Wi(this,"drawn",!1),Wi(this,"domBindings",void 0),Wi(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new ij(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;t<r;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,r){ol(r,e[t])}])}}createCellCoords(e,t){return new mp(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,r){return new xv(e,t,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=r-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,r,i,s){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,t,r,i,s)}scrollViewportHorizontally(e,t,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,t,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selections(){return e.selections},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count}}}}function e7(n,e,t){return e=aj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function aj(n){var e=lj(n,"string");return typeof e=="symbol"?e:String(e)}function lj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class uj extends Iv{constructor(e,t,r){super(e,t),e7(this,"cloneSource",void 0),e7(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selections=r.selections,this.wtEvent=new c9(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections,r.event),this.findOriginalHeaders()}}function cj(n,e,t){return e=hj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hj(n){var e=dj(n,"string");return typeof e=="symbol"?e:String(e)}function dj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Fd{constructor(e,t,r,i,s){cj(this,"wtSettings",null),Ro(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=t,this.wtSettings=i;const{TABLE:o,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=ju(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=ju(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=hp(e.TABLE)}getRelativeCellPosition(e,t,r){if(this.clone.wtTable.holder.contains(e)===!1){Xt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=r<this.wtSettings.getSetting("fixedColumnsStart"),o=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(o,s,c,u):h=this.getRelativeCellPositionWithinHolder(o,a,s,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,r,i){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!t)o=i.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+er())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=i.top,{start:r.start+o,top:r.top+a}}getRelativeCellPositionWithinHolder(e,t,r,i,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=o.horizontal-s.start),t){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=o.vertical-s.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(JY.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:r}=this.domBindings,i=t.createElement("DIV"),s=t.createElement("TABLE"),o=e.wtRootElement.parentNode;i.className=`${ej.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,s.className=e.TABLE.className,i.appendChild(s),o.appendChild(i);const a=this.wtSettings.getSetting("preventOverflow");return a===!0||a==="horizontal"&&this.type===ll||a==="vertical"&&this.type===ul?this.mainTableScrollableElement=r:r.getComputedStyle(o).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=hp(e.TABLE),new uj(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,r=e.style,i=t.style,s=e.parentNode.style;re([r,i,s],o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class fj extends Fd{constructor(e,t,r,i,s,o){super(e,t,Jo,r,i),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new ZY(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${s}px`,t.style.bottom=`${o}px`}else Vg(t),this.repositionOverlay();let r=cn(this.clone.wtTable.TABLE);const i=Bt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),t.style.height=`${r}px`,t.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;t.hasVerticalScroll()||(s+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(s+=er(r)),i.style.bottom=`${s}px`}}const mj="calculatedColumns",g9={getFirstRenderedColumn(){const n=this.dataAccessObject.startColumnRendered;return n===null?-1:n},getFirstVisibleColumn(){const n=this.dataAccessObject.startColumnVisible;return n===null?-1:n},getLastRenderedColumn(){const n=this.dataAccessObject.endColumnRendered;return n===null?-1:n},getLastVisibleColumn(){const n=this.dataAccessObject.endColumnVisible;return n===null?-1:n},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible}};Ro(g9,"MIXIN_NAME",mj,{writable:!1,enumerable:!1});const Ov=g9;class _v extends wc{constructor(e,t,r,i){super(e,t,r,i,xs)}}Yt(_v,m9);Yt(_v,Ov);const pj=_v;function gj(n,e,t){return e=yj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yj(n){var e=wj(n,"string");return typeof e=="symbol"?e:String(e)}function wj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class vj extends Fd{constructor(e,t,r,i){super(e,t,xs,r,i),gj(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new pj(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),t.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;t.hasVerticalScroll()||(s+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(s+=er(r)),i.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.mainTableScrollableElement===t?(t.scrollTo(Yu(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:r,wtSettings:i}=this.wot,s=i.getSetting("defaultRowHeight");let o=e,a=0;for(;o<t;){const l=r.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=er(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let c=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=s),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=cn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let r=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;t&&s.offsetHeight!==s.clientHeight&&(o=er(this.domBindings.rootDocument)),t?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=o,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return cp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==t,i=this.wtSettings.getSetting("columnHeaders");let s=!1;if((r||t===0)&&i.length>0){const o=this.wot.wtTable.holder.parentNode,a=Je(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Ae(o,"innerBorderBottom"),s=!a):(tt(o,"innerBorderBottom"),s=a)}return s}}const Cj="calculatedRows",y9={getFirstRenderedRow(){const n=this.dataAccessObject.startRowRendered;return n===null?-1:n},getFirstVisibleRow(){const n=this.dataAccessObject.startRowVisible;return n===null?-1:n},getLastRenderedRow(){const n=this.dataAccessObject.endRowRendered;return n===null?-1:n},getLastVisibleRow(){const n=this.dataAccessObject.endRowVisible;return n===null?-1:n},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible}};Ro(y9,"MIXIN_NAME",Cj,{writable:!1,enumerable:!1});const w9=y9;class Lv extends wc{constructor(e,t,r,i){super(e,t,r,i,ul)}}Yt(Lv,w9);Yt(Lv,Mv);const Ej=Lv;class bj extends Fd{constructor(e,t,r,i){super(e,t,ul,r,i)}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Ej(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===t&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),rv(r,`${s}px`,"0px")):(s=this.getScrollPosition(),Vg(r));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,zh(t)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,s=0;for(;i<t;)s+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return s}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:r}=this.domBindings,i=er(t),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),o.height=`${u}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=Bt(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){var e;const{holder:t}=this.clone.wtTable,{selections:r}=this.wot,i=this.facadeGetter(),s=Math.abs((e=r==null?void 0:r.getCell().getBorder(i).cornerCenterPointOffset)!==null&&e!==void 0?e:0);this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+s}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){let r=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;if(t){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(t=!1)}return t&&s.offsetWidth!==s.clientWidth&&(o=er(this.domBindings.rootDocument)),t?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=o,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(Ny(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=i-s;r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){const t=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?tt(t,"emptyRows"):Ae(t,"emptyRows");let o=!1;if(i&&!r.length)Ae(t,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const a=Je(t,"innerBorderInlineStart");e?(Ae(t,"innerBorderLeft innerBorderInlineStart"),o=!a):(tt(t,"innerBorderLeft innerBorderInlineStart"),o=a)}return o}}const Sj="stickyRowsTop",v9={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};Ro(v9,"MIXIN_NAME",Sj,{writable:!1,enumerable:!1});const C9=v9;class Pv extends wc{constructor(e,t,r,i){super(e,t,r,i,cl)}}Yt(Pv,C9);Yt(Pv,Mv);const Rj=Pv;function t7(n,e,t){return e=Tj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Tj(n){var e=Aj(n,"string");return typeof e=="symbol"?e:String(e)}function Aj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class xj extends Fd{constructor(e,t,r,i,s,o){super(e,t,cl,r,i),t7(this,"topOverlay",void 0),t7(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Rj(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();rv(e,`${i}px`,`${s}px`)}else Vg(e);let t=cn(this.clone.wtTable.TABLE);const r=Bt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${r}px`,!1}}class Dv extends wc{constructor(e,t,r,i){super(e,t,r,i,ll)}}Yt(Dv,C9);Yt(Dv,Ov);const Mj=Dv;function Nj(n,e,t){return e=Ij(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ij(n){var e=Oj(n,"string");return typeof e=="symbol"?e:String(e)}function Oj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class _j extends Fd{constructor(e,t,r,i){super(e,t,ll,r,i),Nj(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Mj(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,s=!1;if(this.trimmingContainer===t&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;s=u===c,i=this.getOverlayOffset(),rv(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Vg(e);const o=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),o}setScrollPosition(e){const t=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(Yu(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,s=0;for(;i<t;){const o=this.wot.wtTable.getRowHeight(i);s+=o===void 0?r:o,i+=1}return s}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:r}=this.domBindings,i=er(t),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=cn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){var e;const{holder:t}=this.clone.wtTable,{selections:r}=this.wot,i=this.facadeGetter(),s=Math.abs((e=r==null?void 0:r.getCell().getBorder(i).cornerCenterPointOffset)!==null&&e!==void 0?e:0);this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+s}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:r,wtSettings:i}=this,o=(r.cloneSource?r.cloneSource:r).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(t){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(t=!1)}if(t&&o.offsetHeight!==o.clientHeight&&(l=er(this.domBindings.rootDocument)),t){const u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return cp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>o&&(r=0)}return r}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?tt(r,"emptyColumns"):Ae(r,"emptyColumns");let s=!1;if(!t){const o=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==o,l=this.wtSettings.getSetting("columnHeaders");if((a||o===0)&&l.length>0){const u=Je(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(Ae(r,"innerBorderTop"),s=!u):(tt(r,"innerBorderTop"),s=u)}}return s}}function Xs(n,e,t){return e=Lj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Lj(n){var e=Pj(n,"string");return typeof e=="symbol"?e:String(e)}function Pj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Dj{constructor(e,t,r,i,s,o){Xs(this,"wot",null),Xs(this,"topOverlay",null),Xs(this,"bottomOverlay",null),Xs(this,"inlineStartOverlay",null),Xs(this,"topInlineStartCornerOverlay",null),Xs(this,"bottomInlineStartCornerOverlay",null),Xs(this,"browserLineHeight",void 0),Xs(this,"wtSettings",null),Xs(this,"resizeObserver",new ResizeObserver(c=>{Cv(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=t,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=er(a);const u=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?o.holder:hp(o.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,r=e.getComputedStyle(t.body),i=parseInt(r.lineHeight,10),s=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new _j(...e),this.bottomOverlay=new vj(...e),this.inlineStartOverlay=new bj(...e),this.topInlineStartCornerOverlay=new xj(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new fj(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(!!this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const s=t.devicePixelRatio&&t.devicePixelRatio>1,o=this.scrollableElement===t,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!yx())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:d}=h.clone.wtTable;this.eventManager.addEventListener(d,"wheel",f=>this.onCloneWheel(f,a),l)}});let c;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==t&&s!==t&&!e.target.contains(i)||r!==t&&s!==t&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==r&&o!==r&&!o.contains(s),l=i!==r&&o!==r&&!o.contains(i);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Wh(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,t+=t*this.browserLineHeight);const i=this.scrollVertically(t),s=this.scrollHorizontally(r);return i||s}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,s]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==s||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=i;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=s),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=hp(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,r=e.clientHeight,i=t!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=r),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:t}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),o=t.getRowHeaderWidth(),a=t.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${o+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,s)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:h,scrollWidth:d}=r.holder;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<d,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){!this.wtTable.isVisible()||(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return re(t,i=>{!i||i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];re(t,r=>{!r||(r.clone.wtTable.TABLE.className=e.className)})}}const kj=Dj;function n7(n,e,t){return e=Fj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Fj(n){var e=Hj(n,"string");return typeof e=="symbol"?e:String(e)}function Hj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Uj{constructor(e){n7(this,"settings",{}),n7(this,"defaults",Object.freeze(this.getDefaults())),ft(this.defaults,(t,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(t===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,r)=>{const i=this.getSetting("data",e,t);ol(r,i==null?"":i)},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}update(e,t){return t===void 0?ft(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=t,this}getSetting(e,t,r,i,s){return typeof this.settings[e]=="function"?this.settings[e](t,r,i,s):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class kv extends wc{constructor(e,t,r,i){super(e,t,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=ju(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Yh(e,"height",t),s=Yh(e,"overflow",t),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let{width:u,height:c}=e.getBoundingClientRect();if(r&&["auto","hidden","scroll"].includes(s)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(al(d,t).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),o.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),o.width=`${u}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Gh(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,r="master",s=e.getSetting("columnHeaders").length;if(s&&!t.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<s;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);t.hasOversizedColumnHeadersMarked[r]=!0}}}Yt(kv,w9);Yt(kv,Ov);const Bj=kv;class Vj{constructor(e,t,r,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=r,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return t===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=cn(t)>0&&t.clientHeight>0?t.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=t.documentElement.offsetWidth,o=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-s:u.left,h=s-c;let d,f;if(a)return Bt(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?d=Math.min(h,s):d=Math.min(this.getContainerFillWidth(),h,s),i===r&&o>0&&this.sumColumnWidths(0,o-1)>d)return t.documentElement.clientWidth;if(i!==r&&(f=Yh(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),f==="scroll"||f==="hidden"||f==="auto"))return Math.max(d,i.clientWidth);const m=e.getSetting("stretchH");return m==="none"||!m?Math.max(d,Bt(this.wtTable.TABLE)):d}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let r=0,i=e;for(;i<t;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const r=t.offsetWidth;return this.containerWidth=r,e.removeChild(t),r}getWorkspaceOffset(){return Hn(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=cn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=t.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=t.length;i<s;i++)r?(this.rowHeaderWidth+=Bt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Va;const{wtSettings:t,wtTable:r}=this;let i,s,o;this.rowHeaderWidth=NaN,t.getSetting("renderAllRows")&&e===Va?i=1/0:i=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=t.getSetting("fixedRowsTop"),u=t.getSetting("fixedRowsBottom"),c=t.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,i-=o),u&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=o),r.holder.clientHeight===r.holder.offsetHeight?s=0:s=er(this.domBindings.rootDocument),new a9({viewportSize:i,scrollOffset:a,totalItems:t.getSetting("totalRows"),itemSizeFn:h=>r.getRowHeight(h),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,scrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Va;const{wtSettings:t,wtTable:r}=this;let i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=t.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=er(this.domBindings.rootDocument)),new Sv({viewportSize:i,scrollOffset:s,totalItems:t.getSetting("totalColumns"),itemSizeFn:a=>r.getColumnWidth(a),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:(a,l)=>t.getSetting("onBeforeStretchingColumnWidth",a,l),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(t){const r=this.createRowsCalculator(br),i=this.createColumnsCalculator(br);this.areAllProposedVisibleRowsAlreadyRendered(r)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(Va),this.columnsRenderCalculator=this.createColumnsCalculator(Va)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(br),this.columnsVisibleCalculator=this.createColumnsCalculator(br)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:t,endRow:r,isVisibleInTrimmingContainer:i}=e;if(t===null&&r===null)return!i;const{startRow:s,endRow:o}=this.rowsRenderCalculator;return t<s||t===s&&t>0?!1:!(r>o||r===o&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:t,endColumn:r,isVisibleInTrimmingContainer:i}=e;if(t===null&&r===null)return!i;const{startColumn:s,endColumn:o}=this.columnsRenderCalculator;return t<s||t===s&&t>0?!1:!(r>o||r===o&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){ft(this.hasOversizedColumnHeadersMarked,(e,t,r)=>{r[t]=void 0})}}const $j=Vj;class Wj extends Iv{constructor(e,t){super(e,new Uj(t));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new Bj(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new $j(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selections=this.wtSettings.getSetting("selections"),this.wtEvent=new c9(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections),this.wtOverlays=new kj(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],r=[];ft(e,(i,s)=>{this.wtSettings.getSetting(s).length&&r.push(i),t.push(i)}),tt(this.wtTable.wtRootElement.parentNode,t),Ae(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Fv{constructor(e){e instanceof Iv?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{const r=new Fv(t);return()=>r},this._wot=new Wj(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selections(){return this._wot.selections}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,r){return this._wot.createCellRange(e,t,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,r,i,s){return this._wot.scrollViewport(e,t,r,i,s)}scrollViewportHorizontally(e,t,r){return this._wot.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return this._wot.scrollViewportVertically(e,t,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,r,i,s){return this._wot.wtSettings.getSetting(e,t,r,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}class Gj{constructor(e,t){!t||(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,r=this.main.childNodes.length;t<r;t++){const i=this.main.childNodes[t];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ds(e);const r=this,i=this.wot.rootDocument.body,s=t.getBoundingClientRect();t.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),t.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=t.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ns()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=t.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const t=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};ft(i,(o,a)=>{this.selectionHandles.styles.bottomHitArea[a]=o,this.selectionHandles.styles.topHitArea[a]=o});const s={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};ft(s,(o,a)=>{this.selectionHandles.styles.bottom[a]=o,this.selectionHandles.styles.top[a]=o}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const r=this.wot.selections.createOrGetArea();return!!(r.cellRange&&(e!==r.cellRange.to.row||t!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,r,i,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),m=parseInt(u.width,10),p=parseInt(c.width,10),y=this.wot.wtTable.getWidth(),C=this.wot.wtTable.getHeight();u.top=`${parseInt(r-m-1,10)}px`,u[l]=`${parseInt(i-m-1,10)}px`,c.top=`${parseInt(r-p/4*3,10)}px`,c[l]=`${parseInt(i-p/4*3,10)}px`;const b=Math.min(parseInt(i+s,10),y-m-f*2),v=Math.min(parseInt(i+s-p/4,10),y-p-f*2);h[l]=`${b}px`,d[l]=`${v}px`;const S=Math.min(parseInt(r+o,10),C-m-f*2),L=Math.min(parseInt(r+o-p/4,10),C-p-f*2);h.top=`${S}px`,d.top=`${L}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,t)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:r,rootWindow:i}=this.wot;let s,o,a,l,u,c;const h=t.getRenderedRowsCount();for(let O=0;O<h;O+=1){const g=t.rowFilter.renderedToSource(O);if(g>=e[0]&&g<=e[2]){s=g,u=e[0];break}}for(let O=h-1;O>=0;O-=1){const g=t.rowFilter.renderedToSource(O);if(g>=e[0]&&g<=e[2]){o=g;break}}const d=t.getRenderedColumnsCount();for(let O=0;O<d;O+=1){const g=t.columnFilter.renderedToSource(O);if(g>=e[1]&&g<=e[3]){a=g,c=e[1];break}}for(let O=d-1;O>=0;O-=1){const g=t.columnFilter.renderedToSource(O);if(g>=e[1]&&g<=e[3]){l=g;break}}if(s===void 0||a===void 0){this.disappear();return}let f=t.getCell(this.wot.createCellCoords(s,a));const m=s!==o||a!==l,p=m?t.getCell(this.wot.createCellCoords(o,l)):f,y=Hn(f),C=m?Hn(p):y,b=Hn(t.TABLE),v=Bt(t.TABLE),S=y.top,L=y.left,_=this.wot.wtSettings.getSetting("rtlMode");let P=0,x=0;if(_){const O=Bt(f),g=i.innerWidth-b.left-v;x=L+O-C.left,P=i.innerWidth-L-O-g-1}else x=C.left+Bt(p)-L,P=L-b.left-1;if(this.isEntireColumnSelected(s,o)){const O=this.getDimensionsFromHeader("columns",a,l,u,b);let g=null;O&&([g,P,x]=O),g&&(f=g)}let I=S-b.top-1,R=C.top+cn(p)-S;if(this.isEntireRowSelected(a,l)){const O=this.getDimensionsFromHeader("rows",s,o,c,b);let g=null;O&&([g,I,R]=O),g&&(f=g)}const N=al(f,i);parseInt(N.borderTopWidth,10)>0&&(I+=1,R=R>0?R-1:0),parseInt(N[_?"borderRightWidth":"borderLeftWidth"],10)>0&&(P+=1,x=x>0?x-1:0);const H=_?"right":"left";this.topStyle.top=`${I}px`,this.topStyle[H]=`${P}px`,this.topStyle.width=`${x}px`,this.topStyle.display="block",this.startStyle.top=`${I}px`,this.startStyle[H]=`${P}px`,this.startStyle.height=`${R}px`,this.startStyle.display="block";const K=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${I+R-K}px`,this.bottomStyle[H]=`${P}px`,this.bottomStyle.width=`${x}px`,this.bottomStyle.display="block",this.endStyle.top=`${I}px`,this.endStyle[H]=`${P+x-K}px`,this.endStyle.height=`${R+1}px`,this.endStyle.display="block";let X=this.settings.border.cornerVisible;X=typeof X=="function"?X(this.settings.layerLevel):X;const J=this.wot.getSetting("onModifyGetCellCoords",o,l);let[ue,se]=[o,l];if(J&&Array.isArray(J)&&([,,ue,se]=J),Ns()||!X||this.isPartRange(ue,se))this.cornerStyle.display="none";else{this.cornerStyle.top=`${I+R+this.cornerCenterPointOffset-1}px`,this.cornerStyle[H]=`${P+x+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let O=ju(t.TABLE);const g=O===i;g&&(O=r.documentElement);const E=parseInt(this.cornerDefaultStyle.width,10)/2,A=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const U=g?p.getBoundingClientRect().left:p.offsetLeft;let G=!1,V=0;_?(V=U-parseInt(this.cornerDefaultStyle.width,10)/2,G=V<0):(V=U+Bt(p)+parseInt(this.cornerDefaultStyle.width,10)/2,G=V>=Om(O)),G&&(this.cornerStyle[H]=`${Math.floor(P+x+this.cornerCenterPointOffset-E)}px`,this.cornerStyle[_?"borderLeftWidth":"borderRightWidth"]=0)}o===this.wot.getSetting("totalRows")-1&&(g?p.getBoundingClientRect().top:p.offsetTop)+cn(p)+parseInt(this.cornerDefaultStyle.height,10)/2>=Yo(O)&&(this.cornerStyle.top=`${Math.floor(I+R+this.cornerCenterPointOffset-A)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Ns()&&this.updateMultipleSelectionHandlesPosition(o,l,I,P,x,R)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,r,i,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,m=null,p=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},u=function(){return cn(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},u=function(){return Bt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const y=this.wot.getSetting("columnHeaders").length;if(m=l(t,y-i),p=l(r,y-i),!m||!p)return!1;const C=Hn(m),b=Hn(p);return m&&p&&(h=C[f]-s[f]-1,d=b[f]+u(p)-C[f]),[m,h,d]}return!1}changeBorderStyle(e,t){const r=this[e].style,i=t[e];!i||i.hide?Ae(this[e],"hidden"):(Je(this[e],"hidden")&&tt(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},r=this[e].style;r.backgroundColor=t.color,r.width=`${t.width}px`,r.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?Ae(this[e],"hidden"):tt(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ns()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const zj=Gj;class Yj{constructor(e,t){this.settings=e,this.cellRange=t||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}getBorder(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new zj(e,this.settings)),this.instanceBorders[e.guid]}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}addClassAtCoords(e,t,r,i){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;const o=e.wtTable.getCell(this.settings.createCellCoords(t,r));if(typeof o=="object"){let a=i;s&&(a=this.classNameGenerator(o),this.classNames.includes(a)||this.classNames.push(a)),Ae(o,a)}return this}linearClassNameGenerator(e,t){return function r(i){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(t===0||s===0)return e;let o=s>=0?s:t,a=e;o-=1;const l=o===0?e:`${e}-${o}`;if(Je(i,l)){const u=o+1;a=`${e}-${u}`}else a=r(i,o);return a}}draw(e){if(this.isEmpty()){this.settings.border&&this.getBorder(e).disappear();return}const t=e.wtTable.getRenderedRowsCount(),r=e.wtTable.getRenderedColumnsCount(),i=this.getCorners(),[s,o,a,l]=i,{highlightHeaderClassName:u,highlightColumnClassName:c,highlightRowClassName:h,highlightOnlyClosestHeader:d,selectionType:f}=this.settings,m=f===void 0||["active-header","header"].includes(f);if(m&&o!==null&&l!==null){let p=0;for(let y=0;y<r;y+=1){const C=e.wtTable.columnFilter.renderedToSource(y);if(C>=o&&C<=l){let b=e.wtTable.getColumnHeaders(C);const v=b.length-1;d&&b.length>1&&(b=[b[v]]);for(let S=0;S<b.length;S+=1){const L=[];let _=b[S];u&&L.push(u),c&&L.push(c),S=d?v:S;const P=e.getSetting("onBeforeHighlightingColumnHeader",C,S,{selectionType:f,columnCursor:p,selectionWidth:l-o+1,classNames:L});P!==C&&(_=e.wtTable.getColumnHeader(P,S)),Ae(_,L)}p+=1}}}if(s!==null&&a!==null){let p=0;for(let y=0;y<t;y+=1){const C=e.wtTable.rowFilter.renderedToSource(y);if(m&&C>=s&&C<=a){let b=e.wtTable.getRowHeaders(C);const v=b.length-1;d&&b.length>1&&(b=[b[v]]);for(let S=0;S<b.length;S+=1){const L=[];let _=b[S];u&&L.push(u),h&&L.push(h),S=d?v:S;const P=e.getSetting("onBeforeHighlightingRowHeader",C,S,{selectionType:f,rowCursor:p,selectionHeight:a-s+1,classNames:L});P!==C&&(_=e.wtTable.getRowHeader(P,S)),Ae(_,L)}p+=1}if(o!==null&&l!==null)for(let b=0;b<r;b+=1){const v=e.wtTable.columnFilter.renderedToSource(b);C>=s&&C<=a&&v>=o&&v<=l?this.settings.className&&this.addClassAtCoords(e,C,v,this.settings.className,this.settings.markIntersections):C>=s&&C<=a?h&&this.addClassAtCoords(e,C,v,h):v>=o&&v<=l&&c&&this.addClassAtCoords(e,C,v,c);const S=e.getSetting("onAfterDrawSelection",C,v,this.settings.layerLevel);typeof S=="string"&&this.addClassAtCoords(e,C,v,S)}}}e.getSetting("onBeforeDrawBorders",i,this.settings.className),this.settings.border&&this.getBorder(e).appear(i)}destroy(){Object.values(this.instanceBorders).forEach(e=>e.destroy())}}const jj=Yj,Kj="localHooks",E9={_localHooks:Object.create(null),addLocalHook(n,e){return this._localHooks[n]||(this._localHooks[n]=[]),this._localHooks[n].push(e),this},runLocalHooks(n,e,t,r,i,s,o){if(this._localHooks[n]){const a=this._localHooks[n].length;for(let l=0;l<a;l++)Iy(this._localHooks[n][l],this,e,t,r,i,s,o)}},clearLocalHooks(){return this._localHooks={},this}};Ro(E9,"MIXIN_NAME",Kj,{writable:!1,enumerable:!1});const ni=E9;class Ml{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.indexedValues=[],this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,qt(this.initValueOrFn)?ze(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):ze(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Yt(Ml,ni);function Hv(n,e,t,r){const i=t.length?t[0]:void 0;return[...n.slice(0,i),...t.map((s,o)=>qt(r)?r(s,o):r),...i===void 0?[]:n.slice(i)]}function Uv(n,e){return Oi(n,(t,r)=>e.includes(r)===!1)}class fa extends Ml{insert(e,t){this.indexedValues=Hv(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=Uv(this.indexedValues,e),super.remove(e)}}class zg extends fa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Tr(this.getValues(),(e,t,r)=>(t&&e.push(r),e),[])}}function Bv(n,e,t){return[...n.slice(0,e),...t,...n.slice(e)]}function jh(n,e){return Oi(n,t=>e.includes(t)===!1)}function Vv(n,e){return ct(n,t=>t-e.filter(r=>r<t).length)}function $v(n,e){const t=e[0],r=e.length;return ct(n,i=>i>=t?i+r:i)}function qj(n,e,t){return e=Xj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Xj(n){var e=Qj(n,"string");return typeof e=="symbol"?e:String(e)}function Qj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Yg extends Ml{constructor(){super(...arguments),qj(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=jh(this.orderOfIndexes,[e]),qt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=Hv(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=$v(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=Uv(this.indexedValues,e),this.orderOfIndexes=jh(this.orderOfIndexes,e),this.orderOfIndexes=Vv(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Hd extends fa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Tr(this.getValues(),(e,t,r)=>(t&&e.push(r),e),[])}}const r7=new Map([["indexesSequence",{getListWithInsertedItems:Bv,getListWithRemovedItems:jh}],["physicallyIndexed",{getListWithInsertedItems:Hv,getListWithRemovedItems:Uv}]]),b9=n=>{if(r7.has(n)===!1)throw new Error(`Alter strategy with ID '${n}' does not exist.`);return r7.get(n)};class S9 extends Ml{constructor(){super(e=>e)}insert(e,t){const r=$v(this.indexedValues,t);this.indexedValues=Bv(r,e,t),super.insert(e,t)}remove(e){const t=jh(this.indexedValues,e);this.indexedValues=Vv(t,e),super.remove(e)}}const i7=new Map([["hiding",zg],["index",Ml],["linkedPhysicalIndexToValue",Yg],["physicalIndexToValue",fa],["trimming",Hd]]);function Zj(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!i7.has(n))throw new Error(`The provided map type ("${n}") does not exist.`);return new(i7.get(n))(e)}class Wv{constructor(){this.collection=new Map}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)))}unregister(e){const t=this.collection.get(e);De(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t))}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return Qt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(r=>{r.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}Yt(Wv,ni);class s7 extends Wv{constructor(e,t){super(),this.mergedValuesCache=[],this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=ct(this.get(),s=>s.getValues()),r=[],i=De(t[0])&&t[0].length||0;for(let s=0;s<i;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(t[a][s]);r.push(o)}return ct(r,this.aggregationFunction)}getMergedValueAtIndex(e,t){const r=this.getMergedValues(t)[e];return De(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Jj(n,e,t){eK(n,e),e.set(n,t)}function eK(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tK(n,e,t){var r=R9(n,e,"set");return nK(n,r,t),t}function nK(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function rK(n,e){var t=R9(n,e,"get");return iK(n,t)}function R9(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function iK(n,e){return e.get?e.get.call(n):e.value}var C2=new WeakMap;class T9{constructor(){Jj(this,C2,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(rK(this,C2)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){tK(this,C2,e)}}Yt(T9,ni);function o7(n,e){const t=[];let r=0,i=0;for(;r<n.length&&i<e.length;r++,i++)n[r]!==e[i]&&t.push({op:"replace",index:i,oldValue:n[r],newValue:e[i]});for(;r<e.length;r++)t.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<n.length;i++)t.push({op:"remove",index:i,oldValue:n[i],newValue:void 0});return t}function Lc(n,e,t){sK(n,e),e.set(n,t)}function sK(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wi(n,e){var t=A9(n,e,"get");return oK(n,t)}function oK(n,e){return e.get?e.get.call(n):e.value}function gf(n,e,t){var r=A9(n,e,"set");return aK(n,r,t),t}function A9(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function aK(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var yf=new WeakMap,Pc=new WeakMap,wf=new WeakMap,vf=new WeakMap,Cf=new WeakMap;class lK{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Lc(this,yf,{writable:!0,value:new Set}),Lc(this,Pc,{writable:!0,value:[]}),Lc(this,wf,{writable:!0,value:[]}),Lc(this,vf,{writable:!0,value:!1}),Lc(this,Cf,{writable:!0,value:!1}),gf(this,Cf,e!=null?e:!1)}createObserver(){const e=new T9;return wi(this,yf).add(e),e.addLocalHook("unsubscribe",()=>{wi(this,yf).delete(e)}),e._writeInitialChanges(o7(wi(this,Pc),wi(this,wf))),e}emit(e){let t=wi(this,wf);(!wi(this,vf)||wi(this,Pc).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(wi(this,Cf)):gf(this,Pc,new Array(e.length).fill(wi(this,Cf))),wi(this,vf)||(gf(this,vf,!0),t=wi(this,Pc)));const r=o7(t,e);wi(this,yf).forEach(i=>i._write(r)),gf(this,wf,e)}}class Vy{constructor(){this.indexesSequence=new S9,this.trimmingMapsCollection=new s7(e=>e.some(t=>t===!0),!1),this.hidingMapsCollection=new s7(e=>e.some(t=>t===!0),!1),this.variousMapsCollection=new Wv,this.hidingChangesObservable=new lK({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,r){return this.registerMap(e,Zj(t,r))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof Hd?this.trimmingMapsCollection.register(e,t):t instanceof zg?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const r=this.getNumberOfIndexes();return r>0&&t.init(r),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return De(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return De(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return De(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return De(t)?t:null}getNearestNotHiddenIndex(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return t>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?r?this.getNearestNotHiddenIndex(e,-t,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const r=ct(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),s=e.length,o=jh(this.getIndexesSequence(),r),a=o.filter(u=>this.isTrimmed(u)===!1);let l=o.indexOf(a[a.length-1])+1;if(t+s<i){const u=a[t];l=o.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(Bv(o,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const r=this.getNotTrimmedIndexes()[e],i=De(r)?r:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),o=ct(new Array(t).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(s,o),this.hidingMapsCollection.insertToEvery(s,o),this.variousMapsCollection.insertToEvery(s,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const r=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(r,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const r=this.getPhysicalFromRenderableIndex(t),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,t)}}}Yt(Vy,ni);Ue.getSingleton().register("modifyAutoColumnSizeSeed");const Dc="autoColumnSize",uK=10,E2=new WeakMap,cK="autoColumnSize";class gh extends Lt{static get PLUGIN_KEY(){return Dc}static get PLUGIN_PRIORITY(){return uK}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),E2.set(this,{cachedColumnHeaders:[]}),this.ghostTable=new t9(this.hot),this.samplesGenerator=new n9((t,r)=>{const i=this.hot.getCellMeta(t,r);let s="";i.spanned||(s=this.hot.getDataAtCell(t,r));let o="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(o=this.hot.runHooks("modifyAutoColumnSizeSeed",o,i,s)),{value:s,bundleSeed:o}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredColumns=0,this.columnWidthsMap=new fa,this.hot.columnIndexMapper.registerMap(cK,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,r,i)=>this.onBeforeColumnResize(t,r,i))}isEnabled(){return this.hot.getSettings()[Dc]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Dc];t&&t.useHeaders!==null&&t.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",r=>this.onBeforeChange(r)),this.addHook("afterFormulasValuesUpdate",r=>this.onAfterFormulasValuesUpdate(r)),this.addHook("beforeViewRender",r=>this.onBeforeViewRender(r)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("afterInit",()=>this.onAfterInit()),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,r)=>this.onBeforeColumnResize(e,t,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const t=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();r===-1||i===-1||this.calculateColumnsWidth({from:r,to:i},void 0,t)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof t=="number"?{from:t,to:t}:t;ze(i.from,i.to,o=>{let a=this.hot.toPhysicalColumn(o);if(a===null&&(a=o),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(o,s);re(l,u=>{let[c,h]=u;return this.ghostTable.addColumn(c,h)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((o,a)=>{const l=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const s=()=>{if(!this.hot){fp(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:t,to:Math.min(t+gh.CALCULATION_STEP,r)},e),t=t+gh.CALCULATION_STEP+1,t<r?i=Cv(s):(fp(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},o=this.getSyncCalculationLimit();this.firstCalculation&&o>=0&&(this.calculateColumnsWidth({from:0,to:o},e),this.firstCalculation=!1,t=o+1),t<r?s():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[Dc],t=e&&Sn(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Sn(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Dc];let t=gh.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return dt(e)&&(t=e.syncLimit,Rx(t)?t=Fx(r,t):t>>=0),Math.min(t,r)}getColumnWidth(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=t;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,Sv.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const t=e.wtTable.getFirstVisibleColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){const t=e.wtTable.getFirstRenderedColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const t=e.wtTable.getLastVisibleColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){const t=e.wtTable.getLastRenderedColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader(),{cachedColumnHeaders:t}=E2.get(this);return Tr(e,(i,s,o)=>{const a=t.length;return(a-1<o||t[o]!==s)&&i.push(o),a-1<o?t.push(s):t[o]=s,i},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{re(e,t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!Oi(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}onBeforeViewRender(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}onAfterLoadData(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}onBeforeChange(e){const t=ct(e,r=>{let[,i]=r;return this.hot.toPhysicalColumn(this.hot.propToCol(i))});this.clearCache(Array.from(new Set(t)))}onBeforeColumnResize(e,t,r){let i=e;return r&&(this.calculateColumnsWidth(t,void 0,!0),i=this.getColumnWidth(t,void 0,!1)),i}onAfterInit(){E2.get(this).cachedColumnHeaders=this.hot.getColHeader()}onAfterFormulasValuesUpdate(e){const t=Oi(e,i=>{var s;return De((s=i.address)===null||s===void 0?void 0:s.col)}),r=ct(t,i=>i.address.col);this.clearCache(Array.from(new Set(r)))}destroy(){this.ghostTable.clean(),super.destroy()}}const za={horizontal:"horizontal",vertical:"vertical"};function hK(n,e,t){let r,i,s;return e[0]===n[0]&&e[1]<n[1]?(s="left",r=t(e[0],e[1]),i=t(e[2],n[1]-1)):e[2]===n[2]&&e[0]===n[0]&&e[3]>n[3]?(s="right",r=t(e[0],n[3]+1),i=t(e[2],e[3])):e[0]<n[0]&&e[1]===n[1]?(s="up",r=t(e[0],e[1]),i=t(n[0]-1,e[3])):e[2]>n[2]&&e[1]===n[1]&&(s="down",r=t(n[2]+1,e[1]),i=t(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:r,endOfDragCoords:i}}function dK(n){const e={};return n===!0?(e.directions=Object.keys(za),e.autoInsertRow=!0):dt(n)?(De(n.autoInsertRow)?n.direction===za.horizontal?e.autoInsertRow=!1:e.autoInsertRow=n.autoInsertRow:e.autoInsertRow=!1,De(n.direction)?e.directions=[n.direction]:e.directions=Object.keys(za)):typeof n=="string"?(e.directions=[n],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}Ue.getSingleton().register("modifyAutofillRange");Ue.getSingleton().register("beforeAutofill");Ue.getSingleton().register("afterAutofill");const a7="autofill",fK=20,mK=["fillHandle"],pK="insert_row_below",gK=200;class yK extends Lt{static get PLUGIN_KEY(){return a7}static get PLUGIN_PRIORITY(){return fK}static get SETTING_KEYS(){return[a7,...mK]}constructor(e){super(e),this.eventManager=new dn(this),this.addingStarted=!1,this.mouseDownOnCellCorner=!1,this.mouseDragOutside=!1,this.handleDraggedCells=0,this.directions=[],this.autoInsertRow=!1}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>this.onAfterCellCornerMouseDown(e)),this.addHook("afterOnCellCornerDblClick",e=>this.onCellCornerDblClick(e)),this.addHook("beforeOnCellMouseOver",(e,t)=>this.onBeforeCellMouseOver(t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:r}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:r,endRow:i,endCol:s}]),a=[],l=[],u=[];return re(o,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),re(a,c=>{const h=[];re(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[o.row,o.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,t),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=hK(l,u,(f,m)=>this.hot._createCellCoords(f,m));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),m=s.clone(),p=this.hot._createCellRange(h,h,d),y=this.hot.runHooks("beforeAutofill",f,m,p,c);if(y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let C=y;const b=y;if(["up","left"].indexOf(c)>-1&&!(b.length===1&&b[0].length===0))if(C=[],c==="up"){const v=d.row-h.row+1,S=v%b.length;for(let L=0;L<v;L++)C.push(b[(L+(b.length-S))%b.length])}else{const v=d.col-h.col+1,S=v%b[0].length;for(let L=0;L<b.length;L++){C.push([]);for(let _=0;_<v;_++)C[L].push(b[L][(_+(b[L].length-S))%b[L].length])}}this.hot.populateFromArray(h.row,h.col,C,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",C,m,p,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),r=t.getBottomEndCorner();let i=e;if(this.directions.includes(za.vertical)&&this.directions.includes(za.horizontal)){const s=t.getTopStartCorner();(r.col<=e.col||s.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||s.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(za.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(za.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(pK,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},gK)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&t[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),r=this.hot.countRows();let i;for(let s=e[2]+1;s<r;s++){for(let l=e[1];l<=e[3];l++)if(t[s][l])return-1;const o=t[s][e[1]-1],a=t[s][e[3]+1];(!!o||!!a)&&(i=s)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...ct(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,r=Hn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+cn(this.hot.table),i=Hn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+Bt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t))}onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}onBeforeCellMouseOver(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}onMouseUp(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}onMouseMove(e){const t=this.getIfMouseWasDraggedOutside(e);this.addingStarted===!1&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=dK(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}const Ef="autoRowSize",wK=40,vK="autoRowSize";class yh extends Lt{static get PLUGIN_KEY(){return Ef}static get PLUGIN_PRIORITY(){return wK}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),this.rowHeightsMap=void 0,this.headerHeight=null,this.ghostTable=new t9(this.hot),this.samplesGenerator=new n9((t,r)=>{let i;return t>=0?i=this.hot.getDataAtCell(t,r):t===-1&&(i=this.hot.getColHeader(r)),{value:i}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredRows=0,this.rowHeightsMap=new fa,this.hot.rowIndexMapper.registerMap(vK,this.rowHeightsMap),this.addHook("beforeRowResize",(t,r,i)=>this.onBeforeRowResize(t,r,i))}isEnabled(){const e=this.hot.getSettings()[Ef];return e===!0||dt(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",t=>this.onBeforeChange(t)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",t=>this.onBeforeViewRender(t)),this.addHook("modifyRowHeight",(t,r)=>this.getRowHeight(r,t)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,r)=>this.onBeforeRowResize(e,t,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof t=="number"?{from:t,to:t}:t;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}ze(i.from,i.to,o=>{if(r||this.rowHeightsMap.getValueAtIndex(o)===null){const a=this.samplesGenerator.generateRowSamples(o,s);re(a,l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const s=()=>{if(!this.hot){fp(i),this.inProgress=!1;return}this.calculateRowsHeight({from:t,to:Math.min(t+yh.CALCULATION_STEP,r)},e),t=t+yh.CALCULATION_STEP+1,t<r?i=Cv(s):(fp(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},o=this.getSyncCalculationLimit();this.firstCalculation&&o>=0&&(this.calculateRowsHeight({from:0,to:o},e),this.firstCalculation=!1,t=o+1),t<r?s():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[Ef],t=e&&Sn(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Sn(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){Gh(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Ef];let t=yh.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return dt(e)&&(t=e.syncLimit,Rx(t)?t=Fx(r,t):t>>=0),Math.min(t,r)}getRowHeight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=t;return r!==null&&r>(t||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:t,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{ze(Math.min(t,r),Math.max(t,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!Oi(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}onBeforeViewRender(){const e=this.hot.renderCall,t=this.hot.getSettings().fixedRowsBottom,r=this.getFirstVisibleRow(),i=this.getLastVisibleRow();if(!(r===-1||i===-1)){if(this.calculateRowsHeight({from:r,to:i},void 0,e),t){const s=this.hot.countRows()-1;this.calculateRowsHeight({from:s-t,to:s})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}onBeforeRowMove(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()}onBeforeRowResize(e,t,r){let i=e;return r&&(this.calculateRowsHeight(t,void 0,!0),i=this.getRowHeight(t)),i}onAfterLoadData(){this.hot.view?this.recalculateAllRowsHeight():setTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()},0)}onBeforeChange(e){let t=null;e.length===1?t=e[0][0]:e.length>1&&(t={from:e[0][0],to:e[e.length-1][0]}),t!==null&&this.clearCacheByRange(t)}destroy(){this.ghostTable.clean(),super.destroy()}}const{getListWithInsertedItems:CK,getListWithRemovedItems:EK}=b9("physicallyIndexed");class bK extends Ml{constructor(){super(e=>e)}insert(e,t){const r=$v(this.indexedValues,t);this.indexedValues=CK(r,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=EK(this.indexedValues,e);this.indexedValues=Vv(t,e),super.remove(e)}}const SK=bK,{getListWithInsertedItems:RK,getListWithRemovedItems:TK}=b9("physicallyIndexed");class AK extends Ml{constructor(){super(e=>e)}insert(e,t){this.indexedValues=RK(this.indexedValues,e,t,(r,i)=>this.getNextValue(i)),super.insert(e,t)}remove(e){this.indexedValues=TK(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const xK=AK,b2="bindRowsWithHeaders",MK=210,NK="loose",IK=new Map([["loose",SK],["strict",xK]]);class OK extends Lt{static get PLUGIN_KEY(){return b2}static get PLUGIN_PRIORITY(){return MK}constructor(e){super(e),this.headerIndexes=null}isEnabled(){return!!this.hot.getSettings()[b2]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[b2];typeof e!="string"&&(e=NK);const t=IK.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",r=>this.onModifyRowHeader(r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}onModifyRowHeader(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}destroy(){super.destroy()}}function _K(n,e,t){LK(n,e),e.set(n,t)}function LK(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function S2(n,e,t){return e=PK(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function PK(n){var e=DK(n,"string");return typeof e=="symbol"?e:String(e)}function DK(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function l7(n,e){var t=x9(n,e,"get");return kK(n,t)}function kK(n,e){return e.get?e.get.call(n):e.value}function R2(n,e,t){var r=x9(n,e,"set");return FK(n,r,t),t}function x9(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function FK(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const T2="collapsibleColumns",HK=290,UK=["nestedHeaders"],Wl="collapsibleIndicator",u7=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Gl=new WeakMap;class BK extends Lt{constructor(){super(...arguments),S2(this,"nestedHeadersPlugin",null),S2(this,"eventManager",new dn(this)),S2(this,"headerStateManager",null),_K(this,Gl,{writable:!0,value:null})}static get PLUGIN_KEY(){return T2}static get PLUGIN_PRIORITY(){return HK}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[T2,...UK]}isEnabled(){return!!this.hot.getSettings()[T2]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||Xt("You need to configure the Nested Headers plugin in order to use collapsible headers."),R2(this,Gl,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("afterGetColHeader",function(){return e.onAfterGetColHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",(r,i,s)=>this.onBeforeOnCellMouseDown(r,i,s)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!!this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),R2(this,Gl,null),this.nestedHeadersPlugin=null,this.clearButtons(),super.disablePlugin()}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};ze(0,e-1,o=>{const a=t.childNodes[o],l=r.childNodes[o],u=i?i.childNodes[o]:null;ze(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Wl}`);s(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Wl}`),s(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Wl}`),s(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:l}=r;if(i===!0&&s>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!u7.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const r=Oi(e,d=>{let{row:f}=d;return f<0});let i=r.length>0;re(r,d=>{var f;let{row:m,col:p}=d;const{collapsible:y,isCollapsed:C}=(f=this.headerStateManager.getHeaderSettings(m,p))!==null&&f!==void 0?f:{};if(!y||C&&t==="collapse"||!C&&t==="expand")return i=!1,!1});const s=[],o=[];i&&re(r,d=>{let{row:f,col:m}=d;const{colspanCompensation:p,affectedColumns:y,rollbackModification:C}=this.headerStateManager.triggerNodeModification(t,f,m);p>0&&(o.push(...y),s.push(C))});const a=this.getCollapsedColumns();let l=[];t==="collapse"?l=dx([...a,...o]):t==="expand"&&(l=Oi(a,d=>!o.includes(d)));const u=u7.get(t);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){re(s,d=>{d()});return}this.hot.batchExecution(()=>{re(o,d=>{l7(this,Gl).setValueAtIndex(this.hot.toPhysicalColumn(d),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return l7(this,Gl).getHiddenIndexes()}onAfterGetColHeader(e,t,r){var i;const{collapsible:s,origColspan:o,isCollapsed:a}=(i=this.headerStateManager.getHeaderSettings(r,e))!==null&&i!==void 0?i:{},l=s&&o>1&&e>=this.hot.getSettings().fixedColumnsStart;let u=t.querySelector(`.${Wl}`);if(l)u||(u=this.hot.rootDocument.createElement("div"),Ae(u,Wl),t.querySelector("div:first-child").appendChild(u)),tt(u,["collapsed","expanded"]),a?(Ae(u,"collapsed"),ol(u,"+")):(Ae(u,"expanded"),ol(u,"-"));else{var c;(c=u)===null||c===void 0||c.remove()}}onBeforeOnCellMouseDown(e,t){Je(e.target,Wl)&&(Je(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):Je(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),Ds(e))}onInit(){this.updatePlugin()}onAfterLoadData(e,t){t||this.updatePlugin()}destroy(){R2(this,Gl,null),super.destroy()}}const VK=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],$K=!1,WK=!0,GK=!0;class zK{constructor(e,t){this.hot=e,this.sortingStates=new Yg,this.sortEmptyCells=$K,this.indicator=WK,this.headerAction=GK,this.compareFunctionFactory=void 0,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){!dt(e)||ft(e,(t,r)=>{VK.includes(r)&&(this[r]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[r]=t;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return dt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[r,i]=t;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(De(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const yp="asc",wp="desc",YK="colHeader";function jK(n){if(dt(n)===!1)return!1;const{column:e,sortOrder:t}=n;return Number.isInteger(e)&&[yp,wp].includes(t)}function KK(n){if(n.some(t=>jK(t)===!1))return!1;const e=n.map(t=>{let{column:r}=t;return r});return new Set(e).size===e.length}function c7(n){if(n!==wp)return n===yp?wp:yp}function h7(n){return n.querySelector(`.${YK}`)}function d7(n,e){if(n<0||!e.parentNode)return!1;const t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length===-1}function $y(n,e,t){return n===-1&&e>=0&&sl(t)===!1}const qK="ascending",XK="descending",M9="indicatorDisabled",N9="columnSorting",I9="sortAction",O9=new Map([[yp,qK],[wp,XK]]);function QK(n,e,t,r){const i=[N9];if(r&&i.push(I9),t===!1)return i.push(M9),i;const s=n.getSortOrderOfColumn(e);return De(s)&&i.push(O9.get(s)),i}function ZK(){return Array.from(O9.values()).concat(I9,M9,N9)}function _9(n,e,t){const r=e.locale;return function(i,s){const{sortEmptyCells:o}=t;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof s=="string"&&(s=s.toLocaleLowerCase(r)),i===s?_s:zn(i)?zn(s)?_s:o&&n==="asc"?ln:un:zn(s)?o&&n==="asc"?un:ln:isNaN(i)&&!isNaN(s)?n==="asc"?un:ln:!isNaN(i)&&isNaN(s)||(isNaN(i)||isNaN(s)||(i=parseFloat(i),s=parseFloat(s)),i<s)?n==="asc"?ln:un:i>s?n==="asc"?un:ln:_s}}const L9="default";function JK(n,e,t){return function(r,i){const s=parseFloat(r),o=parseFloat(i),{sortEmptyCells:a}=t;if(s===o||isNaN(s)&&isNaN(o))return _s;if(a){if(zn(r))return n==="asc"?ln:un;if(zn(i))return n==="asc"?un:ln}return isNaN(s)?un:isNaN(o)?ln:s<o?n==="asc"?ln:un:s>o?n==="asc"?un:ln:_s}}const eq="numeric";function tq(n,e,t){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:s}=t;return function(o,a){const l=zn(o),u=zn(a),c=l?i:o,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(s===!1){if(l&&u===!1)return un;if(l===!1&&u)return ln}return d===!1&&f?n==="asc"?ln:un:d&&f===!1?n==="asc"?un:ln:d===!1&&f===!1?_9(n,e,t)(o,a):c===i&&h===r?n==="asc"?ln:un:c===r&&h===i?n==="asc"?un:ln:_s}}const nq="checkbox";function rq(n,e,t){return function(r,i){const{sortEmptyCells:s}=t;if(r===i)return _s;if(zn(r))return zn(i)?_s:s&&n==="asc"?ln:un;if(zn(i))return s&&n==="asc"?un:ln;const o=e.dateFormat,a=It(r,o),l=It(i,o);return a.isValid()?l.isValid()?l.isAfter(a)?n==="asc"?ln:un:l.isBefore(a)?n==="asc"?un:ln:_s:ln:un}}const iq="date",{register:jg,getItem:f7,hasItem:sq}=Hi("sorting.compareFunctionFactory"),{register:P9,getItem:oq}=Hi("sorting.mainSortComparator");function D9(n){return sq(n)?f7(n):f7(L9)}jg(eq,JK);jg(nq,tq);jg(iq,rq);jg(L9,_9);const _s=0,ln=-1,un=1;function aq(n,e){const t=oq(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];n.sort(t(...i))}function lq(n,e){return function(t,r){const[,...i]=t,[,...s]=r;return function(a){const l=n[a],u=e[a],c=i[a],h=s[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:D9(u.type))(l,u,d)(c,h)}(0)}}const Wy="columnSorting",uq=50,m7="append",cq="replace";P9(Wy,lq);Ue.getSingleton().register("beforeColumnSort");Ue.getSingleton().register("afterColumnSort");class k9 extends Lt{static get PLUGIN_KEY(){return Wy}static get PLUGIN_PRIORITY(){return uq}constructor(e){super(e),this.columnStatesManager=null,this.columnMetaCache=null,this.pluginKey=Wy,this.indexesSequenceCache=null}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new zK(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new fa(t=>{let r=this.hot.toVisualColumn(t);return r===null&&(r=t),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,r)=>this.onAfterGetColHeader(t,r)),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",(t,r)=>this.onAfterOnCellMouseDown(t,r)),this.addHook("afterInit",()=>this.loadOrSortBySettings()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.hot.view&&this.loadOrSortBySettings(),super.enablePlugin())}disablePlugin(){const e=(t,r)=>{const i=h7(r);d7(t,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,super.disablePlugin()}sort(e){const t=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",t,r,i)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new S9),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",t,i?r:t,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return De(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return KK(e)&&e.every(r=>{let{column:i}=r;return i<=t&&i>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:s,...o}=i;return{column:this.hot.toPhysicalColumn(s),...o}};t.initialConfig=ct(e,r),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,r=i=>{let{column:s,...o}=i;return{column:this.hot.toVisualColumn(s),...o}};return De(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=ct(t.initialConfig,r)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(De(t)){const i=c7(t);return De(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:c7()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m7;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(i){if(Qt(o))return[...s.slice(0,r),...s.slice(r+1)];if(t===m7)return[...s.slice(0,r),...s.slice(r+1),o];if(t===cq)return[...s.slice(0,r),o,...s.slice(r+1)]}return De(o)?s.concat(o):s}getPluginColumnConfig(e){if(dt(e)){const t=e[this.pluginKey];if(dt(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(i);return Array.isArray(s.columns)?Object.assign(r,t,this.getPluginColumnConfig(s.columns[e])):qt(s.columns)?Object.assign(r,t,this.getPluginColumnConfig(s.columns(e))):Object.assign(r,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),r=Object.create(t);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const t=[],r=this.hot.countRows(),i=u=>ct(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)t.push([this.hot.toPhysicalRow(u)].concat(i(u)));const s=ct(t,u=>u[0]);aq(t,this.pluginKey,ct(e,u=>u.sortOrder),ct(e,u=>this.getFirstCellSettings(u.column)));for(let u=t.length;u<r;u+=1)t.push([u].concat(i(u)));const o=ct(t,u=>u[0]),a=new Map(ct(s,(u,c)=>[u,o[c]])),l=ct(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}loadOrSortBySettings(){const e=this.getAllSavedSortSettings();if(dt(e))this.sortBySettings(e);else{const t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}sortBySettings(e){if(dt(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||dt(t))&&this.sort(t)}else this.hot.render()}onAfterGetColHeader(e,t){const r=h7(t);if(d7(e,t)===!1||r===null)return;const i=this.getFirstCellSettings(e)[this.pluginKey],s=i.indicator,o=i.headerAction;this.updateHeaderClasses(r,this.columnStatesManager,e,s,o)}updateHeaderClasses(e){if(tt(e,ZK()),this.enabled!==!1){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];Ae(e,QK(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),De(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}onAfterLoadData(e){e===!0&&this.hot.view&&this.loadOrSortBySettings()}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&e.target.nodeName==="SPAN"}onBeforeOnCellMouseDown(e,t,r,i){$y(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}onAfterOnCellMouseDown(e,t){$y(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}class hq{constructor(e,t){this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=t,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),re(r,i=>{const s={};this.assignSetting(i,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,s,"reversedRowCoords",!1),this.assignSetting(i,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"sourceColumn",i.destinationColumn),this.assignSetting(i,s,"type","sum"),this.assignSetting(i,s,"forceNumeric",!1),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"customFunction",null),this.assignSetting(i,s,"readOnly",!0),this.assignSetting(i,s,"roundFloat",!1),t.push(s)}),t}assignSetting(e,t,r,i){if(r==="ranges"&&e[r]===void 0){t[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;t[r]=i}else r==="destinationRow"&&t.reversedRowCoords?t[r]=this.hot.countRows()-e[r]-1:t[r]=e[r]}resetSetupBeforeStructureAlteration(e,t,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();re(s,o=>{i==="row"&&o.destinationRow>=t&&(e==="insert_row"?o.alterRowOffset=r:e==="remove_row"&&(o.alterRowOffset=-1*r)),i==="col"&&o.destinationColumn>=t&&(e==="insert_col"?o.alterColumnOffset=r:e==="remove_col"&&(o.alterColumnOffset=-1*r))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,t,r,i,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=t;re(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?re(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):re(u,d=>{this.shiftEndpointCoordinates(d,h)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,r,i){re(e.ranges,s=>{s[1]&&(t>=s[0]&&t<=s[1]?r>s[1]?s[1]+=i:r<s[0]&&(s[0]-=i):r>=s[0]&&r<=s[1]&&(s[1]-=i,t<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,r=[],i=[];re(t,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));i.push(o)}),re(i,s=>{let o=[];re(s,(a,l)=>{l===0?o.push(a):s[l]!==s[l-1]+1&&(o.push(s[l-1]),r.push(o),o=[],o.push(a)),l===s.length-1&&(o.push(a),r.push(o))})}),e.ranges=r}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,re(e.ranges,r=>{re(r,(i,s)=>{i>=t&&(r[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const s=i.alterRowOffset||0,o=i.alterColumnOffset||0;return i.destinationRow+s>=this.hot.countRows()||i.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],re(e,i=>{this.resetEndpointValue(i,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],re(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],re(e,(r,i,s)=>{`${r[2]||""}`!=`${r[3]}`&&re(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[i][1])===o.sourceColumn&&t.indexOf(a)===-1&&t.push(a)})}),re(t,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?r:0)),this.hot.toVisualColumn(e.destinationColumn+(t?i:0)),""])}setEndpointValue(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(t==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Xt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const dq=hq;function A2(n){return n==null||isNaN(n)}const x2="columnSummary",fq=220;class mq extends Lt{static get PLUGIN_KEY(){return x2}static get PLUGIN_PRIORITY(){return fq}constructor(e){super(e),this.endpoints=null}isEnabled(){return!!this.hot.getSettings()[x2]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[x2],this.endpoints=new dq(this,this.settings),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeCreateRow",(t,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,r,null,i)),this.addHook("beforeCreateCol",(t,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(t,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,r,null,i)),this.addHook("afterCreateCol",(t,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,r,null,i)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){return e.onAfterRowMove(...arguments)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let t=0;return ft(e.ranges,r=>{t+=this.getPartialSum(r,e.sourceColumn)}),t}getPartialSum(e,t){let r=0,i=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(i,t),s=A2(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}r+=s||0,i-=1}while(i>=e[0]);return Math.round(r*10**o)/10**o}calculateMinMax(e,t){let r=null;return ft(e.ranges,i=>{const s=this.getPartialMinMax(i,e.sourceColumn,t);if(r===null&&s!==null&&(r=s),s!==null)switch(t){case"min":r=Math.min(r,s);break;case"max":r=Math.max(r,s);break}}),r===null?"Not enough data":r}getPartialMinMax(e,t,r){let i=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,t),o=A2(o)?null:o,i===null)i=o;else if(o!==null)switch(r){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}s-=1}while(s>=e[0]);return i}countEmpty(e,t){let r,i=0,s=e[1]||e[0];do r=this.getCellValue(s,t),r=A2(r)?null:r,r===null&&(i+=1),s-=1;while(s>=e[0]);return i}countEntries(e){let t=0;const r=e.ranges;return ft(r,i=>{const s=i[1]===void 0?1:i[1]-i[0]+1,o=this.countEmpty(i,e.sourceColumn);t+=s,t-=o}),t}calculateAverage(e){const t=this.calculateSum(e),r=this.countEntries(e);return t/r}getCellValue(e,t){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(t);let s=this.hot.getSourceDataAtCell(e,t),o="";if(r!==null&&i!==null&&(o=this.hot.getCellMeta(r,i).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Vt`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}onAfterInit(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}onAfterChange(e,t){e&&t!=="ColumnSummary.reset"&&t!=="ColumnSummary.set"&&t!=="loadData"&&this.endpoints.refreshChangedEndpoints(e)}onAfterRowMove(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}}class Ru{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){this.rootDocument=e,this.isRtl=t,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}setPosition(e,t){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${t}px`}setSize(e,t){if(e&&t){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${t}px`}}getSize(){return{width:Bt(this.getInputElement()),height:cn(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const t=this.getInputElement();t.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),t=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Ae(this.container,Ru.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Ae(e,Ru.CLASS_EDITOR),Ae(t,Ru.CLASS_INPUT),e.appendChild(t),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${Ru.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const pq=Ru,ut="---------";function gq(){return{name:ut}}function yq(n){return ct(n,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function bf(n){return Je(n,"htSeparator")}function wq(n){return Je(n,"htSubmenu")}function Sf(n){return Je(n,"htDisabled")}function Rf(n){return Je(n,"htSelectionDisabled")}function Nl(n){const e=n.getSelected();return!e||e[0]<0?null:e}function vq(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Cq(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ra(n,e){const t={};return re(n,r=>{r.forAll((i,s)=>{i>=0&&s>=0&&(t[i]||(t[i]=[]),t[i][s]=e(i,s))})}),t}function Ho(n,e,t,r,i){re(n,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&Eq(o,a,e,t,r,i)})})}function Eq(n,e,t,r,i,s){const o=i(n,e);let a=r;o.className&&(t==="vertical"?a=vq(o.className,r):a=Cq(o.className,r)),s(n,e,"className",a)}function Ss(n,e){let t=!1;return Array.isArray(n)&&re(n,r=>(r.forAll((i,s)=>{if(i>=0&&s>=0&&e(i,s))return t=!0,!1}),t)),t}function ao(n){return`<span class="selected">${String.fromCharCode(10003)}</span>${n}`}function bq(n,e){return!n.hidden||!(typeof n.hidden=="function"&&n.hidden.call(e))}function F9(n,e){const t=n.slice(0);for(let r=0;r<t.length&&t[r].name===e;)t.shift();return t}function Sq(n,e){let t=n.slice(0);return t.reverse(),t=F9(t,e),t.reverse(),t}function Rq(n){const e=[];return re(n,(t,r)=>{r>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function Tq(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ut,t=n.slice(0);return t=F9(t,e),t=Sq(t,e),t=Rq(t),t}const Aq=250,xq=250;class H9{constructor(e){this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},xq)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Aq;this.showDebounced=Ix(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}}Yt(H9,ni);const Mq=H9,U9="ContextMenu:items",rt=U9,Gv=`${rt}.noItems`,zv=`${rt}.insertRowAbove`,Yv=`${rt}.insertRowBelow`,jv=`${rt}.insertColumnOnTheLeft`,Kv=`${rt}.insertColumnOnTheRight`,qv=`${rt}.removeRow`,Xv=`${rt}.removeColumn`,Qv=`${rt}.undo`,Zv=`${rt}.redo`,Jv=`${rt}.readOnly`,eC=`${rt}.clearColumn`,tC=`${rt}.copy`,nC=`${rt}.copyWithHeaders`,rC=`${rt}.copyWithGroupHeaders`,iC=`${rt}.copyHeadersOnly`,sC=`${rt}.cut`,oC=`${rt}.freezeColumn`,aC=`${rt}.unfreezeColumn`,lC=`${rt}.mergeCells`,uC=`${rt}.unmergeCells`,cC=`${rt}.addComment`,hC=`${rt}.editComment`,dC=`${rt}.removeComment`,fC=`${rt}.readOnlyComment`,mC=`${rt}.align`,pC=`${rt}.align.left`,gC=`${rt}.align.center`,yC=`${rt}.align.right`,wC=`${rt}.align.justify`,vC=`${rt}.align.top`,CC=`${rt}.align.middle`,EC=`${rt}.align.bottom`,bC=`${rt}.borders`,SC=`${rt}.borders.top`,RC=`${rt}.borders.right`,TC=`${rt}.borders.bottom`,AC=`${rt}.borders.left`,xC=`${rt}.borders.remove`,MC=`${rt}.nestedHeaders.insertChildRow`,NC=`${rt}.nestedHeaders.detachFromParent`,IC=`${rt}.hideColumn`,OC=`${rt}.showColumn`,_C=`${rt}.hideRow`,LC=`${rt}.showRow`,Ur="Filters:",fn=`${Ur}conditions`,Kg=`${fn}.none`,PC=`${fn}.isEmpty`,DC=`${fn}.isNotEmpty`,kC=`${fn}.isEqualTo`,FC=`${fn}.isNotEqualTo`,HC=`${fn}.beginsWith`,UC=`${fn}.endsWith`,BC=`${fn}.contains`,VC=`${fn}.doesNotContain`,Nq=`${fn}.byValue`,$C=`${fn}.greaterThan`,WC=`${fn}.greaterThanOrEqualTo`,GC=`${fn}.lessThan`,zC=`${fn}.lessThanOrEqualTo`,YC=`${fn}.isBetween`,jC=`${fn}.isNotBetween`,KC=`${fn}.after`,qC=`${fn}.before`,XC=`${fn}.today`,QC=`${fn}.tomorrow`,ZC=`${fn}.yesterday`,JC=`${Ur}labels.filterByCondition`,eE=`${Ur}labels.filterByValue`,tE=`${Ur}labels.conjunction`,qg=`${Ur}labels.disjunction`,vp=`${Ur}values.blankCells`,nE=`${Ur}buttons.selectAll`,rE=`${Ur}buttons.clear`,iE=`${Ur}buttons.ok`,sE=`${Ur}buttons.cancel`,oE=`${Ur}buttons.placeholder.search`,aE=`${Ur}buttons.placeholder.value`,lE=`${Ur}buttons.placeholder.secondValue`,Iq=Object.freeze(Object.defineProperty({__proto__:null,CONTEXT_MENU_ITEMS_NAMESPACE:U9,CONTEXTMENU_ITEMS_NO_ITEMS:Gv,CONTEXTMENU_ITEMS_ROW_ABOVE:zv,CONTEXTMENU_ITEMS_ROW_BELOW:Yv,CONTEXTMENU_ITEMS_INSERT_LEFT:jv,CONTEXTMENU_ITEMS_INSERT_RIGHT:Kv,CONTEXTMENU_ITEMS_REMOVE_ROW:qv,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Xv,CONTEXTMENU_ITEMS_UNDO:Qv,CONTEXTMENU_ITEMS_REDO:Zv,CONTEXTMENU_ITEMS_READ_ONLY:Jv,CONTEXTMENU_ITEMS_CLEAR_COLUMN:eC,CONTEXTMENU_ITEMS_COPY:tC,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:nC,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:rC,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:iC,CONTEXTMENU_ITEMS_CUT:sC,CONTEXTMENU_ITEMS_FREEZE_COLUMN:oC,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:aC,CONTEXTMENU_ITEMS_MERGE_CELLS:lC,CONTEXTMENU_ITEMS_UNMERGE_CELLS:uC,CONTEXTMENU_ITEMS_ADD_COMMENT:cC,CONTEXTMENU_ITEMS_EDIT_COMMENT:hC,CONTEXTMENU_ITEMS_REMOVE_COMMENT:dC,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:fC,CONTEXTMENU_ITEMS_ALIGNMENT:mC,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:pC,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:gC,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:yC,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:wC,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:vC,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:CC,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:EC,CONTEXTMENU_ITEMS_BORDERS:bC,CONTEXTMENU_ITEMS_BORDERS_TOP:SC,CONTEXTMENU_ITEMS_BORDERS_RIGHT:RC,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:TC,CONTEXTMENU_ITEMS_BORDERS_LEFT:AC,CONTEXTMENU_ITEMS_REMOVE_BORDERS:xC,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:MC,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:NC,CONTEXTMENU_ITEMS_HIDE_COLUMN:IC,CONTEXTMENU_ITEMS_SHOW_COLUMN:OC,CONTEXTMENU_ITEMS_HIDE_ROW:_C,CONTEXTMENU_ITEMS_SHOW_ROW:LC,FILTERS_NAMESPACE:Ur,FILTERS_CONDITIONS_NAMESPACE:fn,FILTERS_CONDITIONS_NONE:Kg,FILTERS_CONDITIONS_EMPTY:PC,FILTERS_CONDITIONS_NOT_EMPTY:DC,FILTERS_CONDITIONS_EQUAL:kC,FILTERS_CONDITIONS_NOT_EQUAL:FC,FILTERS_CONDITIONS_BEGINS_WITH:HC,FILTERS_CONDITIONS_ENDS_WITH:UC,FILTERS_CONDITIONS_CONTAINS:BC,FILTERS_CONDITIONS_NOT_CONTAIN:VC,FILTERS_CONDITIONS_BY_VALUE:Nq,FILTERS_CONDITIONS_GREATER_THAN:$C,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:WC,FILTERS_CONDITIONS_LESS_THAN:GC,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:zC,FILTERS_CONDITIONS_BETWEEN:YC,FILTERS_CONDITIONS_NOT_BETWEEN:jC,FILTERS_CONDITIONS_AFTER:KC,FILTERS_CONDITIONS_BEFORE:qC,FILTERS_CONDITIONS_TODAY:XC,FILTERS_CONDITIONS_TOMORROW:QC,FILTERS_CONDITIONS_YESTERDAY:ZC,FILTERS_DIVS_FILTER_BY_CONDITION:JC,FILTERS_DIVS_FILTER_BY_VALUE:eE,FILTERS_LABELS_CONJUNCTION:tE,FILTERS_LABELS_DISJUNCTION:qg,FILTERS_VALUES_BLANK_CELLS:vp,FILTERS_BUTTONS_SELECT_ALL:nE,FILTERS_BUTTONS_CLEAR:rE,FILTERS_BUTTONS_OK:iE,FILTERS_BUTTONS_CANCEL:sE,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:oE,FILTERS_BUTTONS_PLACEHOLDER_VALUE:aE,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:lE},Symbol.toStringTag,{value:"Module"})),M2="comments",Oq=60,Tf=new WeakMap,ds="comment",zl="value",p7="style",Af="readOnly";class _q extends Lt{static get PLUGIN_KEY(){return M2}static get PLUGIN_PRIORITY(){return Oq}constructor(e){super(e),this.editor=null,this.displaySwitch=null,this.eventManager=null,this.range={},this.preventEditorAutoSwitch=!1,Tf.set(this,{tempEditorDimensions:{},cellBelowCursor:null})}isEnabled(){return!!this.hot.getSettings()[M2]}enablePlugin(){this.enabled||(this.editor||(this.editor=new pq(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new dn(this)),this.displaySwitch||(this.displaySwitch=new Mq(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,t,r,i,s,o)=>this.onAfterRenderer(e,o)),this.addHook("afterScrollHorizontally",()=>this.hide()),this.addHook("afterScrollVertically",()=>this.hide()),this.addHook("afterBeginEditing",()=>this.hide()),this.displaySwitch.addLocalHook("hide",()=>this.hide()),this.displaySwitch.addLocalHook("show",(e,t)=>this.showAtCell(e,t)),this.registerListeners(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin(),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}disablePlugin(){super.disablePlugin()}registerListeners(){const{rootDocument:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",t=>this.onMouseOver(t)),this.eventManager.addEventListener(e,"mousedown",t=>this.onMouseDown(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",()=>this.onEditorBlur()),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",t=>this.onEditorMouseDown(t)),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",t=>this.onEditorMouseUp(t))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=el(e.target,"TD","TBODY");return!!(t&&Je(t,"htCommentCell")&&el(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.editor.getInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=this.editor.getValue();let r="";e!=null?r=e:t!=null&&(r=t);const i=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(i,s,{[zl]:r}),this.hot.render()}setCommentAtCell(e,t,r){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,ds),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(r)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,zl)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,zl)}show(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:e,col:t}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||t<0||t>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(r[ds]?r[ds][zl]:""),this.editor.show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){this.editor.hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!this.editor.isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:s}=this.hot,{row:o,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(o),u=s.getRenderableFromVisualIndex(a);const c=l===null;this.editor.setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1))),u===null&&(u=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(a,-1)));const h=l===null,d=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(t=u)!==null&&t!==void 0?t:0;const{rootWindow:f,view:{_wt:m}}=this.hot,{wtTable:p}=m,y=m.getCell({row:l,col:u},!0),C=this.getCommentMeta(o,a,p7);C?this.editor.setSize(C.width,C.height):this.editor.resetSize();const b=d?0:p.getStretchedColumnWidth(u),v=c&&!h?cn(y):0,{left:S,top:L,width:_,height:P}=y.getBoundingClientRect(),{width:x,height:I}=this.editor.getSize(),{innerWidth:R,innerHeight:N}=this.hot.rootWindow,H=this.hot.rootDocument.documentElement;let K=S+f.scrollX+b,X=L+f.scrollY+v;this.hot.isRtl()&&(K-=x+b),this.hot.isLtr()&&S+_+x>R?K=S+f.scrollX-x-1:this.hot.isRtl()&&K<-(H.scrollWidth-H.clientWidth)&&(K=S+f.scrollX+b+1),L+I>N&&(X-=I-P+1),this.editor.setPosition(K,X),this.editor.setReadOnlyState(this.getCommentMeta(o,a,Af))}checkSelectionCommentsConsistency(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;let t=!1;const r=e.getTopStartCorner();return this.getCommentMeta(r.row,r.col,zl)&&(t=!0),t}updateCommentMeta(e,t,r){const i=this.hot.getCellMeta(e,t)[ds];let s;i?(s=kr(i),Ug(s,r)):s=r,this.hot.setCellMeta(e,t,ds,s)}getCommentMeta(e,t,r){const i=this.hot.getCellMeta(e,t);if(!!i[ds])return i[ds][r]}onMouseDown(e){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(e)){const t=el(e.target,"TD","TBODY");let r=null;t&&(r=this.hot.getCoords(t)),(!t||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col))&&this.hide()}}onMouseOver(e){const t=Tf.get(this),{rootDocument:r}=this.hot;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Je(e.target,"wtBorder")||t.cellBelowCursor===e.target||!this.editor))if(t.cellBelowCursor=r.elementFromPoint(e.clientX,e.clientY),this.targetIsCellWithComment(e)){const i=this.hot._createCellRange(this.hot.getCoords(e.target));this.displaySwitch.show(i)}else tl(e.target,r)&&!this.targetIsCommentTextArea(e)&&this.displaySwitch.hide()}onMouseUp(){this.preventEditorAutoSwitch=!1}onAfterRenderer(e,t){t[ds]&&t[ds][zl]&&Ae(e,t.commentedCellClassName)}onEditorBlur(){this.setComment()}onEditorMouseDown(e){const t=Tf.get(this);t.tempEditorDimensions={width:Bt(e.target),height:cn(e.target)}}onEditorMouseUp(e){const t=Tf.get(this),r=Bt(e.target),i=cn(e.target);(r!==t.tempEditorDimensions.width+1||i!==t.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[p7]:{width:r,height:i}})}onContextMenuAddComment(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:e.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}onContextMenuRemoveComment(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((t,r)=>{t>=0&&r>=0&&this.removeCommentAtCell(t,r,!1)}),this.hot.render()}onContextMenuMakeReadOnly(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((t,r)=>{if(t>=0&&r>=0){const i=!!this.getCommentMeta(t,r,Af);this.updateCommentMeta(t,r,{[Af]:!i})}})}addToContextMenu(e){const t=()=>this.hot.rowIndexMapper.getRenderableIndexesLength()>0&&this.hot.columnIndexMapper.getRenderableIndexesLength()>0;e.items.push({name:"---------"},{key:"commentsAddEdit",name:()=>this.checkSelectionCommentsConsistency()?this.hot.getTranslatedPhrase(hC):this.hot.getTranslatedPhrase(cC),callback:()=>this.onContextMenuAddComment(),disabled:()=>t()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner()):!0},{key:"commentsRemove",name(){return this.getTranslatedPhrase(dC)},callback:()=>this.onContextMenuRemoveComment(),disabled:()=>t()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner()):!0},{key:"commentsReadOnly",name(){let r=this.getTranslatedPhrase(fC);return Ss(this.getSelectedRangeLast(),(s,o)=>{let a=this.getCellMeta(s,o)[ds];if(a&&(a=a[Af]),a)return!0})&&(r=ao(r)),r},callback:()=>this.onContextMenuMakeReadOnly(),disabled:()=>t()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner())||!this.checkSelectionCommentsConsistency():!0})}getDisplayDelaySetting(){const e=this.hot.getSettings()[M2];if(dt(e))return e.displayDelay}destroy(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),super.destroy()}}var g7=VA,Lq=TypeError,Pq=function(n,e){if(!delete n[e])throw new Lq("Cannot delete property "+g7(e)+" of "+g7(n))},Dq=Rl,kq=Dg,Fq=Fg,Hq=nx,Uq=Pq,Bq=rx,Vq=[].unshift(0)!==1,$q=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(n){return n instanceof TypeError}},Wq=Vq||!$q();Dq({target:"Array",proto:!0,arity:1,forced:Wq},{unshift:function(e){var t=kq(this),r=Fq(t),i=arguments.length;if(i){Bq(r+i);for(var s=r;s--;){var o=s+i;s in t?t[o]=t[s]:Uq(t,o)}for(var a=0;a<i;a++)t[a]=arguments[a]}return Hq(t,r+i)}});class Gq{constructor(e){this.hot=e,this.commands={},this.commonCallback=null}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let l=this.commands[o];if(!l)throw new Error(`Menu command '${o}' not exists.`);if(a&&l.submenu&&(l=zq(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Sn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(s.join(":")),re(u,c=>c.apply(this.hot,r))}}function zq(n,e){let t;return re(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===n)return t=r,!1}),t}const B9=Gq,Si="alignment";function Yq(){return{key:Si,name(){return this.getTranslatedPhrase(mC)},disabled(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Si}:left`,name(){let n=this.getTranslatedPhrase(pC);return Ss(this.getSelectedRange(),(t,r)=>{const i=this.getCellMeta(t,r).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(n=ao(n)),n},callback(){const n=this.getSelectedRange(),e=Ra(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,n,t,r),Ho(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Si}:center`,name(){let n=this.getTranslatedPhrase(gC);return Ss(this.getSelectedRange(),(t,r)=>{const i=this.getCellMeta(t,r).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(n=ao(n)),n},callback(){const n=this.getSelectedRange(),e=Ra(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,n,t,r),Ho(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Si}:right`,name(){let n=this.getTranslatedPhrase(yC);return Ss(this.getSelectedRange(),(t,r)=>{const i=this.getCellMeta(t,r).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(n=ao(n)),n},callback(){const n=this.getSelectedRange(),e=Ra(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,n,t,r),Ho(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Si}:justify`,name(){let n=this.getTranslatedPhrase(wC);return Ss(this.getSelectedRange(),(t,r)=>{const i=this.getCellMeta(t,r).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(n=ao(n)),n},callback(){const n=this.getSelectedRange(),e=Ra(n,(i,s)=>this.getCellMeta(i,s).className),t="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,n,t,r),Ho(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{name:ut},{key:`${Si}:top`,name(){let n=this.getTranslatedPhrase(vC);return Ss(this.getSelectedRange(),(t,r)=>{const i=this.getCellMeta(t,r).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(n=ao(n)),n},callback(){const n=this.getSelectedRange(),e=Ra(n,(i,s)=>this.getCellMeta(i,s).className),t="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,n,t,r),Ho(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Si}:middle`,name(){let n=this.getTranslatedPhrase(CC);return Ss(this.getSelectedRange(),(t,r)=>{const i=this.getCellMeta(t,r).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(n=ao(n)),n},callback(){const n=this.getSelectedRange(),e=Ra(n,(i,s)=>this.getCellMeta(i,s).className),t="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,n,t,r),Ho(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Si}:bottom`,name(){let n=this.getTranslatedPhrase(EC);return Ss(this.getSelectedRange(),(t,r)=>{const i=this.getCellMeta(t,r).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(n=ao(n)),n},callback(){const n=this.getSelectedRange(),e=Ra(n,(i,s)=>this.getCellMeta(i,s).className),t="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,n,t,r),Ho(n,t,r,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1}]}}}const Xg="clear_column";function jq(){return{key:Xg,name(){return this.getTranslatedPhrase(eC)},callback(n,e){const t=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){return Nl(this)?!this.selection.isSelectedByColumnHeader():!0}}}const Ud="col_left";function Kq(){return{key:Ud,name(){return this.getTranslatedPhrase(jv)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,n.col,1,"ContextMenu.columnLeft")},disabled(){return!this.isColumnModificationAllowed()||!Nl(this)?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Bd="col_right";function qq(){return{key:Bd,name(){return this.getTranslatedPhrase(Kv)},callback(){const n=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,n.col,1,"ContextMenu.columnRight")},disabled(){return!this.isColumnModificationAllowed()||!Nl(this)?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Vd="make_read_only";function Xq(){return{key:Vd,name(){let n=this.getTranslatedPhrase(Jv);return Ss(this.getSelectedRange(),(t,r)=>this.getCellMeta(t,r).readOnly)&&(n=ao(n)),n},callback(){const n=this.getSelectedRange(),e=Ss(n,(t,r)=>this.getCellMeta(t,r).readOnly);re(n,t=>{t.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Qg="redo";function Qq(){return{key:Qg,name(){return this.getTranslatedPhrase(Zv)},callback(){this.redo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Zg=0,Jg=1,V9=2,uE=3,Zq=[uE,V9],Jq=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],N2=Symbol("root"),y7=Symbol("child");function Xu(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:N2;if(e!==N2&&e!==y7)throw new Error("The second argument is used internally only and cannot be overwritten.");const t=Array.isArray(n),r=e===N2;let i=Zg;if(t){const s=n[0];n.length===0?i=Jg:r&&s instanceof xv?i=uE:r&&Array.isArray(s)?i=Xu(s,y7):n.length>=2&&n.length<=4&&!n.some((a,l)=>!Jq[l].includes(typeof a))&&(i=V9)}return i}function Kh(n){let{keepDirection:e=!1,propToCol:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Zq.includes(n))throw new Error("Unsupported selection ranges schema type was provided.");return function(r){const i=n===uE;let s=i?r.from.row:r[0],o=i?r.from.col:r[1],a=i?r.to.row:r[2],l=i?r.to.col:r[3];if(typeof t=="function"&&(typeof o=="string"&&(o=t(o)),typeof l=="string"&&(l=t(l))),Qt(a)&&(a=s),Qt(l)&&(l=o),!e){const u=s,c=o,h=a,d=l;s=Math.min(u,h),o=Math.min(c,d),a=Math.max(u,h),l=Math.max(c,d)}return[s,o,a,l]}}function eX(n){const e=Xu(n);if(e===Zg||e===Jg)return[];const t=Kh(e),r=new Set;re(n,o=>{const[,a,,l]=t(o),u=Math.max(a,0),c=l-u+1;re(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((o,a)=>o-a);return Tr(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function tX(n){const e=Xu(n);if(e===Zg||e===Jg)return[];const t=Kh(e),r=new Set;re(n,o=>{const[a,,l]=t(o),u=Math.max(a,0),c=l-u+1;re(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((o,a)=>o-a);return Tr(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function Mo(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof n=="number"&&n>=0&&n<e}const $d="remove_col";function nX(){return{key:$d,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[,t,,r]=n[0];t-r!==0&&(e=1)}return this.getTranslatedPhrase(Xv,e)},callback(){this.alter("remove_col",eX(this.getSelected()),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed()||!Nl(this))return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const e1="remove_row";function rX(){return{key:e1,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[t,,r]=n[0];t-r!==0&&(e=1)}return this.getTranslatedPhrase(qv,e)},callback(){this.alter("remove_row",tX(this.getSelected()),1,"ContextMenu.removeRow")},disabled(){if(!Nl(this))return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const t1="row_above";function iX(){return{key:t1,name(){return this.getTranslatedPhrase(zv)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",n.row,1,"ContextMenu.rowAbove")},disabled(){return Nl(this)?this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden(){return!this.getSettings().allowInsertRow}}}const n1="row_below";function sX(){return{key:n1,name(){return this.getTranslatedPhrase(Yv)},callback(){const n=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",n.row,1,"ContextMenu.rowBelow")},disabled(){return Nl(this)?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden(){return!this.getSettings().allowInsertRow}}}const qh="no_items";function oX(){return{key:qh,name(){return this.getTranslatedPhrase(Gv)},disabled:!0,isCommand:!1}}const r1="undo";function aX(){return{key:r1,name(){return this.getTranslatedPhrase(Qv)},callback(){this.undo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const lX=[t1,n1,Ud,Bd,Xg,e1,$d,r1,Qg,Vd,Si,ut,qh],uX={[ut]:gq,[qh]:oX,[t1]:iX,[n1]:sX,[Ud]:Kq,[Bd]:qq,[Xg]:jq,[e1]:rX,[$d]:nX,[r1]:aX,[Qg]:Qq,[Vd]:Xq,[Si]:Yq};function $9(){const n={};return ft(uX,(e,t)=>{n[t]=e()}),n}class cX{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.hot=e,this.predefinedItems=$9(),this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,ft(e,(r,i)=>{let s="";r.name===ut?(t[ut]=r,s=ut):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,t[i]=r,s=r.key):(t[r.key]=r,s=r.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return hX(e,this.defaultOrderPattern,this.predefinedItems)}}function hX(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=n;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),dt(i)?ft(i,(s,o)=>{let a=t[typeof s=="string"?s:o];a||(a=s),dt(s)?Un(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),r.push(a)}):re(i,(s,o)=>{let a=t[s];!a&&lX.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),dt(s)&&Un(a,s),a.key===void 0&&(a.key=o),r.push(a))}),r}const W9=cX;class dX{constructor(e,t){const r=zh(t),i=Yu(t);let s,o,a,l,u,c;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,o=s,l=a,s+=r,a+=i):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,o=s-r,l=a-i),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}const fX=dX;var mX=mc,pX=Hr,gX=function(n){if(mX(n)==="Function")return pX(n)},w7=gX,yX=V5,wX=_g,vX=w7(w7.bind),CX=function(n,e){return yX(n),e===void 0?n:wX?vX(n,e):function(){return n.apply(e,arguments)}},EX=TypeError,G9=function(n,e){if(n<e)throw new EX("Not enough arguments");return n},bX=H5,SX=/(?:ipad|iphone|ipod).*applewebkit/i.test(bX),RX=Rr,TX=mc,AX=TX(RX.process)==="process",ui=Rr,xX=Hg,MX=CX,v7=yr,NX=So,z9=Fi,C7=i9,IX=Z5,E7=z5,OX=G9,_X=SX,LX=AX,Gy=ui.setImmediate,zy=ui.clearImmediate,PX=ui.process,I2=ui.Dispatch,DX=ui.Function,b7=ui.MessageChannel,kX=ui.String,O2=0,wh={},S7="onreadystatechange",Xh,Ta,_2,L2;z9(function(){Xh=ui.location});var cE=function(n){if(NX(wh,n)){var e=wh[n];delete wh[n],e()}},P2=function(n){return function(){cE(n)}},R7=function(n){cE(n.data)},T7=function(n){ui.postMessage(kX(n),Xh.protocol+"//"+Xh.host)};(!Gy||!zy)&&(Gy=function(e){OX(arguments.length,1);var t=v7(e)?e:DX(e),r=IX(arguments,1);return wh[++O2]=function(){xX(t,void 0,r)},Ta(O2),O2},zy=function(e){delete wh[e]},LX?Ta=function(n){PX.nextTick(P2(n))}:I2&&I2.now?Ta=function(n){I2.now(P2(n))}:b7&&!_X?(_2=new b7,L2=_2.port2,_2.port1.onmessage=R7,Ta=MX(L2.postMessage,L2)):ui.addEventListener&&v7(ui.postMessage)&&!ui.importScripts&&Xh&&Xh.protocol!=="file:"&&!z9(T7)?(Ta=T7,ui.addEventListener("message",R7,!1)):S7 in E7("script")?Ta=function(n){C7.appendChild(E7("script"))[S7]=function(){C7.removeChild(this),cE(n)}}:Ta=function(n){setTimeout(P2(n),0)});var Y9={set:Gy,clear:zy},FX=Rl,HX=Rr,A7=Y9.clear;FX({global:!0,bind:!0,enumerable:!0,forced:HX.clearImmediate!==A7},{clearImmediate:A7});var UX=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",j9=Rr,BX=Hg,VX=yr,$X=UX,WX=H5,GX=Z5,zX=G9,YX=j9.Function,jX=/MSIE .\./.test(WX)||$X&&function(){var n=j9.Bun.version.split(".");return n.length<3||n[0]==="0"&&(n[1]<3||n[1]==="3"&&n[2]==="0")}(),KX=function(n,e){var t=e?2:1;return jX?function(r,i){var s=zX(arguments.length,1)>t,o=VX(r)?r:YX(r),a=s?GX(arguments,t):[],l=s?function(){BX(o,this,a)}:o;return e?n(l,i):n(l)}:n},qX=Rl,K9=Rr,x7=Y9.set,XX=KX,M7=K9.setImmediate?XX(x7,!1):x7;qX({global:!0,bind:!0,enumerable:!0,forced:K9.setImmediate!==M7},{setImmediate:M7});const q9={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},QX=new RegExp(Object.keys(q9).map(n=>`(${n})`).join("|"),"gi");function ZX(n){return(n&&n.nodeName||"")==="TABLE"}function N7(n){const e=n.hasColHeaders(),t=n.hasRowHeaders(),r=[e?-1:0,t?-1:0,n.countRows()-1,n.countCols()-1],i=n.getData(...r),s=i.length,o=s>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=t?1:0,h=e?1:0;for(let d=0;d<s;d+=1){const f=e&&d===0,m=[];for(let y=0;y<o;y+=1){const C=!f&&t&&y===0;let b="";if(f)b=`<th>${n.getColHeader(y-c)}</th>`;else if(C)b=`<th>${n.getRowHeader(d-h)}</th>`;else{const v=i[d][y],{hidden:S,rowspan:L,colspan:_}=n.getCellMeta(d-h,y-c);if(!S){const P=[];if(L&&P.push(`rowspan="${L}"`),_&&P.push(`colspan="${_}"`),zn(v))b=`<td ${P.join(" ")}></td>`;else{const x=v.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b=`<td ${P.join(" ")}>${x}</td>`}}}m.push(b)}const p=["<tr>",...m,"</tr>"].join("");f?l.splice(1,0,p):u.splice(-1,0,p)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function I7(n){const e=n.length,t=["<table>"];for(let r=0;r<e;r+=1){const i=n[r],s=i.length,o=[];r===0&&t.push("<tbody>");for(let a=0;a<s;a+=1){const l=i[a],u=zn(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${u}</td>`)}t.push("<tr>",...o,"</tr>"),r+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function JX(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const t={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let s=n;if(typeof s=="string"){const v=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,S=>{const L=S.match(/<td\b[^>]*?>/g)[0],_=S.substring(L.length,S.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${L}${_}</td>`});i.insertAdjacentHTML("afterbegin",`${v}`),s=i.querySelector("table")}if(!s||!ZX(s))return;const o=i.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,l=s.querySelector("tr"),u=l?Array.from(l.cells).reduce((v,S)=>v+S.colSpan,0)-(a?1:0):0,c=s.tFoot&&Array.from(s.tFoot.rows)||[],h=[];let d=!1,f=0,m=0;if(s.tHead){const v=Array.from(s.tHead.rows).filter(S=>{const L=S.querySelector("td")!==null;return L&&h.push(S),!L});f=v.length,d=f>0,f>1?t.nestedHeaders=Array.from(v).reduce((S,L)=>{const _=Array.from(L.cells).reduce((P,x,I)=>{if(a&&I===0)return P;const{colSpan:R,innerHTML:N}=x,H=R>1?{label:N,colspan:R}:N;return P.push(H),P},[]);return S.push(_),S},[]):d&&(t.colHeaders=Array.from(v[0].children).reduce((S,L,_)=>(a&&_===0||S.push(L.innerHTML),S),[]))}h.length&&(t.fixedRowsTop=h.length),c.length&&(t.fixedRowsBottom=c.length);const p=[...h,...Array.from(s.tBodies).reduce((v,S)=>(v.push(...Array.from(S.rows)),v),[]),...c];m=p.length;const y=new Array(m);for(let v=0;v<m;v++)y[v]=new Array(u);const C=[],b=[];for(let v=0;v<m;v++){const S=p[v],L=Array.from(S.cells),_=L.length;for(let P=0;P<_;P++){const x=L[P],{nodeName:I,innerHTML:R,rowSpan:N,colSpan:H}=x,K=y[v].findIndex(X=>X===void 0);if(I==="TD"){if(N>1||H>1){for(let se=v;se<v+N;se++)if(se<m)for(let O=K;O<K+H;O++)y[se][O]=null;const J=x.getAttribute("style");J&&J.includes("mso-ignore:colspan")||C.push({col:K,row:v,rowspan:N,colspan:H})}let X="";o&&/excel/gi.test(o.content)?X=R.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):X=R.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[v][K]=X.replace(QX,J=>q9[J])}else b.push(R)}}return C.length&&(t.mergeCells=C),b.length&&(t.rowHeaders=b),y.length&&(t.data=y),t}function O7(n){let{isShiftKey:e,isLeftClick:t,isRightClick:r,coords:i,selection:s,controller:o,cellCoordsFactory:a}=n;const l=s.isSelected()?s.getSelectedRange().current():null,u=s.isSelectedByCorner(),c=s.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!o.column?s.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!o.row?s.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!s.inInSelection(i),d=t||r&&h;i.row<0&&i.col>=0&&!o.column?d&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?d&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?d&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0)}}function eQ(n){let{isLeftClick:e,coords:t,selection:r,controller:i,cellCoordsFactory:s}=n;if(!e)return;const o=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(s(u-1,t.col)):o&&!i.row?r.setRangeEnd(s(t.row,l-1)):i.cell||r.setRangeEnd(t)}const tQ=new Map([["mousedown",O7],["mouseover",eQ],["touchstart",O7]]);function _7(n,e){let{coords:t,selection:r,controller:i,cellCoordsFactory:s}=e;tQ.get(n.type)({coords:t,selection:r,controller:i,cellCoordsFactory:s,isShiftKey:n.shiftKey,isLeftClick:tv(n)||n.type==="touchstart",isRightClick:sl(n)})}const X9=new WeakMap,hE=Symbol("rootInstance");function nQ(n){X9.set(n,!0)}function rQ(n){return n===hE}function Yy(n){return X9.has(n)}function L7(n,e,t){iQ(n,e),e.set(n,t)}function iQ(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function No(n,e,t){return e=sQ(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sQ(n){var e=oQ(n,"string");return typeof e=="symbol"?e:String(e)}function oQ(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function P7(n,e){var t=Q9(n,e,"get");return aQ(n,t)}function aQ(n,e){return e.get?e.get.call(n):e.value}function D7(n,e,t){var r=Q9(n,e,"set");return lQ(n,r,t),t}function Q9(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function lQ(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const Aa=new WeakMap;var D2=new WeakMap,k2=new WeakMap;class uQ{constructor(e){No(this,"instance",void 0),No(this,"eventManager",void 0),No(this,"settings",void 0),No(this,"THEAD",void 0),No(this,"TBODY",void 0),No(this,"_wt",void 0),No(this,"activeWt",void 0),L7(this,D2,{writable:!0,value:0}),L7(this,k2,{writable:!0,value:0}),No(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new dn(this.instance),this.settings=this.instance.getSettings(),Aa.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,t){const r=this._wt.getCell(e,t);return r<0?null:r}scrollViewport(e,t,r,i,s){return this._wt.scrollViewport(e,t,r,i,s)}scrollViewportHorizontally(e,t,r){return this._wt.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return this._wt.scrollViewportVertically(e,t,r)}createElements(){const e=Aa.get(this),{rootElement:t,rootDocument:r}=this.instance,i=t.getAttribute("style");i&&t.setAttribute("data-originalstyle",i),Ae(t,"handsontable"),e.table=r.createElement("TABLE"),Ae(e.table,"htCore"),this.instance.getSettings().tableClassName&&Ae(e.table,this.instance.getSettings().tableClassName),this.THEAD=r.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}registerEvents(){const e=Aa.get(this),{rootElement:t,rootDocument:r,selection:i}=this.instance,s=r.documentElement;this.eventManager.addEventListener(t,"mousedown",o=>{if(e.selectionMouseDown=!0,!this.isTextSelectionAllowed(o.target)){const{rootWindow:a}=this.instance;IR(a),o.preventDefault(),a.focus()}}),this.eventManager.addEventListener(t,"mouseup",()=>{e.selectionMouseDown=!1}),this.eventManager.addEventListener(t,"mousemove",o=>{e.selectionMouseDown&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&IR(this.instance.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(s,"keyup",o=>{i.isInProgress()&&!o.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",o=>{i.isInProgress()&&tv(o)&&i.finish(),e.mouseDown=!1,(iv(r.activeElement)||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!t.contains(o.target)&&!sl(o))&&this.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",o=>{i.isInProgress()&&sl(o)&&(i.finish(),e.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),e.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",o=>{const a=o.target,l=o.x||o.clientX,u=o.y||o.clientY;let c=o.target;if(e.mouseDown||!t||!this.instance.view)return;const{holder:h}=this.instance.view._wt.wtTable;if(c===h){const f=er(r);if(r.elementFromPoint(l+f,u)!==h||r.elementFromPoint(l,u+f)!==h)return}else for(;c!==s;){if(c===null){if(o.isTargetWebComponent)break;return}if(c===t)return;c=c.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(a):this.settings.outsideClickDeselects)?this.instance.deselectCell():this.instance.destroyEditor(!1,!1)}),this.eventManager.addEventListener(e.table,"selectstart",o=>{this.settings.fragmentSelection||dp(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:r}=e;return this.instance._createCellCoords(...this.translateFromRenderableToVisualIndex(t,r))}translateFromRenderableToVisualIndex(e,t){let r=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return r===null&&(r=e),i===null&&(i=t),[r,i]}countRenderableIndexes(e,t){const r=Math.min(e.getNotTrimmedIndexesLength(),t),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,r,i){if(isNaN(e)||e<0)return 0;const s=r.getNearestNotHiddenIndex(e,t),o=r.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return t<0?a=o+1:t>0&&(a=i-o),a}countNotHiddenFixedColumnsStart(){const e=this.instance.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.instance.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.instance.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>t}initializeWalkontable(){const e=Aa.get(this),t={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e.table,isDataViewInstance:()=>Yy(this.instance),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,a)=>this.instance.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,a)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const o=[];return this.instance.hasRowHeaders()&&o.push((a,l)=>{const u=a>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(a):a;this.appendRowHeader(u,l)}),this.instance.runHooks("afterGetRowHeaderRenderers",o),D7(this,k2,o.length),o},columnHeaders:()=>{const o=[];return this.instance.hasColHeaders()&&o.push((a,l)=>{const u=a>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(a):a;this.appendColHeader(u,l)}),this.instance.runHooks("afterGetColumnHeaderRenderers",o),D7(this,D2,o.length),o},columnWidth:o=>{const a=this.instance.columnIndexMapper.getVisualFromRenderableIndex(o);return this.instance.getColWidth(a===null?o:a)},rowHeight:o=>{const a=this.instance.rowIndexMapper.getVisualFromRenderableIndex(o);return this.instance.getRowHeight(a===null?o:a)},cellRenderer:(o,a,l)=>{const[u,c]=this.translateFromRenderableToVisualIndex(o,a),h=this.instance.runHooks("modifyGetCellCoords",u,c);let d=u,f=c;Array.isArray(h)&&([d,f]=h);const m=this.instance.getCellMeta(d,f),p=this.instance.colToProp(f);let y=this.instance.getDataAtRowProp(d,p);this.instance.hasHook("beforeValueRender")&&(y=this.instance.runHooks("beforeValueRender",y,m)),this.instance.runHooks("beforeRenderer",l,u,c,p,y,m),this.instance.getCellRenderer(m)(this.instance,l,u,c,p,y,m),this.instance.runHooks("afterRenderer",l,u,c,p,y,m)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onContainerElementResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onCellMouseDown:(o,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a),h={row:!1,column:!1,cell:!1};this.instance.listen(),this.activeWt=u,e.mouseDown=!0,this.instance.runHooks("beforeOnCellMouseDown",o,c,l,h),!pu(o)&&(_7(o,{coords:c,selection:this.instance.selection,controller:h,cellCoordsFactory:(d,f)=>this.instance._createCellCoords(d,f)}),this.instance.runHooks("afterOnCellMouseDown",o,c,l),this.activeWt=this._wt)},onCellContextMenu:(o,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,e.mouseDown=!1,this.instance.selection.isInProgress()&&this.instance.selection.finish(),this.instance.runHooks("beforeOnCellContextMenu",o,c,l),!pu(o)&&(this.instance.runHooks("afterOnCellContextMenu",o,c,l),this.activeWt=this._wt)},onCellMouseOut:(o,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,this.instance.runHooks("beforeOnCellMouseOut",o,c,l),!pu(o)&&(this.instance.runHooks("afterOnCellMouseOut",o,c,l),this.activeWt=this._wt)},onCellMouseOver:(o,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a),h={row:!1,column:!1,cell:!1};this.activeWt=u,this.instance.runHooks("beforeOnCellMouseOver",o,c,l,h),!pu(o)&&(e.mouseDown&&_7(o,{coords:c,selection:this.instance.selection,controller:h,cellCoordsFactory:(d,f)=>this.instance._createCellCoords(d,f)}),this.instance.runHooks("afterOnCellMouseOver",o,c,l),this.activeWt=this._wt)},onCellMouseUp:(o,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,this.instance.runHooks("beforeOnCellMouseUp",o,c,l),!(pu(o)||this.instance.isDestroyed)&&(this.instance.runHooks("afterOnCellMouseUp",o,c,l),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.instance.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.instance.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,a)=>this.beforeRender(o,a),onDraw:o=>this.afterRender(o),onScrollVertically:()=>this.instance.runHooks("afterScrollVertically"),onScrollHorizontally:()=>this.instance.runHooks("afterScrollHorizontally"),onBeforeRemoveCellClassNames:()=>this.instance.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,a,l)=>{const u=this.instance.rowIndexMapper,c=u.getVisualFromRenderableIndex(o),h=this.instance.runHooks("beforeHighlightingRowHeader",c,a,l);return u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,a,l)=>{const u=this.instance.columnIndexMapper,c=u.getVisualFromRenderableIndex(o),h=this.instance.runHooks("beforeHighlightingColumnHeader",c,a,l);return u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,a,l)=>{let u;const[c,h]=this.translateFromRenderableToVisualIndex(o,a),d=this.instance.selection.getSelectedRange(),f=d.size();if(f>0){const m=(l!=null?l:0)+1-f,p=d.peekByIndex(m);u=[p.from.row,p.from.col,p.to.row,p.to.col]}return this.instance.runHooks("afterDrawSelection",c,h,u,l)},onBeforeDrawBorders:(o,a)=>{const[l,u,c,h]=o,d=[this.instance.rowIndexMapper.getVisualFromRenderableIndex(l),this.instance.columnIndexMapper.getVisualFromRenderableIndex(u),this.instance.rowIndexMapper.getVisualFromRenderableIndex(c),this.instance.columnIndexMapper.getVisualFromRenderableIndex(h)];return this.instance.runHooks("beforeDrawBorders",d,a)},onBeforeTouchScroll:()=>this.instance.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.instance.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,a)=>{const l=this.instance.columnIndexMapper.getVisualFromRenderableIndex(a);return this.instance.runHooks("beforeStretchingColumnWidth",o,l)},onModifyRowHeaderWidth:o=>this.instance.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,a,l)=>{const u=this.instance.rowIndexMapper,c=this.instance.columnIndexMapper,h=a>=0?c.getVisualFromRenderableIndex(a):a,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.instance.runHooks("modifyGetCellCoords",d,h,l);if(Array.isArray(f)){const[m,p,y,C]=f;return[m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,p>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(p,1)):p,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y,C>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(C,-1)):C]}},viewportRowCalculatorOverride:o=>{let a=this.settings.viewportRowRenderingOffset;if(a==="auto"&&this.settings.fixedRowsTop&&(a=10),a>0||a==="auto"){const l=this.countRenderableRows(),u=o.startRow,c=o.endRow;if(typeof a=="number")o.startRow=Math.max(u-a,0),o.endRow=Math.min(c+a,l-1);else if(a==="auto"){const h=Math.ceil(c/l*12);o.startRow=Math.max(u-h,0),o.endRow=Math.min(c+h,l-1)}}this.instance.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let a=this.settings.viewportColumnRenderingOffset;if(a==="auto"&&this.settings.fixedColumnsStart&&(a=10),a>0||a==="auto"){const l=this.countRenderableColumns(),u=o.startColumn,c=o.endColumn;if(typeof a=="number"&&(o.startColumn=Math.max(u-a,0),o.endColumn=Math.min(c+a,l-1)),a==="auto"){const h=Math.ceil(c/l*6);o.startColumn=Math.max(u-h,0),o.endColumn=Math.min(c+h,l-1)}}this.instance.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.instance.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.instance.runHooks("beforeInitWalkontable",t),this._wt=new Fv(t),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:i,height:s}=this.instance.rootElement.getBoundingClientRect();this.setLastSize(i,s),this.eventManager.addEventListener(r,"mousedown",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.instance.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(dp(e))return!0;const t=tl(e,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Aa.get(this).mouseDown}isSelectedOnlyCell(){var e,t;return(e=(t=this.instance.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.instance.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,t)}afterRender(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const r=t.firstChild;if(!Je(r,"relative")){ks(t),this.appendRowHeader(e,t);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.instance,s=r.createElement("div"),o=r.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,i),s.appendChild(o),t.appendChild(s)}this.instance.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(t.firstChild){const s=t.firstChild;Je(s,"relative")?this.updateCellHeader(s.querySelector(".colHeader"),e,r,i):(ks(t),this.appendColHeader(e,t,r,i))}else{const{rootDocument:s}=this.instance,o=s.createElement("div"),a=s.createElement("span");o.className="relative",a.className="colHeader",this.updateCellHeader(a,e,r,i),o.appendChild(a),t.appendChild(o)}this.instance.runHooks("afterGetColHeader",e,t,i)}updateCellHeader(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=t;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Je(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(t):Je(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(t))),s>-1?pc(e,r(t,i)):(ol(e,String.fromCharCode(160)),Ae(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,t){const r=Aa.get(this);[r.lastWidth,r.lastHeight]=[e,t]}getLastSize(){const e=Aa.get(this);return{width:e.lastWidth,height:e.lastHeight}}getFirstFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return P7(this,D2)}getRowHeadersCount(){return P7(this,k2)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}const cQ=uQ,hQ="ABCDEFGHIJKLMNOPQRSTUVWXYZ",k7=hQ.length;function dQ(n){let e=n+1,t="",r;for(;e>0;)r=(e-1)%k7,t=String.fromCharCode(65+r)+t,e=parseInt((e-r)/k7,10);return t}function F7(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=n;const r=[];return(!Array.isArray(n)||!Array.isArray(n[0]))&&(t=[n]),t.forEach((i,s)=>{Array.isArray(i)?i.forEach((o,a)=>{r.push([s+e,a,o])}):Object.keys(i).forEach(o=>{r.push([s+e,o,i[o]])})}),r}function Z9(n){let e=0;return Array.isArray(n)&&(n[0]&&Array.isArray(n[0])?e=n[0].length:n[0]&&dt(n[0])&&(e=ev(n[0]))),e}function fQ(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>Array.isArray(e)))}function mQ(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}class pQ{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.hot=e,this.data=t,this.dataType="array",this.colToProp=()=>{},this.propToCol=()=>{}}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return re(this.data,(r,i)=>{const s=this.getAtCell(i,e);t.push(s)}),t}getAtRow(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=t===void 0&&r===void 0;let o=null,a=null;if(o=this.modifyRowData(e),Array.isArray(o))a=[],s?o.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,o)}):ze(t,r,l=>{a[l-t]=this.getAtPhysicalCell(e,l,o)});else if(dt(o)||qt(o))if(i?a=[]:a={},!s||i){const u=this.countFirstRowKeys()-1;ze(0,u,c=>{const h=this.colToProp(c);if(c>=(t||0)&&c<=(r||u)&&!Number.isInteger(h)){const d=this.getAtPhysicalCell(e,h,o);i?a.push(d):n2(a,h,d)}})}else ft(o,(l,u)=>{n2(a,u,this.getAtPhysicalCell(e,u,o))});return a}setAtCell(e,t,r){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=zu(r);this.hot.runHooks("modifySourceData",e,t,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(t)?this.data[e][t]=r:n2(this.data[e],t,r)}}getAtPhysicalCell(e,t,r){let i=null;if(r&&(typeof t=="string"?i=rW(r,t):typeof t=="function"?i=t(r):i=r[t]),this.hot.hasHook("modifySourceData")){const s=zu(i);this.hot.runHooks("modifySourceData",e,t,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,t){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,o=null,a=null,l=null;e===null||t===null?(i=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,t.row),o=Math.min(e.col,t.col),a=Math.max(e.row,t.row),l=Math.max(e.col,t.col));const u=[];return ze(s,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,o,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return Z9(this.data)}destroy(){this.data=null,this.hot=null}}const gQ=pQ;function yQ(n,e){return ft(e,(t,r)=>{Qt(n[r])&&(n[r]=t)}),n}function J9(n){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(n);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:n}function eM(n){De(n)&&sv(Vt`Language with code "${n}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function wQ(n,e){return Array.isArray(n)&&Number.isInteger(e)?n[e]:n}const{register:vQ,getValues:CQ}=Hi("phraseFormatters");function EQ(n,e){vQ(n,e)}function bQ(){return CQ()}EQ("pluralize",wQ);/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const SQ={languageCode:"en-US",[Gv]:"No available options",[zv]:"Insert row above",[Yv]:"Insert row below",[jv]:"Insert column left",[Kv]:"Insert column right",[qv]:["Remove row","Remove rows"],[Xv]:["Remove column","Remove columns"],[Qv]:"Undo",[Zv]:"Redo",[Jv]:"Read only",[eC]:"Clear column",[mC]:"Alignment",[pC]:"Left",[gC]:"Center",[yC]:"Right",[wC]:"Justify",[vC]:"Top",[CC]:"Middle",[EC]:"Bottom",[oC]:"Freeze column",[aC]:"Unfreeze column",[bC]:"Borders",[SC]:"Top",[RC]:"Right",[TC]:"Bottom",[AC]:"Left",[xC]:"Remove border(s)",[cC]:"Add comment",[hC]:"Edit comment",[dC]:"Delete comment",[fC]:"Read-only comment",[lC]:"Merge cells",[uC]:"Unmerge cells",[tC]:"Copy",[nC]:["Copy with header","Copy with headers"],[rC]:["Copy with group header","Copy with group headers"],[iC]:["Copy header only","Copy headers only"],[sC]:"Cut",[MC]:"Insert child row",[NC]:"Detach from parent",[IC]:["Hide column","Hide columns"],[OC]:["Show column","Show columns"],[_C]:["Hide row","Hide rows"],[LC]:["Show row","Show rows"],[Kg]:"None",[PC]:"Is empty",[DC]:"Is not empty",[kC]:"Is equal to",[FC]:"Is not equal to",[HC]:"Begins with",[UC]:"Ends with",[BC]:"Contains",[VC]:"Does not contain",[$C]:"Greater than",[WC]:"Greater than or equal to",[GC]:"Less than",[zC]:"Less than or equal to",[YC]:"Is between",[jC]:"Is not between",[KC]:"After",[qC]:"Before",[XC]:"Today",[QC]:"Tomorrow",[ZC]:"Yesterday",[vp]:"Blank cells",[JC]:"Filter by condition",[eE]:"Filter by value",[tE]:"And",[qg]:"Or",[nE]:"Select all",[rE]:"Clear",[iE]:"OK",[sE]:"Cancel",[oE]:"Search",[aE]:"Value",[lE]:"Second value"},tM=SQ,RQ=Iq,jy=tM.languageCode,{register:TQ,getItem:nM,hasItem:AQ,getValues:xQ}=Hi("languagesDictionaries");rM(tM);function rM(n,e){let t=n,r=e;return dt(n)&&(r=n,t=r.languageCode),MQ(t,r),TQ(t,kr(r)),kr(r)}function MQ(n,e){n!==jy&&yQ(e,nM(jy))}function iM(n){return dE(n)?kr(nM(n)):null}function dE(n){return AQ(n)}function NQ(){return xQ()}function sM(n,e,t){const r=iM(n);if(r===null)return null;const i=r[e];if(Qt(i))return null;const s=IQ(i,t);return Array.isArray(s)?s[0]:s}function IQ(n,e){let t=n;return re(bQ(),r=>{t=r(n,e)}),t}function OQ(n){let e=J9(n);return dE(e)||(e=jy,eM(n)),e}const i1="active-header",s1="area",Qh="cell",fE="fill",Wd="header",mE="custom-selection";function _Q(n,e,t){return e=LQ(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function LQ(n){var e=PQ(n,"string");return typeof e=="symbol"?e:String(e)}function PQ(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class DQ extends jj{constructor(e,t){super(e,null),_Q(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:r}=e,i=this.getNearestNotHiddenCoords(t,1),s=this.getNearestNotHiddenCoords(r,-1);if(i===null||s===null)return null;if(i.row>s.row||i.col>s.col){if(!(this.settings.type==="header"||this.settings.type==="active-header"))return null;i=t,s=r}return this.settings.createCellRange(i,i,s)}getNearestNotHiddenCoords(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),e.row,t);if(i===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),e.col,r);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,t,r){if(t<0)return t;const i=e.getNearestNotHiddenIndex(t,r);return(this.settings.type==="header"||this.settings.type==="active-header")&&i===null?-1:i}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,i=this.getNearestNotHiddenCoords(e.from.clone().normalize(),t,r);if(i!==null&&e.overlaps(i)){if(this.cellRange===null){const s=this.settings.visualToRenderableCoords(i);this.cellRange=this.settings.createCellRange(s)}return e.setHighlight(i),this}return e.setHighlight(e.from),this}getCorners(){const{from:e,to:t}=this.cellRange,r=e.row===null||t.row===null,i=e.col===null||t.col===null,s=this.settings.createCellCoords(r?null:Math.min(e.row,t.row),i?null:Math.min(e.col,t.col)),o=this.settings.createCellCoords(r?null:Math.max(e.row,t.row),i?null:Math.max(e.col,t.col));return[s.row,s.col,o.row,o.col]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(t);return this.settings.createCellRange(r,r,i)}}const vc=DQ;function kQ(n){let{activeHeaderClassName:e,...t}=n;return new vc({highlightHeaderClassName:e,...t,selectionType:i1})}function FQ(n){let{layerLevel:e,areaCornerVisible:t,...r}=n;return new vc({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:t},...r,selectionType:s1})}function HQ(n){let{cellCornerVisible:e,...t}=n;return new vc({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e},...t,selectionType:Qh})}function UQ(n){let{border:e,visualCellRange:t,...r}=n;return new vc({...e,...r,selectionType:mE},t)}function BQ(n){let{...e}=n;return new vc({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:fE})}function VQ(n){let{headerClassName:e,rowClassName:t,columnClassName:r,...i}=n;return new vc({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:t,highlightColumnClassName:r,...i,highlightOnlyClosestHeader:!0,selectionType:Wd})}const{register:Cc,getItem:$Q}=Hi("highlight/types");Cc(i1,kQ);Cc(s1,FQ);Cc(Qh,HQ);Cc(mE,UQ);Cc(fE,BQ);Cc(Wd,VQ);function Yl(n,e){return $Q(n)({type:n,...e})}class WQ{constructor(e){this.options=e,this.layerLevel=0,this.cell=Yl(Qh,e),this.fill=Yl(fE,e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}isEnabledFor(e,t){let r=e;e===Qh&&(r="current");let i=this.options.disabledCellSelection(t.row,t.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getCell(){return this.cell}getFill(){return this.fill}createOrGetArea(){const e=this.layerLevel;let t;return this.areas.has(e)?t=this.areas.get(e):(t=Yl(s1,{layerLevel:e,...this.options}),this.areas.set(e,t)),t}getAreas(){return[...this.areas.values()]}createOrGetHeader(){const e=this.layerLevel;let t;return this.headers.has(e)?t=this.headers.get(e):(t=Yl(Wd,{...this.options}),this.headers.set(e,t)),t}getHeaders(){return[...this.headers.values()]}createOrGetActiveHeader(){const e=this.layerLevel;let t;return this.activeHeaders.has(e)?t=this.activeHeaders.get(e):(t=Yl(i1,{...this.options}),this.activeHeaders.set(e,t)),t}getActiveHeaders(){return[...this.activeHeaders.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(Yl(mE,{...this.options,...e}))}clear(){this.cell.clear(),this.fill.clear(),re(this.areas.values(),e=>void e.clear()),re(this.headers.values(),e=>void e.clear()),re(this.activeHeaders.values(),e=>void e.clear())}[Symbol.iterator](){return[this.cell,this.fill,...this.areas.values(),...this.headers.values(),...this.activeHeaders.values(),...this.customSelections][Symbol.iterator]()}}const GQ=WQ;class zQ{constructor(e){this.ranges=[],this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(0)}previous(){return this.peekByIndex(-1)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const t=this.size()+e-1;let r;return t>=0&&(r=this.ranges[t]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const YQ=zQ;class oM{constructor(e,t){this.range=e,this.options=t}transformStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.options.createCellCoords(e,t),s=this.range.current().highlight,{row:o,col:a}=this.options.visualToRenderableCoords(s);let l=s,u=0,c=0;if(this.runLocalHooks("beforeTransformStart",i),o!==null&&a!==null){let h=this.options.countRows(),d=this.options.countCols();const f=this.options.fixedRowsBottom(),m=this.options.minSpareRows(),p=this.options.minSpareCols(),y=this.options.autoWrapRow(),C=this.options.autoWrapCol();o+e>h-1?r&&m>0&&!(f&&o>=h-f-1)?(this.runLocalHooks("insertRowRequire",h),h=this.options.countRows()):C&&(i.row=1-h,i.col=a+i.col===d-1?1-d:1):C&&o+i.row<0&&a+i.col>=0&&(i.row=h-1,i.col=a+i.col===0?d-1:-1),a+i.col>d-1?r&&p>0?(this.runLocalHooks("insertColRequire",d),d=this.options.countCols()):y&&(i.row=o+i.row===h-1?1-h:1,i.col=1-d):y&&a+i.col<0&&o+i.row>=0&&(i.row=o+i.row===0?h-1:-1,i.col=d-1);const b=this.options.createCellCoords(o+i.row,a+i.col);u=0,c=0,b.row<0?(u=-1,b.row=0):b.row>0&&b.row>=h&&(u=1,b.row=h-1),b.col<0?(c=-1,b.col=0):b.col>0&&b.col>=d&&(c=1,b.col=d-1),l=this.options.renderableToVisualCoords(b)}return this.runLocalHooks("afterTransformStart",l,u,c),l}transformEnd(e,t){const r=this.options.createCellCoords(e,t),i=this.range.current();let s=i.to,o=0,a=0;this.runLocalHooks("beforeTransformEnd",r);const{row:l,col:u}=this.options.visualToRenderableCoords(i.highlight);if(l!==null&&u!==null){const c=this.options.countRows(),h=this.options.countCols(),{row:d,col:f}=this.options.visualToRenderableCoords(i.to),m=this.options.createCellCoords(d+r.row,f+r.col);o=0,a=0,m.row<0?(o=-1,m.row=0):m.row>0&&m.row>=c&&(o=1,m.row=c-1),m.col<0?(a=-1,m.col=0):m.col>0&&m.col>=h&&(a=1,m.col=h-1),s=this.options.renderableToVisualCoords(m)}return this.runLocalHooks("afterTransformEnd",s,o,a),s}}Yt(oM,ni);const jQ=oM;class aM{constructor(e,t){var r=this;this.settings=e,this.tableProps=t,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new YQ((i,s,o)=>this.tableProps.createCellRange(i,s,o)),this.highlight=new GQ({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,o)=>this.tableProps.createCellRange(i,s,o),rowIndexMapper:()=>this.tableProps.rowIndexMapper(),columnIndexMapper:()=>this.tableProps.columnIndexMapper()}),this.transformation=new jQ(this.selectedRange,{countRows:()=>this.tableProps.countRowsTranslated(),countCols:()=>this.tableProps.countColsTranslated(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformStart",...s)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformStart",...s)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformEnd",...s)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("afterModifyTransformEnd",...s)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("insertRowRequire",...s)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r.runLocalHooks("insertColRequire",...s)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.settings.selectionMode==="multiple",s=Qt(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,o=e.row<0,a=e.col<0,l=o&&a,u=e.clone();this.selectedByCorner=l,this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,u),(!i||i&&!s&&Qt(t))&&this.selectedRange.clear(),this.selectedRange.add(u),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!l&&a&&this.selectedByRowHeader.add(this.getLayerLevel()),!l&&o&&this.selectedByColumnHeader.add(this.getLayerLevel()),r||this.setRangeEnd(e)}setRangeStartOnly(e,t){this.setRangeStart(e,t,!0)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone();this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const r=this.selectedRange.current();this.settings.selectionMode!=="single"&&r.setTo(this.tableProps.createCellCoords(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Qh,r.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(r);const i=this.getLayerLevel();i<this.highlight.layerLevel&&(re(this.highlight.getAreas(),l=>void l.clear()),re(this.highlight.getHeaders(),l=>void l.clear()),re(this.highlight.getActiveHeaders(),l=>void l.clear())),this.highlight.useLayerLevel(i);const s=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();if(s.clear(),o.clear(),a.clear(),this.highlight.isEnabledFor(s1,r.highlight)&&(this.isMultiple()||i>=1)&&(s.add(r.from).add(r.to).commit(),i===1)){const l=this.selectedRange.previous();this.highlight.useLayerLevel(i-1).createOrGetArea().add(l.from).commit().syncWith(l),this.highlight.useLayerLevel(i)}if(this.highlight.isEnabledFor(Wd,r.highlight)){const l=this.tableProps.countRowsTranslated()===0,u=this.tableProps.countColsTranslated()===0;let c=r;(l||u)&&(c=r.clone()),l&&(c.from.row=-1),u&&(c.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&c.from.normalize(),o.add(c.from).commit()):o.add(c.from).add(c.to).commit(),this.isEntireRowSelected()&&this.tableProps.countCols()===r.getWidth()&&a.add(this.tableProps.createCellCoords(r.from.row,-1)).add(this.tableProps.createCellCoords(r.to.row,-1)).commit(),this.isEntireColumnSelected()&&this.tableProps.countRows()===r.getHeight()&&a.add(this.tableProps.createCellCoords(-1,r.from.col)).add(this.tableProps.createCellCoords(-1,r.to.col)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=zu(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,t,r))}transformEnd(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByCorner}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){!this.isSelected()||(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.tableProps.countRows(),i=this.tableProps.countCols();if(!e&&!t&&(r===0||i===0))return;const s=this.tableProps.createCellCoords(t?-1:0,e?-1:0),o=this.tableProps.createCellCoords(r-1,i-1);this.clear(),this.setRangeStartOnly(s),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(o),this.finish()}selectCells(e){const t=Xu(e);if(t===Jg)return!1;if(t===Zg)throw new Error(Vt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=Kh(t,{propToCol:a=>this.tableProps.propToCol(a),keepDirection:!0}),i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=!e.some(a=>{const[l,u,c,h]=r(a);return!(Mo(l,i)&&Mo(u,s)&&Mo(c,i)&&Mo(h,s))});return o&&(this.clear(),re(e,a=>{const[l,u,c,h]=r(a);this.setRangeStartOnly(this.tableProps.createCellCoords(l,u),!1),this.setRangeEnd(this.tableProps.createCellCoords(c,h)),this.finish()})),o}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;const i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof t=="string"?this.tableProps.propToCol(t):t,o=this.tableProps.countCols(),a=this.tableProps.countRows(),l=Mo(i,o)&&Mo(s,o);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,i)),this.setRangeEnd(this.tableProps.createCellCoords(a-1,s)),this.finish()),l}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;const i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=Mo(e,i)&&Mo(t,i);return o&&(this.setRangeStartOnly(this.tableProps.createCellCoords(e,r)),this.setRangeEnd(this.tableProps.createCellCoords(t,s-1)),this.finish()),o}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const t=this.highlight.getCell(),r=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const s=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();s.commit(),o.commit(),a.commit()}this.highlight.useLayerLevel(r)}}Yt(aM,ni);const KQ=aM,H7=/^(\r\n|\n\r|\r|\n)/,qQ=/^[^\t\r\n]+/,U7=/^\t/;function XQ(n){const e=[[""]];if(n.length===0)return e;let t=0,r=0,i;for(;n.length>0&&i!==n.length;)if(i=n.length,n.match(U7))n=n.replace(U7,""),t+=1,e[r][t]="";else if(n.match(H7))n=n.replace(H7,""),t=0,r+=1,e[r]=[""];else{let s="";if(n.startsWith('"')){let o=0,a=!0;for(;a;){const l=n.slice(0,1);l==='"'&&(o+=1),s+=l,n=n.slice(1),(n.length===0||n.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const o=n.match(qQ);s=o?o[0]:"",n=n.slice(s.length)}e[r][t]=s}return e}function vh(n){let e,t,r,i,s="",o;for(e=0,t=n.length;e<t;e+=1){for(i=n[e].length,r=0;r<i;r+=1)r>0&&(s+="	"),o=n[e][r],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==t-1&&(s+=`
`)}return s}class Tu{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,r){this.instance=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,t){let i=0,s=0,o=!1;if(typeof t=="function"){const a=ev(e);i=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,t.length)}for(r=0;r<i;r++){const a=o?t(r):t[r];if(dt(a)){if(typeof a.data<"u"){const l=o?s:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return Z9(this.dataSource)}recursiveDuckColumns(e,t,r){let i=t,s=r,o;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&ft(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const t=this.instance.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&De(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(De(t))return this.instance.toVisualColumn(t);const r=this.instance.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?$h(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.instance.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.instance.countRows()&&(o=this.instance.toPhysicalRow(l)),this.instance.runHooks("beforeCreateRow",l,t,r)===!1||o===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<t&&s+a<c;){let m=null;this.instance.dataType==="array"?this.tableMeta.dataSchema?m=kr(this.getSchema()):(m=[],ze(h-1,()=>m.push(null))):this.instance.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},Ug(m,this.getSchema())),d.push(m),a+=1}this.instance.rowIndexMapper.insertIndexes(l,a),i==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,d);const f=this.instance.toVisualRow(o);return this.instance.countSourceRows()===d.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(o,t)),this.instance.runHooks("afterCreateRow",f,a,r),this.instance.forceFullRender=!0,{delta:a,startPhysicalIndex:o}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.instance.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.instance.runHooks("beforeCreateCol",l,t,r)===!1)return{delta:0};let c=a;l<this.instance.countCols()&&(c=this.instance.toPhysicalColumn(l));const h=this.instance.countSourceRows();let d=this.instance.countCols(),f=0,m=c;i==="end"&&(m=Math.min(m+1,a));const p=m;for(;f<t&&d<o;){if(typeof l!="number"||l>=d)if(h>0)for(let C=0;C<h;C+=1)typeof s[C]>"u"&&(s[C]=[]),s[C].push(null);else s.push([null]);else for(let C=0;C<h;C++)s[C].splice(m,0,null);f+=1,m+=1,d+=1}this.instance.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(p,t));const y=this.instance.toVisualColumn(p);return this.instance.runHooks("afterCreateCol",y,f,r),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:f,startPhysicalIndex:p}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-t;const s=this.visualRowsToPhysical(i,t),o=this.instance.countSourceRows();if(i=(o+i)%o,this.instance.runHooks("beforeRemoveRow",i,s.length,s,r)===!1)return!1;const l=s.length;if(this.filterData(i,l,s),i<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(s);const c=De(this.tableMeta.columns)||De(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.instance.runHooks("afterRemoveRow",i,l,s,r),this.instance.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-t:e;i=(this.instance.countCols()+i)%this.instance.countCols();const s=this.visualColumnsToPhysical(i,t),o=s.slice(0).sort((h,d)=>d-h);if(this.instance.runHooks("beforeRemoveCol",i,t,s,r)===!1)return!1;let l=!0;const u=o.length,c=this.dataSource;for(let h=0;h<u;h++)l&&s[0]!==s[h]-h&&(l=!1);if(l)for(let h=0,d=this.instance.countSourceRows();h<d;h++)c[h].splice(s[0],t),h===0&&this.metaManager.removeColumn(s[0],t);else for(let h=0,d=this.instance.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(o[f],1),h===0&&this.metaManager.removeColumn(o[f],1);return i<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(s),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",i,t,s,r),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,r){const i=this.instance.getDataAtCol(e),s=i.slice(t,t+r),o=i.slice(t+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];iR(l,o);let c=0;for(;c<r;)l.push(null),c+=1;return D$(l),this.instance.populateFromArray(t,e,l,null,null,"spliceCol"),s}spliceRow(e,t,r){const i=this.instance.getSourceDataAtRow(e),s=i.slice(t,t+r),o=i.slice(t+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];iR(l,o);let c=0;for(;c<r;)l.push(null),c+=1;return this.instance.populateFromArray(e,t,[l],null,null,"spliceRow"),s}spliceData(e,t,r){if(this.instance.runHooks("beforeDataSplice",e,t,r)!==!1){const s=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,t,r){let i=this.instance.runHooks("filterData",e,t,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,o)=>r.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,t){const r=this.instance.toPhysicalRow(e);let i=this.dataSource[r];const s=this.instance.runHooks("modifyRowData",r);i=isNaN(s)?s:i;let o=null;if(i&&i.hasOwnProperty&&Sn(i,t))o=i[t];else if(typeof t=="string"&&t.indexOf(".")>-1){const a=t.split(".");let l=i;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;o=l}else typeof t=="function"&&(o=t(this.dataSource.slice(r,r+1)[0]));if(this.instance.hasHook("modifyData")){const a=zu(o);this.instance.runHooks("modifyData",r,this.propToCol(t),a,"get"),a.isTouched()&&(o=a.value)}return o}getCopyable(e,t){return this.instance.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,r){const i=this.instance.toPhysicalRow(e);let s=r,o=this.dataSource[i];const a=this.instance.runHooks("modifyRowData",i);if(o=isNaN(a)?a:o,this.instance.hasHook("modifyData")){const l=zu(s);this.instance.runHooks("modifyData",i,this.propToCol(t),l,"set"),l.isTouched()&&(s=l.value)}if(o&&o.hasOwnProperty&&Sn(o,t))o[t]=s;else if(typeof t=="string"&&t.indexOf(".")>-1){const l=t.split(".");let u=o,c=0,h;for(c=0,h=l.length-1;c<h;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=s}else typeof t=="function"?t(this.dataSource.slice(i,i+1)[0],s):o[t]=s}visualRowsToPhysical(e,t){const r=this.instance.countSourceRows(),i=[];let s=(r+e)%r,o=t,a;for(;s<r&&o;)a=this.instance.toPhysicalRow(s),i.push(a),o-=1,s+=1;return i}visualColumnsToPhysical(e,t){const r=this.instance.countCols(),i=[];let s=(r+e)%r,o=t;for(;s<r&&o;){const a=this.instance.toPhysicalColumn(s);i.push(a),o-=1,s+=1}return i}clear(){for(let e=0;e<this.instance.countSourceRows();e++)for(let t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;e<0||e===0?t=0:t=e||1/0;const r=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-t.row===0&&!this.instance.countSourceRows()?[]:this.getRange(e,t,Tu.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,r){const i=[];let s,o,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Tu.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,t.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,t.col));for(s=Math.min(e.row,t.row);s<=h;s++){a=[];const f=s>=0?this.instance.toPhysicalRow(s):s;for(o=Math.min(e.col,t.col);o<=d&&f!==null;o++)a.push(c.call(this,s,this.colToProp(o)));f!==null&&i.push(a)}return i}getText(e,t){return vh(this.getRange(e,t,Tu.DESTINATION_RENDERER))}getCopyableText(e,t){return vh(this.getRange(e,t,Tu.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const QQ=Tu;function ZQ(n,e){var t;return n==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(n))||!Sn(e,n)}function o1(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=typeof e.type=="string"?bz(e.type):e.type;if(n._automaticallyAssignedMetaProps&&ft(e,(s,o)=>void n._automaticallyAssignedMetaProps.delete(o)),!dt(r))return;t===n&&!n._automaticallyAssignedMetaProps&&(n._automaticallyAssignedMetaProps=new Set);const i={};ft(r,(s,o)=>{if(ZQ(o,t)){var a;i[o]=s,(a=n._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),Un(n,i)}function JQ(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}da(t,n);for(let r=0;r<e.length;r++)t.prototype[e[r]]=void 0;return t}function Lm(n){return Number.isInteger(n)&&n>=0}function Pm(n,e){if(!n())throw new Error(`Assertion failed: ${e}`)}function xf(n){return n==null}const lM=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol(n){let e,t,r;for(e=0,t=this.countRows();e<t;e++)if(r=this.getDataAtCell(e,n),zn(r)===!1)return!1;return!0},isEmptyRow(n){let e,t,r,i;for(e=0,t=this.countCols();e<t;e++)if(r=this.getDataAtCell(n,e),zn(r)===!1)return typeof r=="object"?(i=this.getCellMeta(n,e),J5(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function eZ(){return class{}}class tZ{constructor(e){this.metaCtor=eZ(),this.meta=this.metaCtor.prototype,Un(this.meta,lM()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;Un(this.meta,e),o1(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}}class nZ{constructor(e){const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){Un(this.meta,e),o1(this.meta,e,e)}}class Ky{constructor(e){this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}obtain(e){Pm(()=>Lm(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let r;if(t>=0)r=this.data[t],r===void 0&&(r=this.valueFactory(e),this.data[t]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Pm(()=>Lm(e)||xf(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let o=0;o<t;o++)r.push(i+o),this.data.push(void 0);const s=xf(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...r,...this.index.slice(s)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Pm(()=>Lm(e)||xf(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(xf(e)?this.index.length-t:e,t);for(let i=0;i<r.length;i++){const s=r[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return Oi(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let t=0;return{next:()=>{if(t<e.length){const r=e[t];return t+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}const rZ=["data","width"];class iZ{constructor(e){this.globalMeta=e,this.metas=new Ky(()=>this._createMeta())}updateMeta(e,t){const r=this.getMeta(e);Un(r,t),o1(r,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return JQ(this.globalMeta.getMetaConstructor(),rZ).prototype}}class sZ{constructor(e){this.columnMeta=e,this.metas=new Ky(()=>this._createRow())}updateMeta(e,t,r){const i=this.getMeta(e,t);Un(i,r),o1(i,r)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,t)}getMeta(e,t,r){const i=this.metas.obtain(e).obtain(t);return r===void 0?i:i[r]}setMeta(e,t,r,i){var s;const o=this.metas.obtain(e).obtain(t);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(r),o[r]=i}removeMeta(e,t,r){const i=this.metas.obtain(e).obtain(t);delete i[r]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let r=0;r<t.length;r++)e.push(...t[r].values());return e}getMetasAtRow(e){Pm(()=>Lm(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Ky(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}}class uM{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new tZ(e),this.tableMeta=new nZ(this.globalMeta),this.columnMeta=new iZ(this.globalMeta),this.cellMeta=new sZ(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,r){let{visualRow:i,visualColumn:s}=r;const o=this.cellMeta.getMeta(e,t);return o.visualRow=i,o.visualCol=s,o.row=e,o.col=t,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(e,t,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,r)}setCellMeta(e,t,r,i){this.cellMeta.setMeta(e,t,r,i)}updateCellMeta(e,t,r){this.cellMeta.updateMeta(e,t,r)}removeCellMeta(e,t,r){this.cellMeta.removeMeta(e,t,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Yt(uM,ni);function B7(n,e,t,r){const{hotInstance:i,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=ts(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":qt(d.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),n=i.runHooks(`before${h}`,n,c,l);const f=new QQ(i,n,u);if(e(f),typeof n=="object"&&n!==null)n.push&&n.splice||(n=[n]);else if(n===null){const m=f.getSchema();n=[];let p,y=0,C=0;for(y=0,C=d.startRows;y<C;y++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)p=kr(m),n.push(p);else if(i.dataType==="array")p=kr(m[0]),n.push(p);else{p=[];for(let b=0,v=d.startCols;b<v;b++)p.push(null);n.push(p)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof n} given)`);Array.isArray(n[0])&&(i.dataType="array"),d.data=n,f.dataSource=n,o.data=n,o.dataType=i.dataType,o.colToProp=f.colToProp.bind(f),o.propToCol=f.propToCol.bind(f),o.countCachedColumns=f.countCachedColumns.bind(f),t(f),i.runHooks(`after${h}`,n,c,l),c||(i.runHooks("afterChange",null,a),i.render())}class oZ{constructor(e){this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),Ue.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:r,col:i}=e;if((t=this.metaSyncMemo.get(r))!==null&&t!==void 0&&t.has(i))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const u=Sn(e,"type")?e.type:null;let c=qt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}class aZ{constructor(e){this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,r,i){if(!i)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]]),this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{target:r,onChange:i=()=>{}}=e,s=typeof r=="string",o=s?r:t,a=`_${o}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[o],this.installPropWatcher(t,a,i),s&&this.installPropWatcher(r,a,i)})}installPropWatcher(e,t,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(s){const o=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,s,o),this[t]=s},enumerable:!0,configurable:!0})}}const V7=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Mf=n=>n.map(e=>{const t=e.toLowerCase();return V7.has(t)?V7.get(t):t}).sort().join("+"),lZ=n=>n.split("+"),$7=n=>n.toLowerCase(),uZ=n=>{const e=Gg({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${n}" context.`}),t=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:m=!1,relativeToGroup:p,position:y}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Qt(c))throw new Error("You need to define the shortcut's group.");if(qt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(Vt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const C={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:m};De(p)&&([C.relativeToGroup,C.position]=[p,y]),l.forEach(b=>{const v=Mf(b);if(e.hasItem(v)){const L=e.getItem(v);let _=L.findIndex(P=>P.group===p);_!==-1?y==="before"?_-=1:_+=1:_=L.length,L.splice(_,0,C)}else e.addItem(v,[C])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{ft(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),t(c)})},i=l=>{const u=Mf(l);e.removeItem(u)};return{addShortcut:t,addShortcuts:r,getShortcuts:l=>{const u=Mf(l),c=e.getItem(u);return De(c)?c.slice():[]},hasShortcut:l=>{const u=Mf(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(m=>m.group!==l);f.length===0?i(lZ(h)):(d.length=0,d.push(...f))})}}};function cZ(){const n=new Set;return{press(e){n.add(e)},release(e){n.delete(e)},releaseAll(){n.clear()},isPressed(e){return n.has(e)}}}const hZ=["meta","alt","shift","control"],kc=cZ();function dZ(n,e,t,r,i){const s=d=>hZ.includes(d),o=function(d){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const m=[];return d.altKey&&m.push("alt"),f&&(d.ctrlKey||d.metaKey)?m.push("control/meta"):(d.ctrlKey&&m.push("control"),d.metaKey&&m.push("meta")),d.shiftKey&&m.push("shift"),m},a=d=>{if(e(d)===!1)return;const f=t(d);if(d.keyCode===229||f===!1||pu(d))return;const m=$7(d.key);let p=[];s(m)?kc.press(m):p=o(d);const y=[m].concat(p);!i(d,y)&&(bR()&&p.includes("meta")||!bR()&&p.includes("control"))&&i(d,[m].concat(o(d,!0))),r(d)},l=d=>{if(e(d)===!1)return;const f=$7(d.key);s(f)!==!1&&kc.release(f)},u=()=>{kc.releaseAll()};return{mount:()=>{let d=n;for(;d;)d.document.documentElement.addEventListener("keydown",a),d.document.documentElement.addEventListener("keyup",l),d.document.documentElement.addEventListener("blur",u),d=up(d)},unmount:()=>{let d=n;for(;d;)d.document.documentElement.removeEventListener("keydown",a),d.document.documentElement.removeEventListener("keyup",l),d.document.documentElement.removeEventListener("blur",u),d=up(d)},isPressed:d=>kc.isPressed(d),releasePressedKeys:()=>kc.releaseAll()}}const fZ=n=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:r,afterKeyDown:i}=n;const s=Gg({errorIdExists:f=>`The "${f}" context name is already registered.`});let o="grid";const a=f=>{const m=uZ(f);return s.addItem(f,m),m},l=()=>o,u=f=>s.getItem(f),c=f=>{o=f};let h=!1;const d=dZ(e,t,r,i,(f,m)=>{const p=u(l());let y=!1;if(!p.hasShortcut(m))return y;const C=p.getShortcuts(m);for(let b=0;b<C.length;b++){const{callback:v,runOnlyIf:S,preventDefault:L,stopPropagation:_,captureCtrl:P}=C[b];if(S(f)!==!1&&(h=P,y=v(f,m)===!1,h=!1,L&&f.preventDefault(),_&&f.stopPropagation(),y))break}return y});return d.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(d.isPressed("control")||d.isPressed("meta")),releasePressedKeys:()=>d.releasePressedKeys(),destroy:()=>d.unmount()}},mZ="gridDefault";let F2=null;function pE(n,e){var t;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=this;const o=new dn(s);let a,l,u,c,h=!0;rQ(r)&&nQ(this),this.rootElement=n,this.rootDocument=n.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const d=(t=e==null?void 0:e.layoutDirection)!==null&&t!==void 0?t:"inherit",f=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",f),this.isRtl=function(){return f==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=OQ(e.language);const m=new uM(s,e,[oZ,aZ]),p=m.getTableMeta(),y=m.getGlobalMeta(),C=Gg();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,n.insertBefore(this.container,n.firstChild),Yy(this)&&U$(e.licenseKey,n),this.guid=`ht_${Sx()}`,this.columnIndexMapper=new Vy,this.rowIndexMapper=new Vy,this.columnIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterRowSequenceChange",g)}),l=new gQ(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const b=g=>{const{row:E,col:A}=g;return s._createCellCoords(E>=0?s.rowIndexMapper.getRenderableFromVisualIndex(E):E,A>=0?s.columnIndexMapper.getRenderableFromVisualIndex(A):A)},v=g=>{const{row:E,col:A}=g;return s._createCellCoords(E>=0?s.rowIndexMapper.getVisualFromRenderableIndex(E):E,A>=0?s.columnIndexMapper.getVisualFromRenderableIndex(A):A)};let S=new KQ(p,{rowIndexMapper:()=>s.rowIndexMapper,columnIndexMapper:()=>s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:g=>a.propToCol(g),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countColsTranslated:()=>this.view.countRenderableColumns(),countRowsTranslated:()=>this.view.countRenderableRows(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(g,E)=>s._createCellCoords(g,E),createCellRange:(g,E,A)=>s._createCellRange(g,E,A),visualToRenderableCoords:b,renderableToVisualCoords:v,isDisabledCellSelection:(g,E)=>s.getCellMeta(g,E).disableVisualSelection});this.selection=S;const L=g=>{let{hiddenIndexesChanged:E}=g;E&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",L),this.rowIndexMapper.addLocalHook("cacheUpdated",L),this.selection.addLocalHook("beforeSetRangeStart",g=>{this.runHooks("beforeSetRangeStart",g)}),this.selection.addLocalHook("beforeSetRangeStartOnly",g=>{this.runHooks("beforeSetRangeStartOnly",g)}),this.selection.addLocalHook("beforeSetRangeEnd",g=>{this.runHooks("beforeSetRangeEnd",g),g.row<0&&(g.row=this.view._wt.wtTable.getFirstVisibleRow()),g.col<0&&(g.col=this.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",g=>{const E=zu(!1),A=this.selection.getSelectedRange(),{from:U,to:G}=A.current(),V=A.size()-1;this.runHooks("afterSelection",U.row,U.col,G.row,G.col,E,V),this.runHooks("afterSelectionByProp",U.row,s.colToProp(U.col),G.row,s.colToProp(G.col),E,V);const oe=this.selection.isSelectedByAnyHeader(),j=this.selection.selectedRange.current();let ye=!0;i&&(ye=!1),E.isTouched()&&(ye=!E.value);const ee=this.selection.isSelectedByRowHeader(),T=this.selection.isSelectedByColumnHeader();ye!==!1&&(oe?ee?this.view.scrollViewportVertically(s.rowIndexMapper.getRenderableFromVisualIndex(g.row)):T&&this.view.scrollViewportHorizontally(s.columnIndexMapper.getRenderableFromVisualIndex(g.col)):j&&!this.selection.isMultiple()?this.view.scrollViewport(b(j.from)):this.view.scrollViewport(b(g))),ee&&T?Ae(this.rootElement,["ht__selection--rows","ht__selection--columns"]):ee?(tt(this.rootElement,"ht__selection--columns"),Ae(this.rootElement,"ht__selection--rows")):T?(tt(this.rootElement,"ht__selection--rows"),Ae(this.rootElement,"ht__selection--columns")):tt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",g=>{const E=g.length-1,{from:A,to:U}=g[E];this.runHooks("afterSelectionEnd",A.row,A.col,U.row,U.col,E),this.runHooks("afterSelectionEndByProp",A.row,s.colToProp(A.col),U.row,s.colToProp(U.col),E)}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{const E=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=E)}),this.selection.addLocalHook("beforeModifyTransformStart",g=>{this.runHooks("modifyTransformStart",g)}),this.selection.addLocalHook("afterModifyTransformStart",(g,E,A)=>{this.runHooks("afterModifyTransformStart",g,E,A)}),this.selection.addLocalHook("beforeModifyTransformEnd",g=>{this.runHooks("modifyTransformEnd",g)}),this.selection.addLocalHook("afterModifyTransformEnd",(g,E,A)=>{this.runHooks("afterModifyTransformEnd",g,E,A)}),this.selection.addLocalHook("afterDeselect",()=>{c.destroyEditor(),this._refreshBorders(),tt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",g=>{this.alter("insert_row_above",g,1,"auto")}),this.selection.addLocalHook("insertColRequire",g=>{this.alter("insert_col_start",g,1,"auto")}),u={alter(g,E){var A,U;let G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,V=arguments.length>3?arguments[3]:void 0,oe=arguments.length>4?arguments[4]:void 0;const j=ye=>{if(ye.length===0)return[];const ee=[...ye];return ee.sort((F,Y)=>{let[q]=F,[me]=Y;return q===me?0:q>me?1:-1}),Tr(ee,(F,Y)=>{let[q,me]=Y;const Z=F[F.length-1],[Ce,Re]=Z,Ee=Ce+Re;if(q<=Ee){const Me=Math.max(me-(Ee-q),0);Z[1]+=Me}else F.push([q,me]);return F},[ee[0]])};switch(g){case"insert_row_below":case"insert_row_above":const ye=s.countSourceRows();if(p.maxRows===ye)return;const ee=g==="insert_row_below"?"below":"above";E=(A=E)!==null&&A!==void 0?A:ee==="below"?ye:0;const{delta:T,startPhysicalIndex:F}=a.createRow(E,G,{source:V,mode:ee});if(T){const Re=S.selectedRange.current(),Ee=Re==null?void 0:Re.from,Me=Ee==null?void 0:Ee.row,Te=s.toVisualRow(F);if(S.isSelectedByCorner())s.selectAll();else if(De(Me)&&Me>=Te){const{row:k,col:B}=Re.to;let z=Ee.col;S.isSelectedByRowHeader()&&(z=-1),S.getSelectedRange().pop(),S.setRangeStartOnly(s._createCellCoords(Me+T,z),!0),S.setRangeEnd(s._createCellCoords(k+T,B))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Y=g==="insert_col_end"?"end":"start";E=(U=E)!==null&&U!==void 0?U:Y==="end"?s.countSourceCols():0;const{delta:q,startPhysicalIndex:me}=a.createCol(E,G,{source:V,mode:Y});if(q){if(Array.isArray(p.colHeaders)){const k=[s.toVisualColumn(me),0];k.length+=q,Array.prototype.splice.apply(p.colHeaders,k)}const Re=S.selectedRange.current(),Ee=Re==null?void 0:Re.from,Me=Ee==null?void 0:Ee.col,Te=s.toVisualColumn(me);if(S.isSelectedByCorner())s.selectAll();else if(De(Me)&&Me>=Te){const{row:k,col:B}=Re.to;let z=Ee.row;S.isSelectedByColumnHeader()&&(z=-1),S.getSelectedRange().pop(),S.setRangeStartOnly(s._createCellCoords(z,Me+q),!0),S.setRangeEnd(s._createCellCoords(k,B+q))}else s._refreshBorders()}break;case"remove_row":const Z=Re=>{let Ee=0;re(Re,Me=>{let[Te,k]=Me;const B=zn(Te)?s.countRows()-1:Math.max(Te-Ee,0);if(Number.isInteger(Te)&&(Te=Math.max(Te-Ee,0)),!a.removeRow(Te,k,V))return;const de=s.countRows(),ne=p.fixedRowsTop;ne>=B+1&&(p.fixedRowsTop-=Math.min(k,ne-B));const fe=p.fixedRowsBottom;fe&&B>=de-fe&&(p.fixedRowsBottom-=Math.min(k,fe)),Ee+=k})};Array.isArray(E)?Z(j(E)):Z([[E,G]]),u.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const Ce=Re=>{let Ee=0;re(Re,Me=>{let[Te,k]=Me;const B=zn(Te)?s.countCols()-1:Math.max(Te-Ee,0);let z=s.toPhysicalColumn(B);if(Number.isInteger(Te)&&(Te=Math.max(Te-Ee,0)),!a.removeCol(Te,k,V))return;const ne=p.fixedColumnsStart;ne>=B+1&&(p.fixedColumnsStart-=Math.min(k,ne-B)),Array.isArray(p.colHeaders)&&(typeof z>"u"&&(z=-1),p.colHeaders.splice(z,k)),Ee+=k})};Array.isArray(E)?Ce(j(E)):Ce([[E,G]]),u.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${g}"`)}oe||u.adjustRowsAndCols()},adjustRowsAndCols(){const g=p.minRows,E=p.minSpareRows,A=p.minCols,U=p.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&S.deselect(),g){const G=s.countRows();G<g&&a.createRow(G,g-G,{source:"auto"})}if(E){const G=s.countEmptyRows(!0);if(G<E){const V=E-G,oe=Math.min(V,p.maxRows-s.countSourceRows());a.createRow(s.countRows(),oe,{source:"auto"})}}{let G;(A||U)&&(G=s.countEmptyCols(!0));let V=s.countCols();if(A&&!p.columns&&V<A){const oe=A-V;G+=oe,a.createCol(V,oe,{source:"auto"})}if(U&&!p.columns&&s.dataType==="array"&&G<U){V=s.countCols();const oe=U-G,j=Math.min(oe,p.maxCols-V);a.createCol(V,j,{source:"auto"})}}if(S.isSelected()){const G=s.countRows(),V=s.countCols();re(S.selectedRange,oe=>{let j=!1,ye=oe.from.row,ee=oe.from.col,T=oe.to.row,F=oe.to.col;ye>G-1?(ye=G-1,j=!0,T>ye&&(T=ye)):T>G-1&&(T=G-1,j=!0,ye>T&&(ye=T)),ee>V-1?(ee=V-1,j=!0,F>ee&&(F=ee)):F>V-1&&(F=V-1,j=!0,ee>F&&(ee=F)),j&&s.selectCell(ye,ee,T,F)})}s.view&&s.view.adjustElementsSize()},populateFromArray(g,E,A,U,G){let V,oe,j,ye;const ee=[],T={},F=[],Y=g.row,q=g.col;if(oe=E.length,oe===0)return!1;let me=0,Z=0;switch(dt(A)&&(me=A.col-q+1,Z=A.row-Y+1),G){case"shift_down":const Ce=Mm(E),Re=Ce.length,Ee=Math.max(Re,me),Me=s.getData().slice(Y),Te=Mm(Me).slice(q,q+Ee);for(j=0;j<Ee;j+=1)if(j<Re){for(V=0,oe=Ce[j].length;V<Z-oe;V+=1)Ce[j].push(Ce[j][V%oe]);j<Te.length?F.push(Ce[j].concat(Te[j])):F.push(Ce[j].concat(new Array(Me.length).fill(null)))}else F.push(Ce[j%Re].concat(Te[j]));s.populateFromArray(Y,q,Mm(F));break;case"shift_right":const k=E.length,B=Math.max(k,Z),z=s.getData().slice(Y).map(he=>he.slice(q));for(V=0;V<B;V+=1)if(V<k){for(j=0,ye=E[V].length;j<me-ye;j+=1)E[V].push(E[V][j%ye]);if(V<z.length)for(let he=0;he<z[V].length;he+=1)E[V].push(z[V][he]);else E[V].push(...new Array(z[0].length).fill(null))}else E.push(E[V%oe].slice(0,B).concat(z[V]));s.populateFromArray(Y,q,E);break;case"overwrite":default:T.row=g.row,T.col=g.col;let de=0,ne=0,fe=!0,le;const ae=function(Se){let be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const _e=E[Se%E.length];return be!==null?_e[be%_e.length]:_e},pe=E.length,te=A?A.row-g.row+1:0;for(A?oe=te:oe=Math.max(pe,te),V=0;V<oe&&!(A&&T.row>A.row&&te>pe||!p.allowInsertRow&&T.row>s.countRows()-1||T.row>=p.maxRows);V++){const he=V-de,Se=ae(he).length,be=A?A.col-g.col+1:0;if(A?ye=be:ye=Math.max(Se,be),T.col=g.col,le=s.getCellMeta(T.row,T.col),(U==="CopyPaste.paste"||U==="Autofill.fill")&&le.skipRowOnPaste){de+=1,T.row+=1,oe+=1;continue}for(ne=0,j=0;j<ye&&!(A&&T.col>A.col&&be>Se||!p.allowInsertColumn&&T.col>s.countCols()-1||T.col>=p.maxCols);j++){if(le=s.getCellMeta(T.row,T.col),(U==="CopyPaste.paste"||U==="Autofill.fill")&&le.skipColumnOnPaste){ne+=1,T.col+=1,ye+=1;continue}if(le.readOnly&&U!=="UndoRedo.undo"){T.col+=1;continue}const _e=j-ne;let $e=ae(he,_e),Oe=s.getDataAtCell(T.row,T.col);if($e!==null&&typeof $e=="object")if(Array.isArray($e)&&Oe===null&&(Oe=[]),Oe===null||typeof Oe!="object")fe=!1;else{const Ye=$h(Array.isArray(Oe)?Oe:Oe[0]||Oe),Xe=$h(Array.isArray($e)?$e:$e[0]||$e);J5(Ye,Xe)||Array.isArray(Ye)&&Array.isArray(Xe)?$e=kr($e):fe=!1}else Oe!==null&&typeof Oe=="object"&&(fe=!1);fe&&ee.push([T.row,T.col,$e]),fe=!0,T.col+=1}T.row+=1}s.setDataAtCell(ee,null,null,U||"populateFromArray");break}}};function _(g){const E=J9(g);dE(E)?(s.runHooks("beforeLanguageChange",E),y.language=E,s.runHooks("afterLanguageChange",E)):eM(g)}function P(g,E){const A=g==="className"?s.rootElement:s.table;if(h)Ae(A,E);else{let U=[],G=[];y[g]&&(U=Array.isArray(y[g])?y[g]:oR(y[g])),E&&(G=Array.isArray(E)?E:oR(E));const V=sR(U,G),oe=sR(G,U);V.length&&tt(A,V),oe.length&&Ae(A,oe)}y[g]=E}this.init=function(){l.setData(p.data),s.runHooks("beforeInit"),(Ns()||vx())&&Ae(s.rootElement,"mobile"),this.updateSettings(p,!0),this.view=new cQ(this),c=oG.getInstance(s,p,S),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),!!h&&s.rootElement.offsetParent===null&&QW(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof h=="object"&&(s.runHooks("afterChange",h[0],h[1]),h=!1),s.runHooks("afterInit")};function x(){let g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function I(g){const E=g.replace(",",".");return isNaN(parseFloat(E))===!1?parseFloat(E):g}function R(g,E,A){if(!g.length)return;const U=s.getActiveEditor(),G=new x;let V=!0;G.onQueueEmpty=oe=>{U&&V&&U.cancelChanges(),A(oe)};for(let oe=g.length-1;oe>=0;oe--){const[j,ye,,ee]=g[oe],T=a.propToCol(ye),F=s.getCellMeta(j,T);F.type==="numeric"&&typeof ee=="string"&&cG(ee)&&(g[oe][3]=I(ee)),s.getCellValidator(F)&&(G.addValidatorToQueue(),s.validateCell(g[oe][3],F,function(Y,q){return function(me){if(typeof me!="boolean")throw new Error("Validation error: result is not boolean");if(me===!1&&q.allowInvalid===!1){V=!1,g.splice(Y,1),q.valid=!0;const Z=s.getCell(q.visualRow,q.visualCol);Z!==null&&tt(Z,p.invalidCellClassName)}G.removeValidatorFormQueue()}}(oe,F),E))}G.checkIfQueueIsEmpty()}function N(g,E){let A=g.length-1;if(A<0)return;for(;A>=0;A--){let G=!1;if(g[A]===null){g.splice(A,1);continue}if(!((g[A][2]===null||g[A][2]===void 0)&&(g[A][3]===null||g[A][3]===void 0))){if(p.allowInsertRow)for(;g[A][0]>s.countRows()-1;){const{delta:V}=a.createRow(void 0,void 0,{source:E});if(V===0){G=!0;break}}if(s.dataType==="array"&&(!p.columns||p.columns.length===0)&&p.allowInsertColumn)for(;a.propToCol(g[A][1])>s.countCols()-1;){const{delta:V}=a.createCol(void 0,void 0,{source:E});if(V===0){G=!0;break}}G||a.set(g[A][0],g[A][1],g[A][3])}}s.forceFullRender=!0,u.adjustRowsAndCols(),s.runHooks("beforeChangeRender",g,E),c.lockEditor(),s._refreshBorders(null),c.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",g,E||"edit");const U=s.getActiveEditor();U&&De(U.refreshValue)&&U.refreshValue()}this._createCellCoords=function(g,E){return s.view._wt.createCellCoords(g,E)},this._createCellRange=function(g,E,A){return s.view._wt.createCellRange(g,E,A)},this.validateCell=function(g,E,A,U){let G=s.getCellValidator(E);function V(oe){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||E.hidden===!0){A(oe);return}const ye=E.visualCol,ee=E.visualRow,T=s.getCell(ee,ye,!0);if(T&&T.nodeName!=="TH"){const F=s.rowIndexMapper.getRenderableFromVisualIndex(ee),Y=s.columnIndexMapper.getRenderableFromVisualIndex(ye);s.view._wt.getSetting("cellRenderer",F,Y,T)}A(oe)}k$(G)&&(G=function(oe){return function(j,ye){ye(oe.test(j))}}(G)),qt(G)?(g=s.runHooks("beforeValidate",g,E.visualRow,E.prop,U),s._registerImmediate(()=>{G.call(E,g,oe=>{!s||(oe=s.runHooks("afterValidate",oe,g,E.visualRow,E.prop,U),E.valid=oe,V(oe),s.runHooks("postAfterValidate",oe,g,E.visualRow,E.prop,U))})})):s._registerImmediate(()=>{E.valid=!0,V(E.valid,!1)})};function H(g,E,A){return Array.isArray(g)?g:[[g,E,A]]}function K(g,E){const A=s.getActiveEditor(),U=s.runHooks("beforeChange",g,E||"edit"),G=g.filter(V=>V!==null);return U===!1||G.length===0?(A&&A.cancelChanges(),[]):G}this.setDataAtCell=function(g,E,A,U){const G=H(g,E,A),V=[];let oe=U,j,ye,ee;for(j=0,ye=G.length;j<ye;j++){if(typeof G[j]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof G[j][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");G[j][1]>=this.countCols()?ee=G[j][1]:ee=a.colToProp(G[j][1]),V.push([G[j][0],ee,l.getAtCell(this.toPhysicalRow(G[j][0]),G[j][1]),G[j][2]])}!oe&&typeof g=="object"&&(oe=E);const T=K(V,U);s.runHooks("afterSetDataAtCell",T,oe),R(T,oe,()=>{N(T,oe)})},this.setDataAtRowProp=function(g,E,A,U){const G=H(g,E,A),V=[];let oe=U,j,ye;for(j=0,ye=G.length;j<ye;j++)V.push([G[j][0],G[j][1],l.getAtCell(this.toPhysicalRow(G[j][0]),G[j][1]),G[j][2]]);!oe&&typeof g=="object"&&(oe=E);const ee=K(V,U);s.runHooks("afterSetDataAtRowProp",ee,oe),R(ee,oe,()=>{N(ee,oe)})},this.listen=function(){s&&!s.isListening()&&(F2=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(F2=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return F2===s.guid},this.destroyEditor=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(g,E)},this.populateFromArray=function(g,E,A,U,G,V,oe){if(!(typeof A=="object"&&typeof A[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const j=typeof U=="number"?s._createCellCoords(U,G):null;return u.populateFromArray(s._createCellCoords(g,E),A,j,V,oe)},this.spliceCol=function(g,E,A){for(var U=arguments.length,G=new Array(U>3?U-3:0),V=3;V<U;V++)G[V-3]=arguments[V];return a.spliceCol(g,E,A,...G)},this.spliceRow=function(g,E,A){for(var U=arguments.length,G=new Array(U>3?U-3:0),V=3;V<U;V++)G[V-3]=arguments[V];return a.spliceRow(g,E,A,...G)},this.getSelected=function(){if(S.isSelected())return ct(S.getSelectedRange(),g=>{let{from:E,to:A}=g;return[E.row,E.col,A.row,A.col]})},this.getSelectedLast=function(){const g=this.getSelected();let E;return g&&g.length>0&&(E=g[g.length-1]),E},this.getSelectedRange=function(){if(S.isSelected())return Array.from(S.getSelectedRange())},this.getSelectedRangeLast=function(){const g=this.getSelectedRange();let E;return g&&g.length>0&&(E=g[g.length-1]),E},this.emptySelectedCells=function(g){if(!S.isSelected()||this.countRows()===0||this.countCols()===0)return;const E=[];re(S.getSelectedRange(),A=>{const U=A.getTopStartCorner(),G=A.getBottomEndCorner();ze(U.row,G.row,V=>{ze(U.col,G.col,oe=>{this.getCellMeta(V,oe).readOnly||E.push([V,oe,null])})})}),E.length>0&&this.setDataAtCell(E,g)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(g){this.suspendRender();const E=g();return this.resumeRender(),E},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const E=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(E,0),(!this.isExecutionSuspended()&&E===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const A=g();return this.resumeExecution(E),A},this.batch=function(g){this.suspendRender(),this.suspendExecution();const E=g();return this.resumeExecution(),this.resumeRender(),E},this.refreshDimensions=function(){if(!s.view)return;const{width:g,height:E}=s.view.getLastSize(),{width:A,height:U}=s.rootElement.getBoundingClientRect(),G=A!==g||U!==E;s.runHooks("beforeRefreshDimensions",{width:g,height:E},{width:A,height:U},G)!==!1&&((G||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(A,U),s.render()),s.runHooks("afterRefreshDimensions",{width:g,height:E},{width:A,height:U},G))},this.updateData=function(g,E){B7(g,A=>{a=A},A=>{a=A,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols()},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"updateData",source:E,metaManager:m,firstRun:h})},this.loadData=function(g,E){B7(g,A=>{a=A},()=>{m.clearCellsCache(),s.initIndexMappers(),u.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"loadData",source:E,metaManager:m,firstRun:h})},this.getInitialColumnCount=function(){const g=p.columns;let E=0;if(Array.isArray(g))E=g.length;else if(qt(g))if(s.dataType==="array"){const A=this.countSourceCols();for(let U=0;U<A;U+=1)g(U)&&(E+=1)}else(s.dataType==="object"||s.dataType==="function")&&(E=a.colToPropCache.length);else if(De(p.dataSchema)){const A=a.getSchema();E=Array.isArray(A)?A.length:ev(A)}else E=this.countSourceCols();return E},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,E,A,U){return Qt(g)?a.getAll():a.getRange(s._createCellCoords(g,E),s._createCellCoords(A,U),a.DESTINATION_RENDERER)},this.getCopyableText=function(g,E,A,U){return a.getCopyableText(s._createCellCoords(g,E),s._createCellCoords(A,U))},this.getCopyableData=function(g,E){return a.getCopyable(g,a.colToProp(E))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(g){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const A=(h?s.loadData:s.updateData).bind(this);let U=!1,G,V;if(De(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(De(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(De(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(G in g)G==="data"||(G==="language"?_(g.language):G==="className"?P("className",g.className):G==="tableClassName"&&s.table?(P("tableClassName",g.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):Ue.getSingleton().isRegistered(G)||Ue.getSingleton().isDeprecated(G)?(qt(g[G])||Array.isArray(g[G]))&&(g[G].initialHook=!0,s.addHook(G,g[G])):!E&&Sn(g,G)&&(y[G]=g[G]));g.data===void 0&&p.data===void 0?A(null,"updateSettings"):g.data!==void 0?A(g.data,"updateSettings"):g.columns!==void 0&&(a.createMap(),s.initIndexMappers());const oe=s.countCols(),j=p.columns;if(j&&qt(j)&&(U=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&m.clearCache(),oe>0)for(G=0,V=0;G<oe;G++){if(j){const T=U?j(G):j[V];T&&m.updateColumnMeta(V,T)}V+=1}De(g.cell)&&ft(g.cell,T=>{s.setCellMetaObject(T.row,T.col,T)}),s.runHooks("afterCellMetaReset");let ye=s.rootElement.style.height;ye!==""&&(ye=parseInt(s.rootElement.style.height,10));let ee=g.height;if(qt(ee)&&(ee=ee()),E&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),ee===null){const T=s.rootElement.getAttribute("data-initialstyle");T&&(T.indexOf("height")>-1||T.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",T):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else ee!==void 0&&(s.rootElement.style.height=isNaN(ee)?`${ee}`:`${ee}px`,s.rootElement.style.overflow="hidden");if(typeof g.width<"u"){let T=g.width;qt(T)&&(T=T()),s.rootElement.style.width=isNaN(T)?`${T}`:`${T}px`}E||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",g)),u.adjustRowsAndCols(),s.view&&!h&&(s.forceFullRender=!0,c.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),!E&&s.view&&(ye===""||ee===""||ee===void 0)&&ye!==ee&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const g=s.getSelectedLast();if(p.getValue){if(qt(p.getValue))return p.getValue.call(s);if(g)return s.getData()[g[0][0]][p.getValue]}else if(g)return s.getDataAtCell(g[0],g[1])},this.getSettings=function(){return p},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,E,A,U,G){u.alter(g,E,A,U,G)},this.getCell=function(g,E){let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,U=E,G=g;if(E>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(E)))return null;U=this.columnIndexMapper.getRenderableFromVisualIndex(E)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;G=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return G===null||U===null?null:s.view.getCellAtCoords(s._createCellCoords(G,U),A)},this.getCoords=function(g){const E=this.view._wt.wtTable.getCoords(g);if(E===null)return null;const{row:A,col:U}=E;let G=A,V=U;return A>=0&&(G=this.rowIndexMapper.getVisualFromRenderableIndex(A)),U>=0&&(V=this.columnIndexMapper.getVisualFromRenderableIndex(U)),s._createCellCoords(G,V)},this.colToProp=function(g){return a.colToProp(g)},this.propToCol=function(g){return a.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,E){return a.get(g,a.colToProp(E))},this.getDataAtRowProp=function(g,E){return a.get(g,E)},this.getDataAtCol=function(g){const E=[],A=a.getRange(s._createCellCoords(0,g),s._createCellCoords(p.data.length-1,g),a.DESTINATION_RENDERER);for(let U=0;U<A.length;U+=1)for(let G=0;G<A[U].length;G+=1)E.push(A[U][G]);return E},this.getDataAtProp=function(g){const E=[],A=a.getRange(s._createCellCoords(0,a.propToCol(g)),s._createCellCoords(p.data.length-1,a.propToCol(g)),a.DESTINATION_RENDERER);for(let U=0;U<A.length;U+=1)for(let G=0;G<A[U].length;G+=1)E.push(A[U][G]);return E},this.getSourceData=function(g,E,A,U){let G;return g===void 0?G=l.getData():G=l.getByRange(s._createCellCoords(g,E),s._createCellCoords(A,U)),G},this.getSourceDataArray=function(g,E,A,U){let G;return g===void 0?G=l.getData(!0):G=l.getByRange(s._createCellCoords(g,E),s._createCellCoords(A,U),!0),G},this.getSourceDataAtCol=function(g){return l.getAtColumn(g)},this.setSourceDataAtCell=function(g,E,A,U){const G=H(g,E,A),V=this.hasHook("afterSetSourceDataAtCell"),oe=[];V&&re(G,ye=>{let[ee,T,F]=ye;oe.push([ee,T,l.getAtCell(ee,T),F])}),re(G,ye=>{let[ee,T,F]=ye;l.setAtCell(ee,T,F)}),V&&this.runHooks("afterSetSourceDataAtCell",oe,U),this.render();const j=s.getActiveEditor();j&&De(j.refreshValue)&&j.refreshValue()},this.getSourceDataAtRow=function(g){return l.getAtRow(g)},this.getSourceDataAtCell=function(g,E){return l.getAtCell(g,E)},this.getDataAtRow=function(g){return a.getRange(s._createCellCoords(g,0),s._createCellCoords(g,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,E,A,U){const G=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,E,A,U],[V,oe]=G;let[,,j,ye]=G,ee=null,T=null;j===void 0&&(j=V),ye===void 0&&(ye=oe);let F="mixed";return ze(Math.max(Math.min(V,j),0),Math.max(V,j),Y=>{let q=!0;return ze(Math.max(Math.min(oe,ye),0),Math.max(oe,ye),me=>(T=this.getCellMeta(Y,me).type,ee?q=ee===T:ee=T,q)),F=q?T:"mixed",q}),F},this.removeCellMeta=function(g,E,A){const[U,G]=[this.toPhysicalRow(g),this.toPhysicalColumn(E)];let V=m.getCellMetaKeyValue(U,G,A);s.runHooks("beforeRemoveCellMeta",g,E,A,V)!==!1&&(m.removeCellMeta(U,G,A),s.runHooks("afterRemoveCellMeta",g,E,A,V)),V=null},this.spliceCellsMeta=function(g){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var A=arguments.length,U=new Array(A>2?A-2:0),G=2;G<A;G++)U[G-2]=arguments[G];if(U.length>0&&!Array.isArray(U[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");E>0&&m.removeRow(this.toPhysicalRow(g),E),U.length>0&&re(U.reverse(),V=>{m.createRow(this.toPhysicalRow(g)),re(V,(oe,j)=>this.setCellMetaObject(g,j,oe))}),s.render()},this.setCellMetaObject=function(g,E,A){typeof A=="object"&&ft(A,(U,G)=>{this.setCellMeta(g,E,G,U)})},this.setCellMeta=function(g,E,A,U){if(s.runHooks("beforeSetCellMeta",g,E,A,U)===!1)return;let V=g,oe=E;g<this.countRows()&&(V=this.toPhysicalRow(g)),E<this.countCols()&&(oe=this.toPhysicalColumn(E)),m.setCellMeta(V,oe,A,U),s.runHooks("afterSetCellMeta",g,E,A,U)},this.getCellsMeta=function(){return m.getCellsMeta()},this.getCellMeta=function(g,E){let A=this.toPhysicalRow(g),U=this.toPhysicalColumn(E);return A===null&&(A=g),U===null&&(U=E),m.getCellMeta(A,U,{visualRow:g,visualColumn:E})},this.getCellMetaAtRow=function(g){return m.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||p.columns)},this.getCellRenderer=function(g,E){const A=typeof g=="number"?s.getCellMeta(g,E).renderer:g.renderer;return typeof A=="string"?VR(A):Qt(A)?VR("text"):A},this.getCellEditor=function(g,E){const A=typeof g=="number"?s.getCellMeta(g,E).editor:g.editor;return typeof A=="string"?OR(A):Qt(A)?OR("text"):A},this.getCellValidator=function(g,E){const A=typeof g=="number"?s.getCellMeta(g,E).validator:g.validator;return typeof A=="string"?tz(A):A},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,E){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(E,g)},this.validateColumns=function(g,E){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(E,void 0,g)},this._validateCells=function(g,E,A){const U=new x;g&&(U.onQueueEmpty=g);let G=s.countRows()-1;for(;G>=0;){if(E!==void 0&&E.indexOf(G)===-1){G-=1;continue}let V=s.countCols()-1;for(;V>=0;){if(A!==void 0&&A.indexOf(V)===-1){V-=1;continue}U.addValidatorToQueue(),s.validateCell(s.getDataAtCell(G,V),s.getCellMeta(G,V),oe=>{if(typeof oe!="boolean")throw new Error("Validation error: result is not boolean");oe===!1&&(U.valid=!1),U.removeValidatorFormQueue()},"validateCells"),V-=1}G-=1}U.checkIfQueueIsEmpty()},this.getRowHeader=function(g){let E=p.rowHeaders,A=g;return A!==void 0&&(A=s.runHooks("modifyRowHeader",A)),A===void 0?(E=[],ze(s.countRows()-1,U=>{E.push(s.getRowHeader(U))})):Array.isArray(E)&&E[A]!==void 0?E=E[A]:qt(E)?E=E(A):E&&typeof E!="string"&&typeof E!="number"&&(E=A+1),E},this.hasRowHeaders=function(){return!!p.rowHeaders},this.hasColHeaders=function(){if(p.colHeaders!==void 0&&p.colHeaders!==null)return!!p.colHeaders;for(let g=0,E=s.countCols();g<E;g++)if(s.getColHeader(g))return!0;return!1},this.getColHeader=function(g){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const A=s.runHooks("modifyColHeader",g);if(A===void 0){const j=[],ye=s.countCols();for(let ee=0;ee<ye;ee++)j.push(s.getColHeader(ee));return j}let U=p.colHeaders;const G=function(j){const ye=[],ee=s.countCols();let T=0;for(;T<ee;T++)qt(p.columns)&&p.columns(T)&&ye.push(T);return ye[j]},V=s.toPhysicalColumn(A),oe=G(V);return p.colHeaders===!1?U=null:p.columns&&qt(p.columns)&&p.columns(oe)&&p.columns(oe).title?U=p.columns(oe).title:p.columns&&p.columns[V]&&p.columns[V].title?U=p.columns[V].title:Array.isArray(p.colHeaders)&&p.colHeaders[V]!==void 0?U=p.colHeaders[V]:qt(p.colHeaders)?U=p.colHeaders(V):p.colHeaders&&typeof p.colHeaders!="string"&&typeof p.colHeaders!="number"&&(U=dQ(A)),U=s.runHooks("modifyColumnHeaderValue",U,g,E),U},this._getColWidthFromSettings=function(g){let E;if(g>=0&&(E=s.getCellMeta(0,g).width),(E===void 0||E===p.width)&&(E=p.colWidths),E!=null){switch(typeof E){case"object":E=E[g];break;case"function":E=E(g);break}typeof E=="string"&&(E=parseInt(E,10))}return E},this.getColWidth=function(g){let E=s._getColWidthFromSettings(g);return E=s.runHooks("modifyColWidth",E,g),E===void 0&&(E=Sv.DEFAULT_WIDTH),E},this._getRowHeightFromSettings=function(g){let E=p.rowHeights;if(E!=null){switch(typeof E){case"object":E=E[g];break;case"function":E=E(g);break}typeof E=="string"&&(E=parseInt(E,10))}return E},this.getRowHeight=function(g){let E=s._getRowHeightFromSettings(g);return E=s.runHooks("modifyRowHeight",E,g),E},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const g=p.maxCols,E=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,E)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,E=0;return Py(s.countRows()-1,A=>{if(s.isEmptyRow(A))E+=1;else if(g===!0)return!1}),E},this.countEmptyCols=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,E=0;return Py(s.countCols()-1,A=>{if(s.isEmptyCol(A))E+=1;else if(g===!0)return!1}),E},this.isEmptyRow=function(g){return p.isEmptyRow.call(s,g)},this.isEmptyCol=function(g){return p.isEmptyCol.call(s,g)},this.selectCell=function(g,E,A,U){let G=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,V=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Qt(g)||Qt(E)?!1:this.selectCells([[g,E,A,U]],G,V)},this.selectCells=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;E===!1&&(i=!0);const U=S.selectCells(g);return U&&A&&s.listen(),i=!1,U},this.selectColumns=function(g){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return S.selectColumns(g,E)},this.selectRows=function(g){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;return S.selectRows(g,E)},this.deselectCell=function(){S.deselect()},this.selectAll=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const E=g&&this.hasRowHeaders(),A=g&&this.hasColHeaders();i=!0,S.selectAll(E,A),i=!1};const X=(g,E)=>g.getNearestNotHiddenIndex(E,1,!0);this.scrollViewportTo=function(g,E){let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,U=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,G=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;const V=!A,oe=!U;let j=g,ye=E;if(G){const F=Number.isInteger(g),Y=Number.isInteger(E),q=F?X(this.rowIndexMapper,g):void 0,me=Y?X(this.columnIndexMapper,E):void 0;if(q===null||me===null)return!1;j=F?s.rowIndexMapper.getRenderableFromVisualIndex(q):void 0,ye=Y?s.columnIndexMapper.getRenderableFromVisualIndex(me):void 0}const ee=Number.isInteger(j),T=Number.isInteger(ye);return ee&&T?s.view.scrollViewport(s._createCellCoords(j,ye),V,U,A,oe):ee&&T===!1?s.view.scrollViewportVertically(j,V,A):T&&ee===!1?s.view.scrollViewportHorizontally(ye,U,oe):!1},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),m.clearCache(),Yy(s)){const g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}ks(s.rootElement),o.destroy(),c&&c.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),C.getItems().forEach(g=>{let[,E]=g;E.destroy()}),C.clear(),s.runHooks("afterDestroy")},!0),Ue.getSingleton().destroy(s),ft(s,(g,E,A)=>{qt(g)?A[E]=J(E):E!=="guid"&&(A[E]=null)}),s.isDestroyed=!0,a&&a.destroy(),a=null,u=null,S=null,c=null,s=null};function J(g){return()=>{throw new Error(`The "${g}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(g){const E=ts(g);return E==="UndoRedo"?this.undoRedo:C.getItem(E)},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:C.getId(g)},this.getInstance=function(){return s},this.addHook=function(g,E){Ue.getSingleton().add(g,E,s)},this.hasHook=function(g){return Ue.getSingleton().has(g,s)||Ue.getSingleton().has(g)},this.addHookOnce=function(g,E){Ue.getSingleton().once(g,E,s)},this.removeHook=function(g,E){Ue.getSingleton().remove(g,E,s)},this.runHooks=function(g,E,A,U,G,V,oe){return Ue.getSingleton().run(s,g,E,A,U,G,V,oe)},this.getTranslatedPhrase=function(g,E){return sM(p.language,g,E)},this.toHTML=()=>N7(this),this.toTableElement=()=>{const g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",N7(this)),g.firstElementChild},this.timeouts=[],this._registerTimeout=function(g){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,A=g;typeof A=="function"&&(A=setTimeout(A,E)),this.timeouts.push(A)},this._clearTimeouts=function(){re(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){re(this.immediates,g=>{clearImmediate(g)})},this._refreshBorders=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.destroyEditor(g),s.view.render(),E&&S.isSelected()&&c.prepareEditor()},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const ue=fZ({handleEvent(g){const E=s.isListening(),A=(g==null?void 0:g.key)!==void 0;return E&&A},beforeKeyDown:g=>this.runHooks("beforeKeyDown",g),afterKeyDown:g=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",g)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",g=>{g.ctrlKey===!1&&g.metaKey===!1&&ue.releasePressedKeys()}),this.getShortcutManager=function(){return ue};const se=ue.addContext("grid"),O={runOnlyIf:()=>De(s.getSelected())&&s.countRenderedRows()>0&&s.countRenderedCols()>0,group:mZ};ue.setActiveContextName("grid"),se.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>{s.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:()=>{const g=s.getSelectedRange(),{row:E,col:A}=g[g.length-1].highlight,U=s.getDataAtCell(E,A),G=new Map;for(let V=0;V<g.length;V++)g[V].forAll((oe,j)=>{if(oe>=0&&j>=0&&(oe!==E||j!==A)){const{readOnly:ye}=s.getCellMeta(oe,j);ye||G.set(`${oe}x${j}`,[oe,j,U])}});s.setDataAtCell(Array.from(G.values()))},runOnlyIf:()=>s.getSelectedRangeLast().getCellsCount()>1},{keys:[["ArrowUp"]],callback:()=>{S.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>{S.setRangeStart(s._createCellCoords(s.rowIndexMapper.getNearestNotHiddenIndex(0,1),s.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:()=>{S.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:g,to:E}=s.getSelectedRangeLast(),A=s.rowIndexMapper.getNearestNotHiddenIndex(0,1);S.setRangeStart(g.clone()),S.setRangeEnd(s._createCellCoords(A,E.col))},runOnlyIf:()=>!(s.selection.isSelectedByCorner()||s.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>{S.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>{S.setRangeStart(s._createCellCoords(s.rowIndexMapper.getNearestNotHiddenIndex(s.countRows()-1,-1),s.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:()=>{S.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:g,to:E}=s.getSelectedRangeLast(),A=s.rowIndexMapper.getNearestNotHiddenIndex(s.countRows()-1,-1);S.setRangeStart(g.clone()),S.setRangeEnd(s._createCellCoords(A,E.col))},runOnlyIf:()=>!(s.selection.isSelectedByCorner()||s.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>{S.transformStart(0,-1*s.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>{const g=s.getSelectedRangeLast().highlight.row,E=s.columnIndexMapper.getNearestNotHiddenIndex(...s.isRtl()?[s.countCols()-1,-1]:[0,1]);S.setRangeStart(s._createCellCoords(g,E))}},{keys:[["ArrowLeft","Shift"]],callback:()=>{S.transformEnd(0,-1*s.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:g,to:E}=s.getSelectedRangeLast(),A=s.columnIndexMapper.getNearestNotHiddenIndex(...s.isRtl()?[s.countCols()-1,-1]:[0,1]);S.setRangeStart(g.clone()),S.setRangeEnd(s._createCellCoords(E.row,A))},runOnlyIf:()=>!(s.selection.isSelectedByCorner()||s.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>{S.transformStart(0,s.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>{const g=s.getSelectedRangeLast().highlight.row,E=s.columnIndexMapper.getNearestNotHiddenIndex(...s.isRtl()?[0,1]:[s.countCols()-1,-1]);S.setRangeStart(s._createCellCoords(g,E))}},{keys:[["ArrowRight","Shift"]],callback:()=>{S.transformEnd(0,s.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:g,to:E}=s.getSelectedRangeLast(),A=s.columnIndexMapper.getNearestNotHiddenIndex(...s.isRtl()?[0,1]:[s.countCols()-1,-1]);S.setRangeStart(g.clone()),S.setRangeEnd(s._createCellCoords(E.row,A))},runOnlyIf:()=>!(s.selection.isSelectedByCorner()||s.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>{const g=parseInt(s.getSettings().fixedColumnsStart,10),E=s.getSelectedRangeLast().highlight.row,A=s.columnIndexMapper.getNearestNotHiddenIndex(g,1);S.setRangeStart(s._createCellCoords(E,A))},runOnlyIf:()=>s.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>{S.setRangeEnd(s._createCellCoords(S.selectedRange.current().from.row,s.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>{const g=parseInt(s.getSettings().fixedRowsTop,10),E=parseInt(s.getSettings().fixedColumnsStart,10),A=s.rowIndexMapper.getNearestNotHiddenIndex(g,1),U=s.columnIndexMapper.getNearestNotHiddenIndex(E,1);S.setRangeStart(s._createCellCoords(A,U))},runOnlyIf:()=>s.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>{S.setRangeStart(s._createCellCoords(s.getSelectedRangeLast().highlight.row,s.columnIndexMapper.getNearestNotHiddenIndex(s.countCols()-1,-1)))},runOnlyIf:()=>s.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>{S.setRangeEnd(s._createCellCoords(S.selectedRange.current().from.row,s.columnIndexMapper.getNearestNotHiddenIndex(s.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>{const g=parseInt(s.getSettings().fixedRowsBottom,10),E=s.rowIndexMapper.getNearestNotHiddenIndex(s.countRows()-g-1,-1),A=s.columnIndexMapper.getNearestNotHiddenIndex(s.countCols()-1,-1);S.setRangeStart(s._createCellCoords(E,A))},runOnlyIf:()=>s.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>{S.transformStart(-s.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:()=>{const{to:g}=s.getSelectedRangeLast(),E=Math.max(g.row-s.countVisibleRows(),0),A=s.rowIndexMapper.getNearestNotHiddenIndex(E,1);if(A!==null){const U=s._createCellCoords(A,g.col),G=g.row-s.view.getFirstFullyVisibleRow(),V=Math.max(U.row-G,0);S.setRangeEnd(U),s.scrollViewportTo(V)}}},{keys:[["PageDown"]],callback:()=>{S.transformStart(s.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:()=>{const{to:g}=s.getSelectedRangeLast(),E=Math.min(g.row+s.countVisibleRows(),s.countRows()-1),A=s.rowIndexMapper.getNearestNotHiddenIndex(E,-1);if(A!==null){const U=s._createCellCoords(A,g.col),G=g.row-s.view.getFirstFullyVisibleRow(),V=Math.min(U.row-G,s.countRows()-1);S.setRangeEnd(U),s.scrollViewportTo(V)}}},{keys:[["Tab"]],callback:g=>{const E=typeof p.tabMoves=="function"?p.tabMoves(g):p.tabMoves;S.transformStart(E.row,E.col,!0)}},{keys:[["Shift","Tab"]],callback:g=>{const E=typeof p.tabMoves=="function"?p.tabMoves(g):p.tabMoves;S.transformStart(-E.row,-E.col)}}],O),Jx().forEach(g=>{const E=vv(g);C.addItem(g,new E(this))}),Ue.getSingleton().run(s,"construct")}const W7=215,cM="menu",pZ=cM;class a1{constructor(e,t){this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:W7,container:this.hot.rootDocument.documentElement},this.eventManager=new dn(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=up(e)}setMenuItems(e){this.menuItems=e}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[e]=t}isSubMenu(){return this.parentMenu!==null}open(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const t=Ix(d=>this.openSubMenu(d),300),r=this.options.minWidth||W7;let i=!1,s=Oi(this.menuItems,d=>(d.key===qh&&(i=!0),bq(d,this.hot)));if(s.length<1&&!i)s.push($9()[qh]);else if(s.length===0)return;s=Tq(s,ut);let o=!1;const a={data:s,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(d){return De(d)&&d<r?r:d},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:(d,f,m,p,y,C)=>this.menuItemRenderer(d,f,m,p,y,C)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:(d,f)=>{this.isAllSubMenusClosed()?t(f.row):this.openSubMenu(f.row)},rowHeights:d=>s[d].name===ut?1:23,afterOnCellContextMenu:d=>{d.preventDefault(),ER()&&o&&this.hasSelectedItem()&&this.close(!0)},beforeOnCellMouseUp:d=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(d))},afterOnCellMouseUp:d=>{(!ER()||!sl(d))&&o&&this.hasSelectedItem()&&(Ns()||vx()?setTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new pE(this.container,a),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.addHook("afterSelection",function(){return e.onAfterSelection(...arguments)}),this.hotMenu.init(),this.hotMenu.listen();const l=this.hotMenu.getShortcutManager(),u=l.addContext(pZ),h={...{group:cM},runOnlyIf:d=>dp(d.target)===!1||this.container.contains(d.target)===!1};l.setActiveContextName("menu"),u.addShortcuts([{keys:[["Escape"]],callback:()=>{this.keyEvent=!0,this.close(),this.keyEvent=!1}},{keys:[["ArrowDown"]],callback:()=>{const d=this.hotMenu.getSelectedLast();this.keyEvent=!0,d?this.selectNextCell(d[0],d[1]):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["ArrowUp"]],callback:()=>{const d=this.hotMenu.getSelectedLast();this.keyEvent=!0,d?this.selectPrevCell(d[0],d[1]):this.selectLastCell(),this.keyEvent=!1}},{keys:[["ArrowRight"]],callback:()=>{const d=this.hotMenu.getSelectedLast();if(this.keyEvent=!0,d){const f=this.openSubMenu(d[0]);f&&f.selectFirstCell()}this.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:()=>{const d=this.hotMenu.getSelectedLast();this.keyEvent=!0,d&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen()),this.keyEvent=!1}},{keys:[["Enter"]],callback:d=>{const f=this.hotMenu.getSelectedLast();this.keyEvent=!0,this.hotMenu.getSourceDataAtRow(f[0]).submenu||(this.executeCommand(d),this.close(!0)),this.keyEvent=!1}},{keys:[["PageUp"]],callback:()=>{const d=this.hotMenu.getSelectedLast();this.keyEvent=!0,d?this.hotMenu.selection.transformStart(-this.hotMenu.countVisibleRows(),0):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["PageDown"]],callback:()=>{const d=this.hotMenu.getSelectedLast();this.keyEvent=!0,d?this.hotMenu.selection.transformStart(this.hotMenu.countVisibleRows(),0):this.selectLastCell(),this.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;!this.isOpened()||(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!wq(t))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new a1(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(t.getBoundingClientRect()),this.hotSubMenus[r.key]=i,i}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[t.key];r&&(r.destroy(),delete this.hotSubMenus[t.key])}closeAllSubMenus(){re(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const r=this.hot.getSelectedRange(),i=r?yq(r):[];this.runLocalHooks("executeCommand",t.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,i,e)}isCommandPassive(e){const{isCommand:t,name:r,disabled:i,submenu:s}=e,o=i===!0||typeof i=="function"&&i.call(this.hot)===!0;return t===!1||r===ut||o===!0||s}setPosition(e){const t=new fX(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(t.fitsBelow(this.container)?this.setPositionBelowCursor(t):t.fitsAbove(this.container)?this.setPositionAboveCursor(t):this.setPositionBelowCursor(t),this.hot.isLtr()?this.setHorizontalPositionForLtr(t):this.setHorizontalPositionForRtl(t)):(this.setPositionBelowCursor(t),this.setPositionOnRightOfCursor(t))}setHorizontalPositionForRtl(e){e.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(e):this.setPositionOnRightOfCursor(e)}setHorizontalPositionForLtr(e){e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)}setPositionAboveCursor(e){let t=this.offset.above+e.top-this.container.offsetHeight;this.isSubMenu()&&(t=e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top=`${t}px`}setPositionBelowCursor(e){let t=this.offset.below+e.top+1;this.isSubMenu()&&(t=e.top-1),this.container.style.top=`${t}px`}setPositionOnRightOfCursor(e){let t=e.left;if(this.isSubMenu()){const{right:r}=this.parentMenu.container.getBoundingClientRect();t+=e.cellWidth+r-(e.left+e.cellWidth)}else t+=this.offset.right;this.container.style.left=`${t}px`}setPositionOnLeftOfCursor(e){let t=this.offset.left+e.left-this.container.offsetWidth;if(this.isSubMenu()){const{left:r}=this.parentMenu.container.getBoundingClientRect();t-=e.left-r}this.container.style.left=`${t}px`}selectFirstCell(){const e=this.hotMenu.getCell(0,0);bf(e)||Sf(e)||Rf(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}selectLastCell(){const e=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(e,0);bf(t)||Sf(t)||Rf(t)?this.selectPrevCell(e,0):(this.hotMenu.selectCell(e,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(e,0,!0,!1))}selectNextCell(e,t){const r=e+1,i=r<this.hotMenu.countRows()?this.hotMenu.getCell(r,t):null;!i||(bf(i)||Sf(i)||Rf(i)?this.selectNextCell(r,t):this.hotMenu.selectCell(r,t))}selectPrevCell(e,t){const r=e-1,i=r>=0?this.hotMenu.getCell(r,t):null;!i||(bf(i)||Sf(i)||Rf(i)?this.selectPrevCell(r,t):this.hotMenu.selectCell(r,t))}menuItemRenderer(e,t,r,i,s,o){const a=e.getSourceDataAtRow(r),l=this.hot.rootDocument.createElement("div"),u=m=>Sn(m,"submenu"),c=m=>new RegExp(ut,"i").test(m.name),h=m=>m.disabled===!0||typeof m.disabled=="function"&&m.disabled.call(this.hot)===!0,d=m=>m.disableSelection;let f=o;typeof f=="function"&&(f=f.call(this.hot)),ks(t),Ae(l,"htItemWrapper"),t.appendChild(l),c(a)?Ae(t,"htSeparator"):typeof a.renderer=="function"?(Ae(t,"htCustomMenuRenderer"),t.appendChild(a.renderer(e,l,r,i,s,f))):pc(l,f),h(a)?(Ae(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell())):d(a)?(Ae(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell())):u(a)?(Ae(t,"htSubmenu"),d(a)?this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell()):this.eventManager.addEventListener(t,"mouseenter",()=>e.selectCell(r,i,void 0,void 0,!1,!1))):(tt(t,["htSubmenu","htDisabled"]),d(a)?this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell()):this.eventManager.addEventListener(t,"mouseenter",()=>e.selectCell(r,i,void 0,void 0,!1,!1)))}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const t=this.options.container.ownerDocument;let r=e,i;return r&&(qt(r)&&(r=r.call(this.hot),r===null||Qt(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=t.querySelector(`.${this.options.className}.${r}`)),i||(i=t.createElement("div"),Ae(i,`htMenu ${this.options.className}`),r&&Ae(i,r),this.options.container.appendChild(i)),i}blockMainTableCallbacks(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}releaseMainTableCallbacks(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,s=parseInt(r.width,10),o=Tr(t,(a,l)=>a+(l.name===ut?1:26),0);i.width=`${s+3}px`,i.height=`${o+3}px`,r.height=i.height}onAfterSelection(e,t,r,i,s){this.keyEvent===!1&&(s.value=!0)}onDocumentMouseDown(e){!this.isOpened()||(this.options.standalone&&this.hotMenu&&!tl(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!tl(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){!this.isOpened()||Je(e.target,"htCore")&&tl(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Yt(a1,ni);const gE=a1,Nf="contextMenu",gZ=70;Ue.getSingleton().register("afterContextMenuDefaultOptions");Ue.getSingleton().register("beforeContextMenuShow");Ue.getSingleton().register("afterContextMenuShow");Ue.getSingleton().register("afterContextMenuHide");Ue.getSingleton().register("afterContextMenuExecute");class l1 extends Lt{static get PLUGIN_KEY(){return Nf}static get PLUGIN_PRIORITY(){return gZ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[t1,n1,ut,Ud,Bd,ut,e1,$d,ut,r1,Qg,ut,Vd,ut,Si]}constructor(e){super(e),this.eventManager=new dn(this),this.commandExecutor=new B9(this.hot),this.itemsFactory=null,this.menu=null}isEnabled(){return!!this.hot.getSettings()[Nf]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Nf];typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new gE(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>this.onAfterOnCellContextMenu(r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),super.disablePlugin()}open(e){if(!this.menu||(this.prepareMenuItems(),this.menu.open(),!this.menu.isOpened()))return;let t=0,r=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){const{frameElement:i}=this.hot.rootWindow,{top:s,left:o}=i.getBoundingClientRect();t=s-zh(e.view),r=o-Yu(e.view)}else t=-1*zh(this.menu.hotMenu.rootWindow),r=-1*Yu(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(e.pageY,10)+t,left:parseInt(e.pageX,10)+r})}close(){!this.menu||(this.menu.close(),this.itemsFactory=null)}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new W9(this.hot,l1.DEFAULT_ITEMS);const e=this.hot.getSettings()[Nf],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),re(r,i=>this.commandExecutor.registerCommand(i.key,i))}onAfterOnCellContextMenu(e){const t=this.hot.getSettings(),r=t.rowHeaders,i=t.colHeaders;function s(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=e.target;this.close(),!Je(o,"handsontableInput")&&(e.preventDefault(),e.stopPropagation(),!(!(r||i)&&!s(o)&&!(Je(o,"current")&&Je(o,"wtBorder")))&&this.open(e))}onMenuBeforeOpen(){this.hot.runHooks("beforeContextMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterContextMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}l1.SEPARATOR={name:ut};function yZ(n){return{key:"copy",name(){return this.getTranslatedPhrase(tC)},callback(){n.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function wZ(n){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(iC,t)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function vZ(n){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(rC,t)},callback(){n.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function CZ(n){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(nC,t)},callback(){n.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function EZ(n){return{key:"cut",name(){return this.getTranslatedPhrase(sC)},callback(){n.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}class bZ{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class SZ{constructor(){this.clipboardData=new bZ}}class yE{constructor(e){this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new dn(this),this.listenersCount=new WeakSet,this.container=e}useSecondaryElement(){const e=AZ(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),G7(this.eventManager,e,this)),this.mainElement=e}setFocusableElement(e){this.listenersCount.has(e)||(this.listenersCount.add(e),G7(this.eventManager,e,this)),this.mainElement=e}getFocusableElement(){return this.mainElement}focus(){this.mainElement.value=" ",Ns()||XW(this.mainElement)}}Yt(yE,ni);const Cp=new WeakMap;function RZ(n){const e=new yE(n);let t=Cp.get(n);return t=isNaN(t)?0:t,Cp.set(n,t+1),e}function TZ(n){n.eventManager.clear()}const H2=(n,e)=>t=>e.runLocalHooks(n,t);function G7(n,e,t){n.addEventListener(e,"copy",H2("copy",t)),n.addEventListener(e,"cut",H2("cut",t)),n.addEventListener(e,"paste",H2("paste",t))}const Ep=new WeakMap;function AZ(n){const e=Ep.get(n);if(e)return e.parentElement||n.appendChild(e),e;const r=(n.defaultView?n:n.ownerDocument).createElement("textarea");return Ep.set(n,r),r.setAttribute("data-hot-input",""),r.className="HandsontableCopyPaste",r.tabIndex=-1,r.autocomplete="off",r.wrap="hard",r.value=" ",n.appendChild(r),r}function z7(n){if(!(n instanceof yE))return;let e=Cp.get(n.container);if(e=isNaN(e)?0:e,e>0&&(e-=1),TZ(n),e<=0){e=0;const t=Ep.get(n.container);t&&t.parentNode&&(t.parentNode.removeChild(t),Ep.delete(n.container)),n.mainElement=null}Cp.set(n.container,e)}function Y7(n,e){hM(n,e),e.add(n)}function jl(n,e,t){hM(n,e),e.set(n,t)}function hM(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function If(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function Nr(n,e){var t=dM(n,e,"get");return xZ(n,t)}function xZ(n,e){return e.get?e.get.call(n):e.value}function Kl(n,e,t){var r=dM(n,e,"set");return MZ(n,r,t),t}function dM(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function MZ(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Io=new WeakMap,U2=new WeakMap,Fc=new WeakMap,qy=new WeakMap,Xy=new WeakMap,Hc=new WeakMap,Of=new WeakSet,j7=new WeakSet;class NZ{constructor(e){let{countRows:t,countColumns:r,rowsLimit:i,columnsLimit:s,countColumnHeaders:o}=e;Y7(this,j7),Y7(this,Of),jl(this,Io,{writable:!0,value:void 0}),jl(this,U2,{writable:!0,value:void 0}),jl(this,Fc,{writable:!0,value:void 0}),jl(this,qy,{writable:!0,value:void 0}),jl(this,Xy,{writable:!0,value:void 0}),jl(this,Hc,{writable:!0,value:void 0}),Kl(this,U2,t),Kl(this,Fc,r),Kl(this,qy,i),Kl(this,Xy,s),Kl(this,Hc,o)}setSelectedRange(e){Kl(this,Io,e)}getCellsRange(){if(Nr(this,U2).call(this)===0||Nr(this,Fc).call(this)===0)return null;const{row:e,col:t}=Nr(this,Io).getTopStartCorner(),{row:r,col:i}=Nr(this,Io).getBottomEndCorner(),s=If(this,j7,IZ).call(this,e,r),o=If(this,Of,B2).call(this,t,i);return{isRangeTrimmed:r!==s||i!==o,startRow:e,startCol:t,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(Nr(this,Fc).call(this)===0||Nr(this,Hc).call(this)===0)return null;const{col:e}=Nr(this,Io).getTopStartCorner(),{col:t}=Nr(this,Io).getBottomEndCorner(),r=If(this,Of,B2).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Nr(this,Fc).call(this)===0||Nr(this,Hc).call(this)===0)return null;const{col:e}=Nr(this,Io).getTopStartCorner(),{col:t}=Nr(this,Io).getBottomEndCorner(),r=If(this,Of,B2).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-Nr(this,Hc).call(this),startCol:e,endRow:-1,endCol:r}}}function B2(n,e){return Math.min(e,Math.max(n+Nr(this,Xy).call(this)-1,n))}function IZ(n,e){return Math.min(e,Math.max(n+Nr(this,qy).call(this)-1,n))}function fM(n){const e=[],t=[];return re(n,r=>{const i=Math.min(r.startRow,r.endRow),s=Math.max(r.startRow,r.endRow);ze(i,s,l=>{e.indexOf(l)===-1&&e.push(l)});const o=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);ze(o,a,l=>{t.indexOf(l)===-1&&t.push(l)})}),{rows:e,columns:t}}function OZ(n,e){mM(n,e),e.add(n)}function xa(n,e,t){mM(n,e),e.set(n,t)}function mM(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ql(n,e,t){return e=_Z(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _Z(n){var e=LZ(n,"string");return typeof e=="symbol"?e:String(e)}function LZ(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function PZ(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function ri(n,e){var t=pM(n,e,"get");return DZ(n,t)}function DZ(n,e){return e.get?e.get.call(n):e.value}function Qs(n,e,t){var r=pM(n,e,"set");return kZ(n,r,t),t}function pM(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function kZ(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}Ue.getSingleton().register("afterCopyLimit");Ue.getSingleton().register("modifyCopyableRange");Ue.getSingleton().register("beforeCut");Ue.getSingleton().register("afterCut");Ue.getSingleton().register("beforePaste");Ue.getSingleton().register("afterPaste");Ue.getSingleton().register("beforeCopy");Ue.getSingleton().register("afterCopy");const _f="copyPaste",FZ=80,HZ=["fragmentSelection"],K7=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var V2=new WeakMap,$2=new WeakMap,W2=new WeakMap,Xl=new WeakMap,Lf=new WeakMap,Pf=new WeakMap,Ql=new WeakMap,q7=new WeakSet;class UZ extends Lt{constructor(){super(...arguments),OZ(this,q7),ql(this,"columnsLimit",1/0),ql(this,"rowsLimit",1/0),ql(this,"pasteMode","overwrite"),ql(this,"uiContainer",this.hot.rootDocument.body),xa(this,V2,{writable:!0,value:!1}),xa(this,$2,{writable:!0,value:!1}),xa(this,W2,{writable:!0,value:!1}),xa(this,Xl,{writable:!0,value:"cells-only"}),xa(this,Lf,{writable:!0,value:!1}),xa(this,Pf,{writable:!0,value:!1}),xa(this,Ql,{writable:!0,value:new NZ({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),ql(this,"copyableRanges",[]),ql(this,"focusableElement",void 0)}static get PLUGIN_KEY(){return _f}static get SETTING_KEYS(){return[_f,...HZ]}static get PLUGIN_PRIORITY(){return FZ}isEnabled(){return!!this.hot.getSettings()[_f]}enablePlugin(){if(this.enabled)return;const{[_f]:e}=this.hot.getSettings();if(typeof e=="object"){var t,r;this.pasteMode=(t=e.pasteMode)!==null&&t!==void 0?t:this.pasteMode,this.rowsLimit=isNaN(e.rowsLimit)?this.rowsLimit:e.rowsLimit,this.columnsLimit=isNaN(e.columnsLimit)?this.columnsLimit:e.columnsLimit,Qs(this,V2,!!e.copyColumnHeaders),Qs(this,$2,!!e.copyColumnGroupHeaders),Qs(this,W2,!!e.copyColumnHeadersOnly),this.uiContainer=(r=e.uiContainer)!==null&&r!==void 0?r:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",i=>this.onAfterContextMenuDefaultOptions(i)),this.addHook("afterOnCellMouseUp",()=>this.onAfterOnCellMouseUp()),this.addHook("afterSelectionEnd",()=>this.onAfterSelectionEnd()),this.addHook("beforeKeyDown",()=>this.onBeforeKeyDown()),this.focusableElement=RZ(this.uiContainer),this.focusableElement.addLocalHook("copy",i=>this.onCopy(i)).addLocalHook("cut",i=>this.onCut(i)).addLocalHook("paste",i=>this.onPaste(i)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),super.updatePlugin()}disablePlugin(){this.focusableElement&&z7(this.focusableElement),super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Qs(this,Xl,e),Qs(this,Lf,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Qs(this,Pf,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}getRangedCopyableData(e){return vh(this.getRangedData(e))}getRangedData(e){const t=[],{rows:r,columns:i}=fM(e);return re(r,s=>{const o=[];re(i,a=>{s<0?o.push(this.hot.getColHeader(a,s)):o.push(this.hot.getCopyableData(s,a))}),t.push(o)}),t}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const r=new SZ;e&&r.clipboardData.setData("text/plain",e),t&&r.clipboardData.setData("text/html",t),this.getOrCreateFocusableElement(),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;ri(this,Ql).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);ri(this,Xl)==="column-headers-only"?t.set("headers",ri(this,Ql).getMostBottomColumnHeadersRange()):(ri(this,Xl)==="with-column-headers"?t.set("headers",ri(this,Ql).getMostBottomColumnHeadersRange()):ri(this,Xl)==="with-column-group-headers"&&t.set("headers",ri(this,Ql).getAllColumnHeadersRange()),t.set("cells",ri(this,Ql).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(i=>i!==null).map(i=>{let{startRow:s,startCol:o,endRow:a,endCol:l}=i;return{startRow:s,startCol:o,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=t.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:s,endRow:o,endCol:a}=r;this.hot.runHooks("afterCopyLimit",o-i+1,a-s+1,this.rowsLimit,this.columnsLimit)}}getOrCreateFocusableElement(){var e;const t=(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA;t?this.focusableElement.setFocusableElement(t):this.focusableElement.useSecondaryElement()}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,s=[],{row:o,col:a}=t.getTopStartCorner(),{row:l,col:u}=t.getBottomEndCorner();let c=o,h=a,d=o,f=a;for(;s.length<r||c<=l;){const{skipRowOnPaste:m,visualRow:p}=this.hot.getCellMeta(c,a);if(c=p+1,m===!0)continue;d=p,h=a;const y=[],C=s.length%r;for(;y.length<i||h<=u;){const{skipColumnOnPaste:b,visualCol:v}=this.hot.getCellMeta(o,h);if(h=v+1,b===!0)continue;f=v;const S=y.length%i;y.push(e[C][S])}s.push(y)}return this.hot.populateFromArray(o,a,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,d,f]}onCopy(e){if(!this.hot.isListening()&&!ri(this,Lf)||this.isEditorOpened())return;this.setCopyableText(),Qs(this,Lf,!1);const t=this.getRangedData(this.copyableRanges),r=PZ(this,q7,BZ).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",t,this.copyableRanges,r)){const s=vh(t);if(e&&e.clipboardData){const o=I7(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",s),e.clipboardData.setData("text/html",[K7,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",t,this.copyableRanges,r)}Qs(this,Xl,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!ri(this,Pf)||this.isEditorOpened())return;this.setCopyableText(),Qs(this,Pf,!1);const t=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",t,this.copyableRanges)){const i=vh(t);if(e&&e.clipboardData){const s=I7(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[K7,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",t,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened())return;e&&e.preventDefault&&e.preventDefault();let t;if(e&&typeof e.clipboardData<"u"){const a=nv(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?t=JX(a,this.hot.rootDocument).data:t=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof t=="string"&&(t=XQ(t)),t&&t.length===0||this.hot.runHooks("beforePaste",t,this.copyableRanges)===!1)return;const[r,i,s,o]=this.populateValues(t);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,s),Math.min(this.hot.countCols()-1,o)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}onAfterContextMenuDefaultOptions(e){e.items.push({name:"---------"},yZ(this)),ri(this,V2)&&e.items.push(CZ(this)),ri(this,$2)&&e.items.push(vZ(this)),ri(this,W2)&&e.items.push(wZ(this)),e.items.push(EZ(this))}onAfterOnCellMouseUp(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}onAfterSelectionEnd(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&YW())&&(this.setCopyableText(),this.focusableElement.focus()))}onBeforeKeyDown(){if(!this.hot.isListening()||this.isEditorOpened())return;const e=this.hot.rootDocument.activeElement,t=this.hot.getActiveEditor();!t||e!==this.focusableElement.getFocusableElement()&&e!==t.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}destroy(){this.focusableElement&&(z7(this.focusableElement),this.focusableElement=null),super.destroy()}}function BZ(n){const{rows:e}=fM(n);let t=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)t+=1;return{columnHeadersCount:t}}function gM(n,e){return`border_row${n}col${e}`}function ih(){return{width:1,color:"#000"}}function mo(){return{hide:!0}}function VZ(){return{width:1,color:"#000",cornerVisible:!1}}function G2(n){if(De(n.start)||De(n.left)){var e;n.start=(e=n.start)!==null&&e!==void 0?e:n.left}if(De(n.end)||De(n.right)){var t;n.end=(t=n.end)!==null&&t!==void 0?t:n.right}return delete n.left,delete n.right,n}function Uc(n){return De(n.start)&&(n.left=n.start),De(n.end)&&(n.right=n.end),n}function z2(n,e){return{id:gM(n,e),border:VZ(),row:n,col:e,top:mo(),bottom:mo(),start:mo(),end:mo()}}function $Z(n,e){return Sn(e,"border")&&e.border&&(n.border=e.border),Sn(e,"top")&&De(e.top)&&(e.top?(dt(e.top)||(e.top=ih()),n.top=e.top):(e.top=mo(),n.top=e.top)),Sn(e,"bottom")&&De(e.bottom)&&(e.bottom?(dt(e.bottom)||(e.bottom=ih()),n.bottom=e.bottom):(e.bottom=mo(),n.bottom=e.bottom)),Sn(e,"start")&&De(e.start)&&(e.start?(dt(e.start)||(e.start=ih()),n.start=e.start):(e.start=mo(),n.start=e.start)),Sn(e,"end")&&De(e.end)&&(e.end?(dt(e.end)||(e.end=ih()),n.end=e.end):(e.end=mo(),n.end=e.end)),n}function Eo(n,e){let t=!1;return re(n.getSelectedRange(),r=>{r.forAll((i,s)=>{if(i<0||s<0)return;const o=n.getCellMeta(i,s).borders;if(o)if(e){if(!Sn(o[e],"hide")||o[e].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function u1(n){return`<span class="selected">${String.fromCharCode(10003)}</span>${n}`}function WZ(n){return n.some(e=>De(e.left)||De(e.right))}function GZ(n){return n.some(e=>De(e.start)||De(e.end))}const zZ=new Map([["left","start"],["right","end"]]);function YZ(n){var e;return(e=zZ.get(n))!==null&&e!==void 0?e:n}function jZ(n){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(TC);return Eo(this,"bottom")&&(e=u1(e)),e},callback(e,t){const r=Eo(this,"bottom");n.prepareBorder(t,"bottom",r)}}}function KZ(n){const e=n.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(AC);return Eo(this,e)&&(t=u1(t)),t},callback(t,r){const i=Eo(this,e);n.prepareBorder(r,e,i)}}}function qZ(n){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(xC)},callback(e,t){n.prepareBorder(t,"noBorders")},disabled(){return!Eo(this)}}}function XZ(n){const e=n.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(RC);return Eo(this,e)&&(t=u1(t)),t},callback(t,r){const i=Eo(this,e);n.prepareBorder(r,e,i)}}}function QZ(n){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(SC);return Eo(this,"top")&&(e=u1(e)),e},callback(e,t){const r=Eo(this,"top");n.prepareBorder(t,"top",r)}}}function ZZ(n,e,t){return e=JZ(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function JZ(n){var e=eJ(n,"string");return typeof e=="symbol"?e:String(e)}function eJ(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Df="customBorders",tJ=90;class nJ extends Lt{constructor(){super(...arguments),ZZ(this,"savedBorders",[])}static get PLUGIN_KEY(){return Df}static get PLUGIN_PRIORITY(){return tJ}isEnabled(){return!!this.hot.getSettings()[Df]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.onAfterContextMenuDefaultOptions(e)),this.addHook("init",()=>this.onAfterInit()),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let r=["top","bottom","start","end"],i=null;t&&(this.checkSettingsCohesion([t]),r=Object.keys(t),i=G2(t));const s=Xu(e),o=Kh(s);re(e,a=>{const[l,u,c,h]=o(a);for(let d=l;d<=c;d+=1)for(let f=u;f<=h;f+=1)re(r,m=>{this.prepareBorderFromCustomAdded(d,f,i,YZ(m))})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=Xu(e),r=Kh(t),i=[];return re(e,s=>{const[o,a,l,u]=r(s);for(let c=o;c<=l;c+=1)for(let h=a;h<=u;h+=1)re(this.savedBorders,d=>{d.row===c&&d.col===h&&i.push(Uc(d))})}),i}clearBorders(e){e?this.setBorders(e):(re(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,t,r,i){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||t>=o)return;let a=z2(e,t);r&&(a=$Z(a,r),re(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",Uc(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,t){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);ze(e.from.row,r,s=>{ze(e.from.col,i,o=>{const a=z2(s,o);let l=0;s===e.from.row&&Sn(t,"top")&&(l+=1,a.top=t.top),s===e.to.row&&Sn(t,"bottom")&&(l+=1,a.bottom=t.bottom),o===e.from.col&&Sn(t,"start")&&(l+=1,a.start=t.start),o===e.to.col&&Sn(t,"end")&&(l+=1,a.end=t.end),l>0&&(this.hot.setCellMeta(s,o,"borders",Uc(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,t){const r=gM(e,t);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,r,i){let s=this.hot.getCellMeta(e,t).borders;!s||s.border===void 0?s=z2(e,t):s=G2(s),i?(s[r]=mo(),this.countHide(s)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(s,r,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,t,"borders",Uc(s)))):(s[r]=ih(),this.checkCustomSelectionsFromContextMenu(s,r,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,t,"borders",Uc(s)))}prepareBorder(e,t,r){re(e,i=>{let{start:s,end:o}=i;if(s.row===o.row&&s.col===o.col)t==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,t,r);else switch(t){case"noBorders":ze(s.col,o.col,a=>{ze(s.row,o.row,l=>{this.removeAllBorders(l,a)})});break;case"top":ze(s.col,o.col,a=>{this.setBorder(s.row,a,t,r)});break;case"bottom":ze(s.col,o.col,a=>{this.setBorder(o.row,a,t,r)});break;case"start":ze(s.row,o.row,a=>{this.setBorder(a,s.col,t,r)});break;case"end":ze(s.row,o.row,a=>{this.setBorder(a,o.col,t,r)});break}})}createCustomBorders(e){re(e,t=>{const r=G2(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,r):this.prepareBorderFromCustomAdded(t.row,t.col,r)})}countHide(e){const{top:t,bottom:r,start:i,end:s}=e;return Tr([t,r,i,s],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const t=ct(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){re(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){re(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=ct(this.savedBorders,r=>r.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):re(this.savedBorders,(i,s)=>{if(e.id===i.id)return this.savedBorders[s]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,r){let i=!1;return re(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id)return ft(s.instanceBorders,o=>{o.toggleHiddenClass(t,r)}),i=!0,!1}),i}checkCustomSelections(e,t,r){const i=this.countHide(e);let s=!1;return i===4?(this.removeAllBorders(e.row,e.col),s=!0):re(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id)return o.visualCellRange=t,o.commit(),r&&ft(o.instanceBorders,a=>{a.changeBorderStyle(r,e)}),s=!0,!1}),s}changeBorderSettings(){const e=this.hot.getSettings()[Df];if(Array.isArray(e)){const t=kr(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=WZ(e),r=GZ(e);if(t&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}onAfterContextMenuDefaultOptions(e){!this.hot.getSettings()[Df]||e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(bC)},disabled(){return this.selection.isSelectedByCorner()},submenu:{items:[QZ(this),XZ(this),jZ(this),KZ(this),qZ(this)]}})}onAfterInit(){this.changeBorderSettings()}destroy(){super.destroy()}}const X7="dragToScroll",rJ=100;class iJ extends Lt{static get PLUGIN_KEY(){return X7}static get PLUGIN_PRIORITY(){return rJ}constructor(e){super(e),this.eventManager=new dn(this),this.boundaries=null,this.callback=null,this.listening=!1}isEnabled(){return!!this.hot.getSettings()[X7]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>this.setupListening(e)),this.addHook("afterOnCellCornerMouseDown",e=>this.setupListening(e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let r=0,i=0;t<this.boundaries.top?i=t-this.boundaries.top:t>this.boundaries.bottom&&(i=t-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",r=>this.onMouseMove(r)),t=up(t)}unregisterEvents(){this.eventManager.clear()}setupListening(e){if(sl(e))return;const t=this.hot.view._wt.wtTable.holder;t!==this.hot.rootWindow&&(this.setBoundaries(t.getBoundingClientRect()),this.setCallback((r,i)=>{r<0?t.scrollLeft-=50:r>0&&(t.scrollLeft+=50),i<0?t.scrollTop-=20:i>0&&(t.scrollTop+=20)}),this.listen())}onMouseMove(e){!this.isListening()||this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}Ue.getSingleton().register("afterDropdownMenuDefaultOptions");Ue.getSingleton().register("beforeDropdownMenuShow");Ue.getSingleton().register("afterDropdownMenuShow");Ue.getSingleton().register("afterDropdownMenuHide");Ue.getSingleton().register("afterDropdownMenuExecute");const Y2="dropdownMenu",sJ=230,j2="changeType";class c1 extends Lt{static get PLUGIN_KEY(){return Y2}static get PLUGIN_PRIORITY(){return sJ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Ud,Bd,ut,$d,ut,Xg,ut,Vd,ut,Si]}constructor(e){super(e),this.eventManager=new dn(this),this.commandExecutor=new B9(this.hot),this.itemsFactory=null,this.menu=null,this.hot.addHook("afterGetColHeader",(t,r)=>this.onAfterGetColHeader(t,r))}isEnabled(){return this.hot.getSettings()[Y2]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new W9(this.hot,c1.DEFAULT_ITEMS);const t=this.hot.getSettings()[Y2],r={items:this.itemsFactory.getItems(t)};this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new gE(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),re(i,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),super.disablePlugin()}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>this.onTableClick(e))}open(e){!this.menu||(this.menu.open(),e.width&&this.menu.setOffset("left",e.width),this.menu.setPosition(e))}close(){!this.menu||this.menu.close()}executeCommand(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}onTableClick(e){if(e.stopPropagation(),Je(e.target,j2)&&!this.menu.isOpened()){let t=0,r=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){const{frameElement:s}=this.hot.rootWindow,{top:o,left:a}=s.getBoundingClientRect();t=o,r=a}const i=e.target.getBoundingClientRect();this.open({left:i.left+r,top:i.top+e.target.offsetHeight+3+t,width:i.width,height:i.height})}}onAfterGetColHeader(e,t){const r=t.parentNode;if(!r)return;const i=r.parentNode.childNodes,s=Array.prototype.indexOf.call(i,r);if(e<0||s!==i.length-1)return;const o=t.querySelector(`.${j2}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const a=this.hot.rootDocument.createElement("button");a.className=j2,a.type="button",a.onclick=function(){return!1},t.firstChild.insertBefore(a,t.firstChild.firstChild)}onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}c1.SEPARATOR={name:ut};class oJ{constructor(e){this.hot=e,this.options={}}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:r,endCol:i}=this._getDataRange(),s=this.options,o=[];return ze(e,r,a=>{const l=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(ze(t,i,u=>{!s.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),o.push(l))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();ze(t,r,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(i[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();ze(t,r,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(i[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[r=0,i=0,s=t,o=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),s=Math.min(s,t),o=Math.min(o,e),{startRow:r,startCol:i,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const aJ=oJ;class wE{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=Xr(this.constructor.DEFAULT_OPTIONS);const r=new Date;return t=Un(Xr(wE.DEFAULT_OPTIONS),t),t=Un(t,e),t.filename=Tx(t.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),t}}const lJ=wE,uJ=String.fromCharCode(13),cJ=String.fromCharCode(34),hJ=String.fromCharCode(10);class dJ extends lJ{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,t=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?String.fromCharCode(65279):"";return i&&(r=ct(r,l=>this._escapeCell(l,!0)),o&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),re(t,(l,u)=>{u>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=In(e);return r!==""&&(t||r.indexOf(uJ)>=0||r.indexOf(cJ)>=0||r.indexOf(hJ)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const fJ=dJ,mJ="csv",Qy={[mJ]:fJ};function pJ(n,e,t){return typeof Qy[n]=="function"?new Qy[n](e,t):null}const gJ="exportFile",yJ=240;class wJ extends Lt{static get PLUGIN_KEY(){return gJ}static get PLUGIN_PRIORITY(){return yJ}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,s=this._createTypeFormatter(e,t),o=this._createBlob(s),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${s.options.filename}.${s.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(o);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,u)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Qy[e])throw new Error(`Export format type "${e}" is not supported.`);return pJ(e,new aJ(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}class yM{constructor(e,t){let{id:r,stateless:i=!0}=t;this.hot=e,this.id=r,this.elements=[],this.hidden=!1,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Yg)}reset(){re(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),re(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}Yt(yM,ni);const h1=yM,Zh={};function oa(n,e){if(!Zh[n])throw Error(`Filter condition "${n}" does not exist.`);const{condition:t,descriptor:r}=Zh[n];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(s){return t.apply(s.meta.instance,[].concat([s],[i]))}}function Ya(n){if(!Zh[n])throw Error(`Filter condition "${n}" does not exist.`);return Zh[n].descriptor}function _n(n,e,t){t.key=n,Zh[n]={condition:e,descriptor:t}}const Qn="none";function vJ(){return!0}_n(Qn,vJ,{name:Kg,inputsCount:0,showOperators:!1});const Ch="empty";function CJ(n){return zn(n.value)}_n(Ch,CJ,{name:PC,inputsCount:0,showOperators:!0});const Dm="not_empty";function EJ(n,e){return!oa(Ch,e)(n)}_n(Dm,EJ,{name:DC,inputsCount:0,showOperators:!0});const Eh="eq";function bJ(n,e){let[t]=e;return In(n.value).toLocaleLowerCase(n.meta.locale)===In(t)}_n(Eh,bJ,{name:kC,inputsCount:1,showOperators:!0});const km="neq";function SJ(n,e){return!oa(Eh,e)(n)}_n(km,SJ,{name:FC,inputsCount:1,showOperators:!0});const wM="gt";function RJ(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value>r}_n(wM,RJ,{name:$C,inputsCount:1,showOperators:!0});const vM="gte";function TJ(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value>=r}_n(vM,TJ,{name:WC,inputsCount:1,showOperators:!0});const CM="lt";function AJ(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value<r}_n(CM,AJ,{name:GC,inputsCount:1,showOperators:!0});const EM="lte";function xJ(n,e){let[t]=e,r=t;return n.meta.type==="numeric"&&(r=parseFloat(r,10)),n.value<=r}_n(EM,xJ,{name:zC,inputsCount:1,showOperators:!0});const vE="date_after";function MJ(n,e){let[t]=e;const r=It(n.value,n.meta.dateFormat),i=It(t,n.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}_n(vE,MJ,{name:KC,inputsCount:1,showOperators:!0});const CE="date_before";function NJ(n,e){let[t]=e;const r=It(n.value,n.meta.dateFormat),i=It(t,n.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}_n(CE,NJ,{name:qC,inputsCount:1,showOperators:!0});const bp="between";function IJ(n,e){let[t,r]=e,i=t,s=r;if(n.meta.type==="numeric"){const o=parseFloat(i,10),a=parseFloat(s,10);i=Math.min(o,a),s=Math.max(o,a)}else if(n.meta.type==="date"){const o=oa(CE,[s]),a=oa(vE,[i]);return o(n)&&a(n)}return n.value>=i&&n.value<=s}_n(bp,IJ,{name:YC,inputsCount:2,showOperators:!0});const bM="not_between";function OJ(n,e){return!oa(bp,e)(n)}_n(bM,OJ,{name:jC,inputsCount:2,showOperators:!0});const SM="begins_with";function _J(n,e){let[t]=e;return In(n.value).toLocaleLowerCase(n.meta.locale).startsWith(In(t))}_n(SM,_J,{name:HC,inputsCount:1,showOperators:!0});const RM="ends_with";function LJ(n,e){let[t]=e;return In(n.value).toLocaleLowerCase(n.meta.locale).endsWith(In(t))}_n(RM,LJ,{name:UC,inputsCount:1,showOperators:!0});const EE="contains";function PJ(n,e){let[t]=e;return In(n.value).toLocaleLowerCase(n.meta.locale).indexOf(In(t))>=0}_n(EE,PJ,{name:BC,inputsCount:1,showOperators:!0});const TM="not_contains";function DJ(n,e){return!oa(EE,e)(n)}_n(TM,DJ,{name:VC,inputsCount:1,showOperators:!0});const AM="date_tomorrow";function kJ(n){const e=It(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(It().subtract(-1,"days").startOf("day"),"d"):!1}_n(AM,kJ,{name:QC,inputsCount:0});const xM="date_today";function FJ(n){const e=It(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(It().startOf("day"),"d"):!1}_n(xM,FJ,{name:XC,inputsCount:0});const MM="date_yesterday";function HJ(n){const e=It(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(It().subtract(1,"days").startOf("day"),"d"):!1}_n(MM,HJ,{name:ZC,inputsCount:0});Vz();function UJ(n,e){let t=n;return t===""&&(t=`(${e})`),t}const Zy=new Set([1]).has(1),BJ=Zy&&typeof Array.from=="function";function Gd(n){let e=n;return Zy&&(e=new Set(e)),function(t){let r;return Zy?r=e.has(t):r=!!~e.indexOf(t),r}}function NM(n){return n==null?"":n}function Jy(n){let e=n;return BJ?e=Array.from(new Set(e)):e=dx(e),e=e.sort((t,r)=>typeof t=="number"&&typeof r=="number"?t-r:t===r?0:t>r?1:-1),e}function Q7(n,e,t,r){const i=[],s=n===e;let o;return s||(o=Gd(e)),re(n,a=>{let l=!1;(s||o(a))&&(l=!0);const u={checked:l,value:a,visualValue:UJ(a,t)};r&&r(u),i.push(u)}),i}const ja="by_value";function VJ(n,e){let[t]=e;return t(n.value)}_n(ja,VJ,{name:"By value",inputsCount:0,inputValuesDecorator(n){let[e]=n;return[Gd(e)]},showOperators:!1});const Jh={};function $J(n){if(!Jh[n])throw Error(`Operation with id "${n}" does not exist.`);const e=Jh[n].func;return function(t,r){return e(t,r)}}function WJ(n){return Jh[n].name}function bE(n,e,t){Jh[n]={name:e,func:t}}const ea="conjunction",GJ=tE;function zJ(n,e){return n.every(t=>t.func(e))}bE(ea,GJ,zJ);const Sp="disjunction",YJ=qg;function jJ(n,e){return n.some(t=>t.func(e))}bE(Sp,YJ,jJ);const SE="disjunctionWithExtraCondition",KJ=qg;function qJ(n,e){if(n.length<3)throw Error("Operation doesn't work on less then three conditions.");return n.slice(0,n.length-1).some(t=>t.func(e))&&n[n.length-1].func(e)}bE(SE,KJ,qJ);const XJ="numeric",IM="text",QJ="date",Z7={[XJ]:[Qn,ut,Ch,Dm,ut,Eh,km,ut,wM,vM,CM,EM,bp,bM],[IM]:[Qn,ut,Ch,Dm,ut,Eh,km,ut,SM,RM,ut,EE,TM],[QJ]:[Qn,ut,Ch,Dm,ut,Eh,km,ut,CE,vE,bp,ut,AM,xM,MM]};function ZJ(n){const e=[];let t=n;return Z7[t]||(t=IM),re(Z7[t],r=>{let i;r===ut?i={name:ut}:i=Xr(Ya(r)),e.push(i)}),e}const K2="built",q2="building",J7=["click","input","keydown","keypress","keyup","focus","blur","change"];class d1{static get DEFAULTS(){return Xr({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){this.hot=e,this.eventManager=new dn(this),this.options=Un(d1.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===q2?this._element:this.buildState===K2?(this.update(),this._element):(this.buildState=q2,this.build(),this.buildState=K2,this._element)}isBuilt(){return this.buildState===K2}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Ur)?this.hot.getTranslatedPhrase(e):e}build(){const e=(t,r)=>{this.eventManager.addEventListener(t,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=q2),this.options.className&&Ae(this._element,this.options.className),this.options.children.length)re(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);ft(this.options,(r,i)=>{t[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(t[i]=this.translateIfPossible(r))}),this._element.appendChild(t),re(J7,r=>e(t,r))}else re(J7,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}Yt(d1,ni);const ta=d1,kf=new WeakMap;class RE extends ta{static get DEFAULTS(){return Xr({placeholder:"",type:"text",tagName:"input"})}constructor(e,t){super(e,Un(RE.DEFAULTS,t)),kf.set(this,{}),this.registerHooks()}registerHooks(){this.addLocalHook("click",()=>this.onClick()),this.addLocalHook("keyup",e=>this.onKeyup(e))}build(){super.build();const e=kf.get(this),t=this.hot.rootDocument.createElement("div");e.input=this._element.firstChild,Ae(this._element,"htUIInput"),Ae(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){if(!this.isBuilt())return;const e=kf.get(this).input;e.type=this.options.type,e.placeholder=this.translateIfPossible(this.options.placeholder),e.value=this.translateIfPossible(this.options.value)}focus(){this.isBuilt()&&kf.get(this).input.focus()}onClick(){}onKeyup(e){this.options.value=e.target.value}}const Lu=RE,Ff=new WeakMap;class TE extends ta{static get DEFAULTS(){return Xr({className:"htUISelect",wrapIt:!1})}constructor(e,t){super(e,Un(TE.DEFAULTS,t)),Ff.set(this,{}),this.menu=null,this.items=[],this.registerHooks()}registerHooks(){this.addLocalHook("click",()=>this.onClick())}setItems(e){this.items=this.translateNames(e),this.menu&&this.menu.setMenuItems(this.items)}translateNames(e){return re(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),this.menu=new gE(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);const e=new ta(this.hot,{className:"htUISelectCaption"}),t=new ta(this.hot,{className:"htUISelectDropdown"}),r=Ff.get(this);r.caption=e,r.captionElement=e.element,r.dropdown=t,re([e,t],i=>this._element.appendChild(i.element)),this.menu.addLocalHook("select",i=>this.onMenuSelect(i)),this.menu.addLocalHook("afterClose",()=>this.onMenuClosed()),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=this.menu.hot.getTranslatedPhrase(Kg),Ff.get(this).captionElement.textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}))}closeOptions(){this.menu&&this.menu.close()}onMenuSelect(e){e.name!==ut&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}onMenuClosed(){this.runLocalHooks("afterClose")}onClick(){this.openOptions()}destroy(){this.menu&&(this.menu.destroy(),this.menu=null);const{caption:e,dropdown:t}=Ff.get(this);e&&e.destroy(),t&&t.destroy(),super.destroy()}}const eT=TE;class JJ extends h1{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new eT(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new Lu(this.hot,{placeholder:aE})),this.elements.push(new Lu(this.hot,{placeholder:lE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>this.onConditionSelect(e)),this.getSelectElement().addLocalHook("afterClose",()=>this.onSelectUIClosed()),re(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>this.onInputKeyDown(t))})}setState(e){if(this.reset(),!e)return;const t=Xr(e.command);t.name.startsWith(fn)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),re(e.args,(r,i)=>{if(i>t.inputsCount-1)return!1;const s=this.getInputElement(i);s.setValue(r),s[t.inputsCount>i?"show":"hide"](),i||setTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Ya(Qn),t=[];return re(this.getInputElements(),(r,i)=>{e.inputsCount>i&&t.push(r.getValue())}),{command:e,args:t}}updateState(e,t){const r=Ya(e?e.name:Qn);this.state.setValueAtIndex(t,{command:r,args:e?e.args:[]}),e||re(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof eT)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Lu)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,i,s,o)=>{Ae(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Ae(t.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return Ae(a,"htFiltersMenuLabel"),a.textContent=o,t.appendChild(a),t.parentNode.hasAttribute("ghost-table")||re(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[Ya(Qn)];if(e!==null){const{visualIndex:r}=e;t=ZJ(this.hot.getDataType(0,r,this.hot.countRows(),r))}re(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}onConditionSelect(e){re(this.getInputElements(),(t,r)=>{t[e.inputsCount>r?"show":"hide"](),r===0&&setTimeout(()=>t.focus(),10)}),this.runLocalHooks("change",e)}onSelectUIClosed(){this.runLocalHooks("afterClose")}onInputKeyDown(e){Wh(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),Ds(e)):Wh(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ds(e))}}const X2=JJ,Hf=new WeakMap;class AE extends ta{static get DEFAULTS(){return Xr({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,Un(AE.DEFAULTS,t)),Hf.set(this,{})}build(){super.build();const e=Hf.get(this);e.input=this._element.firstChild;const t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),e.label=t,this._element.appendChild(t),this.update()}update(){if(!this.isBuilt())return;const e=Hf.get(this);e.input.checked=this.options.checked,e.label.textContent=this.translateIfPossible(this.options.label.textContent)}isChecked(){return this.options.checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=e,this.update()}focus(){this.isBuilt()&&Hf.get(this).input.focus()}}const tT=AE,nT=0;class eee extends h1{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(Ae(t.parentNode,"htFiltersMenuOperators"),t.parentNode.hasAttribute("ghost-table")||re(this.elements,r=>t.appendChild(r.element)),t)}}buildOperatorsElement(){const e=[ea,Sp];re(e,t=>{const r=new tT(this.hot,{name:"operator",label:{htmlFor:t,textContent:WJ(t)},value:t,checked:t===e[nT],id:t});r.addLocalHook("change",i=>this.onRadioInputChange(i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(Vt`Radio button with index ${e} doesn't exist.`);re(this.elements,(t,r)=>{t.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof tT&&t.isChecked());return e?e.getValue():ea}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&re(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ea,t=arguments.length>1?arguments[1]:void 0,r=e;r===SE&&(r=Sp),this.state.setValueAtIndex(t,r)}reset(){this.setChecked(nT)}onRadioInputChange(e){this.setState(e.target.value)}}const tee=eee,Q2=new WeakMap;class xE extends ta{static get DEFAULTS(){return Xr({href:"#",tagName:"a"})}constructor(e,t){super(e,Un(xE.DEFAULTS,t)),Q2.set(this,{})}build(){super.build();const e=Q2.get(this);e.link=this._element.firstChild}update(){!this.isBuilt()||(Q2.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}const rT=xE,nee=new WeakMap,ree="multipleSelect.itemBox";class ME extends ta{static get DEFAULTS(){return Xr({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,Un(ME.DEFAULTS,t)),nee.set(this,{}),this.searchInput=new Lu(this.hot,{placeholder:oE,className:"htUIMultipleSelectSearch"}),this.selectAllUI=new rT(this.hot,{textContent:nE,className:"htUISelectAll"}),this.clearAllUI=new rT(this.hot,{textContent:rE,className:"htUIClearAll"}),this.items=[],this.itemsBox=null,this.registerHooks()}registerHooks(){this.searchInput.addLocalHook("keydown",e=>this.onInputKeyDown(e)),this.searchInput.addLocalHook("input",e=>this.onInput(e)),this.selectAllUI.addLocalHook("click",e=>this.onSelectAllClick(e)),this.clearAllUI.addLocalHook("click",e=>this.onClearAllClick(e))}setItems(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)}setLocale(e){this.locale=e}getLocale(){return this.locale}getItems(){return[...this.items]}getValue(){return see(this.items)}isSelectedAllValues(){return this.items.length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),r=new ta(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(r.element),this._element.appendChild(t);const i=s=>{if(!this._element)return;this.itemsBox&&this.itemsBox.destroy(),Ae(s,"htUIMultipleSelectHot"),this.itemsBox=new this.hot.constructor(s,{data:this.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,h,d,f)=>{l.title=f.instance.getDataAtRowProp(u,f.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>this.itemsBox.container.scrollWidth-er(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"}),this.itemsBox.init(),this.itemsBox.getShortcutManager().getContext("grid").addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:ree})};i(t),setTimeout(()=>i(t),100)}reset(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}update(){!this.isBuilt()||(this.itemsBox.loadData(iee(this.items,this.options.value)),super.update())}destroy(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,super.destroy()}onInput(e){const t=e.target.value.toLocaleLowerCase(this.getLocale());let r;t===""?r=[...this.items]:r=Oi(this.items,i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(t)>=0),this.itemsBox.loadData(r)}onInputKeyDown(e){this.runLocalHooks("keydown",e,this),Ox(Wh,e.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Ds(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}onSelectAllClick(e){const t=[];e.preventDefault(),re(this.itemsBox.getSourceData(),(r,i)=>{r.checked=!0,t.push(F7(r,i)[0])}),this.itemsBox.setSourceDataAtCell(t)}onClearAllClick(e){const t=[];e.preventDefault(),re(this.itemsBox.getSourceData(),(r,i)=>{r.checked=!1,t.push(F7(r,i)[0])}),this.itemsBox.setSourceDataAtCell(t)}}const iT=ME;function iee(n,e){const t=Gd(e);return ct(n,r=>(r.checked=t(r.value),r))}function see(n){const e=[];return re(n,t=>{t.checked&&e.push(t.value)}),e}class oee extends h1{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.elements.push(new iT(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>this.onInputKeyDown(e))}setState(e){if(this.reset(),e&&e.command.key===ja){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?Qn:ja},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(r,i,s,o,a)=>{const[l]=Oi(i,h=>h.name===ja),u={},c=this.hot.getTranslatedPhrase(vp);if(l){const h=Jy(ct(o(r,a),p=>p.value));s&&(l.args[0]=s);const d=[],f=Q7(h,l.args[0],c,p=>{p.checked&&d.push(p.value)}),m=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,m).locale,u.args=[d],u.command=Ya(ja),u.itemsSnapshot=f}else u.args=[],u.command=Ya(Qn);this.state.setValueAtIndex(r,u)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof iT)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,i,s,o)=>{Ae(t.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return Ae(a,"htFiltersMenuLabel"),a.textContent=o,t.appendChild(a),t.parentNode.hasAttribute("ghost-table")||re(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(vp),t=Jy(this._getColumnVisibleValues()),r=Q7(t,t,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(t);const i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}onInputKeyDown(e){Wh(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ds(e))}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:ct(this.hot.getDataAtCol(e.visualIndex),t=>NM(t))}}const aee=oee;class bh extends h1{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),this.name=t.name,this.elements.push(new Lu(this.hot,{type:"button",value:iE,className:"htUIButton htUIButtonOK",identifier:bh.BUTTON_OK})),this.elements.push(new Lu(this.hot,{type:"button",value:sE,className:"htUIButton htUIButtonCancel",identifier:bh.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){re(this.elements,e=>{e.addLocalHook("click",(t,r)=>this.onButtonClick(t,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(Ae(t.parentNode,"htFiltersMenuActionBar"),t.parentNode.hasAttribute("ghost-table")||re(this.elements,r=>t.appendChild(r.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}onButtonClick(e,t){t.options.identifier===bh.BUTTON_OK?this.accept():this.cancel()}}const lee=bh,sT="ConditionCollection.filteringStates";class OM{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.hot=e,this.isMapRegistrable=t,this.filteringStates=new Yg,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(sT,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var r;const i=this.filteringStates.getValueAtIndex(t),s=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],o=i==null?void 0:i.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ea;return e.length?$J(r)(e,t):!0}addCondition(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ea,i=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=ct(t.args,c=>typeof c=="string"?c.toLocaleLowerCase(s):c),a=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(Vt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Qt(Jh[r]))throw new Error(Vt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:o,func:oa(a,o)}]},i):u.push({name:a,args:o,func:oa(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,r;return(t=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Tr(this.filteringStates.getEntries(),(e,t)=>{let[r,{operation:i,conditions:s}]=t;return e.push({column:r,operation:i,conditions:ct(s,o=>{let{name:a,args:l}=o;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),re(e,t=>{re(t.conditions,r=>this.addCondition(t.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const r=this.getConditions(e);return t?r.some(i=>i.name===t):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(sT),this.filteringStates=null,this.clearLocalHooks()}}Yt(OM,ni);const _M=OM;class uee{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return re(this.conditionCollection.getFilteredColumns(),(t,r)=>{let i=this.columnDataFactory(t);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(t,i)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return re(t,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,t){const r=[];return re(t,i=>{const s=i.meta.visualRow;e[s]!==void 0&&(r[s]=e[s])}),r}}const LM=uee;class PM{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];this.hot=e,this.conditionCollection=t,this.columnDataFactory=r,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",i=>this._onConditionBeforeModify(i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>this._onConditionBeforeClean()),this.conditionCollection.addLocalHook("afterClean",()=>this._onConditionAfterClean())}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,re(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}_onConditionBeforeModify(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}updateStatesAtColumn(e,t){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=i.slice(0,s),a=i.slice(s);a.length&&a[0].column===e&&a.shift();const l=ZW(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new _M(r.hot,!1),m=[].concat(c,d);f.importAllConditions(m);const p=r.columnDataFactory(h);let y;f.isEmpty()?y=p:y=new LM(f,b=>r.columnDataFactory(b)).filter(),y=ct(y,b=>b.meta.visualRow);const C=Gd(y);return f.destroy(),Oi(p,b=>C(b.meta.visualRow))})(o),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:t})}_onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}_onConditionAfterClean(){re(this.latestOrderStack,e=>{this.updateStatesAtColumn(e)})}destroy(){this.clearLocalHooks(),ft(this,(e,t)=>{this[t]=null})}}Yt(PM,ni);const cee=PM,oT="filters",hee=250;class dee extends Lt{static get PLUGIN_KEY(){return oT}static get PLUGIN_PRIORITY(){return hee}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),this.eventManager=new dn(this),this.dropdownMenuPlugin=null,this.conditionCollection=null,this.conditionUpdateObserver=null,this.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),this.filtersRowsMap=null,this.hot.addHook("afterGetColHeader",(t,r)=>this.onAfterGetColHeader(t,r))}isEnabled(){return!!this.hot.getSettings()[oT]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Hd),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,t=e&&e.uiContainer||this.hot.rootDocument.body,r=o=>(o.addLocalHook("accept",()=>this.onActionBarSubmit("accept")),o.addLocalHook("cancel",()=>this.onActionBarSubmit("cancel")),o.addLocalHook("change",a=>this.onComponentChange(o,a)),o),i=()=>`${this.hot.getTranslatedPhrase(JC)}:`,s=()=>`${this.hot.getTranslatedPhrase(eE)}:`;if(!this.components.get("filter_by_condition")){const o=new X2(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:t});o.addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition",r(o))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new tee(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const o=new X2(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:t});o.addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition2",r(o))}this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new aee(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new lee(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new _M(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new cee(this.hot,this.conditionCollection,o=>this.getDataMapAtColumn(o)),this.conditionUpdateObserver.addLocalHook("update",o=>this.updateComponents(o))),this.components.forEach(o=>o.show()),this.addHook("beforeDropdownMenuSetItems",o=>this.onBeforeDropdownMenuSetItems(o)),this.addHook("afterDropdownMenuDefaultOptions",o=>this.onAfterDropdownMenuDefaultOptions(o)),this.addHook("afterDropdownMenuShow",()=>this.onAfterDropdownMenuShow()),this.addHook("afterDropdownMenuHide",()=>this.onAfterDropdownMenuHide()),this.addHook("afterChange",o=>this.onAfterChange(o)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,r)=>{t.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}super.disablePlugin()}addCondition(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ea;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:t},args:r},i)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const e=this._createDataFilter(),t=!this.conditionCollection.isEmpty();let r=[];const i=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",i)!==!1)if(t){const o=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=ct(e.filter(),l=>l.meta.visualRow);const a=Gd(r);ze(this.hot.countSourceRows()-1,l=>{a(l)||o.push(l)}),re(o,l=>{this.filtersRowsMap.setValueAtIndex(l,!0)})},!0),r.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",i),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}clearColumnSelection(){const e=this.getSelectedColumn();e!==null&&this.hot.selectCell(0,e.visualIndex)}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),r=[];return re(this.hot.getSourceDataAtCol(t),(i,s)=>{var o;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m}=this.hot.getCellMeta(s,t),p=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),t))!==null&&o!==void 0?o:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m},value:NM(p)})}),r}onAfterChange(e){e&&re(e,t=>{const[,r]=t,i=this.hot.propToCol(r);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),r=Jy(t);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var t;const r=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}onAfterDropdownMenuShow(){this.restoreComponents(Array.from(this.components.values()))}onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}onBeforeDropdownMenuSetItems(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",()=>{this.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}onAfterDropdownMenuDefaultOptions(e){e.items.push({name:ut}),this.components.forEach(t=>{e.items.push(t.getMenuItemDescriptor())})}getOperationBasedOnArguments(e,t,r,i){let s=e;return s===Sp&&t.command.key!==Qn&&r.command.key!==Qn&&i.command.key!==Qn?s=SE:i.command.key!==Qn&&(t.command.key===Qn||r.command.key===Qn)&&(s=ea),s}onActionBarSubmit(e){var t;if(e==="accept"){const i=this.getSelectedColumn();if(i===null){var r;(r=this.dropdownMenuPlugin)===null||r===void 0||r.close();return}const{physicalIndex:s}=i,o=this.components.get("filter_by_condition").getState(),a=this.components.get("filter_by_condition2").getState(),l=this.components.get("filter_by_value").getState(),u=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,a,l);this.conditionUpdateObserver.groupChanges();let c=this.conditionCollection.getColumnStackPosition(s);c===-1&&(c=void 0),this.conditionCollection.removeConditions(s),o.command.key!==Qn&&(this.conditionCollection.addCondition(s,o,u,c),a.command.key!==Qn&&this.conditionCollection.addCondition(s,a,u,c)),l.command.key!==Qn&&this.conditionCollection.addCondition(s,l,u,c),this.conditionUpdateObserver.flush(),this.components.forEach(h=>h.saveState(s)),this.filtersRowsMap.clear(),this.filter()}(t=this.dropdownMenuPlugin)===null||t===void 0||t.close()}onComponentChange(e,t){this.updateDependentComponentsVisibility(),e.constructor===X2&&!t.inputsCount&&this.setListeningDropdownMenu()}onSelectUIClosed(){this.setListeningDropdownMenu()}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...r):this.hideComponents(...r)}onAfterGetColHeader(e,t){const r=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(r)?Ae(t,"htFiltersActive"):tt(t,"htFiltersActive")}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new LM(e,t=>this.getDataMapAtColumn(t))}updateComponents(e){var t;if(!((t=this.dropdownMenuPlugin)!==null&&t!==void 0&&t.enabled))return;const{editedConditionStack:{conditions:r,column:i}}=e,s=r.filter(a=>a.name===ja),o=r.filter(a=>a.name!==ja);if(s.length>=2||o.length>=3)Xt(Vt`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(o[0],i),this.components.get("filter_by_condition2").updateState(o[1],i),this.components.get("filter_operators").updateState(a,i),this.components.get("filter_by_value").updateState(e)}}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return re(i,o=>{re(t.menuItems,(a,l)=>{a.key===o.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const l=this.getIndexesOfComponents(...o);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}const DM="internal-use-in-handsontable",ew={licenseKey:DM,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function kM(n){var e;return{maxColumns:n.maxColumns,maxRows:n.maxRows,language:(e=n[Cr])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function FM(n){return Object.keys(n).reduce((e,t)=>(t!=="hyperformula"&&(e[t]=n[t]),e),{})}function fee(n){var e;const t=n[Cr],r=FM(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),i=kM(n);return{...ew,...r,...i}}function mee(n){var e;const t=n[Cr],r=FM(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),i=kM(n);return{...r,...i}}function pee(n,e){return Object.keys(e).some(t=>e[t]!==void 0&&e[t]!==n[t])}function f1(){const n="engine_relationship",e=Hi(Cr);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function NE(){const n="shared_engine_usage",e=Hi(Cr);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function gee(n){const e=n.getSettings(),t=e[Cr],r=t==null?void 0:t.engine;if(t===!0||Qt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return yee((i=r.hyperformula)!==null&&i!==void 0?i:r,e,n)}else if(typeof r=="object"&&Qt(r.hyperformula)){const s=f1(),o=NE().get(r);return s.has(r)||s.set(r,[]),s.get(r).push(n),o&&o.push(n.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:DM}),(r.getConfig().leapYear1900!==ew.leapYear1900||J5(r.getConfig().nullDate,ew.nullDate)===!1)&&Xt(Vt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function yee(n,e,t){const r=e[Cr],i=fee(e),s=f1(),o=NE();wee(n,r.functions),vee(n,r.language);const a=n.buildEmpty(i);return s.set(a,[t]),o.set(a,[t.guid]),Cee(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function aT(n){var e;const t=f1(),r=t.size===0?[]:Array.from((e=t.get(n))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function lT(n,e){if(n){const t=f1(),r=t.get(n),i=NE(),s=i.get(n);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&t.delete(n)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(i.delete(n),n.destroy()))}}function wee(n,e){e&&e.forEach(t=>{const{name:r,plugin:i,translations:s}=t;try{n.registerFunction(r,i,s)}catch(o){Xt(o.message)}})}function vee(n,e){if(e){const{langCode:t}=e;try{n.registerLanguage(t,e)}catch(r){Xt(r.message)}}}function Cee(n,e){e&&(n.suspendEvaluation(),e.forEach(t=>{const{name:r,expression:i,scope:s,options:o}=t;try{n.addNamedExpression(r,i,s,o)}catch(a){Xt(a.message)}}),n.resumeEvaluation())}function Eee(n,e){return(Qt(e)||!n.doesSheetExist(e))&&(e=n.addSheet(e)),e}const HM="DD/MM/YYYY";function UM(n){return typeof n=="string"&&n.charAt(0)==="'"&&n.charAt(1)==="="}function bee(n){return UM(n)?n.substr(1):n}function See(n){return typeof n=="string"&&n.startsWith("=")}function Z2(n,e){return typeof n=="string"&&e==="date"}function uT(n,e){return It(n,e,!0).isValid()}function cT(n,e){return It(n,e,!0).format(HM)}function Ree(n,e){return It(n,HM,!0).format(e)}function hT(n,e){const r=new Date(Date.UTC(0,0,n+-1));return It(r).format(e)}function Ma(n,e,t){Tee(n,e),e.set(n,t)}function Tee(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zt(n,e){var t=BM(n,e,"get");return Aee(n,t)}function Aee(n,e){return e.get?e.get.call(n):e.value}function Oo(n,e,t){var r=BM(n,e,"set");return xee(n,r,t),t}function BM(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function xee(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Bc=new WeakMap,_o=new WeakMap,ii=new WeakMap,Uf=new WeakMap,J2=new WeakMap,e6=new WeakMap,Bf=new WeakMap;class Mee{constructor(e,t,r){Ma(this,Bc,{writable:!0,value:void 0}),Ma(this,_o,{writable:!0,value:void 0}),Ma(this,ii,{writable:!0,value:void 0}),Ma(this,Uf,{writable:!0,value:[]}),Ma(this,J2,{writable:!0,value:[]}),Ma(this,e6,{writable:!0,value:void 0}),Ma(this,Bf,{writable:!0,value:[]}),Oo(this,Bc,e),Oo(this,_o,t),Oo(this,ii,r)}setRemovedHfIndexes(e){return Oo(this,Bf,e.map(t=>{const r=Zt(this,_o).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(r)})),Zt(this,Bf)}getRemovedHfIndexes(){return Zt(this,Bf)}getHfIndexFromVisualIndex(e){const t=Zt(this,_o).getIndexesSequence(),r=Zt(this,_o).getNotTrimmedIndexes();return t.indexOf(r[e])}syncMoves(e){const r=`move${ts(Zt(this,Bc))}s`;Zt(this,ii).getEngine().batch(()=>{e.forEach(i=>{const s=i.from!==i.to,o=i.from+1!==i.to;s&&o&&Zt(this,ii).getEngine()[r](Zt(this,ii).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,t,r){r!==!1&&(Oo(this,J2,e.map(i=>this.getHfIndexFromVisualIndex(i))),Oo(this,e6,this.getHfIndexFromVisualIndex(t)))}getMoveLine(e,t){const r=Zt(this,_o).getNumberOfIndexes(),i=Array.from(Array(r).keys()).filter(o=>e.includes(o)===!1);if(t===0){var s;return(s=i[t])!==null&&s!==void 0?s:0}return i[t-1]+1}getInitiallyCalculatedMoves(e,t){let r=this.getMoveLine(e,t);const i=[];return e.forEach(s=>{const o={from:s,to:r};i.forEach(a=>{const l=a.from>a.to,u=a.to<=o.from;a.from>o.from&&u&&l&&(o.from+=1)}),o.from>=r&&(r+=1),i.push(o)}),i}adjustedCalculatedMoves(e){return e.forEach((t,r)=>{e.slice(r+1).forEach(s=>{const o=s.from<s.to;s.from>t.from&&o&&(s.from-=1)})}),e}calculateAndSyncMoves(e,t){if(Zt(this,ii).isPerformingUndoRedo()||e===!1||t===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(Zt(this,J2),Zt(this,e6)));Zt(this,ii).getSheetId()===null?Zt(this,ii).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${ts(Zt(this,Bc))}Order`;return t=>{if(Zt(this,ii).isPerformingUndoRedo())return;const r=Zt(this,_o).getIndexesSequence();if(t==="update"){const i=Zt(this,Uf).map(l=>r.indexOf(l)),s=Zt(this,ii).getEngine().getSheetDimensions(Zt(this,ii).getSheetId());let o;Zt(this,Bc)==="row"?o=s.height:o=s.width;const a=i.length;for(let l=a;l<o;l+=1)i.push(l);Zt(this,ii).getEngine()[e](Zt(this,ii).getSheetId(),i)}Oo(this,Uf,r)}}init(){Oo(this,Uf,Zt(this,_o).getIndexesSequence())}}const dT=Mee;function Na(n,e,t){Nee(n,e),e.set(n,t)}function Nee(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zs(n,e){var t=VM(n,e,"get");return Iee(n,t)}function Iee(n,e){return e.get?e.get.call(n):e.value}function Ia(n,e,t){var r=VM(n,e,"set");return Oee(n,r,t),t}function VM(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Oee(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Vf=new WeakMap,$f=new WeakMap,t6=new WeakMap,n6=new WeakMap,r6=new WeakMap,i6=new WeakMap,s6=new WeakMap;class _ee{constructor(e,t,r){Na(this,Vf,{writable:!0,value:void 0}),Na(this,$f,{writable:!0,value:void 0}),Na(this,t6,{writable:!0,value:void 0}),Na(this,n6,{writable:!0,value:!1}),Na(this,r6,{writable:!0,value:!1}),Na(this,i6,{writable:!0,value:null}),Na(this,s6,{writable:!0,value:null}),Ia(this,Vf,new dT("row",e,this)),Ia(this,$f,new dT("column",t,this)),Ia(this,t6,r)}getForAxis(e){return e==="row"?Zs(this,Vf):Zs(this,$f)}setPerformUndo(e){Ia(this,n6,e)}setPerformRedo(e){Ia(this,r6,e)}isPerformingUndoRedo(){return Zs(this,n6)||Zs(this,r6)}getSheetId(){return Zs(this,s6)}getEngine(){return Zs(this,i6)}getPostponeAction(){return Zs(this,t6)}setupSyncEndpoint(e,t){Ia(this,i6,e),Ia(this,s6,t),Zs(this,Vf).init(),Zs(this,$f).init()}}const Lee=_ee;function Zl(n,e,t){return e=Pee(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Pee(n){var e=Dee(n,"string");return typeof e=="symbol"?e:String(e)}function Dee(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function o6(n,e,t){kee(n,e),e.set(n,t)}function kee(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lo(n,e,t){var r=$M(n,e,"set");return Fee(n,r,t),t}function Fee(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function Jl(n,e){var t=$M(n,e,"get");return Hee(n,t)}function $M(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Hee(n,e){return e.get?e.get.call(n):e.value}const Cr="formulas",Uee=["maxRows","maxColumns","language"],Bee=260;Ue.getSingleton().register("afterNamedExpressionAdded");Ue.getSingleton().register("afterNamedExpressionRemoved");Ue.getSingleton().register("afterSheetAdded");Ue.getSingleton().register("afterSheetRemoved");Ue.getSingleton().register("afterSheetRenamed");Ue.getSingleton().register("afterFormulasValuesUpdate");const eu=n=>n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto";var Js=new WeakMap,a6=new WeakMap,Vc=new WeakMap;class Vee extends Lt{constructor(){var e;super(...arguments),e=this,o6(this,Js,{writable:!0,value:!1}),o6(this,a6,{writable:!0,value:!1}),o6(this,Vc,{writable:!0,value:[["valuesUpdated",function(){return e.onEngineValuesUpdated(...arguments)}],["namedExpressionAdded",function(){return e.onEngineNamedExpressionsAdded(...arguments)}],["namedExpressionRemoved",function(){return e.onEngineNamedExpressionsRemoved(...arguments)}],["sheetAdded",function(){return e.onEngineSheetAdded(...arguments)}],["sheetRenamed",function(){return e.onEngineSheetRenamed(...arguments)}],["sheetRemoved",function(){return e.onEngineSheetRemoved(...arguments)}]]}),Zl(this,"staticRegister",Hi("formulas")),Zl(this,"engine",null),Zl(this,"sheetName",null),Zl(this,"indexSyncer",null),Zl(this,"rowAxisSyncer",null),Zl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Cr}static get PLUGIN_PRIORITY(){return Bee}static get SETTING_KEYS(){return[Cr,...Uee]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Cr]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=gee(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Xt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){return t.onBeforeLoadData(...arguments)}),this.addHook("afterLoadData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("beforeUpdateData",function(){return t.onBeforeLoadData(...arguments)}),this.addHook("afterUpdateData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("modifyData",function(){return t.onModifyData(...arguments)}),this.addHook("modifySourceData",function(){return t.onModifySourceData(...arguments)}),this.addHook("beforeValidate",function(){return t.onBeforeValidate(...arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return t.onAfterSetSourceDataAtCell(...arguments)}),this.addHook("afterSetDataAtCell",function(){return t.onAfterSetDataAtCell(...arguments)}),this.addHook("afterSetDataAtRowProp",function(){return t.onAfterSetDataAtCell(...arguments)}),this.addHook("beforeCreateRow",function(){return t.onBeforeCreateRow(...arguments)}),this.addHook("beforeCreateCol",function(){return t.onBeforeCreateCol(...arguments)}),this.addHook("afterCreateRow",function(){return t.onAfterCreateRow(...arguments)}),this.addHook("afterCreateCol",function(){return t.onAfterCreateCol(...arguments)}),this.addHook("beforeRemoveRow",function(){return t.onBeforeRemoveRow(...arguments)}),this.addHook("beforeRemoveCol",function(){return t.onBeforeRemoveCol(...arguments)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow(...arguments)}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol(...arguments)}),this.indexSyncer=new Lee(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,s,o)=>{this.rowAxisSyncer.storeMovesInformation(r,i,o)}),this.hot.addHook("beforeColumnMove",(r,i,s,o)=>{this.columnAxisSyncer.storeMovesInformation(r,i,o)}),this.hot.addHook("afterRowMove",(r,i,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(r,i,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){return t.onAfterCellMetaReset(...arguments)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return t.onAfterDetachChild(...arguments)}),this.addHook("beforeAutofill",function(){return t.onBeforeAutofill(...arguments)}),Jl(this,Vc).forEach(r=>{let[i,s]=r;return this.engine.on(i,s)}),super.enablePlugin()}}disablePlugin(){Jl(this,Vc).forEach(e=>{let[t,r]=e;return this.engine.off(t,r)}),lT(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=mee(this.hot.getSettings());pee(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const r=this.hot.getSettings()[Cr];if(De(r)&&De(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Cr].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i!=null?i:void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Jl(this,Vc).forEach(e=>{var t;let[r,i]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(r,i)}),Lo(this,Vc,null),lT(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(De(t)&&!fQ(t))return Xt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Xt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e!=null?e:void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(r),t),r}catch(r){return Xt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){sv(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${ts(Cr)}.switchSheet`)}getCellType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(t);return i!==null&&s!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var s;const o=i==null||(s=i.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(r.has(o)||r.add(o))}),aT(this.engine).forEach((i,s)=>{if((t||s!==this.sheetId)&&r.has(s)){var o;i.render(),(o=i.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=s=>{var o;const{row:a,col:l,sheet:u}=(o=s==null?void 0:s.address)!==null&&o!==void 0?o:{};return De(u)?`${u}:${a}x${l}`:""},i=new Set(t.map(s=>r(s)));e.forEach(s=>{var o,a;const{row:l,col:u}=(o=s.address)!==null&&o!==void 0?o:{};if(De(l)===!1||De(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,h=r(s);if(c!==void 0&&!i.has(h)){const d=aT(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,t,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){Xt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const s=this.hot.getCellMeta(e,t);return Z2(r,s.type)&&(uT(r,s.dateFormat)?r=cT(r,s.dateFormat):See(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}onBeforeValidate(e,t,r){const i=this.hot.propToCol(r);if(this.isFormulaCellType(t,i)){const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},o=this.hot.getCellMeta(t,i);let a=this.engine.getCellValue(s);return o.type==="date"&&zr(a)&&(a=hT(a,o.dateFormat)),typeof a=="object"&&a!==null?a.value:a}return e}onBeforeAutofill(e,t,r){const{row:i,col:s}=t.getTopStartCorner(),{row:o,col:a}=t.getBottomEndCorner(),{row:l,col:u}=r.getTopStartCorner(),{row:c,col:h}=r.getBottomEndCorner(),d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId}},f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(f)===!1)return!1;const m=this.engine.getFillRangeData(d,f),{row:p,col:y}=d.start,{row:C,col:b}=d.end,v=C-p+1,S=b-y+1;for(let L=0;L<m.length;L+=1)for(let _=0;_<m[L].length;_+=1){const P=m[L][_],x=L%v,I=_%S,R=this.hot.getCellMeta(x,I);Z2(P,R.type)&&(P.startsWith("'")?m[L][_]=P.slice(1):this.isFormulaCellType(x,I,this.sheetId)===!1&&(m[L][_]=Ree(P,R.dateFormat)))}return m}onBeforeLoadData(e,t){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(ts(Cr))||Lo(this,a6,Qt(this.hot.getSettings().data))}onAfterCellMetaReset(){const e=this.hot.getSourceDataArray();let t=!1;e.forEach((r,i)=>{r.forEach((s,o)=>{const a=this.hot.getCellMeta(i,o),l=a.dateFormat;Z2(s,a.type)&&(t=!0,uT(s,l)?e[i][o]=cT(s,l):this.isFormulaCellType(i,o)===!1&&(e[i][o]=`'${s}`))})}),t===!0&&(Lo(this,Js,!0),this.engine.setSheetContent(this.sheetId,e),Lo(this,Js,!1))}onAfterLoadData(e,t){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(ts(Cr)))if(this.sheetName=Eee(this.engine,this.hot.getSettings()[Cr].sheetName),Jl(this,a6))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Lo(this,Js,!0);const s=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),Lo(this,Js,!1)}}}onModifyData(e,t,r,i){if(i!=="get"||Jl(this,Js)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(e);if(s===null||t===null)return;if(!this.isFormulaCellType(s,t)&&this.getCellType(s,t)!=="ARRAY"){UM(r.value)&&(r.value=bee(r.value));return}const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};let l=this.engine.getCellValue(a);const u=this.hot.getCellMeta(s,t);u.type==="date"&&zr(l)&&(l=hT(l,u.dateFormat));const c=typeof l=="object"&&l!==null?l.value:l;r.value=c}onModifySourceData(e,t,r,i){if(i!=="get"||Jl(this,Js)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(e),o=this.hot.propToCol(t);if(s===null||o===null||!this.isFormulaCellType(s,o)&&this.getCellType(s,o)!=="ARRAY")return;const l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(l.width===0&&l.height===0)return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};r.value=this.engine.getCellSerialized(u)}onAfterSetDataAtCell(e,t){if(eu(t))return;const r=[],i=[],s=this.engine.batch(()=>{e.forEach(o=>{let[a,l,,u]=o;const c=this.hot.propToCol(l),h=this.hot.toPhysicalRow(a),d=this.hot.toPhysicalColumn(c),f={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};h!==null&&d!==null?this.syncChangeWithEngine(a,c,u):r.push([a,c,u]),i.push({address:f})})});r.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{r.forEach(a=>{let[l,u,c]=a;this.syncChangeWithEngine(l,u,c)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(s),this.validateDependentCells(s,i)}onAfterSetSourceDataAtCell(e,t){if(eu(t))return;const r=[],i=[];e.forEach(s=>{let[o,a,,l]=s;const u=this.hot.propToCol(a);if(!zr(u))return;const c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(c)){Xt(`Not possible to set source cell data at ${JSON.stringify(c)}`);return}i.push({address:c}),r.push(...this.engine.setCellContents(c,l))}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}onBeforeCreateRow(e,t){let r=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(r=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[r,t]))return!1}onBeforeCreateCol(e,t){let r=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(r=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[r,t]))return!1}onBeforeRemoveRow(e,t,r){return this.rowAxisSyncer.setRemovedHfIndexes(r).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}onBeforeRemoveCol(e,t,r){return this.columnAxisSyncer.setRemovedHfIndexes(r).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}onAfterCreateRow(e,t,r){if(eu(r))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(i)}onAfterCreateCol(e,t,r){if(eu(r))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(i)}onAfterRemoveRow(e,t,r,i){if(eu(i))return;const s=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{s.forEach(a=>{this.engine.removeRows(this.sheetId,[a,1])})});this.renderDependentSheets(o)}onAfterRemoveCol(e,t,r,i){if(eu(i))return;const s=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{s.forEach(a=>{this.engine.removeColumns(this.sheetId,[a,1])})});this.renderDependentSheets(o)}onAfterDetachChild(e,t,r){var i;Lo(this,Js,!0);const s=this.hot.getSourceDataArray(r,0,r+(((i=t.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());Lo(this,Js,!1),s.forEach((o,a)=>{o.forEach((l,u)=>{this.engine.setCellContents({col:u,row:r+a,sheet:this.sheetId},[[l]])})})}onEngineValuesUpdated(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}onEngineNamedExpressionsAdded(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}onEngineNamedExpressionsRemoved(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}onEngineSheetAdded(e){this.hot.runHooks("afterSheetAdded",e)}onEngineSheetRenamed(e,t){this.hot.runHooks("afterSheetRenamed",e,t)}onEngineSheetRemoved(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}}function $ee(n){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(t=1)}return this.getTranslatedPhrase(IC,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,t.col),0),i=Math.max(e.col,t.col),s=[];for(let l=r;l<=i;l+=1)s.push(l);n.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Wee(n){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(OC,t)},callback(){var t,r;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(t=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&t!==void 0?t:0,s=(r=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&r!==void 0?r:this.countCols()-1,n.showColumns(e),this.render(),this.view.adjustElementsSize(!0),s-i+1===this.countCols()||this.selectColumns(i,s)},disabled:!1,hidden(){const t=ct(n.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,s=r.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),c=[];if(i!==s){const h=s-i+1,d=l-a+1;if(h>d){const f=u.slice(i,s+1);c.push(...f.filter(m=>t.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&c.push(...u.slice(s+1))}return re(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function fT(n,e,t){Gee(n,e),e.set(n,t)}function Gee(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function si(n,e){var t=WM(n,e,"get");return zee(n,t)}function zee(n,e){return e.get?e.get.call(n):e.value}function $c(n,e,t){var r=WM(n,e,"set");return Yee(n,r,t),t}function WM(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Yee(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}Ue.getSingleton().register("beforeHideColumns");Ue.getSingleton().register("afterHideColumns");Ue.getSingleton().register("beforeUnhideColumns");Ue.getSingleton().register("afterUnhideColumns");const l6="hiddenColumns",jee=310;var fs=new WeakMap,ms=new WeakMap;class Kee extends Lt{constructor(){super(...arguments),fT(this,fs,{writable:!0,value:{}}),fT(this,ms,{writable:!0,value:null})}static get PLUGIN_KEY(){return l6}static get PLUGIN_PRIORITY(){return jee}isEnabled(){return!!this.hot.getSettings()[l6]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[l6];dt(t)&&($c(this,fs,t),Qt(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),$c(this,ms,new zg),si(this,ms).addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,si(this,ms)),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(r,i,s)=>this.onAfterGetCellMeta(r,i,s)),this.addHook("modifyColWidth",(r,i)=>this.onModifyColWidth(r,i)),this.addHook("afterGetColHeader",function(){return e.onAfterGetColHeader(...arguments)}),this.addHook("modifyCopyableRange",r=>this.onModifyCopyableRange(r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),$c(this,fs,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let i=t;const s=si(this,ms).getValues().slice(),o=e.length>0;if(r&&o){const l=e.map(u=>this.hot.toPhysicalColumn(u));re(l,u=>{s[u]=!1}),i=Tr(s,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",t,i,r&&o)!==!1&&(r&&o&&si(this,ms).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,i,r&&o,r&&i.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{re(e,o=>{si(this,ms).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",t,i,r,r&&i.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideColumns(t)}getHiddenColumns(){return ct(si(this,ms).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return si(this,ms).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<t):!1}resetCellsMeta(){re(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}onModifyColWidth(e,t){if(this.isHidden(t))return 0;if(si(this,fs).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&typeof e=="number"&&this.hot.hasColHeaders())return e+15}onAfterGetCellMeta(e,t,r){if(si(this,fs).copyPasteEnabled===!1&&this.isHidden(t)&&(r.skipColumnOnPaste=!0),this.isHidden(t-1))r.className=r.className||"",r.className.indexOf("afterHiddenColumn")===-1&&(r.className+=" afterHiddenColumn");else if(r.className){const i=r.className.split(" ");if(i.length>0){const s=i.indexOf("afterHiddenColumn");s>-1&&i.splice(s,1),r.className=i.join(" ")}}}onModifyCopyableRange(e){if(si(this,fs).copyPasteEnabled)return e;const t=[],r=(i,s,o,a)=>{t.push({startRow:i,endRow:s,startCol:o,endCol:a})};return re(e,i=>{let s=!0,o=0;ze(i.startCol,i.endCol,a=>{this.isHidden(a)?(s||r(i.startRow,i.endRow,o,a-1),s=!0):(s&&(o=a),a===i.endCol&&r(i.startRow,i.endRow,o,a),s=!1)})}),t}onAfterGetColHeader(e,t){if(!si(this,fs).indicators||e<0)return;const r=[];e>=1&&this.isHidden(e-1)&&r.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&r.push("beforeHiddenColumn"),Ae(t,r)}onAfterContextMenuDefaultOptions(e){e.items.push({name:ut},$ee(this),Wee(this))}onMapInit(){Array.isArray(si(this,fs).columns)&&this.hideColumns(si(this,fs).columns)}destroy(){$c(this,fs,null),$c(this,ms,null),super.destroy()}}function qee(n){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(t=1)}return this.getTranslatedPhrase(_C,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,t.row),0),i=Math.max(e.row,t.row),s=[];for(let l=r;l<=i;l+=1)s.push(l);n.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Xee(n){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(LC,t)},callback(){var t,r;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(t=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&t!==void 0?t:0,s=(r=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&r!==void 0?r:this.countRows()-1,n.showRows(e),this.render(),this.view.adjustElementsSize(!0),s-i+1===this.countRows()||this.selectRows(i,s)},disabled:!1,hidden(){const t=ct(n.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,s=r.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),c=[];if(i!==s){const h=s-i+1,d=l-a+1;if(h>d){const f=u.slice(i,s+1);c.push(...f.filter(m=>t.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&c.push(...u.slice(s+1))}return re(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function mT(n,e,t){Qee(n,e),e.set(n,t)}function Qee(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vi(n,e){var t=GM(n,e,"get");return Zee(n,t)}function Zee(n,e){return e.get?e.get.call(n):e.value}function Wc(n,e,t){var r=GM(n,e,"set");return Jee(n,r,t),t}function GM(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Jee(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}Ue.getSingleton().register("beforeHideRows");Ue.getSingleton().register("afterHideRows");Ue.getSingleton().register("beforeUnhideRows");Ue.getSingleton().register("afterUnhideRows");const u6="hiddenRows",ete=320;var eo=new WeakMap,ps=new WeakMap;class tte extends Lt{constructor(){super(...arguments),mT(this,eo,{writable:!0,value:{}}),mT(this,ps,{writable:!0,value:null})}static get PLUGIN_KEY(){return u6}static get PLUGIN_PRIORITY(){return ete}isEnabled(){return!!this.hot.getSettings()[u6]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[u6];dt(t)&&(Wc(this,eo,t),Qt(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),Wc(this,ps,new zg),vi(this,ps).addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,vi(this,ps)),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(r,i,s)=>this.onAfterGetCellMeta(r,i,s)),this.addHook("modifyRowHeight",(r,i)=>this.onModifyRowHeight(r,i)),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("modifyCopyableRange",r=>this.onModifyCopyableRange(r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Wc(this,eo,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let i=t;const s=vi(this,ps).getValues().slice(),o=e.length>0;if(r&&o){const l=e.map(u=>this.hot.toPhysicalRow(u));re(l,u=>{s[u]=!1}),i=Tr(s,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",t,i,r&&o)!==!1&&(r&&o&&vi(this,ps).setValues(s),this.hot.runHooks("afterUnhideRows",t,i,r&&o,r&&i.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{re(e,o=>{vi(this,ps).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",t,i,r,r&&i.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideRows(t)}getHiddenRows(){return ct(vi(this,ps).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return vi(this,ps).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<t):!1}resetCellsMeta(){re(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}onModifyRowHeight(e,t){return this.isHidden(t)?0:e}onAfterGetCellMeta(e,t,r){if(vi(this,eo).copyPasteEnabled===!1&&this.isHidden(e)&&(r.skipRowOnPaste=!0),this.isHidden(e-1))r.className=r.className||"",r.className.indexOf("afterHiddenRow")===-1&&(r.className+=" afterHiddenRow");else if(r.className){const i=r.className.split(" ");if(i.length>0){const s=i.indexOf("afterHiddenRow");s>-1&&i.splice(s,1),r.className=i.join(" ")}}}onModifyCopyableRange(e){if(vi(this,eo).copyPasteEnabled)return e;const t=[],r=(i,s,o,a)=>{t.push({startRow:i,endRow:s,startCol:o,endCol:a})};return re(e,i=>{let s=!0,o=0;ze(i.startRow,i.endRow,a=>{this.isHidden(a)?(s||r(o,a-1,i.startCol,i.endCol),s=!0):(s&&(o=a),a===i.endRow&&r(o,a,i.startCol,i.endCol),s=!1)})}),t}onAfterGetRowHeader(e,t){if(!vi(this,eo).indicators||e<0)return;const r=[];e>=1&&this.isHidden(e-1)&&r.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&r.push("beforeHiddenRow"),Ae(t,r)}onAfterContextMenuDefaultOptions(e){e.items.push({name:ut},qee(this),Xee(this))}onMapInit(){Array.isArray(vi(this,eo).rows)&&this.hideRows(vi(this,eo).rows)}destroy(){Wc(this,eo,null),Wc(this,ps,null),super.destroy()}}function nte(n){return{key:"freeze_column",name(){return this.getTranslatedPhrase(oC)},callback(e,t){const[{start:{col:r}}]=t;n.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function rte(n){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(aC)},callback(e,t){const[{start:{col:r}}]=t;n.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}Ue.getSingleton().register("beforeColumnFreeze");Ue.getSingleton().register("afterColumnFreeze");Ue.getSingleton().register("beforeColumnUnfreeze");Ue.getSingleton().register("afterColumnUnfreeze");const pT="manualColumnFreeze",ite=110,Gc=new WeakMap;class ste extends Lt{static get PLUGIN_KEY(){return pT}static get PLUGIN_PRIORITY(){return ite}constructor(e){super(e),Gc.set(this,{afterFirstUse:!1})}isEnabled(){return!!this.hot.getSettings()[pT]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.addContextMenuEntry(e)),this.addHook("beforeColumnMove",(e,t)=>this.onBeforeColumnMove(e,t)),super.enablePlugin())}disablePlugin(){const e=Gc.get(this);e.afterFirstUse=!1,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=Gc.get(this),r=this.hot.getSettings(),i=r.fixedColumnsStart<this.hot.countCols()&&e>r.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart),r._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const t=Gc.get(this),r=this.hot.getSettings(),i=r.fixedColumnsStart>0&&e<=r.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(r._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}addContextMenuEntry(e){e.items.push({name:"---------"},nte(this),rte(this))}onBeforeColumnMove(e,t){if(Gc.get(this).afterFirstUse){const i=this.hot.getSettings().fixedColumnsStart;if(t<i||e.some(s=>s<i))return!1}}}const c6=0,gT=1,yT=2,tu="px";class ote{constructor(e){this.hot=e,this._element=null,this.state=c6,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=yT}build(){this.state===c6&&(this._element=this.hot.rootDocument.createElement("div"),this.state=gT)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=c6}isAppended(){return this.state===yT}isBuilt(){return this.state>=gT}setPosition(e,t){zr(e)&&(this._element.style.top=e+tu),zr(t)&&(this._element.style[this.inlineProperty]=t+tu)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){zr(e)&&(this._element.style.width=e+tu),zr(t)&&(this._element.style.height=t+tu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){zr(e)&&(this._element.style.marginTop=e+tu),zr(t)&&(this._element.style[`margin${ts(this.inlineProperty)}`]=t+tu)}getOffset(){const e=this._element.style,t=`margin${ts(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}}const zM=ote,ate="ht__manualColumnMove--backlight";class lte extends zM{build(){super.build(),Ae(this._element,ate)}}const ute=lte,cte="ht__manualColumnMove--guideline";class hte extends zM{build(){super.build(),Ae(this._element,cte)}}const dte=hte;Ue.getSingleton().register("beforeColumnMove");Ue.getSingleton().register("afterColumnMove");const h6="manualColumnMove",fte=120,Po=new WeakMap,wT="ht__manualColumnMove",Wf="show-ui",d6="on-moving--columns",f6="after-selection--columns";class mte extends Lt{static get PLUGIN_KEY(){return h6}static get PLUGIN_PRIORITY(){return fte}constructor(e){super(e),Po.set(this,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),this.eventManager=new dn(this),this.backlight=new ute(e),this.guideline=new dte(e)}isEnabled(){return!!this.hot.getSettings()[h6]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollVertically",()=>this.onAfterScrollVertically()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),Ae(this.hot.rootElement,wT),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){tt(this.hot.rootElement,wT),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const r=Po.get(this),i=r.cachedDropIndex,s=this.isMovePossible(e,t),o=this.hot.runHooks("beforeColumnMove",e,t,i,s);if(r.cachedDropIndex=void 0,o===!1)return;s&&this.hot.columnIndexMapper.moveIndexes(e,t);const a=s&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,i,s,a),a}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const r=this.countFinalIndex(e,t),i=Po.get(this);return i.cachedDropIndex=t,this.moveColumns(e,r)}isMovePossible(e,t){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+t>r,s=t<0,o=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||s||o||a)}isColumnOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}countFinalIndex(e,t){const r=Tr(e,(i,s)=>(s<t&&(i+=1),i),0);return t-r}getColumnsWidth(e,t){const r=this.hot.columnIndexMapper;let i=0;for(let s=e;s<=t;s+=1){const o=r.getRenderableFromVisualIndex(s);s<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(o)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[h6];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const r=[];return ze(e,t,i=>{r.push(i)}),r}refreshPositions(){const e=Po.get(this),t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(e.hoveredColumn)&&t>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1));const r=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.hoveredColumn-1);const a=r.hider.offsetWidth,l=r.TBODY.offsetLeft,u=this.backlight.getOffset().start,c=this.backlight.getSize().width;let h=0,d=0;if(this.hot.isRtl()){const p=this.hot.rootWindow,y=Bt(this.hot.rootElement),C=p.innerWidth-e.rootElementOffset-y;d=p.innerWidth-e.target.eventPageX-C-(i.scrollX===void 0?s:0)}else d=e.target.eventPageX-(e.rootElementOffset-(i.scrollX===void 0?s:0));if(e.hasRowHeaders&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(e.hoveredColumn)&&(o+=s),o+=h,e.hoveredColumn<0)e.fixedColumnsStart>0?e.target.col=0:e.target.col=t>0?t-1:t;else if(e.target.TD.offsetWidth/2+o<=d){const p=e.hoveredColumn>=e.countCols?e.countCols-1:e.hoveredColumn;e.target.col=p+1,o+=e.target.TD.offsetWidth}else e.target.col=e.hoveredColumn;let f=d,m=o;d+c+u>=a?f=a-c-u:d+u<l+h&&(f=l+h+Math.abs(u)),o>=a-1?m=a-1:m===0?m=1:i.scrollX!==void 0&&e.hoveredColumn<e.fixedColumnsStart&&(m-=e.rootElementOffset<=i.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,f),this.guideline.setPosition(null,m)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,t,r,i){const s=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),l=Po.get(this),u=Je(e.target,"sortAction");if(!a||!o||l.pressed||e.button!==0||u){l.pressed=!1,l.columnsToMove.length=0,tt(this.hot.rootElement,[d6,Wf]);return}const c=this.guideline.isBuilt()&&!this.guideline.isAppended(),h=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&h&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));const{from:d,to:f}=a,m=Math.min(d.col,f.col),p=Math.max(d.col,f.col);if(t.row<0&&t.col>=m&&t.col<=p){i.column=!0,l.pressed=!0,l.target.eventPageX=e.pageX,l.target.eventOffsetX=e.offsetX,l.hoveredColumn=t.col,l.target.TD=r,l.target.col=t.col,l.columnsToMove=this.prepareColumnsToMoving(m,p),l.hasRowHeaders=!!this.hot.getSettings().rowHeaders,l.countCols=this.hot.countCols(),l.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,l.rootElementOffset=Hn(this.hot.rootElement).left;const y=l.hasRowHeaders?-1:0,C=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,b=t.col<l.fixedColumnsStart,v=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),S=Math.abs(e.offsetX-(this.hot.isRtl()?e.target.offsetWidth:0)),L=this.getColumnsWidth(m,t.col-1)+S,_=this.getColumnsWidth(y,m-1)+(b?v:0)+L;this.backlight.setPosition(C,_),this.backlight.setSize(this.getColumnsWidth(m,p),s.hider.offsetHeight-C),this.backlight.setOffset(null,-L),Ae(this.hot.rootElement,d6)}else tt(this.hot.rootElement,f6),l.pressed=!1,l.columnsToMove.length=0}onMouseMove(e){const t=Po.get(this);if(!!t.pressed){if(e.target===this.backlight.element){const r=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(r)})}t.target.eventPageX=e.pageX,this.refreshPositions()}}onBeforeOnCellMouseOver(e,t,r,i){const s=this.hot.getSelectedRangeLast(),o=Po.get(this);!s||!o.pressed||(o.columnsToMove.indexOf(t.col)>-1?tt(this.hot.rootElement,Wf):Ae(this.hot.rootElement,Wf),i.row=!0,i.column=!0,i.cell=!0,o.hoveredColumn=t.col,o.target.TD=r)}onMouseUp(){const e=Po.get(this),t=e.target.col,r=e.columnsToMove.length;if(e.hoveredColumn=void 0,e.pressed=!1,e.backlightWidth=0,tt(this.hot.rootElement,[d6,Wf,f6]),this.hot.selection.isSelectedByColumnHeader()&&Ae(this.hot.rootElement,f6),r<1||t===void 0)return;const i=e.columnsToMove[0],s=this.hot.toPhysicalColumn(i),o=this.dragColumns(e.columnsToMove,t);if(e.columnsToMove.length=0,o===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const a=this.hot.toVisualColumn(s),l=a+r-1;this.hot.selectColumns(a,l)}}onAfterScrollVertically(){const e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1,r=e.holder.scrollTop,i=t+r;this.backlight.setPosition(i),this.backlight.setSize(null,e.hider.offsetHeight-i)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const Gf="manualColumnResize",pte=130,vT="manualColumnWidths",m6=new WeakMap;class gte extends Lt{static get PLUGIN_KEY(){return Gf}static get PLUGIN_PRIORITY(){return pte}constructor(e){super(e);const{rootDocument:t}=this.hot;this.currentTH=null,this.currentCol=null,this.selectedCols=[],this.currentWidth=null,this.newSize=null,this.startY=null,this.startWidth=null,this.startOffset=null,this.handle=t.createElement("DIV"),this.guide=t.createElement("DIV"),this.eventManager=new dn(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.columnWidthsMap=void 0,m6.set(this,{config:void 0}),Ae(this.handle,"manualColumnResizer"),Ae(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Gf]}enablePlugin(){this.enabled||(this.columnWidthsMap=new fa,this.columnWidthsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(e,t)=>this.onModifyColWidth(e,t)),this.addHook("beforeStretchingColumnWidth",(e,t)=>this.onBeforeStretchingColumnWidth(e,t)),this.addHook("beforeColumnResize",(e,t,r)=>this.onBeforeColumnResize(e,t,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=m6.get(this);e.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",vT,this.columnWidthsMap.getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",vT,e),e.value}setManualSize(e,t){const r=Math.max(t,20),i=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(i,r),r}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(t,null)}onMapInit(){const e=m6.get(this),t=this.hot.getSettings()[Gf],r=this.loadManualColumnWidths();typeof r<"u"?this.hot.batchExecution(()=>{r.forEach((i,s)=>{this.columnWidthsMap.setValueAtIndex(s,i)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((i,s)=>{this.columnWidthsMap.setValueAtIndex(s,i)})},!0),e.config=t):t===!0&&Array.isArray(e.config)&&this.hot.batchExecution(()=>{e.config.forEach((i,s)=>{this.columnWidthsMap.setValueAtIndex(s,i)})},!0)}setupHandlePosition(e){if(!e.parentNode)return;this.currentTH=e;const{_wt:t}=this.hot.view,r=t.wtTable.getCoords(this.currentTH),i=r.col;if(i<0)return;const s=cn(this.currentTH),o=this.currentTH.getBoundingClientRect(),a=i<t.getSetting("fixedColumnsStart");let l;a&&(l=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),l||(l=t.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),this.selectedCols=[];const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();re(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;ze(d,f,m=>{this.selectedCols.includes(m)||this.selectedCols.push(m)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=l.start-6,this.startWidth=parseInt(o.width,10),this.handle.style.top=`${l.top}px`,this.handle.style[this.inlineDir]=`${this.startOffset+this.startWidth}px`,this.handle.style.height=`${s}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style[this.inlineDir]=`${this.startOffset+this.currentWidth}px`}setupGuidePosition(){const e=parseInt(cn(this.handle),10),t=parseInt(this.handle.style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Ae(this.handle,"active"),Ae(this.guide,"active"),this.guide.style.top=`${t}px`,this.refreshGuidePosition(),this.guide.style.height=`${r-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){tt(this.handle,"active"),tt(this.guide,"active")}checkIfColumnHeader(e){return!!el(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}onMouseOver(e){if(!Nx(e.target)&&this.isTriggeredByRMB!==!0&&this.checkIfColumnHeader(e.target)){const t=this.getClosestTHParent(e.target);if(!t)return;const r=t.getAttribute("colspan");t&&(r===null||r==="1")&&(this.pressed||this.setupHandlePosition(t))}}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(r,i)=>{const s=this.hot.runHooks("beforeColumnResize",this.newSize,r,!0);s!==void 0&&(this.newSize=s),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,r,!0),i&&e()};this.dblclick>=2&&(this.selectedCols.length>1?(re(this.selectedCols,i=>{t(i)}),e()):re(this.selectedCols,i=>{t(i,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){Je(e.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=e.pageX,this.newSize=this.startWidth)}onMouseMove(e){if(this.pressed){const t=(e.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+t,re(this.selectedCols,r=>{this.newSize=this.setManualSize(r,this.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(r,i)=>{this.hot.runHooks("beforeColumnResize",this.newSize,r,!1),i&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,r,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?(re(this.selectedCols,i=>{t(i)}),e()):re(this.selectedCols,i=>{t(i,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",r=>this.onMouseOver(r)),this.eventManager.addEventListener(t,"mousedown",r=>this.onMouseDown(r)),this.eventManager.addEventListener(e,"mousemove",r=>this.onMouseMove(r)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyColWidth(e,t){let r=e;if(this.enabled){const i=this.hot.toPhysicalColumn(t),s=this.columnWidthsMap.getValueAtIndex(i);this.hot.getSettings()[Gf]&&s&&(r=s)}return r}onBeforeStretchingColumnWidth(e,t){let r=this.columnWidthsMap.getValueAtIndex(t);return r===null&&(r=e),r}onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}destroy(){super.destroy()}}const p6=0,CT=1,ET=2,nu="px";class yte{constructor(e){this.hot=e,this._element=null,this.state=p6}appendTo(e){e.appendChild(this._element),this.state=ET}build(){this.state===p6&&(this._element=this.hot.rootDocument.createElement("div"),this.state=CT)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=p6}isAppended(){return this.state===ET}isBuilt(){return this.state>=CT}setPosition(e,t){e!==void 0&&(this._element.style.top=e+nu),t!==void 0&&(this._element.style.left=t+nu)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+nu),t&&(this._element.style.height=t+nu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+nu),t&&(this._element.style.marginLeft=t+nu)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}const YM=yte,wte="ht__manualRowMove--backlight";class vte extends YM{build(){super.build(),Ae(this._element,wte)}}const Cte=vte,Ete="ht__manualRowMove--guideline";class bte extends YM{build(){super.build(),Ae(this._element,Ete)}}const Ste=bte;Ue.getSingleton().register("beforeRowMove");Ue.getSingleton().register("afterRowMove");const g6="manualRowMove",Rte=140,Do=new WeakMap,bT="ht__manualRowMove",zf="show-ui",y6="on-moving--rows",w6="after-selection--rows";class Tte extends Lt{static get PLUGIN_KEY(){return g6}static get PLUGIN_PRIORITY(){return Rte}constructor(e){super(e),Do.set(this,{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),this.eventManager=new dn(this),this.backlight=new Cte(e),this.guideline=new Ste(e)}isEnabled(){return!!this.hot.getSettings()[g6]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollHorizontally",()=>this.onAfterScrollHorizontally()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),Ae(this.hot.rootElement,bT),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){tt(this.hot.rootElement,bT),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const r=Do.get(this),i=r.cachedDropIndex,s=this.isMovePossible(e,t),o=this.hot.runHooks("beforeRowMove",e,t,i,s);if(r.cachedDropIndex=void 0,o===!1)return;s&&this.hot.rowIndexMapper.moveIndexes(e,t);const a=s&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,i,s,a),a}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const r=this.countFinalIndex(e,t),i=Do.get(this);return i.cachedDropIndex=t,this.moveRows(e,r)}isMovePossible(e,t){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+t>r,s=t<0,o=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||s||o||a)}isRowOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}countFinalIndex(e,t){const r=Tr(e,(i,s)=>(s<t&&(i+=1),i),0);return t-r}getRowsHeight(e,t){const r=this.hot.rowIndexMapper;let i=0;for(let s=e;s<=t;s++){const o=r.getRenderableFromVisualIndex(s);o!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(o)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[g6];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:r,to:i}=e,s=Math.min(r.row,i.row),o=Math.max(r.row,i.row);return ze(s,o,a=>{t.push(a)}),t}refreshPositions(){const e=Do.get(this),t=e.target.coords,r=this.hot.view.getFirstFullyVisibleRow(),i=this.hot.view.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(t.row)&&r>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1)),this.isFixedRowBottom(t.row)&&i<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,a=e.target.TD,l=this.hot.rootElement,u=Hn(l),c=ju(l),h=o.holder.scrollTop;let d;this.hot.rootWindow===c?d=c.scrollY:d=c.scrollTop;const f=u.top-d,m=e.target.eventPageY-f+h,p=o.hider.offsetHeight,y=o.TBODY.offsetTop,C=this.backlight.getOffset().top,b=this.backlight.getSize().height,v=a.offsetHeight/2,S=a.offsetHeight;let L=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1);const _=m>=L+v;this.isFixedRowTop(t.row)&&(L+=o.holder.scrollTop),t.row<0?e.target.row=r>0?r-1:r:_?(e.target.row=t.row+1,L+=t.row===0?S-1:S):e.target.row=t.row;let P=m,x=L;m+b+C>=p?P=p-b-C:m+C<y&&(P=y+Math.abs(C)),L>=p-1&&(x=p-1),this.backlight.setPosition(P),this.guideline.setPosition(x)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,t,r,i){const{wtTable:s,wtViewport:o}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast(),u=Do.get(this);if(!l||!a||u.pressed||e.button!==0){u.pressed=!1,u.rowsToMove.length=0,tt(this.hot.rootElement,[y6,zf]);return}const c=this.guideline.isBuilt()&&!this.guideline.isAppended(),h=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&h&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));const{from:d,to:f}=l,m=Math.min(d.row,f.row),p=Math.max(d.row,f.row);if(t.col<0&&t.row>=m&&t.row<=p){i.row=!0,u.pressed=!0,u.target.eventPageY=e.pageY,u.target.coords=t,u.target.TD=r,u.rowsToMove=this.prepareRowsToMoving();const y=s.holder.scrollLeft+o.getRowHeaderWidth();this.backlight.setPosition(null,y),this.backlight.setSize(s.hider.offsetWidth-y,this.getRowsHeight(m,p)),this.backlight.setOffset((this.getRowsHeight(m,t.row-1)+e.offsetY)*-1,null),Ae(this.hot.rootElement,y6),this.refreshPositions()}else tt(this.hot.rootElement,w6),u.pressed=!1,u.rowsToMove.length=0}onMouseMove(e){const t=Do.get(this);if(!!t.pressed){if(e.target===this.backlight.element){const r=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,r)})}t.target.eventPageY=e.pageY,this.refreshPositions()}}onBeforeOnCellMouseOver(e,t,r,i){const s=this.hot.getSelectedRangeLast(),o=Do.get(this);!s||!o.pressed||(o.rowsToMove.indexOf(t.row)>-1?tt(this.hot.rootElement,zf):Ae(this.hot.rootElement,zf),i.row=!0,i.column=!0,i.cell=!0,o.target.coords=t,o.target.TD=r)}onMouseUp(){const e=Do.get(this),t=e.target.row,r=e.rowsToMove.length;if(e.pressed=!1,e.backlightHeight=0,tt(this.hot.rootElement,[y6,zf,w6]),this.hot.selection.isSelectedByRowHeader()&&Ae(this.hot.rootElement,w6),r<1||t===void 0)return;const i=e.rowsToMove[0],s=this.hot.toPhysicalRow(i),o=this.dragRows(e.rowsToMove,t);if(e.rowsToMove.length=0,o===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const a=this.hot.toVisualRow(s),l=a+r-1;this.hot.selectRows(a,l)}}onAfterScrollHorizontally(){const e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth(),r=e.holder.scrollLeft,i=t+r;this.backlight.setPosition(null,i),this.backlight.setSize(e.hider.offsetWidth-i)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const Yf="manualRowResize",Ate=30,ST="manualRowHeights",v6=new WeakMap;class xte extends Lt{static get PLUGIN_KEY(){return Yf}static get PLUGIN_PRIORITY(){return Ate}constructor(e){super(e);const{rootDocument:t}=this.hot;this.currentTH=null,this.currentRow=null,this.selectedRows=[],this.currentHeight=null,this.newSize=null,this.startY=null,this.startHeight=null,this.startOffset=null,this.handle=t.createElement("DIV"),this.guide=t.createElement("DIV"),this.eventManager=new dn(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.rowHeightsMap=void 0,v6.set(this,{config:void 0}),Ae(this.handle,"manualRowResizer"),Ae(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Yf]}enablePlugin(){this.enabled||(this.rowHeightsMap=new fa,this.rowHeightsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(e,t)=>this.onModifyRowHeight(e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=v6.get(this);e.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",ST,this.rowHeightsMap.getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",ST,e),e.value}setManualSize(e,t){const r=this.hot.toPhysicalRow(e),i=Math.max(t,a9.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(r,i),i}setupHandlePosition(e){this.currentTH=e;const{view:t}=this.hot,{_wt:r}=t,i=r.wtTable.getCoords(this.currentTH),s=i.row;if(s<0)return;const o=Bt(this.currentTH),a=this.currentTH.getBoundingClientRect(),l=s<r.getSetting("fixedRowsTop"),u=s>=t.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),this.selectedRows=[];const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();re(d,f=>{const m=f.getTopStartCorner().row,p=f.getBottomStartCorner().row;ze(m,p,y=>{this.selectedRows.includes(y)||this.selectedRows.push(y)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=c.top-6,this.startHeight=parseInt(a.height,10),this.handle.style.top=`${this.startOffset+this.startHeight}px`,this.handle.style[this.inlineDir]=`${c.start}px`,this.handle.style.width=`${o}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style.top=`${this.startOffset+this.currentHeight}px`}setupGuidePosition(){const e=parseInt(Bt(this.handle),10),t=parseInt(this.handle.style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Ae(this.handle,"active"),Ae(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=`${t}px`,this.guide.style.width=`${r-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){tt(this.handle,"active"),tt(this.guide,"active")}checkIfRowHeader(e){var t;return el(e,["TH"],this.hot.rootElement)&&((t=e.parentNode)===null||t===void 0||(t=t.parentNode)===null||t===void 0?void 0:t.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&this.newSize<t?t:this.newSize}onMouseOver(e){if(!Nx(e.target)&&this.isTriggeredByRMB!==!0&&this.checkIfRowHeader(e.target)){const t=this.getClosestTHParent(e.target);t&&(this.pressed||this.setupHandlePosition(t))}}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(r,i)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);s!==void 0&&(this.newSize=s),this.setManualSize(r,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};this.dblclick>=2&&(this.selectedRows.length>1?(re(this.selectedRows,i=>{t(i)}),e()):re(this.selectedRows,i=>{t(i,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){Je(e.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=e.pageY,this.newSize=this.startHeight)}onMouseMove(e){this.pressed&&(this.currentHeight=this.startHeight+(e.pageY-this.startY),re(this.selectedRows,t=>{this.newSize=this.setManualSize(t,this.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(r,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!1),i&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?(re(this.selectedRows,i=>{t(i)}),e()):re(this.selectedRows,i=>{t(i,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>this.onMouseOver(r)),this.eventManager.addEventListener(e,"mousedown",r=>this.onMouseDown(r)),this.eventManager.addEventListener(t,"mousemove",r=>this.onMouseMove(r)),this.eventManager.addEventListener(t,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyRowHeight(e,t){let r=e;if(this.enabled){const i=this.hot.toPhysicalRow(t),s=this.rowHeightsMap.getValueAtIndex(i);this.hot.getSettings()[Yf]&&s&&(r=s)}return r}onMapInit(){const e=v6.get(this),t=this.hot.getSettings()[Yf],r=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof r<"u"?r.forEach((i,s)=>{this.rowHeightsMap.setValueAtIndex(s,i)}):Array.isArray(t)?(t.forEach((i,s)=>{this.rowHeightsMap.setValueAtIndex(s,i)}),e.config=t):t===!0&&Array.isArray(e.config)&&e.config.forEach((i,s)=>{this.rowHeightsMap.setValueAtIndex(s,i)})},!0)}destroy(){super.destroy()}}class Mte{constructor(e,t,r,i,s,o){this.row=e,this.col=t,this.rowspan=r,this.colspan=i,this.removed=!1,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){return Vt`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return Vt`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return Vt`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return Vt`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,t,r){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const t=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const r=e[0]||e[1],i=t+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(t,i),l=Math.max(t,i),u=this[o],c=this[o]+this[s]-1;if(u>=t&&(this[o]+=r),r>0)t<=c&&t>u&&(this[s]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[o]-=d+r,this[s]-=h}else if(u<=a&&c>=l)this[s]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[s]-=h}}return!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const Cs=Mte;function tw(n,e,t,r){e?e.row===t&&e.col===r?(n.setAttribute("rowspan",e.rowspan.toString()),n.setAttribute("colspan",e.colspan.toString())):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="none"):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="")}class IE{constructor(e){this.plugin=e,this.mergedCells=[],this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return Vt`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){const r=this.mergedCells;let i=!1;return re(r,s=>s.row<=e&&s.row+s.rowspan-1>=e&&s.col<=t&&s.col+s.colspan-1>=t?(i=s,!1):!0),i}getByRange(e){const t=this.mergedCells;let r=!1;return re(t,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}getWithinRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,i=[];let s=e;if(!s.includesRange){const o=this.hot._createCellCoords(s.from.row,s.from.col),a=this.hot._createCellCoords(s.to.row,s.to.col);s=this.hot._createCellRange(o,o,a)}return re(r,o=>{const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1),u=this.hot._createCellRange(a,a,l);t?s.overlaps(u)&&i.push(o):s.includesRange(u)&&i.push(o)}),i.length?i:!1}add(e){const t=this.mergedCells,r=e.row,i=e.col,s=e.rowspan,o=e.colspan,a=new Cs(r,i,s,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),t.push(a),a):(Xt(IE.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,t){const r=this.mergedCells,i=this.get(e,t),s=i?this.mergedCells.indexOf(i):-1;return i&&s!==-1?(r.splice(s,1),i):!1}clear(){const e=this.mergedCells,t=[],r=[];re(e,i=>{const s=this.hot.getCell(i.row,i.col);s&&t.push([s,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,re(t,(i,s)=>{ze(0,i.rowspan-1,o=>{ze(0,i.colspan-1,a=>{if(a!==0||o!==0){const l=this.hot.getCell(i.row+o,i.col+a);l&&r.push([l,null,null,null])}})}),t[s][1]=null}),re(t,i=>{tw(...i)}),re(r,i=>{tw(...i)})}isOverlapping(e){const t=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return re(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(t)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,t){const r=this.get(e,t);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===t}getFirstRenderableCoords(e,t){const r=this.get(e,t);if(!r||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,s)}shiftCollections(e,t,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}re(this.mergedCells,s=>{s.shift(i,t)}),Py(this.mergedCells.length-1,0,s=>{const o=this.mergedCells[s];o&&o.removed&&this.mergedCells.splice(this.mergedCells.indexOf(o),1)})}}const Nte=IE;class Ite{constructor(e){this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let r=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?r="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?r="up":t[1]===e[1]&&t[2]===e[2]?r="right":r="left",r}snapDragArea(e,t,r,i){const s=t.slice(0),o=this.getAutofillSize(e,t,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(o/d)*d,m=o-f,p=this.getFarthestCollection(e,t,r,i);if(p){if(r==="down"){const y=p.row+p.rowspan-a-m;s[2]+y>=this.plugin.hot.countRows()?s[2]-=m:s[2]+=m?y:0}else if(r==="right"){const y=p.col+p.colspan-l-m;s[3]+y>=this.plugin.hot.countCols()?s[3]-=m:s[3]+=m?y:0}else if(r==="up"){const y=u-m-p.row+1;s[0]+y<0?s[0]+=m:s[0]-=m?y:0}else if(r==="left"){const y=c-m-p.col+1;s[1]+y<0?s[1]+=m:s[1]-=m?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:o,dragArea:s,cycleLength:d}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Un(this.currentFillData,e)}getAutofillSize(e,t,r){const[i,s,o,a]=e,[l,u,c,h]=t;switch(r){case"up":return i-l;case"down":return c-o;case"left":return s-u;case"right":return h-a;default:return null}}getDragArea(e,t,r){const[i,s,o,a]=e,[l,u,c,h]=t;switch(r){case"up":return[l,u,i-1,a];case"down":return[o+1,s,c,a];case"left":return[l,u,o,s-1];case"right":return[i,a+1,c,h];default:return null}}getFarthestCollection(e,t,r,i){const[s,o,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?s:o,d=this.getAutofillSize(e,t,r),f=u?a-s+1:l-o+1,m=Math.floor(d/f)*f,p=d-m;let y=null,C=null,b=null;switch(r){case"up":y="includesVertically",b=c-p+1;break;case"left":y="includesHorizontally",b=c-p+1;break;case"down":y="includesVertically",b=h+p-1;break;case"right":y="includesHorizontally",b=h+p-1;break}return re(i,v=>{v[y](b)&&v.isFarther(C,r)&&(C=v)}),C}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,s=(u,c)=>{switch(i){case"up":return u.row-c>=t.from.row;case"down":return u.row+u.rowspan-1+c<=t.to.row;case"left":return u.col-c>=t.from.column;case"right":return u.col+u.colspan-1+c<=t.to.column;default:return null}};let o=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],o=l*this.currentFillData.cycleLength,s(a,o))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},r={min:null,max:null};return re(e,i=>{const s=i[0],o=this.plugin.hot.propToCol(i[1]);(t.min===null||s<t.min)&&(t.min=s),(t.max===null||s>t.max)&&(t.max=s),(r.min===null||o<r.min)&&(r.min=o),(r.max===null||o>r.max)&&(r.max=o)}),{from:{row:t.min,column:r.min},to:{row:t.max,column:r.max}}}dragAreaOverlapsCollections(e,t,r){const i=this.getDragArea(e,t,r),[s,o,a,l]=i,u=this.plugin.hot._createCellCoords(s,o),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(h,!0)}}const Ote=Ite;class _te{constructor(e){this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}snapDelta(e,t,r){const i=t.to,s=i.row+e.row,o=i.col+e.col;e.row?this.jumpOverMergedCell(e,r,s):e.col&&this.jumpOverMergedCell(e,r,o)}jumpOverMergedCell(e,t,r){let i=e.row||e.col,s=null,o=null,a=null;e.row?(s=t.includesVertically(r),o=t.row,a=t.getLastRow()):e.col&&(s=t.includesHorizontally(r),o=t.col,a=t.getLastColumn()),i!==0&&(i>0?s&&r!==o&&(i+=a-r+1):s&&r!==a&&(i-=r-o+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,t){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+t.row,e.to.col+t.col))}getSelectedMergedCellClassName(e,t,r,i){const s=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const c=this.plugin.mergedCellsCollection.get(e,t);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(s<=c.row&&o<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const r=[];if(!t||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let s=0;s<e.colspan;s+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+s));for(let i=0;i<r.length;i+=1){const s=[];for(let o=0;o<t.length;o+=1)s[o]=t[o].includes(r[i]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const Lte=_te;function Pte(n){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const t=n.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(uC)}return this.getTranslatedPhrase(lC)},callback(){n.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?Cs.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}Ue.getSingleton().register("beforeMergeCells");Ue.getSingleton().register("afterMergeCells");Ue.getSingleton().register("beforeUnmergeCells");Ue.getSingleton().register("afterUnmergeCells");const sh="mergeCells",Dte=150,RT=new WeakMap,TT=sh;class kte extends Lt{static get PLUGIN_KEY(){return sh}static get PLUGIN_PRIORITY(){return Dte}constructor(e){super(e),RT.set(this,{lastDesiredCoords:null}),this.mergedCellsCollection=null,this.autofillCalculations=null,this.selectionCalculations=null}isEnabled(){return!!this.hot.getSettings()[sh]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Nte(this),this.autofillCalculations=new Ote(this),this.selectionCalculations=new Lte(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("modifyTransformStart",function(){return e.onModifyTransformStart(...arguments)}),this.addHook("afterModifyTransformStart",function(){return e.onAfterModifyTransformStart(...arguments)}),this.addHook("modifyTransformEnd",function(){return e.onModifyTransformEnd(...arguments)}),this.addHook("modifyGetCellCoords",function(){return e.onModifyGetCellCoords(...arguments)}),this.addHook("beforeSetRangeStart",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeEnd",function(){return e.onBeforeSetRangeEnd(...arguments)}),this.addHook("afterIsMultipleSelection",function(){return e.onAfterIsMultipleSelection(...arguments)}),this.addHook("afterRenderer",function(){return e.onAfterRenderer(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.addMergeActionsToContextMenu(...arguments)}),this.addHook("afterGetCellMeta",function(){return e.onAfterGetCellMeta(...arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return e.onAfterViewportRowCalculatorOverride(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),this.addHook("modifyAutofillRange",function(){return e.onModifyAutofillRange(...arguments)}),this.addHook("afterCreateCol",function(){return e.onAfterCreateCol(...arguments)}),this.addHook("afterRemoveCol",function(){return e.onAfterRemoveCol(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeDrawBorders",function(){return e.onBeforeDrawAreaBorders(...arguments)}),this.addHook("afterDrawSelection",function(){return e.onAfterDrawSelection(...arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return e.onBeforeRemoveCellClassNames(...arguments)}),this.addHook("beforeUndoStackChange",(t,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[sh];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!yx())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:s}=r;for(let o=i+1;o<i+s;o++)t.push(o)}),t=[...new Set(t)],t.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>(s==null?void 0:s.name)==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(i);o&&(o.style.background=Yh(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=Yh(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let t=!0;return e?(Cs.containsNegativeValues(e)?(Xt(Cs.NEGATIVE_VALUES_WARNING(e)),t=!1):Cs.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Xt(Cs.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):Cs.isSingleCell(e)?(Xt(Cs.IS_SINGLE_CELL(e)),t=!1):Cs.containsZeroSpan(e)&&(Xt(Cs.ZERO_SPAN_WARNING(e)),t=!1),t):!1}generateFromSettings(e){if(Array.isArray(e)){const t=[];if(re(e,r=>{if(!this.validateSetting(r))return;const i=this.hot._createCellCoords(r.row,r.col),s=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),o=this.hot._createCellRange(i,i,s);this.mergeRange(o,!0,!0),ze(r.row,r.row+r.rowspan-1,a=>{ze(r.col,r.col+r.colspan-1,l=>{a===r.row&&l===r.col||t.push([a,l,null])})})}),t.length===0)return;this.hot.setDataAtCell(t)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:r}=e;this.toggleMerge(e),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:i.row,col:i.col,rowspan:s.row-i.row+1,colspan:s.col-i.col+1},a=[];let l=null;return this.canMergeRange(o,t)?(this.hot.runHooks("beforeMergeCells",e,t),ze(0,o.rowspan-1,c=>{ze(0,o.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+c,o.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o)?(r?l=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,t),l):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);!r||(this.hot.runHooks("beforeUnmergeCells",e,t),re(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),ze(0,i.rowspan-1,s=>{ze(0,i.colspan-1,o=>{this.hot.removeCellMeta(i.row+s,i.col+o,"hidden"),this.hot.removeCellMeta(i.row+s,i.col+o,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,r,i){const s=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,t,r,i){const s=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(s,s,o))}onAfterInit(){this.generateFromSettings(this.hot.getSettings()[sh]),this.hot.render()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render()},runOnlyIf:r=>!r.altKey,group:TT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(TT)}onAfterIsMultipleSelection(e){if(e){const t=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast();for(let i=0;i<t.length;i+=1)if(r.from.row===t[i].row&&r.from.col===t[i].col&&r.to.row===t[i].row+t[i].rowspan-1&&r.to.col===t[i].col+t[i].colspan-1)return!1}return e}onModifyTransformStart(e){const t=RT.get(this),r=this.hot.getSelectedRangeLast();let i={row:e.row,col:e.col},s=null;const o=this.hot._createCellCoords(r.highlight.row,r.highlight.col),a=this.mergedCellsCollection.get(o.row,o.col);if(t.lastDesiredCoords||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),a){const u=this.hot._createCellCoords(a.row,a.col),c=this.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1);this.hot._createCellRange(u,u,c).includes(t.lastDesiredCoords)||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),i.row=t.lastDesiredCoords.row?t.lastDesiredCoords.row-o.row:i.row,i.col=t.lastDesiredCoords.col?t.lastDesiredCoords.col-o.col:i.col,e.row>0?i.row=a.row+a.rowspan-1-o.row+e.row:e.row<0&&(i.row=o.row-a.row+e.row),e.col>0?i.col=a.col+a.colspan-1-o.col+e.col:e.col<0&&(i.col=o.col-a.col+e.col)}s=this.hot._createCellCoords(r.highlight.row+i.row,r.highlight.col+i.col);const l=this.mergedCellsCollection.get(s.row,s.col);if(l){const u=this.mergedCellsCollection.getFirstRenderableCoords(l.row,l.col);t.lastDesiredCoords=s,i={row:u.row-o.row,col:u.col-o.col}}i.row!==0&&(e.row=i.row),i.col!==0&&(e.col=i.col)}onModifyTransformEnd(e){const t=this.hot.getSelectedRangeLast(),r=Xr(e),i=this.selectionCalculations.getUpdatedSelectionRange(t,e);let s=Xr(r);const o=this.mergedCellsCollection.getWithinRange(i,!0);do s=Xr(r),this.selectionCalculations.getUpdatedSelectionRange(t,r),re(o,a=>{this.selectionCalculations.snapDelta(r,t,a)});while(r.row!==s.row||r.col!==s.col);e.row=r.row,e.col=r.col}onModifyGetCellCoords(e,t){if(e<0||t<0)return;const r=this.mergedCellsCollection.get(e,t);if(!r)return;const{row:i,col:s,colspan:o,rowspan:a}=r;return[i,s,i+a-1,s+o-1]}addMergeActionsToContextMenu(e){e.items.push({name:"---------"},Pte(this))}onAfterRenderer(e,t,r){const i=this.mergedCellsCollection.get(t,r),s=dt(i)?Xr(i):void 0;if(dt(s)){const{rowIndexMapper:o,columnIndexMapper:a}=this.hot,{row:l,col:u,colspan:c,rowspan:h}=s,[d,f]=this.translateMergedCellToRenderable(l,h,u,c),m=o.getRenderableFromVisualIndex(t),p=a.getRenderableFromVisualIndex(r),y=d-m+1,C=f-p+1;s.row=o.getNearestNotHiddenIndex(s.row,1),s.col=a.getNearestNotHiddenIndex(s.col,1),s.rowspan=Math.min(s.rowspan,y),s.colspan=Math.min(s.colspan,C)}tw(e,s,t,r)}onBeforeSetRangeStart(e){if(this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)){const t=this.mergedCellsCollection.get(e.row,e.col);[e.row,e.col]=[t.row,t.col]}}onBeforeSetRangeEnd(e){const t=this.hot.getSelectedRangeLast();t.highlight=this.hot._createCellCoords(t.highlight.row,t.highlight.col),t.to=e;let r=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{r=!1;for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1){const o=this.mergedCellsCollection.mergedCells[i].getRange();t.expandByRange(o)&&(e.row=t.to.row,e.col=t.to.col,r=!0)}}while(r)}onAfterGetCellMeta(e,t,r){const i=this.mergedCellsCollection.get(e,t);i&&(i.row!==e||i.col!==t?r.copyable=!1:(r.rowspan=i.rowspan,r.colspan=i.colspan))}onAfterViewportRowCalculatorOverride(e){const t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}modifyViewportRowStart(e,t){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(i,s);if(dt(o)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(i,s);if(dt(o)){const a=o.row+o.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,t);return}}}}onAfterViewportColumnCalculatorOverride(e){const t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}modifyViewportColumnStart(e,t){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(s,i);if(dt(o)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<t;s+=1){const o=this.mergedCellsCollection.get(s,i);if(dt(o)){const a=o.col+o.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,r,i){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,l;t===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+t-1,-1),i===0?l=o.getNearestNotHiddenIndex(r,1):l=o.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?s.getRenderableFromVisualIndex(a):e,c=r>=0?o.getRenderableFromVisualIndex(l):r;return[u,c]}onModifyAutofillRange(e,t){this.autofillCalculations.correctSelectionAreaSize(t);const r=this.autofillCalculations.getDirection(t,e);let i=e;if(this.autofillCalculations.dragAreaOverlapsCollections(t,i,r))return i=t,i;const s=this.mergedCellsCollection.getWithinRange({from:{row:t[0],col:t[1]},to:{row:t[2],col:t[3]}});return s&&(i=this.autofillCalculations.snapDragArea(t,i,r,s)),i}onAfterCreateCol(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}onAfterRemoveCol(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}onAfterCreateRow(e,t,r){r!=="auto"&&this.mergedCellsCollection.shiftCollections("down",e,t)}onAfterRemoveRow(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}onAfterChange(e,t){t==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(e)}onBeforeDrawAreaBorders(e,t){if(t&&t==="area"){const r=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(r);re(i,s=>{r.getBottomEndCorner().row===s.getLastRow()&&r.getBottomEndCorner().col===s.getLastColumn()&&(e[2]=s.row,e[3]=s.col)})}}onAfterModifyTransformStart(e,t,r){if(!this.enabled)return;const i=this.mergedCellsCollection.get(e.row,e.col);if(!i)return;const s=t>0,o=t<0,a=r<0,l=r>0,u=i.row+i.rowspan-1===this.hot.countRows()-1,c=i.row===0,h=i.col+i.colspan-1===this.hot.countCols()-1,d=i.col===0;(s&&u||o&&c||l&&h||a&&d)&&(e.row=i.row,e.col=i.col)}onAfterDrawSelection(e,t,r,i){if(!!r)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,r,i)}onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}function Fte(n,e){return function(t,r){const[,...i]=t,[,...s]=r;return function o(a){const l=n[a],u=e[a],c=i[a],h=s[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:D9(u.type))(l,u,d)(c,h);if(m===_s){const p=a+1;if(typeof e[p]<"u")return o(p)}return m}(0)}}function AT(){Xt(Vt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const jM="sort";function Hte(n,e,t){const r=[];return t===!1||n.isColumnSorted(e)&&n.getNumberOfSortedColumns()>1&&r.push(`${jM}-${n.getIndexOfColumnInSortQueue(e)+1}`),r}function Ute(n){const e=n.className.split(" "),t=new RegExp(`^${jM}-[0-9]{1,2}$`);return e.filter(r=>t.test(r))}const nw="multiColumnSorting",Bte=170,Vte="append",xT="columnSorting";P9(nw,Fte);class $te extends k9{static get PLUGIN_KEY(){return nw}static get PLUGIN_PRIORITY(){return Bte}constructor(e){super(e),this.pluginKey=nw}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[xT]&&AT(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),tt(e,Ute(e)),this.enabled!==!1&&Ae(e,Hte(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[xT]&&AT(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){$y(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,Vte))):this.sort(this.getColumnNextConfig(t.col)))}}const Wte="multipleSelectionHandles",Gte=160;class zte extends Lt{static get PLUGIN_KEY(){return Wte}static get PLUGIN_PRIORITY(){return Gte}constructor(e){super(e),this.dragged=[],this.eventManager=null,this.lastSetCell=null}isEnabled(){return Ns()}enablePlugin(){this.enabled||(this.eventManager||(this.eventManager=new dn(this)),this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(i);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",i=>{let s;if(Je(i.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1;if(Je(i.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",i=>{if(Je(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Je(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",i=>{const{rootDocument:s}=this.hot;let o,a,l,u,c,h;if(e.dragged.length===0)return;const d=s.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(o=e.hot.getCoords(d),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(o),h=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,t,r,i,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":s==="top"?c={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(l.row,t.col)}:c={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,o.col)};break;case"SE-NW":s==="bottom"&&(c={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,o.col)});break}break;case"NW-SE":switch(i){case"NE-SW":s==="top"?c={start:t,end:l}:c.end=t;break;case"NW-SE":s==="top"?c={start:t,end:a}:c.end=t;break;case"SE-NW":s==="top"?c={start:t,end:o}:c.end=t;break;case"SW-NE":s==="top"?c={start:t,end:u}:c.end=t;break}break;case"SW-NE":switch(i){case"NW-SE":s==="bottom"?c={start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(l.row,t.col)}:c={start:this.hot._createCellCoords(o.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SW-NE":s==="top"?c={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)}:c={start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(o.row,t.col)};break;case"SE-NW":s==="bottom"?c={start:this.hot._createCellCoords(t.row,u.col),end:this.hot._createCellCoords(o.row,t.col)}:s==="top"&&(c={start:l,end:t});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(c.end=t);break;case"SE-NW":s==="top"?c.end=t:c={start:t,end:o};break}break}return c}isDragged(){return this.dragged.length>0}}function rw(){let{label:n="",colspan:e=1,origColspan:t=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:n,colspan:e,origColspan:t,collapsible:r,isCollapsed:s,crossHiddenColumns:i,isHidden:o,isRoot:a,isPlaceholder:l}}function KM(){return{label:"",isPlaceholder:!0}}function Yte(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const t=[];if(e===0)return t;re(n,i=>{const s=[];let o=0;t.push(s),re(i,a=>{const l=rw();if(dt(a)){const{label:c,colspan:h}=a;l.label=In(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h)}else l.label=In(a);o+=l.origColspan;let u=!1;if(o>=e&&(l.colspan=l.origColspan-(o-e),l.origColspan=l.colspan,u=!0),s.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)s.push(KM());return!u})});const r=Math.max(...ct(t,i=>i.length));return re(t,i=>{if(i.length<r){const s=ct(new Array(r-i.length),()=>rw());i.splice(i.length,0,...s)}}),t}function C6(n,e,t){jte(n,e),e.set(n,t)}function jte(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gi(n,e){var t=qM(n,e,"get");return Kte(n,t)}function Kte(n,e){return e.get?e.get.call(n):e.value}function zc(n,e,t){var r=qM(n,e,"set");return qte(n,r,t),t}function qM(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function qte(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const MT=["label","collapsible"];var to=new WeakMap,Oa=new WeakMap,E6=new WeakMap;class Xte{constructor(){C6(this,to,{writable:!0,value:[]}),C6(this,Oa,{writable:!0,value:0}),C6(this,E6,{writable:!0,value:1/0})}setColumnsLimit(e){zc(this,E6,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];zc(this,to,Yte(e,Gi(this,E6))),zc(this,Oa,Gi(this,to).length)}getData(){return Gi(this,to)}mergeWith(e){re(e,t=>{let{row:r,col:i,...s}=t;const o=this.getHeaderSettings(r,i);o!==null&&Un(o,s,MT)})}map(e){re(Gi(this,to),t=>{re(t,r=>{const i=e({...r});dt(i)&&Un(r,i,MT)})})}getHeaderSettings(e,t){var r;if(e>=Gi(this,Oa)||e<0)return null;const i=Gi(this,to)[e];return t>=i.length?null:(r=i[t])!==null&&r!==void 0?r:null}getHeadersSettings(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Gi(this,Oa)||e<0)return i;const s=Gi(this,to)[e];let o=0;for(let a=t;a<s.length;a++){const l=s[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),o===r)break;if(o>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Gi(this,Oa)}getColumnsCount(){return Gi(this,Oa)>0?Gi(this,to)[0].length:0}clear(){zc(this,to,[]),zc(this,Oa,0)}}function b6(n,e,t){return e=Qte(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Qte(n){var e=Zte(n,"string");return typeof e=="symbol"?e:String(e)}function Zte(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Jte="DF-pre-order";function XM(n,e){let t=n.call(e,this);for(let r=0;r<this.childs.length;r++){if(t===!1)return!1;t=XM.call(this.childs[r],n,e)}return t}const ene="DF-post-order";function QM(n,e){for(let t=0;t<this.childs.length;t++)if(QM.call(this.childs[t],n,e)===!1)return!1;return n.call(e,this)}const ZM="BF";function tne(n,e){const t=[this];function r(){if(t.length===0)return;const i=t.shift();t.push(...i.childs),n.call(e,i)!==!1&&r()}r()}const nne=ZM,NT=new Map([[Jte,XM],[ene,QM],[ZM,tne]]);class Rp{constructor(e){b6(this,"data",{}),b6(this,"parent",null),b6(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const t=new Rp({...e.data});for(let r=0;r<e.childs.length;r++)t.addChild(this.cloneTree(e.childs[r]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:nne;if(!NT.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);NT.get(t).call(this,e,this)}walkUp(e){const t=this,r=i=>{e.call(t,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function S6(n,e,t){rne(n,e),e.set(n,t)}function rne(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mr(n,e){var t=JM(n,e,"get");return ine(n,t)}function ine(n,e){return e.get?e.get.call(n):e.value}function sne(n,e,t){var r=JM(n,e,"set");return one(n,r,t),t}function JM(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function one(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var ru=new WeakMap,_a=new WeakMap,iu=new WeakMap;class ane{constructor(e){S6(this,ru,{writable:!0,value:new Map}),S6(this,_a,{writable:!0,value:new Map}),S6(this,iu,{writable:!0,value:null}),sne(this,iu,e)}getRoots(){return Array.from(Mr(this,ru).values())}getRootByColumn(e){let t;return Mr(this,_a).has(e)&&(t=Mr(this,ru).get(Mr(this,_a).get(e))),t}getNode(e,t){const r=this.getRootByColumn(t);if(!r)return;const i=t-Mr(this,_a).get(t);let s=0,o;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=s&&i<=s+l-1)return o=a,o.data.isRoot=t===o.data.columnIndex,!1;s+=l}}),o}rebuildTreeIndex(){let e=0;Mr(this,_a).clear(),re(Mr(this,ru),t=>{let[,{data:{colspan:r}}]=t;for(let i=e;i<e+r;i++)Mr(this,_a).set(i,e);e+=r})}buildTree(){this.clear();const e=Mr(this,iu).getColumnsCount();let t=0;for(;t<e;){const r=Mr(this,iu).getHeaderSettings(0,t),i=new Rp;Mr(this,ru).set(t,i),this.buildLeaves(i,t,0,r.origColspan),t+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=Mr(this,iu).getHeadersSettings(r,t,i);r+=1,re(s,o=>{const a={...o,headerLevel:r-1,columnIndex:t};let l;r===1?(e.data=a,l=e):(l=new Rp(a),e.addChild(l)),r<Mr(this,iu).getLayersCount()&&this.buildLeaves(l,t,r,o.origColspan),t+=o.origColspan})}clear(){Mr(this,ru).clear(),Mr(this,_a).clear()}}function eN(n,e){n.walkDown(t=>{let{data:r,childs:i}=t;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let s=1;s<r.colspan;s++)e(r.columnIndex+s)})}function Tp(n,e){let{childs:t}=n;if(t.length!==0)return t[0].data[e]}function Ap(n){return Tp(n,"origColspan")===n.data.origColspan}function OE(n){const{data:e,childs:t}=n;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Ap(n))return OE(t[0]);e.isCollapsed=!1;const i=t.slice(1),s=new Set;let o=0;if(i.length>0)re(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;o+=l.colspan,eN(a,u=>{s.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;o=l-a;for(let c=1;c<l;c++)s.add(u+c)}return n.walkUp(a=>{const{data:l}=a;l.colspan+=o,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Ap(a)&&(l.isCollapsed=Tp(a,"isCollapsed"))}),{rollbackModification:()=>_E(n),affectedColumns:Array.from(s),colspanCompensation:o}}function _E(n){var e;const{data:t,childs:r}=n;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Ap(n))return _E(r[0]);t.isCollapsed=!0;const s=r.slice(1),o=new Set;if(s.length>0)re(s,l=>{eN(l,u=>{o.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=t;for(let c=1;c<l;c++){const h=u+c;o.add(h)}}const a=t.colspan-((e=Tp(n,"colspan"))!==null&&e!==void 0?e:1);return n.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Ap(l)&&(u.isCollapsed=Tp(l,"isCollapsed"))}),{rollbackModification:()=>OE(n),affectedColumns:Array.from(o),colspanCompensation:a}}function lne(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(Vt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(t.includes(e))return;let r=!1;n.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return r=!0,!1}),!r&&n.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function une(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(Vt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(!t.includes(e))return;let r=!1;n.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return r=!0,!1}),!r&&n.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const IT=new Map([["collapse",_E],["expand",OE],["hide-column",lne],["show-column",une]]);function cne(n,e,t){if(!IT.has(n))throw new Error(`The node modifier action ("${n}") does not exist.`);return IT.get(n)(e,t)}function jf(n){const e=[];return re(n,t=>{t.walkDown(r=>{const i=r.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:l}=i,u=dne(e,a);let c=!1;for(let h=o;h<o+s;h++)if(l.includes(h)||c)u.push(KM());else{const f=hne(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function hne(n){const{crossHiddenColumns:e,...t}=rw(n);return t}function dne(n,e){let t;return Array.isArray(n[e])?t=n[e]:(t=[],n[e]=t),t}function R6(n,e,t){fne(n,e),e.set(n,t)}function fne(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yc(n,e,t){var r=tN(n,e,"set");return mne(n,r,t),t}function mne(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function yn(n,e){var t=tN(n,e,"get");return pne(n,t)}function tN(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function pne(n,e){return e.get?e.get.call(n):e.value}var gs=new WeakMap,oi=new WeakMap,La=new WeakMap;class gne{constructor(){R6(this,gs,{writable:!0,value:new Xte}),R6(this,oi,{writable:!0,value:new ane(yn(this,gs))}),R6(this,La,{writable:!0,value:[[]]})}setState(e){yn(this,gs).setData(e);let t=!1;try{yn(this,oi).buildTree()}catch{yn(this,oi).clear(),yn(this,gs).clear(),t=!0}return Yc(this,La,jf(yn(this,oi).getRoots())),t}setColumnsLimit(e){yn(this,gs).setColumnsLimit(e)}mergeStateWith(e){const t=ct(e,r=>{let{row:i,...s}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...s}});yn(this,gs).mergeWith(t),yn(this,oi).buildTree(),Yc(this,La,jf(yn(this,oi).getRoots()))}mapState(e){yn(this,gs).map(e),yn(this,oi).buildTree(),Yc(this,La,jf(yn(this,oi).getRoots()))}mapNodes(e){return Tr(yn(this,oi).getRoots(),(t,r)=>(r.walkDown(i=>{const s=e(i.data);s!==void 0&&t.push(s)}),t),[])}triggerNodeModification(e,t,r){t<0&&(t=this.rowCoordsToLevel(t));const i=yn(this,oi).getNode(t,r);let s;return i&&(s=cne(e,i,r),Yc(this,La,jf(yn(this,oi).getRoots()))),s}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=yn(this,La)[e])===null||i===void 0?void 0:i[t])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=yn(this,oi).getNode(e,t);return r?{...r.data}:null}findLeftMostColumnIndex(e,t){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,t))!==null&&r!==void 0?r:{isRoot:!0};if(i)return t;let s=t-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}getLayersCount(){return yn(this,gs).getLayersCount()}getColumnsCount(){return yn(this,gs).getColumnsCount()}clear(){Yc(this,La,[]),yn(this,gs).clear(),yn(this,oi).clear()}}function jc(n,e,t){return e=yne(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yne(n){var e=wne(n,"string");return typeof e=="symbol"?e:String(e)}function wne(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class vne{constructor(e,t){jc(this,"hot",void 0),jc(this,"nestedHeaderSettingsGetter",void 0),jc(this,"layersCount",0),jc(this,"container",void 0),jc(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let r=0;r<t;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),s=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(s,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:r}=this.hot,i=t.createDocumentFragment(),s=t.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=t.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=t.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;o&&(m+='<button class="changeType"></button>'),pc(d,m),d.colSpan=f.colspan,u.appendChild(d)}}s.appendChild(u)}i.appendChild(s),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}const Cne=vne;function OT(n,e,t){return e=Ene(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ene(n){var e=bne(n,"string");return typeof e=="symbol"?e:String(e)}function bne(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function _T(n,e,t){Sne(n,e),e.set(n,t)}function Sne(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kf(n,e,t){var r=nN(n,e,"set");return Rne(n,r,t),t}function Rne(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function on(n,e){var t=nN(n,e,"get");return Tne(n,t)}function nN(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Tne(n,e){return e.get?e.get.call(n):e.value}const LT="nestedHeaders",Ane=280;var An=new WeakMap,ko=new WeakMap;class xne extends Lt{constructor(){super(...arguments),_T(this,An,{writable:!0,value:new gne}),_T(this,ko,{writable:!0,value:null}),OT(this,"ghostTable",new Cne(this.hot,(e,t)=>this.getHeaderSettings(e,t))),OT(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return LT}static get PLUGIN_PRIORITY(){return Ane}isEnabled(){return!!this.hot.getSettings()[LT]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&Xt(Vt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",function(){return e.onAfterOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterGetColumnHeaderRenderers",r=>this.onAfterGetColumnHeaderRenderers(r)),this.addHook("modifyColWidth",function(){return e.onModifyColWidth(...arguments)}),this.addHook("modifyColumnHeaderValue",function(){return e.onModifyColumnHeaderValue(...arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return e.onBeforeHighlightingColumnHeader(...arguments)}),this.addHook("beforeCopy",function(){return e.onBeforeCopy(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();on(this,An).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=on(this,An).setState(e)),this.detectedOverlappedHeaders&&Xt(Vt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,r)=>{const i=t===!0?"hide-column":"show-column";on(this,An).triggerColumnModification(i,r)}),!on(this,ko)&&this.enabled&&Kf(this,ko,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(r=>{let{op:i,index:s,newValue:o}=r;if(i==="replace"){const a=o===!0?"hide-column":"show-column";on(this,An).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),on(this,An).clear(),on(this,ko).unsubscribe(),Kf(this,ko,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return on(this,An)}getLayersCount(){return on(this,An).getLayersCount()}getHeaderSettings(e,t){return on(this,An).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<t;o++){const a=r.childNodes[o];if(!a)break;const l=i.childNodes[o],u=s?s.childNodes[o]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),tt(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),tt(l.childNodes[c],"hiddenHeader")),s&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),tt(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,s)=>{var o;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),s.removeAttribute("colspan"),tt(s,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:d}=(o=on(this,An).getHeaderSettings(e,u))!==null&&o!==void 0?o:{label:""};if(d||h)Ae(s,"hiddenHeader");else if(c>1){var f,m;const{wtOverlays:p}=l._wt,y=(f=p.topInlineStartCornerOverlay)===null||f===void 0?void 0:f.clone.wtTable.THEAD.contains(s),C=(m=p.inlineStartOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(s),b=y||C?Math.min(c,r-i):c;b>1&&s.setAttribute("colspan",b)}this.hot.view.appendColHeader(u,s,function(){return t.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,t){var r;const{isHidden:i,isPlaceholder:s}=(r=on(this,An).getHeaderSettings(t,e))!==null&&r!==void 0?r:{};return s||i?"":this.hot.getColHeader(e,t)}onBeforeHighlightingColumnHeader(e,t,r){const i=on(this,An).getHeaderTreeNodeData(t,e);if(!i)return e;const{classNames:s,columnCursor:o,selectionType:a,selectionWidth:l}=r,{isRoot:u,colspan:c}=on(this,An).getHeaderSettings(t,e);if(a===Wd){if(!u)return i.columnIndex}else a===i1&&(c>l-o||!u)&&(s.length=0);return e}onBeforeCopy(e,t,r){let{columnHeadersCount:i}=r;if(i!==0)for(let o=0;o<t.length;o++){const{startRow:a,startCol:l,endRow:u,endCol:c}=t[o],h=u-a+1,d=l-c+1;if(a>=0||d===1)break;for(let f=l;f<=c;f++)for(let m=a;m<=u;m++){var s;const p=h+m,y=f-l;if(y===0)continue;((s=on(this,An).getHeaderTreeNodeData(m,f))===null||s===void 0?void 0:s.isRoot)===!1&&(e[p][y]="")}}}onBeforeOnCellMouseDown(e,t,r,i){this._getHeaderTreeNodeDataByCoords(t)&&(i.column=!0)}onAfterOnCellMouseDown(e,t){const r=this._getHeaderTreeNodeDataByCoords(t);if(!r)return;const{selection:i}=this.hot,s=i.isSelected()?i.getSelectedRange().current():null,o=[],{columnIndex:a,origColspan:l}=r,u=!i.inInSelection(t);e.shiftKey&&s?t.col<s.from.col?o.push(s.getTopEndCorner().col,a,t.row):t.col>s.from.col?o.push(s.getTopStartCorner().col,a+l-1,t.row):o.push(a,a+l-1,t.row):(tv(e)||sl(e)&&u)&&o.push(a,a+l-1,t.row),i.selectColumns(...o)}onBeforeOnCellMouseOver(e,t,r,i){if(!this.hot.view.isMouseDown())return;const s=this._getHeaderTreeNodeDataByCoords(t);if(!s)return;const{columnIndex:o,origColspan:a}=s,l=this.hot.getSelectedRangeLast(),u=l.getTopStartCorner(),c=l.getBottomEndCorner(),{from:h}=l;i.column=!0,i.cell=!0;const d=[];t.col<h.col?d.push(c.col,o):t.col>h.col?d.push(u.col,o+a-1):d.push(o,o+a-1),this.hot.selectColumns(...d)}onAfterGetColumnHeaderRenderers(e){e.length=0;for(let t=0;t<on(this,An).getLayersCount();t++)e.push(this.headerRendererFactory(t))}onAfterViewportColumnCalculatorOverride(e){const t=on(this,An).getLayersCount();let r=e.startColumn,i=!!t;for(let s=0;s<t;s++){const o=on(this,An).findLeftMostColumnIndex(s,e.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(i=!1),zr(a)&&a<e.startColumn){r=a;break}}e.startColumn=i?on(this,An).getHeaderTreeNodeData(0,r).columnIndex:r}onModifyColWidth(e,t){const r=this.ghostTable.getWidth(t);return e>r?e:r}onModifyColumnHeaderValue(e,t,r){var i;const{label:s}=(i=on(this,An).getHeaderTreeNodeData(r,t))!==null&&i!==void 0?i:{label:""};return s}onInit(){this.updatePlugin()}onAfterLoadData(e,t){t||this.updatePlugin()}destroy(){Kf(this,An,null),on(this,ko)!==null&&(on(this,ko).unsubscribe(),Kf(this,ko,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return on(this,An).getHeaderTreeNodeData(e.row,e.col)}}class Mne{constructor(e,t){this.hot=t,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},ze(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,r){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&re(e.__children,i=>{this.cacheNode(i,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,r,i){let s=!1,o=t;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),r!=null&&o===r?{result:a,end:!0}:i!=null&&a===i?{result:o,end:!0}:(o+=1,a.__children&&re(a.__children,l=>{if(this.parentReference.set(l,s?null:a),o=this.readTreeNodes(l,o,r,i),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return ft(this.data[0],(t,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(t):r.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(re(r.__children,i=>{t+=1,i.__children&&(t+=this.countChildren(i))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var r;return((r=e.__children)===null||r===void 0?void 0:r[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((t=r.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let r=t;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),r||(r=this.mockNode()),s.__children.push(r),this.rewriteCache();const o=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,t,r){let i=r,s;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,t),e){const a=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(t,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[t]);i=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,i,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),s=this.getRowIndexWithinParent(r);switch(t){case"below":this.addChildAtIndex(i,s+1,null);break;case"above":this.addChildAtIndex(i,s,null);break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(ze(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),ze(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const s=this.getRowIndex(r),o=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,o+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,o+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),t&&this.hot.render()}filterData(e,t,r){const i=[];re(r,s=>{i.push(this.getDataObject(s))}),re(i,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,t,r){const i=this.getDataObject(e-1);let s=null,o=e;i&&i.__children&&i.__children.length===0?(s=i,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?r?s.__children.splice(o,t,...r):s.__children.splice(o,t):r?this.data.splice(o,t,...r):this.data.splice(o,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,r=null;do r=this.getRowParent(r),r!==null&&(t=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,r,i){const s=t===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=o.__children.slice(a,a+1),u=e>t;let c=s?this.getRowParent(t-1):this.getRowParent(t);c==null&&(c=this.getRowParent(t-1)),c==null&&(c=this.getDataObject(t-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(t),c.__children=[]);const h=s||r||i?c.__children.length:this.getRowIndexWithinParent(t),d=o===c;c.__children.splice(h,0,l[0]),o.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(o),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const Nne=Mne;class Ine{constructor(e,t){this.hot=t,this.plugin=e}}const LE=Ine;class lo extends LE{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),s=this.dataManager.getDataObject(r),o=t.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]');if(re(l,u=>{u&&o.removeChild(u)}),Ae(t,lo.CSS_CLASSES.indicatorContainer),i){const{rootDocument:u}=this.hot,c=a.cloneNode(!0);o.innerHTML="",ze(0,i-1,()=>{const h=u.createElement("SPAN");Ae(h,lo.CSS_CLASSES.emptyIndicator),o.appendChild(h)}),o.appendChild(c)}if(this.dataManager.hasChildren(s)){const u=this.hot.rootDocument.createElement("DIV");Ae(t,lo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?Ae(u,`${lo.CSS_CLASSES.button} ${lo.CSS_CLASSES.expandButton}`):Ae(u,`${lo.CSS_CLASSES.button} ${lo.CSS_CLASSES.collapseButton}`),o.appendChild(u)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}const rN=lo;class One extends LE{constructor(e,t){var r;super(e,t),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),re(r.lastCollapsedRows,(a,l)=>{a>=i&&a<s&&(r.lastCollapsedRows[l]=a+o)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,s)=>{ze(i,i+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&re(s.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];re(e,s=>{i.push(...this.collapseChildren(s,!1,!1))}),r&&this.trimRows(i),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return re(e,s=>{i.push(s),t&&this.collapseChildRows(s,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);re(i.__children,s=>{const o=this.dataManager.getRowIndex(s);t.push(o),this.collapseChildRows(o,t)})}r&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return re(e,s=>{i.push(s),t&&this.expandChildRows(s,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);re(i.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);t.push(o),this.expandChildRows(o,t)}})}r&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&re(s.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),t&&this.renderAndAdjust(),a}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];re(e,s=>{i.push(...this.expandChildren(s,!1,!1))}),r&&this.untrimRows(i),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];re(e,r=>{this.dataManager.hasChildren(r)&&t.push(r)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];re(e,r=>{this.dataManager.hasChildren(r)&&t.push(r)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{re(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{re(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&re(t.__children,i=>{const s=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return r=!1,!1}),r}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const r=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const r=this.translateTrimmedRow(t.row);Je(e.target,rN.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Ds(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const _ne=One,PT=new WeakMap;class Lne extends LE{constructor(e,t){super(e,t),PT.set(this,{row_above:(r,i)=>{const s=i[i.length-1];this.dataManager.addSibling(s.start.row,"above")},row_below:(r,i)=>{const s=i[i.length-1];this.dataManager.addSibling(s.start.row,"below")}}),this.dataManager=this.plugin.dataManager}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(MC)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(NC)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return ze(0,e.items.length-1,r=>{if(r===0)return re(t,(i,s)=>{e.items.splice(r+s,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){const t=PT.get(this);return ze(0,e.items.length-1,r=>{const i=t[e.items[r].key];i!=null&&(e.items[r].callback=i)}),e}}const Pne=Lne;class Dne{constructor(e){this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const o=r===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(m=>{if(!l)return!1;const p=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(p,a),p}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(o,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,r,i,i&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:r,dropIndex:i,movePossible:s}=e;let o=!1;return Qt(i)&&(Xt(Vt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,r,i,s,!1),o=!0),o}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let r=this.dataManager.getRowParent(e?t-1:t);return r==null&&(r=this.dataManager.getRowParent(t-1)),r}shiftCollapsibleParentsLocations(e,t,r){r||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,r){const i=t===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,t,this.movedToCollapsed,i)})})}moveCellsMeta(e,t){const r=[],i=Math.max(...e)<t;e.forEach(s=>{r.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(i?r.length:0),0,...r)}selectCells(e,t){const r=e.length;let i=0,s=0,o=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<t?l=this.dataManager.translateTrimmedRow(t-r):l=this.dataManager.translateTrimmedRow(t);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),s=i}else e[r-1]<t?(s=t-1,i=s-r+1):(i=t,s=i+r-1);o=this.hot.selection,a=this.hot.countCols()-1,o.setRangeStart(this.hot._createCellCoords(i,0)),o.setRangeEnd(this.hot._createCellCoords(s,a),!0)}isRowOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}}const T6="nestedRows",kne=300,no=new WeakMap,Fne="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";class Hne extends Lt{static get PLUGIN_KEY(){return T6}static get PLUGIN_PRIORITY(){return kne}constructor(e){super(e),this.dataManager=null,this.headersUI=null,this.collapsedRowsMap=null,no.set(this,{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1})}isEnabled(){return!!this.hot.getSettings()[T6]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Hd),this.dataManager=new Nne(this,this.hot),this.collapsingUI=new _ne(this,this.hot),this.headersUI=new rN(this,this.hot),this.contextMenuUI=new Pne(this,this.hot),this.rowMoveController=new Dne(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("beforeViewRender",function(){return e.onBeforeViewRender(...arguments)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){return e.onFilterData(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeRemoveRow",function(){return e.onBeforeRemoveRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("beforeAddChild",function(){return e.onBeforeAddChild(...arguments)}),this.addHook("afterAddChild",function(){return e.onAfterAddChild(...arguments)}),this.addHook("beforeDetachChild",function(){return e.onBeforeDetachChild(...arguments)}),this.addHook("afterDetachChild",function(){return e.onAfterDetachChild(...arguments)}),this.addHook("modifyRowHeaderWidth",function(){return e.onModifyRowHeaderWidth(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("beforeRowMove",function(){return e.onBeforeRowMove(...arguments)}),this.addHook("beforeLoadData",t=>this.onBeforeLoadData(t)),this.addHook("beforeUpdateData",t=>this.onBeforeLoadData(t)),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}onBeforeRowMove(e,t,r,i){return this.rowMoveController.onBeforeRowMove(e,t,r,i)}disableCoreAPIModifiers(){const e=no.get(this);e.skipCoreAPIModifiers=!0}enableCoreAPIModifiers(){const e=no.get(this);e.skipCoreAPIModifiers=!1}onBeforeOnCellMouseDown(e,t,r){this.collapsingUI.toggleState(e,t,r)}onModifyRowData(e){if(!no.get(this).skipCoreAPIModifiers)return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!no.get(this).skipCoreAPIModifiers)return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,r){return no.get(this).skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,r),!1)}onFilterData(e,t,r){const i=no.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*t),this.dataManager.filterData(e,t,r),i.skipRender=!0,this.dataManager.getData().slice()}onAfterContextMenuDefaultOptions(e){return this.contextMenuUI.appendOptions(e)}onAfterGetRowHeader(e,t){this.headersUI.appendLevelIndicators(e,t)}onModifyRowHeaderWidth(e){return this.headersUI.rowHeaderWidthCache||e}onAfterRemoveRow(e,t,r,i){if(i===this.pluginName)return;const s=no.get(this);setTimeout(()=>{s.skipRender=null,this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()},0)}onBeforeRemoveRow(e,t,r){const i=Array.from(r.reduce((s,o)=>{if(this.dataManager.isParent(o)){const a=this.dataManager.getDataObject(o).__children;return s.add(o),Array.isArray(a)&&a.forEach(l=>s.add(this.dataManager.getRowIndex(l))),s}return s.add(o)},new Set));r.length=0,r.push(...i)}onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterAddChild(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterDetachChild(e,t,r){this.collapsingUI.collapsedRowsStash.shiftStash(r,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onAfterCreateRow(){this.dataManager.rewriteCache()}onAfterInit(){const e=Math.max(...this.dataManager.cache.levels);e>0&&this.headersUI.updateRowHeaderWidth(e)}onBeforeViewRender(e,t){no.get(this).skipRender&&(t.skipRender=!0)}destroy(){super.destroy()}onBeforeLoadData(e){if(!mQ(e)){sv(Fne),this.hot.getSettings()[T6]=!1,this.disablePlugin();return}this.dataManager.setData(e),this.dataManager.rewriteCache()}}class Une{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;this.rootWindow=t,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const r=typeof e>"u"?t:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){re(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const Bne=Une;Ue.getSingleton().register("persistentStateSave");Ue.getSingleton().register("persistentStateLoad");Ue.getSingleton().register("persistentStateReset");const DT="persistentState",Vne=0;class $ne extends Lt{static get PLUGIN_KEY(){return DT}static get PLUGIN_PRIORITY(){return Vne}constructor(e){super(e),this.storage=void 0}isEnabled(){return!!this.hot.getSettings()[DT]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Bne(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}const A6="search",Wne=190,Gne="htSearchResult",zne=function(n,e,t,r,i){n.getCellMeta(e,t).isSearchResult=i},Yne=function(n,e,t){return Qt(n)||n===null||!n.toLocaleLowerCase||n.length===0||Qt(e)||e===null?!1:e.toString().toLocaleLowerCase(t.locale).indexOf(n.toLocaleLowerCase(t.locale))!==-1};class jne extends Lt{static get PLUGIN_KEY(){return A6}static get PLUGIN_PRIORITY(){return Wne}constructor(e){super(e),this.callback=zne,this.queryMethod=Yne,this.searchResultClass=Gne}isEnabled(){return this.hot.getSettings()[A6]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[A6];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){return e.onBeforeRenderer(...arguments)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){return e.onBeforeRenderer(...arguments)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return ze(0,i-1,l=>{ze(0,s-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||t,m=(h.search.queryMethod||r)(e,c,h);if(m){const p={row:l,col:u,data:c};o.push(p)}d&&d(a,l,u,c,m)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){dt(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}onBeforeRenderer(e,t,r,i,s,o){const a=o.className||[];let l=[];typeof a=="string"?l=a.split(" "):l.push(...a),this.isEnabled()&&o.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),o.className=l.join(" ")}destroy(){super.destroy()}}const Kne="touchScroll",qne=200;class Xne extends Lt{static get PLUGIN_KEY(){return Kne}static get PLUGIN_PRIORITY(){return qne}static get SETTING_KEYS(){return!0}constructor(e){super(e),this.scrollbars=[],this.clones=[],this.lockedCollection=!1,this.freezeOverlays=!1}isEnabled(){return e9()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>this.onAfterViewRender()),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>this.onBeforeTouchScroll()),this.addHook("afterMomentumScroll",()=>this.onAfterMomentumScroll())}onAfterViewRender(){if(this.lockedCollection)return;const{topOverlay:e,bottomOverlay:t,inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(r),i&&this.scrollbars.push(i),s&&s.clone&&this.scrollbars.push(s),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),s&&s.clone&&this.clones.push(s.clone.wtTable.holder.parentNode)}onBeforeTouchScroll(){this.freezeOverlays=!0,re(this.clones,e=>{Ae(e,"hide-tween")})}onAfterMomentumScroll(){this.freezeOverlays=!1,re(this.clones,e=>{tt(e,"hide-tween"),Ae(e,"show-tween")}),this.hot._registerTimeout(()=>{re(this.clones,e=>{tt(e,"show-tween")})},400),re(this.scrollbars,e=>{e.refresh(),e.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}const qf="trimRows",Qne=330;class Zne extends Lt{static get PLUGIN_KEY(){return qf}static get PLUGIN_PRIORITY(){return Qne}constructor(e){super(e),this.trimmedRowsMap=null}isEnabled(){return!!this.hot.getSettings()[qf]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Hd),this.trimmedRowsMap.addLocalHook("init",()=>this.onMapInit()),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[qf];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),re(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{re(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",t,i,r,r&&i.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let i=t;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;r&&o&&(re(e,l=>{s[l]=!1}),i=Tr(s,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",t,i,r&&o)!==!1&&(r&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",t,i,r&&o,r&&i.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<t)}onMapInit(){const e=this.hot.getSettings()[qf];Array.isArray(e)&&this.hot.batchExecution(()=>{re(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0)}destroy(){super.destroy()}}const iN="undoRedo",Jne="undoRedo";function ke(n){const e=this;this.instance=n,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,n.addHook("afterChange",function(t,r){const i=t&&t.length;if(!i||!t.find(a=>{const[,,l,u]=a;return l!==u}))return;const o=()=>{const a=t.reduce((u,c)=>(u.push([...c]),u),[]);re(a,u=>{u[1]=n.propToCol(u[1])});const l=i>1?this.getSelected():[[a[0][0],a[0][1]]];return new ke.ChangeAction(a,l)};e.done(o,r)}),n.addHook("afterCreateRow",(t,r,i)=>{e.done(()=>new ke.CreateRowAction(t,r),i)}),n.addHook("beforeRemoveRow",(t,r,i,s)=>{const o=()=>{const a=n.toPhysicalRow(t),l=kr(e.instance.getSourceData(a,0,a+r-1,e.instance.countSourceCols()-1));return new ke.RemoveRowAction(a,l,n.getSettings().fixedRowsBottom,n.getSettings().fixedRowsTop,n.rowIndexMapper.getIndexesSequence())};e.done(o,s)}),n.addHook("afterCreateCol",(t,r,i)=>{e.done(()=>new ke.CreateColumnAction(t,r),i)}),n.addHook("beforeRemoveCol",(t,r,i,s)=>{const o=()=>{const a=e.instance.getSourceDataArray(),l=(e.instance.countCols()+t)%e.instance.countCols(),u=[],c=[],h=[];ze(a.length-1,m=>{const p=[],y=a[m];ze(l,l+(r-1),C=>{p.push(y[n.toPhysicalColumn(C)])}),u.push(p)}),ze(r-1,m=>{h.push(n.toPhysicalColumn(l+m))}),Array.isArray(n.getSettings().colHeaders)&&ze(r-1,m=>{c.push(n.getSettings().colHeaders[n.toPhysicalColumn(l+m)]||null)});const d=n.columnIndexMapper.getIndexesSequence(),f=n.rowIndexMapper.getIndexesSequence();return new ke.RemoveColumnAction(l,h,u,c,d,f,n.getSettings().fixedColumnsStart)};e.done(o,s)}),n.addHook("beforeCellAlignment",(t,r,i,s)=>{e.done(()=>new ke.CellAlignmentAction(t,r,i,s))}),n.addHook("beforeFilter",t=>{e.done(()=>new ke.FiltersAction(t))}),n.addHook("beforeRowMove",(t,r)=>{t!==!1&&e.done(()=>new ke.RowMoveAction(t,r))}),n.addHook("beforeMergeCells",(t,r)=>{r||e.done(()=>new ke.MergeCellsAction(n,t))}),n.addHook("afterUnmergeCells",(t,r)=>{r||e.done(()=>new ke.UnmergeCellsAction(n,t))}),n.addHook("afterInit",()=>{e.init()})}ke.prototype.done=function(n,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const s=n(),o=this.undoneActions.slice();this.doneActions.push(s),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())};ke.prototype.undo=function(){if(this.isUndoAvailable()){const n=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",n);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice());const t=kr(e);if(this.instance.runHooks("beforeUndo",t)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",s),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.instance.runHooks("afterUndo",t)}};ke.prototype.redo=function(){if(this.isRedoAvailable()){const n=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",n);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",n,this.undoneActions.slice());const t=kr(e);if(this.instance.runHooks("beforeRedo",t)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",s),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.instance.runHooks("afterRedo",t)}};ke.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ke.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ke.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ke.prototype.isEnabled=function(){return this.enabled};ke.prototype.enable=function(){if(this.isEnabled())return;const n=this.instance;this.enabled=!0,nre(n),this.registerShortcuts(),n.addHook("afterChange",sN)};ke.prototype.disable=function(){if(!this.isEnabled())return;const n=this.instance;this.enabled=!1,rre(n),this.unregisterShortcuts(),n.removeHook("afterChange",sN)};ke.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ke.Action=function(){};ke.Action.prototype.undo=function(){};ke.Action.prototype.redo=function(){};ke.ChangeAction=function(n,e){this.changes=n,this.selected=e,this.actionType="change"};da(ke.ChangeAction,ke.Action);ke.ChangeAction.prototype.undo=function(n,e){const t=kr(this.changes),r=n.countEmptyRows(!0),i=n.countEmptyCols(!0);for(let s=0,o=t.length;s<o;s++)t[s].splice(3,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.undo");for(let s=0,o=t.length;s<o;s++){const[a,l]=t[s];n.getSettings().minSpareRows&&a+1+n.getSettings().minSpareRows===n.countRows()&&r===n.getSettings().minSpareRows&&(n.alter("remove_row",parseInt(a+1,10),n.getSettings().minSpareRows),n.undoRedo.doneActions.pop()),n.getSettings().minSpareCols&&l+1+n.getSettings().minSpareCols===n.countCols()&&i===n.getSettings().minSpareCols&&(n.alter("remove_col",parseInt(l+1,10),n.getSettings().minSpareCols),n.undoRedo.doneActions.pop())}n.selectCells(this.selected,!1,!1)};ke.ChangeAction.prototype.redo=function(n,e){const t=kr(this.changes);for(let r=0,i=t.length;r<i;r++)t[r].splice(2,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.redo"),this.selected&&n.selectCells(this.selected,!1,!1)};ke.CreateRowAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_row"};da(ke.CreateRowAction,ke.Action);ke.CreateRowAction.prototype.undo=function(n,e){const t=n.countRows(),r=n.getSettings().minSpareRows;this.index>=t&&this.index-r<t&&(this.index-=r),n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ke.CreateRowAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateRow",e),n.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ke.RemoveRowAction=function(n,e,t,r,i){this.index=n,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=t,this.fixedRowsTop=r,this.rowIndexesSequence=i};da(ke.RemoveRowAction,ke.Action);ke.RemoveRowAction.prototype.undo=function(n,e){const t=n.getSettings(),r=[];t.fixedRowsBottom=this.fixedRowsBottom,t.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,s)=>{Object.keys(i).forEach(o=>{const a=parseInt(o,10);r.push([this.index+s,isNaN(a)?o:a,i[o]])})}),n.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),n.addHookOnce("afterViewRender",e),n.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),n.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ke.RemoveRowAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ke.CreateColumnAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_col"};da(ke.CreateColumnAction,ke.Action);ke.CreateColumnAction.prototype.undo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ke.CreateColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateCol",e),n.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ke.RemoveColumnAction=function(n,e,t,r,i,s,o){this.index=n,this.indexes=e,this.data=t,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=s.slice(0),this.actionType="remove_col",this.fixedColumnsStart=o};da(ke.RemoveColumnAction,ke.Action);ke.RemoveColumnAction.prototype.undo=function(n,e){const t=n.getSettings();t.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,h)=>h[this.indexes.indexOf(r[c])],s=this.data.length,o=[];for(let u=0;u<s;u++)o.push(ct(this.data[u],i));const a=ct(this.headers,i),l=[];n.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),re(n.getSourceDataArray(),(u,c)=>{re(r,(h,d)=>{u[h]=o[c][d],l.push([c,h,u[h]])})}),n.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&re(a,(u,c)=>{n.getSettings().colHeaders[r[c]]=u}),n.batchExecution(()=>{n.rowIndexMapper.setIndexesSequence(this.rowPositions),n.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),n.addHookOnce("afterViewRender",e),n.render()};ke.RemoveColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ke.CellAlignmentAction=function(n,e,t,r){this.stateBefore=n,this.range=e,this.type=t,this.alignment=r};ke.CellAlignmentAction.prototype.undo=function(n,e){re(this.range,t=>{t.forAll((r,i)=>{r>=0&&i>=0&&n.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),n.addHookOnce("afterViewRender",e),n.render()};ke.CellAlignmentAction.prototype.redo=function(n,e){Ho(this.range,this.type,this.alignment,(t,r)=>n.getCellMeta(t,r),(t,r,i,s)=>n.setCellMeta(t,r,i,s)),n.addHookOnce("afterViewRender",e),n.render()};ke.FiltersAction=function(n){this.conditionsStack=n,this.actionType="filter"};da(ke.FiltersAction,ke.Action);ke.FiltersAction.prototype.undo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),t.filter()};ke.FiltersAction.prototype.redo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack),t.filter()};class ere extends ke.Action{constructor(e,t){super(),this.cellRange=t;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange)}}ke.MergeCellsAction=ere;class tre extends ke.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange,!0)}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0),e.render()}}ke.UnmergeCellsAction=tre;ke.RowMoveAction=function(n,e){this.rows=n.slice(),this.finalIndex=e,this.actionType="row_move"};da(ke.RowMoveAction,ke.Action);ke.RowMoveAction.prototype.undo=function(n,e){const t=n.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(a=>a>this.finalIndex),s=r.filter(a=>a<=this.finalIndex),o=i.sort((a,l)=>l-a).concat(s.sort((a,l)=>a-l));n.addHookOnce("afterViewRender",e);for(let a=0;a<o.length;a+=1){const l=n.toVisualRow(o[a]);t.moveRow(l,o[a])}n.render(),n.deselectCell(),n.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ke.RowMoveAction.prototype.redo=function(n,e){const t=n.getPlugin("manualRowMove");n.addHookOnce("afterViewRender",e),t.moveRows(this.rows.slice(),this.finalIndex),n.render(),n.deselectCell(),n.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ke.prototype.init=function(){const n=this.instance.getSettings().undo,e=typeof n>"u"||n;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ke.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:iN};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};ke.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(iN)};function sN(n,e){const t=this;if(e==="loadData")return t.undoRedo.clear()}function nre(n){n.undo=function(){return n.undoRedo.undo()},n.redo=function(){return n.undoRedo.redo()},n.isUndoAvailable=function(){return n.undoRedo.isUndoAvailable()},n.isRedoAvailable=function(){return n.undoRedo.isRedoAvailable()},n.clearUndo=function(){return n.undoRedo.clear()}}function rre(n){delete n.undo,delete n.redo,delete n.isUndoAvailable,delete n.isRedoAvailable,delete n.clearUndo}const zd=Ue.getSingleton();zd.add("afterUpdateSettings",function(){var n;(n=this.getPlugin("undoRedo"))===null||n===void 0||n.init()});zd.register("beforeUndo");zd.register("afterUndo");zd.register("beforeRedo");zd.register("afterRedo");ke.PLUGIN_KEY=Jne;ke.SETTING_KEYS=!0;function ire(){Mt(gh),Mt(yK),Mt(yh),Mt(OK),Mt(BK),Mt(k9),Mt(mq),Mt(_q),Mt(l1),Mt(UZ),Mt(nJ),Mt(iJ),Mt(c1),Mt(wJ),Mt(dee),Mt(Vee),Mt(Kee),Mt(tte),Mt(ste),Mt(mte),Mt(gte),Mt(Tte),Mt(xte),Mt(kte),Mt($te),Mt(zte),Mt(xne),Mt(Hne),Mt($ne),Mt(jne),Mt(Xne),Mt(Zne),Mt(ke)}function oN(){NG(),zG(),nz(),Sz(),ire()}vs(qx);vt.editors={BaseEditor:gc};function vt(n,e){const t=new pE(n,e||{},hE);return t.init(),t}vt.Core=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new pE(n,e,hE)};vt.DefaultSettings=lM();vt.hooks=Ue.getSingleton();vt.CellCoords=mp;vt.CellRange=xv;vt.packageName="handsontable";vt.buildDate="31/08/2023 08:23:33";vt.version="13.1.0";vt.languages={dictionaryKeys:RQ,getLanguageDictionary:iM,getLanguagesDictionaries:NQ,registerLanguageDictionary:rM,getTranslatedPhrase:sM};function kT(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function sre(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?kT(Object(t),!0).forEach(function(r){ore(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):kT(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function ed(n){return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ed(n)}function Qu(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function FT(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,lN(r.key),r)}}function Zu(n,e,t){return e&&FT(n.prototype,e),t&&FT(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function ore(n,e,t){return e=lN(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function td(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&iw(n,e)}function xp(n){return xp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xp(n)}function iw(n,e){return iw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},iw(n,e)}function are(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function aN(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function lre(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aN(n)}function nd(n){var e=are();return function(){var r=xp(n),i;if(e){var s=xp(this).constructor;i=Reflect.construct(r,arguments,s)}else i=r.apply(this,arguments);return lre(this,i)}}function ure(n){return cre(n)||hre(n)||dre(n)||fre()}function cre(n){if(Array.isArray(n))return sw(n)}function hre(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function dre(n,e){if(!!n){if(typeof n=="string")return sw(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return sw(n,e)}}function sw(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function fre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mre(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function lN(n){var e=mre(n,"string");return typeof e=="symbol"?e:String(e)}var x6=null,pre="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",gre="The Handsontable instance bound to this component was destroyed and cannot be used properly.",Mp="global",yre="hot-wrapper-editor-container";function wre(){if(typeof console<"u"){var n;(n=console).warn.apply(n,arguments)}}function ow(n,e){var t=we.Children.toArray(n),r=we.Children.count(n),i=null;return r!==0&&(r===1&&t[0].props[e]?i=t[0]:i=t.find(function(s){return s.props[e]!==void 0})),i||null}function uN(n){return n?n.type.WrappedComponent?n.type.WrappedComponent:n.type:null}function cN(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=arguments.length>1?arguments[1]:void 0;if(e===null)return null;var t=dN(e.props,!1);return t.className="".concat(yre," ").concat(t.className),sA.createPortal(we.createElement("div",Object.assign({},t),e),n.body)}function hN(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Mp,r=ow(n,"hot-editor"),i=uN(r);return r?we.cloneElement(r,{emitEditorInstance:function(o,a){e.get(i)||e.set(i,new Map);var l=e.get(i);l.set(a!=null?a:Mp,o)},editorColumnScope:t,isEditor:!0}):null}function vre(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;t||(t=document),x6||(x6=t.createDocumentFragment());var r=t.createElement("DIV");x6.appendChild(r);var i=we.cloneElement(n,sre({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:sA.createPortal(i,r,"".concat(e.row,"-").concat(e.col,"-").concat(Math.random())),portalContainer:r}}function dN(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:n.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:n.className||"",style:n.style||{}}}var fN=function(){function n(){Qu(this,n)}return Zu(n,null,[{key:"getSettings",value:function(t){var r={};if(t.settings){var i=t.settings;for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])}for(var o in t)o!=="settings"&&o!=="children"&&t.hasOwnProperty(o)&&(r[o]=t[o]);return r}}]),n}(),Cre=function(n){td(t,n);var e=nd(t);function t(){return Qu(this,t),e.apply(this,arguments)}return Zu(t,[{key:"getSettingsProps",value:function(){var i=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(s){return!i.internalProps.includes(s)}).reduce(function(s,o){return s[o]=i.props[o],s},{})}},{key:"getLocalEditorElement",value:function(){return hN(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var i=this.props._getChildElementByType(this.props.children,"hot-renderer"),s=this.getLocalEditorElement();this.columnSettings=fN.getSettings(this.getSettingsProps()),i!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(i),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),s!==null&&(this.columnSettings.editor=this.props._getEditorClass(s,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var i=this.props._getOwnerDocument(),s=cN(i,this.getLocalEditorElement());return we.createElement(we.Fragment,null,s)}}]),t}(we.Component),Ere=function(n){td(t,n);var e=nd(t);function t(){var r;return Qu(this,t),r=e.apply(this,arguments),r.state={portals:[]},r}return Zu(t,[{key:"render",value:function(){return we.createElement(we.Fragment,null,this.state.portals)}}]),t}(we.Component),bre="13.1.0";function PE(n,e){return e={exports:{}},n(e,e.exports),e.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ir=typeof Symbol=="function"&&Symbol.for,DE=ir?Symbol.for("react.element"):60103,kE=ir?Symbol.for("react.portal"):60106,m1=ir?Symbol.for("react.fragment"):60107,p1=ir?Symbol.for("react.strict_mode"):60108,g1=ir?Symbol.for("react.profiler"):60114,y1=ir?Symbol.for("react.provider"):60109,w1=ir?Symbol.for("react.context"):60110,FE=ir?Symbol.for("react.async_mode"):60111,v1=ir?Symbol.for("react.concurrent_mode"):60111,C1=ir?Symbol.for("react.forward_ref"):60112,E1=ir?Symbol.for("react.suspense"):60113,Sre=ir?Symbol.for("react.suspense_list"):60120,b1=ir?Symbol.for("react.memo"):60115,S1=ir?Symbol.for("react.lazy"):60116,Rre=ir?Symbol.for("react.block"):60121,Tre=ir?Symbol.for("react.fundamental"):60117,Are=ir?Symbol.for("react.responder"):60118,xre=ir?Symbol.for("react.scope"):60119;function pi(n){if(ed(n)==="object"&&n!==null){var e=n.$$typeof;switch(e){case DE:switch(n=n.type,n){case FE:case v1:case m1:case g1:case p1:case E1:return n;default:switch(n=n&&n.$$typeof,n){case w1:case C1:case S1:case b1:case y1:return n;default:return e}}case kE:return e}}}function mN(n){return pi(n)===v1}var Mre=FE,Nre=v1,Ire=w1,Ore=y1,_re=DE,Lre=C1,Pre=m1,Dre=S1,kre=b1,Fre=kE,Hre=g1,Ure=p1,Bre=E1,Vre=function(e){return mN(e)||pi(e)===FE},$re=mN,Wre=function(e){return pi(e)===w1},Gre=function(e){return pi(e)===y1},zre=function(e){return ed(e)==="object"&&e!==null&&e.$$typeof===DE},Yre=function(e){return pi(e)===C1},jre=function(e){return pi(e)===m1},Kre=function(e){return pi(e)===S1},qre=function(e){return pi(e)===b1},Xre=function(e){return pi(e)===kE},Qre=function(e){return pi(e)===g1},Zre=function(e){return pi(e)===p1},Jre=function(e){return pi(e)===E1},eie=function(e){return typeof e=="string"||typeof e=="function"||e===m1||e===v1||e===g1||e===p1||e===E1||e===Sre||ed(e)==="object"&&e!==null&&(e.$$typeof===S1||e.$$typeof===b1||e.$$typeof===y1||e.$$typeof===w1||e.$$typeof===C1||e.$$typeof===Tre||e.$$typeof===Are||e.$$typeof===xre||e.$$typeof===Rre)},tie=pi,nie={AsyncMode:Mre,ConcurrentMode:Nre,ContextConsumer:Ire,ContextProvider:Ore,Element:_re,ForwardRef:Lre,Fragment:Pre,Lazy:Dre,Memo:kre,Portal:Fre,Profiler:Hre,StrictMode:Ure,Suspense:Bre,isAsyncMode:Vre,isConcurrentMode:$re,isContextConsumer:Wre,isContextProvider:Gre,isElement:zre,isForwardRef:Yre,isFragment:jre,isLazy:Kre,isMemo:qre,isPortal:Xre,isProfiler:Qre,isStrictMode:Zre,isSuspense:Jre,isValidElementType:eie,typeOf:tie},Gt=PE(function(n,e){});Gt.AsyncMode;Gt.ConcurrentMode;Gt.ContextConsumer;Gt.ContextProvider;Gt.Element;Gt.ForwardRef;Gt.Fragment;Gt.Lazy;Gt.Memo;Gt.Portal;Gt.Profiler;Gt.StrictMode;Gt.Suspense;Gt.isAsyncMode;Gt.isConcurrentMode;Gt.isContextConsumer;Gt.isContextProvider;Gt.isElement;Gt.isForwardRef;Gt.isFragment;Gt.isLazy;Gt.isMemo;Gt.isPortal;Gt.isProfiler;Gt.isStrictMode;Gt.isSuspense;Gt.isValidElementType;Gt.typeOf;PE(function(n){n.exports=nie});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var HT=Object.getOwnPropertySymbols,rie=Object.prototype.hasOwnProperty,iie=Object.prototype.propertyIsEnumerable;function sie(n){if(n==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(n)}function oie(){try{if(!Object.assign)return!1;var n=new String("abc");if(n[5]="de",Object.getOwnPropertyNames(n)[0]==="5")return!1;for(var e={},t=0;t<10;t++)e["_"+String.fromCharCode(t)]=t;var r=Object.getOwnPropertyNames(e).map(function(s){return e[s]});if(r.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(s){i[s]=s}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}oie();var aie="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",lie=aie;Function.call.bind(Object.prototype.hasOwnProperty);function pN(){}function gN(){}gN.resetWarningCache=pN;var uie=function(){function e(i,s,o,a,l,u){if(u!==lie){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:gN,resetWarningCache:pN};return r.PropTypes=r,r},cie=PE(function(n){n.exports=uie()}),M6=cie,yN=function(n){td(t,n);var e=nd(t);function t(){var r;return Qu(this,t),r=e.apply(this,arguments),r.id=null,r.__hotInstance=null,r.hotElementRef=null,r.columnSettings=[],r.renderersPortalManager=null,r.portalCacheArray=[],r.renderedCellCache=new Map,r.editorCache=new Map,r.componentRendererColumns=new Map,r}return Zu(t,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(gre),null)},set:function(i){this.__hotInstance=i}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(i){this.hotElementRef=i}},{key:"getRendererWrapper",value:function(i){var s=this;return function(o,a,l,u,c,h,d){var f=s.getRenderedCellCache();if(f.has("".concat(l,"-").concat(u))&&(a.innerHTML=f.get("".concat(l,"-").concat(u)).innerHTML),a&&!a.getAttribute("ghost-table")){for(var m=vre(i,{TD:a,row:l,col:u,prop:c,value:h,cellProperties:d,isRenderer:!0},a.ownerDocument),p=m.portal,y=m.portalContainer;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(y),s.portalCacheArray.push(p)}return f.set("".concat(l,"-").concat(u),a),a}}},{key:"getEditorClass",value:function(i){var s,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mp,a=uN(i),l=(s=this.getEditorCache().get(a))===null||s===void 0?void 0:s.get(o);return this.makeEditorClass(l)}},{key:"makeEditorClass",value:function(i){var s=function(o){td(l,o);var a=nd(l);function l(u){var c;return Qu(this,l),c=a.call(this,u),i.hotCustomEditorInstance=aN(c),c.editorComponent=i,c}return Zu(l,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),l}(vt.editors.BaseEditor);return Object.getOwnPropertyNames(vt.editors.BaseEditor.prototype).forEach(function(o){o!=="constructor"&&(s.prototype[o]=function(){for(var a,l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];return(a=i[o]).call.apply(a,[i].concat(u))})}),s}},{key:"getGlobalRendererElement",value:function(){return ow(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return hN(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var i=fN.getSettings(this.props),s=this.getGlobalRendererElement(),o=this.getGlobalEditorElement();return i.columns=this.columnSettings.length?this.columnSettings:i.columns,o?i.editor=this.getEditorClass(o,Mp):i.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),s?(i.renderer=this.getRendererWrapper(s),this.componentRendererColumns.set("global",!0)):i.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),i}},{key:"displayAutoSizeWarning",value:function(i){var s,o;this.hotInstance&&((s=this.hotInstance.getPlugin("autoRowSize"))!==null&&s!==void 0&&s.enabled||(o=this.hotInstance.getPlugin("autoColumnSize"))!==null&&o!==void 0&&o.enabled)&&this.componentRendererColumns.size>0&&wre(pre)}},{key:"setHotColumnSettings",value:function(i,s){this.columnSettings[s]=i}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var i=this;this.renderersPortalManager.setState({portals:ure(this.portalCacheArray)},function(){i.portalCacheArray=[]})}},{key:"updateHot",value:function(i){this.hotInstance&&this.hotInstance.updateSettings(i,!1)}},{key:"setRenderersPortalManagerRef",value:function(i){this.renderersPortalManager=i}},{key:"componentDidMount",value:function(){var i=this,s=this.createNewGlobalSettings();this.hotInstance=new vt.Core(this.hotElementRef,s),this.hotInstance.addHook("beforeViewRender",function(){return i.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return i.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(s)}},{key:"componentDidUpdate",value:function(){this.clearCache();var i=this.createNewGlobalSettings();this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var i=this,s=dN(this.props),o=function(h){return h.type===Cre},a=we.Children.toArray(this.props.children),l=a.filter(function(c){return o(c)}).map(function(c,h){return we.cloneElement(c,{_componentRendererColumns:i.componentRendererColumns,_emitColumnSettings:i.setHotColumnSettings.bind(i),_columnIndex:h,_getChildElementByType:ow.bind(i),_getRendererWrapper:i.getRendererWrapper.bind(i),_getEditorClass:i.getEditorClass.bind(i),_getOwnerDocument:i.getOwnerDocument.bind(i),_getEditorCache:i.getEditorCache.bind(i),children:c.props.children})}),u=cN(this.getOwnerDocument(),this.getGlobalEditorElement());return we.createElement(we.Fragment,null,we.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},s),l),we.createElement(Ere,{ref:this.setRenderersPortalManagerRef.bind(this)}),u)}}],[{key:"version",get:function(){return bre}}]),t}(we.Component);yN.propTypes={style:M6.object,id:M6.string,className:M6.string};we.Component;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var bn;(function(n){n.RELATIVE="RELATIVE",n.ABSOLUTE="ABSOLUTE"})(bn||(bn={}));class _r{constructor(e,t,r){this.type=e,this.col=t,this.sheet=r}static absolute(e,t){return new _r(bn.ABSOLUTE,e,t)}static relative(e,t){return new _r(bn.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleColumnAddress(e).col-r.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===bn.ABSOLUTE}isColumnRelative(){return this.type===bn.RELATIVE}isAbsolute(){return this.type===bn.ABSOLUTE&&this.sheet!==void 0}moved(e,t,r){const i=this.sheet===void 0?void 0:e;return new _r(this.type,this.col+t,i)}shiftedByColumns(e){return new _r(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const t=ns(this,e);let r=this.col;return this.isColumnRelative()&&(r=e.col+this.col),zI(t,r)}shiftRelativeDimensions(e,t){const r=this.isColumnRelative()?this.col+e:this.col;return new _r(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnAbsolute()?this.col+e:this.col;return new _r(this.type,r,this.sheet)}withSheet(e){return new _r(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case bn.RELATIVE:return`${t}#COLR${this.col}`;case bn.ABSOLUTE:return`${t}#COLA${this.col}`}}unparse(e){const t=this.toSimpleColumnAddress(e);if(Wae(t))return;const r=T1(t.col);return`${this.type===bn.ABSOLUTE?"$":""}${r}`}exceedsSheetSizeLimits(e){return this.col>=e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Er{constructor(e,t,r){this.type=e,this.row=t,this.sheet=r}static absolute(e,t){return new Er(bn.ABSOLUTE,e,t)}static relative(e,t){return new Er(bn.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleRowAddress(e).row-r.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===bn.ABSOLUTE}isRowRelative(){return this.type===bn.RELATIVE}isAbsolute(){return this.type===bn.ABSOLUTE&&this.sheet!==void 0}moved(e,t,r){const i=this.sheet===void 0?void 0:e;return new Er(this.type,this.row+r,i)}shiftedByRows(e){return new Er(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const t=ns(this,e);let r=this.row;return this.isRowRelative()&&(r=e.row+this.row),GI(t,r)}shiftRelativeDimensions(e,t){const r=this.isRowRelative()?this.row+t:this.row;return new Er(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isRowAbsolute()?this.row+t:this.row;return new Er(this.type,r,this.sheet)}withSheet(e){return new Er(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case bn.RELATIVE:return`${t}#ROWR${this.row}`;case bn.ABSOLUTE:return`${t}#ROWA${this.row}`}}unparse(e){const t=this.toSimpleRowAddress(e);return $ae(t)?void 0:`${this.type===bn.ABSOLUTE?"$":""}${t.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var kt;(function(n){n.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",n.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",n.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",n.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"})(kt||(kt={}));class Ut{constructor(e,t,r,i){this.col=e,this.row=t,this.type=r,this.sheet=i}static fromColAndRow(e,t,r){return(e.isColumnAbsolute()&&t.isRowAbsolute()?Ut.absolute.bind(this):e.isColumnAbsolute()?Ut.absoluteCol.bind(this):t.isRowAbsolute()?Ut.absoluteRow.bind(this):Ut.relative.bind(this))(e.col,t.row,r)}static relative(e,t,r){return new Ut(e,t,kt.CELL_REFERENCE_RELATIVE,r)}static absolute(e,t,r){return new Ut(e,t,kt.CELL_REFERENCE_ABSOLUTE,r)}static absoluteCol(e,t,r){return new Ut(e,t,kt.CELL_REFERENCE_ABSOLUTE_COL,r)}static absoluteRow(e,t,r){return new Ut(e,t,kt.CELL_REFERENCE_ABSOLUTE_ROW,r)}toSimpleCellAddress(e){const t=ns(this,e);return this.type===kt.CELL_REFERENCE_ABSOLUTE?Pe(t,this.col,this.row):this.type===kt.CELL_REFERENCE_ABSOLUTE_ROW?Pe(t,e.col+this.col,this.row):this.type===kt.CELL_REFERENCE_ABSOLUTE_COL?Pe(t,this.col,e.row+this.row):Pe(t,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?bn.RELATIVE:bn.ABSOLUTE;return new _r(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?bn.RELATIVE:bn.ABSOLUTE;return new Er(e,this.row,this.sheet)}toSimpleColumnAddress(e){const t=ns(this,e);let r=this.col;return this.isColumnRelative()&&(r+=e.col),zI(t,r)}toSimpleRowAddress(e){const t=ns(this,e);let r=this.row;return this.isRowRelative()&&(r+=e.row),GI(t,r)}isRowAbsolute(){return this.type===kt.CELL_REFERENCE_ABSOLUTE||this.type===kt.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===kt.CELL_REFERENCE_ABSOLUTE||this.type===kt.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===kt.CELL_REFERENCE_RELATIVE||this.type===kt.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===kt.CELL_REFERENCE_RELATIVE||this.type===kt.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===kt.CELL_REFERENCE_ABSOLUTE&&this.sheet!==void 0}shiftedByRows(e){return new Ut(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new Ut(this.col+e,this.row,this.type,this.sheet)}moved(e,t,r){const i=this.sheet===void 0?void 0:e;return new Ut(this.col+t,this.row+r,this.type,i)}withSheet(e){return new Ut(this.col,this.row,this.type,e)}isInvalid(e){return qr(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){const r=this.isColumnAbsolute()?this.col:this.col+e,i=this.isRowAbsolute()?this.row:this.row+t;return new Ut(r,i,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnRelative()?this.col:this.col+e,i=this.isRowRelative()?this.row:this.row+t;return new Ut(r,i,this.type,this.sheet)}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case kt.CELL_REFERENCE_RELATIVE:return`${t}#${this.row}R${this.col}`;case kt.CELL_REFERENCE_ABSOLUTE:return`${t}#${this.row}A${this.col}`;case kt.CELL_REFERENCE_ABSOLUTE_COL:return`${t}#${this.row}AC${this.col}`;case kt.CELL_REFERENCE_ABSOLUTE_ROW:return`${t}#${this.row}AR${this.col}`}}unparse(e){const t=this.toSimpleCellAddress(e);if(qr(t))return;const r=T1(t.col),i=this.type===kt.CELL_REFERENCE_ABSOLUTE||this.type===kt.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===kt.CELL_REFERENCE_ABSOLUTE||this.type===kt.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${r}${i}${t.row+1}`}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Yd=":",Lr="$",hie="\\s+",die="[ \\t\\n\\r]+",R1="A-Za-z\xC0-\u02AF",HE=`${R1}0-9_.`,wN=`[${R1}0-9_]+`,fie="'(((?!').|'')*)'",Ec=`(${wN}|${fie})!`,vN=`(${Ec})?\\${Lr}?[A-Za-z]+\\${Lr}?[0-9]+`,UT=`(${Ec})?\\${Lr}?[A-Za-z]+`,BT=`(${Ec})?\\${Lr}?[0-9]+`,CN="[rR][0-9]*[cC][0-9]*",mie=`(${vN})[^${HE}]`,EN=`[${R1}_][${HE}]*`,pie=["0","1","2","3","4","5","6","7","8","9"],bN=[...Array.from(Array(26)).map((n,e)=>e+"A".charCodeAt(0)),...Array.from(Array(26)).map((n,e)=>e+"a".charCodeAt(0)),...Array.from(Array(687-192+1)).map((n,e)=>e+192)].map(n=>String.fromCharCode(n));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const SN=new RegExp(`^(${Ec})?(\\${Lr}?)([A-Za-z]+)(\\${Lr}?)([0-9]+)$`),gie=new RegExp(`^(${Ec})?(\\${Lr}?)([A-Za-z]+)$`),yie=new RegExp(`^(${Ec})?(\\${Lr}?)([0-9]+)$`),wie=new RegExp(`^${wN}$`),gu=(n,e,t)=>{const r=SN.exec(e),i=UE(r[6]);let s=A1(r,n);if(s===void 0)return;s===null&&(s=void 0);const o=Number(r[8])-1;return r[5]===Lr&&r[7]===Lr?Ut.absolute(i,o,s):r[5]===Lr?Ut.absoluteCol(i,o-t.row,s):r[7]===Lr?Ut.absoluteRow(i-t.col,o,s):Ut.relative(i-t.col,o-t.row,s)},Np=(n,e,t)=>{const r=gie.exec(e);let i=A1(r,n);if(i===void 0)return;i===null&&(i=void 0);const s=UE(r[6]);return r[5]===Lr?_r.absolute(s,i):_r.relative(s-t.col,i)},Ip=(n,e,t)=>{const r=yie.exec(e);let i=A1(r,n);if(i===void 0)return;i===null&&(i=void 0);const s=Number(r[6])-1;return r[5]===Lr?Er.absolute(s,i):Er.relative(s-t.row,i)},aw=(n,e,t)=>{const r=SN.exec(e),i=UE(r[6]);let s=A1(r,n);if(s===void 0)return;s===null&&(s=t);const o=Number(r[8])-1;return Pe(s,i,o)},vie=(n,e,t)=>{const r=e.split(Yd);if(r.length!==2)return;const[i,s]=r,o=aw(n,i,t);if(o===void 0)return;const a=aw(n,s,o.sheet);if(a!==void 0&&o.sheet===a.sheet)return Sw(o,a)},Op=(n,e,t)=>{const r=T1(e.col),i=RN(e.sheet,n);if(i!==void 0)return t!==e.sheet?`${i}!${r}${e.row+1}`:`${r}${e.row+1}`},Cie=(n,e,t)=>{const r=Op(n,e.start,t),i=Op(n,e.end,e.start.sheet);if(!(r===void 0||i===void 0))return`${r}${Yd}${i}`};function UE(n){return n.length===1?n.toUpperCase().charCodeAt(0)-65:n.split("").reduce((e,t)=>e*26+(t.toUpperCase().charCodeAt(0)-64),0)-1}function T1(n){let e="";for(;n>=0;)e=String.fromCharCode(n%26+97)+e,n=Math.floor(n/26)-1;return e.toUpperCase()}function RN(n,e){let t=e(n);if(t!==void 0)return wie.test(t)?t:(t=t.replace(/'/g,"''"),`'${t}'`)}function A1(n,e){var t;let r=(t=n[3])!==null&&t!==void 0?t:n[2];return r?(r=r.replace(/''/g,"'"),e(r)):null}function $t(n){return n&&n.length===0}function Ao(n){return n==null?[]:Object.keys(n)}function Sr(n){for(var e=[],t=Object.keys(n),r=0;r<t.length;r++)e.push(n[t[r]]);return e}function Eie(n,e){for(var t=[],r=Ao(n),i=0;i<r.length;i++){var s=r[i];t.push(e.call(null,n[s],s))}return t}function Fe(n,e){for(var t=[],r=0;r<n.length;r++)t.push(e.call(null,n[r],r));return t}function Jr(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];Array.isArray(r)?e=e.concat(Jr(r)):e.push(r)}return e}function Li(n){return $t(n)?void 0:n[0]}function TN(n){var e=n&&n.length;return e?n[e-1]:void 0}function qe(n,e){if(Array.isArray(n))for(var t=0;t<n.length;t++)e.call(null,n[t],t);else if(VE(n))for(var r=Ao(n),t=0;t<r.length;t++){var i=r[t],s=n[i];e.call(null,s,i)}else throw Error("non exhaustive match")}function Fs(n){return typeof n=="string"}function Pi(n){return n===void 0}function ma(n){return n instanceof Function}function cr(n,e){return e===void 0&&(e=1),n.slice(e,n.length)}function rd(n,e){return e===void 0&&(e=1),n.slice(0,n.length-e)}function os(n,e){var t=[];if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];e.call(null,i)&&t.push(i)}return t}function hl(n,e){return os(n,function(t){return!e(t)})}function Ui(n,e){for(var t=Object.keys(n),r={},i=0;i<t.length;i++){var s=t[i],o=n[s];e(o)&&(r[s]=o)}return r}function Ke(n,e){return VE(n)?n.hasOwnProperty(e):!1}function jn(n,e){return Ju(n,function(t){return t===e})!==void 0}function ei(n){for(var e=[],t=0;t<n.length;t++)e.push(n[t]);return e}function jd(n){var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e}function Ju(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(e.call(null,r))return r}}function bie(n,e){for(var t=[],r=0;r<n.length;r++){var i=n[r];e.call(null,i)&&t.push(i)}return t}function pr(n,e,t){for(var r=Array.isArray(n),i=r?n:Sr(n),s=r?[]:Ao(n),o=t,a=0;a<i.length;a++)o=e.call(null,o,i[a],r?a:s[a]);return o}function Kd(n){return hl(n,function(e){return e==null})}function BE(n,e){e===void 0&&(e=function(r){return r});var t=[];return pr(n,function(r,i){var s=e(i);return jn(t,s)?r:(t.push(s),r.concat(i))},[])}function Ji(n){return Array.isArray(n)}function bo(n){return n instanceof RegExp}function VE(n){return n instanceof Object}function Ii(n,e){for(var t=0;t<n.length;t++)if(!e(n[t],t))return!1;return!0}function x1(n,e){return hl(n,function(t){return jn(e,t)})}function AN(n,e){for(var t=0;t<n.length;t++)if(e(n[t]))return!0;return!1}function Sie(n,e){for(var t=0;t<n.length;t++)if(n[t]===e)return t;return-1}function as(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r++)for(var i=e[r],s=Ao(i),o=0;o<s.length;o++){var a=s[o];n[a]=i[a]}return n}function Rie(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r++){var i=e[r];if(!Pi(i))for(var s=Ao(i),o=0;o<s.length;o++){var a=s[o];Ke(n,a)||(n[a]=i[a])}}return n}function M1(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return Rie.apply(null,[{}].concat(n))}function xN(n,e){var t={};return qe(n,function(r){var i=e(r),s=t[i];s?s.push(r):t[i]=[r]}),t}function VT(n,e){for(var t=jd(n),r=Ao(e),i=0;i<r.length;i++){var s=r[i],o=e[s];t[s]=o}return t}function qn(){}function $T(n){return n}function Tie(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];e.push(r!==void 0?r:void 0)}return e}function lw(n){console&&console.error&&console.error("Error: "+n)}function $E(n){console&&console.warn&&console.warn("Warning: "+n)}function WT(){return typeof Map=="function"}function Aie(n,e){e.forEach(function(t){var r=t.prototype;Object.getOwnPropertyNames(r).forEach(function(i){if(i!=="constructor"){var s=Object.getOwnPropertyDescriptor(r,i);s&&(s.get||s.set)?Object.defineProperty(n.prototype,i,s):n.prototype[i]=t.prototype[i]}})})}function MN(n){function e(){}e.prototype=n;var t=new e;function r(){return typeof t.bar}return r(),r(),n}function _p(n){return n[n.length-1]}function NN(n){var e=new Date().getTime(),t=n(),r=new Date().getTime(),i=r-e;return{time:i,value:t}}var bc={exports:{}};(function(n){(function(e,t){n.exports?n.exports=t():e.regexpToAst=t()})(typeof self<"u"?self:Go,function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(p){this.idx=p.idx,this.input=p.input,this.groupIdx=p.groupIdx},e.prototype.pattern=function(p){this.idx=0,this.input=p,this.groupIdx=0,this.consumeChar("/");var y=this.disjunction();this.consumeChar("/");for(var C={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":a(C,"global");break;case"i":a(C,"ignoreCase");break;case"m":a(C,"multiLine");break;case"u":a(C,"unicode");break;case"y":a(C,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:C,value:y}},e.prototype.disjunction=function(){var p=[];for(p.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),p.push(this.alternative());return{type:"Disjunction",value:p}},e.prototype.alternative=function(){for(var p=[];this.isTerm();)p.push(this.term());return{type:"Alternative",value:p}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var p;switch(this.popChar()){case"=":p="Lookahead";break;case"!":p="NegativeLookahead";break}l(p);var y=this.disjunction();return this.consumeChar(")"),{type:p,value:y}}u()},e.prototype.quantifier=function(p){var y;switch(this.popChar()){case"*":y={atLeast:0,atMost:1/0};break;case"+":y={atLeast:1,atMost:1/0};break;case"?":y={atLeast:0,atMost:1};break;case"{":var C=this.integerIncludingZero();switch(this.popChar()){case"}":y={atLeast:C,atMost:C};break;case",":var b;this.isDigit()?(b=this.integerIncludingZero(),y={atLeast:C,atMost:b}):y={atLeast:C,atMost:1/0},this.consumeChar("}");break}if(p===!0&&y===void 0)return;l(y);break}if(!(p===!0&&y===void 0))return l(y),this.peekChar(0)==="?"?(this.consumeChar("?"),y.greedy=!1):y.greedy=!0,y.type="Quantifier",y},e.prototype.atom=function(){var p;switch(this.peekChar()){case".":p=this.dotAll();break;case"\\":p=this.atomEscape();break;case"[":p=this.characterClass();break;case"(":p=this.group();break}return p===void 0&&this.isPatternCharacter()&&(p=this.patternCharacter()),l(p),this.isQuantifier()&&(p.quantifier=this.quantifier()),p},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[s(`
`),s("\r"),s("\u2028"),s("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var p=this.positiveInteger();return{type:"GroupBackReference",value:p}},e.prototype.characterClassEscape=function(){var p,y=!1;switch(this.popChar()){case"d":p=h;break;case"D":p=h,y=!0;break;case"s":p=f;break;case"S":p=f,y=!0;break;case"w":p=d;break;case"W":p=d,y=!0;break}return l(p),{type:"Set",value:p,complement:y}},e.prototype.controlEscapeAtom=function(){var p;switch(this.popChar()){case"f":p=s("\f");break;case"n":p=s(`
`);break;case"r":p=s("\r");break;case"t":p=s("	");break;case"v":p=s("\v");break}return l(p),{type:"Character",value:p}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var p=this.popChar();if(/[a-zA-Z]/.test(p)===!1)throw Error("Invalid ");var y=p.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:y}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:s("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var p=this.popChar();return{type:"Character",value:s(p)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var p=this.popChar();return{type:"Character",value:s(p)}}},e.prototype.characterClass=function(){var p=[],y=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),y=!0);this.isClassAtom();){var C=this.classAtom(),b=C.type==="Character";if(b&&this.isRangeDash()){this.consumeChar("-");var v=this.classAtom(),S=v.type==="Character";if(S){if(v.value<C.value)throw Error("Range out of order in character class");p.push({from:C.value,to:v.value})}else o(C.value,p),p.push(s("-")),o(v.value,p)}else o(C.value,p)}return this.consumeChar("]"),{type:"Set",complement:y,value:p}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:s("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var p=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),p=!1;break;default:this.groupIdx++;break}var y=this.disjunction();this.consumeChar(")");var C={type:"Group",capturing:p,value:y};return p&&(C.idx=this.groupIdx),C},e.prototype.positiveInteger=function(){var p=this.popChar();if(i.test(p)===!1)throw Error("Expecting a positive integer");for(;r.test(this.peekChar(0));)p+=this.popChar();return parseInt(p,10)},e.prototype.integerIncludingZero=function(){var p=this.popChar();if(r.test(p)===!1)throw Error("Expecting an integer");for(;r.test(this.peekChar(0));)p+=this.popChar();return parseInt(p,10)},e.prototype.patternCharacter=function(){var p=this.popChar();switch(p){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:s(p)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},e.prototype.isDigit=function(){return r.test(this.peekChar(0))},e.prototype.isClassAtom=function(p){switch(p===void 0&&(p=0),this.peekChar(p)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},e.prototype.isQuantifier=function(){var p=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(p)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(p){for(var y="",C=0;C<p;C++){var b=this.popChar();if(t.test(b)===!1)throw Error("Expecting a HexDecimal digits");y+=b}var v=parseInt(y,16);return{type:"Character",value:v}},e.prototype.peekChar=function(p){return p===void 0&&(p=0),this.input[this.idx+p]},e.prototype.popChar=function(){var p=this.peekChar(0);return this.consumeChar(),p},e.prototype.consumeChar=function(p){if(p!==void 0&&this.input[this.idx]!==p)throw Error("Expected: '"+p+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t=/[0-9a-fA-F]/,r=/[0-9]/,i=/[1-9]/;function s(p){return p.charCodeAt(0)}function o(p,y){p.length!==void 0?p.forEach(function(C){y.push(C)}):y.push(p)}function a(p,y){if(p[y]===!0)throw"duplicate flag "+y;p[y]=!0}function l(p){if(p===void 0)throw Error("Internal Error - Should never get here!")}function u(){throw Error("Internal Error - Should never get here!")}var c,h=[];for(c=s("0");c<=s("9");c++)h.push(c);var d=[s("_")].concat(h);for(c=s("a");c<=s("z");c++)d.push(c);for(c=s("A");c<=s("Z");c++)d.push(c);var f=[s(" "),s("\f"),s(`
`),s("\r"),s("	"),s("\v"),s("	"),s("\xA0"),s("\u1680"),s("\u2000"),s("\u2001"),s("\u2002"),s("\u2003"),s("\u2004"),s("\u2005"),s("\u2006"),s("\u2007"),s("\u2008"),s("\u2009"),s("\u200A"),s("\u2028"),s("\u2029"),s("\u202F"),s("\u205F"),s("\u3000"),s("\uFEFF")];function m(){}return m.prototype.visitChildren=function(p){for(var y in p){var C=p[y];p.hasOwnProperty(y)&&(C.type!==void 0?this.visit(C):Array.isArray(C)&&C.forEach(function(b){this.visit(b)},this))}},m.prototype.visit=function(p){switch(p.type){case"Pattern":this.visitPattern(p);break;case"Flags":this.visitFlags(p);break;case"Disjunction":this.visitDisjunction(p);break;case"Alternative":this.visitAlternative(p);break;case"StartAnchor":this.visitStartAnchor(p);break;case"EndAnchor":this.visitEndAnchor(p);break;case"WordBoundary":this.visitWordBoundary(p);break;case"NonWordBoundary":this.visitNonWordBoundary(p);break;case"Lookahead":this.visitLookahead(p);break;case"NegativeLookahead":this.visitNegativeLookahead(p);break;case"Character":this.visitCharacter(p);break;case"Set":this.visitSet(p);break;case"Group":this.visitGroup(p);break;case"GroupBackReference":this.visitGroupBackReference(p);break;case"Quantifier":this.visitQuantifier(p);break}this.visitChildren(p)},m.prototype.visitPattern=function(p){},m.prototype.visitFlags=function(p){},m.prototype.visitDisjunction=function(p){},m.prototype.visitAlternative=function(p){},m.prototype.visitStartAnchor=function(p){},m.prototype.visitEndAnchor=function(p){},m.prototype.visitWordBoundary=function(p){},m.prototype.visitNonWordBoundary=function(p){},m.prototype.visitLookahead=function(p){},m.prototype.visitNegativeLookahead=function(p){},m.prototype.visitCharacter=function(p){},m.prototype.visitSet=function(p){},m.prototype.visitGroup=function(p){},m.prototype.visitGroupBackReference=function(p){},m.prototype.visitQuantifier=function(p){},{RegExpParser:e,BaseRegExpVisitor:m,VERSION:"0.4.0"}})})(bc);var Fm={},xie=new bc.exports.RegExpParser;function N1(n){var e=n.toString();if(Fm.hasOwnProperty(e))return Fm[e];var t=xie.pattern(e);return Fm[e]=t,t}function Mie(){Fm={}}var Nie=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),IN="Complement Sets are not supported for first char optimization",Lp=`Unable to use "first char" lexer optimizations:
`;function Iie(n,e){e===void 0&&(e=!1);try{var t=N1(n),r=uw(t.value,{},t.flags.ignoreCase);return r}catch(s){if(s.message===IN)e&&$E(""+Lp+("	Unable to optimize: < "+n.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var i="";e&&(i=`
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),lw(Lp+`
`+("	Failed parsing: < "+n.toString()+` >
`)+("	Using the regexp-to-ast library version: "+bc.exports.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+i)}}return[]}function uw(n,e,t){switch(n.type){case"Disjunction":for(var r=0;r<n.value.length;r++)uw(n.value[r],e,t);break;case"Alternative":for(var i=n.value,r=0;r<i.length;r++){var s=i[r];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var o=s;switch(o.type){case"Character":Xf(o.value,e,t);break;case"Set":if(o.complement===!0)throw Error(IN);qe(o.value,function(u){if(typeof u=="number")Xf(u,e,t);else{var c=u;if(t===!0)for(var h=c.from;h<=c.to;h++)Xf(h,e,t);else{for(var h=c.from;h<=c.to&&h<oh;h++)Xf(h,e,t);if(c.to>=oh)for(var d=c.from>=oh?c.from:oh,f=c.to,m=aa(d),p=aa(f),y=m;y<=p;y++)e[y]=y}}});break;case"Group":uw(o.value,e,t);break;default:throw Error("Non Exhaustive Match")}var a=o.quantifier!==void 0&&o.quantifier.atLeast===0;if(o.type==="Group"&&cw(o)===!1||o.type!=="Group"&&a===!1)break}break;default:throw Error("non exhaustive match!")}return Sr(e)}function Xf(n,e,t){var r=aa(n);e[r]=r,t===!0&&Oie(n,e)}function Oie(n,e){var t=String.fromCharCode(n),r=t.toUpperCase();if(r!==t){var i=aa(r.charCodeAt(0));e[i]=i}else{var s=t.toLowerCase();if(s!==t){var i=aa(s.charCodeAt(0));e[i]=i}}}function GT(n,e){return Ju(n.value,function(t){if(typeof t=="number")return jn(e,t);var r=t;return Ju(e,function(i){return r.from<=i&&i<=r.to})!==void 0})}function cw(n){return n.quantifier&&n.quantifier.atLeast===0?!0:n.value?Ji(n.value)?Ii(n.value,cw):cw(n.value):!1}var _ie=function(n){Nie(e,n);function e(t){var r=n.call(this)||this;return r.targetCharCodes=t,r.found=!1,r}return e.prototype.visitChildren=function(t){if(this.found!==!0){switch(t.type){case"Lookahead":this.visitLookahead(t);return;case"NegativeLookahead":this.visitNegativeLookahead(t);return}n.prototype.visitChildren.call(this,t)}},e.prototype.visitCharacter=function(t){jn(this.targetCharCodes,t.value)&&(this.found=!0)},e.prototype.visitSet=function(t){t.complement?GT(t,this.targetCharCodes)===void 0&&(this.found=!0):GT(t,this.targetCharCodes)!==void 0&&(this.found=!0)},e}(bc.exports.BaseRegExpVisitor);function WE(n,e){if(e instanceof RegExp){var t=N1(e),r=new _ie(n);return r.visit(t),r.found}else return Ju(e,function(i){return jn(n,i.charCodeAt(0))})!==void 0}var ON=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Hs="PATTERN",Ka="defaultMode",Qf="modes",_N=typeof new RegExp("(?:)").sticky=="boolean";function Lie(n,e){e=M1(e,{useSticky:_N,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(b,v){return v()}});var t=e.tracer;t("initCharCodeToOptimizedIndexMap",function(){nse()});var r;t("Reject Lexer.NA",function(){r=hl(n,function(b){return b[Hs]===Zr.NA})});var i=!1,s;t("Transform Patterns",function(){i=!1,s=Fe(r,function(b){var v=b[Hs];if(bo(v)){var S=v.source;return S.length===1&&S!=="^"&&S!=="$"&&S!=="."?S:S.length===2&&S[0]==="\\"&&!jn(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],S[1])?S[1]:e.useSticky?YT(v):zT(v)}else{if(ma(v))return i=!0,{exec:v};if(Ke(v,"exec"))return i=!0,v;if(typeof v=="string"){if(v.length===1)return v;var L=v.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),_=new RegExp(L);return e.useSticky?YT(_):zT(_)}else throw Error("non exhaustive match")}})});var o,a,l,u,c;t("misc mapping",function(){o=Fe(r,function(b){return b.tokenTypeIdx}),a=Fe(r,function(b){var v=b.GROUP;if(v!==Zr.SKIPPED){if(Fs(v))return v;if(Pi(v))return!1;throw Error("non exhaustive match")}}),l=Fe(r,function(b){var v=b.LONGER_ALT;if(v){var S=Sie(r,v);return S}}),u=Fe(r,function(b){return b.PUSH_MODE}),c=Fe(r,function(b){return Ke(b,"POP_MODE")})});var h;t("Line Terminator Handling",function(){var b=DN(e.lineTerminatorCharacters);h=Fe(r,function(v){return!1}),e.positionTracking!=="onlyOffset"&&(h=Fe(r,function(v){if(Ke(v,"LINE_BREAKS"))return v.LINE_BREAKS;if(PN(v,b)===!1)return WE(b,v.PATTERN)}))});var d,f,m,p;t("Misc Mapping #2",function(){d=Fe(r,LN),f=Fe(s,Jie),m=pr(r,function(b,v){var S=v.GROUP;return Fs(S)&&S!==Zr.SKIPPED&&(b[S]=[]),b},{}),p=Fe(s,function(b,v){return{pattern:s[v],longerAlt:l[v],canLineTerminator:h[v],isCustom:d[v],short:f[v],group:a[v],push:u[v],pop:c[v],tokenTypeIdx:o[v],tokenType:r[v]}})});var y=!0,C=[];return e.safeMode||t("First Char Optimization",function(){C=pr(r,function(b,v,S){if(typeof v.PATTERN=="string"){var L=v.PATTERN.charCodeAt(0),_=aa(L);N6(b,_,p[S])}else if(Ji(v.START_CHARS_HINT)){var P;qe(v.START_CHARS_HINT,function(I){var R=typeof I=="string"?I.charCodeAt(0):I,N=aa(R);P!==N&&(P=N,N6(b,N,p[S]))})}else if(bo(v.PATTERN))if(v.PATTERN.unicode)y=!1,e.ensureOptimizations&&lw(""+Lp+("	Unable to analyze < "+v.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var x=Iie(v.PATTERN,e.ensureOptimizations);$t(x)&&(y=!1),qe(x,function(I){N6(b,I,p[S])})}else e.ensureOptimizations&&lw(""+Lp+("	TokenType: <"+v.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),y=!1;return b},[])}),t("ArrayPacking",function(){C=Tie(C)}),{emptyGroups:m,patternIdxToConfig:p,charCodeToPatternIdxToConfig:C,hasCustom:i,canBeOptimized:y}}function Pie(n,e){var t=[],r=kie(n);t=t.concat(r.errors);var i=Fie(r.valid),s=i.valid;return t=t.concat(i.errors),t=t.concat(Die(s)),t=t.concat(zie(s)),t=t.concat(Yie(s,e)),t=t.concat(jie(s)),t}function Die(n){var e=[],t=os(n,function(r){return bo(r[Hs])});return e=e.concat(Uie(t)),e=e.concat($ie(t)),e=e.concat(Wie(t)),e=e.concat(Gie(t)),e=e.concat(Bie(t)),e}function kie(n){var e=os(n,function(i){return!Ke(i,Hs)}),t=Fe(e,function(i){return{message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:On.MISSING_PATTERN,tokenTypes:[i]}}),r=x1(n,e);return{errors:t,valid:r}}function Fie(n){var e=os(n,function(i){var s=i[Hs];return!bo(s)&&!ma(s)&&!Ke(s,"exec")&&!Fs(s)}),t=Fe(e,function(i){return{message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:On.INVALID_PATTERN,tokenTypes:[i]}}),r=x1(n,e);return{errors:t,valid:r}}var Hie=/[^\\][\$]/;function Uie(n){var e=function(i){ON(s,i);function s(){var o=i!==null&&i.apply(this,arguments)||this;return o.found=!1,o}return s.prototype.visitEndAnchor=function(o){this.found=!0},s}(bc.exports.BaseRegExpVisitor),t=os(n,function(i){var s=i[Hs];try{var o=N1(s),a=new e;return a.visit(o),a.found}catch{return Hie.test(s.source)}}),r=Fe(t,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:On.EOI_ANCHOR_FOUND,tokenTypes:[i]}});return r}function Bie(n){var e=os(n,function(r){var i=r[Hs];return i.test("")}),t=Fe(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'PATTERN' must not match an empty string",type:On.EMPTY_MATCH_PATTERN,tokenTypes:[r]}});return t}var Vie=/[^\\[][\^]|^\^/;function $ie(n){var e=function(i){ON(s,i);function s(){var o=i!==null&&i.apply(this,arguments)||this;return o.found=!1,o}return s.prototype.visitStartAnchor=function(o){this.found=!0},s}(bc.exports.BaseRegExpVisitor),t=os(n,function(i){var s=i[Hs];try{var o=N1(s),a=new e;return a.visit(o),a.found}catch{return Vie.test(s.source)}}),r=Fe(t,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:On.SOI_ANCHOR_FOUND,tokenTypes:[i]}});return r}function Wie(n){var e=os(n,function(r){var i=r[Hs];return i instanceof RegExp&&(i.multiline||i.global)}),t=Fe(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:On.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[r]}});return t}function Gie(n){var e=[],t=Fe(n,function(s){return pr(n,function(o,a){return s.PATTERN.source===a.PATTERN.source&&!jn(e,a)&&a.PATTERN!==Zr.NA&&(e.push(a),o.push(a)),o},[])});t=Kd(t);var r=os(t,function(s){return s.length>1}),i=Fe(r,function(s){var o=Fe(s,function(l){return l.name}),a=Li(s).PATTERN;return{message:"The same RegExp pattern ->"+a+"<-"+("has been used in all of the following Token Types: "+o.join(", ")+" <-"),type:On.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}});return i}function zie(n){var e=os(n,function(r){if(!Ke(r,"GROUP"))return!1;var i=r.GROUP;return i!==Zr.SKIPPED&&i!==Zr.NA&&!Fs(i)}),t=Fe(e,function(r){return{message:"Token Type: ->"+r.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:On.INVALID_GROUP_TYPE_FOUND,tokenTypes:[r]}});return t}function Yie(n,e){var t=os(n,function(i){return i.PUSH_MODE!==void 0&&!jn(e,i.PUSH_MODE)}),r=Fe(t,function(i){var s="Token Type: ->"+i.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+i.PUSH_MODE+"<-which does not exist";return{message:s,type:On.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}});return r}function jie(n){var e=[],t=pr(n,function(r,i,s){var o=i.PATTERN;return o===Zr.NA||(Fs(o)?r.push({str:o,idx:s,tokenType:i}):bo(o)&&qie(o)&&r.push({str:o.source,idx:s,tokenType:i})),r},[]);return qe(n,function(r,i){qe(t,function(s){var o=s.str,a=s.idx,l=s.tokenType;if(i<a&&Kie(o,r.PATTERN)){var u="Token: ->"+l.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+r.name+"<-")+`in the lexer's definition.
See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:u,type:On.UNREACHABLE_PATTERN,tokenTypes:[r,l]})}})}),e}function Kie(n,e){if(bo(e)){var t=e.exec(n);return t!==null&&t.index===0}else{if(ma(e))return e(n,0,[],{});if(Ke(e,"exec"))return e.exec(n,0,[],{});if(typeof e=="string")return e===n;throw Error("non exhaustive match")}}function qie(n){var e=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return Ju(e,function(t){return n.source.indexOf(t)!==-1})===void 0}function zT(n){var e=n.ignoreCase?"i":"";return new RegExp("^(?:"+n.source+")",e)}function YT(n){var e=n.ignoreCase?"iy":"y";return new RegExp(""+n.source,e)}function Xie(n,e,t){var r=[];return Ke(n,Ka)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Ka+`> property in its definition
`,type:On.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Ke(n,Qf)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Qf+`> property in its definition
`,type:On.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Ke(n,Qf)&&Ke(n,Ka)&&!Ke(n.modes,n.defaultMode)&&r.push({message:"A MultiMode Lexer cannot be initialized with a "+Ka+": <"+n.defaultMode+`>which does not exist
`,type:On.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Ke(n,Qf)&&qe(n.modes,function(i,s){qe(i,function(o,a){Pi(o)&&r.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+s+"> at index: <"+a+`>
`),type:On.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),r}function Qie(n,e,t){var r=[],i=!1,s=Kd(Jr(Eie(n.modes,function(l){return l}))),o=hl(s,function(l){return l[Hs]===Zr.NA}),a=DN(t);return e&&qe(o,function(l){var u=PN(l,a);if(u!==!1){var c=tse(l,u),h={message:c,type:u.issue,tokenType:l};r.push(h)}else Ke(l,"LINE_BREAKS")?l.LINE_BREAKS===!0&&(i=!0):WE(a,l.PATTERN)&&(i=!0)}),e&&!i&&r.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:On.NO_LINE_BREAKS_FLAGS}),r}function Zie(n){var e={},t=Ao(n);return qe(t,function(r){var i=n[r];if(Ji(i))e[r]=[];else throw Error("non exhaustive match")}),e}function LN(n){var e=n.PATTERN;if(bo(e))return!1;if(ma(e))return!0;if(Ke(e,"exec"))return!0;if(Fs(e))return!1;throw Error("non exhaustive match")}function Jie(n){return Fs(n)&&n.length===1?n.charCodeAt(0):!1}var ese={test:function(n){for(var e=n.length,t=this.lastIndex;t<e;t++){var r=n.charCodeAt(t);if(r===10)return this.lastIndex=t+1,!0;if(r===13)return n.charCodeAt(t+1)===10?this.lastIndex=t+2:this.lastIndex=t+1,!0}return!1},lastIndex:0};function PN(n,e){if(Ke(n,"LINE_BREAKS"))return!1;if(bo(n.PATTERN)){try{WE(e,n.PATTERN)}catch(t){return{issue:On.IDENTIFY_TERMINATOR,errMsg:t.message}}return!1}else{if(Fs(n.PATTERN))return!1;if(LN(n))return{issue:On.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function tse(n,e){if(e.issue===On.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+n.name+`> Token Type
`)+("	 Root cause: "+e.errMsg+`.
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===On.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+n.name+`> Token Type
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function DN(n){var e=Fe(n,function(t){return Fs(t)&&t.length>0?t.charCodeAt(0):t});return e}function N6(n,e,t){n[e]===void 0?n[e]=[t]:n[e].push(t)}var oh=256;function aa(n){return n<oh?n:Hm[n]}var Hm=[];function nse(){if($t(Hm)){Hm=new Array(65536);for(var n=0;n<65536;n++)Hm[n]=n>255?255+~~(n/255):n}}function I1(n,e){var t=n.tokenTypeIdx;return t===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[t]===!0}function Pp(n,e){return n.tokenTypeIdx===e.tokenTypeIdx}var jT=1,kN={};function qd(n){var e=rse(n);ise(e),ose(e),sse(e),qe(e,function(t){t.isParent=t.categoryMatches.length>0})}function rse(n){for(var e=ei(n),t=n,r=!0;r;){t=Kd(Jr(Fe(t,function(s){return s.CATEGORIES})));var i=x1(t,e);e=e.concat(i),$t(i)?r=!1:t=i}return e}function ise(n){qe(n,function(e){HN(e)||(kN[jT]=e,e.tokenTypeIdx=jT++),KT(e)&&!Ji(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),KT(e)||(e.CATEGORIES=[]),ase(e)||(e.categoryMatches=[]),lse(e)||(e.categoryMatchesMap={})})}function sse(n){qe(n,function(e){e.categoryMatches=[],qe(e.categoryMatchesMap,function(t,r){e.categoryMatches.push(kN[r].tokenTypeIdx)})})}function ose(n){qe(n,function(e){FN([],e)})}function FN(n,e){qe(n,function(t){e.categoryMatchesMap[t.tokenTypeIdx]=!0}),qe(e.CATEGORIES,function(t){var r=n.concat(e);jn(r,t)||FN(r,t)})}function HN(n){return Ke(n,"tokenTypeIdx")}function KT(n){return Ke(n,"CATEGORIES")}function ase(n){return Ke(n,"categoryMatches")}function lse(n){return Ke(n,"categoryMatchesMap")}function use(n){return Ke(n,"tokenTypeIdx")}var cse={buildUnableToPopLexerModeMessage:function(n){return"Unable to pop Lexer Mode after encountering Token ->"+n.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(n,e,t,r,i){return"unexpected character: ->"+n.charAt(e)+"<- at offset: "+e+","+(" skipped "+t+" characters.")}},On;(function(n){n[n.MISSING_PATTERN=0]="MISSING_PATTERN",n[n.INVALID_PATTERN=1]="INVALID_PATTERN",n[n.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",n[n.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",n[n.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",n[n.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",n[n.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",n[n.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",n[n.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",n[n.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",n[n.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",n[n.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",n[n.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",n[n.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",n[n.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",n[n.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",n[n.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(On||(On={}));var ah={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:cse,traceInitPerf:!1,skipValidations:!1};Object.freeze(ah);var Zr=function(){function n(e,t){var r=this;if(t===void 0&&(t=ah),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof t=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=VT(ah,t);var i=this.config.traceInitPerf;i===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof i=="number"&&(this.traceInitMaxIdent=i,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var s,o=!0;r.TRACE_INIT("Lexer Config handling",function(){if(r.config.lineTerminatorsPattern===ah.lineTerminatorsPattern)r.config.lineTerminatorsPattern=ese;else if(r.config.lineTerminatorCharacters===ah.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),Ji(e)?(s={modes:{}},s.modes[Ka]=ei(e),s[Ka]=Ka):(o=!1,s=jd(e))}),r.config.skipValidations===!1&&(r.TRACE_INIT("performRuntimeChecks",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(Xie(s,r.trackStartLines,r.config.lineTerminatorCharacters))}),r.TRACE_INIT("performWarningRuntimeChecks",function(){r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat(Qie(s,r.trackStartLines,r.config.lineTerminatorCharacters))})),s.modes=s.modes?s.modes:{},qe(s.modes,function(c,h){s.modes[h]=hl(c,function(d){return Pi(d)})});var a=Ao(s.modes);if(qe(s.modes,function(c,h){r.TRACE_INIT("Mode: <"+h+"> processing",function(){if(r.modes.push(h),r.config.skipValidations===!1&&r.TRACE_INIT("validatePatterns",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(Pie(c,a))}),$t(r.lexerDefinitionErrors)){qd(c);var d;r.TRACE_INIT("analyzeTokenTypes",function(){d=Lie(c,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:r.TRACE_INIT.bind(r)})}),r.patternIdxToConfig[h]=d.patternIdxToConfig,r.charCodeToPatternIdxToConfig[h]=d.charCodeToPatternIdxToConfig,r.emptyGroups=VT(r.emptyGroups,d.emptyGroups),r.hasCustom=d.hasCustom||r.hasCustom,r.canModeBeOptimized[h]=d.canBeOptimized}})}),r.defaultMode=s.defaultMode,!$t(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling){var l=Fe(r.lexerDefinitionErrors,function(c){return c.message}),u=l.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+u)}qe(r.lexerDefinitionWarning,function(c){$E(c.message)}),r.TRACE_INIT("Choosing sub-methods implementations",function(){if(_N?(r.chopInput=$T,r.match=r.matchWithTest):(r.updateLastIndex=qn,r.match=r.matchWithExec),o&&(r.handleModes=qn),r.trackStartLines===!1&&(r.computeNewColumn=$T),r.trackEndLines===!1&&(r.updateTokenEndLineColumnLocation=qn),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else if(/onlyOffset/i.test(r.config.positionTracking))r.createTokenInstance=r.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)}),r.TRACE_INIT("Failed Optimization Warnings",function(){var c=pr(r.canModeBeOptimized,function(h,d,f){return d===!1&&h.push(f),h},[]);if(t.ensureOptimizations&&!$t(c))throw Error("Lexer Modes: < "+c.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),r.TRACE_INIT("clearRegExpParserCache",function(){Mie()}),r.TRACE_INIT("toFastProperties",function(){MN(r)})})}return n.prototype.tokenize=function(e,t){if(t===void 0&&(t=this.defaultMode),!$t(this.lexerDefinitionErrors)){var r=Fe(this.lexerDefinitionErrors,function(o){return o.message}),i=r.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}var s=this.tokenizeInternal(e,t);return s},n.prototype.tokenizeInternal=function(e,t){var r=this,i,s,o,a,l,u,c,h,d,f,m,p,y,C,b=e,v=b.length,S=0,L=0,_=this.hasCustom?0:Math.floor(e.length/10),P=new Array(_),x=[],I=this.trackStartLines?1:void 0,R=this.trackStartLines?1:void 0,N=Zie(this.emptyGroups),H=this.trackStartLines,K=this.config.lineTerminatorsPattern,X=0,J=[],ue=[],se=[],O=[];Object.freeze(O);var g=void 0;function E(){return J}function A(k){var B=aa(k),z=ue[B];return z===void 0?O:z}var U=function(k){if(se.length===1&&k.tokenType.PUSH_MODE===void 0){var B=r.config.errorMessageProvider.buildUnableToPopLexerModeMessage(k);x.push({offset:k.startOffset,line:k.startLine!==void 0?k.startLine:void 0,column:k.startColumn!==void 0?k.startColumn:void 0,length:k.image.length,message:B})}else{se.pop();var z=TN(se);J=r.patternIdxToConfig[z],ue=r.charCodeToPatternIdxToConfig[z],X=J.length;var de=r.canModeBeOptimized[z]&&r.config.safeMode===!1;ue&&de?g=A:g=E}};function G(k){se.push(k),ue=this.charCodeToPatternIdxToConfig[k],J=this.patternIdxToConfig[k],X=J.length,X=J.length;var B=this.canModeBeOptimized[k]&&this.config.safeMode===!1;ue&&B?g=A:g=E}G.call(this,t);for(var V;S<v;){l=null;var oe=b.charCodeAt(S),j=g(oe),ye=j.length;for(i=0;i<ye;i++){V=j[i];var ee=V.pattern;u=null;var T=V.short;if(T!==!1?oe===T&&(l=ee):V.isCustom===!0?(C=ee.exec(b,S,P,N),C!==null?(l=C[0],C.payload!==void 0&&(u=C.payload)):l=null):(this.updateLastIndex(ee,S),l=this.match(ee,e,S)),l!==null){if(a=V.longerAlt,a!==void 0){var F=J[a],Y=F.pattern;c=null,F.isCustom===!0?(C=Y.exec(b,S,P,N),C!==null?(o=C[0],C.payload!==void 0&&(c=C.payload)):o=null):(this.updateLastIndex(Y,S),o=this.match(Y,e,S)),o&&o.length>l.length&&(l=o,u=c,V=F)}break}}if(l!==null){if(h=l.length,d=V.group,d!==void 0&&(f=V.tokenTypeIdx,m=this.createTokenInstance(l,S,f,V.tokenType,I,R,h),this.handlePayload(m,u),d===!1?L=this.addToken(P,L,m):N[d].push(m)),e=this.chopInput(e,h),S=S+h,R=this.computeNewColumn(R,h),H===!0&&V.canLineTerminator===!0){var q=0,me=void 0,Z=void 0;K.lastIndex=0;do me=K.test(l),me===!0&&(Z=K.lastIndex-1,q++);while(me===!0);q!==0&&(I=I+q,R=h-Z,this.updateTokenEndLineColumnLocation(m,d,Z,q,I,R,h))}this.handleModes(V,U,G,m)}else{for(var Ce=S,Re=I,Ee=R,Me=!1;!Me&&S<v;)for(b.charCodeAt(S),e=this.chopInput(e,1),S++,s=0;s<X;s++){var Te=J[s],ee=Te.pattern,T=Te.short;if(T!==!1?b.charCodeAt(S)===T&&(Me=!0):Te.isCustom===!0?Me=ee.exec(b,S,P,N)!==null:(this.updateLastIndex(ee,S),Me=ee.exec(e)!==null),Me===!0)break}p=S-Ce,y=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(b,Ce,p,Re,Ee),x.push({offset:Ce,line:Re,column:Ee,length:p,message:y})}}return this.hasCustom||(P.length=L),{tokens:P,groups:N,errors:x}},n.prototype.handleModes=function(e,t,r,i){if(e.pop===!0){var s=e.push;t(i),s!==void 0&&r.call(this,s)}else e.push!==void 0&&r.call(this,e.push)},n.prototype.chopInput=function(e,t){return e.substring(t)},n.prototype.updateLastIndex=function(e,t){e.lastIndex=t},n.prototype.updateTokenEndLineColumnLocation=function(e,t,r,i,s,o,a){var l,u;t!==void 0&&(l=r===a-1,u=l?-1:0,i===1&&l===!0||(e.endLine=s+u,e.endColumn=o-1+-u))},n.prototype.computeNewColumn=function(e,t){return e+t},n.prototype.createTokenInstance=function(){return null},n.prototype.createOffsetOnlyToken=function(e,t,r,i){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:i}},n.prototype.createStartOnlyToken=function(e,t,r,i,s,o){return{image:e,startOffset:t,startLine:s,startColumn:o,tokenTypeIdx:r,tokenType:i}},n.prototype.createFullToken=function(e,t,r,i,s,o,a){return{image:e,startOffset:t,endOffset:t+a-1,startLine:s,endLine:s,startColumn:o,endColumn:o+a-1,tokenTypeIdx:r,tokenType:i}},n.prototype.addToken=function(e,t,r){return 666},n.prototype.addTokenUsingPush=function(e,t,r){return e.push(r),t},n.prototype.addTokenUsingMemberAccess=function(e,t,r){return e[t]=r,t++,t},n.prototype.handlePayload=function(e,t){},n.prototype.handlePayloadNoCustom=function(e,t){},n.prototype.handlePayloadWithCustom=function(e,t){t!==null&&(e.payload=t)},n.prototype.match=function(e,t,r){return null},n.prototype.matchWithTest=function(e,t,r){var i=e.test(t);return i===!0?t.substring(r,e.lastIndex):null},n.prototype.matchWithExec=function(e,t){var r=e.exec(t);return r!==null?r[0]:r},n.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+e+">");var i=NN(t),s=i.time,o=i.value,a=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(r+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,o}else return t()},n.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",n.NA=/NOT_APPLICABLE/,n}();function Pu(n){return UN(n)?n.LABEL:n.name}function UN(n){return Fs(n.LABEL)&&n.LABEL!==""}var hse="parent",qT="categories",XT="label",QT="group",ZT="push_mode",JT="pop_mode",e4="longer_alt",t4="line_breaks",n4="start_chars_hint";function Et(n){return dse(n)}function dse(n){var e=n.pattern,t={};if(t.name=n.name,Pi(e)||(t.PATTERN=e),Ke(n,hse))throw`The parent property is no longer supported.
See: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.`;return Ke(n,qT)&&(t.CATEGORIES=n[qT]),qd([t]),Ke(n,XT)&&(t.LABEL=n[XT]),Ke(n,QT)&&(t.GROUP=n[QT]),Ke(n,JT)&&(t.POP_MODE=n[JT]),Ke(n,ZT)&&(t.PUSH_MODE=n[ZT]),Ke(n,e4)&&(t.LONGER_ALT=n[e4]),Ke(n,t4)&&(t.LINE_BREAKS=n[t4]),Ke(n,n4)&&(t.START_CHARS_HINT=n[n4]),t}var dl=Et({name:"EOF",pattern:Zr.NA});qd([dl]);function GE(n,e,t,r,i,s,o,a){return{image:e,startOffset:t,endOffset:r,startLine:i,endLine:s,startColumn:o,endColumn:a,tokenTypeIdx:n.tokenTypeIdx,tokenType:n}}function Ht(n,e){return I1(n,e)}var xo=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ys=function(){function n(e){this.definition=e}return n.prototype.accept=function(e){e.visit(this),qe(this.definition,function(t){t.accept(e)})},n}(),di=function(n){xo(e,n);function e(t){var r=n.call(this,[])||this;return r.idx=1,as(r,Ui(t,function(i){return i!==void 0})),r}return Object.defineProperty(e.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.accept=function(t){t.visit(this)},e}(Ys),Sc=function(n){xo(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.orgText="",as(r,Ui(t,function(i){return i!==void 0})),r}return e}(Ys),ti=function(n){xo(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.ignoreAmbiguities=!1,as(r,Ui(t,function(i){return i!==void 0})),r}return e}(Ys),fr=function(n){xo(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,as(r,Ui(t,function(i){return i!==void 0})),r}return e}(Ys),Di=function(n){xo(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,as(r,Ui(t,function(i){return i!==void 0})),r}return e}(Ys),ki=function(n){xo(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,as(r,Ui(t,function(i){return i!==void 0})),r}return e}(Ys),Nn=function(n){xo(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,as(r,Ui(t,function(i){return i!==void 0})),r}return e}(Ys),fi=function(n){xo(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,as(r,Ui(t,function(i){return i!==void 0})),r}return e}(Ys),mi=function(n){xo(e,n);function e(t){var r=n.call(this,t.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,as(r,Ui(t,function(i){return i!==void 0})),r}return e}(Ys),hn=function(){function n(e){this.idx=1,as(this,Ui(e,function(t){return t!==void 0}))}return n.prototype.accept=function(e){e.visit(this)},n}();function fse(n){return Fe(n,Um)}function Um(n){function e(i){return Fe(i,Um)}if(n instanceof di)return{type:"NonTerminal",name:n.nonTerminalName,idx:n.idx};if(n instanceof ti)return{type:"Flat",definition:e(n.definition)};if(n instanceof fr)return{type:"Option",idx:n.idx,definition:e(n.definition)};if(n instanceof Di)return{type:"RepetitionMandatory",name:n.name,idx:n.idx,definition:e(n.definition)};if(n instanceof ki)return{type:"RepetitionMandatoryWithSeparator",name:n.name,idx:n.idx,separator:Um(new hn({terminalType:n.separator})),definition:e(n.definition)};if(n instanceof fi)return{type:"RepetitionWithSeparator",name:n.name,idx:n.idx,separator:Um(new hn({terminalType:n.separator})),definition:e(n.definition)};if(n instanceof Nn)return{type:"Repetition",name:n.name,idx:n.idx,definition:e(n.definition)};if(n instanceof mi)return{type:"Alternation",name:n.name,idx:n.idx,definition:e(n.definition)};if(n instanceof hn){var t={type:"Terminal",name:n.terminalType.name,label:Pu(n.terminalType),idx:n.idx},r=n.terminalType.PATTERN;return n.terminalType.PATTERN&&(t.pattern=bo(r)?r.source:r),t}else{if(n instanceof Sc)return{type:"Rule",name:n.name,orgText:n.orgText,definition:e(n.definition)};throw Error("non exhaustive match")}}var O1=function(){function n(){}return n.prototype.walk=function(e,t){var r=this;t===void 0&&(t=[]),qe(e.definition,function(i,s){var o=cr(e.definition,s+1);if(i instanceof di)r.walkProdRef(i,o,t);else if(i instanceof hn)r.walkTerminal(i,o,t);else if(i instanceof ti)r.walkFlat(i,o,t);else if(i instanceof fr)r.walkOption(i,o,t);else if(i instanceof Di)r.walkAtLeastOne(i,o,t);else if(i instanceof ki)r.walkAtLeastOneSep(i,o,t);else if(i instanceof fi)r.walkManySep(i,o,t);else if(i instanceof Nn)r.walkMany(i,o,t);else if(i instanceof mi)r.walkOr(i,o,t);else throw Error("non exhaustive match")})},n.prototype.walkTerminal=function(e,t,r){},n.prototype.walkProdRef=function(e,t,r){},n.prototype.walkFlat=function(e,t,r){var i=t.concat(r);this.walk(e,i)},n.prototype.walkOption=function(e,t,r){var i=t.concat(r);this.walk(e,i)},n.prototype.walkAtLeastOne=function(e,t,r){var i=[new fr({definition:e.definition})].concat(t,r);this.walk(e,i)},n.prototype.walkAtLeastOneSep=function(e,t,r){var i=r4(e,t,r);this.walk(e,i)},n.prototype.walkMany=function(e,t,r){var i=[new fr({definition:e.definition})].concat(t,r);this.walk(e,i)},n.prototype.walkManySep=function(e,t,r){var i=r4(e,t,r);this.walk(e,i)},n.prototype.walkOr=function(e,t,r){var i=this,s=t.concat(r);qe(e.definition,function(o){var a=new ti({definition:[o]});i.walk(a,s)})},n}();function r4(n,e,t){var r=[new fr({definition:[new hn({terminalType:n.separator})].concat(n.definition)})],i=r.concat(e,t);return i}var Il=function(){function n(){}return n.prototype.visit=function(e){var t=e;switch(t.constructor){case di:return this.visitNonTerminal(t);case ti:return this.visitFlat(t);case fr:return this.visitOption(t);case Di:return this.visitRepetitionMandatory(t);case ki:return this.visitRepetitionMandatoryWithSeparator(t);case fi:return this.visitRepetitionWithSeparator(t);case Nn:return this.visitRepetition(t);case mi:return this.visitAlternation(t);case hn:return this.visitTerminal(t);case Sc:return this.visitRule(t);default:throw Error("non exhaustive match")}},n.prototype.visitNonTerminal=function(e){},n.prototype.visitFlat=function(e){},n.prototype.visitOption=function(e){},n.prototype.visitRepetition=function(e){},n.prototype.visitRepetitionMandatory=function(e){},n.prototype.visitRepetitionMandatoryWithSeparator=function(e){},n.prototype.visitRepetitionWithSeparator=function(e){},n.prototype.visitAlternation=function(e){},n.prototype.visitTerminal=function(e){},n.prototype.visitRule=function(e){},n}(),mse=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();function pse(n){return n instanceof ti||n instanceof fr||n instanceof Nn||n instanceof Di||n instanceof ki||n instanceof fi||n instanceof hn||n instanceof Sc}function Dp(n,e){e===void 0&&(e=[]);var t=n instanceof fr||n instanceof Nn||n instanceof fi;return t?!0:n instanceof mi?AN(n.definition,function(r){return Dp(r,e)}):n instanceof di&&jn(e,n)?!1:n instanceof Ys?(n instanceof di&&e.push(n),Ii(n.definition,function(r){return Dp(r,e)})):!1}function gse(n){return n instanceof mi}function qi(n){if(n instanceof di)return"SUBRULE";if(n instanceof fr)return"OPTION";if(n instanceof mi)return"OR";if(n instanceof Di)return"AT_LEAST_ONE";if(n instanceof ki)return"AT_LEAST_ONE_SEP";if(n instanceof fi)return"MANY_SEP";if(n instanceof Nn)return"MANY";if(n instanceof hn)return"CONSUME";throw Error("non exhaustive match")}var yse=function(n){mse(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(t){var r=t.terminalType.name+this.separator+"Terminal";Ke(this.dslMethods,r)||(this.dslMethods[r]=[]),this.dslMethods[r].push(t)},e.prototype.visitNonTerminal=function(t){var r=t.nonTerminalName+this.separator+"Terminal";Ke(this.dslMethods,r)||(this.dslMethods[r]=[]),this.dslMethods[r].push(t)},e.prototype.visitOption=function(t){this.dslMethods.option.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.dslMethods.repetitionWithSeparator.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.dslMethods.repetitionMandatory.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)},e.prototype.visitRepetition=function(t){this.dslMethods.repetition.push(t)},e.prototype.visitAlternation=function(t){this.dslMethods.alternation.push(t)},e}(Il),Zf=new yse;function wse(n){Zf.reset(),n.accept(Zf);var e=Zf.dslMethods;return Zf.reset(),e}function Xd(n){if(n instanceof di)return Xd(n.referencedRule);if(n instanceof hn)return Ese(n);if(pse(n))return vse(n);if(gse(n))return Cse(n);throw Error("non exhaustive match")}function vse(n){for(var e=[],t=n.definition,r=0,i=t.length>r,s,o=!0;i&&o;)s=t[r],o=Dp(s),e=e.concat(Xd(s)),r=r+1,i=t.length>r;return BE(e)}function Cse(n){var e=Fe(n.definition,function(t){return Xd(t)});return BE(Jr(e))}function Ese(n){return[n.terminalType]}var BN="_~IN~_",bse=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Sse=function(n){bse(e,n);function e(t){var r=n.call(this)||this;return r.topProd=t,r.follows={},r}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(t,r,i){},e.prototype.walkProdRef=function(t,r,i){var s=Tse(t.referencedRule,t.idx)+this.topProd.name,o=r.concat(i),a=new ti({definition:o}),l=Xd(a);this.follows[s]=l},e}(O1);function Rse(n){var e={};return qe(n,function(t){var r=new Sse(t).startWalking();as(e,r)}),e}function Tse(n,e){return n.name+e+BN}var Ase=4,pa=8,xse=8,Du=1<<pa,kp=2<<pa,Sh=3<<pa,Rh=4<<pa,Th=5<<pa,Au=6<<pa;function Ah(n,e,t){return t|e|n}var Mse=32-xse;function VN(n,e,t,r){var i=r+1<<Mse;return Ah(n,e,t)|i}var Nse=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();function i4(n,e){isNaN(n.startOffset)===!0?(n.startOffset=e.startOffset,n.endOffset=e.endOffset):n.endOffset<e.endOffset&&(n.endOffset=e.endOffset)}function s4(n,e){isNaN(n.startOffset)===!0?(n.startOffset=e.startOffset,n.startColumn=e.startColumn,n.startLine=e.startLine,n.endOffset=e.endOffset,n.endColumn=e.endColumn,n.endLine=e.endLine):n.endOffset<e.endOffset&&(n.endOffset=e.endOffset,n.endColumn=e.endColumn,n.endLine=e.endLine)}function Ise(n,e,t){n.children[t]===void 0?n.children[t]=[e]:n.children[t].push(e)}function o4(n,e,t){n.children[e]===void 0?n.children[e]=[t]:n.children[e].push(t)}var zE=function(n){Nse(e,n);function e(t){var r=n.call(this)||this;return r.result=[],r.ruleIdx=t,r}return e.prototype.collectNamedDSLMethod=function(t,r,i){if(!Pi(t.name)){var s=void 0;if(t instanceof fr||t instanceof Nn||t instanceof Di||t instanceof mi)s=new r({definition:t.definition,idx:t.idx});else if(t instanceof ki||t instanceof fi)s=new r({definition:t.definition,idx:t.idx,separator:t.separator});else throw Error("non exhaustive match");var o=[s],a=Ah(this.ruleIdx,i,t.idx);this.result.push({def:o,key:a,name:t.name,orgProd:t})}},e.prototype.visitOption=function(t){this.collectNamedDSLMethod(t,fr,kp)},e.prototype.visitRepetition=function(t){this.collectNamedDSLMethod(t,Nn,Sh)},e.prototype.visitRepetitionMandatory=function(t){this.collectNamedDSLMethod(t,Di,Rh)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.collectNamedDSLMethod(t,ki,Au)},e.prototype.visitRepetitionWithSeparator=function(t){this.collectNamedDSLMethod(t,fi,Th)},e.prototype.visitAlternation=function(t){var r=this;this.collectNamedDSLMethod(t,mi,Du);var i=t.definition.length>1;qe(t.definition,function(s,o){if(!Pi(s.name)){var a=s.definition;i?a=[new fr({definition:s.definition})]:a=s.definition;var l=VN(r.ruleIdx,Du,t.idx,o);r.result.push({def:a,key:l,name:s.name,orgProd:s})}})},e}(Il);function Ose(n,e){var t={allRuleNames:[]};return qe(n,function(r){var i=e[r.name];t.allRuleNames.push(r.name);var s=new zE(i);r.accept(s),qe(s.result,function(o){o.def,o.key;var a=o.name;t.allRuleNames.push(r.name+a)})}),t}var Ol=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),_se=function(n){Ol(e,n);function e(t,r){var i=n.call(this)||this;return i.topProd=t,i.path=r,i.possibleTokTypes=[],i.nextProductionName="",i.nextProductionOccurrence=0,i.found=!1,i.isAtEndOfPath=!1,i}return e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=ei(this.path.ruleStack).reverse(),this.occurrenceStack=ei(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(t,r){r===void 0&&(r=[]),this.found||n.prototype.walk.call(this,t,r)},e.prototype.walkProdRef=function(t,r,i){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){var s=r.concat(i);this.updateExpectedNext(),this.walk(t.referencedRule,s)}},e.prototype.updateExpectedNext=function(){$t(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(O1),Lse=function(n){Ol(e,n);function e(t,r){var i=n.call(this,t,r)||this;return i.path=r,i.nextTerminalName="",i.nextTerminalOccurrence=0,i.nextTerminalName=i.path.lastTok.name,i.nextTerminalOccurrence=i.path.lastTokOccurrence,i}return e.prototype.walkTerminal=function(t,r,i){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){var s=r.concat(i),o=new ti({definition:s});this.possibleTokTypes=Xd(o),this.found=!0}},e}(_se),_1=function(n){Ol(e,n);function e(t,r){var i=n.call(this)||this;return i.topRule=t,i.occurrence=r,i.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},i}return e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(O1),Pse=function(n){Ol(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkMany=function(t,r,i){if(t.idx===this.occurrence){var s=Li(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof hn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkMany.call(this,t,r,i)},e}(_1),a4=function(n){Ol(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkManySep=function(t,r,i){if(t.idx===this.occurrence){var s=Li(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof hn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkManySep.call(this,t,r,i)},e}(_1),Dse=function(n){Ol(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkAtLeastOne=function(t,r,i){if(t.idx===this.occurrence){var s=Li(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof hn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkAtLeastOne.call(this,t,r,i)},e}(_1),l4=function(n){Ol(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.walkAtLeastOneSep=function(t,r,i){if(t.idx===this.occurrence){var s=Li(r.concat(i));this.result.isEndOfRule=s===void 0,s instanceof hn&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else n.prototype.walkAtLeastOneSep.call(this,t,r,i)},e}(_1);function hw(n,e,t){t===void 0&&(t=[]),t=ei(t);var r=[],i=0;function s(u){return u.concat(cr(n,i+1))}function o(u){var c=hw(s(u),e,t);return r.concat(c)}for(;t.length<e&&i<n.length;){var a=n[i];if(a instanceof ti)return o(a.definition);if(a instanceof di)return o(a.definition);if(a instanceof fr)r=o(a.definition);else if(a instanceof Di){var l=a.definition.concat([new Nn({definition:a.definition})]);return o(l)}else if(a instanceof ki){var l=[new ti({definition:a.definition}),new Nn({definition:[new hn({terminalType:a.separator})].concat(a.definition)})];return o(l)}else if(a instanceof fi){var l=a.definition.concat([new Nn({definition:[new hn({terminalType:a.separator})].concat(a.definition)})]);r=o(l)}else if(a instanceof Nn){var l=a.definition.concat([new Nn({definition:a.definition})]);r=o(l)}else{if(a instanceof mi)return qe(a.definition,function(u){r=o(u.definition)}),r;if(a instanceof hn)t.push(a.terminalType);else throw Error("non exhaustive match")}i++}return r.push({partialPath:t,suffixDef:cr(n,i)}),r}function $N(n,e,t,r){var i="EXIT_NONE_TERMINAL",s=[i],o="EXIT_ALTERNATIVE",a=!1,l=e.length,u=l-r-1,c=[],h=[];for(h.push({idx:-1,def:n,ruleStack:[],occurrenceStack:[]});!$t(h);){var d=h.pop();if(d===o){a&&TN(h).idx<=u&&h.pop();continue}var f=d.def,m=d.idx,p=d.ruleStack,y=d.occurrenceStack;if(!$t(f)){var C=f[0];if(C===i){var b={idx:m,def:cr(f),ruleStack:rd(p),occurrenceStack:rd(y)};h.push(b)}else if(C instanceof hn)if(m<l-1){var v=m+1,S=e[v];if(t(S,C.terminalType)){var b={idx:v,def:cr(f),ruleStack:p,occurrenceStack:y};h.push(b)}}else if(m===l-1)c.push({nextTokenType:C.terminalType,nextTokenOccurrence:C.idx,ruleStack:p,occurrenceStack:y}),a=!0;else throw Error("non exhaustive match");else if(C instanceof di){var L=ei(p);L.push(C.nonTerminalName);var _=ei(y);_.push(C.idx);var b={idx:m,def:C.definition.concat(s,cr(f)),ruleStack:L,occurrenceStack:_};h.push(b)}else if(C instanceof fr){var P={idx:m,def:cr(f),ruleStack:p,occurrenceStack:y};h.push(P),h.push(o);var x={idx:m,def:C.definition.concat(cr(f)),ruleStack:p,occurrenceStack:y};h.push(x)}else if(C instanceof Di){var I=new Nn({definition:C.definition,idx:C.idx}),R=C.definition.concat([I],cr(f)),b={idx:m,def:R,ruleStack:p,occurrenceStack:y};h.push(b)}else if(C instanceof ki){var N=new hn({terminalType:C.separator}),I=new Nn({definition:[N].concat(C.definition),idx:C.idx}),R=C.definition.concat([I],cr(f)),b={idx:m,def:R,ruleStack:p,occurrenceStack:y};h.push(b)}else if(C instanceof fi){var P={idx:m,def:cr(f),ruleStack:p,occurrenceStack:y};h.push(P),h.push(o);var N=new hn({terminalType:C.separator}),H=new Nn({definition:[N].concat(C.definition),idx:C.idx}),R=C.definition.concat([H],cr(f)),x={idx:m,def:R,ruleStack:p,occurrenceStack:y};h.push(x)}else if(C instanceof Nn){var P={idx:m,def:cr(f),ruleStack:p,occurrenceStack:y};h.push(P),h.push(o);var H=new Nn({definition:C.definition,idx:C.idx}),R=C.definition.concat([H],cr(f)),x={idx:m,def:R,ruleStack:p,occurrenceStack:y};h.push(x)}else if(C instanceof mi)for(var K=C.definition.length-1;K>=0;K--){var X=C.definition[K],J={idx:m,def:X.definition.concat(cr(f)),ruleStack:p,occurrenceStack:y};h.push(J),h.push(o)}else if(C instanceof ti)h.push({idx:m,def:C.definition.concat(cr(f)),ruleStack:p,occurrenceStack:y});else if(C instanceof Sc)h.push(kse(C,m,p,y));else throw Error("non exhaustive match")}}return c}function kse(n,e,t,r){var i=ei(t);i.push(n.name);var s=ei(r);return s.push(1),{idx:e,def:n.definition,ruleStack:i,occurrenceStack:s}}var WN=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),zt;(function(n){n[n.OPTION=0]="OPTION",n[n.REPETITION=1]="REPETITION",n[n.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",n[n.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",n[n.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",n[n.ALTERNATION=5]="ALTERNATION"})(zt||(zt={}));function Fse(n){if(n instanceof fr)return zt.OPTION;if(n instanceof Nn)return zt.REPETITION;if(n instanceof Di)return zt.REPETITION_MANDATORY;if(n instanceof ki)return zt.REPETITION_MANDATORY_WITH_SEPARATOR;if(n instanceof fi)return zt.REPETITION_WITH_SEPARATOR;if(n instanceof mi)return zt.ALTERNATION;throw Error("non exhaustive match")}function Hse(n,e,t,r,i,s){var o=YE(n,e,t),a=YN(o)?Pp:I1;return s(o,r,a,i)}function Use(n,e,t,r,i,s){var o=jE(n,e,i,t),a=YN(o)?Pp:I1;return s(o[0],a,r)}function Bse(n,e,t,r){var i=n.length,s=Ii(n,function(l){return Ii(l,function(u){return u.length===1})});if(e)return function(l){for(var u=Fe(l,function(v){return v.GATE}),c=0;c<i;c++){var h=n[c],d=h.length,f=u[c];if(f!==void 0&&f.call(this)===!1)continue;e:for(var m=0;m<d;m++){for(var p=h[m],y=p.length,C=0;C<y;C++){var b=this.LA(C+1);if(t(b,p[C])===!1)continue e}return c}}};if(s&&!r){var o=Fe(n,function(l){return Jr(l)}),a=pr(o,function(l,u,c){return qe(u,function(h){Ke(l,h.tokenTypeIdx)||(l[h.tokenTypeIdx]=c),qe(h.categoryMatches,function(d){Ke(l,d)||(l[d]=c)})}),l},[]);return function(){var l=this.LA(1);return a[l.tokenTypeIdx]}}else return function(){for(var l=0;l<i;l++){var u=n[l],c=u.length;e:for(var h=0;h<c;h++){for(var d=u[h],f=d.length,m=0;m<f;m++){var p=this.LA(m+1);if(t(p,d[m])===!1)continue e}return l}}}}function Vse(n,e,t){var r=Ii(n,function(u){return u.length===1}),i=n.length;if(r&&!t){var s=Jr(n);if(s.length===1&&$t(s[0].categoryMatches)){var o=s[0],a=o.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===a}}else{var l=pr(s,function(u,c,h){return u[c.tokenTypeIdx]=!0,qe(c.categoryMatches,function(d){u[d]=!0}),u},[]);return function(){var u=this.LA(1);return l[u.tokenTypeIdx]===!0}}}else return function(){e:for(var u=0;u<i;u++){for(var c=n[u],h=c.length,d=0;d<h;d++){var f=this.LA(d+1);if(e(f,c[d])===!1)continue e}return!0}return!1}}var $se=function(n){WN(e,n);function e(t,r,i){var s=n.call(this)||this;return s.topProd=t,s.targetOccurrence=r,s.targetProdType=i,s}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(t,r,i,s){return t.idx===this.targetOccurrence&&this.targetProdType===r?(this.restDef=i.concat(s),!0):!1},e.prototype.walkOption=function(t,r,i){this.checkIsTarget(t,zt.OPTION,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkAtLeastOne=function(t,r,i){this.checkIsTarget(t,zt.REPETITION_MANDATORY,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkAtLeastOneSep=function(t,r,i){this.checkIsTarget(t,zt.REPETITION_MANDATORY_WITH_SEPARATOR,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkMany=function(t,r,i){this.checkIsTarget(t,zt.REPETITION,r,i)||n.prototype.walkOption.call(this,t,r,i)},e.prototype.walkManySep=function(t,r,i){this.checkIsTarget(t,zt.REPETITION_WITH_SEPARATOR,r,i)||n.prototype.walkOption.call(this,t,r,i)},e}(O1),GN=function(n){WN(e,n);function e(t,r,i){var s=n.call(this)||this;return s.targetOccurrence=t,s.targetProdType=r,s.targetRef=i,s.result=[],s}return e.prototype.checkIsTarget=function(t,r){t.idx===this.targetOccurrence&&this.targetProdType===r&&(this.targetRef===void 0||t===this.targetRef)&&(this.result=t.definition)},e.prototype.visitOption=function(t){this.checkIsTarget(t,zt.OPTION)},e.prototype.visitRepetition=function(t){this.checkIsTarget(t,zt.REPETITION)},e.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,zt.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,zt.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,zt.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(t){this.checkIsTarget(t,zt.ALTERNATION)},e}(Il);function u4(n){for(var e=new Array(n),t=0;t<n;t++)e[t]=[];return e}function I6(n){for(var e=[""],t=0;t<n.length;t++){for(var r=n[t],i=[],s=0;s<e.length;s++){var o=e[s];i.push(o+"_"+r.tokenTypeIdx);for(var a=0;a<r.categoryMatches.length;a++){var l="_"+r.categoryMatches[a];i.push(o+l)}}e=i}return e}function Wse(n,e,t){for(var r=0;r<n.length;r++)if(r!==t)for(var i=n[r],s=0;s<e.length;s++){var o=e[s];if(i[o]===!0)return!1}return!0}function zN(n,e){for(var t=Fe(n,function(c){return hw([c],1)}),r=u4(t.length),i=Fe(t,function(c){var h={};return qe(c,function(d){var f=I6(d.partialPath);qe(f,function(m){h[m]=!0})}),h}),s=t,o=1;o<=e;o++){var a=s;s=u4(a.length);for(var l=function(c){for(var h=a[c],d=0;d<h.length;d++){var f=h[d].partialPath,m=h[d].suffixDef,p=I6(f),y=Wse(i,p,c);if(y||$t(m)||f.length===e){var C=r[c];if(dw(C,f)===!1){C.push(f);for(var b=0;b<p.length;b++){var v=p[b];i[c][v]=!0}}}else{var S=hw(m,o+1,f);s[c]=s[c].concat(S),qe(S,function(L){var _=I6(L.partialPath);qe(_,function(P){i[c][P]=!0})})}}},u=0;u<a.length;u++)l(u)}return r}function YE(n,e,t,r){var i=new GN(n,zt.ALTERNATION,r);return e.accept(i),zN(i.result,t)}function jE(n,e,t,r){var i=new GN(n,t);e.accept(i);var s=i.result,o=new $se(e,n,t),a=o.startWalking(),l=new ti({definition:s}),u=new ti({definition:a});return zN([l,u],r)}function dw(n,e){e:for(var t=0;t<n.length;t++){var r=n[t];if(r.length===e.length){for(var i=0;i<r.length;i++){var s=e[i],o=r[i],a=s===o||o.categoryMatchesMap[s.tokenTypeIdx]!==void 0;if(a===!1)continue e}return!0}}return!1}function Gse(n,e){return n.length<e.length&&Ii(n,function(t,r){var i=e[r];return t===i||i.categoryMatchesMap[t.tokenTypeIdx]})}function YN(n){return Ii(n,function(e){return Ii(e,function(t){return Ii(t,function(r){return $t(r.categoryMatches)})})})}var KE=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();function zse(n,e,t,r,i,s){var o=Fe(n,function(b){return jse(b,i)}),a=Fe(n,function(b){return qN(b,b,i)}),l=[],u=[],c=[];Ii(a,$t)&&(l=Fe(n,function(b){return toe(b,i)}),u=Fe(n,function(b){return noe(b,e,r,i)}),c=soe(n,e,i));var h=loe(n,t,i),d=Fe(t,function(b){return Zse(b,i)}),f=Yse(n,i),m=uoe(n,i),p=Fe(n,function(b){return ioe(b,i)}),y=Fe(n,function(b){return Xse(b,i)}),C=Fe(n,function(b){return Jse(b,n,s,i)});return Jr(o.concat(d,f,m,c,a,l,u,h,p,y,C))}function Yse(n,e){var t=[];return qe(n,function(r){var i=new zE("");r.accept(i);var s=Fe(i.result,function(o){return o.orgProd});t.push(Fe(s,function(o){return Qse(r,o,e)}))}),Jr(t)}function jse(n,e){var t=new qse;n.accept(t);var r=t.allProductions,i=xN(r,Kse),s=Ui(i,function(a){return a.length>1}),o=Fe(Sr(s),function(a){var l=Li(a),u=e.buildDuplicateFoundError(n,a),c=qi(l),h={message:u,type:nr.DUPLICATE_PRODUCTIONS,ruleName:n.name,dslName:c,occurrence:l.idx},d=jN(l);return d&&(h.parameter=d),h});return o}function Kse(n){return qi(n)+"_#_"+n.idx+"_#_"+jN(n)}function jN(n){return n instanceof hn?n.terminalType.name:n instanceof di?n.nonTerminalName:""}var qse=function(n){KE(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},e.prototype.visitOption=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e.prototype.visitAlternation=function(t){this.allProductions.push(t)},e.prototype.visitTerminal=function(t){this.allProductions.push(t)},e}(Il),fl=/^[a-zA-Z_]\w*$/,KN=new RegExp(fl.source.replace("^","^\\$"));function Xse(n,e){var t=[],r=n.name;return r.match(fl)||t.push({message:e.buildInvalidRuleNameError({topLevelRule:n,expectedPattern:fl}),type:nr.INVALID_RULE_NAME,ruleName:r}),t}function Qse(n,e,t){var r=[],i;return e.name.match(KN)||(i=t.buildInvalidNestedRuleNameError(n,e),r.push({message:i,type:nr.INVALID_NESTED_RULE_NAME,ruleName:n.name})),r}function Zse(n,e){var t=[],r=n.name;return r.match(fl)||t.push({message:e.buildTokenNameError({tokenType:n,expectedPattern:fl}),type:nr.INVALID_TOKEN_NAME}),t}function Jse(n,e,t,r){var i=[],s=pr(e,function(a,l){return l.name===n.name?a+1:a},0);if(s>1){var o=r.buildDuplicateRuleNameError({topLevelRule:n,grammarName:t});i.push({message:o,type:nr.DUPLICATE_RULE_NAME,ruleName:n.name})}return i}function eoe(n,e,t){var r=[],i;return jn(e,n)||(i="Invalid rule override, rule: ->"+n+"<- cannot be overridden in the grammar: ->"+t+"<-as it is not defined in any of the super grammars ",r.push({message:i,type:nr.INVALID_RULE_OVERRIDE,ruleName:n})),r}function qN(n,e,t,r){r===void 0&&(r=[]);var i=[],s=Bm(e.definition);if($t(s))return[];var o=n.name,a=jn(s,n);a&&i.push({message:t.buildLeftRecursionError({topLevelRule:n,leftRecursionPath:r}),type:nr.LEFT_RECURSION,ruleName:o});var l=x1(s,r.concat([n])),u=Fe(l,function(c){var h=ei(r);return h.push(c),qN(n,c,t,h)});return i.concat(Jr(u))}function Bm(n){var e=[];if($t(n))return e;var t=Li(n);if(t instanceof di)e.push(t.referencedRule);else if(t instanceof ti||t instanceof fr||t instanceof Di||t instanceof ki||t instanceof fi||t instanceof Nn)e=e.concat(Bm(t.definition));else if(t instanceof mi)e=Jr(Fe(t.definition,function(o){return Bm(o.definition)}));else if(!(t instanceof hn))throw Error("non exhaustive match");var r=Dp(t),i=n.length>1;if(r&&i){var s=cr(n);return e.concat(Bm(s))}else return e}var qE=function(n){KE(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.alternations=[],t}return e.prototype.visitAlternation=function(t){this.alternations.push(t)},e}(Il);function toe(n,e){var t=new qE;n.accept(t);var r=t.alternations,i=pr(r,function(s,o){var a=rd(o.definition),l=Fe(a,function(u,c){var h=$N([u],[],null,1);return $t(h)?{message:e.buildEmptyAlternationError({topLevelRule:n,alternation:o,emptyChoiceIdx:c}),type:nr.NONE_LAST_EMPTY_ALT,ruleName:n.name,occurrence:o.idx,alternative:c+1}:null});return s.concat(Kd(l))},[]);return i}function noe(n,e,t,r){var i=new qE;n.accept(i);var s=i.alternations,o=t[n.name];o&&(s=hl(s,function(l){return o[qi(l)+(l.idx===0?"":l.idx)]})),s=hl(s,function(l){return l.ignoreAmbiguities===!0});var a=pr(s,function(l,u){var c=u.idx,h=u.maxLookahead||e,d=YE(c,n,h,u),f=ooe(d,u,n,r),m=aoe(d,u,n,r);return l.concat(f,m)},[]);return a}var roe=function(n){KE(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e}(Il);function ioe(n,e){var t=new qE;n.accept(t);var r=t.alternations,i=pr(r,function(s,o){return o.definition.length>255&&s.push({message:e.buildTooManyAlternativesError({topLevelRule:n,alternation:o}),type:nr.TOO_MANY_ALTS,ruleName:n.name,occurrence:o.idx}),s},[]);return i}function soe(n,e,t){var r=[];return qe(n,function(i){var s=new roe;i.accept(s);var o=s.allProductions;qe(o,function(a){var l=Fse(a),u=a.maxLookahead||e,c=a.idx,h=jE(c,i,l,u),d=h[0];if($t(Jr(d))){var f=t.buildEmptyRepetitionError({topLevelRule:i,repetition:a});r.push({message:f,type:nr.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),r}function ooe(n,e,t,r){var i=[],s=pr(n,function(a,l,u){return e.definition[u].ignoreAmbiguities===!0||qe(l,function(c){var h=[u];qe(n,function(d,f){u!==f&&dw(d,c)&&e.definition[f].ignoreAmbiguities!==!0&&h.push(f)}),h.length>1&&!dw(i,c)&&(i.push(c),a.push({alts:h,path:c}))}),a},[]),o=Fe(s,function(a){var l=Fe(a.alts,function(c){return c+1}),u=r.buildAlternationAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:l,prefixPath:a.path});return{message:u,type:nr.AMBIGUOUS_ALTS,ruleName:t.name,occurrence:e.idx,alternatives:[a.alts]}});return o}function aoe(n,e,t,r){var i=[],s=pr(n,function(o,a,l){var u=Fe(a,function(c){return{idx:l,path:c}});return o.concat(u)},[]);return qe(s,function(o){var a=e.definition[o.idx];if(a.ignoreAmbiguities!==!0){var l=o.idx,u=o.path,c=bie(s,function(d){return e.definition[d.idx].ignoreAmbiguities!==!0&&d.idx<l&&Gse(d.path,u)}),h=Fe(c,function(d){var f=[d.idx+1,l+1],m=e.idx===0?"":e.idx,p=r.buildAlternationPrefixAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:f,prefixPath:d.path});return{message:p,type:nr.AMBIGUOUS_PREFIX_ALTS,ruleName:t.name,occurrence:m,alternatives:f}});i=i.concat(h)}}),i}function loe(n,e,t){var r=[],i=Fe(e,function(s){return s.name});return qe(n,function(s){var o=s.name;if(jn(i,o)){var a=t.buildNamespaceConflictError(s);r.push({message:a,type:nr.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:o})}}),r}function uoe(n,e){var t=[];return qe(n,function(r){var i=new zE("");r.accept(i);var s=xN(i.result,function(a){return a.name}),o=Ui(s,function(a){return a.length>1});qe(Sr(o),function(a){var l=Fe(a,function(c){return c.orgProd}),u=e.buildDuplicateNestedRuleNameError(r,l);t.push({message:u,type:nr.DUPLICATE_NESTED_NAME,ruleName:r.name})})}),t}var XN={buildMismatchTokenMessage:function(n){var e=n.expected,t=n.actual;n.previous,n.ruleName;var r=UN(e),i=r?"--> "+Pu(e)+" <--":"token of type --> "+e.name+" <--",s="Expecting "+i+" but found --> '"+t.image+"' <--";return s},buildNotAllInputParsedMessage:function(n){var e=n.firstRedundant;return n.ruleName,"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(n){var e=n.expectedPathsPerAlt,t=n.actual;n.previous;var r=n.customUserDescription;n.ruleName;var i="Expecting: ",s=Li(t).image,o=`
but found: '`+s+"'";if(r)return i+r+o;var a=pr(e,function(h,d){return h.concat(d)},[]),l=Fe(a,function(h){return"["+Fe(h,function(d){return Pu(d)}).join(", ")+"]"}),u=Fe(l,function(h,d){return"  "+(d+1)+". "+h}),c=`one of these possible Token sequences:
`+u.join(`
`);return i+c+o},buildEarlyExitMessage:function(n){var e=n.expectedIterationPaths,t=n.actual,r=n.customUserDescription;n.ruleName;var i="Expecting: ",s=Li(t).image,o=`
but found: '`+s+"'";if(r)return i+r+o;var a=Fe(e,function(u){return"["+Fe(u,function(c){return Pu(c)}).join(",")+"]"}),l=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+a.join(" ,")+">");return i+l+o}};Object.freeze(XN);var coe={buildRuleNotFoundError:function(n,e){var t="Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+n.name+"<-";return t}},XE={buildDuplicateFoundError:function(n,e){function t(c){return c instanceof hn?c.terminalType.name:c instanceof di?c.nonTerminalName:""}var r=n.name,i=Li(e),s=i.idx,o=qi(i),a=t(i),l=s>0,u="->"+o+(l?s:"")+"<- "+(a?"with argument: ->"+a+"<-":"")+`
                  appears more than once (`+e.length+" times) in the top level rule: ->"+r+`<-.                  
                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return u=u.replace(/[ \t]+/g," "),u=u.replace(/\s\s+/g,`
`),u},buildInvalidNestedRuleNameError:function(n,e){var t="Invalid nested rule name: ->"+e.name+"<- inside rule: ->"+n.name+`<-
`+("it must match the pattern: ->"+KN.toString()+`<-.
`)+"Note that this means a nested rule name must start with the '$'(dollar) sign.";return t},buildDuplicateNestedRuleNameError:function(n,e){var t=Li(e).name,r="Duplicate nested rule name: ->"+t+"<- inside rule: ->"+n.name+`<-
A nested name must be unique in the scope of a top level grammar rule.`;return r},buildNamespaceConflictError:function(n){var e=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+n.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return e},buildAlternationPrefixAmbiguityError:function(n){var e=Fe(n.prefixPath,function(i){return Pu(i)}).join(", "),t=n.alternation.idx===0?"":n.alternation.idx,r="Ambiguous alternatives: <"+n.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+t+"> inside <"+n.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`)+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return r},buildAlternationAmbiguityError:function(n){var e=Fe(n.prefixPath,function(i){return Pu(i)}).join(", "),t=n.alternation.idx===0?"":n.alternation.idx,r="Ambiguous Alternatives Detected: <"+n.ambiguityIndices.join(" ,")+"> in <OR"+t+">"+(" inside <"+n.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`);return r=r+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r},buildEmptyRepetitionError:function(n){var e=qi(n.repetition);n.repetition.idx!==0&&(e+=n.repetition.idx);var t="The repetition <"+e+"> within Rule <"+n.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return t},buildTokenNameError:function(n){var e=n.tokenType.name,t="Invalid Grammar Token name: ->"+e+"<- it must match the pattern: ->"+n.expectedPattern.toString()+"<-";return t},buildEmptyAlternationError:function(n){var e="Ambiguous empty alternative: <"+(n.emptyChoiceIdx+1)+">"+(" in <OR"+n.alternation.idx+"> inside <"+n.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return e},buildTooManyAlternativesError:function(n){var e=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+n.alternation.idx+"> inside <"+n.topLevelRule.name+`> Rule.
 has `+(n.alternation.definition.length+1)+" alternatives.");return e},buildLeftRecursionError:function(n){var e=n.topLevelRule.name,t=Fe(n.leftRecursionPath,function(s){return s.name}),r=e+" --> "+t.concat([e]).join(" --> "),i=`Left Recursion found in grammar.
`+("rule: <"+e+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+r+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return i},buildInvalidRuleNameError:function(n){var e=n.topLevelRule.name,t=n.expectedPattern.toString(),r="Invalid grammar rule name: ->"+e+"<- it must match the pattern: ->"+t+"<-";return r},buildDuplicateRuleNameError:function(n){var e;n.topLevelRule instanceof Sc?e=n.topLevelRule.name:e=n.topLevelRule;var t="Duplicate definition, rule: ->"+e+"<- is already defined in the grammar: ->"+n.grammarName+"<-";return t}},hoe=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();function doe(n,e){var t=new foe(n,e);return t.resolveRefs(),t.errors}var foe=function(n){hoe(e,n);function e(t,r){var i=n.call(this)||this;return i.nameToTopRule=t,i.errMsgProvider=r,i.errors=[],i}return e.prototype.resolveRefs=function(){var t=this;qe(Sr(this.nameToTopRule),function(r){t.currTopLevel=r,r.accept(t)})},e.prototype.visitNonTerminal=function(t){var r=this.nameToTopRule[t.nonTerminalName];if(r)t.referencedRule=r;else{var i=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:i,type:nr.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},e}(Il);function moe(n){n=M1(n,{errMsgProvider:coe});var e={};return qe(n.rules,function(t){e[t.name]=t}),doe(e,n.errMsgProvider)}function poe(n){return n=M1(n,{errMsgProvider:XE,ignoredIssues:{}}),zse(n.rules,n.maxLookahead,n.tokenTypes,n.ignoredIssues,n.errMsgProvider,n.grammarName)}var QN="MismatchedTokenException",ZN="NoViableAltException",JN="EarlyExitException",eI="NotAllInputParsedException",tI=[QN,ZN,JN,eI];Object.freeze(tI);function Fp(n){return jn(tI,n.name)}function QE(n,e,t){this.name=QN,this.message=n,this.token=e,this.previousToken=t,this.resyncedTokens=[]}QE.prototype=Error.prototype;function nI(n,e,t){this.name=ZN,this.message=n,this.token=e,this.previousToken=t,this.resyncedTokens=[]}nI.prototype=Error.prototype;function rI(n,e){this.name=eI,this.message=n,this.token=e,this.resyncedTokens=[]}rI.prototype=Error.prototype;function iI(n,e,t){this.name=JN,this.message=n,this.token=e,this.previousToken=t,this.resyncedTokens=[]}iI.prototype=Error.prototype;var O6={},sI="InRuleRecoveryException";function oI(n){this.name=sI,this.message=n}oI.prototype=Error.prototype;var goe=function(){function n(){}return n.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Ke(e,"recoveryEnabled")?e.recoveryEnabled:Kr.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=yoe)},n.prototype.getTokenToInsert=function(e){var t=GE(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},n.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},n.prototype.tryInRepetitionRecovery=function(e,t,r,i){for(var s=this,o=this.findReSyncTokenType(),a=this.exportLexerState(),l=[],u=!1,c=this.LA(1),h=this.LA(1),d=function(){var f=s.LA(0),m=s.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:c,previous:f,ruleName:s.getCurrRuleFullName()}),p=new QE(m,c,s.LA(0));p.resyncedTokens=rd(l),s.SAVE_ERROR(p)};!u;)if(this.tokenMatcher(h,i)){d();return}else if(r.call(this)){d(),e.apply(this,t);return}else this.tokenMatcher(h,o)?u=!0:(h=this.SKIP_TOKEN(),this.addToResyncTokens(h,l));this.importLexerState(a)},n.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,r){return!(r===!1||e===void 0||t===void 0||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))},n.prototype.getFollowsForInRuleRecovery=function(e,t){var r=this.getCurrentGrammarPath(e,t),i=this.getNextPossibleTokenTypes(r);return i},n.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t)){var r=this.getTokenToInsert(e);return r}if(this.canRecoverWithSingleTokenDeletion(e)){var i=this.SKIP_TOKEN();return this.consumeToken(),i}throw new oI("sad sad panda")},n.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},n.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(e)||$t(t))return!1;var i=this.LA(1),s=Ju(t,function(o){return r.tokenMatcher(i,o)})!==void 0;return s},n.prototype.canRecoverWithSingleTokenDeletion=function(e){var t=this.tokenMatcher(this.LA(2),e);return t},n.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(t);return jn(r,e)},n.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),r=2;;){var i=t.tokenType;if(jn(e,i))return i;t=this.LA(r),r++}},n.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return O6;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}},n.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return $t(this.LAST_EXPLICIT_RULE_STACK)||(t=Fe(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_STACK[i]}),r=Fe(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_OCCURRENCE_STACK[i]})),Fe(t,function(i,s){return s===0?O6:{ruleName:e.shortRuleNameToFullName(i),idxInCallingRule:r[s],inRule:e.shortRuleNameToFullName(t[s-1])}})},n.prototype.flattenFollowSet=function(){var e=this,t=Fe(this.buildFullFollowKeyStack(),function(r){return e.getFollowSetFromFollowKey(r)});return Jr(t)},n.prototype.getFollowSetFromFollowKey=function(e){if(e===O6)return[dl];var t=e.ruleName+e.idxInCallingRule+BN+e.inRule;return this.resyncFollows[t]},n.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,dl)||t.push(e),t},n.prototype.reSyncTo=function(e){for(var t=[],r=this.LA(1);this.tokenMatcher(r,e)===!1;)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return rd(t)},n.prototype.attemptInRepetitionRecovery=function(e,t,r,i,s,o,a){},n.prototype.getCurrentGrammarPath=function(e,t){var r=this.getHumanReadableRuleStack(),i=ei(this.RULE_OCCURRENCE_STACK),s={ruleStack:r,occurrenceStack:i,lastTok:e,lastTokOccurrence:t};return s},n.prototype.getHumanReadableRuleStack=function(){var e=this;return $t(this.LAST_EXPLICIT_RULE_STACK)?Fe(this.RULE_STACK,function(t){return e.shortRuleNameToFullName(t)}):Fe(this.LAST_EXPLICIT_RULE_STACK,function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])})},n}();function yoe(n,e,t,r,i,s,o){var a=this.getKeyForAutomaticLookahead(r,i),l=this.firstAfterRepMap[a];if(l===void 0){var u=this.getCurrRuleFullName(),c=this.getGAstProductions()[u],h=new s(c,i);l=h.startWalking(),this.firstAfterRepMap[a]=l}var d=l.token,f=l.occurrence,m=l.isEndOfRule;this.RULE_STACK.length===1&&m&&d===void 0&&(d=dl,f=1),this.shouldInRepetitionRecoveryBeTried(d,f,o)&&this.tryInRepetitionRecovery(n,e,t,d)}var woe=function(){function n(){}return n.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=Ke(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:Kr.dynamicTokensEnabled,this.maxLookahead=Ke(e,"maxLookahead")?e.maxLookahead:Kr.maxLookahead,this.lookAheadFuncsCache=WT()?new Map:[],WT()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},n.prototype.preComputeLookaheadFunctions=function(e){var t=this;qe(e,function(r){t.TRACE_INIT(r.name+" Rule Lookahead",function(){var i=wse(r),s=i.alternation,o=i.repetition,a=i.option,l=i.repetitionMandatory,u=i.repetitionMandatoryWithSeparator,c=i.repetitionWithSeparator;qe(s,function(h){var d=h.idx===0?"":h.idx;t.TRACE_INIT(""+qi(h)+d,function(){var f=Hse(h.idx,r,h.maxLookahead||t.maxLookahead,h.hasPredicates,t.dynamicTokensEnabled,t.lookAheadBuilderForAlternatives),m=Ah(t.fullRuleNameToShort[r.name],Du,h.idx);t.setLaFuncCache(m,f)})}),qe(o,function(h){t.computeLookaheadFunc(r,h.idx,Sh,zt.REPETITION,h.maxLookahead,qi(h))}),qe(a,function(h){t.computeLookaheadFunc(r,h.idx,kp,zt.OPTION,h.maxLookahead,qi(h))}),qe(l,function(h){t.computeLookaheadFunc(r,h.idx,Rh,zt.REPETITION_MANDATORY,h.maxLookahead,qi(h))}),qe(u,function(h){t.computeLookaheadFunc(r,h.idx,Au,zt.REPETITION_MANDATORY_WITH_SEPARATOR,h.maxLookahead,qi(h))}),qe(c,function(h){t.computeLookaheadFunc(r,h.idx,Th,zt.REPETITION_WITH_SEPARATOR,h.maxLookahead,qi(h))})})})},n.prototype.computeLookaheadFunc=function(e,t,r,i,s,o){var a=this;this.TRACE_INIT(""+o+(t===0?"":t),function(){var l=Use(t,e,s||a.maxLookahead,a.dynamicTokensEnabled,i,a.lookAheadBuilderForOptional),u=Ah(a.fullRuleNameToShort[e.name],r,t);a.setLaFuncCache(u,l)})},n.prototype.lookAheadBuilderForOptional=function(e,t,r){return Vse(e,t,r)},n.prototype.lookAheadBuilderForAlternatives=function(e,t,r,i){return Bse(e,t,r,i)},n.prototype.getKeyForAutomaticLookahead=function(e,t){var r=this.getLastExplicitRuleShortName();return Ah(r,e,t)},n.prototype.getLaFuncFromCache=function(e){},n.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},n.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},n.prototype.setLaFuncCache=function(e,t){},n.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},n.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},n}();function voe(n){return L1(n.constructor)}var Coe=/^\s*function\s*(\S*)\s*\(/,c4="name";function L1(n){var e=n.name;if(e)return e;var t=n.toString().match(Coe)[1];return t}function aI(n,e){var t=Object.getOwnPropertyDescriptor(n,c4);return Pi(t)||t.configurable?(Object.defineProperty(n,c4,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0):!1}function Eoe(n,e){for(var t=Ao(n),r=t.length,i=0;i<r;i++)for(var s=t[i],o=n[s],a=o.length,l=0;l<a;l++){var u=o[l];u.tokenTypeIdx===void 0&&(u.fullName!==void 0?this[u.fullName](u.children,e):this[u.name](u.children,e))}}function boe(n,e){var t=function(){};aI(t,n+"BaseSemantics");var r={visit:function(i,s){if(Ji(i)&&(i=i[0]),!Pi(i))return i.fullName!==void 0?this[i.fullName](i.children,s):this[i.name](i.children,s)},validateVisitor:function(){var i=Roe(this,e);if(!$t(i)){var s=Fe(i,function(o){return o.msg});throw Error("Errors Detected in CST Visitor <"+L1(this.constructor)+`>:
	`+(""+s.join(`

`).replace(/\n/g,`
	`)))}}};return t.prototype=r,t.prototype.constructor=t,t._RULE_NAMES=e,t}function Soe(n,e,t){var r=function(){};aI(r,n+"BaseSemanticsWithDefaults");var i=Object.create(t.prototype);return qe(e,function(s){i[s]=Eoe}),r.prototype=i,r.prototype.constructor=r,r}var Hp;(function(n){n[n.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",n[n.MISSING_METHOD=1]="MISSING_METHOD"})(Hp||(Hp={}));function Roe(n,e){var t=Toe(n,e),r=xoe(n,e);return t.concat(r)}function Toe(n,e){var t=Fe(e,function(r){if(!ma(n[r]))return{msg:"Missing visitor method: <"+r+"> on "+L1(n.constructor)+" CST Visitor.",type:Hp.MISSING_METHOD,methodName:r}});return Kd(t)}var Aoe=["constructor","visit","validateVisitor"];function xoe(n,e){var t=[];for(var r in n)fl.test(r)&&ma(n[r])&&!jn(Aoe,r)&&!jn(e,r)&&t.push({msg:"Redundant visitor method: <"+r+"> on "+L1(n.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`+("For utility methods on visitor classes use methods names that do not match /"+fl.source+"/."),type:Hp.REDUNDANT_METHOD,methodName:r});return t}var Moe=function(){function n(){}return n.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=Ke(e,"outputCst")?e.outputCst:Kr.outputCst,this.nodeLocationTracking=Ke(e,"nodeLocationTracking")?e.nodeLocationTracking:Kr.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=qn,this.cstFinallyStateUpdate=qn,this.cstPostTerminal=qn,this.cstPostNonTerminal=qn,this.cstPostRule=qn,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=s4,this.setNodeLocationFromNode=s4,this.cstPostRule=qn,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=qn,this.setNodeLocationFromNode=qn,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=i4,this.setNodeLocationFromNode=i4,this.cstPostRule=qn,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=qn,this.setNodeLocationFromNode=qn,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=qn,this.setNodeLocationFromNode=qn,this.cstPostRule=qn,this.setInitialNodeLocation=qn;else throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"')},n.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},n.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},n.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},n.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},n.prototype.cstNestedInvocationStateUpdate=function(e,t){var r={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},n.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var r={name:e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},n.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},n.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},n.prototype.cstPostRuleFull=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset?(r.endOffset=t.endOffset,r.endLine=t.endLine,r.endColumn=t.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},n.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset?r.endOffset=t.endOffset:r.startOffset=NaN},n.prototype.cstPostTerminal=function(e,t){var r=this.CST_STACK[this.CST_STACK.length-1];Ise(r,t,e),this.setNodeLocationFromToken(r.location,t)},n.prototype.cstPostNonTerminal=function(e,t){if(this.isBackTracking()!==!0){var r=this.CST_STACK[this.CST_STACK.length-1];o4(r,t,e),this.setNodeLocationFromNode(r.location,e.location)}},n.prototype.getBaseCstVisitorConstructor=function(){if(Pi(this.baseCstVisitorConstructor)){var e=boe(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},n.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(Pi(this.baseCstVisitorWithDefaultsConstructor)){var e=Soe(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},n.prototype.nestedRuleBeforeClause=function(e,t){var r;if(e.NAME!==void 0)return r=e.NAME,this.nestedRuleInvocationStateUpdate(r,t),r},n.prototype.nestedAltBeforeClause=function(e,t,r,i){var s=this.getLastExplicitRuleShortName(),o=VN(s,r,t,i),a;if(e.NAME!==void 0)return a=e.NAME,this.nestedRuleInvocationStateUpdate(a,o),{shortName:o,nestedName:a}},n.prototype.nestedRuleFinallyClause=function(e,t){var r=this.CST_STACK,i=r[r.length-1];this.nestedRuleFinallyStateUpdate();var s=r[r.length-1];o4(s,t,i),this.setNodeLocationFromNode(s.location,i.location)},n.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},n.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},n.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},n.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},n.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},n.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},n.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},n.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},n}(),Noe=function(){function n(){}return n.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(n.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),n.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):Bp},n.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?Bp:this.tokVector[t]},n.prototype.consumeToken=function(){this.currIdx++},n.prototype.exportLexerState=function(){return this.currIdx},n.prototype.importLexerState=function(e){this.currIdx=e},n.prototype.resetLexerState=function(){this.currIdx=-1},n.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},n.prototype.getLexerPosition=function(){return this.exportLexerState()},n}(),Ioe=function(){function n(){}return n.prototype.ACTION=function(e){return e.call(this)},n.prototype.consume=function(e,t,r){return this.consumeInternal(t,e,r)},n.prototype.subrule=function(e,t,r){return this.subruleInternal(t,e,r)},n.prototype.option=function(e,t){return this.optionInternal(t,e)},n.prototype.or=function(e,t){return this.orInternal(t,e)},n.prototype.many=function(e,t){return this.manyInternal(e,t)},n.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},n.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},n.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},n.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},n.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},n.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},n.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},n.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},n.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},n.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},n.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},n.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},n.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},n.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},n.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},n.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},n.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},n.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},n.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},n.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},n.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},n.prototype.OPTION=function(e){return this.optionInternal(e,0)},n.prototype.OPTION1=function(e){return this.optionInternal(e,1)},n.prototype.OPTION2=function(e){return this.optionInternal(e,2)},n.prototype.OPTION3=function(e){return this.optionInternal(e,3)},n.prototype.OPTION4=function(e){return this.optionInternal(e,4)},n.prototype.OPTION5=function(e){return this.optionInternal(e,5)},n.prototype.OPTION6=function(e){return this.optionInternal(e,6)},n.prototype.OPTION7=function(e){return this.optionInternal(e,7)},n.prototype.OPTION8=function(e){return this.optionInternal(e,8)},n.prototype.OPTION9=function(e){return this.optionInternal(e,9)},n.prototype.OR=function(e){return this.orInternal(e,0)},n.prototype.OR1=function(e){return this.orInternal(e,1)},n.prototype.OR2=function(e){return this.orInternal(e,2)},n.prototype.OR3=function(e){return this.orInternal(e,3)},n.prototype.OR4=function(e){return this.orInternal(e,4)},n.prototype.OR5=function(e){return this.orInternal(e,5)},n.prototype.OR6=function(e){return this.orInternal(e,6)},n.prototype.OR7=function(e){return this.orInternal(e,7)},n.prototype.OR8=function(e){return this.orInternal(e,8)},n.prototype.OR9=function(e){return this.orInternal(e,9)},n.prototype.MANY=function(e){this.manyInternal(0,e)},n.prototype.MANY1=function(e){this.manyInternal(1,e)},n.prototype.MANY2=function(e){this.manyInternal(2,e)},n.prototype.MANY3=function(e){this.manyInternal(3,e)},n.prototype.MANY4=function(e){this.manyInternal(4,e)},n.prototype.MANY5=function(e){this.manyInternal(5,e)},n.prototype.MANY6=function(e){this.manyInternal(6,e)},n.prototype.MANY7=function(e){this.manyInternal(7,e)},n.prototype.MANY8=function(e){this.manyInternal(8,e)},n.prototype.MANY9=function(e){this.manyInternal(9,e)},n.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},n.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},n.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},n.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},n.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},n.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},n.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},n.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},n.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},n.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},n.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},n.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},n.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},n.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},n.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},n.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},n.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},n.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},n.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},n.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},n.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},n.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},n.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},n.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},n.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},n.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},n.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},n.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},n.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},n.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},n.prototype.RULE=function(e,t,r){if(r===void 0&&(r=Vp),jn(this.definedRulesNames,e)){var i=XE.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),s={message:i,type:nr.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(s)}this.definedRulesNames.push(e);var o=this.defineRule(e,t,r);return this[e]=o,o},n.prototype.OVERRIDE_RULE=function(e,t,r){r===void 0&&(r=Vp);var i=[];i=i.concat(eoe(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,i);var s=this.defineRule(e,t,r);return this[e]=s,s},n.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return e.apply(this,t),!0}catch(i){if(Fp(i))return!1;throw i}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},n.prototype.getGAstProductions=function(){return this.gastProductionsCache},n.prototype.getSerializedGastProductions=function(){return fse(Sr(this.gastProductionsCache))},n}(),Ooe=function(){function n(){}return n.prototype.initRecognizerEngine=function(e,t){if(this.className=voe(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=Pp,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Ke(t,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(Ji(e)){if($t(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(Ji(e))this.tokensMap=pr(e,function(o,a){return o[a.name]=a,o},{});else if(Ke(e,"modes")&&Ii(Jr(Sr(e.modes)),use)){var r=Jr(Sr(e.modes)),i=BE(r);this.tokensMap=pr(i,function(o,a){return o[a.name]=a,o},{})}else if(VE(e))this.tokensMap=jd(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=dl;var s=Ii(Sr(e),function(o){return $t(o.categoryMatches)});this.tokenMatcher=s?Pp:I1,qd(Sr(this.tokensMap))},n.prototype.defineRule=function(e,t,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var i=Ke(r,"resyncEnabled")?r.resyncEnabled:Vp.resyncEnabled,s=Ke(r,"recoveryValueFunc")?r.recoveryValueFunc:Vp.recoveryValueFunc,o=this.ruleShortNameIdx<<Ase+pa;this.ruleShortNameIdx++,this.shortRuleNameToFull[o]=e,this.fullRuleNameToShort[e]=o;function a(c){try{if(this.outputCst===!0){t.apply(this,c);var h=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(h),h}else return t.apply(this,c)}catch(d){return this.invokeRuleCatch(d,i,s)}finally{this.ruleFinallyStateUpdate()}}var l;l=function(c,h){return c===void 0&&(c=0),this.ruleInvocationStateUpdate(o,e,c),a.call(this,h)};var u="ruleName";return l[u]=e,l.originalGrammarAction=t,l},n.prototype.invokeRuleCatch=function(e,t,r){var i=this.RULE_STACK.length===1,s=t&&!this.isBackTracking()&&this.recoveryEnabled;if(Fp(e)){var o=e;if(s){var a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a))if(o.resyncedTokens=this.reSyncTo(a),this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];return l.recoveredNode=!0,l}else return r();else{if(this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];l.recoveredNode=!0,o.partialCstResult=l}throw o}}else{if(i)return this.moveToTerminatedState(),r();throw o}}else throw e},n.prototype.optionInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(kp,t),i=this.nestedRuleBeforeClause(e,r);try{return this.optionInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.optionInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(kp,t);return this.optionInternalLogic(e,t,r)},n.prototype.optionInternalLogic=function(e,t,r){var i=this,s=this.getLaFuncFromCache(r),o,a;if(e.DEF!==void 0){if(o=e.DEF,a=e.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=e;if(s.call(this)===!0)return o.call(this)},n.prototype.atLeastOneInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Rh,e),i=this.nestedRuleBeforeClause(t,r);try{return this.atLeastOneInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.atLeastOneInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Rh,e);this.atLeastOneInternalLogic(e,t,r)},n.prototype.atLeastOneInternalLogic=function(e,t,r){var i=this,s=this.getLaFuncFromCache(r),o,a;if(t.DEF!==void 0){if(o=t.DEF,a=t.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=t;if(s.call(this)===!0)for(var u=this.doSingleRepetition(o);s.call(this)===!0&&u===!0;)u=this.doSingleRepetition(o);else throw this.raiseEarlyExitException(e,zt.REPETITION_MANDATORY,t.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],s,Rh,e,Dse)},n.prototype.atLeastOneSepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Au,e),i=this.nestedRuleBeforeClause(t,r);try{this.atLeastOneSepFirstInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Au,e);this.atLeastOneSepFirstInternalLogic(e,t,r)},n.prototype.atLeastOneSepFirstInternalLogic=function(e,t,r){var i=this,s=t.DEF,o=t.SEP,a=this.getLaFuncFromCache(r);if(a.call(this)===!0){s.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),o)};this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,l,s,l4],l,Au,e,l4)}else throw this.raiseEarlyExitException(e,zt.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG)},n.prototype.manyInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Sh,e),i=this.nestedRuleBeforeClause(t,r);try{return this.manyInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.manyInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Sh,e);return this.manyInternalLogic(e,t,r)},n.prototype.manyInternalLogic=function(e,t,r){var i=this,s=this.getLaFuncFromCache(r),o,a;if(t.DEF!==void 0){if(o=t.DEF,a=t.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=t;for(var u=!0;s.call(this)===!0&&u===!0;)u=this.doSingleRepetition(o);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],s,Sh,e,Pse,u)},n.prototype.manySepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Th,e),i=this.nestedRuleBeforeClause(t,r);try{this.manySepFirstInternalLogic(e,t,r)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.manySepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Th,e);this.manySepFirstInternalLogic(e,t,r)},n.prototype.manySepFirstInternalLogic=function(e,t,r){var i=this,s=t.DEF,o=t.SEP,a=this.getLaFuncFromCache(r);if(a.call(this)===!0){s.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),o)};this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,l,s,a4],l,Th,e,a4)}},n.prototype.repetitionSepSecondInternal=function(e,t,r,i,s){for(;r();)this.CONSUME(t),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,i,s],r,Au,e,s)},n.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();e.call(this);var r=this.getLexerPosition();return r>t},n.prototype.orInternalNoCst=function(e,t){var r=Ji(e)?e:e.DEF,i=this.getKeyForAutomaticLookahead(Du,t),s=this.getLaFuncFromCache(i),o=s.call(this,r);if(o!==void 0){var a=r[o];return a.ALT.call(this)}this.raiseNoAltException(t,e.ERR_MSG)},n.prototype.orInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Du,t),i=this.nestedRuleBeforeClause(e,r);try{var s=Ji(e)?e:e.DEF,o=this.getLaFuncFromCache(r),a=o.call(this,s);if(a!==void 0){var l=s[a],u=this.nestedAltBeforeClause(l,t,Du,a);try{return l.ALT.call(this)}finally{u!==void 0&&this.nestedRuleFinallyClause(u.shortName,u.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{i!==void 0&&this.nestedRuleFinallyClause(r,i)}},n.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new rI(t,e))}},n.prototype.subruleInternal=function(e,t,r){var i;try{var s=r!==void 0?r.ARGS:void 0;return i=e.call(this,t,s),this.cstPostNonTerminal(i,r!==void 0&&r.LABEL!==void 0?r.LABEL:e.ruleName),i}catch(o){this.subruleInternalError(o,r,e.ruleName)}},n.prototype.subruleInternalError=function(e,t,r){throw Fp(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,t!==void 0&&t.LABEL!==void 0?t.LABEL:r),delete e.partialCstResult),e},n.prototype.consumeInternal=function(e,t,r){var i;try{var s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),i=s):this.consumeInternalError(e,s,r)}catch(o){i=this.consumeInternalRecovery(e,t,o)}return this.cstPostTerminal(r!==void 0&&r.LABEL!==void 0?r.LABEL:e.name,i),i},n.prototype.consumeInternalError=function(e,t,r){var i,s=this.LA(0);throw r!==void 0&&r.ERR_MSG?i=r.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new QE(i,t,s))},n.prototype.consumeInternalRecovery=function(e,t,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.isBackTracking()){var i=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,i)}catch(s){throw s.name===sI?r:s}}else throw r},n.prototype.saveRecogState=function(){var e=this.errors,t=ei(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},n.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},n.prototype.ruleInvocationStateUpdate=function(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},n.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},n.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},n.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},n.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),dl)},n.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},n}(),_oe=function(){function n(){}return n.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=M1(e.errorMessageProvider,Kr.errorMessageProvider)},n.prototype.SAVE_ERROR=function(e){if(Fp(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:ei(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(n.prototype,"errors",{get:function(){return ei(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),n.prototype.raiseEarlyExitException=function(e,t,r){for(var i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],o=jE(e,s,t,this.maxLookahead),a=o[0],l=[],u=1;u<=this.maxLookahead;u++)l.push(this.LA(u));var c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:a,actual:l,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new iI(c,this.LA(1),this.LA(0)))},n.prototype.raiseNoAltException=function(e,t){for(var r=this.getCurrRuleFullName(),i=this.getGAstProductions()[r],s=YE(e,i,this.maxLookahead),o=[],a=1;a<=this.maxLookahead;a++)o.push(this.LA(a));var l=this.LA(0),u=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:o,previous:l,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new nI(u,this.LA(1),l))},n}(),Loe=function(){function n(){}return n.prototype.initContentAssist=function(){},n.prototype.computeContentAssist=function(e,t){var r=this.gastProductionsCache[e];if(Pi(r))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return $N([r],t,this.tokenMatcher,this.maxLookahead)},n.prototype.getNextPossibleTokenTypes=function(e){var t=Li(e.ruleStack),r=this.getGAstProductions(),i=r[t],s=new Lse(i,e).startWalking();return s},n}(),P1={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(P1);var h4=!0,d4=Math.pow(2,pa)-1,lI=Et({name:"RECORDING_PHASE_TOKEN",pattern:Zr.NA});qd([lI]);var uI=GE(lI,`This IToken indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(uI);var Poe={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,children:{}},Doe=function(){function n(){}return n.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},n.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var t=function(i){var s=i>0?i:"";e["CONSUME"+s]=function(o,a){return this.consumeInternalRecord(o,i,a)},e["SUBRULE"+s]=function(o,a){return this.subruleInternalRecord(o,i,a)},e["OPTION"+s]=function(o){return this.optionInternalRecord(o,i)},e["OR"+s]=function(o){return this.orInternalRecord(o,i)},e["MANY"+s]=function(o){this.manyInternalRecord(i,o)},e["MANY_SEP"+s]=function(o){this.manySepFirstInternalRecord(i,o)},e["AT_LEAST_ONE"+s]=function(o){this.atLeastOneInternalRecord(i,o)},e["AT_LEAST_ONE_SEP"+s]=function(o){this.atLeastOneSepFirstInternalRecord(i,o)}},r=0;r<10;r++)t(r);e.consume=function(i,s,o){return this.consumeInternalRecord(s,i,o)},e.subrule=function(i,s,o){return this.subruleInternalRecord(s,i,o)},e.option=function(i,s){return this.optionInternalRecord(s,i)},e.or=function(i,s){return this.orInternalRecord(s,i)},e.many=function(i,s){this.manyInternalRecord(i,s)},e.atLeastOne=function(i,s){this.atLeastOneInternalRecord(i,s)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},n.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var t=0;t<10;t++){var r=t>0?t:"";delete e["CONSUME"+r],delete e["SUBRULE"+r],delete e["OPTION"+r],delete e["OR"+r],delete e["MANY"+r],delete e["MANY_SEP"+r],delete e["AT_LEAST_ONE"+r],delete e["AT_LEAST_ONE_SEP"+r]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})},n.prototype.ACTION_RECORD=function(e){},n.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},n.prototype.LA_RECORD=function(e){return Bp},n.prototype.topLevelRuleRecord=function(e,t){try{var r=new Sc({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(i){if(i.KNOWN_RECORDER_ERROR!==!0)try{i.message=i.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording`}catch{throw i}throw i}},n.prototype.optionInternalRecord=function(e,t){return Kc.call(this,fr,e,t)},n.prototype.atLeastOneInternalRecord=function(e,t){Kc.call(this,Di,t,e)},n.prototype.atLeastOneSepFirstInternalRecord=function(e,t){Kc.call(this,ki,t,e,h4)},n.prototype.manyInternalRecord=function(e,t){Kc.call(this,Nn,t,e)},n.prototype.manySepFirstInternalRecord=function(e,t){Kc.call(this,fi,t,e,h4)},n.prototype.orInternalRecord=function(e,t){return koe.call(this,e,t)},n.prototype.subruleInternalRecord=function(e,t,r){if(Up(t),!e||Ke(e,"ruleName")===!1){var i=new Error("<SUBRULE"+f4(t)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var s=_p(this.recordingProdStack),o=e.ruleName,a=new di({idx:t,nonTerminalName:o,referencedRule:void 0});return s.definition.push(a),this.outputCst?Poe:P1},n.prototype.consumeInternalRecord=function(e,t,r){if(Up(t),!HN(e)){var i=new Error("<CONSUME"+f4(t)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var s=_p(this.recordingProdStack),o=new hn({idx:t,terminalType:e});return s.definition.push(o),uI},n}();function Kc(n,e,t,r){r===void 0&&(r=!1),Up(t);var i=_p(this.recordingProdStack),s=ma(e)?e:e.DEF,o=new n({definition:[],idx:t});return Ke(e,"NAME")&&(o.name=e.NAME),r&&(o.separator=e.SEP),Ke(e,"MAX_LOOKAHEAD")&&(o.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(o),s.call(this),i.definition.push(o),this.recordingProdStack.pop(),P1}function koe(n,e){var t=this;Up(e);var r=_p(this.recordingProdStack),i=Ji(n)===!1,s=i===!1?n:n.DEF,o=new mi({definition:[],idx:e,ignoreAmbiguities:i&&n.IGNORE_AMBIGUITIES===!0});Ke(n,"NAME")&&(o.name=n.NAME),Ke(n,"MAX_LOOKAHEAD")&&(o.maxLookahead=n.MAX_LOOKAHEAD);var a=AN(s,function(l){return ma(l.GATE)});return o.hasPredicates=a,r.definition.push(o),qe(s,function(l){var u=new ti({definition:[]});o.definition.push(u),Ke(l,"NAME")&&(u.name=l.NAME),Ke(l,"IGNORE_AMBIGUITIES")?u.ignoreAmbiguities=l.IGNORE_AMBIGUITIES:Ke(l,"GATE")&&(u.ignoreAmbiguities=!0),t.recordingProdStack.push(u),l.ALT.call(t),t.recordingProdStack.pop()}),P1}function f4(n){return n===0?"":""+n}function Up(n){if(n<0||n>d4){var e=new Error("Invalid DSL Method idx value: <"+n+`>
	`+("Idx value must be a none negative value smaller than "+(d4+1)));throw e.KNOWN_RECORDER_ERROR=!0,e}}var Foe=function(){function n(){}return n.prototype.initPerformanceTracer=function(e){if(Ke(e,"traceInitPerf")){var t=e.traceInitPerf,r=typeof t=="number";this.traceInitMaxIdent=r?t:1/0,this.traceInitPerf=r?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=Kr.traceInitPerf;this.traceInitIndent=-1},n.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+e+">");var i=NN(t),s=i.time,o=i.value,a=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(r+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,o}else return t()},n}(),cI=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Bp=GE(dl,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(Bp);var Kr=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:XN,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),Vp=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),nr;(function(n){n[n.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",n[n.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",n[n.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",n[n.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",n[n.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",n[n.LEFT_RECURSION=5]="LEFT_RECURSION",n[n.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",n[n.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",n[n.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",n[n.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",n[n.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",n[n.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",n[n.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",n[n.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",n[n.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"})(nr||(nr={}));function Hoe(n){return n===void 0&&(n=void 0),function(){return n}}var ZE=function(){function n(e,t){t===void 0&&(t=Kr),this.ignoredIssues=Kr.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var r=this;r.initErrorHandler(t),r.initLexerAdapter(),r.initLooksAhead(t),r.initRecognizerEngine(e,t),r.initRecoverable(t),r.initTreeBuilder(t),r.initContentAssist(),r.initGastRecorder(t),r.initPerformanceTracer(t),Ke(t,"ignoredIssues")&&t.ignoredIssues!==Kr.ignoredIssues&&$E(`The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.`),this.ignoredIssues=Ke(t,"ignoredIssues")?t.ignoredIssues:Kr.ignoredIssues,this.skipValidations=Ke(t,"skipValidations")?t.skipValidations:Kr.skipValidations}return n.performSelfAnalysis=function(e){e.performSelfAnalysis()},n.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",function(){var t;e.selfAnalysisDone=!0;var r=e.className;e.TRACE_INIT("toFastProps",function(){MN(e)}),e.TRACE_INIT("Grammar Recording",function(){try{e.enableRecording(),qe(e.definedRulesNames,function(s){var o=e[s],a=o.originalGrammarAction,l=void 0;e.TRACE_INIT(s+" Rule",function(){l=e.topLevelRuleRecord(s,a)}),e.gastProductionsCache[s]=l})}finally{e.disableRecording()}});var i=[];if(e.TRACE_INIT("Grammar Resolving",function(){i=moe({rules:Sr(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,i)}),e.TRACE_INIT("Grammar Validations",function(){if($t(i)&&e.skipValidations===!1){var s=poe({rules:Sr(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:Sr(e.tokensMap),ignoredIssues:e.ignoredIssues,errMsgProvider:XE,grammarName:r});e.definitionErrors.push.apply(e.definitionErrors,s)}}),$t(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",function(){var s=Rse(Sr(e.gastProductionsCache));e.resyncFollows=s}),e.TRACE_INIT("ComputeLookaheadFunctions",function(){e.preComputeLookaheadFunctions(Sr(e.gastProductionsCache))})),e.TRACE_INIT("expandAllNestedRuleNames",function(){var s=Ose(Sr(e.gastProductionsCache),e.fullRuleNameToShort);e.allRuleNames=s.allRuleNames}),!n.DEFER_DEFINITION_ERRORS_HANDLING&&!$t(e.definitionErrors))throw t=Fe(e.definitionErrors,function(s){return s.message}),new Error(`Parser Definition Errors detected:
 `+t.join(`
-------------------------------
`))})},n.DEFER_DEFINITION_ERRORS_HANDLING=!1,n}();Aie(ZE,[goe,woe,Moe,Noe,Ooe,Ioe,_oe,Loe,Doe,Foe]);(function(n){cI(e,n);function e(t,r){r===void 0&&(r=Kr);var i=this,s=jd(r);return s.outputCst=!0,i=n.call(this,t,s)||this,i}return e})(ZE);var Uoe=function(n){cI(e,n);function e(t,r){r===void 0&&(r=Kr);var i=this,s=jd(r);return s.outputCst=!1,i=n.call(this,t,s)||this,i}return e}(ZE);/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const m4=(n,e)=>({type:n,message:e});var Mn;(function(n){n.LexingError="LexingError",n.ParserError="ParsingError",n.StaticOffsetError="StaticOffsetError",n.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",n.RangeOffsetNotAllowed="RangeOffsetNotAllowed"})(Mn||(Mn={}));var W;(function(n){n.EMPTY="EMPTY",n.NUMBER="NUMBER",n.STRING="STRING",n.MINUS_UNARY_OP="MINUS_UNARY_OP",n.PLUS_UNARY_OP="PLUS_UNARY_OP",n.PERCENT_OP="PERCENT_OP",n.CONCATENATE_OP="CONCATENATE_OP",n.EQUALS_OP="EQUALS_OP",n.NOT_EQUAL_OP="NOT_EQUAL_OP",n.GREATER_THAN_OP="GREATER_THAN_OP",n.LESS_THAN_OP="LESS_THAN_OP",n.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",n.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",n.PLUS_OP="PLUS_OP",n.MINUS_OP="MINUS_OP",n.TIMES_OP="TIMES_OP",n.DIV_OP="DIV_OP",n.POWER_OP="POWER_OP",n.FUNCTION_CALL="FUNCTION_CALL",n.NAMED_EXPRESSION="NAMED_EXPRESSION",n.PARENTHESIS="PARENTHESES",n.CELL_REFERENCE="CELL_REFERENCE",n.CELL_RANGE="CELL_RANGE",n.COLUMN_RANGE="COLUMN_RANGE",n.ROW_RANGE="ROW_RANGE",n.ERROR="ERROR",n.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",n.ARRAY="ARRAY"})(W||(W={}));var xi;(function(n){n[n.RELATIVE=0]="RELATIVE",n[n.START_ABSOLUTE=1]="START_ABSOLUTE",n[n.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"})(xi||(xi={}));const Boe=n=>({type:W.EMPTY,leadingWhitespace:n==null?void 0:n.image}),Voe=(n,e)=>({type:W.NUMBER,value:n,leadingWhitespace:e==null?void 0:e.image}),$oe=n=>{var e;return{type:W.STRING,value:n.image.slice(1,-1),leadingWhitespace:(e=n.leadingWhitespace)===null||e===void 0?void 0:e.image}},p4=(n,e)=>({type:W.CELL_REFERENCE,reference:n,leadingWhitespace:e==null?void 0:e.image}),g4=(n,e,t,r)=>(JE(n,e,t),{type:W.CELL_RANGE,start:n,end:e,sheetReferenceType:t,leadingWhitespace:r}),Woe=(n,e,t,r)=>(JE(n,e,t),{type:W.COLUMN_RANGE,start:n,end:e,sheetReferenceType:t,leadingWhitespace:r==null?void 0:r.image}),Goe=(n,e,t,r)=>(JE(n,e,t),{type:W.ROW_RANGE,start:n,end:e,sheetReferenceType:t,leadingWhitespace:r==null?void 0:r.image}),zoe=(n,e,t)=>({type:W.CONCATENATE_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),Yoe=(n,e,t)=>({type:W.EQUALS_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),joe=(n,e,t)=>({type:W.NOT_EQUAL_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),Koe=(n,e,t)=>({type:W.GREATER_THAN_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),qoe=(n,e,t)=>({type:W.LESS_THAN_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),Xoe=(n,e,t)=>({type:W.GREATER_THAN_OR_EQUAL_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),Qoe=(n,e,t)=>({type:W.LESS_THAN_OR_EQUAL_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),Zoe=(n,e,t)=>({type:W.PLUS_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),Joe=(n,e,t)=>({type:W.MINUS_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),eae=(n,e,t)=>({type:W.TIMES_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),tae=(n,e,t)=>({type:W.DIV_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),nae=(n,e,t)=>({type:W.POWER_OP,left:n,right:e,leadingWhitespace:t==null?void 0:t.image}),rae=(n,e)=>({type:W.MINUS_UNARY_OP,value:n,leadingWhitespace:e==null?void 0:e.image}),iae=(n,e)=>({type:W.PLUS_UNARY_OP,value:n,leadingWhitespace:e==null?void 0:e.image}),sae=(n,e)=>({type:W.PERCENT_OP,value:n,leadingWhitespace:e==null?void 0:e.image}),oae=(n,e,t,r,i)=>({type:W.FUNCTION_CALL,procedureName:n,args:e,leadingWhitespace:t==null?void 0:t.image,internalWhitespace:r==null?void 0:r.image,hyperlink:i}),y4=(n,e,t)=>({type:W.ARRAY,args:n,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:t==null?void 0:t.image}),aae=(n,e)=>({type:W.NAMED_EXPRESSION,expressionName:n,leadingWhitespace:e==null?void 0:e.image}),lae=(n,e,t)=>({type:W.PARENTHESIS,expression:n,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:t==null?void 0:t.image}),Ts=(n,e)=>({type:W.ERROR,error:n,leadingWhitespace:e==null?void 0:e.image}),su=(n,e,t)=>({type:W.ERROR_WITH_RAW_INPUT,error:e,rawInput:n,leadingWhitespace:t==null?void 0:t.image}),fw=()=>({type:W.ERROR,error:D.parsingError()});function JE(n,e,t){if(n.sheet!==void 0&&e.sheet===void 0||n.sheet===void 0&&e.sheet!==void 0)throw new Error("Start address inconsistent with end address");if(n.sheet===void 0&&t!==xi.RELATIVE||n.sheet!==void 0&&t===xi.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function bt(n,e){return(e!=null?e:"")+n}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const hI={[W.PLUS_OP]:"+",[W.MINUS_OP]:"-",[W.TIMES_OP]:"*",[W.DIV_OP]:"/",[W.CONCATENATE_OP]:"&",[W.POWER_OP]:"^",[W.EQUALS_OP]:"=",[W.NOT_EQUAL_OP]:"<>",[W.GREATER_THAN_OP]:">",[W.GREATER_THAN_OR_EQUAL_OP]:">=",[W.LESS_THAN_OP]:"<",[W.LESS_THAN_OR_EQUAL_OP]:"<="};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const uae=(n,e,t,r)=>({ast:n,relativeDependencies:e,hasVolatileFunction:t,hasStructuralChangeFunction:r});class cae{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){const r=k1(t,this.functionRegistry),i=uae(t,r,Uo(t,this.functionRegistry.isFunctionVolatile),Uo(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,i),i}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){const r=this.cache.get(e);return r!==void 0?r.ast:(this.set(e,t),t)}}const Uo=(n,e)=>{switch(n.type){case W.EMPTY:case W.NUMBER:case W.STRING:case W.ERROR:case W.ERROR_WITH_RAW_INPUT:case W.CELL_REFERENCE:case W.CELL_RANGE:case W.COLUMN_RANGE:case W.ROW_RANGE:case W.NAMED_EXPRESSION:return!1;case W.PERCENT_OP:case W.PLUS_UNARY_OP:case W.MINUS_UNARY_OP:return Uo(n.value,e);case W.CONCATENATE_OP:case W.EQUALS_OP:case W.NOT_EQUAL_OP:case W.LESS_THAN_OP:case W.GREATER_THAN_OP:case W.LESS_THAN_OR_EQUAL_OP:case W.GREATER_THAN_OR_EQUAL_OP:case W.MINUS_OP:case W.PLUS_OP:case W.TIMES_OP:case W.DIV_OP:case W.POWER_OP:return Uo(n.left,e)||Uo(n.right,e);case W.PARENTHESIS:return Uo(n.expression,e);case W.FUNCTION_CALL:return e(n.procedureName)?!0:n.args.some(t=>Uo(t,e));case W.ARRAY:return n.args.some(t=>t.some(r=>Uo(r,e)))}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Q{}Q.DistinctSigns="Distinct signs.";Q.WrongArgNumber="Wrong number of arguments.";Q.EmptyArg="Empty function argument.";Q.EmptyArray="Empty array not allowed.";Q.ArrayDimensions="Array dimensions are not compatible.";Q.NoSpaceForArrayResult="No space for array result.";Q.ValueSmall="Value too small.";Q.ValueLarge="Value too large.";Q.BadCriterion="Incorrect criterion.";Q.RangeManySheets="Range spans more than one sheet.";Q.CellRangeExpected="Cell range expected.";Q.WrongDimension="Wrong range dimension.";Q.ScalarExpected="Cell range not allowed.";Q.NumberCoercion="Value cannot be coerced to number.";Q.NumberExpected="Number argument expected.";Q.IntegerExpected="Value needs to be an integer.";Q.BadMode="Mode not recognized.";Q.DateBounds="Date outside of bounds.";Q.OutOfSheet="Resulting reference is out of the sheet.";Q.WrongType="Wrong type of argument.";Q.NaN="NaN or infinite value encountered.";Q.EqualLength="Ranges need to be of equal length.";Q.Negative="Value cannot be negative.";Q.NotBinary="String does not represent a binary number.";Q.NotOctal="String does not represent an octal number.";Q.NotHex="String does not represent a hexadecimal number.";Q.EndStartPeriod="End period needs to be at least start period.";Q.CellRefExpected="Cell reference expected.";Q.EmptyRange="Empty range not allowed.";Q.BadRef="Address is not correct.";Q.NumberRange="Number-only range expected.";Q.ValueNotFound="Value not found.";Q.ValueBaseLarge="Value in base too large.";Q.ValueBaseSmall="Value in base too small.";Q.ValueBaseLong="Value in base too long.";Q.NegativeLength="Length cannot be negative.";Q.PatternNotFound="Pattern not found.";Q.OneValue="Needs at least one value.";Q.TwoValues="Range needs to contain at least two elements.";Q.ThreeValues="Range needs to contain at least three elements.";Q.IndexBounds="Index out of bounds.";Q.IndexLarge="Index too large.";Q.Formula="Expected formula.";Q.NegativeCount="Count cannot be negative.";Q.ParseError="Parsing error.";Q.SheetRef="Sheet does not exist.";Q.PeriodLong="Period number cannot exceed life length.";Q.InvalidDate="Invalid date.";Q.BitshiftLong="Result of bitshift is too long.";Q.EmptyString="Empty-string argument not allowed.";Q.LengthBounds="Length out of bounds.";Q.NegativeTime="Time cannot be negative.";Q.NoDefault="No default option.";Q.NoConditionMet="None of the conditions were met.";Q.Selector="Selector cannot exceed the number of arguments.";Q.StartEndDate="Start date needs to be earlier than end date.";Q.IncorrectDateTime="String does not represent correct DateTime.";Q.CharacterCodeBounds="Character code out of bounds.";Q.NonZero="Argument cannot be 0.";Q.LessThanOne="Argument cannot be less than 1.";Q.WeekendString="Incorrect weekend bitmask string.";Q.InvalidRoman="Invalid roman numeral.";Q.WrongOrder="Wrong order of values.";Q.ComplexNumberExpected="Complex number expected.";Q.ShouldBeIorJ="Should be 'i' or 'j'.";Q.SizeMismatch="Array dimensions mismatched.";Q.FunctionName=n=>`Function name ${n} not recognized.`;Q.NamedExpressionName=n=>`Named expression ${n} not recognized.`;Q.LicenseKey=n=>`License key is ${n}.`;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class hae{constructor(){this.POSSIBLE_START_CHARACTERS=[...bN,...pie,Lr,"'","_"],this.cellReferenceRegexp=new RegExp(mie,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;const r=this.cellReferenceRegexp.exec(e+"@");return r==null||r[1]==null?null:(r[0]=r[1],r)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class dae{constructor(){this.POSSIBLE_START_CHARACTERS=[...bN,"_"],this.namedExpressionRegexp=new RegExp(EN,"y"),this.r1c1CellRefRegexp=new RegExp(`^${CN}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;const r=this.namedExpressionRegexp.exec(e);return r==null||r[0]==null||this.r1c1CellRefRegexp.test(r[0])?null:r}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const id=Et({name:"AdditionOp",pattern:Zr.NA}),mw=Et({name:"PlusOp",pattern:/\+/,categories:id}),pw=Et({name:"MinusOp",pattern:/-/,categories:id}),D1=Et({name:"MultiplicationOp",pattern:Zr.NA}),dI=Et({name:"TimesOp",pattern:/\*/,categories:D1}),fI=Et({name:"DivOp",pattern:/\//,categories:D1}),gw=Et({name:"PowerOp",pattern:/\^/}),mI=Et({name:"PercentOp",pattern:/%/}),ga=Et({name:"BooleanOp",pattern:Zr.NA}),yw=Et({name:"EqualsOp",pattern:/=/,categories:ga}),pI=Et({name:"NotEqualOp",pattern:/<>/,categories:ga}),gI=Et({name:"GreaterThanOp",pattern:/>/,categories:ga}),yI=Et({name:"LessThanOp",pattern:/</,categories:ga}),wI=Et({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:ga}),vI=Et({name:"LessThanOrEqualOp",pattern:/<=/,categories:ga}),CI=Et({name:"ConcatenateOp",pattern:/&/}),ww=Et({name:"LParen",pattern:/\(/}),Vm=Et({name:"RParen",pattern:/\)/}),EI=Et({name:"ArrayLParen",pattern:/{/}),bI=Et({name:"ArrayRParen",pattern:/}/}),SI=Et({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),RI=Et({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),sd=Et({name:"RangeSeparator",pattern:new RegExp(Yd)}),eb=Et({name:"ColumnRange",pattern:new RegExp(`${UT}${Yd}${UT}`)}),tb=Et({name:"RowRange",pattern:new RegExp(`${BT}${Yd}${BT}`)}),nb=Et({name:"ProcedureName",pattern:new RegExp(`([${R1}][${HE}]*)\\(`)}),_6=new hae,jo=Et({name:"CellReference",pattern:_6.match.bind(_6),start_chars_hint:_6.POSSIBLE_START_CHARACTERS,line_breaks:!1}),L6=new dae,TI=Et({name:"NamedExpression",pattern:L6.match.bind(L6),start_chars_hint:L6.POSSIBLE_START_CHARACTERS,line_breaks:!1}),rb=n=>{const e=n.translationPackage.getFunctionTranslation("OFFSET"),t=n.errorMapping,r=n.translationPackage.buildFunctionMapping(),i=new RegExp(n.ignoreWhiteSpace==="standard"?die:hie),s=Et({name:"WhiteSpace",pattern:i}),o=Et({name:"ArrayRowSep",pattern:n.arrayRowSeparator}),a=Et({name:"ArrayColSep",pattern:n.arrayColumnSeparator}),l=Et({name:"NumberLiteral",pattern:new RegExp(`(([${n.decimalSeparator}]\\d+)|(\\d+([${n.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),u=Et({name:"OffsetProcedureName",pattern:new RegExp(e,"i")});let c,h;n.functionArgSeparator===n.arrayColumnSeparator?(c=a,h=[]):n.functionArgSeparator===n.arrayRowSeparator?(c=o,h=[]):(c=Et({name:"ArgSeparator",pattern:n.functionArgSeparator}),h=[c]);const d=[s,mw,pw,dI,fI,gw,yw,pI,mI,wI,vI,gI,yI,ww,Vm,EI,bI,u,nb,sd,...h,eb,tb,l,SI,RI,CI,ga,id,D1,jo,TI,o,a];return{ArgSeparator:c,NumberLiteral:l,OffsetProcedureName:u,ArrayRowSeparator:o,ArrayColSeparator:a,WhiteSpace:s,allTokens:d,errorMapping:t,functionMapping:r,decimalSeparator:n.decimalSeparator,maxColumns:n.maxColumns,maxRows:n.maxRows}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class xu extends Uoe{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:Hoe(Boe())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var r;const i=this.CONSUME(nb),s=i.image.toUpperCase().slice(0,-1),o=(r=this.lexerConfig.functionMapping[s])!==null&&r!==void 0?r:s,a=[];let l=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var c;const h=this.CONSUME(this.lexerConfig.ArgSeparator);l.type===W.EMPTY&&(l.leadingWhitespace=(c=h.leadingWhitespace)===null||c===void 0?void 0:c.image),a.push(l),l=this.SUBRULE2(this.booleanExpressionOrEmpty)}),a.push(l),a.length===1&&a[0].type===W.EMPTY&&(a.length=0);const u=this.CONSUME(Vm);return oae(o,a,i.leadingWhitespace,u.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{const r=this.CONSUME(TI);return aae(r.image,r.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{const r=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(ww),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{r.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(Vm),this.handleOffsetHeuristic(r)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{const r=this.CONSUME(eb),[i,s]=r.image.split(":"),o=this.ACTION(()=>Np(this.sheetMapping,i,this.formulaAddress)),a=this.ACTION(()=>Np(this.sheetMapping,s,this.formulaAddress));if(o===void 0||a===void 0)return Ts(new D($.REF));if(o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return su(r.image,new D($.NAME),r.leadingWhitespace);if(o.sheet===void 0&&a.sheet!==void 0)return this.parsingError(Mn.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:c}=xu.fixSheetIdsForRangeEnds(o,a);return Woe(l,u,c,r.leadingWhitespace)}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{const r=this.CONSUME(tb),[i,s]=r.image.split(":"),o=this.ACTION(()=>Ip(this.sheetMapping,i,this.formulaAddress)),a=this.ACTION(()=>Ip(this.sheetMapping,s,this.formulaAddress));if(o===void 0||a===void 0)return Ts(new D($.REF));if(o.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return su(r.image,new D($.NAME),r.leadingWhitespace);if(o.sheet===void 0&&a.sheet!==void 0)return this.parsingError(Mn.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:c}=xu.fixSheetIdsForRangeEnds(o,a);return Goe(l,u,c,r.leadingWhitespace)}),this.cellReference=this.RULE("cellReference",()=>{const r=this.CONSUME(jo),i=this.ACTION(()=>gu(this.sheetMapping,r.image,this.formulaAddress));return i===void 0?su(r.image,new D($.REF),r.leadingWhitespace):i.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?su(r.image,new D($.NAME),r.leadingWhitespace):p4(i,r.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",r=>{var i;const s=this.CONSUME(jo),o=this.ACTION(()=>gu(this.sheetMapping,r.image,this.formulaAddress)),a=this.ACTION(()=>gu(this.sheetMapping,s.image,this.formulaAddress));return o===void 0||a===void 0?this.ACTION(()=>su(`${r.image}:${s.image}`,new D($.REF),r.leadingWhitespace)):o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>su(`${r.image}:${s.image}`,new D($.NAME),r.leadingWhitespace)):this.buildCellRange(o,a,(i=r.leadingWhitespace)===null||i===void 0?void 0:i.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",r=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[r]})},{ALT:()=>{var i;const s=this.SUBRULE(this.offsetProcedureExpression),o=this.ACTION(()=>gu(this.sheetMapping,r.image,this.formulaAddress));return o===void 0?Ts(new D($.REF)):s.type===W.CELL_REFERENCE?this.buildCellRange(o,s.reference,(i=r.leadingWhitespace)===null||i===void 0?void 0:i.image):this.parsingError(Mn.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{const r=this.CONSUME(jo);return this.CONSUME2(sd),this.SUBRULE(this.endOfRangeExpression,{ARGS:[r]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",r=>{const i=this.CONSUME(jo),s=this.ACTION(()=>gu(this.sheetMapping,i.image,this.formulaAddress));return s===void 0?this.ACTION(()=>Ts(new D($.REF))):this.buildCellRange(r.reference,s,r.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",r=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[r]})},{ALT:()=>{const i=this.SUBRULE(this.offsetProcedureExpression);return i.type===W.CELL_REFERENCE?this.buildCellRange(r.reference,i.reference,r.leadingWhitespace):this.parsingError(Mn.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{const r=this.SUBRULE(this.offsetProcedureExpression);let i;return this.OPTION(()=>{this.CONSUME(sd),r.type===W.CELL_RANGE?i=this.parsingError(Mn.RangeOffsetNotAllowed,"Range offset not allowed here"):i=this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[r]})}),i!==void 0?i:r}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{const r=[[]];return r[r.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),r[r.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),r.push([]),r[r.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),y4(r)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{const r=this.CONSUME(ww),i=this.SUBRULE(this.booleanExpression),s=this.CONSUME(Vm);return lae(i,r.leadingWhitespace,s.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{const r=this.CONSUME(EI),i=this.SUBRULE(this.insideArrayExpression),s=this.CONSUME(bI);return y4(i.args,r.leadingWhitespace,s.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=r=>{const i=r.replace(this.lexerConfig.decimalSeparator,".");return Number(i)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var r;return this.OR((r=this.atomicExpCache)!==null&&r!==void 0?r:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const i=this.CONSUME(this.lexerConfig.NumberLiteral);return Voe(this.numericStringToNumber(i.image),i.leadingWhitespace)}},{ALT:()=>{const i=this.CONSUME(SI);return $oe(i)}},{ALT:()=>{const i=this.CONSUME(RI),s=i.image.toUpperCase(),o=this.lexerConfig.errorMapping[s];return o?Ts(new D(o),i.leadingWhitespace):this.parsingError(Mn.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{const r=this.SUBRULE(this.positiveAtomicExpression),i=this.OPTION(()=>this.CONSUME(mI));return i?sae(r,i.leadingWhitespace):r}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{const r=this.CONSUME(id),i=this.SUBRULE(this.atomicExpression);return Ht(r,mw)?iae(i,r.leadingWhitespace):Ht(r,pw)?rae(i,r.leadingWhitespace):(this.customParsingError=m4(Mn.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let r=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{const i=this.CONSUME(gw),s=this.SUBRULE2(this.atomicExpression);Ht(i,gw)?r=nae(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let r=this.SUBRULE(this.powerExpression);return this.MANY(()=>{const i=this.CONSUME(D1),s=this.SUBRULE2(this.powerExpression);Ht(i,dI)?r=eae(r,s,i.leadingWhitespace):Ht(i,fI)?r=tae(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.additionExpression=this.RULE("additionExpression",()=>{let r=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{const i=this.CONSUME(id),s=this.SUBRULE2(this.multiplicationExpression);Ht(i,mw)?r=Zoe(r,s,i.leadingWhitespace):Ht(i,pw)?r=Joe(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let r=this.SUBRULE(this.additionExpression);return this.MANY(()=>{const i=this.CONSUME(CI),s=this.SUBRULE2(this.additionExpression);r=zoe(r,s,i.leadingWhitespace)}),r}),this.booleanExpression=this.RULE("booleanExpression",()=>{let r=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{const i=this.CONSUME(ga),s=this.SUBRULE2(this.concatenateExpression);Ht(i,yw)?r=Yoe(r,s,i.leadingWhitespace):Ht(i,pI)?r=joe(r,s,i.leadingWhitespace):Ht(i,gI)?r=Koe(r,s,i.leadingWhitespace):Ht(i,yI)?r=qoe(r,s,i.leadingWhitespace):Ht(i,wI)?r=Xoe(r,s,i.leadingWhitespace):Ht(i,vI)?r=Qoe(r,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),r}),this.formula=this.RULE("formula",()=>(this.CONSUME(yw),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=Pe(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let r=this.formulaWithContext(t),i=[];return this.customParsingError&&i.push(this.customParsingError),i=i.concat(this.errors.map(s=>({type:Mn.ParserError,message:s.message}))),i.length>0&&(r=fw()),{ast:r,errors:i}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,r){if(e.sheet===void 0&&t.sheet!==void 0)return this.parsingError(Mn.ParserError,"Malformed range expression");const{firstEnd:i,secondEnd:s,sheetRefType:o}=xu.fixSheetIdsForRangeEnds(e,t);return g4(i,s,o,r)}static fixSheetIdsForRangeEnds(e,t){const r=xu.rangeSheetReferenceType(e.sheet,t.sheet),i=e.sheet!==void 0&&t.sheet===void 0?t.withSheet(e.sheet):t;return{firstEnd:e,secondEnd:i,sheetRefType:r}}handleOffsetHeuristic(e){const t=e[0];if(t.type!==W.CELL_REFERENCE)return this.parsingError(Mn.StaticOffsetError,"First argument to OFFSET is not a reference");const r=e[1];let i;if(r.type===W.NUMBER&&Number.isInteger(r.value))i=r.value;else if(r.type===W.PLUS_UNARY_OP&&r.value.type===W.NUMBER&&Number.isInteger(r.value.value))i=r.value.value;else if(r.type===W.MINUS_UNARY_OP&&r.value.type===W.NUMBER&&Number.isInteger(r.value.value))i=-r.value.value;else return this.parsingError(Mn.StaticOffsetError,"Second argument to OFFSET is not a static number");const s=e[2];let o;if(s.type===W.NUMBER&&Number.isInteger(s.value))o=s.value;else if(s.type===W.PLUS_UNARY_OP&&s.value.type===W.NUMBER&&Number.isInteger(s.value.value))o=s.value.value;else if(s.type===W.MINUS_UNARY_OP&&s.value.type===W.NUMBER&&Number.isInteger(s.value.value))o=-s.value.value;else return this.parsingError(Mn.StaticOffsetError,"Third argument to OFFSET is not a static number");const a=e[3];let l;if(a===void 0)l=1;else if(a.type===W.NUMBER){if(l=a.value,l<1)return this.parsingError(Mn.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(l))return this.parsingError(Mn.StaticOffsetError,"Fourth argument to OFFSET is not integer")}else return this.parsingError(Mn.StaticOffsetError,"Fourth argument to OFFSET is not a static number");const u=e[4];let c;if(u===void 0)c=1;else if(u.type===W.NUMBER){if(c=u.value,c<1)return this.parsingError(Mn.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(c))return this.parsingError(Mn.StaticOffsetError,"Fifth argument to OFFSET is not integer")}else return this.parsingError(Mn.StaticOffsetError,"Fifth argument to OFFSET is not a static number");const h=new Ut(t.reference.col+o,t.reference.row+i,t.reference.type);let d=h.col,f=h.row;if((t.reference.type===kt.CELL_REFERENCE_RELATIVE||t.reference.type===kt.CELL_REFERENCE_ABSOLUTE_COL)&&(f=f+this.formulaAddress.row),(t.reference.type===kt.CELL_REFERENCE_RELATIVE||t.reference.type===kt.CELL_REFERENCE_ABSOLUTE_ROW)&&(d=d+this.formulaAddress.col),d<0||f<0)return Ts(new D($.REF,Q.OutOfSheet));if(c===1&&l===1)return p4(h);{const m=new Ut(h.col+c-1,h.row+l-1,h.type);return g4(h,m,xi.RELATIVE)}}parsingError(e,t){return this.customParsingError=m4(e,t),fw()}static rangeSheetReferenceType(e,t){return e===void 0?xi.RELATIVE:t===void 0?xi.START_ABSOLUTE:xi.BOTH_ABSOLUTE}}class $p{constructor(e){this.lexerConfig=e,this.lexer=new Zr(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const t=this.lexer.tokenize(e);let r=t.tokens;return r=this.trimTrailingWhitespaces(r),r=this.skipWhitespacesInsideRanges(r),r=this.skipWhitespacesBeforeArgSeparators(r),t.tokens=r,t}skipWhitespacesInsideRanges(e){return $p.filterTokensByNeighbors(e,(t,r,i)=>(Ht(t,jo)||Ht(t,sd))&&Ht(r,this.lexerConfig.WhiteSpace)&&(Ht(i,jo)||Ht(i,sd)))}skipWhitespacesBeforeArgSeparators(e){return $p.filterTokensByNeighbors(e,(t,r,i)=>!Ht(t,this.lexerConfig.ArgSeparator)&&Ht(r,this.lexerConfig.WhiteSpace)&&Ht(i,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let r=0;const i=[e[r++]];for(;r<e.length-1;)t(e[r-1],e[r],e[r+1])||i.push(e[r]),++r;return i.push(e[r]),i}trimTrailingWhitespaces(e){return e.length>0&&Ht(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class AI{constructor(e,t,r,i){this.config=e,this.lexerConfig=t,this.sheetMappingFn=r,this.namedExpressions=i}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(e,t){var r,i;switch(e.type){case W.EMPTY:return bt("",e.leadingWhitespace);case W.NUMBER:return bt(xI(e.value,this.config.decimalSeparator),e.leadingWhitespace);case W.STRING:return bt('"'+e.value+'"',e.leadingWhitespace);case W.FUNCTION_CALL:{const s=e.args.map(l=>l!==void 0?this.unparseAst(l,t):"").join(this.config.functionArgSeparator),a=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+s+bt(")",e.internalWhitespace);return bt(a,e.leadingWhitespace)}case W.NAMED_EXPRESSION:{const s=(r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))===null||r===void 0?void 0:r.displayName;return bt(s||e.expressionName,e.leadingWhitespace)}case W.CELL_REFERENCE:{let s;return e.reference.sheet!==void 0?s=this.unparseSheetName(e.reference.sheet)+"!":s="",s+=(i=e.reference.unparse(t))!==null&&i!==void 0?i:this.config.translationPackage.getErrorTranslation($.REF),bt(s,e.leadingWhitespace)}case W.COLUMN_RANGE:case W.ROW_RANGE:case W.CELL_RANGE:return bt(this.formatRange(e,t),e.leadingWhitespace);case W.PLUS_UNARY_OP:{const s=this.unparseAst(e.value,t);return bt("+",e.leadingWhitespace)+s}case W.MINUS_UNARY_OP:{const s=this.unparseAst(e.value,t);return bt("-",e.leadingWhitespace)+s}case W.PERCENT_OP:return this.unparseAst(e.value,t)+bt("%",e.leadingWhitespace);case W.ERROR:{const s=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:$.ERROR);return bt(s,e.leadingWhitespace)}case W.ERROR_WITH_RAW_INPUT:return bt(e.rawInput,e.leadingWhitespace);case W.PARENTHESIS:{const o="("+this.unparseAst(e.expression,t)+bt(")",e.internalWhitespace);return bt(o,e.leadingWhitespace)}case W.ARRAY:{const s="{"+e.args.map(o=>o.map(a=>this.unparseAst(a,t)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+bt("}",e.internalWhitespace);return bt(s,e.leadingWhitespace)}default:{const s=this.unparseAst(e.left,t),o=this.unparseAst(e.right,t);return s+bt(hI[e.type],e.leadingWhitespace)+o}}}unparseSheetName(e){const t=RN(e,this.sheetMappingFn);if(t===void 0)throw new an(e);return t}formatRange(e,t){let r="",i="";e.start.sheet!==void 0&&e.sheetReferenceType!==xi.RELATIVE&&(r=this.unparseSheetName(e.start.sheet)+"!"),e.end.sheet!==void 0&&e.sheetReferenceType===xi.BOTH_ABSOLUTE&&(i=this.unparseSheetName(e.end.sheet)+"!");const s=e.start.unparse(t),o=e.end.unparse(t);return s===void 0||o===void 0?this.config.translationPackage.getErrorTranslation($.REF):`${r}${s}:${i}${o}`}}function xI(n,e){return n.toString().replace(".",e)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class xh{constructor(e,t,r){this.config=e,this.functionRegistry=t,this.sheetMapping=r,this.statsCacheUsed=0,this.lexerConfig=rb(e),this.lexer=new $p(this.lexerConfig),this.formulaParser=new xu(this.lexerConfig,this.sheetMapping),this.cache=new cae(this.functionRegistry)}parse(e,t){this.formulaAddress=t;const r=this.tokenizeFormula(e);if(r.errors.length>0){const h=r.errors.map(d=>({type:Mn.LexingError,message:d.message}));return{ast:fw(),errors:h,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const i=this.computeHashFromTokens(r.tokens,t);let s=this.cache.get(i);if(s!==void 0)++this.statsCacheUsed;else{const h=this.bindWhitespacesToTokens(r.tokens),d=this.formulaParser.parseFromTokens(h,t);if(d.errors.length>0)return Object.assign(Object.assign({},d),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});s=this.cache.set(i,d.ast)}const{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:l}=s,u=this.convertReversedRangesToRegularRanges(o),c=k1(u,this.functionRegistry);return{ast:u,errors:[],hasVolatileFunction:a,hasStructuralChangeFunction:l,dependencies:c}}convertReversedRangesToRegularRanges(e){switch(e.type){case W.EMPTY:case W.NUMBER:case W.STRING:case W.ERROR:case W.ERROR_WITH_RAW_INPUT:case W.CELL_REFERENCE:case W.NAMED_EXPRESSION:return e;case W.CELL_RANGE:{const{start:t,end:r}=e,i=this.orderCellRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case W.COLUMN_RANGE:{const{start:t,end:r}=e,i=this.orderColumnRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case W.ROW_RANGE:{const{start:t,end:r}=e,i=this.orderRowRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case W.PERCENT_OP:case W.PLUS_UNARY_OP:case W.MINUS_UNARY_OP:{const t=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:t})}case W.CONCATENATE_OP:case W.EQUALS_OP:case W.NOT_EQUAL_OP:case W.LESS_THAN_OP:case W.GREATER_THAN_OP:case W.LESS_THAN_OR_EQUAL_OP:case W.GREATER_THAN_OR_EQUAL_OP:case W.MINUS_OP:case W.PLUS_OP:case W.TIMES_OP:case W.DIV_OP:case W.POWER_OP:{const t=this.convertReversedRangesToRegularRanges(e.left),r=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:r})}case W.PARENTHESIS:{const t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t})}case W.FUNCTION_CALL:{const t=e.args.map(r=>this.convertReversedRangesToRegularRanges(r));return Object.assign(Object.assign({},e),{args:t})}case W.ARRAY:{const t=e.args.map(r=>r.map(i=>this.convertReversedRangesToRegularRanges(i)));return Object.assign(Object.assign({},e),{args:t})}}}orderCellRangeEnds(e,t){const r=[e,t],[i,s]=r.map(c=>c.toColumnAddress()).sort(_r.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=r.map(c=>c.toRowAddress()).sort(Er.compareByAbsoluteAddress(this.formulaAddress)),[l,u]=r.map(c=>c.sheet).sort(xh.compareSheetIds.bind(this));return{start:Ut.fromColAndRow(i,o,l),end:Ut.fromColAndRow(s,a,u)}}orderColumnRangeEnds(e,t){const r=[e,t],[i,s]=r.sort(_r.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=r.map(l=>l.sheet).sort(xh.compareSheetIds.bind(this));return{start:new _r(i.type,i.col,o),end:new _r(s.type,s.col,a)}}orderRowRangeEnds(e,t){const r=[e,t],[i,s]=r.sort(Er.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=r.map(l=>l.sheet).sort(xh.compareSheetIds.bind(this));return{start:new Er(i.type,i.row,o),end:new Er(s.type,s.row,a)}}static compareSheetIds(e,t){return e=e!=null?e:1/0,t=t!=null?t:1/0,e-t}fetchCachedResultForAst(e){const t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}fetchCachedResult(e){const t=this.cache.get(e);if(t===void 0)throw new Error("There is no AST with such key in the cache");{const{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:s,relativeDependencies:o}=t;return{ast:r,errors:[],hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}}}computeHashFromTokens(e,t){var r;let i="",s=0;for(;s<e.length;){const o=e[s];if(Ht(o,jo)){const a=gu(this.sheetMapping,o.image,t);a===void 0?i=i.concat(o.image):i=i.concat(a.hash(!0))}else if(Ht(o,nb)){const a=o.image.toUpperCase().slice(0,-1),l=(r=this.lexerConfig.functionMapping[a])!==null&&r!==void 0?r:a;i=i.concat(l,"(")}else if(Ht(o,eb)){const[a,l]=o.image.split(":"),u=Np(this.sheetMapping,a,t),c=Np(this.sheetMapping,l,t);u===void 0||c===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",c.hash(!0))}else if(Ht(o,tb)){const[a,l]=o.image.split(":"),u=Ip(this.sheetMapping,a,t),c=Ip(this.sheetMapping,l,t);u===void 0||c===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",c.hash(!0))}else i=i.concat(o.image);s++}return i}rememberNewAst(e){const t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case W.EMPTY:return e.leadingWhitespace||"";case W.NUMBER:return bt(xI(e.value,this.config.decimalSeparator),e.leadingWhitespace);case W.STRING:return bt('"'+e.value+'"',e.leadingWhitespace);case W.NAMED_EXPRESSION:return bt(e.expressionName,e.leadingWhitespace);case W.FUNCTION_CALL:{const t=e.args.map(i=>this.computeHashOfAstNode(i)).join(this.config.functionArgSeparator),r=e.procedureName+"("+t+bt(")",e.internalWhitespace);return bt(r,e.leadingWhitespace)}case W.CELL_REFERENCE:return bt(e.reference.hash(!0),e.leadingWhitespace);case W.COLUMN_RANGE:case W.ROW_RANGE:case W.CELL_RANGE:{const t=e.start.hash(e.sheetReferenceType!==xi.RELATIVE),r=e.end.hash(e.sheetReferenceType===xi.BOTH_ABSOLUTE);return bt(t+":"+r,e.leadingWhitespace)}case W.MINUS_UNARY_OP:return bt("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case W.PLUS_UNARY_OP:return bt("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case W.PERCENT_OP:return this.computeHashOfAstNode(e.value)+bt("%",e.leadingWhitespace);case W.ERROR:{const t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:$.ERROR);return bt(t,e.leadingWhitespace)}case W.ERROR_WITH_RAW_INPUT:return bt(e.rawInput,e.leadingWhitespace);case W.ARRAY:{const t=e.args.map(r=>r.map(i=>this.computeHashOfAstNode(i)).join(",")).join(";");return bt("{"+t+bt("}",e.internalWhitespace),e.leadingWhitespace)}case W.PARENTHESIS:{const r="("+this.computeHashOfAstNode(e.expression)+bt(")",e.internalWhitespace);return bt(r,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+bt(hI[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const t=[],r=e[0];Ht(r,this.lexerConfig.WhiteSpace)||t.push(r);for(let i=1;i<e.length;++i){const s=e[i];if(Ht(s,this.lexerConfig.WhiteSpace))continue;const o=e[i-1];Ht(o,this.lexerConfig.WhiteSpace)&&(s.leadingWhitespace=o),t.push(s)}return t}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const yu=(n,e,t,r)=>{switch(n.type){case W.EMPTY:case W.NUMBER:case W.STRING:case W.ERROR:return;case W.NAMED_EXPRESSION:{r&&t.push(new Ko(n.expressionName));return}case W.CELL_REFERENCE:{r&&t.push(new MI(n.reference));return}case W.CELL_RANGE:{r&&n.start.sheet===n.end.sheet&&t.push(new fae(n.start,n.end));return}case W.COLUMN_RANGE:{r&&n.start.sheet===n.end.sheet&&t.push(new mae(n.start,n.end));return}case W.ROW_RANGE:{r&&n.start.sheet===n.end.sheet&&t.push(new pae(n.start,n.end));return}case W.PERCENT_OP:case W.PLUS_UNARY_OP:case W.MINUS_UNARY_OP:{yu(n.value,e,t,!0);return}case W.CONCATENATE_OP:case W.EQUALS_OP:case W.NOT_EQUAL_OP:case W.LESS_THAN_OP:case W.GREATER_THAN_OP:case W.LESS_THAN_OR_EQUAL_OP:case W.GREATER_THAN_OR_EQUAL_OP:case W.MINUS_OP:case W.PLUS_OP:case W.TIMES_OP:case W.DIV_OP:case W.POWER_OP:yu(n.left,e,t,!0),yu(n.right,e,t,!0);return;case W.PARENTHESIS:yu(n.expression,e,t,r);return;case W.FUNCTION_CALL:{const i=!e.doesFunctionNeedArgumentToBeComputed(n.procedureName);n.args.forEach(s=>yu(s,e,t,i));return}}},k1=(n,e)=>{const t=new Array;return yu(n,e,t,!0),t};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class MI{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class fae{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new We(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class mae{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleColumnAddress(e),r=this.end.toSimpleColumnAddress(e);return new wo(t.sheet,t.col,r.col)}}class pae{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleRowAddress(e),r=this.end.toSimpleRowAddress(e);return new vo(t.sheet,t.row,r.row)}}class Ko{constructor(e){this.name=e}absolutize(e){return this}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const As=(n,e)=>n.map(t=>t.absolutize(e)),gae=n=>n.filter(e=>e instanceof Ko?!0:e instanceof We?!(qr(e.start)||qr(e.end)):!qr(e));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const ht=Symbol("Empty value");function Le(n){return n instanceof js?n.val:n}class js{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}function ib(n,e){if(typeof n=="number")return e;{const t=n.fromNumber(e);return t.format=n.format,t}}class sb extends js{getDetailedType(){return He.NUMBER_DATE}}class vw extends js{getDetailedType(){return He.NUMBER_CURRENCY}}class ob extends js{getDetailedType(){return He.NUMBER_TIME}}class ab extends js{getDetailedType(){return He.NUMBER_DATETIME}}class $m extends js{getDetailedType(){return He.NUMBER_PERCENT}}function At(n){return typeof n=="number"||n instanceof js}var He;(function(n){n.NUMBER_RAW="NUMBER_RAW",n.NUMBER_DATE="NUMBER_DATE",n.NUMBER_TIME="NUMBER_TIME",n.NUMBER_DATETIME="NUMBER_DATETIME",n.NUMBER_CURRENCY="NUMBER_CURRENCY",n.NUMBER_PERCENT="NUMBER_PERCENT"})(He||(He={}));function yae(n){return n instanceof js?n.getDetailedType():He.NUMBER_RAW}function wae(n){if(n instanceof js)return n.format}function Wp(n){return n instanceof js?{type:n.getDetailedType(),format:n.format}:{type:He.NUMBER_RAW}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Be{constructor(e,t,r,i){this._data=e,this.range=t,this.dependencyGraph=r,this._hasOnlyNumbers=i,this.size=e===void 0?new lt(t.effectiveWidth(r),t.effectiveHeight(r)):new lt(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,r){return new Be(e,t,r,!0)}static onlyNumbers(e){return new Be(e,void 0,void 0,!0)}static onlyValues(e){return new Be(e,void 0,void 0,void 0)}static onlyRange(e,t){return new Be(void 0,e,t,void 0)}static fromScalar(e){return new Be([[e]],void 0,void 0,void 0)}isAdHoc(){return this.range===void 0}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let t=0;t<this._data.length;t++)for(let r=0;r<this._data[0].length;r++)e.push(this._data[t][r]);return e}*effectiveAddressesFromData(e){for(let t=0;t<this.data.length;++t){const r=this.data[t];for(let i=0;i<r.length;++i)yield Pe(e.sheet,e.col+i,e.row+t)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let r=0;r<this.size.width;++r)yield[this._data[t][r],Pe(e.sheet,e.col+r,e.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(this._hasOnlyNumbers===void 0){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if(typeof t!="number")return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),(e=this._data)!==null&&e!==void 0?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){this._data===void 0&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{const t=this.dependencyGraph.getCellValue(e);return t instanceof Be?(this._hasOnlyNumbers=!1,new D($.VALUE,Q.ScalarExpected)):(At(t)||(this._hasOnlyNumbers=!1),t)}))}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class na{constructor(){this.changes=new Map}static empty(){return new na}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,r){this.addInterpreterValue(e,t,r)}exportChanges(e){let t=[];return this.changes.forEach(r=>{const i=e.exportChange(r);Array.isArray(i)?t=t.concat(i):t.push(i)}),t}getChanges(){return Array.from(this.changes.values())}isEmpty(){return this.changes.size===0}add(e,t){const r=t.value;if(r instanceof Be)for(const i of r.effectiveAddressesFromData(e))this.changes.delete(Mh(i));this.changes.set(Mh(e),t)}addInterpreterValue(e,t,r){this.add(t,{address:t,value:e,oldValue:r})}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Qr{constructor(e,t,r){if(this.sheet=e,this.rowStart=t,this.rowEnd=r,t<0)throw Error("Starting row cant be less than 0");if(r<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,r){return new Qr(e,t,t+r-1)}static fromRowStartAndEnd(e,t,r){return new Qr(e,t,r)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.rowStart,e.rowStart),r=Math.min(this.rowEnd,e.rowEnd);return t>r?null:new Qr(this.sheet,t,r)}firstRow(){return new Qr(this.sheet,this.rowStart,this.rowStart)}}class ci{constructor(e,t,r){if(this.sheet=e,this.columnStart=t,this.columnEnd=r,t<0)throw Error("Starting column cant be less than 0");if(r<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,r){return new ci(e,t,t+r-1)}static fromColumnStartAndEnd(e,t,r){return new ci(e,t,r)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.columnStart,e.columnStart),r=Math.min(this.columnEnd,e.columnEnd);return t>r?null:new ci(this.sheet,t,r)}firstColumn(){return new ci(this.sheet,this.columnStart,this.columnStart)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var Ze;(function(n){n.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",n.PARSER="PARSER",n.GRAPH_BUILD="GRAPH_BUILD",n.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",n.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",n.TOP_SORT="TOP_SORT",n.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",n.EVALUATION="EVALUATION",n.VLOOKUP="VLOOKUP",n.TRANSFORM_ASTS="TRANSFORM_ASTS",n.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",n.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",n.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",n.ADJUSTING_RANGES="ADJUSTING_RANGES",n.ADJUSTING_GRAPH="ADJUSTING_GRAPH",n.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",n.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(Ze||(Ze={}));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class NI{constructor(){this.stats=new Map([[Ze.CRITERION_FUNCTION_FULL_CACHE_USED,0],[Ze.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const t=((e=this.stats.get(Ze.CRITERION_FUNCTION_FULL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(Ze.CRITERION_FUNCTION_FULL_CACHE_USED,t)}incrementCriterionFunctionPartialCacheUsed(){var e;const t=((e=this.stats.get(Ze.CRITERION_FUNCTION_PARTIAL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(Ze.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(Ze.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(Ze.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t;const r=Date.now(),i=this.startTimes.get(e);if(i){let s=(t=this.stats.get(e))!==null&&t!==void 0?t:0;s+=r-i,this.stats.set(e,s),this.startTimes.delete(e)}else throw Error(`Statistics ${e} not started`)}measure(e,t){this.start(e);const r=t();return this.end(e),r}snapshot(){return new Map(this.stats)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class vae extends NI{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class an extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class II extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class od extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class nl extends Error{constructor(){super("Sheet size limit exceeded")}}class Cw extends Error{constructor(){super("This is not a formula")}}class OI extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class kn extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class ad extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}class _I extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class LI extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class ld extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class PI extends Error{constructor(){super("There is no operation to undo")}}class DI extends Error{constructor(){super("There is no operation to redo")}}class kI extends Error{constructor(){super("There is nothing to paste")}}function Cae(n,e){switch(typeof e){case"function":case"symbol":return e.toString();case"bigint":return"BigInt("+e.toString()+")";default:return e instanceof RegExp?"RegExp("+e.toString()+")":e}}class FI extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,Cae,4)}`)}}class Tt extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: ${t}`)}}class Eae extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class HI extends Error{constructor(e,t){super(`Config parameter ${e} should be at least ${t}`)}}class UI extends Error{constructor(e,t){super(`Config parameter ${e} should be at most ${t}`)}}class BI extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: ${t}`)}}class VI extends Error{constructor(){super("Computations are suspended")}}class wu extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class $I extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class Ew extends Error{constructor(){super("Language not registered.")}}class WI extends Error{constructor(){super("Language already registered.")}}class ec extends Error{static functionNotDeclaredInPlugin(e,t){return new ec(`Function with id ${e} not declared in plugin ${t}`)}static functionMethodNotFound(e,t){return new ec(`Function method ${e} not found in plugin ${t}`)}}class rl extends Error{static cannotRegisterFunctionWithId(e){return new rl(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new rl(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new rl("Cannot unregister protected plugin")}}class Mu extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class Gp extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class lb extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class bae extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Sae{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new an(e.sheet);return t.getCell(e)}fetchCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new an(e.sheet);const r=t.getCell(e);if(!r)throw Error("Vertex for address missing in AddressMapping");return r}strategyFor(e){const t=this.mapping.get(e);if(t===void 0)throw new an(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t){const{height:r,width:i,fill:s}=t,o=this.policy.call(s);this.addSheet(e,new o(i,r))}getCellValue(e){const t=this.getCell(e);return t===void 0?ht:t instanceof En?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){const t=this.getCell(e);return t instanceof ra?t.getValues().rawValue:t instanceof En?t.getArrayCellRawValue(e):null}setCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.setCell(e,t)}moveCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(r.has(t))throw new Error("Cannot move cell. Destination already occupied.");const i=r.getCell(e);if(i===void 0)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,i),this.removeCell(e)}removeCell(e){const t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){const t=this.mapping.get(e.sheet);return t===void 0?!1:t.has(e)}getHeight(e){const t=this.mapping.get(e);if(t===void 0)throw new an(e);return t.getHeight()}getWidth(e){const t=this.mapping.get(e);if(!t)throw new an(e);return t.getWidth()}addRows(e,t,r){const i=this.mapping.get(e);if(i===void 0)throw new an(e);i.addRows(t,r)}removeRows(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new an(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,r){const i=this.mapping.get(e);if(i===void 0)throw new an(e);i.addColumns(t,r)}removeColumns(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new an(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){const t=this.mapping.get(e);if(t!==void 0)yield*t.getEntries(e);else throw new an(e)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Rae{constructor(){this.arrayMapping=new Map}getArray(e){const t=this.getArrayByCorner(e.start);if(t!=null&&t.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get(Mh(e))}setArray(e,t){this.arrayMapping.set(Mh(e.start),t)}removeArray(e){typeof e=="string"?this.arrayMapping.delete(e):this.arrayMapping.delete(Mh(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,r])}*arraysInCols(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,r])}isFormulaArrayInRow(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const r of e.rows())this.isFormulaArrayInRow(e.sheet,r)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const r of e.columns())this.isFormulaArrayInColumn(e.sheet,r)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,t,r){this.updateArrayVerticesInSheet(e,(i,s)=>{const o=s.getRange();return t<=o.start.row?[o.shifted(0,r),s]:void 0})}moveArrayVerticesAfterColumnByColumns(e,t,r){this.updateArrayVerticesInSheet(e,(i,s)=>{const o=s.getRange();return t<=o.start.col?[o.shifted(r,0),s]:void 0})}updateArrayVerticesInSheet(e,t){const r=Array();for(const[i,s]of this.arrayMapping.entries()){if(s.sheet!==e)continue;const o=t(i,s);o!==void 0&&(this.removeArray(i),r.push(o))}r.forEach(([i,s])=>{this.setArray(i,s)})}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class lh{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class tc{constructor(e){this.size=new lt(e.length>0?e[0].length:0,e.length),this.array=e}static fromInterpreterValue(e){return e instanceof Be?new tc(e.data):new tc([[e]])}simpleRangeValue(){return Be.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(e,t){for(let r=0;r<this.height();r++)this.array[r].splice(e,0,...new Array(t).fill(ht));this.size.width+=t}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");const r=t-e+1;this.array.splice(e,r),this.size.height-=r}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");const r=t-e+1;for(const i of this.array)i.splice(e,r);this.size.width-=r}nullArrays(e,t){const r=[];for(let i=0;i<e;++i)r.push(new Array(t).fill(ht));return r}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,r){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=r}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height||(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width))throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}class P6{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class hi{constructor(e,t,r){this.formula=e,this.cellAddress=t,this.version=r}get width(){return 1}get height(){return 1}static fromAst(e,t,r,i){return r.isScalar()?new Is(e,t,i):new En(e,t,r,i)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[t,r,i]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=t,this.cellAddress=r,this.version=i}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class En extends hi{constructor(e,t,r,i=0){super(e,t,i),r.isRef?this.array=new P6(new D($.REF,Q.NoSpaceForArrayResult),lt.error()):this.array=new lh(r)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof D)return this.setErrorValue(e),e;const t=tc.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}getCellValue(){if(this.array instanceof lh)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof lh))return this.array.simpleRangeValue()}getArrayCellValue(e){const t=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;try{return this.array.get(t,r)}catch{return new D($.REF)}}getArrayCellRawValue(e){const t=this.getArrayCellValue(e);if(!(t instanceof D||t===ht))return Le(t)}setArrayCellValue(e,t){const r=e.col-this.cellAddress.col,i=e.row-this.cellAddress.row;this.array instanceof tc&&this.array.set(r,i,t)}setNoSpace(){return this.array=new P6(new D($.SPILL,Q.NoSpaceForArrayResult),lt.error()),this.getCellValue()}getRange(){return We.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return We.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=r&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=r&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof lh)}columnsFromArray(){return ci.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return Qr.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return cd(this.cellAddress,e)}setErrorValue(e){this.array=new P6(e,this.array.size)}}class Is extends hi{constructor(e,t,r){super(e,t,r)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(this.cachedCellValue!==void 0)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return this.cachedCellValue!==void 0}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class vr{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){var r;return(r=this.getCriterionFunctionValues(e).get(t))===null||r===void 0?void 0:r[0]}getCriterionFunctionValues(e){var t;return(t=this.criterionFunctionCache.get(e))!==null&&t!==void 0?t:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Tae=(n,e,t,r,i)=>{if(e instanceof vr){const a=e.range.intersectionWith(t);return a!==void 0?Array.from(a.addresses(i)):[]}let s,o;if(e instanceof hi)s=e.getFormula(r),o=e.getAddress(r);else return[];return k1(s,n).filter(a=>a instanceof MI).map(a=>a.dependency.toSimpleCellAddress(o)).filter(a=>t.addressInRange(a))};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var uo;(function(n){n[n.ON_STACK=0]="ON_STACK",n[n.PROCESSED=1]="PROCESSED",n[n.POPPED=2]="POPPED"})(uo||(uo={}));class Aae{constructor(e=[],t=[]){this.nodesSparseArray=e,this.edgesSparseArray=t,this.entranceTime=[],this.low=[],this.parent=[],this.inSCC=[],this.nodeStatus=[],this.order=[],this.sccNonSingletons=[],this.timeCounter=0}getTopSortedWithSccSubgraphFrom(e,t,r){const i=e.reverse();return i.forEach(s=>this.runDFS(s)),this.postprocess(i,r,t)}getAdjacentNodeIds(e){return this.edgesSparseArray[e].filter(t=>t!==void 0&&this.nodesSparseArray[t])}runDFS(e){if(this.nodeStatus[e]!==void 0)return;this.nodeStatus[e]=uo.ON_STACK;const t=[e],r=[];for(;t.length>0;){const i=t[t.length-1];switch(this.nodeStatus[i]){case uo.ON_STACK:{this.handleOnStack(i,r,t);break}case uo.PROCESSED:{this.handleProcessed(i,r,t);break}case uo.POPPED:{t.pop();break}}}}handleOnStack(e,t,r){this.entranceTime[e]=this.timeCounter,this.low[e]=this.timeCounter,this.timeCounter++,t.push(e),this.getAdjacentNodeIds(e).forEach(i=>{this.entranceTime[i]===void 0&&(r.push(i),this.parent[i]=e,this.nodeStatus[i]=uo.ON_STACK)}),this.nodeStatus[e]=uo.PROCESSED}handleProcessed(e,t,r){let i=this.entranceTime[e];if(this.getAdjacentNodeIds(e).forEach(s=>{this.inSCC[s]||(i=this.parent[s]===e?Math.min(i,this.low[s]):Math.min(i,this.entranceTime[s]))}),this.low[e]=i,i===this.entranceTime[e]){const s=[];do s.push(t[t.length-1]),t.pop();while(s[s.length-1]!==e);s.forEach(o=>{this.inSCC[o]=!0}),this.order.push(...s),s.length>1&&s.forEach(o=>{this.sccNonSingletons[o]=!0})}r.pop(),this.nodeStatus[e]=uo.POPPED}postprocess(e,t,r){const i=[];e.forEach(a=>{i[a]=!0});const s=[],o=[];return this.order.reverse(),this.order.forEach(a=>{const l=this.getAdjacentNodeIds(a);this.sccNonSingletons[a]||l.includes(a)?(o.push(this.nodesSparseArray[a]),t(this.nodesSparseArray[a]),l.forEach(u=>i[u]=!0)):(s.push(this.nodesSparseArray[a]),i[a]&&r(this.nodesSparseArray[a])&&l.forEach(u=>i[u]=!0))}),{sorted:s,cycled:o}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class xae{constructor(e,t){this.rawValue=e,this.processFn=t,this.processedValue=null}getProcessedValue(){return this.processedValue===null&&(this.processedValue=this.processFn(this.rawValue)),this.processedValue}markAsModified(){this.processedValue=null}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Mae{constructor(e){this.dependencyQuery=e,this.nodesSparseArray=[],this.edgesSparseArray=[],this.nodesIds=new Map,this.dirtyAndVolatileNodeIds=new xae({dirty:[],volatile:[]},t=>this.processDirtyAndVolatileNodeIds(t)),this.infiniteRangeIds=new Set,this.changingWithStructureNodeIds=[],this.nextId=0}getNodes(){return this.nodesSparseArray.filter(e=>e!==void 0)}hasNode(e){return this.nodesIds.has(e)}existsEdge(e,t){const r=this.getNodeId(e),i=this.getNodeId(t);return r===void 0||i===void 0?!1:this.edgesSparseArray[r].includes(i)}adjacentNodes(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return new Set(this.edgesSparseArray[t].filter(r=>r!==void 0).map(r=>this.nodesSparseArray[r]))}adjacentNodesCount(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return this.fixEdgesArrayForNode(t).length}addNodeAndReturnId(e){const t=this.nodesIds.get(e);if(t!==void 0)return t;const r=this.nextId;return this.nextId++,this.nodesSparseArray[r]=e,this.edgesSparseArray[r]=[],this.nodesIds.set(e,r),r}addEdge(e,t){const r=this.getNodeIdIfNotNumber(e),i=this.getNodeIdIfNotNumber(t);if(r===void 0)throw this.missingNodeError(e);if(i===void 0)throw this.missingNodeError(t);this.edgesSparseArray[r].includes(i)||this.edgesSparseArray[r].push(i)}removeNode(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);this.edgesSparseArray[t].length>0&&(this.edgesSparseArray[t].forEach(i=>this.dirtyAndVolatileNodeIds.rawValue.dirty.push(i)),this.dirtyAndVolatileNodeIds.markAsModified());const r=this.removeDependencies(e);return delete this.nodesSparseArray[t],delete this.edgesSparseArray[t],this.infiniteRangeIds.delete(t),this.nodesIds.delete(e),r}removeEdge(e,t){const r=this.getNodeIdIfNotNumber(e),i=this.getNodeIdIfNotNumber(t);if(r===void 0)throw this.missingNodeError(e);if(i===void 0)throw this.missingNodeError(t);const s=this.edgesSparseArray[r].indexOf(i);if(s===-1)throw new Error("Edge does not exist");delete this.edgesSparseArray[r][s]}removeEdgeIfExists(e,t){const r=this.getNodeId(e),i=this.getNodeId(t);if(r===void 0||i===void 0)return;const s=this.edgesSparseArray[r].indexOf(i);s!==-1&&delete this.edgesSparseArray[r][s]}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(this.getNodes(),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,t,r){const i=new Aae(this.nodesSparseArray,this.edgesSparseArray),s=e.map(o=>this.getNodeId(o)).filter(o=>o!==void 0);return i.getTopSortedWithSccSubgraphFrom(s,t,r)}markNodeAsVolatile(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.volatile.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsDirty(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.dirty.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}getDirtyAndVolatileNodes(){return this.dirtyAndVolatileNodeIds.getProcessedValue()}clearDirtyNodes(){this.dirtyAndVolatileNodeIds.rawValue.dirty=[],this.dirtyAndVolatileNodeIds.markAsModified()}markNodeAsChangingWithStructure(e){const t=this.getNodeId(e);t!==void 0&&this.changingWithStructureNodeIds.push(t)}markChangingWithStructureNodesAsDirty(){this.changingWithStructureNodeIds.length<=0||(this.dirtyAndVolatileNodeIds.rawValue.dirty=[...this.dirtyAndVolatileNodeIds.rawValue.dirty,...this.changingWithStructureNodeIds],this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsInfiniteRange(e){const t=this.getNodeIdIfNotNumber(e);t!==void 0&&this.infiniteRangeIds.add(t)}getInfiniteRanges(){return[...this.infiniteRangeIds].map(e=>({node:this.nodesSparseArray[e],id:e}))}getNodeId(e){return this.nodesIds.get(e)}getNodeIdIfNotNumber(e){return typeof e=="number"?e:this.nodesIds.get(e)}fixEdgesArrayForNode(e){const t=this.edgesSparseArray[e];return this.edgesSparseArray[e]=t.filter(r=>r!==void 0&&this.nodesSparseArray[r]),this.edgesSparseArray[e]}removeDependencies(e){const t=this.dependencyQuery(e);return t.forEach(([r,i])=>{this.removeEdgeIfExists(i,e)}),t}processDirtyAndVolatileNodeIds({dirty:e,volatile:t}){return[...new Set([...e,...t])].map(r=>this.nodesSparseArray[r]).filter(r=>r!==void 0)}missingNodeError(e){return new Error(`Unknown node ${e}`)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Nae{constructor(){this.rangeMapping=new Map}getMappingSize(e){var t,r;return(r=(t=this.rangeMapping.get(e))===null||t===void 0?void 0:t.size)!==null&&r!==void 0?r:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);t===void 0&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));const r=Wm(e.getStart(),e.getEnd());t.set(r,e)}removeRange(e){const t=e.getStart().sheet,r=this.rangeMapping.get(t);if(r===void 0)return;const i=Wm(e.getStart(),e.getEnd());r.delete(i),r.size===0&&this.rangeMapping.delete(t)}getRange(e,t){const r=this.rangeMapping.get(e.sheet),i=Wm(e,t);return r==null?void 0:r.get(i)}fetchRange(e,t){const r=this.getRange(e,t);if(!r)throw Error("Range does not exist");return r}truncateRanges(e,t){const r=Array(),i=Array(),s=Array(),o=e.sheet;for(const[l,u]of this.entriesFromSheet(e.sheet)){const c=u.range;e.start<=t(u.range.end)&&(c.removeSpan(e),c.shouldBeRemoved()?(this.removeByKey(o,l),r.push(u)):i.push([l,u]),s.push(u))}const a=[];i.sort((l,u)=>Oae(l[1],u[1],t));for(const[l,u]of i){const c=Iae(u.range);if(c===l)continue;const h=this.getByKey(o,c);this.removeByKey(o,l),h!==void 0&&u!=h?a.push([h,u]):this.setRange(u)}return{verticesToRemove:r,verticesToMerge:a,verticesWithChangedSize:s}}moveAllRangesInSheetAfterRowByRows(e,t,r){return this.updateVerticesFromSheet(e,(i,s)=>t<=s.start.row?(s.range.shiftByRows(r),{changedSize:!1,vertex:s}):t>s.start.row&&t<=s.end.row?(s.range.expandByRows(r),{changedSize:!0,vertex:s}):void 0)}moveAllRangesInSheetAfterColumnByColumns(e,t,r){return this.updateVerticesFromSheet(e,(i,s)=>t<=s.start.col?(s.range.shiftByColumns(r),{changedSize:!1,vertex:s}):t>s.start.col&&t<=s.end.col?(s.range.expandByColumns(r),{changedSize:!0,vertex:s}):void 0)}moveRangesInsideSourceRange(e,t,r,i){this.updateVerticesFromSheet(e.sheet,(s,o)=>{if(e.containsRange(o.range))return o.range.shiftByColumns(t),o.range.shiftByRows(r),o.range.moveToSheet(i),{changedSize:!1,vertex:o}})}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}*rangesInSheet(e){const t=this.rangeMapping.get(e);!t||(yield*t.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const t=Pe(e.end.sheet,e.end.col,e.end.row-1),r=this.getRange(e.start,t);if(r!==void 0){const i=We.fromSimpleCellAddresses(Pe(e.start.sheet,e.start.col,e.end.row),e.end);return{smallerRangeVertex:r,restRange:i}}}return{restRange:e}}*entriesFromSheet(e){const t=this.rangeMapping.get(e);!t||(yield*t.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){var r;return(r=this.rangeMapping.get(e))===null||r===void 0?void 0:r.get(t)}updateVerticesFromSheet(e,t){const r=Array();for(const[i,s]of this.entriesFromSheet(e)){const o=t(i,s);o!==void 0&&(this.removeByKey(e,i),r.push(o))}return r.forEach(i=>{this.setRange(i.vertex)}),{verticesWithChangedSize:r.filter(i=>i.changedSize).map(i=>i.vertex)}}}function Wm(n,e){return`${n.col},${n.row},${e.col},${e.row}`}function Iae(n){return Wm(n.start,n.end)}const Oae=(n,e,t)=>{const r=t(n.range.start),i=t(n.range.start);if(r===i){const s=t(n.range.end),o=t(e.range.end);return s-o}else return r-i};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class _ae{constructor(e,t,r){this.functions=e,this.errors=t,this.ui=r,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,t)=>(e[this.functions[t]]=t,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,t)=>(e[this.errors[t]]=t,e),{})}isFunctionTranslated(e){return this.functions[e]!==void 0}getFunctionTranslations(e){const t=[];for(const r of e)this.isFunctionTranslated(r)&&t.push(this.functions[r]);return t}getFunctionTranslation(e){const t=this.functions[e];if(t===void 0)throw new wu(`functions.${e}`);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===$.LIC)return`#${$.LIC}!`;const t=this.errors[e];if(t===void 0)throw new wu(`errors.${e}`);return t}getUITranslation(e){const t=this.ui[e];if(t===void 0)throw new wu(`ui.${e}`);return t}checkUI(){for(const e of Object.values(ud))if(!(e in this.ui))throw new wu(`ui.${e}`)}checkErrors(){for(const e of Object.values($))if(!(e in this.errors)&&e!==$.LIC)throw new wu(`errors.${e}`)}checkFunctionTranslations(e){const t=new Set(Object.getOwnPropertyNames(e));for(const r of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(r))throw new $I(r)}}function Lae(n){return new _ae(Object.assign({},n.functions),Object.assign({},n.errors),Object.assign({},n.ui))}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var ud;(function(n){n.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"})(ud||(ud={}));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function vu(n){return n.toLowerCase()}class Pae{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return vu(this.displayName)}}class Dae{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=t=>{const r=this.mappingFromCanonicalName.get(vu(t));if(r===void 0)throw new II(t);return r.id},this.get=t=>{var r;return(r=this.mappingFromCanonicalName.get(vu(t)))===null||r===void 0?void 0:r.id},this.fetchDisplayName=t=>this.fetchSheetById(t).displayName,this.sheetNamePrefix=e.getUITranslation(ud.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const t=vu(e);if(this.mappingFromCanonicalName.has(t))throw new od(e);this.lastSheetId++;const r=new Pae(this.lastSheetId,e);return this.store(r),r.id}removeSheet(e){const t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){var t;return(t=this.mappingFromId.get(e))===null||t===void 0?void 0:t.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(vu(e))}renameSheet(e,t){const r=this.fetchSheetById(e),i=r.displayName;if(i===t)return;const s=this.mappingFromCanonicalName.get(vu(t));if(s!==void 0&&s.id!==r.id)throw new od(t);const o=r.canonicalName;return this.mappingFromCanonicalName.delete(o),r.displayName=t,this.store(r),i}sheetNames(){return Array.from(this.mappingFromId.values()).map(e=>e.displayName)}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const t=this.mappingFromId.get(e);if(t===void 0)throw new an(e);return t}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ub{constructor(e,t,r,i,s,o,a,l){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=r,this.arrayMapping=i,this.stats=s,this.lazilyTransformingAstService=o,this.functionRegistry=a,this.namedExpressions=l,this.changes=na.empty(),this.dependencyQueryAddresses=u=>{if(u instanceof vr)return this.rangeDependencyQuery(u).map(([c,h])=>c);{const c=this.formulaDependencyQuery(u);if(c!==void 0){const[h,d]=c;return d.map(f=>f instanceof Ko?this.namedExpressions.namedExpressionOrPlaceholder(f.name,h.sheet).address:vn(f)?f:Sw(f.start,f.end))}else return[]}},this.dependencyQueryVertices=u=>{if(u instanceof vr)return this.rangeDependencyQuery(u);{const c=this.formulaDependencyQuery(u);if(c!==void 0){const[h,d]=c;return d.map(f=>{if(f instanceof We)return[f.start,this.rangeMapping.fetchRange(f.start,f.end)];if(f instanceof Ko){const m=this.namedExpressions.namedExpressionOrPlaceholder(f.name,h.sheet);return[m.address,this.addressMapping.fetchCell(m.address)]}else return[f,this.addressMapping.fetchCell(f)]})}else return[]}},this.rangeDependencyQuery=u=>{const c=[],{smallerRangeVertex:h,restRange:d}=this.rangeMapping.findSmallerRange(u.range);let f;h!==void 0&&this.graph.adjacentNodes(h).has(u)?(f=d,c.push([new We(h.start,h.end),h])):f=u.range;for(const m of f.addresses(this)){const p=this.addressMapping.getCell(m);p!==void 0&&c.push([m,p])}return c},this.formulaDependencyQuery=u=>{let c,h;if(u instanceof hi)h=u.getAddress(this.lazilyTransformingAstService),c=u.getFormula(this.lazilyTransformingAstService);else return;const d=k1(c,this.functionRegistry);return[h,As(d,h)]},this.graph=new Mae(this.dependencyQueryVertices)}static buildEmpty(e,t,r,i,s){return new ub(new Sae(t.chooseAddressMappingPolicy),new Nae,new Dae(t.translationPackage),new Rae,s,e,r,i)}setFormulaToCell(e,t,r,i,s,o){const a=hi.fromAst(t,e,i,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(a),this.processCellDependencies(r,a),this.graph.markNodeAsDirty(a),s&&this.markAsVolatile(a),o&&this.markAsDependentOnStructureChange(a),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(r,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);if(r instanceof En&&this.arrayMapping.removeArray(r.getRange()),r instanceof ra)r.getValues().rawValue!==t.rawValue&&(r.setValues(t),this.graph.markNodeAsDirty(r));else{const i=new ra(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(r,i),this.addressMapping.setCell(e,i),this.graph.markNodeAsDirty(i)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const t=this.shrinkPossibleArrayAndGetCell(e);if(t===void 0)return na.empty();if(this.graph.adjacentNodes(t).size>0){const r=new Wo;this.exchangeGraphNode(t,r),this.graph.adjacentNodesCount(r)===0?(this.removeVertex(r),this.addressMapping.removeCell(e)):(this.graph.markNodeAsDirty(r),this.addressMapping.setCell(e,r))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}ensureThatVertexIsNonArrayCellVertex(e){if(e instanceof En)throw new Error("Illegal operation")}clearDirtyVertices(){this.graph.clearDirtyNodes()}verticesToRecompute(){return this.graph.getDirtyAndVolatileNodes()}processCellDependencies(e,t){const r=this.graph.getNodeId(t);e.forEach(i=>{if(i instanceof We){const s=i;let o=this.getRange(s.start,s.end);o===void 0&&(o=new vr(s),this.rangeMapping.setRange(o)),this.graph.addNodeAndReturnId(o);const a=this.graph.getNodeId(o);s.isFinite()||this.graph.markNodeAsInfiniteRange(a);const{smallerRangeVertex:l,restRange:u}=this.rangeMapping.findSmallerRange(s);if(l!==void 0){if(this.graph.addEdge(l,a),o.bruteForce){o.bruteForce=!1;for(const h of s.addresses(this))this.graph.removeEdge(this.fetchCell(h),a)}}else o.bruteForce=!0;const c=this.arrayMapping.getArray(u);if(c!==void 0)this.graph.addEdge(c,a);else for(const h of u.addresses(this)){const{vertex:d,id:f}=this.fetchCellOrCreateEmpty(h);this.graph.addEdge(f!=null?f:d,a)}this.graph.addEdge(a,r),s.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(o)}else if(i instanceof Ko){const s=t.getAddress(this.lazilyTransformingAstService).sheet,{vertex:o,id:a}=this.fetchNamedExpressionVertex(i.name,s);this.graph.addEdge(a!=null?a:o,r)}else{const{vertex:s,id:o}=this.fetchCellOrCreateEmpty(i);this.graph.addEdge(o!=null?o:s,r)}})}fetchNamedExpressionVertex(e,t){const r=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(r.address)}exchangeNode(e,t){const r=this.fetchCellOrCreateEmpty(e).vertex,i=this.fetchCellOrCreateEmpty(t).vertex;this.addressMapping.removeCell(e),this.exchangeGraphNode(r,i)}correctInfiniteRangesDependency(e){const t=this.graph.getInfiniteRanges().filter(({node:o})=>o.range.addressInRange(e));if(t.length<=0)return;const{vertex:r,id:i}=this.fetchCellOrCreateEmpty(e),s=i!=null?i:this.graph.getNodeId(r);t.forEach(({id:o})=>{this.graph.addEdge(s,o)})}fetchCellOrCreateEmpty(e){const t=this.addressMapping.getCell(e);if(t!==void 0)return{vertex:t,id:void 0};const r=new Wo,i=this.graph.addNodeAndReturnId(r);return this.addressMapping.setCell(e,r),{vertex:r,id:i}}removeRows(e){this.stats.measure(Ze.ADJUSTING_GRAPH,()=>{for(const[r,i]of this.addressMapping.entriesFromRowsSpan(e)){for(const s of this.graph.adjacentNodes(i))this.graph.markNodeAsDirty(s);if(i instanceof En)if(i.isLeftCorner(r))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(Ze.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(e)});const t=this.stats.measure(Ze.ADJUSTING_RANGES,()=>{const r=this.truncateRanges(e,i=>i.row);return this.getArrayVerticesRelatedToRanges(r)});return this.stats.measure(Ze.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){this.clearSheet(e);for(const[t,r]of this.addressMapping.sheetEntries(e)){for(const i of this.graph.adjacentNodes(r))this.graph.markNodeAsDirty(i);this.removeVertex(r),this.addressMapping.removeCell(t)}this.stats.measure(Ze.ADJUSTING_RANGES,()=>{const t=this.rangeMapping.removeRangesInSheet(e);for(const r of t)this.removeVertex(r);this.stats.measure(Ze.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeSheet(e)})})}clearSheet(e){const t=new Set;for(const[r,i]of this.addressMapping.sheetEntries(e))i instanceof En?t.add(i):this.setCellEmpty(r);for(const r of t.values())this.setArrayEmpty(r);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(Ze.ADJUSTING_GRAPH,()=>{for(const[r,i]of this.addressMapping.entriesFromColumnsSpan(e)){for(const s of this.graph.adjacentNodes(i))this.graph.markNodeAsDirty(s);if(i instanceof En)if(i.isLeftCorner(r))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(Ze.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(e)});const t=this.stats.measure(Ze.ADJUSTING_RANGES,()=>{const r=this.truncateRanges(e,i=>i.col);return this.getArrayVerticesRelatedToRanges(r)});return this.stats.measure(Ze.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(Ze.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});const t=this.stats.measure(Ze.ADJUSTING_RANGES,()=>{const r=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(r.verticesWithChangedSize)});this.stats.measure(Ze.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)});for(const r of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsDirty(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:t}}addColumns(e){this.stats.measure(Ze.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});const t=this.stats.measure(Ze.ADJUSTING_RANGES,()=>{const r=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(r.verticesWithChangedSize)});this.stats.measure(Ze.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns));for(const r of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsDirty(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}ensureNoArrayInRange(e){if(this.arrayMapping.isFormulaArrayInRange(e))throw Error("It is not possible to move / replace cells with array")}isThereSpaceForArray(e){const t=e.getRangeOrUndef();if(t===void 0)return!1;for(const r of t.addresses(this)){const i=this.addressMapping.getCell(r);if(i!==void 0&&!(i instanceof Wo)&&i!==e)return!1}return!0}moveCells(e,t,r,i){for(const s of e.addressesWithDirection(t,r,this)){const o=Pe(i,s.col+t,s.row+r);let a=this.addressMapping.getCell(s);const l=this.addressMapping.getCell(o);if(this.addressMapping.removeCell(s),a!==void 0){this.graph.markNodeAsDirty(a),this.addressMapping.setCell(o,a);let u;for(const c of this.graph.adjacentNodes(a))c instanceof vr&&!e.containsRange(c.range)&&(u=u!=null?u:this.fetchCellOrCreateEmpty(s).vertex,this.graph.addEdge(u,c),this.graph.removeEdge(a,c));u&&(this.graph.markNodeAsDirty(u),this.addressMapping.setCell(s,u))}if(l!==void 0){a===void 0&&this.addressMapping.removeCell(o);for(const u of this.graph.adjacentNodes(l))a=a!=null?a:this.fetchCellOrCreateEmpty(o).vertex,this.graph.addEdge(a,u),this.graph.markNodeAsDirty(a);this.removeVertex(l)}}for(const s of this.rangeMapping.rangeVerticesContainedInRange(e))for(const o of this.graph.adjacentNodes(s))if(o instanceof vr&&!e.containsRange(o.range)){this.graph.removeEdge(s,o);for(const a of s.range.addresses(this)){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u!=null?u:l,o),this.addressMapping.setCell(a,l),this.graph.markNodeAsDirty(l)}}this.rangeMapping.moveRangesInsideSourceRange(e,t,r,i)}setArrayEmpty(e){const t=We.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),r=this.graph.adjacentNodes(e);for(const i of t.addresses(this))this.addressMapping.removeCell(i);for(const i of r.values()){const s=Tae(this.functionRegistry,i,e.getRange(),this.lazilyTransformingAstService,this);for(const o of s){const{vertex:a,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l!=null?l:a,i)}s.length>0&&this.graph.markNodeAsDirty(i)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNodeAndReturnId(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNodeAndReturnId(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.getNodes())e instanceof En&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}existsVertex(e){return this.addressMapping.has(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const t=this.addressMapping.getCellValue(e);return t instanceof Be?new D($.VALUE,Q.ScalarExpected):t}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}setArray(e,t){this.arrayMapping.setArray(e,t)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsVolatile(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.getNodes())e instanceof Is&&e.ensureRecentData(this.lazilyTransformingAstService)}getArrayVerticesRelatedToRanges(e){const t=e.map(r=>this.graph.hasNode(r)?Array.from(this.graph.adjacentNodes(r)).filter(i=>i instanceof En):[]);return new Set(...t)}*rawValuesFromRange(e){for(const t of e.addresses(this)){const r=this.getScalarValue(t);r!==ht&&(yield[Le(r),t])}}*entriesFromRange(e){for(const t of e.addresses(this))yield[t,this.getCell(t)]}exchangeGraphNode(e,t){this.graph.addNodeAndReturnId(t);const r=this.graph.adjacentNodes(e);this.removeVertex(e),r.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(t,i)})}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNodeAndReturnId(t)}computeListOfValuesInRange(e){const t=[];for(const r of e.addresses(this)){const i=this.getScalarValue(r);t.push(i)}return t}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const t of this.adjacentArrayVertices(e)){let r;t instanceof hi?r=this.formulaDirectDependenciesToArray(t,e):r=this.rangeDirectDependenciesToArray(t,e);let i=!1;for(const[s,o]of r)e.isLeftCorner(s)&&(i=!0),this.graph.addEdge(o,t),this.graph.markNodeAsDirty(o);i||this.graph.removeEdge(e,t)}this.graph.markNodeAsDirty(e)}isArrayInternalCell(e){const t=this.getCell(e);return t instanceof En&&!t.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=na.empty(),e}getAdjacentNodesAddresses(e){const t=this.graph.adjacentNodes(e),r=[];return t.forEach(i=>{const s=i;s instanceof vr?r.push(Sw(s.start,s.end)):r.push(s.getAddress(this.lazilyTransformingAstService))}),r}correctInfiniteRangesDependenciesByRangeVertex(e){this.graph.getInfiniteRanges().forEach(({id:t,node:r})=>{const i=e.range.intersectionWith(r.range);i!==void 0&&i.addresses(this).forEach(s=>{const{vertex:o,id:a}=this.fetchCellOrCreateEmpty(s);this.graph.addEdge(a!=null?a:o,t)})})}cleanAddressMappingUnderArray(e){const t=e.getRange();for(const r of t.addresses(this)){const i=e.getArrayCellValue(r);this.getCell(r)===e?e.isLeftCorner(r)?this.changes.addChange(new D($.REF),r,i):(this.addressMapping.removeCell(r),this.changes.addChange(ht,r,i)):this.changes.addChange(ht,r,i)}}*formulaDirectDependenciesToArray(e,t){var r;const[,i]=(r=this.formulaDependencyQuery(e))!==null&&r!==void 0?r:[];if(i!==void 0){for(const s of i)if(!(s instanceof Ko||s instanceof We)&&t.getRange().addressInRange(s)){const o=this.fetchCellOrCreateEmpty(s).vertex;yield[s,o]}}}*rangeDirectDependenciesToArray(e,t){const{restRange:r}=this.rangeMapping.findSmallerRange(e.range);for(const i of r.addresses(this))if(t.getRange().addressInRange(i)){const s=this.fetchCellOrCreateEmpty(i).vertex;yield[i,s]}}*adjacentArrayVertices(e){const t=this.graph.adjacentNodes(e);for(const r of t)(r instanceof hi||r instanceof vr)&&(yield r)}addStructuralNodesToChangeSet(){this.graph.markChangingWithStructureNodesAsDirty()}fixRangesWhenAddingRows(e,t,r){const i=Array.from(this.rangeMapping.rangesInSheet(e));for(const s of i)if(s.range.includesRow(t+r))if(s.bruteForce){const o=s.range.rangeWithSameWidth(t,r);for(const a of o.addresses(this)){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u!=null?u:l,s)}}else{let o=s,a=this.rangeMapping.findSmallerRange(o.range);if(a.smallerRangeVertex!==void 0)continue;for(;a.smallerRangeVertex===void 0;){const l=new vr(We.spanFrom(o.range.start,o.range.width(),o.range.height()-1));this.rangeMapping.setRange(l),this.graph.addNodeAndReturnId(l);const u=new We(Pe(o.range.start.sheet,o.range.start.col,o.range.end.row),o.range.end);this.addAllFromRange(u,o),this.graph.addEdge(l,o),o=l,a=this.rangeMapping.findSmallerRange(o.range)}this.graph.addEdge(a.smallerRangeVertex,o),this.addAllFromRange(a.restRange,o),this.graph.removeEdge(a.smallerRangeVertex,s)}}addAllFromRange(e,t){for(const r of e.addresses(this)){const{vertex:i,id:s}=this.fetchCellOrCreateEmpty(r);this.graph.addEdge(s!=null?s:i,t)}}fixRangesWhenAddingColumns(e,t,r){for(const i of this.rangeMapping.rangesInSheet(e))if(i.range.includesColumn(t+r)){let s;i.bruteForce?s=i.range.rangeWithSameHeight(t,r):s=We.spanFrom(Pe(e,t,i.range.end.row),r,1);for(const o of s.addresses(this)){const{vertex:a,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l!=null?l:a,i)}}}exchangeOrAddFormulaVertex(e){const t=e.getAddress(this.lazilyTransformingAstService),r=We.spanFrom(t,e.width,e.height),i=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof En&&this.setArray(r,e),this.exchangeOrAddGraphNode(i,e),this.addressMapping.setCell(t,e),e instanceof En){if(!this.isThereSpaceForArray(e))return;for(const s of r.addresses(this)){if(e.isLeftCorner(s))continue;const o=this.getCell(s);this.exchangeOrAddGraphNode(o,e)}}for(const s of r.addresses(this))this.addressMapping.setCell(s,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),!(e instanceof En))return;const r=We.spanFromOrUndef(t,e.width,e.height);if(r!==void 0&&(this.setArray(r,e),!!this.isThereSpaceForArray(e)))for(const i of r.addresses(this))this.addressMapping.setCell(i,e)}truncateRanges(e,t){const{verticesToRemove:r,verticesToMerge:i,verticesWithChangedSize:s}=this.rangeMapping.truncateRanges(e,t);for(const[o,a]of i)this.mergeRangeVertices(o,a);for(const o of r)this.removeVertexAndCleanupDependencies(o);return s}fixArraysAfterAddingRow(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInRows(Qr.fromRowStartAndEnd(e,t-1,t-1))){const s=i.getRange();for(let o=s.start.col;o<=s.end.col;++o)for(let a=t;a<=s.end.row;++a){const l=Pe(e,o,a),u=Pe(e,o,a+r),c=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(ht,u,c)}}}fixArraysAfterRemovingRows(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInRows(Qr.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(i))for(const s of i.getRange().addresses(this))this.addressMapping.setCell(s,i);else this.setNoSpaceIfArray(i)}fixArraysAfterAddingColumn(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInCols(ci.fromColumnStartAndEnd(e,t-1,t-1))){const s=i.getRange();for(let o=s.start.row;o<=s.end.row;++o)for(let a=t;a<=s.end.col;++a){const l=Pe(e,a,o),u=Pe(e,a+r,o),c=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(ht,u,c)}}}fixArraysAfterRemovingColumns(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-r),!(t<=0))for(const[,i]of this.arrayMapping.arraysInCols(ci.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(i))for(const s of i.getRange().addresses(this))this.addressMapping.setCell(s,i);else this.setNoSpaceIfArray(i)}shrinkPossibleArrayAndGetCell(e){const t=this.getCell(e);return t instanceof En?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof En&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof vr&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,t){const r=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.removeEdgeIfExists(e,t),r.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(e,i)})}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e));for(;t.size>0;){const r=t.values().next().value;t.delete(r);const[i,s]=r;this.graph.hasNode(s)&&this.graph.adjacentNodesCount(s)===0&&((s instanceof vr||s instanceof Wo)&&this.graph.removeNode(s).forEach(o=>t.add(o)),s instanceof vr?this.rangeMapping.removeRange(s):s instanceof Wo&&this.addressMapping.removeCell(i))}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Wo{constructor(){}getCellValue(){return ht}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ra{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}setCellValue(e){throw Error("SetCellValue is deprecated for ValueCellVertex")}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ku{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){return D.parsingError()}getFormula(){return this.rawInput}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class kae{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return(t=this.mapping.get(e.col))===null||t===void 0?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let r=this.mapping.get(e.col);r||(r=new Map,this.mapping.set(e.col,r)),r.set(e.row,t)}has(e){var t;return!!(!((t=this.mapping.get(e.col))===null||t===void 0)&&t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;(t=this.mapping.get(e.col))===null||t===void 0||t.delete(e.row)}addRows(e,t){this.mapping.forEach(r=>{const i=new Map;r.forEach((s,o)=>{o>=e&&(i.set(o+t,s),r.delete(o))}),i.forEach((s,o)=>{r.set(o,s)})}),this.height+=t}addColumns(e,t){const r=new Map;this.mapping.forEach((i,s)=>{s>=e&&(r.set(s+t,i),this.mapping.delete(s))}),r.forEach((i,s)=>{this.mapping.set(s,i)}),this.width+=t}removeRows(e){this.mapping.forEach(i=>{const s=new Map;i.forEach((o,a)=>{a>=e.rowStart&&(i.delete(a),a>e.rowEnd&&s.set(a-e.numberOfRows,o))}),s.forEach((o,a)=>{i.set(a,o)})});const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){const t=new Map;this.mapping.forEach((s,o)=>{o>=e.columnStart&&(this.mapping.delete(o),o>e.columnEnd&&t.set(o-e.numberOfColumns,s))}),t.forEach((s,o)=>{this.mapping.set(o,s)});const r=Math.min(this.width-1,e.columnEnd),i=Math.max(0,r-e.columnStart+1);this.width=Math.max(0,this.width-i)}*getEntries(e){for(const[t,r]of this.mapping)for(const[i,s]of r)yield[Pe(e,t,i),s]}*verticesFromColumn(e){const t=this.mapping.get(e);if(t!==void 0)for(const[r,i]of t)yield i}*verticesFromRow(e){for(const t of this.mapping.values()){const r=t.get(e);r!==void 0&&(yield r)}}*verticesFromColumnsSpan(e){for(const t of e.columns()){const r=this.mapping.get(t);if(r!==void 0)for(const[i,s]of r)yield s}}*verticesFromRowsSpan(e){for(const t of this.mapping.values())for(const r of e.rows()){const i=t.get(r);i!==void 0&&(yield i)}}*entriesFromRowsSpan(e){for(const[t,r]of this.mapping.entries())for(const i of e.rows()){const s=r.get(i);s!==void 0&&(yield[Pe(e.sheet,t,i),s])}}*entriesFromColumnsSpan(e){for(const t of e.columns()){const r=this.mapping.get(t);if(r!==void 0)for(const[i,s]of r.entries())yield[Pe(e.sheet,t,i),s]}}*vertices(){for(const[e,t]of this.mapping)for(const[r,i]of t)i!==void 0&&(yield i)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Fae{constructor(e,t){this.width=e,this.height=t,this.mapping=new Array(t);for(let r=0;r<t;r++)this.mapping[r]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){const t=this.mapping[e.row];return t?!!t[e.col]:!1}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){this.mapping[e.row]!==void 0&&delete this.mapping[e.row][e.col]}addRows(e,t){const r=[];for(let i=0;i<t;i++)r.push(new Array(this.width));this.mapping.splice(e,0,...r),this.height+=t}addColumns(e,t){for(let r=0;r<this.height;r++)this.mapping[r].splice(e,0,...new Array(t));this.width+=t}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){for(let i=0;i<this.height;i++)this.mapping[i].splice(e.columnStart,e.numberOfColumns);const t=Math.min(this.width-1,e.columnEnd),r=Math.max(0,t-e.columnStart+1);this.width=Math.max(0,this.width-r)}*getEntries(e){for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r){const i=this.getCellVertex(r,t);i&&(yield[Pe(e,r,t),i])}}*verticesFromColumn(e){for(let t=0;t<this.height;++t){const r=this.getCellVertex(e,t);r&&(yield r)}}*verticesFromRow(e){for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let r=0;r<this.height;++r){const i=this.getCellVertex(t,r);i&&(yield i)}}*verticesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const i=this.getCellVertex(t,r);i&&(yield i)}}*entriesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const i=this.getCellVertex(t,r);i&&(yield[Pe(e.sheet,t,r),i])}}*entriesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let r=0;r<this.height;++r){const i=this.getCellVertex(t,r);i&&(yield[Pe(e.sheet,t,r),i])}}*vertices(){for(let e=0;e<this.height;++e)for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}getCellVertex(e,t){var r;return(r=this.mapping[t])===null||r===void 0?void 0:r[e]}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var $;(function(n){n.DIV_BY_ZERO="DIV_BY_ZERO",n.NAME="NAME",n.VALUE="VALUE",n.NUM="NUM",n.NA="NA",n.CYCLE="CYCLE",n.REF="REF",n.SPILL="SPILL",n.LIC="LIC",n.ERROR="ERROR"})($||($={}));var Yr;(function(n){n.FORMULA="FORMULA",n.VALUE="VALUE",n.ARRAY="ARRAY",n.EMPTY="EMPTY",n.ARRAYFORMULA="ARRAYFORMULA"})(Yr||(Yr={}));const Hae=(n,e)=>n instanceof En?n.isLeftCorner(e)?Yr.ARRAYFORMULA:Yr.ARRAY:n instanceof Is||n instanceof ku?Yr.FORMULA:n instanceof ra?Yr.VALUE:Yr.EMPTY;var zp;(function(n){n.EMPTY="EMPTY",n.NUMBER="NUMBER",n.STRING="STRING",n.BOOLEAN="BOOLEAN",n.ERROR="ERROR"})(zp||(zp={}));var bw;(function(n){n.NUMBER="NUMBER"})(bw||(bw={}));const Zi=Object.assign(Object.assign({},zp),bw),Uae=Object.assign(Object.assign({},zp),He),w4=n=>{switch(n){case Zi.EMPTY:return 0;case Zi.NUMBER:return 1;case Zi.STRING:return 2;case Zi.BOOLEAN:return 3;case Zi.ERROR:return 4}throw new Error("Cell value not computed")},Yp=n=>{if(n===ht)return Zi.EMPTY;if(n instanceof D||n instanceof Be)return Zi.ERROR;if(typeof n=="string")return Zi.STRING;if(At(n))return Zi.NUMBER;if(typeof n=="boolean")return Zi.BOOLEAN;throw new Error("Cell value not computed")},Bae=n=>At(n)?yae(n):Yp(n),Vae=n=>{if(At(n))return wae(n)};class D{constructor(e,t,r){this.type=e,this.message=t,this.root=r}static parsingError(){return new D($.ERROR,Q.ParseError)}attachRootVertex(e){return this.root===void 0?new D(this.type,this.message,e):this}}const GI=(n,e)=>({sheet:n,row:e}),$ae=n=>n.row<0,zI=(n,e)=>({sheet:n,col:e}),Wae=n=>n.col<0,Pe=(n,e,t)=>({sheet:n,col:e,row:t}),qr=n=>n.col<0||n.row<0,Gae=(n,e,t,r)=>Pe(e,n.col+t,n.row+r),Mh=n=>`${n.sheet},${n.row},${n.col}`;function vn(n){return n&&(typeof n=="object"||typeof n=="function")?"col"in n&&typeof n.col=="number"&&"row"in n&&typeof n.row=="number"&&"sheet"in n&&typeof n.sheet=="number":!1}const ns=(n,e)=>{var t;return(t=n.sheet)!==null&&t!==void 0?t:e.sheet},cd=(n,e)=>n.sheet===e.sheet&&n.col===e.col&&n.row===e.row;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const zae="AbsoluteCellRange: Wrong range size";function ai(n){return n&&(typeof n=="object"||typeof n=="function")?"start"in n&&vn(n.start)&&"end"in n&&vn(n.end):!1}const Sw=(n,e)=>({start:n,end:e});class We{constructor(e,t){if(e.sheet!==t.sheet)throw new ad(e.sheet,t.sheet);this.start=Pe(e.sheet,e.col,e.row),this.end=Pe(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new ad(e.sheet,t.sheet);const r=t.col-e.col,i=t.row-e.row;return Number.isFinite(i)&&Number.isFinite(r)?new We(e,t):Number.isFinite(i)?new vo(e.sheet,e.row,t.row):new wo(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===W.CELL_RANGE?We.fromCellRange(e,t):e.type===W.COLUMN_RANGE?wo.fromColumnRange(e,t):vo.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return We.fromAst(e,t)}catch{return}}static fromCellRange(e,t){return new We(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,r){const i=We.spanFromOrUndef(e,t,r);if(i===void 0)throw new Error(zae);return i}static spanFromOrUndef(e,t,r){if(!Number.isFinite(t)&&Number.isFinite(r))return e.col!==0?void 0:new vo(e.sheet,e.row,e.row+r-1);if(!Number.isFinite(r)&&Number.isFinite(t))return e.row!==0?void 0:new wo(e.sheet,e.col,e.col+t-1);if(Number.isFinite(r)&&Number.isFinite(t))return new We(e,Pe(e.sheet,e.col+t-1,e.row+r-1))}static fromCoordinates(e,t,r,i,s){return new We(Pe(e,t,r),Pe(e,i,s))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet!==e.sheet?!1:this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const t=Math.max(this.start.row,e.start.row),r=Math.min(this.end.row,e.end.row),i=Math.max(this.start.col,e.start.col),s=Math.min(this.end.col,e.end.col);if(!(t>r||i>s))return new We(Pe(this.sheet,i,t),Pe(this.sheet,s,r))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return We.spanFrom(Pe(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof Qr?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return We.spanFrom(Pe(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return We.spanFrom(Pe(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let t=0;t<this.height();++t){e[t]=[];for(let r=0;r<this.width();++r){const i=Pe(this.sheet,this.start.col+r,this.start.row+t);e[t].push(i)}}return e}withStart(e){return new We(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return cd(this.start,e.start)&&cd(this.end,e.end)}addressesArrayMap(e,t){const r=[];let i=this.start.row;for(;i<=this.effectiveEndRow(e);){let s=this.start.col;const o=[];for(;s<=this.effectiveEndColumn(e);)o.push(t(Pe(this.start.sheet,s,i))),s++;r.push(o),i++}return r}addresses(e){const t=[];let r=this.start.row;const i=this.effectiveEndRow(e),s=this.effectiveEndColumn(e);for(;r<=i;){let o=this.start.col;for(;o<=s;)t.push(Pe(this.start.sheet,o,r)),o++;r++}return t}*addressesWithDirection(e,t,r){if(e>0)if(t>0){let i=this.effectiveEndRow(r);for(;i>=this.start.row;){let s=this.effectiveEndColumn(r);for(;s>=this.start.col;)yield Pe(this.start.sheet,s,i),s-=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(r);){let s=this.effectiveEndColumn(r);for(;s>=this.start.col;)yield Pe(this.start.sheet,s,i),s-=1;i+=1}}else if(t>0){let i=this.effectiveEndRow(r);for(;i>=this.start.row;){let s=this.start.col;for(;s<=this.effectiveEndColumn(r);)yield Pe(this.start.sheet,s,i),s+=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(r);){let s=this.start.col;for(;s<=this.effectiveEndColumn(r);)yield Pe(this.start.sheet,s,i),s+=1;i+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return Pe(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row){const r=t-e+1;return this.shiftByRows(-r)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col){const r=t-e+1;return this.shiftByColumns(-r)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}class wo extends We{constructor(e,t,r){super(Pe(e,t,0),Pe(e,r,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){const r=e.start.toSimpleColumnAddress(t),i=e.end.toSimpleColumnAddress(t);if(r.sheet!==i.sheet)throw new ad(r.sheet,i.sheet);return new wo(r.sheet,r.col,i.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new wo(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new wo(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}class vo extends We{constructor(e,t,r){super(Pe(e,0,t),Pe(e,Number.POSITIVE_INFINITY,r))}static fromRowRangeAst(e,t){const r=e.start.toSimpleRowAddress(t),i=e.end.toSimpleRowAddress(t);if(r.sheet!==i.sheet)throw new ad(r.sheet,i.sheet);return new vo(r.sheet,r.row,i.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new vo(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new vo(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ls{constructor(e,t,r){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=r}}var YI={exports:{}};(function(n){(function(e){for(var t=[null,0,{}],r=10,i=44032,s=4352,o=4449,a=4519,l=19,u=21,c=28,h=u*c,d=l*h,f=function(O,g){this.codepoint=O,this.feature=g},m={},p=[],y=0;y<=255;++y)p[y]=0;function C(O,g,E){var A=m[g];return A||(A=O(g,E),!!A.feature&&++p[g>>8&255]>r&&(m[g]=A)),A}function b(O,g,E){var A=g&65280,U=f.udata[A]||{},G=U[g];return G?new f(g,G):new f(g,t)}function v(O,g,E){return E?O(g,E):new f(g,null)}function S(O,g,E){var A;if(g<s||s+l<=g&&g<i||i+d<g)return O(g,E);if(s<=g&&g<s+l){var U={},G=(g-s)*u;for(A=0;A<u;++A)U[o+A]=i+c*(A+G);return new f(g,[,,U])}var V=g-i,oe=V%c,j=[];if(oe!==0)j[0]=[i+V-oe,a+oe];else for(j[0]=[s+Math.floor(V/h),o+Math.floor(V%h/c)],j[2]={},A=1;A<c;++A)j[2][a+A]=g+A;return new f(g,j)}function L(O,g,E){return g<60||13311<g&&g<42607?new f(g,t):O(g,E)}var _=[L,C,v,S,b];f.fromCharCode=_.reduceRight(function(O,g){return function(E,A){return g(O,E,A)}},null),f.isHighSurrogate=function(O){return O>=55296&&O<=56319},f.isLowSurrogate=function(O){return O>=56320&&O<=57343},f.prototype.prepFeature=function(){this.feature||(this.feature=f.fromCharCode(this.codepoint,!0).feature)},f.prototype.toString=function(){if(this.codepoint<65536)return String.fromCharCode(this.codepoint);var O=this.codepoint-65536;return String.fromCharCode(Math.floor(O/1024)+55296,O%1024+56320)},f.prototype.getDecomp=function(){return this.prepFeature(),this.feature[0]||null},f.prototype.isCompatibility=function(){return this.prepFeature(),!!this.feature[1]&&this.feature[1]&1<<8},f.prototype.isExclude=function(){return this.prepFeature(),!!this.feature[1]&&this.feature[1]&1<<9},f.prototype.getCanonicalClass=function(){return this.prepFeature(),this.feature[1]?this.feature[1]&255:0},f.prototype.getComposite=function(O){if(this.prepFeature(),!this.feature[2])return null;var g=this.feature[2][O.codepoint];return g?f.fromCharCode(g):null};var P=function(O){this.str=O,this.cursor=0};P.prototype.next=function(){if(!!this.str&&this.cursor<this.str.length){var O=this.str.charCodeAt(this.cursor++),g;return f.isHighSurrogate(O)&&this.cursor<this.str.length&&f.isLowSurrogate(g=this.str.charCodeAt(this.cursor))&&(O=(O-55296)*1024+(g-56320)+65536,++this.cursor),f.fromCharCode(O)}else return this.str=null,null};var x=function(O,g){this.it=O,this.canonical=g,this.resBuf=[]};x.prototype.next=function(){function O(E,A){var U=A.getDecomp();if(!!U&&!(E&&A.isCompatibility())){for(var G=[],V=0;V<U.length;++V){var oe=O(E,f.fromCharCode(U[V]));G=G.concat(oe)}return G}else return[A]}if(this.resBuf.length===0){var g=this.it.next();if(!g)return null;this.resBuf=O(this.canonical,g)}return this.resBuf.shift()};var I=function(O){this.it=O,this.resBuf=[]};I.prototype.next=function(){var O;if(this.resBuf.length===0)do{var g=this.it.next();if(!g)break;O=g.getCanonicalClass();var E=this.resBuf.length;if(O!==0)for(;E>0;--E){var A=this.resBuf[E-1],U=A.getCanonicalClass();if(U<=O)break}this.resBuf.splice(E,0,g)}while(O!==0);return this.resBuf.shift()};var R=function(O){this.it=O,this.procBuf=[],this.resBuf=[],this.lastClass=null};R.prototype.next=function(){for(;this.resBuf.length===0;){var O=this.it.next();if(!O){this.resBuf=this.procBuf,this.procBuf=[];break}if(this.procBuf.length===0)this.lastClass=O.getCanonicalClass(),this.procBuf.push(O);else{var g=this.procBuf[0],E=g.getComposite(O),A=O.getCanonicalClass();!!E&&(this.lastClass<A||this.lastClass===0)?this.procBuf[0]=E:(A===0&&(this.resBuf=this.procBuf,this.procBuf=[]),this.lastClass=A,this.procBuf.push(O))}}return this.resBuf.shift()};var N=function(O,g){switch(O){case"NFD":return new I(new x(new P(g),!0));case"NFKD":return new I(new x(new P(g),!1));case"NFC":return new R(new I(new x(new P(g),!0)));case"NFKC":return new R(new I(new x(new P(g),!1)))}throw O+" is invalid"},H=function(O,g){for(var E=N(O,g),A="",U;U=E.next();)A+=U.toString();return A};function K(O){return H("NFD",O)}function X(O){return H("NFKD",O)}function J(O){return H("NFC",O)}function ue(O){return H("NFKC",O)}f.udata={0:{60:[,,{824:8814}],61:[,,{824:8800}],62:[,,{824:8815}],65:[,,{768:192,769:193,770:194,771:195,772:256,774:258,775:550,776:196,777:7842,778:197,780:461,783:512,785:514,803:7840,805:7680,808:260}],66:[,,{775:7682,803:7684,817:7686}],67:[,,{769:262,770:264,775:266,780:268,807:199}],68:[,,{775:7690,780:270,803:7692,807:7696,813:7698,817:7694}],69:[,,{768:200,769:201,770:202,771:7868,772:274,774:276,775:278,776:203,777:7866,780:282,783:516,785:518,803:7864,807:552,808:280,813:7704,816:7706}],70:[,,{775:7710}],71:[,,{769:500,770:284,772:7712,774:286,775:288,780:486,807:290}],72:[,,{770:292,775:7714,776:7718,780:542,803:7716,807:7720,814:7722}],73:[,,{768:204,769:205,770:206,771:296,772:298,774:300,775:304,776:207,777:7880,780:463,783:520,785:522,803:7882,808:302,816:7724}],74:[,,{770:308}],75:[,,{769:7728,780:488,803:7730,807:310,817:7732}],76:[,,{769:313,780:317,803:7734,807:315,813:7740,817:7738}],77:[,,{769:7742,775:7744,803:7746}],78:[,,{768:504,769:323,771:209,775:7748,780:327,803:7750,807:325,813:7754,817:7752}],79:[,,{768:210,769:211,770:212,771:213,772:332,774:334,775:558,776:214,777:7886,779:336,780:465,783:524,785:526,795:416,803:7884,808:490}],80:[,,{769:7764,775:7766}],82:[,,{769:340,775:7768,780:344,783:528,785:530,803:7770,807:342,817:7774}],83:[,,{769:346,770:348,775:7776,780:352,803:7778,806:536,807:350}],84:[,,{775:7786,780:356,803:7788,806:538,807:354,813:7792,817:7790}],85:[,,{768:217,769:218,770:219,771:360,772:362,774:364,776:220,777:7910,778:366,779:368,780:467,783:532,785:534,795:431,803:7908,804:7794,808:370,813:7798,816:7796}],86:[,,{771:7804,803:7806}],87:[,,{768:7808,769:7810,770:372,775:7814,776:7812,803:7816}],88:[,,{775:7818,776:7820}],89:[,,{768:7922,769:221,770:374,771:7928,772:562,775:7822,776:376,777:7926,803:7924}],90:[,,{769:377,770:7824,775:379,780:381,803:7826,817:7828}],97:[,,{768:224,769:225,770:226,771:227,772:257,774:259,775:551,776:228,777:7843,778:229,780:462,783:513,785:515,803:7841,805:7681,808:261}],98:[,,{775:7683,803:7685,817:7687}],99:[,,{769:263,770:265,775:267,780:269,807:231}],100:[,,{775:7691,780:271,803:7693,807:7697,813:7699,817:7695}],101:[,,{768:232,769:233,770:234,771:7869,772:275,774:277,775:279,776:235,777:7867,780:283,783:517,785:519,803:7865,807:553,808:281,813:7705,816:7707}],102:[,,{775:7711}],103:[,,{769:501,770:285,772:7713,774:287,775:289,780:487,807:291}],104:[,,{770:293,775:7715,776:7719,780:543,803:7717,807:7721,814:7723,817:7830}],105:[,,{768:236,769:237,770:238,771:297,772:299,774:301,776:239,777:7881,780:464,783:521,785:523,803:7883,808:303,816:7725}],106:[,,{770:309,780:496}],107:[,,{769:7729,780:489,803:7731,807:311,817:7733}],108:[,,{769:314,780:318,803:7735,807:316,813:7741,817:7739}],109:[,,{769:7743,775:7745,803:7747}],110:[,,{768:505,769:324,771:241,775:7749,780:328,803:7751,807:326,813:7755,817:7753}],111:[,,{768:242,769:243,770:244,771:245,772:333,774:335,775:559,776:246,777:7887,779:337,780:466,783:525,785:527,795:417,803:7885,808:491}],112:[,,{769:7765,775:7767}],114:[,,{769:341,775:7769,780:345,783:529,785:531,803:7771,807:343,817:7775}],115:[,,{769:347,770:349,775:7777,780:353,803:7779,806:537,807:351}],116:[,,{775:7787,776:7831,780:357,803:7789,806:539,807:355,813:7793,817:7791}],117:[,,{768:249,769:250,770:251,771:361,772:363,774:365,776:252,777:7911,778:367,779:369,780:468,783:533,785:535,795:432,803:7909,804:7795,808:371,813:7799,816:7797}],118:[,,{771:7805,803:7807}],119:[,,{768:7809,769:7811,770:373,775:7815,776:7813,778:7832,803:7817}],120:[,,{775:7819,776:7821}],121:[,,{768:7923,769:253,770:375,771:7929,772:563,775:7823,776:255,777:7927,778:7833,803:7925}],122:[,,{769:378,770:7825,775:380,780:382,803:7827,817:7829}],160:[[32],256],168:[[32,776],256,{768:8173,769:901,834:8129}],170:[[97],256],175:[[32,772],256],178:[[50],256],179:[[51],256],180:[[32,769],256],181:[[956],256],184:[[32,807],256],185:[[49],256],186:[[111],256],188:[[49,8260,52],256],189:[[49,8260,50],256],190:[[51,8260,52],256],192:[[65,768]],193:[[65,769]],194:[[65,770],,{768:7846,769:7844,771:7850,777:7848}],195:[[65,771]],196:[[65,776],,{772:478}],197:[[65,778],,{769:506}],198:[,,{769:508,772:482}],199:[[67,807],,{769:7688}],200:[[69,768]],201:[[69,769]],202:[[69,770],,{768:7872,769:7870,771:7876,777:7874}],203:[[69,776]],204:[[73,768]],205:[[73,769]],206:[[73,770]],207:[[73,776],,{769:7726}],209:[[78,771]],210:[[79,768]],211:[[79,769]],212:[[79,770],,{768:7890,769:7888,771:7894,777:7892}],213:[[79,771],,{769:7756,772:556,776:7758}],214:[[79,776],,{772:554}],216:[,,{769:510}],217:[[85,768]],218:[[85,769]],219:[[85,770]],220:[[85,776],,{768:475,769:471,772:469,780:473}],221:[[89,769]],224:[[97,768]],225:[[97,769]],226:[[97,770],,{768:7847,769:7845,771:7851,777:7849}],227:[[97,771]],228:[[97,776],,{772:479}],229:[[97,778],,{769:507}],230:[,,{769:509,772:483}],231:[[99,807],,{769:7689}],232:[[101,768]],233:[[101,769]],234:[[101,770],,{768:7873,769:7871,771:7877,777:7875}],235:[[101,776]],236:[[105,768]],237:[[105,769]],238:[[105,770]],239:[[105,776],,{769:7727}],241:[[110,771]],242:[[111,768]],243:[[111,769]],244:[[111,770],,{768:7891,769:7889,771:7895,777:7893}],245:[[111,771],,{769:7757,772:557,776:7759}],246:[[111,776],,{772:555}],248:[,,{769:511}],249:[[117,768]],250:[[117,769]],251:[[117,770]],252:[[117,776],,{768:476,769:472,772:470,780:474}],253:[[121,769]],255:[[121,776]]},256:{256:[[65,772]],257:[[97,772]],258:[[65,774],,{768:7856,769:7854,771:7860,777:7858}],259:[[97,774],,{768:7857,769:7855,771:7861,777:7859}],260:[[65,808]],261:[[97,808]],262:[[67,769]],263:[[99,769]],264:[[67,770]],265:[[99,770]],266:[[67,775]],267:[[99,775]],268:[[67,780]],269:[[99,780]],270:[[68,780]],271:[[100,780]],274:[[69,772],,{768:7700,769:7702}],275:[[101,772],,{768:7701,769:7703}],276:[[69,774]],277:[[101,774]],278:[[69,775]],279:[[101,775]],280:[[69,808]],281:[[101,808]],282:[[69,780]],283:[[101,780]],284:[[71,770]],285:[[103,770]],286:[[71,774]],287:[[103,774]],288:[[71,775]],289:[[103,775]],290:[[71,807]],291:[[103,807]],292:[[72,770]],293:[[104,770]],296:[[73,771]],297:[[105,771]],298:[[73,772]],299:[[105,772]],300:[[73,774]],301:[[105,774]],302:[[73,808]],303:[[105,808]],304:[[73,775]],306:[[73,74],256],307:[[105,106],256],308:[[74,770]],309:[[106,770]],310:[[75,807]],311:[[107,807]],313:[[76,769]],314:[[108,769]],315:[[76,807]],316:[[108,807]],317:[[76,780]],318:[[108,780]],319:[[76,183],256],320:[[108,183],256],323:[[78,769]],324:[[110,769]],325:[[78,807]],326:[[110,807]],327:[[78,780]],328:[[110,780]],329:[[700,110],256],332:[[79,772],,{768:7760,769:7762}],333:[[111,772],,{768:7761,769:7763}],334:[[79,774]],335:[[111,774]],336:[[79,779]],337:[[111,779]],340:[[82,769]],341:[[114,769]],342:[[82,807]],343:[[114,807]],344:[[82,780]],345:[[114,780]],346:[[83,769],,{775:7780}],347:[[115,769],,{775:7781}],348:[[83,770]],349:[[115,770]],350:[[83,807]],351:[[115,807]],352:[[83,780],,{775:7782}],353:[[115,780],,{775:7783}],354:[[84,807]],355:[[116,807]],356:[[84,780]],357:[[116,780]],360:[[85,771],,{769:7800}],361:[[117,771],,{769:7801}],362:[[85,772],,{776:7802}],363:[[117,772],,{776:7803}],364:[[85,774]],365:[[117,774]],366:[[85,778]],367:[[117,778]],368:[[85,779]],369:[[117,779]],370:[[85,808]],371:[[117,808]],372:[[87,770]],373:[[119,770]],374:[[89,770]],375:[[121,770]],376:[[89,776]],377:[[90,769]],378:[[122,769]],379:[[90,775]],380:[[122,775]],381:[[90,780]],382:[[122,780]],383:[[115],256,{775:7835}],416:[[79,795],,{768:7900,769:7898,771:7904,777:7902,803:7906}],417:[[111,795],,{768:7901,769:7899,771:7905,777:7903,803:7907}],431:[[85,795],,{768:7914,769:7912,771:7918,777:7916,803:7920}],432:[[117,795],,{768:7915,769:7913,771:7919,777:7917,803:7921}],439:[,,{780:494}],452:[[68,381],256],453:[[68,382],256],454:[[100,382],256],455:[[76,74],256],456:[[76,106],256],457:[[108,106],256],458:[[78,74],256],459:[[78,106],256],460:[[110,106],256],461:[[65,780]],462:[[97,780]],463:[[73,780]],464:[[105,780]],465:[[79,780]],466:[[111,780]],467:[[85,780]],468:[[117,780]],469:[[220,772]],470:[[252,772]],471:[[220,769]],472:[[252,769]],473:[[220,780]],474:[[252,780]],475:[[220,768]],476:[[252,768]],478:[[196,772]],479:[[228,772]],480:[[550,772]],481:[[551,772]],482:[[198,772]],483:[[230,772]],486:[[71,780]],487:[[103,780]],488:[[75,780]],489:[[107,780]],490:[[79,808],,{772:492}],491:[[111,808],,{772:493}],492:[[490,772]],493:[[491,772]],494:[[439,780]],495:[[658,780]],496:[[106,780]],497:[[68,90],256],498:[[68,122],256],499:[[100,122],256],500:[[71,769]],501:[[103,769]],504:[[78,768]],505:[[110,768]],506:[[197,769]],507:[[229,769]],508:[[198,769]],509:[[230,769]],510:[[216,769]],511:[[248,769]],66045:[,220]},512:{512:[[65,783]],513:[[97,783]],514:[[65,785]],515:[[97,785]],516:[[69,783]],517:[[101,783]],518:[[69,785]],519:[[101,785]],520:[[73,783]],521:[[105,783]],522:[[73,785]],523:[[105,785]],524:[[79,783]],525:[[111,783]],526:[[79,785]],527:[[111,785]],528:[[82,783]],529:[[114,783]],530:[[82,785]],531:[[114,785]],532:[[85,783]],533:[[117,783]],534:[[85,785]],535:[[117,785]],536:[[83,806]],537:[[115,806]],538:[[84,806]],539:[[116,806]],542:[[72,780]],543:[[104,780]],550:[[65,775],,{772:480}],551:[[97,775],,{772:481}],552:[[69,807],,{774:7708}],553:[[101,807],,{774:7709}],554:[[214,772]],555:[[246,772]],556:[[213,772]],557:[[245,772]],558:[[79,775],,{772:560}],559:[[111,775],,{772:561}],560:[[558,772]],561:[[559,772]],562:[[89,772]],563:[[121,772]],658:[,,{780:495}],688:[[104],256],689:[[614],256],690:[[106],256],691:[[114],256],692:[[633],256],693:[[635],256],694:[[641],256],695:[[119],256],696:[[121],256],728:[[32,774],256],729:[[32,775],256],730:[[32,778],256],731:[[32,808],256],732:[[32,771],256],733:[[32,779],256],736:[[611],256],737:[[108],256],738:[[115],256],739:[[120],256],740:[[661],256],66272:[,220]},768:{768:[,230],769:[,230],770:[,230],771:[,230],772:[,230],773:[,230],774:[,230],775:[,230],776:[,230,{769:836}],777:[,230],778:[,230],779:[,230],780:[,230],781:[,230],782:[,230],783:[,230],784:[,230],785:[,230],786:[,230],787:[,230],788:[,230],789:[,232],790:[,220],791:[,220],792:[,220],793:[,220],794:[,232],795:[,216],796:[,220],797:[,220],798:[,220],799:[,220],800:[,220],801:[,202],802:[,202],803:[,220],804:[,220],805:[,220],806:[,220],807:[,202],808:[,202],809:[,220],810:[,220],811:[,220],812:[,220],813:[,220],814:[,220],815:[,220],816:[,220],817:[,220],818:[,220],819:[,220],820:[,1],821:[,1],822:[,1],823:[,1],824:[,1],825:[,220],826:[,220],827:[,220],828:[,220],829:[,230],830:[,230],831:[,230],832:[[768],230],833:[[769],230],834:[,230],835:[[787],230],836:[[776,769],230],837:[,240],838:[,230],839:[,220],840:[,220],841:[,220],842:[,230],843:[,230],844:[,230],845:[,220],846:[,220],848:[,230],849:[,230],850:[,230],851:[,220],852:[,220],853:[,220],854:[,220],855:[,230],856:[,232],857:[,220],858:[,220],859:[,230],860:[,233],861:[,234],862:[,234],863:[,233],864:[,234],865:[,234],866:[,233],867:[,230],868:[,230],869:[,230],870:[,230],871:[,230],872:[,230],873:[,230],874:[,230],875:[,230],876:[,230],877:[,230],878:[,230],879:[,230],884:[[697]],890:[[32,837],256],894:[[59]],900:[[32,769],256],901:[[168,769]],902:[[913,769]],903:[[183]],904:[[917,769]],905:[[919,769]],906:[[921,769]],908:[[927,769]],910:[[933,769]],911:[[937,769]],912:[[970,769]],913:[,,{768:8122,769:902,772:8121,774:8120,787:7944,788:7945,837:8124}],917:[,,{768:8136,769:904,787:7960,788:7961}],919:[,,{768:8138,769:905,787:7976,788:7977,837:8140}],921:[,,{768:8154,769:906,772:8153,774:8152,776:938,787:7992,788:7993}],927:[,,{768:8184,769:908,787:8008,788:8009}],929:[,,{788:8172}],933:[,,{768:8170,769:910,772:8169,774:8168,776:939,788:8025}],937:[,,{768:8186,769:911,787:8040,788:8041,837:8188}],938:[[921,776]],939:[[933,776]],940:[[945,769],,{837:8116}],941:[[949,769]],942:[[951,769],,{837:8132}],943:[[953,769]],944:[[971,769]],945:[,,{768:8048,769:940,772:8113,774:8112,787:7936,788:7937,834:8118,837:8115}],949:[,,{768:8050,769:941,787:7952,788:7953}],951:[,,{768:8052,769:942,787:7968,788:7969,834:8134,837:8131}],953:[,,{768:8054,769:943,772:8145,774:8144,776:970,787:7984,788:7985,834:8150}],959:[,,{768:8056,769:972,787:8e3,788:8001}],961:[,,{787:8164,788:8165}],965:[,,{768:8058,769:973,772:8161,774:8160,776:971,787:8016,788:8017,834:8166}],969:[,,{768:8060,769:974,787:8032,788:8033,834:8182,837:8179}],970:[[953,776],,{768:8146,769:912,834:8151}],971:[[965,776],,{768:8162,769:944,834:8167}],972:[[959,769]],973:[[965,769]],974:[[969,769],,{837:8180}],976:[[946],256],977:[[952],256],978:[[933],256,{769:979,776:980}],979:[[978,769]],980:[[978,776]],981:[[966],256],982:[[960],256],1008:[[954],256],1009:[[961],256],1010:[[962],256],1012:[[920],256],1013:[[949],256],1017:[[931],256],66422:[,230],66423:[,230],66424:[,230],66425:[,230],66426:[,230]},1024:{1024:[[1045,768]],1025:[[1045,776]],1027:[[1043,769]],1030:[,,{776:1031}],1031:[[1030,776]],1036:[[1050,769]],1037:[[1048,768]],1038:[[1059,774]],1040:[,,{774:1232,776:1234}],1043:[,,{769:1027}],1045:[,,{768:1024,774:1238,776:1025}],1046:[,,{774:1217,776:1244}],1047:[,,{776:1246}],1048:[,,{768:1037,772:1250,774:1049,776:1252}],1049:[[1048,774]],1050:[,,{769:1036}],1054:[,,{776:1254}],1059:[,,{772:1262,774:1038,776:1264,779:1266}],1063:[,,{776:1268}],1067:[,,{776:1272}],1069:[,,{776:1260}],1072:[,,{774:1233,776:1235}],1075:[,,{769:1107}],1077:[,,{768:1104,774:1239,776:1105}],1078:[,,{774:1218,776:1245}],1079:[,,{776:1247}],1080:[,,{768:1117,772:1251,774:1081,776:1253}],1081:[[1080,774]],1082:[,,{769:1116}],1086:[,,{776:1255}],1091:[,,{772:1263,774:1118,776:1265,779:1267}],1095:[,,{776:1269}],1099:[,,{776:1273}],1101:[,,{776:1261}],1104:[[1077,768]],1105:[[1077,776]],1107:[[1075,769]],1110:[,,{776:1111}],1111:[[1110,776]],1116:[[1082,769]],1117:[[1080,768]],1118:[[1091,774]],1140:[,,{783:1142}],1141:[,,{783:1143}],1142:[[1140,783]],1143:[[1141,783]],1155:[,230],1156:[,230],1157:[,230],1158:[,230],1159:[,230],1217:[[1046,774]],1218:[[1078,774]],1232:[[1040,774]],1233:[[1072,774]],1234:[[1040,776]],1235:[[1072,776]],1238:[[1045,774]],1239:[[1077,774]],1240:[,,{776:1242}],1241:[,,{776:1243}],1242:[[1240,776]],1243:[[1241,776]],1244:[[1046,776]],1245:[[1078,776]],1246:[[1047,776]],1247:[[1079,776]],1250:[[1048,772]],1251:[[1080,772]],1252:[[1048,776]],1253:[[1080,776]],1254:[[1054,776]],1255:[[1086,776]],1256:[,,{776:1258}],1257:[,,{776:1259}],1258:[[1256,776]],1259:[[1257,776]],1260:[[1069,776]],1261:[[1101,776]],1262:[[1059,772]],1263:[[1091,772]],1264:[[1059,776]],1265:[[1091,776]],1266:[[1059,779]],1267:[[1091,779]],1268:[[1063,776]],1269:[[1095,776]],1272:[[1067,776]],1273:[[1099,776]]},1280:{1415:[[1381,1410],256],1425:[,220],1426:[,230],1427:[,230],1428:[,230],1429:[,230],1430:[,220],1431:[,230],1432:[,230],1433:[,230],1434:[,222],1435:[,220],1436:[,230],1437:[,230],1438:[,230],1439:[,230],1440:[,230],1441:[,230],1442:[,220],1443:[,220],1444:[,220],1445:[,220],1446:[,220],1447:[,220],1448:[,230],1449:[,230],1450:[,220],1451:[,230],1452:[,230],1453:[,222],1454:[,228],1455:[,230],1456:[,10],1457:[,11],1458:[,12],1459:[,13],1460:[,14],1461:[,15],1462:[,16],1463:[,17],1464:[,18],1465:[,19],1466:[,19],1467:[,20],1468:[,21],1469:[,22],1471:[,23],1473:[,24],1474:[,25],1476:[,230],1477:[,220],1479:[,18]},1536:{1552:[,230],1553:[,230],1554:[,230],1555:[,230],1556:[,230],1557:[,230],1558:[,230],1559:[,230],1560:[,30],1561:[,31],1562:[,32],1570:[[1575,1619]],1571:[[1575,1620]],1572:[[1608,1620]],1573:[[1575,1621]],1574:[[1610,1620]],1575:[,,{1619:1570,1620:1571,1621:1573}],1608:[,,{1620:1572}],1610:[,,{1620:1574}],1611:[,27],1612:[,28],1613:[,29],1614:[,30],1615:[,31],1616:[,32],1617:[,33],1618:[,34],1619:[,230],1620:[,230],1621:[,220],1622:[,220],1623:[,230],1624:[,230],1625:[,230],1626:[,230],1627:[,230],1628:[,220],1629:[,230],1630:[,230],1631:[,220],1648:[,35],1653:[[1575,1652],256],1654:[[1608,1652],256],1655:[[1735,1652],256],1656:[[1610,1652],256],1728:[[1749,1620]],1729:[,,{1620:1730}],1730:[[1729,1620]],1746:[,,{1620:1747}],1747:[[1746,1620]],1749:[,,{1620:1728}],1750:[,230],1751:[,230],1752:[,230],1753:[,230],1754:[,230],1755:[,230],1756:[,230],1759:[,230],1760:[,230],1761:[,230],1762:[,230],1763:[,220],1764:[,230],1767:[,230],1768:[,230],1770:[,220],1771:[,230],1772:[,230],1773:[,220]},1792:{1809:[,36],1840:[,230],1841:[,220],1842:[,230],1843:[,230],1844:[,220],1845:[,230],1846:[,230],1847:[,220],1848:[,220],1849:[,220],1850:[,230],1851:[,220],1852:[,220],1853:[,230],1854:[,220],1855:[,230],1856:[,230],1857:[,230],1858:[,220],1859:[,230],1860:[,220],1861:[,230],1862:[,220],1863:[,230],1864:[,220],1865:[,230],1866:[,230],2027:[,230],2028:[,230],2029:[,230],2030:[,230],2031:[,230],2032:[,230],2033:[,230],2034:[,220],2035:[,230]},2048:{2070:[,230],2071:[,230],2072:[,230],2073:[,230],2075:[,230],2076:[,230],2077:[,230],2078:[,230],2079:[,230],2080:[,230],2081:[,230],2082:[,230],2083:[,230],2085:[,230],2086:[,230],2087:[,230],2089:[,230],2090:[,230],2091:[,230],2092:[,230],2093:[,230],2137:[,220],2138:[,220],2139:[,220],2276:[,230],2277:[,230],2278:[,220],2279:[,230],2280:[,230],2281:[,220],2282:[,230],2283:[,230],2284:[,230],2285:[,220],2286:[,220],2287:[,220],2288:[,27],2289:[,28],2290:[,29],2291:[,230],2292:[,230],2293:[,230],2294:[,220],2295:[,230],2296:[,230],2297:[,220],2298:[,220],2299:[,230],2300:[,230],2301:[,230],2302:[,230],2303:[,230]},2304:{2344:[,,{2364:2345}],2345:[[2344,2364]],2352:[,,{2364:2353}],2353:[[2352,2364]],2355:[,,{2364:2356}],2356:[[2355,2364]],2364:[,7],2381:[,9],2385:[,230],2386:[,220],2387:[,230],2388:[,230],2392:[[2325,2364],512],2393:[[2326,2364],512],2394:[[2327,2364],512],2395:[[2332,2364],512],2396:[[2337,2364],512],2397:[[2338,2364],512],2398:[[2347,2364],512],2399:[[2351,2364],512],2492:[,7],2503:[,,{2494:2507,2519:2508}],2507:[[2503,2494]],2508:[[2503,2519]],2509:[,9],2524:[[2465,2492],512],2525:[[2466,2492],512],2527:[[2479,2492],512]},2560:{2611:[[2610,2620],512],2614:[[2616,2620],512],2620:[,7],2637:[,9],2649:[[2582,2620],512],2650:[[2583,2620],512],2651:[[2588,2620],512],2654:[[2603,2620],512],2748:[,7],2765:[,9],68109:[,220],68111:[,230],68152:[,230],68153:[,1],68154:[,220],68159:[,9],68325:[,230],68326:[,220]},2816:{2876:[,7],2887:[,,{2878:2891,2902:2888,2903:2892}],2888:[[2887,2902]],2891:[[2887,2878]],2892:[[2887,2903]],2893:[,9],2908:[[2849,2876],512],2909:[[2850,2876],512],2962:[,,{3031:2964}],2964:[[2962,3031]],3014:[,,{3006:3018,3031:3020}],3015:[,,{3006:3019}],3018:[[3014,3006]],3019:[[3015,3006]],3020:[[3014,3031]],3021:[,9]},3072:{3142:[,,{3158:3144}],3144:[[3142,3158]],3149:[,9],3157:[,84],3158:[,91],3260:[,7],3263:[,,{3285:3264}],3264:[[3263,3285]],3270:[,,{3266:3274,3285:3271,3286:3272}],3271:[[3270,3285]],3272:[[3270,3286]],3274:[[3270,3266],,{3285:3275}],3275:[[3274,3285]],3277:[,9]},3328:{3398:[,,{3390:3402,3415:3404}],3399:[,,{3390:3403}],3402:[[3398,3390]],3403:[[3399,3390]],3404:[[3398,3415]],3405:[,9],3530:[,9],3545:[,,{3530:3546,3535:3548,3551:3550}],3546:[[3545,3530]],3548:[[3545,3535],,{3530:3549}],3549:[[3548,3530]],3550:[[3545,3551]]},3584:{3635:[[3661,3634],256],3640:[,103],3641:[,103],3642:[,9],3656:[,107],3657:[,107],3658:[,107],3659:[,107],3763:[[3789,3762],256],3768:[,118],3769:[,118],3784:[,122],3785:[,122],3786:[,122],3787:[,122],3804:[[3755,3737],256],3805:[[3755,3745],256]},3840:{3852:[[3851],256],3864:[,220],3865:[,220],3893:[,220],3895:[,220],3897:[,216],3907:[[3906,4023],512],3917:[[3916,4023],512],3922:[[3921,4023],512],3927:[[3926,4023],512],3932:[[3931,4023],512],3945:[[3904,4021],512],3953:[,129],3954:[,130],3955:[[3953,3954],512],3956:[,132],3957:[[3953,3956],512],3958:[[4018,3968],512],3959:[[4018,3969],256],3960:[[4019,3968],512],3961:[[4019,3969],256],3962:[,130],3963:[,130],3964:[,130],3965:[,130],3968:[,130],3969:[[3953,3968],512],3970:[,230],3971:[,230],3972:[,9],3974:[,230],3975:[,230],3987:[[3986,4023],512],3997:[[3996,4023],512],4002:[[4001,4023],512],4007:[[4006,4023],512],4012:[[4011,4023],512],4025:[[3984,4021],512],4038:[,220]},4096:{4133:[,,{4142:4134}],4134:[[4133,4142]],4151:[,7],4153:[,9],4154:[,9],4237:[,220],4348:[[4316],256],69702:[,9],69759:[,9],69785:[,,{69818:69786}],69786:[[69785,69818]],69787:[,,{69818:69788}],69788:[[69787,69818]],69797:[,,{69818:69803}],69803:[[69797,69818]],69817:[,9],69818:[,7]},4352:{69888:[,230],69889:[,230],69890:[,230],69934:[[69937,69927]],69935:[[69938,69927]],69937:[,,{69927:69934}],69938:[,,{69927:69935}],69939:[,9],69940:[,9],70003:[,7],70080:[,9]},4608:{70197:[,9],70198:[,7],70377:[,7],70378:[,9]},4864:{4957:[,230],4958:[,230],4959:[,230],70460:[,7],70471:[,,{70462:70475,70487:70476}],70475:[[70471,70462]],70476:[[70471,70487]],70477:[,9],70502:[,230],70503:[,230],70504:[,230],70505:[,230],70506:[,230],70507:[,230],70508:[,230],70512:[,230],70513:[,230],70514:[,230],70515:[,230],70516:[,230]},5120:{70841:[,,{70832:70844,70842:70843,70845:70846}],70843:[[70841,70842]],70844:[[70841,70832]],70846:[[70841,70845]],70850:[,9],70851:[,7]},5376:{71096:[,,{71087:71098}],71097:[,,{71087:71099}],71098:[[71096,71087]],71099:[[71097,71087]],71103:[,9],71104:[,7]},5632:{71231:[,9],71350:[,9],71351:[,7]},5888:{5908:[,9],5940:[,9],6098:[,9],6109:[,230]},6144:{6313:[,228]},6400:{6457:[,222],6458:[,230],6459:[,220]},6656:{6679:[,230],6680:[,220],6752:[,9],6773:[,230],6774:[,230],6775:[,230],6776:[,230],6777:[,230],6778:[,230],6779:[,230],6780:[,230],6783:[,220],6832:[,230],6833:[,230],6834:[,230],6835:[,230],6836:[,230],6837:[,220],6838:[,220],6839:[,220],6840:[,220],6841:[,220],6842:[,220],6843:[,230],6844:[,230],6845:[,220]},6912:{6917:[,,{6965:6918}],6918:[[6917,6965]],6919:[,,{6965:6920}],6920:[[6919,6965]],6921:[,,{6965:6922}],6922:[[6921,6965]],6923:[,,{6965:6924}],6924:[[6923,6965]],6925:[,,{6965:6926}],6926:[[6925,6965]],6929:[,,{6965:6930}],6930:[[6929,6965]],6964:[,7],6970:[,,{6965:6971}],6971:[[6970,6965]],6972:[,,{6965:6973}],6973:[[6972,6965]],6974:[,,{6965:6976}],6975:[,,{6965:6977}],6976:[[6974,6965]],6977:[[6975,6965]],6978:[,,{6965:6979}],6979:[[6978,6965]],6980:[,9],7019:[,230],7020:[,220],7021:[,230],7022:[,230],7023:[,230],7024:[,230],7025:[,230],7026:[,230],7027:[,230],7082:[,9],7083:[,9],7142:[,7],7154:[,9],7155:[,9]},7168:{7223:[,7],7376:[,230],7377:[,230],7378:[,230],7380:[,1],7381:[,220],7382:[,220],7383:[,220],7384:[,220],7385:[,220],7386:[,230],7387:[,230],7388:[,220],7389:[,220],7390:[,220],7391:[,220],7392:[,230],7394:[,1],7395:[,1],7396:[,1],7397:[,1],7398:[,1],7399:[,1],7400:[,1],7405:[,220],7412:[,230],7416:[,230],7417:[,230]},7424:{7468:[[65],256],7469:[[198],256],7470:[[66],256],7472:[[68],256],7473:[[69],256],7474:[[398],256],7475:[[71],256],7476:[[72],256],7477:[[73],256],7478:[[74],256],7479:[[75],256],7480:[[76],256],7481:[[77],256],7482:[[78],256],7484:[[79],256],7485:[[546],256],7486:[[80],256],7487:[[82],256],7488:[[84],256],7489:[[85],256],7490:[[87],256],7491:[[97],256],7492:[[592],256],7493:[[593],256],7494:[[7426],256],7495:[[98],256],7496:[[100],256],7497:[[101],256],7498:[[601],256],7499:[[603],256],7500:[[604],256],7501:[[103],256],7503:[[107],256],7504:[[109],256],7505:[[331],256],7506:[[111],256],7507:[[596],256],7508:[[7446],256],7509:[[7447],256],7510:[[112],256],7511:[[116],256],7512:[[117],256],7513:[[7453],256],7514:[[623],256],7515:[[118],256],7516:[[7461],256],7517:[[946],256],7518:[[947],256],7519:[[948],256],7520:[[966],256],7521:[[967],256],7522:[[105],256],7523:[[114],256],7524:[[117],256],7525:[[118],256],7526:[[946],256],7527:[[947],256],7528:[[961],256],7529:[[966],256],7530:[[967],256],7544:[[1085],256],7579:[[594],256],7580:[[99],256],7581:[[597],256],7582:[[240],256],7583:[[604],256],7584:[[102],256],7585:[[607],256],7586:[[609],256],7587:[[613],256],7588:[[616],256],7589:[[617],256],7590:[[618],256],7591:[[7547],256],7592:[[669],256],7593:[[621],256],7594:[[7557],256],7595:[[671],256],7596:[[625],256],7597:[[624],256],7598:[[626],256],7599:[[627],256],7600:[[628],256],7601:[[629],256],7602:[[632],256],7603:[[642],256],7604:[[643],256],7605:[[427],256],7606:[[649],256],7607:[[650],256],7608:[[7452],256],7609:[[651],256],7610:[[652],256],7611:[[122],256],7612:[[656],256],7613:[[657],256],7614:[[658],256],7615:[[952],256],7616:[,230],7617:[,230],7618:[,220],7619:[,230],7620:[,230],7621:[,230],7622:[,230],7623:[,230],7624:[,230],7625:[,230],7626:[,220],7627:[,230],7628:[,230],7629:[,234],7630:[,214],7631:[,220],7632:[,202],7633:[,230],7634:[,230],7635:[,230],7636:[,230],7637:[,230],7638:[,230],7639:[,230],7640:[,230],7641:[,230],7642:[,230],7643:[,230],7644:[,230],7645:[,230],7646:[,230],7647:[,230],7648:[,230],7649:[,230],7650:[,230],7651:[,230],7652:[,230],7653:[,230],7654:[,230],7655:[,230],7656:[,230],7657:[,230],7658:[,230],7659:[,230],7660:[,230],7661:[,230],7662:[,230],7663:[,230],7664:[,230],7665:[,230],7666:[,230],7667:[,230],7668:[,230],7669:[,230],7676:[,233],7677:[,220],7678:[,230],7679:[,220]},7680:{7680:[[65,805]],7681:[[97,805]],7682:[[66,775]],7683:[[98,775]],7684:[[66,803]],7685:[[98,803]],7686:[[66,817]],7687:[[98,817]],7688:[[199,769]],7689:[[231,769]],7690:[[68,775]],7691:[[100,775]],7692:[[68,803]],7693:[[100,803]],7694:[[68,817]],7695:[[100,817]],7696:[[68,807]],7697:[[100,807]],7698:[[68,813]],7699:[[100,813]],7700:[[274,768]],7701:[[275,768]],7702:[[274,769]],7703:[[275,769]],7704:[[69,813]],7705:[[101,813]],7706:[[69,816]],7707:[[101,816]],7708:[[552,774]],7709:[[553,774]],7710:[[70,775]],7711:[[102,775]],7712:[[71,772]],7713:[[103,772]],7714:[[72,775]],7715:[[104,775]],7716:[[72,803]],7717:[[104,803]],7718:[[72,776]],7719:[[104,776]],7720:[[72,807]],7721:[[104,807]],7722:[[72,814]],7723:[[104,814]],7724:[[73,816]],7725:[[105,816]],7726:[[207,769]],7727:[[239,769]],7728:[[75,769]],7729:[[107,769]],7730:[[75,803]],7731:[[107,803]],7732:[[75,817]],7733:[[107,817]],7734:[[76,803],,{772:7736}],7735:[[108,803],,{772:7737}],7736:[[7734,772]],7737:[[7735,772]],7738:[[76,817]],7739:[[108,817]],7740:[[76,813]],7741:[[108,813]],7742:[[77,769]],7743:[[109,769]],7744:[[77,775]],7745:[[109,775]],7746:[[77,803]],7747:[[109,803]],7748:[[78,775]],7749:[[110,775]],7750:[[78,803]],7751:[[110,803]],7752:[[78,817]],7753:[[110,817]],7754:[[78,813]],7755:[[110,813]],7756:[[213,769]],7757:[[245,769]],7758:[[213,776]],7759:[[245,776]],7760:[[332,768]],7761:[[333,768]],7762:[[332,769]],7763:[[333,769]],7764:[[80,769]],7765:[[112,769]],7766:[[80,775]],7767:[[112,775]],7768:[[82,775]],7769:[[114,775]],7770:[[82,803],,{772:7772}],7771:[[114,803],,{772:7773}],7772:[[7770,772]],7773:[[7771,772]],7774:[[82,817]],7775:[[114,817]],7776:[[83,775]],7777:[[115,775]],7778:[[83,803],,{775:7784}],7779:[[115,803],,{775:7785}],7780:[[346,775]],7781:[[347,775]],7782:[[352,775]],7783:[[353,775]],7784:[[7778,775]],7785:[[7779,775]],7786:[[84,775]],7787:[[116,775]],7788:[[84,803]],7789:[[116,803]],7790:[[84,817]],7791:[[116,817]],7792:[[84,813]],7793:[[116,813]],7794:[[85,804]],7795:[[117,804]],7796:[[85,816]],7797:[[117,816]],7798:[[85,813]],7799:[[117,813]],7800:[[360,769]],7801:[[361,769]],7802:[[362,776]],7803:[[363,776]],7804:[[86,771]],7805:[[118,771]],7806:[[86,803]],7807:[[118,803]],7808:[[87,768]],7809:[[119,768]],7810:[[87,769]],7811:[[119,769]],7812:[[87,776]],7813:[[119,776]],7814:[[87,775]],7815:[[119,775]],7816:[[87,803]],7817:[[119,803]],7818:[[88,775]],7819:[[120,775]],7820:[[88,776]],7821:[[120,776]],7822:[[89,775]],7823:[[121,775]],7824:[[90,770]],7825:[[122,770]],7826:[[90,803]],7827:[[122,803]],7828:[[90,817]],7829:[[122,817]],7830:[[104,817]],7831:[[116,776]],7832:[[119,778]],7833:[[121,778]],7834:[[97,702],256],7835:[[383,775]],7840:[[65,803],,{770:7852,774:7862}],7841:[[97,803],,{770:7853,774:7863}],7842:[[65,777]],7843:[[97,777]],7844:[[194,769]],7845:[[226,769]],7846:[[194,768]],7847:[[226,768]],7848:[[194,777]],7849:[[226,777]],7850:[[194,771]],7851:[[226,771]],7852:[[7840,770]],7853:[[7841,770]],7854:[[258,769]],7855:[[259,769]],7856:[[258,768]],7857:[[259,768]],7858:[[258,777]],7859:[[259,777]],7860:[[258,771]],7861:[[259,771]],7862:[[7840,774]],7863:[[7841,774]],7864:[[69,803],,{770:7878}],7865:[[101,803],,{770:7879}],7866:[[69,777]],7867:[[101,777]],7868:[[69,771]],7869:[[101,771]],7870:[[202,769]],7871:[[234,769]],7872:[[202,768]],7873:[[234,768]],7874:[[202,777]],7875:[[234,777]],7876:[[202,771]],7877:[[234,771]],7878:[[7864,770]],7879:[[7865,770]],7880:[[73,777]],7881:[[105,777]],7882:[[73,803]],7883:[[105,803]],7884:[[79,803],,{770:7896}],7885:[[111,803],,{770:7897}],7886:[[79,777]],7887:[[111,777]],7888:[[212,769]],7889:[[244,769]],7890:[[212,768]],7891:[[244,768]],7892:[[212,777]],7893:[[244,777]],7894:[[212,771]],7895:[[244,771]],7896:[[7884,770]],7897:[[7885,770]],7898:[[416,769]],7899:[[417,769]],7900:[[416,768]],7901:[[417,768]],7902:[[416,777]],7903:[[417,777]],7904:[[416,771]],7905:[[417,771]],7906:[[416,803]],7907:[[417,803]],7908:[[85,803]],7909:[[117,803]],7910:[[85,777]],7911:[[117,777]],7912:[[431,769]],7913:[[432,769]],7914:[[431,768]],7915:[[432,768]],7916:[[431,777]],7917:[[432,777]],7918:[[431,771]],7919:[[432,771]],7920:[[431,803]],7921:[[432,803]],7922:[[89,768]],7923:[[121,768]],7924:[[89,803]],7925:[[121,803]],7926:[[89,777]],7927:[[121,777]],7928:[[89,771]],7929:[[121,771]]},7936:{7936:[[945,787],,{768:7938,769:7940,834:7942,837:8064}],7937:[[945,788],,{768:7939,769:7941,834:7943,837:8065}],7938:[[7936,768],,{837:8066}],7939:[[7937,768],,{837:8067}],7940:[[7936,769],,{837:8068}],7941:[[7937,769],,{837:8069}],7942:[[7936,834],,{837:8070}],7943:[[7937,834],,{837:8071}],7944:[[913,787],,{768:7946,769:7948,834:7950,837:8072}],7945:[[913,788],,{768:7947,769:7949,834:7951,837:8073}],7946:[[7944,768],,{837:8074}],7947:[[7945,768],,{837:8075}],7948:[[7944,769],,{837:8076}],7949:[[7945,769],,{837:8077}],7950:[[7944,834],,{837:8078}],7951:[[7945,834],,{837:8079}],7952:[[949,787],,{768:7954,769:7956}],7953:[[949,788],,{768:7955,769:7957}],7954:[[7952,768]],7955:[[7953,768]],7956:[[7952,769]],7957:[[7953,769]],7960:[[917,787],,{768:7962,769:7964}],7961:[[917,788],,{768:7963,769:7965}],7962:[[7960,768]],7963:[[7961,768]],7964:[[7960,769]],7965:[[7961,769]],7968:[[951,787],,{768:7970,769:7972,834:7974,837:8080}],7969:[[951,788],,{768:7971,769:7973,834:7975,837:8081}],7970:[[7968,768],,{837:8082}],7971:[[7969,768],,{837:8083}],7972:[[7968,769],,{837:8084}],7973:[[7969,769],,{837:8085}],7974:[[7968,834],,{837:8086}],7975:[[7969,834],,{837:8087}],7976:[[919,787],,{768:7978,769:7980,834:7982,837:8088}],7977:[[919,788],,{768:7979,769:7981,834:7983,837:8089}],7978:[[7976,768],,{837:8090}],7979:[[7977,768],,{837:8091}],7980:[[7976,769],,{837:8092}],7981:[[7977,769],,{837:8093}],7982:[[7976,834],,{837:8094}],7983:[[7977,834],,{837:8095}],7984:[[953,787],,{768:7986,769:7988,834:7990}],7985:[[953,788],,{768:7987,769:7989,834:7991}],7986:[[7984,768]],7987:[[7985,768]],7988:[[7984,769]],7989:[[7985,769]],7990:[[7984,834]],7991:[[7985,834]],7992:[[921,787],,{768:7994,769:7996,834:7998}],7993:[[921,788],,{768:7995,769:7997,834:7999}],7994:[[7992,768]],7995:[[7993,768]],7996:[[7992,769]],7997:[[7993,769]],7998:[[7992,834]],7999:[[7993,834]],8e3:[[959,787],,{768:8002,769:8004}],8001:[[959,788],,{768:8003,769:8005}],8002:[[8e3,768]],8003:[[8001,768]],8004:[[8e3,769]],8005:[[8001,769]],8008:[[927,787],,{768:8010,769:8012}],8009:[[927,788],,{768:8011,769:8013}],8010:[[8008,768]],8011:[[8009,768]],8012:[[8008,769]],8013:[[8009,769]],8016:[[965,787],,{768:8018,769:8020,834:8022}],8017:[[965,788],,{768:8019,769:8021,834:8023}],8018:[[8016,768]],8019:[[8017,768]],8020:[[8016,769]],8021:[[8017,769]],8022:[[8016,834]],8023:[[8017,834]],8025:[[933,788],,{768:8027,769:8029,834:8031}],8027:[[8025,768]],8029:[[8025,769]],8031:[[8025,834]],8032:[[969,787],,{768:8034,769:8036,834:8038,837:8096}],8033:[[969,788],,{768:8035,769:8037,834:8039,837:8097}],8034:[[8032,768],,{837:8098}],8035:[[8033,768],,{837:8099}],8036:[[8032,769],,{837:8100}],8037:[[8033,769],,{837:8101}],8038:[[8032,834],,{837:8102}],8039:[[8033,834],,{837:8103}],8040:[[937,787],,{768:8042,769:8044,834:8046,837:8104}],8041:[[937,788],,{768:8043,769:8045,834:8047,837:8105}],8042:[[8040,768],,{837:8106}],8043:[[8041,768],,{837:8107}],8044:[[8040,769],,{837:8108}],8045:[[8041,769],,{837:8109}],8046:[[8040,834],,{837:8110}],8047:[[8041,834],,{837:8111}],8048:[[945,768],,{837:8114}],8049:[[940]],8050:[[949,768]],8051:[[941]],8052:[[951,768],,{837:8130}],8053:[[942]],8054:[[953,768]],8055:[[943]],8056:[[959,768]],8057:[[972]],8058:[[965,768]],8059:[[973]],8060:[[969,768],,{837:8178}],8061:[[974]],8064:[[7936,837]],8065:[[7937,837]],8066:[[7938,837]],8067:[[7939,837]],8068:[[7940,837]],8069:[[7941,837]],8070:[[7942,837]],8071:[[7943,837]],8072:[[7944,837]],8073:[[7945,837]],8074:[[7946,837]],8075:[[7947,837]],8076:[[7948,837]],8077:[[7949,837]],8078:[[7950,837]],8079:[[7951,837]],8080:[[7968,837]],8081:[[7969,837]],8082:[[7970,837]],8083:[[7971,837]],8084:[[7972,837]],8085:[[7973,837]],8086:[[7974,837]],8087:[[7975,837]],8088:[[7976,837]],8089:[[7977,837]],8090:[[7978,837]],8091:[[7979,837]],8092:[[7980,837]],8093:[[7981,837]],8094:[[7982,837]],8095:[[7983,837]],8096:[[8032,837]],8097:[[8033,837]],8098:[[8034,837]],8099:[[8035,837]],8100:[[8036,837]],8101:[[8037,837]],8102:[[8038,837]],8103:[[8039,837]],8104:[[8040,837]],8105:[[8041,837]],8106:[[8042,837]],8107:[[8043,837]],8108:[[8044,837]],8109:[[8045,837]],8110:[[8046,837]],8111:[[8047,837]],8112:[[945,774]],8113:[[945,772]],8114:[[8048,837]],8115:[[945,837]],8116:[[940,837]],8118:[[945,834],,{837:8119}],8119:[[8118,837]],8120:[[913,774]],8121:[[913,772]],8122:[[913,768]],8123:[[902]],8124:[[913,837]],8125:[[32,787],256],8126:[[953]],8127:[[32,787],256,{768:8141,769:8142,834:8143}],8128:[[32,834],256],8129:[[168,834]],8130:[[8052,837]],8131:[[951,837]],8132:[[942,837]],8134:[[951,834],,{837:8135}],8135:[[8134,837]],8136:[[917,768]],8137:[[904]],8138:[[919,768]],8139:[[905]],8140:[[919,837]],8141:[[8127,768]],8142:[[8127,769]],8143:[[8127,834]],8144:[[953,774]],8145:[[953,772]],8146:[[970,768]],8147:[[912]],8150:[[953,834]],8151:[[970,834]],8152:[[921,774]],8153:[[921,772]],8154:[[921,768]],8155:[[906]],8157:[[8190,768]],8158:[[8190,769]],8159:[[8190,834]],8160:[[965,774]],8161:[[965,772]],8162:[[971,768]],8163:[[944]],8164:[[961,787]],8165:[[961,788]],8166:[[965,834]],8167:[[971,834]],8168:[[933,774]],8169:[[933,772]],8170:[[933,768]],8171:[[910]],8172:[[929,788]],8173:[[168,768]],8174:[[901]],8175:[[96]],8178:[[8060,837]],8179:[[969,837]],8180:[[974,837]],8182:[[969,834],,{837:8183}],8183:[[8182,837]],8184:[[927,768]],8185:[[908]],8186:[[937,768]],8187:[[911]],8188:[[937,837]],8189:[[180]],8190:[[32,788],256,{768:8157,769:8158,834:8159}]},8192:{8192:[[8194]],8193:[[8195]],8194:[[32],256],8195:[[32],256],8196:[[32],256],8197:[[32],256],8198:[[32],256],8199:[[32],256],8200:[[32],256],8201:[[32],256],8202:[[32],256],8209:[[8208],256],8215:[[32,819],256],8228:[[46],256],8229:[[46,46],256],8230:[[46,46,46],256],8239:[[32],256],8243:[[8242,8242],256],8244:[[8242,8242,8242],256],8246:[[8245,8245],256],8247:[[8245,8245,8245],256],8252:[[33,33],256],8254:[[32,773],256],8263:[[63,63],256],8264:[[63,33],256],8265:[[33,63],256],8279:[[8242,8242,8242,8242],256],8287:[[32],256],8304:[[48],256],8305:[[105],256],8308:[[52],256],8309:[[53],256],8310:[[54],256],8311:[[55],256],8312:[[56],256],8313:[[57],256],8314:[[43],256],8315:[[8722],256],8316:[[61],256],8317:[[40],256],8318:[[41],256],8319:[[110],256],8320:[[48],256],8321:[[49],256],8322:[[50],256],8323:[[51],256],8324:[[52],256],8325:[[53],256],8326:[[54],256],8327:[[55],256],8328:[[56],256],8329:[[57],256],8330:[[43],256],8331:[[8722],256],8332:[[61],256],8333:[[40],256],8334:[[41],256],8336:[[97],256],8337:[[101],256],8338:[[111],256],8339:[[120],256],8340:[[601],256],8341:[[104],256],8342:[[107],256],8343:[[108],256],8344:[[109],256],8345:[[110],256],8346:[[112],256],8347:[[115],256],8348:[[116],256],8360:[[82,115],256],8400:[,230],8401:[,230],8402:[,1],8403:[,1],8404:[,230],8405:[,230],8406:[,230],8407:[,230],8408:[,1],8409:[,1],8410:[,1],8411:[,230],8412:[,230],8417:[,230],8421:[,1],8422:[,1],8423:[,230],8424:[,220],8425:[,230],8426:[,1],8427:[,1],8428:[,220],8429:[,220],8430:[,220],8431:[,220],8432:[,230]},8448:{8448:[[97,47,99],256],8449:[[97,47,115],256],8450:[[67],256],8451:[[176,67],256],8453:[[99,47,111],256],8454:[[99,47,117],256],8455:[[400],256],8457:[[176,70],256],8458:[[103],256],8459:[[72],256],8460:[[72],256],8461:[[72],256],8462:[[104],256],8463:[[295],256],8464:[[73],256],8465:[[73],256],8466:[[76],256],8467:[[108],256],8469:[[78],256],8470:[[78,111],256],8473:[[80],256],8474:[[81],256],8475:[[82],256],8476:[[82],256],8477:[[82],256],8480:[[83,77],256],8481:[[84,69,76],256],8482:[[84,77],256],8484:[[90],256],8486:[[937]],8488:[[90],256],8490:[[75]],8491:[[197]],8492:[[66],256],8493:[[67],256],8495:[[101],256],8496:[[69],256],8497:[[70],256],8499:[[77],256],8500:[[111],256],8501:[[1488],256],8502:[[1489],256],8503:[[1490],256],8504:[[1491],256],8505:[[105],256],8507:[[70,65,88],256],8508:[[960],256],8509:[[947],256],8510:[[915],256],8511:[[928],256],8512:[[8721],256],8517:[[68],256],8518:[[100],256],8519:[[101],256],8520:[[105],256],8521:[[106],256],8528:[[49,8260,55],256],8529:[[49,8260,57],256],8530:[[49,8260,49,48],256],8531:[[49,8260,51],256],8532:[[50,8260,51],256],8533:[[49,8260,53],256],8534:[[50,8260,53],256],8535:[[51,8260,53],256],8536:[[52,8260,53],256],8537:[[49,8260,54],256],8538:[[53,8260,54],256],8539:[[49,8260,56],256],8540:[[51,8260,56],256],8541:[[53,8260,56],256],8542:[[55,8260,56],256],8543:[[49,8260],256],8544:[[73],256],8545:[[73,73],256],8546:[[73,73,73],256],8547:[[73,86],256],8548:[[86],256],8549:[[86,73],256],8550:[[86,73,73],256],8551:[[86,73,73,73],256],8552:[[73,88],256],8553:[[88],256],8554:[[88,73],256],8555:[[88,73,73],256],8556:[[76],256],8557:[[67],256],8558:[[68],256],8559:[[77],256],8560:[[105],256],8561:[[105,105],256],8562:[[105,105,105],256],8563:[[105,118],256],8564:[[118],256],8565:[[118,105],256],8566:[[118,105,105],256],8567:[[118,105,105,105],256],8568:[[105,120],256],8569:[[120],256],8570:[[120,105],256],8571:[[120,105,105],256],8572:[[108],256],8573:[[99],256],8574:[[100],256],8575:[[109],256],8585:[[48,8260,51],256],8592:[,,{824:8602}],8594:[,,{824:8603}],8596:[,,{824:8622}],8602:[[8592,824]],8603:[[8594,824]],8622:[[8596,824]],8653:[[8656,824]],8654:[[8660,824]],8655:[[8658,824]],8656:[,,{824:8653}],8658:[,,{824:8655}],8660:[,,{824:8654}]},8704:{8707:[,,{824:8708}],8708:[[8707,824]],8712:[,,{824:8713}],8713:[[8712,824]],8715:[,,{824:8716}],8716:[[8715,824]],8739:[,,{824:8740}],8740:[[8739,824]],8741:[,,{824:8742}],8742:[[8741,824]],8748:[[8747,8747],256],8749:[[8747,8747,8747],256],8751:[[8750,8750],256],8752:[[8750,8750,8750],256],8764:[,,{824:8769}],8769:[[8764,824]],8771:[,,{824:8772}],8772:[[8771,824]],8773:[,,{824:8775}],8775:[[8773,824]],8776:[,,{824:8777}],8777:[[8776,824]],8781:[,,{824:8813}],8800:[[61,824]],8801:[,,{824:8802}],8802:[[8801,824]],8804:[,,{824:8816}],8805:[,,{824:8817}],8813:[[8781,824]],8814:[[60,824]],8815:[[62,824]],8816:[[8804,824]],8817:[[8805,824]],8818:[,,{824:8820}],8819:[,,{824:8821}],8820:[[8818,824]],8821:[[8819,824]],8822:[,,{824:8824}],8823:[,,{824:8825}],8824:[[8822,824]],8825:[[8823,824]],8826:[,,{824:8832}],8827:[,,{824:8833}],8828:[,,{824:8928}],8829:[,,{824:8929}],8832:[[8826,824]],8833:[[8827,824]],8834:[,,{824:8836}],8835:[,,{824:8837}],8836:[[8834,824]],8837:[[8835,824]],8838:[,,{824:8840}],8839:[,,{824:8841}],8840:[[8838,824]],8841:[[8839,824]],8849:[,,{824:8930}],8850:[,,{824:8931}],8866:[,,{824:8876}],8872:[,,{824:8877}],8873:[,,{824:8878}],8875:[,,{824:8879}],8876:[[8866,824]],8877:[[8872,824]],8878:[[8873,824]],8879:[[8875,824]],8882:[,,{824:8938}],8883:[,,{824:8939}],8884:[,,{824:8940}],8885:[,,{824:8941}],8928:[[8828,824]],8929:[[8829,824]],8930:[[8849,824]],8931:[[8850,824]],8938:[[8882,824]],8939:[[8883,824]],8940:[[8884,824]],8941:[[8885,824]]},8960:{9001:[[12296]],9002:[[12297]]},9216:{9312:[[49],256],9313:[[50],256],9314:[[51],256],9315:[[52],256],9316:[[53],256],9317:[[54],256],9318:[[55],256],9319:[[56],256],9320:[[57],256],9321:[[49,48],256],9322:[[49,49],256],9323:[[49,50],256],9324:[[49,51],256],9325:[[49,52],256],9326:[[49,53],256],9327:[[49,54],256],9328:[[49,55],256],9329:[[49,56],256],9330:[[49,57],256],9331:[[50,48],256],9332:[[40,49,41],256],9333:[[40,50,41],256],9334:[[40,51,41],256],9335:[[40,52,41],256],9336:[[40,53,41],256],9337:[[40,54,41],256],9338:[[40,55,41],256],9339:[[40,56,41],256],9340:[[40,57,41],256],9341:[[40,49,48,41],256],9342:[[40,49,49,41],256],9343:[[40,49,50,41],256],9344:[[40,49,51,41],256],9345:[[40,49,52,41],256],9346:[[40,49,53,41],256],9347:[[40,49,54,41],256],9348:[[40,49,55,41],256],9349:[[40,49,56,41],256],9350:[[40,49,57,41],256],9351:[[40,50,48,41],256],9352:[[49,46],256],9353:[[50,46],256],9354:[[51,46],256],9355:[[52,46],256],9356:[[53,46],256],9357:[[54,46],256],9358:[[55,46],256],9359:[[56,46],256],9360:[[57,46],256],9361:[[49,48,46],256],9362:[[49,49,46],256],9363:[[49,50,46],256],9364:[[49,51,46],256],9365:[[49,52,46],256],9366:[[49,53,46],256],9367:[[49,54,46],256],9368:[[49,55,46],256],9369:[[49,56,46],256],9370:[[49,57,46],256],9371:[[50,48,46],256],9372:[[40,97,41],256],9373:[[40,98,41],256],9374:[[40,99,41],256],9375:[[40,100,41],256],9376:[[40,101,41],256],9377:[[40,102,41],256],9378:[[40,103,41],256],9379:[[40,104,41],256],9380:[[40,105,41],256],9381:[[40,106,41],256],9382:[[40,107,41],256],9383:[[40,108,41],256],9384:[[40,109,41],256],9385:[[40,110,41],256],9386:[[40,111,41],256],9387:[[40,112,41],256],9388:[[40,113,41],256],9389:[[40,114,41],256],9390:[[40,115,41],256],9391:[[40,116,41],256],9392:[[40,117,41],256],9393:[[40,118,41],256],9394:[[40,119,41],256],9395:[[40,120,41],256],9396:[[40,121,41],256],9397:[[40,122,41],256],9398:[[65],256],9399:[[66],256],9400:[[67],256],9401:[[68],256],9402:[[69],256],9403:[[70],256],9404:[[71],256],9405:[[72],256],9406:[[73],256],9407:[[74],256],9408:[[75],256],9409:[[76],256],9410:[[77],256],9411:[[78],256],9412:[[79],256],9413:[[80],256],9414:[[81],256],9415:[[82],256],9416:[[83],256],9417:[[84],256],9418:[[85],256],9419:[[86],256],9420:[[87],256],9421:[[88],256],9422:[[89],256],9423:[[90],256],9424:[[97],256],9425:[[98],256],9426:[[99],256],9427:[[100],256],9428:[[101],256],9429:[[102],256],9430:[[103],256],9431:[[104],256],9432:[[105],256],9433:[[106],256],9434:[[107],256],9435:[[108],256],9436:[[109],256],9437:[[110],256],9438:[[111],256],9439:[[112],256],9440:[[113],256],9441:[[114],256],9442:[[115],256],9443:[[116],256],9444:[[117],256],9445:[[118],256],9446:[[119],256],9447:[[120],256],9448:[[121],256],9449:[[122],256],9450:[[48],256]},10752:{10764:[[8747,8747,8747,8747],256],10868:[[58,58,61],256],10869:[[61,61],256],10870:[[61,61,61],256],10972:[[10973,824],512]},11264:{11388:[[106],256],11389:[[86],256],11503:[,230],11504:[,230],11505:[,230]},11520:{11631:[[11617],256],11647:[,9],11744:[,230],11745:[,230],11746:[,230],11747:[,230],11748:[,230],11749:[,230],11750:[,230],11751:[,230],11752:[,230],11753:[,230],11754:[,230],11755:[,230],11756:[,230],11757:[,230],11758:[,230],11759:[,230],11760:[,230],11761:[,230],11762:[,230],11763:[,230],11764:[,230],11765:[,230],11766:[,230],11767:[,230],11768:[,230],11769:[,230],11770:[,230],11771:[,230],11772:[,230],11773:[,230],11774:[,230],11775:[,230]},11776:{11935:[[27597],256],12019:[[40863],256]},12032:{12032:[[19968],256],12033:[[20008],256],12034:[[20022],256],12035:[[20031],256],12036:[[20057],256],12037:[[20101],256],12038:[[20108],256],12039:[[20128],256],12040:[[20154],256],12041:[[20799],256],12042:[[20837],256],12043:[[20843],256],12044:[[20866],256],12045:[[20886],256],12046:[[20907],256],12047:[[20960],256],12048:[[20981],256],12049:[[20992],256],12050:[[21147],256],12051:[[21241],256],12052:[[21269],256],12053:[[21274],256],12054:[[21304],256],12055:[[21313],256],12056:[[21340],256],12057:[[21353],256],12058:[[21378],256],12059:[[21430],256],12060:[[21448],256],12061:[[21475],256],12062:[[22231],256],12063:[[22303],256],12064:[[22763],256],12065:[[22786],256],12066:[[22794],256],12067:[[22805],256],12068:[[22823],256],12069:[[22899],256],12070:[[23376],256],12071:[[23424],256],12072:[[23544],256],12073:[[23567],256],12074:[[23586],256],12075:[[23608],256],12076:[[23662],256],12077:[[23665],256],12078:[[24027],256],12079:[[24037],256],12080:[[24049],256],12081:[[24062],256],12082:[[24178],256],12083:[[24186],256],12084:[[24191],256],12085:[[24308],256],12086:[[24318],256],12087:[[24331],256],12088:[[24339],256],12089:[[24400],256],12090:[[24417],256],12091:[[24435],256],12092:[[24515],256],12093:[[25096],256],12094:[[25142],256],12095:[[25163],256],12096:[[25903],256],12097:[[25908],256],12098:[[25991],256],12099:[[26007],256],12100:[[26020],256],12101:[[26041],256],12102:[[26080],256],12103:[[26085],256],12104:[[26352],256],12105:[[26376],256],12106:[[26408],256],12107:[[27424],256],12108:[[27490],256],12109:[[27513],256],12110:[[27571],256],12111:[[27595],256],12112:[[27604],256],12113:[[27611],256],12114:[[27663],256],12115:[[27668],256],12116:[[27700],256],12117:[[28779],256],12118:[[29226],256],12119:[[29238],256],12120:[[29243],256],12121:[[29247],256],12122:[[29255],256],12123:[[29273],256],12124:[[29275],256],12125:[[29356],256],12126:[[29572],256],12127:[[29577],256],12128:[[29916],256],12129:[[29926],256],12130:[[29976],256],12131:[[29983],256],12132:[[29992],256],12133:[[3e4],256],12134:[[30091],256],12135:[[30098],256],12136:[[30326],256],12137:[[30333],256],12138:[[30382],256],12139:[[30399],256],12140:[[30446],256],12141:[[30683],256],12142:[[30690],256],12143:[[30707],256],12144:[[31034],256],12145:[[31160],256],12146:[[31166],256],12147:[[31348],256],12148:[[31435],256],12149:[[31481],256],12150:[[31859],256],12151:[[31992],256],12152:[[32566],256],12153:[[32593],256],12154:[[32650],256],12155:[[32701],256],12156:[[32769],256],12157:[[32780],256],12158:[[32786],256],12159:[[32819],256],12160:[[32895],256],12161:[[32905],256],12162:[[33251],256],12163:[[33258],256],12164:[[33267],256],12165:[[33276],256],12166:[[33292],256],12167:[[33307],256],12168:[[33311],256],12169:[[33390],256],12170:[[33394],256],12171:[[33400],256],12172:[[34381],256],12173:[[34411],256],12174:[[34880],256],12175:[[34892],256],12176:[[34915],256],12177:[[35198],256],12178:[[35211],256],12179:[[35282],256],12180:[[35328],256],12181:[[35895],256],12182:[[35910],256],12183:[[35925],256],12184:[[35960],256],12185:[[35997],256],12186:[[36196],256],12187:[[36208],256],12188:[[36275],256],12189:[[36523],256],12190:[[36554],256],12191:[[36763],256],12192:[[36784],256],12193:[[36789],256],12194:[[37009],256],12195:[[37193],256],12196:[[37318],256],12197:[[37324],256],12198:[[37329],256],12199:[[38263],256],12200:[[38272],256],12201:[[38428],256],12202:[[38582],256],12203:[[38585],256],12204:[[38632],256],12205:[[38737],256],12206:[[38750],256],12207:[[38754],256],12208:[[38761],256],12209:[[38859],256],12210:[[38893],256],12211:[[38899],256],12212:[[38913],256],12213:[[39080],256],12214:[[39131],256],12215:[[39135],256],12216:[[39318],256],12217:[[39321],256],12218:[[39340],256],12219:[[39592],256],12220:[[39640],256],12221:[[39647],256],12222:[[39717],256],12223:[[39727],256],12224:[[39730],256],12225:[[39740],256],12226:[[39770],256],12227:[[40165],256],12228:[[40565],256],12229:[[40575],256],12230:[[40613],256],12231:[[40635],256],12232:[[40643],256],12233:[[40653],256],12234:[[40657],256],12235:[[40697],256],12236:[[40701],256],12237:[[40718],256],12238:[[40723],256],12239:[[40736],256],12240:[[40763],256],12241:[[40778],256],12242:[[40786],256],12243:[[40845],256],12244:[[40860],256],12245:[[40864],256]},12288:{12288:[[32],256],12330:[,218],12331:[,228],12332:[,232],12333:[,222],12334:[,224],12335:[,224],12342:[[12306],256],12344:[[21313],256],12345:[[21316],256],12346:[[21317],256],12358:[,,{12441:12436}],12363:[,,{12441:12364}],12364:[[12363,12441]],12365:[,,{12441:12366}],12366:[[12365,12441]],12367:[,,{12441:12368}],12368:[[12367,12441]],12369:[,,{12441:12370}],12370:[[12369,12441]],12371:[,,{12441:12372}],12372:[[12371,12441]],12373:[,,{12441:12374}],12374:[[12373,12441]],12375:[,,{12441:12376}],12376:[[12375,12441]],12377:[,,{12441:12378}],12378:[[12377,12441]],12379:[,,{12441:12380}],12380:[[12379,12441]],12381:[,,{12441:12382}],12382:[[12381,12441]],12383:[,,{12441:12384}],12384:[[12383,12441]],12385:[,,{12441:12386}],12386:[[12385,12441]],12388:[,,{12441:12389}],12389:[[12388,12441]],12390:[,,{12441:12391}],12391:[[12390,12441]],12392:[,,{12441:12393}],12393:[[12392,12441]],12399:[,,{12441:12400,12442:12401}],12400:[[12399,12441]],12401:[[12399,12442]],12402:[,,{12441:12403,12442:12404}],12403:[[12402,12441]],12404:[[12402,12442]],12405:[,,{12441:12406,12442:12407}],12406:[[12405,12441]],12407:[[12405,12442]],12408:[,,{12441:12409,12442:12410}],12409:[[12408,12441]],12410:[[12408,12442]],12411:[,,{12441:12412,12442:12413}],12412:[[12411,12441]],12413:[[12411,12442]],12436:[[12358,12441]],12441:[,8],12442:[,8],12443:[[32,12441],256],12444:[[32,12442],256],12445:[,,{12441:12446}],12446:[[12445,12441]],12447:[[12424,12426],256],12454:[,,{12441:12532}],12459:[,,{12441:12460}],12460:[[12459,12441]],12461:[,,{12441:12462}],12462:[[12461,12441]],12463:[,,{12441:12464}],12464:[[12463,12441]],12465:[,,{12441:12466}],12466:[[12465,12441]],12467:[,,{12441:12468}],12468:[[12467,12441]],12469:[,,{12441:12470}],12470:[[12469,12441]],12471:[,,{12441:12472}],12472:[[12471,12441]],12473:[,,{12441:12474}],12474:[[12473,12441]],12475:[,,{12441:12476}],12476:[[12475,12441]],12477:[,,{12441:12478}],12478:[[12477,12441]],12479:[,,{12441:12480}],12480:[[12479,12441]],12481:[,,{12441:12482}],12482:[[12481,12441]],12484:[,,{12441:12485}],12485:[[12484,12441]],12486:[,,{12441:12487}],12487:[[12486,12441]],12488:[,,{12441:12489}],12489:[[12488,12441]],12495:[,,{12441:12496,12442:12497}],12496:[[12495,12441]],12497:[[12495,12442]],12498:[,,{12441:12499,12442:12500}],12499:[[12498,12441]],12500:[[12498,12442]],12501:[,,{12441:12502,12442:12503}],12502:[[12501,12441]],12503:[[12501,12442]],12504:[,,{12441:12505,12442:12506}],12505:[[12504,12441]],12506:[[12504,12442]],12507:[,,{12441:12508,12442:12509}],12508:[[12507,12441]],12509:[[12507,12442]],12527:[,,{12441:12535}],12528:[,,{12441:12536}],12529:[,,{12441:12537}],12530:[,,{12441:12538}],12532:[[12454,12441]],12535:[[12527,12441]],12536:[[12528,12441]],12537:[[12529,12441]],12538:[[12530,12441]],12541:[,,{12441:12542}],12542:[[12541,12441]],12543:[[12467,12488],256]},12544:{12593:[[4352],256],12594:[[4353],256],12595:[[4522],256],12596:[[4354],256],12597:[[4524],256],12598:[[4525],256],12599:[[4355],256],12600:[[4356],256],12601:[[4357],256],12602:[[4528],256],12603:[[4529],256],12604:[[4530],256],12605:[[4531],256],12606:[[4532],256],12607:[[4533],256],12608:[[4378],256],12609:[[4358],256],12610:[[4359],256],12611:[[4360],256],12612:[[4385],256],12613:[[4361],256],12614:[[4362],256],12615:[[4363],256],12616:[[4364],256],12617:[[4365],256],12618:[[4366],256],12619:[[4367],256],12620:[[4368],256],12621:[[4369],256],12622:[[4370],256],12623:[[4449],256],12624:[[4450],256],12625:[[4451],256],12626:[[4452],256],12627:[[4453],256],12628:[[4454],256],12629:[[4455],256],12630:[[4456],256],12631:[[4457],256],12632:[[4458],256],12633:[[4459],256],12634:[[4460],256],12635:[[4461],256],12636:[[4462],256],12637:[[4463],256],12638:[[4464],256],12639:[[4465],256],12640:[[4466],256],12641:[[4467],256],12642:[[4468],256],12643:[[4469],256],12644:[[4448],256],12645:[[4372],256],12646:[[4373],256],12647:[[4551],256],12648:[[4552],256],12649:[[4556],256],12650:[[4558],256],12651:[[4563],256],12652:[[4567],256],12653:[[4569],256],12654:[[4380],256],12655:[[4573],256],12656:[[4575],256],12657:[[4381],256],12658:[[4382],256],12659:[[4384],256],12660:[[4386],256],12661:[[4387],256],12662:[[4391],256],12663:[[4393],256],12664:[[4395],256],12665:[[4396],256],12666:[[4397],256],12667:[[4398],256],12668:[[4399],256],12669:[[4402],256],12670:[[4406],256],12671:[[4416],256],12672:[[4423],256],12673:[[4428],256],12674:[[4593],256],12675:[[4594],256],12676:[[4439],256],12677:[[4440],256],12678:[[4441],256],12679:[[4484],256],12680:[[4485],256],12681:[[4488],256],12682:[[4497],256],12683:[[4498],256],12684:[[4500],256],12685:[[4510],256],12686:[[4513],256],12690:[[19968],256],12691:[[20108],256],12692:[[19977],256],12693:[[22235],256],12694:[[19978],256],12695:[[20013],256],12696:[[19979],256],12697:[[30002],256],12698:[[20057],256],12699:[[19993],256],12700:[[19969],256],12701:[[22825],256],12702:[[22320],256],12703:[[20154],256]},12800:{12800:[[40,4352,41],256],12801:[[40,4354,41],256],12802:[[40,4355,41],256],12803:[[40,4357,41],256],12804:[[40,4358,41],256],12805:[[40,4359,41],256],12806:[[40,4361,41],256],12807:[[40,4363,41],256],12808:[[40,4364,41],256],12809:[[40,4366,41],256],12810:[[40,4367,41],256],12811:[[40,4368,41],256],12812:[[40,4369,41],256],12813:[[40,4370,41],256],12814:[[40,4352,4449,41],256],12815:[[40,4354,4449,41],256],12816:[[40,4355,4449,41],256],12817:[[40,4357,4449,41],256],12818:[[40,4358,4449,41],256],12819:[[40,4359,4449,41],256],12820:[[40,4361,4449,41],256],12821:[[40,4363,4449,41],256],12822:[[40,4364,4449,41],256],12823:[[40,4366,4449,41],256],12824:[[40,4367,4449,41],256],12825:[[40,4368,4449,41],256],12826:[[40,4369,4449,41],256],12827:[[40,4370,4449,41],256],12828:[[40,4364,4462,41],256],12829:[[40,4363,4457,4364,4453,4523,41],256],12830:[[40,4363,4457,4370,4462,41],256],12832:[[40,19968,41],256],12833:[[40,20108,41],256],12834:[[40,19977,41],256],12835:[[40,22235,41],256],12836:[[40,20116,41],256],12837:[[40,20845,41],256],12838:[[40,19971,41],256],12839:[[40,20843,41],256],12840:[[40,20061,41],256],12841:[[40,21313,41],256],12842:[[40,26376,41],256],12843:[[40,28779,41],256],12844:[[40,27700,41],256],12845:[[40,26408,41],256],12846:[[40,37329,41],256],12847:[[40,22303,41],256],12848:[[40,26085,41],256],12849:[[40,26666,41],256],12850:[[40,26377,41],256],12851:[[40,31038,41],256],12852:[[40,21517,41],256],12853:[[40,29305,41],256],12854:[[40,36001,41],256],12855:[[40,31069,41],256],12856:[[40,21172,41],256],12857:[[40,20195,41],256],12858:[[40,21628,41],256],12859:[[40,23398,41],256],12860:[[40,30435,41],256],12861:[[40,20225,41],256],12862:[[40,36039,41],256],12863:[[40,21332,41],256],12864:[[40,31085,41],256],12865:[[40,20241,41],256],12866:[[40,33258,41],256],12867:[[40,33267,41],256],12868:[[21839],256],12869:[[24188],256],12870:[[25991],256],12871:[[31631],256],12880:[[80,84,69],256],12881:[[50,49],256],12882:[[50,50],256],12883:[[50,51],256],12884:[[50,52],256],12885:[[50,53],256],12886:[[50,54],256],12887:[[50,55],256],12888:[[50,56],256],12889:[[50,57],256],12890:[[51,48],256],12891:[[51,49],256],12892:[[51,50],256],12893:[[51,51],256],12894:[[51,52],256],12895:[[51,53],256],12896:[[4352],256],12897:[[4354],256],12898:[[4355],256],12899:[[4357],256],12900:[[4358],256],12901:[[4359],256],12902:[[4361],256],12903:[[4363],256],12904:[[4364],256],12905:[[4366],256],12906:[[4367],256],12907:[[4368],256],12908:[[4369],256],12909:[[4370],256],12910:[[4352,4449],256],12911:[[4354,4449],256],12912:[[4355,4449],256],12913:[[4357,4449],256],12914:[[4358,4449],256],12915:[[4359,4449],256],12916:[[4361,4449],256],12917:[[4363,4449],256],12918:[[4364,4449],256],12919:[[4366,4449],256],12920:[[4367,4449],256],12921:[[4368,4449],256],12922:[[4369,4449],256],12923:[[4370,4449],256],12924:[[4366,4449,4535,4352,4457],256],12925:[[4364,4462,4363,4468],256],12926:[[4363,4462],256],12928:[[19968],256],12929:[[20108],256],12930:[[19977],256],12931:[[22235],256],12932:[[20116],256],12933:[[20845],256],12934:[[19971],256],12935:[[20843],256],12936:[[20061],256],12937:[[21313],256],12938:[[26376],256],12939:[[28779],256],12940:[[27700],256],12941:[[26408],256],12942:[[37329],256],12943:[[22303],256],12944:[[26085],256],12945:[[26666],256],12946:[[26377],256],12947:[[31038],256],12948:[[21517],256],12949:[[29305],256],12950:[[36001],256],12951:[[31069],256],12952:[[21172],256],12953:[[31192],256],12954:[[30007],256],12955:[[22899],256],12956:[[36969],256],12957:[[20778],256],12958:[[21360],256],12959:[[27880],256],12960:[[38917],256],12961:[[20241],256],12962:[[20889],256],12963:[[27491],256],12964:[[19978],256],12965:[[20013],256],12966:[[19979],256],12967:[[24038],256],12968:[[21491],256],12969:[[21307],256],12970:[[23447],256],12971:[[23398],256],12972:[[30435],256],12973:[[20225],256],12974:[[36039],256],12975:[[21332],256],12976:[[22812],256],12977:[[51,54],256],12978:[[51,55],256],12979:[[51,56],256],12980:[[51,57],256],12981:[[52,48],256],12982:[[52,49],256],12983:[[52,50],256],12984:[[52,51],256],12985:[[52,52],256],12986:[[52,53],256],12987:[[52,54],256],12988:[[52,55],256],12989:[[52,56],256],12990:[[52,57],256],12991:[[53,48],256],12992:[[49,26376],256],12993:[[50,26376],256],12994:[[51,26376],256],12995:[[52,26376],256],12996:[[53,26376],256],12997:[[54,26376],256],12998:[[55,26376],256],12999:[[56,26376],256],13e3:[[57,26376],256],13001:[[49,48,26376],256],13002:[[49,49,26376],256],13003:[[49,50,26376],256],13004:[[72,103],256],13005:[[101,114,103],256],13006:[[101,86],256],13007:[[76,84,68],256],13008:[[12450],256],13009:[[12452],256],13010:[[12454],256],13011:[[12456],256],13012:[[12458],256],13013:[[12459],256],13014:[[12461],256],13015:[[12463],256],13016:[[12465],256],13017:[[12467],256],13018:[[12469],256],13019:[[12471],256],13020:[[12473],256],13021:[[12475],256],13022:[[12477],256],13023:[[12479],256],13024:[[12481],256],13025:[[12484],256],13026:[[12486],256],13027:[[12488],256],13028:[[12490],256],13029:[[12491],256],13030:[[12492],256],13031:[[12493],256],13032:[[12494],256],13033:[[12495],256],13034:[[12498],256],13035:[[12501],256],13036:[[12504],256],13037:[[12507],256],13038:[[12510],256],13039:[[12511],256],13040:[[12512],256],13041:[[12513],256],13042:[[12514],256],13043:[[12516],256],13044:[[12518],256],13045:[[12520],256],13046:[[12521],256],13047:[[12522],256],13048:[[12523],256],13049:[[12524],256],13050:[[12525],256],13051:[[12527],256],13052:[[12528],256],13053:[[12529],256],13054:[[12530],256]},13056:{13056:[[12450,12497,12540,12488],256],13057:[[12450,12523,12501,12449],256],13058:[[12450,12531,12506,12450],256],13059:[[12450,12540,12523],256],13060:[[12452,12491,12531,12464],256],13061:[[12452,12531,12481],256],13062:[[12454,12457,12531],256],13063:[[12456,12473,12463,12540,12489],256],13064:[[12456,12540,12459,12540],256],13065:[[12458,12531,12473],256],13066:[[12458,12540,12512],256],13067:[[12459,12452,12522],256],13068:[[12459,12521,12483,12488],256],13069:[[12459,12525,12522,12540],256],13070:[[12460,12525,12531],256],13071:[[12460,12531,12510],256],13072:[[12462,12460],256],13073:[[12462,12491,12540],256],13074:[[12461,12517,12522,12540],256],13075:[[12462,12523,12480,12540],256],13076:[[12461,12525],256],13077:[[12461,12525,12464,12521,12512],256],13078:[[12461,12525,12513,12540,12488,12523],256],13079:[[12461,12525,12527,12483,12488],256],13080:[[12464,12521,12512],256],13081:[[12464,12521,12512,12488,12531],256],13082:[[12463,12523,12476,12452,12525],256],13083:[[12463,12525,12540,12493],256],13084:[[12465,12540,12473],256],13085:[[12467,12523,12490],256],13086:[[12467,12540,12509],256],13087:[[12469,12452,12463,12523],256],13088:[[12469,12531,12481,12540,12512],256],13089:[[12471,12522,12531,12464],256],13090:[[12475,12531,12481],256],13091:[[12475,12531,12488],256],13092:[[12480,12540,12473],256],13093:[[12487,12471],256],13094:[[12489,12523],256],13095:[[12488,12531],256],13096:[[12490,12494],256],13097:[[12494,12483,12488],256],13098:[[12495,12452,12484],256],13099:[[12497,12540,12475,12531,12488],256],13100:[[12497,12540,12484],256],13101:[[12496,12540,12524,12523],256],13102:[[12500,12450,12473,12488,12523],256],13103:[[12500,12463,12523],256],13104:[[12500,12467],256],13105:[[12499,12523],256],13106:[[12501,12449,12521,12483,12489],256],13107:[[12501,12451,12540,12488],256],13108:[[12502,12483,12471,12455,12523],256],13109:[[12501,12521,12531],256],13110:[[12504,12463,12479,12540,12523],256],13111:[[12506,12477],256],13112:[[12506,12491,12498],256],13113:[[12504,12523,12484],256],13114:[[12506,12531,12473],256],13115:[[12506,12540,12472],256],13116:[[12505,12540,12479],256],13117:[[12509,12452,12531,12488],256],13118:[[12508,12523,12488],256],13119:[[12507,12531],256],13120:[[12509,12531,12489],256],13121:[[12507,12540,12523],256],13122:[[12507,12540,12531],256],13123:[[12510,12452,12463,12525],256],13124:[[12510,12452,12523],256],13125:[[12510,12483,12495],256],13126:[[12510,12523,12463],256],13127:[[12510,12531,12471,12519,12531],256],13128:[[12511,12463,12525,12531],256],13129:[[12511,12522],256],13130:[[12511,12522,12496,12540,12523],256],13131:[[12513,12460],256],13132:[[12513,12460,12488,12531],256],13133:[[12513,12540,12488,12523],256],13134:[[12516,12540,12489],256],13135:[[12516,12540,12523],256],13136:[[12518,12450,12531],256],13137:[[12522,12483,12488,12523],256],13138:[[12522,12521],256],13139:[[12523,12500,12540],256],13140:[[12523,12540,12502,12523],256],13141:[[12524,12512],256],13142:[[12524,12531,12488,12466,12531],256],13143:[[12527,12483,12488],256],13144:[[48,28857],256],13145:[[49,28857],256],13146:[[50,28857],256],13147:[[51,28857],256],13148:[[52,28857],256],13149:[[53,28857],256],13150:[[54,28857],256],13151:[[55,28857],256],13152:[[56,28857],256],13153:[[57,28857],256],13154:[[49,48,28857],256],13155:[[49,49,28857],256],13156:[[49,50,28857],256],13157:[[49,51,28857],256],13158:[[49,52,28857],256],13159:[[49,53,28857],256],13160:[[49,54,28857],256],13161:[[49,55,28857],256],13162:[[49,56,28857],256],13163:[[49,57,28857],256],13164:[[50,48,28857],256],13165:[[50,49,28857],256],13166:[[50,50,28857],256],13167:[[50,51,28857],256],13168:[[50,52,28857],256],13169:[[104,80,97],256],13170:[[100,97],256],13171:[[65,85],256],13172:[[98,97,114],256],13173:[[111,86],256],13174:[[112,99],256],13175:[[100,109],256],13176:[[100,109,178],256],13177:[[100,109,179],256],13178:[[73,85],256],13179:[[24179,25104],256],13180:[[26157,21644],256],13181:[[22823,27491],256],13182:[[26126,27835],256],13183:[[26666,24335,20250,31038],256],13184:[[112,65],256],13185:[[110,65],256],13186:[[956,65],256],13187:[[109,65],256],13188:[[107,65],256],13189:[[75,66],256],13190:[[77,66],256],13191:[[71,66],256],13192:[[99,97,108],256],13193:[[107,99,97,108],256],13194:[[112,70],256],13195:[[110,70],256],13196:[[956,70],256],13197:[[956,103],256],13198:[[109,103],256],13199:[[107,103],256],13200:[[72,122],256],13201:[[107,72,122],256],13202:[[77,72,122],256],13203:[[71,72,122],256],13204:[[84,72,122],256],13205:[[956,8467],256],13206:[[109,8467],256],13207:[[100,8467],256],13208:[[107,8467],256],13209:[[102,109],256],13210:[[110,109],256],13211:[[956,109],256],13212:[[109,109],256],13213:[[99,109],256],13214:[[107,109],256],13215:[[109,109,178],256],13216:[[99,109,178],256],13217:[[109,178],256],13218:[[107,109,178],256],13219:[[109,109,179],256],13220:[[99,109,179],256],13221:[[109,179],256],13222:[[107,109,179],256],13223:[[109,8725,115],256],13224:[[109,8725,115,178],256],13225:[[80,97],256],13226:[[107,80,97],256],13227:[[77,80,97],256],13228:[[71,80,97],256],13229:[[114,97,100],256],13230:[[114,97,100,8725,115],256],13231:[[114,97,100,8725,115,178],256],13232:[[112,115],256],13233:[[110,115],256],13234:[[956,115],256],13235:[[109,115],256],13236:[[112,86],256],13237:[[110,86],256],13238:[[956,86],256],13239:[[109,86],256],13240:[[107,86],256],13241:[[77,86],256],13242:[[112,87],256],13243:[[110,87],256],13244:[[956,87],256],13245:[[109,87],256],13246:[[107,87],256],13247:[[77,87],256],13248:[[107,937],256],13249:[[77,937],256],13250:[[97,46,109,46],256],13251:[[66,113],256],13252:[[99,99],256],13253:[[99,100],256],13254:[[67,8725,107,103],256],13255:[[67,111,46],256],13256:[[100,66],256],13257:[[71,121],256],13258:[[104,97],256],13259:[[72,80],256],13260:[[105,110],256],13261:[[75,75],256],13262:[[75,77],256],13263:[[107,116],256],13264:[[108,109],256],13265:[[108,110],256],13266:[[108,111,103],256],13267:[[108,120],256],13268:[[109,98],256],13269:[[109,105,108],256],13270:[[109,111,108],256],13271:[[80,72],256],13272:[[112,46,109,46],256],13273:[[80,80,77],256],13274:[[80,82],256],13275:[[115,114],256],13276:[[83,118],256],13277:[[87,98],256],13278:[[86,8725,109],256],13279:[[65,8725,109],256],13280:[[49,26085],256],13281:[[50,26085],256],13282:[[51,26085],256],13283:[[52,26085],256],13284:[[53,26085],256],13285:[[54,26085],256],13286:[[55,26085],256],13287:[[56,26085],256],13288:[[57,26085],256],13289:[[49,48,26085],256],13290:[[49,49,26085],256],13291:[[49,50,26085],256],13292:[[49,51,26085],256],13293:[[49,52,26085],256],13294:[[49,53,26085],256],13295:[[49,54,26085],256],13296:[[49,55,26085],256],13297:[[49,56,26085],256],13298:[[49,57,26085],256],13299:[[50,48,26085],256],13300:[[50,49,26085],256],13301:[[50,50,26085],256],13302:[[50,51,26085],256],13303:[[50,52,26085],256],13304:[[50,53,26085],256],13305:[[50,54,26085],256],13306:[[50,55,26085],256],13307:[[50,56,26085],256],13308:[[50,57,26085],256],13309:[[51,48,26085],256],13310:[[51,49,26085],256],13311:[[103,97,108],256]},27136:{92912:[,1],92913:[,1],92914:[,1],92915:[,1],92916:[,1]},27392:{92976:[,230],92977:[,230],92978:[,230],92979:[,230],92980:[,230],92981:[,230],92982:[,230]},42496:{42607:[,230],42612:[,230],42613:[,230],42614:[,230],42615:[,230],42616:[,230],42617:[,230],42618:[,230],42619:[,230],42620:[,230],42621:[,230],42652:[[1098],256],42653:[[1100],256],42655:[,230],42736:[,230],42737:[,230]},42752:{42864:[[42863],256],43e3:[[294],256],43001:[[339],256]},43008:{43014:[,9],43204:[,9],43232:[,230],43233:[,230],43234:[,230],43235:[,230],43236:[,230],43237:[,230],43238:[,230],43239:[,230],43240:[,230],43241:[,230],43242:[,230],43243:[,230],43244:[,230],43245:[,230],43246:[,230],43247:[,230],43248:[,230],43249:[,230]},43264:{43307:[,220],43308:[,220],43309:[,220],43347:[,9],43443:[,7],43456:[,9]},43520:{43696:[,230],43698:[,230],43699:[,230],43700:[,220],43703:[,230],43704:[,230],43710:[,230],43711:[,230],43713:[,230],43766:[,9]},43776:{43868:[[42791],256],43869:[[43831],256],43870:[[619],256],43871:[[43858],256],44013:[,9]},48128:{113822:[,1]},53504:{119134:[[119127,119141],512],119135:[[119128,119141],512],119136:[[119135,119150],512],119137:[[119135,119151],512],119138:[[119135,119152],512],119139:[[119135,119153],512],119140:[[119135,119154],512],119141:[,216],119142:[,216],119143:[,1],119144:[,1],119145:[,1],119149:[,226],119150:[,216],119151:[,216],119152:[,216],119153:[,216],119154:[,216],119163:[,220],119164:[,220],119165:[,220],119166:[,220],119167:[,220],119168:[,220],119169:[,220],119170:[,220],119173:[,230],119174:[,230],119175:[,230],119176:[,230],119177:[,230],119178:[,220],119179:[,220],119210:[,230],119211:[,230],119212:[,230],119213:[,230],119227:[[119225,119141],512],119228:[[119226,119141],512],119229:[[119227,119150],512],119230:[[119228,119150],512],119231:[[119227,119151],512],119232:[[119228,119151],512]},53760:{119362:[,230],119363:[,230],119364:[,230]},54272:{119808:[[65],256],119809:[[66],256],119810:[[67],256],119811:[[68],256],119812:[[69],256],119813:[[70],256],119814:[[71],256],119815:[[72],256],119816:[[73],256],119817:[[74],256],119818:[[75],256],119819:[[76],256],119820:[[77],256],119821:[[78],256],119822:[[79],256],119823:[[80],256],119824:[[81],256],119825:[[82],256],119826:[[83],256],119827:[[84],256],119828:[[85],256],119829:[[86],256],119830:[[87],256],119831:[[88],256],119832:[[89],256],119833:[[90],256],119834:[[97],256],119835:[[98],256],119836:[[99],256],119837:[[100],256],119838:[[101],256],119839:[[102],256],119840:[[103],256],119841:[[104],256],119842:[[105],256],119843:[[106],256],119844:[[107],256],119845:[[108],256],119846:[[109],256],119847:[[110],256],119848:[[111],256],119849:[[112],256],119850:[[113],256],119851:[[114],256],119852:[[115],256],119853:[[116],256],119854:[[117],256],119855:[[118],256],119856:[[119],256],119857:[[120],256],119858:[[121],256],119859:[[122],256],119860:[[65],256],119861:[[66],256],119862:[[67],256],119863:[[68],256],119864:[[69],256],119865:[[70],256],119866:[[71],256],119867:[[72],256],119868:[[73],256],119869:[[74],256],119870:[[75],256],119871:[[76],256],119872:[[77],256],119873:[[78],256],119874:[[79],256],119875:[[80],256],119876:[[81],256],119877:[[82],256],119878:[[83],256],119879:[[84],256],119880:[[85],256],119881:[[86],256],119882:[[87],256],119883:[[88],256],119884:[[89],256],119885:[[90],256],119886:[[97],256],119887:[[98],256],119888:[[99],256],119889:[[100],256],119890:[[101],256],119891:[[102],256],119892:[[103],256],119894:[[105],256],119895:[[106],256],119896:[[107],256],119897:[[108],256],119898:[[109],256],119899:[[110],256],119900:[[111],256],119901:[[112],256],119902:[[113],256],119903:[[114],256],119904:[[115],256],119905:[[116],256],119906:[[117],256],119907:[[118],256],119908:[[119],256],119909:[[120],256],119910:[[121],256],119911:[[122],256],119912:[[65],256],119913:[[66],256],119914:[[67],256],119915:[[68],256],119916:[[69],256],119917:[[70],256],119918:[[71],256],119919:[[72],256],119920:[[73],256],119921:[[74],256],119922:[[75],256],119923:[[76],256],119924:[[77],256],119925:[[78],256],119926:[[79],256],119927:[[80],256],119928:[[81],256],119929:[[82],256],119930:[[83],256],119931:[[84],256],119932:[[85],256],119933:[[86],256],119934:[[87],256],119935:[[88],256],119936:[[89],256],119937:[[90],256],119938:[[97],256],119939:[[98],256],119940:[[99],256],119941:[[100],256],119942:[[101],256],119943:[[102],256],119944:[[103],256],119945:[[104],256],119946:[[105],256],119947:[[106],256],119948:[[107],256],119949:[[108],256],119950:[[109],256],119951:[[110],256],119952:[[111],256],119953:[[112],256],119954:[[113],256],119955:[[114],256],119956:[[115],256],119957:[[116],256],119958:[[117],256],119959:[[118],256],119960:[[119],256],119961:[[120],256],119962:[[121],256],119963:[[122],256],119964:[[65],256],119966:[[67],256],119967:[[68],256],119970:[[71],256],119973:[[74],256],119974:[[75],256],119977:[[78],256],119978:[[79],256],119979:[[80],256],119980:[[81],256],119982:[[83],256],119983:[[84],256],119984:[[85],256],119985:[[86],256],119986:[[87],256],119987:[[88],256],119988:[[89],256],119989:[[90],256],119990:[[97],256],119991:[[98],256],119992:[[99],256],119993:[[100],256],119995:[[102],256],119997:[[104],256],119998:[[105],256],119999:[[106],256],12e4:[[107],256],120001:[[108],256],120002:[[109],256],120003:[[110],256],120005:[[112],256],120006:[[113],256],120007:[[114],256],120008:[[115],256],120009:[[116],256],120010:[[117],256],120011:[[118],256],120012:[[119],256],120013:[[120],256],120014:[[121],256],120015:[[122],256],120016:[[65],256],120017:[[66],256],120018:[[67],256],120019:[[68],256],120020:[[69],256],120021:[[70],256],120022:[[71],256],120023:[[72],256],120024:[[73],256],120025:[[74],256],120026:[[75],256],120027:[[76],256],120028:[[77],256],120029:[[78],256],120030:[[79],256],120031:[[80],256],120032:[[81],256],120033:[[82],256],120034:[[83],256],120035:[[84],256],120036:[[85],256],120037:[[86],256],120038:[[87],256],120039:[[88],256],120040:[[89],256],120041:[[90],256],120042:[[97],256],120043:[[98],256],120044:[[99],256],120045:[[100],256],120046:[[101],256],120047:[[102],256],120048:[[103],256],120049:[[104],256],120050:[[105],256],120051:[[106],256],120052:[[107],256],120053:[[108],256],120054:[[109],256],120055:[[110],256],120056:[[111],256],120057:[[112],256],120058:[[113],256],120059:[[114],256],120060:[[115],256],120061:[[116],256],120062:[[117],256],120063:[[118],256]},54528:{120064:[[119],256],120065:[[120],256],120066:[[121],256],120067:[[122],256],120068:[[65],256],120069:[[66],256],120071:[[68],256],120072:[[69],256],120073:[[70],256],120074:[[71],256],120077:[[74],256],120078:[[75],256],120079:[[76],256],120080:[[77],256],120081:[[78],256],120082:[[79],256],120083:[[80],256],120084:[[81],256],120086:[[83],256],120087:[[84],256],120088:[[85],256],120089:[[86],256],120090:[[87],256],120091:[[88],256],120092:[[89],256],120094:[[97],256],120095:[[98],256],120096:[[99],256],120097:[[100],256],120098:[[101],256],120099:[[102],256],120100:[[103],256],120101:[[104],256],120102:[[105],256],120103:[[106],256],120104:[[107],256],120105:[[108],256],120106:[[109],256],120107:[[110],256],120108:[[111],256],120109:[[112],256],120110:[[113],256],120111:[[114],256],120112:[[115],256],120113:[[116],256],120114:[[117],256],120115:[[118],256],120116:[[119],256],120117:[[120],256],120118:[[121],256],120119:[[122],256],120120:[[65],256],120121:[[66],256],120123:[[68],256],120124:[[69],256],120125:[[70],256],120126:[[71],256],120128:[[73],256],120129:[[74],256],120130:[[75],256],120131:[[76],256],120132:[[77],256],120134:[[79],256],120138:[[83],256],120139:[[84],256],120140:[[85],256],120141:[[86],256],120142:[[87],256],120143:[[88],256],120144:[[89],256],120146:[[97],256],120147:[[98],256],120148:[[99],256],120149:[[100],256],120150:[[101],256],120151:[[102],256],120152:[[103],256],120153:[[104],256],120154:[[105],256],120155:[[106],256],120156:[[107],256],120157:[[108],256],120158:[[109],256],120159:[[110],256],120160:[[111],256],120161:[[112],256],120162:[[113],256],120163:[[114],256],120164:[[115],256],120165:[[116],256],120166:[[117],256],120167:[[118],256],120168:[[119],256],120169:[[120],256],120170:[[121],256],120171:[[122],256],120172:[[65],256],120173:[[66],256],120174:[[67],256],120175:[[68],256],120176:[[69],256],120177:[[70],256],120178:[[71],256],120179:[[72],256],120180:[[73],256],120181:[[74],256],120182:[[75],256],120183:[[76],256],120184:[[77],256],120185:[[78],256],120186:[[79],256],120187:[[80],256],120188:[[81],256],120189:[[82],256],120190:[[83],256],120191:[[84],256],120192:[[85],256],120193:[[86],256],120194:[[87],256],120195:[[88],256],120196:[[89],256],120197:[[90],256],120198:[[97],256],120199:[[98],256],120200:[[99],256],120201:[[100],256],120202:[[101],256],120203:[[102],256],120204:[[103],256],120205:[[104],256],120206:[[105],256],120207:[[106],256],120208:[[107],256],120209:[[108],256],120210:[[109],256],120211:[[110],256],120212:[[111],256],120213:[[112],256],120214:[[113],256],120215:[[114],256],120216:[[115],256],120217:[[116],256],120218:[[117],256],120219:[[118],256],120220:[[119],256],120221:[[120],256],120222:[[121],256],120223:[[122],256],120224:[[65],256],120225:[[66],256],120226:[[67],256],120227:[[68],256],120228:[[69],256],120229:[[70],256],120230:[[71],256],120231:[[72],256],120232:[[73],256],120233:[[74],256],120234:[[75],256],120235:[[76],256],120236:[[77],256],120237:[[78],256],120238:[[79],256],120239:[[80],256],120240:[[81],256],120241:[[82],256],120242:[[83],256],120243:[[84],256],120244:[[85],256],120245:[[86],256],120246:[[87],256],120247:[[88],256],120248:[[89],256],120249:[[90],256],120250:[[97],256],120251:[[98],256],120252:[[99],256],120253:[[100],256],120254:[[101],256],120255:[[102],256],120256:[[103],256],120257:[[104],256],120258:[[105],256],120259:[[106],256],120260:[[107],256],120261:[[108],256],120262:[[109],256],120263:[[110],256],120264:[[111],256],120265:[[112],256],120266:[[113],256],120267:[[114],256],120268:[[115],256],120269:[[116],256],120270:[[117],256],120271:[[118],256],120272:[[119],256],120273:[[120],256],120274:[[121],256],120275:[[122],256],120276:[[65],256],120277:[[66],256],120278:[[67],256],120279:[[68],256],120280:[[69],256],120281:[[70],256],120282:[[71],256],120283:[[72],256],120284:[[73],256],120285:[[74],256],120286:[[75],256],120287:[[76],256],120288:[[77],256],120289:[[78],256],120290:[[79],256],120291:[[80],256],120292:[[81],256],120293:[[82],256],120294:[[83],256],120295:[[84],256],120296:[[85],256],120297:[[86],256],120298:[[87],256],120299:[[88],256],120300:[[89],256],120301:[[90],256],120302:[[97],256],120303:[[98],256],120304:[[99],256],120305:[[100],256],120306:[[101],256],120307:[[102],256],120308:[[103],256],120309:[[104],256],120310:[[105],256],120311:[[106],256],120312:[[107],256],120313:[[108],256],120314:[[109],256],120315:[[110],256],120316:[[111],256],120317:[[112],256],120318:[[113],256],120319:[[114],256]},54784:{120320:[[115],256],120321:[[116],256],120322:[[117],256],120323:[[118],256],120324:[[119],256],120325:[[120],256],120326:[[121],256],120327:[[122],256],120328:[[65],256],120329:[[66],256],120330:[[67],256],120331:[[68],256],120332:[[69],256],120333:[[70],256],120334:[[71],256],120335:[[72],256],120336:[[73],256],120337:[[74],256],120338:[[75],256],120339:[[76],256],120340:[[77],256],120341:[[78],256],120342:[[79],256],120343:[[80],256],120344:[[81],256],120345:[[82],256],120346:[[83],256],120347:[[84],256],120348:[[85],256],120349:[[86],256],120350:[[87],256],120351:[[88],256],120352:[[89],256],120353:[[90],256],120354:[[97],256],120355:[[98],256],120356:[[99],256],120357:[[100],256],120358:[[101],256],120359:[[102],256],120360:[[103],256],120361:[[104],256],120362:[[105],256],120363:[[106],256],120364:[[107],256],120365:[[108],256],120366:[[109],256],120367:[[110],256],120368:[[111],256],120369:[[112],256],120370:[[113],256],120371:[[114],256],120372:[[115],256],120373:[[116],256],120374:[[117],256],120375:[[118],256],120376:[[119],256],120377:[[120],256],120378:[[121],256],120379:[[122],256],120380:[[65],256],120381:[[66],256],120382:[[67],256],120383:[[68],256],120384:[[69],256],120385:[[70],256],120386:[[71],256],120387:[[72],256],120388:[[73],256],120389:[[74],256],120390:[[75],256],120391:[[76],256],120392:[[77],256],120393:[[78],256],120394:[[79],256],120395:[[80],256],120396:[[81],256],120397:[[82],256],120398:[[83],256],120399:[[84],256],120400:[[85],256],120401:[[86],256],120402:[[87],256],120403:[[88],256],120404:[[89],256],120405:[[90],256],120406:[[97],256],120407:[[98],256],120408:[[99],256],120409:[[100],256],120410:[[101],256],120411:[[102],256],120412:[[103],256],120413:[[104],256],120414:[[105],256],120415:[[106],256],120416:[[107],256],120417:[[108],256],120418:[[109],256],120419:[[110],256],120420:[[111],256],120421:[[112],256],120422:[[113],256],120423:[[114],256],120424:[[115],256],120425:[[116],256],120426:[[117],256],120427:[[118],256],120428:[[119],256],120429:[[120],256],120430:[[121],256],120431:[[122],256],120432:[[65],256],120433:[[66],256],120434:[[67],256],120435:[[68],256],120436:[[69],256],120437:[[70],256],120438:[[71],256],120439:[[72],256],120440:[[73],256],120441:[[74],256],120442:[[75],256],120443:[[76],256],120444:[[77],256],120445:[[78],256],120446:[[79],256],120447:[[80],256],120448:[[81],256],120449:[[82],256],120450:[[83],256],120451:[[84],256],120452:[[85],256],120453:[[86],256],120454:[[87],256],120455:[[88],256],120456:[[89],256],120457:[[90],256],120458:[[97],256],120459:[[98],256],120460:[[99],256],120461:[[100],256],120462:[[101],256],120463:[[102],256],120464:[[103],256],120465:[[104],256],120466:[[105],256],120467:[[106],256],120468:[[107],256],120469:[[108],256],120470:[[109],256],120471:[[110],256],120472:[[111],256],120473:[[112],256],120474:[[113],256],120475:[[114],256],120476:[[115],256],120477:[[116],256],120478:[[117],256],120479:[[118],256],120480:[[119],256],120481:[[120],256],120482:[[121],256],120483:[[122],256],120484:[[305],256],120485:[[567],256],120488:[[913],256],120489:[[914],256],120490:[[915],256],120491:[[916],256],120492:[[917],256],120493:[[918],256],120494:[[919],256],120495:[[920],256],120496:[[921],256],120497:[[922],256],120498:[[923],256],120499:[[924],256],120500:[[925],256],120501:[[926],256],120502:[[927],256],120503:[[928],256],120504:[[929],256],120505:[[1012],256],120506:[[931],256],120507:[[932],256],120508:[[933],256],120509:[[934],256],120510:[[935],256],120511:[[936],256],120512:[[937],256],120513:[[8711],256],120514:[[945],256],120515:[[946],256],120516:[[947],256],120517:[[948],256],120518:[[949],256],120519:[[950],256],120520:[[951],256],120521:[[952],256],120522:[[953],256],120523:[[954],256],120524:[[955],256],120525:[[956],256],120526:[[957],256],120527:[[958],256],120528:[[959],256],120529:[[960],256],120530:[[961],256],120531:[[962],256],120532:[[963],256],120533:[[964],256],120534:[[965],256],120535:[[966],256],120536:[[967],256],120537:[[968],256],120538:[[969],256],120539:[[8706],256],120540:[[1013],256],120541:[[977],256],120542:[[1008],256],120543:[[981],256],120544:[[1009],256],120545:[[982],256],120546:[[913],256],120547:[[914],256],120548:[[915],256],120549:[[916],256],120550:[[917],256],120551:[[918],256],120552:[[919],256],120553:[[920],256],120554:[[921],256],120555:[[922],256],120556:[[923],256],120557:[[924],256],120558:[[925],256],120559:[[926],256],120560:[[927],256],120561:[[928],256],120562:[[929],256],120563:[[1012],256],120564:[[931],256],120565:[[932],256],120566:[[933],256],120567:[[934],256],120568:[[935],256],120569:[[936],256],120570:[[937],256],120571:[[8711],256],120572:[[945],256],120573:[[946],256],120574:[[947],256],120575:[[948],256]},55040:{120576:[[949],256],120577:[[950],256],120578:[[951],256],120579:[[952],256],120580:[[953],256],120581:[[954],256],120582:[[955],256],120583:[[956],256],120584:[[957],256],120585:[[958],256],120586:[[959],256],120587:[[960],256],120588:[[961],256],120589:[[962],256],120590:[[963],256],120591:[[964],256],120592:[[965],256],120593:[[966],256],120594:[[967],256],120595:[[968],256],120596:[[969],256],120597:[[8706],256],120598:[[1013],256],120599:[[977],256],120600:[[1008],256],120601:[[981],256],120602:[[1009],256],120603:[[982],256],120604:[[913],256],120605:[[914],256],120606:[[915],256],120607:[[916],256],120608:[[917],256],120609:[[918],256],120610:[[919],256],120611:[[920],256],120612:[[921],256],120613:[[922],256],120614:[[923],256],120615:[[924],256],120616:[[925],256],120617:[[926],256],120618:[[927],256],120619:[[928],256],120620:[[929],256],120621:[[1012],256],120622:[[931],256],120623:[[932],256],120624:[[933],256],120625:[[934],256],120626:[[935],256],120627:[[936],256],120628:[[937],256],120629:[[8711],256],120630:[[945],256],120631:[[946],256],120632:[[947],256],120633:[[948],256],120634:[[949],256],120635:[[950],256],120636:[[951],256],120637:[[952],256],120638:[[953],256],120639:[[954],256],120640:[[955],256],120641:[[956],256],120642:[[957],256],120643:[[958],256],120644:[[959],256],120645:[[960],256],120646:[[961],256],120647:[[962],256],120648:[[963],256],120649:[[964],256],120650:[[965],256],120651:[[966],256],120652:[[967],256],120653:[[968],256],120654:[[969],256],120655:[[8706],256],120656:[[1013],256],120657:[[977],256],120658:[[1008],256],120659:[[981],256],120660:[[1009],256],120661:[[982],256],120662:[[913],256],120663:[[914],256],120664:[[915],256],120665:[[916],256],120666:[[917],256],120667:[[918],256],120668:[[919],256],120669:[[920],256],120670:[[921],256],120671:[[922],256],120672:[[923],256],120673:[[924],256],120674:[[925],256],120675:[[926],256],120676:[[927],256],120677:[[928],256],120678:[[929],256],120679:[[1012],256],120680:[[931],256],120681:[[932],256],120682:[[933],256],120683:[[934],256],120684:[[935],256],120685:[[936],256],120686:[[937],256],120687:[[8711],256],120688:[[945],256],120689:[[946],256],120690:[[947],256],120691:[[948],256],120692:[[949],256],120693:[[950],256],120694:[[951],256],120695:[[952],256],120696:[[953],256],120697:[[954],256],120698:[[955],256],120699:[[956],256],120700:[[957],256],120701:[[958],256],120702:[[959],256],120703:[[960],256],120704:[[961],256],120705:[[962],256],120706:[[963],256],120707:[[964],256],120708:[[965],256],120709:[[966],256],120710:[[967],256],120711:[[968],256],120712:[[969],256],120713:[[8706],256],120714:[[1013],256],120715:[[977],256],120716:[[1008],256],120717:[[981],256],120718:[[1009],256],120719:[[982],256],120720:[[913],256],120721:[[914],256],120722:[[915],256],120723:[[916],256],120724:[[917],256],120725:[[918],256],120726:[[919],256],120727:[[920],256],120728:[[921],256],120729:[[922],256],120730:[[923],256],120731:[[924],256],120732:[[925],256],120733:[[926],256],120734:[[927],256],120735:[[928],256],120736:[[929],256],120737:[[1012],256],120738:[[931],256],120739:[[932],256],120740:[[933],256],120741:[[934],256],120742:[[935],256],120743:[[936],256],120744:[[937],256],120745:[[8711],256],120746:[[945],256],120747:[[946],256],120748:[[947],256],120749:[[948],256],120750:[[949],256],120751:[[950],256],120752:[[951],256],120753:[[952],256],120754:[[953],256],120755:[[954],256],120756:[[955],256],120757:[[956],256],120758:[[957],256],120759:[[958],256],120760:[[959],256],120761:[[960],256],120762:[[961],256],120763:[[962],256],120764:[[963],256],120765:[[964],256],120766:[[965],256],120767:[[966],256],120768:[[967],256],120769:[[968],256],120770:[[969],256],120771:[[8706],256],120772:[[1013],256],120773:[[977],256],120774:[[1008],256],120775:[[981],256],120776:[[1009],256],120777:[[982],256],120778:[[988],256],120779:[[989],256],120782:[[48],256],120783:[[49],256],120784:[[50],256],120785:[[51],256],120786:[[52],256],120787:[[53],256],120788:[[54],256],120789:[[55],256],120790:[[56],256],120791:[[57],256],120792:[[48],256],120793:[[49],256],120794:[[50],256],120795:[[51],256],120796:[[52],256],120797:[[53],256],120798:[[54],256],120799:[[55],256],120800:[[56],256],120801:[[57],256],120802:[[48],256],120803:[[49],256],120804:[[50],256],120805:[[51],256],120806:[[52],256],120807:[[53],256],120808:[[54],256],120809:[[55],256],120810:[[56],256],120811:[[57],256],120812:[[48],256],120813:[[49],256],120814:[[50],256],120815:[[51],256],120816:[[52],256],120817:[[53],256],120818:[[54],256],120819:[[55],256],120820:[[56],256],120821:[[57],256],120822:[[48],256],120823:[[49],256],120824:[[50],256],120825:[[51],256],120826:[[52],256],120827:[[53],256],120828:[[54],256],120829:[[55],256],120830:[[56],256],120831:[[57],256]},59392:{125136:[,220],125137:[,220],125138:[,220],125139:[,220],125140:[,220],125141:[,220],125142:[,220]},60928:{126464:[[1575],256],126465:[[1576],256],126466:[[1580],256],126467:[[1583],256],126469:[[1608],256],126470:[[1586],256],126471:[[1581],256],126472:[[1591],256],126473:[[1610],256],126474:[[1603],256],126475:[[1604],256],126476:[[1605],256],126477:[[1606],256],126478:[[1587],256],126479:[[1593],256],126480:[[1601],256],126481:[[1589],256],126482:[[1602],256],126483:[[1585],256],126484:[[1588],256],126485:[[1578],256],126486:[[1579],256],126487:[[1582],256],126488:[[1584],256],126489:[[1590],256],126490:[[1592],256],126491:[[1594],256],126492:[[1646],256],126493:[[1722],256],126494:[[1697],256],126495:[[1647],256],126497:[[1576],256],126498:[[1580],256],126500:[[1607],256],126503:[[1581],256],126505:[[1610],256],126506:[[1603],256],126507:[[1604],256],126508:[[1605],256],126509:[[1606],256],126510:[[1587],256],126511:[[1593],256],126512:[[1601],256],126513:[[1589],256],126514:[[1602],256],126516:[[1588],256],126517:[[1578],256],126518:[[1579],256],126519:[[1582],256],126521:[[1590],256],126523:[[1594],256],126530:[[1580],256],126535:[[1581],256],126537:[[1610],256],126539:[[1604],256],126541:[[1606],256],126542:[[1587],256],126543:[[1593],256],126545:[[1589],256],126546:[[1602],256],126548:[[1588],256],126551:[[1582],256],126553:[[1590],256],126555:[[1594],256],126557:[[1722],256],126559:[[1647],256],126561:[[1576],256],126562:[[1580],256],126564:[[1607],256],126567:[[1581],256],126568:[[1591],256],126569:[[1610],256],126570:[[1603],256],126572:[[1605],256],126573:[[1606],256],126574:[[1587],256],126575:[[1593],256],126576:[[1601],256],126577:[[1589],256],126578:[[1602],256],126580:[[1588],256],126581:[[1578],256],126582:[[1579],256],126583:[[1582],256],126585:[[1590],256],126586:[[1592],256],126587:[[1594],256],126588:[[1646],256],126590:[[1697],256],126592:[[1575],256],126593:[[1576],256],126594:[[1580],256],126595:[[1583],256],126596:[[1607],256],126597:[[1608],256],126598:[[1586],256],126599:[[1581],256],126600:[[1591],256],126601:[[1610],256],126603:[[1604],256],126604:[[1605],256],126605:[[1606],256],126606:[[1587],256],126607:[[1593],256],126608:[[1601],256],126609:[[1589],256],126610:[[1602],256],126611:[[1585],256],126612:[[1588],256],126613:[[1578],256],126614:[[1579],256],126615:[[1582],256],126616:[[1584],256],126617:[[1590],256],126618:[[1592],256],126619:[[1594],256],126625:[[1576],256],126626:[[1580],256],126627:[[1583],256],126629:[[1608],256],126630:[[1586],256],126631:[[1581],256],126632:[[1591],256],126633:[[1610],256],126635:[[1604],256],126636:[[1605],256],126637:[[1606],256],126638:[[1587],256],126639:[[1593],256],126640:[[1601],256],126641:[[1589],256],126642:[[1602],256],126643:[[1585],256],126644:[[1588],256],126645:[[1578],256],126646:[[1579],256],126647:[[1582],256],126648:[[1584],256],126649:[[1590],256],126650:[[1592],256],126651:[[1594],256]},61696:{127232:[[48,46],256],127233:[[48,44],256],127234:[[49,44],256],127235:[[50,44],256],127236:[[51,44],256],127237:[[52,44],256],127238:[[53,44],256],127239:[[54,44],256],127240:[[55,44],256],127241:[[56,44],256],127242:[[57,44],256],127248:[[40,65,41],256],127249:[[40,66,41],256],127250:[[40,67,41],256],127251:[[40,68,41],256],127252:[[40,69,41],256],127253:[[40,70,41],256],127254:[[40,71,41],256],127255:[[40,72,41],256],127256:[[40,73,41],256],127257:[[40,74,41],256],127258:[[40,75,41],256],127259:[[40,76,41],256],127260:[[40,77,41],256],127261:[[40,78,41],256],127262:[[40,79,41],256],127263:[[40,80,41],256],127264:[[40,81,41],256],127265:[[40,82,41],256],127266:[[40,83,41],256],127267:[[40,84,41],256],127268:[[40,85,41],256],127269:[[40,86,41],256],127270:[[40,87,41],256],127271:[[40,88,41],256],127272:[[40,89,41],256],127273:[[40,90,41],256],127274:[[12308,83,12309],256],127275:[[67],256],127276:[[82],256],127277:[[67,68],256],127278:[[87,90],256],127280:[[65],256],127281:[[66],256],127282:[[67],256],127283:[[68],256],127284:[[69],256],127285:[[70],256],127286:[[71],256],127287:[[72],256],127288:[[73],256],127289:[[74],256],127290:[[75],256],127291:[[76],256],127292:[[77],256],127293:[[78],256],127294:[[79],256],127295:[[80],256],127296:[[81],256],127297:[[82],256],127298:[[83],256],127299:[[84],256],127300:[[85],256],127301:[[86],256],127302:[[87],256],127303:[[88],256],127304:[[89],256],127305:[[90],256],127306:[[72,86],256],127307:[[77,86],256],127308:[[83,68],256],127309:[[83,83],256],127310:[[80,80,86],256],127311:[[87,67],256],127338:[[77,67],256],127339:[[77,68],256],127376:[[68,74],256]},61952:{127488:[[12411,12363],256],127489:[[12467,12467],256],127490:[[12469],256],127504:[[25163],256],127505:[[23383],256],127506:[[21452],256],127507:[[12487],256],127508:[[20108],256],127509:[[22810],256],127510:[[35299],256],127511:[[22825],256],127512:[[20132],256],127513:[[26144],256],127514:[[28961],256],127515:[[26009],256],127516:[[21069],256],127517:[[24460],256],127518:[[20877],256],127519:[[26032],256],127520:[[21021],256],127521:[[32066],256],127522:[[29983],256],127523:[[36009],256],127524:[[22768],256],127525:[[21561],256],127526:[[28436],256],127527:[[25237],256],127528:[[25429],256],127529:[[19968],256],127530:[[19977],256],127531:[[36938],256],127532:[[24038],256],127533:[[20013],256],127534:[[21491],256],127535:[[25351],256],127536:[[36208],256],127537:[[25171],256],127538:[[31105],256],127539:[[31354],256],127540:[[21512],256],127541:[[28288],256],127542:[[26377],256],127543:[[26376],256],127544:[[30003],256],127545:[[21106],256],127546:[[21942],256],127552:[[12308,26412,12309],256],127553:[[12308,19977,12309],256],127554:[[12308,20108,12309],256],127555:[[12308,23433,12309],256],127556:[[12308,28857,12309],256],127557:[[12308,25171,12309],256],127558:[[12308,30423,12309],256],127559:[[12308,21213,12309],256],127560:[[12308,25943,12309],256],127568:[[24471],256],127569:[[21487],256]},63488:{194560:[[20029]],194561:[[20024]],194562:[[20033]],194563:[[131362]],194564:[[20320]],194565:[[20398]],194566:[[20411]],194567:[[20482]],194568:[[20602]],194569:[[20633]],194570:[[20711]],194571:[[20687]],194572:[[13470]],194573:[[132666]],194574:[[20813]],194575:[[20820]],194576:[[20836]],194577:[[20855]],194578:[[132380]],194579:[[13497]],194580:[[20839]],194581:[[20877]],194582:[[132427]],194583:[[20887]],194584:[[20900]],194585:[[20172]],194586:[[20908]],194587:[[20917]],194588:[[168415]],194589:[[20981]],194590:[[20995]],194591:[[13535]],194592:[[21051]],194593:[[21062]],194594:[[21106]],194595:[[21111]],194596:[[13589]],194597:[[21191]],194598:[[21193]],194599:[[21220]],194600:[[21242]],194601:[[21253]],194602:[[21254]],194603:[[21271]],194604:[[21321]],194605:[[21329]],194606:[[21338]],194607:[[21363]],194608:[[21373]],194609:[[21375]],194610:[[21375]],194611:[[21375]],194612:[[133676]],194613:[[28784]],194614:[[21450]],194615:[[21471]],194616:[[133987]],194617:[[21483]],194618:[[21489]],194619:[[21510]],194620:[[21662]],194621:[[21560]],194622:[[21576]],194623:[[21608]],194624:[[21666]],194625:[[21750]],194626:[[21776]],194627:[[21843]],194628:[[21859]],194629:[[21892]],194630:[[21892]],194631:[[21913]],194632:[[21931]],194633:[[21939]],194634:[[21954]],194635:[[22294]],194636:[[22022]],194637:[[22295]],194638:[[22097]],194639:[[22132]],194640:[[20999]],194641:[[22766]],194642:[[22478]],194643:[[22516]],194644:[[22541]],194645:[[22411]],194646:[[22578]],194647:[[22577]],194648:[[22700]],194649:[[136420]],194650:[[22770]],194651:[[22775]],194652:[[22790]],194653:[[22810]],194654:[[22818]],194655:[[22882]],194656:[[136872]],194657:[[136938]],194658:[[23020]],194659:[[23067]],194660:[[23079]],194661:[[23e3]],194662:[[23142]],194663:[[14062]],194664:[[14076]],194665:[[23304]],194666:[[23358]],194667:[[23358]],194668:[[137672]],194669:[[23491]],194670:[[23512]],194671:[[23527]],194672:[[23539]],194673:[[138008]],194674:[[23551]],194675:[[23558]],194676:[[24403]],194677:[[23586]],194678:[[14209]],194679:[[23648]],194680:[[23662]],194681:[[23744]],194682:[[23693]],194683:[[138724]],194684:[[23875]],194685:[[138726]],194686:[[23918]],194687:[[23915]],194688:[[23932]],194689:[[24033]],194690:[[24034]],194691:[[14383]],194692:[[24061]],194693:[[24104]],194694:[[24125]],194695:[[24169]],194696:[[14434]],194697:[[139651]],194698:[[14460]],194699:[[24240]],194700:[[24243]],194701:[[24246]],194702:[[24266]],194703:[[172946]],194704:[[24318]],194705:[[140081]],194706:[[140081]],194707:[[33281]],194708:[[24354]],194709:[[24354]],194710:[[14535]],194711:[[144056]],194712:[[156122]],194713:[[24418]],194714:[[24427]],194715:[[14563]],194716:[[24474]],194717:[[24525]],194718:[[24535]],194719:[[24569]],194720:[[24705]],194721:[[14650]],194722:[[14620]],194723:[[24724]],194724:[[141012]],194725:[[24775]],194726:[[24904]],194727:[[24908]],194728:[[24910]],194729:[[24908]],194730:[[24954]],194731:[[24974]],194732:[[25010]],194733:[[24996]],194734:[[25007]],194735:[[25054]],194736:[[25074]],194737:[[25078]],194738:[[25104]],194739:[[25115]],194740:[[25181]],194741:[[25265]],194742:[[25300]],194743:[[25424]],194744:[[142092]],194745:[[25405]],194746:[[25340]],194747:[[25448]],194748:[[25475]],194749:[[25572]],194750:[[142321]],194751:[[25634]],194752:[[25541]],194753:[[25513]],194754:[[14894]],194755:[[25705]],194756:[[25726]],194757:[[25757]],194758:[[25719]],194759:[[14956]],194760:[[25935]],194761:[[25964]],194762:[[143370]],194763:[[26083]],194764:[[26360]],194765:[[26185]],194766:[[15129]],194767:[[26257]],194768:[[15112]],194769:[[15076]],194770:[[20882]],194771:[[20885]],194772:[[26368]],194773:[[26268]],194774:[[32941]],194775:[[17369]],194776:[[26391]],194777:[[26395]],194778:[[26401]],194779:[[26462]],194780:[[26451]],194781:[[144323]],194782:[[15177]],194783:[[26618]],194784:[[26501]],194785:[[26706]],194786:[[26757]],194787:[[144493]],194788:[[26766]],194789:[[26655]],194790:[[26900]],194791:[[15261]],194792:[[26946]],194793:[[27043]],194794:[[27114]],194795:[[27304]],194796:[[145059]],194797:[[27355]],194798:[[15384]],194799:[[27425]],194800:[[145575]],194801:[[27476]],194802:[[15438]],194803:[[27506]],194804:[[27551]],194805:[[27578]],194806:[[27579]],194807:[[146061]],194808:[[138507]],194809:[[146170]],194810:[[27726]],194811:[[146620]],194812:[[27839]],194813:[[27853]],194814:[[27751]],194815:[[27926]]},63744:{63744:[[35912]],63745:[[26356]],63746:[[36554]],63747:[[36040]],63748:[[28369]],63749:[[20018]],63750:[[21477]],63751:[[40860]],63752:[[40860]],63753:[[22865]],63754:[[37329]],63755:[[21895]],63756:[[22856]],63757:[[25078]],63758:[[30313]],63759:[[32645]],63760:[[34367]],63761:[[34746]],63762:[[35064]],63763:[[37007]],63764:[[27138]],63765:[[27931]],63766:[[28889]],63767:[[29662]],63768:[[33853]],63769:[[37226]],63770:[[39409]],63771:[[20098]],63772:[[21365]],63773:[[27396]],63774:[[29211]],63775:[[34349]],63776:[[40478]],63777:[[23888]],63778:[[28651]],63779:[[34253]],63780:[[35172]],63781:[[25289]],63782:[[33240]],63783:[[34847]],63784:[[24266]],63785:[[26391]],63786:[[28010]],63787:[[29436]],63788:[[37070]],63789:[[20358]],63790:[[20919]],63791:[[21214]],63792:[[25796]],63793:[[27347]],63794:[[29200]],63795:[[30439]],63796:[[32769]],63797:[[34310]],63798:[[34396]],63799:[[36335]],63800:[[38706]],63801:[[39791]],63802:[[40442]],63803:[[30860]],63804:[[31103]],63805:[[32160]],63806:[[33737]],63807:[[37636]],63808:[[40575]],63809:[[35542]],63810:[[22751]],63811:[[24324]],63812:[[31840]],63813:[[32894]],63814:[[29282]],63815:[[30922]],63816:[[36034]],63817:[[38647]],63818:[[22744]],63819:[[23650]],63820:[[27155]],63821:[[28122]],63822:[[28431]],63823:[[32047]],63824:[[32311]],63825:[[38475]],63826:[[21202]],63827:[[32907]],63828:[[20956]],63829:[[20940]],63830:[[31260]],63831:[[32190]],63832:[[33777]],63833:[[38517]],63834:[[35712]],63835:[[25295]],63836:[[27138]],63837:[[35582]],63838:[[20025]],63839:[[23527]],63840:[[24594]],63841:[[29575]],63842:[[30064]],63843:[[21271]],63844:[[30971]],63845:[[20415]],63846:[[24489]],63847:[[19981]],63848:[[27852]],63849:[[25976]],63850:[[32034]],63851:[[21443]],63852:[[22622]],63853:[[30465]],63854:[[33865]],63855:[[35498]],63856:[[27578]],63857:[[36784]],63858:[[27784]],63859:[[25342]],63860:[[33509]],63861:[[25504]],63862:[[30053]],63863:[[20142]],63864:[[20841]],63865:[[20937]],63866:[[26753]],63867:[[31975]],63868:[[33391]],63869:[[35538]],63870:[[37327]],63871:[[21237]],63872:[[21570]],63873:[[22899]],63874:[[24300]],63875:[[26053]],63876:[[28670]],63877:[[31018]],63878:[[38317]],63879:[[39530]],63880:[[40599]],63881:[[40654]],63882:[[21147]],63883:[[26310]],63884:[[27511]],63885:[[36706]],63886:[[24180]],63887:[[24976]],63888:[[25088]],63889:[[25754]],63890:[[28451]],63891:[[29001]],63892:[[29833]],63893:[[31178]],63894:[[32244]],63895:[[32879]],63896:[[36646]],63897:[[34030]],63898:[[36899]],63899:[[37706]],63900:[[21015]],63901:[[21155]],63902:[[21693]],63903:[[28872]],63904:[[35010]],63905:[[35498]],63906:[[24265]],63907:[[24565]],63908:[[25467]],63909:[[27566]],63910:[[31806]],63911:[[29557]],63912:[[20196]],63913:[[22265]],63914:[[23527]],63915:[[23994]],63916:[[24604]],63917:[[29618]],63918:[[29801]],63919:[[32666]],63920:[[32838]],63921:[[37428]],63922:[[38646]],63923:[[38728]],63924:[[38936]],63925:[[20363]],63926:[[31150]],63927:[[37300]],63928:[[38584]],63929:[[24801]],63930:[[20102]],63931:[[20698]],63932:[[23534]],63933:[[23615]],63934:[[26009]],63935:[[27138]],63936:[[29134]],63937:[[30274]],63938:[[34044]],63939:[[36988]],63940:[[40845]],63941:[[26248]],63942:[[38446]],63943:[[21129]],63944:[[26491]],63945:[[26611]],63946:[[27969]],63947:[[28316]],63948:[[29705]],63949:[[30041]],63950:[[30827]],63951:[[32016]],63952:[[39006]],63953:[[20845]],63954:[[25134]],63955:[[38520]],63956:[[20523]],63957:[[23833]],63958:[[28138]],63959:[[36650]],63960:[[24459]],63961:[[24900]],63962:[[26647]],63963:[[29575]],63964:[[38534]],63965:[[21033]],63966:[[21519]],63967:[[23653]],63968:[[26131]],63969:[[26446]],63970:[[26792]],63971:[[27877]],63972:[[29702]],63973:[[30178]],63974:[[32633]],63975:[[35023]],63976:[[35041]],63977:[[37324]],63978:[[38626]],63979:[[21311]],63980:[[28346]],63981:[[21533]],63982:[[29136]],63983:[[29848]],63984:[[34298]],63985:[[38563]],63986:[[40023]],63987:[[40607]],63988:[[26519]],63989:[[28107]],63990:[[33256]],63991:[[31435]],63992:[[31520]],63993:[[31890]],63994:[[29376]],63995:[[28825]],63996:[[35672]],63997:[[20160]],63998:[[33590]],63999:[[21050]],194816:[[27966]],194817:[[28023]],194818:[[27969]],194819:[[28009]],194820:[[28024]],194821:[[28037]],194822:[[146718]],194823:[[27956]],194824:[[28207]],194825:[[28270]],194826:[[15667]],194827:[[28363]],194828:[[28359]],194829:[[147153]],194830:[[28153]],194831:[[28526]],194832:[[147294]],194833:[[147342]],194834:[[28614]],194835:[[28729]],194836:[[28702]],194837:[[28699]],194838:[[15766]],194839:[[28746]],194840:[[28797]],194841:[[28791]],194842:[[28845]],194843:[[132389]],194844:[[28997]],194845:[[148067]],194846:[[29084]],194847:[[148395]],194848:[[29224]],194849:[[29237]],194850:[[29264]],194851:[[149e3]],194852:[[29312]],194853:[[29333]],194854:[[149301]],194855:[[149524]],194856:[[29562]],194857:[[29579]],194858:[[16044]],194859:[[29605]],194860:[[16056]],194861:[[16056]],194862:[[29767]],194863:[[29788]],194864:[[29809]],194865:[[29829]],194866:[[29898]],194867:[[16155]],194868:[[29988]],194869:[[150582]],194870:[[30014]],194871:[[150674]],194872:[[30064]],194873:[[139679]],194874:[[30224]],194875:[[151457]],194876:[[151480]],194877:[[151620]],194878:[[16380]],194879:[[16392]],194880:[[30452]],194881:[[151795]],194882:[[151794]],194883:[[151833]],194884:[[151859]],194885:[[30494]],194886:[[30495]],194887:[[30495]],194888:[[30538]],194889:[[16441]],194890:[[30603]],194891:[[16454]],194892:[[16534]],194893:[[152605]],194894:[[30798]],194895:[[30860]],194896:[[30924]],194897:[[16611]],194898:[[153126]],194899:[[31062]],194900:[[153242]],194901:[[153285]],194902:[[31119]],194903:[[31211]],194904:[[16687]],194905:[[31296]],194906:[[31306]],194907:[[31311]],194908:[[153980]],194909:[[154279]],194910:[[154279]],194911:[[31470]],194912:[[16898]],194913:[[154539]],194914:[[31686]],194915:[[31689]],194916:[[16935]],194917:[[154752]],194918:[[31954]],194919:[[17056]],194920:[[31976]],194921:[[31971]],194922:[[32e3]],194923:[[155526]],194924:[[32099]],194925:[[17153]],194926:[[32199]],194927:[[32258]],194928:[[32325]],194929:[[17204]],194930:[[156200]],194931:[[156231]],194932:[[17241]],194933:[[156377]],194934:[[32634]],194935:[[156478]],194936:[[32661]],194937:[[32762]],194938:[[32773]],194939:[[156890]],194940:[[156963]],194941:[[32864]],194942:[[157096]],194943:[[32880]],194944:[[144223]],194945:[[17365]],194946:[[32946]],194947:[[33027]],194948:[[17419]],194949:[[33086]],194950:[[23221]],194951:[[157607]],194952:[[157621]],194953:[[144275]],194954:[[144284]],194955:[[33281]],194956:[[33284]],194957:[[36766]],194958:[[17515]],194959:[[33425]],194960:[[33419]],194961:[[33437]],194962:[[21171]],194963:[[33457]],194964:[[33459]],194965:[[33469]],194966:[[33510]],194967:[[158524]],194968:[[33509]],194969:[[33565]],194970:[[33635]],194971:[[33709]],194972:[[33571]],194973:[[33725]],194974:[[33767]],194975:[[33879]],194976:[[33619]],194977:[[33738]],194978:[[33740]],194979:[[33756]],194980:[[158774]],194981:[[159083]],194982:[[158933]],194983:[[17707]],194984:[[34033]],194985:[[34035]],194986:[[34070]],194987:[[160714]],194988:[[34148]],194989:[[159532]],194990:[[17757]],194991:[[17761]],194992:[[159665]],194993:[[159954]],194994:[[17771]],194995:[[34384]],194996:[[34396]],194997:[[34407]],194998:[[34409]],194999:[[34473]],195e3:[[34440]],195001:[[34574]],195002:[[34530]],195003:[[34681]],195004:[[34600]],195005:[[34667]],195006:[[34694]],195007:[[17879]],195008:[[34785]],195009:[[34817]],195010:[[17913]],195011:[[34912]],195012:[[34915]],195013:[[161383]],195014:[[35031]],195015:[[35038]],195016:[[17973]],195017:[[35066]],195018:[[13499]],195019:[[161966]],195020:[[162150]],195021:[[18110]],195022:[[18119]],195023:[[35488]],195024:[[35565]],195025:[[35722]],195026:[[35925]],195027:[[162984]],195028:[[36011]],195029:[[36033]],195030:[[36123]],195031:[[36215]],195032:[[163631]],195033:[[133124]],195034:[[36299]],195035:[[36284]],195036:[[36336]],195037:[[133342]],195038:[[36564]],195039:[[36664]],195040:[[165330]],195041:[[165357]],195042:[[37012]],195043:[[37105]],195044:[[37137]],195045:[[165678]],195046:[[37147]],195047:[[37432]],195048:[[37591]],195049:[[37592]],195050:[[37500]],195051:[[37881]],195052:[[37909]],195053:[[166906]],195054:[[38283]],195055:[[18837]],195056:[[38327]],195057:[[167287]],195058:[[18918]],195059:[[38595]],195060:[[23986]],195061:[[38691]],195062:[[168261]],195063:[[168474]],195064:[[19054]],195065:[[19062]],195066:[[38880]],195067:[[168970]],195068:[[19122]],195069:[[169110]],195070:[[38923]],195071:[[38923]]},64e3:{64e3:[[20999]],64001:[[24230]],64002:[[25299]],64003:[[31958]],64004:[[23429]],64005:[[27934]],64006:[[26292]],64007:[[36667]],64008:[[34892]],64009:[[38477]],64010:[[35211]],64011:[[24275]],64012:[[20800]],64013:[[21952]],64016:[[22618]],64018:[[26228]],64021:[[20958]],64022:[[29482]],64023:[[30410]],64024:[[31036]],64025:[[31070]],64026:[[31077]],64027:[[31119]],64028:[[38742]],64029:[[31934]],64030:[[32701]],64032:[[34322]],64034:[[35576]],64037:[[36920]],64038:[[37117]],64042:[[39151]],64043:[[39164]],64044:[[39208]],64045:[[40372]],64046:[[37086]],64047:[[38583]],64048:[[20398]],64049:[[20711]],64050:[[20813]],64051:[[21193]],64052:[[21220]],64053:[[21329]],64054:[[21917]],64055:[[22022]],64056:[[22120]],64057:[[22592]],64058:[[22696]],64059:[[23652]],64060:[[23662]],64061:[[24724]],64062:[[24936]],64063:[[24974]],64064:[[25074]],64065:[[25935]],64066:[[26082]],64067:[[26257]],64068:[[26757]],64069:[[28023]],64070:[[28186]],64071:[[28450]],64072:[[29038]],64073:[[29227]],64074:[[29730]],64075:[[30865]],64076:[[31038]],64077:[[31049]],64078:[[31048]],64079:[[31056]],64080:[[31062]],64081:[[31069]],64082:[[31117]],64083:[[31118]],64084:[[31296]],64085:[[31361]],64086:[[31680]],64087:[[32244]],64088:[[32265]],64089:[[32321]],64090:[[32626]],64091:[[32773]],64092:[[33261]],64093:[[33401]],64094:[[33401]],64095:[[33879]],64096:[[35088]],64097:[[35222]],64098:[[35585]],64099:[[35641]],64100:[[36051]],64101:[[36104]],64102:[[36790]],64103:[[36920]],64104:[[38627]],64105:[[38911]],64106:[[38971]],64107:[[24693]],64108:[[148206]],64109:[[33304]],64112:[[20006]],64113:[[20917]],64114:[[20840]],64115:[[20352]],64116:[[20805]],64117:[[20864]],64118:[[21191]],64119:[[21242]],64120:[[21917]],64121:[[21845]],64122:[[21913]],64123:[[21986]],64124:[[22618]],64125:[[22707]],64126:[[22852]],64127:[[22868]],64128:[[23138]],64129:[[23336]],64130:[[24274]],64131:[[24281]],64132:[[24425]],64133:[[24493]],64134:[[24792]],64135:[[24910]],64136:[[24840]],64137:[[24974]],64138:[[24928]],64139:[[25074]],64140:[[25140]],64141:[[25540]],64142:[[25628]],64143:[[25682]],64144:[[25942]],64145:[[26228]],64146:[[26391]],64147:[[26395]],64148:[[26454]],64149:[[27513]],64150:[[27578]],64151:[[27969]],64152:[[28379]],64153:[[28363]],64154:[[28450]],64155:[[28702]],64156:[[29038]],64157:[[30631]],64158:[[29237]],64159:[[29359]],64160:[[29482]],64161:[[29809]],64162:[[29958]],64163:[[30011]],64164:[[30237]],64165:[[30239]],64166:[[30410]],64167:[[30427]],64168:[[30452]],64169:[[30538]],64170:[[30528]],64171:[[30924]],64172:[[31409]],64173:[[31680]],64174:[[31867]],64175:[[32091]],64176:[[32244]],64177:[[32574]],64178:[[32773]],64179:[[33618]],64180:[[33775]],64181:[[34681]],64182:[[35137]],64183:[[35206]],64184:[[35222]],64185:[[35519]],64186:[[35576]],64187:[[35531]],64188:[[35585]],64189:[[35582]],64190:[[35565]],64191:[[35641]],64192:[[35722]],64193:[[36104]],64194:[[36664]],64195:[[36978]],64196:[[37273]],64197:[[37494]],64198:[[38524]],64199:[[38627]],64200:[[38742]],64201:[[38875]],64202:[[38911]],64203:[[38923]],64204:[[38971]],64205:[[39698]],64206:[[40860]],64207:[[141386]],64208:[[141380]],64209:[[144341]],64210:[[15261]],64211:[[16408]],64212:[[16441]],64213:[[152137]],64214:[[154832]],64215:[[163539]],64216:[[40771]],64217:[[40846]],195072:[[38953]],195073:[[169398]],195074:[[39138]],195075:[[19251]],195076:[[39209]],195077:[[39335]],195078:[[39362]],195079:[[39422]],195080:[[19406]],195081:[[170800]],195082:[[39698]],195083:[[4e4]],195084:[[40189]],195085:[[19662]],195086:[[19693]],195087:[[40295]],195088:[[172238]],195089:[[19704]],195090:[[172293]],195091:[[172558]],195092:[[172689]],195093:[[40635]],195094:[[19798]],195095:[[40697]],195096:[[40702]],195097:[[40709]],195098:[[40719]],195099:[[40726]],195100:[[40763]],195101:[[173568]]},64256:{64256:[[102,102],256],64257:[[102,105],256],64258:[[102,108],256],64259:[[102,102,105],256],64260:[[102,102,108],256],64261:[[383,116],256],64262:[[115,116],256],64275:[[1396,1398],256],64276:[[1396,1381],256],64277:[[1396,1387],256],64278:[[1406,1398],256],64279:[[1396,1389],256],64285:[[1497,1460],512],64286:[,26],64287:[[1522,1463],512],64288:[[1506],256],64289:[[1488],256],64290:[[1491],256],64291:[[1492],256],64292:[[1499],256],64293:[[1500],256],64294:[[1501],256],64295:[[1512],256],64296:[[1514],256],64297:[[43],256],64298:[[1513,1473],512],64299:[[1513,1474],512],64300:[[64329,1473],512],64301:[[64329,1474],512],64302:[[1488,1463],512],64303:[[1488,1464],512],64304:[[1488,1468],512],64305:[[1489,1468],512],64306:[[1490,1468],512],64307:[[1491,1468],512],64308:[[1492,1468],512],64309:[[1493,1468],512],64310:[[1494,1468],512],64312:[[1496,1468],512],64313:[[1497,1468],512],64314:[[1498,1468],512],64315:[[1499,1468],512],64316:[[1500,1468],512],64318:[[1502,1468],512],64320:[[1504,1468],512],64321:[[1505,1468],512],64323:[[1507,1468],512],64324:[[1508,1468],512],64326:[[1510,1468],512],64327:[[1511,1468],512],64328:[[1512,1468],512],64329:[[1513,1468],512],64330:[[1514,1468],512],64331:[[1493,1465],512],64332:[[1489,1471],512],64333:[[1499,1471],512],64334:[[1508,1471],512],64335:[[1488,1500],256],64336:[[1649],256],64337:[[1649],256],64338:[[1659],256],64339:[[1659],256],64340:[[1659],256],64341:[[1659],256],64342:[[1662],256],64343:[[1662],256],64344:[[1662],256],64345:[[1662],256],64346:[[1664],256],64347:[[1664],256],64348:[[1664],256],64349:[[1664],256],64350:[[1658],256],64351:[[1658],256],64352:[[1658],256],64353:[[1658],256],64354:[[1663],256],64355:[[1663],256],64356:[[1663],256],64357:[[1663],256],64358:[[1657],256],64359:[[1657],256],64360:[[1657],256],64361:[[1657],256],64362:[[1700],256],64363:[[1700],256],64364:[[1700],256],64365:[[1700],256],64366:[[1702],256],64367:[[1702],256],64368:[[1702],256],64369:[[1702],256],64370:[[1668],256],64371:[[1668],256],64372:[[1668],256],64373:[[1668],256],64374:[[1667],256],64375:[[1667],256],64376:[[1667],256],64377:[[1667],256],64378:[[1670],256],64379:[[1670],256],64380:[[1670],256],64381:[[1670],256],64382:[[1671],256],64383:[[1671],256],64384:[[1671],256],64385:[[1671],256],64386:[[1677],256],64387:[[1677],256],64388:[[1676],256],64389:[[1676],256],64390:[[1678],256],64391:[[1678],256],64392:[[1672],256],64393:[[1672],256],64394:[[1688],256],64395:[[1688],256],64396:[[1681],256],64397:[[1681],256],64398:[[1705],256],64399:[[1705],256],64400:[[1705],256],64401:[[1705],256],64402:[[1711],256],64403:[[1711],256],64404:[[1711],256],64405:[[1711],256],64406:[[1715],256],64407:[[1715],256],64408:[[1715],256],64409:[[1715],256],64410:[[1713],256],64411:[[1713],256],64412:[[1713],256],64413:[[1713],256],64414:[[1722],256],64415:[[1722],256],64416:[[1723],256],64417:[[1723],256],64418:[[1723],256],64419:[[1723],256],64420:[[1728],256],64421:[[1728],256],64422:[[1729],256],64423:[[1729],256],64424:[[1729],256],64425:[[1729],256],64426:[[1726],256],64427:[[1726],256],64428:[[1726],256],64429:[[1726],256],64430:[[1746],256],64431:[[1746],256],64432:[[1747],256],64433:[[1747],256],64467:[[1709],256],64468:[[1709],256],64469:[[1709],256],64470:[[1709],256],64471:[[1735],256],64472:[[1735],256],64473:[[1734],256],64474:[[1734],256],64475:[[1736],256],64476:[[1736],256],64477:[[1655],256],64478:[[1739],256],64479:[[1739],256],64480:[[1733],256],64481:[[1733],256],64482:[[1737],256],64483:[[1737],256],64484:[[1744],256],64485:[[1744],256],64486:[[1744],256],64487:[[1744],256],64488:[[1609],256],64489:[[1609],256],64490:[[1574,1575],256],64491:[[1574,1575],256],64492:[[1574,1749],256],64493:[[1574,1749],256],64494:[[1574,1608],256],64495:[[1574,1608],256],64496:[[1574,1735],256],64497:[[1574,1735],256],64498:[[1574,1734],256],64499:[[1574,1734],256],64500:[[1574,1736],256],64501:[[1574,1736],256],64502:[[1574,1744],256],64503:[[1574,1744],256],64504:[[1574,1744],256],64505:[[1574,1609],256],64506:[[1574,1609],256],64507:[[1574,1609],256],64508:[[1740],256],64509:[[1740],256],64510:[[1740],256],64511:[[1740],256]},64512:{64512:[[1574,1580],256],64513:[[1574,1581],256],64514:[[1574,1605],256],64515:[[1574,1609],256],64516:[[1574,1610],256],64517:[[1576,1580],256],64518:[[1576,1581],256],64519:[[1576,1582],256],64520:[[1576,1605],256],64521:[[1576,1609],256],64522:[[1576,1610],256],64523:[[1578,1580],256],64524:[[1578,1581],256],64525:[[1578,1582],256],64526:[[1578,1605],256],64527:[[1578,1609],256],64528:[[1578,1610],256],64529:[[1579,1580],256],64530:[[1579,1605],256],64531:[[1579,1609],256],64532:[[1579,1610],256],64533:[[1580,1581],256],64534:[[1580,1605],256],64535:[[1581,1580],256],64536:[[1581,1605],256],64537:[[1582,1580],256],64538:[[1582,1581],256],64539:[[1582,1605],256],64540:[[1587,1580],256],64541:[[1587,1581],256],64542:[[1587,1582],256],64543:[[1587,1605],256],64544:[[1589,1581],256],64545:[[1589,1605],256],64546:[[1590,1580],256],64547:[[1590,1581],256],64548:[[1590,1582],256],64549:[[1590,1605],256],64550:[[1591,1581],256],64551:[[1591,1605],256],64552:[[1592,1605],256],64553:[[1593,1580],256],64554:[[1593,1605],256],64555:[[1594,1580],256],64556:[[1594,1605],256],64557:[[1601,1580],256],64558:[[1601,1581],256],64559:[[1601,1582],256],64560:[[1601,1605],256],64561:[[1601,1609],256],64562:[[1601,1610],256],64563:[[1602,1581],256],64564:[[1602,1605],256],64565:[[1602,1609],256],64566:[[1602,1610],256],64567:[[1603,1575],256],64568:[[1603,1580],256],64569:[[1603,1581],256],64570:[[1603,1582],256],64571:[[1603,1604],256],64572:[[1603,1605],256],64573:[[1603,1609],256],64574:[[1603,1610],256],64575:[[1604,1580],256],64576:[[1604,1581],256],64577:[[1604,1582],256],64578:[[1604,1605],256],64579:[[1604,1609],256],64580:[[1604,1610],256],64581:[[1605,1580],256],64582:[[1605,1581],256],64583:[[1605,1582],256],64584:[[1605,1605],256],64585:[[1605,1609],256],64586:[[1605,1610],256],64587:[[1606,1580],256],64588:[[1606,1581],256],64589:[[1606,1582],256],64590:[[1606,1605],256],64591:[[1606,1609],256],64592:[[1606,1610],256],64593:[[1607,1580],256],64594:[[1607,1605],256],64595:[[1607,1609],256],64596:[[1607,1610],256],64597:[[1610,1580],256],64598:[[1610,1581],256],64599:[[1610,1582],256],64600:[[1610,1605],256],64601:[[1610,1609],256],64602:[[1610,1610],256],64603:[[1584,1648],256],64604:[[1585,1648],256],64605:[[1609,1648],256],64606:[[32,1612,1617],256],64607:[[32,1613,1617],256],64608:[[32,1614,1617],256],64609:[[32,1615,1617],256],64610:[[32,1616,1617],256],64611:[[32,1617,1648],256],64612:[[1574,1585],256],64613:[[1574,1586],256],64614:[[1574,1605],256],64615:[[1574,1606],256],64616:[[1574,1609],256],64617:[[1574,1610],256],64618:[[1576,1585],256],64619:[[1576,1586],256],64620:[[1576,1605],256],64621:[[1576,1606],256],64622:[[1576,1609],256],64623:[[1576,1610],256],64624:[[1578,1585],256],64625:[[1578,1586],256],64626:[[1578,1605],256],64627:[[1578,1606],256],64628:[[1578,1609],256],64629:[[1578,1610],256],64630:[[1579,1585],256],64631:[[1579,1586],256],64632:[[1579,1605],256],64633:[[1579,1606],256],64634:[[1579,1609],256],64635:[[1579,1610],256],64636:[[1601,1609],256],64637:[[1601,1610],256],64638:[[1602,1609],256],64639:[[1602,1610],256],64640:[[1603,1575],256],64641:[[1603,1604],256],64642:[[1603,1605],256],64643:[[1603,1609],256],64644:[[1603,1610],256],64645:[[1604,1605],256],64646:[[1604,1609],256],64647:[[1604,1610],256],64648:[[1605,1575],256],64649:[[1605,1605],256],64650:[[1606,1585],256],64651:[[1606,1586],256],64652:[[1606,1605],256],64653:[[1606,1606],256],64654:[[1606,1609],256],64655:[[1606,1610],256],64656:[[1609,1648],256],64657:[[1610,1585],256],64658:[[1610,1586],256],64659:[[1610,1605],256],64660:[[1610,1606],256],64661:[[1610,1609],256],64662:[[1610,1610],256],64663:[[1574,1580],256],64664:[[1574,1581],256],64665:[[1574,1582],256],64666:[[1574,1605],256],64667:[[1574,1607],256],64668:[[1576,1580],256],64669:[[1576,1581],256],64670:[[1576,1582],256],64671:[[1576,1605],256],64672:[[1576,1607],256],64673:[[1578,1580],256],64674:[[1578,1581],256],64675:[[1578,1582],256],64676:[[1578,1605],256],64677:[[1578,1607],256],64678:[[1579,1605],256],64679:[[1580,1581],256],64680:[[1580,1605],256],64681:[[1581,1580],256],64682:[[1581,1605],256],64683:[[1582,1580],256],64684:[[1582,1605],256],64685:[[1587,1580],256],64686:[[1587,1581],256],64687:[[1587,1582],256],64688:[[1587,1605],256],64689:[[1589,1581],256],64690:[[1589,1582],256],64691:[[1589,1605],256],64692:[[1590,1580],256],64693:[[1590,1581],256],64694:[[1590,1582],256],64695:[[1590,1605],256],64696:[[1591,1581],256],64697:[[1592,1605],256],64698:[[1593,1580],256],64699:[[1593,1605],256],64700:[[1594,1580],256],64701:[[1594,1605],256],64702:[[1601,1580],256],64703:[[1601,1581],256],64704:[[1601,1582],256],64705:[[1601,1605],256],64706:[[1602,1581],256],64707:[[1602,1605],256],64708:[[1603,1580],256],64709:[[1603,1581],256],64710:[[1603,1582],256],64711:[[1603,1604],256],64712:[[1603,1605],256],64713:[[1604,1580],256],64714:[[1604,1581],256],64715:[[1604,1582],256],64716:[[1604,1605],256],64717:[[1604,1607],256],64718:[[1605,1580],256],64719:[[1605,1581],256],64720:[[1605,1582],256],64721:[[1605,1605],256],64722:[[1606,1580],256],64723:[[1606,1581],256],64724:[[1606,1582],256],64725:[[1606,1605],256],64726:[[1606,1607],256],64727:[[1607,1580],256],64728:[[1607,1605],256],64729:[[1607,1648],256],64730:[[1610,1580],256],64731:[[1610,1581],256],64732:[[1610,1582],256],64733:[[1610,1605],256],64734:[[1610,1607],256],64735:[[1574,1605],256],64736:[[1574,1607],256],64737:[[1576,1605],256],64738:[[1576,1607],256],64739:[[1578,1605],256],64740:[[1578,1607],256],64741:[[1579,1605],256],64742:[[1579,1607],256],64743:[[1587,1605],256],64744:[[1587,1607],256],64745:[[1588,1605],256],64746:[[1588,1607],256],64747:[[1603,1604],256],64748:[[1603,1605],256],64749:[[1604,1605],256],64750:[[1606,1605],256],64751:[[1606,1607],256],64752:[[1610,1605],256],64753:[[1610,1607],256],64754:[[1600,1614,1617],256],64755:[[1600,1615,1617],256],64756:[[1600,1616,1617],256],64757:[[1591,1609],256],64758:[[1591,1610],256],64759:[[1593,1609],256],64760:[[1593,1610],256],64761:[[1594,1609],256],64762:[[1594,1610],256],64763:[[1587,1609],256],64764:[[1587,1610],256],64765:[[1588,1609],256],64766:[[1588,1610],256],64767:[[1581,1609],256]},64768:{64768:[[1581,1610],256],64769:[[1580,1609],256],64770:[[1580,1610],256],64771:[[1582,1609],256],64772:[[1582,1610],256],64773:[[1589,1609],256],64774:[[1589,1610],256],64775:[[1590,1609],256],64776:[[1590,1610],256],64777:[[1588,1580],256],64778:[[1588,1581],256],64779:[[1588,1582],256],64780:[[1588,1605],256],64781:[[1588,1585],256],64782:[[1587,1585],256],64783:[[1589,1585],256],64784:[[1590,1585],256],64785:[[1591,1609],256],64786:[[1591,1610],256],64787:[[1593,1609],256],64788:[[1593,1610],256],64789:[[1594,1609],256],64790:[[1594,1610],256],64791:[[1587,1609],256],64792:[[1587,1610],256],64793:[[1588,1609],256],64794:[[1588,1610],256],64795:[[1581,1609],256],64796:[[1581,1610],256],64797:[[1580,1609],256],64798:[[1580,1610],256],64799:[[1582,1609],256],64800:[[1582,1610],256],64801:[[1589,1609],256],64802:[[1589,1610],256],64803:[[1590,1609],256],64804:[[1590,1610],256],64805:[[1588,1580],256],64806:[[1588,1581],256],64807:[[1588,1582],256],64808:[[1588,1605],256],64809:[[1588,1585],256],64810:[[1587,1585],256],64811:[[1589,1585],256],64812:[[1590,1585],256],64813:[[1588,1580],256],64814:[[1588,1581],256],64815:[[1588,1582],256],64816:[[1588,1605],256],64817:[[1587,1607],256],64818:[[1588,1607],256],64819:[[1591,1605],256],64820:[[1587,1580],256],64821:[[1587,1581],256],64822:[[1587,1582],256],64823:[[1588,1580],256],64824:[[1588,1581],256],64825:[[1588,1582],256],64826:[[1591,1605],256],64827:[[1592,1605],256],64828:[[1575,1611],256],64829:[[1575,1611],256],64848:[[1578,1580,1605],256],64849:[[1578,1581,1580],256],64850:[[1578,1581,1580],256],64851:[[1578,1581,1605],256],64852:[[1578,1582,1605],256],64853:[[1578,1605,1580],256],64854:[[1578,1605,1581],256],64855:[[1578,1605,1582],256],64856:[[1580,1605,1581],256],64857:[[1580,1605,1581],256],64858:[[1581,1605,1610],256],64859:[[1581,1605,1609],256],64860:[[1587,1581,1580],256],64861:[[1587,1580,1581],256],64862:[[1587,1580,1609],256],64863:[[1587,1605,1581],256],64864:[[1587,1605,1581],256],64865:[[1587,1605,1580],256],64866:[[1587,1605,1605],256],64867:[[1587,1605,1605],256],64868:[[1589,1581,1581],256],64869:[[1589,1581,1581],256],64870:[[1589,1605,1605],256],64871:[[1588,1581,1605],256],64872:[[1588,1581,1605],256],64873:[[1588,1580,1610],256],64874:[[1588,1605,1582],256],64875:[[1588,1605,1582],256],64876:[[1588,1605,1605],256],64877:[[1588,1605,1605],256],64878:[[1590,1581,1609],256],64879:[[1590,1582,1605],256],64880:[[1590,1582,1605],256],64881:[[1591,1605,1581],256],64882:[[1591,1605,1581],256],64883:[[1591,1605,1605],256],64884:[[1591,1605,1610],256],64885:[[1593,1580,1605],256],64886:[[1593,1605,1605],256],64887:[[1593,1605,1605],256],64888:[[1593,1605,1609],256],64889:[[1594,1605,1605],256],64890:[[1594,1605,1610],256],64891:[[1594,1605,1609],256],64892:[[1601,1582,1605],256],64893:[[1601,1582,1605],256],64894:[[1602,1605,1581],256],64895:[[1602,1605,1605],256],64896:[[1604,1581,1605],256],64897:[[1604,1581,1610],256],64898:[[1604,1581,1609],256],64899:[[1604,1580,1580],256],64900:[[1604,1580,1580],256],64901:[[1604,1582,1605],256],64902:[[1604,1582,1605],256],64903:[[1604,1605,1581],256],64904:[[1604,1605,1581],256],64905:[[1605,1581,1580],256],64906:[[1605,1581,1605],256],64907:[[1605,1581,1610],256],64908:[[1605,1580,1581],256],64909:[[1605,1580,1605],256],64910:[[1605,1582,1580],256],64911:[[1605,1582,1605],256],64914:[[1605,1580,1582],256],64915:[[1607,1605,1580],256],64916:[[1607,1605,1605],256],64917:[[1606,1581,1605],256],64918:[[1606,1581,1609],256],64919:[[1606,1580,1605],256],64920:[[1606,1580,1605],256],64921:[[1606,1580,1609],256],64922:[[1606,1605,1610],256],64923:[[1606,1605,1609],256],64924:[[1610,1605,1605],256],64925:[[1610,1605,1605],256],64926:[[1576,1582,1610],256],64927:[[1578,1580,1610],256],64928:[[1578,1580,1609],256],64929:[[1578,1582,1610],256],64930:[[1578,1582,1609],256],64931:[[1578,1605,1610],256],64932:[[1578,1605,1609],256],64933:[[1580,1605,1610],256],64934:[[1580,1581,1609],256],64935:[[1580,1605,1609],256],64936:[[1587,1582,1609],256],64937:[[1589,1581,1610],256],64938:[[1588,1581,1610],256],64939:[[1590,1581,1610],256],64940:[[1604,1580,1610],256],64941:[[1604,1605,1610],256],64942:[[1610,1581,1610],256],64943:[[1610,1580,1610],256],64944:[[1610,1605,1610],256],64945:[[1605,1605,1610],256],64946:[[1602,1605,1610],256],64947:[[1606,1581,1610],256],64948:[[1602,1605,1581],256],64949:[[1604,1581,1605],256],64950:[[1593,1605,1610],256],64951:[[1603,1605,1610],256],64952:[[1606,1580,1581],256],64953:[[1605,1582,1610],256],64954:[[1604,1580,1605],256],64955:[[1603,1605,1605],256],64956:[[1604,1580,1605],256],64957:[[1606,1580,1581],256],64958:[[1580,1581,1610],256],64959:[[1581,1580,1610],256],64960:[[1605,1580,1610],256],64961:[[1601,1605,1610],256],64962:[[1576,1581,1610],256],64963:[[1603,1605,1605],256],64964:[[1593,1580,1605],256],64965:[[1589,1605,1605],256],64966:[[1587,1582,1610],256],64967:[[1606,1580,1610],256],65008:[[1589,1604,1746],256],65009:[[1602,1604,1746],256],65010:[[1575,1604,1604,1607],256],65011:[[1575,1603,1576,1585],256],65012:[[1605,1581,1605,1583],256],65013:[[1589,1604,1593,1605],256],65014:[[1585,1587,1608,1604],256],65015:[[1593,1604,1610,1607],256],65016:[[1608,1587,1604,1605],256],65017:[[1589,1604,1609],256],65018:[[1589,1604,1609,32,1575,1604,1604,1607,32,1593,1604,1610,1607,32,1608,1587,1604,1605],256],65019:[[1580,1604,32,1580,1604,1575,1604,1607],256],65020:[[1585,1740,1575,1604],256]},65024:{65040:[[44],256],65041:[[12289],256],65042:[[12290],256],65043:[[58],256],65044:[[59],256],65045:[[33],256],65046:[[63],256],65047:[[12310],256],65048:[[12311],256],65049:[[8230],256],65056:[,230],65057:[,230],65058:[,230],65059:[,230],65060:[,230],65061:[,230],65062:[,230],65063:[,220],65064:[,220],65065:[,220],65066:[,220],65067:[,220],65068:[,220],65069:[,220],65072:[[8229],256],65073:[[8212],256],65074:[[8211],256],65075:[[95],256],65076:[[95],256],65077:[[40],256],65078:[[41],256],65079:[[123],256],65080:[[125],256],65081:[[12308],256],65082:[[12309],256],65083:[[12304],256],65084:[[12305],256],65085:[[12298],256],65086:[[12299],256],65087:[[12296],256],65088:[[12297],256],65089:[[12300],256],65090:[[12301],256],65091:[[12302],256],65092:[[12303],256],65095:[[91],256],65096:[[93],256],65097:[[8254],256],65098:[[8254],256],65099:[[8254],256],65100:[[8254],256],65101:[[95],256],65102:[[95],256],65103:[[95],256],65104:[[44],256],65105:[[12289],256],65106:[[46],256],65108:[[59],256],65109:[[58],256],65110:[[63],256],65111:[[33],256],65112:[[8212],256],65113:[[40],256],65114:[[41],256],65115:[[123],256],65116:[[125],256],65117:[[12308],256],65118:[[12309],256],65119:[[35],256],65120:[[38],256],65121:[[42],256],65122:[[43],256],65123:[[45],256],65124:[[60],256],65125:[[62],256],65126:[[61],256],65128:[[92],256],65129:[[36],256],65130:[[37],256],65131:[[64],256],65136:[[32,1611],256],65137:[[1600,1611],256],65138:[[32,1612],256],65140:[[32,1613],256],65142:[[32,1614],256],65143:[[1600,1614],256],65144:[[32,1615],256],65145:[[1600,1615],256],65146:[[32,1616],256],65147:[[1600,1616],256],65148:[[32,1617],256],65149:[[1600,1617],256],65150:[[32,1618],256],65151:[[1600,1618],256],65152:[[1569],256],65153:[[1570],256],65154:[[1570],256],65155:[[1571],256],65156:[[1571],256],65157:[[1572],256],65158:[[1572],256],65159:[[1573],256],65160:[[1573],256],65161:[[1574],256],65162:[[1574],256],65163:[[1574],256],65164:[[1574],256],65165:[[1575],256],65166:[[1575],256],65167:[[1576],256],65168:[[1576],256],65169:[[1576],256],65170:[[1576],256],65171:[[1577],256],65172:[[1577],256],65173:[[1578],256],65174:[[1578],256],65175:[[1578],256],65176:[[1578],256],65177:[[1579],256],65178:[[1579],256],65179:[[1579],256],65180:[[1579],256],65181:[[1580],256],65182:[[1580],256],65183:[[1580],256],65184:[[1580],256],65185:[[1581],256],65186:[[1581],256],65187:[[1581],256],65188:[[1581],256],65189:[[1582],256],65190:[[1582],256],65191:[[1582],256],65192:[[1582],256],65193:[[1583],256],65194:[[1583],256],65195:[[1584],256],65196:[[1584],256],65197:[[1585],256],65198:[[1585],256],65199:[[1586],256],65200:[[1586],256],65201:[[1587],256],65202:[[1587],256],65203:[[1587],256],65204:[[1587],256],65205:[[1588],256],65206:[[1588],256],65207:[[1588],256],65208:[[1588],256],65209:[[1589],256],65210:[[1589],256],65211:[[1589],256],65212:[[1589],256],65213:[[1590],256],65214:[[1590],256],65215:[[1590],256],65216:[[1590],256],65217:[[1591],256],65218:[[1591],256],65219:[[1591],256],65220:[[1591],256],65221:[[1592],256],65222:[[1592],256],65223:[[1592],256],65224:[[1592],256],65225:[[1593],256],65226:[[1593],256],65227:[[1593],256],65228:[[1593],256],65229:[[1594],256],65230:[[1594],256],65231:[[1594],256],65232:[[1594],256],65233:[[1601],256],65234:[[1601],256],65235:[[1601],256],65236:[[1601],256],65237:[[1602],256],65238:[[1602],256],65239:[[1602],256],65240:[[1602],256],65241:[[1603],256],65242:[[1603],256],65243:[[1603],256],65244:[[1603],256],65245:[[1604],256],65246:[[1604],256],65247:[[1604],256],65248:[[1604],256],65249:[[1605],256],65250:[[1605],256],65251:[[1605],256],65252:[[1605],256],65253:[[1606],256],65254:[[1606],256],65255:[[1606],256],65256:[[1606],256],65257:[[1607],256],65258:[[1607],256],65259:[[1607],256],65260:[[1607],256],65261:[[1608],256],65262:[[1608],256],65263:[[1609],256],65264:[[1609],256],65265:[[1610],256],65266:[[1610],256],65267:[[1610],256],65268:[[1610],256],65269:[[1604,1570],256],65270:[[1604,1570],256],65271:[[1604,1571],256],65272:[[1604,1571],256],65273:[[1604,1573],256],65274:[[1604,1573],256],65275:[[1604,1575],256],65276:[[1604,1575],256]},65280:{65281:[[33],256],65282:[[34],256],65283:[[35],256],65284:[[36],256],65285:[[37],256],65286:[[38],256],65287:[[39],256],65288:[[40],256],65289:[[41],256],65290:[[42],256],65291:[[43],256],65292:[[44],256],65293:[[45],256],65294:[[46],256],65295:[[47],256],65296:[[48],256],65297:[[49],256],65298:[[50],256],65299:[[51],256],65300:[[52],256],65301:[[53],256],65302:[[54],256],65303:[[55],256],65304:[[56],256],65305:[[57],256],65306:[[58],256],65307:[[59],256],65308:[[60],256],65309:[[61],256],65310:[[62],256],65311:[[63],256],65312:[[64],256],65313:[[65],256],65314:[[66],256],65315:[[67],256],65316:[[68],256],65317:[[69],256],65318:[[70],256],65319:[[71],256],65320:[[72],256],65321:[[73],256],65322:[[74],256],65323:[[75],256],65324:[[76],256],65325:[[77],256],65326:[[78],256],65327:[[79],256],65328:[[80],256],65329:[[81],256],65330:[[82],256],65331:[[83],256],65332:[[84],256],65333:[[85],256],65334:[[86],256],65335:[[87],256],65336:[[88],256],65337:[[89],256],65338:[[90],256],65339:[[91],256],65340:[[92],256],65341:[[93],256],65342:[[94],256],65343:[[95],256],65344:[[96],256],65345:[[97],256],65346:[[98],256],65347:[[99],256],65348:[[100],256],65349:[[101],256],65350:[[102],256],65351:[[103],256],65352:[[104],256],65353:[[105],256],65354:[[106],256],65355:[[107],256],65356:[[108],256],65357:[[109],256],65358:[[110],256],65359:[[111],256],65360:[[112],256],65361:[[113],256],65362:[[114],256],65363:[[115],256],65364:[[116],256],65365:[[117],256],65366:[[118],256],65367:[[119],256],65368:[[120],256],65369:[[121],256],65370:[[122],256],65371:[[123],256],65372:[[124],256],65373:[[125],256],65374:[[126],256],65375:[[10629],256],65376:[[10630],256],65377:[[12290],256],65378:[[12300],256],65379:[[12301],256],65380:[[12289],256],65381:[[12539],256],65382:[[12530],256],65383:[[12449],256],65384:[[12451],256],65385:[[12453],256],65386:[[12455],256],65387:[[12457],256],65388:[[12515],256],65389:[[12517],256],65390:[[12519],256],65391:[[12483],256],65392:[[12540],256],65393:[[12450],256],65394:[[12452],256],65395:[[12454],256],65396:[[12456],256],65397:[[12458],256],65398:[[12459],256],65399:[[12461],256],65400:[[12463],256],65401:[[12465],256],65402:[[12467],256],65403:[[12469],256],65404:[[12471],256],65405:[[12473],256],65406:[[12475],256],65407:[[12477],256],65408:[[12479],256],65409:[[12481],256],65410:[[12484],256],65411:[[12486],256],65412:[[12488],256],65413:[[12490],256],65414:[[12491],256],65415:[[12492],256],65416:[[12493],256],65417:[[12494],256],65418:[[12495],256],65419:[[12498],256],65420:[[12501],256],65421:[[12504],256],65422:[[12507],256],65423:[[12510],256],65424:[[12511],256],65425:[[12512],256],65426:[[12513],256],65427:[[12514],256],65428:[[12516],256],65429:[[12518],256],65430:[[12520],256],65431:[[12521],256],65432:[[12522],256],65433:[[12523],256],65434:[[12524],256],65435:[[12525],256],65436:[[12527],256],65437:[[12531],256],65438:[[12441],256],65439:[[12442],256],65440:[[12644],256],65441:[[12593],256],65442:[[12594],256],65443:[[12595],256],65444:[[12596],256],65445:[[12597],256],65446:[[12598],256],65447:[[12599],256],65448:[[12600],256],65449:[[12601],256],65450:[[12602],256],65451:[[12603],256],65452:[[12604],256],65453:[[12605],256],65454:[[12606],256],65455:[[12607],256],65456:[[12608],256],65457:[[12609],256],65458:[[12610],256],65459:[[12611],256],65460:[[12612],256],65461:[[12613],256],65462:[[12614],256],65463:[[12615],256],65464:[[12616],256],65465:[[12617],256],65466:[[12618],256],65467:[[12619],256],65468:[[12620],256],65469:[[12621],256],65470:[[12622],256],65474:[[12623],256],65475:[[12624],256],65476:[[12625],256],65477:[[12626],256],65478:[[12627],256],65479:[[12628],256],65482:[[12629],256],65483:[[12630],256],65484:[[12631],256],65485:[[12632],256],65486:[[12633],256],65487:[[12634],256],65490:[[12635],256],65491:[[12636],256],65492:[[12637],256],65493:[[12638],256],65494:[[12639],256],65495:[[12640],256],65498:[[12641],256],65499:[[12642],256],65500:[[12643],256],65504:[[162],256],65505:[[163],256],65506:[[172],256],65507:[[175],256],65508:[[166],256],65509:[[165],256],65510:[[8361],256],65512:[[9474],256],65513:[[8592],256],65514:[[8593],256],65515:[[8594],256],65516:[[8595],256],65517:[[9632],256],65518:[[9675],256]}};var se={nfc:J,nfd:K,nfkc:ue,nfkd:X};n.exports=se,se.shimApplied=!1,String.prototype.normalize||(Object.defineProperty(String.prototype,"normalize",{enumerable:!1,configurable:!0,writable:!0,value:function(){var g=""+this,E=arguments[0]===void 0?"NFC":arguments[0];if(this===null||this===void 0)throw new TypeError("Cannot call method on "+Object.prototype.toString.call(this));if(E==="NFC")return se.nfc(g);if(E==="NFD")return se.nfd(g);if(E==="NFKC")return se.nfkc(g);if(E==="NFKD")return se.nfkd(g);throw new RangeError("Invalid normalization form: "+E)}}),se.shimApplied=!0)})()})(YI);const Yae=YI.exports;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function jae(n){const e=n.caseSensitive?n.accentSensitive?"variant":"case":n.accentSensitive?"accent":"base",t=n.caseFirst,r=n.ignorePunctuation;return new Intl.Collator(n.localeLang,{sensitivity:e,caseFirst:t,ignorePunctuation:r})}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Kae="i",qae=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class Xae{constructor(e,t,r){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=r,this.lt=(i,s)=>this.compare(i,s)<0,this.leq=(i,s)=>this.compare(i,s)<=0,this.gt=(i,s)=>this.compare(i,s)>0,this.geq=(i,s)=>this.compare(i,s)>=0,this.eq=(i,s)=>this.compare(i,s)===0,this.neq=(i,s)=>this.compare(i,s)!==0,this.pow=(i,s)=>Math.pow(Le(i),Le(s)),this.addWithEpsilonRaw=(i,s)=>{const o=i+s;return Math.abs(o)<this.actualEps*Math.abs(i)?0:o},this.addWithEpsilon=(i,s)=>{const o=E4(i,s);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(Le(i),Le(s)),o)},this.unaryMinus=i=>ib(i,-Le(i)),this.unaryPlus=i=>i,this.unaryPercent=i=>new $m(Le(i)/100),this.concat=(i,s)=>i.concat(s),this.nonstrictadd=(i,s)=>i instanceof D?i:s instanceof D?s:typeof i=="number"?typeof s=="number"?this.addWithEpsilonRaw(i,s):i:typeof s=="number"?s:0,this.subtract=(i,s)=>{const o=E4(i,s),a=Le(i),l=Le(s);let u=a-l;return Math.abs(u)<this.actualEps*Math.abs(a)&&(u=0),this.ExtendedNumberFactory(u,o)},this.divide=(i,s)=>{const o=Le(i),a=Le(s);if(a===0)return new D($.DIV_BY_ZERO);{const l=b4(i,s);return this.ExtendedNumberFactory(o/a,l)}},this.multiply=(i,s)=>{const o=b4(i,s);return this.ExtendedNumberFactory(Le(i)*Le(s),o)},this.manyToExactComplex=i=>{const s=[];for(const o of i){if(o instanceof D)return o;if(At(o)||typeof o=="string"){const a=this.coerceScalarToComplex(o);a instanceof D||s.push(a)}}return s},this.coerceNumbersExactRanges=i=>this.manyToNumbers(i,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=i=>this.manyToNumbers(i,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=i=>{const s=[];for(const o of i){if(o instanceof D)return o;At(o)&&s.push(Le(o))}return s},this.manyToOnlyNumbersDropNulls=i=>{const s=[];for(const o of i){if(o instanceof D)return o;if(At(o))s.push(Le(o));else if(o!==ht)return new D($.VALUE,Q.NumberExpected)}return s},this.manyToCoercedNumbersDropNulls=i=>{const s=[];for(const o of i){if(o instanceof D)return o;if(o===ht)continue;const a=this.coerceScalarToNumberOrError(o);At(a)&&s.push(Le(a))}return s},this.collator=jae(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return r=>typeof r=="string"&&t.test(this.normalizeString(r))}neqMatcherFunction(e){const t=this.buildRegex(e);return r=>typeof r!="string"||!t.test(this.normalizeString(r))}searchString(e,t){var r;const s=this.buildRegex(e,!1).exec(t);return(r=s==null?void 0:s.index)!==null&&r!==void 0?r:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let t=0;t<e.length;t++){const r=e.charAt(t);if(hd(r)||this.config.useRegularExpressions&&dd(r))return!0}return!1}floatCmp(e,t){const r=Le(e),i=Le(t),s=1+this.actualEps;return i>=0&&r*s>=i&&r<=i*s||i<=0&&r*s<=i&&r>=i*s?0:r>i?1:-1}coerceScalarToNumberOrError(e){var t;return e instanceof D?e:(t=this.coerceToMaybeNumber(e))!==null&&t!==void 0?t:new D($.VALUE,Q.NumberCoercion)}coerceToMaybeNumber(e){var t;return(t=this.coerceNonDateScalarToMaybeNumber(e))!==null&&t!==void 0?t:typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===ht)return 0;if(typeof e=="string"){if(e==="")return 0;const t=this.coerceStringToMaybePercentNumber(e);if(t!==void 0)return t;const r=this.coerceStringToMaybeCurrencyNumber(e);return r!==void 0?r:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}else return At(e)?e:typeof e=="boolean"?Number(e):void 0}coerceStringToMaybePercentNumber(e){const t=e.trim();if(t.endsWith("%")){const r=t.slice(0,t.length-1).trim(),i=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(i!==void 0)return new $m(i/100)}}coerceStringToMaybeCurrencyNumber(e){const t=this.currencyMatcher(e.trim());if(t!==void 0){const[r,i]=t,s=this.numberLiteralsHelper.numericStringToMaybeNumber(i);if(s!==void 0)return new vw(s,r)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){const t=[];for(const i of e)if(i instanceof Be)t.push(i);else if(i!==ht){const s=this.coerceScalarToComplex(i);if(s instanceof D)return s;t.push(s)}const r=[];for(const i of t)if(i instanceof Be){const s=this.manyToExactComplex(i.valuesFromTopLeftCorner());if(s instanceof D)return s;r.push(...s)}else r.push(i);return r}coerceScalarToComplex(e){return e instanceof D?e:e===ht?[0,0]:At(e)?[Le(e),0]:typeof e=="string"?this.coerceStringToComplex(e):new D($.NUM,Q.ComplexNumberExpected)}ExtendedNumberFactory(e,t){const{type:r,format:i}=t;switch(r){case He.NUMBER_RAW:return e;case He.NUMBER_CURRENCY:return new vw(e,i!=null?i:this.config.currencySymbol[0]);case He.NUMBER_DATE:return new sb(e,i);case He.NUMBER_DATETIME:return new ab(e,i);case He.NUMBER_TIME:return new ob(e,i);case He.NUMBER_PERCENT:return new $m(e,i)}}buildRegex(e,t=!0){e=this.normalizeString(e);let r,i=this.config.useWildcards,s=this.config.useRegularExpressions;if(s)try{RegExp(e)}catch{s=!1,i=!1}return s?r=ele(e,this.config.caseSensitive):i?r=Zae(e,this.config.caseSensitive):r=Jae(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+r+")$"):RegExp(r)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=QI(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,t){if(typeof e=="string"||typeof t=="string"){const r=typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):e,i=typeof t=="string"?this.dateTimeHelper.dateStringToDateNumber(t):t;if(At(r)&&At(i))return this.floatCmp(r,i)}return e===ht?e=v4(t):t===ht&&(t=v4(e)),typeof e=="string"&&typeof t=="string"?this.stringCmp(e,t):typeof e=="boolean"&&typeof t=="boolean"?C4(Rw(e),Rw(t)):At(e)&&At(t)?this.floatCmp(e,t):e===ht&&t===ht?0:C4(w4(Yp(e)),w4(Yp(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){const r=[];for(const s of e)if(s instanceof Be)r.push(s);else{const o=Le(this.coerceScalarToNumberOrError(s));if(o instanceof D)return o;r.push(o)}const i=[];for(const s of r)if(s instanceof Be){const o=t(s.valuesFromTopLeftCorner());if(o instanceof D)return o;i.push(...o)}else i.push(s);return i}coerceStringToComplex(e){const t=qae.exec(e);if(t===null)return new D($.NUM,Q.ComplexNumberExpected);let r;if(t[6]!==void 0?r=t[1]==="-"?[0,-1]:[0,1]:r=this.parseComplexToken(t[1]+t[3],t[5]),r instanceof D||t[8]===void 0)return r;let i;return t[14]!==void 0?i=t[9]==="-"?[0,-1]:[0,1]:i=this.parseComplexToken(t[9]+t[11],t[13]),i instanceof D?i:t[5]!==""||t[13]===""?new D($.NUM,Q.ComplexNumberExpected):t[8]==="+"?[r[0]+i[0],r[1]+i[1]]:[r[0]-i[0],r[1]-i[1]]}parseComplexToken(e,t){const r=Le(this.coerceNonDateScalarToMaybeNumber(e));return r===void 0?new D($.NUM,Q.ComplexNumberExpected):t===""?[r,0]:[0,r]}}function wn([n,e],t){if(!isFinite(n)||!isFinite(e))return new D($.NUM,Q.NaN);if(t=t!=null?t:Kae,e===0)return`${n}`;const r=`${e===-1||e===1?"":Math.abs(e)}${t}`;return n===0?`${e<0?"-":""}${r}`:`${n}${e<0?"-":"+"}${r}`}function jI(n){return n instanceof Be?n:Be.fromScalar(n)}function Rw(n){return Number(n)}function v4(n){return typeof n=="string"?"":At(n)?0:typeof n=="boolean"?!1:ht}function KI(n){if(n instanceof D||typeof n=="boolean")return n;if(n===ht)return!1;if(At(n))return Le(n)!==0;{const e=n.toUpperCase();return e==="TRUE"?!0:e==="FALSE"||e===""?!1:void 0}}function Tw(n){return n instanceof D||typeof n=="string"?n:n===ht?"":At(n)?Le(n).toString():n?"TRUE":"FALSE"}function D6(n){return n===ht?0:n}function C4(n,e){const t=Le(n),r=Le(e);return t>r?1:t<r?-1:0}function qI(n){return isNaN(n)||n===1/0||n===-1/0}function XI(n){return n===0?0:n}function hd(n){return["*","?"].includes(n)}const Qae=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function dd(n){return Qae.includes(n)}function Zae(n,e){let t="";for(let r=0;r<n.length;r++){const i=n.charAt(r);if(i==="~"){if(r==n.length-1){t+="~";continue}const s=n.charAt(r+1);hd(s)||dd(s)?(t+="\\"+s,r++):(t+=s,r++)}else hd(i)?t+="."+i:dd(i)?t+="\\"+i:e?t+=i:t+=i.toLowerCase()}return t}function Jae(n,e){let t="";for(let r=0;r<n.length;r++){const i=n.charAt(r);hd(i)||dd(i)?t+="\\"+i:e?t+=i:t+=i.toLowerCase()}return t}function ele(n,e){let t="";for(let r=0;r<n.length;r++){const i=n.charAt(r);hd(i)||dd(i)||e?t+=i:t+=i.toLowerCase()}return t}function E4(n,e){const{type:t,format:r}=Wp(n),{type:i,format:s}=Wp(e);if(t===He.NUMBER_RAW)return{type:i,format:s};if(i===He.NUMBER_RAW)return{type:t,format:r};if((t===He.NUMBER_DATETIME||t===He.NUMBER_DATE)&&(i===He.NUMBER_DATETIME||i===He.NUMBER_DATE))return{type:He.NUMBER_RAW};if(t===He.NUMBER_TIME){if(i===He.NUMBER_DATE)return{type:He.NUMBER_DATETIME,format:`${s} ${r}`};if(i===He.NUMBER_DATETIME)return{type:He.NUMBER_DATETIME,format:s}}if(i===He.NUMBER_TIME){if(t===He.NUMBER_DATE)return{type:He.NUMBER_DATETIME,format:`${r} ${s}`};if(t===He.NUMBER_DATETIME)return{type:He.NUMBER_DATETIME,format:r}}return{type:t,format:r}}function b4(n,e){let{type:t,format:r}=Wp(n),{type:i,format:s}=Wp(e);return t===He.NUMBER_PERCENT&&(t=He.NUMBER_RAW,r=void 0),i===He.NUMBER_PERCENT&&(i=He.NUMBER_RAW,s=void 0),t===He.NUMBER_RAW?{type:i,format:s}:i===He.NUMBER_RAW?{type:t,format:r}:{type:He.NUMBER_RAW}}function Nh(n){return QI(n.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function Gm(n,e){var t;if(n.isAdHoc())return(t=n.data[0])===null||t===void 0?void 0:t[0];const r=n.range;if(e.formulaAddress.sheet===r.sheet){if(r.width()===1){const i=e.formulaAddress.row-r.start.row;if(i>=0&&i<r.height())return n.data[i][0]}else if(r.height()===1){const i=e.formulaAddress.col-r.start.col;if(i>=0&&i<r.width())return n.data[0][i]}}}function QI(n,e){return typeof n.normalize=="function"?n.normalize(e.toUpperCase()):Yae[e](n)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var w;(function(n){n.STRING="STRING",n.NUMBER="NUMBER",n.BOOLEAN="BOOLEAN",n.SCALAR="SCALAR",n.NOERROR="NOERROR",n.RANGE="RANGE",n.INTEGER="INTEGER",n.COMPLEX="COMPLEX",n.ANY="ANY"})(w||(w={}));class nt{constructor(e){this.coerceScalarToNumberOrError=t=>this.arithmeticHelper.coerceScalarToNumberOrError(t),this.runFunction=(t,r,i,s)=>{const o=this.evaluateArguments(t,r,i),a=o.map(([m,p])=>m),l=o.map(([m,p])=>p),u=this.buildMetadataForEachArgumentValue(a.length,i),c=r.arraysFlag&&!i.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(u,a.length))return new D($.NA,Q.WrongArgNumber);const[h,d]=c?this.calculateSizeOfVectorizedResultArray(a,u):[1,1];if(h===1&&d===1){const m=this.vectorizeAndBroadcastArgumentsIfNecessary(c,a,u,0,0);return this.calculateSingleCellOfResultArray(r,m,u,l,s,i.returnNumberType)}const f=[...Array(h).keys()].map(m=>[...Array(d).keys()].map(p=>{const y=this.vectorizeAndBroadcastArgumentsIfNecessary(c,a,u,m,p),C=this.calculateSingleCellOfResultArray(r,y,u,l,s,i.returnNumberType);if(C instanceof Be)throw new Error("Function returning array cannot be vectorized.");return C}));return Be.onlyValues(f)},this.runFunctionWithReferenceArgument=(t,r,i,s,o,a=()=>new D($.NA,Q.CellRefExpected))=>{if(t.length===0)return this.returnNumberWrapper(s(),i.returnNumberType);if(t.length>1)return new D($.NA,Q.WrongArgNumber);let l=t[0];for(;l.type===W.PARENTHESIS;)l=l.expression;let u;if(l.type===W.CELL_REFERENCE)u=l.reference.toSimpleCellAddress(r.formulaAddress);else if(l.type===W.CELL_RANGE||l.type===W.COLUMN_RANGE||l.type===W.ROW_RANGE)try{u=We.fromAst(l,r.formulaAddress).start}catch{return new D($.REF,Q.CellRefExpected)}return u!==void 0?this.returnNumberWrapper(o(u),i.returnNumberType):this.runFunction(t,r,i,a)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){const r=[];for(const i of e){const s=this.evaluateAst(i,t);if(s instanceof Be)for(const o of s.valuesFromTopLeftCorner())r.push([o,!0]);else r.push([s,!1])}return r}coerceToType(e,t,r){let i;if(e instanceof Be)switch(t.argumentType){case w.RANGE:case w.ANY:i=e;break;default:{const s=Gm(e,r);if(s===void 0)return;e=s}}if(!(e instanceof Be))switch(t.argumentType){case w.INTEGER:case w.NUMBER:const s=this.coerceScalarToNumberOrError(e);if(!At(s)){i=s;break}const o=Le(s);if(t.maxValue!==void 0&&o>t.maxValue)return new D($.NUM,Q.ValueLarge);if(t.minValue!==void 0&&o<t.minValue)return new D($.NUM,Q.ValueSmall);if(t.lessThan!==void 0&&o>=t.lessThan)return new D($.NUM,Q.ValueLarge);if(t.greaterThan!==void 0&&o<=t.greaterThan)return new D($.NUM,Q.ValueSmall);if(t.argumentType===w.INTEGER&&!Number.isInteger(o))return new D($.NUM,Q.IntegerExpected);i=s;break;case w.STRING:i=Tw(e);break;case w.BOOLEAN:i=KI(e);break;case w.SCALAR:case w.NOERROR:case w.ANY:i=e;break;case w.RANGE:if(e instanceof D)return e;i=jI(e);break;case w.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(Le(e))}return t.passSubtype||i===void 0?i:Le(i)}calculateSingleCellOfResultArray(e,t,r,i,s,o){const a=this.coerceArgumentsToRequiredTypes(e,t,r,i);if(a instanceof D)return a;const l=s(...a);return this.returnNumberWrapper(l,o)}coerceArgumentsToRequiredTypes(e,t,r,i){const s=[];for(let o=0;o<r.length;o++){const a=r[o],l=t[o]!==void 0?t[o]:a==null?void 0:a.defaultValue;if(l===void 0){s.push(void 0);continue}const u=this.coerceToType(l,a,e);if(u===void 0&&!i[o])return new D($.VALUE,Q.WrongType);if(u instanceof D&&a.argumentType!==w.SCALAR)return u;s.push(u)}return s}vectorizeAndBroadcastArgumentsIfNecessary(e,t,r,i,s){return t.map((o,a)=>e&&this.isRangePassedAsAScalarArgument(o,r[a])?this.vectorizeAndBroadcastRangeArgument(o,i,s):o)}vectorizeAndBroadcastRangeArgument(e,t,r){var i;const s=e.height()===1?0:t,o=e.width()===1?0:r;return(i=e.data[s])===null||i===void 0?void 0:i[o]}evaluateArguments(e,t,r){return r.expandRanges?this.listOfScalarValues(e,t):e.map(i=>[this.evaluateAst(i,t),!1])}buildMetadataForEachArgumentValue(e,t){const r=t.parameters?[...t.parameters]:[];if(t.repeatLastArgs!==void 0&&Number.isInteger(t.repeatLastArgs)&&t.repeatLastArgs>0)for(;e>r.length;)r.push(...r.slice(r.length-t.repeatLastArgs));return r}isNumberOfArgumentValuesValid(e,t){return t>e.length?!1:t<e.length?e.slice(t).every(s=>(s==null?void 0:s.optionalArg)||(s==null?void 0:s.defaultValue)!==void 0):!0}calculateSizeOfVectorizedResultArray(e,t){const r=e.filter((o,a)=>this.isRangePassedAsAScalarArgument(o,t[a])),i=Math.max(1,...r.map(o=>o.height())),s=Math.max(1,...r.map(o=>o.width()));return[i,s]}isRangePassedAsAScalarArgument(e,t){return e==null||t==null?!1:e instanceof Be&&![w.RANGE,w.ANY].includes(t.argumentType)}metadata(e){const t=this.constructor.implementedFunctions[e];if(t!==void 0)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,r){return t!==void 0&&At(e)?this.arithmeticHelper.ExtendedNumberFactory(Le(e),{type:t,format:r}):e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class lt{constructor(e,t,r=!1){if(this.width=e,this.height=t,this.isRef=r,e<=0||t<=0)throw Error("Incorrect array size")}static fromArray(e){return new lt(e.length>0?e[0].length:0,e.length)}static error(){return new lt(1,1,!0)}static scalar(){return new lt(1,1,!1)}isScalar(){return this.width<=1&&this.height<=1||this.isRef}}function tle(n,e){return new lt(Math.max(n.width,e.width),Math.max(n.height,e.height))}function nle(n){return new lt(n.width,n.height)}class rle{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case W.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case W.COLUMN_RANGE:case W.ROW_RANGE:case W.CELL_RANGE:{const r=We.fromAstOrUndef(e,t.formulaAddress);return r===void 0?lt.error():new lt(r.width(),r.height(),!0)}case W.ARRAY:{const r=[],i=[];for(const a of e.args){const l=a.map(h=>this.checkArraySizeForAst(h,t)),u=Math.min(...l.map(h=>h.height)),c=l.reduce((h,d)=>h+d.width,0);r.push(u),i.push(c)}const s=r.reduce((a,l)=>a+l,0),o=Math.min(...i);return new lt(o,s)}case W.STRING:case W.NUMBER:return lt.scalar();case W.CELL_REFERENCE:return new lt(1,1,!0);case W.DIV_OP:case W.CONCATENATE_OP:case W.EQUALS_OP:case W.GREATER_THAN_OP:case W.GREATER_THAN_OR_EQUAL_OP:case W.LESS_THAN_OP:case W.LESS_THAN_OR_EQUAL_OP:case W.MINUS_OP:case W.NOT_EQUAL_OP:case W.PLUS_OP:case W.POWER_OP:case W.TIMES_OP:{const r=this.checkArraySizeForAst(e.left,t),i=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(r.height>1||r.width>1||i.height>1||i.width>1)?lt.error():tle(r,i)}case W.MINUS_UNARY_OP:case W.PLUS_UNARY_OP:case W.PERCENT_OP:{const r=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(r.height>1||r.width>1)?lt.error():nle(r)}case W.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);case W.EMPTY:return lt.error();default:return lt.error()}}checkArraySizeForFunction(e,t){const r=this.functionRegistry.getMetadata(e.procedureName),i=this.functionRegistry.getArraySizeFunction(e.procedureName);if(i!==void 0)return i(e,t);const s=e.args.map(u=>{var c;return this.checkArraySizeForAst(u,new Ls(t.formulaAddress,t.arraysFlag||((c=r==null?void 0:r.arrayFunction)!==null&&c!==void 0?c:!1)))});if(r===void 0||r.expandRanges||!t.arraysFlag||r.vectorizationForbidden||r.parameters===void 0)return new lt(1,1);const o=[...r.parameters];if(r.repeatLastArgs===void 0&&o.length<s.length||r.repeatLastArgs!==void 0&&o.length<s.length&&(s.length-o.length)%r.repeatLastArgs!==0)return lt.error();for(;o.length<s.length;)o.push(...o.slice(o.length-r.repeatLastArgs));let a=1,l=1;for(let u=0;u<s.length;u++)o[u].argumentType!==w.RANGE&&o[u].argumentType!==w.ANY&&(l=Math.max(l,s[u].height),a=Math.max(a,s[u].width));return new lt(a,l)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ZI{constructor(e,t,r){var i;this.value=t,this.address=r,this.type=e.type,this.message=(i=e.message)!==null&&i!==void 0?i:""}toString(){return this.value}valueOf(){return this.value}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function _t(n,e,t){if(typeof n>"u")return dr.defaultConfig[t];if(typeof e=="string"){if(typeof n===e)return n;throw new Tt(e,t)}else{if(e.includes(n))return n;throw new BI(e.map(r=>`'${r}'`).join(" "),t)}}function ou(n,e,t){if(n<t)throw new HI(e,t)}function ile(n,e,t){if(n>t)throw new UI(e,t)}function Jf(n,e,t,r){if(e(n))return n;if(typeof n>"u")return dr.defaultConfig[r];throw new Tt(t,r)}function S4(...n){const e=new Map;n.forEach(r=>{const i=e.get(r.value)||[];i.push(r.name),e.set(r.value,i)});const t=[];for(const r of e.values())r.length>1&&t.push(r);if(t.length>0){t.forEach(i=>i.sort());const r=t.map(i=>`[${i}]`).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${r}`)}}function Ne(n,e,t){if(typeof n!==e)throw new Tt(e,t)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const cb=new RegExp("^ss(\\.(s+|0+))?$"),sle=new RegExp("^[0-9/.\\-: ]+[ap]?m?$"),ole=new RegExp("\\s+"),JI=new RegExp("[ /.-]"),Aw=":",R4=1e3,ale=eO(cle),lle=eO(hle);function ule(n,e,t){if(e===void 0&&t===void 0)return;let r=n.replace(ole," ").trim().toLowerCase();if(!dle(r))return;let i=r.substring(r.length-2);i==="am"||i==="pm"?r=r.substring(0,r.length-2).trim():(i=r.substring(r.length-1),i==="a"||i==="p"?r=r.substring(0,r.length-1).trim():i=void 0);const s=r.split(JI);s.length>=2&&s[s.length-2].includes(Aw)&&(s[s.length-2]=s[s.length-2]+"."+s[s.length-1],s.pop());const o=s[s.length-1].split(Aw);if(i!==void 0&&o.push(i),s.length===1)return T4(o,t);if(o.length===1)return A4(s,e);const a=A4(s.slice(0,s.length-1),e),l=T4(o,t);if(a!==void 0)return l===void 0?void 0:Object.assign(Object.assign({},a),l)}function T4(n,e){var t,r,i;if(e===void 0)return;const{itemsCount:s,hourItem:o,minuteItem:a,secondItem:l}=ale(e);let u;if(n[n.length-1]==="am"||n[n.length-1]==="a"?(u=!1,n.pop()):(n[n.length-1]==="pm"||n[n.length-1]==="p")&&(u=!0,n.pop()),n.length!==s)return;const c=Number((t=n[l])!==null&&t!==void 0?t:"0");if(!Number.isFinite(c))return;const h=Math.round(c*R4)/R4,d=Number((r=n[a])!==null&&r!==void 0?r:"0");if(!(Number.isFinite(d)&&Number.isInteger(d)))return;const f=Number((i=n[o])!==null&&i!==void 0?i:"0");return!(Number.isFinite(f)&&Number.isInteger(f))||u!==void 0&&(f<0||f>12)?void 0:{hours:u!==void 0?f%12+(u?12:0):f,minutes:d,seconds:h}}function A4(n,e){var t;if(e===void 0)return;const{itemsCount:r,dayItem:i,monthItem:s,shortYearItem:o,longYearItem:a}=lle(e);if(n.length!==r)return;const l=Number(n[i]);if(!(Number.isFinite(l)&&Number.isInteger(l)))return;const u=Number(n[s]);if(!(Number.isFinite(u)&&Number.isInteger(u))||n[a]&&n[o])return;const c=Number((t=n[a])!==null&&t!==void 0?t:n[o]);if(!!(Number.isFinite(c)&&Number.isInteger(c))&&!(n[a]&&(c<1e3||c>9999))&&!(n[o]&&(c<0||c>99)))return{year:c,month:u,day:l}}function cle(n){const e=n.toLowerCase().trim(),r=(e.endsWith("am/pm")?e.substring(0,e.length-5):e.endsWith("a/p")?e.substring(0,n.length-3):e).trim().split(Aw);return{itemsCount:r.length,hourItem:r.indexOf("hh"),minuteItem:r.indexOf("mm"),secondItem:r.findIndex(i=>cb.test(i))}}function hle(n){const e=n.toLowerCase().trim().split(JI);return{itemsCount:e.length,dayItem:e.indexOf("dd"),monthItem:e.indexOf("mm"),shortYearItem:e.indexOf("yy"),longYearItem:e.indexOf("yyyy")}}function dle(n){return sle.test(n)}function eO(n){const e={};return t=>{const r=e[t];if(r!==void 0)return r;const i=n(t);return e[t]=i,i}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const xw=[31,28,31,30,31,30,31,31,30,31,30,31],Nu=[0,31,59,90,120,151,181,212,243,273,304,334],em=60,tm=60,Mw=24;function Ih(n){return n&&(typeof n=="object"||typeof n=="function")?"year"in n&&typeof n.year=="number"&&"month"in n&&typeof n.month=="number"&&"day"in n&&typeof n.day=="number":!1}function tO(n){return n&&(typeof n=="object"||typeof n=="function")?"hours"in n&&typeof n.hours=="number"&&"minutes"in n&&typeof n.minutes=="number"&&"seconds"in n&&typeof n.seconds=="number":!1}const fle={year:9999,month:12,day:31};class mle{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(fle),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:t,dateFormat:r="",timeFormat:i=""}=this.parseDateTimeFromConfigFormats(e);if(t!==void 0)return tO(t)?Ih(t)?new ab(Hu(t)+this.dateToNumber(t),r+" "+i):new ob(Hu(t),i):Ih(t)?new sb(this.dateToNumber(t),r):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1?!1:this.isLeapYear(e.year)&&e.month===2?e.day<=29:e.day<=xw[e.month-1]}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const t=Math.floor(e)+this.minDateAbsoluteValue;let r=Math.floor(t/365.2425);this.dateToNumberFromZero({year:r+1,month:1,day:1})<=t?r++:this.dateToNumberFromZero({year:r-1,month:1,day:1})>t&&r--;const i=t-this.dateToNumberFromZero({year:r,month:1,day:1}),s=ple(i-(this.isLeapYear(r)&&i>=59?1:0)),o=i-Nu[s]-(this.isLeapYear(r)&&s>1?1:0);return{year:r,month:s+1,day:o+1}}numberToSimpleDateTime(e){const t=Fu(e%1),r=Math.floor(t.hours/Mw);t.hours=t.hours%Mw;const i=this.numberToSimpleDate(Math.floor(e)+r);return Object.assign(Object.assign({},i),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&t===2?29:xw[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return e.day===31&&(e.day=30),e.day===30&&t.day===31&&(t.day=30),e.month===2&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,t.month===2&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,r){const i=this.parseDateTime(e,t,r);if(!(Ih(i)&&(i.year>=0&&i.year<100&&(i.year<this.getNullYear()?i.year+=2e3:i.year+=1900),!this.isValidDate(i))))return i}parseDateTimeFromFormats(e,t,r){const i=t.length===0?[void 0]:t,s=r.length===0?[void 0]:r;for(const o of i)for(const a of s){const l=this.parseSingleFormat(e,o,a);if(l!==void 0)return{dateTime:l,timeFormat:a,dateFormat:o}}return{}}countLeapDays(e){return e.month>2||e.month===2&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+Nu[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return e%4?!1:e%100?!0:e%400?e===1900&&this.config.leapYear1900:!0}}function ple(n){let e=0;return Nu[e+6]<=n&&(e+=6),Nu[e+3]<=n&&(e+=3),Nu[e+2]<=n?e+=2:Nu[e+1]<=n&&(e+=1),e}function x4(n,e){const t=12*n.year+n.month-1+e;return{year:Math.floor(t/12),month:t%12+1,day:n.day}}function gle(n){return{year:n.year,month:n.month,day:Math.min(n.day,xw[n.month-1])}}function k6(n){return Math.round(n*3600*24)/(3600*24)}function yle(n,e=1){return Math.round(n*e)/e}function Fu(n){const e=n*Mw*tm*em,t=yle(e%em,1e5)%em,r=(e-t)/em,i=Math.round(r%tm)%tm,s=(r-i)/tm;return{hours:Math.round(s),minutes:i,seconds:t}}function Hu(n){return((n.seconds/60+n.minutes)/60+n.hours)/24}function M4(n){return{year:n.year,month:n.month,day:Math.min(30,n.day)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class wle{call(){return Fae}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const N4=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,I4=/(\\.|[#0]+(\.[#0]*)?)/g;var Os;(function(n){n.FORMAT="FORMAT",n.FREE_TEXT="FREE_TEXT"})(Os||(Os={}));function nm(n,e){return{type:n,value:e}}var jp;(function(n){n.DATE="DATE",n.NUMBER="NUMBER",n.STRING="STRING"})(jp||(jp={}));function vle(n){N4.lastIndex=0;const e=[];let t;do t=N4.exec(n),t!==null&&e.push(t);while(t);return e}function Cle(n){I4.lastIndex=0;const e=I4.exec(n);return e!==null?[e]:[]}function nO(n,e){const t=[];let r=0;for(let s=0;s<n.length;++s){const o=n[s];if(o.index!==r){const a=e.substr(r,o.index-r);t.push(nm(Os.FREE_TEXT,a))}o[0].startsWith("\\")?t.push(nm(Os.FREE_TEXT,o[0])):t.push(nm(Os.FORMAT,o[0])),r=o.index+o[0].length}const i=n[n.length-1];if(i.index+i[0].length<e.length){const s=e.substr(i.index+i[0].length,e.length);t.push(nm(Os.FREE_TEXT,s))}return t}function rO(n){const e=vle(n);if(!e.every(t=>iO(t)))return{type:jp.DATE,tokens:nO(e,n)}}function Ele(n){const e=Cle(n);if(!e.every(t=>iO(t)))return{type:jp.NUMBER,tokens:nO(e,n)}}function iO(n){return n[0].startsWith("\\")}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function ble(n,e,t,r){const i=t.stringifyDateTime(r.numberToSimpleDateTime(n),e);if(i!==void 0)return i;const s=t.stringifyDuration(Fu(n),e);if(s!==void 0)return s;const o=Ele(e);return o!==void 0?Rle(o.tokens,n):e}function jr(n,e){let t=`${n}`;for(;t.length<e;)t="0"+t;return t}function Sle(n,e){let t=`${n}`;for(;t.length<e;)t=t+"0";return t}function O4(n,e){return n.split(e).length-1}function Rle(n,e){let t="";for(let r=0;r<n.length;++r){const i=n[r];if(i.type===Os.FREE_TEXT){t+=i.value;continue}const s=i.value.split("."),o=s[0],a=s[1]||"",l=s[1]?".":"",u=Number(e.toFixed(a.length)).toString().split(".");let c=u[0]||"",h=u[1]||"";if(o.length>c.length){const f=O4(o.substr(0,o.length-c.length),"0");c=jr(c,f+c.length)}const d=O4(a.substr(h.length,a.length-h.length),"0");h=Sle(h,d+h.length),t+=c+l+h}return t}function Tle(n,e){const t=rO(e);if(t===void 0)return;const r=t.tokens;let i="";for(const s of r){if(s.type===Os.FREE_TEXT){i+=s.value;continue}switch(s.value.toLowerCase()){case"h":case"hh":{i+=jr(n.hours,s.value.length),n.hours=0;break}case"[hh]":{i+=jr(n.hours,s.value.length-2),n.hours=0;break}case"m":case"mm":{i+=jr(n.minutes,s.value.length),n.minutes=0;break}case"[mm]":{i+=jr(n.minutes+60*n.hours,s.value.length-2),n.minutes=0,n.hours=0;break}case"s":case"ss":{i+=jr(Math.floor(n.seconds),s.value.length);break}default:{if(cb.test(s.value)){const o=Math.max(s.value.length-3,0);i+=`${n.seconds<10?"0":""}${Math.floor(n.seconds*Math.pow(10,o))/Math.pow(10,o)}`;continue}return}}}return i}function Ale(n,e){const t=rO(e);if(t===void 0)return;const r=t.tokens;let i="",s=!1;const o=r.some(a=>a.type===Os.FORMAT&&(a.value==="a/p"||a.value==="A/P"||a.value==="am/pm"||a.value==="AM/PM"));for(let a=0;a<r.length;a++){const l=r[a];if(l.type===Os.FREE_TEXT){i+=l.value;continue}switch(l.value.toLowerCase()){case"h":case"hh":{s=!0,i+=jr(o?(n.hours+11)%12+1:n.hours,l.value.length);break}case"d":case"dd":{i+=jr(n.day,l.value.length);break}case"s":case"ss":{i+=jr(Math.floor(n.seconds),l.value.length);break}case"m":case"mm":{a+1<r.length&&r[a+1].value.startsWith(":")&&(s=!0),s?i+=jr(n.minutes,l.value.length):i+=jr(n.month,l.value.length),s=!0;break}case"yy":{i+=jr(n.year%100,l.value.length);break}case"yyyy":{i+=n.year;break}case"am/pm":case"a/p":{const[u,c]=l.value.split("/");i+=n.hours<12?u:c;break}default:{if(cb.test(l.value)){const u=l.value.length-3;i+=`${n.seconds<10?"0":""}${Math.floor(n.seconds*Math.pow(10,u))/Math.pow(10,u)}`;continue}return}}}return i}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Nw="length",Oh=n=>parseInt(n,16),_4=n=>parseInt(n,10),F6=n=>(n+"").replace(/\-/g,""),Kp=(n,e,t)=>n.substr(e,t),Yi=n=>n.codePointAt(0)-65;function xle(n){return F6(n)[Nw]===25?Oh(Kp(F6(n),Oh("12"),Yi("F")))/(Oh(Kp(F6(n),Yi("C"),Yi("Y")>>4))||(~~![][Nw]<<3)+1):0}function Mle(n){if(n=(n+"").replace(/\-/g,""),n[Nw]!==Yi("Z"))return!1;let e=0;return[[0,Yi("G")+1],[Yi("H"),Yi("H")-1],[Yi("G")+Yi("H"),Yi("G")]].reduce((t,[r,i],s)=>(t|=(_4(`${_4(Oh(Kp(n,e+r-(s===0?0:2),i+(s?2:0)))+(Oh(Kp(n,e+r+i,2))+[]).padStart(2,"0"))}`)%97||2)>>1,e+=2,t),Yi("A"))===[]+1>>1}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Nle={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:n})=>`The license key for HyperFormula expired on ${n}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let L4=!1;function Ile(n){const e={template:"missing",vars:{}};if(n==="gpl-v3"||n==="internal-use-in-handsontable")e.template="valid";else if(typeof n=="string"&&Mle(n)){const[t,r,i]="19/09/2023".split("/"),s=Math.floor(new Date(`${r}/${t}/${i}`).getTime()/864e5),o=xle(n);e.vars.keyValidityDate=Ole(new Date((o+1)*864e5)),s>o?e.template="expired":e.template="valid"}else n!==""&&(e.template="invalid");return!L4&&e.template!=="valid"&&(console.warn(Nle[e.template](e.vars)),L4=!0),e.template}function Ole(n){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][n.getMonth()],r=n.getDate(),i=n.getFullYear();return`${t} ${r}, ${i}`}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var tn;(function(n){class e{constructor(l){this.value=l,this.value=ib(this.value,XI(Le(this.value)))}}n.Number=e;class t{constructor(l){this.value=l}}n.String=t;class r{constructor(l){this.value=l}}n.Boolean=r;class i{static getSingletonInstance(){return i.instance||(i.instance=new i),i.instance}}n.Empty=i;class s{constructor(l){this.formula=l}}n.Formula=s;class o{constructor(l,u){this.value=new D(l,u)}}n.Error=o})(tn||(tn={}));function _le(n){return n.startsWith("=")}function Lle(n){const e=n.toLowerCase();return e==="true"||e==="false"}function Ple(n,e){const t=n.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(t)&&Object.prototype.hasOwnProperty.call(e,t)}class Dle{constructor(e,t,r){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=r}parse(e){if(e==null)return tn.Empty.getSingletonInstance();if(typeof e=="number")return qI(e)?new tn.Error($.NUM,Q.ValueLarge):new tn.Number(e);if(typeof e=="boolean")return new tn.Boolean(e);if(e instanceof Date){const t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),r=Hu({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3}),i=t+r;return i<0?new tn.Error($.NUM,Q.DateBounds):i%1===0?new tn.Number(new sb(i,"Date()")):i<1?new tn.Number(new ob(i,"Date()")):new tn.Number(new ab(i,"Date()"))}else if(typeof e=="string"){if(Lle(e))return new tn.Boolean(e.toLowerCase()==="true");if(_le(e))return new tn.Formula(e);if(Ple(e,this.config.errorMapping))return new tn.Error(this.config.errorMapping[e.toUpperCase()]);{let t=e.trim(),r=0,i;if(t.endsWith("%"))r=1,t=t.slice(0,t.length-1);else{const a=this.currencyMatcher(t);a!==void 0&&(r=2,[i,t]=a)}const s=this.numberLiteralsHelper.numericStringToMaybeNumber(t);if(s!==void 0){let a;return r===1?a=new $m(s/100):r===2?a=new vw(s,i):a=s,new tn.Number(a)}const o=this.dateHelper.dateStringToDateNumber(t);return o!==void 0?new tn.Number(o):new tn.String(e.startsWith("'")?e.slice(1):e)}}else throw new FI(e)}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var $a;(function(n){n[n.COPY=0]="COPY",n[n.CUT=1]="CUT"})($a||($a={}));var ur;(function(n){n[n.VALUE=0]="VALUE",n[n.EMPTY=1]="EMPTY",n[n.FORMULA=2]="FORMULA",n[n.PARSING_ERROR=3]="PARSING_ERROR"})(ur||(ur={}));class P4{constructor(e,t,r,i,s){this.sourceLeftCorner=e,this.width=t,this.height=r,this.type=i,this.content=s}*getContent(e){if(this.content!==void 0)for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r)yield[Pe(e.sheet,e.col+r,e.row+t),this.content[t][r]]}}class kle{constructor(e,t,r){this.dependencyGraph=t,this.operations=r,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,r){this.clipboard=new P4(e,t,r,$a.CUT)}copy(e,t,r){const i=[];for(let s=0;s<r;++s){i[s]=[];for(let o=0;o<t;++o){const a=this.operations.getClipboardCell(Pe(e.sheet,e.col+o,e.row+s));i[s].push(a)}}this.clipboard=new P4(e,t,r,$a.COPY,i)}abortCut(){this.clipboard&&this.clipboard.type===$a.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(this.clipboard===void 0)return;if(qr(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new kn("a valid target address.");const t=We.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new nl;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return this.clipboard!==void 0&&this.clipboard.type===$a.CUT}isCopyClipboard(){return this.clipboard!==void 0&&this.clipboard.type===$a.COPY}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class qp{constructor(e,t,r,i){this.displayName=e,this.address=t,this.added=r,this.options=i}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new qp(this.displayName,this.address,this.added,this.options)}}class Fle{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);return!(r&&r.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const t=this.mapping.get(this.normalizeExpressionName(e));if(t&&t.added)return t}remove(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);r&&(r.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class D4{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){const t=this.normalizeExpressionName(e);return!this.mapping.has(t)}remove(e){const t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}normalizeExpressionName(e){return e.toLowerCase()}}class ml{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new Fle,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){var r,i;return t===void 0?this.workbookStore.isNameAvailable(e):(i=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.isNameAvailable(e))!==null&&i!==void 0?i:!0}namedExpressionInAddress(e){const t=this.addressCache.get(e);if(t&&t.added)return t}namedExpressionForScope(e,t){var r;return t===void 0?this.workbookStore.getExisting(e):(r=this.worksheetStore(t))===null||r===void 0?void 0:r.get(e)}nearestNamedExpression(e,t){var r,i;return(i=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.get(e))!==null&&i!==void 0?i:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){var r,i;return(i=(r=this.worksheetStore(t))===null||r===void 0?void 0:r.has(e))!==null&&i!==void 0?i:!1}isNameValid(e){const t=new RegExp(`^${vN}$`),r=new RegExp(`^${CN}$`),i=new RegExp(`^${EN}$`);return t.test(e)||r.test(e)?!1:i.test(e)}addNamedExpression(e,t,r){const i=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);let s=i.get(e);return s!==void 0?(s.added=!0,s.displayName=e,s.options=r):(s=new qp(e,this.nextAddress(),!0,r),i.add(s)),this.addressCache.set(s.address.row,s),s}restoreNamedExpression(e,t){const r=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,r.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){var r;return(r=this.worksheetStoreOrCreate(t).get(e))!==null&&r!==void 0?r:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return t===void 0&&(t=new qp(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let r;t===void 0?r=this.workbookStore:r=this.worksheetStore(t);const i=r==null?void 0:r.get(e);if(r===void 0||i===void 0||!i.added)throw Error("Named expression does not exist");r.remove(e),r instanceof D4&&r.mapping.size===0&&this.worksheetStores.delete(t),this.addressCache.delete(i.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter(({scope:t})=>t===e).map(t=>t.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach(t=>{e.push({expression:t,scope:void 0})}),this.worksheetStores.forEach((t,r)=>{t.getAllNamedExpressions().forEach(i=>{e.push({expression:i,scope:r})})}),e}getAllNamedExpressionsForScope(e){var t,r;return e===void 0?this.workbookStore.getAllNamedExpressions():(r=(t=this.worksheetStores.get(e))===null||t===void 0?void 0:t.getAllNamedExpressions())!==null&&r!==void 0?r:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new D4,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return Pe(ml.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}ml.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const Bo=n=>{switch(n.type){case W.EMPTY:case W.NUMBER:case W.STRING:case W.ERROR:case W.ERROR_WITH_RAW_INPUT:return!1;case W.CELL_REFERENCE:return!n.reference.isAbsolute();case W.CELL_RANGE:case W.COLUMN_RANGE:case W.ROW_RANGE:return!n.start.isAbsolute();case W.NAMED_EXPRESSION:return!1;case W.PERCENT_OP:case W.PLUS_UNARY_OP:case W.MINUS_UNARY_OP:return Bo(n.value);case W.CONCATENATE_OP:case W.EQUALS_OP:case W.NOT_EQUAL_OP:case W.LESS_THAN_OP:case W.GREATER_THAN_OP:case W.LESS_THAN_OR_EQUAL_OP:case W.GREATER_THAN_OR_EQUAL_OP:case W.MINUS_OP:case W.PLUS_OP:case W.TIMES_OP:case W.DIV_OP:case W.POWER_OP:return Bo(n.left)||Bo(n.right);case W.PARENTHESIS:return Bo(n.expression);case W.FUNCTION_CALL:return n.args.some(e=>Bo(e));case W.ARRAY:return n.args.some(e=>e.some(t=>Bo(t)))}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ya{performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[i,s]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService)),o=t.rememberNewAst(i);r.setFormula(o),r.setAddress(s)}}transformSingleAst(e,t){const r=this.transformAst(e,t),i=this.fixNodeAddress(t);return[r,i]}transformAst(e,t){switch(e.type){case W.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case W.CELL_RANGE:return this.transformCellRangeAst(e,t);case W.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case W.ROW_RANGE:return this.transformRowRangeAst(e,t);case W.EMPTY:case W.ERROR:case W.NUMBER:case W.NAMED_EXPRESSION:case W.ERROR_WITH_RAW_INPUT:case W.STRING:return e;case W.PERCENT_OP:case W.MINUS_UNARY_OP:case W.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case W.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(r=>this.transformAst(r,t))});case W.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case W.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(r=>r.map(i=>this.transformAst(i,t)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){const r=this.transformCellAddress(e.reference,t);return r instanceof Ut?Object.assign(Object.assign({},e),{reference:r}):r===$.REF?Ts(new D($.REF)):e}transformCellRangeAst(e,t){const r=this.transformCellRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===$.REF?Ts(new D($.REF)):e}transformColumnRangeAst(e,t){const r=this.transformColumnRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===$.REF?Ts(new D($.REF)):e}transformRowRangeAst(e,t){const r=this.transformRowRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===$.REF?Ts(new D($.REF)):e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Hle extends ya{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=ns(e,t);if(r!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const i=e.toSimpleColumnAddress(t);return r===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=i.col?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1:t.sheet===this.columnsSpan.sheet&&r!==this.columnsSpan.sheet?e.isColumnAbsolute()||t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?e.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const i=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return i===$.REF||s===$.REF?$.REF:i||s?[i||e,s||t]:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Iw extends ya{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}transformCellAddress(e,t){const r=ns(e,t);if(r!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;const i=e.toSimpleRowAddress(t);return r===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=i.row?e.shiftedByRows(this.rowsSpan.numberOfRows):!1:t.sheet===this.rowsSpan.sheet&&r!==this.rowsSpan.sheet?e.isRowAbsolute()||t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?e.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(this.rowsSpan.numberOfRows):i.row<this.rowsSpan.rowStart?t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart?e.shiftedByRows(this.rowsSpan.numberOfRows):!1}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const i=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return i===$.REF||s===$.REF?$.REF:i||s?[i||e,s||t]:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ule extends ya{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return e.isInvalid(t)?$.REF:!1}transformCellRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?$.REF:!1}transformColumnRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?$.REF:!1}transformRowRange(e,t,r){return e.isInvalid(r)||t.isInvalid(r)?$.REF:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ble extends ya{constructor(e,t,r,i){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=i,this.dependentFormulaTransformer=new Vle(e,t,r,i)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return Pe(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformAddress(e,t){const r=this.sourceRange;if(e instanceof Ut){const i=e.toSimpleCellAddress(t);if(r.addressInRange(i))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,r){const i=this.sourceRange;if(e instanceof Ut&&t instanceof Ut){const s=e.toSimpleCellAddress(r),o=t.toSimpleCellAddress(r);if(i.addressInRange(s)&&i.addressInRange(o))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class Vle extends ya{constructor(e,t,r,i){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=i}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.shouldMove(e,t)?e.moved(this.toSheet,this.toRight,this.toBottom):!1}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}shouldMove(e,t){return e instanceof Ut?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof Er?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,r){const i=this.transformCellAddress(e,r),s=this.transformCellAddress(t,r);return i&&s?[i,s]:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class $le extends ya{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=ns(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==r)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===r){const i=e.toSimpleColumnAddress(t);if(i.col<this.columnsSpan.columnStart)return!1;if(i.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==r){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===r)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const i=e.toSimpleColumnAddress(t);if(i.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(i.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return $.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const i=ns(e,r);let s=e,o=t;if(this.columnsSpan.sheet===i){const u=e.toSimpleColumnAddress(r),c=t.toSimpleColumnAddress(r);if(this.columnsSpan.columnStart<=u.col&&this.columnsSpan.columnEnd>=c.col)return $.REF;u.col>=this.columnsSpan.columnStart&&u.col<=this.columnsSpan.columnEnd&&(s=e.shiftedByColumns(this.columnsSpan.columnEnd-u.col+1)),c.col>=this.columnsSpan.columnStart&&c.col<=this.columnsSpan.columnEnd&&(o=t.shiftedByColumns(-(c.col-this.columnsSpan.columnStart+1)))}const a=this.transformCellAddress(s,r),l=this.transformCellAddress(o,r);if(a===!1&&l===!1)return[s,o];if(a===$.REF||l===$.REF)throw Error("Cannot happen");return[a||s,l||o]}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ow extends ya{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){const r=ns(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==r)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===r){const i=e.toSimpleRowAddress(t);if(i.row<this.rowsSpan.rowStart)return!1;if(i.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==r){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===r)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const i=e.toSimpleRowAddress(t);if(i.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(i.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return $.REF}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const i=ns(e,r);let s=e,o=t;if(this.rowsSpan.sheet===i){const u=e.toSimpleRowAddress(r),c=t.toSimpleRowAddress(r);if(this.rowsSpan.rowStart<=u.row&&this.rowsSpan.rowEnd>=c.row)return $.REF;u.row>=this.rowsSpan.rowStart&&u.row<=this.rowsSpan.rowEnd&&(s=e.shiftedByRows(this.rowsSpan.rowEnd-u.row+1)),c.row>=this.rowsSpan.rowStart&&c.row<=this.rowsSpan.rowEnd&&(o=t.shiftedByRows(-(c.row-this.rowsSpan.rowStart+1)))}const a=this.transformCellAddress(s,r),l=this.transformCellAddress(o,r);return a===!1&&l===!1?[s,o]:a===$.REF||l===$.REF?$.REF:[a||s,l||o]}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Wle extends ya{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[i]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService));r.setFormula(i)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,r){return this.transformAddress(e)}transformColumnRange(e,t,r){return this.transformAddress(e)}transformRowRange(e,t,r){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet?$.REF:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function sO(n){if(!Array.isArray(n))throw new kn("an array of arrays.");for(let e=0;e<n.length;e++)if(!Array.isArray(n[e]))throw new kn("an array of arrays.")}function Xp(n){let e=0,t=0,r=0;for(let s=0;s<n.length;s++){let o=0;for(let a=0;a<n[s].length;a++){const l=n[s][a];l!=null&&(o=a+1,++r)}e=Math.max(e,o),o>0&&(t=s+1)}const i=e*t;return{height:t,width:e,fill:i===0?0:r/i}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class oO{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Qp(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>Qr.fromNumberOfRows(this.sheet,e[0],e[1]))}}class aO{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Zp(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>Qr.fromNumberOfRows(this.sheet,e[0],e[1]))}}class lO{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Zp(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>ci.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class uO{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Qp(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>ci.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class Gle{constructor(e,t,r,i,s,o,a,l,u){this.dependencyGraph=t,this.columnSearch=r,this.cellContentParser=i,this.parser=s,this.stats=o,this.lazilyTransformingAstService=a,this.namedExpressions=l,this.arraySizePredictor=u,this.changes=na.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const t=[];for(const r of e.rowsSpans()){const i=this.doRemoveRows(r);i&&t.push(i)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){const t=[];for(const r of e.columnsSpans()){const i=this.doRemoveColumns(r);i&&t.push(i)}return t}removeSheet(e){this.dependencyGraph.removeSheet(e);let t;this.stats.measure(Ze.TRANSFORM_ASTS,()=>{const i=new Wle(e);i.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(i)}),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const r=this.namedExpressions.getAllNamedExpressionsForScope(e).map(i=>this.removeNamedExpression(i.normalizeExpressionName(),e));return{version:t,scopedNamedExpressions:r}}removeSheetByName(e){const t=this.sheetMapping.fetch(e);return this.removeSheet(t)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const t=this.sheetMapping.addSheet(e),r=[];return this.dependencyGraph.addressMapping.autoAddSheet(t,Xp(r)),this.sheetMapping.fetchDisplayName(t)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,r,i){const s=Qr.fromNumberOfRows(e,i,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(s),i<t&&(t+=r);const o=Pe(e,0,t),a=Pe(e,0,i);this.moveCells(o,Number.POSITIVE_INFINITY,r,a);const l=Qr.fromNumberOfRows(e,t,r);return this.doRemoveRows(l),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,r,i){const s=ci.fromNumberOfColumns(e,i,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(s),i<t&&(t+=r);const o=Pe(e,t,0),a=Pe(e,i,0);this.moveCells(o,r,Number.POSITIVE_INFINITY,a);const l=ci.fromNumberOfColumns(e,t,r);return this.doRemoveColumns(l),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,r,i){this.ensureItIsPossibleToMoveCells(e,t,r,i);const s=We.spanFrom(e,t,r),o=We.spanFrom(i,t,r),a=i.col-e.col,l=i.row-e.row,u=i.sheet,c=this.getRangeClipboardCells(o),h=this.dependencyGraph.rawValuesFromRange(o);this.columnSearch.removeValues(h);const d=this.dependencyGraph.rawValuesFromRange(s);this.columnSearch.moveValues(d,a,l,u);let f;this.stats.measure(Ze.TRANSFORM_ASTS,()=>{const p=new Ble(s,a,l,u);p.performEagerTransformations(this.dependencyGraph,this.parser),f=this.lazilyTransformingAstService.addTransformation(p)}),this.dependencyGraph.moveCells(s,a,l,u);const m=this.updateNamedExpressionsForMovedCells(e,t,r,i);return{version:f,overwrittenCellsData:c,addedGlobalNamedExpressions:m}}setRowOrder(e,t){const r=[];let i=[];for(const[s,o]of t)if(s!==o){const a=We.spanFrom({sheet:e,col:0,row:s},1/0,1),l=this.getRangeClipboardCells(a);i=i.concat(l),r.push(l.map(([{sheet:u,col:c},h])=>[{sheet:u,col:c,row:o},h]))}return r.forEach(s=>this.restoreClipboardCells(e,s.values())),i}setColumnOrder(e,t){const r=[];let i=[];for(const[s,o]of t)if(s!==o){const a=We.spanFrom({sheet:e,col:s,row:0},1,1/0),l=this.getRangeClipboardCells(a);i=i.concat(l),r.push(l.map(([{sheet:u,col:c,row:h},d])=>[{sheet:u,col:o,row:h},d]))}return r.forEach(s=>this.restoreClipboardCells(e,s.values())),i}addNamedExpression(e,t,r,i){const s=this.namedExpressions.addNamedExpression(e,r,i);this.storeNamedExpressionInCell(s.address,t),this.adjustNamedExpressionEdges(s,e,r)}restoreNamedExpression(e,t,r){const i=e.displayName;this.restoreCell(e.address,t);const s=this.namedExpressions.restoreNamedExpression(e,r);this.adjustNamedExpressionEdges(s,i,r)}changeNamedExpressionExpression(e,t,r,i){const s=this.namedExpressions.namedExpressionForScope(e,r);if(!s)throw new ld(e);const o=s.copy();s.options=i;const a=this.getClipboardCell(s.address);return this.storeNamedExpressionInCell(s.address,t),[o,a]}removeNamedExpression(e,t){const r=this.namedExpressions.namedExpressionForScope(e,t);if(!r)throw new ld(e);this.namedExpressions.remove(r.displayName,t);const i=this.getClipboardCell(r.address);if(t!==void 0){const s=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(r.address,s.address)}else this.dependencyGraph.setCellEmpty(r.address);return[r,i]}ensureItIsPossibleToMoveCells(e,t,r,i){if(qr(e)||!(Jp(t)&&Jp(r)||zle(e,t,r))||qr(i)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(i.sheet))throw new kn("a valid range of cells to move.");const s=We.spanFrom(e,t,r),o=We.spanFrom(i,t,r);if(o.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new nl;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new Mu;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new Gp}restoreClipboardCells(e,t){const r=[];for(const[i,s]of t)if(this.restoreCell(i,s),s.type===ur.FORMULA){const{dependencies:o}=this.parser.fetchCachedResult(s.hash);r.push(...this.updateNamedExpressionsForTargetAddress(e,i,o))}return r}restoreCell(e,t){switch(t.type){case ur.VALUE:{this.setValueToCell(t,e);break}case ur.FORMULA:{this.setFormulaToCellFromCache(t.hash,e);break}case ur.EMPTY:{this.setCellEmpty(e);break}case ur.PARSING_ERROR:{this.setParsingErrorToCell(t.rawInput,t.errors,e);break}}}getOldContent(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof Wo)return[e,{type:ur.EMPTY}];if(t instanceof ra)return[e,Object.assign({type:ur.VALUE},t.getValues())];if(t instanceof hi)return[t.getAddress(this.lazilyTransformingAstService),{type:ur.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof ku)return[e,{type:ur.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof Wo)return{type:ur.EMPTY};if(t instanceof ra)return Object.assign({type:ur.VALUE},t.getValues());if(t instanceof En){const r=t.getArrayCellValue(e);return r===ht?{type:ur.EMPTY}:{type:ur.VALUE,parsedValue:r,rawValue:t.getArrayCellRawValue(e)}}else{if(t instanceof Is)return{type:ur.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof ku)return{type:ur.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}}throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const t=this.dependencyGraph.getSheetHeight(e),r=this.dependencyGraph.getSheetWidth(e),i=new Array(t);for(let s=0;s<t;s++){i[s]=new Array(r);for(let o=0;o<r;o++){const a=Pe(e,o,s);i[s][o]=this.getClipboardCell(a)}}return i}getRangeClipboardCells(e){const t=[];for(const r of e.addresses(this.dependencyGraph))t.push([r,this.getClipboardCell(r)]);return t}setCellContent(e,t){const r=this.cellContentParser.parse(t),i=this.getOldContent(e);if(r instanceof tn.Formula){const s=this.parser.parse(r.formula,e),{ast:o,errors:a}=s;if(a.length>0)this.setParsingErrorToCell(r.formula,a,e);else{const l=this.arraySizePredictor.checkArraySize(o,e);this.setFormulaToCell(e,l,s)}}else r instanceof tn.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e);return i}setSheetContent(e,t){this.clearSheet(e);for(let r=0;r<t.length;r++)for(let i=0;i<t[r].length;i++){const s=Pe(e,i,r);this.setCellContent(s,t[r][i])}}setParsingErrorToCell(e,t,r){const i=this.dependencyGraph.getCellValue(r),s=new ku(t,e),o=this.dependencyGraph.setParsingErrorToCell(r,s);this.columnSearch.remove(Le(i),r),this.columnSearch.applyChanges(o.getChanges()),this.changes.addAll(o),this.changes.addChange(s.getCellValue(),r)}setFormulaToCell(e,t,{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}){const a=this.dependencyGraph.getCellValue(e),l=this.dependencyGraph.setFormulaToCell(e,r,As(o,e),t,i,s);this.columnSearch.remove(Le(a),e),this.columnSearch.applyChanges(l.getChanges()),this.changes.addAll(l)}setValueToCell(e,t){const r=this.dependencyGraph.getCellValue(t),i=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change(Le(r),Le(e.parsedValue),t),this.columnSearch.applyChanges(i.getChanges().filter(s=>!cd(s.address,t))),this.changes.addAll(i),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const t=this.dependencyGraph.getCellValue(e),r=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(Le(t),e),this.columnSearch.applyChanges(r.getChanges()),this.changes.addAll(r),this.changes.addChange(ht,e)}setFormulaToCellFromCache(e,t){const{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}=this.parser.fetchCachedResult(e),a=As(o,t),[l]=new Ule(t.sheet).transformSingleAst(r,t);this.parser.rememberNewAst(l);const u=gae(a),c=this.arraySizePredictor.checkArraySize(r,t);this.dependencyGraph.setFormulaToCell(t,l,u,c,i,s)}rowEffectivelyNotInSheet(e,t){const r=this.dependencyGraph.addressMapping.getHeight(t);return e>=r}getAndClearContentChanges(){const e=this.changes;return this.changes=na.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromRowsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:r,contentChanges:i}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(i.getChanges());let s;return this.stats.measure(Ze.TRANSFORM_ASTS,()=>{const o=new Ow(e);o.performEagerTransformations(this.dependencyGraph,this.parser),s=this.lazilyTransformingAstService.addTransformation(o)}),this.rewriteAffectedArrays(r),{version:s,removedCells:t,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromColumnsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:r,contentChanges:i}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(i.getChanges()),this.columnSearch.removeColumns(e);let s;return this.stats.measure(Ze.TRANSFORM_ASTS,()=>{const o=new $le(e);o.performEagerTransformations(this.dependencyGraph,this.parser),s=this.lazilyTransformingAstService.addTransformation(o)}),this.rewriteAffectedArrays(r),{version:s,removedCells:t,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:t}=this.dependencyGraph.addRows(e);this.stats.measure(Ze.TRANSFORM_ASTS,()=>{const r=new Iw(e);r.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(r)}),this.rewriteAffectedArrays(t)}rewriteAffectedArrays(e){for(const t of e.values()){if(t.array.size.isRef)continue;const r=t.getFormula(this.lazilyTransformingAstService),i=t.getAddress(this.lazilyTransformingAstService),s=this.parser.computeHashFromAst(r);this.setFormulaToCellFromCache(s,i)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:t,contentChanges:r}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(r.getChanges()),this.stats.measure(Ze.TRANSFORM_ASTS,()=>{const i=new Hle(e);i.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(i)}),this.rewriteAffectedArrays(t)}columnEffectivelyNotInSheet(e,t){const r=this.dependencyGraph.addressMapping.getWidth(t);return e>=r}adjustNamedExpressionEdges(e,t,r){if(r===void 0)return;const{vertex:i,id:s}=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),o=s!=null?s:this.dependencyGraph.graph.getNodeId(i),a=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),{vertex:l,id:u}=this.dependencyGraph.fetchCellOrCreateEmpty(a.address),c=u!=null?u:this.dependencyGraph.graph.getNodeId(l);for(const h of this.dependencyGraph.graph.adjacentNodes(l))if(h instanceof Is&&h.getAddress(this.lazilyTransformingAstService).sheet===r){const d=h.getFormula(this.lazilyTransformingAstService),f=h.getAddress(this.lazilyTransformingAstService),{dependencies:m}=this.parser.fetchCachedResultForAst(d);for(const p of As(m,f))p instanceof Ko&&p.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(c,h),this.dependencyGraph.graph.addEdge(o,h))}}storeNamedExpressionInCell(e,t){const r=this.cellContentParser.parse(t);if(r instanceof tn.Formula){const i=this.parser.parse(r.formula,Pe(-1,0,0));if(Bo(i.ast))throw new lb;const{ast:s,hasVolatileFunction:o,hasStructuralChangeFunction:a,dependencies:l}=i;this.dependencyGraph.setFormulaToCell(e,s,As(l,e),lt.scalar(),o,a)}else r instanceof tn.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,r,i){if(e.sheet===i.sheet)return[];const s=[],o=We.spanFrom(i,t,r);for(const a of o.addresses(this.dependencyGraph)){const l=this.addressMapping.fetchCell(a);if(l instanceof Is&&a.sheet!==e.sheet){const u=l.getFormula(this.lazilyTransformingAstService),{dependencies:c}=this.parser.fetchCachedResultForAst(u);s.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,a,c))}}return s}updateNamedExpressionsForTargetAddress(e,t,r){if(e===t.sheet)return[];const i=[],s=this.addressMapping.fetchCell(t);for(const o of As(r,t)){if(!(o instanceof Ko))continue;const a=o.name,l=this.dependencyGraph.fetchNamedExpressionVertex(a,e).vertex,c=this.namedExpressions.isExpressionInScope(a,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(a,t.sheet).vertex:this.copyOrFetchGlobalNamedExpressionVertex(a,l,i);c!==l&&(this.dependencyGraph.graph.removeEdgeIfExists(l,s),this.dependencyGraph.graph.addEdge(c,s))}return i}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(ml.SHEET_FOR_WORKBOOK_EXPRESSIONS,new kae(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,r){let i=this.namedExpressions.namedExpressionForScope(e);if(i===void 0)if(i=this.namedExpressions.addNamedExpression(e),r.push(i.normalizeExpressionName()),t instanceof Is){const s=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:l,dependencies:u}=s;this.dependencyGraph.setFormulaToCell(i.address,o,As(u,i.address),lt.scalar(),a,l)}else t instanceof Wo?this.setCellEmpty(i.address):t instanceof ra&&this.setValueToCell(t.getValues(),i.address);return this.dependencyGraph.fetchCellOrCreateEmpty(i.address).vertex}}function Qp(n){if(n.length<=1)return n;const e=[...n].sort(([i],[s])=>i-s),t=e.reduce((i,[s,o])=>{const a=i[i.length-1],l=a[0]+a[1];return s<=l?a[1]+=Math.max(0,o-(l-s)):i.push([s,o]),i},[e[0]]);let r=0;for(let i=0;i<t.length;++i)t[i][0]-=r,r+=t[i][1];return t}function Zp(n){if(n.length<=1)return n;const e=[...n].sort(([i],[s])=>i-s),t=e.reduce((i,[s,o])=>{const a=i[i.length-1];return s===a[0]?a[1]=Math.max(a[1],o):i.push([s,o]),i},[e[0]]);let r=0;for(let i=0;i<t.length;++i)t[i][0]+=r,r+=t[i][1];return t}function Jp(n){return Number.isInteger(n)&&n>0}function zle(n,e,t){return n.row===0&&Jp(e)&&t===Number.POSITIVE_INFINITY||n.col===0&&Jp(t)&&e===Number.POSITIVE_INFINITY}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Bn{}class Yle extends Bn{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class jle extends Bn{constructor(e,t,r,i,s,o,a){super(),this.sourceLeftCorner=e,this.width=t,this.height=r,this.destinationLeftCorner=i,this.overwrittenCellsData=s,this.addedGlobalNamedExpressions=o,this.version=a}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class Kle extends Bn{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class qle extends Bn{constructor(e,t,r){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=r}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class Xle extends Bn{constructor(e,t,r){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=r}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class Qle extends Bn{constructor(e,t,r){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=r}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class Zle extends Bn{constructor(e,t,r,i,s){super(),this.sheet=e,this.startRow=t,this.numberOfRows=r,this.targetRow=i,this.version=s,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class Jle extends Bn{constructor(e,t,r,i,s){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=r,this.targetColumn=i,this.version=s,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class eue extends Bn{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class tue extends Bn{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class nue extends Bn{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class rue extends Bn{constructor(e,t,r,i,s){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=r,this.scopedNamedExpressions=i,this.version=s}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class iue extends Bn{constructor(e,t,r){super(),this.sheetId=e,this.oldName=t,this.newName=r}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class sue extends Bn{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class oue extends Bn{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class aue extends Bn{constructor(e,t,r,i){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=r,this.addedGlobalNamedExpressions=i}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class lue extends Bn{constructor(e,t,r,i){super(),this.name=e,this.newContent=t,this.scope=r,this.options=i}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class uue extends Bn{constructor(e,t,r){super(),this.namedExpression=e,this.content=t,this.scope=r}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class cue extends Bn{constructor(e,t,r,i,s){super(),this.namedExpression=e,this.newContent=t,this.oldContent=r,this.scope=i,this.options=s}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class hue extends Bn{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class due{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){this.batchUndoEntry!==void 0?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new hue}commitBatchMode(){if(this.batchUndoEntry===void 0)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,r){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,r])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return this.undoStack.length===0}isRedoStackEmpty(){return this.redoStack.length===0}undo(){const e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},rowsRemovals:r}=e;for(let i=r.length-1;i>=0;--i){const s=r[i];this.operations.addRows(new aO(t,[[s.rowFrom,s.rowCount]]));for(const{address:o,cellType:a}of s.removedCells)this.operations.restoreCell(o,a);this.restoreOldDataFromVersion(s.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},columnsRemovals:r}=e;for(let i=r.length-1;i>=0;--i){const s=r[i];this.operations.addColumns(new lO(t,[[s.columnFrom,s.columnCount]]));for(const{address:o,cellType:a}of s.removedCells)this.operations.restoreCell(o,a);this.restoreOldDataFromVersion(s.version-1)}}undoAddRows(e){const t=e.command.rowsSpans();for(let r=t.length-1;r>=0;--r){const i=t[r];this.operations.removeRows(new oO(e.command.sheet,[[i.rowStart,i.numberOfRows]]))}}undoAddColumns(e){const t=e.command.columnsSpans();for(let r=t.length-1;r>=0;--r){const i=t[r];this.operations.removeColumns(new uO(e.command.sheet,[[i.columnStart,i.numberOfColumns]]))}}undoSetCellContents(e){for(const t of e.cellContents){const r=t.address,[i,s]=t.oldContent;cd(r,i)||this.operations.setCellEmpty(r),this.operations.restoreCell(i,s)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){const{sheet:t}=e;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:t}=e;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){const{sheetName:t}=e;this.operations.removeSheetByName(t)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:t,sheetId:r}=e;this.operations.addSheet(e.sheetName);for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=Pe(r,o,i);this.operations.restoreCell(l,a)}}for(const[i,s]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(i,s,r);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:t,sheetId:r}=e;for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=Pe(r,o,i);this.operations.restoreCell(l,a)}}}undoSetSheetContent(e){const{oldSheetContent:t,sheetId:r}=e;this.operations.clearSheet(r);for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=Pe(r,o,i);this.operations.restoreCell(l,a)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:t,newContent:r}=e,i=r.length,s=r[0].length;for(let o=0;o<i;++o)for(let a=0;a<s;++a){const l=Pe(t.sheet,t.col+a,t.row+o);this.operations.restoreCell(l,r[o][a])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:t,newSheetContent:r}=e;this.operations.setSheetContent(t,r)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[t,r]of e)this.operations.restoreCell(t,r)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const t=this.oldData.get(e)||[];for(const r of t){const[i,s]=r;this.operations.setFormulaToCellFromCache(s,i)}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class fue{constructor(e,t,r,i,s,o,a,l,u,c){this.operations=t,this.undoRedo=r,this.clipboardOperations=i,this.dependencyGraph=s,this.columnSearch=o,this.parser=a,this.cellContentParser=l,this.lazilyTransformingAstService=u,this.namedExpressions=c,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){const r=new aO(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(r),this.undoRedo.saveOperation(new Kle(r))}removeRows(e,...t){const r=new oO(e,t);this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeRows(r);this.undoRedo.saveOperation(new Yle(r,i))}addColumns(e,...t){const r=new lO(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(r),this.undoRedo.saveOperation(new eue(r))}removeColumns(e,...t){const r=new uO(e,t);this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeColumns(r);this.undoRedo.saveOperation(new tue(r,i))}moveCells(e,t,r,i){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:s,overwrittenCellsData:o,addedGlobalNamedExpressions:a}=this.operations.moveCells(e,t,r,i);this.undoRedo.saveOperation(new jle(e,t,r,i,o,a,s))}moveRows(e,t,r,i){this.ensureItIsPossibleToMoveRows(e,t,r,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const s=this.operations.moveRows(e,t,r,i);this.undoRedo.saveOperation(new Zle(e,t,r,i,s))}moveColumns(e,t,r,i){this.ensureItIsPossibleToMoveColumns(e,t,r,i),this.undoRedo.clearRedoStack();const s=this.operations.moveColumns(e,t,r,i);this.undoRedo.saveOperation(new Jle(e,t,r,i,s))}cut(e,t,r){this.clipboardOperations.cut(e,t,r)}ensureItIsPossibleToCopy(e,t,r){if(!au(t))throw new kn("width to be positive integer.");if(!au(r))throw new kn("height to be positive integer.")}copy(e,t,r){this.ensureItIsPossibleToCopy(e,t,r),this.clipboardOperations.copy(e,t,r)}paste(e){const t=this.clipboardOperations.clipboard;if(t===void 0)throw new kI;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const r=We.spanFrom(e,t.width,t.height),i=this.operations.getRangeClipboardCells(r);this.undoRedo.clearRedoStack();const s=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new aue(e,i,t.content,s))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return this.clipboardOperations.clipboard===void 0}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){e!==void 0&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new nue(t)),t}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.sheetMapping.fetchDisplayName(e),r=this.operations.getSheetClipboardCells(e),{version:i,scopedNamedExpressions:s}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new rue(t,e,r,s,i))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);const r=this.operations.renameSheet(e,t);return r!==void 0&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new iue(e,r,t))),r}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new sue(e,t))}setCellContents(e,t){if(!(t instanceof Array))t=[[t]];else for(let i=0;i<t.length;i++)if(!(t[i]instanceof Array))throw new kn("an array of arrays or a raw cell value.");this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();const r=[];for(let i=0;i<t.length;i++)for(let s=0;s<t[i].length;s++){const o={sheet:e.sheet,row:e.row+i,col:e.col+s},a=t[i][s];this.clipboardOperations.abortCut();const l=this.operations.setCellContent(o,a);r.push({address:o,newContent:a,oldContent:l})}this.undoRedo.saveOperation(new oue(r))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),sO(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new Qle(e,r,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new qle(e,t,r))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new an(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(const[r,i]of t)if(r!==i){const s=We.spanFrom({sheet:e,col:r,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new Mu}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new Xle(e,t,r))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new an(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(const[r,i]of t)if(r!==i){const s=We.spanFrom({sheet:e,col:0,row:r},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new Mu}}mappingFromOrder(e,t,r){if(!this.sheetMapping.hasSheetWithId(e))throw new an(e);const i=r==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==i)throw new kn(`number of ${r}s provided to be sheet ${r==="row"?"height":"width"}.`);const s=[];for(let o=0;o<i;o++)t[o]!==o&&s.push([o,t[o]]);return s}undo(){if(this.undoRedo.isUndoStackEmpty())throw new PI;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new DI;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,r,i){this.ensureItIsPossibleToAddNamedExpression(e,t,r),this.operations.addNamedExpression(e,t,r,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new lue(e,t,r,i))}changeNamedExpressionExpression(e,t,r,i){this.ensureItIsPossibleToChangeNamedExpression(e,r,t);const[s,o]=this.operations.changeNamedExpressionExpression(e,r,t,i);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new cue(s,r,o,t,i))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);const[r,i]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new uue(r,i,t)),r}ensureItIsPossibleToAddNamedExpression(e,t,r){this.ensureScopeIdIsValid(r),this.ensureNamedExpressionNameIsValid(e,r),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,r){if(this.ensureScopeIdIsValid(r),this.namedExpressions.namedExpressionForScope(e,r)===void 0)throw new ld(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),this.namedExpressions.namedExpressionForScope(e,t)===void 0)throw new ld(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new an(e);const r=this.dependencyGraph.getSheetHeight(e),i=t.map(s=>s[1]).reduce((s,o)=>s+o,0);if(r+i>this.maxRows)throw new nl;for(const[s,o]of t)if(!Pa(s)||!au(o))throw new kn("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(const[r,i]of t){const s=r+i-1;if(!Pa(r)||!Pa(s))throw new kn("starting and ending row to be nonnegative.");if(s<r)throw new kn("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new an(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new an(e);const r=this.dependencyGraph.getSheetWidth(e),i=t.map(s=>s[1]).reduce((s,o)=>s+o,0);if(r+i>this.maxColumns)throw new nl;for(const[s,o]of t)if(!Pa(s)||!au(o))throw new kn("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(const[r,i]of t){const s=r+i-1;if(!Pa(r)||!Pa(s))throw new kn("starting and ending column to be nonnegative.");if(s<r)throw new kn("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new an(e)}}ensureItIsPossibleToMoveRows(e,t,r,i){this.ensureItIsPossibleToAddRows(e,[i,r]);const s=Pe(e,0,t),o=Pe(e,0,i);if(!this.sheetMapping.hasSheetWithId(e)||qr(s)||qr(o)||!au(r)||i<=t+r&&i>=t)throw new kn("a valid range of rows to move.");const a=this.dependencyGraph.getSheetWidth(e),l=We.spanFrom(s,a,r);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new Mu;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(Qr.fromNumberOfRows(e,i-1,2)))throw new Gp}ensureItIsPossibleToMoveColumns(e,t,r,i){this.ensureItIsPossibleToAddColumns(e,[i,r]);const s=Pe(e,t,0),o=Pe(e,i,0);if(!this.sheetMapping.hasSheetWithId(e)||qr(s)||qr(o)||!au(r)||i<=t+r&&i>=t)throw new kn("a valid range of columns to move.");const a=this.dependencyGraph.getSheetHeight(e),l=We.spanFrom(s,r,a);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new Mu;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(ci.fromNumberOfColumns(e,i-1,2)))throw new Gp}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new od(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new an(e);const r=this.sheetMapping.get(t);if(r!==void 0&&r!==e)throw new od(t)}ensureItIsPossibleToChangeContent(e){if(qr(e))throw new OI(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new an(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){const r=Xp(t),i=We.spanFrom(e,r.width,r.height);this.ensureRangeInSizeLimits(i);for(const s of i.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(s)}ensureItIsPossibleToChangeSheetContents(e,t){const r=Xp(t),i=We.spanFrom(Pe(e,0,0),r.width,r.height);this.ensureRangeInSizeLimits(i)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new nl}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(e!==void 0&&!this.sheetMapping.hasSheetWithId(e))throw new an(e)}validateRowOrColumnMapping(e,t,r){const i=r==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),s=t.map(([a,l])=>a).sort((a,l)=>a-l),o=t.map(([a,l])=>l).sort((a,l)=>a-l);for(let a=0;a<s.length;a++){if(!Pa(s[a])||s[a]>=i)throw new kn(`${r} numbers to be nonnegative integers and less than sheet ${r==="row"?"height":"width"}.`);if(s[a]===s[a+1])throw new kn(`source ${r} numbers to be unique.`);if(s[a]!==o[a])throw new kn(`target ${r} numbers to be permutation of source ${r} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new LI(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new _I(e)}ensureNamedExpressionIsValid(e){const t=this.cellContentParser.parse(e);if(t instanceof tn.Formula){const r=this.parser.parse(t.formula,Pe(-1,0,0));if(Bo(r.ast))throw new lb}}}function au(n){return Number.isInteger(n)&&n>0}function Pa(n){return Number.isInteger(n)&&n>=0}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class mue{constructor(e,t,r,i,s,o){this.config=e,this.stats=t,this.interpreter=r,this.lazilyTransformingAstService=i,this.dependencyGraph=s,this.columnSearch=o}run(){this.stats.start(Ze.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(Ze.TOP_SORT),this.stats.measure(Ze.EVALUATION,()=>{this.recomputeFormulas(t,e)})}partialRun(e){const t=na.empty();return this.stats.measure(Ze.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,r=>{if(r instanceof hi){const i=r.isComputed()?r.getCellValue():void 0,s=this.recomputeFormulaVertexValue(r);if(s!==i){const o=r.getAddress(this.lazilyTransformingAstService);return t.addChange(s,o),this.columnSearch.change(Le(i),Le(s),o),!0}return!1}else return r instanceof vr&&r.clearCache(),!0},r=>{if(r instanceof vr)r.clearCache();else if(r instanceof hi){const i=r.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(Le(r.valueOrUndef()),i);const s=new D($.CYCLE,void 0,r);r.setCellValue(s),t.addChange(s,i)}})}),t}runAndForget(e,t,r){const i=[];for(const o of As(r,t))if(o instanceof We){const a=o;if(this.dependencyGraph.getRange(a.start,a.end)===void 0){const l=new vr(a);this.dependencyGraph.rangeMapping.setRange(l),i.push(l)}}const s=this.evaluateAstToCellValue(e,new Ls(t,this.config.useArrayArithmetic));return i.forEach(o=>{this.dependencyGraph.rangeMapping.removeRange(o)}),s}recomputeFormulas(e,t){e.forEach(r=>{r instanceof hi&&r.setCellValue(new D($.CYCLE,void 0,r))}),t.forEach(r=>{if(r instanceof hi){const i=this.recomputeFormulaVertexValue(r),s=r.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(Le(i),s)}else r instanceof vr&&r.clearCache()})}recomputeFormulaVertexValue(e){const t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof En&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const r=e.getFormula(this.lazilyTransformingAstService),i=this.evaluateAstToCellValue(r,new Ls(t,this.config.useArrayArithmetic,e));return e.setCellValue(i)}}evaluateAstToCellValue(e,t){const r=this.interpreter.evaluateAst(e,t);return r instanceof Be?r:r===ht&&this.config.evaluateNullToZero?0:r}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class _w{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class cO{constructor(e,t){this.name=e,this.newValue=t}}class pue{constructor(e,t,r,i){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=r,this.lazilyTransformingService=i}exportChange(e){const t=e.value,r=e.address;if(r.sheet===ml.SHEET_FOR_WORKBOOK_EXPRESSIONS){const i=this.namedExpressions.namedExpressionInAddress(r.row);if(!i)throw new Error("Missing named expression");return new cO(i.displayName,this.exportScalarOrRange(t))}else if(t instanceof Be){const i=[];for(const[s,o]of t.entriesFromTopLeftCorner(r))i.push(new _w(o,this.exportValue(s)));return i}else return new _w(r,this.exportValue(t))}exportValue(e){return e instanceof Be?this.detailedError(new D($.VALUE,Q.ScalarExpected)):this.config.smartRounding&&At(e)?this.cellValueRounding(Le(e)):e instanceof D?this.detailedError(e):e===ht?null:Le(e)}exportScalarOrRange(e){return e instanceof Be?e.rawData().map(t=>t.map(r=>this.exportValue(r))):this.exportValue(e)}detailedError(e){var t,r;let i;const s=(t=e.root)===null||t===void 0?void 0:t.getAddress(this.lazilyTransformingService);return s!==void 0&&(s.sheet===ml.SHEET_FOR_WORKBOOK_EXPRESSIONS?i=(r=this.namedExpressions.namedExpressionInAddress(s.row))===null||r===void 0?void 0:r.displayName:i=Op(this.sheetIndexMapping,s,-1)),new ZI(e,this.config.translationPackage.getErrorTranslation(e.type),i)}cellValueRounding(e){if(e===0)return e;const t=Math.floor(Math.log10(Math.abs(e))),r=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class gue{constructor(e,t,r,i,s,o){this.dependencyGraph=e,this.columnSearch=t,this.parser=r,this.cellContentParser=i,this.stats=s,this.arraySizePredictor=o,this.buildStrategy=new yue(e,t,r,s,i,o)}buildGraph(e,t){const r=t.measure(Ze.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),t.measure(Ze.PROCESS_DEPENDENCIES,()=>this.processDependencies(r))}processDependencies(e){e.forEach((t,r)=>{this.dependencyGraph.processCellDependencies(t,r)})}}class yue{constructor(e,t,r,i,s,o){this.dependencyGraph=e,this.columnIndex=t,this.parser=r,this.stats=i,this.cellContentParser=s,this.arraySizePredictor=o}run(e){const t=new Map;for(const r in e){const i=this.dependencyGraph.getSheetId(r),s=e[r];for(let o=0;o<s.length;++o){const a=s[o];for(let l=0;l<a.length;++l){const u=a[l],c=Pe(i,l,o),h=this.cellContentParser.parse(u);if(h instanceof tn.Formula){const d=this.stats.measure(Ze.PARSER,()=>this.parser.parse(h.formula,c));if(d.errors.length>0){this.shrinkArrayIfNeeded(c);const f=new ku(d.errors,h.formula);this.dependencyGraph.addVertex(c,f)}else{this.shrinkArrayIfNeeded(c);const f=this.arraySizePredictor.checkArraySize(d.ast,c);if(f.isScalar()){const m=new Is(d.ast,c,0);t.set(m,As(d.dependencies,c)),this.dependencyGraph.addVertex(c,m),d.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(m),d.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(m)}else{const m=new En(d.ast,c,new lt(f.width,f.height));t.set(m,As(d.dependencies,c)),this.dependencyGraph.addArrayVertex(c,m)}}}else if(!(h instanceof tn.Empty)){this.shrinkArrayIfNeeded(c);const d=new ra(h.value,u);this.columnIndex.add(Le(h.value),c),this.dependencyGraph.addVertex(c,d)}}}}return t}shrinkArrayIfNeeded(e){const t=this.dependencyGraph.getCell(e);t instanceof En&&this.dependencyGraph.shrinkArrayToCorner(t)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const rm=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class hO extends nt{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),()=>{const{licenseKeyValidityState:r,licenseKey:i}=this.config;let s;return rm.has(i)?s=rm.get(i):rm.has(r)?s=rm.get(r):r==="valid"&&(s=i.slice(-5)),`HyperFormula v${gr.version}, ${s}`})}}hO.implementedFunctions={VERSION:{method:"version",parameters:[]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function H6(n,e){var t;let r=e.implementedFunctions[n];const i=(t=e.aliases)===null||t===void 0?void 0:t[n];if(i!==void 0){if(r!==void 0)throw new bae(n,e.name);r=e.implementedFunctions[i]}if(r===void 0)throw ec.functionNotDeclaredInPlugin(n,e.name);return r}class Wn{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=t=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(t),this.isFunctionVolatile=t=>this.volatileFunctions.has(t),this.isArrayFunction=t=>this.arrayFunctions.has(t),this.isFunctionDependentOnSheetStructureChange=t=>this.structuralChangeFunctions.has(t),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const t of e.functionPlugins)Wn.loadPluginFunctions(t,this.instancePlugins)}else this.instancePlugins=new Map(Wn.plugins);for(const[t,r]of Wn.protectedFunctions())Wn.loadFunctionUnprotected(r,t,this.instancePlugins);for(const[t,r]of this.instancePlugins.entries())this.categorizeFunction(t,H6(t,r))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),t!==void 0&&this.loadTranslations(t)}static registerFunction(e,t,r){this.loadPluginFunction(t,e,this.plugins),r!==void 0&&this.loadTranslations(r)}static unregisterFunction(e){if(this.functionIsProtected(e))throw rl.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const t of this.protectedPlugins())if(t===e)throw rl.cannotUnregisterProtectedPlugin();for(const[t,r]of this.plugins.entries())r===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const t=new Set(gr.getRegisteredLanguagesCodes());Object.keys(e).forEach(r=>{t.has(r)&&gr.getLanguage(r).extendFunctions(e[r])})}static loadPluginFunctions(e,t){Object.keys(e.implementedFunctions).forEach(r=>{this.loadPluginFunction(e,r,t)}),e.aliases!==void 0&&Object.keys(e.aliases).forEach(r=>{this.loadPluginFunction(e,r,t)})}static loadPluginFunction(e,t,r){if(this.functionIsProtected(t))throw rl.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,r)}static loadFunctionUnprotected(e,t,r){const i=H6(t,e).method;if(Object.prototype.hasOwnProperty.call(e.prototype,i))r.set(t,e);else throw ec.functionMethodNotFound(i,e.name)}static*protectedFunctions(){for(const[e,t]of this._protectedPlugins)t!==void 0&&(yield[e,t])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)e!==void 0&&(yield e)}initializePlugins(e){const t=[];for(const[r,i]of this.instancePlugins.entries()){let s=t.find(u=>u instanceof i);s===void 0&&(s=new i(e),t.push(s));const o=H6(r,i),a=o.method;this.functions.set(r,[a,s]);const l=o.arraySizeMethod;l!==void 0&&this.arraySizeFunctions.set(r,[l,s])}}getFunctionPlugin(e){if(!Wn.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const t=this.functions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[r,i]=t;return(s,o)=>i[r](s,o)}else return}getArraySizeFunction(e){const t=this.arraySizeFunctions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[r,i]=t;return(s,o)=>i[r](s,o)}else return}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[t,r]of this.instancePlugins)Wn.functionIsProtected(t)||e.add(r);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}Wn.plugins=new Map;Wn._protectedPlugins=new Map([["VERSION",hO],["OFFSET",void 0]]);/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var Jn;(function(n){n.GREATER_THAN="GREATER_THAN",n.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",n.LESS_THAN="LESS_THAN",n.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",n.NOT_EQUAL="NOT_EQUAL",n.EQUAL="EQUAL"})(Jn||(Jn={}));const im=(n,e)=>({operator:n,value:e});class wue{constructor(e){var t,r,i,s;this.trueString=(r=(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))===null||t===void 0?void 0:t.toLowerCase())!==null&&r!==void 0?r:"true",this.falseString=(s=(i=e.translationPackage.getMaybeFunctionTranslation("FALSE"))===null||i===void 0?void 0:i.toLowerCase())!==null&&s!==void 0?s:"false"}fromCellValue(e,t){if(typeof e!="string"&&typeof e!="boolean"&&typeof e!="number")return;const r=this.parseCriterion(e,t);if(r!==void 0)return{raw:e,lambda:Eue(r,t)}}parseCriterion(e,t){if(typeof e=="number"||typeof e=="boolean")return im(Jn.EQUAL,e);if(typeof e=="string"){const r=vue.exec(e);let i,s;r?(s=Cue(r[1]),i=r[2]):(s=Jn.EQUAL,i=e);const o=t.coerceToMaybeNumber(i),a=i.toLowerCase()===this.trueString?!0:i.toLowerCase()===this.falseString?!1:void 0;if(s===void 0)return;if(i==="")return im(s,null);if(o===void 0){if(s===Jn.EQUAL||s===Jn.NOT_EQUAL)return im(s,a!=null?a:i)}else return im(s,Le(o))}}}const vue=/([<>=]+)(.*)/;function Cue(n){switch(n){case">":return Jn.GREATER_THAN;case">=":return Jn.GREATER_THAN_OR_EQUAL;case"<":return Jn.LESS_THAN;case"<=":return Jn.LESS_THAN_OR_EQUAL;case"<>":return Jn.NOT_EQUAL;case"=":return Jn.EQUAL;default:return}}const Eue=(n,e)=>{switch(n.operator){case Jn.GREATER_THAN:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)>0:t=>!1;case Jn.GREATER_THAN_OR_EQUAL:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)>=0:t=>!1;case Jn.LESS_THAN:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)<0:t=>!1;case Jn.LESS_THAN_OR_EQUAL:return typeof n.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,n.value)<=0:t=>!1;case Jn.EQUAL:return typeof n.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,n.value)===0;if(typeof t=="string"){if(t==="")return!1;const r=e.coerceToMaybeNumber(t);return r===void 0?!1:e.floatCmp(r,n.value)===0}else return!1}:typeof n.value=="string"?e.eqMatcherFunction(n.value):typeof n.value=="boolean"?t=>typeof t=="boolean"&&t===n.value:t=>t===ht;case Jn.NOT_EQUAL:return typeof n.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,n.value)!==0;if(typeof t=="string"){if(t==="")return!0;const r=e.coerceToMaybeNumber(t);return r===void 0?!0:e.floatCmp(r,n.value)!==0}else return!0}:typeof n.value=="string"?e.neqMatcherFunction(n.value):typeof n.value=="boolean"?t=>typeof t!="boolean"||t!==n.value:t=>t!==ht}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class bue{constructor(e,t,r,i,s,o,a,l,u,c){this.config=e,this.dependencyGraph=t,this.columnSearch=r,this.stats=i,this.arithmeticHelper=s,this.functionRegistry=o,this.namedExpressions=a,this.serialization=l,this.arraySizePredictor=u,this.dateTimeHelper=c,this.equalOp=(h,d)=>Ci(this.arithmeticHelper.eq,h,d),this.notEqualOp=(h,d)=>Ci(this.arithmeticHelper.neq,h,d),this.greaterThanOp=(h,d)=>Ci(this.arithmeticHelper.gt,h,d),this.lessThanOp=(h,d)=>Ci(this.arithmeticHelper.lt,h,d),this.greaterThanOrEqualOp=(h,d)=>Ci(this.arithmeticHelper.geq,h,d),this.lessThanOrEqualOp=(h,d)=>Ci(this.arithmeticHelper.leq,h,d),this.concatOp=(h,d)=>Ci(this.arithmeticHelper.concat,Tw(h),Tw(d)),this.plusOp=(h,d)=>Ci(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(h),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.minusOp=(h,d)=>Ci(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(h),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.timesOp=(h,d)=>Ci(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(h),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.powerOp=(h,d)=>Ci(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(h),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.divOp=(h,d)=>Ci(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(h),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.unaryMinusOp=h=>k4(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.percentOp=h=>k4(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.unaryPlusOp=h=>this.arithmeticHelper.unaryPlus(h),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new wue(e)}evaluateAst(e,t){let r=this.evaluateAstWithoutPostprocessing(e,t);if(At(r)){if(qI(Le(r)))return new D($.NUM,Q.NaN);r=ib(r,XI(Le(r)))}return r instanceof Be&&r.height()===1&&r.width()===1&&([[r]]=r.data),Sue(r,t.formulaVertex)}evaluateAstWithoutPostprocessing(e,t){switch(e.type){case W.EMPTY:return ht;case W.CELL_REFERENCE:{const r=e.reference.toSimpleCellAddress(t.formulaAddress);return qr(r)?new D($.REF,Q.BadRef):this.dependencyGraph.getCellValue(r)}case W.NUMBER:case W.STRING:return e.value;case W.CONCATENATE_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,r,i,t)}case W.EQUALS_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,r,i,t)}case W.NOT_EQUAL_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,r,i,t)}case W.GREATER_THAN_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,r,i,t)}case W.LESS_THAN_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,r,i,t)}case W.GREATER_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,r,i,t)}case W.LESS_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,r,i,t)}case W.PLUS_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,r,i,t)}case W.MINUS_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,r,i,t)}case W.TIMES_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,r,i,t)}case W.POWER_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,r,i,t)}case W.DIV_OP:{const r=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,r,i,t)}case W.PLUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,r,t)}case W.MINUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,r,t)}case W.PERCENT_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,r,t)}case W.FUNCTION_CALL:{if(this.config.licenseKeyValidityState!=="valid"&&!Wn.functionIsProtected(e.procedureName))return new D($.LIC,Q.LicenseKey(this.config.licenseKeyValidityState));const r=this.functionRegistry.getFunction(e.procedureName);return r!==void 0?r(e,new Ls(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new D($.NAME,Q.FunctionName(e.procedureName))}case W.NAMED_EXPRESSION:{const r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return r?this.dependencyGraph.getCellValue(r.address):new D($.NAME,Q.NamedExpressionName(e.expressionName))}case W.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new D($.REF,Q.RangeManySheets);const r=We.fromCellRange(e,t.formulaAddress),i=this.dependencyGraph.getArray(r);if(i){const s=i.array;if(s instanceof lh)throw new Error("Array should be already computed");if(s instanceof D)return s;if(s instanceof tc)return Be.fromRange(s.raw(),r,this.dependencyGraph);throw new Error("Unknown array")}else return Be.onlyRange(r,this.dependencyGraph)}case W.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new D($.REF,Q.RangeManySheets);const r=wo.fromColumnRange(e,t.formulaAddress);return Be.onlyRange(r,this.dependencyGraph)}case W.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new D($.REF,Q.RangeManySheets);const r=vo.fromRowRangeAst(e,t.formulaAddress);return Be.onlyRange(r,this.dependencyGraph)}case W.PARENTHESIS:return this.evaluateAst(e.expression,t);case W.ARRAY:{let r;const i=[];for(const s of e.args){let o;const a=[];for(const u of s){const c=jI(this.evaluateAst(u,t)),h=c.height();if(o===void 0)o=h,a.push(...c.data);else if(o===h)for(let d=0;d<h;d++)a[d].push(...c.data[d]);else return new D($.REF,Q.SizeMismatch)}const l=a[0].length;if(r===void 0)r=l,i.push(...a);else if(r===l)i.push(...a);else return new D($.REF,Q.SizeMismatch)}return Be.onlyValues(i)}case W.ERROR_WITH_RAW_INPUT:case W.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,t,r){var i;if(t instanceof Be&&!r.arraysFlag&&(t=(i=Gm(t,r))!==null&&i!==void 0?i:new D($.VALUE,Q.ScalarExpected)),t instanceof D)return t;if(t instanceof Be){const s=t.data.map(o=>o.map(e));return Be.onlyValues(s)}return e(t)}binaryRangeWrapper(e,t,r,i){var s,o;if(t instanceof Be&&!i.arraysFlag&&(t=(s=Gm(t,i))!==null&&s!==void 0?s:new D($.VALUE,Q.ScalarExpected)),t instanceof D)return t;if(r instanceof Be&&!i.arraysFlag&&(r=(o=Gm(r,i))!==null&&o!==void 0?o:new D($.VALUE,Q.ScalarExpected)),r instanceof D)return r;if(t instanceof Be||r instanceof Be){if(!(t instanceof Be))if(r.isAdHoc()){const c=r.data;for(let h=0;h<c.length;h++)for(let d=0;d<c[0].length;d++)c[h][d]=e(t,c[h][d]);return Be.onlyValues(c)}else t=Be.fromScalar(t);if(!(r instanceof Be))if(t.isAdHoc()){const c=t.data;for(let h=0;h<c.length;h++)for(let d=0;d<c[0].length;d++)c[h][d]=e(c[h][d],r);return Be.onlyValues(c)}else r=Be.fromScalar(r);if(t.width()===r.width()&&t.height()===r.height()){if(t.isAdHoc()){const c=t.data,h=r.data;for(let d=0;d<c.length;d++)for(let f=0;f<c[0].length;f++)c[d][f]=e(c[d][f],h[d][f]);return Be.onlyValues(c)}if(r.isAdHoc()){const c=t.data,h=r.data;for(let d=0;d<c.length;d++)for(let f=0;f<c[0].length;f++)h[d][f]=e(c[d][f],h[d][f]);return Be.onlyValues(h)}}const a=Math.max(t.width(),r.width()),l=Math.max(t.height(),r.height()),u=Array(l);for(let c=0;c<l;c++)u[c]=Array(a);for(let c=0;c<l;c++){const h=t.height()!==1?c:0,d=r.height()!==1?c:0;for(let f=0;f<a;f++){const m=t.width()!==1?f:0,p=r.width()!==1?f:0;h<t.height()&&d<r.height()&&m<t.width()&&p<r.width()?u[c][f]=e(t.data[h][m],r.data[d][p]):u[c][f]=new D($.NA)}}return Be.onlyValues(u)}return e(t,r)}}function k4(n,e){return e instanceof D?e:n(e)}function Ci(n,e,t){return e instanceof D?e:t instanceof D?t:n(e,t)}function Sue(n,e){return n instanceof D&&e!==void 0?n.attachRootVertex(e):n}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Rue{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,t){this.transformations.forEach(r=>r.performEagerTransformations(e,t))}transformSingleAst(e,t){let[r,i]=[e,t];return this.transformations.forEach(s=>{[r,i]=s.transformSingleAst(r,i)}),[r,i]}isIrreversible(){return!0}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Tue{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return this.combinedTransformer!==void 0?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new Rue(e)}commitCombinedMode(){if(this.combinedTransformer===void 0)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,t,r){this.stats.start(Ze.TRANSFORM_ASTS_POSTPONED);for(let s=r;s<this.transformations.length;s++){const o=this.transformations[s];o.isIrreversible()&&(this.undoRedo.storeDataForVersion(s,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[a,l]=o.transformSingleAst(e,t);e=a,t=l}const i=this.parser.rememberNewAst(e);return this.stats.end(Ze.TRANSFORM_ASTS_POSTPONED),[i,t,this.transformations.length]}*getTransformationsFrom(e,t){for(let r=e;r<this.transformations.length;r++){const i=this.transformations[r];(!t||t(i))&&(yield i)}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const zm=-1;function Aue(n,e,{searchCoordinate:t,orderingDirection:r,matchExactly:i},s){const o=e.start[t],a=t==="col"?e.effectiveEndColumn(s):e.effectiveEndRow(s),l=t==="col"?d=>Le(s.getCellValue(Pe(e.sheet,d,e.start.row))):d=>Le(s.getCellValue(Pe(e.sheet,e.start.col,d))),u=r==="asc"?(d,f)=>F4(d,f):(d,f)=>-F4(d,f),c=xue(d=>u(n,l(d))>=0,o,a),h=l(c);return c===zm||typeof h!=typeof n||i&&h!==n?zm:c-o}function xue(n,e,t){let r=e,i=t;for(;r<i;){const s=Math.ceil((r+i)/2);n(s)?r=s:i=s-1}return r===i&&n(r)?r:zm}function F4(n,e){return typeof n==typeof e?n===ht?0:n<e?-1:n>e?1:0:n===ht?-1:e===ht?1:e instanceof D||typeof n=="number"&&typeof e=="string"||typeof n=="number"&&typeof e=="boolean"?-1:typeof n=="string"&&typeof e=="number"?1:typeof n=="string"&&typeof e=="boolean"?-1:1}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class dO{constructor(e){this.dependencyGraph=e}advancedFind(e,t){let r;const i=t.range;i===void 0?r=t.valuesFromTopLeftCorner():r=this.dependencyGraph.computeListOfValuesInRange(i);for(let s=0;s<r.length;s++)if(e(Le(r[s])))return s;return-1}basicFind(e,t,r,{ordering:i,matchExactly:s}){const o=typeof e=="string"?Nh(e):e,a=t.range;return a===void 0?this.findNormalizedValue(o,t.valuesFromTopLeftCorner()):i==="none"?this.findNormalizedValue(o,this.dependencyGraph.computeListOfValuesInRange(a)):Aue(o,a,{searchCoordinate:r,orderingDirection:i,matchExactly:s},this.dependencyGraph)}findNormalizedValue(e,t){return t.map(Le).map(r=>typeof r=="string"?Nh(r):r).indexOf(e)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class fO extends dO{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,r){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,r,i){}removeValues(e){}find(e,t,r){return this.basicFind(e,t,"row",r)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Wa{constructor(e,t,r){this.dependencyGraph=e,this.config=t,this.stats=r,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new fO(e)}add(e,t){if(!(e===ht||e instanceof D))if(e instanceof Be)for(const[r,i]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue(Le(r),i);else this.addSingleCellValue(e,t)}remove(e,t){if(e!==void 0)if(e instanceof Be)for(const[r,i]of e.entriesFromTopLeftCorner(t))this.removeSingleValue(Le(r),i);else this.removeSingleValue(e,t)}change(e,t,r){e!==t&&(this.remove(e,r),this.add(t,r))}applyChanges(e){for(const t of e)t.oldValue!==void 0&&this.change(Le(t.oldValue),Le(t.value),t.address)}moveValues(e,t,r,i){for(const[s,o]of e){const a=Gae(o,i,t,r);this.remove(s,o),this.add(s,a)}}removeValues(e){for(const[t,r]of e)this.remove(t,r)}find(e,t,{ordering:r,matchExactly:i}){const s=i===!0?"findFirst":"findLast",o=this.findUsingColumnIndex(e,t,s);return o!==void 0?o:this.binarySearchStrategy.find(e,t,{ordering:r,matchExactly:i})}findUsingColumnIndex(e,t,r){const i=t.range;if(i===void 0)return;this.ensureRecentData(i.sheet,i.start.col,e);const s=this.getColumnMap(i.sheet,i.start.col);if(!s)return-1;const o=typeof e=="string"?Nh(e):e,a=s.get(o);if(!a||!a.index||a.index.length===0)return;const l=Wa.findRowBelongingToRange(a,i,r);return l!==void 0?l-i.start.row:void 0}static findRowBelongingToRange(e,t,r){const i=t.start.row,s=t.end.row,o=r==="findFirst"?Da(i,e.index,"upperBound"):Da(s,e.index,"lowerBound");if(o===-1)return;const a=e.index[o];return a>=i&&a<=s?a:void 0}advancedFind(e,t){return this.binarySearchStrategy.advancedFind(e,t)}addColumns(e){const t=this.index.get(e.sheet);!t||t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const t=this.index.get(e.sheet);!t||t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);const r=this.index.get(e);let i=r[t];return i||(i=new Map,r[t]=i),i}getValueIndex(e,t,r){const i=this.getColumnMap(e,t);let s=this.getColumnMap(e,t).get(r);return s||(s={version:this.transformingService.version(),index:[]},i.set(r,s)),s}ensureRecentData(e,t,r){const i=this.getValueIndex(e,t,r),s=this.transformingService.version();if(i.version===s)return;const o=this.transformingService.getTransformationsFrom(i.version,a=>a.sheet===e&&(a instanceof Iw||a instanceof Ow));for(const a of o)a instanceof Iw?this.addRows(t,a.rowsSpan,r):a instanceof Ow&&this.removeRows(t,a.rowsSpan,r);i.version=s}addSingleCellValue(e,t){this.stats.measure(Ze.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e),typeof e=="string"&&(e=Nh(e));const r=this.getValueIndex(t.sheet,t.col,e);Wa.addValue(r,t.row)})}removeSingleValue(e,t){this.stats.measure(Ze.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e);const r=this.getColumnMap(t.sheet,t.col);typeof e=="string"&&(e=Nh(e));const i=r.get(e);if(!i)return;const s=Da(t.row,i.index);s>-1&&i.index.splice(s,1),i.index.length===0&&r.delete(e),r.size===0&&delete this.index.get(t.sheet)[t.col]})}addRows(e,t,r){const i=this.getValueIndex(t.sheet,e,r);Wa.shiftRows(i,t.rowStart,t.numberOfRows)}removeRows(e,t,r){const i=this.getValueIndex(t.sheet,e,r);Wa.removeRowsFromValues(i,t),Wa.shiftRows(i,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){const r=Da(t,e.index,"lowerBound");e.index[r]===t||e.index.splice(r+1,0,t)}static removeRowsFromValues(e,t){const r=Da(t.rowStart,e.index,"upperBound"),i=Da(t.rowEnd,e.index,"lowerBound");r>-1&&i>-1&&r<=i&&e.index[r]<=t.rowEnd&&e.index.splice(r,i-r+1)}static shiftRows(e,t,r){const i=Da(t,e.index,"upperBound");if(i!==-1)for(let s=i;s<e.index.length;++s)e.index[s]+=r}}function Da(n,e,t="upperBound"){let r=0,i=e.length-1;for(;r<=i;){const a=Math.floor((r+i)/2);if(n>e[a])r=a+1;else if(n<e[a])i=a-1;else return a}const s=t==="lowerBound"?i:r;return s>=0&&s<=e.length?s:-1}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Mue(n,e,t){return e.useColumnIndex?new Wa(n,e,t):new fO(n)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Nue{constructor(e){this.config=e;const t=this.config.thousandSeparator==="."?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,r=this.config.decimalSeparator==="."?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${r}\\d+)|(\\d+(${t}\\d{3,})*(${r}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${t}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const t=this.numericStringToNumber(e);return isNaN(t)?void 0:t}}numericStringToNumber(e){const t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class hb{constructor(e,t,r){this.dependencyGraph=e,this.unparser=t,this.exporter=r}getCellHyperlink(e){const t=this.dependencyGraph.getCell(e);if(t instanceof Is){const r=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(r.procedureName==="HYPERLINK")return r.hyperlink}}getCellFormula(e,t){const r=this.dependencyGraph.getCell(e);if(r instanceof Is){const i=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=t!=null?t:e,this.unparser.unparse(i,t)}else if(r instanceof En){const i=r.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(i.row!==e.row||i.col!==e.col||i.sheet!==e.sheet)return;t=t!=null?t:e;const s=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(s!==void 0)return this.unparser.unparse(s,t)}else if(r instanceof ku)return r.getFormula()}getCellSerialized(e,t){var r;return(r=this.getCellFormula(e,t))!==null&&r!==void 0?r:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,t=>this.getCellValue(t))}getSheetFormulas(e){return this.genericSheetGetter(e,t=>this.getCellFormula(t))}genericSheetGetter(e,t){const r=this.dependencyGraph.getSheetHeight(e),i=this.dependencyGraph.getSheetWidth(e),s=new Array(r);for(let o=0;o<r;o++){s[o]=new Array(i);for(let a=0;a<i;a++){const l=Pe(e,a,o);s[o][a]=t(l)}for(let a=i-1;a>=0&&(s[o][a]===null||s[o][a]===void 0);a--)s[o].pop()}for(let o=r-1;o>=0&&s[o].length===0;o--)s.pop();return s}genericAllSheetsGetter(e){const t={};for(const r of this.dependencyGraph.sheetMapping.displayNames()){const i=this.dependencyGraph.sheetMapping.fetch(r);t[r]=e(i)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,t=>this.getCellSerialized(t))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){const e=[];let t=0;for(const r of this.dependencyGraph.sheetMapping.displayNames()){const i=this.dependencyGraph.sheetMapping.fetch(r);e[i]=t,t++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(r=>({name:r.expression.displayName,expression:this.getCellSerialized(r.expression.address),scope:r.scope!==void 0?e[r.scope]:void 0,options:r.expression.options}))}withNewConfig(e,t){const r=new AI(e,rb(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new hb(this.dependencyGraph,r,this.exporter)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class sm{static buildFromSheets(e,t={},r=[]){const i=new dr(t);return this.buildEngine(i,e,r)}static buildFromSheet(e,t={},r=[]){const i=new dr(t),s=i.translationPackage.getUITranslation(ud.NEW_SHEET_PREFIX)+"1";return this.buildEngine(i,{[s]:e},r)}static buildEmpty(e={},t=[]){return this.buildEngine(new dr(e),{},t)}static rebuildWithConfig(e,t,r,i){return this.buildEngine(e,t,r,i)}static buildEngine(e,t={},r=[],i=e.useStats?new NI:new vae){i.start(Ze.BUILD_ENGINE_TOTAL);const s=new ml,o=new Wn(e),a=new Tue(i),l=ub.buildEmpty(a,e,o,s,i),u=Mue(l,e,i),c=l.sheetMapping,h=l.addressMapping;for(const N in t)if(Object.prototype.hasOwnProperty.call(t,N)){const H=t[N];sO(H);const K=Xp(H);if(K.height>e.maxRows||K.width>e.maxColumns)throw new nl;const X=c.addSheet(N);h.autoAddSheet(X,K)}const d=new xh(e,o,c.get);a.parser=d;const f=new AI(e,rb(e),c.fetchDisplayName,s),m=new mle(e),p=new Nue(e),y=new Xae(e,m,p),C=new Dle(e,m,p),b=new rle(e,o),v=new Gle(e,l,u,C,d,i,a,s,b),S=new due(e,v);a.undoRedo=S;const L=new kle(e,l,v),_=new fue(e,v,S,L,l,u,d,C,a,s);r.forEach(N=>{_.ensureItIsPossibleToAddNamedExpression(N.name,N.expression,N.scope),_.operations.addNamedExpression(N.name,N.expression,N.scope,N.options)});const P=new pue(e,s,c.fetchDisplayName,a),x=new hb(l,f,P),I=new bue(e,l,u,i,y,o,s,x,b,m);i.measure(Ze.GRAPH_BUILD,()=>{new gue(l,u,d,C,i,b).buildGraph(t,i)});const R=new mue(e,i,I,a,l,u);return R.run(),i.end(Ze.BUILD_ENGINE_TOTAL),{config:e,stats:i,dependencyGraph:l,columnSearch:u,parser:d,unparser:f,cellContentParser:C,evaluator:R,lazilyTransformingAstService:a,crudOperations:_,exporter:P,namedExpressions:s,serialization:x,functionRegistry:o}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Iue(n){for(const[e,t]of Object.entries(n))t instanceof Function?n[e]=Oue(t):delete n[e]}function Oue(n){return()=>{throw new Error(`The "${n}" method cannot be called because this HyperFormula instance has been destroyed`)}}var mO={exports:{}};function db(){}db.prototype={on:function(n,e,t){var r=this.e||(this.e={});return(r[n]||(r[n]=[])).push({fn:e,ctx:t}),this},once:function(n,e,t){var r=this;function i(){r.off(n,i),e.apply(t,arguments)}return i._=e,this.on(n,i,t)},emit:function(n){var e=[].slice.call(arguments,1),t=((this.e||(this.e={}))[n]||[]).slice(),r=0,i=t.length;for(r;r<i;r++)t[r].fn.apply(t[r].ctx,e);return this},off:function(n,e){var t=this.e||(this.e={}),r=t[n],i=[];if(r&&e)for(var s=0,o=r.length;s<o;s++)r[s].fn!==e&&r[s].fn._!==e&&i.push(r[s]);return i.length?t[n]=i:delete t[n],this}};mO.exports=db;var _ue=mO.exports.TinyEmitter=db;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var Es;(function(n){n.SheetAdded="sheetAdded",n.SheetRemoved="sheetRemoved",n.SheetRenamed="sheetRenamed",n.NamedExpressionAdded="namedExpressionAdded",n.NamedExpressionRemoved="namedExpressionRemoved",n.ValuesUpdated="valuesUpdated",n.EvaluationSuspended="evaluationSuspended",n.EvaluationResumed="evaluationResumed"})(Es||(Es={}));class Lue extends _ue{emit(e,...t){return super.emit(e,...t),this}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class gr{constructor(e,t,r,i,s,o,a,l,u,c,h,d,f,m){this._config=e,this._stats=t,this._dependencyGraph=r,this._columnSearch=i,this._parser=s,this._unparser=o,this._cellContentParser=a,this._evaluator=l,this._lazilyTransformingAstService=u,this._crudOperations=c,this._exporter=h,this._namedExpressions=d,this._serialization=f,this._functionRegistry=m,this._emitter=new Lue,this._evaluationSuspended=!1}static get defaultConfig(){return Pue()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},r=[]){return this.buildFromEngineState(sm.buildFromSheet(e,t,r))}static buildFromSheets(e,t={},r=[]){return this.buildFromEngineState(sm.buildFromSheets(e,t,r))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(sm.buildEmpty(e,t))}static getLanguage(e){Ne(e,"string","languageCode");const t=this.registeredLanguages.get(e);if(t===void 0)throw new Ew;return t}static registerLanguage(e,t){if(Ne(e,"string","languageCode"),this.registeredLanguages.has(e))throw new WI;this.registeredLanguages.set(e,Lae(t))}static unregisterLanguage(e){if(Ne(e,"string","languageCode"),this.registeredLanguages.has(e))this.registeredLanguages.delete(e);else throw new Ew}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){Wn.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){Wn.unregisterFunctionPlugin(e)}static registerFunction(e,t,r){Ne(e,"string","functionId"),Wn.registerFunction(e,t,r)}static unregisterFunction(e){Ne(e,"string","functionId"),Wn.unregisterFunction(e)}static unregisterAllFunctions(){Wn.unregisterAll()}static getRegisteredFunctionNames(e){Ne(e,"string","code");const t=Wn.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return Ne(e,"string","functionId"),Wn.getFunctionPlugin(e)}static getAllFunctionPlugins(){return Wn.getPlugins()}static buildFromEngineState(e){return new gr(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!vn(e))throw new Tt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!vn(e))throw new Tt("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellHyperlink(e){if(!vn(e))throw new Tt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e)}getCellSerialized(e){if(!vn(e))throw new Tt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return Ne(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return Ne(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return Ne(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return Ne(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every(([r,i])=>this._config[r]===i)||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if(vn(e))t=new We(e,e);else if(ai(e))t=new We(e.start,e.end);else throw new Tt("SimpleCellAddress | SimpleCellRange","address");try{this._crudOperations.ensureRangeInSizeLimits(t);for(const r of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(r)}catch{return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return Ne(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){Ne(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch{return!1}}setRowOrder(e,t){Ne(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,r)}isItPossibleToSetRowOrder(e,t){Ne(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,r),this._crudOperations.testRowOrderForArrays(e,r),!0}catch{return!1}}swapColumnIndexes(e,t){return Ne(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){Ne(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch{return!1}}setColumnOrder(e,t){Ne(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,r)}isItPossibleToSetColumnOrder(e,t){Ne(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,r),this._crudOperations.testColumnOrderForArrays(e,r),!0}catch{return!1}}isItPossibleToAddRows(e,...t){Ne(e,"number","sheetId");const r=Zp(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...r),!0}catch{return!1}}addRows(e,...t){return Ne(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){Ne(e,"number","sheetId");const r=Qp(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...r),!0}catch{return!1}}removeRows(e,...t){return Ne(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){Ne(e,"number","sheetId");const r=Zp(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...r),!0}catch{return!1}}addColumns(e,...t){return Ne(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){Ne(e,"number","sheetId");const r=Qp(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...r),!0}catch{return!1}}removeColumns(e,...t){return Ne(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!vn(t))throw new Tt("SimpleCellAddress","destinationLeftCorner");if(!ai(e))throw new Tt("SimpleCellRange","source");try{const r=new We(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(r.start,r.width(),r.height(),t),!0}catch{return!1}}moveCells(e,t){if(!vn(t))throw new Tt("SimpleCellAddress","destinationLeftCorner");if(!ai(e))throw new Tt("SimpleCellRange","source");const r=new We(e.start,e.end);return this._crudOperations.moveCells(r.start,r.width(),r.height(),t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,t,r,i){Ne(e,"number","sheetId"),Ne(t,"number","startRow"),Ne(r,"number","numberOfRows"),Ne(i,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,r,i),!0}catch{return!1}}moveRows(e,t,r,i){return Ne(e,"number","sheetId"),Ne(t,"number","startRow"),Ne(r,"number","numberOfRows"),Ne(i,"number","targetRow"),this._crudOperations.moveRows(e,t,r,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,r,i){Ne(e,"number","sheetId"),Ne(t,"number","startColumn"),Ne(r,"number","numberOfColumns"),Ne(i,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,r,i),!0}catch{return!1}}moveColumns(e,t,r,i){return Ne(e,"number","sheetId"),Ne(t,"number","startColumn"),Ne(r,"number","numberOfColumns"),Ne(i,"number","targetColumn"),this._crudOperations.moveColumns(e,t,r,i),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!ai(e))throw new Tt("SimpleCellRange","source");const t=new We(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}cut(e){if(!ai(e))throw new Tt("SimpleCellRange","source");const t=new We(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}paste(e){if(!vn(e))throw new Tt("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!ai(e))throw new Tt("SimpleCellRange","source");return new We(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(i=>this.getCellValue(i)))}getRangeFormulas(e){if(!ai(e))throw new Tt("SimpleCellRange","source");return new We(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(i=>this.getCellFormula(i)))}getRangeSerialized(e){if(!ai(e))throw new Tt("SimpleCellRange","source");return new We(e.start,e.end).arrayOfAddressesInRange().map(r=>r.map(i=>this.getCellSerialized(i)))}getFillRangeData(e,t,r=!1){if(!ai(e))throw new Tt("SimpleCellRange","source");if(!ai(t))throw new Tt("SimpleCellRange","target");const i=new We(e.start,e.end),s=new We(t.start,t.end);return this.ensureEvaluationIsNotSuspended(),s.arrayOfAddressesInRange().map(o=>o.map(a=>{const l=((a.row-(r?t:e).start.row)%i.height()+i.height())%i.height()+e.start.row,u=((a.col-(r?t:e).start.col)%i.width()+i.width())%i.width()+e.start.col;return this._serialization.getCellSerialized({row:l,col:u,sheet:i.sheet},a)}))}isItPossibleToAddSheet(e){Ne(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch{return!1}}addSheet(e){e!==void 0&&Ne(e,"string","sheetName");const t=this._crudOperations.addSheet(e);return this._emitter.emit(Es.SheetAdded,t),t}isItPossibleToRemoveSheet(e){Ne(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}removeSheet(e){Ne(e,"number","sheetId");const t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const r=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Es.SheetRemoved,t,r),r}isItPossibleToClearSheet(e){Ne(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}clearSheet(e){return Ne(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){Ne(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch{return!1}}setSheetContent(e,t){return Ne(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return Ne(e,"string","cellAddress"),Ne(t,"number","sheetId"),aw(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return Ne(e,"string","cellRange"),Ne(t,"number","sheetId"),vie(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t){if(!vn(e))throw new Tt("SimpleCellAddress","cellAddress");return Ne(t,"number","sheetId"),Op(this.sheetMapping.fetchDisplayName,e,t)}simpleCellRangeToString(e,t){if(!ai(e))throw new Tt("SimpleCellRange","cellRange");return Ne(t,"number","sheetId"),Cie(this.sheetMapping.fetchDisplayName,e,t)}getCellDependents(e){let t;if(vn(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(ai(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new Tt("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if(vn(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(ai(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new Tt("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return Ne(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return Ne(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return Ne(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!vn(e))throw new Tt("SimpleCellAddress","cellAddress");const t=this.dependencyGraph.getCell(e);return Hae(t,e)}doesCellHaveSimpleValue(e){if(!vn(e))throw new Tt("SimpleCellAddress","cellAddress");return this.getCellType(e)===Yr.VALUE}doesCellHaveFormula(e){if(!vn(e))throw new Tt("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===Yr.FORMULA||t===Yr.ARRAYFORMULA}isCellEmpty(e){if(!vn(e))throw new Tt("SimpleCellAddress","cellAddress");return this.getCellType(e)===Yr.EMPTY}isCellPartOfArray(e){if(!vn(e))throw new Tt("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===Yr.ARRAY||t===Yr.ARRAYFORMULA}getCellValueType(e){if(!vn(e))throw new Tt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return Yp(t)}getCellValueDetailedType(e){if(!vn(e))throw new Tt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return Bae(t)}getCellValueFormat(e){if(!vn(e))throw new Tt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return Vae(t)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){Ne(e,"number","sheetId"),Ne(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch{return!1}}renameSheet(e,t){Ne(e,"number","sheetId"),Ne(t,"string","newName");const r=this._crudOperations.renameSheet(e,t);r!==void 0&&this._emitter.emit(Es.SheetRenamed,r,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(t){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),t}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(Es.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Es.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,r){Ne(e,"string","expressionName"),r!==void 0&&Ne(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,r),!0}catch{return!1}}addNamedExpression(e,t,r,i){Ne(e,"string","expressionName"),r!==void 0&&Ne(r,"number","scope"),this._crudOperations.addNamedExpression(e,t,r,i);const s=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Es.NamedExpressionAdded,e,s),s}getNamedExpressionValue(e,t){Ne(e,"string","expressionName"),t!==void 0&&Ne(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);if(r)return this._serialization.getCellValue(r.address)}getNamedExpressionFormula(e,t){Ne(e,"string","expressionName"),t!==void 0&&Ne(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);if(r!==void 0)return this._serialization.getCellFormula(r.address)}getNamedExpression(e,t){Ne(e,"string","expressionName"),t!==void 0&&Ne(t,"number","scope");const r=this._namedExpressions.namedExpressionForScope(e,t);if(r===void 0)return;const i=this._serialization.getCellFormula(r.address);return{name:e,scope:t,expression:i,options:r.options}}isItPossibleToChangeNamedExpression(e,t,r){Ne(e,"string","expressionName"),r!==void 0&&Ne(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,r),!0}catch{return!1}}changeNamedExpression(e,t,r,i){return Ne(e,"string","expressionName"),r!==void 0&&Ne(r,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,r,t,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){Ne(e,"string","expressionName"),t!==void 0&&Ne(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch{return!1}}removeNamedExpression(e,t){Ne(e,"string","expressionName"),t!==void 0&&Ne(t,"number","scope");const r=this._crudOperations.removeNamedExpression(e,t);if(r){const i=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Es.NamedExpressionRemoved,r.displayName,i),i}else return[]}listNamedExpressions(e){return e!==void 0&&Ne(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){Ne(e,"string","formulaString");const{ast:t,address:r}=this.extractTemporaryFormula(e);if(t===void 0)throw new Cw;return this._unparser.unparse(t,r)}calculateFormula(e,t){Ne(e,"string","formulaString"),Ne(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);const{ast:r,address:i,dependencies:s}=this.extractTemporaryFormula(e,t);if(r===void 0)throw new Cw;const o=this.evaluator.runAndForget(r,i,s);return this._exporter.exportScalarOrRange(o)}validateFormula(e){Ne(e,"string","formulaString");const{ast:t}=this.extractTemporaryFormula(e);return!(t===void 0||t.type===W.ERROR&&!t.error)}getRegisteredFunctionNames(){return gr.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return Ne(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return Ne(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return Ne(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return Ne(e,"number","val"),Fu(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){Iue(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new VI}extractTemporaryFormula(e,t=1){const r=this._cellContentParser.parse(e),i={sheet:t,col:0,row:0};if(!(r instanceof tn.Formula))return{address:i,dependencies:[]};const{ast:s,errors:o,dependencies:a}=this._parser.parse(r.formula,i);return o.length>0?{address:i,dependencies:[]}:{ast:s,address:i,dependencies:a}}rebuildWithConfig(e){const t=this._config.mergeConfig(e),r=this._config.mergeConfig({language:e.language}),i=this._serialization.withNewConfig(r,this._namedExpressions).getAllSheetsSerialized(),s=this._serialization.getAllNamedExpressionsSerialized(),o=sm.rebuildWithConfig(t,i,s,this._stats);this._config=o.config,this._stats=o.stats,this._dependencyGraph=o.dependencyGraph,this._columnSearch=o.columnSearch,this._parser=o.parser,this._unparser=o.unparser,this._cellContentParser=o.cellContentParser,this._evaluator=o.evaluator,this._lazilyTransformingAstService=o.lazilyTransformingAstService,this._crudOperations=o.crudOperations,this._exporter=o.exporter,this._namedExpressions=o.namedExpressions,this._serialization=o.serialization,this._functionRegistry=o.functionRegistry}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),t=this.dependencyGraph.verticesToRecompute();this.dependencyGraph.clearDirtyVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));const r=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(Es.ValuesUpdated,r),r}}}gr.version="2.6.0";gr.buildDate="19/09/2023 10:21:36";gr.releaseDate="19/09/2023";gr.languages={};gr.registeredLanguages=new Map;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const H4=new WeakMap;class dr{constructor(e={},t=!0){const{accentSensitive:r,binarySearchThreshold:i,caseSensitive:s,caseFirst:o,chooseAddressMappingPolicy:a,currencySymbol:l,dateFormats:u,decimalSeparator:c,evaluateNullToZero:h,functionArgSeparator:d,functionPlugins:f,ignorePunctuation:m,leapYear1900:p,localeLang:y,language:C,ignoreWhiteSpace:b,licenseKey:v,matchWholeCell:S,arrayColumnSeparator:L,arrayRowSeparator:_,maxRows:P,maxColumns:x,nullYear:I,nullDate:R,parseDateTime:N,precisionEpsilon:H,precisionRounding:K,stringifyDateTime:X,stringifyDuration:J,smartRounding:ue,timeFormats:se,thousandSeparator:O,useArrayArithmetic:g,useStats:E,undoLimit:A,useColumnIndex:U,useRegularExpressions:G,useWildcards:V}=e;t&&dr.warnDeprecatedOptions(e),this.useArrayArithmetic=_t(g,"boolean","useArrayArithmetic"),this.accentSensitive=_t(r,"boolean","accentSensitive"),this.caseSensitive=_t(s,"boolean","caseSensitive"),this.caseFirst=_t(o,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=_t(m,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=a!=null?a:dr.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...Jf(u,Array.isArray,"array","dateFormats")],this.timeFormats=[...Jf(se,Array.isArray,"array","timeFormats")],this.functionArgSeparator=_t(d,"string","functionArgSeparator"),this.decimalSeparator=_t(c,[".",","],"decimalSeparator"),this.language=_t(C,"string","language"),this.ignoreWhiteSpace=_t(b,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=_t(v,"string","licenseKey"),this.thousandSeparator=_t(O,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=_t(L,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=_t(_,[";","|"],"arrayRowSeparator"),this.localeLang=_t(y,"string","localeLang"),this.functionPlugins=[...f!=null?f:dr.defaultConfig.functionPlugins],this.smartRounding=_t(ue,"boolean","smartRounding"),this.evaluateNullToZero=_t(h,"boolean","evaluateNullToZero"),this.nullYear=_t(I,"number","nullYear"),ou(this.nullYear,"nullYear",0),ile(this.nullYear,"nullYear",100),this.precisionRounding=_t(K,"number","precisionRounding"),ou(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=_t(H,"number","precisionEpsilon"),ou(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=_t(U,"boolean","useColumnIndex"),this.useStats=_t(E,"boolean","useStats"),this.binarySearchThreshold=i!=null?i:dr.defaultConfig.binarySearchThreshold,this.parseDateTime=_t(N,"function","parseDateTime"),this.stringifyDateTime=_t(X,"function","stringifyDateTime"),this.stringifyDuration=_t(J,"function","stringifyDuration"),this.translationPackage=gr.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=Jf(R,Ih,"IDate","nullDate"),this.leapYear1900=_t(p,"boolean","leapYear1900"),this.undoLimit=_t(A,"number","undoLimit"),this.useRegularExpressions=_t(G,"boolean","useRegularExpressions"),this.useWildcards=_t(V,"boolean","useWildcards"),this.matchWholeCell=_t(S,"boolean","matchWholeCell"),ou(this.undoLimit,"undoLimit",0),this.maxRows=_t(P,"number","maxRows"),ou(this.maxRows,"maxRows",1),this.maxColumns=_t(x,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(l),ou(this.maxColumns,"maxColumns",1),H4.set(this,{licenseKeyValidityState:Ile(this.licenseKey)}),S4({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),S4({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const t=[...Jf(e,Array.isArray,"array","currencySymbol")];return t.forEach(r=>{if(typeof r!="string")throw new Tt("string[]","currencySymbol");if(r==="")throw new Eae("currencySymbol")}),t}get licenseKeyValidityState(){return H4.get(this).licenseKeyValidityState}getConfig(){return pO(this)}mergeConfig(e){const t=Object.assign({},this.getConfig(),e);return dr.warnDeprecatedOptions(e),new dr(t,!1)}static warnDeprecatedOptions(e){dr.warnDeprecatedIfUsed(e.binarySearchThreshold,"binarySearchThreshold","1.1")}static warnDeprecatedIfUsed(e,t,r,i){e!==void 0&&console.warn(i===void 0?`${t} option is deprecated since ${r}`:`${t} option is deprecated since ${r}, please use ${i}`)}}dr.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",chooseAddressMappingPolicy:new wle,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:ule,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:Ale,stringifyDuration:Tle,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};function pO(n){var e;const t={};for(const r in dr.defaultConfig){const i=(e=n[r])!==null&&e!==void 0?e:dr.defaultConfig[r];Array.isArray(i)?t[r]=[...i]:t[r]=i}return t}function Pue(){return pO({})}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Lw={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var Vo;(function(n){n[n.FullyAbsolute=1]="FullyAbsolute",n[n.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",n[n.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",n[n.FullyRelative=4]="FullyRelative"})(Vo||(Vo={}));class gO extends nt{verifyAddressArguments(e,t,r,i){if(i){if(e<1||t<1)return new D($.VALUE,Q.LessThanOne)}else if(Vo.FullyAbsolute==r){if(e<1||t<1)return new D($.VALUE,Q.LessThanOne)}else if(Vo.RowAbsoluteColRelative==r){if(e<1)return new D($.VALUE,Q.LessThanOne)}else if(Vo.RowRelativeColAbsolute==r&&t<1)return new D($.VALUE,Q.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),(r,i,s,o,a)=>{const l=this.verifyAddressArguments(r,i,s,o);if(l!==void 0)return l;const u=T1(i-1);let c="";a!=null&&(c=`${a}!`);const h=i==0?"C":`C[${i}]`,d=r==0?"R":`R[${r}]`;return Vo.FullyRelative==s?o?`${c}${u}${r}`:`${c}${d}${h}`:Vo.RowRelativeColAbsolute==s?o?`${c}$${u}${r}`:`${c}${d}C${i}`:Vo.RowAbsoluteColRelative==s?o?`${c}${u}$${r}`:`${c}R${r}${h}`:o?`${c}$${u}$${r}`:`${c}R${r}C${i}`})}}gO.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:w.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:w.STRING,optionalArg:!0}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class yO extends nt{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),r=>r)}arrayformulaArraySize(e,t){if(e.args.length!==1)return lt.error();const r=this.metadata("ARRAYFORMULA");return e.args.map(s=>{var o;return this.arraySizeForAst(s,new Ls(t.formulaAddress,t.arraysFlag||((o=r==null?void 0:r.arrayFunction)!==null&&o!==void 0?o:!1)))})[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),(r,i,s)=>{i=Math.min(i,r.height()),s=Math.min(s,r.width());const o=r.data,a=[];for(let l=0;l<i;l++)a.push(o[l].slice(0,s));return Be.onlyValues(a)})}arrayconstrainArraySize(e,t){if(e.args.length!==3)return lt.error();const r=this.metadata("ARRAY_CONSTRAIN"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new Ls(t.formulaAddress,t.arraysFlag||((l=r==null?void 0:r.arrayFunction)!==null&&l!==void 0?l:!1)))});let{height:s,width:o}=i[0];return e.args[1].type===W.NUMBER&&(s=Math.min(s,e.args[1].value)),e.args[2].type===W.NUMBER&&(o=Math.min(o,e.args[2].value)),s<1||o<1||!Number.isInteger(s)||!Number.isInteger(o)?lt.error():new lt(o,s)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),(r,...i)=>{for(const a of i)if(r.width()!==a.width()||r.height()!==a.height())return new D($.NA,Q.EqualLength);if(r.width()>1&&r.height()>1)return new D($.NA,Q.WrongDimension);const s=r.data,o=[];for(let a=0;a<r.height();a++){const l=[];for(let u=0;u<r.width();u++){let c=!0;for(const h of i)if(KI(h.data[a][u])!==!0){c=!1;break}c&&l.push(s[a][u])}l.length>0&&o.push(l)}return o.length>0?Be.onlyValues(o):new D($.NA,Q.EmptyRange)})}filterArraySize(e,t){if(e.args.length<=1)return lt.error();const r=this.metadata("FILTER"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new Ls(t.formulaAddress,t.arraysFlag||((l=r==null?void 0:r.arrayFunction)!==null&&l!==void 0?l:!1)))}),s=Math.max(...i.map(a=>a.width)),o=Math.max(...i.map(a=>a.height));return new lt(s,o)}}yO.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:w.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:w.RANGE},{argumentType:w.INTEGER,minValue:1},{argumentType:w.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class wO extends nt{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}wO.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Due=0xffffffffffff,U4=-53,B4=53;class vO extends nt{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),CO)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),EO)}}vO.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:w.INTEGER,minValue:0},{argumentType:w.INTEGER,minValue:U4,maxValue:B4}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:w.INTEGER,minValue:0},{argumentType:w.INTEGER,minValue:U4,maxValue:B4}]}};function CO(n,e){return e<0?EO(n,-e):bO(n*Math.pow(2,e))}function EO(n,e){return e<0?CO(n,-e):bO(Math.floor(n/Math.pow(2,e)))}function bO(n){return n>Due?new D($.NUM,Q.BitshiftLong):n}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class SO extends nt{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(r,i)=>r&i)}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(r,i)=>r|i)}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(r,i)=>r^i)}}SO.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:w.INTEGER,minValue:0},{argumentType:w.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:w.INTEGER,minValue:0},{argumentType:w.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:w.INTEGER,minValue:0},{argumentType:w.INTEGER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class RO extends nt{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),()=>!0)}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),()=>!1)}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(r,i,s)=>r?i:s)}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),(...r)=>{for(let i=0;i<r.length;i+=2)if(r[i])return r[i+1];return new D($.NA,Q.NoConditionMet)})}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(...r)=>r.filter(i=>i!==void 0).every(i=>!!i))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(...r)=>r.filter(i=>i!==void 0).some(i=>i))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),r=>!r)}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(...r)=>{let i=0;return r.filter(s=>s!==void 0).forEach(s=>{s&&i++}),i%2===1})}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),(r,...i)=>{const s=i.length;let o=0;for(;o+1<s;o+=2)if(!(i[o]instanceof D)&&this.arithmeticHelper.eq(r,i[o]))return i[o+1];return o<s?i[o]:new D($.NA,Q.NoDefault)})}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(r,i)=>r instanceof D?i:r)}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(r,i)=>r instanceof D&&r.type===$.NA?i:r)}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(r,...i)=>r>i.length?new D($.NUM,Q.Selector):i[r-1])}}RO.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:w.BOOLEAN},{argumentType:w.SCALAR,passSubtype:!0},{argumentType:w.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:w.BOOLEAN},{argumentType:w.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:w.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:w.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:w.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:w.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:w.NOERROR},{argumentType:w.SCALAR,passSubtype:!0},{argumentType:w.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:w.SCALAR,passSubtype:!0},{argumentType:w.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:w.SCALAR,passSubtype:!0},{argumentType:w.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:w.INTEGER,minValue:1},{argumentType:w.SCALAR,passSubtype:!0}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class TO extends nt{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),r=>r<1||r>=256?new D($.VALUE,Q.CharacterCodeBounds):String.fromCharCode(Math.trunc(r)))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),r=>r<1||r>=1114112?new D($.VALUE,Q.CharacterCodeBounds):String.fromCodePoint(Math.trunc(r)))}}TO.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:w.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class AO extends nt{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),r=>r.length===0?new D($.VALUE,Q.EmptyString):r.charCodeAt(0))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),r=>{var i;return(i=r.codePointAt(0))!==null&&i!==void 0?i:new D($.VALUE,Q.EmptyString)})}}AO.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:w.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:w.STRING}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class xO extends nt{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(...r)=>{let i=0;return r.forEach(s=>{s===ht&&i++}),i})}}xO.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:w.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class MO extends nt{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(...r)=>{const i=new Set,s=new Set;for(const o of r)o instanceof D?s.add(o.type):o!==""&&i.add(o);return i.size+s.size})}}MO.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:w.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class NO extends nt{constructor(){super(...arguments),this.isoweeknumCore=e=>{const t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),r=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.dateToNumber({year:r.year,month:1,day:1}),s=this.dateTimeHelper.relativeNumberToAbsoluteNumber(i),o=s+((4-s)%7+7)%7,a=Math.floor((t-1)/7)-Math.floor((o-1)/7)+1;return a===0?this.isoweeknumCore(e-7)+1:a},this.days360Core=(e,t,r)=>{const i=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.numberToSimpleDate(t);let o,a;return r?(o=M4(i),a=M4(s)):[o,a]=this.dateTimeHelper.toBasisUS(i,s),360*(a.year-o.year)+30*(a.month-o.month)+a.day-o.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),(r,i,s)=>{const o=Math.trunc(s);let a=Math.trunc(i),l=Math.trunc(r);l<this.dateTimeHelper.getEpochYearZero()&&(l+=this.dateTimeHelper.getEpochYearZero());const u=Math.floor((a-1)/12);l+=u,a-=u*12;const c={year:l,month:a,day:1};if(this.dateTimeHelper.isValidDate(c)){let h=this.dateTimeHelper.dateToNumber(c)+(o-1);return h=this.dateTimeHelper.getWithinBounds(h),h===void 0?new D($.NUM,Q.DateBounds):h}return new D($.VALUE,Q.InvalidDate)})}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(r,i,s)=>{const o=Hu({hours:Math.trunc(r),minutes:Math.trunc(i),seconds:Math.trunc(s)});return o<0?new D($.NUM,Q.NegativeTime):o%1})}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),(r,i)=>{const s=this.dateTimeHelper.numberToSimpleDate(r);let o=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(x4(s,i)));return o=this.dateTimeHelper.getWithinBounds(o),o===void 0?new D($.NUM,Q.DateBounds):o})}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),r=>this.dateTimeHelper.numberToSimpleDate(r).day)}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(r,i)=>Math.trunc(r)-Math.trunc(i))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),r=>this.dateTimeHelper.numberToSimpleDate(r).month)}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),r=>this.dateTimeHelper.numberToSimpleDate(r).year)}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),r=>Fu(k6(r)%1).hours)}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),r=>Fu(k6(r)%1).minutes)}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),r=>Fu(k6(r)%1).seconds)}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),(r,i)=>ble(r,i,this.config,this.dateTimeHelper))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(r,i)=>{const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(r));if(i===3)return(s-1)%7;const o=W4.get(i);return o===void 0?new D($.NUM,Q.BadMode):(s-o)%7+1})}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(r,i)=>{const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(r)),o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.dateToNumber({year:o.year,month:1,day:1}),l=this.dateTimeHelper.relativeNumberToAbsoluteNumber(a);if(i===21)return this.isoweeknumCore(r);const u=W4.get(i);return u===void 0?new D($.NUM,Q.BadMode):Math.floor((s-u)/7)-Math.floor((l-u)/7)+1})}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),r=>{const{dateTime:i}=this.dateTimeHelper.parseDateTimeFromConfigFormats(r);return i===void 0?new D($.VALUE,Q.IncorrectDateTime):Ih(i)?(tO(i)?Math.trunc(Hu(i)):0)+this.dateTimeHelper.dateToNumber(i):0})}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),r=>{const i=this.dateTimeHelper.dateStringToDateNumber(r);return i===void 0?new D($.VALUE,Q.IncorrectDateTime):Le(i)%1})}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),()=>{const r=new Date(Date.now());return Hu({hours:r.getHours(),minutes:r.getMinutes(),seconds:r.getSeconds()})+this.dateTimeHelper.dateToNumber({year:r.getFullYear(),month:r.getMonth()+1,day:r.getDate()})})}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),()=>{const r=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:r.getFullYear(),month:r.getMonth()+1,day:r.getDate()})})}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),(r,i)=>{const s=this.dateTimeHelper.numberToSimpleDate(r),o=gle(x4(s,i));let a=this.dateTimeHelper.dateToNumber(o);return a=this.dateTimeHelper.getWithinBounds(a),a===void 0?new D($.NUM,Q.DateBounds):a})}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),(r,i,s)=>{if(r>i)return new D($.NUM,Q.StartEndDate);if(s==="D")return Math.floor(i)-Math.floor(r);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);switch(s){case"M":return(a.year-o.year)*12+(a.month-o.month)-(a.day<o.day?1:0);case"YM":return(12+(a.month-o.month)-(a.day<o.day?1:0))%12;case"Y":return a.month>o.month||a.month===o.month&&a.day>=o.day?a.year-o.year:a.year-o.year-1;case"MD":if(a.day>=o.day)return a.day-o.day;{const l=a.month===1?12:a.month-1,u=a.month===1?a.year-1:a.year;return this.dateTimeHelper.daysInMonth(u,l)+a.day-o.day}case"YD":return a.month>o.month||a.month===o.month&&a.day>=o.day?Math.floor(i)-this.dateTimeHelper.dateToNumber({year:a.year,month:o.month,day:o.day}):Math.floor(i)-Math.floor(r)-365*(a.year-o.year-1)-this.dateTimeHelper.leapYearsCount(a.year-1)+this.dateTimeHelper.leapYearsCount(o.year);default:return new D($.NUM,Q.BadMode)}})}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(r,i,s)=>{switch(r=Math.trunc(r),i=Math.trunc(i),r>i&&([r,i]=[i,r]),s){case 0:return this.days360Core(r,i,!1)/360;case 1:return(i-r)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(r),this.dateTimeHelper.numberToSimpleDate(i));case 2:return(i-r)/360;case 3:return(i-r)/365;case 4:return this.days360Core(r,i,!0)/360}throw new Error("Should not be reachable.")})}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),r=>{r=Math.trunc(r);const i=r%60;r=Math.trunc(r/60);const s=r%60;r=Math.trunc(r/60);const o=r%24;r=Math.trunc(r/24);const a=r%30;r=Math.trunc(r/30);const l=r%12,u=Math.trunc(r/12);return"P"+(u>0?`${u}Y`:"")+(l>0?`${l}M`:"")+(a>0?`${a}D`:"")+"T"+(o>0?`${o}H`:"")+(s>0?`${s}M`:"")+(i>0?`${i}S`:"")})}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(r,i,s)=>this.networkdayscore(r,i,1,s))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(r,i,s,o)=>this.networkdayscore(r,i,s,o))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),(r,i,s)=>this.workdaycore(r,i,1,s))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(r,i,s,o)=>this.workdaycore(r,i,s,o))}networkdayscore(e,t,r,i){e=Math.trunc(e),t=Math.trunc(t);let s=1;e>t&&([e,t]=[t,e],s=-1);const o=$4(r);if(o instanceof D)return o;const a=this.simpleRangeToFilteredHolidays(o,i);return a instanceof D?a:s*this.countWorkdays(e,t,o,a)}workdaycore(e,t,r,i){e=Math.trunc(e),t=Math.trunc(t);const s=$4(r);if(s instanceof D)return s;const o=this.simpleRangeToFilteredHolidays(s,i);if(o instanceof D)return o;if(t>0){let a=1;for(;this.countWorkdays(e+1,e+a,s,o)<t;)a*=2;let l=1;for(;l+1<a;){const u=Math.trunc((l+a)/2);this.countWorkdays(e+1,e+u,s,o)<t?l=u:a=u}return e+a}else if(t<0){t*=-1;let a=1;for(;this.countWorkdays(e-a,e-1,s,o)<t;)a*=2;let l=1;for(;l+1<a;){const u=Math.trunc((l+a)/2);this.countWorkdays(e-u,e-1,s,o)<t?l=u:a=u}return e-a}else return e}countWorkdays(e,t,r,i){const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let a=0;for(let l=0;l<7;l++)r.charAt(l)==="0"&&(a+=Math.floor((s+6-l)/7),a-=Math.floor((o-1+6-l)/7));return a-=V4(t+1,i)-V4(e,i),a}simpleRangeToFilteredHolidays(e,t){var r;const i=(r=t==null?void 0:t.valuesFromTopLeftCorner())!==null&&r!==void 0?r:[];for(const o of i)if(o instanceof D)return o;const s=[];for(const o of i)if(o!==ht)if(At(o))s.push(Math.trunc(Le(o)));else return new D($.VALUE,Q.WrongType);return[...new Set(s)].sort((o,a)=>o-a).filter(o=>{const l=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(o)-1)%7;return e.charAt(l)==="0"})}}NO.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER}],returnNumberType:He.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER}],returnNumberType:He.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:w.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:w.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:w.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:w.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:w.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:w.NUMBER},{argumentType:w.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER}],returnNumberType:He.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:w.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:w.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:w.STRING}],returnNumberType:He.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:w.STRING}],returnNumberType:He.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:He.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:He.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER}],returnNumberType:He.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:w.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.NOERROR,defaultValue:1},{argumentType:w.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER},{argumentType:w.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER},{argumentType:w.NOERROR,defaultValue:1},{argumentType:w.RANGE,optionalArg:!0}]}};function V4(n,e){if(e.length===0||n<=e[0])return 0;if(e[e.length-1]<n)return e.length;let t=0,r=e.length-1;for(;t+1<r;){const i=Math.floor((r+t)/2);e[i]>=n?r=i:t=i}return r}function $4(n){var e;return typeof n!="number"&&typeof n!="string"?new D($.VALUE,Q.WrongType):typeof n=="string"?n.length!==7||!/^(0|1)*$/.test(n)||n==="1111111"?new D($.NUM,Q.WeekendString):n:(e=kue.get(n))!==null&&e!==void 0?e:new D($.NUM,Q.BadMode)}const W4=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),kue=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class IO extends nt{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),r=>r*(180/Math.PI))}}IO.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class OO extends nt{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(r,i)=>r===i?1:0)}}OO.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class _O extends nt{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}_O.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class LO extends nt{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),fb)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),Pw)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),G4)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),Dw)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(r,i,s,o,a,l)=>{if(o>a)return new D($.NUM,Q.EndStartPeriod);let u=0;for(let c=o;c<=a;c++)u+=Pw(r,c,i,s,0,l);return u})}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(r,i,s,o,a,l)=>{if(o>a)return new D($.NUM,Q.EndStartPeriod);let u=0;for(let c=o;c<=a;c++)u+=G4(r,c,i,s,0,l);return u})}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(r,i,s,o,a)=>{if(a===12&&o>s||o>s+1)return new D($.NUM,Q.PeriodLong);if(i>=r)return 0;const l=Math.round((1-Math.pow(i/r,1/s))*1e3)/1e3,u=r*l*a/12;if(o===1)return u;let c=u;for(let h=0;h<o-2;h++)c+=(r-c)*l;return o===s+1?(r-c)*l*(12-a)/12:(r-c)*l})}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(r,i,s,o,a)=>{if(o>s)return new D($.NUM);let l=a/s,u;l>=1?(l=1,o===1?u=r:u=0):u=r*Math.pow(1-l,o-1);const c=r*Math.pow(1-l,o);return Math.max(u-Math.max(i,c),0)})}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(r,i)=>{if(i<1)return new D($.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(r)+(r-Math.trunc(r))*10/i})}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(r,i)=>{if(i<1)return new D($.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(r)+(r-Math.trunc(r))*i/10})}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(r,i)=>(i=Math.trunc(i),Math.pow(1+r/i,i)-1))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(r,i,s,o)=>s===0?new D($.DIV_BY_ZERO):o*r*(i/s-1))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(r,i)=>(i=Math.trunc(i),(Math.pow(r+1,1/i)-1)*i))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(r,i,s,o,a)=>r===0?i===0?new D($.DIV_BY_ZERO):(-s-o)/i:(a&&(i*=1+r),Math.log((i-o*r)/(s*r+i))/Math.log(1+r)))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(r,i,s,o,a,l)=>{if(l<=-1)return new D($.VALUE);const u=1e-7,c=50;let h=l;a=a?1:0;for(let d=0;d<c;d++){if(h<=-1)return new D($.NUM);let f;if(Math.abs(h)<u)f=s*(1+r*h)+i*(1+h*a)*r+o;else{const p=Math.pow(1+h,r);f=s*p+i*(1/h+a)*(p-1)+o}if(Math.abs(f)<u)return h;let m;if(Math.abs(h)<u)m=s*r+i*a*r;else{const p=Math.pow(1+h,r),y=r*Math.pow(1+h,r-1);m=s*y+i*(1/h+a)*y+i*(-1/(h*h))*(p-1)}h-=f/m}return new D($.NUM)})}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(r,i,s,o,a)=>(a=a?1:0,r===-1?i===0?new D($.NUM):new D($.DIV_BY_ZERO):r===0?-s*i-o:((1-Math.pow(1+r,i))*s*(1+r*a)/r-o)/Math.pow(1+r,i)))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(r,i,s)=>i===0||s<0&&i>0||s>0&&i<0?new D($.NUM):Math.pow(s/i,1/r)-1)}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(r,i,s)=>s===0?new D($.DIV_BY_ZERO):(r-i)/s)}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(r,i,s,o)=>o>s?new D($.NUM):(r-i)*(s-o+1)*2/(s*(s+1)))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(r,i,s)=>{if(r=Math.round(r),i=Math.round(i),r>=i)return new D($.NUM);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);if(a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day))return new D($.NUM);const l=360-s*(i-r);return l===0?0:l<0?new D($.NUM):365*s/l})}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(r,i,s)=>{if(r=Math.round(r),i=Math.round(i),r>=i)return new D($.NUM);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);if(a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day))return new D($.NUM);const l=360-s*(i-r);return l===0?0:l<0?new D($.NUM):100*(1-s*(i-r)/360)})}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(r,i,s)=>{if(r=Math.round(r),i=Math.round(i),r>=i)return new D($.NUM);const o=this.dateTimeHelper.numberToSimpleDate(r),a=this.dateTimeHelper.numberToSimpleDate(i);return a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day)?new D($.NUM):(100-s)*360/(s*(i-r))})}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(r,i)=>{const s=i.valuesFromTopLeftCorner();for(const o of s)if(o instanceof D)return o;for(const o of s)if(At(o))r*=1+Le(o);else if(o!==ht)return new D($.VALUE,Q.NumberExpected);return r})}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),(r,...i)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(i);return s instanceof D?s:U6(r,s)})}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),(r,i,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());if(o instanceof D)return o;let a=!1,l=!1;const u=[],c=[];for(const m of o)m>0?(a=!0,u.push(m),c.push(0)):m<0?(l=!0,c.push(m),u.push(0)):(c.push(0),u.push(0));if(!a||!l)return new D($.DIV_BY_ZERO);const h=o.length,d=U6(s,u);if(d instanceof D)return d;const f=U6(i,c);return f instanceof D?f:Math.pow(-d*Math.pow(1+s,h)/f/(1+i),1/(h-1))-1})}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(r,i,s)=>(Math.log(s)-Math.log(i))/Math.log(1+r))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(r,i,s)=>{const o=i.valuesFromTopLeftCorner();for(const d of o)if(typeof d!="number")return new D($.VALUE,Q.NumberExpected);const a=o,l=s.valuesFromTopLeftCorner();for(const d of l)if(typeof d!="number")return new D($.VALUE,Q.NumberExpected);const u=l;if(u.length!==a.length)return new D($.NUM,Q.EqualLength);const c=u.length;let h=0;if(u[0]<0)return new D($.NUM,Q.ValueSmall);for(let d=0;d<c;d++){if(u[d]=Math.floor(u[d]),u[d]<u[0])return new D($.NUM,Q.ValueSmall);h+=a[d]/Math.pow(1+r,(u[d]-u[0])/365)}return h})}}LO.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:0}],returnNumberType:He.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:0}],returnNumberType:He.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:0}],returnNumberType:He.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:0}],returnNumberType:He.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.INTEGER,minValue:1},{argumentType:w.INTEGER,minValue:1},{argumentType:w.INTEGER,minValue:0,maxValue:1}],returnNumberType:He.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.INTEGER,minValue:1},{argumentType:w.INTEGER,minValue:1},{argumentType:w.INTEGER,minValue:0,maxValue:1}],returnNumberType:He.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.INTEGER,minValue:0},{argumentType:w.INTEGER,minValue:0},{argumentType:w.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:He.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.INTEGER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:He.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:1}],returnNumberType:He.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:1}],returnNumberType:He.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:0}],returnNumberType:He.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:.1}],returnNumberType:He.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER},{argumentType:w.NUMBER}],returnNumberType:He.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER}],returnNumberType:He.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0}],returnNumberType:He.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,greaterThan:0}],returnNumberType:He.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,greaterThan:0}],returnNumberType:He.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,greaterThan:0}],returnNumberType:He.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:w.NUMBER},{argumentType:w.RANGE}],returnNumberType:He.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:w.NUMBER},{argumentType:w.ANY}],repeatLastArgs:1,returnNumberType:He.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:w.RANGE},{argumentType:w.NUMBER},{argumentType:w.NUMBER}],returnNumberType:He.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:w.NUMBER,greaterThan:-1},{argumentType:w.RANGE},{argumentType:w.RANGE}]}};function fb(n,e,t,r,i){if(n===0)return(-t-r)/e;{const s=Math.pow(1+n,e);return(r*n+t*n*s)*(i?1/(1+n):1)/(1-s)}}function Pw(n,e,t,r,i,s){const o=fb(n,t,r,i,s);return e===1?n*(s?0:-r):n*(s?Dw(n,e-2,o,r,s)-o:Dw(n,e-1,o,r,s))}function Dw(n,e,t,r,i){if(n===0)return-r-t*e;{const s=Math.pow(1+n,e);return t*(i?1+n:1)*(1-s)/n-r*s}}function G4(n,e,t,r,i,s){return fb(n,t,r,i,s)-Pw(n,e,t,r,i,s)}function U6(n,e){let t=0;for(let r=e.length-1;r>=0;r--){if(t+=e[r],n===-1){if(t===0)continue;return new D($.DIV_BY_ZERO)}t/=1+n}return t}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class PO extends nt{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),()=>new D($.NA,Q.WrongArgNumber),r=>{var i;return(i=this.serialization.getCellFormula(r))!==null&&i!==void 0?i:new D($.NA,Q.Formula)})}}PO.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:w.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class DO extends nt{hyperlink(e,t){return this.runFunction(e.args,t,this.metadata("HYPERLINK"),(r,i)=>(e.hyperlink=r,i!=null?i:r))}}DO.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:w.STRING},{argumentType:w.STRING,optionalArg:!0}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class kO extends nt{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),r=>/^[01]{1,10}$/.test(r))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),r=>r instanceof D&&r.type!==$.NA)}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),r=>r instanceof D)}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),()=>new D($.NA,Q.WrongArgNumber),r=>this.dependencyGraph.addressMapping.getCell(r)instanceof hi)}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),r=>r===ht)}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),r=>r instanceof D&&r.type==$.NA)}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),At)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),r=>typeof r=="boolean")}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),r=>r instanceof D&&(r.type==$.REF||r.type==$.CYCLE))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),r=>typeof r=="string")}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),r=>typeof r!="string")}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),()=>t.formulaAddress.col+1,r=>r.col+1)}columns(e,t){if(e.args.length!==1)return new D($.NA,Q.WrongArgNumber);if(e.args.some(i=>i.type===W.EMPTY))return new D($.NUM,Q.EmptyArg);let r=e.args[0];for(;r.type===W.PARENTHESIS;)r=r.expression;if(r.type===W.CELL_RANGE||r.type===W.COLUMN_RANGE)return r.end.col-r.start.col+1;if(r.type===W.CELL_REFERENCE)return 1;if(r.type===W.ROW_RANGE)return this.config.maxColumns;{const i=this.evaluateAst(r,t);return i instanceof Be?i.width():i instanceof D?i:1}}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),()=>t.formulaAddress.row+1,r=>r.row+1)}rows(e,t){if(e.args.length!==1)return new D($.NA,Q.WrongArgNumber);if(e.args.some(i=>i.type===W.EMPTY))return new D($.NUM,Q.EmptyArg);let r=e.args[0];for(;r.type===W.PARENTHESIS;)r=r.expression;if(r.type===W.CELL_RANGE||r.type===W.ROW_RANGE)return r.end.row-r.start.row+1;if(r.type===W.CELL_REFERENCE)return 1;if(r.type===W.COLUMN_RANGE)return this.config.maxRows;{const i=this.evaluateAst(r,t);return i instanceof Be?i.height():i instanceof D?i:1}}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),(r,i,s)=>{var o,a,l,u,c,h;return s<1||i<1?new D($.VALUE,Q.LessThanOne):s>r.width()||i>r.height()?new D($.NUM,Q.ValueLarge):(h=(l=(a=(o=r==null?void 0:r.data)===null||o===void 0?void 0:o[i-1])===null||a===void 0?void 0:a[s-1])!==null&&l!==void 0?l:(c=(u=r==null?void 0:r.data)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c[0])!==null&&h!==void 0?h:new D($.VALUE,Q.CellRangeExpected)})}na(e,t){return new D($.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),()=>t.formulaAddress.sheet+1,r=>r.sheet+1,r=>{const i=this.dependencyGraph.sheetMapping.get(r);return i!==void 0?i+1:new D($.NA,Q.SheetRef)})}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new D($.VALUE,Q.CellRefExpected))}}kO.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:w.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:w.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:w.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:w.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:w.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:w.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:w.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:w.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:w.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:w.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:w.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:w.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:w.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:w.RANGE},{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:w.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:w.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:w.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:w.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class FO extends nt{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),r=>r%2===0)}}FO.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class HO extends nt{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),r=>r%2===1)}}HO.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class UO extends nt{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(r,i)=>Math.log(r)/Math.log(i))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}UO.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:w.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const kw=parseFloat(Math.PI.toFixed(14));class BO extends nt{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),()=>kw)}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),r=>Math.sqrt(kw*r))}}BO.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:w.NUMBER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function z4(n,e){return new lt(e.width,n.height)}function B6(n,e,t){return new lt(1+(n.width-e)/t,1+(n.height-e)/t)}class VO extends nt{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),(r,i)=>{if(!r.hasOnlyNumbers()||!i.hasOnlyNumbers())return new D($.VALUE,Q.NumberRange);if(i.height()!==r.width())return new D($.VALUE,Q.ArrayDimensions);const s=z4(r.size,i.size),o=this.createKernel(function(a,l,u){let c=0;for(let h=0;h<u;++h)c+=a[this.thread.y][h]*l[h][this.thread.x];return c},s)(r.rawNumbers(),i.rawNumbers(),r.width());return Be.onlyNumbers(o)})}mmultArraySize(e,t){if(e.args.length!==2)return lt.error();const r=this.metadata("MMULT"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new Ls(t.formulaAddress,t.arraysFlag||((l=r==null?void 0:r.arrayFunction)!==null&&l!==void 0?l:!1)))}),[s,o]=i;return z4(s,o)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),(r,i,s=i)=>{if(!r.hasOnlyNumbers())return new D($.VALUE,Q.NumberRange);const o=B6(r.size,i,s),a=this.createKernel(function(l,u,c){const h=this.thread.x*c,d=this.thread.y*c;let f=l[d][h];for(let m=0;m<u;m++)for(let p=0;p<u;p++)f=Math.max(f,l[d+m][h+p]);return f},o)(r.rawNumbers(),i,s);return Be.onlyNumbers(a)})}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),(r,i,s=i)=>{if(!r.hasOnlyNumbers())return new D($.VALUE,Q.NumberRange);const o=B6(r.size,i,s),a=this.createKernel(function(l,u,c){const h=this.thread.x*c,d=this.thread.y*c;let f=l[d][h];for(let v=0;v<u;v++)for(let S=0;S<u;S++)f=Math.max(f,l[d+v][h+S]);let m=l[d][h];for(let v=0;v<u;v++)for(let S=0;S<u;S++)m=Math.min(m,l[d+v][h+S]);const p=u*u;let y=m,C=f,b=42;for(let v=0;v<32;v++){const S=(y+C)/2;let L=0;for(let _=0;_<u;_++)for(let P=0;P<u;P++)l[d+_][h+P]>S&&L++;if(u%2===0)if(L===p/2){b=S;break}else L>p/2?y=S:C=S;else if(L===(p-1)/2){b=S;break}else L>(p-1)/2?y=S:C=S}return b},o)(r.rawNumbers(),i,s);return Be.onlyNumbers(a)})}maxpoolArraySize(e,t){if(e.args.length<2||e.args.length>3)return lt.error();const r=this.metadata("MAXPOOL"),s=e.args.map(u=>{var c;return this.arraySizeForAst(u,new Ls(t.formulaAddress,t.arraysFlag||((c=r==null?void 0:r.arrayFunction)!==null&&c!==void 0?c:!1)))})[0],o=e.args[1];let a;o.type===W.NUMBER?a=o.value:a=1;let l=a;if(e.args.length===3){const u=e.args[2];u.type===W.NUMBER?l=u.value:l=1}return a>s.width||a>s.height||l>a||(s.width-a)%l!==0||(s.height-a)%l!==0?lt.error():B6(s,a,l)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),r=>{const i=r.rawData(),s=r.size,o=[];for(let a=0;a<s.width;++a){o[a]=[];for(let l=0;l<s.height;++l)o[a][l]=i[l][a]}return Be.onlyValues(o)})}transposeArraySize(e,t){if(e.args.length!==1)return lt.error();const r=this.metadata("TRANSPOSE"),i=e.args.map(o=>{var a;return this.arraySizeForAst(o,new Ls(t.formulaAddress,t.arraysFlag||((a=r==null?void 0:r.arrayFunction)!==null&&a!==void 0?a:!1)))}),[s]=i;return new lt(s.height,s.width)}createKernel(e,t){return function(...r){const i=[];for(let s=0;s<t.height;++s){i.push([]);for(let o=0;o<t.width;++o)i[s][o]=e.apply({thread:{x:o,y:s}},r)}return i}}}VO.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:w.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:w.RANGE},{argumentType:w.NUMBER},{argumentType:w.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:w.RANGE},{argumentType:w.NUMBER},{argumentType:w.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class $O extends nt{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);return i instanceof D?i:i.length===0?new D($.NUM,Q.OneValue):(i.sort((s,o)=>s-o),i.length%2===0?(i[i.length/2-1]+i[i.length/2])/2:i[Math.floor(i.length/2)])})}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),(r,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());return s instanceof D?s:(s.sort((o,a)=>o-a),i=Math.trunc(i),i>s.length?new D($.NUM,Q.ValueLarge):s[s.length-i])})}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),(r,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());return s instanceof D?s:(s.sort((o,a)=>o-a),i=Math.trunc(i),i>s.length?new D($.NUM,Q.ValueLarge):s[i-1])})}}$O.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:w.RANGE},{argumentType:w.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:w.RANGE},{argumentType:w.NUMBER,minValue:1}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class WO extends nt{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(r,i)=>i===0?new D($.DIV_BY_ZERO):r%i)}}WO.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function om(n){return At(n)&&!Number.isFinite(Le(n))?0:n}class Xi{constructor(e,t,r){this.sumsq=e,this.sum=t,this.count=r}static single(e){return new Xi(e*e,e,1)}compose(e){return new Xi(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}varSValue(){if(this.count>1)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}varPValue(){if(this.count>0)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}Xi.empty=new Xi(0,0,0);class mb extends nt{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,r=>Math.pow(Le(r),2),lu)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){const r=this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(i,s)=>Math.max(i,s),Le,am);return om(r)}min(e,t){return this.doMin(e.args,t)}mina(e,t){const r=this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(i,s)=>Math.min(i,s),Le,am);return om(r)}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){var r;const i=this.reduce(e.args,t,Xi.empty,"_AGGREGATE_A",(s,o)=>s.compose(o),s=>Xi.single(Le(s)),am);return i instanceof D?i:(r=i.averageValue())!==null&&r!==void 0?r:new D($.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){var r;const i=this.reduceAggregateA(e.args,t);return i instanceof D?i:(r=i.varSValue())!==null&&r!==void 0?r:new D($.DIV_BY_ZERO)}varpa(e,t){var r;const i=this.reduceAggregateA(e.args,t);return i instanceof D?i:(r=i.varPValue())!==null&&r!==void 0?r:new D($.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof D)return r;{const i=r.varSValue();return i===void 0?new D($.DIV_BY_ZERO):Math.sqrt(i)}}stdevpa(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof D)return r;{const i=r.varPValue();return i===void 0?new D($.DIV_BY_ZERO):Math.sqrt(i)}}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new D($.NA,Q.WrongArgNumber);const r=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:w.NUMBER},t),i=e.args.slice(1);switch(r){case 1:case 101:return this.doAverage(i,t);case 2:case 102:return this.doCount(i,t);case 3:case 103:return this.doCounta(i,t);case 4:case 104:return this.doMax(i,t);case 5:case 105:return this.doMin(i,t);case 6:case 106:return this.doProduct(i,t);case 7:case 107:return this.doStdevS(i,t);case 8:case 108:return this.doStdevP(i,t);case 9:case 109:return this.doSum(i,t);case 10:case 110:return this.doVarS(i,t);case 11:case 111:return this.doVarP(i,t);default:return new D($.VALUE,Q.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,Xi.empty,"_AGGREGATE",(r,i)=>r.compose(i),r=>Xi.single(Le(r)),lu)}reduceAggregateA(e,t){return this.reduce(e,t,Xi.empty,"_AGGREGATE_A",(r,i)=>r.compose(i),r=>Xi.single(Le(r)),am)}doAverage(e,t){var r;const i=this.reduceAggregate(e,t);return i instanceof D?i:(r=i.averageValue())!==null&&r!==void 0?r:new D($.DIV_BY_ZERO)}doVarS(e,t){var r;const i=this.reduceAggregate(e,t);return i instanceof D?i:(r=i.varSValue())!==null&&r!==void 0?r:new D($.DIV_BY_ZERO)}doVarP(e,t){var r;const i=this.reduceAggregate(e,t);return i instanceof D?i:(r=i.varPValue())!==null&&r!==void 0?r:new D($.DIV_BY_ZERO)}doStdevS(e,t){const r=this.reduceAggregate(e,t);if(r instanceof D)return r;{const i=r.varSValue();return i===void 0?new D($.DIV_BY_ZERO):Math.sqrt(i)}}doStdevP(e,t){const r=this.reduceAggregate(e,t);if(r instanceof D)return r;{const i=r.varPValue();return i===void 0?new D($.DIV_BY_ZERO):Math.sqrt(i)}}doCount(e,t){return this.reduce(e,t,0,"COUNT",(r,i)=>r+i,Le,r=>At(r)?1:0)}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",(r,i)=>r+i,Le,r=>r===ht?0:1)}doMax(e,t){const r=this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(i,s)=>Math.max(i,s),Le,lu);return om(r)}doMin(e,t){const r=this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",(i,s)=>Math.min(i,s),Le,lu);return om(r)}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,Le,lu)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",(r,i)=>r*i,Le,lu)}reduce(e,t,r,i,s,o,a){return e.length<1?new D($.NA,Q.WrongArgNumber):e.reduce((l,u)=>{if(l instanceof D)return l;if(u.type===W.CELL_RANGE||u.type===W.COLUMN_RANGE||u.type===W.ROW_RANGE){const h=this.evaluateRange(u,t,r,i,s,o,a);return h instanceof D?h:s(h,l)}let c;if(c=this.evaluateAst(u,t),c instanceof Be)return Array.from(c.valuesFromTopLeftCorner()).map(a).filter(d=>d!==void 0).map(d=>d instanceof D?d:o(d)).reduce((d,f)=>d instanceof D?d:f instanceof D?f:s(d,f),l);if(u.type===W.CELL_REFERENCE){if(c=a(c),c===void 0)return l}else if(c=this.coerceScalarToNumberOrError(c),c=a(c),c===void 0)return l;return c instanceof D?c:s(l,o(c))},r)}evaluateRange(e,t,r,i,s,o,a){let l;try{l=We.fromAst(e,t.formulaAddress)}catch(h){if(h instanceof ad)return new D($.REF,Q.RangeManySheets);throw h}const u=this.dependencyGraph.getRange(l.start,l.end);if(u===void 0)throw new Error("Range does not exists in graph");let c=u.getFunctionValue(i);return c===void 0&&(c=this.getRangeValues(i,l,u,o,a).reduce((d,f)=>d instanceof D?d:f instanceof D?f:s(d,f),r),u.setFunctionValue(i,c)),c}getRangeValues(e,t,r,i,s){const o=[],{smallerRangeVertex:a,restRange:l}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let u;if(a!==void 0&&this.dependencyGraph.existsEdge(a,r)){const c=a.getFunctionValue(e);if(c!==void 0)o.push(c);else for(const h of a.range.addresses(this.dependencyGraph)){const d=s(this.dependencyGraph.getScalarValue(h));d instanceof D?o.push(d):d!==void 0&&o.push(i(d))}u=l}else u=t;for(const c of u.addresses(this.dependencyGraph)){const h=s(this.dependencyGraph.getScalarValue(c));h instanceof D?o.push(h):h!==void 0&&o.push(i(h))}return o}}mb.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:w.NUMBER},{argumentType:w.ANY}],repeatLastArgs:1}};mb.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};function lu(n){if(At(n)||n instanceof D)return n}function am(n){return typeof n=="boolean"?Rw(n):At(n)||n instanceof D?n:typeof n=="string"?0:void 0}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class GO extends nt{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}GO.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class zO extends nt{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),r=>r*(Math.PI/180))}}zO.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Zn=10,YO=255,Y4=2,j4=36,Fue="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";class jO extends nt{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(r,i)=>ro(r,2,i))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(r,i)=>ro(r,8,i))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(r,i)=>ro(r,16,i))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),r=>{const i=ys(r,2,Zn);return i===void 0?new D($.NUM,Q.NotBinary):io(i,2)})}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(r,i)=>{const s=ys(r,2,Zn);return s===void 0?new D($.NUM,Q.NotBinary):ro(io(s,2),8,i)})}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(r,i)=>{const s=ys(r,2,Zn);return s===void 0?new D($.NUM,Q.NotBinary):ro(io(s,2),16,i)})}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),r=>{const i=ys(r,8,Zn);return i===void 0?new D($.NUM,Q.NotOctal):io(i,8)})}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(r,i)=>{const s=ys(r,8,Zn);return s===void 0?new D($.NUM,Q.NotOctal):ro(io(s,8),2,i)})}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(r,i)=>{const s=ys(r,8,Zn);return s===void 0?new D($.NUM,Q.NotOctal):ro(io(s,8),16,i)})}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),r=>{const i=ys(r,16,Zn);return i===void 0?new D($.NUM,Q.NotHex):io(i,16)})}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(r,i)=>{const s=ys(r,16,Zn);return s===void 0?new D($.NUM,Q.NotHex):ro(io(s,16),2,i)})}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(r,i)=>{const s=ys(r,16,Zn);return s===void 0?new D($.NUM,Q.NotHex):ro(io(s,16),8,i)})}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),Uue)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(r,i)=>{const s=ys(r,i,YO);return s===void 0?new D($.NUM,Q.NotHex):parseInt(s,i)})}}jO.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:w.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,optionalArg:!0,minValue:0,maxValue:Zn}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,optionalArg:!0,minValue:0,maxValue:Zn}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:w.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,optionalArg:!0,minValue:0,maxValue:Zn}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,optionalArg:!0,minValue:0,maxValue:Zn}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:w.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,optionalArg:!0,minValue:0,maxValue:Zn}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,optionalArg:!0,minValue:0,maxValue:Zn}]},DECIMAL:{method:"decimal",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,minValue:Y4,maxValue:j4}]},BASE:{method:"base",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:Y4,maxValue:j4},{argumentType:w.NUMBER,optionalArg:!0,minValue:0,maxValue:YO}]}};function ys(n,e,t){const r=Fue.substr(0,e),i=new RegExp(`^[${r}]+$`);if(!(n.length>t||!i.test(n)))return n}function ro(n,e,t){if(n>Hue(e))return new D($.NUM,Q.ValueBaseLarge);if(n<KO(e))return new D($.NUM,Q.ValueBaseSmall);const r=qO(n,e);return t===void 0||n<0?r:r.length>t?new D($.NUM,Q.ValueBaseLong):jr(r,t)}function KO(n){return-Math.pow(n,Zn)/2}function Hue(n){return-KO(n)-1}function Uue(n,e,t){const r=qO(n,e);return t!==void 0&&t>r.length?jr(r,t):r}function qO(n,e){const t=n<0?Math.pow(e,Zn):0;return(n+t).toString(e).toUpperCase()}function io(n,e){const t=parseInt(n,e),r=Math.pow(e,Zn);return t>=r/2?t-r:t}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class XO extends nt{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(r,i)=>i<r?new D($.NUM,Q.WrongOrder):(r=Math.ceil(r),i=Math.floor(i)+1,r===i&&(i+=1),r+Math.floor(Math.random()*(i-r))))}}XO.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER}],isVolatile:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function K4(n){const e=Math.ceil(n);return e%2===1?e:e+1}function q4(n){const e=Math.ceil(n);return e%2===0?e:e+1}class pb extends nt{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(r,i)=>{const s=Math.pow(10,i);return r<0?-Math.ceil(-r*s)/s:Math.ceil(r*s)/s})}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(r,i)=>{const s=Math.pow(10,i);return r<0?-Math.floor(-r*s)/s:Math.floor(r*s)/s})}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(r,i)=>{const s=Math.pow(10,i);return r<0?-Math.round(-r*s)/s:Math.round(r*s)/s})}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),r=>r<0?-Math.floor(-r):Math.floor(r))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),r=>r<0?-q4(-r):q4(r))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),r=>r<0?-K4(-r):K4(r))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(r,i,s)=>i===0||r===0?0:(i=Math.abs(i),s===1&&r<0&&(i=-i),Math.ceil(r/i)*i))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(r,i)=>r===0?0:i===0?new D($.DIV_BY_ZERO):r>0&&i<0?new D($.NUM,Q.DistinctSigns):Math.ceil(r/i)*i)}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(r,i)=>i===0||r===0?0:(i=Math.abs(i),Math.ceil(r/i)*i))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(r,i,s)=>i===0||r===0?0:(i=Math.abs(i),s===1&&r<0&&(i*=-1),Math.floor(r/i)*i))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(r,i)=>r===0?0:i===0?new D($.DIV_BY_ZERO):r>0&&i<0?new D($.NUM,Q.DistinctSigns):Math.floor(r/i)*i)}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(r,i)=>i===0||r===0?0:(i=Math.abs(i),Math.floor(r/i)*i))}}pb.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:w.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:w.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:w.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:1},{argumentType:w.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:1},{argumentType:w.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:1}]}};pb.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class QO extends nt{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}QO.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function*Bue(){}function Vue(n){const e=n[Symbol.iterator](),{done:t,value:r}=e.next();return t?{rest:Bue()}:{value:r,rest:e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const $ue=(n,e,t)=>{if(t.end.row>t.start.row){const r=Pe(t.end.sheet,t.end.col,t.end.row-1),i=n.getRange(t.start,r);if(i!==void 0)return{smallerRangeVertex:i,restValuesRange:t.withStart(Pe(t.start.sheet,t.start.col,t.end.row)),restConditionRanges:e.map(s=>s.withStart(Pe(s.start.sheet,s.start.col,s.end.row)))}}return{restValuesRange:t,restConditionRanges:e}};class Wue{constructor(e,t,r,i,s){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=r,this.composeFunction=i,this.mapFunction=s,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const s of t)if(!s.conditionRange.sameDimensionsAs(e))return new D($.VALUE,Q.EqualLength);const r=this.tryToGetRangeVertexForRangeValue(e),i=t.map(s=>this.tryToGetRangeVertexForRangeValue(s.conditionRange));if(r&&i.every(s=>s!==void 0)){const s=t.map(l=>l.criterionPackage.raw).join(","),o=this.findAlreadyComputedValueInCache(r,this.cacheKey(t),s);if(o!==void 0)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),o;const a=this.buildNewCriterionCache(this.cacheKey(t),t.map(l=>l.conditionRange.range),e.range);return a.has(s)||a.set(s,[this.evaluateRangeValue(e,t),t.map(l=>l.criterionPackage.lambda)]),r.setCriterionFunctionValues(this.cacheKey(t),a),i.forEach(l=>{l!==void 0&&l.addDependentCacheRange(r)}),a.get(s)[0]}else return this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){const t=e.range;if(t!==void 0)return this.dependencyGraph.getRange(t.start,t.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const r of e)t=this.composeFunction(t,r);return t}findAlreadyComputedValueInCache(e,t,r){return e.getCriterionFunctionValue(t,r)}evaluateRangeValue(e,t){const r=t.map(a=>a.criterionPackage.lambda),i=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),s=t.map(a=>a.conditionRange.iterateValuesFromTopLeftCorner()),o=Q4(r,s,i);return this.reduceFunction(o)}buildNewCriterionCache(e,t,r){const i=this.dependencyGraph.getRange(r.start,r.end),{smallerRangeVertex:s,restConditionRanges:o,restValuesRange:a}=$ue(this.dependencyGraph,t,r);let l;s!==void 0&&this.dependencyGraph.existsEdge(s,i)?l=s.getCriterionFunctionValues(e):l=new Map;const u=new Map;return l.forEach(([c,h],d)=>{const f=Q4(h,o.map(p=>X4(this.dependencyGraph,p)),Array.from(X4(this.dependencyGraph,a)).map(this.mapFunction)[Symbol.iterator]()),m=this.composeFunction(c,this.reduceFunction(f));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),u.set(d,[m,h])}),u}}class Gue{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}function*X4(n,e){for(const t of e.addresses(n))yield Le(n.getScalarValue(t))}function*Q4(n,e,t){for(const r of t){const i=e.map(o=>Vue(o));if(!i.every(o=>Object.prototype.hasOwnProperty.call(o,"value")))return;const s=i.map(o=>Le(o.value));zue(s,n).every(([o,a])=>a(o))&&(yield r),e=i.map(o=>o.rest)}}function zue(n,e){const t=[];for(let r=0;r<Math.min(n.length,e.length);r++)t.push([n[r],e[r]]);return t}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ia{constructor(e,t){this.sum=e,this.count=t}static single(e){return new ia(e,1)}compose(e){return new ia(this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}}ia.empty=new ia(0,0);function Yue(n){return e=>{const t=e.map(r=>`${r.conditionRange.range.sheet},${r.conditionRange.range.start.col},${r.conditionRange.range.start.row}`);return[n,...t].join(",")}}function Z4(n){return At(n)&&!Number.isFinite(Le(n))?0:n}function lm(n){if(n instanceof D)return n;if(At(n))return Le(n)}class ZO extends nt{sumif(e,t){const r="SUMIF",i=(s,o,a)=>this.computeConditionalAggregationFunction(a!=null?a:s,[s,o],r,0,(l,u)=>this.arithmeticHelper.nonstrictadd(l,u),lm);return this.runFunction(e.args,t,this.metadata(r),i)}sumifs(e,t){const r="SUMIFS",i=(s,...o)=>this.computeConditionalAggregationFunction(s,o,r,0,(a,l)=>this.arithmeticHelper.nonstrictadd(a,l),lm);return this.runFunction(e.args,t,this.metadata(r),i)}averageif(e,t){const r="AVERAGEIF",i=(s,o,a)=>{const l=this.computeConditionalAggregationFunction(a!=null?a:s,[s,o],r,ia.empty,(u,c)=>u.compose(c),u=>At(u)?ia.single(Le(u)):ia.empty);return l instanceof D?l:l.averageValue()||new D($.DIV_BY_ZERO)};return this.runFunction(e.args,t,this.metadata(r),i)}countif(e,t){const r="COUNTIF",i=(s,o)=>this.computeConditionalAggregationFunction(s,[s,o],r,0,(a,l)=>a+l,()=>1);return this.runFunction(e.args,t,this.metadata(r),i)}countifs(e,t){const r="COUNTIFS",i=(...s)=>this.computeConditionalAggregationFunction(s[0],s,r,0,(o,a)=>o+a,()=>1);return this.runFunction(e.args,t,this.metadata(r),i)}minifs(e,t){const r="MINIFS",i=(o,a)=>a===void 0||o===void 0?a===void 0?o:a:Math.min(o,a),s=(o,...a)=>{const l=this.computeConditionalAggregationFunction(o,a,r,Number.POSITIVE_INFINITY,i,lm);return Z4(l)};return this.runFunction(e.args,t,this.metadata(r),s)}maxifs(e,t){const r="MAXIFS",i=(o,a)=>a===void 0||o===void 0?a===void 0?o:a:Math.max(o,a),s=(o,...a)=>{const l=this.computeConditionalAggregationFunction(o,a,r,Number.NEGATIVE_INFINITY,i,lm);return Z4(l)};return this.runFunction(e.args,t,this.metadata(r),s)}computeConditionalAggregationFunction(e,t,r,i,s,o){const a=[];for(let l=0;l<t.length;l+=2){const u=t[l],c=this.interpreter.criterionBuilder.fromCellValue(t[l+1],this.arithmeticHelper);if(c===void 0)return new D($.VALUE,Q.BadCriterion);a.push(new Gue(u,c))}return new Wue(this.interpreter,Yue(r),i,s,o).compute(e,a)}}ZO.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:w.RANGE},{argumentType:w.NOERROR},{argumentType:w.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:w.RANGE},{argumentType:w.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:w.RANGE},{argumentType:w.NOERROR},{argumentType:w.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE},{argumentType:w.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:w.RANGE},{argumentType:w.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE},{argumentType:w.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE},{argumentType:w.NOERROR}],repeatLastArgs:2}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class JO extends nt{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(...r)=>{const i=r[0].width(),s=r[0].height();for(const l of r)if(l.width()!==i||l.height()!==s)return new D($.VALUE,Q.EqualLength);let o=0;const a=r.map(l=>l.iterateValuesFromTopLeftCorner());for(let l=0;l<i*s;l++){let u=1;for(const c of a){const h=c.next().value;if(h instanceof D)return h;const d=this.coerceScalarToNumberOrError(h);At(d)?u*=Le(d):u=0}o+=u}return o})}}JO.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:w.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class e_ extends nt{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(...r)=>"".concat(...r))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(r,i)=>{const s=r.split(" ");return i>=s.length||i<0?new D($.VALUE,Q.IndexBounds):s[i]})}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),r=>r.length)}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),r=>r.toLowerCase())}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),r=>r.replace(/^ +| +$/g,"").replace(/ +/g," "))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),r=>r.replace(/\p{L}+/gu,i=>i.charAt(0).toUpperCase()+i.substring(1).toLowerCase()))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),r=>r.replace(/[\u0000-\u001F]/g,""))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(r,i)=>r===i)}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(r,i)=>i<0?new D($.VALUE,Q.NegativeCount):r.repeat(i))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(r,i)=>i<0?new D($.VALUE,Q.NegativeLength):i===0?"":r.slice(-i))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(r,i)=>i<0?new D($.VALUE,Q.NegativeLength):r.slice(0,i))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(r,i,s)=>i<1?new D($.VALUE,Q.LessThanOne):s<0?new D($.VALUE,Q.NegativeLength):r.substring(i-1,i+s-1))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(r,i,s,o)=>i<1?new D($.VALUE,Q.LessThanOne):s<0?new D($.VALUE,Q.NegativeLength):r.substring(0,i-1)+o+r.substring(i+s-1))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),(r,i,s)=>{if(s<1||s>i.length)return new D($.VALUE,Q.LengthBounds);const o=r.toLowerCase(),a=i.substring(s-1).toLowerCase(),l=this.arithmeticHelper.requiresRegex(o)?this.arithmeticHelper.searchString(o,a):a.indexOf(o);return l>-1?l+s:new D($.VALUE,Q.PatternNotFound)})}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(r,i,s,o)=>{const a=new RegExp(i,"g");if(o===void 0)return r.replace(a,s);if(o<1)return new D($.VALUE,Q.LessThanOne);let l,u=0;for(;(l=a.exec(r))!==null;)if(o===++u)return r.substring(0,l.index)+s+r.substring(a.lastIndex);return r})}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(r,i,s)=>{if(s<1||s>i.length)return new D($.VALUE,Q.IndexBounds);const a=i.substring(s-1).indexOf(r)+s;return a>0?a:new D($.VALUE,Q.PatternNotFound)})}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),r=>r instanceof D||typeof r=="string"?r:"")}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),r=>r.toUpperCase())}}e_.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:w.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:w.STRING},{argumentType:w.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:w.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:w.STRING}]},MID:{method:"mid",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER},{argumentType:w.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:w.STRING}]},T:{method:"t",parameters:[{argumentType:w.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:w.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:w.STRING}]},REPT:{method:"rept",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:w.STRING},{argumentType:w.STRING},{argumentType:w.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:w.STRING},{argumentType:w.STRING},{argumentType:w.STRING},{argumentType:w.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:w.STRING},{argumentType:w.STRING},{argumentType:w.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:w.STRING}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class t_ extends nt{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(r,i)=>r===0&&i===0?new D($.DIV_BY_ZERO):Math.atan2(i,r))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),r=>r===0?new D($.DIV_BY_ZERO):1/Math.tan(r))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),r=>r===0?kw/2:Math.atan(1/r))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),r=>1/Math.cos(r))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),r=>r===0?new D($.DIV_BY_ZERO):1/Math.sin(r))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),r=>r===0?new D($.DIV_BY_ZERO):1/Math.tanh(r))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),r=>r===0?new D($.NUM,Q.NonZero):Math.atanh(1/r))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),r=>1/Math.cosh(r))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),r=>r===0?new D($.DIV_BY_ZERO):1/Math.sinh(r))}}t_.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:w.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:w.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:w.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:w.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:w.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:w.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:w.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:w.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:w.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:w.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:w.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:w.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:w.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:w.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:w.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:w.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:w.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:w.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:w.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class jue extends dO{constructor(e){super(e),this.dependencyGraph=e}find(e,t,r){return this.basicFind(e,t,"col",r)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class n_ extends nt{constructor(){super(...arguments),this.rowSearch=new jue(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(r,i,s,o)=>{const a=i.range;return a===void 0?new D($.VALUE,Q.WrongType):s<1?new D($.VALUE,Q.LessThanOne):s>a.width()?new D($.REF,Q.IndexLarge):this.doVlookup(D6(r),i,s-1,o)})}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(r,i,s,o)=>{const a=i.range;return a===void 0?new D($.VALUE,Q.WrongType):s<1?new D($.VALUE,Q.LessThanOne):s>a.height()?new D($.REF,Q.IndexLarge):this.doHlookup(D6(r),i,s-1,o)})}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),(r,i,s)=>this.doMatch(D6(r),i,s))}searchInRange(e,t,r,i){if(!r&&typeof e=="string"&&this.arithmeticHelper.requiresRegex(e))return i.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t);{const s=r?{ordering:"asc"}:{ordering:"none",matchExactly:!0};return i.find(e,t,s)}}doVlookup(e,t,r,i){this.dependencyGraph.stats.start(Ze.VLOOKUP);const s=t.range;let o;s===void 0?o=Be.onlyValues(t.data.map(u=>[u[0]])):o=Be.onlyRange(We.spanFrom(s.start,1,s.height()),this.dependencyGraph);const a=this.searchInRange(e,o,i,this.columnSearch);if(this.dependencyGraph.stats.end(Ze.VLOOKUP),a===-1)return new D($.NA,Q.ValueNotFound);let l;if(s===void 0)l=t.data[a][r];else{const u=Pe(s.sheet,s.start.col+r,s.start.row+a);l=this.dependencyGraph.getCellValue(u)}return l instanceof Be?new D($.VALUE,Q.WrongType):l}doHlookup(e,t,r,i){const s=t.range;let o;s===void 0?o=Be.onlyValues([t.data[0]]):o=Be.onlyRange(We.spanFrom(s.start,s.width(),1),this.dependencyGraph);const a=this.searchInRange(e,o,i,this.rowSearch);if(a===-1)return new D($.NA,Q.ValueNotFound);let l;if(s===void 0)l=t.data[r][a];else{const u=Pe(s.sheet,s.start.col+a,s.start.row+r);l=this.dependencyGraph.getCellValue(u)}return l instanceof Be?new D($.VALUE,Q.WrongType):l}doMatch(e,t,r){if(![-1,0,1].includes(r))return new D($.VALUE,Q.BadMode);if(t.width()>1&&t.height()>1)return new D($.NA);const i=t.width()===1?this.columnSearch:this.rowSearch,s=r===0?{ordering:"none",matchExactly:!0}:{ordering:r===-1?"desc":"asc"},o=i.find(e,t,s);return o===-1?new D($.NA,Q.ValueNotFound):o+1}}n_.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:w.NOERROR},{argumentType:w.RANGE},{argumentType:w.NUMBER},{argumentType:w.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:w.NOERROR},{argumentType:w.RANGE},{argumentType:w.NUMBER},{argumentType:w.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:w.NOERROR},{argumentType:w.RANGE},{argumentType:w.NUMBER,defaultValue:1}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class r_ extends nt{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),(r,i)=>(r=Math.trunc(r),i===!1?i=4:i===!0&&(i=0),i=Le(this.coerceScalarToNumberOrError(i)),i instanceof D?i:(i=Math.trunc(i),i<0?new D($.VALUE,Q.ValueSmall):i>4?new D($.VALUE,Q.ValueLarge):Kue(r,i))))}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),r=>{r=r.trim().toUpperCase();let i=!1;if(r.startsWith("-")&&(r=r.slice(1),i=!0,r===""))return new D($.VALUE,Q.InvalidRoman);const s={input:r,acc:0};return ws(s,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),ws(s,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),ws(s,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),ws(s,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),ws(s,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),ws(s,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),ws(s,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),ws(s,{token:"IX",val:9}),ws(s,{token:"V",val:5},{token:"IV",val:4}),ws(s,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),s.input!==""?new D($.VALUE,Q.InvalidRoman):i?-s.acc:s.acc})}}r_.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:w.NUMBER,minValue:1,lessThan:4e3},{argumentType:w.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:w.STRING}]}};function ws(n,...e){for(const t of e)if(n.input.startsWith(t.token)){n.input=n.input.slice(t.token.length),n.acc+=t.val;break}}function Kue(n,e){const t={val:n%1e3,acc:"M".repeat(Math.floor(n/1e3))};return e===4&&(xn(t,"IM",999,1e3),xn(t,"ID",499,500)),e>=3&&(xn(t,"VM",995,1e3),xn(t,"VD",495,500)),e>=2&&(xn(t,"XM",990,1e3),xn(t,"XD",490,500)),e>=1&&(xn(t,"LM",950,1e3),xn(t,"LD",450,500)),xn(t,"CM",900,1e3),xn(t,"CD",400,500),xn(t,"D",500,900),t.acc+="C".repeat(Math.floor(t.val/100)),t.val%=100,e>=2&&(xn(t,"IC",99,100),xn(t,"IL",49,50)),e>=1&&(xn(t,"VC",95,100),xn(t,"VL",45,50)),xn(t,"XC",90,100),xn(t,"XL",40,50),xn(t,"L",50,90),t.acc+="X".repeat(Math.floor(t.val/10)),t.val%=10,xn(t,"IX",9,10),xn(t,"IV",4,5),xn(t,"V",5,9),t.acc+="I".repeat(t.val),t.acc}function xn(n,e,t,r){n.val>=t&&n.val<r&&(n.val-=t,n.acc+=e)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class i_ extends nt{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}i_.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:w.NUMBER,passSubtype:!0},{argumentType:w.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:w.STRING,passSubtype:!0},{argumentType:w.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:w.NUMBER,passSubtype:!0},{argumentType:w.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:w.NOERROR,passSubtype:!0},{argumentType:w.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:w.NOERROR,passSubtype:!0},{argumentType:w.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:w.NOERROR,passSubtype:!0},{argumentType:w.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:w.NOERROR,passSubtype:!0},{argumentType:w.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:w.NOERROR,passSubtype:!0},{argumentType:w.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:w.NUMBER,passSubtype:!0},{argumentType:w.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:w.NUMBER,passSubtype:!0},{argumentType:w.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:w.NOERROR,passSubtype:!0},{argumentType:w.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:w.NUMBER,passSubtype:!0},{argumentType:w.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:w.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:w.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:w.NUMBER,passSubtype:!0}]}};/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */var it=Math;function nn(n,e){for(var t=0,r=0;t<n.length;++t)r=e*r+n[t];return r}function s_(n,e,t,r,i){if(e===0)return t;if(e===1)return r;for(var s=2/n,o=r,a=1;a<e;++a)o=r*a*s+i*t,t=r,r=o;return o}function o_(n,e,t,r,i){return function(o,a){if(r){if(o===0)return r==1?-1/0:1/0;if(o<0)return NaN}if(a===0)return n(o);if(a===1)return e(o);if(a<0)return NaN;a|=0;var l=n(o),u=e(o);return s_(o,a,l,u,i)}}var Fw=function(){var n=.636619772,e=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),t=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function s(h){var d=0,f=0,m=0,p=h*h;if(h<8)f=nn(e,p),m=nn(t,p),d=f/m;else{var y=h-.785398164;p=64/p,f=nn(r,p),m=nn(i,p),d=it.sqrt(n/h)*(it.cos(y)*f-it.sin(y)*m*8/h)}return d}var o=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),a=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(h){var d=0,f=0,m=0,p=h*h,y=it.abs(h)-2.356194491;return Math.abs(h)<8?(f=h*nn(o,p),m=nn(a,p),d=f/m):(p=64/p,f=nn(l,p),m=nn(u,p),d=it.sqrt(n/it.abs(h))*(it.cos(y)*f-it.sin(y)*m*8/it.abs(h)),h<0&&(d=-d)),d}return function h(d,f){if(f=Math.round(f),!isFinite(d))return isNaN(d)?d:0;if(f<0)return(f%2?-1:1)*h(d,-f);if(d<0)return(f%2?-1:1)*h(-d,f);if(f===0)return s(d);if(f===1)return c(d);if(d===0)return 0;var m=0;if(d>f)m=s_(d,f,s(d),c(d),-1);else{for(var p=2*it.floor((f+it.floor(it.sqrt(40*f)))/2),y=!1,C=0,b=0,v=1,S=0,L=2/d,_=p;_>0;_--)S=_*L*v-C,C=v,v=S,it.abs(v)>1e10&&(v*=1e-10,C*=1e-10,m*=1e-10,b*=1e-10),y&&(b+=v),y=!y,_==f&&(m=C);b=2*b-v,m/=b}return m}}(),que=function(){var n=.636619772,e=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),t=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function s(h){var d=0,f=0,m=0,p=h*h,y=h-.785398164;return h<8?(f=nn(e,p),m=nn(t,p),d=f/m+n*Fw(h,0)*it.log(h)):(p=64/p,f=nn(r,p),m=nn(i,p),d=it.sqrt(n/h)*(it.sin(y)*f+it.cos(y)*m*8/h)),d}var o=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),a=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(h){var d=0,f=0,m=0,p=h*h,y=h-2.356194491;return h<8?(f=h*nn(o,p),m=nn(a,p),d=f/m+n*(Fw(h,1)*it.log(h)-1/h)):(p=64/p,f=nn(l,p),m=nn(u,p),d=it.sqrt(n/h)*(it.sin(y)*f+it.cos(y)*m*8/h)),d}return o_(s,c,"BESSELY",1,-1)}(),Hw=function(){var n=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function t(o){return o<=3.75?nn(n,o*o/(3.75*3.75)):it.exp(it.abs(o))/it.sqrt(it.abs(o))*nn(e,3.75/it.abs(o))}var r=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),i=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function s(o){return o<3.75?o*nn(r,o*o/(3.75*3.75)):(o<0?-1:1)*it.exp(it.abs(o))/it.sqrt(it.abs(o))*nn(i,3.75/it.abs(o))}return function o(a,l){if(l=Math.round(l),l===0)return t(a);if(l===1)return s(a);if(l<0)return NaN;if(it.abs(a)===0)return 0;if(a==1/0)return 1/0;var u=0,c,h=2/it.abs(a),d=0,f=1,m=0,p=2*it.round((l+it.round(it.sqrt(40*l)))/2);for(c=p;c>0;c--)m=c*h*f+d,d=f,f=m,it.abs(f)>1e10&&(f*=1e-10,d*=1e-10,u*=1e-10),c==l&&(u=d);return u*=o(a,0)/f,a<0&&l%2?-u:u}}(),Xue=function(){var n=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),e=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function t(o){return o<=2?-it.log(o/2)*Hw(o,0)+nn(n,o*o/4):it.exp(-o)/it.sqrt(o)*nn(e,2/o)}var r=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),i=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function s(o){return o<=2?it.log(o/2)*Hw(o,1)+1/o*nn(r,o*o/4):it.exp(-o)/it.sqrt(o)*nn(i,2/o)}return o_(t,s,"BESSELK",2,1)}();/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */function Uu(n){const e=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let t=e.length-1,r=!1,i=0,s=0,o,a,l,u;if(n===0)return 0;for(n<0&&(n=-n,r=!0),o=2/(2+n),a=4*o-2;t>0;t--)l=i,i=a*i-s+e[t],s=l;return u=o*Math.exp(-n*n+.5*(e[0]+a*i)-s),r?u-1:1-u}function a_(n){return 1-Uu(n)}function l_(n){let e=0,t,r,i,s;if(n>=2)return-100;if(n<=0)return 100;for(s=n<1?n:2-n,i=Math.sqrt(-2*Math.log(s/2)),t=-.70711*((2.30753+i*.27061)/(1+i*(.99229+i*.04481))-i);e<2;e++)r=a_(t)-s,t+=r/(1.1283791670955126*Math.exp(-t*t)-t*r);return n<1?t:-t}const J4={pdf:(n,e)=>n<0?0:e*Math.exp(-e*n),cdf:(n,e)=>n<0?0:1-Math.exp(-e*n)};function _h(n){const e=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],t=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let r=!1,i=0,s=0,o=0,a=n,l,u,c,h;if(n>171.6243769536076)return 1/0;if(a<=0)if(h=a%1,h)r=(a&1?-1:1)*Math.PI/Math.sin(Math.PI*h),a=1-a;else return 1/0;for(c=a,a<1?u=a++:u=(a-=i=(a|0)-1)-1,l=0;l<8;++l)o=(o+e[l])*u,s=s*u+t[l];if(h=o/s+1,c<a)h/=c;else if(c>a)for(l=0;l<i;++l)h*=a,a++;return r&&(h=r/h),h}const V6={pdf:function(e,t,r){return e<0?0:e===0&&t===1?1/r:Math.exp((t-1)*Math.log(e)-e/r-tr(t)-t*Math.log(r))},cdf:function(e,t,r){return e<0?0:gb(t,e/r)},inv:function(n,e,t){return u_(n,e)*t}};function tr(n){let e=0;const t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let r=1.000000000190015,i,s,o;for(o=(s=i=n)+5.5,o-=(i+.5)*Math.log(o);e<6;e++)r+=t[e]/++s;return Math.log(2.5066282746310007*r/i)-o}function gb(n,e){const t=tr(n);let r=n,i=1/n,s=i,o=e+1-n,a=1/1e-30,l=1/o,u=l,c=1;const h=-~(Math.log(n>=1?n:1/n)*8.5+n*.4+17);let d;if(e<0||n<=0)return NaN;if(e<n+1){for(;c<=h;c++)i+=s*=e/++r;return i*Math.exp(-e+n*Math.log(e)-t)}for(;c<=h;c++)d=-c*(c-n),o+=2,l=d*l+o,a=o+d/a,l=1/l,u*=l*a;return 1-u*Math.exp(-e+n*Math.log(e)-t)}function u_(n,e){let t=0;const r=e-1,i=1e-8,s=tr(e);let o,a,l,u,c,h,d;if(n>=1)return Math.max(100,e+100*Math.sqrt(e));if(n<=0)return 0;for(e>1?(h=Math.log(r),d=Math.exp(r*(h-1)-s),c=n<.5?n:1-n,l=Math.sqrt(-2*Math.log(c)),o=(2.30753+l*.27061)/(1+l*(.99229+l*.04481))-l,n<.5&&(o=-o),o=Math.max(.001,e*Math.pow(1-1/(9*e)-o/(3*Math.sqrt(e)),3))):(l=1-e*(.253+e*.12),n<l?o=Math.pow(n/l,1/e):o=1-Math.log(1-(n-l)/(1-l)));t<12;t++){if(o<=0)return 0;if(a=gb(e,o)-n,e>1?l=d*Math.exp(-(o-r)+r*(Math.log(o)-h)):l=Math.exp(-o+r*Math.log(o)-s),u=a/l,o-=l=u/(1-.5*Math.min(1,u*((e-1)/o-1))),o<=0&&(o=.5*(o+l)),Math.abs(l)<i*o)break}return o}const ji={pdf:function(e,t,r){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(e-t,2)/(2*r*r))},cdf:function(e,t,r){return .5*(1+Uu((e-t)/Math.sqrt(2*r*r)))},inv:function(n,e,t){return-1.4142135623730951*t*l_(2*n)+e}},$6={pdf:function(e,t,r){return e>1||e<0?0:t==1&&r==1?1:t<512&&r<512?Math.pow(e,t-1)*Math.pow(1-e,r-1)/yb(t,r):Math.exp((t-1)*Math.log(e)+(r-1)*Math.log(1-e)-c_(t,r))},cdf:function(e,t,r){return e>1||e<0?+(e>1):F1(e,t,r)},inv:function(e,t,r){return wb(e,t,r)}};function yb(n,e){if(!(n<=0||e<=0))return n+e>170?Math.exp(c_(n,e)):_h(n)*_h(e)/_h(n+e)}function c_(n,e){return tr(n)+tr(e)-tr(n+e)}function wb(n,e,t){var r=1e-8,i=e-1,s=t-1,o=0,a,l,u,c,h,d,f,m,p,y,C;if(n<=0)return 0;if(n>=1)return 1;for(e>=1&&t>=1?(u=n<.5?n:1-n,c=Math.sqrt(-2*Math.log(u)),f=(2.30753+c*.27061)/(1+c*(.99229+c*.04481))-c,n<.5&&(f=-f),m=(f*f-3)/6,p=2/(1/(2*e-1)+1/(2*t-1)),y=f*Math.sqrt(m+p)/p-(1/(2*t-1)-1/(2*e-1))*(m+5/6-2/(3*p)),f=e/(e+t*Math.exp(2*y))):(a=Math.log(e/(e+t)),l=Math.log(t/(e+t)),c=Math.exp(e*a)/e,h=Math.exp(t*l)/t,y=c+h,n<c/y?f=Math.pow(e*y*n,1/e):f=1-Math.pow(t*y*(1-n),1/t)),C=-tr(e)-tr(t)+tr(e+t);o<10;o++){if(f===0||f===1)return f;if(d=F1(f,e,t)-n,c=Math.exp(i*Math.log(f)+s*Math.log(1-f)+C),h=d/c,f-=c=h/(1-.5*Math.min(1,h*(i/f-s/(1-f)))),f<=0&&(f=.5*(f+c)),f>=1&&(f=.5*(f+c+1)),Math.abs(c)<r*f&&o>0)break}return f}function F1(n,e,t){var r=n===0||n===1?0:Math.exp(tr(e+t)-tr(e)-tr(t)+e*Math.log(n)+t*Math.log(1-n));return n<0||n>1?!1:n<(e+1)/(e+t+2)?r*e8(n,e,t)/e:1-r*e8(1-n,t,e)/t}function e8(n,e,t){var r=1e-30,i=1,s=e+t,o=e+1,a=e-1,l=1,u=1-s*n/o,c,h,d,f;for(Math.abs(u)<r&&(u=r),u=1/u,f=u;i<=100&&(c=2*i,h=i*(t-i)*n/((a+c)*(e+c)),u=1+h*u,Math.abs(u)<r&&(u=r),l=1+h/l,Math.abs(l)<r&&(l=r),u=1/u,f*=u*l,h=-(e+i)*(s+i)*n/((e+c)*(o+c)),u=1+h*u,Math.abs(u)<r&&(u=r),l=1+h/l,Math.abs(l)<r&&(l=r),u=1/u,d=u*l,f*=d,!(Math.abs(d-1)<3e-7));i++);return f}const Ym={pdf:function(n,e,t){return t===0||t===1?e*t===n?1:0:h_(e,n)*Math.pow(t,n)*Math.pow(1-t,e-n)},cdf:function(n,e,t){var r,i=1e-10;if(n<0)return 0;if(n>=e)return 1;if(t<0||t>1||e<=0)return NaN;n=Math.floor(n);var s=t,o=n+1,a=e-n,l=o+a,u=Math.exp(tr(l)-tr(a)-tr(o)+o*Math.log(s)+a*Math.log(1-s));return s<(o+1)/(l+2)?r=u*t8(s,o,a,i):r=1-u*t8(1-s,a,o,i),Math.round((1-r)*(1/i))/(1/i)}};function t8(n,e,t,r){for(var i=0,s=1,o=1,a=1,l=0,u=0,c;Math.abs((o-u)/o)>r;)u=o,c=-(e+l)*(e+t+l)*n/(e+2*l)/(e+2*l+1),i=o+c*i,s=a+c*s,l=l+1,c=l*(t-l)*n/(e+2*l-1)/(e+2*l),o=i+c*o,a=s+c*a,i=i/a,s=s/a,o=o/a,a=1;return o/e}function h_(n,e){return n>170||e>170?Math.exp(Que(n,e)):jm(n)/jm(e)/jm(n-e)}function Que(n,e){return W6(n)-W6(e)-W6(n-e)}function W6(n){return n<0?NaN:tr(n+1)}function jm(n){return n<0?NaN:_h(n+1)}const Cu={pdf:function(e,t){return e<0?0:e===0&&t===2?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-tr(t/2))},cdf:function(e,t){return e<0?0:gb(t/2,e/2)},inv:function(n,e){return 2*u_(n,.5*e)}},Eu={pdf:function(e,t,r){var i,s,o;return e<0?0:t<=2?e===0&&t<2?1/0:e===0&&t===2?1:1/yb(t/2,r/2)*Math.pow(t/r,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/r*e,-(t+r)/2):(i=t*e/(r+e*t),s=r/(r+e*t),o=t*s/2,o*Ym.pdf((t-2)/2,(t+r-2)/2,i))},cdf:function(e,t,r){return e<0?0:F1(t*e/(t*e+r),t/2,r/2)},inv:function(e,t,r){return r/(t*(1/wb(e,t/2,r/2)-1))}},n8={pdf:function(e,t,r){return e<0||t<0||r<0?0:r/t*Math.pow(e/t,r-1)*Math.exp(-Math.pow(e/t,r))},cdf:function(e,t,r){return e<0?0:1-Math.exp(-Math.pow(e/t,r))}},Uw={pdf:function(e,t){return t<0||e%1!==0||e<0?0:Math.pow(t,e)*Math.exp(-t)/jm(e)},cdf:function(e,t){var r=0;if(e<0)return 0;for(var i=0;r<=e;r++)i+=Uw.pdf(r,t);return i}},co={pdf:function(e,t,r,i){if(e<0||e<r-(t-i))return 0;if(e>i||e>r)return 0;if(r*2>t)return i*2>t?co.pdf(t-r-i+e,t,t-r,t-i):co.pdf(i-e,t,t-r,i);if(i*2>t)return co.pdf(r-e,t,r,t-i);if(r<i)return co.pdf(e,t,i,r);for(var s=1,o=0,a=0;a<e;a++){for(;s>1&&o<i;)s*=1-r/(t-o),o++;s*=(i-a)*(r-a)/((a+1)*(t-r-i+a+1))}for(;o<i;o++)s*=1-r/(t-o);return Math.min(1,Math.max(0,s))},cdf:function n(e,t,r,i){if(e<0||e<r-(t-i))return 0;if(e>=i||e>=r)return 1;if(r*2>t)return i*2>t?n(t-r-i+e,t,t-r,t-i):1-co.cdf(i-e-1,t,t-r,i);if(i*2>t)return 1-co.cdf(r-e-1,t,r,t-i);if(r<i)return co.cdf(e,t,i,r);for(var s=1,o=1,a=0,l=0;l<e;l++){for(;s>1&&a<i;){var u=1-r/(t-a);o*=u,s*=u,a++}o*=(i-l)*(r-l)/((l+1)*(t-r-i+l+1)),s+=o}for(;a<i;a++)s*=1-r/(t-a);return Math.min(1,Math.max(0,s))}},Ri={pdf:function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*yb(.5,t/2))*Math.pow(1+e*e/t,-((t+1)/2))},cdf:function(e,t){var r=t/2;return F1((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),r,r)},inv:function(n,e){var t=wb(2*Math.min(n,1-n),.5*e,.5);return t=Math.sqrt(e*(1-t)/t),n>.5?t:-t}},G6={pdf:function(e,t,r){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(Math.log(e)-t,2)/(2*r*r))},cdf:function(e,t,r){return e<0?0:.5+.5*Uu((Math.log(e)-t)/Math.sqrt(2*r*r))},inv:function(n,e,t){return Math.exp(-1.4142135623730951*t*l_(2*n)+e)}},Bw={pdf:function(e,t,r){return e!==e>>>0?!1:e<0?0:h_(e+t-1,t-1)*Math.pow(1-r,e)*Math.pow(r,t)},cdf:function(e,t,r){var i=0,s=0;if(e<0)return 0;for(;s<=e;s++)i+=Bw.pdf(s,t,r);return i}};function d_(n){for(var e=0,t=n.length;--t>=0;)e+=n[t];return e}function Ei(n){return d_(n)/n.length}function Ha(n){for(var e=Ei(n),t=0,r=n.length,i;--r>=0;)i=n[r]-e,t+=i*i;return t}function uh(n,e){return Ha(n)/(n.length-(e?1:0))}function qo(n,e){return Math.sqrt(uh(n,e))}function Zue(){var n=[].slice.call(arguments),e=new Array(2),t;return n.length===4?t=Math.abs(ji.inv(n[1]/2,0,1)*n[2]/Math.sqrt(n[3])):t=Math.abs(ji.inv(n[1]/2,0,1)*qo(n[2])/Math.sqrt(n[2].length)),e[0]=n[0]-t,e[1]=n[0]+t,e}function Jue(){var n=[].slice.call(arguments),e=new Array(2),t;return n.length===4?t=Math.abs(Ri.inv(n[1]/2,n[3]-1)*n[2]/Math.sqrt(n[3])):t=Math.abs(Ri.inv(n[1]/2,n[2].length-1)*qo(n[2],!0)/Math.sqrt(n[2].length)),e[0]=n[0]-t,e[1]=n[0]+t,e}function ece(n){for(var e=1,t=n.length;--t>=0;)e*=n[t];return e}function tce(n){return Math.pow(ece(n),1/n.length)}function ch(n,e){var t=Ei(n),r=Ei(e),i=n.length,s=new Array(i),o;for(o=0;o<i;o++)s[o]=(n[o]-t)*(e[o]-r);return d_(s)/(i-1)}function r8(n,e){return ch(n,e)/qo(n,1)/qo(e,1)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class vb extends nt{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(r,i)=>i===void 0?Uu(r):Uu(i)-Uu(r))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),a_)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(r,i,s)=>s?J4.cdf(r,i):J4.pdf(r,i))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),r=>Math.log((1+r)/(1-r))/2)}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),r=>1-2/(Math.exp(2*r)+1))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),_h)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(r,i,s,o)=>o?V6.cdf(r,i,s):V6.pdf(r,i,s))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),tr)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),V6.inv)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),r=>ji.cdf(r,0,1)-.5)}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(r,i,s,o,a,l)=>r<=a?new D($.NUM,Q.ValueSmall):r>=l?new D($.NUM,Q.ValueLarge):(r=(r-a)/(l-a),o?$6.cdf(r,i,s):$6.pdf(r,i,s)))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(r,i,s,o,a)=>o>=a?new D($.NUM,Q.WrongOrder):$6.inv(r,i,s)*(a-o)+o)}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(r,i,s,o)=>r>i?new D($.NUM,Q.WrongOrder):(r=Math.trunc(r),i=Math.trunc(i),o?Ym.cdf(r,i,s):Ym.pdf(r,i,s)))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(r,i,s)=>{r=Math.trunc(r);let o=-1,a=r;for(;a>o+1;){const l=Math.trunc((o+a)/2);Ym.cdf(l,r,i)>=s?a=l:o=l}return a})}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(r,i)=>Hw(r,Math.trunc(i)))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(r,i)=>Fw(r,Math.trunc(i)))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(r,i)=>Xue(r,Math.trunc(i)))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(r,i)=>que(r,Math.trunc(i)))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(r,i,s)=>(i=Math.trunc(i),s?Cu.cdf(r,i):Cu.pdf(r,i)))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(r,i)=>1-Cu.cdf(r,Math.trunc(i)))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(r,i)=>Cu.inv(r,Math.trunc(i)))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(r,i)=>Cu.inv(1-r,Math.trunc(i)))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(r,i,s,o)=>(i=Math.trunc(i),s=Math.trunc(s),o?Eu.cdf(r,i,s):Eu.pdf(r,i,s)))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(r,i,s)=>1-Eu.cdf(r,Math.trunc(i),Math.trunc(s)))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(r,i,s)=>Eu.inv(r,Math.trunc(i),Math.trunc(s)))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(r,i,s)=>Eu.inv(1-r,Math.trunc(i),Math.trunc(s)))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(r,i,s,o)=>o?n8.cdf(r,s,i):n8.pdf(r,s,i))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(r,i,s)=>(r=Math.trunc(r),s?Uw.cdf(r,i):Uw.pdf(r,i)))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(r,i,s,o,a)=>r>i||r>s||i>o||s>o?new D($.NUM,Q.ValueLarge):r+o<s+i?new D($.NUM,Q.ValueLarge):(r=Math.trunc(r),i=Math.trunc(i),s=Math.trunc(s),o=Math.trunc(o),a?co.cdf(r,o,s,i):co.pdf(r,o,s,i)))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(r,i,s)=>(i=Math.trunc(i),s?Ri.cdf(r,i):Ri.pdf(r,i)))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(r,i)=>(1-Ri.cdf(r,Math.trunc(i)))*2)}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(r,i)=>1-Ri.cdf(r,Math.trunc(i)))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(r,i,s)=>s*(1-Ri.cdf(r,Math.trunc(i))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(r,i)=>Ri.inv(r,Math.trunc(i)))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(r,i)=>Ri.inv(1-r/2,Math.trunc(i)))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(r,i,s,o)=>o?G6.cdf(r,i,s):G6.pdf(r,i,s))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(r,i,s)=>G6.inv(r,i,s))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(r,i,s,o)=>o?ji.cdf(r,i,s):ji.pdf(r,i,s))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(r,i,s)=>ji.inv(r,i,s))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(r,i)=>i?ji.cdf(r,0,1):ji.pdf(r,0,1))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),r=>ji.inv(r,0,1))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),r=>ji.pdf(r,0,1))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(r,i,s,o)=>(r=Math.trunc(r),i=Math.trunc(i),o?Bw.cdf(r,i,s):Bw.pdf(r,i,s)))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(r,i,s)=>Zue(1,r,i,Math.trunc(s))[1]-1)}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(r,i,s)=>(s=Math.trunc(s),s===1?new D($.DIV_BY_ZERO):Jue(1,r,i,s)[1]-1))}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(r,i,s)=>(r-i)/s)}}vb.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:w.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:w.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:w.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:w.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:w.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:w.NUMBER,minValue:0,lessThan:1},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:w.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.BOOLEAN},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:w.NUMBER,greaterThan:0,maxValue:1},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0,maxValue:1},{argumentType:w.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0,maxValue:1},{argumentType:w.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:1,maxValue:1e10},{argumentType:w.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:w.NUMBER,minValue:0,maxValue:1},{argumentType:w.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:w.NUMBER,minValue:0,maxValue:1},{argumentType:w.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:1},{argumentType:w.NUMBER,minValue:1},{argumentType:w.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:1},{argumentType:w.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:w.NUMBER,minValue:0,maxValue:1},{argumentType:w.NUMBER,minValue:1},{argumentType:w.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:w.NUMBER,minValue:0,maxValue:1},{argumentType:w.NUMBER,minValue:1},{argumentType:w.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:1},{argumentType:w.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:1},{argumentType:w.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:w.NUMBER,greaterThan:0,lessThan:1},{argumentType:w.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:w.NUMBER,greaterThan:0,maxValue:1},{argumentType:w.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:w.NUMBER,greaterThan:0,lessThan:1},{argumentType:w.NUMBER},{argumentType:w.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:w.NUMBER,greaterThan:0,lessThan:1},{argumentType:w.NUMBER},{argumentType:w.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:w.NUMBER},{argumentType:w.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:w.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:w.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:1},{argumentType:w.NUMBER,minValue:0,maxValue:1},{argumentType:w.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:w.NUMBER,greaterThan:0,lessThan:1},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:w.NUMBER,greaterThan:0,lessThan:1},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,greaterThan:0}]}};vb.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class f_ extends nt{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),r=>{r=Math.trunc(r);let i=1;for(let s=1;s<=r;s++)i*=s;return i})}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),r=>{r=Math.trunc(r);let i=1;for(let s=r;s>=1;s-=2)i*=s;return i})}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(r,i)=>i>r?new D($.NUM,Q.WrongOrder):(r=Math.trunc(r),i=Math.trunc(i),i8(r,i)))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(r,i)=>(r=Math.trunc(r),i=Math.trunc(i),r+i-1>=1030?new D($.NUM,Q.ValueLarge):r===0&&i===0?1:i8(r+i-1,i)))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(r);if(i instanceof D)return i;let s=0;for(const o of i){if(o<0)return new D($.NUM,Q.ValueSmall);s=m_(s,Math.trunc(o))}return s>Number.MAX_SAFE_INTEGER?new D($.NUM,Q.ValueLarge):s})}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(r);if(i instanceof D)return i;let s=1;for(const o of i){if(o<0)return new D($.NUM,Q.ValueSmall);s=nce(s,Math.trunc(o))}return s>Number.MAX_SAFE_INTEGER?new D($.NUM,Q.ValueLarge):s})}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(r,i)=>i===0?0:r>0&&i<0||r<0&&i>0?new D($.NUM,Q.DistinctSigns):Math.round(r/i)*i)}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(...r)=>{let i=0,s=1;for(let o of r){if(o<0)return new D($.NUM,Q.ValueSmall);o=Math.trunc(o);for(let a=1;a<=o;a++)s*=(i+a)/a;i+=o}return Math.round(s)})}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(r,i)=>i===0?new D($.DIV_BY_ZERO):Math.trunc(r/i))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(r,i,s,o)=>{const a=this.arithmeticHelper.manyToOnlyNumbersDropNulls(o.valuesFromTopLeftCorner());if(a instanceof D)return a;let l=0;a.reverse();for(const u of a)l*=Math.pow(r,s),l+=u;return l*Math.pow(r,i)})}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),r=>r>0?1:r<0?-1:0)}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(r,i)=>{const s=r.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new D($.NA,Q.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const c=s[u],h=o[u];if(c instanceof D)return c;if(h instanceof D)return h;typeof c=="number"&&typeof h=="number"&&(l+=Math.pow(c,2)-Math.pow(h,2))}return l})}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(r,i)=>{const s=r.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new D($.NA,Q.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const c=s[u],h=o[u];if(c instanceof D)return c;if(h instanceof D)return h;typeof c=="number"&&typeof h=="number"&&(l+=Math.pow(c,2)+Math.pow(h,2))}return l})}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(r,i)=>{const s=r.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new D($.NA,Q.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const c=s[u],h=o[u];if(c instanceof D)return c;if(h instanceof D)return h;typeof c=="number"&&typeof h=="number"&&(l+=Math.pow(c-h,2))}return l})}}f_.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:w.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:w.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:w.NUMBER,minValue:0,lessThan:1030},{argumentType:w.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:w.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:w.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]}};function i8(n,e){2*e>n&&(e=n-e);let t=1;for(let r=1;r<=e;r++)t*=(n-e+r)/r;return Math.round(t)}function m_(n,e){for(n<e&&([n,e]=[e,n]);e>0;)[n,e]=[e,n%e];return n}function nce(n,e){return n===0||e===0?0:n*(e/m_(n,e))}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class p_ extends nt{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(r,i,s)=>s!=="i"&&s!=="j"?new D($.VALUE,Q.ShouldBeIorJ):wn([r,i],s))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),w_)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),([r,i])=>i)}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),([r,i])=>r)}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),([r,i])=>r===0&&i===0?new D($.DIV_BY_ZERO):Math.atan2(i,r))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),([r,i])=>wn([r,-i]))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),r=>wn(um(r)))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),r=>wn(s8(r)))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),r=>wn(ka(um(r),cm(r))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),r=>wn(ka([1,0],cm(r))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),r=>wn(ka([1,0],o8(r))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),r=>wn(ka([1,0],um(r))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),r=>wn(ka([1,0],s8(r))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),r=>wn(cm(r)))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),r=>wn(o8(r)))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),r=>wn(ka(cm(r),um(r))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(r,i)=>wn(ka(r,i)))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(...r)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(r);if(i instanceof D)return i;let s=[1,0];for(const o of i)s=g_(s,o);return wn(s)})}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),(...r)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(r);if(i instanceof D)return i;let s=[0,0];for(const o of i)s=rce(s,o);return wn(s)})}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(r,i)=>wn(ice(r,i)))}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),r=>wn(y_(r)))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),r=>wn(Km(r)))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),r=>{const[i,s]=Km(r),o=Math.log(10);return wn([i/o,s/o])})}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),r=>{const[i,s]=Km(r),o=Math.log(2);return wn([i/o,s/o])})}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(r,i)=>wn(a8(r,i)))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),r=>wn(a8(r,.5)))}}p_.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:w.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:w.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:w.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:w.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:w.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:w.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:w.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:w.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:w.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:w.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:w.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:w.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:w.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:w.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:w.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:w.COMPLEX},{argumentType:w.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:w.COMPLEX},{argumentType:w.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:w.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:w.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:w.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:w.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:w.COMPLEX},{argumentType:w.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:w.COMPLEX}]}};function rce([n,e],[t,r]){return[n+t,e+r]}function ice([n,e],[t,r]){return[n-t,e-r]}function g_([n,e],[t,r]){return[n*t-e*r,n*r+t*e]}function ka([n,e],[t,r]){const i=Math.pow(t,2)+Math.pow(r,2),[s,o]=g_([n,e],[t,-r]);return[s/i,o/i]}function um([n,e]){return[Math.cos(n)*Math.cosh(e),-Math.sin(n)*Math.sinh(e)]}function s8([n,e]){return[Math.cosh(n)*Math.cos(e),Math.sinh(n)*Math.sin(e)]}function cm([n,e]){return[Math.sin(n)*Math.cosh(e),Math.cos(n)*Math.sinh(e)]}function o8([n,e]){return[Math.sinh(n)*Math.cos(e),Math.cosh(n)*Math.sin(e)]}function y_([n,e]){return[Math.exp(n)*Math.cos(e),Math.exp(n)*Math.sin(e)]}function w_([n,e]){return Math.sqrt(n*n+e*e)}function Km([n,e]){return[Math.log(w_([n,e])),Math.atan2(e,n)]}function a8(n,e){const[t,r]=Km(n);return y_([e*t,e*r])}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Cb extends nt{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof D)return i;if(i.length===0)return new D($.DIV_BY_ZERO);const s=Ei(i);return i.reduce((o,a)=>o+Math.abs(a-s),0)/i.length})}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);return i instanceof D?i:i.length===0?0:Ha(i)})}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof D)return i;if(i.length===0)return new D($.NUM,Q.OneValue);for(const s of i)if(s<=0)return new D($.NUM,Q.ValueSmall);return tce(i)})}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof D)return i;if(i.length===0)return new D($.NUM,Q.OneValue);for(const s of i)if(s<=0)return new D($.NUM,Q.ValueSmall);return i.length/i.reduce((s,o)=>s+1/o,0)})}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new D($.NA,Q.EqualLength);const s=Fa(r,i);return s instanceof D?s:s[0].length<=1?new D($.DIV_BY_ZERO,Q.TwoValues):r8(s[0],s[1])})}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new D($.NA,Q.EqualLength);const s=Fa(r,i);return s instanceof D?s:s[0].length<=1?new D($.DIV_BY_ZERO,Q.TwoValues):Math.pow(r8(s[0],s[1]),2)})}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new D($.NA,Q.EqualLength);const s=Fa(r,i);if(s instanceof D)return s;const o=s[0].length;return o<1?new D($.DIV_BY_ZERO,Q.OneValue):o===1?0:ch(s[0],s[1])*(o-1)/o})}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new D($.NA,Q.EqualLength);const s=Fa(r,i);return s instanceof D?s:s[0].length<=1?new D($.DIV_BY_ZERO,Q.TwoValues):ch(s[0],s[1])})}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),(r,i,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner());if(o instanceof D)return o;const a=o.length;if(s===void 0){if(a<2)return new D($.DIV_BY_ZERO,Q.TwoValues);s=qo(o,!0)}return a<1?new D($.NA,Q.OneValue):s===0?new D($.DIV_BY_ZERO):1-ji.cdf((Ei(o)-i)/(s/Math.sqrt(a)),0,1)})}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),(r,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner()),o=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(s instanceof D)return s;if(o instanceof D)return o;if(s.length<=1||o.length<=1)return new D($.DIV_BY_ZERO);const a=uh(s,!0),l=uh(o,!0);if(a===0||l===0)return new D($.DIV_BY_ZERO);const u=a/l,c=Eu.cdf(u,s.length-1,o.length-1);return 2*Math.min(c,1-c)})}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new D($.NA,Q.EqualLength);const s=Fa(r,i);if(s instanceof D)return s;const o=s[0].length;return o<=2?new D($.DIV_BY_ZERO,Q.ThreeValues):Math.sqrt((Ha(s[0])-Math.pow(ch(s[0],s[1])*(o-1),2)/Ha(s[1]))/(o-2))})}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(r,i)=>{if(r.numberOfElements()!==i.numberOfElements())return new D($.NA,Q.EqualLength);const s=Fa(r,i);if(s instanceof D)return s;const o=s[0].length;return o<=1?new D($.DIV_BY_ZERO,Q.TwoValues):ch(s[0],s[1])*(o-1)/Ha(s[1])})}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(r,i)=>{const s=r.height(),o=r.width();if(i.height()!==s||i.width()!==o)return new D($.NA,Q.EqualLength);const a=Fa(r,i);if(a instanceof D)return a;if(a[0].length<=1)return new D($.DIV_BY_ZERO,Q.TwoValues);let l=0;for(let u=0;u<a[0].length;u++){if(a[1][u]===0)return new D($.DIV_BY_ZERO);l+=Math.pow(a[0][u]-a[1][u],2)/a[1][u]}return l<0?new D($.NUM,Q.NaN):1-Cu.cdf(l,s>1&&o>1?(s-1)*(o-1):s*o-1)})}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),(r,i,s,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(r.valuesFromTopLeftCorner()),l=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(a instanceof D)return a;if(l instanceof D)return l;const u=a.length,c=l.length;if(o===1){if(c!==u)return new D($.NA,Q.EqualLength);if(u<=1)return new D($.DIV_BY_ZERO,Q.TwoValues);const h=Array(u);for(let m=0;m<u;m++)h[m]=a[m]-l[m];const d=qo(h,!0);if(d===0)return new D($.DIV_BY_ZERO);const f=Math.abs(Math.sqrt(u)*Ei(h)/d);return s*(1-Ri.cdf(f,u-1))}else if(o===2){if(u<=1||c<=1)return new D($.DIV_BY_ZERO,Q.TwoValues);const h=(Ha(a)+Ha(l))/(u+c-2);if(h===0)return new D($.DIV_BY_ZERO);const d=Math.abs((Ei(a)-Ei(l))/Math.sqrt(h*(1/u+1/c)));return s*(1-Ri.cdf(d,u+c-2))}else{if(u<=1||c<=1)return new D($.DIV_BY_ZERO,Q.TwoValues);const h=uh(a,!0),d=uh(l,!0);if(h===0&&d===0)return new D($.DIV_BY_ZERO);const f=Math.abs((Ei(a)-Ei(l))/Math.sqrt(h/u+d/c)),m=Math.pow(h/u+d/c,2)/(Math.pow(h/u,2)/(u-1)+Math.pow(d/c,2)/(c-1));return s*(1-Ri.cdf(f,m))}})}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof D)return i;const s=i.length;if(s<3)return new D($.DIV_BY_ZERO,Q.ThreeValues);const o=Ei(i),a=qo(i,!0);return a===0?new D($.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-o)/a,3),0)*s/(s-1)/(s-2)})}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),(...r)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(r);if(i instanceof D)return i;const s=i.length;if(s<3)return new D($.DIV_BY_ZERO,Q.ThreeValues);const o=Ei(i),a=qo(i,!1);return a===0?new D($.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-o)/a,3),0)/s})}}Cb.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:w.RANGE},{argumentType:w.NUMBER},{argumentType:w.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE},{argumentType:w.INTEGER,minValue:1,maxValue:2},{argumentType:w.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:w.ANY}],repeatLastArgs:1}};Cb.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};function Fa(n,e){const t=n.iterateValuesFromTopLeftCorner(),r=e.iterateValuesFromTopLeftCorner();let i,s;const o=[],a=[];for(;i=t.next(),s=r.next(),!i.done&&!s.done;){const l=i.value,u=s.value;if(l instanceof D)return l;if(u instanceof D)return u;At(l)&&At(u)&&(o.push(Le(l)),a.push(Le(u)))}return[o,a]}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const l8=Object.freeze(Object.defineProperty({__proto__:null,AddressPlugin:gO,ArrayPlugin:yO,AbsPlugin:wO,BitShiftPlugin:vO,BitwiseLogicOperationsPlugin:SO,BooleanPlugin:RO,CharPlugin:TO,CodePlugin:AO,CountBlankPlugin:xO,CountUniquePlugin:MO,DateTimePlugin:NO,DegreesPlugin:IO,DeltaPlugin:OO,ExpPlugin:_O,FinancialPlugin:LO,FormulaTextPlugin:PO,HyperlinkPlugin:DO,InformationPlugin:kO,IsEvenPlugin:FO,IsOddPlugin:HO,LogarithmPlugin:UO,MathConstantsPlugin:BO,MatrixPlugin:VO,MedianPlugin:$O,ModuloPlugin:WO,NumericAggregationPlugin:mb,PowerPlugin:GO,RadiansPlugin:zO,RadixConversionPlugin:jO,RandomPlugin:XO,RoundingPlugin:pb,SqrtPlugin:QO,ConditionalAggregationPlugin:ZO,SumprodPlugin:JO,TextPlugin:e_,TrigonometryPlugin:t_,LookupPlugin:n_,RomanPlugin:r_,SimpleArithmerticPlugin:i_,StatisticalPlugin:vb,MathPlugin:f_,ComplexPlugin:p_,StatisticalAggregationPlugin:Cb},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class at extends gr{}at.HyperFormula=gr;at.ErrorType=$;at.CellError=D;at.CellType=Yr;at.CellValueType=Zi;at.CellValueDetailedType=Uae;at.DetailedCellError=ZI;at.ExportedCellChange=_w;at.ExportedNamedExpressionChange=cO;at.ConfigValueTooBigError=UI;at.ConfigValueTooSmallError=HI;at.EvaluationSuspendedError=VI;at.ExpectedOneOfValuesError=BI;at.ExpectedValueOfTypeError=Tt;at.ArraySize=lt;at.SimpleRangeValue=Be;at.EmptyValue=ht;at.FunctionPlugin=nt;at.FunctionArgumentType=w;at.FunctionPluginValidationError=ec;at.InvalidAddressError=OI;at.InvalidArgumentsError=kn;at.LanguageNotRegisteredError=Ew;at.LanguageAlreadyRegisteredError=WI;at.MissingTranslationError=wu;at.NamedExpressionDoesNotExistError=ld;at.NamedExpressionNameIsAlreadyTakenError=_I;at.NamedExpressionNameIsInvalidError=LI;at.NoOperationToRedoError=DI;at.NoOperationToUndoError=PI;at.NoRelativeAddressesAllowedError=lb;at.NoSheetWithIdError=an;at.NoSheetWithNameError=II;at.NotAFormulaError=Cw;at.NothingToPasteError=kI;at.ProtectedFunctionTranslationError=$I;at.SheetNameAlreadyTakenError=od;at.SheetSizeLimitExceededError=nl;at.SourceLocationHasArrayError=Mu;at.TargetLocationHasArrayError=Gp;at.UnableToParseError=FI;const sce=dr.defaultConfig.language;gr.registerLanguage(sce,Lw);gr.languages[Lw.langCode]=Lw;for(const n of Object.getOwnPropertyNames(l8))n.startsWith("_")||gr.registerFunctionPlugin(l8[n]);oN();const oce=at.buildEmpty({licenseKey:"internal-use-in-handsontable"}),v_={startDate:St().toString(),endDate:St().add(1,"M").toString(),expenditure:[["Line item name","Amount"]],income:[["Line item name","Amount"]],total:[["Total","=sum(income!B1:B9999) - sum(expenditure!B1:B9999)"]]},ace=N5("dataAtom",v_),lce=()=>{Ng(s=>s.database);const[n,e]=rs(ace);return ie.exports.useEffect(()=>{n.total.length>1&&e({...n,total:v_.total})},[]),we.createElement(gt,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",sx:{width:"90vw"},spacing:1},we.createElement(gt,{item:!0,xs:6},we.createElement(r,{value:n.startDate,label:"Start Date",dataKey:"startDate"})),we.createElement(gt,{item:!0,xs:6},we.createElement(r,{value:n.endDate,label:"End Date",dataKey:"endDate"})),we.createElement(gt,{item:!0,xs:12},we.createElement(i,{data:n.expenditure,reducerKey:"expenditure",updateData:t})),we.createElement(gt,{item:!0,xs:12},we.createElement(i,{data:n.income,reducerKey:"income",updateData:t})),we.createElement(gt,{item:!0,xs:12},we.createElement(i,{data:n.total,reducerKey:"total",updateData:t,minSpareRows:0,rowHeaders:!1,readOnly:!0})));function t(s){const{type:o,payload:a}=s,l=e;switch(s.type){case"startDate":case"endDate":case"expenditure":case"income":l({...n,[o]:a});break}}function r({dataKey:s,label:o,value:a}){return we.createElement(cA,{dateAdapter:hA},we.createElement(dA,{inputFormat:"DD MMM YYYY",label:o,onChange:l=>t({type:s,payload:l}),value:St(a),renderInput:l=>we.createElement(Ba,{fullWidth:!0,...l})}))}function i({reducerKey:s,data:o,updateData:a,minSpareRows:l=1,rowHeaders:u=!0,readOnly:c=!1}){function h(d,f,m,p,y,C,b){To.apply(this,arguments),f.style.fontWeight="bold",f.style.color=(()=>{switch(s){case"expenditure":return"red";case"income":return"green";case"total":default:return"black"}})(),f.style.textAlign="center"}return we.createElement(CF,{sx:{width:"90vw"}},we.createElement(yN,{stretchH:"all",width:"100%",data:o,rowHeaders:u,minSpareRows:l,readOnly:c,licenseKey:"non-commercial-and-evaluation",formulas:{engine:oce,sheetName:s},cells:(d,f)=>{const m={};return d===0&&(m.readOnly=!0,m.renderer=h),m},beforeChange:d=>{let f=Co.exports.cloneDeep(o);d.forEach(m=>{if(m===null)return;const[p,y,C,b]=m;console.log({row:p,col:y,oldVal:C,newVal:b}),p>o.length&&Co.exports.concat(f,new Array(o.length-p).fill("")),typeof y=="number"&&(f[p][y]=b)}),a({type:s,payload:f})}}))}},uce=ha(ce.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add"),cce=ha(ce.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}),"ArrowBack"),hce=ha(ce.jsx("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward"),dce=ha(ce.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear"),fce=ha(ce.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),mce=ha(ce.jsx("path",{d:"M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2H6zm10 14.5V20H8v-3.5l4-4 4 4zm-4-5-4-4V4h8v3.5l-4 4z"}),"HourglassEmpty"),pce=ha(ce.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm.88 15.76V19h-1.75v-1.29c-.74-.18-2.39-.77-3.02-2.96l1.65-.67c.06.22.58 2.09 2.4 2.09.93 0 1.98-.48 1.98-1.61 0-.96-.7-1.46-2.28-2.03-1.1-.39-3.35-1.03-3.35-3.31 0-.1.01-2.4 2.62-2.96V5h1.75v1.24c1.84.32 2.51 1.79 2.66 2.23l-1.58.67c-.11-.35-.59-1.34-1.9-1.34-.7 0-1.81.37-1.81 1.39 0 .95.86 1.31 2.64 1.9 2.4.83 3.01 2.05 3.01 3.45 0 2.63-2.5 3.13-3.02 3.22z"}),"Paid"),gce=ha(ce.jsx("path",{d:"M19 13H5v-2h14v2z"}),"Remove");var Us={exports:{}};const yce=iA(yk);(function(n,e){(function(t,r){r(e,yce,ie.exports)})(Go,function(t,r,i){function s(c){return c&&typeof c=="object"&&"default"in c?c:{default:c}}var o=s(i);function a(c,h,d){var f,m;typeof c=="function"?(f=h||[],m=d):(f=[],m=h);var p=o.default.useRef({hasResult:!1,result:m,error:null}),y=o.default.useReducer(function(v){return v+1},0);y[0];var C=y[1],b=o.default.useMemo(function(){var v=typeof c=="function"?c():c;if(!v||typeof v.subscribe!="function")throw c===v?new TypeError("Given argument to useObservable() was neither a valid observable nor a function."):new TypeError("Observable factory given to useObservable() did not return a valid observable.");if(!p.current.hasResult)if(typeof v.getValue=="function")p.current.result=v.getValue(),p.current.hasResult=!0;else{var S=v.subscribe(function(L){p.current.result=L,p.current.hasResult=!0});typeof S=="function"?S():S.unsubscribe()}return v},f);if(o.default.useDebugValue(p.current.result),o.default.useEffect(function(){var v=b.subscribe(function(S){var L=p.current;(L.error!==null||L.result!==S)&&(L.error=null,L.result=S,L.hasResult=!0,C())},function(S){var L=p.current;L.error!==S&&(L.error=S,C())});return typeof v=="function"?v:v.unsubscribe.bind(v)},f),p.current.error)throw p.current.error;return p.current.result}function l(c,h,d){return a(function(){return r.liveQuery(c)},h||[],d)}function u(c,h,d){if(!c)throw new TypeError("Invalid arguments to usePermissions(): undefined or null");var f;if(arguments.length>=3){if(!("transaction"in c))throw new TypeError("Invalid arguments to usePermission(db, table, obj): 1st arg must be a Dexie instance");if(typeof h!="string")throw new TypeError("Invalid arguments to usePermission(db, table, obj): 2nd arg must be string");if(!d||typeof d!="object")throw new TypeError("Invalid arguments to usePermission(db, table, obj): 3rd arg must be an object");f=c}else{if(c instanceof r.Dexie)throw new TypeError("Invalid arguments to usePermission(db, table, obj): Missing table and obj arguments.");if(typeof c.table=="function"&&typeof c.db=="object")f=c.db,d=c,h=c.table();else throw new TypeError("Invalid arguments to usePermissions(). Expected usePermissions(entity: DexieCloudEntity) or usePermissions(db: Dexie, table: string, obj: DexieCloudObject)")}if(!("cloud"in f))throw new Error("usePermissions() is only for Dexie Cloud but there's no dexie-cloud-addon active in given db.");if(!("permissions"in f.cloud))throw new Error("usePermissions() requires a newer version of dexie-cloud-addon. Please upgrade it.");return a(function(){return f.cloud.permissions(d,h)},[d.realmId,d.owner,h])}t.useLiveQuery=l,t.useObservable=a,t.usePermissions=u,Object.defineProperty(t,"__esModule",{value:!0})})})(Us,Us.exports);const C_=I5({show:!1,message:"",severity:"info"}),wce=()=>{const[n,e]=rs(C_),t=(i,s)=>{s!=="clickaway"&&e({...n,show:!1})},r=we.createElement(we.Fragment,null,we.createElement(Bh,{size:"small","aria-label":"close",color:"inherit",onClick:t},we.createElement(fce,{fontSize:"small"})));return we.createElement(xk,{open:n.show,autoHideDuration:3e3,onClose:t,action:r},we.createElement(Mk,{severity:n.severity},n.message))},vce=wce,z6={[Nt.category]:"",[Nt.name]:"",[Nt.amount]:"",[Nt.datetime]:St().unix(),[Nt.transactionType]:Gn.CREDIT,[Nt.creditCard]:""},Cce=()=>{const n=Ng(m=>m.database),[,e]=rs(C_),t=Us.exports.useLiveQuery(async()=>{const m=await n.expenditure.toArray(),p=await n.recurring.toArray(),y=m.reduce((S,L)=>[...S,L[Nt.category]],[]),C=p.reduce((S,L)=>[...S,L.name],[]),b=m.map(S=>S[Nt.creditCard]),v=p.map(S=>S.credit_card);return{categories:Co.exports.uniq([...y,...C]).filter(S=>S!==void 0),creditCards:Co.exports.uniq([...b,...v]).filter(S=>S!==void 0)}}),[r,i]=ie.exports.useState(z6),[s,o]=ie.exports.useState(!1),[a,l]=ie.exports.useState("monthly");function u(m,p){i({...r,[m]:p})}function c(m){if(!!Object.values(r).some(y=>y===""||y===null||y===void 0)){e({show:!1,message:"Please fill in all fields first.",severity:"error"});return}if(m===Gn.RECURRING){if(s===!1){o(!0);return}let y=St.unix(r.datetime),C;switch(a){case"weekly":C=`${a} ${y.day()}`;break;case"monthly":C=`${a} ${y.date()}`;break;case"yearly":C=`${a} ${y.format("DD-MM")}`;break;default:C=`${a} ${y.day()}`;break}n.recurring.add({name:r.name,amount:parseFloat(r.amount),cron:C,start:r.datetime,category:r.category,credit_card:r.credit_card}).then(()=>{e({message:"Recorded!",severity:"success",show:!0}),i({...z6,[Nt.datetime]:St().unix()})});return}n.expenditure.add({...r,category:r.category,[Nt.transactionType]:m}).then(()=>{e({message:"Recorded!",severity:"success",show:!0}),i({...z6,[Nt.datetime]:St().unix()})})}const h=[{endIcon:we.createElement(pce,null),type:Gn.SALARY,color:"info"},{endIcon:we.createElement(uce,null),type:Gn.DEBIT,color:"success"},{endIcon:we.createElement(mce,null),type:Gn.RECURRING,color:"warning"},{endIcon:we.createElement(gce,null),type:Gn.CREDIT,color:"error"}],d={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"75vw",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},f=()=>{const m=p=>{let y=parseInt(p);return y===1?"st":y===2?"nd":y===3?"rd":"th"};return we.createElement(uF,{open:s,onClose:()=>o(!1)},we.createElement(Gu,{sx:d},we.createElement(cF,null,we.createElement(hF,null,"Type of reccurence"),we.createElement(bk,{value:a,onChange:p=>l(p.target.value)},we.createElement(B0,{value:"weekly",control:we.createElement(U0,null),label:"Weekly"}),we.createElement(B0,{value:"monthly",control:we.createElement(U0,null),label:"Monthly"}),we.createElement(B0,{value:"yearly",control:we.createElement(U0,null),label:"Yearly"}))),we.createElement(yo,null,"This will recur ",a,a==="yearly"?` on ${St.unix(r.datetime).format("D MMMM")}`:a==="monthly"?` on the ${St.unix(r.datetime).format("D")}${m(St.unix(r.datetime).format("D"))} day`:` every ${St.unix(r.datetime).format("dddd")}`),we.createElement(np,{onClick:()=>{c(Gn.RECURRING),o(!1)}},"confirm")))};return we.createElement("div",null,we.createElement(gt,{container:!0,justifyContent:"center",alignItems:"center",direction:"column",spacing:2},we.createElement(gt,{item:!0},we.createElement(gy,{size:"small",clearOnEscape:!0,freeSolo:!0,autoSelect:!0,autoComplete:!0,options:(t==null?void 0:t.creditCards)||[],sx:{width:"80vw"},value:r[Nt.creditCard],onChange:(m,p)=>u(Nt.creditCard,p),renderInput:m=>we.createElement(Ba,{...m,label:"Source"})})),we.createElement(gt,{item:!0},we.createElement(gy,{size:"small",clearOnEscape:!0,freeSolo:!0,autoSelect:!0,autoComplete:!0,options:(t==null?void 0:t.categories)||[],sx:{width:"80vw"},value:r[Nt.category],onChange:(m,p)=>u(Nt.category,p),renderInput:m=>we.createElement(Ba,{...m,label:"Categories"})})),we.createElement(gt,{item:!0},we.createElement(Ba,{size:"small",label:"Name",sx:{width:"80vw"},value:r[Nt.name],onChange:m=>u(Nt.name,m.target.value),inputProps:{autoCapitalize:"none"},InputProps:{endAdornment:we.createElement(fF,{position:"end"},r.name!==""&&we.createElement(Bh,{size:"small",onClick:()=>u(Nt.name,"")},we.createElement(dce,null)))}})),we.createElement(gt,{item:!0},we.createElement(mF,{size:"small",style:{width:"80vw"},value:r[Nt.amount],onChange:m=>u(Nt.amount,Number(m.target.value.replace(/[^0-9.]/g,""))),prefix:"$",thousandSeparator:!0,customInput:Ba,label:"Amount",inputProps:{inputMode:"decimal"}})),we.createElement(gt,{item:!0},we.createElement(cA,{dateAdapter:hA,adapterLocale:"en-sg"},we.createElement(dA,{label:"Date",value:St.unix(r[Nt.datetime]),onChange:m=>u(Nt.datetime,m===null?null:m.unix()),renderInput:m=>we.createElement(Ba,{sx:{width:"80vw"},...m})}))),we.createElement(gt,{item:!0},we.createElement(gt,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:2},h.map((m,p)=>we.createElement(gt,{item:!0,xs:6,key:p},we.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},we.createElement(np,{variant:"contained",color:m.color,endIcon:m.endIcon,size:"small",onClick:()=>c(m.type)},m.type))))))),we.createElement(f,null))},Ece=({title:n})=>we.createElement(yo,{variant:"body1"},n),uu=({title:n,value:e,color:t})=>we.createElement("div",null,we.createElement(Ece,{title:n}),we.createElement(yo,{variant:"h6",style:{color:t}},e)),bce=async(n,e)=>{var c;const t=await fo.expenditure.toArray(),r=t.filter(h=>h.datetime>=n&&h.datetime<=e);let i=r.reduce((h,d)=>h+Number(d.amount)*(wk.includes(d.txn_type)?1:-1),0),s=Co.exports.sortBy(r.filter(h=>vk.includes(h.txn_type)),["datetime"]).reduce((h,d)=>h+d.amount,0);const o=fd(await fo.recurring.where("start").belowOrEqual(St().unix()).toArray(),n,St().unix()).filter(h=>h.datetime>=n&&h.datetime<e).reduce((h,d)=>h+d.amount,0),a=((c=await fo.expenditure.where({txn_type:Gn.SALARY}).first())==null?void 0:c.datetime)||0,l=fd(await fo.recurring.where("start").belowOrEqual(St().unix()).toArray(),a,St().unix()).reduce((h,d)=>h+d.amount,0);return{total:t.reduce((h,{amount:d,txn_type:f})=>h+([Gn.CREDIT,Gn.RECURRING].includes(f)?Number(d)*-1:Number(d)),0)-l,spending:s+o,saving:i-o}},Sce=N5("showBigNumbers",!1);function Y6(n,e,t){return n.push({category:e.category,name:e.name,amount:e.amount,txn_type:Gn.RECURRING,datetime:t.unix(),recurringId:e.id,credit_card:e.credit_card}),n}function fd(n,e,t){return n.reduce((r,i)=>{if(t<i.start)return r;let s=i.cron.split(" ")[0],o=i.cron.split(" ")[1],a=[],l=St.unix(e);switch(s){case"weekly":let u=parseInt(o),c=l.day(),h=Math.abs(c-u);for(c<u?l=l.add(h,"d"):l=l.add(7-h,"d");l.unix()<t;)a=Y6(a,i,l),l=l.add(1,"w");break;case"monthly":let d=parseInt(o),f=Math.abs(parseInt(o)-St.unix(e).date());for(St.unix(e).date()<St.unix(i.start).date()?l=l.add(f,"d"):l=St.unix(e).set("D",d);l.unix()<t;)a=Y6(a,i,l),l=l.add(1,"M");break;case"yearly":let m=Co.exports.max([St.unix(e).year(),St.unix(t).year()]),p=St(o,"DD-MM").set("year",m||St().year());p.unix()<t&&p.unix()>=e&&(l=St.unix(i.start),a=Y6(a,i,l));break}return[...r,...a]},[])}const Rce=()=>{const{startDate:n,endDate:e}=H1(),[t,r]=rs(Sce),i=Sk(),s=Rk(),o=Us.exports.useLiveQuery(()=>bce(n,e),[n,e]);return we.createElement("div",null,we.createElement(gt,{container:!0,justifyContent:"center",alignItems:"center",direction:"row",style:{textAlign:"center"},spacing:1,onClick:()=>r(!t)},we.createElement(gt,{item:!0,xs:6,md:3},we.createElement(uu,{value:t?`$${o==null?void 0:o.total.toLocaleString()}`:"*****",title:"Total funds",color:t?Number(o==null?void 0:o.total.toLocaleString())<0?"red":"green":void 0})),we.createElement(gt,{item:!0,xs:6,md:3},we.createElement(uu,{value:St.unix(n).format("DD MMM"),title:"Pay day",color:"orange"})),we.createElement(gt,{item:!0,xs:6,md:3},we.createElement(uu,{title:"Monthly Spend",value:t?`$${o==null?void 0:o.spending.toLocaleString()}`||"$0":"*****"})),we.createElement(gt,{item:!0,xs:6,md:3},we.createElement(uu,{title:"Monthly Save",value:t?`$${o==null?void 0:o.saving.toLocaleString()}`||"$0":"*****"})),we.createElement(gt,{item:!0,xs:6,md:3},we.createElement(uu,{title:"Total Portfolio",value:t?`$${Co.exports.round(s,2).toLocaleString()}`||"$0":"*****"})),we.createElement(gt,{item:!0,xs:6,md:3},we.createElement(uu,{title:"Total Portfolio (%)",value:t?`${i}%`||"0%":"*****",color:t?i<0?"red":"green":void 0}))))},E_=I5(0);function H1(){var a,l,u,c,h;const n=Ng(d=>d.database),[e]=rs(E_),t=(a=Us.exports.useLiveQuery(async()=>{var d;return(d=await n.expenditure.orderBy("datetime").last())==null?void 0:d.datetime}))!=null?a:0,r=(l=Us.exports.useLiveQuery(async()=>(await n.expenditure.where({txn_type:Gn.SALARY})).toArray()))!=null?l:[],i=r.length||0,s=(c=(u=r[i-e-1])==null?void 0:u.datetime)!=null?c:t,o=e===0?St().unix():(h=r[i-e])==null?void 0:h.datetime;return{minDate:t,totalMonths:i,paydays:r,startDate:s,endDate:o}}const Tce=()=>{const n=Ck();return ie.exports.useEffect(()=>{Ek(n)}),we.createElement("div",null,we.createElement(gt,{container:!0,justifyContent:"center",alignItems:"center",direction:"column",spacing:2},we.createElement(gt,{item:!0},we.createElement(Rce,null)),we.createElement(gt,{item:!0},we.createElement(Cce,null))))};function Ace(){ie.exports.useRef(null);const{startDate:n,endDate:e}=H1(),t=Us.exports.useLiveQuery(async()=>{const r=await fo.expenditure.where(Nt.datetime).between(n,e||1/0,!0,!0).toArray(),i=fd(await fo.recurring.toArray(),n,e);return Or([...r,...i]).filter(o=>o.txn_type===Gn.CREDIT).groupBy(Nt.category).mapValues(o=>Or(o).sortBy("amount").reverse().value()).toPairs().sortBy(o=>Or(o[1]).sumBy("amount")).reverse().map(([o,a])=>({name:o,amount:Or.sumBy(a,"amount").toFixed(2),__children:Or(a).map(Or.partialRight(Or.pick,["name","amount"])).groupBy("name").mapValues(l=>({name:l[0].name,amount:Or.sumBy(l,"amount").toFixed(2)})).values().value()})).value()},[n,e])||[];return t===null||t.length,we.createElement("div",{style:{width:"90vw"}},t.map(r=>we.createElement(DF,null,we.createElement(XF,null,we.createElement(gt,{container:!0,justifyContent:"space-between"},we.createElement(gt,{item:!0},r.name,":"),we.createElement(gt,{item:!0},r.amount))),we.createElement(VF,null,we.createElement(gF,null,we.createElement(yF,null,r.__children.map(i=>we.createElement(wF,null,we.createElement(TS,null,i.name),we.createElement(TS,null,i.amount)))))))))}let Eb=Zd();const st=n=>Qd(n,Eb);let bb=Zd();st.write=n=>Qd(n,bb);let U1=Zd();st.onStart=n=>Qd(n,U1);let Sb=Zd();st.onFrame=n=>Qd(n,Sb);let Rb=Zd();st.onFinish=n=>Qd(n,Rb);let Bu=[];st.setTimeout=(n,e)=>{let t=st.now()+e,r=()=>{let s=Bu.findIndex(o=>o.cancel==r);~s&&Bu.splice(s,1),Qo-=~s?1:0},i={time:t,handler:n,cancel:r};return Bu.splice(b_(t),0,i),Qo+=1,S_(),i};let b_=n=>~(~Bu.findIndex(e=>e.time>n)||~Bu.length);st.cancel=n=>{U1.delete(n),Sb.delete(n),Eb.delete(n),bb.delete(n),Rb.delete(n)};st.sync=n=>{Vw=!0,st.batchedUpdates(n),Vw=!1};st.throttle=n=>{let e;function t(){try{n(...e)}finally{e=null}}function r(...i){e=i,st.onStart(t)}return r.handler=n,r.cancel=()=>{U1.delete(t),e=null},r};let Tb=typeof window<"u"?window.requestAnimationFrame:()=>{};st.use=n=>Tb=n;st.now=typeof performance<"u"?()=>performance.now():Date.now;st.batchedUpdates=n=>n();st.catch=console.error;st.frameLoop="always";st.advance=()=>{st.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):T_()};let Xo=-1,Qo=0,Vw=!1;function Qd(n,e){Vw?(e.delete(n),n(0)):(e.add(n),S_())}function S_(){Xo<0&&(Xo=0,st.frameLoop!=="demand"&&Tb(R_))}function xce(){Xo=-1}function R_(){~Xo&&(Tb(R_),st.batchedUpdates(T_))}function T_(){let n=Xo;Xo=st.now();let e=b_(Xo);e&&(A_(Bu.splice(0,e),t=>t.handler()),Qo-=e),U1.flush(),Eb.flush(n?Math.min(64,Xo-n):16.667),Sb.flush(),bb.flush(),Rb.flush(),Qo||xce()}function Zd(){let n=new Set,e=n;return{add(t){Qo+=e==n&&!n.has(t)?1:0,n.add(t)},delete(t){return Qo-=e==n&&n.has(t)?1:0,n.delete(t)},flush(t){e.size&&(n=new Set,Qo-=e.size,A_(e,r=>r(t)&&n.add(r)),Qo+=n.size,e=n)}}}function A_(n,e){n.forEach(t=>{try{e(t)}catch(r){st.catch(r)}})}function $w(){}const Mce=(n,e,t)=>Object.defineProperty(n,e,{value:t,writable:!0,configurable:!0}),xe={arr:Array.isArray,obj:n=>!!n&&n.constructor.name==="Object",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",und:n=>n===void 0};function ho(n,e){if(xe.arr(n)){if(!xe.arr(e)||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}return n===e}const et=(n,e)=>n.forEach(e);function Bs(n,e,t){if(xe.arr(n)){for(let r=0;r<n.length;r++)e.call(t,n[r],`${r}`);return}for(const r in n)n.hasOwnProperty(r)&&e.call(t,n[r],r)}const Pr=n=>xe.und(n)?[]:xe.arr(n)?n:[n];function Lh(n,e){if(n.size){const t=Array.from(n);n.clear(),et(t,e)}}const hh=(n,...e)=>Lh(n,t=>t(...e)),x_=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent);let Ab,M_,sa=null,N_=!1,xb=$w;const Nce=n=>{n.to&&(M_=n.to),n.now&&(st.now=n.now),n.colors!==void 0&&(sa=n.colors),n.skipAnimation!=null&&(N_=n.skipAnimation),n.createStringInterpolator&&(Ab=n.createStringInterpolator),n.requestAnimationFrame&&st.use(n.requestAnimationFrame),n.batchedUpdates&&(st.batchedUpdates=n.batchedUpdates),n.willAdvance&&(xb=n.willAdvance),n.frameLoop&&(st.frameLoop=n.frameLoop)};var Vs=Object.freeze({__proto__:null,get createStringInterpolator(){return Ab},get to(){return M_},get colors(){return sa},get skipAnimation(){return N_},get willAdvance(){return xb},assign:Nce});const Ph=new Set;let Ai=[],j6=[],eg=0;const B1={get idle(){return!Ph.size&&!Ai.length},start(n){eg>n.priority?(Ph.add(n),st.onStart(Ice)):(I_(n),st(Ww))},advance:Ww,sort(n){if(eg)st.onFrame(()=>B1.sort(n));else{const e=Ai.indexOf(n);~e&&(Ai.splice(e,1),O_(n))}},clear(){Ai=[],Ph.clear()}};function Ice(){Ph.forEach(I_),Ph.clear(),st(Ww)}function I_(n){Ai.includes(n)||O_(n)}function O_(n){Ai.splice(Oce(Ai,e=>e.priority>n.priority),0,n)}function Ww(n){const e=j6;for(let t=0;t<Ai.length;t++){const r=Ai[t];eg=r.priority,r.idle||(xb(r),r.advance(n),r.idle||e.push(r))}return eg=0,j6=Ai,j6.length=0,Ai=e,Ai.length>0}function Oce(n,e){const t=n.findIndex(e);return t<0?n.length:t}const _ce={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},es="[-+]?\\d*\\.?\\d+",tg=es+"%";function V1(...n){return"\\(\\s*("+n.join(")\\s*,\\s*(")+")\\s*\\)"}const Lce=new RegExp("rgb"+V1(es,es,es)),Pce=new RegExp("rgba"+V1(es,es,es,es)),Dce=new RegExp("hsl"+V1(es,tg,tg)),kce=new RegExp("hsla"+V1(es,tg,tg,es)),Fce=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Hce=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Uce=/^#([0-9a-fA-F]{6})$/,Bce=/^#([0-9a-fA-F]{8})$/;function Vce(n){let e;return typeof n=="number"?n>>>0===n&&n>=0&&n<=4294967295?n:null:(e=Uce.exec(n))?parseInt(e[1]+"ff",16)>>>0:sa&&sa[n]!==void 0?sa[n]:(e=Lce.exec(n))?(cu(e[1])<<24|cu(e[2])<<16|cu(e[3])<<8|255)>>>0:(e=Pce.exec(n))?(cu(e[1])<<24|cu(e[2])<<16|cu(e[3])<<8|h8(e[4]))>>>0:(e=Fce.exec(n))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=Bce.exec(n))?parseInt(e[1],16)>>>0:(e=Hce.exec(n))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=Dce.exec(n))?(u8(c8(e[1]),hm(e[2]),hm(e[3]))|255)>>>0:(e=kce.exec(n))?(u8(c8(e[1]),hm(e[2]),hm(e[3]))|h8(e[4]))>>>0:null}function K6(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function u8(n,e,t){const r=t<.5?t*(1+e):t+e-t*e,i=2*t-r,s=K6(i,r,n+1/3),o=K6(i,r,n),a=K6(i,r,n-1/3);return Math.round(s*255)<<24|Math.round(o*255)<<16|Math.round(a*255)<<8}function cu(n){const e=parseInt(n,10);return e<0?0:e>255?255:e}function c8(n){return(parseFloat(n)%360+360)%360/360}function h8(n){const e=parseFloat(n);return e<0?0:e>1?255:Math.round(e*255)}function hm(n){const e=parseFloat(n);return e<0?0:e>100?1:e/100}function d8(n){let e=Vce(n);if(e===null)return n;e=e||0;let t=(e&4278190080)>>>24,r=(e&16711680)>>>16,i=(e&65280)>>>8,s=(e&255)/255;return`rgba(${t}, ${r}, ${i}, ${s})`}const md=(n,e,t)=>{if(xe.fun(n))return n;if(xe.arr(n))return md({range:n,output:e,extrapolate:t});if(xe.str(n.output[0]))return Ab(n);const r=n,i=r.output,s=r.range||[0,1],o=r.extrapolateLeft||r.extrapolate||"extend",a=r.extrapolateRight||r.extrapolate||"extend",l=r.easing||(u=>u);return u=>{const c=Wce(u,s);return $ce(u,s[c],s[c+1],i[c],i[c+1],l,o,a,r.map)}};function $ce(n,e,t,r,i,s,o,a,l){let u=l?l(n):n;if(u<e){if(o==="identity")return u;o==="clamp"&&(u=e)}if(u>t){if(a==="identity")return u;a==="clamp"&&(u=t)}return r===i?r:e===t?n<=e?r:i:(e===-1/0?u=-u:t===1/0?u=u-e:u=(u-e)/(t-e),u=s(u),r===-1/0?u=-u:i===1/0?u=u+r:u=u*(i-r)+r,u)}function Wce(n,e){for(var t=1;t<e.length-1&&!(e[t]>=n);++t);return t-1}function Gw(){return Gw=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Gw.apply(this,arguments)}const nc=Symbol.for("FluidValue.get"),pl=Symbol.for("FluidValue.observers"),Ti=n=>Boolean(n&&n[nc]),Wr=n=>n&&n[nc]?n[nc]():n,f8=n=>n[pl]||null;function Gce(n,e){n.eventObserved?n.eventObserved(e):n(e)}function pd(n,e){let t=n[pl];t&&t.forEach(r=>{Gce(r,e)})}class __{constructor(e){if(this[nc]=void 0,this[pl]=void 0,!e&&!(e=this.get))throw Error("Unknown getter");zce(this,e)}}const zce=(n,e)=>L_(n,nc,e);function Rc(n,e){if(n[nc]){let t=n[pl];t||L_(n,pl,t=new Set),t.has(e)||(t.add(e),n.observerAdded&&n.observerAdded(t.size,e))}return e}function gd(n,e){let t=n[pl];if(t&&t.has(e)){const r=t.size-1;r?t.delete(e):n[pl]=null,n.observerRemoved&&n.observerRemoved(r,e)}}const L_=(n,e,t)=>Object.defineProperty(n,e,{value:t,writable:!0,configurable:!0}),qm=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Yce=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,m8=new RegExp(`(${qm.source})(%|[a-z]+)`,"i"),jce=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,$1=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,P_=n=>{const[e,t]=Kce(n);if(!e||x_())return n;const r=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(r)return r.trim();if(t&&t.startsWith("--")){const i=window.getComputedStyle(document.documentElement).getPropertyValue(t);return i||n}else{if(t&&$1.test(t))return P_(t);if(t)return t}return n},Kce=n=>{const e=$1.exec(n);if(!e)return[,];const[,t,r]=e;return[t,r]};let q6;const qce=(n,e,t,r,i)=>`rgba(${Math.round(e)}, ${Math.round(t)}, ${Math.round(r)}, ${i})`,D_=n=>{q6||(q6=sa?new RegExp(`(${Object.keys(sa).join("|")})(?!\\w)`,"g"):/^\b$/);const e=n.output.map(s=>Wr(s).replace($1,P_).replace(Yce,d8).replace(q6,d8)),t=e.map(s=>s.match(qm).map(Number)),i=t[0].map((s,o)=>t.map(a=>{if(!(o in a))throw Error('The arity of each "output" value must be equal');return a[o]})).map(s=>md(Gw({},n,{output:s})));return s=>{var o;const a=!m8.test(e[0])&&((o=e.find(u=>m8.test(u)))==null?void 0:o.replace(qm,""));let l=0;return e[0].replace(qm,()=>`${i[l++](s)}${a||""}`).replace(jce,qce)}},Mb="react-spring: ",k_=n=>{const e=n;let t=!1;if(typeof e!="function")throw new TypeError(`${Mb}once requires a function parameter`);return(...r)=>{t||(e(...r),t=!0)}},Xce=k_(console.warn);function Qce(){Xce(`${Mb}The "interpolate" function is deprecated in v9 (use "to" instead)`)}const Zce=k_(console.warn);function Jce(){Zce(`${Mb}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function W1(n){return xe.str(n)&&(n[0]=="#"||/\d/.test(n)||!x_()&&$1.test(n)||n in(sa||{}))}const qa=typeof window<"u"&&window.document&&window.document.createElement?ie.exports.useLayoutEffect:ie.exports.useEffect,ehe=()=>{const n=ie.exports.useRef(!1);return qa(()=>(n.current=!0,()=>{n.current=!1}),[]),n};function Nb(){const n=ie.exports.useState()[1],e=ehe();return()=>{e.current&&n(Math.random())}}function the(n,e){const[t]=ie.exports.useState(()=>({inputs:e,result:n()})),r=ie.exports.useRef(),i=r.current;let s=i;return s?Boolean(e&&s.inputs&&nhe(e,s.inputs))||(s={inputs:e,result:n()}):s=t,ie.exports.useEffect(()=>{r.current=s,i==t&&(t.inputs=t.result=void 0)},[s]),s.result}function nhe(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}const Ib=n=>ie.exports.useEffect(n,rhe),rhe=[];function zw(n){const e=ie.exports.useRef();return ie.exports.useEffect(()=>{e.current=n}),e.current}const yd=Symbol.for("Animated:node"),ihe=n=>!!n&&n[yd]===n,Rs=n=>n&&n[yd],Ob=(n,e)=>Mce(n,yd,e),G1=n=>n&&n[yd]&&n[yd].getPayload();class F_{constructor(){this.payload=void 0,Ob(this,this)}getPayload(){return this.payload||[]}}class Tc extends F_{constructor(e){super(),this.done=!0,this.elapsedTime=void 0,this.lastPosition=void 0,this.lastVelocity=void 0,this.v0=void 0,this.durationProgress=0,this._value=e,xe.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new Tc(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,t){return xe.num(e)&&(this.lastPosition=e,t&&(e=Math.round(e/t)*t,this.done&&(this.lastPosition=e))),this._value===e?!1:(this._value=e,!0)}reset(){const{done:e}=this;this.done=!1,xe.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}}class rc extends Tc{constructor(e){super(0),this._string=null,this._toString=void 0,this._toString=md({output:[e,e]})}static create(e){return new rc(e)}getValue(){let e=this._string;return e==null?this._string=this._toString(this._value):e}setValue(e){if(xe.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else if(super.setValue(e))this._string=null;else return!1;return!0}reset(e){e&&(this._toString=md({output:[this.getValue(),e]})),this._value=0,super.reset()}}const ng={dependencies:null};class z1 extends F_{constructor(e){super(),this.source=e,this.setValue(e)}getValue(e){const t={};return Bs(this.source,(r,i)=>{ihe(r)?t[i]=r.getValue(e):Ti(r)?t[i]=Wr(r):e||(t[i]=r)}),t}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&et(this.payload,e=>e.reset())}_makePayload(e){if(e){const t=new Set;return Bs(e,this._addToPayload,t),Array.from(t)}}_addToPayload(e){ng.dependencies&&Ti(e)&&ng.dependencies.add(e);const t=G1(e);t&&et(t,r=>this.add(r))}}class _b extends z1{constructor(e){super(e)}static create(e){return new _b(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){const t=this.getPayload();return e.length==t.length?t.map((r,i)=>r.setValue(e[i])).some(Boolean):(super.setValue(e.map(she)),!0)}}function she(n){return(W1(n)?rc:Tc).create(n)}function Yw(n){const e=Rs(n);return e?e.constructor:xe.arr(n)?_b:W1(n)?rc:Tc}function rg(){return rg=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},rg.apply(this,arguments)}const p8=(n,e)=>{const t=!xe.fun(n)||n.prototype&&n.prototype.isReactComponent;return ie.exports.forwardRef((r,i)=>{const s=ie.exports.useRef(null),o=t&&ie.exports.useCallback(m=>{s.current=lhe(i,m)},[i]),[a,l]=ahe(r,e),u=Nb(),c=()=>{const m=s.current;if(t&&!m)return;(m?e.applyAnimatedValues(m,a.getValue(!0)):!1)===!1&&u()},h=new ohe(c,l),d=ie.exports.useRef();qa(()=>(d.current=h,et(l,m=>Rc(m,h)),()=>{d.current&&(et(d.current.deps,m=>gd(m,d.current)),st.cancel(d.current.update))})),ie.exports.useEffect(c,[]),Ib(()=>()=>{const m=d.current;et(m.deps,p=>gd(p,m))});const f=e.getComponentProps(a.getValue());return ie.exports.createElement(n,rg({},f,{ref:o}))})};class ohe{constructor(e,t){this.update=e,this.deps=t}eventObserved(e){e.type=="change"&&st.write(this.update)}}function ahe(n,e){const t=new Set;return ng.dependencies=t,n.style&&(n=rg({},n,{style:e.createAnimatedStyle(n.style)})),n=new z1(n),ng.dependencies=null,[n,t]}function lhe(n,e){return n&&(xe.fun(n)?n(e):n.current=e),e}const g8=Symbol.for("AnimatedComponent"),uhe=(n,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:t=i=>new z1(i),getComponentProps:r=i=>i}={})=>{const i={applyAnimatedValues:e,createAnimatedStyle:t,getComponentProps:r},s=o=>{const a=y8(o)||"Anonymous";return xe.str(o)?o=s[o]||(s[o]=p8(o,i)):o=o[g8]||(o[g8]=p8(o,i)),o.displayName=`Animated(${a})`,o};return Bs(n,(o,a)=>{xe.arr(n)&&(a=y8(o)),s[a]=s(o)}),{animated:s}},y8=n=>xe.str(n)?n:n&&xe.str(n.displayName)?n.displayName:xe.fun(n)&&n.name||null;function Rn(){return Rn=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Rn.apply(this,arguments)}function Gr(n,...e){return xe.fun(n)?n(...e):n}const Dh=(n,e)=>n===!0||!!(e&&n&&(xe.fun(n)?n(e):Pr(n).includes(e))),H_=(n,e)=>xe.obj(n)?e&&n[e]:n,U_=(n,e)=>n.default===!0?n[e]:n.default?n.default[e]:void 0,che=n=>n,Y1=(n,e=che)=>{let t=hhe;n.default&&n.default!==!0&&(n=n.default,t=Object.keys(n));const r={};for(const i of t){const s=e(n[i],i);xe.und(s)||(r[i]=s)}return r},hhe=["config","onProps","onStart","onChange","onPause","onResume","onRest"],dhe={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function fhe(n){const e={};let t=0;if(Bs(n,(r,i)=>{dhe[i]||(e[i]=r,t++)}),t)return e}function Lb(n){const e=fhe(n);if(e){const t={to:e};return Bs(n,(r,i)=>i in e||(t[i]=r)),t}return Rn({},n)}function wd(n){return n=Wr(n),xe.arr(n)?n.map(wd):W1(n)?Vs.createStringInterpolator({range:[0,1],output:[n,n]})(1):n}function B_(n){for(const e in n)return!0;return!1}function jw(n){return xe.fun(n)||xe.arr(n)&&xe.obj(n[0])}function Kw(n,e){var t;(t=n.ref)==null||t.delete(n),e==null||e.delete(n)}function V_(n,e){if(e&&n.ref!==e){var t;(t=n.ref)==null||t.delete(n),e.add(n),n.ref=e}}const Pb={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},ig=1.70158,dm=ig*1.525,w8=ig+1,v8=2*Math.PI/3,C8=2*Math.PI/4.5,fm=n=>n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375,mhe={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>1-(1-n)*(1-n),easeInOutQuad:n=>n<.5?2*n*n:1-Math.pow(-2*n+2,2)/2,easeInCubic:n=>n*n*n,easeOutCubic:n=>1-Math.pow(1-n,3),easeInOutCubic:n=>n<.5?4*n*n*n:1-Math.pow(-2*n+2,3)/2,easeInQuart:n=>n*n*n*n,easeOutQuart:n=>1-Math.pow(1-n,4),easeInOutQuart:n=>n<.5?8*n*n*n*n:1-Math.pow(-2*n+2,4)/2,easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>1-Math.pow(1-n,5),easeInOutQuint:n=>n<.5?16*n*n*n*n*n:1-Math.pow(-2*n+2,5)/2,easeInSine:n=>1-Math.cos(n*Math.PI/2),easeOutSine:n=>Math.sin(n*Math.PI/2),easeInOutSine:n=>-(Math.cos(Math.PI*n)-1)/2,easeInExpo:n=>n===0?0:Math.pow(2,10*n-10),easeOutExpo:n=>n===1?1:1-Math.pow(2,-10*n),easeInOutExpo:n=>n===0?0:n===1?1:n<.5?Math.pow(2,20*n-10)/2:(2-Math.pow(2,-20*n+10))/2,easeInCirc:n=>1-Math.sqrt(1-Math.pow(n,2)),easeOutCirc:n=>Math.sqrt(1-Math.pow(n-1,2)),easeInOutCirc:n=>n<.5?(1-Math.sqrt(1-Math.pow(2*n,2)))/2:(Math.sqrt(1-Math.pow(-2*n+2,2))+1)/2,easeInBack:n=>w8*n*n*n-ig*n*n,easeOutBack:n=>1+w8*Math.pow(n-1,3)+ig*Math.pow(n-1,2),easeInOutBack:n=>n<.5?Math.pow(2*n,2)*((dm+1)*2*n-dm)/2:(Math.pow(2*n-2,2)*((dm+1)*(n*2-2)+dm)+2)/2,easeInElastic:n=>n===0?0:n===1?1:-Math.pow(2,10*n-10)*Math.sin((n*10-10.75)*v8),easeOutElastic:n=>n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((n*10-.75)*v8)+1,easeInOutElastic:n=>n===0?0:n===1?1:n<.5?-(Math.pow(2,20*n-10)*Math.sin((20*n-11.125)*C8))/2:Math.pow(2,-20*n+10)*Math.sin((20*n-11.125)*C8)/2+1,easeInBounce:n=>1-fm(1-n),easeOutBounce:fm,easeInOutBounce:n=>n<.5?(1-fm(1-2*n))/2:(1+fm(2*n-1))/2},qw=Rn({},Pb.default,{mass:1,damping:1,easing:mhe.linear,clamp:!1});class phe{constructor(){this.tension=void 0,this.friction=void 0,this.frequency=void 0,this.damping=void 0,this.mass=void 0,this.velocity=0,this.restVelocity=void 0,this.precision=void 0,this.progress=void 0,this.duration=void 0,this.easing=void 0,this.clamp=void 0,this.bounce=void 0,this.decay=void 0,this.round=void 0,Object.assign(this,qw)}}function ghe(n,e,t){t&&(t=Rn({},t),E8(t,e),e=Rn({},t,e)),E8(n,e),Object.assign(n,e);for(const o in qw)n[o]==null&&(n[o]=qw[o]);let{mass:r,frequency:i,damping:s}=n;return xe.und(i)||(i<.01&&(i=.01),s<0&&(s=0),n.tension=Math.pow(2*Math.PI/i,2)*r,n.friction=4*Math.PI*s*r/i),n}function E8(n,e){if(!xe.und(e.decay))n.duration=void 0;else{const t=!xe.und(e.tension)||!xe.und(e.friction);(t||!xe.und(e.frequency)||!xe.und(e.damping)||!xe.und(e.mass))&&(n.duration=void 0,n.decay=void 0),t&&(n.frequency=void 0)}}const b8=[];class yhe{constructor(){this.changed=!1,this.values=b8,this.toValues=null,this.fromValues=b8,this.to=void 0,this.from=void 0,this.config=new phe,this.immediate=!1}}function $_(n,{key:e,props:t,defaultProps:r,state:i,actions:s}){return new Promise((o,a)=>{var l;let u,c,h=Dh((l=t.cancel)!=null?l:r==null?void 0:r.cancel,e);if(h)m();else{xe.und(t.pause)||(i.paused=Dh(t.pause,e));let p=r==null?void 0:r.pause;p!==!0&&(p=i.paused||Dh(p,e)),u=Gr(t.delay||0,e),p?(i.resumeQueue.add(f),s.pause()):(s.resume(),f())}function d(){i.resumeQueue.add(f),i.timeouts.delete(c),c.cancel(),u=c.time-st.now()}function f(){u>0&&!Vs.skipAnimation?(i.delayed=!0,c=st.setTimeout(m,u),i.pauseQueue.add(d),i.timeouts.add(c)):m()}function m(){i.delayed&&(i.delayed=!1),i.pauseQueue.delete(d),i.timeouts.delete(c),n<=(i.cancelId||0)&&(h=!0);try{s.start(Rn({},t,{callId:n,cancel:h}),o)}catch(p){a(p)}}})}const Db=(n,e)=>e.length==1?e[0]:e.some(t=>t.cancelled)?Vu(n.get()):e.every(t=>t.noop)?W_(n.get()):Qi(n.get(),e.every(t=>t.finished)),W_=n=>({value:n,noop:!0,finished:!0,cancelled:!1}),Qi=(n,e,t=!1)=>({value:n,finished:e,cancelled:t}),Vu=n=>({value:n,cancelled:!0,finished:!1});function G_(n,e,t,r){const{callId:i,parentId:s,onRest:o}=e,{asyncTo:a,promise:l}=t;return!s&&n===a&&!e.reset?l:t.promise=(async()=>{t.asyncId=i,t.asyncTo=n;const u=Y1(e,(y,C)=>C==="onRest"?void 0:y);let c,h;const d=new Promise((y,C)=>(c=y,h=C)),f=y=>{const C=i<=(t.cancelId||0)&&Vu(r)||i!==t.asyncId&&Qi(r,!1);if(C)throw y.result=C,h(y),y},m=(y,C)=>{const b=new S8,v=new R8;return(async()=>{if(Vs.skipAnimation)throw vd(t),v.result=Qi(r,!1),h(v),v;f(b);const S=xe.obj(y)?Rn({},y):Rn({},C,{to:y});S.parentId=i,Bs(u,(_,P)=>{xe.und(S[P])&&(S[P]=_)});const L=await r.start(S);return f(b),t.paused&&await new Promise(_=>{t.resumeQueue.add(_)}),L})()};let p;if(Vs.skipAnimation)return vd(t),Qi(r,!1);try{let y;xe.arr(n)?y=(async C=>{for(const b of C)await m(b)})(n):y=Promise.resolve(n(m,r.stop.bind(r))),await Promise.all([y.then(c),d]),p=Qi(r.get(),!0,!1)}catch(y){if(y instanceof S8)p=y.result;else if(y instanceof R8)p=y.result;else throw y}finally{i==t.asyncId&&(t.asyncId=s,t.asyncTo=s?a:void 0,t.promise=s?l:void 0)}return xe.fun(o)&&st.batchedUpdates(()=>{o(p,r,r.item)}),p})()}function vd(n,e){Lh(n.timeouts,t=>t.cancel()),n.pauseQueue.clear(),n.resumeQueue.clear(),n.asyncId=n.asyncTo=n.promise=void 0,e&&(n.cancelId=e)}class S8 extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise."),this.result=void 0}}class R8 extends Error{constructor(){super("SkipAnimationSignal"),this.result=void 0}}const Xw=n=>n instanceof kb;let whe=1;class kb extends __{constructor(...e){super(...e),this.id=whe++,this.key=void 0,this._priority=0}get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){const e=Rs(this);return e&&e.getValue()}to(...e){return Vs.to(this,e)}interpolate(...e){return Qce(),Vs.to(this,e)}toJSON(){return this.get()}observerAdded(e){e==1&&this._attach()}observerRemoved(e){e==0&&this._detach()}_attach(){}_detach(){}_onChange(e,t=!1){pd(this,{type:"change",parent:this,value:e,idle:t})}_onPriorityChange(e){this.idle||B1.sort(this),pd(this,{type:"priority",parent:this,priority:e})}}const gl=Symbol.for("SpringPhase"),z_=1,Qw=2,Zw=4,X6=n=>(n[gl]&z_)>0,Fo=n=>(n[gl]&Qw)>0,qc=n=>(n[gl]&Zw)>0,T8=(n,e)=>e?n[gl]|=Qw|z_:n[gl]&=~Qw,A8=(n,e)=>e?n[gl]|=Zw:n[gl]&=~Zw;class vhe extends kb{constructor(e,t){if(super(),this.key=void 0,this.animation=new yhe,this.queue=void 0,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!xe.und(e)||!xe.und(t)){const r=xe.obj(e)?Rn({},e):Rn({},t,{from:e});xe.und(r.default)&&(r.default=!0),this.start(r)}}get idle(){return!(Fo(this)||this._state.asyncTo)||qc(this)}get goal(){return Wr(this.animation.to)}get velocity(){const e=Rs(this);return e instanceof Tc?e.lastVelocity||0:e.getPayload().map(t=>t.lastVelocity||0)}get hasAnimated(){return X6(this)}get isAnimating(){return Fo(this)}get isPaused(){return qc(this)}get isDelayed(){return this._state.delayed}advance(e){let t=!0,r=!1;const i=this.animation;let{config:s,toValues:o}=i;const a=G1(i.to);!a&&Ti(i.to)&&(o=Pr(Wr(i.to))),i.values.forEach((c,h)=>{if(c.done)return;const d=c.constructor==rc?1:a?a[h].lastPosition:o[h];let f=i.immediate,m=d;if(!f){if(m=c.lastPosition,s.tension<=0){c.done=!0;return}let p=c.elapsedTime+=e;const y=i.fromValues[h],C=c.v0!=null?c.v0:c.v0=xe.arr(s.velocity)?s.velocity[h]:s.velocity;let b;if(xe.und(s.duration))if(s.decay){const v=s.decay===!0?.998:s.decay,S=Math.exp(-(1-v)*p);m=y+C/(1-v)*(1-S),f=Math.abs(c.lastPosition-m)<.1,b=C*S}else{b=c.lastVelocity==null?C:c.lastVelocity;const v=s.precision||(y==d?.005:Math.min(1,Math.abs(d-y)*.001)),S=s.restVelocity||v/10,L=s.clamp?0:s.bounce,_=!xe.und(L),P=y==d?c.v0>0:y<d;let x,I=!1;const R=1,N=Math.ceil(e/R);for(let H=0;H<N&&(x=Math.abs(b)>S,!(!x&&(f=Math.abs(d-m)<=v,f)));++H){_&&(I=m==d||m>d==P,I&&(b=-b*L,m=d));const K=-s.tension*1e-6*(m-d),X=-s.friction*.001*b,J=(K+X)/s.mass;b=b+J*R,m=m+b*R}}else{let v=1;s.duration>0&&(this._memoizedDuration!==s.duration&&(this._memoizedDuration=s.duration,c.durationProgress>0&&(c.elapsedTime=s.duration*c.durationProgress,p=c.elapsedTime+=e)),v=(s.progress||0)+p/this._memoizedDuration,v=v>1?1:v<0?0:v,c.durationProgress=v),m=y+s.easing(v)*(d-y),b=(m-c.lastPosition)/e,f=v==1}c.lastVelocity=b,Number.isNaN(m)&&(console.warn("Got NaN while animating:",this),f=!0)}a&&!a[h].done&&(f=!1),f?c.done=!0:t=!1,c.setValue(m,s.round)&&(r=!0)});const l=Rs(this),u=l.getValue();if(t){const c=Wr(i.to);(u!==c||r)&&!s.decay?(l.setValue(c),this._onChange(c)):r&&s.decay&&this._onChange(u),this._stop()}else r&&this._onChange(u)}set(e){return st.batchedUpdates(()=>{this._stop(),this._focus(e),this._set(e)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(Fo(this)){const{to:e,config:t}=this.animation;st.batchedUpdates(()=>{this._onStart(),t.decay||this._set(e,!1),this._stop()})}return this}update(e){return(this.queue||(this.queue=[])).push(e),this}start(e,t){let r;return xe.und(e)?(r=this.queue||[],this.queue=[]):r=[xe.obj(e)?e:Rn({},t,{to:e})],Promise.all(r.map(i=>this._update(i))).then(i=>Db(this,i))}stop(e){const{to:t}=this.animation;return this._focus(this.get()),vd(this._state,e&&this._lastCallId),st.batchedUpdates(()=>this._stop(t,e)),this}reset(){this._update({reset:!0})}eventObserved(e){e.type=="change"?this._start():e.type=="priority"&&(this.priority=e.priority+1)}_prepareNode(e){const t=this.key||"";let{to:r,from:i}=e;r=xe.obj(r)?r[t]:r,(r==null||jw(r))&&(r=void 0),i=xe.obj(i)?i[t]:i,i==null&&(i=void 0);const s={to:r,from:i};return X6(this)||(e.reverse&&([r,i]=[i,r]),i=Wr(i),xe.und(i)?Rs(this)||this._set(r):this._set(i)),s}_update(e,t){let r=Rn({},e);const{key:i,defaultProps:s}=this;r.default&&Object.assign(s,Y1(r,(l,u)=>/^on/.test(u)?H_(l,i):l)),M8(this,r,"onProps"),Qc(this,"onProps",r,this);const o=this._prepareNode(r);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const a=this._state;return $_(++this._lastCallId,{key:i,props:r,defaultProps:s,state:a,actions:{pause:()=>{qc(this)||(A8(this,!0),hh(a.pauseQueue),Qc(this,"onPause",Qi(this,Xc(this,this.animation.to)),this))},resume:()=>{qc(this)&&(A8(this,!1),Fo(this)&&this._resume(),hh(a.resumeQueue),Qc(this,"onResume",Qi(this,Xc(this,this.animation.to)),this))},start:this._merge.bind(this,o)}}).then(l=>{if(r.loop&&l.finished&&!(t&&l.noop)){const u=Y_(r);if(u)return this._update(u,!0)}return l})}_merge(e,t,r){if(t.cancel)return this.stop(!0),r(Vu(this));const i=!xe.und(e.to),s=!xe.und(e.from);if(i||s)if(t.callId>this._lastToId)this._lastToId=t.callId;else return r(Vu(this));const{key:o,defaultProps:a,animation:l}=this,{to:u,from:c}=l;let{to:h=u,from:d=c}=e;s&&!i&&(!t.default||xe.und(h))&&(h=d),t.reverse&&([h,d]=[d,h]);const f=!ho(d,c);f&&(l.from=d),d=Wr(d);const m=!ho(h,u);m&&this._focus(h);const p=jw(t.to),{config:y}=l,{decay:C,velocity:b}=y;(i||s)&&(y.velocity=0),t.config&&!p&&ghe(y,Gr(t.config,o),t.config!==a.config?Gr(a.config,o):void 0);let v=Rs(this);if(!v||xe.und(h))return r(Qi(this,!0));const S=xe.und(t.reset)?s&&!t.default:!xe.und(d)&&Dh(t.reset,o),L=S?d:this.get(),_=wd(h),P=xe.num(_)||xe.arr(_)||W1(_),x=!p&&(!P||Dh(a.immediate||t.immediate,o));if(m){const H=Yw(h);if(H!==v.constructor)if(x)v=this._set(_);else throw Error(`Cannot animate between ${v.constructor.name} and ${H.name}, as the "to" prop suggests`)}const I=v.constructor;let R=Ti(h),N=!1;if(!R){const H=S||!X6(this)&&f;(m||H)&&(N=ho(wd(L),_),R=!N),(!ho(l.immediate,x)&&!x||!ho(y.decay,C)||!ho(y.velocity,b))&&(R=!0)}if(N&&Fo(this)&&(l.changed&&!S?R=!0:R||this._stop(u)),!p&&((R||Ti(u))&&(l.values=v.getPayload(),l.toValues=Ti(h)?null:I==rc?[1]:Pr(_)),l.immediate!=x&&(l.immediate=x,!x&&!S&&this._set(u)),R)){const{onRest:H}=l;et(Ehe,X=>M8(this,t,X));const K=Qi(this,Xc(this,u));hh(this._pendingCalls,K),this._pendingCalls.add(r),l.changed&&st.batchedUpdates(()=>{l.changed=!S,H==null||H(K,this),S?Gr(a.onRest,K):l.onStart==null||l.onStart(K,this)})}S&&this._set(L),p?r(G_(t.to,t,this._state,this)):R?this._start():Fo(this)&&!m?this._pendingCalls.add(r):r(W_(L))}_focus(e){const t=this.animation;e!==t.to&&(f8(this)&&this._detach(),t.to=e,f8(this)&&this._attach())}_attach(){let e=0;const{to:t}=this.animation;Ti(t)&&(Rc(t,this),Xw(t)&&(e=t.priority+1)),this.priority=e}_detach(){const{to:e}=this.animation;Ti(e)&&gd(e,this)}_set(e,t=!0){const r=Wr(e);if(!xe.und(r)){const i=Rs(this);if(!i||!ho(r,i.getValue())){const s=Yw(r);!i||i.constructor!=s?Ob(this,s.create(r)):i.setValue(r),i&&st.batchedUpdates(()=>{this._onChange(r,t)})}}return Rs(this)}_onStart(){const e=this.animation;e.changed||(e.changed=!0,Qc(this,"onStart",Qi(this,Xc(this,e.to)),this))}_onChange(e,t){t||(this._onStart(),Gr(this.animation.onChange,e,this)),Gr(this.defaultProps.onChange,e,this),super._onChange(e,t)}_start(){const e=this.animation;Rs(this).reset(Wr(e.to)),e.immediate||(e.fromValues=e.values.map(t=>t.lastPosition)),Fo(this)||(T8(this,!0),qc(this)||this._resume())}_resume(){Vs.skipAnimation?this.finish():B1.start(this)}_stop(e,t){if(Fo(this)){T8(this,!1);const r=this.animation;et(r.values,s=>{s.done=!0}),r.toValues&&(r.onChange=r.onPause=r.onResume=void 0),pd(this,{type:"idle",parent:this});const i=t?Vu(this.get()):Qi(this.get(),Xc(this,e!=null?e:r.to));hh(this._pendingCalls,i),r.changed&&(r.changed=!1,Qc(this,"onRest",i,this))}}}function Xc(n,e){const t=wd(e),r=wd(n.get());return ho(r,t)}function Y_(n,e=n.loop,t=n.to){let r=Gr(e);if(r){const i=r!==!0&&Lb(r),s=(i||n).reverse,o=!i||i.reset;return Cd(Rn({},n,{loop:e,default:!1,pause:void 0,to:!s||jw(t)?t:void 0,from:o?n.from:void 0,reset:o},i))}}function Cd(n){const{to:e,from:t}=n=Lb(n),r=new Set;return xe.obj(e)&&x8(e,r),xe.obj(t)&&x8(t,r),n.keys=r.size?Array.from(r):null,n}function Che(n){const e=Cd(n);return xe.und(e.default)&&(e.default=Y1(e)),e}function x8(n,e){Bs(n,(t,r)=>t!=null&&e.add(r))}const Ehe=["onStart","onRest","onChange","onPause","onResume"];function M8(n,e,t){n.animation[t]=e[t]!==U_(e,t)?H_(e[t],n.key):void 0}function Qc(n,e,...t){var r,i,s,o;(r=(i=n.animation)[e])==null||r.call(i,...t),(s=(o=n.defaultProps)[e])==null||s.call(o,...t)}const bhe=["onStart","onChange","onRest"];let She=1;class j_{constructor(e,t){this.id=She++,this.springs={},this.queue=[],this.ref=void 0,this._flush=void 0,this._initialProps=void 0,this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._item=void 0,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),t&&(this._flush=t),e&&this.start(Rn({default:!0},e))}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(e=>e.idle&&!e.isDelayed&&!e.isPaused)}get item(){return this._item}set item(e){this._item=e}get(){const e={};return this.each((t,r)=>e[r]=t.get()),e}set(e){for(const t in e){const r=e[t];xe.und(r)||this.springs[t].set(r)}}update(e){return e&&this.queue.push(Cd(e)),this}start(e){let{queue:t}=this;return e?t=Pr(e).map(Cd):this.queue=[],this._flush?this._flush(this,t):(Z_(this,t),Jw(this,t))}stop(e,t){if(e!==!!e&&(t=e),t){const r=this.springs;et(Pr(t),i=>r[i].stop(!!e))}else vd(this._state,this._lastAsyncId),this.each(r=>r.stop(!!e));return this}pause(e){if(xe.und(e))this.start({pause:!0});else{const t=this.springs;et(Pr(e),r=>t[r].pause())}return this}resume(e){if(xe.und(e))this.start({pause:!1});else{const t=this.springs;et(Pr(e),r=>t[r].resume())}return this}each(e){Bs(this.springs,e)}_onFrame(){const{onStart:e,onChange:t,onRest:r}=this._events,i=this._active.size>0,s=this._changed.size>0;(i&&!this._started||s&&!this._started)&&(this._started=!0,Lh(e,([l,u])=>{u.value=this.get(),l(u,this,this._item)}));const o=!i&&this._started,a=s||o&&r.size?this.get():null;s&&t.size&&Lh(t,([l,u])=>{u.value=a,l(u,this,this._item)}),o&&(this._started=!1,Lh(r,([l,u])=>{u.value=a,l(u,this,this._item)}))}eventObserved(e){if(e.type=="change")this._changed.add(e.parent),e.idle||this._active.add(e.parent);else if(e.type=="idle")this._active.delete(e.parent);else return;st.onFrame(this._onFrame)}}function Jw(n,e){return Promise.all(e.map(t=>K_(n,t))).then(t=>Db(n,t))}async function K_(n,e,t){const{keys:r,to:i,from:s,loop:o,onRest:a,onResolve:l}=e,u=xe.obj(e.default)&&e.default;o&&(e.loop=!1),i===!1&&(e.to=null),s===!1&&(e.from=null);const c=xe.arr(i)||xe.fun(i)?i:void 0;c?(e.to=void 0,e.onRest=void 0,u&&(u.onRest=void 0)):et(bhe,p=>{const y=e[p];if(xe.fun(y)){const C=n._events[p];e[p]=({finished:b,cancelled:v})=>{const S=C.get(y);S?(b||(S.finished=!1),v&&(S.cancelled=!0)):C.set(y,{value:null,finished:b||!1,cancelled:v||!1})},u&&(u[p]=e[p])}});const h=n._state;e.pause===!h.paused?(h.paused=e.pause,hh(e.pause?h.pauseQueue:h.resumeQueue)):h.paused&&(e.pause=!0);const d=(r||Object.keys(n.springs)).map(p=>n.springs[p].start(e)),f=e.cancel===!0||U_(e,"cancel")===!0;(c||f&&h.asyncId)&&d.push($_(++n._lastAsyncId,{props:e,state:h,actions:{pause:$w,resume:$w,start(p,y){f?(vd(h,n._lastAsyncId),y(Vu(n))):(p.onRest=a,y(G_(c,p,h,n)))}}})),h.paused&&await new Promise(p=>{h.resumeQueue.add(p)});const m=Db(n,await Promise.all(d));if(o&&m.finished&&!(t&&m.noop)){const p=Y_(e,o,i);if(p)return Z_(n,[p]),K_(n,p,!0)}return l&&st.batchedUpdates(()=>l(m,n,n.item)),m}function e5(n,e){const t=Rn({},n.springs);return e&&et(Pr(e),r=>{xe.und(r.keys)&&(r=Cd(r)),xe.obj(r.to)||(r=Rn({},r,{to:void 0})),Q_(t,r,i=>X_(i))}),q_(n,t),t}function q_(n,e){Bs(e,(t,r)=>{n.springs[r]||(n.springs[r]=t,Rc(t,n))})}function X_(n,e){const t=new vhe;return t.key=n,e&&Rc(t,e),t}function Q_(n,e,t){e.keys&&et(e.keys,r=>{(n[r]||(n[r]=t(r)))._prepareNode(e)})}function Z_(n,e){et(e,t=>{Q_(n.springs,t,r=>X_(r,n))})}function Rhe(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}const The=["children"],Jd=n=>{let{children:e}=n,t=Rhe(n,The);const r=ie.exports.useContext(sg),i=t.pause||!!r.pause,s=t.immediate||!!r.immediate;t=the(()=>({pause:i,immediate:s}),[i,s]);const{Provider:o}=sg;return ie.exports.createElement(o,{value:t},e)},sg=Ahe(Jd,{});Jd.Provider=sg.Provider;Jd.Consumer=sg.Consumer;function Ahe(n,e){return Object.assign(n,ie.exports.createContext(e)),n.Provider._context=n,n.Consumer._context=n,n}const J_=()=>{const n=[],e=function(i){Jce();const s=[];return et(n,(o,a)=>{if(xe.und(i))s.push(o.start());else{const l=t(i,o,a);l&&s.push(o.start(l))}}),s};e.current=n,e.add=function(r){n.includes(r)||n.push(r)},e.delete=function(r){const i=n.indexOf(r);~i&&n.splice(i,1)},e.pause=function(){return et(n,r=>r.pause(...arguments)),this},e.resume=function(){return et(n,r=>r.resume(...arguments)),this},e.set=function(r){et(n,i=>i.set(r))},e.start=function(r){const i=[];return et(n,(s,o)=>{if(xe.und(r))i.push(s.start());else{const a=this._getProps(r,s,o);a&&i.push(s.start(a))}}),i},e.stop=function(){return et(n,r=>r.stop(...arguments)),this},e.update=function(r){return et(n,(i,s)=>i.update(this._getProps(r,i,s))),this};const t=function(i,s,o){return xe.fun(i)?i(o,s):i};return e._getProps=t,e};function xhe(n,e,t){const r=xe.fun(e)&&e;r&&!t&&(t=[]);const i=ie.exports.useMemo(()=>r||arguments.length==3?J_():void 0,[]),s=ie.exports.useRef(0),o=Nb(),a=ie.exports.useMemo(()=>({ctrls:[],queue:[],flush(C,b){const v=e5(C,b);return s.current>0&&!a.queue.length&&!Object.keys(v).some(L=>!C.springs[L])?Jw(C,b):new Promise(L=>{q_(C,v),a.queue.push(()=>{L(Jw(C,b))}),o()})}}),[]),l=ie.exports.useRef([...a.ctrls]),u=[],c=zw(n)||0;ie.exports.useMemo(()=>{et(l.current.slice(n,c),C=>{Kw(C,i),C.stop(!0)}),l.current.length=n,h(c,n)},[n]),ie.exports.useMemo(()=>{h(0,Math.min(c,n))},t);function h(C,b){for(let v=C;v<b;v++){const S=l.current[v]||(l.current[v]=new j_(null,a.flush)),L=r?r(v,S):e[v];L&&(u[v]=Che(L))}}const d=l.current.map((C,b)=>e5(C,u[b])),f=ie.exports.useContext(Jd),m=zw(f),p=f!==m&&B_(f);qa(()=>{s.current++,a.ctrls=l.current;const{queue:C}=a;C.length&&(a.queue=[],et(C,b=>b())),et(l.current,(b,v)=>{i==null||i.add(b),p&&b.start({default:f});const S=u[v];S&&(V_(b,S.ref),b.ref?b.queue.push(S):b.start(S))})}),Ib(()=>()=>{et(a.ctrls,C=>C.stop(!0))});const y=d.map(C=>Rn({},C));return i?[y,i]:y}function Ks(n,e){const t=xe.fun(n),[[r],i]=xhe(1,t?n:[n],t?e||[]:e);return t||arguments.length==2?[r,i]:r}let Ir;(function(n){n.MOUNT="mount",n.ENTER="enter",n.UPDATE="update",n.LEAVE="leave"})(Ir||(Ir={}));function Fb(n,e,t){const r=xe.fun(e)&&e,{reset:i,sort:s,trail:o=0,expires:a=!0,exitBeforeEnter:l=!1,onDestroyed:u,ref:c,config:h}=r?r():e,d=ie.exports.useMemo(()=>r||arguments.length==3?J_():void 0,[]),f=Pr(n),m=[],p=ie.exports.useRef(null),y=i?null:p.current;qa(()=>{p.current=m}),Ib(()=>(et(p.current,X=>{var J;(J=X.ctrl.ref)==null||J.add(X.ctrl);const ue=P.get(X);ue&&X.ctrl.start(ue.payload)}),()=>{et(p.current,X=>{X.expired&&clearTimeout(X.expirationId),Kw(X.ctrl,d),X.ctrl.stop(!0)})}));const C=Nhe(f,r?r():e,y),b=i&&p.current||[];qa(()=>et(b,({ctrl:X,item:J,key:ue})=>{Kw(X,d),Gr(u,J,ue)}));const v=[];if(y&&et(y,(X,J)=>{X.expired?(clearTimeout(X.expirationId),b.push(X)):(J=v[J]=C.indexOf(X.key),~J&&(m[J]=X))}),et(f,(X,J)=>{m[J]||(m[J]={key:C[J],item:X,phase:Ir.MOUNT,ctrl:new j_},m[J].ctrl.item=X)}),v.length){let X=-1;const{leave:J}=r?r():e;et(v,(ue,se)=>{const O=y[se];~ue?(X=m.indexOf(O),m[X]=Rn({},O,{item:f[ue]})):J&&m.splice(++X,0,O)})}xe.fun(s)&&m.sort((X,J)=>s(X.item,J.item));let S=-o;const L=Nb(),_=Y1(e),P=new Map,x=ie.exports.useRef(new Map),I=ie.exports.useRef(!1);et(m,(X,J)=>{const ue=X.key,se=X.phase,O=r?r():e;let g,E,A=Gr(O.delay||0,ue);if(se==Ir.MOUNT)g=O.enter,E=Ir.ENTER;else{const oe=C.indexOf(ue)<0;if(se!=Ir.LEAVE)if(oe)g=O.leave,E=Ir.LEAVE;else if(g=O.update)E=Ir.UPDATE;else return;else if(!oe)g=O.enter,E=Ir.ENTER;else return}if(g=Gr(g,X.item,J),g=xe.obj(g)?Lb(g):{to:g},!g.config){const oe=h||_.config;g.config=Gr(oe,X.item,J,E)}S+=o;const U=Rn({},_,{delay:A+S,ref:c,immediate:O.immediate,reset:!1},g);if(E==Ir.ENTER&&xe.und(U.from)){const oe=r?r():e,j=xe.und(oe.initial)||y?oe.from:oe.initial;U.from=Gr(j,X.item,J)}const{onResolve:G}=U;U.onResolve=oe=>{Gr(G,oe);const j=p.current,ye=j.find(ee=>ee.key===ue);if(!!ye&&!(oe.cancelled&&ye.phase!=Ir.UPDATE)&&ye.ctrl.idle){const ee=j.every(T=>T.ctrl.idle);if(ye.phase==Ir.LEAVE){const T=Gr(a,ye.item);if(T!==!1){const F=T===!0?0:T;if(ye.expired=!0,!ee&&F>0){F<=2147483647&&(ye.expirationId=setTimeout(L,F));return}}}ee&&j.some(T=>T.expired)&&(x.current.delete(ye),l&&(I.current=!0),L())}};const V=e5(X.ctrl,U);E===Ir.LEAVE&&l?x.current.set(X,{phase:E,springs:V,payload:U}):P.set(X,{phase:E,springs:V,payload:U})});const R=ie.exports.useContext(Jd),N=zw(R),H=R!==N&&B_(R);qa(()=>{H&&et(m,X=>{X.ctrl.start({default:R})})},[R]),et(P,(X,J)=>{if(x.current.size){const ue=m.findIndex(se=>se.key===J.key);m.splice(ue,1)}}),qa(()=>{et(x.current.size?x.current:P,({phase:X,payload:J},ue)=>{const{ctrl:se}=ue;ue.phase=X,d==null||d.add(se),H&&X==Ir.ENTER&&se.start({default:R}),J&&(V_(se,J.ref),se.ref&&!I.current?se.update(J):(se.start(J),I.current&&(I.current=!1)))})},i?void 0:t);const K=X=>ie.exports.createElement(ie.exports.Fragment,null,m.map((J,ue)=>{const{springs:se}=P.get(J)||J.ctrl,O=X(Rn({},se),J.item,J,ue);return O&&O.type?ie.exports.createElement(O.type,Rn({},O.props,{key:xe.str(J.key)||xe.num(J.key)?J.key:J.ctrl.id,ref:O.ref})):O}));return d?[K,d]:K}let Mhe=1;function Nhe(n,{key:e,keys:t=e},r){if(t===null){const i=new Set;return n.map(s=>{const o=r&&r.find(a=>a.item===s&&a.phase!==Ir.LEAVE&&!i.has(a));return o?(i.add(o),o.key):Mhe++})}return xe.und(t)?n:xe.fun(t)?n.map(t):Pr(t)}class eL extends kb{constructor(e,t){super(),this.key=void 0,this.idle=!0,this.calc=void 0,this._active=new Set,this.source=e,this.calc=md(...t);const r=this._get(),i=Yw(r);Ob(this,i.create(r))}advance(e){const t=this._get(),r=this.get();ho(t,r)||(Rs(this).setValue(t),this._onChange(t,this.idle)),!this.idle&&N8(this._active)&&Q6(this)}_get(){const e=xe.arr(this.source)?this.source.map(Wr):Pr(Wr(this.source));return this.calc(...e)}_start(){this.idle&&!N8(this._active)&&(this.idle=!1,et(G1(this),e=>{e.done=!1}),Vs.skipAnimation?(st.batchedUpdates(()=>this.advance()),Q6(this)):B1.start(this))}_attach(){let e=1;et(Pr(this.source),t=>{Ti(t)&&Rc(t,this),Xw(t)&&(t.idle||this._active.add(t),e=Math.max(e,t.priority+1))}),this.priority=e,this._start()}_detach(){et(Pr(this.source),e=>{Ti(e)&&gd(e,this)}),this._active.clear(),Q6(this)}eventObserved(e){e.type=="change"?e.idle?this.advance():(this._active.add(e.parent),this._start()):e.type=="idle"?this._active.delete(e.parent):e.type=="priority"&&(this.priority=Pr(this.source).reduce((t,r)=>Math.max(t,(Xw(r)?r.priority:0)+1),0))}}function Ihe(n){return n.idle!==!1}function N8(n){return!n.size||Array.from(n).every(Ihe)}function Q6(n){n.idle||(n.idle=!0,et(G1(n),e=>{e.done=!0}),pd(n,{type:"idle",parent:n}))}const t5=(n,...e)=>new eL(n,e);Vs.assign({createStringInterpolator:D_,to:(n,e)=>new eL(n,e)});function Hb(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}const Ohe=["style","children","scrollTop","scrollLeft"],tL=/^--/;function _he(n,e){return e==null||typeof e=="boolean"||e===""?"":typeof e=="number"&&e!==0&&!tL.test(n)&&!(kh.hasOwnProperty(n)&&kh[n])?e+"px":(""+e).trim()}const I8={};function Lhe(n,e){if(!n.nodeType||!n.setAttribute)return!1;const t=n.nodeName==="filter"||n.parentNode&&n.parentNode.nodeName==="filter",r=e,{style:i,children:s,scrollTop:o,scrollLeft:a}=r,l=Hb(r,Ohe),u=Object.values(l),c=Object.keys(l).map(h=>t||n.hasAttribute(h)?h:I8[h]||(I8[h]=h.replace(/([A-Z])/g,d=>"-"+d.toLowerCase())));s!==void 0&&(n.textContent=s);for(let h in i)if(i.hasOwnProperty(h)){const d=_he(h,i[h]);tL.test(h)?n.style.setProperty(h,d):n.style[h]=d}c.forEach((h,d)=>{n.setAttribute(h,u[d])}),o!==void 0&&(n.scrollTop=o),a!==void 0&&(n.scrollLeft=a)}let kh={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};const Phe=(n,e)=>n+e.charAt(0).toUpperCase()+e.substring(1),Dhe=["Webkit","Ms","Moz","O"];kh=Object.keys(kh).reduce((n,e)=>(Dhe.forEach(t=>n[Phe(t,e)]=n[e]),n),kh);const khe=["x","y","z"],Fhe=/^(matrix|translate|scale|rotate|skew)/,Hhe=/^(translate)/,Uhe=/^(rotate|skew)/,Z6=(n,e)=>xe.num(n)&&n!==0?n+e:n,Xm=(n,e)=>xe.arr(n)?n.every(t=>Xm(t,e)):xe.num(n)?n===e:parseFloat(n)===e;class Bhe extends z1{constructor(e){let{x:t,y:r,z:i}=e,s=Hb(e,khe);const o=[],a=[];(t||r||i)&&(o.push([t||0,r||0,i||0]),a.push(l=>[`translate3d(${l.map(u=>Z6(u,"px")).join(",")})`,Xm(l,0)])),Bs(s,(l,u)=>{if(u==="transform")o.push([l||""]),a.push(c=>[c,c===""]);else if(Fhe.test(u)){if(delete s[u],xe.und(l))return;const c=Hhe.test(u)?"px":Uhe.test(u)?"deg":"";o.push(Pr(l)),a.push(u==="rotate3d"?([h,d,f,m])=>[`rotate3d(${h},${d},${f},${Z6(m,c)})`,Xm(m,0)]:h=>[`${u}(${h.map(d=>Z6(d,c)).join(",")})`,Xm(h,u.startsWith("scale")?1:0)])}}),o.length&&(s.transform=new Vhe(o,a)),super(s)}}class Vhe extends __{constructor(e,t){super(),this._value=null,this.inputs=e,this.transforms=t}get(){return this._value||(this._value=this._get())}_get(){let e="",t=!0;return et(this.inputs,(r,i)=>{const s=Wr(r[0]),[o,a]=this.transforms[i](xe.arr(s)?s:r.map(Wr));e+=" "+o,t=t&&a}),t?"none":e}observerAdded(e){e==1&&et(this.inputs,t=>et(t,r=>Ti(r)&&Rc(r,this)))}observerRemoved(e){e==0&&et(this.inputs,t=>et(t,r=>Ti(r)&&gd(r,this)))}eventObserved(e){e.type=="change"&&(this._value=null),pd(this,e)}}const $he=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],Whe=["scrollTop","scrollLeft"];Vs.assign({batchedUpdates:oA.exports.unstable_batchedUpdates,createStringInterpolator:D_,colors:_ce});const Ghe=uhe($he,{applyAnimatedValues:Lhe,createAnimatedStyle:n=>new Bhe(n),getComponentProps:n=>Hb(n,Whe)}),Tn=Ghe.animated;function yl(){return yl=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},yl.apply(this,arguments)}var zhe={pointerEvents:"none",position:"absolute",zIndex:10,top:0,left:0},O8=function(n,e){return"translate("+n+"px, "+e+"px)"},nL=ie.exports.memo(function(n){var e,t=n.position,r=n.anchor,i=n.children,s=rn(),o=Bi(),a=o.animate,l=o.config,u=LP(),c=u[0],h=u[1],d=ie.exports.useRef(!1),f=void 0,m=!1,p=h.width>0&&h.height>0,y=Math.round(t[0]),C=Math.round(t[1]);p&&(r==="top"?(y-=h.width/2,C-=h.height+14):r==="right"?(y+=14,C-=h.height/2):r==="bottom"?(y-=h.width/2,C+=14):r==="left"?(y-=h.width+14,C-=h.height/2):r==="center"&&(y-=h.width/2,C-=h.height/2),f={transform:O8(y,C)},d.current||(m=!0),d.current=[y,C]);var b=Ks({to:f,config:l,immediate:!a||m}),v=yl({},zhe,s.tooltip,{transform:(e=b.transform)!=null?e:O8(y,C)});return ce.jsx(Tn.div,{ref:c,style:v,children:i})});nL.displayName="TooltipWrapper";var rL=ie.exports.memo(function(n){var e=n.size,t=e===void 0?12:e,r=n.color,i=n.style;return ce.jsx("span",{style:yl({display:"block",width:t,height:t,background:r},i===void 0?{}:i)})}),iL=ie.exports.memo(function(n){var e,t=n.id,r=n.value,i=n.format,s=n.enableChip,o=s!==void 0&&s,a=n.color,l=n.renderContent,u=rn(),c=yg(i);if(typeof l=="function")e=l();else{var h=r;c!==void 0&&h!==void 0&&(h=c(h)),e=ce.jsxs("div",{style:u.tooltip.basic,children:[o&&ce.jsx(rL,{color:a,style:u.tooltip.chip}),h!==void 0?ce.jsxs("span",{children:[t,": ",ce.jsx("strong",{children:""+h})]}):t]})}return ce.jsx("div",{style:u.tooltip.container,children:e})}),Yhe={width:"100%",borderCollapse:"collapse"},sL=ie.exports.memo(function(n){var e,t=n.title,r=n.rows,i=r===void 0?[]:r,s=n.renderContent,o=rn();return i.length?(e=typeof s=="function"?s():ce.jsxs("div",{children:[t&&t,ce.jsx("table",{style:yl({},Yhe,o.tooltip.table),children:ce.jsx("tbody",{children:i.map(function(a,l){return ce.jsx("tr",{children:a.map(function(u,c){return ce.jsx("td",{style:o.tooltip.tableCell,children:u},c)})},l)})})})]}),ce.jsx("div",{style:o.tooltip.container,children:e})):null});sL.displayName="TableTooltip";var n5=ie.exports.memo(function(n){var e=n.x0,t=n.x1,r=n.y0,i=n.y1,s=rn(),o=Bi(),a=o.animate,l=o.config,u=ie.exports.useMemo(function(){return yl({},s.crosshair.line,{pointerEvents:"none"})},[s.crosshair.line]),c=Ks({x1:e,x2:t,y1:r,y2:i,config:l,immediate:!a});return ce.jsx(Tn.line,yl({},c,{fill:"none",style:u}))});n5.displayName="CrosshairLine";var r5=ie.exports.memo(function(n){var e,t,r=n.width,i=n.height,s=n.type,o=n.x,a=n.y;return s==="cross"?(e={x0:o,x1:o,y0:0,y1:i},t={x0:0,x1:r,y0:a,y1:a}):s==="top-left"?(e={x0:o,x1:o,y0:0,y1:a},t={x0:0,x1:o,y0:a,y1:a}):s==="top"?e={x0:o,x1:o,y0:0,y1:a}:s==="top-right"?(e={x0:o,x1:o,y0:0,y1:a},t={x0:o,x1:r,y0:a,y1:a}):s==="right"?t={x0:o,x1:r,y0:a,y1:a}:s==="bottom-right"?(e={x0:o,x1:o,y0:a,y1:i},t={x0:o,x1:r,y0:a,y1:a}):s==="bottom"?e={x0:o,x1:o,y0:a,y1:i}:s==="bottom-left"?(e={x0:o,x1:o,y0:a,y1:i},t={x0:0,x1:o,y0:a,y1:a}):s==="left"?t={x0:0,x1:o,y0:a,y1:a}:s==="x"?e={x0:o,x1:o,y0:0,y1:i}:s==="y"&&(t={x0:0,x1:r,y0:a,y1:a}),ce.jsxs(ce.Fragment,{children:[e&&ce.jsx(n5,{x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1}),t&&ce.jsx(n5,{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1})]})});r5.displayName="Crosshair";var oL=ie.exports.createContext({showTooltipAt:function(){},showTooltipFromEvent:function(){},hideTooltip:function(){}}),i5={isVisible:!1,position:[null,null],content:null,anchor:null},aL=ie.exports.createContext(i5),jhe=function(n){var e=ie.exports.useState(i5),t=e[0],r=e[1],i=ie.exports.useCallback(function(a,l,u){var c=l[0],h=l[1];u===void 0&&(u="top"),r({isVisible:!0,position:[c,h],anchor:u,content:a})},[r]),s=ie.exports.useCallback(function(a,l,u){u===void 0&&(u="top");var c=n.current.getBoundingClientRect(),h=n.current.offsetWidth,d=h===c.width?1:h/c.width,f=(l.clientX-c.left)*d,m=(l.clientY-c.top)*d;u!=="left"&&u!=="right"||(u=f<c.width/2?"right":"left"),r({isVisible:!0,position:[f,m],anchor:u,content:a})},[n,r]),o=ie.exports.useCallback(function(){r(i5)},[r]);return{actions:ie.exports.useMemo(function(){return{showTooltipAt:i,showTooltipFromEvent:s,hideTooltip:o}},[i,s,o]),state:t}},ef=function(){var n=ie.exports.useContext(oL);if(n===void 0)throw new Error("useTooltip must be used within a TooltipProvider");return n},Khe=function(){var n=ie.exports.useContext(aL);if(n===void 0)throw new Error("useTooltipState must be used within a TooltipProvider");return n},qhe=function(n){return n.isVisible},Xhe=function(){var n=Khe();return qhe(n)?ce.jsx(nL,{position:n.position,anchor:n.anchor,children:n.content}):null},Qhe=function(n){var e=n.container,t=n.children,r=jhe(e),i=r.actions,s=r.state;return ce.jsx(oL.Provider,{value:i,children:ce.jsx(aL.Provider,{value:s,children:t})})},Zhe=_5,Jhe=fA;function ede(n,e,t){(t!==void 0&&!Jhe(n[e],t)||t===void 0&&!(e in n))&&Zhe(n,e,t)}var lL=ede,og={exports:{}};(function(n,e){var t=Nk,r=e&&!e.nodeType&&e,i=r&&!0&&n&&!n.nodeType&&n,s=i&&i.exports===r,o=s?t.Buffer:void 0,a=o?o.allocUnsafe:void 0;function l(u,c){if(c)return u.slice();var h=u.length,d=a?a(h):new u.constructor(h);return u.copy(d),d}n.exports=l})(og,og.exports);var _8=Ik;function tde(n){var e=new n.constructor(n.byteLength);return new _8(e).set(new _8(n)),e}var Ub=tde,nde=Ub;function rde(n,e){var t=e?nde(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.length)}var uL=rde;function ide(n,e){var t=-1,r=n.length;for(e||(e=Array(r));++t<r;)e[t]=n[t];return e}var cL=ide,sde=fc,L8=Object.create,ode=function(){function n(){}return function(e){if(!sde(e))return{};if(L8)return L8(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}}(),ade=ode,lde=Ok,ude=lde(Object.getPrototypeOf,Object),Bb=ude,cde=ade,hde=Bb,dde=mA;function fde(n){return typeof n.constructor=="function"&&!dde(n)?cde(hde(n)):{}}var hL=fde,mde=pA,pde=Md;function gde(n){return pde(n)&&mde(n)}var dL=gde,yde=gA,wde=Bb,vde=Md,Cde="[object Object]",Ede=Function.prototype,bde=Object.prototype,fL=Ede.toString,Sde=bde.hasOwnProperty,Rde=fL.call(Object);function Tde(n){if(!vde(n)||yde(n)!=Cde)return!1;var e=wde(n);if(e===null)return!0;var t=Sde.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&fL.call(t)==Rde}var tf=Tde;function Ade(n,e){if(!(e==="constructor"&&typeof n[e]=="function")&&e!="__proto__")return n[e]}var mL=Ade,xde=_5,Mde=fA,Nde=Object.prototype,Ide=Nde.hasOwnProperty;function Ode(n,e,t){var r=n[e];(!(Ide.call(n,e)&&Mde(r,t))||t===void 0&&!(e in n))&&xde(n,e,t)}var Vb=Ode,_de=Vb,Lde=_5;function Pde(n,e,t,r){var i=!t;t||(t={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=r?r(t[a],n[a],a,t,n):void 0;l===void 0&&(l=n[a]),i?Lde(t,a,l):_de(t,a,l)}return t}var Ac=Pde;function Dde(n){var e=[];if(n!=null)for(var t in Object(n))e.push(t);return e}var kde=Dde,Fde=fc,Hde=mA,Ude=kde,Bde=Object.prototype,Vde=Bde.hasOwnProperty;function $de(n){if(!Fde(n))return Ude(n);var e=Hde(n),t=[];for(var r in n)r=="constructor"&&(e||!Vde.call(n,r))||t.push(r);return t}var Wde=$de,Gde=_k,zde=Wde,Yde=pA;function jde(n){return Yde(n)?Gde(n,!0):zde(n)}var nf=jde,Kde=Ac,qde=nf;function Xde(n){return Kde(n,qde(n))}var Qde=Xde,P8=lL,Zde=og.exports,Jde=uL,efe=cL,tfe=hL,D8=Lk,k8=L5,nfe=dL,rfe=yA.exports,ife=Uh,sfe=fc,ofe=tf,afe=Pk,F8=mL,lfe=Qde;function ufe(n,e,t,r,i,s,o){var a=F8(n,t),l=F8(e,t),u=o.get(l);if(u){P8(n,t,u);return}var c=s?s(a,l,t+"",n,e,o):void 0,h=c===void 0;if(h){var d=k8(l),f=!d&&rfe(l),m=!d&&!f&&afe(l);c=l,d||f||m?k8(a)?c=a:nfe(a)?c=efe(a):f?(h=!1,c=Zde(l,!0)):m?(h=!1,c=Jde(l,!0)):c=[]:ofe(l)||D8(l)?(c=a,D8(a)?c=lfe(a):(!sfe(a)||ife(a))&&(c=tfe(l))):h=!1}h&&(o.set(l,c),i(c,l,r,s,o),o.delete(l)),P8(n,t,c)}var cfe=ufe,hfe=wA,dfe=lL,ffe=Dk,mfe=cfe,pfe=fc,gfe=nf,yfe=mL;function pL(n,e,t,r,i){n!==e&&ffe(e,function(s,o){if(i||(i=new hfe),pfe(s))mfe(n,e,o,t,pL,r,i);else{var a=r?r(yfe(n,o),s,o+"",n,e,i):void 0;a===void 0&&(a=s),dfe(n,o,a)}},gfe)}var wfe=pL,vfe=vA,Cfe=kk;function Efe(n){return vfe(function(e,t){var r=-1,i=t.length,s=i>1?t[i-1]:void 0,o=i>2?t[2]:void 0;for(s=n.length>3&&typeof s=="function"?(i--,s):void 0,o&&Cfe(t[0],t[1],o)&&(s=i<3?void 0:s,i=1),e=Object(e);++r<i;){var a=t[r];a&&n(e,a,r,s)}return e})}var bfe=Efe,Sfe=wfe,Rfe=bfe,Tfe=Rfe(function(n,e,t){Sfe(n,e,t)}),Afe=Tfe,xfe=Vb,Mfe=Ig,Nfe=Fk,H8=fc,Ife=CA;function Ofe(n,e,t,r){if(!H8(n))return n;e=Mfe(e,n);for(var i=-1,s=e.length,o=s-1,a=n;a!=null&&++i<s;){var l=Ife(e[i]),u=t;if(l==="__proto__"||l==="constructor"||l==="prototype")return n;if(i!=o){var c=a[l];u=r?r(c,l,a):void 0,u===void 0&&(u=H8(c)?c:Nfe(e[i+1])?[]:{})}xfe(a,l,u),a=a[l]}return n}var gL=Ofe,_fe=gL;function Lfe(n,e,t){return n==null?n:_fe(n,e,t)}var Xa=Lfe;function j1(n,e,t){n.prototype=e.prototype=t,t.constructor=n}function $b(n,e){var t=Object.create(n.prototype);for(var r in e)t[r]=e[r];return t}function xc(){}var wl=.7,ic=1/wl,$u="\\s*([+-]?\\d+)\\s*",Ed="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ps="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Pfe=/^#([0-9a-f]{3,8})$/,Dfe=new RegExp("^rgb\\("+[$u,$u,$u]+"\\)$"),kfe=new RegExp("^rgb\\("+[Ps,Ps,Ps]+"\\)$"),Ffe=new RegExp("^rgba\\("+[$u,$u,$u,Ed]+"\\)$"),Hfe=new RegExp("^rgba\\("+[Ps,Ps,Ps,Ed]+"\\)$"),Ufe=new RegExp("^hsl\\("+[Ed,Ps,Ps]+"\\)$"),Bfe=new RegExp("^hsla\\("+[Ed,Ps,Ps,Ed]+"\\)$"),U8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};j1(xc,bd,{copy:function(n){return Object.assign(new this.constructor,this,n)},displayable:function(){return this.rgb().displayable()},hex:B8,formatHex:B8,formatHsl:Vfe,formatRgb:V8,toString:V8});function B8(){return this.rgb().formatHex()}function Vfe(){return wL(this).formatHsl()}function V8(){return this.rgb().formatRgb()}function bd(n){var e,t;return n=(n+"").trim().toLowerCase(),(e=Pfe.exec(n))?(t=e[1].length,e=parseInt(e[1],16),t===6?$8(e):t===3?new Dr(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?mm(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?mm(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Dfe.exec(n))?new Dr(e[1],e[2],e[3],1):(e=kfe.exec(n))?new Dr(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Ffe.exec(n))?mm(e[1],e[2],e[3],e[4]):(e=Hfe.exec(n))?mm(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Ufe.exec(n))?z8(e[1],e[2]/100,e[3]/100,1):(e=Bfe.exec(n))?z8(e[1],e[2]/100,e[3]/100,e[4]):U8.hasOwnProperty(n)?$8(U8[n]):n==="transparent"?new Dr(NaN,NaN,NaN,0):null}function $8(n){return new Dr(n>>16&255,n>>8&255,n&255,1)}function mm(n,e,t,r){return r<=0&&(n=e=t=NaN),new Dr(n,e,t,r)}function yL(n){return n instanceof xc||(n=bd(n)),n?(n=n.rgb(),new Dr(n.r,n.g,n.b,n.opacity)):new Dr}function sc(n,e,t,r){return arguments.length===1?yL(n):new Dr(n,e,t,r==null?1:r)}function Dr(n,e,t,r){this.r=+n,this.g=+e,this.b=+t,this.opacity=+r}j1(Dr,sc,$b(xc,{brighter:function(n){return n=n==null?ic:Math.pow(ic,n),new Dr(this.r*n,this.g*n,this.b*n,this.opacity)},darker:function(n){return n=n==null?wl:Math.pow(wl,n),new Dr(this.r*n,this.g*n,this.b*n,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:W8,formatHex:W8,formatRgb:G8,toString:G8}));function W8(){return"#"+J6(this.r)+J6(this.g)+J6(this.b)}function G8(){var n=this.opacity;return n=isNaN(n)?1:Math.max(0,Math.min(1,n)),(n===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(n===1?")":", "+n+")")}function J6(n){return n=Math.max(0,Math.min(255,Math.round(n)||0)),(n<16?"0":"")+n.toString(16)}function z8(n,e,t,r){return r<=0?n=e=t=NaN:t<=0||t>=1?n=e=NaN:e<=0&&(n=NaN),new Ms(n,e,t,r)}function wL(n){if(n instanceof Ms)return new Ms(n.h,n.s,n.l,n.opacity);if(n instanceof xc||(n=bd(n)),!n)return new Ms;if(n instanceof Ms)return n;n=n.rgb();var e=n.r/255,t=n.g/255,r=n.b/255,i=Math.min(e,t,r),s=Math.max(e,t,r),o=NaN,a=s-i,l=(s+i)/2;return a?(e===s?o=(t-r)/a+(t<r)*6:t===s?o=(r-e)/a+2:o=(e-t)/a+4,a/=l<.5?s+i:2-s-i,o*=60):a=l>0&&l<1?0:o,new Ms(o,a,l,n.opacity)}function $fe(n,e,t,r){return arguments.length===1?wL(n):new Ms(n,e,t,r==null?1:r)}function Ms(n,e,t,r){this.h=+n,this.s=+e,this.l=+t,this.opacity=+r}j1(Ms,$fe,$b(xc,{brighter:function(n){return n=n==null?ic:Math.pow(ic,n),new Ms(this.h,this.s,this.l*n,this.opacity)},darker:function(n){return n=n==null?wl:Math.pow(wl,n),new Ms(this.h,this.s,this.l*n,this.opacity)},rgb:function(){var n=this.h%360+(this.h<0)*360,e=isNaN(n)||isNaN(this.s)?0:this.s,t=this.l,r=t+(t<.5?t:1-t)*e,i=2*t-r;return new Dr(ey(n>=240?n-240:n+120,i,r),ey(n,i,r),ey(n<120?n+240:n-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var n=this.opacity;return n=isNaN(n)?1:Math.max(0,Math.min(1,n)),(n===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(n===1?")":", "+n+")")}}));function ey(n,e,t){return(n<60?e+(t-e)*n/60:n<180?t:n<240?e+(t-e)*(240-n)/60:e)*255}const Wfe=Math.PI/180,Gfe=180/Math.PI;var vL=-.14861,Wb=1.78277,Gb=-.29227,K1=-.90649,Sd=1.97294,Y8=Sd*K1,j8=Sd*Wb,K8=Wb*Gb-K1*vL;function zfe(n){if(n instanceof il)return new il(n.h,n.s,n.l,n.opacity);n instanceof Dr||(n=yL(n));var e=n.r/255,t=n.g/255,r=n.b/255,i=(K8*r+Y8*e-j8*t)/(K8+Y8-j8),s=r-i,o=(Sd*(t-i)-Gb*s)/K1,a=Math.sqrt(o*o+s*s)/(Sd*i*(1-i)),l=a?Math.atan2(o,s)*Gfe-120:NaN;return new il(l<0?l+360:l,a,i,n.opacity)}function $s(n,e,t,r){return arguments.length===1?zfe(n):new il(n,e,t,r==null?1:r)}function il(n,e,t,r){this.h=+n,this.s=+e,this.l=+t,this.opacity=+r}j1(il,$s,$b(xc,{brighter:function(n){return n=n==null?ic:Math.pow(ic,n),new il(this.h,this.s,this.l*n,this.opacity)},darker:function(n){return n=n==null?wl:Math.pow(wl,n),new il(this.h,this.s,this.l*n,this.opacity)},rgb:function(){var n=isNaN(this.h)?0:(this.h+120)*Wfe,e=+this.l,t=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(n),i=Math.sin(n);return new Dr(255*(e+t*(vL*r+Wb*i)),255*(e+t*(Gb*r+K1*i)),255*(e+t*(Sd*r)),this.opacity)}}));function Yfe(n,e,t,r,i){var s=n*n,o=s*n;return((1-3*n+3*s-o)*e+(4-6*s+3*o)*t+(1+3*n+3*s-3*o)*r+o*i)/6}function jfe(n){var e=n.length-1;return function(t){var r=t<=0?t=0:t>=1?(t=1,e-1):Math.floor(t*e),i=n[r],s=n[r+1],o=r>0?n[r-1]:2*i-s,a=r<e-1?n[r+2]:2*s-i;return Yfe((t-r/e)*e,o,i,s,a)}}const q1=n=>()=>n;function CL(n,e){return function(t){return n+t*e}}function Kfe(n,e,t){return n=Math.pow(n,t),e=Math.pow(e,t)-n,t=1/t,function(r){return Math.pow(n+r*e,t)}}function qfe(n,e){var t=e-n;return t?CL(n,t>180||t<-180?t-360*Math.round(t/360):t):q1(isNaN(n)?e:n)}function Xfe(n){return(n=+n)==1?Wu:function(e,t){return t-e?Kfe(e,t,n):q1(isNaN(e)?t:e)}}function Wu(n,e){var t=e-n;return t?CL(n,t):q1(isNaN(n)?e:n)}const q8=function n(e){var t=Xfe(e);function r(i,s){var o=t((i=sc(i)).r,(s=sc(s)).r),a=t(i.g,s.g),l=t(i.b,s.b),u=Wu(i.opacity,s.opacity);return function(c){return i.r=o(c),i.g=a(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=n,r}(1);function Qfe(n){return function(e){var t=e.length,r=new Array(t),i=new Array(t),s=new Array(t),o,a;for(o=0;o<t;++o)a=sc(e[o]),r[o]=a.r||0,i[o]=a.g||0,s[o]=a.b||0;return r=n(r),i=n(i),s=n(s),a.opacity=1,function(l){return a.r=r(l),a.g=i(l),a.b=s(l),a+""}}}var Zfe=Qfe(jfe);function Jfe(n,e){e||(e=[]);var t=n?Math.min(e.length,n.length):0,r=e.slice(),i;return function(s){for(i=0;i<t;++i)r[i]=n[i]*(1-s)+e[i]*s;return r}}function eme(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function tme(n,e){var t=e?e.length:0,r=n?Math.min(t,n.length):0,i=new Array(r),s=new Array(t),o;for(o=0;o<r;++o)i[o]=zb(n[o],e[o]);for(;o<t;++o)s[o]=e[o];return function(a){for(o=0;o<r;++o)s[o]=i[o](a);return s}}function nme(n,e){var t=new Date;return n=+n,e=+e,function(r){return t.setTime(n*(1-r)+e*r),t}}function ag(n,e){return n=+n,e=+e,function(t){return n*(1-t)+e*t}}function rme(n,e){var t={},r={},i;(n===null||typeof n!="object")&&(n={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in n?t[i]=zb(n[i],e[i]):r[i]=e[i];return function(s){for(i in t)r[i]=t[i](s);return r}}var s5=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ty=new RegExp(s5.source,"g");function ime(n){return function(){return n}}function sme(n){return function(e){return n(e)+""}}function EL(n,e){var t=s5.lastIndex=ty.lastIndex=0,r,i,s,o=-1,a=[],l=[];for(n=n+"",e=e+"";(r=s5.exec(n))&&(i=ty.exec(e));)(s=i.index)>t&&(s=e.slice(t,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:ag(r,i)})),t=ty.lastIndex;return t<e.length&&(s=e.slice(t),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?sme(l[0].x):ime(e):(e=l.length,function(u){for(var c=0,h;c<e;++c)a[(h=l[c]).i]=h.x(u);return a.join("")})}function zb(n,e){var t=typeof e,r;return e==null||t==="boolean"?q1(e):(t==="number"?ag:t==="string"?(r=bd(e))?(e=r,q8):EL:e instanceof bd?q8:e instanceof Date?nme:eme(e)?Jfe:Array.isArray(e)?tme:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?rme:ag)(n,e)}function ome(n,e){return n=+n,e=+e,function(t){return Math.round(n*(1-t)+e*t)}}function bL(n){return function e(t){t=+t;function r(i,s){var o=n((i=$s(i)).h,(s=$s(s)).h),a=Wu(i.s,s.s),l=Wu(i.l,s.l),u=Wu(i.opacity,s.opacity);return function(c){return i.h=o(c),i.s=a(c),i.l=l(Math.pow(c,t)),i.opacity=u(c),i+""}}return r.gamma=e,r}(1)}bL(qfe);var Yb=bL(Wu);function SL(n,e){return n<e?-1:n>e?1:n>=e?0:NaN}function jb(n){let e=n,t=n;n.length===1&&(e=(o,a)=>n(o)-a,t=ame(n));function r(o,a,l,u){for(l==null&&(l=0),u==null&&(u=o.length);l<u;){const c=l+u>>>1;t(o[c],a)<0?l=c+1:u=c}return l}function i(o,a,l,u){for(l==null&&(l=0),u==null&&(u=o.length);l<u;){const c=l+u>>>1;t(o[c],a)>0?u=c:l=c+1}return l}function s(o,a,l,u){l==null&&(l=0),u==null&&(u=o.length);const c=r(o,a,l,u-1);return c>l&&e(o[c-1],a)>-e(o[c],a)?c-1:c}return{left:r,center:s,right:i}}function ame(n){return(e,t)=>SL(n(e),t)}function lme(n){return n===null?NaN:+n}const ume=jb(SL),cme=ume.right;jb(lme).center;const hme=cme;var o5=Math.sqrt(50),a5=Math.sqrt(10),l5=Math.sqrt(2);function u5(n,e,t){var r,i=-1,s,o,a;if(e=+e,n=+n,t=+t,n===e&&t>0)return[n];if((r=e<n)&&(s=n,n=e,e=s),(a=RL(n,e,t))===0||!isFinite(a))return[];if(a>0){let l=Math.round(n/a),u=Math.round(e/a);for(l*a<n&&++l,u*a>e&&--u,o=new Array(s=u-l+1);++i<s;)o[i]=(l+i)*a}else{a=-a;let l=Math.round(n*a),u=Math.round(e*a);for(l/a<n&&++l,u/a>e&&--u,o=new Array(s=u-l+1);++i<s;)o[i]=(l+i)/a}return r&&o.reverse(),o}function RL(n,e,t){var r=(e-n)/Math.max(0,t),i=Math.floor(Math.log(r)/Math.LN10),s=r/Math.pow(10,i);return i>=0?(s>=o5?10:s>=a5?5:s>=l5?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=o5?10:s>=a5?5:s>=l5?2:1)}function c5(n,e,t){var r=Math.abs(e-n)/Math.max(0,t),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=r/i;return s>=o5?i*=10:s>=a5?i*=5:s>=l5&&(i*=2),e<n?-i:i}function dme(n,e,t){n=+n,e=+e,t=(i=arguments.length)<2?(e=n,n=0,1):i<3?1:+t;for(var r=-1,i=Math.max(0,Math.ceil((e-n)/t))|0,s=new Array(i);++r<i;)s[r]=n+r*t;return s}function _l(n,e){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(e).domain(n);break}return this}const X8=Symbol("implicit");function Qa(){var n=new Map,e=[],t=[],r=X8;function i(s){var o=s+"",a=n.get(o);if(!a){if(r!==X8)return r;n.set(o,a=e.push(s))}return t[(a-1)%t.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],n=new Map;for(const o of s){const a=o+"";n.has(a)||n.set(a,e.push(o))}return i},i.range=function(s){return arguments.length?(t=Array.from(s),i):t.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return Qa(e,t).unknown(r)},_l.apply(i,arguments),i}function Kb(){var n=Qa().unknown(void 0),e=n.domain,t=n.range,r=0,i=1,s,o,a=!1,l=0,u=0,c=.5;delete n.unknown;function h(){var d=e().length,f=i<r,m=f?i:r,p=f?r:i;s=(p-m)/Math.max(1,d-l+u*2),a&&(s=Math.floor(s)),m+=(p-m-s*(d-l))*c,o=s*(1-l),a&&(m=Math.round(m),o=Math.round(o));var y=dme(d).map(function(C){return m+s*C});return t(f?y.reverse():y)}return n.domain=function(d){return arguments.length?(e(d),h()):e()},n.range=function(d){return arguments.length?([r,i]=d,r=+r,i=+i,h()):[r,i]},n.rangeRound=function(d){return[r,i]=d,r=+r,i=+i,a=!0,h()},n.bandwidth=function(){return o},n.step=function(){return s},n.round=function(d){return arguments.length?(a=!!d,h()):a},n.padding=function(d){return arguments.length?(l=Math.min(1,u=+d),h()):l},n.paddingInner=function(d){return arguments.length?(l=Math.min(1,d),h()):l},n.paddingOuter=function(d){return arguments.length?(u=+d,h()):u},n.align=function(d){return arguments.length?(c=Math.max(0,Math.min(1,d)),h()):c},n.copy=function(){return Kb(e(),[r,i]).round(a).paddingInner(l).paddingOuter(u).align(c)},_l.apply(h(),arguments)}function TL(n){var e=n.copy;return n.padding=n.paddingOuter,delete n.paddingInner,delete n.paddingOuter,n.copy=function(){return TL(e())},n}function fme(){return TL(Kb.apply(null,arguments).paddingInner(1))}function mme(n){return function(){return n}}function pme(n){return+n}var Q8=[0,1];function Iu(n){return n}function h5(n,e){return(e-=n=+n)?function(t){return(t-n)/e}:mme(isNaN(e)?NaN:.5)}function gme(n,e){var t;return n>e&&(t=n,n=e,e=t),function(r){return Math.max(n,Math.min(e,r))}}function yme(n,e,t){var r=n[0],i=n[1],s=e[0],o=e[1];return i<r?(r=h5(i,r),s=t(o,s)):(r=h5(r,i),s=t(s,o)),function(a){return s(r(a))}}function wme(n,e,t){var r=Math.min(n.length,e.length)-1,i=new Array(r),s=new Array(r),o=-1;for(n[r]<n[0]&&(n=n.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=h5(n[o],n[o+1]),s[o]=t(e[o],e[o+1]);return function(a){var l=hme(n,a,1,r)-1;return s[l](i[l](a))}}function X1(n,e){return e.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function qb(){var n=Q8,e=Q8,t=zb,r,i,s,o=Iu,a,l,u;function c(){var d=Math.min(n.length,e.length);return o!==Iu&&(o=gme(n[0],n[d-1])),a=d>2?wme:yme,l=u=null,h}function h(d){return d==null||isNaN(d=+d)?s:(l||(l=a(n.map(r),e,t)))(r(o(d)))}return h.invert=function(d){return o(i((u||(u=a(e,n.map(r),ag)))(d)))},h.domain=function(d){return arguments.length?(n=Array.from(d,pme),c()):n.slice()},h.range=function(d){return arguments.length?(e=Array.from(d),c()):e.slice()},h.rangeRound=function(d){return e=Array.from(d),t=ome,c()},h.clamp=function(d){return arguments.length?(o=d?!0:Iu,c()):o!==Iu},h.interpolate=function(d){return arguments.length?(t=d,c()):t},h.unknown=function(d){return arguments.length?(s=d,h):s},function(d,f){return r=d,i=f,c()}}function AL(){return qb()(Iu,Iu)}function vme(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function lg(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,r=n.slice(0,t);return[r.length>1?r[0]+r.slice(2):r,+n.slice(t+1)]}function oc(n){return n=lg(Math.abs(n)),n?n[1]:NaN}function Cme(n,e){return function(t,r){for(var i=t.length,s=[],o=0,a=n[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),s.push(t.substring(i-=a,i+a)),!((l+=a+1)>r));)a=n[o=(o+1)%n.length];return s.reverse().join(e)}}function Eme(n){return function(e){return e.replace(/[0-9]/g,function(t){return n[+t]})}}var bme=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ug(n){if(!(e=bme.exec(n)))throw new Error("invalid format: "+n);var e;return new Xb({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}ug.prototype=Xb.prototype;function Xb(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}Xb.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Sme(n){e:for(var e=n.length,t=1,r=-1,i;t<e;++t)switch(n[t]){case".":r=i=t;break;case"0":r===0&&(r=t),i=t;break;default:if(!+n[t])break e;r>0&&(r=0);break}return r>0?n.slice(0,r)+n.slice(i+1):n}var xL;function Rme(n,e){var t=lg(n,e);if(!t)return n+"";var r=t[0],i=t[1],s=i-(xL=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+lg(n,Math.max(0,e+s-1))[0]}function Z8(n,e){var t=lg(n,e);if(!t)return n+"";var r=t[0],i=t[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const J8={"%":(n,e)=>(n*100).toFixed(e),b:n=>Math.round(n).toString(2),c:n=>n+"",d:vme,e:(n,e)=>n.toExponential(e),f:(n,e)=>n.toFixed(e),g:(n,e)=>n.toPrecision(e),o:n=>Math.round(n).toString(8),p:(n,e)=>Z8(n*100,e),r:Z8,s:Rme,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function e3(n){return n}var t3=Array.prototype.map,n3=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Tme(n){var e=n.grouping===void 0||n.thousands===void 0?e3:Cme(t3.call(n.grouping,Number),n.thousands+""),t=n.currency===void 0?"":n.currency[0]+"",r=n.currency===void 0?"":n.currency[1]+"",i=n.decimal===void 0?".":n.decimal+"",s=n.numerals===void 0?e3:Eme(t3.call(n.numerals,String)),o=n.percent===void 0?"%":n.percent+"",a=n.minus===void 0?"\u2212":n.minus+"",l=n.nan===void 0?"NaN":n.nan+"";function u(h){h=ug(h);var d=h.fill,f=h.align,m=h.sign,p=h.symbol,y=h.zero,C=h.width,b=h.comma,v=h.precision,S=h.trim,L=h.type;L==="n"?(b=!0,L="g"):J8[L]||(v===void 0&&(v=12),S=!0,L="g"),(y||d==="0"&&f==="=")&&(y=!0,d="0",f="=");var _=p==="$"?t:p==="#"&&/[boxX]/.test(L)?"0"+L.toLowerCase():"",P=p==="$"?r:/[%p]/.test(L)?o:"",x=J8[L],I=/[defgprs%]/.test(L);v=v===void 0?6:/[gprs]/.test(L)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function R(N){var H=_,K=P,X,J,ue;if(L==="c")K=x(N)+K,N="";else{N=+N;var se=N<0||1/N<0;if(N=isNaN(N)?l:x(Math.abs(N),v),S&&(N=Sme(N)),se&&+N==0&&m!=="+"&&(se=!1),H=(se?m==="("?m:a:m==="-"||m==="("?"":m)+H,K=(L==="s"?n3[8+xL/3]:"")+K+(se&&m==="("?")":""),I){for(X=-1,J=N.length;++X<J;)if(ue=N.charCodeAt(X),48>ue||ue>57){K=(ue===46?i+N.slice(X+1):N.slice(X))+K,N=N.slice(0,X);break}}}b&&!y&&(N=e(N,1/0));var O=H.length+N.length+K.length,g=O<C?new Array(C-O+1).join(d):"";switch(b&&y&&(N=e(g+N,g.length?C-K.length:1/0),g=""),f){case"<":N=H+N+K+g;break;case"=":N=H+g+N+K;break;case"^":N=g.slice(0,O=g.length>>1)+H+N+K+g.slice(O);break;default:N=g+H+N+K;break}return s(N)}return R.toString=function(){return h+""},R}function c(h,d){var f=u((h=ug(h),h.type="f",h)),m=Math.max(-8,Math.min(8,Math.floor(oc(d)/3)))*3,p=Math.pow(10,-m),y=n3[8+m/3];return function(C){return f(p*C)+y}}return{format:u,formatPrefix:c}}var pm,Qb,ML;Ame({thousands:",",grouping:[3],currency:["$",""]});function Ame(n){return pm=Tme(n),Qb=pm.format,ML=pm.formatPrefix,pm}function xme(n){return Math.max(0,-oc(Math.abs(n)))}function Mme(n,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(oc(e)/3)))*3-oc(Math.abs(n)))}function Nme(n,e){return n=Math.abs(n),e=Math.abs(e)-n,Math.max(0,oc(e)-oc(n))+1}function Ime(n,e,t,r){var i=c5(n,e,t),s;switch(r=ug(r==null?",f":r),r.type){case"s":{var o=Math.max(Math.abs(n),Math.abs(e));return r.precision==null&&!isNaN(s=Mme(i,o))&&(r.precision=s),ML(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=Nme(i,Math.max(Math.abs(n),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=xme(i))&&(r.precision=s-(r.type==="%")*2);break}}return Qb(r)}function NL(n){var e=n.domain;return n.ticks=function(t){var r=e();return u5(r[0],r[r.length-1],t==null?10:t)},n.tickFormat=function(t,r){var i=e();return Ime(i[0],i[i.length-1],t==null?10:t,r)},n.nice=function(t){t==null&&(t=10);var r=e(),i=0,s=r.length-1,o=r[i],a=r[s],l,u,c=10;for(a<o&&(u=o,o=a,a=u,u=i,i=s,s=u);c-- >0;){if(u=RL(o,a,t),u===l)return r[i]=o,r[s]=a,e(r);if(u>0)o=Math.floor(o/u)*u,a=Math.ceil(a/u)*u;else if(u<0)o=Math.ceil(o*u)/u,a=Math.floor(a*u)/u;else break;l=u}return n},n}function IL(){var n=AL();return n.copy=function(){return X1(n,IL())},_l.apply(n,arguments),NL(n)}function OL(n,e){n=n.slice();var t=0,r=n.length-1,i=n[t],s=n[r],o;return s<i&&(o=t,t=r,r=o,o=i,i=s,s=o),n[t]=e.floor(i),n[r]=e.ceil(s),n}function r3(n){return Math.log(n)}function i3(n){return Math.exp(n)}function Ome(n){return-Math.log(-n)}function _me(n){return-Math.exp(-n)}function Lme(n){return isFinite(n)?+("1e"+n):n<0?0:n}function Pme(n){return n===10?Lme:n===Math.E?Math.exp:function(e){return Math.pow(n,e)}}function Dme(n){return n===Math.E?Math.log:n===10&&Math.log10||n===2&&Math.log2||(n=Math.log(n),function(e){return Math.log(e)/n})}function s3(n){return function(e){return-n(-e)}}function kme(n){var e=n(r3,i3),t=e.domain,r=10,i,s;function o(){return i=Dme(r),s=Pme(r),t()[0]<0?(i=s3(i),s=s3(s),n(Ome,_me)):n(r3,i3),e}return e.base=function(a){return arguments.length?(r=+a,o()):r},e.domain=function(a){return arguments.length?(t(a),o()):t()},e.ticks=function(a){var l=t(),u=l[0],c=l[l.length-1],h;(h=c<u)&&(d=u,u=c,c=d);var d=i(u),f=i(c),m,p,y,C=a==null?10:+a,b=[];if(!(r%1)&&f-d<C){if(d=Math.floor(d),f=Math.ceil(f),u>0){for(;d<=f;++d)for(p=1,m=s(d);p<r;++p)if(y=m*p,!(y<u)){if(y>c)break;b.push(y)}}else for(;d<=f;++d)for(p=r-1,m=s(d);p>=1;--p)if(y=m*p,!(y<u)){if(y>c)break;b.push(y)}b.length*2<C&&(b=u5(u,c,C))}else b=u5(d,f,Math.min(f-d,C)).map(s);return h?b.reverse():b},e.tickFormat=function(a,l){if(l==null&&(l=r===10?".0e":","),typeof l!="function"&&(l=Qb(l)),a===1/0)return l;a==null&&(a=10);var u=Math.max(1,r*a/e.ticks().length);return function(c){var h=c/s(Math.round(i(c)));return h*r<r-.5&&(h*=r),h<=u?l(c):""}},e.nice=function(){return t(OL(t(),{floor:function(a){return s(Math.floor(i(a)))},ceil:function(a){return s(Math.ceil(i(a)))}}))},e}function _L(){var n=kme(qb()).domain([1,10]);return n.copy=function(){return X1(n,_L()).base(n.base())},_l.apply(n,arguments),n}function o3(n){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/n))}}function a3(n){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*n}}function Fme(n){var e=1,t=n(o3(e),a3(e));return t.constant=function(r){return arguments.length?n(o3(e=+r),a3(e)):e},NL(t)}function LL(){var n=Fme(qb());return n.copy=function(){return X1(n,LL()).constant(n.constant())},_l.apply(n,arguments)}var ny=new Date,ry=new Date;function sr(n,e,t,r){function i(s){return n(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=function(s){return n(s=new Date(+s)),s},i.ceil=function(s){return n(s=new Date(s-1)),e(s,1),n(s),s},i.round=function(s){var o=i(s),a=i.ceil(s);return s-o<a-s?o:a},i.offset=function(s,o){return e(s=new Date(+s),o==null?1:Math.floor(o)),s},i.range=function(s,o,a){var l=[],u;if(s=i.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return l;do l.push(u=new Date(+s)),e(s,a),n(s);while(u<s&&s<o);return l},i.filter=function(s){return sr(function(o){if(o>=o)for(;n(o),!s(o);)o.setTime(o-1)},function(o,a){if(o>=o)if(a<0)for(;++a<=0;)for(;e(o,-1),!s(o););else for(;--a>=0;)for(;e(o,1),!s(o););})},t&&(i.count=function(s,o){return ny.setTime(+s),ry.setTime(+o),n(ny),n(ry),Math.floor(t(ny,ry))},i.every=function(s){return s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?function(o){return r(o)%s===0}:function(o){return i.count(0,o)%s===0}):i}),i}var cg=sr(function(){},function(n,e){n.setTime(+n+e)},function(n,e){return e-n});cg.every=function(n){return n=Math.floor(n),!isFinite(n)||!(n>0)?null:n>1?sr(function(e){e.setTime(Math.floor(e/n)*n)},function(e,t){e.setTime(+e+t*n)},function(e,t){return(t-e)/n}):cg};const Hme=cg;cg.range;const po=1e3,Mi=po*60,go=Mi*60,vl=go*24,Zb=vl*7,l3=vl*30,iy=vl*365;var PL=sr(function(n){n.setTime(n-n.getMilliseconds())},function(n,e){n.setTime(+n+e*po)},function(n,e){return(e-n)/po},function(n){return n.getUTCSeconds()});const Ou=PL;PL.range;var DL=sr(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*po)},function(n,e){n.setTime(+n+e*Mi)},function(n,e){return(e-n)/Mi},function(n){return n.getMinutes()});const kL=DL;DL.range;var FL=sr(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*po-n.getMinutes()*Mi)},function(n,e){n.setTime(+n+e*go)},function(n,e){return(e-n)/go},function(n){return n.getHours()});const HL=FL;FL.range;var UL=sr(n=>n.setHours(0,0,0,0),(n,e)=>n.setDate(n.getDate()+e),(n,e)=>(e-n-(e.getTimezoneOffset()-n.getTimezoneOffset())*Mi)/vl,n=>n.getDate()-1);const Q1=UL;UL.range;function Ll(n){return sr(function(e){e.setDate(e.getDate()-(e.getDay()+7-n)%7),e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t*7)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Mi)/Zb})}var Z1=Ll(0),hg=Ll(1),Ume=Ll(2),Bme=Ll(3),ac=Ll(4),Vme=Ll(5),$me=Ll(6);Z1.range;hg.range;Ume.range;Bme.range;ac.range;Vme.range;$me.range;var BL=sr(function(n){n.setDate(1),n.setHours(0,0,0,0)},function(n,e){n.setMonth(n.getMonth()+e)},function(n,e){return e.getMonth()-n.getMonth()+(e.getFullYear()-n.getFullYear())*12},function(n){return n.getMonth()});const VL=BL;BL.range;var Jb=sr(function(n){n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,e){n.setFullYear(n.getFullYear()+e)},function(n,e){return e.getFullYear()-n.getFullYear()},function(n){return n.getFullYear()});Jb.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:sr(function(e){e.setFullYear(Math.floor(e.getFullYear()/n)*n),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t*n)})};const Cl=Jb;Jb.range;var $L=sr(function(n){n.setUTCSeconds(0,0)},function(n,e){n.setTime(+n+e*Mi)},function(n,e){return(e-n)/Mi},function(n){return n.getUTCMinutes()});const WL=$L;$L.range;var GL=sr(function(n){n.setUTCMinutes(0,0,0)},function(n,e){n.setTime(+n+e*go)},function(n,e){return(e-n)/go},function(n){return n.getUTCHours()});const zL=GL;GL.range;var YL=sr(function(n){n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCDate(n.getUTCDate()+e)},function(n,e){return(e-n)/vl},function(n){return n.getUTCDate()-1});const J1=YL;YL.range;function Pl(n){return sr(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-n)%7),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t*7)},function(e,t){return(t-e)/Zb})}var e0=Pl(0),dg=Pl(1),Wme=Pl(2),Gme=Pl(3),lc=Pl(4),zme=Pl(5),Yme=Pl(6);e0.range;dg.range;Wme.range;Gme.range;lc.range;zme.range;Yme.range;var jL=sr(function(n){n.setUTCDate(1),n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCMonth(n.getUTCMonth()+e)},function(n,e){return e.getUTCMonth()-n.getUTCMonth()+(e.getUTCFullYear()-n.getUTCFullYear())*12},function(n){return n.getUTCMonth()});const KL=jL;jL.range;var eS=sr(function(n){n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCFullYear(n.getUTCFullYear()+e)},function(n,e){return e.getUTCFullYear()-n.getUTCFullYear()},function(n){return n.getUTCFullYear()});eS.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:sr(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/n)*n),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t*n)})};const El=eS;eS.range;function qL(n,e,t,r,i,s){const o=[[Ou,1,po],[Ou,5,5*po],[Ou,15,15*po],[Ou,30,30*po],[s,1,Mi],[s,5,5*Mi],[s,15,15*Mi],[s,30,30*Mi],[i,1,go],[i,3,3*go],[i,6,6*go],[i,12,12*go],[r,1,vl],[r,2,2*vl],[t,1,Zb],[e,1,l3],[e,3,3*l3],[n,1,iy]];function a(u,c,h){const d=c<u;d&&([u,c]=[c,u]);const f=h&&typeof h.range=="function"?h:l(u,c,h),m=f?f.range(u,+c+1):[];return d?m.reverse():m}function l(u,c,h){const d=Math.abs(c-u)/h,f=jb(([,,y])=>y).right(o,d);if(f===o.length)return n.every(c5(u/iy,c/iy,h));if(f===0)return Hme.every(Math.max(c5(u,c,h),1));const[m,p]=o[d/o[f-1][2]<o[f][2]/d?f-1:f];return m.every(p)}return[a,l]}const[jme,Kme]=qL(El,KL,e0,J1,zL,WL),[qme,Xme]=qL(Cl,VL,Z1,Q1,HL,kL);function sy(n){if(0<=n.y&&n.y<100){var e=new Date(-1,n.m,n.d,n.H,n.M,n.S,n.L);return e.setFullYear(n.y),e}return new Date(n.y,n.m,n.d,n.H,n.M,n.S,n.L)}function oy(n){if(0<=n.y&&n.y<100){var e=new Date(Date.UTC(-1,n.m,n.d,n.H,n.M,n.S,n.L));return e.setUTCFullYear(n.y),e}return new Date(Date.UTC(n.y,n.m,n.d,n.H,n.M,n.S,n.L))}function Zc(n,e,t){return{y:n,m:e,d:t,H:0,M:0,S:0,L:0}}function Qme(n){var e=n.dateTime,t=n.date,r=n.time,i=n.periods,s=n.days,o=n.shortDays,a=n.months,l=n.shortMonths,u=Jc(i),c=eh(i),h=Jc(s),d=eh(s),f=Jc(o),m=eh(o),p=Jc(a),y=eh(a),C=Jc(l),b=eh(l),v={a:se,A:O,b:g,B:E,c:null,d:m3,e:m3,f:Cpe,g:Ipe,G:_pe,H:ype,I:wpe,j:vpe,L:XL,m:Epe,M:bpe,p:A,q:U,Q:y3,s:w3,S:Spe,u:Rpe,U:Tpe,V:Ape,w:xpe,W:Mpe,x:null,X:null,y:Npe,Y:Ope,Z:Lpe,"%":g3},S={a:G,A:V,b:oe,B:j,c:null,d:p3,e:p3,f:Fpe,g:jpe,G:qpe,H:Ppe,I:Dpe,j:kpe,L:ZL,m:Hpe,M:Upe,p:ye,q:ee,Q:y3,s:w3,S:Bpe,u:Vpe,U:$pe,V:Wpe,w:Gpe,W:zpe,x:null,X:null,y:Ype,Y:Kpe,Z:Xpe,"%":g3},L={a:R,A:N,b:H,B:K,c:X,d:d3,e:d3,f:fpe,g:h3,G:c3,H:f3,I:f3,j:upe,L:dpe,m:lpe,M:cpe,p:I,q:ape,Q:ppe,s:gpe,S:hpe,u:npe,U:rpe,V:ipe,w:tpe,W:spe,x:J,X:ue,y:h3,Y:c3,Z:ope,"%":mpe};v.x=_(t,v),v.X=_(r,v),v.c=_(e,v),S.x=_(t,S),S.X=_(r,S),S.c=_(e,S);function _(T,F){return function(Y){var q=[],me=-1,Z=0,Ce=T.length,Re,Ee,Me;for(Y instanceof Date||(Y=new Date(+Y));++me<Ce;)T.charCodeAt(me)===37&&(q.push(T.slice(Z,me)),(Ee=u3[Re=T.charAt(++me)])!=null?Re=T.charAt(++me):Ee=Re==="e"?" ":"0",(Me=F[Re])&&(Re=Me(Y,Ee)),q.push(Re),Z=me+1);return q.push(T.slice(Z,me)),q.join("")}}function P(T,F){return function(Y){var q=Zc(1900,void 0,1),me=x(q,T,Y+="",0),Z,Ce;if(me!=Y.length)return null;if("Q"in q)return new Date(q.Q);if("s"in q)return new Date(q.s*1e3+("L"in q?q.L:0));if(F&&!("Z"in q)&&(q.Z=0),"p"in q&&(q.H=q.H%12+q.p*12),q.m===void 0&&(q.m="q"in q?q.q:0),"V"in q){if(q.V<1||q.V>53)return null;"w"in q||(q.w=1),"Z"in q?(Z=oy(Zc(q.y,0,1)),Ce=Z.getUTCDay(),Z=Ce>4||Ce===0?dg.ceil(Z):dg(Z),Z=J1.offset(Z,(q.V-1)*7),q.y=Z.getUTCFullYear(),q.m=Z.getUTCMonth(),q.d=Z.getUTCDate()+(q.w+6)%7):(Z=sy(Zc(q.y,0,1)),Ce=Z.getDay(),Z=Ce>4||Ce===0?hg.ceil(Z):hg(Z),Z=Q1.offset(Z,(q.V-1)*7),q.y=Z.getFullYear(),q.m=Z.getMonth(),q.d=Z.getDate()+(q.w+6)%7)}else("W"in q||"U"in q)&&("w"in q||(q.w="u"in q?q.u%7:"W"in q?1:0),Ce="Z"in q?oy(Zc(q.y,0,1)).getUTCDay():sy(Zc(q.y,0,1)).getDay(),q.m=0,q.d="W"in q?(q.w+6)%7+q.W*7-(Ce+5)%7:q.w+q.U*7-(Ce+6)%7);return"Z"in q?(q.H+=q.Z/100|0,q.M+=q.Z%100,oy(q)):sy(q)}}function x(T,F,Y,q){for(var me=0,Z=F.length,Ce=Y.length,Re,Ee;me<Z;){if(q>=Ce)return-1;if(Re=F.charCodeAt(me++),Re===37){if(Re=F.charAt(me++),Ee=L[Re in u3?F.charAt(me++):Re],!Ee||(q=Ee(T,Y,q))<0)return-1}else if(Re!=Y.charCodeAt(q++))return-1}return q}function I(T,F,Y){var q=u.exec(F.slice(Y));return q?(T.p=c.get(q[0].toLowerCase()),Y+q[0].length):-1}function R(T,F,Y){var q=f.exec(F.slice(Y));return q?(T.w=m.get(q[0].toLowerCase()),Y+q[0].length):-1}function N(T,F,Y){var q=h.exec(F.slice(Y));return q?(T.w=d.get(q[0].toLowerCase()),Y+q[0].length):-1}function H(T,F,Y){var q=C.exec(F.slice(Y));return q?(T.m=b.get(q[0].toLowerCase()),Y+q[0].length):-1}function K(T,F,Y){var q=p.exec(F.slice(Y));return q?(T.m=y.get(q[0].toLowerCase()),Y+q[0].length):-1}function X(T,F,Y){return x(T,e,F,Y)}function J(T,F,Y){return x(T,t,F,Y)}function ue(T,F,Y){return x(T,r,F,Y)}function se(T){return o[T.getDay()]}function O(T){return s[T.getDay()]}function g(T){return l[T.getMonth()]}function E(T){return a[T.getMonth()]}function A(T){return i[+(T.getHours()>=12)]}function U(T){return 1+~~(T.getMonth()/3)}function G(T){return o[T.getUTCDay()]}function V(T){return s[T.getUTCDay()]}function oe(T){return l[T.getUTCMonth()]}function j(T){return a[T.getUTCMonth()]}function ye(T){return i[+(T.getUTCHours()>=12)]}function ee(T){return 1+~~(T.getUTCMonth()/3)}return{format:function(T){var F=_(T+="",v);return F.toString=function(){return T},F},parse:function(T){var F=P(T+="",!1);return F.toString=function(){return T},F},utcFormat:function(T){var F=_(T+="",S);return F.toString=function(){return T},F},utcParse:function(T){var F=P(T+="",!0);return F.toString=function(){return T},F}}}var u3={"-":"",_:" ",0:"0"},or=/^\s*\d+/,Zme=/^%/,Jme=/[\\^$*+?|[\]().{}]/g;function Ot(n,e,t){var r=n<0?"-":"",i=(r?-n:n)+"",s=i.length;return r+(s<t?new Array(t-s+1).join(e)+i:i)}function epe(n){return n.replace(Jme,"\\$&")}function Jc(n){return new RegExp("^(?:"+n.map(epe).join("|")+")","i")}function eh(n){return new Map(n.map((e,t)=>[e.toLowerCase(),t]))}function tpe(n,e,t){var r=or.exec(e.slice(t,t+1));return r?(n.w=+r[0],t+r[0].length):-1}function npe(n,e,t){var r=or.exec(e.slice(t,t+1));return r?(n.u=+r[0],t+r[0].length):-1}function rpe(n,e,t){var r=or.exec(e.slice(t,t+2));return r?(n.U=+r[0],t+r[0].length):-1}function ipe(n,e,t){var r=or.exec(e.slice(t,t+2));return r?(n.V=+r[0],t+r[0].length):-1}function spe(n,e,t){var r=or.exec(e.slice(t,t+2));return r?(n.W=+r[0],t+r[0].length):-1}function c3(n,e,t){var r=or.exec(e.slice(t,t+4));return r?(n.y=+r[0],t+r[0].length):-1}function h3(n,e,t){var r=or.exec(e.slice(t,t+2));return r?(n.y=+r[0]+(+r[0]>68?1900:2e3),t+r[0].length):-1}function ope(n,e,t){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(t,t+6));return r?(n.Z=r[1]?0:-(r[2]+(r[3]||"00")),t+r[0].length):-1}function ape(n,e,t){var r=or.exec(e.slice(t,t+1));return r?(n.q=r[0]*3-3,t+r[0].length):-1}function lpe(n,e,t){var r=or.exec(e.slice(t,t+2));return r?(n.m=r[0]-1,t+r[0].length):-1}function d3(n,e,t){var r=or.exec(e.slice(t,t+2));return r?(n.d=+r[0],t+r[0].length):-1}function upe(n,e,t){var r=or.exec(e.slice(t,t+3));return r?(n.m=0,n.d=+r[0],t+r[0].length):-1}function f3(n,e,t){var r=or.exec(e.slice(t,t+2));return r?(n.H=+r[0],t+r[0].length):-1}function cpe(n,e,t){var r=or.exec(e.slice(t,t+2));return r?(n.M=+r[0],t+r[0].length):-1}function hpe(n,e,t){var r=or.exec(e.slice(t,t+2));return r?(n.S=+r[0],t+r[0].length):-1}function dpe(n,e,t){var r=or.exec(e.slice(t,t+3));return r?(n.L=+r[0],t+r[0].length):-1}function fpe(n,e,t){var r=or.exec(e.slice(t,t+6));return r?(n.L=Math.floor(r[0]/1e3),t+r[0].length):-1}function mpe(n,e,t){var r=Zme.exec(e.slice(t,t+1));return r?t+r[0].length:-1}function ppe(n,e,t){var r=or.exec(e.slice(t));return r?(n.Q=+r[0],t+r[0].length):-1}function gpe(n,e,t){var r=or.exec(e.slice(t));return r?(n.s=+r[0],t+r[0].length):-1}function m3(n,e){return Ot(n.getDate(),e,2)}function ype(n,e){return Ot(n.getHours(),e,2)}function wpe(n,e){return Ot(n.getHours()%12||12,e,2)}function vpe(n,e){return Ot(1+Q1.count(Cl(n),n),e,3)}function XL(n,e){return Ot(n.getMilliseconds(),e,3)}function Cpe(n,e){return XL(n,e)+"000"}function Epe(n,e){return Ot(n.getMonth()+1,e,2)}function bpe(n,e){return Ot(n.getMinutes(),e,2)}function Spe(n,e){return Ot(n.getSeconds(),e,2)}function Rpe(n){var e=n.getDay();return e===0?7:e}function Tpe(n,e){return Ot(Z1.count(Cl(n)-1,n),e,2)}function QL(n){var e=n.getDay();return e>=4||e===0?ac(n):ac.ceil(n)}function Ape(n,e){return n=QL(n),Ot(ac.count(Cl(n),n)+(Cl(n).getDay()===4),e,2)}function xpe(n){return n.getDay()}function Mpe(n,e){return Ot(hg.count(Cl(n)-1,n),e,2)}function Npe(n,e){return Ot(n.getFullYear()%100,e,2)}function Ipe(n,e){return n=QL(n),Ot(n.getFullYear()%100,e,2)}function Ope(n,e){return Ot(n.getFullYear()%1e4,e,4)}function _pe(n,e){var t=n.getDay();return n=t>=4||t===0?ac(n):ac.ceil(n),Ot(n.getFullYear()%1e4,e,4)}function Lpe(n){var e=n.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ot(e/60|0,"0",2)+Ot(e%60,"0",2)}function p3(n,e){return Ot(n.getUTCDate(),e,2)}function Ppe(n,e){return Ot(n.getUTCHours(),e,2)}function Dpe(n,e){return Ot(n.getUTCHours()%12||12,e,2)}function kpe(n,e){return Ot(1+J1.count(El(n),n),e,3)}function ZL(n,e){return Ot(n.getUTCMilliseconds(),e,3)}function Fpe(n,e){return ZL(n,e)+"000"}function Hpe(n,e){return Ot(n.getUTCMonth()+1,e,2)}function Upe(n,e){return Ot(n.getUTCMinutes(),e,2)}function Bpe(n,e){return Ot(n.getUTCSeconds(),e,2)}function Vpe(n){var e=n.getUTCDay();return e===0?7:e}function $pe(n,e){return Ot(e0.count(El(n)-1,n),e,2)}function JL(n){var e=n.getUTCDay();return e>=4||e===0?lc(n):lc.ceil(n)}function Wpe(n,e){return n=JL(n),Ot(lc.count(El(n),n)+(El(n).getUTCDay()===4),e,2)}function Gpe(n){return n.getUTCDay()}function zpe(n,e){return Ot(dg.count(El(n)-1,n),e,2)}function Ype(n,e){return Ot(n.getUTCFullYear()%100,e,2)}function jpe(n,e){return n=JL(n),Ot(n.getUTCFullYear()%100,e,2)}function Kpe(n,e){return Ot(n.getUTCFullYear()%1e4,e,4)}function qpe(n,e){var t=n.getUTCDay();return n=t>=4||t===0?lc(n):lc.ceil(n),Ot(n.getUTCFullYear()%1e4,e,4)}function Xpe(){return"+0000"}function g3(){return"%"}function y3(n){return+n}function w3(n){return Math.floor(+n/1e3)}var hu,t0,eP,tP,nP;Qpe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Qpe(n){return hu=Qme(n),t0=hu.format,eP=hu.parse,tP=hu.utcFormat,nP=hu.utcParse,hu}function Zpe(n){return new Date(n)}function Jpe(n){return n instanceof Date?+n:+new Date(+n)}function tS(n,e,t,r,i,s,o,a,l,u){var c=AL(),h=c.invert,d=c.domain,f=u(".%L"),m=u(":%S"),p=u("%I:%M"),y=u("%I %p"),C=u("%a %d"),b=u("%b %d"),v=u("%B"),S=u("%Y");function L(_){return(l(_)<_?f:a(_)<_?m:o(_)<_?p:s(_)<_?y:r(_)<_?i(_)<_?C:b:t(_)<_?v:S)(_)}return c.invert=function(_){return new Date(h(_))},c.domain=function(_){return arguments.length?d(Array.from(_,Jpe)):d().map(Zpe)},c.ticks=function(_){var P=d();return n(P[0],P[P.length-1],_==null?10:_)},c.tickFormat=function(_,P){return P==null?L:u(P)},c.nice=function(_){var P=d();return(!_||typeof _.range!="function")&&(_=e(P[0],P[P.length-1],_==null?10:_)),_?d(OL(P,_)):c},c.copy=function(){return X1(c,tS(n,e,t,r,i,s,o,a,l,u))},c}function ege(){return _l.apply(tS(qme,Xme,Cl,VL,Z1,Q1,HL,kL,Ou,t0).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function tge(){return _l.apply(tS(jme,Kme,El,KL,e0,J1,zL,WL,Ou,tP).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function yt(n){for(var e=n.length/6|0,t=new Array(e),r=0;r<e;)t[r]="#"+n.slice(r*6,++r*6);return t}const rP=yt("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),iP=yt("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),sP=yt("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),oP=yt("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),aP=yt("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),lP=yt("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),uP=yt("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),cP=yt("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),nS=yt("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),jt=n=>Zfe(n[n.length-1]);var n0=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(yt);const nge=jt(n0);var r0=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(yt);const rge=jt(r0);var i0=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(yt);const ige=jt(i0);var s0=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(yt);const sge=jt(s0);var o0=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(yt);const oge=jt(o0);var a0=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(yt);const age=jt(a0);var l0=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(yt);const lge=jt(l0);var u0=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(yt);const uge=jt(u0);var c0=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(yt);const cge=jt(c0);var h0=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(yt);const hge=jt(h0);var d0=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(yt);const dge=jt(d0);var f0=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(yt);const fge=jt(f0);var m0=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(yt);const mge=jt(m0);var p0=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(yt);const pge=jt(p0);var g0=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(yt);const gge=jt(g0);var y0=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(yt);const yge=jt(y0);var w0=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(yt);const wge=jt(w0);var v0=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(yt);const vge=jt(v0);var C0=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(yt);const Cge=jt(C0);var E0=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(yt);const Ege=jt(E0);var b0=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(yt);const bge=jt(b0);var S0=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(yt);const Sge=jt(S0);var R0=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(yt);const Rge=jt(R0);var T0=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(yt);const Tge=jt(T0);var A0=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(yt);const Age=jt(A0);var x0=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(yt);const xge=jt(x0);var M0=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(yt);const Mge=jt(M0);function Nge(n){return n=Math.max(0,Math.min(1,n)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-n*(35.34-n*(2381.73-n*(6402.7-n*(7024.72-n*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+n*(170.73+n*(52.82-n*(131.46-n*(176.58-n*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+n*(442.36-n*(2482.43-n*(6167.24-n*(6614.94-n*2475.67)))))))+")"}const Ige=Yb($s(300,.5,0),$s(-240,.5,1));var Oge=Yb($s(-100,.75,.35),$s(80,1.5,.8)),_ge=Yb($s(260,.75,.35),$s(80,1.5,.8)),gm=$s();function Lge(n){(n<0||n>1)&&(n-=Math.floor(n));var e=Math.abs(n-.5);return gm.h=360*n-100,gm.s=1.5-1.5*e,gm.l=.8-.9*e,gm+""}var ym=sc(),Pge=Math.PI/3,Dge=Math.PI*2/3;function kge(n){var e;return n=(.5-n)*Math.PI,ym.r=255*(e=Math.sin(n))*e,ym.g=255*(e=Math.sin(n+Pge))*e,ym.b=255*(e=Math.sin(n+Dge))*e,ym+""}function Fge(n){return n=Math.max(0,Math.min(1,n)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+n*(1172.33-n*(10793.56-n*(33300.12-n*(38394.49-n*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+n*(557.33+n*(1225.33-n*(3574.96-n*(1073.77+n*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+n*(3211.1-n*(15327.97-n*(27814-n*(22569.18-n*6838.66)))))))+")"}function N0(n){var e=n.length;return function(t){return n[Math.max(0,Math.min(e-1,Math.floor(t*e)))]}}const Hge=N0(yt("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var Uge=N0(yt("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Bge=N0(yt("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Vge=N0(yt("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),$ge=Hk,Wge=Uk,Gge=Bk,zge=EA,Yge=Og,jge=Vk,Kge=200;function qge(n,e,t,r){var i=-1,s=Wge,o=!0,a=n.length,l=[],u=e.length;if(!a)return l;t&&(e=zge(e,Yge(t))),r?(s=Gge,o=!1):e.length>=Kge&&(s=jge,o=!1,e=new $ge(e));e:for(;++i<a;){var c=n[i],h=t==null?c:t(c);if(c=r||c!==0?c:0,o&&h===h){for(var d=u;d--;)if(e[d]===h)continue e;l.push(c)}else s(e,h,r)||l.push(c)}return l}var Xge=qge,Qge=Xge,Zge=vA,Jge=dL,e1e=Zge(function(n,e){return Jge(n)?Qge(n,e):[]}),hP=e1e,d5=Math.PI,f5=2*d5,Ua=1e-6,t1e=f5-Ua;function m5(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function rS(){return new m5}m5.prototype=rS.prototype={constructor:m5,moveTo:function(n,e){this._+="M"+(this._x0=this._x1=+n)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(n,e){this._+="L"+(this._x1=+n)+","+(this._y1=+e)},quadraticCurveTo:function(n,e,t,r){this._+="Q"+ +n+","+ +e+","+(this._x1=+t)+","+(this._y1=+r)},bezierCurveTo:function(n,e,t,r,i,s){this._+="C"+ +n+","+ +e+","+ +t+","+ +r+","+(this._x1=+i)+","+(this._y1=+s)},arcTo:function(n,e,t,r,i){n=+n,e=+e,t=+t,r=+r,i=+i;var s=this._x1,o=this._y1,a=t-n,l=r-e,u=s-n,c=o-e,h=u*u+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=n)+","+(this._y1=e);else if(h>Ua)if(!(Math.abs(c*a-l*u)>Ua)||!i)this._+="L"+(this._x1=n)+","+(this._y1=e);else{var d=t-s,f=r-o,m=a*a+l*l,p=d*d+f*f,y=Math.sqrt(m),C=Math.sqrt(h),b=i*Math.tan((d5-Math.acos((m+h-p)/(2*y*C)))/2),v=b/C,S=b/y;Math.abs(v-1)>Ua&&(this._+="L"+(n+v*u)+","+(e+v*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>u*f)+","+(this._x1=n+S*a)+","+(this._y1=e+S*l)}},arc:function(n,e,t,r,i,s){n=+n,e=+e,t=+t,s=!!s;var o=t*Math.cos(r),a=t*Math.sin(r),l=n+o,u=e+a,c=1^s,h=s?r-i:i-r;if(t<0)throw new Error("negative radius: "+t);this._x1===null?this._+="M"+l+","+u:(Math.abs(this._x1-l)>Ua||Math.abs(this._y1-u)>Ua)&&(this._+="L"+l+","+u),t&&(h<0&&(h=h%f5+f5),h>t1e?this._+="A"+t+","+t+",0,1,"+c+","+(n-o)+","+(e-a)+"A"+t+","+t+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):h>Ua&&(this._+="A"+t+","+t+",0,"+ +(h>=d5)+","+c+","+(this._x1=n+t*Math.cos(i))+","+(this._y1=e+t*Math.sin(i))))},rect:function(n,e,t,r){this._+="M"+(this._x0=this._x1=+n)+","+(this._y0=this._y1=+e)+"h"+ +t+"v"+ +r+"h"+-t+"Z"},toString:function(){return this._}};function hr(n){return function(){return n}}var v3=1e-12;function dP(n){this._context=n}dP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(n,e){switch(n=+n,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(n,e):this._context.moveTo(n,e);break;case 1:this._point=2;default:this._context.lineTo(n,e);break}}};function iS(n){return new dP(n)}function fP(n){return n[0]}function mP(n){return n[1]}function pP(){var n=fP,e=mP,t=hr(!0),r=null,i=iS,s=null;function o(a){var l,u=a.length,c,h=!1,d;for(r==null&&(s=i(d=rS())),l=0;l<=u;++l)!(l<u&&t(c=a[l],l,a))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+n(c,l,a),+e(c,l,a));if(d)return s=null,d+""||null}return o.x=function(a){return arguments.length?(n=typeof a=="function"?a:hr(+a),o):n},o.y=function(a){return arguments.length?(e=typeof a=="function"?a:hr(+a),o):e},o.defined=function(a){return arguments.length?(t=typeof a=="function"?a:hr(!!a),o):t},o.curve=function(a){return arguments.length?(i=a,r!=null&&(s=i(r)),o):i},o.context=function(a){return arguments.length?(a==null?r=s=null:s=i(r=a),o):r},o}function n1e(){var n=fP,e=null,t=hr(0),r=mP,i=hr(!0),s=null,o=iS,a=null;function l(c){var h,d,f,m=c.length,p,y=!1,C,b=new Array(m),v=new Array(m);for(s==null&&(a=o(C=rS())),h=0;h<=m;++h){if(!(h<m&&i(p=c[h],h,c))===y)if(y=!y)d=h,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),f=h-1;f>=d;--f)a.point(b[f],v[f]);a.lineEnd(),a.areaEnd()}y&&(b[h]=+n(p,h,c),v[h]=+t(p,h,c),a.point(e?+e(p,h,c):b[h],r?+r(p,h,c):v[h]))}if(C)return a=null,C+""||null}function u(){return pP().defined(i).curve(o).context(s)}return l.x=function(c){return arguments.length?(n=typeof c=="function"?c:hr(+c),e=null,l):n},l.x0=function(c){return arguments.length?(n=typeof c=="function"?c:hr(+c),l):n},l.x1=function(c){return arguments.length?(e=c==null?null:typeof c=="function"?c:hr(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:hr(+c),r=null,l):t},l.y0=function(c){return arguments.length?(t=typeof c=="function"?c:hr(+c),l):t},l.y1=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:hr(+c),l):r},l.lineX0=l.lineY0=function(){return u().x(n).y(t)},l.lineY1=function(){return u().x(n).y(r)},l.lineX1=function(){return u().x(e).y(t)},l.defined=function(c){return arguments.length?(i=typeof c=="function"?c:hr(!!c),l):i},l.curve=function(c){return arguments.length?(o=c,s!=null&&(a=o(s)),l):o},l.context=function(c){return arguments.length?(c==null?s=a=null:a=o(s=c),l):s},l}var C3=Array.prototype.slice;function la(){}function fg(n,e,t){n._context.bezierCurveTo((2*n._x0+n._x1)/3,(2*n._y0+n._y1)/3,(n._x0+2*n._x1)/3,(n._y0+2*n._y1)/3,(n._x0+4*n._x1+e)/6,(n._y0+4*n._y1+t)/6)}function I0(n){this._context=n}I0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:fg(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(n,e){switch(n=+n,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(n,e):this._context.moveTo(n,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:fg(this,n,e);break}this._x0=this._x1,this._x1=n,this._y0=this._y1,this._y1=e}};function r1e(n){return new I0(n)}function gP(n){this._context=n}gP.prototype={areaStart:la,areaEnd:la,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(n,e){switch(n=+n,e=+e,this._point){case 0:this._point=1,this._x2=n,this._y2=e;break;case 1:this._point=2,this._x3=n,this._y3=e;break;case 2:this._point=3,this._x4=n,this._y4=e,this._context.moveTo((this._x0+4*this._x1+n)/6,(this._y0+4*this._y1+e)/6);break;default:fg(this,n,e);break}this._x0=this._x1,this._x1=n,this._y0=this._y1,this._y1=e}};function i1e(n){return new gP(n)}function yP(n){this._context=n}yP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(n,e){switch(n=+n,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var t=(this._x0+4*this._x1+n)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break;case 3:this._point=4;default:fg(this,n,e);break}this._x0=this._x1,this._x1=n,this._y0=this._y1,this._y1=e}};function s1e(n){return new yP(n)}function wP(n,e){this._basis=new I0(n),this._beta=e}wP.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var n=this._x,e=this._y,t=n.length-1;if(t>0)for(var r=n[0],i=e[0],s=n[t]-r,o=e[t]-i,a=-1,l;++a<=t;)l=a/t,this._basis.point(this._beta*n[a]+(1-this._beta)*(r+l*s),this._beta*e[a]+(1-this._beta)*(i+l*o));this._x=this._y=null,this._basis.lineEnd()},point:function(n,e){this._x.push(+n),this._y.push(+e)}};const o1e=function n(e){function t(r){return e===1?new I0(r):new wP(r,e)}return t.beta=function(r){return n(+r)},t}(.85);function mg(n,e,t){n._context.bezierCurveTo(n._x1+n._k*(n._x2-n._x0),n._y1+n._k*(n._y2-n._y0),n._x2+n._k*(n._x1-e),n._y2+n._k*(n._y1-t),n._x2,n._y2)}function sS(n,e){this._context=n,this._k=(1-e)/6}sS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:mg(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(n,e){switch(n=+n,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(n,e):this._context.moveTo(n,e);break;case 1:this._point=2,this._x1=n,this._y1=e;break;case 2:this._point=3;default:mg(this,n,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=n,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const a1e=function n(e){function t(r){return new sS(r,e)}return t.tension=function(r){return n(+r)},t}(0);function oS(n,e){this._context=n,this._k=(1-e)/6}oS.prototype={areaStart:la,areaEnd:la,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(n,e){switch(n=+n,e=+e,this._point){case 0:this._point=1,this._x3=n,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=n,this._y4=e);break;case 2:this._point=3,this._x5=n,this._y5=e;break;default:mg(this,n,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=n,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const l1e=function n(e){function t(r){return new oS(r,e)}return t.tension=function(r){return n(+r)},t}(0);function aS(n,e){this._context=n,this._k=(1-e)/6}aS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(n,e){switch(n=+n,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:mg(this,n,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=n,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const u1e=function n(e){function t(r){return new aS(r,e)}return t.tension=function(r){return n(+r)},t}(0);function lS(n,e,t){var r=n._x1,i=n._y1,s=n._x2,o=n._y2;if(n._l01_a>v3){var a=2*n._l01_2a+3*n._l01_a*n._l12_a+n._l12_2a,l=3*n._l01_a*(n._l01_a+n._l12_a);r=(r*a-n._x0*n._l12_2a+n._x2*n._l01_2a)/l,i=(i*a-n._y0*n._l12_2a+n._y2*n._l01_2a)/l}if(n._l23_a>v3){var u=2*n._l23_2a+3*n._l23_a*n._l12_a+n._l12_2a,c=3*n._l23_a*(n._l23_a+n._l12_a);s=(s*u+n._x1*n._l23_2a-e*n._l12_2a)/c,o=(o*u+n._y1*n._l23_2a-t*n._l12_2a)/c}n._context.bezierCurveTo(r,i,s,o,n._x2,n._y2)}function vP(n,e){this._context=n,this._alpha=e}vP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(n,e){if(n=+n,e=+e,this._point){var t=this._x2-n,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(t*t+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(n,e):this._context.moveTo(n,e);break;case 1:this._point=2;break;case 2:this._point=3;default:lS(this,n,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=n,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const c1e=function n(e){function t(r){return e?new vP(r,e):new sS(r,0)}return t.alpha=function(r){return n(+r)},t}(.5);function CP(n,e){this._context=n,this._alpha=e}CP.prototype={areaStart:la,areaEnd:la,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(n,e){if(n=+n,e=+e,this._point){var t=this._x2-n,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(t*t+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=n,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=n,this._y4=e);break;case 2:this._point=3,this._x5=n,this._y5=e;break;default:lS(this,n,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=n,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const h1e=function n(e){function t(r){return e?new CP(r,e):new oS(r,0)}return t.alpha=function(r){return n(+r)},t}(.5);function EP(n,e){this._context=n,this._alpha=e}EP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(n,e){if(n=+n,e=+e,this._point){var t=this._x2-n,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(t*t+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:lS(this,n,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=n,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const d1e=function n(e){function t(r){return e?new EP(r,e):new aS(r,0)}return t.alpha=function(r){return n(+r)},t}(.5);function bP(n){this._context=n}bP.prototype={areaStart:la,areaEnd:la,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(n,e){n=+n,e=+e,this._point?this._context.lineTo(n,e):(this._point=1,this._context.moveTo(n,e))}};function f1e(n){return new bP(n)}function E3(n){return n<0?-1:1}function b3(n,e,t){var r=n._x1-n._x0,i=e-n._x1,s=(n._y1-n._y0)/(r||i<0&&-0),o=(t-n._y1)/(i||r<0&&-0),a=(s*i+o*r)/(r+i);return(E3(s)+E3(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function S3(n,e){var t=n._x1-n._x0;return t?(3*(n._y1-n._y0)/t-e)/2:e}function ay(n,e,t){var r=n._x0,i=n._y0,s=n._x1,o=n._y1,a=(s-r)/3;n._context.bezierCurveTo(r+a,i+a*e,s-a,o-a*t,s,o)}function pg(n){this._context=n}pg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ay(this,this._t0,S3(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(n,e){var t=NaN;if(n=+n,e=+e,!(n===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(n,e):this._context.moveTo(n,e);break;case 1:this._point=2;break;case 2:this._point=3,ay(this,S3(this,t=b3(this,n,e)),t);break;default:ay(this,this._t0,t=b3(this,n,e));break}this._x0=this._x1,this._x1=n,this._y0=this._y1,this._y1=e,this._t0=t}}};function SP(n){this._context=new RP(n)}(SP.prototype=Object.create(pg.prototype)).point=function(n,e){pg.prototype.point.call(this,e,n)};function RP(n){this._context=n}RP.prototype={moveTo:function(n,e){this._context.moveTo(e,n)},closePath:function(){this._context.closePath()},lineTo:function(n,e){this._context.lineTo(e,n)},bezierCurveTo:function(n,e,t,r,i,s){this._context.bezierCurveTo(e,n,r,t,s,i)}};function m1e(n){return new pg(n)}function p1e(n){return new SP(n)}function TP(n){this._context=n}TP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var n=this._x,e=this._y,t=n.length;if(t)if(this._line?this._context.lineTo(n[0],e[0]):this._context.moveTo(n[0],e[0]),t===2)this._context.lineTo(n[1],e[1]);else for(var r=R3(n),i=R3(e),s=0,o=1;o<t;++s,++o)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],n[o],e[o]);(this._line||this._line!==0&&t===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(n,e){this._x.push(+n),this._y.push(+e)}};function R3(n){var e,t=n.length-1,r,i=new Array(t),s=new Array(t),o=new Array(t);for(i[0]=0,s[0]=2,o[0]=n[0]+2*n[1],e=1;e<t-1;++e)i[e]=1,s[e]=4,o[e]=4*n[e]+2*n[e+1];for(i[t-1]=2,s[t-1]=7,o[t-1]=8*n[t-1]+n[t],e=1;e<t;++e)r=i[e]/s[e-1],s[e]-=r,o[e]-=r*o[e-1];for(i[t-1]=o[t-1]/s[t-1],e=t-2;e>=0;--e)i[e]=(o[e]-i[e+1])/s[e];for(s[t-1]=(n[t]+i[t-1])/2,e=0;e<t-1;++e)s[e]=2*n[e+1]-i[e+1];return[i,s]}function g1e(n){return new TP(n)}function O0(n,e){this._context=n,this._t=e}O0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(n,e){switch(n=+n,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(n,e):this._context.moveTo(n,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(n,e);else{var t=this._x*(1-this._t)+n*this._t;this._context.lineTo(t,this._y),this._context.lineTo(t,e)}break}}this._x=n,this._y=e}};function y1e(n){return new O0(n,.5)}function w1e(n){return new O0(n,0)}function v1e(n){return new O0(n,1)}function uc(n,e){if((o=n.length)>1)for(var t=1,r,i,s=n[e[0]],o,a=s.length;t<o;++t)for(i=s,s=n[e[t]],r=0;r<a;++r)s[r][1]+=s[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}function cc(n){for(var e=n.length,t=new Array(e);--e>=0;)t[e]=e;return t}function C1e(n,e){return n[e]}function E1e(){var n=hr([]),e=cc,t=uc,r=C1e;function i(s){var o=n.apply(this,arguments),a,l=s.length,u=o.length,c=new Array(u),h;for(a=0;a<u;++a){for(var d=o[a],f=c[a]=new Array(l),m=0,p;m<l;++m)f[m]=p=[0,+r(s[m],d,m,s)],p.data=s[m];f.key=d}for(a=0,h=e(c);a<u;++a)c[h[a]].index=a;return t(c,h),c}return i.keys=function(s){return arguments.length?(n=typeof s=="function"?s:hr(C3.call(s)),i):n},i.value=function(s){return arguments.length?(r=typeof s=="function"?s:hr(+s),i):r},i.order=function(s){return arguments.length?(e=s==null?cc:typeof s=="function"?s:hr(C3.call(s)),i):e},i.offset=function(s){return arguments.length?(t=s==null?uc:s,i):t},i}function b1e(n,e){if((r=n.length)>0){for(var t,r,i=0,s=n[0].length,o;i<s;++i){for(o=t=0;t<r;++t)o+=n[t][i][1]||0;if(o)for(t=0;t<r;++t)n[t][i][1]/=o}uc(n,e)}}function AP(n,e){if((l=n.length)>0)for(var t,r=0,i,s,o,a,l,u=n[e[0]].length;r<u;++r)for(o=a=0,t=0;t<l;++t)(s=(i=n[e[t]][r])[1]-i[0])>0?(i[0]=o,i[1]=o+=s):s<0?(i[1]=a,i[0]=a+=s):(i[0]=0,i[1]=s)}function S1e(n,e){if((i=n.length)>0){for(var t=0,r=n[e[0]],i,s=r.length;t<s;++t){for(var o=0,a=0;o<i;++o)a+=n[o][t][1]||0;r[t][1]+=r[t][0]=-a/2}uc(n,e)}}function R1e(n,e){if(!(!((o=n.length)>0)||!((s=(i=n[e[0]]).length)>0))){for(var t=0,r=1,i,s,o;r<s;++r){for(var a=0,l=0,u=0;a<o;++a){for(var c=n[e[a]],h=c[r][1]||0,d=c[r-1][1]||0,f=(h-d)/2,m=0;m<a;++m){var p=n[e[m]],y=p[r][1]||0,C=p[r-1][1]||0;f+=y-C}l+=h,u+=f*h}i[r-1][1]+=i[r-1][0]=t,l&&(t-=u/l)}i[r-1][1]+=i[r-1][0]=t,uc(n,e)}}function T1e(n){var e=n.map(A1e);return cc(n).sort(function(t,r){return e[t]-e[r]})}function A1e(n){for(var e=-1,t=0,r=n.length,i,s=-1/0;++e<r;)(i=+n[e][1])>s&&(s=i,t=e);return t}function xP(n){var e=n.map(MP);return cc(n).sort(function(t,r){return e[t]-e[r]})}function MP(n){for(var e=0,t=-1,r=n.length,i;++t<r;)(i=+n[t][1])&&(e+=i);return e}function x1e(n){return xP(n).reverse()}function M1e(n){var e=n.length,t,r,i=n.map(MP),s=T1e(n),o=0,a=0,l=[],u=[];for(t=0;t<e;++t)r=s[t],o<a?(o+=i[r],l.push(r)):(a+=i[r],u.push(r));return u.reverse().concat(l)}function N1e(n){return cc(n).reverse()}function I1e(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function gg(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,r=n.slice(0,t);return[r.length>1?r[0]+r.slice(2):r,+n.slice(t+1)]}function O1e(n){return n=gg(Math.abs(n)),n?n[1]:NaN}function _1e(n,e){return function(t,r){for(var i=t.length,s=[],o=0,a=n[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),s.push(t.substring(i-=a,i+a)),!((l+=a+1)>r));)a=n[o=(o+1)%n.length];return s.reverse().join(e)}}function L1e(n){return function(e){return e.replace(/[0-9]/g,function(t){return n[+t]})}}var P1e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function p5(n){if(!(e=P1e.exec(n)))throw new Error("invalid format: "+n);var e;return new uS({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}p5.prototype=uS.prototype;function uS(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}uS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function D1e(n){e:for(var e=n.length,t=1,r=-1,i;t<e;++t)switch(n[t]){case".":r=i=t;break;case"0":r===0&&(r=t),i=t;break;default:if(!+n[t])break e;r>0&&(r=0);break}return r>0?n.slice(0,r)+n.slice(i+1):n}var NP;function k1e(n,e){var t=gg(n,e);if(!t)return n+"";var r=t[0],i=t[1],s=i-(NP=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+gg(n,Math.max(0,e+s-1))[0]}function T3(n,e){var t=gg(n,e);if(!t)return n+"";var r=t[0],i=t[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const A3={"%":function(n,e){return(n*100).toFixed(e)},b:function(n){return Math.round(n).toString(2)},c:function(n){return n+""},d:I1e,e:function(n,e){return n.toExponential(e)},f:function(n,e){return n.toFixed(e)},g:function(n,e){return n.toPrecision(e)},o:function(n){return Math.round(n).toString(8)},p:function(n,e){return T3(n*100,e)},r:T3,s:k1e,X:function(n){return Math.round(n).toString(16).toUpperCase()},x:function(n){return Math.round(n).toString(16)}};function x3(n){return n}var M3=Array.prototype.map,N3=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function F1e(n){var e=n.grouping===void 0||n.thousands===void 0?x3:_1e(M3.call(n.grouping,Number),n.thousands+""),t=n.currency===void 0?"":n.currency[0]+"",r=n.currency===void 0?"":n.currency[1]+"",i=n.decimal===void 0?".":n.decimal+"",s=n.numerals===void 0?x3:L1e(M3.call(n.numerals,String)),o=n.percent===void 0?"%":n.percent+"",a=n.minus===void 0?"-":n.minus+"",l=n.nan===void 0?"NaN":n.nan+"";function u(h){h=p5(h);var d=h.fill,f=h.align,m=h.sign,p=h.symbol,y=h.zero,C=h.width,b=h.comma,v=h.precision,S=h.trim,L=h.type;L==="n"?(b=!0,L="g"):A3[L]||(v===void 0&&(v=12),S=!0,L="g"),(y||d==="0"&&f==="=")&&(y=!0,d="0",f="=");var _=p==="$"?t:p==="#"&&/[boxX]/.test(L)?"0"+L.toLowerCase():"",P=p==="$"?r:/[%p]/.test(L)?o:"",x=A3[L],I=/[defgprs%]/.test(L);v=v===void 0?6:/[gprs]/.test(L)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function R(N){var H=_,K=P,X,J,ue;if(L==="c")K=x(N)+K,N="";else{N=+N;var se=N<0||1/N<0;if(N=isNaN(N)?l:x(Math.abs(N),v),S&&(N=D1e(N)),se&&+N==0&&m!=="+"&&(se=!1),H=(se?m==="("?m:a:m==="-"||m==="("?"":m)+H,K=(L==="s"?N3[8+NP/3]:"")+K+(se&&m==="("?")":""),I){for(X=-1,J=N.length;++X<J;)if(ue=N.charCodeAt(X),48>ue||ue>57){K=(ue===46?i+N.slice(X+1):N.slice(X))+K,N=N.slice(0,X);break}}}b&&!y&&(N=e(N,1/0));var O=H.length+N.length+K.length,g=O<C?new Array(C-O+1).join(d):"";switch(b&&y&&(N=e(g+N,g.length?C-K.length:1/0),g=""),f){case"<":N=H+N+K+g;break;case"=":N=H+g+N+K;break;case"^":N=g.slice(0,O=g.length>>1)+H+N+K+g.slice(O);break;default:N=g+H+N+K;break}return s(N)}return R.toString=function(){return h+""},R}function c(h,d){var f=u((h=p5(h),h.type="f",h)),m=Math.max(-8,Math.min(8,Math.floor(O1e(d)/3)))*3,p=Math.pow(10,-m),y=N3[8+m/3];return function(C){return f(p*C)+y}}return{format:u,formatPrefix:c}}var wm,_0;H1e({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function H1e(n){return wm=F1e(n),_0=wm.format,wm.formatPrefix,wm}var U1e=bA,B1e=gL,V1e=Ig;function $1e(n,e,t){for(var r=-1,i=e.length,s={};++r<i;){var o=e[r],a=U1e(n,o);t(a,o)&&B1e(s,V1e(o,n),a)}return s}var W1e=$1e,G1e=W1e,z1e=$k;function Y1e(n,e){return G1e(n,e,function(t,r){return z1e(n,r)})}var j1e=Y1e,K1e=Wk;function q1e(n){var e=n==null?0:n.length;return e?K1e(n,1):[]}var X1e=q1e,Q1e=X1e,Z1e=Gk,J1e=zk;function e0e(n){return J1e(Z1e(n,void 0,Q1e),n+"")}var IP=e0e,t0e=j1e,n0e=IP,r0e=n0e(function(n,e){return n==null?{}:t0e(n,e)}),i0e=r0e;function Yn(){return Yn=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Yn.apply(this,arguments)}function g5(n,e){return g5=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t},g5(n,e)}function cS(n,e){if(n==null)return{};var t,r,i={},s=Object.keys(n);for(r=0;r<s.length;r++)t=s[r],e.indexOf(t)>=0||(i[t]=n[t]);return i}var ua={fill:M.exports.string,fontSize:M.exports.number,fontFamily:M.exports.string},s0e=M.exports.shape({domain:M.exports.shape({line:M.exports.shape({stroke:M.exports.string.isRequired,strokeWidth:M.exports.number.isRequired,strokeDasharray:M.exports.string}).isRequired}).isRequired,ticks:M.exports.shape({line:M.exports.shape({stroke:M.exports.string.isRequired,strokeWidth:M.exports.number.isRequired,strokeDasharray:M.exports.string}).isRequired,text:M.exports.shape(Yn({},ua)).isRequired}).isRequired,legend:M.exports.shape({text:M.exports.shape(Yn({},ua)).isRequired}).isRequired}),o0e=M.exports.shape({line:M.exports.shape({stroke:M.exports.string.isRequired,strokeWidth:M.exports.number.isRequired,strokeDasharray:M.exports.string}).isRequired}),a0e=M.exports.shape({hidden:M.exports.shape({symbol:M.exports.shape({fill:M.exports.string.isRequired,opacity:M.exports.number}).isRequired,text:M.exports.shape(Yn({},ua,{opacity:M.exports.number})).isRequired}).isRequired,text:M.exports.shape(Yn({},ua)).isRequired}),l0e=M.exports.shape({text:M.exports.shape(Yn({},ua)).isRequired}),u0e=M.exports.shape({text:M.exports.shape(Yn({},ua)).isRequired}),c0e=M.exports.shape({text:M.exports.shape(Yn({},ua)).isRequired}),h0e=M.exports.shape({line:M.exports.shape({stroke:M.exports.string.isRequired,strokeWidth:M.exports.number.isRequired,strokeDasharray:M.exports.string}).isRequired}),d0e=M.exports.shape({text:M.exports.shape(Yn({},ua,{outlineWidth:M.exports.number.isRequired,outlineColor:M.exports.string.isRequired})).isRequired,link:M.exports.shape({stroke:M.exports.string.isRequired,strokeWidth:M.exports.number.isRequired,outlineWidth:M.exports.number.isRequired,outlineColor:M.exports.string.isRequired}).isRequired,outline:M.exports.shape({stroke:M.exports.string.isRequired,strokeWidth:M.exports.number.isRequired,outlineWidth:M.exports.number.isRequired,outlineColor:M.exports.string.isRequired}).isRequired,symbol:M.exports.shape({fill:M.exports.string.isRequired,outlineWidth:M.exports.number.isRequired,outlineColor:M.exports.string.isRequired}).isRequired});M.exports.shape({background:M.exports.string.isRequired,fontFamily:M.exports.string.isRequired,fontSize:M.exports.number.isRequired,textColor:M.exports.string.isRequired,axis:s0e.isRequired,grid:o0e.isRequired,legends:a0e.isRequired,labels:l0e.isRequired,dots:u0e.isRequired,markers:c0e,crosshair:h0e.isRequired,annotations:d0e.isRequired});var f0e={background:"transparent",fontFamily:"sans-serif",fontSize:11,textColor:"#333333",axis:{domain:{line:{stroke:"transparent",strokeWidth:1}},ticks:{line:{stroke:"#777777",strokeWidth:1},text:{}},legend:{text:{fontSize:12}}},grid:{line:{stroke:"#dddddd",strokeWidth:1}},legends:{hidden:{symbol:{fill:"#333333",opacity:.6},text:{fill:"#333333",opacity:.6}},text:{},ticks:{line:{stroke:"#777777",strokeWidth:1},text:{fontSize:10}},title:{text:{}}},labels:{text:{}},markers:{lineColor:"#000000",lineStrokeWidth:1,text:{}},dots:{text:{}},tooltip:{container:{background:"white",color:"inherit",fontSize:"inherit",borderRadius:"2px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.25)",padding:"5px 9px"},basic:{whiteSpace:"pre",display:"flex",alignItems:"center"},chip:{marginRight:7},table:{},tableCell:{padding:"3px 5px"},tableCellValue:{fontWeight:"bold"}},crosshair:{line:{stroke:"#000000",strokeWidth:1,strokeOpacity:.75,strokeDasharray:"6 6"}},annotations:{text:{fontSize:13,outlineWidth:2,outlineColor:"#ffffff",outlineOpacity:1},link:{stroke:"#000000",strokeWidth:1,outlineWidth:2,outlineColor:"#ffffff",outlineOpacity:1},outline:{fill:"none",stroke:"#000000",strokeWidth:2,outlineWidth:2,outlineColor:"#ffffff",outlineOpacity:1},symbol:{fill:"#000000",outlineWidth:2,outlineColor:"#ffffff",outlineOpacity:1}}},m0e=["axis.ticks.text","axis.legend.text","legends.title.text","legends.text","legends.ticks.text","legends.title.text","labels.text","dots.text","markers.text","annotations.text"],p0e=function(n,e){var t=Afe({},n,e);return m0e.forEach(function(r){Ni(t,r+".fontFamily")===void 0&&Xa(t,r+".fontFamily",t.fontFamily),Ni(t,r+".fontSize")===void 0&&Xa(t,r+".fontSize",t.fontSize),Ni(t,r+".fill")===void 0&&Xa(t,r+".fill",t.textColor)}),t},OP=ie.exports.createContext(),hS=function(n){var e=n.children,t=n.animate,r=n.stiffness,i=n.damping,s=n.config,o=ie.exports.useMemo(function(){var a=Yk(s)?Pb[s]:s;return{animate:t,springConfig:{stiffness:r,damping:i},config:a}},[t,r,i,s]);return ce.jsx(OP.Provider,{value:o,children:e})},dh={animate:M.exports.bool,motionStiffness:M.exports.number,motionDamping:M.exports.number,motionConfig:M.exports.oneOfType([M.exports.oneOf(Object.keys(Pb)),M.exports.shape({mass:M.exports.number,tension:M.exports.number,friction:M.exports.number,clamp:M.exports.bool,precision:M.exports.number,velocity:M.exports.number,duration:M.exports.number,easing:M.exports.func})])};hS.propTypes={children:M.exports.node.isRequired,animate:dh.animate,stiffness:dh.motionStiffness,damping:dh.motionDamping,config:dh.motionConfig};var g0e={animate:!0,stiffness:90,damping:15,config:"default"};hS.defaultProps=g0e;var Bi=function(){return ie.exports.useContext(OP)},dS=function(n){var e=Bi(),t=e.animate,r=e.config,i=function(a){var l=ie.exports.useRef();return ie.exports.useEffect(function(){l.current=a},[a]),l.current}(n),s=ie.exports.useMemo(function(){return EL(i,n)},[i,n]),o=Ks({from:{value:0},to:{value:1},reset:!0,config:r,immediate:!t}).value;return t5(o,s)},y0e={nivo:["#d76445","#f47560","#e8c1a0","#97e3d5","#61cdbb","#00b0a7"],BrBG:je(n0),PRGn:je(r0),PiYG:je(i0),PuOr:je(s0),RdBu:je(o0),RdGy:je(a0),RdYlBu:je(l0),RdYlGn:je(u0),spectral:je(c0),blues:je(S0),greens:je(R0),greys:je(T0),oranges:je(M0),purples:je(A0),reds:je(x0),BuGn:je(h0),BuPu:je(d0),GnBu:je(f0),OrRd:je(m0),PuBuGn:je(p0),PuBu:je(g0),PuRd:je(y0),RdPu:je(w0),YlGnBu:je(v0),YlGn:je(C0),YlOrBr:je(E0),YlOrRd:je(b0)},w0e=Object.keys(y0e);je(n0),je(r0),je(i0),je(s0),je(o0),je(a0),je(l0),je(u0),je(c0),je(S0),je(R0),je(T0),je(M0),je(A0),je(x0),je(h0),je(d0),je(f0),je(m0),je(p0),je(g0),je(y0),je(w0),je(v0),je(C0),je(E0),je(b0);M.exports.oneOfType([M.exports.oneOf(w0e),M.exports.func,M.exports.arrayOf(M.exports.string)]);var y5={basis:r1e,basisClosed:i1e,basisOpen:s1e,bundle:o1e,cardinal:a1e,cardinalClosed:l1e,cardinalOpen:u1e,catmullRom:c1e,catmullRomClosed:h1e,catmullRomOpen:d1e,linear:iS,linearClosed:f1e,monotoneX:m1e,monotoneY:p1e,natural:g1e,step:y1e,stepAfter:v1e,stepBefore:w1e},L0=Object.keys(y5);M.exports.oneOf(L0);L0.filter(function(n){return n.endsWith("Closed")});hP(L0,"bundle","basisClosed","basisOpen","cardinalClosed","cardinalOpen","catmullRomClosed","catmullRomOpen","linearClosed");var v0e=hP(L0,"bundle","basisClosed","basisOpen","cardinalClosed","cardinalOpen","catmullRomClosed","catmullRomOpen","linearClosed"),C0e=M.exports.oneOf(v0e),_P=function(n){if(!y5[n])throw new TypeError("'"+n+"', is not a valid curve interpolator identifier.");return y5[n]},E0e={defs:M.exports.arrayOf(M.exports.shape({id:M.exports.string.isRequired})).isRequired,fill:M.exports.arrayOf(M.exports.shape({id:M.exports.string.isRequired,match:M.exports.oneOfType([M.exports.oneOf(["*"]),M.exports.object,M.exports.func]).isRequired})).isRequired},b0e={ascending:xP,descending:x1e,insideOut:M1e,none:cc,reverse:N1e},S0e=Object.keys(b0e);M.exports.oneOf(S0e);var R0e={expand:b1e,diverging:AP,none:uc,silhouette:S1e,wiggle:R1e},T0e=Object.keys(R0e);M.exports.oneOf(T0e);M.exports.shape({top:M.exports.number,right:M.exports.number,bottom:M.exports.number,left:M.exports.number}).isRequired;var A0e=["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],fS=M.exports.oneOf(A0e);Qa(nS);var x0e={top:0,right:0,bottom:0,left:0},P0=function(n,e,t){return t===void 0&&(t={}),ie.exports.useMemo(function(){var r=Yn({},x0e,t);return{margin:r,innerWidth:n-r.left-r.right,innerHeight:e-r.top-r.bottom,outerWidth:n,outerHeight:e}},[n,e,t.top,t.right,t.bottom,t.left])},LP=function(){var n=ie.exports.useRef(null),e=ie.exports.useState({left:0,top:0,width:0,height:0}),t=e[0],r=e[1],i=ie.exports.useState(function(){return typeof window<"u"?new ResizeObserver(function(s){var o=s[0];return r(o.contentRect)}):null})[0];return ie.exports.useEffect(function(){return n.current&&i!==null&&i.observe(n.current),function(){i!==null&&i.disconnect()}},[]),[n,t]},M0e=function(n){return ie.exports.useMemo(function(){return p0e(f0e,n)},[n])},N0e=function(n){return typeof n=="function"?n:typeof n=="string"?n.indexOf("time:")===0?t0(n.slice("5")):_0(n):function(e){return""+e}},yg=function(n){return ie.exports.useMemo(function(){return N0e(n)},[n])},PP=ie.exports.createContext(),I0e={},DP=function(n){var e=n.theme,t=e===void 0?I0e:e,r=n.children,i=M0e(t);return ce.jsx(PP.Provider,{value:i,children:r})};DP.propTypes={children:M.exports.node.isRequired,theme:M.exports.object};var rn=function(){return ie.exports.useContext(PP)},kP=function(n){var e=n.children,t=n.condition,r=n.wrapper;return t?ie.exports.cloneElement(r,{},e):e};kP.propTypes={children:M.exports.node.isRequired,condition:M.exports.bool.isRequired,wrapper:M.exports.element.isRequired};var O0e={position:"relative"},D0=function(n){var e=n.children,t=n.theme,r=n.renderWrapper,i=r===void 0||r,s=n.isInteractive,o=s===void 0||s,a=n.animate,l=n.motionStiffness,u=n.motionDamping,c=n.motionConfig,h=ie.exports.useRef(null);return ce.jsx(DP,{theme:t,children:ce.jsx(hS,{animate:a,stiffness:l,damping:u,config:c,children:ce.jsx(Qhe,{container:h,children:ce.jsxs(kP,{condition:i,wrapper:ce.jsx("div",{style:O0e,ref:h}),children:[e,o&&ce.jsx(Xhe,{})]})})})})};D0.propTypes={children:M.exports.element.isRequired,isInteractive:M.exports.bool,renderWrapper:M.exports.bool,theme:M.exports.object,animate:M.exports.bool,motionStiffness:M.exports.number,motionDamping:M.exports.number,motionConfig:M.exports.string};M.exports.func.isRequired,M.exports.bool,M.exports.bool,M.exports.object.isRequired,M.exports.bool.isRequired,M.exports.number,M.exports.number,M.exports.string;var rf=function(n){var e=n.children,t=LP(),r=t[0],i=t[1],s=i.width>0&&i.height>0;return ce.jsx("div",{ref:r,style:{width:"100%",height:"100%"},children:s&&e({width:i.width,height:i.height})})};rf.propTypes={children:M.exports.func.isRequired};var _0e=["id","colors"],FP=function(n){var e=n.id,t=n.colors,r=cS(n,_0e);return ce.jsx("linearGradient",Yn({id:e,x1:0,x2:0,y1:0,y2:1},r,{children:t.map(function(i){var s=i.offset,o=i.color,a=i.opacity;return ce.jsx("stop",{offset:s+"%",stopColor:o,stopOpacity:a!==void 0?a:1},s)})}))};FP.propTypes={id:M.exports.string.isRequired,colors:M.exports.arrayOf(M.exports.shape({offset:M.exports.number.isRequired,color:M.exports.string.isRequired,opacity:M.exports.number})).isRequired,gradientTransform:M.exports.string};var HP={linearGradient:FP},Qm=ie.exports.memo(function(n){var e=n.id,t=n.background,r=n.color,i=n.size,s=n.padding,o=n.stagger,a=i+s,l=i/2,u=s/2;return o===!0&&(a=2*i+2*s),ce.jsxs("pattern",{id:e,width:a,height:a,patternUnits:"userSpaceOnUse",children:[ce.jsx("rect",{width:a,height:a,fill:t}),ce.jsx("circle",{cx:u+l,cy:u+l,r:l,fill:r}),o&&ce.jsx("circle",{cx:1.5*s+i+l,cy:1.5*s+i+l,r:l,fill:r})]})});Qm.displayName="PatternDots",Qm.propTypes={id:M.exports.string.isRequired,color:M.exports.string.isRequired,background:M.exports.string.isRequired,size:M.exports.number.isRequired,padding:M.exports.number.isRequired,stagger:M.exports.bool.isRequired},Qm.defaultProps={color:"#000000",background:"#ffffff",size:4,padding:4,stagger:!1};var Rd=function(n){return n*Math.PI/180},L0e=function(n){return 180*n/Math.PI},P0e=function(n,e){return{x:Math.cos(n)*e,y:Math.sin(n)*e}},D0e=function(n){var e=n%360;return e<0&&(e+=360),e},k0e={svg:{align:{left:"start",center:"middle",right:"end",start:"start",middle:"middle",end:"end"},baseline:{top:"text-before-edge",center:"central",bottom:"alphabetic"}},canvas:{align:{left:"left",center:"center",right:"right",start:"left",middle:"center",end:"right"},baseline:{top:"top",center:"middle",bottom:"bottom"}}},Zm=ie.exports.memo(function(n){var e=n.id,t=n.spacing,r=n.rotation,i=n.background,s=n.color,o=n.lineWidth,a=Math.round(r)%360,l=Math.abs(t);a>180?a-=360:a>90?a-=180:a<-180?a+=360:a<-90&&(a+=180);var u,c=l,h=l;return a===0?u=`
                M 0 0 L `+c+` 0
                M 0 `+h+" L "+c+" "+h+`
            `:a===90?u=`
                M 0 0 L 0 `+h+`
                M `+c+" 0 L "+c+" "+h+`
            `:(c=Math.abs(l/Math.sin(Rd(a))),h=l/Math.sin(Rd(90-a)),u=a>0?`
                    M 0 `+-h+" L "+2*c+" "+h+`
                    M `+-c+" "+-h+" L "+c+" "+h+`
                    M `+-c+" 0 L "+c+" "+2*h+`
                `:`
                    M `+-c+" "+h+" L "+c+" "+-h+`
                    M `+-c+" "+2*h+" L "+2*c+" "+-h+`
                    M 0 `+2*h+" L "+2*c+` 0
                `),ce.jsxs("pattern",{id:e,width:c,height:h,patternUnits:"userSpaceOnUse",children:[ce.jsx("rect",{width:c,height:h,fill:i,stroke:"rgba(255, 0, 0, 0.1)",strokeWidth:0}),ce.jsx("path",{d:u,strokeWidth:o,stroke:s,strokeLinecap:"square"})]})});Zm.displayName="PatternLines",Zm.propTypes={id:M.exports.string.isRequired,spacing:M.exports.number.isRequired,rotation:M.exports.number.isRequired,background:M.exports.string.isRequired,color:M.exports.string.isRequired,lineWidth:M.exports.number.isRequired},Zm.defaultProps={spacing:5,rotation:0,color:"#000000",background:"#ffffff",lineWidth:2};var Jm=ie.exports.memo(function(n){var e=n.id,t=n.background,r=n.color,i=n.size,s=n.padding,o=n.stagger,a=i+s,l=s/2;return o===!0&&(a=2*i+2*s),ce.jsxs("pattern",{id:e,width:a,height:a,patternUnits:"userSpaceOnUse",children:[ce.jsx("rect",{width:a,height:a,fill:t}),ce.jsx("rect",{x:l,y:l,width:i,height:i,fill:r}),o&&ce.jsx("rect",{x:1.5*s+i,y:1.5*s+i,width:i,height:i,fill:r})]})});Jm.displayName="PatternSquares",Jm.propTypes={id:M.exports.string.isRequired,color:M.exports.string.isRequired,background:M.exports.string.isRequired,size:M.exports.number.isRequired,padding:M.exports.number.isRequired,stagger:M.exports.bool.isRequired},Jm.defaultProps={color:"#000000",background:"#ffffff",size:4,padding:4,stagger:!1};var UP={patternDots:Qm,patternLines:Zm,patternSquares:Jm},F0e=["type"],w5=Yn({},HP,UP),BP=function(n){var e=n.defs;return!e||e.length<1?null:ce.jsx("defs",{"aria-hidden":!0,children:e.map(function(t){var r=t.type,i=cS(t,F0e);return w5[r]?ie.exports.createElement(w5[r],Yn({key:i.id},i)):null})})};BP.propTypes={defs:M.exports.arrayOf(M.exports.shape({type:M.exports.oneOf(Object.keys(w5)).isRequired,id:M.exports.string.isRequired}))};var H0e=ie.exports.memo(BP),mS=function(n){var e=n.width,t=n.height,r=n.margin,i=n.defs,s=n.children,o=n.role,a=n.ariaLabel,l=n.ariaLabelledBy,u=n.ariaDescribedBy,c=n.isFocusable,h=rn();return ce.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:t,role:o,"aria-label":a,"aria-labelledby":l,"aria-describedby":u,focusable:c,tabIndex:c?0:void 0,children:[ce.jsx(H0e,{defs:i}),ce.jsx("rect",{width:e,height:t,fill:h.background}),ce.jsx("g",{transform:"translate("+r.left+","+r.top+")",children:s})]})};mS.propTypes={width:M.exports.number.isRequired,height:M.exports.number.isRequired,margin:M.exports.shape({top:M.exports.number.isRequired,left:M.exports.number.isRequired}).isRequired,defs:M.exports.array,children:M.exports.oneOfType([M.exports.arrayOf(M.exports.node),M.exports.node]).isRequired,role:M.exports.string,isFocusable:M.exports.bool,ariaLabel:M.exports.string,ariaLabelledBy:M.exports.string,ariaDescribedBy:M.exports.string};var VP=function(n){var e=n.size,t=n.color,r=n.borderWidth,i=n.borderColor;return ce.jsx("circle",{r:e/2,fill:t,stroke:i,strokeWidth:r,style:{pointerEvents:"none"}})};VP.propTypes={size:M.exports.number.isRequired,color:M.exports.string.isRequired,borderWidth:M.exports.number.isRequired,borderColor:M.exports.string.isRequired};var U0e=ie.exports.memo(VP),$P=function(n){var e=n.x,t=n.y,r=n.symbol,i=r===void 0?U0e:r,s=n.size,o=n.datum,a=n.color,l=n.borderWidth,u=n.borderColor,c=n.label,h=n.labelTextAnchor,d=h===void 0?"middle":h,f=n.labelYOffset,m=f===void 0?-12:f,p=rn(),y=Bi(),C=y.animate,b=y.config,v=Ks({transform:"translate("+e+", "+t+")",config:b,immediate:!C});return ce.jsxs(Tn.g,{transform:v.transform,style:{pointerEvents:"none"},children:[ie.exports.createElement(i,{size:s,color:a,datum:o,borderWidth:l,borderColor:u}),c&&ce.jsx("text",{textAnchor:d,y:m,style:p.dots.text,children:c})]})};$P.propTypes={x:M.exports.number.isRequired,y:M.exports.number.isRequired,datum:M.exports.object.isRequired,size:M.exports.number.isRequired,color:M.exports.string.isRequired,borderWidth:M.exports.number.isRequired,borderColor:M.exports.string.isRequired,symbol:M.exports.oneOfType([M.exports.func,M.exports.object]),label:M.exports.oneOfType([M.exports.string,M.exports.number]),labelTextAnchor:M.exports.oneOf(["start","middle","end"]),labelYOffset:M.exports.number};var B0e=ie.exports.memo($P),v5=function(n){var e=n.width,t=n.height,r=n.axis,i=n.scale,s=n.value,o=n.lineStyle,a=n.textStyle,l=n.legend,u=n.legendPosition,c=n.legendOffsetX,h=n.legendOffsetY,d=n.legendOrientation,f=rn(),m=0,p=0,y=0,C=0;r==="y"?(y=i(s),p=e):(m=i(s),C=t);var b=null;if(l){var v=function(S){var L=S.axis,_=S.width,P=S.height,x=S.position,I=S.offsetX,R=S.offsetY,N=S.orientation,H=0,K=0,X=N==="vertical"?-90:0,J="start";if(L==="x")switch(x){case"top-left":H=-I,K=R,J="end";break;case"top":K=-R,J=N==="horizontal"?"middle":"start";break;case"top-right":H=I,K=R,J=N==="horizontal"?"start":"end";break;case"right":H=I,K=P/2,J=N==="horizontal"?"start":"middle";break;case"bottom-right":H=I,K=P-R,J="start";break;case"bottom":K=P+R,J=N==="horizontal"?"middle":"end";break;case"bottom-left":K=P-R,H=-I,J=N==="horizontal"?"end":"start";break;case"left":H=-I,K=P/2,J=N==="horizontal"?"end":"middle"}else switch(x){case"top-left":H=I,K=-R,J="start";break;case"top":H=_/2,K=-R,J=N==="horizontal"?"middle":"start";break;case"top-right":H=_-I,K=-R,J=N==="horizontal"?"end":"start";break;case"right":H=_+I,J=N==="horizontal"?"start":"middle";break;case"bottom-right":H=_-I,K=R,J="end";break;case"bottom":H=_/2,K=R,J=N==="horizontal"?"middle":"end";break;case"bottom-left":H=I,K=R,J=N==="horizontal"?"start":"end";break;case"left":H=-I,J=N==="horizontal"?"end":"middle"}return{x:H,y:K,rotation:X,textAnchor:J}}({axis:r,width:e,height:t,position:u,offsetX:c,offsetY:h,orientation:d});b=ce.jsx("text",{transform:"translate("+v.x+", "+v.y+") rotate("+v.rotation+")",textAnchor:v.textAnchor,dominantBaseline:"central",style:a,children:l})}return ce.jsxs("g",{transform:"translate("+m+", "+y+")",children:[ce.jsx("line",{x1:0,x2:p,y1:0,y2:C,stroke:f.markers.lineColor,strokeWidth:f.markers.lineStrokeWidth,style:o}),b]})};v5.propTypes={width:M.exports.number.isRequired,height:M.exports.number.isRequired,axis:M.exports.oneOf(["x","y"]).isRequired,scale:M.exports.func.isRequired,value:M.exports.oneOfType([M.exports.number,M.exports.string,M.exports.instanceOf(Date)]).isRequired,lineStyle:M.exports.object,textStyle:M.exports.object,legend:M.exports.string,legendPosition:M.exports.oneOf(["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"]),legendOffsetX:M.exports.number.isRequired,legendOffsetY:M.exports.number.isRequired,legendOrientation:M.exports.oneOf(["horizontal","vertical"]).isRequired},v5.defaultProps={legendPosition:"top-right",legendOffsetX:14,legendOffsetY:14,legendOrientation:"horizontal"};var V0e=ie.exports.memo(v5),WP=function(n){var e=n.markers,t=n.width,r=n.height,i=n.xScale,s=n.yScale;return e&&e.length!==0?e.map(function(o,a){return ce.jsx(V0e,Yn({},o,{width:t,height:r,scale:o.axis==="y"?s:i}),a)}):null};WP.propTypes={width:M.exports.number.isRequired,height:M.exports.number.isRequired,xScale:M.exports.func.isRequired,yScale:M.exports.func.isRequired,markers:M.exports.arrayOf(M.exports.shape({axis:M.exports.oneOf(["x","y"]).isRequired,value:M.exports.oneOfType([M.exports.number,M.exports.string,M.exports.instanceOf(Date)]).isRequired,lineStyle:M.exports.object,textStyle:M.exports.object}))};var GP=ie.exports.memo(WP),$0e=["theme","renderWrapper","animate","motionStiffness","motionDamping","motionConfig"],zP=function(n){return function(e){var t,r;function i(){return e.apply(this,arguments)||this}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,g5(t,r),i.prototype.render=function(){var s=this.props,o=s.theme,a=s.renderWrapper,l=s.animate,u=s.motionStiffness,c=s.motionDamping,h=s.motionConfig,d=cS(s,$0e);return ce.jsx(D0,{theme:o,renderWrapper:a,isInteractive:d.isInteractive,animate:l,motionStiffness:u,motionDamping:c,motionConfig:h,children:ce.jsx(n,Yn({},d))})},i}(ie.exports.Component)},W0e=function(n,e){var t,r=Uh(n)?n:function(i){return Ni(i,n)};return e&&(t=Uh(e)?e:_0(e)),t?function(i){return t(r(i))}:r},YP=function(n){return Uh(n)?n:function(e){return Ni(e,n)}},ly=function(n){return ie.exports.useMemo(function(){return YP(n)},[n])},jP=function(n,e,t,r,i,s){return n<=i&&i<=n+t&&e<=s&&s<=e+r},Fh=function(n,e){var t=e.clientX,r=e.clientY,i=n.getBoundingClientRect(),s=n.getBBox(),o=s.width===i.width?1:s.width/i.width;return[(t-i.left)*o,(r-i.top)*o]},G0e=Object.keys(HP),z0e=Object.keys(UP),Y0e=function(n,e,t){if(n==="*")return!0;if(Uh(n))return n(e);if(tf(n)){var r=t?Ni(e,t):e;return jk(i0e(r,Object.keys(n)),n)}return!1},KP=function(n,e,t,r){var i=r===void 0?{}:r,s=i.dataKey,o=i.colorKey,a=o===void 0?"color":o,l=i.targetKey,u=l===void 0?"fill":l,c=[],h={};return n.length&&e.length&&(c=[].concat(n),e.forEach(function(d){for(var f=function(p){var y=t[p],C=y.id,b=y.match;if(Y0e(b,d,s)){var v=n.find(function(N){return N.id===C});if(v){if(z0e.includes(v.type))if(v.background==="inherit"||v.color==="inherit"){var S=Ni(d,a),L=v.background,_=v.color,P=C;v.background==="inherit"&&(P=P+".bg."+S,L=S),v.color==="inherit"&&(P=P+".fg."+S,_=S),Xa(d,u,"url(#"+P+")"),h[P]||(c.push(Yn({},v,{id:P,background:L,color:_})),h[P]=1)}else Xa(d,u,"url(#"+C+")");else if(G0e.includes(v.type))if(v.colors.map(function(N){return N.color}).includes("inherit")){var x=Ni(d,a),I=C,R=Yn({},v,{colors:v.colors.map(function(N,H){return N.color!=="inherit"?N:(I=I+"."+H+"."+x,Yn({},N,{color:N.color==="inherit"?x:N.color}))})});R.id=I,Xa(d,u,"url(#"+I+")"),h[I]||(c.push(R),h[I]=1)}else Xa(d,u,"url(#"+C+")")}return"break"}},m=0;m<t.length&&f(m)!=="break";m++);})),c},j0e=Kk;function K0e(n){return n&&n.length?j0e(n):[]}var I3=K0e,q0e=gA,X0e=Md,Q0e="[object Date]";function Z0e(n){return X0e(n)&&q0e(n)==Q0e}var J0e=Z0e,e2e=J0e,t2e=Og,O3=P5.exports,_3=O3&&O3.isDate,n2e=_3?t2e(_3):e2e,r2e=n2e,uy=new Date,cy=new Date;function rr(n,e,t,r){function i(s){return n(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=function(s){return n(s=new Date(+s)),s},i.ceil=function(s){return n(s=new Date(s-1)),e(s,1),n(s),s},i.round=function(s){var o=i(s),a=i.ceil(s);return s-o<a-s?o:a},i.offset=function(s,o){return e(s=new Date(+s),o==null?1:Math.floor(o)),s},i.range=function(s,o,a){var l=[],u;if(s=i.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return l;do l.push(u=new Date(+s)),e(s,a),n(s);while(u<s&&s<o);return l},i.filter=function(s){return rr(function(o){if(o>=o)for(;n(o),!s(o);)o.setTime(o-1)},function(o,a){if(o>=o)if(a<0)for(;++a<=0;)for(;e(o,-1),!s(o););else for(;--a>=0;)for(;e(o,1),!s(o););})},t&&(i.count=function(s,o){return uy.setTime(+s),cy.setTime(+o),n(uy),n(cy),Math.floor(t(uy,cy))},i.every=function(s){return s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?function(o){return r(o)%s===0}:function(o){return i.count(0,o)%s===0}):i}),i}var wg=rr(function(){},function(n,e){n.setTime(+n+e)},function(n,e){return e-n});wg.every=function(n){return n=Math.floor(n),!isFinite(n)||!(n>0)?null:n>1?rr(function(e){e.setTime(Math.floor(e/n)*n)},function(e,t){e.setTime(+e+t*n)},function(e,t){return(t-e)/n}):wg};const L3=wg;wg.range;var vg=1e3,hc=6e4,Cg=36e5,qP=6048e5,XP=rr(function(n){n.setTime(n-n.getMilliseconds())},function(n,e){n.setTime(+n+e*vg)},function(n,e){return(e-n)/vg},function(n){return n.getUTCSeconds()});const P3=XP;XP.range;var QP=rr(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*vg)},function(n,e){n.setTime(+n+e*hc)},function(n,e){return(e-n)/hc},function(n){return n.getMinutes()});const i2e=QP;QP.range;var ZP=rr(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*vg-n.getMinutes()*hc)},function(n,e){n.setTime(+n+e*Cg)},function(n,e){return(e-n)/Cg},function(n){return n.getHours()});const s2e=ZP;ZP.range;function Dl(n){return rr(function(e){e.setDate(e.getDate()-(e.getDay()+7-n)%7),e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t*7)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*hc)/qP})}var C5=Dl(0),JP=Dl(1),eD=Dl(2),tD=Dl(3),nD=Dl(4),rD=Dl(5),iD=Dl(6);C5.range;JP.range;eD.range;tD.range;nD.range;rD.range;iD.range;var sD=rr(function(n){n.setDate(1),n.setHours(0,0,0,0)},function(n,e){n.setMonth(n.getMonth()+e)},function(n,e){return e.getMonth()-n.getMonth()+(e.getFullYear()-n.getFullYear())*12},function(n){return n.getMonth()});const o2e=sD;sD.range;var pS=rr(function(n){n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,e){n.setFullYear(n.getFullYear()+e)},function(n,e){return e.getFullYear()-n.getFullYear()},function(n){return n.getFullYear()});pS.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:rr(function(e){e.setFullYear(Math.floor(e.getFullYear()/n)*n),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t*n)})};const a2e=pS;pS.range;var oD=rr(function(n){n.setUTCSeconds(0,0)},function(n,e){n.setTime(+n+e*hc)},function(n,e){return(e-n)/hc},function(n){return n.getUTCMinutes()});const l2e=oD;oD.range;var aD=rr(function(n){n.setUTCMinutes(0,0,0)},function(n,e){n.setTime(+n+e*Cg)},function(n,e){return(e-n)/Cg},function(n){return n.getUTCHours()});const u2e=aD;aD.range;function kl(n){return rr(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-n)%7),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t*7)},function(e,t){return(t-e)/qP})}var E5=kl(0),lD=kl(1),uD=kl(2),cD=kl(3),hD=kl(4),dD=kl(5),fD=kl(6);E5.range;lD.range;uD.range;cD.range;hD.range;dD.range;fD.range;var mD=rr(function(n){n.setUTCDate(1),n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCMonth(n.getUTCMonth()+e)},function(n,e){return e.getUTCMonth()-n.getUTCMonth()+(e.getUTCFullYear()-n.getUTCFullYear())*12},function(n){return n.getUTCMonth()});const c2e=mD;mD.range;var gS=rr(function(n){n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCFullYear(n.getUTCFullYear()+e)},function(n,e){return e.getUTCFullYear()-n.getUTCFullYear()},function(n){return n.getUTCFullYear()});gS.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:rr(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/n)*n),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t*n)})};const h2e=gS;gS.range;function Ga(){return Ga=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Ga.apply(this,arguments)}var du=[function(n){return n.setMilliseconds(0)},function(n){return n.setSeconds(0)},function(n){return n.setMinutes(0)},function(n){return n.setHours(0)},function(n){return n.setDate(1)},function(n){return n.setMonth(0)}],d2e={millisecond:[],second:du.slice(0,1),minute:du.slice(0,2),hour:du.slice(0,3),day:du.slice(0,4),month:du.slice(0,5),year:du.slice(0,6)},f2e=function(n){return function(e){return d2e[n].forEach(function(t){t(e)}),e}},pD=function(n){var e=n.format,t=e===void 0?"native":e,r=n.precision,i=r===void 0?"millisecond":r,s=n.useUTC,o=s===void 0||s,a=f2e(i);return function(l){if(l===void 0)return l;if(t==="native"||l instanceof Date)return a(l);var u=o?nP(t):eP(t);return a(u(l))}},m2e=function(n,e,t,r){var i,s,o,a,l=n.min,u=l===void 0?0:l,c=n.max,h=c===void 0?"auto":c,d=n.stacked,f=d!==void 0&&d,m=n.reverse,p=m!==void 0&&m,y=n.clamp,C=y!==void 0&&y,b=n.nice,v=b!==void 0&&b;u==="auto"?i=f===!0?(s=e.minStacked)!=null?s:0:e.min:i=u,h==="auto"?o=f===!0?(a=e.maxStacked)!=null?a:0:e.max:o=h;var S=IL().rangeRound(r==="x"?[0,t]:[t,0]).domain(p?[o,i]:[i,o]).clamp(C);return v===!0?S.nice():typeof v=="number"&&S.nice(v),p2e(S,f)},p2e=function(n,e){e===void 0&&(e=!1);var t=n;return t.type="linear",t.stacked=e,t},g2e=function(n,e,t){var r=fme().range([0,t]).domain(e.all);return r.type="point",r},y2e=function(n,e,t,r){var i=n.round,s=i===void 0||i,o=Kb().range(r==="x"?[0,t]:[t,0]).domain(e.all).round(s);return w2e(o)},w2e=function(n){var e=n;return e.type="band",e},v2e=function(n,e,t){var r,i,s=n.format,o=s===void 0?"native":s,a=n.precision,l=a===void 0?"millisecond":a,u=n.min,c=u===void 0?"auto":u,h=n.max,d=h===void 0?"auto":h,f=n.useUTC,m=f===void 0||f,p=n.nice,y=p!==void 0&&p,C=pD({format:o,precision:l,useUTC:m});r=c==="auto"?C(e.min):o!=="native"?C(c):c,i=d==="auto"?C(e.max):o!=="native"?C(d):d;var b=m?tge():ege();b.range([0,t]),r&&i&&b.domain([r,i]),y===!0?b.nice():typeof y!="object"&&typeof y!="number"||b.nice(y);var v=b;return v.type="time",v.useUTC=m,v},C2e=function(n,e,t,r){var i,s=n.base,o=s===void 0?10:s,a=n.min,l=a===void 0?"auto":a,u=n.max,c=u===void 0?"auto":u;if(e.all.some(function(p){return p===0}))throw new Error("a log scale domain must not include or cross zero");var h,d,f=!1;if(e.all.filter(function(p){return p!=null}).forEach(function(p){f||(i===void 0?i=Math.sign(p):Math.sign(p)!==i&&(f=!0))}),f)throw new Error("a log scale domain must be strictly-positive or strictly-negative");h=l==="auto"?e.min:l,d=c==="auto"?e.max:c;var m=_L().domain([h,d]).rangeRound(r==="x"?[0,t]:[t,0]).base(o).nice();return m.type="log",m},E2e=function(n,e,t,r){var i,s,o=n.constant,a=o===void 0?1:o,l=n.min,u=l===void 0?"auto":l,c=n.max,h=c===void 0?"auto":c,d=n.reverse,f=d!==void 0&&d;i=u==="auto"?e.min:u,s=h==="auto"?e.max:h;var m=LL().constant(a).rangeRound(r==="x"?[0,t]:[t,0]).nice();f===!0?m.domain([s,i]):m.domain([i,s]);var p=m;return p.type="symlog",p},b2e=function(n){return n==="x"?"y":"x"},S2e=function(n,e){return n===e},R2e=function(n,e){return n.getTime()===e.getTime()};function Td(n,e,t,r){switch(n.type){case"linear":return m2e(n,e,t,r);case"point":return g2e(0,e,t);case"band":return y2e(n,e,t,r);case"time":return v2e(n,e,t);case"log":return C2e(n,e,t,r);case"symlog":return E2e(n,e,t,r);default:throw new Error("invalid scale spec")}}var D3=function(n,e,t){var r;if("stacked"in t&&t.stacked){var i=n.data[e==="x"?"xStacked":"yStacked"];return i==null?null:t(i)}return(r=t(n.data[e]))!=null?r:null},T2e=function(n,e,t,r,i){var s=n.map(function(c){return function(h){return Ga({},h,{data:h.data.map(function(d){return{data:Ga({},d)}})})}(c)}),o=A2e(s,e,t);"stacked"in e&&e.stacked===!0&&x2e(o,s),"stacked"in t&&t.stacked===!0&&M2e(o,s);var a=Td(e,o.x,r,"x"),l=Td(t,o.y,i,"y"),u=s.map(function(c){return Ga({},c,{data:c.data.map(function(h){return Ga({},h,{position:{x:D3(h,"x",a),y:D3(h,"y",l)}})})})});return Ga({},o,{series:u,xScale:a,yScale:l})},A2e=function(n,e,t){return{x:k3(n,"x",e),y:k3(n,"y",t)}},k3=function(n,e,t,r){var i=r===void 0?{}:r,s=i.getValue,o=s===void 0?function(m){return m.data[e]}:s,a=i.setValue,l=a===void 0?function(m,p){m.data[e]=p}:a;if(t.type==="linear")n.forEach(function(m){m.data.forEach(function(p){var y=o(p);y&&l(p,parseFloat(String(y)))})});else if(t.type==="time"&&t.format!=="native"){var u=pD(t);n.forEach(function(m){m.data.forEach(function(p){var y=o(p);y&&l(p,u(y))})})}var c=[];switch(n.forEach(function(m){m.data.forEach(function(p){c.push(o(p))})}),t.type){case"linear":var h=qk(I3(c).filter(function(m){return m!==null}),function(m){return m});return{all:h,min:Math.min.apply(Math,h),max:Math.max.apply(Math,h)};case"time":var d=py(c,function(m){return m.getTime()}).slice(0).sort(function(m,p){return p.getTime()-m.getTime()}).reverse();return{all:d,min:d[0],max:je(d)};default:var f=I3(c);return{all:f,min:f[0],max:je(f)}}},gD=function(n,e,t){var r=b2e(n),i=[];e[r].all.forEach(function(s){var o=r2e(s)?R2e:S2e,a=[];t.forEach(function(l){var u=l.data.find(function(f){return o(f.data[r],s)}),c=null,h=null;if(u!==void 0){if((c=u.data[n])!==null){var d=je(a);d===void 0?h=c:d!==null&&(h=d+c)}u.data[n==="x"?"xStacked":"yStacked"]=h}a.push(h),h!==null&&i.push(h)})}),e[n].minStacked=Math.min.apply(Math,i),e[n].maxStacked=Math.max.apply(Math,i)},x2e=function(n,e){return gD("x",n,e)},M2e=function(n,e){return gD("y",n,e)},yD=function(n){var e=n.bandwidth();if(e===0)return n;var t=e/2;return n.round()&&(t=Math.round(t)),function(r){var i;return((i=n(r))!=null?i:0)+t}},wD={millisecond:[L3,L3],second:[P3,P3],minute:[i2e,l2e],hour:[s2e,u2e],day:[rr(function(n){return n.setHours(0,0,0,0)},function(n,e){return n.setDate(n.getDate()+e)},function(n,e){return(e.getTime()-n.getTime())/864e5},function(n){return Math.floor(n.getTime()/864e5)}),rr(function(n){return n.setUTCHours(0,0,0,0)},function(n,e){return n.setUTCDate(n.getUTCDate()+e)},function(n,e){return(e.getTime()-n.getTime())/864e5},function(n){return Math.floor(n.getTime()/864e5)})],week:[C5,E5],sunday:[C5,E5],monday:[JP,lD],tuesday:[eD,uD],wednesday:[tD,cD],thursday:[nD,hD],friday:[rD,dD],saturday:[iD,fD],month:[o2e,c2e],year:[a2e,h2e]},N2e=Object.keys(wD),I2e=new RegExp("^every\\s*(\\d+)?\\s*("+N2e.join("|")+")s?$","i"),vD=function(n,e){if(Array.isArray(e))return e;if(typeof e=="string"&&"useUTC"in n){var t=e.match(I2e);if(t){var r=t[1],i=t[2],s=wD[i][n.useUTC?1:0];if(i==="day"){var o,a,l=n.domain(),u=l[0],c=l[1],h=new Date(c);return h.setDate(h.getDate()+1),(o=(a=s.every(Number(r!=null?r:1)))==null?void 0:a.range(u,h))!=null?o:[]}if(r===void 0)return n.ticks(s);var d=s.every(Number(r));if(d)return n.ticks(d)}throw new Error("Invalid tickValues: "+e)}if("ticks"in n){if(e===void 0)return n.ticks();if(typeof(f=e)=="number"&&isFinite(f)&&Math.floor(f)===f)return n.ticks(e)}var f;return n.domain()};function ss(){return ss=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},ss.apply(this,arguments)}var CD=function(n){var e,t=n.axis,r=n.scale,i=n.ticksPosition,s=n.tickValues,o=n.tickSize,a=n.tickPadding,l=n.tickRotation,u=n.engine,c=u===void 0?"svg":u,h=vD(r,s),d=k0e[c],f="bandwidth"in r?yD(r):r,m={lineX:0,lineY:0},p={textX:0,textY:0},y=typeof document=="object"&&document.dir==="rtl",C=d.align.center,b=d.baseline.center;return t==="x"?(e=function(v){var S;return{x:(S=f(v))!=null?S:0,y:0}},m.lineY=o*(i==="after"?1:-1),p.textY=(o+a)*(i==="after"?1:-1),b=i==="after"?d.baseline.top:d.baseline.bottom,l===0?C=d.align.center:i==="after"&&l<0||i==="before"&&l>0?(C=d.align[y?"left":"right"],b=d.baseline.center):(i==="after"&&l>0||i==="before"&&l<0)&&(C=d.align[y?"right":"left"],b=d.baseline.center)):(e=function(v){var S;return{x:0,y:(S=f(v))!=null?S:0}},m.lineX=o*(i==="after"?1:-1),p.textX=(o+a)*(i==="after"?1:-1),C=i==="after"?d.align.left:d.align.right),{ticks:h.map(function(v){return ss({key:v instanceof Date?""+v.valueOf():""+v,value:v},e(v),m,p)}),textAlign:C,textBaseline:b}},ED=function(n,e){if(n===void 0||typeof n=="function")return n;if(e.type==="time"){var t=t0(n);return function(r){return t(r instanceof Date?r:new Date(r))}}return _0(n)},b5=function(n){var e,t=n.width,r=n.height,i=n.scale,s=n.axis,o=n.values,a=(e=o,(Array.isArray(e)?o:void 0)||vD(i,o)),l="bandwidth"in i?yD(i):i,u=s==="x"?a.map(function(c){var h,d;return{key:c instanceof Date?""+c.valueOf():""+c,x1:(h=l(c))!=null?h:0,x2:(d=l(c))!=null?d:0,y1:0,y2:r}}):a.map(function(c){var h,d;return{key:c instanceof Date?""+c.valueOf():""+c,x1:0,x2:t,y1:(h=l(c))!=null?h:0,y2:(d=l(c))!=null?d:0}});return u},O2e=ie.exports.memo(function(n){var e,t=n.value,r=n.format,i=n.lineX,s=n.lineY,o=n.onClick,a=n.textBaseline,l=n.textAnchor,u=n.animatedProps,c=rn(),h=(e=r==null?void 0:r(t))!=null?e:t,d=ie.exports.useMemo(function(){var f={opacity:u.opacity};return o?{style:ss({},f,{cursor:"pointer"}),onClick:function(m){return o(m,h)}}:{style:f}},[u.opacity,o,h]);return ce.jsxs(Tn.g,ss({transform:u.transform},d,{children:[ce.jsx("line",{x1:0,x2:i,y1:0,y2:s,style:c.axis.ticks.line}),ce.jsx(Tn.text,{dominantBaseline:a,textAnchor:l,transform:u.textTransform,style:c.axis.ticks.text,children:h})]}))}),_2e=ie.exports.memo(function(n){var e=n.axis,t=n.scale,r=n.x,i=r===void 0?0:r,s=n.y,o=s===void 0?0:s,a=n.length,l=n.ticksPosition,u=n.tickValues,c=n.tickSize,h=c===void 0?5:c,d=n.tickPadding,f=d===void 0?5:d,m=n.tickRotation,p=m===void 0?0:m,y=n.format,C=n.renderTick,b=C===void 0?O2e:C,v=n.legend,S=n.legendPosition,L=S===void 0?"end":S,_=n.legendOffset,P=_===void 0?0:_,x=n.onClick,I=n.ariaHidden,R=rn(),N=ie.exports.useMemo(function(){return ED(y,t)},[y,t]),H=CD({axis:e,scale:t,ticksPosition:l,tickValues:u,tickSize:h,tickPadding:f,tickRotation:p}),K=H.ticks,X=H.textAlign,J=H.textBaseline,ue=null;if(v!==void 0){var se,O=0,g=0,E=0;e==="y"?(E=-90,O=P,L==="start"?(se="start",g=a):L==="middle"?(se="middle",g=a/2):L==="end"&&(se="end")):(g=P,L==="start"?se="start":L==="middle"?(se="middle",O=a/2):L==="end"&&(se="end",O=a)),ue=ce.jsx("text",{transform:"translate("+O+", "+g+") rotate("+E+")",textAnchor:se,style:ss({dominantBaseline:"central"},R.axis.legend.text),children:v})}var A=Bi(),U=A.animate,G=A.config,V=Ks({transform:"translate("+i+","+o+")",lineX2:e==="x"?a:0,lineY2:e==="x"?0:a,config:G,immediate:!U}),oe=Fb(K,{keys:function(j){return j.key},initial:function(j){return{opacity:1,transform:"translate("+j.x+","+j.y+")",textTransform:"translate("+j.textX+","+j.textY+") rotate("+p+")"}},from:function(j){return{opacity:0,transform:"translate("+j.x+","+j.y+")",textTransform:"translate("+j.textX+","+j.textY+") rotate("+p+")"}},enter:function(j){return{opacity:1,transform:"translate("+j.x+","+j.y+")",textTransform:"translate("+j.textX+","+j.textY+") rotate("+p+")"}},update:function(j){return{opacity:1,transform:"translate("+j.x+","+j.y+")",textTransform:"translate("+j.textX+","+j.textY+") rotate("+p+")"}},leave:{opacity:0},config:G,immediate:!U});return ce.jsxs(Tn.g,{transform:V.transform,"aria-hidden":I,children:[oe(function(j,ye,ee,T){return ie.exports.createElement(b,ss({tickIndex:T,format:N,rotate:p,textBaseline:J,textAnchor:X,animatedProps:j},ye,x?{onClick:x}:{}))}),ce.jsx(Tn.line,{style:R.axis.domain.line,x1:0,x2:V.lineX2,y1:0,y2:V.lineY2}),ue]})}),L2e={ticksPosition:M.exports.oneOf(["before","after"]),tickValues:M.exports.oneOfType([M.exports.number,M.exports.arrayOf(M.exports.oneOfType([M.exports.number,M.exports.string,M.exports.instanceOf(Date)])),M.exports.string]),tickSize:M.exports.number,tickPadding:M.exports.number,tickRotation:M.exports.number,format:M.exports.oneOfType([M.exports.func,M.exports.string]),renderTick:M.exports.func,legend:M.exports.node,legendPosition:M.exports.oneOf(["start","middle","end"]),legendOffset:M.exports.number,ariaHidden:M.exports.bool},vm=M.exports.shape(L2e),bD=["top","right","bottom","left"],SD=ie.exports.memo(function(n){var e=n.xScale,t=n.yScale,r=n.width,i=n.height,s={top:n.top,right:n.right,bottom:n.bottom,left:n.left};return ce.jsx(ce.Fragment,{children:bD.map(function(o){var a=s[o];if(!a)return null;var l=o==="top"||o==="bottom";return ce.jsx(_2e,ss({},a,{axis:l?"x":"y",x:o==="right"?r:0,y:o==="bottom"?i:0,scale:l?e:t,length:l?r:i,ticksPosition:o==="top"||o==="left"?"before":"after"}),o)})})}),P2e=ie.exports.memo(function(n){var e=n.animatedProps,t=rn();return ce.jsx(Tn.line,ss({},e,t.grid.line))}),F3=ie.exports.memo(function(n){var e=n.lines,t=Bi(),r=t.animate,i=t.config,s=Fb(e,{keys:function(o){return o.key},initial:function(o){return{opacity:1,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2}},from:function(o){return{opacity:0,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2}},enter:function(o){return{opacity:1,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2}},update:function(o){return{opacity:1,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2}},leave:{opacity:0},config:i,immediate:!r});return ce.jsx("g",{children:s(function(o,a){return ie.exports.createElement(P2e,ss({},a,{key:a.key,animatedProps:o}))})})}),RD=ie.exports.memo(function(n){var e=n.width,t=n.height,r=n.xScale,i=n.yScale,s=n.xValues,o=n.yValues,a=ie.exports.useMemo(function(){return!!r&&b5({width:e,height:t,scale:r,axis:"x",values:s})},[r,s,e,t]),l=ie.exports.useMemo(function(){return!!i&&b5({width:e,height:t,scale:i,axis:"y",values:o})},[t,e,i,o]);return ce.jsxs(ce.Fragment,{children:[a&&ce.jsx(F3,{lines:a}),l&&ce.jsx(F3,{lines:l})]})}),D2e=function(n,e){var t,r=e.axis,i=e.scale,s=e.x,o=s===void 0?0:s,a=e.y,l=a===void 0?0:a,u=e.length,c=e.ticksPosition,h=e.tickValues,d=e.tickSize,f=d===void 0?5:d,m=e.tickPadding,p=m===void 0?5:m,y=e.tickRotation,C=y===void 0?0:y,b=e.format,v=e.legend,S=e.legendPosition,L=S===void 0?"end":S,_=e.legendOffset,P=_===void 0?0:_,x=e.theme,I=CD({axis:r,scale:i,ticksPosition:c,tickValues:h,tickSize:f,tickPadding:p,tickRotation:C,engine:"canvas"}),R=I.ticks,N=I.textAlign,H=I.textBaseline;n.save(),n.translate(o,l),n.textAlign=N,n.textBaseline=H,n.font=(x.axis.ticks.text.fontWeight?x.axis.ticks.text.fontWeight+" ":"")+x.axis.ticks.text.fontSize+"px "+x.axis.ticks.text.fontFamily,((t=x.axis.domain.line.strokeWidth)!=null?t:0)>0&&(n.lineWidth=Number(x.axis.domain.line.strokeWidth),n.lineCap="square",x.axis.domain.line.stroke&&(n.strokeStyle=x.axis.domain.line.stroke),n.beginPath(),n.moveTo(0,0),n.lineTo(r==="x"?u:0,r==="x"?0:u),n.stroke());var K=typeof b=="function"?b:function(O){return""+O};if(R.forEach(function(O){var g;((g=x.axis.ticks.line.strokeWidth)!=null?g:0)>0&&(n.lineWidth=Number(x.axis.ticks.line.strokeWidth),n.lineCap="square",x.axis.ticks.line.stroke&&(n.strokeStyle=x.axis.ticks.line.stroke),n.beginPath(),n.moveTo(O.x,O.y),n.lineTo(O.x+O.lineX,O.y+O.lineY),n.stroke());var E=K(O.value);n.save(),n.translate(O.x+O.textX,O.y+O.textY),n.rotate(Rd(C)),x.axis.ticks.text.fill&&(n.fillStyle=x.axis.ticks.text.fill),n.fillText(String(E),0,0),n.restore()}),v!==void 0){var X=0,J=0,ue=0,se="center";r==="y"?(ue=-90,X=P,L==="start"?(se="start",J=u):L==="middle"?(se="center",J=u/2):L==="end"&&(se="end")):(J=P,L==="start"?se="start":L==="middle"?(se="center",X=u/2):L==="end"&&(se="end",X=u)),n.translate(X,J),n.rotate(Rd(ue)),n.font=(x.axis.legend.text.fontWeight?x.axis.legend.text.fontWeight+" ":"")+x.axis.legend.text.fontSize+"px "+x.axis.legend.text.fontFamily,x.axis.legend.text.fill&&(n.fillStyle=x.axis.legend.text.fill),n.textAlign=se,n.textBaseline="middle",n.fillText(v,0,0)}n.restore()},TD=function(n,e){var t=e.xScale,r=e.yScale,i=e.width,s=e.height,o=e.top,a=e.right,l=e.bottom,u=e.left,c=e.theme,h={top:o,right:a,bottom:l,left:u};bD.forEach(function(d){var f=h[d];if(!f)return null;var m=d==="top"||d==="bottom",p=d==="top"||d==="left"?"before":"after",y=m?t:r,C=ED(f.format,y);D2e(n,ss({},f,{axis:m?"x":"y",x:d==="right"?i:0,y:d==="bottom"?s:0,scale:y,format:C,length:m?i:s,ticksPosition:p,theme:c}))})},Eg=function(n,e){var t=e.width,r=e.height,i=e.scale,s=e.axis,o=e.values;b5({width:t,height:r,scale:i,axis:s,values:o}).forEach(function(a){n.beginPath(),n.moveTo(a.x1,a.y1),n.lineTo(a.x2,a.y2),n.stroke()})};function k2e(n,e){for(var t=-1,r=n==null?0:n.length;++t<r&&e(n[t],t,n)!==!1;);return n}var F2e=k2e,H2e=Ac,U2e=SA;function B2e(n,e){return n&&H2e(e,U2e(e),n)}var V2e=B2e,$2e=Ac,W2e=nf;function G2e(n,e){return n&&$2e(e,W2e(e),n)}var z2e=G2e,Y2e=Ac,j2e=RA;function K2e(n,e){return Y2e(n,j2e(n),e)}var q2e=K2e,X2e=Xk,Q2e=Bb,Z2e=RA,J2e=Qk,e6e=Object.getOwnPropertySymbols,t6e=e6e?function(n){for(var e=[];n;)X2e(e,Z2e(n)),n=Q2e(n);return e}:J2e,AD=t6e,n6e=Ac,r6e=AD;function i6e(n,e){return n6e(n,r6e(n),e)}var s6e=i6e,o6e=Zk,a6e=AD,l6e=nf;function u6e(n){return o6e(n,l6e,a6e)}var xD=u6e,c6e=Object.prototype,h6e=c6e.hasOwnProperty;function d6e(n){var e=n.length,t=new n.constructor(e);return e&&typeof n[0]=="string"&&h6e.call(n,"index")&&(t.index=n.index,t.input=n.input),t}var f6e=d6e,m6e=Ub;function p6e(n,e){var t=e?m6e(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.byteLength)}var g6e=p6e,y6e=/\w*$/;function w6e(n){var e=new n.constructor(n.source,y6e.exec(n));return e.lastIndex=n.lastIndex,e}var v6e=w6e,H3=Jk,U3=H3?H3.prototype:void 0,B3=U3?U3.valueOf:void 0;function C6e(n){return B3?Object(B3.call(n)):{}}var E6e=C6e,b6e=Ub,S6e=g6e,R6e=v6e,T6e=E6e,A6e=uL,x6e="[object Boolean]",M6e="[object Date]",N6e="[object Map]",I6e="[object Number]",O6e="[object RegExp]",_6e="[object Set]",L6e="[object String]",P6e="[object Symbol]",D6e="[object ArrayBuffer]",k6e="[object DataView]",F6e="[object Float32Array]",H6e="[object Float64Array]",U6e="[object Int8Array]",B6e="[object Int16Array]",V6e="[object Int32Array]",$6e="[object Uint8Array]",W6e="[object Uint8ClampedArray]",G6e="[object Uint16Array]",z6e="[object Uint32Array]";function Y6e(n,e,t){var r=n.constructor;switch(e){case D6e:return b6e(n);case x6e:case M6e:return new r(+n);case k6e:return S6e(n,t);case F6e:case H6e:case U6e:case B6e:case V6e:case $6e:case W6e:case G6e:case z6e:return A6e(n,t);case N6e:return new r;case I6e:case L6e:return new r(n);case O6e:return R6e(n);case _6e:return new r;case P6e:return T6e(n)}}var j6e=Y6e,K6e=D5,q6e=Md,X6e="[object Map]";function Q6e(n){return q6e(n)&&K6e(n)==X6e}var Z6e=Q6e,J6e=Z6e,eye=Og,V3=P5.exports,$3=V3&&V3.isMap,tye=$3?eye($3):J6e,nye=tye,rye=D5,iye=Md,sye="[object Set]";function oye(n){return iye(n)&&rye(n)==sye}var aye=oye,lye=aye,uye=Og,W3=P5.exports,G3=W3&&W3.isSet,cye=G3?uye(G3):lye,hye=cye,dye=wA,fye=F2e,mye=Vb,pye=V2e,gye=z2e,yye=og.exports,wye=cL,vye=q2e,Cye=s6e,Eye=eF,bye=xD,Sye=D5,Rye=f6e,Tye=j6e,Aye=hL,xye=L5,Mye=yA.exports,Nye=nye,Iye=fc,Oye=hye,_ye=SA,Lye=nf,Pye=1,Dye=2,kye=4,MD="[object Arguments]",Fye="[object Array]",Hye="[object Boolean]",Uye="[object Date]",Bye="[object Error]",ND="[object Function]",Vye="[object GeneratorFunction]",$ye="[object Map]",Wye="[object Number]",ID="[object Object]",Gye="[object RegExp]",zye="[object Set]",Yye="[object String]",jye="[object Symbol]",Kye="[object WeakMap]",qye="[object ArrayBuffer]",Xye="[object DataView]",Qye="[object Float32Array]",Zye="[object Float64Array]",Jye="[object Int8Array]",ewe="[object Int16Array]",twe="[object Int32Array]",nwe="[object Uint8Array]",rwe="[object Uint8ClampedArray]",iwe="[object Uint16Array]",swe="[object Uint32Array]",Kt={};Kt[MD]=Kt[Fye]=Kt[qye]=Kt[Xye]=Kt[Hye]=Kt[Uye]=Kt[Qye]=Kt[Zye]=Kt[Jye]=Kt[ewe]=Kt[twe]=Kt[$ye]=Kt[Wye]=Kt[ID]=Kt[Gye]=Kt[zye]=Kt[Yye]=Kt[jye]=Kt[nwe]=Kt[rwe]=Kt[iwe]=Kt[swe]=!0;Kt[Bye]=Kt[ND]=Kt[Kye]=!1;function ep(n,e,t,r,i,s){var o,a=e&Pye,l=e&Dye,u=e&kye;if(t&&(o=i?t(n,r,i,s):t(n)),o!==void 0)return o;if(!Iye(n))return n;var c=xye(n);if(c){if(o=Rye(n),!a)return wye(n,o)}else{var h=Sye(n),d=h==ND||h==Vye;if(Mye(n))return yye(n,a);if(h==ID||h==MD||d&&!i){if(o=l||d?{}:Aye(n),!a)return l?Cye(n,gye(o,n)):vye(n,pye(o,n))}else{if(!Kt[h])return i?n:{};o=Tye(n,h,a)}}s||(s=new dye);var f=s.get(n);if(f)return f;s.set(n,o),Oye(n)?n.forEach(function(y){o.add(ep(y,e,t,y,n,s))}):Nye(n)&&n.forEach(function(y,C){o.set(C,ep(y,e,t,C,n,s))});var m=u?l?bye:Eye:l?Lye:_ye,p=c?void 0:m(n);return fye(p||n,function(y,C){p&&(C=y,y=n[C]),mye(o,C,ep(y,e,t,C,n,s))}),o}var owe=ep,awe=bA,lwe=tF;function uwe(n,e){return e.length<2?n:awe(n,lwe(e,0,-1))}var cwe=uwe,hwe=Ig,dwe=je,fwe=cwe,mwe=CA;function pwe(n,e){return e=hwe(e,n),n=fwe(n,e),n==null||delete n[mwe(dwe(e))]}var gwe=pwe,ywe=tf;function wwe(n){return ywe(n)?void 0:n}var vwe=wwe,Cwe=EA,Ewe=owe,bwe=gwe,Swe=Ig,Rwe=Ac,Twe=vwe,Awe=IP,xwe=xD,Mwe=1,Nwe=2,Iwe=4,Owe=Awe(function(n,e){var t={};if(n==null)return t;var r=!1;e=Cwe(e,function(s){return s=Swe(s,n),r||(r=s.length>1),s}),Rwe(n,xwe(n),t),r&&(t=Ewe(t,Mwe|Nwe|Iwe,Twe));for(var i=e.length;i--;)bwe(t,e[i]);return t}),OD=Owe,_we=nF;function Lwe(n,e){var t=[];return _we(n,function(r,i,s){e(r,i,s)&&t.push(r)}),t}var Pwe=Lwe,Dwe=iF,kwe=Pwe,Fwe=rF,Hwe=L5;function Uwe(n,e){var t=Hwe(n)?Dwe:kwe;return t(n,Fwe(e))}var Bwe=Uwe;function Ws(){return Ws=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Ws.apply(this,arguments)}var S5={dotSize:4,noteWidth:120,noteTextOffset:8,animate:!0,motionStiffness:90,motionDamping:13},Vwe=function(n){var e=typeof n;return ie.exports.isValidElement(n)||e==="string"||e==="function"||e==="object"},$we=function(n){var e=typeof n;return e==="string"||e==="function"},Ad=function(n){return n.type==="circle"},R5=function(n){return n.type==="dot"},xd=function(n){return n.type==="rect"},Wwe=function(n){var e=n.data,t=n.annotations,r=n.getPosition,i=n.getDimensions;return t.reduce(function(s,o){var a=o.offset||0;return[].concat(s,Bwe(e,o.match).map(function(l){var u=r(l),c=i(l);return(Ad(o)||xd(o))&&(c.size=c.size+2*a,c.width=c.width+2*a,c.height=c.height+2*a),Ws({},OD(o,["match","offset"]),u,c,{size:o.size||c.size,datum:l})}))},[])},Gwe=function(n,e,t,r){var i=Math.atan2(r-e,t-n);return D0e(L0e(i))},_D=function(n){var e,t,r=n.x,i=n.y,s=n.noteX,o=n.noteY,a=n.noteWidth,l=a===void 0?S5.noteWidth:a,u=n.noteTextOffset,c=u===void 0?S5.noteTextOffset:u;if(SS(s))e=r+s;else{if(s.abs===void 0)throw new Error("noteX should be either a number or an object containing an 'abs' property");e=s.abs}if(SS(o))t=i+o;else{if(o.abs===void 0)throw new Error("noteY should be either a number or an object containing an 'abs' property");t=o.abs}var h=r,d=i,f=Gwe(r,i,e,t);if(Ad(n)){var m=P0e(Rd(f),n.size/2);h+=m.x,d+=m.y}if(xd(n)){var p=Math.round((f+90)/45)%8;p===0&&(d-=n.height/2),p===1&&(h+=n.width/2,d-=n.height/2),p===2&&(h+=n.width/2),p===3&&(h+=n.width/2,d+=n.height/2),p===4&&(d+=n.height/2),p===5&&(h-=n.width/2,d+=n.height/2),p===6&&(h-=n.width/2),p===7&&(h-=n.width/2,d-=n.height/2)}var y=e,C=e;return(f+90)%360>180?(y-=l,C-=l):C+=l,{points:[[h,d],[e,t],[C,t]],text:[y,t-c],angle:f+90}},LD=function(n){var e=n.data,t=n.annotations,r=n.getPosition,i=n.getDimensions;return ie.exports.useMemo(function(){return Wwe({data:e,annotations:t,getPosition:r,getDimensions:i})},[e,t,r,i])},zwe=function(n){var e=n.annotations;return ie.exports.useMemo(function(){return e.map(function(t){return Ws({},t,{computed:_D(Ws({},t))})})},[e])},Ywe=function(n){return ie.exports.useMemo(function(){return _D(n)},[n])},jwe=function(n){var e=n.datum,t=n.x,r=n.y,i=n.note,s=rn(),o=Bi(),a=o.animate,l=o.config,u=Ks({x:t,y:r,config:l,immediate:!a});return typeof i=="function"?ie.exports.createElement(i,{x:t,y:r,datum:e}):ce.jsxs(ce.Fragment,{children:[s.annotations.text.outlineWidth>0&&ce.jsx(Tn.text,{x:u.x,y:u.y,style:Ws({},s.annotations.text,{strokeLinejoin:"round",strokeWidth:2*s.annotations.text.outlineWidth,stroke:s.annotations.text.outlineColor}),children:i}),ce.jsx(Tn.text,{x:u.x,y:u.y,style:OD(s.annotations.text,["outlineWidth","outlineColor"]),children:i})]})},z3=function(n){var e=n.points,t=n.isOutline,r=t!==void 0&&t,i=rn(),s=ie.exports.useMemo(function(){var l=e[0];return e.slice(1).reduce(function(u,c){return u+" L"+c[0]+","+c[1]},"M"+l[0]+","+l[1])},[e]),o=dS(s);if(r&&i.annotations.link.outlineWidth<=0)return null;var a=Ws({},i.annotations.link);return r&&(a.strokeLinecap="square",a.strokeWidth=i.annotations.link.strokeWidth+2*i.annotations.link.outlineWidth,a.stroke=i.annotations.link.outlineColor,a.opacity=i.annotations.link.outlineOpacity),ce.jsx(Tn.path,{fill:"none",d:o,style:a})},Kwe=function(n){var e=n.x,t=n.y,r=n.size,i=rn(),s=Bi(),o=s.animate,a=s.config,l=Ks({x:e,y:t,radius:r/2,config:a,immediate:!o});return ce.jsxs(ce.Fragment,{children:[i.annotations.outline.outlineWidth>0&&ce.jsx(Tn.circle,{cx:l.x,cy:l.y,r:l.radius,style:Ws({},i.annotations.outline,{fill:"none",strokeWidth:i.annotations.outline.strokeWidth+2*i.annotations.outline.outlineWidth,stroke:i.annotations.outline.outlineColor,opacity:i.annotations.outline.outlineOpacity})}),ce.jsx(Tn.circle,{cx:l.x,cy:l.y,r:l.radius,style:i.annotations.outline})]})},qwe=function(n){var e=n.x,t=n.y,r=n.size,i=r===void 0?S5.dotSize:r,s=rn(),o=Bi(),a=o.animate,l=o.config,u=Ks({x:e,y:t,radius:i/2,config:l,immediate:!a});return ce.jsxs(ce.Fragment,{children:[s.annotations.outline.outlineWidth>0&&ce.jsx(Tn.circle,{cx:u.x,cy:u.y,r:u.radius,style:Ws({},s.annotations.outline,{fill:"none",strokeWidth:2*s.annotations.outline.outlineWidth,stroke:s.annotations.outline.outlineColor,opacity:s.annotations.outline.outlineOpacity})}),ce.jsx(Tn.circle,{cx:u.x,cy:u.y,r:u.radius,style:s.annotations.symbol})]})},Xwe=function(n){var e=n.x,t=n.y,r=n.width,i=n.height,s=n.borderRadius,o=s===void 0?6:s,a=rn(),l=Bi(),u=l.animate,c=l.config,h=Ks({x:e-r/2,y:t-i/2,width:r,height:i,config:c,immediate:!u});return ce.jsxs(ce.Fragment,{children:[a.annotations.outline.outlineWidth>0&&ce.jsx(Tn.rect,{x:h.x,y:h.y,rx:o,ry:o,width:h.width,height:h.height,style:Ws({},a.annotations.outline,{fill:"none",strokeWidth:a.annotations.outline.strokeWidth+2*a.annotations.outline.outlineWidth,stroke:a.annotations.outline.outlineColor,opacity:a.annotations.outline.outlineOpacity})}),ce.jsx(Tn.rect,{x:h.x,y:h.y,rx:o,ry:o,width:h.width,height:h.height,style:a.annotations.outline})]})},Qwe=function(n){var e=n.datum,t=n.x,r=n.y,i=n.note,s=Ywe(n);if(!Vwe(i))throw new Error("note should be a valid react element");return ce.jsxs(ce.Fragment,{children:[ce.jsx(z3,{points:s.points,isOutline:!0}),Ad(n)&&ce.jsx(Kwe,{x:t,y:r,size:n.size}),R5(n)&&ce.jsx(qwe,{x:t,y:r,size:n.size}),xd(n)&&ce.jsx(Xwe,{x:t,y:r,width:n.width,height:n.height,borderRadius:n.borderRadius}),ce.jsx(z3,{points:s.points}),ce.jsx(jwe,{datum:e,x:s.text[0],y:s.text[1],note:i})]})},Y3=function(n,e){e.forEach(function(t,r){var i=t[0],s=t[1];r===0?n.moveTo(i,s):n.lineTo(i,s)})},Zwe=function(n,e){var t=e.annotations,r=e.theme;t.length!==0&&(n.save(),t.forEach(function(i){if(!$we(i.note))throw new Error("note is invalid for canvas implementation");r.annotations.link.outlineWidth>0&&(n.lineCap="square",n.strokeStyle=r.annotations.link.outlineColor,n.lineWidth=r.annotations.link.strokeWidth+2*r.annotations.link.outlineWidth,n.beginPath(),Y3(n,i.computed.points),n.stroke(),n.lineCap="butt"),Ad(i)&&r.annotations.outline.outlineWidth>0&&(n.strokeStyle=r.annotations.outline.outlineColor,n.lineWidth=r.annotations.outline.strokeWidth+2*r.annotations.outline.outlineWidth,n.beginPath(),n.arc(i.x,i.y,i.size/2,0,2*Math.PI),n.stroke()),R5(i)&&r.annotations.symbol.outlineWidth>0&&(n.strokeStyle=r.annotations.symbol.outlineColor,n.lineWidth=2*r.annotations.symbol.outlineWidth,n.beginPath(),n.arc(i.x,i.y,i.size/2,0,2*Math.PI),n.stroke()),xd(i)&&r.annotations.outline.outlineWidth>0&&(n.strokeStyle=r.annotations.outline.outlineColor,n.lineWidth=r.annotations.outline.strokeWidth+2*r.annotations.outline.outlineWidth,n.beginPath(),n.rect(i.x-i.width/2,i.y-i.height/2,i.width,i.height),n.stroke()),n.strokeStyle=r.annotations.link.stroke,n.lineWidth=r.annotations.link.strokeWidth,n.beginPath(),Y3(n,i.computed.points),n.stroke(),Ad(i)&&(n.strokeStyle=r.annotations.outline.stroke,n.lineWidth=r.annotations.outline.strokeWidth,n.beginPath(),n.arc(i.x,i.y,i.size/2,0,2*Math.PI),n.stroke()),R5(i)&&(n.fillStyle=r.annotations.symbol.fill,n.beginPath(),n.arc(i.x,i.y,i.size/2,0,2*Math.PI),n.fill()),xd(i)&&(n.strokeStyle=r.annotations.outline.stroke,n.lineWidth=r.annotations.outline.strokeWidth,n.beginPath(),n.rect(i.x-i.width/2,i.y-i.height/2,i.width,i.height),n.stroke()),typeof i.note=="function"?i.note(n,{datum:i.datum,x:i.computed.text[0],y:i.computed.text[1],theme:r}):(n.font=r.annotations.text.fontSize+"px "+r.annotations.text.fontFamily,n.textAlign="left",n.textBaseline="alphabetic",n.fillStyle=r.annotations.text.fill,n.strokeStyle=r.annotations.text.outlineColor,n.lineWidth=2*r.annotations.text.outlineWidth,r.annotations.text.outlineWidth>0&&(n.lineJoin="round",n.strokeText(i.note,i.computed.text[0],i.computed.text[1]),n.lineJoin="miter"),n.fillText(i.note,i.computed.text[0],i.computed.text[1]))}),n.restore())};function bg(){return bg=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},bg.apply(this,arguments)}function j3(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Jwe(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t)return(t=t.call(n)).next.bind(t);if(Array.isArray(n)||(t=function(i,s){if(i){if(typeof i=="string")return j3(i,s);var o=Object.prototype.toString.call(i).slice(8,-1);return o==="Object"&&i.constructor&&(o=i.constructor.name),o==="Map"||o==="Set"?Array.from(i):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?j3(i,s):void 0}}(n))||e&&n&&typeof n.length=="number"){t&&(n=t);var r=0;return function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var PD={nivo:["#e8c1a0","#f47560","#f1e15b","#e8a838","#61cdbb","#97e3d5"],category10:rP,accent:iP,dark2:sP,paired:oP,pastel1:aP,pastel2:lP,set1:uP,set2:cP,set3:nS},e5e=Object.keys(PD),DD={brown_blueGreen:n0,purpleRed_green:r0,pink_yellowGreen:i0,purple_orange:s0,red_blue:o0,red_grey:a0,red_yellow_blue:l0,red_yellow_green:u0,spectral:c0},t5e=Object.keys(DD),n5e={brown_blueGreen:nge,purpleRed_green:rge,pink_yellowGreen:ige,purple_orange:sge,red_blue:oge,red_grey:age,red_yellow_blue:lge,red_yellow_green:uge,spectral:cge},kD={blues:S0,greens:R0,greys:T0,oranges:M0,purples:A0,reds:x0,blue_green:h0,blue_purple:d0,green_blue:f0,orange_red:m0,purple_blue_green:p0,purple_blue:g0,purple_red:y0,red_purple:w0,yellow_green_blue:v0,yellow_green:C0,yellow_orange_brown:E0,yellow_orange_red:b0},r5e=Object.keys(kD),i5e={blues:Sge,greens:Rge,greys:Tge,oranges:Mge,purples:Age,reds:xge,turbo:Fge,viridis:Hge,inferno:Bge,magma:Uge,plasma:Vge,cividis:Nge,warm:Oge,cool:_ge,cubehelixDefault:Ige,blue_green:hge,blue_purple:dge,green_blue:fge,orange_red:mge,purple_blue_green:pge,purple_blue:gge,purple_red:yge,red_purple:wge,yellow_green_blue:vge,yellow_green:Cge,yellow_orange_brown:Ege,yellow_orange_red:bge},tp=bg({},PD,DD,kD),s5e=Object.keys(tp),o5e=function(n){return e5e.includes(n)},a5e=function(n){return t5e.includes(n)},l5e=function(n){return r5e.includes(n)},u5e={rainbow:Lge,sinebow:kge};bg({},n5e,i5e,u5e);var c5e=function(n,e){if(typeof n=="function")return n;if(tf(n)){if(function(l){return l.theme!==void 0}(n)){if(e===void 0)throw new Error("Unable to use color from theme as no theme was provided");var t=Ni(e,n.theme);if(t===void 0)throw new Error("Color from theme is undefined at path: '"+n.theme+"'");return function(){return t}}if(function(l){return l.from!==void 0}(n)){var r=function(l){return Ni(l,n.from)};if(Array.isArray(n.modifiers)){for(var i,s=[],o=function(){var l=i.value,u=l[0],c=l[1];if(u==="brighter")s.push(function(h){return h.brighter(c)});else if(u==="darker")s.push(function(h){return h.darker(c)});else{if(u!=="opacity")throw new Error("Invalid color modifier: '"+u+"', must be one of: 'brighter', 'darker', 'opacity'");s.push(function(h){return h.opacity=c,h})}},a=Jwe(n.modifiers);!(i=a()).done;)o();return s.length===0?r:function(l){return s.reduce(function(u,c){return c(u)},sc(r(l))).toString()}}return r}throw new Error("Invalid color spec, you should either specify 'theme' or 'from' when using a config object")}return function(){return n}},dc=function(n,e){return ie.exports.useMemo(function(){return c5e(n,e)},[n,e])},h5e=M.exports.oneOfType([M.exports.func,M.exports.arrayOf(M.exports.string),M.exports.shape({scheme:M.exports.oneOf(s5e).isRequired,size:M.exports.number}),M.exports.shape({datum:M.exports.string.isRequired}),M.exports.string]);M.exports.oneOfType([M.exports.string,M.exports.func,M.exports.shape({theme:M.exports.string.isRequired}),M.exports.shape({from:M.exports.string.isRequired,modifiers:M.exports.arrayOf(M.exports.array)})]);var d5e=function(n,e){if(typeof n=="function")return n;var t=typeof e=="function"?e:function(h){return Ni(h,e)};if(Array.isArray(n)){var r=Qa(n),i=function(h){return r(t(h))};return i.scale=r,i}if(tf(n)){if(function(h){return h.datum!==void 0}(n))return function(h){return Ni(h,n.datum)};if(function(h){return h.scheme!==void 0}(n)){if(o5e(n.scheme)){var s=Qa(tp[n.scheme]),o=function(h){return s(t(h))};return o.scale=s,o}if(a5e(n.scheme)){if(n.size!==void 0&&(n.size<3||n.size>11))throw new Error("Invalid size '"+n.size+"' for diverging color scheme '"+n.scheme+"', must be between 3~11");var a=Qa(tp[n.scheme][n.size||11]),l=function(h){return a(t(h))};return l.scale=a,l}if(l5e(n.scheme)){if(n.size!==void 0&&(n.size<3||n.size>9))throw new Error("Invalid size '"+n.size+"' for sequential color scheme '"+n.scheme+"', must be between 3~9");var u=Qa(tp[n.scheme][n.size||9]),c=function(h){return u(t(h))};return c.scale=u,c}}throw new Error("Invalid colors, when using an object, you should either pass a 'datum' or a 'scheme' property")}return function(){return n}},FD=function(n,e){return ie.exports.useMemo(function(){return d5e(n,e)},[n,e])},f5e=function(n){var e=n.x,t=n.y,r=n.size,i=n.fill,s=n.opacity,o=s===void 0?1:s,a=n.borderWidth,l=a===void 0?0:a,u=n.borderColor;return ce.jsx("circle",{r:r/2,cx:e+r/2,cy:t+r/2,fill:i,opacity:o,strokeWidth:l,stroke:u===void 0?"transparent":u,style:{pointerEvents:"none"}})},m5e=function(n){var e=n.x,t=n.y,r=n.size,i=n.fill,s=n.opacity,o=s===void 0?1:s,a=n.borderWidth,l=a===void 0?0:a,u=n.borderColor;return ce.jsx("g",{transform:"translate("+e+","+t+")",children:ce.jsx("path",{d:`
                    M`+r/2+` 0
                    L`+.8*r+" "+r/2+`
                    L`+r/2+" "+r+`
                    L`+.2*r+" "+r/2+`
                    L`+r/2+` 0
                `,fill:i,opacity:o,strokeWidth:l,stroke:u===void 0?"transparent":u,style:{pointerEvents:"none"}})})},p5e=function(n){var e=n.x,t=n.y,r=n.size,i=n.fill,s=n.opacity,o=s===void 0?1:s,a=n.borderWidth,l=a===void 0?0:a,u=n.borderColor;return ce.jsx("rect",{x:e,y:t,fill:i,opacity:o,strokeWidth:l,stroke:u===void 0?"transparent":u,width:r,height:r,style:{pointerEvents:"none"}})},g5e=function(n){var e=n.x,t=n.y,r=n.size,i=n.fill,s=n.opacity,o=s===void 0?1:s,a=n.borderWidth,l=a===void 0?0:a,u=n.borderColor;return ce.jsx("g",{transform:"translate("+e+","+t+")",children:ce.jsx("path",{d:`
                M`+r/2+` 0
                L`+r+" "+r+`
                L0 `+r+`
                L`+r/2+` 0
            `,fill:i,opacity:o,strokeWidth:l,stroke:u===void 0?"transparent":u,style:{pointerEvents:"none"}})})};function Za(){return Za=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Za.apply(this,arguments)}var y5e={top:0,right:0,bottom:0,left:0},yS=function(n){var e,t=n.direction,r=n.itemsSpacing,i=n.padding,s=n.itemCount,o=n.itemWidth,a=n.itemHeight;if(typeof i!="number"&&(typeof(e=i)!="object"||Array.isArray(e)||e===null))throw new Error("Invalid property padding, must be one of: number, object");var l=typeof i=="number"?{top:i,right:i,bottom:i,left:i}:Za({},y5e,i),u=l.left+l.right,c=l.top+l.bottom,h=o+u,d=a+c,f=(s-1)*r;return t==="row"?h=o*s+f+u:t==="column"&&(d=a*s+f+c),{width:h,height:d,padding:l}},HD=function(n){var e=n.anchor,t=n.translateX,r=n.translateY,i=n.containerWidth,s=n.containerHeight,o=n.width,a=n.height,l=t,u=r;switch(e){case"top":l+=(i-o)/2;break;case"top-right":l+=i-o;break;case"right":l+=i-o,u+=(s-a)/2;break;case"bottom-right":l+=i-o,u+=s-a;break;case"bottom":l+=(i-o)/2,u+=s-a;break;case"bottom-left":u+=s-a;break;case"left":u+=(s-a)/2;break;case"center":l+=(i-o)/2,u+=(s-a)/2}return{x:l,y:u}},UD=function(n){var e,t,r,i,s,o,a=n.direction,l=n.justify,u=n.symbolSize,c=n.symbolSpacing,h=n.width,d=n.height;switch(a){case"left-to-right":e=0,t=(d-u)/2,i=d/2,o="central",l?(r=h,s="end"):(r=u+c,s="start");break;case"right-to-left":e=h-u,t=(d-u)/2,i=d/2,o="central",l?(r=0,s="start"):(r=h-u-c,s="end");break;case"top-to-bottom":e=(h-u)/2,t=0,r=h/2,s="middle",l?(i=d,o="alphabetic"):(i=u+c,o="text-before-edge");break;case"bottom-to-top":e=(h-u)/2,t=d-u,r=h/2,s="middle",l?(i=0,o="text-before-edge"):(i=d-u-c,o="alphabetic")}return{symbolX:e,symbolY:t,labelX:r,labelY:i,labelAnchor:s,labelAlignment:o}},w5e={circle:f5e,diamond:m5e,square:p5e,triangle:g5e},v5e=function(n){var e,t,r,i,s,o,a,l,u,c,h,d=n.x,f=n.y,m=n.width,p=n.height,y=n.data,C=n.direction,b=C===void 0?"left-to-right":C,v=n.justify,S=v!==void 0&&v,L=n.textColor,_=n.background,P=_===void 0?"transparent":_,x=n.opacity,I=x===void 0?1:x,R=n.symbolShape,N=R===void 0?"square":R,H=n.symbolSize,K=H===void 0?16:H,X=n.symbolSpacing,J=X===void 0?8:X,ue=n.symbolBorderWidth,se=ue===void 0?0:ue,O=n.symbolBorderColor,g=O===void 0?"transparent":O,E=n.onClick,A=n.onMouseEnter,U=n.onMouseLeave,G=n.toggleSerie,V=n.effects,oe=ie.exports.useState({}),j=oe[0],ye=oe[1],ee=rn(),T=ie.exports.useCallback(function(k){if(V){var B=V.filter(function(z){return z.on==="hover"}).reduce(function(z,de){return Za({},z,de.style)},{});ye(B)}A==null||A(y,k)},[A,y,V]),F=ie.exports.useCallback(function(k){if(V){var B=V.filter(function(z){return z.on!=="hover"}).reduce(function(z,de){return Za({},z,de.style)},{});ye(B)}U==null||U(y,k)},[U,y,V]),Y=UD({direction:b,justify:S,symbolSize:(e=j.symbolSize)!=null?e:K,symbolSpacing:J,width:m,height:p}),q=Y.symbolX,me=Y.symbolY,Z=Y.labelX,Ce=Y.labelY,Re=Y.labelAnchor,Ee=Y.labelAlignment,Me=[E,A,U,G].some(function(k){return k!==void 0}),Te=typeof N=="function"?N:w5e[N];return ce.jsxs("g",{transform:"translate("+d+","+f+")",style:{opacity:(t=j.itemOpacity)!=null?t:I},children:[ce.jsx("rect",{width:m,height:p,fill:(r=j.itemBackground)!=null?r:P,style:{cursor:Me?"pointer":"auto"},onClick:function(k){E==null||E(y,k),G==null||G(y.id)},onMouseEnter:T,onMouseLeave:F}),ie.exports.createElement(Te,Za({id:y.id,x:q,y:me,size:(i=j.symbolSize)!=null?i:K,fill:(s=(o=y.fill)!=null?o:y.color)!=null?s:"black",borderWidth:(a=j.symbolBorderWidth)!=null?a:se,borderColor:(l=j.symbolBorderColor)!=null?l:g},y.hidden?ee.legends.hidden.symbol:void 0)),ce.jsx("text",{textAnchor:Re,style:Za({},ee.legends.text,{fill:(u=(c=(h=j.itemTextColor)!=null?h:L)!=null?c:ee.legends.text.fill)!=null?u:"black",dominantBaseline:Ee,pointerEvents:"none",userSelect:"none"},y.hidden?ee.legends.hidden.text:void 0),x:Z,y:Ce,children:y.label})]})},C5e=function(n){var e=n.data,t=n.x,r=n.y,i=n.direction,s=n.padding,o=s===void 0?0:s,a=n.justify,l=n.effects,u=n.itemWidth,c=n.itemHeight,h=n.itemDirection,d=h===void 0?"left-to-right":h,f=n.itemsSpacing,m=f===void 0?0:f,p=n.itemTextColor,y=n.itemBackground,C=y===void 0?"transparent":y,b=n.itemOpacity,v=b===void 0?1:b,S=n.symbolShape,L=n.symbolSize,_=n.symbolSpacing,P=n.symbolBorderWidth,x=n.symbolBorderColor,I=n.onClick,R=n.onMouseEnter,N=n.onMouseLeave,H=n.toggleSerie,K=yS({itemCount:e.length,itemWidth:u,itemHeight:c,itemsSpacing:m,direction:i,padding:o}).padding,X=i==="row"?u+m:0,J=i==="column"?c+m:0;return ce.jsx("g",{transform:"translate("+t+","+r+")",children:e.map(function(ue,se){return ce.jsx(v5e,{data:ue,x:se*X+K.left,y:se*J+K.top,width:u,height:c,direction:d,justify:a,effects:l,textColor:p,background:C,opacity:v,symbolShape:S,symbolSize:L,symbolSpacing:_,symbolBorderWidth:P,symbolBorderColor:x,onClick:I,onMouseEnter:R,onMouseLeave:N,toggleSerie:H},se)})})},BD=function(n){var e=n.data,t=n.containerWidth,r=n.containerHeight,i=n.translateX,s=i===void 0?0:i,o=n.translateY,a=o===void 0?0:o,l=n.anchor,u=n.direction,c=n.padding,h=c===void 0?0:c,d=n.justify,f=n.itemsSpacing,m=f===void 0?0:f,p=n.itemWidth,y=n.itemHeight,C=n.itemDirection,b=n.itemTextColor,v=n.itemBackground,S=n.itemOpacity,L=n.symbolShape,_=n.symbolSize,P=n.symbolSpacing,x=n.symbolBorderWidth,I=n.symbolBorderColor,R=n.onClick,N=n.onMouseEnter,H=n.onMouseLeave,K=n.toggleSerie,X=n.effects,J=yS({itemCount:e.length,itemsSpacing:m,itemWidth:p,itemHeight:y,direction:u,padding:h}),ue=J.width,se=J.height,O=HD({anchor:l,translateX:s,translateY:a,containerWidth:t,containerHeight:r,width:ue,height:se}),g=O.x,E=O.y;return ce.jsx(C5e,{data:e,x:g,y:E,direction:u,padding:h,justify:d,effects:X,itemsSpacing:m,itemWidth:p,itemHeight:y,itemDirection:C,itemTextColor:b,itemBackground:v,itemOpacity:S,symbolShape:L,symbolSize:_,symbolSpacing:P,symbolBorderWidth:x,symbolBorderColor:I,onClick:R,onMouseEnter:N,onMouseLeave:H,toggleSerie:typeof K=="boolean"?void 0:K})},E5e={start:"left",middle:"center",end:"right"},VD=function(n,e){var t=e.data,r=e.containerWidth,i=e.containerHeight,s=e.translateX,o=s===void 0?0:s,a=e.translateY,l=a===void 0?0:a,u=e.anchor,c=e.direction,h=e.padding,d=h===void 0?0:h,f=e.justify,m=f!==void 0&&f,p=e.itemsSpacing,y=p===void 0?0:p,C=e.itemWidth,b=e.itemHeight,v=e.itemDirection,S=v===void 0?"left-to-right":v,L=e.itemTextColor,_=e.symbolSize,P=_===void 0?16:_,x=e.symbolSpacing,I=x===void 0?8:x,R=e.theme,N=yS({itemCount:t.length,itemWidth:C,itemHeight:b,itemsSpacing:y,direction:c,padding:d}),H=N.width,K=N.height,X=N.padding,J=HD({anchor:u,translateX:o,translateY:l,containerWidth:r,containerHeight:i,width:H,height:K}),ue=J.x,se=J.y,O=c==="row"?C+y:0,g=c==="column"?b+y:0;n.save(),n.translate(ue,se),n.font=R.legends.text.fontSize+"px "+(R.legends.text.fontFamily||"sans-serif"),t.forEach(function(E,A){var U,G,V=A*O+X.left,oe=A*g+X.top,j=UD({direction:S,justify:m,symbolSize:P,symbolSpacing:I,width:C,height:b}),ye=j.symbolX,ee=j.symbolY,T=j.labelX,F=j.labelY,Y=j.labelAnchor,q=j.labelAlignment;n.fillStyle=(U=E.color)!=null?U:"black",n.fillRect(V+ye,oe+ee,P,P),n.textAlign=E5e[Y],q==="central"&&(n.textBaseline="middle"),n.fillStyle=(G=L!=null?L:R.legends.text.fill)!=null?G:"black",n.fillText(String(E.label),V+T,oe+F)}),n.restore()},b5e={data:M.exports.arrayOf(M.exports.object),anchor:M.exports.oneOf(["top","top-right","right","bottom-right","bottom","bottom-left","left","top-left","center"]).isRequired,translateX:M.exports.number,translateY:M.exports.number,direction:M.exports.oneOf(["row","column"]).isRequired,itemsSpacing:M.exports.number,itemWidth:M.exports.number.isRequired,itemHeight:M.exports.number.isRequired,itemDirection:M.exports.oneOf(["left-to-right","right-to-left","top-to-bottom","bottom-to-top"]),itemTextColor:M.exports.string,itemBackground:M.exports.string,itemOpacity:M.exports.number,symbolShape:M.exports.oneOfType([M.exports.oneOf(["circle","diamond","square","triangle"]),M.exports.func]),symbolSize:M.exports.number,symbolSpacing:M.exports.number,symbolBorderWidth:M.exports.number,symbolBorderColor:M.exports.string,onClick:M.exports.func,onMouseEnter:M.exports.func,onMouseLeave:M.exports.func,effects:M.exports.arrayOf(M.exports.shape({on:M.exports.oneOfType([M.exports.oneOf(["hover"])]).isRequired,style:M.exports.shape({itemTextColor:M.exports.string,itemBackground:M.exports.string,itemOpacity:M.exports.number,symbolSize:M.exports.number,symbolBorderWidth:M.exports.number,symbolBorderColor:M.exports.string}).isRequired}))};function Wt(){return Wt=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Wt.apply(this,arguments)}function Mc(n,e){if(n==null)return{};var t,r,i={},s=Object.keys(n);for(r=0;r<s.length;r++)t=s[r],e.indexOf(t)>=0||(i[t]=n[t]);return i}var K3,S5e=function(n){var e=n.bars,t=n.annotations,r=LD({data:e,annotations:t,getPosition:function(i){return{x:i.x+i.width/2,y:i.y+i.height/2}},getDimensions:function(i){var s=i.height,o=i.width;return{width:o,height:s,size:Math.max(o,s)}}});return ce.jsx(ce.Fragment,{children:r.map(function(i,s){return ce.jsx(Qwe,Wt({},i),s)})})},R5e=function(n){var e=n.width,t=n.height,r=n.legends,i=n.toggleSerie;return ce.jsx(ce.Fragment,{children:r.map(function(s,o){var a,l=s[0],u=s[1];return ce.jsx(BD,Wt({},l,{containerWidth:e,containerHeight:t,data:(a=l.data)!=null?a:u,toggleSerie:l.toggleSerie&&l.dataFrom==="keys"?i:void 0}),o)})})},T5e=["data"],A5e=function(n){var e,t=n.bar,r=t.data,i=Mc(t,T5e),s=n.style,o=s.borderColor,a=s.color,l=s.height,u=s.labelColor,c=s.labelOpacity,h=s.labelX,d=s.labelY,f=s.transform,m=s.width,p=n.borderRadius,y=n.borderWidth,C=n.label,b=n.shouldRenderLabel,v=n.isInteractive,S=n.onClick,L=n.onMouseEnter,_=n.onMouseLeave,P=n.tooltip,x=n.isFocusable,I=n.ariaLabel,R=n.ariaLabelledBy,N=n.ariaDescribedBy,H=rn(),K=ef(),X=K.showTooltipFromEvent,J=K.showTooltipAt,ue=K.hideTooltip,se=ie.exports.useMemo(function(){return function(){return ie.exports.createElement(P,Wt({},i,r))}},[P,i,r]),O=ie.exports.useCallback(function(V){S==null||S(Wt({color:i.color},r),V)},[i,r,S]),g=ie.exports.useCallback(function(V){return X(se(),V)},[X,se]),E=ie.exports.useCallback(function(V){L==null||L(r,V),X(se(),V)},[r,L,X,se]),A=ie.exports.useCallback(function(V){_==null||_(r,V),ue()},[r,ue,_]),U=ie.exports.useCallback(function(){J(se(),[i.absX+i.width/2,i.absY])},[J,se,i]),G=ie.exports.useCallback(function(){ue()},[ue]);return ce.jsxs(Tn.g,{transform:f,children:[ce.jsx(Tn.rect,{width:t5(m,function(V){return Math.max(V,0)}),height:t5(l,function(V){return Math.max(V,0)}),rx:p,ry:p,fill:(e=r.fill)!=null?e:a,strokeWidth:y,stroke:o,focusable:x,tabIndex:x?0:void 0,"aria-label":I?I(r):void 0,"aria-labelledby":R?R(r):void 0,"aria-describedby":N?N(r):void 0,onMouseEnter:v?E:void 0,onMouseMove:v?g:void 0,onMouseLeave:v?A:void 0,onClick:v?O:void 0,onFocus:v&&x?U:void 0,onBlur:v&&x?G:void 0}),b&&ce.jsx(Tn.text,{x:h,y:d,textAnchor:"middle",dominantBaseline:"central",fillOpacity:c,style:Wt({},H.labels.text,{pointerEvents:"none",fill:u}),children:C})]})},x5e=["color","label"],en={indexBy:"id",keys:["value"],groupMode:"stacked",layout:"vertical",reverse:!1,minValue:"auto",maxValue:"auto",valueScale:{type:"linear"},indexScale:{type:"band",round:!0},padding:.1,innerPadding:0,axisBottom:{},axisLeft:{},enableGridX:!1,enableGridY:!0,enableLabel:!0,label:"formattedValue",labelSkipWidth:0,labelSkipHeight:0,labelTextColor:{from:"theme",theme:"labels.text.fill"},colorBy:"id",colors:{scheme:"nivo"},borderRadius:0,borderWidth:0,borderColor:{from:"color"},isInteractive:!0,tooltip:function(n){var e=n.color,t=n.label,r=Mc(n,x5e);return ce.jsx(iL,{id:t,value:r.formattedValue,enableChip:!0,color:e})},tooltipLabel:function(n){return n.id+" - "+n.indexValue},legends:[],initialHiddenIds:[],annotations:[],markers:[]},Cn=Wt({},en,{layers:["grid","axes","bars","markers","legends","annotations"],barComponent:A5e,defs:[],fill:[],animate:!0,motionConfig:"default",role:"img",isFocusable:!1}),$r=Wt({},en,{layers:["grid","axes","bars","legends","annotations"],pixelRatio:typeof window<"u"&&(K3=window.devicePixelRatio)!=null?K3:1}),$D=function(n,e,t,r,i,s){return Td(r,{all:n.map(e),min:0,max:0},i,s).padding(t)},WD=function(n,e){return n.map(function(t){return Wt({},e.reduce(function(r,i){return r[i]=null,r},{}),t)})},k0=function(n){return Object.keys(n).reduce(function(e,t){return n[t]&&(e[t]=n[t]),e},{})},F0=function(n){return[n,Number(n)]},M5e=["layout","minValue","maxValue","reverse","width","height","padding","innerPadding","valueScale","indexScale","hiddenIds"],wS=function(n,e){return n>e},GD=function(n,e){return n<e},zD=function(n,e){return Array.from(" ".repeat(e-n),function(t,r){return n+r})},N5e=function(n){return wS(n,0)?0:n},I5e=function(n,e,t,r){var i=n.data,s=n.formatValue,o=n.getColor,a=n.getIndex,l=n.getTooltipLabel,u=n.innerPadding,c=u===void 0?0:u,h=n.keys,d=n.xScale,f=n.yScale,m=n.margin,p=t?GD:wS,y=i.map(k0),C=[];return h.forEach(function(b,v){return zD(0,d.domain().length).forEach(function(S){var L,_,P,x=F0(i[S][b]),I=x[0],R=x[1],N=a(i[S]),H=((L=d(N))!=null?L:0)+e*v+c*v,K=p(_=R,0)?(P=f(_))!=null?P:0:r,X=function(ue,se){var O;return p(ue,0)?r-se:((O=f(ue))!=null?O:0)-r}(R,K),J={id:b,value:I===null?I:R,formattedValue:s(R),hidden:!1,index:S,indexValue:N,data:y[S]};C.push({key:b+"."+J.indexValue,index:C.length,data:J,x:H,y:K,absX:m.left+H,absY:m.top+K,width:e,height:X,color:o(J),label:l(J)})})}),C},O5e=function(n,e,t,r){var i=n.data,s=n.formatValue,o=n.getIndex,a=n.getColor,l=n.getTooltipLabel,u=n.keys,c=n.innerPadding,h=c===void 0?0:c,d=n.xScale,f=n.yScale,m=n.margin,p=t?GD:wS,y=i.map(k0),C=[];return u.forEach(function(b,v){return zD(0,f.domain().length).forEach(function(S){var L,_,P,x=F0(i[S][b]),I=x[0],R=x[1],N=o(i[S]),H=p(_=R,0)?r:(P=d(_))!=null?P:0,K=((L=f(N))!=null?L:0)+e*v+h*v,X=function(ue,se){var O;return p(ue,0)?((O=d(ue))!=null?O:0)-r:r-se}(R,H),J={id:b,value:I===null?I:R,formattedValue:s(R),hidden:!1,index:S,indexValue:N,data:y[S]};C.push({key:b+"."+J.indexValue,index:C.length,data:J,x:H,y:K,absX:m.left+H,absY:m.top+K,width:X,height:e,color:a(J),label:l(J)})})}),C},_5e=function(n){var e,t,r=n.layout,i=n.minValue,s=n.maxValue,o=n.reverse,a=n.width,l=n.height,u=n.padding,c=u===void 0?0:u,h=n.innerPadding,d=h===void 0?0:h,f=n.valueScale,m=n.indexScale,p=n.hiddenIds,y=p===void 0?[]:p,C=Mc(n,M5e),b=C.keys.filter(function(E){return!y.includes(E)}),v=WD(C.data,b),S=r==="vertical"?["y","x",a]:["x","y",l],L=S[0],_=S[1],P=S[2],x=$D(v,C.getIndex,c,m,P,_),I=Wt({max:s,min:i,reverse:o},f),R=I.min==="auto"?N5e:function(E){return E},N=v.reduce(function(E,A){return[].concat(E,b.map(function(U){return A[U]}))},[]).filter(Boolean),H=R(Math.min.apply(Math,N)),K=(t=Math.max.apply(Math,N),isFinite(t)?t:0),X=Td(I,{all:N,min:H,max:K},L==="x"?a:l,L),J=r==="vertical"?[x,X]:[X,x],ue=J[0],se=J[1],O=(x.bandwidth()-d*(b.length-1))/b.length,g=[Wt({},C,{data:v,keys:b,innerPadding:d,xScale:ue,yScale:se}),O,I.reverse,(e=X(0))!=null?e:0];return{xScale:ue,yScale:se,bars:O>0?r==="vertical"?I5e.apply(void 0,g):O5e.apply(void 0,g):[]}},L5e=["data","layout","minValue","maxValue","reverse","width","height","padding","valueScale","indexScale","hiddenIds"],P5e=function n(e){var t;return e.some(Array.isArray)?n((t=[]).concat.apply(t,e)):e},D5e=function(n,e,t){var r=n.formatValue,i=n.getColor,s=n.getIndex,o=n.getTooltipLabel,a=n.innerPadding,l=n.stackedData,u=n.xScale,c=n.yScale,h=n.margin,d=[];return l.forEach(function(f){return u.domain().forEach(function(m,p){var y,C,b=f[p],v=(y=u(s(b.data)))!=null?y:0,S=((C=function(R){return c(R[t?0:1])}(b))!=null?C:0)+.5*a,L=function(R,N){var H;return((H=c(R[t?1:0]))!=null?H:0)-N}(b,S)-a,_=F0(b.data[f.key]),P=_[0],x=_[1],I={id:f.key,value:P===null?P:x,formattedValue:r(x),hidden:!1,index:p,indexValue:m,data:k0(b.data)};d.push({key:f.key+"."+m,index:d.length,data:I,x:v,y:S,absX:h.left+v,absY:h.top+S,width:e,height:L,color:i(I),label:o(I)})})}),d},k5e=function(n,e,t){var r=n.formatValue,i=n.getColor,s=n.getIndex,o=n.getTooltipLabel,a=n.innerPadding,l=n.stackedData,u=n.xScale,c=n.yScale,h=n.margin,d=[];return l.forEach(function(f){return c.domain().forEach(function(m,p){var y,C,b=f[p],v=(y=c(s(b.data)))!=null?y:0,S=((C=function(R){return u(R[t?1:0])}(b))!=null?C:0)+.5*a,L=function(R,N){var H;return((H=u(R[t?0:1]))!=null?H:0)-N}(b,S)-a,_=F0(b.data[f.key]),P=_[0],x=_[1],I={id:f.key,value:P===null?P:x,formattedValue:r(x),hidden:!1,index:p,indexValue:m,data:k0(b.data)};d.push({key:f.key+"."+m,index:d.length,data:I,x:S,y:v,absX:h.left+S,absY:h.top+v,width:L,height:e,color:i(I),label:o(I)})})}),d},F5e=function(n){var e,t=n.data,r=n.layout,i=n.minValue,s=n.maxValue,o=n.reverse,a=n.width,l=n.height,u=n.padding,c=u===void 0?0:u,h=n.valueScale,d=n.indexScale,f=n.hiddenIds,m=f===void 0?[]:f,p=Mc(n,L5e),y=p.keys.filter(function(O){return!m.includes(O)}),C=E1e().keys(y).offset(AP)(WD(t,y)),b=r==="vertical"?["y","x",a]:["x","y",l],v=b[0],S=b[1],L=b[2],_=$D(t,p.getIndex,c,d,L,S),P=Wt({max:s,min:i,reverse:o},h),x=(e=P5e(C),h.type==="log"?e.filter(function(O){return O!==0}):e),I=Math.min.apply(Math,x),R=Math.max.apply(Math,x),N=Td(P,{all:x,min:I,max:R},v==="x"?a:l,v),H=r==="vertical"?[_,N]:[N,_],K=H[0],X=H[1],J=p.innerPadding>0?p.innerPadding:0,ue=_.bandwidth(),se=[Wt({},p,{innerPadding:J,stackedData:C,xScale:K,yScale:X}),ue,P.reverse];return{xScale:K,yScale:X,bars:ue>0?r==="vertical"?D5e.apply(void 0,se):k5e.apply(void 0,se):[]}},H5e=function(n){var e=n.bars,t=n.direction,r=n.from,i=n.groupMode,s=n.layout,o=n.legendLabel,a=n.reverse,l=YP(o!=null?o:r==="indexes"?"indexValue":"id");return r==="indexes"?function(u,c,h){var d=py(u.map(function(f){var m,p;return{id:(m=f.data.indexValue)!=null?m:"",label:h(f.data),hidden:f.data.hidden,color:(p=f.color)!=null?p:"#000"}}),function(f){return f.id});return c==="horizontal"&&d.reverse(),d}(e,s,l):function(u,c,h,d,f,m){var p=py(u.map(function(y){var C;return{id:y.data.id,label:m(y.data),hidden:y.data.hidden,color:(C=y.color)!=null?C:"#000"}}),function(y){return y.id});return(c==="vertical"&&d==="stacked"&&h==="column"&&f!==!0||c==="horizontal"&&d==="stacked"&&f===!0)&&p.reverse(),p}(e,s,t,i,a,l)},YD=function(n){var e=n.indexBy,t=e===void 0?en.indexBy:e,r=n.keys,i=r===void 0?en.keys:r,s=n.label,o=s===void 0?en.label:s,a=n.tooltipLabel,l=a===void 0?en.tooltipLabel:a,u=n.valueFormat,c=n.colors,h=c===void 0?en.colors:c,d=n.colorBy,f=d===void 0?en.colorBy:d,m=n.borderColor,p=m===void 0?en.borderColor:m,y=n.labelTextColor,C=y===void 0?en.labelTextColor:y,b=n.groupMode,v=b===void 0?en.groupMode:b,S=n.layout,L=S===void 0?en.layout:S,_=n.reverse,P=_===void 0?en.reverse:_,x=n.data,I=n.minValue,R=I===void 0?en.minValue:I,N=n.maxValue,H=N===void 0?en.maxValue:N,K=n.margin,X=n.width,J=n.height,ue=n.padding,se=ue===void 0?en.padding:ue,O=n.innerPadding,g=O===void 0?en.innerPadding:O,E=n.valueScale,A=E===void 0?en.valueScale:E,U=n.indexScale,G=U===void 0?en.indexScale:U,V=n.initialHiddenIds,oe=V===void 0?en.initialHiddenIds:V,j=n.enableLabel,ye=j===void 0?en.enableLabel:j,ee=n.labelSkipWidth,T=ee===void 0?en.labelSkipWidth:ee,F=n.labelSkipHeight,Y=F===void 0?en.labelSkipHeight:F,q=n.legends,me=q===void 0?en.legends:q,Z=n.legendLabel,Ce=ie.exports.useState(oe!=null?oe:[]),Re=Ce[0],Ee=Ce[1],Me=ie.exports.useCallback(function(Oe){Ee(function(Ye){return Ye.indexOf(Oe)>-1?Ye.filter(function(Xe){return Xe!==Oe}):[].concat(Ye,[Oe])})},[]),Te=ly(t),k=ly(o),B=ly(l),z=yg(u),de=rn(),ne=FD(h,f),fe=dc(p,de),le=dc(C,de),ae=(v==="grouped"?_5e:F5e)({layout:L,reverse:P,data:x,getIndex:Te,keys:i,minValue:R,maxValue:H,width:X,height:J,getColor:ne,padding:se,innerPadding:g,valueScale:A,indexScale:G,hiddenIds:Re,formatValue:z,getTooltipLabel:B,margin:K}),pe=ae.bars,te=ae.xScale,he=ae.yScale,Se=ie.exports.useMemo(function(){return pe.filter(function(Oe){return Oe.data.value!==null}).map(function(Oe,Ye){return Wt({},Oe,{index:Ye})})},[pe]),be=ie.exports.useCallback(function(Oe){var Ye=Oe.width,Xe=Oe.height;return!!ye&&!(T>0&&Ye<T)&&!(Y>0&&Xe<Y)},[ye,T,Y]),_e=ie.exports.useMemo(function(){return i.map(function(Oe){var Ye=pe.find(function(Xe){return Xe.data.id===Oe});return Wt({},Ye,{data:Wt({id:Oe},Ye==null?void 0:Ye.data,{hidden:Re.includes(Oe)})})})},[Re,i,pe]),$e=ie.exports.useMemo(function(){return me.map(function(Oe){return[Oe,H5e({bars:Oe.dataFrom==="keys"?_e:pe,direction:Oe.direction,from:Oe.dataFrom,groupMode:v,layout:L,legendLabel:Z,reverse:P})]})},[me,_e,pe,v,L,Z,P]);return{bars:pe,barsWithValue:Se,xScale:te,yScale:he,getIndex:Te,getLabel:k,getTooltipLabel:B,formatValue:z,getColor:ne,getBorderColor:fe,getLabelColor:le,shouldRenderBarLabel:be,hiddenIds:Re,toggleSerie:Me,legendsWithData:$e}},U5e=["isInteractive","animate","motionConfig","theme","renderWrapper"],B5e=function(n){var e=n.data,t=n.indexBy,r=n.keys,i=n.margin,s=n.width,o=n.height,a=n.groupMode,l=n.layout,u=n.reverse,c=n.minValue,h=n.maxValue,d=n.valueScale,f=n.indexScale,m=n.padding,p=n.innerPadding,y=n.axisTop,C=n.axisRight,b=n.axisBottom,v=b===void 0?Cn.axisBottom:b,S=n.axisLeft,L=S===void 0?Cn.axisLeft:S,_=n.enableGridX,P=_===void 0?Cn.enableGridX:_,x=n.enableGridY,I=x===void 0?Cn.enableGridY:x,R=n.gridXValues,N=n.gridYValues,H=n.layers,K=H===void 0?Cn.layers:H,X=n.barComponent,J=X===void 0?Cn.barComponent:X,ue=n.enableLabel,se=ue===void 0?Cn.enableLabel:ue,O=n.label,g=n.labelSkipWidth,E=g===void 0?Cn.labelSkipWidth:g,A=n.labelSkipHeight,U=A===void 0?Cn.labelSkipHeight:A,G=n.labelTextColor,V=n.markers,oe=V===void 0?Cn.markers:V,j=n.colorBy,ye=n.colors,ee=n.defs,T=ee===void 0?Cn.defs:ee,F=n.fill,Y=F===void 0?Cn.fill:F,q=n.borderRadius,me=q===void 0?Cn.borderRadius:q,Z=n.borderWidth,Ce=Z===void 0?Cn.borderWidth:Z,Re=n.borderColor,Ee=n.annotations,Me=Ee===void 0?Cn.annotations:Ee,Te=n.legendLabel,k=n.tooltipLabel,B=n.valueFormat,z=n.isInteractive,de=z===void 0?Cn.isInteractive:z,ne=n.tooltip,fe=ne===void 0?Cn.tooltip:ne,le=n.onClick,ae=n.onMouseEnter,pe=n.onMouseLeave,te=n.legends,he=n.role,Se=he===void 0?Cn.role:he,be=n.ariaLabel,_e=n.ariaLabelledBy,$e=n.ariaDescribedBy,Oe=n.isFocusable,Ye=Oe===void 0?Cn.isFocusable:Oe,Xe=n.barAriaLabel,ot=n.barAriaLabelledBy,wt=n.barAriaDescribedBy,Br=n.initialHiddenIds,Vn=Bi(),Ft=Vn.animate,Pt=Vn.config,Ln=P0(s,o,i),mn=Ln.outerWidth,Jt=Ln.outerHeight,xt=Ln.margin,Ar=Ln.innerWidth,gi=Ln.innerHeight,$n=YD({indexBy:t,label:O,tooltipLabel:k,valueFormat:B,colors:ye,colorBy:j,borderColor:Re,labelTextColor:G,groupMode:a,layout:l,reverse:u,data:e,keys:r,minValue:c,maxValue:h,margin:xt,width:Ar,height:gi,padding:m,innerPadding:p,valueScale:d,indexScale:f,enableLabel:se,labelSkipWidth:E,labelSkipHeight:U,legends:te,legendLabel:Te,initialHiddenIds:Br}),Vi=$n.bars,Nc=$n.barsWithValue,ar=$n.xScale,Qe=$n.yScale,mt=$n.getLabel,Dt=$n.getTooltipLabel,sn=$n.getBorderColor,Ct=$n.getLabelColor,pn=$n.shouldRenderBarLabel,Pn=$n.toggleSerie,gn=$n.legendsWithData,Fl=Fb(Nc,{keys:function(ve){return ve.key},from:function(ve){return Wt({borderColor:sn(ve),color:ve.color,height:0,labelColor:Ct(ve),labelOpacity:0,labelX:ve.width/2,labelY:ve.height/2,transform:"translate("+ve.x+", "+(ve.y+ve.height)+")",width:ve.width},l==="vertical"?{}:{height:ve.height,transform:"translate("+ve.x+", "+ve.y+")",width:0})},enter:function(ve){return{borderColor:sn(ve),color:ve.color,height:ve.height,labelColor:Ct(ve),labelOpacity:1,labelX:ve.width/2,labelY:ve.height/2,transform:"translate("+ve.x+", "+ve.y+")",width:ve.width}},update:function(ve){return{borderColor:sn(ve),color:ve.color,height:ve.height,labelColor:Ct(ve),labelOpacity:1,labelX:ve.width/2,labelY:ve.height/2,transform:"translate("+ve.x+", "+ve.y+")",width:ve.width}},leave:function(ve){return Wt({borderColor:sn(ve),color:ve.color,height:0,labelColor:Ct(ve),labelOpacity:0,labelX:ve.width/2,labelY:0,transform:"translate("+ve.x+", "+(ve.y+ve.height)+")",width:ve.width},l==="vertical"?{}:{labelX:0,labelY:ve.height/2,height:ve.height,transform:"translate("+ve.x+", "+ve.y+")",width:0})},config:Pt,immediate:!Ft}),qs=ie.exports.useMemo(function(){return{borderRadius:me,borderWidth:Ce,enableLabel:se,isInteractive:de,labelSkipWidth:E,labelSkipHeight:U,onClick:le,onMouseEnter:ae,onMouseLeave:pe,getTooltipLabel:Dt,tooltip:fe,isFocusable:Ye,ariaLabel:Xe,ariaLabelledBy:ot,ariaDescribedBy:wt}},[me,Ce,se,Dt,de,U,E,le,ae,pe,fe,Ye,Xe,ot,wt]),wa=KP(T,Vi,Y,{dataKey:"data",targetKey:"data.fill"}),Ve={annotations:null,axes:null,bars:null,grid:null,legends:null,markers:null};K.includes("annotations")&&(Ve.annotations=ce.jsx(S5e,{bars:Vi,annotations:Me},"annotations")),K.includes("axes")&&(Ve.axes=ce.jsx(SD,{xScale:ar,yScale:Qe,width:Ar,height:gi,top:y,right:C,bottom:v,left:L},"axes")),K.includes("bars")&&(Ve.bars=ce.jsx(ie.exports.Fragment,{children:Fl(function(ve,Ie){return ie.exports.createElement(J,Wt({},qs,{bar:Ie,style:ve,shouldRenderLabel:pn(Ie),label:mt(Ie.data)}))})},"bars")),K.includes("grid")&&(Ve.grid=ce.jsx(RD,{width:Ar,height:gi,xScale:P?ar:null,yScale:I?Qe:null,xValues:R,yValues:N},"grid")),K.includes("legends")&&(Ve.legends=ce.jsx(R5e,{width:Ar,height:gi,legends:gn,toggleSerie:Pn},"legends")),K.includes("markers")&&(Ve.markers=ce.jsx(GP,{markers:oe,width:Ar,height:gi,xScale:ar,yScale:Qe},"markers"));var ge=ie.exports.useMemo(function(){return Wt({},qs,{margin:xt,width:s,height:o,innerWidth:Ar,innerHeight:gi,bars:Vi,legendData:gn,enableLabel:se,xScale:ar,yScale:Qe,tooltip:fe,getTooltipLabel:Dt,onClick:le,onMouseEnter:ae,onMouseLeave:pe})},[qs,xt,s,o,Ar,gi,Vi,gn,se,ar,Qe,fe,Dt,le,ae,pe]);return ce.jsx(mS,{width:mn,height:Jt,margin:xt,defs:wa,role:Se,ariaLabel:be,ariaLabelledBy:_e,ariaDescribedBy:$e,isFocusable:Ye,children:K.map(function(ve,Ie){var Rt;return typeof ve=="function"?ce.jsx(ie.exports.Fragment,{children:ie.exports.createElement(ve,ge)},Ie):(Rt=Ve==null?void 0:Ve[ve])!=null?Rt:null})})},V5e=function(n){var e=n.isInteractive,t=e===void 0?Cn.isInteractive:e,r=n.animate,i=r===void 0?Cn.animate:r,s=n.motionConfig,o=s===void 0?Cn.motionConfig:s,a=n.theme,l=n.renderWrapper,u=Mc(n,U5e);return ce.jsx(D0,{animate:i,isInteractive:t,motionConfig:o,renderWrapper:l,theme:a,children:ce.jsx(B5e,Wt({isInteractive:t},u))})},$5e=["isInteractive","renderWrapper","theme"],hy=function(n,e,t,r){return n.find(function(i){return jP(i.x+e.left,i.y+e.top,i.width,i.height,t,r)})},W5e=function(n){var e=n.data,t=n.indexBy,r=n.keys,i=n.margin,s=n.width,o=n.height,a=n.groupMode,l=n.layout,u=n.reverse,c=n.minValue,h=n.maxValue,d=n.valueScale,f=n.indexScale,m=n.padding,p=n.innerPadding,y=n.axisTop,C=n.axisRight,b=n.axisBottom,v=b===void 0?$r.axisBottom:b,S=n.axisLeft,L=S===void 0?$r.axisLeft:S,_=n.enableGridX,P=_===void 0?$r.enableGridX:_,x=n.enableGridY,I=x===void 0?$r.enableGridY:x,R=n.gridXValues,N=n.gridYValues,H=n.layers,K=H===void 0?$r.layers:H,X=n.renderBar,J=X===void 0?function(Qe,mt){var Dt=mt.bar,sn=Dt.color,Ct=Dt.height,pn=Dt.width,Pn=Dt.x,gn=Dt.y,Fl=mt.borderColor,qs=mt.borderRadius,wa=mt.borderWidth,Ve=mt.label,ge=mt.labelColor,ve=mt.shouldRenderLabel;if(Qe.fillStyle=sn,wa>0&&(Qe.strokeStyle=Fl,Qe.lineWidth=wa),Qe.beginPath(),qs>0){var Ie=Math.min(qs,Ct);Qe.moveTo(Pn+Ie,gn),Qe.lineTo(Pn+pn-Ie,gn),Qe.quadraticCurveTo(Pn+pn,gn,Pn+pn,gn+Ie),Qe.lineTo(Pn+pn,gn+Ct-Ie),Qe.quadraticCurveTo(Pn+pn,gn+Ct,Pn+pn-Ie,gn+Ct),Qe.lineTo(Pn+Ie,gn+Ct),Qe.quadraticCurveTo(Pn,gn+Ct,Pn,gn+Ct-Ie),Qe.lineTo(Pn,gn+Ie),Qe.quadraticCurveTo(Pn,gn,Pn+Ie,gn),Qe.closePath()}else Qe.rect(Pn,gn,pn,Ct);Qe.fill(),wa>0&&Qe.stroke(),ve&&(Qe.textBaseline="middle",Qe.textAlign="center",Qe.fillStyle=ge,Qe.fillText(Ve,Pn+pn/2,gn+Ct/2))}:X,ue=n.enableLabel,se=ue===void 0?$r.enableLabel:ue,O=n.label,g=n.labelSkipWidth,E=g===void 0?$r.labelSkipWidth:g,A=n.labelSkipHeight,U=A===void 0?$r.labelSkipHeight:A,G=n.labelTextColor,V=n.colorBy,oe=n.colors,j=n.borderRadius,ye=j===void 0?$r.borderRadius:j,ee=n.borderWidth,T=ee===void 0?$r.borderWidth:ee,F=n.borderColor,Y=n.annotations,q=Y===void 0?$r.annotations:Y,me=n.legendLabel,Z=n.tooltipLabel,Ce=n.valueFormat,Re=n.isInteractive,Ee=Re===void 0?$r.isInteractive:Re,Me=n.tooltip,Te=Me===void 0?$r.tooltip:Me,k=n.onClick,B=n.onMouseEnter,z=n.onMouseLeave,de=n.legends,ne=n.pixelRatio,fe=ne===void 0?$r.pixelRatio:ne,le=n.canvasRef,ae=ie.exports.useRef(null),pe=rn(),te=P0(s,o,i),he=te.margin,Se=te.innerWidth,be=te.innerHeight,_e=te.outerWidth,$e=te.outerHeight,Oe=YD({indexBy:t,label:O,tooltipLabel:Z,valueFormat:Ce,colors:oe,colorBy:V,borderColor:F,labelTextColor:G,groupMode:a,layout:l,reverse:u,data:e,keys:r,minValue:c,maxValue:h,margin:he,width:Se,height:be,padding:m,innerPadding:p,valueScale:d,indexScale:f,enableLabel:se,labelSkipWidth:E,labelSkipHeight:U,legends:de,legendLabel:me}),Ye=Oe.bars,Xe=Oe.barsWithValue,ot=Oe.xScale,wt=Oe.yScale,Br=Oe.getLabel,Vn=Oe.getTooltipLabel,Ft=Oe.getBorderColor,Pt=Oe.getLabelColor,Ln=Oe.shouldRenderBarLabel,mn=Oe.legendsWithData,Jt=ef(),xt=Jt.showTooltipFromEvent,Ar=Jt.hideTooltip,gi=zwe({annotations:LD({data:Ye,annotations:q,getPosition:function(Qe){return{x:Qe.x,y:Qe.y}},getDimensions:function(Qe){var mt=Qe.width,Dt=Qe.height;return{width:mt,height:Dt,size:Math.max(mt,Dt)}}})}),$n=ie.exports.useMemo(function(){return{borderRadius:ye,borderWidth:T,isInteractive:Ee,isFocusable:!1,labelSkipWidth:E,labelSkipHeight:U,margin:he,width:s,height:o,innerWidth:Se,innerHeight:be,bars:Ye,legendData:mn,enableLabel:se,xScale:ot,yScale:wt,tooltip:Te,getTooltipLabel:Vn,onClick:k,onMouseEnter:B,onMouseLeave:z}},[ye,T,Ee,E,U,he,s,o,Se,be,Ye,mn,se,ot,wt,Te,Vn,k,B,z]);ie.exports.useEffect(function(){var Qe,mt=(Qe=ae.current)==null?void 0:Qe.getContext("2d");ae.current&&mt&&(ae.current.width=_e*fe,ae.current.height=$e*fe,mt.scale(fe,fe),mt.fillStyle=pe.background,mt.fillRect(0,0,_e,$e),mt.translate(he.left,he.top),K.forEach(function(Dt){Dt==="grid"?typeof pe.grid.line.strokeWidth=="number"&&pe.grid.line.strokeWidth>0&&(mt.lineWidth=pe.grid.line.strokeWidth,mt.strokeStyle=pe.grid.line.stroke,P&&Eg(mt,{width:s,height:o,scale:ot,axis:"x",values:R}),I&&Eg(mt,{width:s,height:o,scale:wt,axis:"y",values:N})):Dt==="axes"?TD(mt,{xScale:ot,yScale:wt,width:Se,height:be,top:y,right:C,bottom:v,left:L,theme:pe}):Dt==="bars"?Xe.forEach(function(sn){J(mt,{bar:sn,borderColor:Ft(sn),borderRadius:ye,borderWidth:T,label:Br(sn.data),labelColor:Pt(sn),shouldRenderLabel:Ln(sn)})}):Dt==="legends"?mn.forEach(function(sn){var Ct=sn[0],pn=sn[1];VD(mt,Wt({},Ct,{data:pn,containerWidth:Se,containerHeight:be,theme:pe}))}):Dt==="annotations"?Zwe(mt,{annotations:gi,theme:pe}):typeof Dt=="function"&&Dt(mt,$n)}),mt.save())},[v,L,C,y,Xe,ye,T,gi,P,I,Ft,Br,Pt,R,N,a,o,be,Se,$n,K,l,mn,he.left,he.top,$e,_e,fe,J,ot,wt,u,Ln,pe,s]);var Vi=ie.exports.useCallback(function(Qe){if(Ye&&ae.current){var mt=Fh(ae.current,Qe),Dt=mt[0],sn=mt[1],Ct=hy(Ye,he,Dt,sn);Ct!==void 0?(xt(ie.exports.createElement(Te,Wt({},Ct.data,{color:Ct.color,label:Ct.label,value:Number(Ct.data.value)})),Qe),Qe.type==="mouseenter"&&(B==null||B(Ct.data,Qe))):Ar()}},[Ar,he,B,Ye,xt,Te]),Nc=ie.exports.useCallback(function(Qe){if(Ye&&ae.current){Ar();var mt=Fh(ae.current,Qe),Dt=mt[0],sn=mt[1],Ct=hy(Ye,he,Dt,sn);Ct&&(z==null||z(Ct.data,Qe))}},[Ar,he,z,Ye]),ar=ie.exports.useCallback(function(Qe){if(Ye&&ae.current){var mt=Fh(ae.current,Qe),Dt=mt[0],sn=mt[1],Ct=hy(Ye,he,Dt,sn);Ct!==void 0&&(k==null||k(Wt({},Ct.data,{color:Ct.color}),Qe))}},[he,k,Ye]);return ce.jsx("canvas",{ref:function(Qe){ae.current=Qe,le&&"current"in le&&(le.current=Qe)},width:_e*fe,height:$e*fe,style:{width:_e,height:$e,cursor:Ee?"auto":"normal"},onMouseEnter:Ee?Vi:void 0,onMouseMove:Ee?Vi:void 0,onMouseLeave:Ee?Nc:void 0,onClick:Ee?ar:void 0})},G5e=ie.exports.forwardRef(function(n,e){var t=n.isInteractive,r=n.renderWrapper,i=n.theme,s=Mc(n,$5e);return ce.jsx(D0,{isInteractive:t,renderWrapper:r,theme:i,animate:!1,children:ce.jsx(W5e,Wt({},s,{canvasRef:e}))})}),z5e=function(n){return ce.jsx(rf,{children:function(e){var t=e.width,r=e.height;return ce.jsx(V5e,Wt({width:t,height:r},n))}})};ie.exports.forwardRef(function(n,e){return ce.jsx(rf,{children:function(t){var r=t.width,i=t.height;return ce.jsx(G5e,Wt({width:r,height:i},n,{ref:e}))}})});function Y5e(){const{startDate:n,endDate:e}=H1(),[t]=rs(O5),r=Us.exports.useLiveQuery(async()=>{const i=await fo.expenditure.where(Nt.datetime).between(n,e||1/0,!0,!0).toArray(),s=fd(await fo.recurring.toArray(),n,e),o=Or([...i,...s]).filter(u=>u.txn_type===Gn.CREDIT).groupBy(Nt.creditCard).mapValues(u=>u.reduce((c,h)=>c+Number(h.amount),0)).value(),a=[];return{chartData:Object.entries(o).reduce((u,c)=>{const[h,d]=c;return a.push(h),[...u,{source:h,[h]:d}]},[]),banks:Co.exports.uniq(a)}},[n,e]);return we.createElement(Gu,{sx:ck},we.createElement(yo,{variant:"h6"},"Spending by Card"),we.createElement(z5e,{data:(r==null?void 0:r.chartData)||[],indexBy:"source",keys:(r==null?void 0:r.banks)||[],tooltip:i=>we.createElement(hk,null,`${i.id} $${i.value.toLocaleString()}`),margin:{top:10,right:10,bottom:40,left:40},theme:{axis:{legend:{text:{fill:t?"#939393":"#000"}},ticks:{text:{fill:t?"#939393":"#000"}}},labels:{text:{fill:t?"#fff":"#000",textShadow:`1px 1px ${t?"black":"white"}`}}}}))}var vS={},j5e=uA.exports;Object.defineProperty(vS,"__esModule",{value:!0});var jD=vS.default=void 0,K5e=j5e(aA()),q5e=lA(),X5e=(0,K5e.default)((0,q5e.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12 1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteForever");jD=vS.default=X5e;var Q5e=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Dn=globalThis&&globalThis.__assign||function(){return Dn=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},Dn.apply(this,arguments)},q3={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},X3={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},Cm={width:"20px",height:"20px",position:"absolute"},Z5e={top:Dn(Dn({},q3),{top:"-5px"}),right:Dn(Dn({},X3),{left:void 0,right:"-5px"}),bottom:Dn(Dn({},q3),{top:void 0,bottom:"-5px"}),left:Dn(Dn({},X3),{left:"-5px"}),topRight:Dn(Dn({},Cm),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:Dn(Dn({},Cm),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:Dn(Dn({},Cm),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:Dn(Dn({},Cm),{left:"-10px",top:"-10px",cursor:"nw-resize"})},J5e=function(n){Q5e(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.onMouseDown=function(r){t.props.onResizeStart(r,t.props.direction)},t.onTouchStart=function(r){t.props.onResizeStart(r,t.props.direction)},t}return e.prototype.render=function(){return ie.exports.createElement("div",{className:this.props.className||"",style:Dn(Dn({position:"absolute",userSelect:"none"},Z5e[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},e}(ie.exports.PureComponent),eve=globalThis&&globalThis.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),bs=globalThis&&globalThis.__assign||function(){return bs=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},bs.apply(this,arguments)},tve={width:"auto",height:"auto"},Em=function(n,e,t){return Math.max(Math.min(n,t),e)},Q3=function(n,e){return Math.round(n/e)*e},fu=function(n,e){return new RegExp(n,"i").test(e)},bm=function(n){return Boolean(n.touches&&n.touches.length)},nve=function(n){return Boolean((n.clientX||n.clientX===0)&&(n.clientY||n.clientY===0))},Z3=function(n,e,t){t===void 0&&(t=0);var r=e.reduce(function(s,o,a){return Math.abs(o-n)<Math.abs(e[s]-n)?a:s},0),i=Math.abs(e[r]-n);return t===0||i<t?e[r]:n},dy=function(n){return n=n.toString(),n==="auto"||n.endsWith("px")||n.endsWith("%")||n.endsWith("vh")||n.endsWith("vw")||n.endsWith("vmax")||n.endsWith("vmin")?n:n+"px"},Sm=function(n,e,t,r){if(n&&typeof n=="string"){if(n.endsWith("px"))return Number(n.replace("px",""));if(n.endsWith("%")){var i=Number(n.replace("%",""))/100;return e*i}if(n.endsWith("vw")){var i=Number(n.replace("vw",""))/100;return t*i}if(n.endsWith("vh")){var i=Number(n.replace("vh",""))/100;return r*i}}return n},rve=function(n,e,t,r,i,s,o){return r=Sm(r,n.width,e,t),i=Sm(i,n.height,e,t),s=Sm(s,n.width,e,t),o=Sm(o,n.height,e,t),{maxWidth:typeof r>"u"?void 0:Number(r),maxHeight:typeof i>"u"?void 0:Number(i),minWidth:typeof s>"u"?void 0:Number(s),minHeight:typeof o>"u"?void 0:Number(o)}},ive=["as","style","className","grid","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],J3="__resizable_base__",sve=function(n){eve(e,n);function e(t){var r=n.call(this,t)||this;return r.ratio=1,r.resizable=null,r.parentLeft=0,r.parentTop=0,r.resizableLeft=0,r.resizableRight=0,r.resizableTop=0,r.resizableBottom=0,r.targetLeft=0,r.targetTop=0,r.appendBase=function(){if(!r.resizable||!r.window)return null;var i=r.parentNode;if(!i)return null;var s=r.window.document.createElement("div");return s.style.width="100%",s.style.height="100%",s.style.position="absolute",s.style.transform="scale(0, 0)",s.style.left="0",s.style.flex="0 0 100%",s.classList?s.classList.add(J3):s.className+=J3,i.appendChild(s),s},r.removeBase=function(i){var s=r.parentNode;!s||s.removeChild(i)},r.ref=function(i){i&&(r.resizable=i)},r.state={isResizing:!1,width:typeof(r.propsSize&&r.propsSize.width)>"u"?"auto":r.propsSize&&r.propsSize.width,height:typeof(r.propsSize&&r.propsSize.height)>"u"?"auto":r.propsSize&&r.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},r.onResizeStart=r.onResizeStart.bind(r),r.onMouseMove=r.onMouseMove.bind(r),r.onMouseUp=r.onMouseUp.bind(r),r}return Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){return!this.resizable||!this.resizable.ownerDocument?null:this.resizable.ownerDocument.defaultView},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||tve},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){var t=0,r=0;if(this.resizable&&this.window){var i=this.resizable.offsetWidth,s=this.resizable.offsetHeight,o=this.resizable.style.position;o!=="relative"&&(this.resizable.style.position="relative"),t=this.resizable.style.width!=="auto"?this.resizable.offsetWidth:i,r=this.resizable.style.height!=="auto"?this.resizable.offsetHeight:s,this.resizable.style.position=o}return{width:t,height:r}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sizeStyle",{get:function(){var t=this,r=this.props.size,i=function(a){if(typeof t.state[a]>"u"||t.state[a]==="auto")return"auto";if(t.propsSize&&t.propsSize[a]&&t.propsSize[a].toString().endsWith("%")){if(t.state[a].toString().endsWith("%"))return t.state[a].toString();var l=t.getParentSize(),u=Number(t.state[a].toString().replace("px","")),c=u/l[a]*100;return c+"%"}return dy(t.state[a])},s=r&&typeof r.width<"u"&&!this.state.isResizing?dy(r.width):i("width"),o=r&&typeof r.height<"u"&&!this.state.isResizing?dy(r.height):i("height");return{width:s,height:o}},enumerable:!1,configurable:!0}),e.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var t=this.appendBase();if(!t)return{width:0,height:0};var r=!1,i=this.parentNode.style.flexWrap;i!=="wrap"&&(r=!0,this.parentNode.style.flexWrap="wrap"),t.style.position="relative",t.style.minWidth="100%",t.style.minHeight="100%";var s={width:t.offsetWidth,height:t.offsetHeight};return r&&(this.parentNode.style.flexWrap=i),this.removeBase(t),s},e.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},e.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},e.prototype.componentDidMount=function(){if(!(!this.resizable||!this.window)){var t=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:t.flexBasis!=="auto"?t.flexBasis:void 0})}},e.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},e.prototype.createSizeForCssProperty=function(t,r){var i=this.propsSize&&this.propsSize[r];return this.state[r]==="auto"&&this.state.original[r]===t&&(typeof i>"u"||i==="auto")?"auto":t},e.prototype.calculateNewMaxFromBoundary=function(t,r){var i=this.props.boundsByDirection,s=this.state.direction,o=i&&fu("left",s),a=i&&fu("top",s),l,u;if(this.props.bounds==="parent"){var c=this.parentNode;c&&(l=o?this.resizableRight-this.parentLeft:c.offsetWidth+(this.parentLeft-this.resizableLeft),u=a?this.resizableBottom-this.parentTop:c.offsetHeight+(this.parentTop-this.resizableTop))}else this.props.bounds==="window"?this.window&&(l=o?this.resizableRight:this.window.innerWidth-this.resizableLeft,u=a?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(l=o?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),u=a?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return l&&Number.isFinite(l)&&(t=t&&t<l?t:l),u&&Number.isFinite(u)&&(r=r&&r<u?r:u),{maxWidth:t,maxHeight:r}},e.prototype.calculateNewSizeFromDirection=function(t,r){var i=this.props.scale||1,s=this.props.resizeRatio||1,o=this.state,a=o.direction,l=o.original,u=this.props,c=u.lockAspectRatio,h=u.lockAspectRatioExtraHeight,d=u.lockAspectRatioExtraWidth,f=l.width,m=l.height,p=h||0,y=d||0;return fu("right",a)&&(f=l.width+(t-l.x)*s/i,c&&(m=(f-y)/this.ratio+p)),fu("left",a)&&(f=l.width-(t-l.x)*s/i,c&&(m=(f-y)/this.ratio+p)),fu("bottom",a)&&(m=l.height+(r-l.y)*s/i,c&&(f=(m-p)*this.ratio+y)),fu("top",a)&&(m=l.height-(r-l.y)*s/i,c&&(f=(m-p)*this.ratio+y)),{newWidth:f,newHeight:m}},e.prototype.calculateNewSizeFromAspectRatio=function(t,r,i,s){var o=this.props,a=o.lockAspectRatio,l=o.lockAspectRatioExtraHeight,u=o.lockAspectRatioExtraWidth,c=typeof s.width>"u"?10:s.width,h=typeof i.width>"u"||i.width<0?t:i.width,d=typeof s.height>"u"?10:s.height,f=typeof i.height>"u"||i.height<0?r:i.height,m=l||0,p=u||0;if(a){var y=(d-m)*this.ratio+p,C=(f-m)*this.ratio+p,b=(c-p)/this.ratio+m,v=(h-p)/this.ratio+m,S=Math.max(c,y),L=Math.min(h,C),_=Math.max(d,b),P=Math.min(f,v);t=Em(t,S,L),r=Em(r,_,P)}else t=Em(t,c,h),r=Em(r,d,f);return{newWidth:t,newHeight:r}},e.prototype.setBoundingClientRect=function(){if(this.props.bounds==="parent"){var t=this.parentNode;if(t){var r=t.getBoundingClientRect();this.parentLeft=r.left,this.parentTop=r.top}}if(this.props.bounds&&typeof this.props.bounds!="string"){var i=this.props.bounds.getBoundingClientRect();this.targetLeft=i.left,this.targetTop=i.top}if(this.resizable){var s=this.resizable.getBoundingClientRect(),o=s.left,a=s.top,l=s.right,u=s.bottom;this.resizableLeft=o,this.resizableRight=l,this.resizableTop=a,this.resizableBottom=u}},e.prototype.onResizeStart=function(t,r){if(!(!this.resizable||!this.window)){var i=0,s=0;if(t.nativeEvent&&nve(t.nativeEvent)?(i=t.nativeEvent.clientX,s=t.nativeEvent.clientY):t.nativeEvent&&bm(t.nativeEvent)&&(i=t.nativeEvent.touches[0].clientX,s=t.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable){var o=this.props.onResizeStart(t,r,this.resizable);if(o===!1)return}this.props.size&&(typeof this.props.size.height<"u"&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),typeof this.props.size.width<"u"&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio=typeof this.props.lockAspectRatio=="number"?this.props.lockAspectRatio:this.size.width/this.size.height;var a,l=this.window.getComputedStyle(this.resizable);if(l.flexBasis!=="auto"){var u=this.parentNode;if(u){var c=this.window.getComputedStyle(u).flexDirection;this.flexDir=c.startsWith("row")?"row":"column",a=l.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var h={original:{x:i,y:s,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:bs(bs({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(t.target).cursor||"auto"}),direction:r,flexBasis:a};this.setState(h)}},e.prototype.onMouseMove=function(t){var r=this;if(!(!this.state.isResizing||!this.resizable||!this.window)){if(this.window.TouchEvent&&bm(t))try{t.preventDefault(),t.stopPropagation()}catch{}var i=this.props,s=i.maxWidth,o=i.maxHeight,a=i.minWidth,l=i.minHeight,u=bm(t)?t.touches[0].clientX:t.clientX,c=bm(t)?t.touches[0].clientY:t.clientY,h=this.state,d=h.direction,f=h.original,m=h.width,p=h.height,y=this.getParentSize(),C=rve(y,this.window.innerWidth,this.window.innerHeight,s,o,a,l);s=C.maxWidth,o=C.maxHeight,a=C.minWidth,l=C.minHeight;var b=this.calculateNewSizeFromDirection(u,c),v=b.newHeight,S=b.newWidth,L=this.calculateNewMaxFromBoundary(s,o);this.props.snap&&this.props.snap.x&&(S=Z3(S,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(v=Z3(v,this.props.snap.y,this.props.snapGap));var _=this.calculateNewSizeFromAspectRatio(S,v,{width:L.maxWidth,height:L.maxHeight},{width:a,height:l});if(S=_.newWidth,v=_.newHeight,this.props.grid){var P=Q3(S,this.props.grid[0]),x=Q3(v,this.props.grid[1]),I=this.props.snapGap||0;S=I===0||Math.abs(P-S)<=I?P:S,v=I===0||Math.abs(x-v)<=I?x:v}var R={width:S-f.width,height:v-f.height};if(m&&typeof m=="string"){if(m.endsWith("%")){var N=S/y.width*100;S=N+"%"}else if(m.endsWith("vw")){var H=S/this.window.innerWidth*100;S=H+"vw"}else if(m.endsWith("vh")){var K=S/this.window.innerHeight*100;S=K+"vh"}}if(p&&typeof p=="string"){if(p.endsWith("%")){var N=v/y.height*100;v=N+"%"}else if(p.endsWith("vw")){var H=v/this.window.innerWidth*100;v=H+"vw"}else if(p.endsWith("vh")){var K=v/this.window.innerHeight*100;v=K+"vh"}}var X={width:this.createSizeForCssProperty(S,"width"),height:this.createSizeForCssProperty(v,"height")};this.flexDir==="row"?X.flexBasis=X.width:this.flexDir==="column"&&(X.flexBasis=X.height),oA.exports.flushSync(function(){r.setState(X)}),this.props.onResize&&this.props.onResize(t,d,this.resizable,R)}},e.prototype.onMouseUp=function(t){var r=this.state,i=r.isResizing,s=r.direction,o=r.original;if(!(!i||!this.resizable)){var a={width:this.size.width-o.width,height:this.size.height-o.height};this.props.onResizeStop&&this.props.onResizeStop(t,s,this.resizable,a),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:bs(bs({},this.state.backgroundStyle),{cursor:"auto"})})}},e.prototype.updateSize=function(t){this.setState({width:t.width,height:t.height})},e.prototype.renderResizer=function(){var t=this,r=this.props,i=r.enable,s=r.handleStyles,o=r.handleClasses,a=r.handleWrapperStyle,l=r.handleWrapperClass,u=r.handleComponent;if(!i)return null;var c=Object.keys(i).map(function(h){return i[h]!==!1?ie.exports.createElement(J5e,{key:h,direction:h,onResizeStart:t.onResizeStart,replaceStyles:s&&s[h],className:o&&o[h]},u&&u[h]?u[h]:null):null});return ie.exports.createElement("div",{className:l,style:a},c)},e.prototype.render=function(){var t=this,r=Object.keys(this.props).reduce(function(o,a){return ive.indexOf(a)!==-1||(o[a]=t.props[a]),o},{}),i=bs(bs(bs({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(i.flexBasis=this.state.flexBasis);var s=this.props.as||"div";return ie.exports.createElement(s,bs({ref:this.ref,style:i,className:this.props.className},r),this.state.isResizing&&ie.exports.createElement("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer())},e.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},e}(ie.exports.PureComponent),CS={},ove=uA.exports;Object.defineProperty(CS,"__esModule",{value:!0});var KD=CS.default=void 0,ave=ove(aA()),lve=lA(),uve=(0,ave.default)((0,lve.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"FileDownload");KD=CS.default=uve;const cve=(n,e)=>{const t=JSON.stringify(n,null,2),r=new Blob([t],{type:"application/json"}),i=URL.createObjectURL(r),s=document.createElement("a");s.href=i,s.download=e+".json",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)};function hve(){const n=Ng(h=>h.database),e="90vw",[t,r]=ie.exports.useState(400),[i,s]=ie.exports.useState(0),[o,a]=ie.exports.useState(""),l=Us.exports.useLiveQuery(async()=>{const h=await n.expenditure.toArray();let{minDate:d,maxDate:f}=h.reduce((y,C)=>({minDate:Math.min(C.datetime,y.minDate),maxDate:Math.max(C.datetime,y.maxDate)}),{minDate:1/0,maxDate:0});const m=h.reduce((y,C)=>Math.max(y,C.id||0),0),p=fd(await n.recurring.where("start").belowOrEqual(f).toArray(),d,f).map((y,C)=>({...y,id:m+C}));return Co.exports.sortBy([...h,...p],["datetime"])}),u=ie.exports.useCallback(h=>{let d=h.row.id,f=h.field,m=h.value;n.expenditure.update(d,{[f]:f==="amount"?parseFloat(m):m}).then().finally()},[]),c=[{field:"datetime",renderCell:h=>`${St.unix(h.row.datetime).format("YYYY MMM DD")}`},{field:"category",editable:!0},{field:"credit_card"},{field:"name",editable:!0},{field:"amount",editable:!0},{field:"delete",renderCell:h=>we.createElement(Bh,{onClick:async()=>{h.row.recurringId?await n.recurring.delete(h.row.recurringId):await n.expenditure.delete(h.row.id)}},we.createElement(jD,null))},{field:"txn_type"}];return we.createElement("div",null,we.createElement(sve,{size:{width:e,height:t},onResizeStop:(h,d,f,m)=>{r(t+m.height)},minWidth:e,maxWidth:e,minHeight:220},we.createElement(sF,{sx:{[`& .${Gn.DEBIT}`]:{bgcolor:"green"},[`& .${Gn.CREDIT}`]:{bgcolor:"red"},[`& .${Gn.SALARY}`]:{bgcolor:"blue"},[`& .${Gn.RECURRING}`]:{bgcolor:"orange",color:"grey"}},onCellEditCommit:u,disableSelectionOnClick:!0,columns:c,rows:l||[],getRowClassName:h=>h.row[Nt.transactionType],initialState:{sorting:{sortModel:[{field:"datetime",sort:"desc"}]}}})),we.createElement(gt,{style:{width:"100%"},container:!0,direction:"row",justifyContent:"space-between",alignItems:"flex-start"},we.createElement(gt,{item:!0},we.createElement(np,{variant:"contained",startIcon:we.createElement(KD,null),onClick:async()=>{const h=await n.expenditure.toArray(),d=await n.recurring.toArray();cve({expenditure:h,recurring:d},"expenditure")}},"export")),we.createElement(gt,{item:!0},we.createElement(yo,{variant:"subtitle2",onClick:()=>s(i+1)},"*psst this table is resizable"))),i>=10&&we.createElement("div",null,we.createElement(np,{size:"small",onClick:()=>{const h=JSON.parse(o);"expenditure"in h&&n.expenditure.clear().then(()=>{n.expenditure.bulkAdd(h.expenditure)}),"recurring"in h&&n.recurring.clear().then(()=>{n.recurring.bulkAdd(h.recurring)})}},"upload"),we.createElement("input",{type:"file",accept:"application/json",onChange:h=>{let d=new FileReader;h.target.files!==null&&(d.readAsText(h.target.files[0],"UTF-8"),d.onload=f=>{var m;a((m=f.target)==null?void 0:m.result)})}})))}const eA=Math.pow(2,-52),Rm=new Uint32Array(512);class Sg{static from(e,t=gve,r=yve){const i=e.length,s=new Float64Array(i*2);for(let o=0;o<i;o++){const a=e[o];s[2*o]=t(a),s[2*o+1]=r(a)}return new Sg(s)}constructor(e){const t=e.length>>1;if(t>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const r=Math.max(2*t-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:r,_hullTri:i,_hullHash:s}=this,o=e.length>>1;let a=1/0,l=1/0,u=-1/0,c=-1/0;for(let R=0;R<o;R++){const N=e[2*R],H=e[2*R+1];N<a&&(a=N),H<l&&(l=H),N>u&&(u=N),H>c&&(c=H),this._ids[R]=R}const h=(a+u)/2,d=(l+c)/2;let f=1/0,m,p,y;for(let R=0;R<o;R++){const N=fy(h,d,e[2*R],e[2*R+1]);N<f&&(m=R,f=N)}const C=e[2*m],b=e[2*m+1];f=1/0;for(let R=0;R<o;R++){if(R===m)continue;const N=fy(C,b,e[2*R],e[2*R+1]);N<f&&N>0&&(p=R,f=N)}let v=e[2*p],S=e[2*p+1],L=1/0;for(let R=0;R<o;R++){if(R===m||R===p)continue;const N=mve(C,b,v,S,e[2*R],e[2*R+1]);N<L&&(y=R,L=N)}let _=e[2*y],P=e[2*y+1];if(L===1/0){for(let H=0;H<o;H++)this._dists[H]=e[2*H]-e[0]||e[2*H+1]-e[1];_u(this._ids,this._dists,0,o-1);const R=new Uint32Array(o);let N=0;for(let H=0,K=-1/0;H<o;H++){const X=this._ids[H];this._dists[X]>K&&(R[N++]=X,K=this._dists[X])}this.hull=R.subarray(0,N),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Tm(C,b,v,S,_,P)){const R=p,N=v,H=S;p=y,v=_,S=P,y=R,_=N,P=H}const x=pve(C,b,v,S,_,P);this._cx=x.x,this._cy=x.y;for(let R=0;R<o;R++)this._dists[R]=fy(e[2*R],e[2*R+1],x.x,x.y);_u(this._ids,this._dists,0,o-1),this._hullStart=m;let I=3;r[m]=t[y]=p,r[p]=t[m]=y,r[y]=t[p]=m,i[m]=0,i[p]=1,i[y]=2,s.fill(-1),s[this._hashKey(C,b)]=m,s[this._hashKey(v,S)]=p,s[this._hashKey(_,P)]=y,this.trianglesLen=0,this._addTriangle(m,p,y,-1,-1,-1);for(let R=0,N,H;R<this._ids.length;R++){const K=this._ids[R],X=e[2*K],J=e[2*K+1];if(R>0&&Math.abs(X-N)<=eA&&Math.abs(J-H)<=eA||(N=X,H=J,K===m||K===p||K===y))continue;let ue=0;for(let A=0,U=this._hashKey(X,J);A<this._hashSize&&(ue=s[(U+A)%this._hashSize],!(ue!==-1&&ue!==r[ue]));A++);ue=t[ue];let se=ue,O;for(;O=r[se],!Tm(X,J,e[2*se],e[2*se+1],e[2*O],e[2*O+1]);)if(se=O,se===ue){se=-1;break}if(se===-1)continue;let g=this._addTriangle(se,K,r[se],-1,-1,i[se]);i[K]=this._legalize(g+2),i[se]=g,I++;let E=r[se];for(;O=r[E],Tm(X,J,e[2*E],e[2*E+1],e[2*O],e[2*O+1]);)g=this._addTriangle(E,K,O,i[K],-1,i[E]),i[K]=this._legalize(g+2),r[E]=E,I--,E=O;if(se===ue)for(;O=t[se],Tm(X,J,e[2*O],e[2*O+1],e[2*se],e[2*se+1]);)g=this._addTriangle(O,K,se,-1,i[se],i[O]),this._legalize(g+2),i[O]=g,r[se]=se,I--,se=O;this._hullStart=t[K]=se,r[se]=t[E]=K,r[K]=E,s[this._hashKey(X,J)]=K,s[this._hashKey(e[2*se],e[2*se+1])]=se}this.hull=new Uint32Array(I);for(let R=0,N=this._hullStart;R<I;R++)this.hull[R]=N,N=r[N];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(dve(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:r,coords:i}=this;let s=0,o=0;for(;;){const a=r[e],l=e-e%3;if(o=l+(e+2)%3,a===-1){if(s===0)break;e=Rm[--s];continue}const u=a-a%3,c=l+(e+1)%3,h=u+(a+2)%3,d=t[o],f=t[e],m=t[c],p=t[h];if(fve(i[2*d],i[2*d+1],i[2*f],i[2*f+1],i[2*m],i[2*m+1],i[2*p],i[2*p+1])){t[e]=p,t[a]=d;const C=r[h];if(C===-1){let v=this._hullStart;do{if(this._hullTri[v]===h){this._hullTri[v]=e;break}v=this._hullPrev[v]}while(v!==this._hullStart)}this._link(e,C),this._link(a,r[o]),this._link(o,h);const b=u+(a+1)%3;s<Rm.length&&(Rm[s++]=b)}else{if(s===0)break;e=Rm[--s]}}return o}_link(e,t){this._halfedges[e]=t,t!==-1&&(this._halfedges[t]=e)}_addTriangle(e,t,r,i,s,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=t,this._triangles[a+2]=r,this._link(a,i),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function dve(n,e){const t=n/(Math.abs(n)+Math.abs(e));return(e>0?3-t:1+t)/4}function fy(n,e,t,r){const i=n-t,s=e-r;return i*i+s*s}function my(n,e,t,r,i,s){const o=(r-e)*(i-n),a=(t-n)*(s-e);return Math.abs(o-a)>=33306690738754716e-32*Math.abs(o+a)?o-a:0}function Tm(n,e,t,r,i,s){return(my(i,s,n,e,t,r)||my(n,e,t,r,i,s)||my(t,r,i,s,n,e))<0}function fve(n,e,t,r,i,s,o,a){const l=n-o,u=e-a,c=t-o,h=r-a,d=i-o,f=s-a,m=l*l+u*u,p=c*c+h*h,y=d*d+f*f;return l*(h*y-p*f)-u*(c*y-p*d)+m*(c*f-h*d)<0}function mve(n,e,t,r,i,s){const o=t-n,a=r-e,l=i-n,u=s-e,c=o*o+a*a,h=l*l+u*u,d=.5/(o*u-a*l),f=(u*c-a*h)*d,m=(o*h-l*c)*d;return f*f+m*m}function pve(n,e,t,r,i,s){const o=t-n,a=r-e,l=i-n,u=s-e,c=o*o+a*a,h=l*l+u*u,d=.5/(o*u-a*l),f=n+(u*c-a*h)*d,m=e+(o*h-l*c)*d;return{x:f,y:m}}function _u(n,e,t,r){if(r-t<=20)for(let i=t+1;i<=r;i++){const s=n[i],o=e[s];let a=i-1;for(;a>=t&&e[n[a]]>o;)n[a+1]=n[a--];n[a+1]=s}else{const i=t+r>>1;let s=t+1,o=r;th(n,i,s),e[n[t]]>e[n[r]]&&th(n,t,r),e[n[s]]>e[n[r]]&&th(n,s,r),e[n[t]]>e[n[s]]&&th(n,t,s);const a=n[s],l=e[a];for(;;){do s++;while(e[n[s]]<l);do o--;while(e[n[o]]>l);if(o<s)break;th(n,s,o)}n[t+1]=n[o],n[o]=a,r-s+1>=o-t?(_u(n,e,s,r),_u(n,e,t,o-1)):(_u(n,e,t,o-1),_u(n,e,s,r))}}function th(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function gve(n){return n[0]}function yve(n){return n[1]}const tA=1e-6;class Ja{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},${this._y1=+t}`}arc(e,t,r){e=+e,t=+t,r=+r;const i=e+r,s=t;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${s}`:(Math.abs(this._x1-i)>tA||Math.abs(this._y1-s)>tA)&&(this._+="L"+i+","+s),r&&(this._+=`A${r},${r},0,1,1,${e-r},${t}A${r},${r},0,1,1,${this._x1=i},${this._y1=s}`)}rect(e,t,r,i){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class T5{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}class wve{constructor(e,[t,r,i,s]=[0,0,960,500]){if(!((i=+i)>=(t=+t))||!((s=+s)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=i,this.xmin=t,this.ymax=s,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:r},vectors:i}=this,s=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let f=0,m=0,p=r.length,y,C;f<p;f+=3,m+=2){const b=r[f]*2,v=r[f+1]*2,S=r[f+2]*2,L=e[b],_=e[b+1],P=e[v],x=e[v+1],I=e[S],R=e[S+1],N=P-L,H=x-_,K=I-L,X=R-_,J=N*N+H*H,ue=K*K+X*X,se=(N*X-H*K)*2;if(!se)y=(L+I)/2-1e8*X,C=(_+R)/2+1e8*K;else if(Math.abs(se)<1e-8)y=(L+I)/2,C=(_+R)/2;else{const O=1/se;y=L+(X*J-H*ue)*O,C=_+(N*ue-K*J)*O}s[m]=y,s[m+1]=C}let o=t[t.length-1],a,l=o*4,u,c=e[2*o],h,d=e[2*o+1];i.fill(0);for(let f=0;f<t.length;++f)o=t[f],a=l,u=c,h=d,l=o*4,c=e[2*o],d=e[2*o+1],i[a+2]=i[l]=h-d,i[a+3]=i[l+1]=c-u}render(e){const t=e==null?e=new Ja:void 0,{delaunay:{halfedges:r,inedges:i,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let c=0,h=r.length;c<h;++c){const d=r[c];if(d<c)continue;const f=Math.floor(c/3)*2,m=Math.floor(d/3)*2,p=o[f],y=o[f+1],C=o[m],b=o[m+1];this._renderSegment(p,y,C,b,e)}let l,u=s[s.length-1];for(let c=0;c<s.length;++c){l=u,u=s[c];const h=Math.floor(i[u]/3)*2,d=o[h],f=o[h+1],m=l*4,p=this._project(d,f,a[m+2],a[m+3]);p&&this._renderSegment(d,f,p[0],p[1],e)}return t&&t.value()}renderBounds(e){const t=e==null?e=new Ja:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const r=t==null?t=new Ja:void 0,i=this._clip(e);if(i===null||!i.length)return;t.moveTo(i[0],i[1]);let s=i.length;for(;i[0]===i[s-2]&&i[1]===i[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(i[o]!==i[o-2]||i[o+1]!==i[o-1])&&t.lineTo(i[o],i[o+1]);return t.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,r=e.length/2;t<r;++t){const i=this.cellPolygon(t);i&&(i.index=t,yield i)}}cellPolygon(e){const t=new T5;return this.renderCell(e,t),t.value()}_renderSegment(e,t,r,i,s){let o;const a=this._regioncode(e,t),l=this._regioncode(r,i);a===0&&l===0?(s.moveTo(e,t),s.lineTo(r,i)):(o=this._clipSegment(e,t,r,i,a,l))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(e,t,r){return t=+t,t!==t||(r=+r,r!==r)?!1:this.delaunay._step(e,t,r)===e}*neighbors(e){const t=this._clip(e);if(t)for(const r of this.delaunay.neighbors(e)){const i=this._clip(r);if(i){e:for(let s=0,o=t.length;s<o;s+=2)for(let a=0,l=i.length;a<l;a+=2)if(t[s]==i[a]&&t[s+1]==i[a+1]&&t[(s+2)%o]==i[(a+l-2)%l]&&t[(s+3)%o]==i[(a+l-1)%l]){yield r;break e}}}}_cell(e){const{circumcenters:t,delaunay:{inedges:r,halfedges:i,triangles:s}}=this,o=r[e];if(o===-1)return null;const a=[];let l=o;do{const u=Math.floor(l/3);if(a.push(t[u*2],t[u*2+1]),l=l%3===2?l-2:l+1,s[l]!==e)break;l=i[l]}while(l!==o&&l!==-1);return a}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(t===null)return null;const{vectors:r}=this,i=e*4;return r[i]||r[i+1]?this._clipInfinite(e,t,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(e,t)}_clipFinite(e,t){const r=t.length;let i=null,s,o,a=t[r-2],l=t[r-1],u,c=this._regioncode(a,l),h,d;for(let f=0;f<r;f+=2)if(s=a,o=l,a=t[f],l=t[f+1],u=c,c=this._regioncode(a,l),u===0&&c===0)h=d,d=0,i?i.push(a,l):i=[a,l];else{let m,p,y,C,b;if(u===0){if((m=this._clipSegment(s,o,a,l,u,c))===null)continue;[p,y,C,b]=m}else{if((m=this._clipSegment(a,l,s,o,c,u))===null)continue;[C,b,p,y]=m,h=d,d=this._edgecode(p,y),h&&d&&this._edge(e,h,d,i,i.length),i?i.push(p,y):i=[p,y]}h=d,d=this._edgecode(C,b),h&&d&&this._edge(e,h,d,i,i.length),i?i.push(C,b):i=[C,b]}if(i)h=d,d=this._edgecode(i[0],i[1]),h&&d&&this._edge(e,h,d,i,i.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(e,t,r,i,s,o){for(;;){if(s===0&&o===0)return[e,t,r,i];if(s&o)return null;let a,l,u=s||o;u&8?(a=e+(r-e)*(this.ymax-t)/(i-t),l=this.ymax):u&4?(a=e+(r-e)*(this.ymin-t)/(i-t),l=this.ymin):u&2?(l=t+(i-t)*(this.xmax-e)/(r-e),a=this.xmax):(l=t+(i-t)*(this.xmin-e)/(r-e),a=this.xmin),s?(e=a,t=l,s=this._regioncode(e,t)):(r=a,i=l,o=this._regioncode(r,i))}}_clipInfinite(e,t,r,i,s,o){let a=Array.from(t),l;if((l=this._project(a[0],a[1],r,i))&&a.unshift(l[0],l[1]),(l=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(l[0],l[1]),a=this._clipFinite(e,a))for(let u=0,c=a.length,h,d=this._edgecode(a[c-2],a[c-1]);u<c;u+=2)h=d,d=this._edgecode(a[u],a[u+1]),h&&d&&(u=this._edge(e,h,d,a,u),c=a.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(e,t,r,i,s){for(;t!==r;){let o,a;switch(t){case 5:t=4;continue;case 4:t=6,o=this.xmax,a=this.ymin;break;case 6:t=2;continue;case 2:t=10,o=this.xmax,a=this.ymax;break;case 10:t=8;continue;case 8:t=9,o=this.xmin,a=this.ymax;break;case 9:t=1;continue;case 1:t=5,o=this.xmin,a=this.ymin;break}(i[s]!==o||i[s+1]!==a)&&this.contains(e,o,a)&&(i.splice(s,0,o,a),s+=2)}if(i.length>4)for(let o=0;o<i.length;o+=2){const a=(o+2)%i.length,l=(o+4)%i.length;(i[o]===i[a]&&i[a]===i[l]||i[o+1]===i[a+1]&&i[a+1]===i[l+1])&&(i.splice(a,2),o-=2)}return s}_project(e,t,r,i){let s=1/0,o,a,l;if(i<0){if(t<=this.ymin)return null;(o=(this.ymin-t)/i)<s&&(l=this.ymin,a=e+(s=o)*r)}else if(i>0){if(t>=this.ymax)return null;(o=(this.ymax-t)/i)<s&&(l=this.ymax,a=e+(s=o)*r)}if(r>0){if(e>=this.xmax)return null;(o=(this.xmax-e)/r)<s&&(a=this.xmax,l=t+(s=o)*i)}else if(r<0){if(e<=this.xmin)return null;(o=(this.xmin-e)/r)<s&&(a=this.xmin,l=t+(s=o)*i)}return[a,l]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}}const vve=2*Math.PI,mu=Math.pow;function Cve(n){return n[0]}function Eve(n){return n[1]}function bve(n){const{triangles:e,coords:t}=n;for(let r=0;r<e.length;r+=3){const i=2*e[r],s=2*e[r+1],o=2*e[r+2];if((t[o]-t[i])*(t[s+1]-t[i+1])-(t[s]-t[i])*(t[o+1]-t[i+1])>1e-10)return!1}return!0}function Sve(n,e,t){return[n+Math.sin(n+e)*t,e+Math.cos(n-e)*t]}class ES{static from(e,t=Cve,r=Eve,i){return new ES("length"in e?Rve(e,t,r,i):Float64Array.from(Tve(e,t,r,i)))}constructor(e){this._delaunator=new Sg(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&bve(e)){this.collinear=Int32Array.from({length:t.length/2},(d,f)=>f).sort((d,f)=>t[2*d]-t[2*f]||t[2*d+1]-t[2*f+1]);const l=this.collinear[0],u=this.collinear[this.collinear.length-1],c=[t[2*l],t[2*l+1],t[2*u],t[2*u+1]],h=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,f=t.length/2;d<f;++d){const m=Sve(t[2*d],t[2*d+1],h);t[2*d]=m[0],t[2*d+1]=m[1]}this._delaunator=new Sg(t)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let l=0,u=r.length;l<u;++l){const c=s[l%3===2?l-2:l+1];(r[l]===-1||o[c]===-1)&&(o[c]=l)}for(let l=0,u=i.length;l<u;++l)a[i[l]]=l;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],o[i[0]]=1,i.length===2&&(o[i[1]]=0))}voronoi(e){return new wve(this,e)}*neighbors(e){const{inedges:t,hull:r,_hullIndex:i,halfedges:s,triangles:o,collinear:a}=this;if(a){const h=a.indexOf(e);h>0&&(yield a[h-1]),h<a.length-1&&(yield a[h+1]);return}const l=t[e];if(l===-1)return;let u=l,c=-1;do{if(yield c=o[u],u=u%3===2?u-2:u+1,o[u]!==e)return;if(u=s[u],u===-1){const h=r[(i[e]+1)%r.length];h!==c&&(yield h);return}}while(u!==l)}find(e,t,r=0){if(e=+e,e!==e||(t=+t,t!==t))return-1;const i=r;let s;for(;(s=this._step(r,e,t))>=0&&s!==r&&s!==i;)r=s;return s}_step(e,t,r){const{inedges:i,hull:s,_hullIndex:o,halfedges:a,triangles:l,points:u}=this;if(i[e]===-1||!u.length)return(e+1)%(u.length>>1);let c=e,h=mu(t-u[e*2],2)+mu(r-u[e*2+1],2);const d=i[e];let f=d;do{let m=l[f];const p=mu(t-u[m*2],2)+mu(r-u[m*2+1],2);if(p<h&&(h=p,c=m),f=f%3===2?f-2:f+1,l[f]!==e)break;if(f=a[f],f===-1){if(f=s[(o[e]+1)%s.length],f!==m&&mu(t-u[f*2],2)+mu(r-u[f*2+1],2)<h)return f;break}}while(f!==d);return c}render(e){const t=e==null?e=new Ja:void 0,{points:r,halfedges:i,triangles:s}=this;for(let o=0,a=i.length;o<a;++o){const l=i[o];if(l<o)continue;const u=s[o]*2,c=s[l]*2;e.moveTo(r[u],r[u+1]),e.lineTo(r[c],r[c+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t=2){const r=e==null?e=new Ja:void 0,{points:i}=this;for(let s=0,o=i.length;s<o;s+=2){const a=i[s],l=i[s+1];e.moveTo(a+t,l),e.arc(a,l,t,0,vve)}return r&&r.value()}renderHull(e){const t=e==null?e=new Ja:void 0,{hull:r,points:i}=this,s=r[0]*2,o=r.length;e.moveTo(i[s],i[s+1]);for(let a=1;a<o;++a){const l=2*r[a];e.lineTo(i[l],i[l+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new T5;return this.renderHull(e),e.value()}renderTriangle(e,t){const r=t==null?t=new Ja:void 0,{points:i,triangles:s}=this,o=s[e*=3]*2,a=s[e+1]*2,l=s[e+2]*2;return t.moveTo(i[o],i[o+1]),t.lineTo(i[a],i[a+1]),t.lineTo(i[l],i[l+1]),t.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,r=e.length/3;t<r;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new T5;return this.renderTriangle(e,t),t.value()}}function Rve(n,e,t,r){const i=n.length,s=new Float64Array(i*2);for(let o=0;o<i;++o){const a=n[o];s[o*2]=e.call(r,a,o,n),s[o*2+1]=t.call(r,a,o,n)}return s}function*Tve(n,e,t,r){let i=0;for(const s of n)yield e.call(r,s,i,n),yield t.call(r,s,i,n),++i}var nA=function(n){return typeof n=="function"?n:function(e){return e[n]}},Ave=function(n){var e=n.points,t=n.x,r=t===void 0?"x":t,i=n.y,s=i===void 0?"y":i,o=nA(r),a=nA(s);return e.map(function(l){return[o(l),a(l)]})},xve=function(n){var e=n.points,t=n.width,r=n.height,i=n.debug,s=ES.from(e),o=i?s.voronoi([0,0,t,r]):void 0;return{delaunay:s,voronoi:o}},qD=function(n){var e=n.points,t=n.x,r=n.y,i=n.width,s=n.height,o=n.debug,a=ie.exports.useMemo(function(){return Ave({points:e,x:t,y:r})},[e,t,r]);return ie.exports.useMemo(function(){return xve({points:a,width:i,height:s,debug:o})},[a,i,s,o])},Mve=function(n){var e=n.nodes,t=n.width,r=n.height,i=n.x,s=n.y,o=n.onMouseEnter,a=n.onMouseMove,l=n.onMouseLeave,u=n.onClick,c=n.debug,h=ie.exports.useRef(null),d=ie.exports.useState(null),f=d[0],m=d[1],p=qD({points:e,x:i,y:s,width:t,height:r,debug:c}),y=p.delaunay,C=p.voronoi,b=ie.exports.useMemo(function(){if(c&&C)return C.render()},[c,C]),v=ie.exports.useCallback(function(x){if(!h.current)return[null,null];var I=Fh(h.current,x),R=I[0],N=I[1],H=y.find(R,N);return[H,H!==void 0?e[H]:null]},[h,y]),S=ie.exports.useCallback(function(x){var I=v(x),R=I[0],N=I[1];m(R),N&&(o==null||o(N,x))},[v,m,o]),L=ie.exports.useCallback(function(x){var I=v(x),R=I[0],N=I[1];m(R),N&&(a==null||a(N,x))},[v,m,a]),_=ie.exports.useCallback(function(x){if(m(null),l){var I=void 0;f!==null&&(I=e[f]),I&&l(I,x)}},[m,f,l,e]),P=ie.exports.useCallback(function(x){var I=v(x),R=I[0],N=I[1];m(R),N&&(u==null||u(N,x))},[v,m,u]);return ce.jsxs("g",{ref:h,children:[c&&C&&ce.jsxs(ce.Fragment,{children:[ce.jsx("path",{d:b,stroke:"red",strokeWidth:1,opacity:.75}),f!==null&&ce.jsx("path",{fill:"pink",opacity:.35,d:C.renderCell(f)})]}),ce.jsx("rect",{width:t,height:r,fill:"red",opacity:0,style:{cursor:"auto"},onMouseEnter:S,onMouseMove:L,onMouseLeave:_,onClick:P})]})},Nve=function(n,e){n.save(),n.globalAlpha=.75,n.beginPath(),e.render(n),n.strokeStyle="red",n.lineWidth=1,n.stroke(),n.restore()},Ive=function(n,e,t){n.save(),n.globalAlpha=.35,n.beginPath(),e.renderCell(t,n),n.fillStyle="red",n.fill(),n.restore()};function mr(){return mr=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},mr.apply(this,arguments)}var XD=function(n){var e=n.point;return ce.jsx(iL,{id:ce.jsxs("span",{children:["x: ",ce.jsx("strong",{children:e.data.xFormatted}),", y:"," ",ce.jsx("strong",{children:e.data.yFormatted})]}),enableChip:!0,color:e.serieColor})};XD.propTypes={point:M.exports.object.isRequired};var Ove=ie.exports.memo(XD),QD=function(n){var e=n.slice,t=n.axis,r=rn(),i=t==="x"?"y":"x";return ce.jsx(sL,{rows:e.points.map(function(s){return[ce.jsx(rL,{color:s.serieColor,style:r.tooltip.chip},"chip"),s.serieId,ce.jsx("span",{style:r.tooltip.tableCellValue,children:s.data[i+"Formatted"]},"value")]})})};QD.propTypes={slice:M.exports.object.isRequired,axis:M.exports.oneOf(["x","y"]).isRequired};var _ve=ie.exports.memo(QD),ZD={data:M.exports.arrayOf(M.exports.shape({id:M.exports.oneOfType([M.exports.string,M.exports.number]).isRequired,data:M.exports.arrayOf(M.exports.shape({x:M.exports.oneOfType([M.exports.number,M.exports.string,M.exports.instanceOf(Date)]),y:M.exports.oneOfType([M.exports.number,M.exports.string,M.exports.instanceOf(Date)])})).isRequired})).isRequired,xScale:M.exports.object.isRequired,xFormat:M.exports.oneOfType([M.exports.func,M.exports.string]),yScale:M.exports.object.isRequired,yFormat:M.exports.oneOfType([M.exports.func,M.exports.string]),layers:M.exports.arrayOf(M.exports.oneOfType([M.exports.oneOf(["grid","markers","axes","areas","crosshair","lines","slices","points","mesh","legends"]),M.exports.func])).isRequired,curve:C0e.isRequired,axisTop:vm,axisRight:vm,axisBottom:vm,axisLeft:vm,enableGridX:M.exports.bool.isRequired,enableGridY:M.exports.bool.isRequired,gridXValues:M.exports.oneOfType([M.exports.number,M.exports.arrayOf(M.exports.oneOfType([M.exports.number,M.exports.string,M.exports.instanceOf(Date)]))]),gridYValues:M.exports.oneOfType([M.exports.number,M.exports.arrayOf(M.exports.oneOfType([M.exports.number,M.exports.string,M.exports.instanceOf(Date)]))]),enablePoints:M.exports.bool.isRequired,pointSymbol:M.exports.func,pointSize:M.exports.number.isRequired,pointColor:M.exports.any.isRequired,pointBorderWidth:M.exports.number.isRequired,pointBorderColor:M.exports.any.isRequired,enablePointLabel:M.exports.bool.isRequired,pointLabel:M.exports.oneOfType([M.exports.string,M.exports.func]).isRequired,markers:M.exports.arrayOf(M.exports.shape({axis:M.exports.oneOf(["x","y"]).isRequired,value:M.exports.oneOfType([M.exports.number,M.exports.string,M.exports.instanceOf(Date)]).isRequired,style:M.exports.object})),colors:h5e.isRequired,enableArea:M.exports.bool.isRequired,areaOpacity:M.exports.number.isRequired,areaBlendMode:fS.isRequired,areaBaselineValue:M.exports.oneOfType([M.exports.number,M.exports.string,M.exports.instanceOf(Date)]).isRequired,lineWidth:M.exports.number.isRequired,legends:M.exports.arrayOf(M.exports.shape(b5e)).isRequired,isInteractive:M.exports.bool.isRequired,debugMesh:M.exports.bool.isRequired,tooltip:M.exports.oneOfType([M.exports.func,M.exports.object]).isRequired,enableSlices:M.exports.oneOf(["x","y",!1]).isRequired,debugSlices:M.exports.bool.isRequired,sliceTooltip:M.exports.oneOfType([M.exports.func,M.exports.object]).isRequired,enableCrosshair:M.exports.bool.isRequired,crosshairType:M.exports.string.isRequired},Lve=mr({},ZD,{enablePointLabel:M.exports.bool.isRequired,role:M.exports.string.isRequired,useMesh:M.exports.bool.isRequired},dh,E0e),Pve=mr({pixelRatio:M.exports.number.isRequired},ZD),JD={curve:"linear",xScale:{type:"point"},yScale:{type:"linear",min:0,max:"auto"},layers:["grid","markers","axes","areas","crosshair","lines","points","slices","mesh","legends"],axisBottom:{},axisLeft:{},enableGridX:!0,enableGridY:!0,enablePoints:!0,pointSize:6,pointColor:{from:"color"},pointBorderWidth:0,pointBorderColor:{theme:"background"},enablePointLabel:!1,pointLabel:"yFormatted",colors:{scheme:"nivo"},enableArea:!1,areaBaselineValue:0,areaOpacity:.2,areaBlendMode:"normal",lineWidth:2,legends:[],isInteractive:!0,tooltip:Ove,enableSlices:!1,debugSlices:!1,sliceTooltip:_ve,debugMesh:!1,enableCrosshair:!0,crosshairType:"bottom-left"},oo=mr({},JD,{enablePointLabel:!1,useMesh:!1,animate:!0,motionConfig:"gentle",defs:[],fill:[],role:"img"}),Dve=mr({},JD,{pixelRatio:typeof window<"u"&&window.devicePixelRatio||1}),kve=function(n){var e=n.curve;return ie.exports.useMemo(function(){return pP().defined(function(t){return t.x!==null&&t.y!==null}).x(function(t){return t.x}).y(function(t){return t.y}).curve(_P(e))},[e])},Fve=function(n){var e=n.curve,t=n.yScale,r=n.areaBaselineValue;return ie.exports.useMemo(function(){return n1e().defined(function(i){return i.x!==null&&i.y!==null}).x(function(i){return i.x}).y1(function(i){return i.y}).curve(_P(e)).y0(t(r))},[e,t,r])},Hve=function(n){var e=n.enableSlices,t=n.points,r=n.width,i=n.height;return ie.exports.useMemo(function(){if(e===!1)return[];if(e==="x"){var s=new Map;return t.forEach(function(a){a.data.x!==null&&a.data.y!==null&&(s.has(a.x)?s.get(a.x).push(a):s.set(a.x,[a]))}),Array.from(s.entries()).sort(function(a,l){return a[0]-l[0]}).map(function(a,l,u){var c,h=a[0],d=a[1],f=u[l-1],m=u[l+1];return{id:h,x0:c=f?h-(h-f[0])/2:h,x:h,y0:0,y:0,width:m?h-c+(m[0]-h)/2:r-c,height:i,points:d.reverse()}})}if(e==="y"){var o=new Map;return t.forEach(function(a){a.data.x!==null&&a.data.y!==null&&(o.has(a.y)?o.get(a.y).push(a):o.set(a.y,[a]))}),Array.from(o.entries()).sort(function(a,l){return a[0]-l[0]}).map(function(a,l,u){var c,h,d=a[0],f=a[1],m=u[l-1],p=u[l+1];return c=m?d-(d-m[0])/2:d,h=p?d-c+(p[0]-d)/2:i-c,{id:d,x0:0,x:0,y0:c,y:d,width:r,height:h,points:f.reverse()}})}},[e,t])},ek=function(n){var e=n.data,t=n.xScale,r=t===void 0?oo.xScale:t,i=n.xFormat,s=n.yScale,o=s===void 0?oo.yScale:s,a=n.yFormat,l=n.width,u=n.height,c=n.colors,h=c===void 0?oo.colors:c,d=n.curve,f=d===void 0?oo.curve:d,m=n.areaBaselineValue,p=m===void 0?oo.areaBaselineValue:m,y=n.pointColor,C=y===void 0?oo.pointColor:y,b=n.pointBorderColor,v=b===void 0?oo.pointBorderColor:b,S=n.enableSlices,L=S===void 0?oo.enableSlicesTooltip:S,_=yg(i),P=yg(a),x=FD(h,"id"),I=rn(),R=dc(C,I),N=dc(v,I),H=ie.exports.useState([]),K=H[0],X=H[1],J=ie.exports.useMemo(function(){return T2e(e.filter(function(oe){return K.indexOf(oe.id)===-1}),r,o,l,u)},[e,K,r,o,l,u]),ue=J.xScale,se=J.yScale,O=J.series,g=ie.exports.useMemo(function(){var oe=e.map(function(ye){return{id:ye.id,label:ye.id,color:x(ye)}}),j=oe.map(function(ye){return mr({},O.find(function(ee){return ee.id===ye.id}),{color:ye.color})}).filter(function(ye){return Boolean(ye.id)});return{legendData:oe.map(function(ye){return mr({},ye,{hidden:!j.find(function(ee){return ee.id===ye.id})})}).reverse(),series:j}},[e,O,x]),E=g.legendData,A=g.series,U=ie.exports.useCallback(function(oe){X(function(j){return j.indexOf(oe)>-1?j.filter(function(ye){return ye!==oe}):[].concat(j,[oe])})},[]),G=function(oe){var j=oe.series,ye=oe.getPointColor,ee=oe.getPointBorderColor,T=oe.formatX,F=oe.formatY;return ie.exports.useMemo(function(){return j.reduce(function(Y,q){return[].concat(Y,q.data.filter(function(me){return me.position.x!==null&&me.position.y!==null}).map(function(me,Z){var Ce={id:q.id+"."+Z,index:Y.length+Z,serieId:q.id,serieColor:q.color,x:me.position.x,y:me.position.y};return Ce.color=ye(q),Ce.borderColor=ee(Ce),Ce.data=mr({},me.data,{xFormatted:T(me.data.x),yFormatted:F(me.data.y)}),Ce}))},[])},[j,ye,ee,T,F])}({series:A,getPointColor:R,getPointBorderColor:N,formatX:_,formatY:P}),V=Hve({enableSlices:L,points:G,width:l,height:u});return{legendData:E,toggleSerie:U,lineGenerator:kve({curve:f}),areaGenerator:Fve({curve:f,yScale:se,areaBaselineValue:p}),getColor:x,series:A,xScale:ue,yScale:se,slices:V,points:G}},tk=function(n){var e=n.areaBlendMode,t=n.areaOpacity,r=n.color,i=n.fill,s=n.path,o=Bi(),a=o.animate,l=o.config,u=dS(s),c=Ks({color:r,config:l,immediate:!a});return ce.jsx(Tn.path,{d:u,fill:i||c.color,fillOpacity:t,strokeWidth:0,style:{mixBlendMode:e}})};tk.propTypes={areaBlendMode:fS.isRequired,areaOpacity:M.exports.number.isRequired,color:M.exports.string,fill:M.exports.string,path:M.exports.string.isRequired};var nk=function(n){var e=n.areaGenerator,t=n.areaOpacity,r=n.areaBlendMode,i=n.lines.slice(0).reverse();return ce.jsx("g",{children:i.map(function(s){return ce.jsx(tk,mr({path:e(s.data.map(function(o){return o.position}))},mr({areaOpacity:t,areaBlendMode:r},s)),s.id)})})};nk.propTypes={areaGenerator:M.exports.func.isRequired,areaOpacity:M.exports.number.isRequired,areaBlendMode:fS.isRequired,lines:M.exports.arrayOf(M.exports.object).isRequired};var Uve=ie.exports.memo(nk),rk=function(n){var e=n.lineGenerator,t=n.points,r=n.color,i=n.thickness,s=ie.exports.useMemo(function(){return e(t)},[e,t]),o=dS(s);return ce.jsx(Tn.path,{d:o,fill:"none",strokeWidth:i,stroke:r})};rk.propTypes={points:M.exports.arrayOf(M.exports.shape({x:M.exports.oneOfType([M.exports.string,M.exports.number]),y:M.exports.oneOfType([M.exports.string,M.exports.number])})),lineGenerator:M.exports.func.isRequired,color:M.exports.string.isRequired,thickness:M.exports.number.isRequired};var Bve=ie.exports.memo(rk),ik=function(n){var e=n.lines,t=n.lineGenerator,r=n.lineWidth;return e.slice(0).reverse().map(function(i){var s=i.id,o=i.data,a=i.color;return ce.jsx(Bve,{id:s,points:o.map(function(l){return l.position}),lineGenerator:t,color:a,thickness:r},s)})};ik.propTypes={lines:M.exports.arrayOf(M.exports.shape({id:M.exports.oneOfType([M.exports.string,M.exports.number]).isRequired,color:M.exports.string.isRequired,data:M.exports.arrayOf(M.exports.shape({data:M.exports.shape({x:M.exports.oneOfType([M.exports.string,M.exports.number,M.exports.instanceOf(Date)]),y:M.exports.oneOfType([M.exports.string,M.exports.number,M.exports.instanceOf(Date)])}).isRequired,position:M.exports.shape({x:M.exports.number,y:M.exports.number}).isRequired})).isRequired})).isRequired,lineWidth:M.exports.number.isRequired,lineGenerator:M.exports.func.isRequired};var Vve=ie.exports.memo(ik),sk=function(n){var e=n.slice,t=n.axis,r=n.debug,i=n.tooltip,s=n.isCurrent,o=n.setCurrent,a=ef(),l=a.showTooltipFromEvent,u=a.hideTooltip,c=ie.exports.useCallback(function(f){l(ie.exports.createElement(i,{slice:e,axis:t}),f,"right"),o(e)},[l,i,e]),h=ie.exports.useCallback(function(f){l(ie.exports.createElement(i,{slice:e,axis:t}),f,"right")},[l,i,e]),d=ie.exports.useCallback(function(){u(),o(null)},[u]);return ce.jsx("rect",{x:e.x0,y:e.y0,width:e.width,height:e.height,stroke:"red",strokeWidth:r?1:0,strokeOpacity:.75,fill:"red",fillOpacity:s&&r?.35:0,onMouseEnter:c,onMouseMove:h,onMouseLeave:d})};sk.propTypes={slice:M.exports.object.isRequired,axis:M.exports.oneOf(["x","y"]).isRequired,debug:M.exports.bool.isRequired,height:M.exports.number.isRequired,tooltip:M.exports.oneOfType([M.exports.func,M.exports.object]),isCurrent:M.exports.bool.isRequired,setCurrent:M.exports.func.isRequired};var $ve=ie.exports.memo(sk),ok=function(n){var e=n.slices,t=n.axis,r=n.debug,i=n.height,s=n.tooltip,o=n.current,a=n.setCurrent;return e.map(function(l){return ce.jsx($ve,{slice:l,axis:t,debug:r,height:i,tooltip:s,setCurrent:a,isCurrent:o!==null&&o.id===l.id},l.id)})};ok.propTypes={slices:M.exports.arrayOf(M.exports.shape({id:M.exports.oneOfType([M.exports.number,M.exports.string,M.exports.instanceOf(Date)]).isRequired,x:M.exports.number.isRequired,y:M.exports.number.isRequired,points:M.exports.arrayOf(M.exports.object).isRequired})).isRequired,axis:M.exports.oneOf(["x","y"]).isRequired,debug:M.exports.bool.isRequired,height:M.exports.number.isRequired,tooltip:M.exports.oneOfType([M.exports.func,M.exports.object]).isRequired,current:M.exports.object,setCurrent:M.exports.func.isRequired};var Wve=ie.exports.memo(ok),ak=function(n){var e=n.points,t=n.symbol,r=n.size,i=n.borderWidth,s=n.enableLabel,o=n.label,a=n.labelYOffset,l=rn(),u=W0e(o),c=e.slice(0).reverse().map(function(h){return{id:h.id,x:h.x,y:h.y,datum:h.data,fill:h.color,stroke:h.borderColor,label:s?u(h.data):null}});return ce.jsx("g",{children:c.map(function(h){return ce.jsx(B0e,{x:h.x,y:h.y,datum:h.datum,symbol:t,size:r,color:h.fill,borderWidth:i,borderColor:h.stroke,label:h.label,labelYOffset:a,theme:l},h.id)})})};ak.propTypes={points:M.exports.arrayOf(M.exports.object),symbol:M.exports.func,size:M.exports.number.isRequired,color:M.exports.func.isRequired,borderWidth:M.exports.number.isRequired,borderColor:M.exports.func.isRequired,enableLabel:M.exports.bool.isRequired,label:M.exports.oneOfType([M.exports.string,M.exports.func]).isRequired,labelYOffset:M.exports.number};var Gve=ie.exports.memo(ak),lk=function(n){var e=n.points,t=n.width,r=n.height,i=n.margin,s=n.setCurrent,o=n.onMouseEnter,a=n.onMouseMove,l=n.onMouseLeave,u=n.onClick,c=n.tooltip,h=n.debug,d=ef(),f=d.showTooltipAt,m=d.hideTooltip,p=ie.exports.useCallback(function(v,S){f(ie.exports.createElement(c,{point:v}),[v.x+i.left,v.y+i.top],"top"),s(v),o&&o(v,S)},[s,f,c,o,i]),y=ie.exports.useCallback(function(v,S){f(ie.exports.createElement(c,{point:v}),[v.x+i.left,v.y+i.top],"top"),s(v),a&&a(v,S)},[s,f,c,a]),C=ie.exports.useCallback(function(v,S){m(),s(null),l&&l(v,S)},[m,s,l]),b=ie.exports.useCallback(function(v,S){u&&u(v,S)},[u]);return ce.jsx(Mve,{nodes:e,width:t,height:r,onMouseEnter:p,onMouseMove:y,onMouseLeave:C,onClick:b,debug:h})};lk.propTypes={points:M.exports.arrayOf(M.exports.object).isRequired,width:M.exports.number.isRequired,height:M.exports.number.isRequired,margin:M.exports.object.isRequired,setCurrent:M.exports.func.isRequired,onMouseEnter:M.exports.func,onMouseMove:M.exports.func,onMouseLeave:M.exports.func,onClick:M.exports.func,tooltip:M.exports.oneOfType([M.exports.func,M.exports.object]).isRequired,debug:M.exports.bool.isRequired};var zve=ie.exports.memo(lk),A5=function(n){var e=n.data,t=n.xScale,r=n.xFormat,i=n.yScale,s=n.yFormat,o=n.layers,a=n.curve,l=n.areaBaselineValue,u=n.colors,c=n.margin,h=n.width,d=n.height,f=n.axisTop,m=n.axisRight,p=n.axisBottom,y=n.axisLeft,C=n.enableGridX,b=n.enableGridY,v=n.gridXValues,S=n.gridYValues,L=n.lineWidth,_=n.enableArea,P=n.areaOpacity,x=n.areaBlendMode,I=n.enablePoints,R=n.pointSymbol,N=n.pointSize,H=n.pointColor,K=n.pointBorderWidth,X=n.pointBorderColor,J=n.enablePointLabel,ue=n.pointLabel,se=n.pointLabelYOffset,O=n.defs,g=n.fill,E=n.markers,A=n.legends,U=n.isInteractive,G=n.useMesh,V=n.debugMesh,oe=n.onMouseEnter,j=n.onMouseMove,ye=n.onMouseLeave,ee=n.onClick,T=n.tooltip,F=n.enableSlices,Y=n.debugSlices,q=n.sliceTooltip,me=n.enableCrosshair,Z=n.crosshairType,Ce=n.role,Re=P0(h,d,c),Ee=Re.margin,Me=Re.innerWidth,Te=Re.innerHeight,k=Re.outerWidth,B=Re.outerHeight,z=ek({data:e,xScale:t,xFormat:r,yScale:i,yFormat:s,width:Me,height:Te,colors:u,curve:a,areaBaselineValue:l,pointColor:H,pointBorderColor:X,enableSlices:F}),de=z.legendData,ne=z.toggleSerie,fe=z.lineGenerator,le=z.areaGenerator,ae=z.series,pe=z.xScale,te=z.yScale,he=z.slices,Se=z.points,be=rn(),_e=dc(H,be),$e=dc(X,be),Oe=ie.exports.useState(null),Ye=Oe[0],Xe=Oe[1],ot=ie.exports.useState(null),wt=ot[0],Br=ot[1],Vn={grid:ce.jsx(RD,{theme:be,width:Me,height:Te,xScale:C?pe:null,yScale:b?te:null,xValues:v,yValues:S},"grid"),markers:ce.jsx(GP,{markers:E,width:Me,height:Te,xScale:pe,yScale:te,theme:be},"markers"),axes:ce.jsx(SD,{xScale:pe,yScale:te,width:Me,height:Te,theme:be,top:f,right:m,bottom:p,left:y},"axes"),areas:null,lines:ce.jsx(Vve,{lines:ae,lineGenerator:fe,lineWidth:L},"lines"),slices:null,points:null,crosshair:null,mesh:null,legends:A.map(function(Pt,Ln){return ce.jsx(BD,mr({},Pt,{containerWidth:Me,containerHeight:Te,data:Pt.data||de,theme:be,toggleSerie:Pt.toggleSerie?ne:void 0}),"legend."+Ln)})},Ft=KP(O,ae,g);return _&&(Vn.areas=ce.jsx(Uve,{areaGenerator:le,areaOpacity:P,areaBlendMode:x,lines:ae},"areas")),U&&F!==!1&&(Vn.slices=ce.jsx(Wve,{slices:he,axis:F,debug:Y,height:Te,tooltip:q,current:wt,setCurrent:Br},"slices")),I&&(Vn.points=ce.jsx(Gve,{points:Se,symbol:R,size:N,color:_e,borderWidth:K,borderColor:$e,enableLabel:J,label:ue,labelYOffset:se},"points")),U&&me&&(Ye!==null&&(Vn.crosshair=ce.jsx(r5,{width:Me,height:Te,x:Ye.x,y:Ye.y,type:Z},"crosshair")),wt!==null&&(Vn.crosshair=ce.jsx(r5,{width:Me,height:Te,x:wt.x,y:wt.y,type:F},"crosshair"))),U&&G&&F===!1&&(Vn.mesh=ce.jsx(zve,{points:Se,width:Me,height:Te,margin:Ee,current:Ye,setCurrent:Xe,onMouseEnter:oe,onMouseMove:j,onMouseLeave:ye,onClick:ee,tooltip:T,debug:V},"mesh")),ce.jsx(mS,{defs:Ft,width:k,height:B,margin:Ee,role:Ce,children:o.map(function(Pt,Ln){return typeof Pt=="function"?ce.jsx(ie.exports.Fragment,{children:Pt(mr({},n,{innerWidth:Me,innerHeight:Te,series:ae,slices:he,points:Se,xScale:pe,yScale:te,lineGenerator:fe,areaGenerator:le,currentPoint:Ye,setCurrentPoint:Xe,currentSlice:wt,setCurrentSlice:Br}))},Ln):Vn[Pt]})})};A5.propTypes=Lve,A5.defaultProps=oo;var Yve=zP(A5),jve=function(n){return ce.jsx(rf,{children:function(e){var t=e.width,r=e.height;return ce.jsx(Yve,mr({width:t,height:r},n))}})},x5=function(n){var e=n.width,t=n.height,r=n.margin,i=n.pixelRatio,s=n.data,o=n.xScale,a=n.xFormat,l=n.yScale,u=n.yFormat,c=n.curve,h=n.layers,d=n.colors,f=n.lineWidth,m=n.enableArea,p=n.areaBaselineValue,y=n.areaOpacity,C=n.enablePoints,b=n.pointSize,v=n.pointColor,S=n.pointBorderWidth,L=n.pointBorderColor,_=n.enableGridX,P=n.gridXValues,x=n.enableGridY,I=n.gridYValues,R=n.axisTop,N=n.axisRight,H=n.axisBottom,K=n.axisLeft,X=n.legends,J=n.isInteractive,ue=n.debugMesh,se=n.onMouseLeave,O=n.onClick,g=n.tooltip,E=n.canvasRef,A=ie.exports.useRef(null),U=P0(e,t,r),G=U.margin,V=U.innerWidth,oe=U.innerHeight,j=U.outerWidth,ye=U.outerHeight,ee=rn(),T=ie.exports.useState(null),F=T[0],Y=T[1],q=ek({data:s,xScale:o,xFormat:a,yScale:l,yFormat:u,width:V,height:oe,colors:d,curve:c,areaBaselineValue:p,pointColor:v,pointBorderColor:L}),me=q.lineGenerator,Z=q.areaGenerator,Ce=q.series,Re=q.xScale,Ee=q.yScale,Me=q.points,Te=qD({points:Me,width:V,height:oe,debug:ue}),k=Te.delaunay,B=Te.voronoi;ie.exports.useEffect(function(){E&&(E.current=A.current),A.current.width=j*i,A.current.height=ye*i;var te=A.current.getContext("2d");te.scale(i,i),te.fillStyle=ee.background,te.fillRect(0,0,j,ye),te.translate(G.left,G.top),h.forEach(function(he){if(typeof he=="function"&&he({ctx:te,innerWidth:V,innerHeight:oe,series:Ce,points:Me,xScale:Re,yScale:Ee,lineWidth:f,lineGenerator:me,areaGenerator:Z,currentPoint:F,setCurrentPoint:Y}),he==="grid"&&ee.grid.line.strokeWidth>0&&(te.lineWidth=ee.grid.line.strokeWidth,te.strokeStyle=ee.grid.line.stroke,_&&Eg(te,{width:V,height:oe,scale:Re,axis:"x",values:P}),x&&Eg(te,{width:V,height:oe,scale:Ee,axis:"y",values:I})),he==="axes"&&TD(te,{xScale:Re,yScale:Ee,width:V,height:oe,top:R,right:N,bottom:H,left:K,theme:ee}),he==="areas"&&m===!0&&(te.save(),te.globalAlpha=y,Z.context(te),Ce.forEach(function(be){te.fillStyle=be.color,te.beginPath(),Z(be.data.map(function(_e){return _e.position})),te.fill()}),te.restore()),he==="lines"&&(me.context(te),Ce.forEach(function(be){te.strokeStyle=be.color,te.lineWidth=f,te.beginPath(),me(be.data.map(function(_e){return _e.position})),te.stroke()})),he==="points"&&C===!0&&b>0&&Me.forEach(function(be){te.fillStyle=be.color,te.beginPath(),te.arc(be.x,be.y,b/2,0,2*Math.PI),te.fill(),S>0&&(te.strokeStyle=be.borderColor,te.lineWidth=S,te.stroke())}),he==="mesh"&&ue===!0&&(Nve(te,B),F&&Ive(te,B,F.index)),he==="legends"){var Se=Ce.map(function(be){return{id:be.id,label:be.id,color:be.color}}).reverse();X.forEach(function(be){VD(te,mr({},be,{data:be.data||Se,containerWidth:V,containerHeight:oe,theme:ee}))})}})},[A,j,ye,h,ee,me,Ce,Re,Ee,_,P,x,I,R,N,H,K,X,Me,C,b,F]);var z=ie.exports.useCallback(function(te){var he=Fh(A.current,te),Se=he[0],be=he[1];if(!jP(G.left,G.top,V,oe,Se,be))return null;var _e=k.find(Se-G.left,be-G.top);return Me[_e]},[A,G,V,oe,k]),de=ef(),ne=de.showTooltipFromEvent,fe=de.hideTooltip,le=ie.exports.useCallback(function(te){var he=z(te);Y(he),he?ne(ie.exports.createElement(g,{point:he}),te):fe()},[z,Y,ne,fe,g]),ae=ie.exports.useCallback(function(te){fe(),Y(null),F&&se&&se(F,te)},[fe,Y,se]),pe=ie.exports.useCallback(function(te){if(O){var he=z(te);he&&O(he,te)}},[z,O]);return ce.jsx("canvas",{ref:A,width:j*i,height:ye*i,style:{width:j,height:ye,cursor:J?"auto":"normal"},onMouseEnter:J?le:void 0,onMouseMove:J?le:void 0,onMouseLeave:J?ae:void 0,onClick:J?pe:void 0})};x5.propTypes=Pve,x5.defaultProps=Dve;var Kve=zP(x5),qve=ie.exports.forwardRef(function(n,e){return ce.jsx(Kve,mr({},n,{canvasRef:e}))});ie.exports.forwardRef(function(n,e){return ce.jsx(rf,{children:function(t){var r=t.width,i=t.height;return ce.jsx(qve,mr({width:r,height:i},n,{ref:e}))}})});var uk={exports:{}};(function(n,e){(function(t){n.exports=t()})(function(){return function t(r,i,s){function o(u,c){if(!i[u]){if(!r[u]){var h=typeof zo=="function"&&zo;if(!c&&h)return h(u,!0);if(a)return a(u,!0);throw new Error("Cannot find module '"+u+"'")}c=i[u]={exports:{}},r[u][0].call(c.exports,function(d){var f=r[u][1][d];return o(f||d)},c,c.exports,t,r,i,s)}return i[u].exports}for(var a=typeof zo=="function"&&zo,l=0;l<s.length;l++)o(s[l]);return o}({1:[function(t,r,i){(function(s,o,a,l,u,c,h,d,f){var m=t("crypto");function p(_,P){P=b(_,P);var x;return(x=P.algorithm!=="passthrough"?m.createHash(P.algorithm):new L).write===void 0&&(x.write=x.update,x.end=x.update),S(P,x).dispatch(_),x.update||x.end(""),x.digest?x.digest(P.encoding==="buffer"?void 0:P.encoding):(_=x.read(),P.encoding!=="buffer"?_.toString(P.encoding):_)}(i=r.exports=p).sha1=function(_){return p(_)},i.keys=function(_){return p(_,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},i.MD5=function(_){return p(_,{algorithm:"md5",encoding:"hex"})},i.keysMD5=function(_){return p(_,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var y=m.getHashes?m.getHashes().slice():["sha1","md5"],C=(y.push("passthrough"),["buffer","hex","binary","base64"]);function b(_,P){var x={};if(x.algorithm=(P=P||{}).algorithm||"sha1",x.encoding=P.encoding||"hex",x.excludeValues=!!P.excludeValues,x.algorithm=x.algorithm.toLowerCase(),x.encoding=x.encoding.toLowerCase(),x.ignoreUnknown=P.ignoreUnknown===!0,x.respectType=P.respectType!==!1,x.respectFunctionNames=P.respectFunctionNames!==!1,x.respectFunctionProperties=P.respectFunctionProperties!==!1,x.unorderedArrays=P.unorderedArrays===!0,x.unorderedSets=P.unorderedSets!==!1,x.unorderedObjects=P.unorderedObjects!==!1,x.replacer=P.replacer||void 0,x.excludeKeys=P.excludeKeys||void 0,_===void 0)throw new Error("Object argument required.");for(var I=0;I<y.length;++I)y[I].toLowerCase()===x.algorithm.toLowerCase()&&(x.algorithm=y[I]);if(y.indexOf(x.algorithm)===-1)throw new Error('Algorithm "'+x.algorithm+'"  not supported. supported values: '+y.join(", "));if(C.indexOf(x.encoding)===-1&&x.algorithm!=="passthrough")throw new Error('Encoding "'+x.encoding+'"  not supported. supported values: '+C.join(", "));return x}function v(_){if(typeof _=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(_))!=null}function S(_,P,x){x=x||[];function I(R){return P.update?P.update(R,"utf8"):P.write(R,"utf8")}return{dispatch:function(R){return this["_"+((R=_.replacer?_.replacer(R):R)===null?"null":typeof R)](R)},_object:function(R){var N,H=Object.prototype.toString.call(R),K=/\[object (.*)\]/i.exec(H);if(K=(K=K?K[1]:"unknown:["+H+"]").toLowerCase(),0<=(H=x.indexOf(R)))return this.dispatch("[CIRCULAR:"+H+"]");if(x.push(R),a!==void 0&&a.isBuffer&&a.isBuffer(R))return I("buffer:"),I(R);if(K==="object"||K==="function"||K==="asyncfunction")return H=Object.keys(R),_.unorderedObjects&&(H=H.sort()),_.respectType===!1||v(R)||H.splice(0,0,"prototype","__proto__","constructor"),_.excludeKeys&&(H=H.filter(function(X){return!_.excludeKeys(X)})),I("object:"+H.length+":"),N=this,H.forEach(function(X){N.dispatch(X),I(":"),_.excludeValues||N.dispatch(R[X]),I(",")});if(!this["_"+K]){if(_.ignoreUnknown)return I("["+K+"]");throw new Error('Unknown object type "'+K+'"')}this["_"+K](R)},_array:function(R,X){X=X!==void 0?X:_.unorderedArrays!==!1;var H=this;if(I("array:"+R.length+":"),!X||R.length<=1)return R.forEach(function(J){return H.dispatch(J)});var K=[],X=R.map(function(J){var ue=new L,se=x.slice();return S(_,ue,se).dispatch(J),K=K.concat(se.slice(x.length)),ue.read().toString()});return x=x.concat(K),X.sort(),this._array(X,!1)},_date:function(R){return I("date:"+R.toJSON())},_symbol:function(R){return I("symbol:"+R.toString())},_error:function(R){return I("error:"+R.toString())},_boolean:function(R){return I("bool:"+R.toString())},_string:function(R){I("string:"+R.length+":"),I(R.toString())},_function:function(R){I("fn:"),v(R)?this.dispatch("[native]"):this.dispatch(R.toString()),_.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(R.name)),_.respectFunctionProperties&&this._object(R)},_number:function(R){return I("number:"+R.toString())},_xml:function(R){return I("xml:"+R.toString())},_null:function(){return I("Null")},_undefined:function(){return I("Undefined")},_regexp:function(R){return I("regex:"+R.toString())},_uint8array:function(R){return I("uint8array:"),this.dispatch(Array.prototype.slice.call(R))},_uint8clampedarray:function(R){return I("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(R))},_int8array:function(R){return I("int8array:"),this.dispatch(Array.prototype.slice.call(R))},_uint16array:function(R){return I("uint16array:"),this.dispatch(Array.prototype.slice.call(R))},_int16array:function(R){return I("int16array:"),this.dispatch(Array.prototype.slice.call(R))},_uint32array:function(R){return I("uint32array:"),this.dispatch(Array.prototype.slice.call(R))},_int32array:function(R){return I("int32array:"),this.dispatch(Array.prototype.slice.call(R))},_float32array:function(R){return I("float32array:"),this.dispatch(Array.prototype.slice.call(R))},_float64array:function(R){return I("float64array:"),this.dispatch(Array.prototype.slice.call(R))},_arraybuffer:function(R){return I("arraybuffer:"),this.dispatch(new Uint8Array(R))},_url:function(R){return I("url:"+R.toString())},_map:function(R){return I("map:"),R=Array.from(R),this._array(R,_.unorderedSets!==!1)},_set:function(R){return I("set:"),R=Array.from(R),this._array(R,_.unorderedSets!==!1)},_file:function(R){return I("file:"),this.dispatch([R.name,R.size,R.type,R.lastModfied])},_blob:function(){if(_.ignoreUnknown)return I("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return I("domwindow")},_bigint:function(R){return I("bigint:"+R.toString())},_process:function(){return I("process")},_timer:function(){return I("timer")},_pipe:function(){return I("pipe")},_tcp:function(){return I("tcp")},_udp:function(){return I("udp")},_tty:function(){return I("tty")},_statwatcher:function(){return I("statwatcher")},_securecontext:function(){return I("securecontext")},_connection:function(){return I("connection")},_zlib:function(){return I("zlib")},_context:function(){return I("context")},_nodescript:function(){return I("nodescript")},_httpparser:function(){return I("httpparser")},_dataview:function(){return I("dataview")},_signal:function(){return I("signal")},_fsevent:function(){return I("fsevent")},_tlswrap:function(){return I("tlswrap")}}}function L(){return{buf:"",write:function(_){this.buf+=_},end:function(_){this.buf+=_},read:function(){return this.buf}}}i.writeToStream=function(_,P,x){return x===void 0&&(x=P,P={}),S(P=b(_,P),x).dispatch(_)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(t,r,i){(function(s,o,a,l,u,c,h,d,f){(function(m){var p=typeof Uint8Array<"u"?Uint8Array:Array,y="+".charCodeAt(0),C="/".charCodeAt(0),b="0".charCodeAt(0),v="a".charCodeAt(0),S="A".charCodeAt(0),L="-".charCodeAt(0),_="_".charCodeAt(0);function P(x){return x=x.charCodeAt(0),x===y||x===L?62:x===C||x===_?63:x<b?-1:x<b+10?x-b+26+26:x<S+26?x-S:x<v+26?x-v+26:void 0}m.toByteArray=function(x){var I,R;if(0<x.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var N=x.length,N=x.charAt(N-2)==="="?2:x.charAt(N-1)==="="?1:0,H=new p(3*x.length/4-N),K=0<N?x.length-4:x.length,X=0;function J(ue){H[X++]=ue}for(I=0;I<K;I+=4,0)J((16711680&(R=P(x.charAt(I))<<18|P(x.charAt(I+1))<<12|P(x.charAt(I+2))<<6|P(x.charAt(I+3))))>>16),J((65280&R)>>8),J(255&R);return N==2?J(255&(R=P(x.charAt(I))<<2|P(x.charAt(I+1))>>4)):N==1&&(J((R=P(x.charAt(I))<<10|P(x.charAt(I+1))<<4|P(x.charAt(I+2))>>2)>>8&255),J(255&R)),H},m.fromByteArray=function(x){var I,R,N,H,K=x.length%3,X="";function J(ue){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(ue)}for(I=0,N=x.length-K;I<N;I+=3)R=(x[I]<<16)+(x[I+1]<<8)+x[I+2],X+=J((H=R)>>18&63)+J(H>>12&63)+J(H>>6&63)+J(63&H);switch(K){case 1:X=(X+=J((R=x[x.length-1])>>2))+J(R<<4&63)+"==";break;case 2:X=(X=(X+=J((R=(x[x.length-2]<<8)+x[x.length-1])>>10))+J(R>>4&63))+J(R<<2&63)+"="}return X}})(i===void 0?this.base64js={}:i)}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(t,r,i){(function(s,o,y,l,u,c,h,d,f){var m=t("base64-js"),p=t("ieee754");function y(T,F,Y){if(!(this instanceof y))return new y(T,F,Y);var q,me,Z,Ce,Re=typeof T;if(F==="base64"&&Re=="string")for(T=(Ce=T).trim?Ce.trim():Ce.replace(/^\s+|\s+$/g,"");T.length%4!=0;)T+="=";if(Re=="number")q=O(T);else if(Re=="string")q=y.byteLength(T,F);else{if(Re!="object")throw new Error("First argument needs to be a number, array or string.");q=O(T.length)}if(y._useTypedArrays?me=y._augment(new Uint8Array(q)):((me=this).length=q,me._isBuffer=!0),y._useTypedArrays&&typeof T.byteLength=="number")me._set(T);else if(g(Ce=T)||y.isBuffer(Ce)||Ce&&typeof Ce=="object"&&typeof Ce.length=="number")for(Z=0;Z<q;Z++)y.isBuffer(T)?me[Z]=T.readUInt8(Z):me[Z]=T[Z];else if(Re=="string")me.write(T,0,F);else if(Re=="number"&&!y._useTypedArrays&&!Y)for(Z=0;Z<q;Z++)me[Z]=0;return me}function C(T,F,Y,q){return y._charsWritten=G(function(me){for(var Z=[],Ce=0;Ce<me.length;Ce++)Z.push(255&me.charCodeAt(Ce));return Z}(F),T,Y,q)}function b(T,F,Y,q){return y._charsWritten=G(function(me){for(var Z,Ce,Re=[],Ee=0;Ee<me.length;Ee++)Ce=me.charCodeAt(Ee),Z=Ce>>8,Ce=Ce%256,Re.push(Ce),Re.push(Z);return Re}(F),T,Y,q)}function v(T,F,Y){var q="";Y=Math.min(T.length,Y);for(var me=F;me<Y;me++)q+=String.fromCharCode(T[me]);return q}function S(T,F,Y,Z){Z||(ee(typeof Y=="boolean","missing or invalid endian"),ee(F!=null,"missing offset"),ee(F+1<T.length,"Trying to read beyond buffer length"));var me,Z=T.length;if(!(Z<=F))return Y?(me=T[F],F+1<Z&&(me|=T[F+1]<<8)):(me=T[F]<<8,F+1<Z&&(me|=T[F+1])),me}function L(T,F,Y,Z){Z||(ee(typeof Y=="boolean","missing or invalid endian"),ee(F!=null,"missing offset"),ee(F+3<T.length,"Trying to read beyond buffer length"));var me,Z=T.length;if(!(Z<=F))return Y?(F+2<Z&&(me=T[F+2]<<16),F+1<Z&&(me|=T[F+1]<<8),me|=T[F],F+3<Z&&(me+=T[F+3]<<24>>>0)):(F+1<Z&&(me=T[F+1]<<16),F+2<Z&&(me|=T[F+2]<<8),F+3<Z&&(me|=T[F+3]),me+=T[F]<<24>>>0),me}function _(T,F,Y,q){if(q||(ee(typeof Y=="boolean","missing or invalid endian"),ee(F!=null,"missing offset"),ee(F+1<T.length,"Trying to read beyond buffer length")),!(T.length<=F))return q=S(T,F,Y,!0),32768&q?-1*(65535-q+1):q}function P(T,F,Y,q){if(q||(ee(typeof Y=="boolean","missing or invalid endian"),ee(F!=null,"missing offset"),ee(F+3<T.length,"Trying to read beyond buffer length")),!(T.length<=F))return q=L(T,F,Y,!0),2147483648&q?-1*(4294967295-q+1):q}function x(T,F,Y,q){return q||(ee(typeof Y=="boolean","missing or invalid endian"),ee(F+3<T.length,"Trying to read beyond buffer length")),p.read(T,F,Y,23,4)}function I(T,F,Y,q){return q||(ee(typeof Y=="boolean","missing or invalid endian"),ee(F+7<T.length,"Trying to read beyond buffer length")),p.read(T,F,Y,52,8)}function R(T,F,Y,q,me){if(me||(ee(F!=null,"missing value"),ee(typeof q=="boolean","missing or invalid endian"),ee(Y!=null,"missing offset"),ee(Y+1<T.length,"trying to write beyond buffer length"),oe(F,65535)),me=T.length,!(me<=Y))for(var Z=0,Ce=Math.min(me-Y,2);Z<Ce;Z++)T[Y+Z]=(F&255<<8*(q?Z:1-Z))>>>8*(q?Z:1-Z)}function N(T,F,Y,q,me){if(me||(ee(F!=null,"missing value"),ee(typeof q=="boolean","missing or invalid endian"),ee(Y!=null,"missing offset"),ee(Y+3<T.length,"trying to write beyond buffer length"),oe(F,4294967295)),me=T.length,!(me<=Y))for(var Z=0,Ce=Math.min(me-Y,4);Z<Ce;Z++)T[Y+Z]=F>>>8*(q?Z:3-Z)&255}function H(T,F,Y,q,me){me||(ee(F!=null,"missing value"),ee(typeof q=="boolean","missing or invalid endian"),ee(Y!=null,"missing offset"),ee(Y+1<T.length,"Trying to write beyond buffer length"),j(F,32767,-32768)),T.length<=Y||R(T,0<=F?F:65535+F+1,Y,q,me)}function K(T,F,Y,q,me){me||(ee(F!=null,"missing value"),ee(typeof q=="boolean","missing or invalid endian"),ee(Y!=null,"missing offset"),ee(Y+3<T.length,"Trying to write beyond buffer length"),j(F,2147483647,-2147483648)),T.length<=Y||N(T,0<=F?F:4294967295+F+1,Y,q,me)}function X(T,F,Y,q,me){me||(ee(F!=null,"missing value"),ee(typeof q=="boolean","missing or invalid endian"),ee(Y!=null,"missing offset"),ee(Y+3<T.length,"Trying to write beyond buffer length"),ye(F,34028234663852886e22,-34028234663852886e22)),T.length<=Y||p.write(T,F,Y,q,23,4)}function J(T,F,Y,q,me){me||(ee(F!=null,"missing value"),ee(typeof q=="boolean","missing or invalid endian"),ee(Y!=null,"missing offset"),ee(Y+7<T.length,"Trying to write beyond buffer length"),ye(F,17976931348623157e292,-17976931348623157e292)),T.length<=Y||p.write(T,F,Y,q,52,8)}i.Buffer=y,i.SlowBuffer=y,i.INSPECT_MAX_BYTES=50,y.poolSize=8192,y._useTypedArrays=function(){try{var T=new ArrayBuffer(0),F=new Uint8Array(T);return F.foo=function(){return 42},F.foo()===42&&typeof F.subarray=="function"}catch{return!1}}(),y.isEncoding=function(T){switch(String(T).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},y.isBuffer=function(T){return!(T==null||!T._isBuffer)},y.byteLength=function(T,F){var Y;switch(T+="",F||"utf8"){case"hex":Y=T.length/2;break;case"utf8":case"utf-8":Y=A(T).length;break;case"ascii":case"binary":case"raw":Y=T.length;break;case"base64":Y=U(T).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":Y=2*T.length;break;default:throw new Error("Unknown encoding")}return Y},y.concat=function(T,F){if(ee(g(T),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),T.length===0)return new y(0);if(T.length===1)return T[0];if(typeof F!="number")for(me=F=0;me<T.length;me++)F+=T[me].length;for(var Y=new y(F),q=0,me=0;me<T.length;me++){var Z=T[me];Z.copy(Y,q),q+=Z.length}return Y},y.prototype.write=function(T,F,Y,q){isFinite(F)?isFinite(Y)||(q=Y,Y=void 0):(Ee=q,q=F,F=Y,Y=Ee),F=Number(F)||0;var me,Z,Ce,Re,Ee=this.length-F;switch((!Y||Ee<(Y=Number(Y)))&&(Y=Ee),q=String(q||"utf8").toLowerCase()){case"hex":me=function(Me,Te,k,B){k=Number(k)||0;var z=Me.length-k;(!B||z<(B=Number(B)))&&(B=z),ee((z=Te.length)%2==0,"Invalid hex string"),z/2<B&&(B=z/2);for(var de=0;de<B;de++){var ne=parseInt(Te.substr(2*de,2),16);ee(!isNaN(ne),"Invalid hex string"),Me[k+de]=ne}return y._charsWritten=2*de,de}(this,T,F,Y);break;case"utf8":case"utf-8":Z=this,Ce=F,Re=Y,me=y._charsWritten=G(A(T),Z,Ce,Re);break;case"ascii":case"binary":me=C(this,T,F,Y);break;case"base64":Z=this,Ce=F,Re=Y,me=y._charsWritten=G(U(T),Z,Ce,Re);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":me=b(this,T,F,Y);break;default:throw new Error("Unknown encoding")}return me},y.prototype.toString=function(T,F,Y){var q,me,Z,Ce,Re=this;if(T=String(T||"utf8").toLowerCase(),F=Number(F)||0,(Y=Y!==void 0?Number(Y):Re.length)===F)return"";switch(T){case"hex":q=function(Ee,Me,Te){var k=Ee.length;(!Me||Me<0)&&(Me=0),(!Te||Te<0||k<Te)&&(Te=k);for(var B="",z=Me;z<Te;z++)B+=E(Ee[z]);return B}(Re,F,Y);break;case"utf8":case"utf-8":q=function(Ee,Me,Te){var k="",B="";Te=Math.min(Ee.length,Te);for(var z=Me;z<Te;z++)Ee[z]<=127?(k+=V(B)+String.fromCharCode(Ee[z]),B=""):B+="%"+Ee[z].toString(16);return k+V(B)}(Re,F,Y);break;case"ascii":case"binary":q=v(Re,F,Y);break;case"base64":me=Re,Ce=Y,q=(Z=F)===0&&Ce===me.length?m.fromByteArray(me):m.fromByteArray(me.slice(Z,Ce));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":q=function(Ee,Me,Te){for(var k=Ee.slice(Me,Te),B="",z=0;z<k.length;z+=2)B+=String.fromCharCode(k[z]+256*k[z+1]);return B}(Re,F,Y);break;default:throw new Error("Unknown encoding")}return q},y.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},y.prototype.copy=function(T,F,Y,q){if(F=F||0,(q=q||q===0?q:this.length)!==(Y=Y||0)&&T.length!==0&&this.length!==0){ee(Y<=q,"sourceEnd < sourceStart"),ee(0<=F&&F<T.length,"targetStart out of bounds"),ee(0<=Y&&Y<this.length,"sourceStart out of bounds"),ee(0<=q&&q<=this.length,"sourceEnd out of bounds"),q>this.length&&(q=this.length);var me=(q=T.length-F<q-Y?T.length-F+Y:q)-Y;if(me<100||!y._useTypedArrays)for(var Z=0;Z<me;Z++)T[Z+F]=this[Z+Y];else T._set(this.subarray(Y,Y+me),F)}},y.prototype.slice=function(T,F){var Y=this.length;if(T=se(T,Y,0),F=se(F,Y,Y),y._useTypedArrays)return y._augment(this.subarray(T,F));for(var q=F-T,me=new y(q,void 0,!0),Z=0;Z<q;Z++)me[Z]=this[Z+T];return me},y.prototype.get=function(T){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(T)},y.prototype.set=function(T,F){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(T,F)},y.prototype.readUInt8=function(T,F){if(F||(ee(T!=null,"missing offset"),ee(T<this.length,"Trying to read beyond buffer length")),!(T>=this.length))return this[T]},y.prototype.readUInt16LE=function(T,F){return S(this,T,!0,F)},y.prototype.readUInt16BE=function(T,F){return S(this,T,!1,F)},y.prototype.readUInt32LE=function(T,F){return L(this,T,!0,F)},y.prototype.readUInt32BE=function(T,F){return L(this,T,!1,F)},y.prototype.readInt8=function(T,F){if(F||(ee(T!=null,"missing offset"),ee(T<this.length,"Trying to read beyond buffer length")),!(T>=this.length))return 128&this[T]?-1*(255-this[T]+1):this[T]},y.prototype.readInt16LE=function(T,F){return _(this,T,!0,F)},y.prototype.readInt16BE=function(T,F){return _(this,T,!1,F)},y.prototype.readInt32LE=function(T,F){return P(this,T,!0,F)},y.prototype.readInt32BE=function(T,F){return P(this,T,!1,F)},y.prototype.readFloatLE=function(T,F){return x(this,T,!0,F)},y.prototype.readFloatBE=function(T,F){return x(this,T,!1,F)},y.prototype.readDoubleLE=function(T,F){return I(this,T,!0,F)},y.prototype.readDoubleBE=function(T,F){return I(this,T,!1,F)},y.prototype.writeUInt8=function(T,F,Y){Y||(ee(T!=null,"missing value"),ee(F!=null,"missing offset"),ee(F<this.length,"trying to write beyond buffer length"),oe(T,255)),F>=this.length||(this[F]=T)},y.prototype.writeUInt16LE=function(T,F,Y){R(this,T,F,!0,Y)},y.prototype.writeUInt16BE=function(T,F,Y){R(this,T,F,!1,Y)},y.prototype.writeUInt32LE=function(T,F,Y){N(this,T,F,!0,Y)},y.prototype.writeUInt32BE=function(T,F,Y){N(this,T,F,!1,Y)},y.prototype.writeInt8=function(T,F,Y){Y||(ee(T!=null,"missing value"),ee(F!=null,"missing offset"),ee(F<this.length,"Trying to write beyond buffer length"),j(T,127,-128)),F>=this.length||(0<=T?this.writeUInt8(T,F,Y):this.writeUInt8(255+T+1,F,Y))},y.prototype.writeInt16LE=function(T,F,Y){H(this,T,F,!0,Y)},y.prototype.writeInt16BE=function(T,F,Y){H(this,T,F,!1,Y)},y.prototype.writeInt32LE=function(T,F,Y){K(this,T,F,!0,Y)},y.prototype.writeInt32BE=function(T,F,Y){K(this,T,F,!1,Y)},y.prototype.writeFloatLE=function(T,F,Y){X(this,T,F,!0,Y)},y.prototype.writeFloatBE=function(T,F,Y){X(this,T,F,!1,Y)},y.prototype.writeDoubleLE=function(T,F,Y){J(this,T,F,!0,Y)},y.prototype.writeDoubleBE=function(T,F,Y){J(this,T,F,!1,Y)},y.prototype.fill=function(T,F,Y){if(F=F||0,Y=Y||this.length,ee(typeof(T=typeof(T=T||0)=="string"?T.charCodeAt(0):T)=="number"&&!isNaN(T),"value is not a number"),ee(F<=Y,"end < start"),Y!==F&&this.length!==0){ee(0<=F&&F<this.length,"start out of bounds"),ee(0<=Y&&Y<=this.length,"end out of bounds");for(var q=F;q<Y;q++)this[q]=T}},y.prototype.inspect=function(){for(var T=[],F=this.length,Y=0;Y<F;Y++)if(T[Y]=E(this[Y]),Y===i.INSPECT_MAX_BYTES){T[Y+1]="...";break}return"<Buffer "+T.join(" ")+">"},y.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(y._useTypedArrays)return new y(this).buffer;for(var T=new Uint8Array(this.length),F=0,Y=T.length;F<Y;F+=1)T[F]=this[F];return T.buffer};var ue=y.prototype;function se(T,F,Y){return typeof T!="number"?Y:F<=(T=~~T)?F:0<=T||0<=(T+=F)?T:0}function O(T){return(T=~~Math.ceil(+T))<0?0:T}function g(T){return(Array.isArray||function(F){return Object.prototype.toString.call(F)==="[object Array]"})(T)}function E(T){return T<16?"0"+T.toString(16):T.toString(16)}function A(T){for(var F=[],Y=0;Y<T.length;Y++){var q=T.charCodeAt(Y);if(q<=127)F.push(T.charCodeAt(Y));else for(var me=Y,Z=(55296<=q&&q<=57343&&Y++,encodeURIComponent(T.slice(me,Y+1)).substr(1).split("%")),Ce=0;Ce<Z.length;Ce++)F.push(parseInt(Z[Ce],16))}return F}function U(T){return m.toByteArray(T)}function G(T,F,Y,q){for(var me=0;me<q&&!(me+Y>=F.length||me>=T.length);me++)F[me+Y]=T[me];return me}function V(T){try{return decodeURIComponent(T)}catch{return String.fromCharCode(65533)}}function oe(T,F){ee(typeof T=="number","cannot write a non-number as a number"),ee(0<=T,"specified a negative value for writing an unsigned value"),ee(T<=F,"value is larger than maximum value for type"),ee(Math.floor(T)===T,"value has a fractional component")}function j(T,F,Y){ee(typeof T=="number","cannot write a non-number as a number"),ee(T<=F,"value larger than maximum allowed value"),ee(Y<=T,"value smaller than minimum allowed value"),ee(Math.floor(T)===T,"value has a fractional component")}function ye(T,F,Y){ee(typeof T=="number","cannot write a non-number as a number"),ee(T<=F,"value larger than maximum allowed value"),ee(Y<=T,"value smaller than minimum allowed value")}function ee(T,F){if(!T)throw new Error(F||"Failed assertion")}y._augment=function(T){return T._isBuffer=!0,T._get=T.get,T._set=T.set,T.get=ue.get,T.set=ue.set,T.write=ue.write,T.toString=ue.toString,T.toLocaleString=ue.toString,T.toJSON=ue.toJSON,T.copy=ue.copy,T.slice=ue.slice,T.readUInt8=ue.readUInt8,T.readUInt16LE=ue.readUInt16LE,T.readUInt16BE=ue.readUInt16BE,T.readUInt32LE=ue.readUInt32LE,T.readUInt32BE=ue.readUInt32BE,T.readInt8=ue.readInt8,T.readInt16LE=ue.readInt16LE,T.readInt16BE=ue.readInt16BE,T.readInt32LE=ue.readInt32LE,T.readInt32BE=ue.readInt32BE,T.readFloatLE=ue.readFloatLE,T.readFloatBE=ue.readFloatBE,T.readDoubleLE=ue.readDoubleLE,T.readDoubleBE=ue.readDoubleBE,T.writeUInt8=ue.writeUInt8,T.writeUInt16LE=ue.writeUInt16LE,T.writeUInt16BE=ue.writeUInt16BE,T.writeUInt32LE=ue.writeUInt32LE,T.writeUInt32BE=ue.writeUInt32BE,T.writeInt8=ue.writeInt8,T.writeInt16LE=ue.writeInt16LE,T.writeInt16BE=ue.writeInt16BE,T.writeInt32LE=ue.writeInt32LE,T.writeInt32BE=ue.writeInt32BE,T.writeFloatLE=ue.writeFloatLE,T.writeFloatBE=ue.writeFloatBE,T.writeDoubleLE=ue.writeDoubleLE,T.writeDoubleBE=ue.writeDoubleBE,T.fill=ue.fill,T.inspect=ue.inspect,T.toArrayBuffer=ue.toArrayBuffer,T}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(t,r,i){(function(s,o,m,l,u,c,h,d,f){var m=t("buffer").Buffer,p=4,y=new m(p);y.fill(0),r.exports={hash:function(C,b,v,S){for(var L=b(function(R,N){R.length%p!=0&&(H=R.length+(p-R.length%p),R=m.concat([R,y],H));for(var H,K=[],X=N?R.readInt32BE:R.readInt32LE,J=0;J<R.length;J+=p)K.push(X.call(R,J));return K}(C=m.isBuffer(C)?C:new m(C),S),8*C.length),b=S,_=new m(v),P=b?_.writeInt32BE:_.writeInt32LE,x=0;x<L.length;x++)P.call(_,L[x],4*x,!0);return _}}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(t,r,i){(function(s,o,m,l,u,c,h,d,f){var m=t("buffer").Buffer,p=t("./sha"),y=t("./sha256"),C=t("./rng"),b={sha1:p,sha256:y,md5:t("./md5")},v=64,S=new m(v);function L(R,N){var H=b[R=R||"sha1"],K=[];return H||_("algorithm:",R,"is not yet supported"),{update:function(X){return m.isBuffer(X)||(X=new m(X)),K.push(X),X.length,this},digest:function(X){var J=m.concat(K),J=N?function(ue,se,O){m.isBuffer(se)||(se=new m(se)),m.isBuffer(O)||(O=new m(O)),se.length>v?se=ue(se):se.length<v&&(se=m.concat([se,S],v));for(var g=new m(v),E=new m(v),A=0;A<v;A++)g[A]=54^se[A],E[A]=92^se[A];return O=ue(m.concat([g,O])),ue(m.concat([E,O]))}(H,N,J):H(J);return K=null,X?J.toString(X):J}}}function _(){var R=[].slice.call(arguments).join(" ");throw new Error([R,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}S.fill(0),i.createHash=function(R){return L(R)},i.createHmac=L,i.randomBytes=function(R,N){if(!N||!N.call)return new m(C(R));try{N.call(this,void 0,new m(C(R)))}catch(H){N(H)}};var P,x=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],I=function(R){i[R]=function(){_("sorry,",R,"is not implemented yet")}};for(P in x)I(x[P])}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(t,r,i){(function(s,o,a,l,u,c,h,d,f){var m=t("./helpers");function p(_,P){_[P>>5]|=128<<P%32,_[14+(P+64>>>9<<4)]=P;for(var x=1732584193,I=-271733879,R=-1732584194,N=271733878,H=0;H<_.length;H+=16){var K=x,X=I,J=R,ue=N,x=C(x,I,R,N,_[H+0],7,-680876936),N=C(N,x,I,R,_[H+1],12,-389564586),R=C(R,N,x,I,_[H+2],17,606105819),I=C(I,R,N,x,_[H+3],22,-1044525330);x=C(x,I,R,N,_[H+4],7,-176418897),N=C(N,x,I,R,_[H+5],12,1200080426),R=C(R,N,x,I,_[H+6],17,-1473231341),I=C(I,R,N,x,_[H+7],22,-45705983),x=C(x,I,R,N,_[H+8],7,1770035416),N=C(N,x,I,R,_[H+9],12,-1958414417),R=C(R,N,x,I,_[H+10],17,-42063),I=C(I,R,N,x,_[H+11],22,-1990404162),x=C(x,I,R,N,_[H+12],7,1804603682),N=C(N,x,I,R,_[H+13],12,-40341101),R=C(R,N,x,I,_[H+14],17,-1502002290),x=b(x,I=C(I,R,N,x,_[H+15],22,1236535329),R,N,_[H+1],5,-165796510),N=b(N,x,I,R,_[H+6],9,-1069501632),R=b(R,N,x,I,_[H+11],14,643717713),I=b(I,R,N,x,_[H+0],20,-373897302),x=b(x,I,R,N,_[H+5],5,-701558691),N=b(N,x,I,R,_[H+10],9,38016083),R=b(R,N,x,I,_[H+15],14,-660478335),I=b(I,R,N,x,_[H+4],20,-405537848),x=b(x,I,R,N,_[H+9],5,568446438),N=b(N,x,I,R,_[H+14],9,-1019803690),R=b(R,N,x,I,_[H+3],14,-187363961),I=b(I,R,N,x,_[H+8],20,1163531501),x=b(x,I,R,N,_[H+13],5,-1444681467),N=b(N,x,I,R,_[H+2],9,-51403784),R=b(R,N,x,I,_[H+7],14,1735328473),x=v(x,I=b(I,R,N,x,_[H+12],20,-1926607734),R,N,_[H+5],4,-378558),N=v(N,x,I,R,_[H+8],11,-2022574463),R=v(R,N,x,I,_[H+11],16,1839030562),I=v(I,R,N,x,_[H+14],23,-35309556),x=v(x,I,R,N,_[H+1],4,-1530992060),N=v(N,x,I,R,_[H+4],11,1272893353),R=v(R,N,x,I,_[H+7],16,-155497632),I=v(I,R,N,x,_[H+10],23,-1094730640),x=v(x,I,R,N,_[H+13],4,681279174),N=v(N,x,I,R,_[H+0],11,-358537222),R=v(R,N,x,I,_[H+3],16,-722521979),I=v(I,R,N,x,_[H+6],23,76029189),x=v(x,I,R,N,_[H+9],4,-640364487),N=v(N,x,I,R,_[H+12],11,-421815835),R=v(R,N,x,I,_[H+15],16,530742520),x=S(x,I=v(I,R,N,x,_[H+2],23,-995338651),R,N,_[H+0],6,-198630844),N=S(N,x,I,R,_[H+7],10,1126891415),R=S(R,N,x,I,_[H+14],15,-1416354905),I=S(I,R,N,x,_[H+5],21,-57434055),x=S(x,I,R,N,_[H+12],6,1700485571),N=S(N,x,I,R,_[H+3],10,-1894986606),R=S(R,N,x,I,_[H+10],15,-1051523),I=S(I,R,N,x,_[H+1],21,-2054922799),x=S(x,I,R,N,_[H+8],6,1873313359),N=S(N,x,I,R,_[H+15],10,-30611744),R=S(R,N,x,I,_[H+6],15,-1560198380),I=S(I,R,N,x,_[H+13],21,1309151649),x=S(x,I,R,N,_[H+4],6,-145523070),N=S(N,x,I,R,_[H+11],10,-1120210379),R=S(R,N,x,I,_[H+2],15,718787259),I=S(I,R,N,x,_[H+9],21,-343485551),x=L(x,K),I=L(I,X),R=L(R,J),N=L(N,ue)}return Array(x,I,R,N)}function y(_,P,x,I,R,N){return L((P=L(L(P,_),L(I,N)))<<R|P>>>32-R,x)}function C(_,P,x,I,R,N,H){return y(P&x|~P&I,_,P,R,N,H)}function b(_,P,x,I,R,N,H){return y(P&I|x&~I,_,P,R,N,H)}function v(_,P,x,I,R,N,H){return y(P^x^I,_,P,R,N,H)}function S(_,P,x,I,R,N,H){return y(x^(P|~I),_,P,R,N,H)}function L(_,P){var x=(65535&_)+(65535&P);return(_>>16)+(P>>16)+(x>>16)<<16|65535&x}r.exports=function(_){return m.hash(_,p,16)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(t,r,i){(function(s,o,a,l,u,c,h,d,f){r.exports=function(m){for(var p,y=new Array(m),C=0;C<m;C++)(3&C)==0&&(p=4294967296*Math.random()),y[C]=p>>>((3&C)<<3)&255;return y}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(t,r,i){(function(s,o,a,l,u,c,h,d,f){var m=t("./helpers");function p(b,v){b[v>>5]|=128<<24-v%32,b[15+(v+64>>9<<4)]=v;for(var S,L,_,P=Array(80),x=1732584193,I=-271733879,R=-1732584194,N=271733878,H=-1009589776,K=0;K<b.length;K+=16){for(var X=x,J=I,ue=R,se=N,O=H,g=0;g<80;g++){P[g]=g<16?b[K+g]:C(P[g-3]^P[g-8]^P[g-14]^P[g-16],1);var E=y(y(C(x,5),(E=I,L=R,_=N,(S=g)<20?E&L|~E&_:!(S<40)&&S<60?E&L|E&_|L&_:E^L^_)),y(y(H,P[g]),(S=g)<20?1518500249:S<40?1859775393:S<60?-1894007588:-899497514)),H=N,N=R,R=C(I,30),I=x,x=E}x=y(x,X),I=y(I,J),R=y(R,ue),N=y(N,se),H=y(H,O)}return Array(x,I,R,N,H)}function y(b,v){var S=(65535&b)+(65535&v);return(b>>16)+(v>>16)+(S>>16)<<16|65535&S}function C(b,v){return b<<v|b>>>32-v}r.exports=function(b){return m.hash(b,p,20,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(t,r,i){(function(s,o,a,l,u,c,h,d,f){function m(v,S){var L=(65535&v)+(65535&S);return(v>>16)+(S>>16)+(L>>16)<<16|65535&L}function p(v,S){var L,_=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),P=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),x=new Array(64);v[S>>5]|=128<<24-S%32,v[15+(S+64>>9<<4)]=S;for(var I,R,N=0;N<v.length;N+=16){for(var H=P[0],K=P[1],X=P[2],J=P[3],ue=P[4],se=P[5],O=P[6],g=P[7],E=0;E<64;E++)x[E]=E<16?v[E+N]:m(m(m((R=x[E-2],C(R,17)^C(R,19)^b(R,10)),x[E-7]),(R=x[E-15],C(R,7)^C(R,18)^b(R,3))),x[E-16]),L=m(m(m(m(g,C(R=ue,6)^C(R,11)^C(R,25)),ue&se^~ue&O),_[E]),x[E]),I=m(C(I=H,2)^C(I,13)^C(I,22),H&K^H&X^K&X),g=O,O=se,se=ue,ue=m(J,L),J=X,X=K,K=H,H=m(L,I);P[0]=m(H,P[0]),P[1]=m(K,P[1]),P[2]=m(X,P[2]),P[3]=m(J,P[3]),P[4]=m(ue,P[4]),P[5]=m(se,P[5]),P[6]=m(O,P[6]),P[7]=m(g,P[7])}return P}var y=t("./helpers"),C=function(v,S){return v>>>S|v<<32-S},b=function(v,S){return v>>>S};r.exports=function(v){return y.hash(v,p,32,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(t,r,i){(function(s,o,a,l,u,c,h,d,f){i.read=function(m,p,y,C,N){var v,S,L=8*N-C-1,_=(1<<L)-1,P=_>>1,x=-7,I=y?N-1:0,R=y?-1:1,N=m[p+I];for(I+=R,v=N&(1<<-x)-1,N>>=-x,x+=L;0<x;v=256*v+m[p+I],I+=R,x-=8);for(S=v&(1<<-x)-1,v>>=-x,x+=C;0<x;S=256*S+m[p+I],I+=R,x-=8);if(v===0)v=1-P;else{if(v===_)return S?NaN:1/0*(N?-1:1);S+=Math.pow(2,C),v-=P}return(N?-1:1)*S*Math.pow(2,v-C)},i.write=function(m,p,y,C,b,H){var S,L,_=8*H-b-1,P=(1<<_)-1,x=P>>1,I=b===23?Math.pow(2,-24)-Math.pow(2,-77):0,R=C?0:H-1,N=C?1:-1,H=p<0||p===0&&1/p<0?1:0;for(p=Math.abs(p),isNaN(p)||p===1/0?(L=isNaN(p)?1:0,S=P):(S=Math.floor(Math.log(p)/Math.LN2),p*(C=Math.pow(2,-S))<1&&(S--,C*=2),2<=(p+=1<=S+x?I/C:I*Math.pow(2,1-x))*C&&(S++,C/=2),P<=S+x?(L=0,S=P):1<=S+x?(L=(p*C-1)*Math.pow(2,b),S+=x):(L=p*Math.pow(2,x-1)*Math.pow(2,b),S=0));8<=b;m[y+R]=255&L,R+=N,L/=256,b-=8);for(S=S<<b|L,_+=b;0<_;m[y+R]=255&S,R+=N,S/=256,_-=8);m[y+R-N]|=128*H}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(t,r,i){(function(s,o,a,l,u,c,h,d,f){var m,p,y;function C(){}(s=r.exports={}).nextTick=(p=typeof window<"u"&&window.setImmediate,y=typeof window<"u"&&window.postMessage&&window.addEventListener,p?function(b){return window.setImmediate(b)}:y?(m=[],window.addEventListener("message",function(b){var v=b.source;v!==window&&v!==null||b.data!=="process-tick"||(b.stopPropagation(),0<m.length&&m.shift()())},!0),function(b){m.push(b),window.postMessage("process-tick","*")}):function(b){setTimeout(b,0)}),s.title="browser",s.browser=!0,s.env={},s.argv=[],s.on=C,s.addListener=C,s.once=C,s.off=C,s.removeListener=C,s.removeAllListeners=C,s.emit=C,s.binding=function(b){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(b){throw new Error("process.chdir is not supported")}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(uk);const Xve=uk.exports,Qve=I5([]);function Zve(){const[n]=rs(O5),[e,t]=rs(Qve),{data:r,tags:i}=Us.exports.useLiveQuery(async()=>{const s=(await fo.expenditure.where(Nt.datetime).between(St().subtract(6,"months").unix(),St().unix(),!0,!0).toArray()).filter(l=>l.txn_type===Gn.CREDIT),o=Or(s).countBy(Nt.category).toPairs().sortBy(1).reverse().map(l=>l[0]).value();return{data:Or(s).filter(l=>e.includes(l[Nt.category])).value(),tags:o}},[Xve(e)])||{data:[],tags:[]};return console.log(rA(r)),we.createElement("div",{style:{marginBottom:20}},we.createElement(yo,{variant:"h6"},"Last 6 months"),we.createElement(gy,{size:"small",multiple:!0,clearOnEscape:!0,freeSolo:!0,autoSelect:!0,autoComplete:!0,options:i,sx:{width:"80vw"},value:e,onChange:(s,o)=>t(o),renderInput:s=>we.createElement(Ba,{...s,label:"Source"})}),r.length===0?we.createElement(we.Fragment,null):we.createElement(Gu,{sx:Or.omit(ck,["m"])},we.createElement(jve,{data:rA(r),margin:{top:50,right:40,bottom:50,left:60},xScale:{type:"point"},yScale:{type:"linear",min:"auto",max:"auto",stacked:!0,reverse:!1},theme:{axis:{legend:{text:{fill:n?"#939393":"#000"}},ticks:{text:{fill:n?"#939393":"#000"}}}},yFormat:" >-.2f",pointSize:10,pointColor:{theme:"background"},pointBorderWidth:2,pointBorderColor:{from:"serieColor"},pointLabelYOffset:-12,useMesh:!0,tooltip:s=>we.createElement(hk,null,we.createElement(yo,null,s.point.serieId.replace("/","")),we.createElement(yo,null,s.point.data.x,": ",s.point.data.y))})))}function rA(n){return Or(n).map(e=>({...e,datetime:St.unix(e.datetime).format("MMM YY")})).groupBy(Nt.category).mapValues(e=>Or(e).groupBy(Nt.datetime).mapValues(t=>Or.sumBy(t,r=>r.amount)).toPairs().map(t=>({x:t[0],y:t[1]})).sortBy(t=>St(t.x,"MMM YY")).value()).toPairs().map(e=>({id:e[0],data:e[1]})).value()}oN();function Jve(){return we.createElement(gt,{container:!0,justifyContent:"center",alignItems:"center",direction:"column",spacing:2},we.createElement(gt,{item:!0},we.createElement(Ace,null)),we.createElement(gt,{item:!0},we.createElement(Y5e,null)),we.createElement(gt,{item:!0},we.createElement(Zve,null)),we.createElement(gt,{item:!0},we.createElement(hve,null)))}const ck={m:4,height:"40vh",width:"80vw",textAlign:"center"},hk=({children:n})=>{const[e]=rs(O5);return we.createElement(Gu,{sx:{backgroundColor:e?"#000":"#fff",padding:"5px 10px 5px 10px",borderRadius:"25px"}},n)};var eCe={exports:{}};(function(n,e){(function(t,r){n.exports=r(Tk())})(Go,function(t){function r(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var i=r(t),s={name:"en-sg",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),weekStart:1,weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),ordinal:function(o){return o},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"}};return i.default.locale(s,null,!0),s})})(eCe);function tCe(){const{minDate:n,totalMonths:e}=H1(),[t,r]=rs(E_);return we.createElement(gt,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",style:{width:"80vw"}},we.createElement(gt,{item:!0},we.createElement(Bh,{onClick:()=>r(Math.min(e-1,t+1))},we.createElement(cce,null))),we.createElement(gt,{item:!0},we.createElement(yo,null,St.unix(n!=null?n:St().unix()).subtract(t,"month").format("MMM YYYY"))),we.createElement(gt,{item:!0},we.createElement(Bh,{onClick:()=>r(Math.max(0,t-1))},we.createElement(hce,null))))}const M5=[{name:"Input",component:Tce},{name:"Insights",component:Jve},{name:"Goals",component:lce}],nCe=N5("chosenTabAtom",M5[1].name);function ACe(){const[n,e]=rs(nCe);return we.createElement(Gu,{sx:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"}},we.createElement(tCe,null),we.createElement(oF,{value:n,onChange:(t,r)=>e(r)},M5.map((t,r)=>we.createElement(aF,{label:t.name,key:r,value:t.name}))),we.createElement(Gu,{sx:{mt:2,mb:6,padding:0}},M5.map((t,r)=>{if(n===t.name)return we.createElement(t.component,{key:r})})),we.createElement(vce,null))}export{ACe as default};
