import{g as _z,a as Tz,s as Oz,B as tae,c as QS,_ as ju,b as n0,r as J,u as Az,d as xz,j as he,e as N_,f as Iz,h as ch,i as Mz,R as de,k as Nz,l as Pz,m as Cs,G as Nt,n as bl,o as rae,p as kz,F as ur,T as pn,q as j2,t as Mf,v as $z,w as Vf,x as nae,y as iae,z as Lz,A as V4,C as Dz,D as Fz,E as Hz}from"./index.5b9be2f7.js";import{d as xt,L as Bz,A as Uz,D as Vz,R as oae,a as y5,c as aae,t as sae,r as lae}from"./hooks.b3d8233b.js";import{h as qt,m as uae}from"./moment.a565bb48.js";import{c as i0,u as n1,S as cae,A as fae,_ as j4,e as jz,a as hae,b as dae,i as Mp,d as pae,f as Wz,g as zz,h as i1,j as Gz,k as mae,l as gae,m as W4,n as Yz,o as Cg,p as yae,q as Kz,r as vae,s as qz,t as bae,v as ZS,w as wae,x as Xz,y as Sae,z as Qz,B as JS,C as Rae,D as Eae,E as Cae,F as Zz,G as _ae,H as Tae,I as Oae,J as Aae,K as Qe,L as xae,M as Zi,N as Iae,O as Mae,P as z4,Q as P_,R as Nae,T as Pae,U as Jz,V as eG,W as kae,X as $ae,Y as Lae,Z as Dae,$ as G4,a0 as Fae,a1 as Hae,a2 as Bae,a3 as Uae,a4 as Vae,a5 as oN,a6 as jae,a7 as Wae,a8 as zae}from"./DataGrid.f2f8289c.js";import{l as on,_ as Gae}from"./lodash.edf9022d.js";import{c as Yae,B as Ua}from"./Box.da70235b.js";import{I as Kae,N as qae,F as v5}from"./index.66faa368.js";import{I as _g,A as aN,C as Xae}from"./TableCell.41b92f62.js";import{T as Lm,M as Qae,a as Zae,F as Jae}from"./TextField.fc80162b.js";import{T as ms}from"./Typography.d62f42db.js";import{p as _}from"./index.4c7d49d7.js";import"./TableRow.4c1e5b68.js";const ese=Yae(),b5=ese;function tse(t){return Tz("MuiToggleButton",t)}const rse=_z("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge"]),sN=rse,nse=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],ise=t=>{const{classes:e,fullWidth:r,selected:n,disabled:i,size:o,color:a}=t,s={root:["root",n&&"selected",i&&"disabled",r&&"fullWidth",`size${QS(o)}`,a]};return Iz(s,tse,e)},ose=Oz(tae,{name:"MuiToggleButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,e[`size${QS(r.size)}`]]}})(({theme:t,ownerState:e})=>{let r=e.color==="standard"?t.palette.text.primary:t.palette[e.color].main,n;return t.vars&&(r=e.color==="standard"?t.vars.palette.text.primary:t.vars.palette[e.color].main,n=e.color==="standard"?t.vars.palette.text.primaryChannel:t.vars.palette[e.color].mainChannel),ju({},t.typography.button,{borderRadius:(t.vars||t).shape.borderRadius,padding:11,border:`1px solid ${(t.vars||t).palette.divider}`,color:(t.vars||t).palette.action.active},e.fullWidth&&{width:"100%"},{[`&.${sN.disabled}`]:{color:(t.vars||t).palette.action.disabled,border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:n0(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${sN.selected}`]:{color:r,backgroundColor:t.vars?`rgba(${n} / ${t.vars.palette.action.selectedOpacity})`:n0(r,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${n} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:n0(r,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${n} / ${t.vars.palette.action.selectedOpacity})`:n0(r,t.palette.action.selectedOpacity)}}}},e.size==="small"&&{padding:7,fontSize:t.typography.pxToRem(13)},e.size==="large"&&{padding:15,fontSize:t.typography.pxToRem(15)})}),ase=J.exports.forwardRef(function(e,r){const n=Az({props:e,name:"MuiToggleButton"}),{children:i,className:o,color:a="standard",disabled:s=!1,disableFocusRipple:l=!1,fullWidth:u=!1,onChange:c,onClick:f,selected:h,size:d="medium",value:p}=n,m=xz(n,nse),g=ju({},n,{color:a,disabled:s,disableFocusRipple:l,fullWidth:u,size:d}),v=ise(g),S=b=>{f&&(f(b,p),b.defaultPrevented)||c&&c(b,p)};return he.jsx(ose,ju({className:N_(v.root,o),disabled:s,focusRipple:!l,ref:r,onClick:S,onChange:c,value:p,ownerState:g,"aria-pressed":h},m,{children:i}))}),w5=ase;function sse(t,e){return e===void 0||t===void 0?!1:Array.isArray(e)?e.indexOf(t)>=0:t===e}function lse(t){return Tz("MuiToggleButtonGroup",t)}const use=_z("MuiToggleButtonGroup",["root","selected","vertical","disabled","grouped","groupedHorizontal","groupedVertical"]),Ea=use,cse=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],fse=t=>{const{classes:e,orientation:r,fullWidth:n,disabled:i}=t,o={root:["root",r==="vertical"&&"vertical",n&&"fullWidth"],grouped:["grouped",`grouped${QS(r)}`,i&&"disabled"]};return Iz(o,lse,e)},hse=Oz("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[{[`& .${Ea.grouped}`]:e.grouped},{[`& .${Ea.grouped}`]:e[`grouped${QS(r.orientation)}`]},e.root,r.orientation==="vertical"&&e.vertical,r.fullWidth&&e.fullWidth]}})(({ownerState:t,theme:e})=>ju({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius},t.orientation==="vertical"&&{flexDirection:"column"},t.fullWidth&&{width:"100%"},{[`& .${Ea.grouped}`]:ju({},t.orientation==="horizontal"?{"&:not(:first-of-type)":{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-of-type)":{borderTopRightRadius:0,borderBottomRightRadius:0},[`&.${Ea.selected} + .${Ea.grouped}.${Ea.selected}`]:{borderLeft:0,marginLeft:0}}:{"&:not(:first-of-type)":{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},"&:not(:last-of-type)":{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`&.${Ea.selected} + .${Ea.grouped}.${Ea.selected}`]:{borderTop:0,marginTop:0}})})),dse=J.exports.forwardRef(function(e,r){const n=Az({props:e,name:"MuiToggleButtonGroup"}),{children:i,className:o,color:a="standard",disabled:s=!1,exclusive:l=!1,fullWidth:u=!1,onChange:c,orientation:f="horizontal",size:h="medium",value:d}=n,p=xz(n,cse),m=ju({},n,{disabled:s,fullWidth:u,orientation:f,size:h}),g=fse(m),v=(b,E)=>{if(!c)return;const T=d&&d.indexOf(E);let N;d&&T>=0?(N=d.slice(),N.splice(T,1)):N=d?d.concat(E):[E],c(b,N)},S=(b,E)=>{!c||c(b,d===E?null:E)};return he.jsx(hse,ju({role:"group",className:N_(g.root,o),ref:r,ownerState:m},p,{children:J.exports.Children.map(i,b=>J.exports.isValidElement(b)?J.exports.cloneElement(b,{className:N_(g.grouped,b.props.className),onChange:l?S:v,selected:b.props.selected===void 0?sse(b.props.value,d):b.props.selected,size:b.props.size||h,fullWidth:u,color:b.props.color||a,disabled:b.props.disabled||s}):null)}))}),S5=dse;var dt=function(t){try{return!!t()}catch{return!0}},pse=dt,o1=!pse(function(){var t=function(){}.bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),tG=o1,rG=Function.prototype,k_=rG.call,mse=tG&&rG.bind.bind(k_,k_),mt=tG?mse:function(t){return function(){return k_.apply(t,arguments)}},nG=mt,gse=nG({}.toString),yse=nG("".slice),ga=function(t){return yse(gse(t),8,-1)},vse=mt,bse=dt,wse=ga,R5=Object,Sse=vse("".split),a1=bse(function(){return!R5("z").propertyIsEnumerable(0)})?function(t){return wse(t)=="String"?Sse(t,""):R5(t)}:R5,No=function(t){return t==null},Rse=No,Ese=TypeError,bi=function(t){if(Rse(t))throw Ese("Can't call method on "+t);return t},Cse=a1,_se=bi,Li=function(t){return Cse(_se(t))},o0=function(t){return t&&t.Math==Math&&t},nr=o0(typeof globalThis=="object"&&globalThis)||o0(typeof window=="object"&&window)||o0(typeof self=="object"&&self)||o0(typeof ch=="object"&&ch)||function(){return this}()||Function("return this")(),mc={exports:{}},Tse=!1,lN=nr,Ose=Object.defineProperty,Y4=function(t,e){try{Ose(lN,t,{value:e,configurable:!0,writable:!0})}catch{lN[t]=e}return e},Ase=nr,xse=Y4,uN="__core-js_shared__",Ise=Ase[uN]||xse(uN,{}),K4=Ise,cN=K4;(mc.exports=function(t,e){return cN[t]||(cN[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.30.1",mode:"global",copyright:"\xA9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Mse=bi,Nse=Object,wi=function(t){return Nse(Mse(t))},Pse=mt,kse=wi,$se=Pse({}.hasOwnProperty),Rr=Object.hasOwn||function(e,r){return $se(kse(e),r)},Lse=mt,Dse=0,Fse=Math.random(),Hse=Lse(1 .toString),e6=function(t){return"Symbol("+(t===void 0?"":t)+")_"+Hse(++Dse+Fse,36)},gc=typeof navigator<"u"&&String(navigator.userAgent)||"",iG=nr,E5=gc,fN=iG.process,hN=iG.Deno,dN=fN&&fN.versions||hN&&hN.version,pN=dN&&dN.v8,wo,W2;pN&&(wo=pN.split("."),W2=wo[0]>0&&wo[0]<4?1:+(wo[0]+wo[1]));!W2&&E5&&(wo=E5.match(/Edge\/(\d+)/),(!wo||wo[1]>=74)&&(wo=E5.match(/Chrome\/(\d+)/),wo&&(W2=+wo[1])));var s1=W2,mN=s1,Bse=dt,Np=!!Object.getOwnPropertySymbols&&!Bse(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&mN&&mN<41}),Use=Np,oG=Use&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Vse=nr,jse=mc.exports,gN=Rr,Wse=e6,zse=Np,Gse=oG,Nf=Vse.Symbol,C5=jse("wks"),Yse=Gse?Nf.for||Nf:Nf&&Nf.withoutSetter||Wse,lr=function(t){return gN(C5,t)||(C5[t]=zse&&gN(Nf,t)?Nf[t]:Yse("Symbol."+t)),C5[t]},$_=typeof document=="object"&&document.all,Kse=typeof $_>"u"&&$_!==void 0,aG={all:$_,IS_HTMLDDA:Kse},sG=aG,qse=sG.all,cr=sG.IS_HTMLDDA?function(t){return typeof t=="function"||t===qse}:function(t){return typeof t=="function"},yN=cr,lG=aG,Xse=lG.all,Wr=lG.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:yN(t)||t===Xse}:function(t){return typeof t=="object"?t!==null:yN(t)},Qse=Wr,Zse=String,Jse=TypeError,$r=function(t){if(Qse(t))return t;throw Jse(Zse(t)+" is not an object")},q4={},ele=dt,zr=!ele(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),tle=zr,rle=dt,uG=tle&&rle(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),ei={},nle=nr,vN=Wr,L_=nle.document,ile=vN(L_)&&vN(L_.createElement),t6=function(t){return ile?L_.createElement(t):{}},ole=zr,ale=dt,sle=t6,cG=!ole&&!ale(function(){return Object.defineProperty(sle("div"),"a",{get:function(){return 7}}).a!=7}),lle=o1,a0=Function.prototype.call,en=lle?a0.bind(a0):function(){return a0.apply(a0,arguments)},_5=nr,ule=cr,cle=function(t){return ule(t)?t:void 0},_s=function(t,e){return arguments.length<2?cle(_5[t]):_5[t]&&_5[t][e]},fle=mt,wl=fle({}.isPrototypeOf),hle=_s,dle=cr,ple=wl,mle=oG,gle=Object,l1=mle?function(t){return typeof t=="symbol"}:function(t){var e=hle("Symbol");return dle(e)&&ple(e.prototype,gle(t))},yle=String,Pp=function(t){try{return yle(t)}catch{return"Object"}},vle=cr,ble=Pp,wle=TypeError,yc=function(t){if(vle(t))return t;throw wle(ble(t)+" is not a function")},Sle=yc,Rle=No,vc=function(t,e){var r=t[e];return Rle(r)?void 0:Sle(r)},T5=en,O5=cr,A5=Wr,Ele=TypeError,fG=function(t,e){var r,n;if(e==="string"&&O5(r=t.toString)&&!A5(n=T5(r,t))||O5(r=t.valueOf)&&!A5(n=T5(r,t))||e!=="string"&&O5(r=t.toString)&&!A5(n=T5(r,t)))return n;throw Ele("Can't convert object to primitive value")},Cle=en,bN=Wr,wN=l1,_le=vc,Tle=fG,Ole=lr,Ale=TypeError,xle=Ole("toPrimitive"),hG=function(t,e){if(!bN(t)||wN(t))return t;var r=_le(t,xle),n;if(r){if(e===void 0&&(e="default"),n=Cle(r,t,e),!bN(n)||wN(n))return n;throw Ale("Can't convert object to primitive value")}return e===void 0&&(e="number"),Tle(t,e)},Ile=hG,Mle=l1,r6=function(t){var e=Ile(t,"string");return Mle(e)?e:e+""},Nle=zr,Ple=cG,kle=uG,s0=$r,SN=r6,$le=TypeError,x5=Object.defineProperty,Lle=Object.getOwnPropertyDescriptor,I5="enumerable",M5="configurable",N5="writable";ei.f=Nle?kle?function(e,r,n){if(s0(e),r=SN(r),s0(n),typeof e=="function"&&r==="prototype"&&"value"in n&&N5 in n&&!n[N5]){var i=Lle(e,r);i&&i[N5]&&(e[r]=n.value,n={configurable:M5 in n?n[M5]:i[M5],enumerable:I5 in n?n[I5]:i[I5],writable:!1})}return x5(e,r,n)}:x5:function(e,r,n){if(s0(e),r=SN(r),s0(n),Ple)try{return x5(e,r,n)}catch{}if("get"in n||"set"in n)throw $le("Accessors not supported");return"value"in n&&(e[r]=n.value),e};var Dle=Math.ceil,Fle=Math.floor,Hle=Math.trunc||function(e){var r=+e;return(r>0?Fle:Dle)(r)},Ble=Hle,Sl=function(t){var e=+t;return e!==e||e===0?0:Ble(e)},Ule=Sl,Vle=Math.max,jle=Math.min,u1=function(t,e){var r=Ule(t);return r<0?Vle(r+e,0):jle(r,e)},Wle=Sl,zle=Math.min,bc=function(t){return t>0?zle(Wle(t),9007199254740991):0},Gle=bc,ao=function(t){return Gle(t.length)},Yle=Li,Kle=u1,qle=ao,RN=function(t){return function(e,r,n){var i=Yle(e),o=qle(i),a=Kle(n,o),s;if(t&&r!=r){for(;o>a;)if(s=i[a++],s!=s)return!0}else for(;o>a;a++)if((t||a in i)&&i[a]===r)return t||a||0;return!t&&-1}},X4={includes:RN(!0),indexOf:RN(!1)},c1={},Xle=mt,P5=Rr,Qle=Li,Zle=X4.indexOf,Jle=c1,EN=Xle([].push),dG=function(t,e){var r=Qle(t),n=0,i=[],o;for(o in r)!P5(Jle,o)&&P5(r,o)&&EN(i,o);for(;e.length>n;)P5(r,o=e[n++])&&(~Zle(i,o)||EN(i,o));return i},Q4=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],eue=dG,tue=Q4,f1=Object.keys||function(e){return eue(e,tue)},rue=zr,nue=uG,iue=ei,oue=$r,aue=Li,sue=f1;q4.f=rue&&!nue?Object.defineProperties:function(e,r){oue(e);for(var n=aue(r),i=sue(r),o=i.length,a=0,s;o>a;)iue.f(e,s=i[a++],n[s]);return e};var lue=_s,pG=lue("document","documentElement"),uue=mc.exports,cue=e6,CN=uue("keys"),n6=function(t){return CN[t]||(CN[t]=cue(t))},fue=$r,hue=q4,_N=Q4,due=c1,pue=pG,mue=t6,gue=n6,TN=">",ON="<",D_="prototype",F_="script",mG=gue("IE_PROTO"),k5=function(){},gG=function(t){return ON+F_+TN+t+ON+"/"+F_+TN},AN=function(t){t.write(gG("")),t.close();var e=t.parentWindow.Object;return t=null,e},yue=function(){var t=mue("iframe"),e="java"+F_+":",r;return t.style.display="none",pue.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(gG("document.F=Object")),r.close(),r.F},l0,Fb=function(){try{l0=new ActiveXObject("htmlfile")}catch{}Fb=typeof document<"u"?document.domain&&l0?AN(l0):yue():AN(l0);for(var t=_N.length;t--;)delete Fb[D_][_N[t]];return Fb()};due[mG]=!0;var kp=Object.create||function(e,r){var n;return e!==null?(k5[D_]=fue(e),n=new k5,k5[D_]=null,n[mG]=e):n=Fb(),r===void 0?n:hue.f(n,r)},vue=lr,bue=kp,wue=ei.f,H_=vue("unscopables"),B_=Array.prototype;B_[H_]==null&&wue(B_,H_,{configurable:!0,value:bue(null)});var h1=function(t){B_[H_][t]=!0},d1={},Sue=nr,Rue=cr,xN=Sue.WeakMap,yG=Rue(xN)&&/native code/.test(String(xN)),p1=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},Eue=zr,Cue=ei,_ue=p1,wc=Eue?function(t,e,r){return Cue.f(t,e,_ue(1,r))}:function(t,e,r){return t[e]=r,t},Tue=yG,vG=nr,Oue=Wr,Aue=wc,$5=Rr,L5=K4,xue=n6,Iue=c1,IN="Object already initialized",U_=vG.TypeError,Mue=vG.WeakMap,z2,Tg,G2,Nue=function(t){return G2(t)?Tg(t):z2(t,{})},Pue=function(t){return function(e){var r;if(!Oue(e)||(r=Tg(e)).type!==t)throw U_("Incompatible receiver, "+t+" required");return r}};if(Tue||L5.state){var $o=L5.state||(L5.state=new Mue);$o.get=$o.get,$o.has=$o.has,$o.set=$o.set,z2=function(t,e){if($o.has(t))throw U_(IN);return e.facade=t,$o.set(t,e),e},Tg=function(t){return $o.get(t)||{}},G2=function(t){return $o.has(t)}}else{var $c=xue("state");Iue[$c]=!0,z2=function(t,e){if($5(t,$c))throw U_(IN);return e.facade=t,Aue(t,$c,e),e},Tg=function(t){return $5(t,$c)?t[$c]:{}},G2=function(t){return $5(t,$c)}}var Ts={set:z2,get:Tg,has:G2,enforce:Nue,getterFor:Pue},ya={},m1={},bG={}.propertyIsEnumerable,wG=Object.getOwnPropertyDescriptor,kue=wG&&!bG.call({1:2},1);m1.f=kue?function(e){var r=wG(this,e);return!!r&&r.enumerable}:bG;var $ue=zr,Lue=en,Due=m1,Fue=p1,Hue=Li,Bue=r6,Uue=Rr,Vue=cG,MN=Object.getOwnPropertyDescriptor;ya.f=$ue?MN:function(e,r){if(e=Hue(e),r=Bue(r),Vue)try{return MN(e,r)}catch{}if(Uue(e,r))return Fue(!Lue(Due.f,e,r),e[r])};var Z4={exports:{}},V_=zr,jue=Rr,SG=Function.prototype,Wue=V_&&Object.getOwnPropertyDescriptor,J4=jue(SG,"name"),zue=J4&&function(){}.name==="something",Gue=J4&&(!V_||V_&&Wue(SG,"name").configurable),g1={EXISTS:J4,PROPER:zue,CONFIGURABLE:Gue},Yue=mt,Kue=cr,j_=K4,que=Yue(Function.toString);Kue(j_.inspectSource)||(j_.inspectSource=function(t){return que(t)});var RG=j_.inspectSource,e8=mt,Xue=dt,Que=cr,u0=Rr,W_=zr,Zue=g1.CONFIGURABLE,Jue=RG,EG=Ts,ece=EG.enforce,tce=EG.get,NN=String,Hb=Object.defineProperty,rce=e8("".slice),nce=e8("".replace),ice=e8([].join),oce=W_&&!Xue(function(){return Hb(function(){},"length",{value:8}).length!==8}),ace=String(String).split("String"),sce=Z4.exports=function(t,e,r){rce(NN(e),0,7)==="Symbol("&&(e="["+nce(NN(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!u0(t,"name")||Zue&&t.name!==e)&&(W_?Hb(t,"name",{value:e,configurable:!0}):t.name=e),oce&&r&&u0(r,"arity")&&t.length!==r.arity&&Hb(t,"length",{value:r.arity});try{r&&u0(r,"constructor")&&r.constructor?W_&&Hb(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var n=ece(t);return u0(n,"source")||(n.source=ice(ace,typeof e=="string"?e:"")),t};Function.prototype.toString=sce(function(){return Que(this)&&tce(this).source||Jue(this)},"toString");var lce=cr,uce=ei,cce=Z4.exports,fce=Y4,so=function(t,e,r,n){n||(n={});var i=n.enumerable,o=n.name!==void 0?n.name:e;if(lce(r)&&cce(r,o,n),n.global)i?t[e]=r:fce(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=r:uce.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},Sc={},hce=dG,dce=Q4,pce=dce.concat("length","prototype");Sc.f=Object.getOwnPropertyNames||function(e){return hce(e,pce)};var y1={};y1.f=Object.getOwnPropertySymbols;var mce=_s,gce=mt,yce=Sc,vce=y1,bce=$r,wce=gce([].concat),CG=mce("Reflect","ownKeys")||function(e){var r=yce.f(bce(e)),n=vce.f;return n?wce(r,n(e)):r},PN=Rr,Sce=CG,Rce=ya,Ece=ei,_G=function(t,e,r){for(var n=Sce(e),i=Ece.f,o=Rce.f,a=0;a<n.length;a++){var s=n[a];!PN(t,s)&&!(r&&PN(r,s))&&i(t,s,o(e,s))}},Cce=dt,_ce=cr,Tce=/#|\.prototype\./,v1=function(t,e){var r=Ace[Oce(t)];return r==Ice?!0:r==xce?!1:_ce(e)?Cce(e):!!e},Oce=v1.normalize=function(t){return String(t).replace(Tce,".").toLowerCase()},Ace=v1.data={},xce=v1.NATIVE="N",Ice=v1.POLYFILL="P",i6=v1,D5=nr,Mce=ya.f,Nce=wc,Pce=so,kce=Y4,$ce=_G,Lce=i6,tt=function(t,e){var r=t.target,n=t.global,i=t.stat,o,a,s,l,u,c;if(n?a=D5:i?a=D5[r]||kce(r,{}):a=(D5[r]||{}).prototype,a)for(s in e){if(u=e[s],t.dontCallGetSet?(c=Mce(a,s),l=c&&c.value):l=a[s],o=Lce(n?s:r+(i?".":"#")+s,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;$ce(u,l)}(t.sham||l&&l.sham)&&Nce(u,"sham",!0),Pce(a,s,u,t)}},Dce=dt,TG=!Dce(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),Fce=Rr,Hce=cr,Bce=wi,Uce=n6,Vce=TG,kN=Uce("IE_PROTO"),z_=Object,jce=z_.prototype,o6=Vce?z_.getPrototypeOf:function(t){var e=Bce(t);if(Fce(e,kN))return e[kN];var r=e.constructor;return Hce(r)&&e instanceof r?r.prototype:e instanceof z_?jce:null},Wce=dt,zce=cr,Gce=Wr,$N=o6,Yce=so,Kce=lr,G_=Kce("iterator"),OG=!1,Wu,F5,H5;[].keys&&(H5=[].keys(),"next"in H5?(F5=$N($N(H5)),F5!==Object.prototype&&(Wu=F5)):OG=!0);var qce=!Gce(Wu)||Wce(function(){var t={};return Wu[G_].call(t)!==t});qce&&(Wu={});zce(Wu[G_])||Yce(Wu,G_,function(){return this});var AG={IteratorPrototype:Wu,BUGGY_SAFARI_ITERATORS:OG},Xce=ei.f,Qce=Rr,Zce=lr,LN=Zce("toStringTag"),a6=function(t,e,r){t&&!r&&(t=t.prototype),t&&!Qce(t,LN)&&Xce(t,LN,{configurable:!0,value:e})},Jce=AG.IteratorPrototype,efe=kp,tfe=p1,rfe=a6,nfe=d1,ife=function(){return this},ofe=function(t,e,r,n){var i=e+" Iterator";return t.prototype=efe(Jce,{next:tfe(+!n,r)}),rfe(t,i,!1),nfe[i]=ife,t},afe=mt,sfe=yc,lfe=function(t,e,r){try{return afe(sfe(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}},ufe=cr,cfe=String,ffe=TypeError,hfe=function(t){if(typeof t=="object"||ufe(t))return t;throw ffe("Can't set "+cfe(t)+" as a prototype")},dfe=lfe,pfe=$r,mfe=hfe,t8=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=dfe(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(i,o){return pfe(i),mfe(o),t?r(i,o):i.__proto__=o,i}}():void 0),gfe=tt,yfe=en,xG=g1,vfe=cr,bfe=ofe,DN=o6,FN=t8,wfe=a6,Sfe=wc,B5=so,Rfe=lr,Efe=d1,IG=AG,Cfe=xG.PROPER,_fe=xG.CONFIGURABLE,HN=IG.IteratorPrototype,c0=IG.BUGGY_SAFARI_ITERATORS,em=Rfe("iterator"),BN="keys",tm="values",UN="entries",Tfe=function(){return this},r8=function(t,e,r,n,i,o,a){bfe(r,e,n);var s=function(v){if(v===i&&h)return h;if(!c0&&v in c)return c[v];switch(v){case BN:return function(){return new r(this,v)};case tm:return function(){return new r(this,v)};case UN:return function(){return new r(this,v)}}return function(){return new r(this)}},l=e+" Iterator",u=!1,c=t.prototype,f=c[em]||c["@@iterator"]||i&&c[i],h=!c0&&f||s(i),d=e=="Array"&&c.entries||f,p,m,g;if(d&&(p=DN(d.call(new t)),p!==Object.prototype&&p.next&&(DN(p)!==HN&&(FN?FN(p,HN):vfe(p[em])||B5(p,em,Tfe)),wfe(p,l,!0))),Cfe&&i==tm&&f&&f.name!==tm&&(_fe?Sfe(c,"name",tm):(u=!0,h=function(){return yfe(f,this)})),i)if(m={values:s(tm),keys:o?h:s(BN),entries:s(UN)},a)for(g in m)(c0||u||!(g in c))&&B5(c,g,m[g]);else gfe({target:e,proto:!0,forced:c0||u},m);return c[em]!==h&&B5(c,em,h,{name:i}),Efe[e]=h,m},n8=function(t,e){return{value:t,done:e}},Ofe=Li,i8=h1,VN=d1,MG=Ts,Afe=ei.f,xfe=r8,f0=n8,Ife=zr,NG="Array Iterator",Mfe=MG.set,Nfe=MG.getterFor(NG),Pfe=xfe(Array,"Array",function(t,e){Mfe(this,{type:NG,target:Ofe(t),index:0,kind:e})},function(){var t=Nfe(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,f0(void 0,!0)):r=="keys"?f0(n,!1):r=="values"?f0(e[n],!1):f0([n,e[n]],!1)},"values"),jN=VN.Arguments=VN.Array;i8("keys");i8("values");i8("entries");if(Ife&&jN.name!=="values")try{Afe(jN,"name",{value:"values"})}catch{}var kfe=lr,$fe=kfe("toStringTag"),PG={};PG[$fe]="z";var o8=String(PG)==="[object z]",Lfe=o8,Dfe=cr,Bb=ga,Ffe=lr,Hfe=Ffe("toStringTag"),Bfe=Object,Ufe=Bb(function(){return arguments}())=="Arguments",Vfe=function(t,e){try{return t[e]}catch{}},s6=Lfe?Bb:function(t){var e,r,n;return t===void 0?"Undefined":t===null?"Null":typeof(r=Vfe(e=Bfe(t),Hfe))=="string"?r:Ufe?Bb(e):(n=Bb(e))=="Object"&&Dfe(e.callee)?"Arguments":n},jfe=o8,Wfe=s6,zfe=jfe?{}.toString:function(){return"[object "+Wfe(this)+"]"},Gfe=o8,Yfe=so,Kfe=zfe;Gfe||Yfe(Object.prototype,"toString",Kfe,{unsafe:!0});var qfe=s6,Xfe=String,Gr=function(t){if(qfe(t)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return Xfe(t)},a8=mt,Qfe=Sl,Zfe=Gr,Jfe=bi,ehe=a8("".charAt),WN=a8("".charCodeAt),the=a8("".slice),zN=function(t){return function(e,r){var n=Zfe(Jfe(e)),i=Qfe(r),o=n.length,a,s;return i<0||i>=o?t?"":void 0:(a=WN(n,i),a<55296||a>56319||i+1===o||(s=WN(n,i+1))<56320||s>57343?t?ehe(n,i):a:t?the(n,i,i+2):(a-55296<<10)+(s-56320)+65536)}},s8={codeAt:zN(!1),charAt:zN(!0)},rhe=s8.charAt,nhe=Gr,kG=Ts,ihe=r8,GN=n8,$G="String Iterator",ohe=kG.set,ahe=kG.getterFor($G);ihe(String,"String",function(t){ohe(this,{type:$G,string:nhe(t),index:0})},function(){var e=ahe(this),r=e.string,n=e.index,i;return n>=r.length?GN(void 0,!0):(i=rhe(r,n),e.index+=i.length,GN(i,!1))});var she=dt,l8=!she(function(){return Object.isExtensible(Object.preventExtensions({}))}),lhe=so,u8=function(t,e,r){for(var n in e)lhe(t,n,e[n],r);return t},$p={exports:{}},c8={},uhe=r6,che=ei,fhe=p1,Lp=function(t,e,r){var n=uhe(e);n in t?che.f(t,n,fhe(0,r)):t[n]=r},YN=u1,hhe=ao,dhe=Lp,phe=Array,mhe=Math.max,f8=function(t,e,r){for(var n=hhe(t),i=YN(e,n),o=YN(r===void 0?n:r,n),a=phe(mhe(o-i,0)),s=0;i<o;i++,s++)dhe(a,s,t[i]);return a.length=s,a},ghe=ga,yhe=Li,LG=Sc.f,vhe=f8,DG=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],bhe=function(t){try{return LG(t)}catch{return vhe(DG)}};c8.f=function(e){return DG&&ghe(e)=="Window"?bhe(e):LG(yhe(e))};var whe=dt,She=whe(function(){if(typeof ArrayBuffer=="function"){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}),Rhe=dt,Ehe=Wr,Che=ga,KN=She,Ub=Object.isExtensible,_he=Rhe(function(){Ub(1)}),The=_he||KN?function(e){return!Ehe(e)||KN&&Che(e)=="ArrayBuffer"?!1:Ub?Ub(e):!0}:Ub,Ohe=tt,Ahe=mt,xhe=c1,Ihe=Wr,h8=Rr,Mhe=ei.f,qN=Sc,Nhe=c8,d8=The,Phe=e6,khe=l8,FG=!1,bs=Phe("meta"),$he=0,p8=function(t){Mhe(t,bs,{value:{objectID:"O"+$he++,weakData:{}}})},Lhe=function(t,e){if(!Ihe(t))return typeof t=="symbol"?t:(typeof t=="string"?"S":"P")+t;if(!h8(t,bs)){if(!d8(t))return"F";if(!e)return"E";p8(t)}return t[bs].objectID},Dhe=function(t,e){if(!h8(t,bs)){if(!d8(t))return!0;if(!e)return!1;p8(t)}return t[bs].weakData},Fhe=function(t){return khe&&FG&&d8(t)&&!h8(t,bs)&&p8(t),t},Hhe=function(){Bhe.enable=function(){},FG=!0;var t=qN.f,e=Ahe([].splice),r={};r[bs]=1,t(r).length&&(qN.f=function(n){for(var i=t(n),o=0,a=i.length;o<a;o++)if(i[o]===bs){e(i,o,1);break}return i},Ohe({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Nhe.f}))},Bhe=$p.exports={enable:Hhe,fastKey:Lhe,getWeakData:Dhe,onFreeze:Fhe};xhe[bs]=!0;var Uhe=ga,Vhe=mt,b1=function(t){if(Uhe(t)==="Function")return Vhe(t)},XN=b1,jhe=yc,Whe=o1,zhe=XN(XN.bind),w1=function(t,e){return jhe(t),e===void 0?t:Whe?zhe(t,e):function(){return t.apply(e,arguments)}},Ghe=lr,Yhe=d1,Khe=Ghe("iterator"),qhe=Array.prototype,HG=function(t){return t!==void 0&&(Yhe.Array===t||qhe[Khe]===t)},Xhe=s6,QN=vc,Qhe=No,Zhe=d1,Jhe=lr,ede=Jhe("iterator"),m8=function(t){if(!Qhe(t))return QN(t,ede)||QN(t,"@@iterator")||Zhe[Xhe(t)]},tde=en,rde=yc,nde=$r,ide=Pp,ode=m8,ade=TypeError,BG=function(t,e){var r=arguments.length<2?ode(t):e;if(rde(r))return nde(tde(r,t));throw ade(ide(t)+" is not iterable")},sde=en,ZN=$r,lde=vc,UG=function(t,e,r){var n,i;ZN(t);try{if(n=lde(t,"return"),!n){if(e==="throw")throw r;return r}n=sde(n,t)}catch(o){i=!0,n=o}if(e==="throw")throw r;if(i)throw n;return ZN(n),r},ude=w1,cde=en,fde=$r,hde=Pp,dde=HG,pde=ao,JN=wl,mde=BG,gde=m8,e9=UG,yde=TypeError,Vb=function(t,e){this.stopped=t,this.result=e},t9=Vb.prototype,g8=function(t,e,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),o=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),s=!!(r&&r.INTERRUPTED),l=ude(e,n),u,c,f,h,d,p,m,g=function(S){return u&&e9(u,"normal",S),new Vb(!0,S)},v=function(S){return i?(fde(S),s?l(S[0],S[1],g):l(S[0],S[1])):s?l(S,g):l(S)};if(o)u=t.iterator;else if(a)u=t;else{if(c=gde(t),!c)throw yde(hde(t)+" is not iterable");if(dde(c)){for(f=0,h=pde(t);h>f;f++)if(d=v(t[f]),d&&JN(t9,d))return d;return new Vb(!1)}u=mde(t,c)}for(p=o?t.next:u.next;!(m=cde(p,u)).done;){try{d=v(m.value)}catch(S){e9(u,"throw",S)}if(typeof d=="object"&&d&&JN(t9,d))return d}return new Vb(!1)},vde=wl,bde=TypeError,y8=function(t,e){if(vde(e,t))return t;throw bde("Incorrect invocation")},wde=lr,VG=wde("iterator"),jG=!1;try{var Sde=0,r9={next:function(){return{done:!!Sde++}},return:function(){jG=!0}};r9[VG]=function(){return this},Array.from(r9,function(){throw 2})}catch{}var WG=function(t,e){if(!e&&!jG)return!1;var r=!1;try{var n={};n[VG]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch{}return r},Rde=cr,Ede=Wr,n9=t8,v8=function(t,e,r){var n,i;return n9&&Rde(n=e.constructor)&&n!==r&&Ede(i=n.prototype)&&i!==r.prototype&&n9(t,i),t},Cde=tt,_de=nr,Tde=mt,i9=i6,Ode=so,Ade=$p.exports,xde=g8,Ide=y8,Mde=cr,Nde=No,U5=Wr,V5=dt,Pde=WG,kde=a6,$de=v8,l6=function(t,e,r){var n=t.indexOf("Map")!==-1,i=t.indexOf("Weak")!==-1,o=n?"set":"add",a=_de[t],s=a&&a.prototype,l=a,u={},c=function(v){var S=Tde(s[v]);Ode(s,v,v=="add"?function(E){return S(this,E===0?0:E),this}:v=="delete"?function(b){return i&&!U5(b)?!1:S(this,b===0?0:b)}:v=="get"?function(E){return i&&!U5(E)?void 0:S(this,E===0?0:E)}:v=="has"?function(E){return i&&!U5(E)?!1:S(this,E===0?0:E)}:function(E,T){return S(this,E===0?0:E,T),this})},f=i9(t,!Mde(a)||!(i||s.forEach&&!V5(function(){new a().entries().next()})));if(f)l=r.getConstructor(e,t,n,o),Ade.enable();else if(i9(t,!0)){var h=new l,d=h[o](i?{}:-0,1)!=h,p=V5(function(){h.has(1)}),m=Pde(function(v){new a(v)}),g=!i&&V5(function(){for(var v=new a,S=5;S--;)v[o](S,S);return!v.has(-0)});m||(l=e(function(v,S){Ide(v,s);var b=$de(new a,v,l);return Nde(S)||xde(S,b[o],{that:b,AS_ENTRIES:n}),b}),l.prototype=s,s.constructor=l),(p||g)&&(c("delete"),c("has"),n&&c("get")),(g||d)&&c(o),i&&s.clear&&delete s.clear}return u[t]=l,Cde({global:!0,constructor:!0,forced:l!=a},u),kde(l,t),i||r.setStrong(l,t,n),l},Lde=ga,Dp=Array.isArray||function(e){return Lde(e)=="Array"},Dde=mt,Fde=dt,zG=cr,Hde=s6,Bde=_s,Ude=RG,GG=function(){},Vde=[],YG=Bde("Reflect","construct"),b8=/^\s*(?:class|function)\b/,jde=Dde(b8.exec),Wde=!b8.exec(GG),rm=function(e){if(!zG(e))return!1;try{return YG(GG,Vde,e),!0}catch{return!1}},KG=function(e){if(!zG(e))return!1;switch(Hde(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Wde||!!jde(b8,Ude(e))}catch{return!0}};KG.sham=!0;var u6=!YG||Fde(function(){var t;return rm(rm.call)||!rm(Object)||!rm(function(){t=!0})||t})?KG:rm,o9=Dp,zde=u6,Gde=Wr,Yde=lr,Kde=Yde("species"),a9=Array,qde=function(t){var e;return o9(t)&&(e=t.constructor,zde(e)&&(e===a9||o9(e.prototype))?e=void 0:Gde(e)&&(e=e[Kde],e===null&&(e=void 0))),e===void 0?a9:e},Xde=qde,w8=function(t,e){return new(Xde(t))(e===0?0:e)},Qde=w1,Zde=mt,Jde=a1,epe=wi,tpe=ao,rpe=w8,s9=Zde([].push),Is=function(t){var e=t==1,r=t==2,n=t==3,i=t==4,o=t==6,a=t==7,s=t==5||o;return function(l,u,c,f){for(var h=epe(l),d=Jde(h),p=Qde(u,c),m=tpe(d),g=0,v=f||rpe,S=e?v(l,m):r||a?v(l,0):void 0,b,E;m>g;g++)if((s||g in d)&&(b=d[g],E=p(b,g,h),t))if(e)S[g]=E;else if(E)switch(t){case 3:return!0;case 5:return b;case 6:return g;case 2:s9(S,b)}else switch(t){case 4:return!1;case 7:s9(S,b)}return o?-1:n||i?i:S}},Rc={forEach:Is(0),map:Is(1),filter:Is(2),some:Is(3),every:Is(4),find:Is(5),findIndex:Is(6),filterReject:Is(7)},npe=mt,l9=u8,h0=$p.exports.getWeakData,ipe=y8,ope=$r,ape=No,j5=Wr,spe=g8,qG=Rc,u9=Rr,XG=Ts,lpe=XG.set,upe=XG.getterFor,cpe=qG.find,fpe=qG.findIndex,hpe=npe([].splice),dpe=0,d0=function(t){return t.frozen||(t.frozen=new QG)},QG=function(){this.entries=[]},W5=function(t,e){return cpe(t.entries,function(r){return r[0]===e})};QG.prototype={get:function(t){var e=W5(this,t);if(e)return e[1]},has:function(t){return!!W5(this,t)},set:function(t,e){var r=W5(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=fpe(this.entries,function(r){return r[0]===t});return~e&&hpe(this.entries,e,1),!!~e}};var ZG={getConstructor:function(t,e,r,n){var i=t(function(l,u){ipe(l,o),lpe(l,{type:e,id:dpe++,frozen:void 0}),ape(u)||spe(u,l[n],{that:l,AS_ENTRIES:r})}),o=i.prototype,a=upe(e),s=function(l,u,c){var f=a(l),h=h0(ope(u),!0);return h===!0?d0(f).set(u,c):h[f.id]=c,l};return l9(o,{delete:function(l){var u=a(this);if(!j5(l))return!1;var c=h0(l);return c===!0?d0(u).delete(l):c&&u9(c,u.id)&&delete c[u.id]},has:function(u){var c=a(this);if(!j5(u))return!1;var f=h0(u);return f===!0?d0(c).has(u):f&&u9(f,c.id)}}),l9(o,r?{get:function(u){var c=a(this);if(j5(u)){var f=h0(u);return f===!0?d0(c).get(u):f?f[c.id]:void 0}},set:function(u,c){return s(this,u,c)}}:{add:function(u){return s(this,u,!0)}}),i}},ppe=l8,c9=nr,jb=mt,f9=u8,mpe=$p.exports,gpe=l6,JG=ZG,p0=Wr,m0=Ts.enforce,ype=dt,vpe=yG,S1=Object,bpe=Array.isArray,g0=S1.isExtensible,eY=S1.isFrozen,wpe=S1.isSealed,tY=S1.freeze,Spe=S1.seal,h9={},d9={},Rpe=!c9.ActiveXObject&&"ActiveXObject"in c9,nm,rY=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},nY=gpe("WeakMap",rY,JG),Sf=nY.prototype,Wb=jb(Sf.set),Epe=function(){return ppe&&ype(function(){var t=tY([]);return Wb(new nY,t,1),!eY(t)})};if(vpe)if(Rpe){nm=JG.getConstructor(rY,"WeakMap",!0),mpe.enable();var p9=jb(Sf.delete),y0=jb(Sf.has),m9=jb(Sf.get);f9(Sf,{delete:function(t){if(p0(t)&&!g0(t)){var e=m0(this);return e.frozen||(e.frozen=new nm),p9(this,t)||e.frozen.delete(t)}return p9(this,t)},has:function(e){if(p0(e)&&!g0(e)){var r=m0(this);return r.frozen||(r.frozen=new nm),y0(this,e)||r.frozen.has(e)}return y0(this,e)},get:function(e){if(p0(e)&&!g0(e)){var r=m0(this);return r.frozen||(r.frozen=new nm),y0(this,e)?m9(this,e):r.frozen.get(e)}return m9(this,e)},set:function(e,r){if(p0(e)&&!g0(e)){var n=m0(this);n.frozen||(n.frozen=new nm),y0(this,e)?Wb(this,e,r):n.frozen.set(e,r)}else Wb(this,e,r);return this}})}else Epe()&&f9(Sf,{set:function(e,r){var n;return bpe(e)&&(eY(e)?n=h9:wpe(e)&&(n=d9)),Wb(this,e,r),n==h9&&tY(e),n==d9&&Spe(e),this}});var iY={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Cpe=t6,z5=Cpe("span").classList,g9=z5&&z5.constructor&&z5.constructor.prototype,oY=g9===Object.prototype?void 0:g9,y9=nr,aY=iY,_pe=oY,Dm=Pfe,G5=wc,sY=lr,Y5=sY("iterator"),v9=sY("toStringTag"),K5=Dm.values,lY=function(t,e){if(t){if(t[Y5]!==K5)try{G5(t,Y5,K5)}catch{t[Y5]=K5}if(t[v9]||G5(t,v9,e),aY[e]){for(var r in Dm)if(t[r]!==Dm[r])try{G5(t,r,Dm[r])}catch{t[r]=Dm[r]}}}};for(var q5 in aY)lY(y9[q5]&&y9[q5].prototype,q5);lY(_pe,"DOMTokenList");var Tpe=dt,Fp=function(t,e){var r=[][t];return!!r&&Tpe(function(){r.call(null,e||function(){return 1},1)})},Ope=tt,Ape=b1,xpe=X4.indexOf,Ipe=Fp,Y_=Ape([].indexOf),uY=!!Y_&&1/Y_([1],1,-0)<0,Mpe=uY||!Ipe("indexOf");Ope({target:"Array",proto:!0,forced:Mpe},{indexOf:function(e){var r=arguments.length>1?arguments[1]:void 0;return uY?Y_(this,e,r)||0:xpe(this,e,r)}});var b9=Pp,Npe=TypeError,cY=function(t,e){if(!delete t[e])throw Npe("Cannot delete property "+b9(e)+" of "+b9(t))},w9=f8,Ppe=Math.floor,K_=function(t,e){var r=t.length,n=Ppe(r/2);return r<8?kpe(t,e):$pe(t,K_(w9(t,0,n),e),K_(w9(t,n),e),e)},kpe=function(t,e){for(var r=t.length,n=1,i,o;n<r;){for(o=n,i=t[n];o&&e(t[o-1],i)>0;)t[o]=t[--o];o!==n++&&(t[o]=i)}return t},$pe=function(t,e,r,n){for(var i=e.length,o=r.length,a=0,s=0;a<i||s<o;)t[a+s]=a<i&&s<o?n(e[a],r[s])<=0?e[a++]:r[s++]:a<i?e[a++]:r[s++];return t},Lpe=K_,Dpe=gc,S9=Dpe.match(/firefox\/(\d+)/i),Fpe=!!S9&&+S9[1],Hpe=gc,Bpe=/MSIE|Trident/.test(Hpe),Upe=gc,R9=Upe.match(/AppleWebKit\/(\d+)\./),Vpe=!!R9&&+R9[1],jpe=tt,fY=mt,Wpe=yc,zpe=wi,E9=ao,Gpe=cY,C9=Gr,S8=dt,Ype=Lpe,Kpe=Fp,_9=Fpe,qpe=Bpe,T9=s1,O9=Vpe,Ws=[],A9=fY(Ws.sort),Xpe=fY(Ws.push),Qpe=S8(function(){Ws.sort(void 0)}),Zpe=S8(function(){Ws.sort(null)}),Jpe=Kpe("sort"),hY=!S8(function(){if(T9)return T9<70;if(!(_9&&_9>3)){if(qpe)return!0;if(O9)return O9<603;var t="",e,r,n,i;for(e=65;e<76;e++){switch(r=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)Ws.push({k:r+i,v:n})}for(Ws.sort(function(o,a){return a.v-o.v}),i=0;i<Ws.length;i++)r=Ws[i].k.charAt(0),t.charAt(t.length-1)!==r&&(t+=r);return t!=="DGBEFHACIJK"}}),eme=Qpe||!Zpe||!Jpe||!hY,tme=function(t){return function(e,r){return r===void 0?-1:e===void 0?1:t!==void 0?+t(e,r)||0:C9(e)>C9(r)?1:-1}};jpe({target:"Array",proto:!0,forced:eme},{sort:function(e){e!==void 0&&Wpe(e);var r=zpe(this);if(hY)return e===void 0?A9(r):A9(r,e);var n=[],i=E9(r),o,a;for(a=0;a<i;a++)a in r&&Xpe(n,r[a]);for(Ype(n,tme(e)),o=E9(n),a=0;a<o;)r[a]=n[a++];for(;a<i;)Gpe(r,a++);return r}});var rme=tt,nme=Rc.find,ime=h1,q_="find",dY=!0;q_ in[]&&Array(1)[q_](function(){dY=!1});rme({target:"Array",proto:!0,forced:dY},{find:function(e){return nme(this,e,arguments.length>1?arguments[1]:void 0)}});ime(q_);var ome=$r,pY=function(){var t=ome(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},R8=dt,ame=nr,E8=ame.RegExp,C8=R8(function(){var t=E8("a","y");return t.lastIndex=2,t.exec("abcd")!=null}),sme=C8||R8(function(){return!E8("a","y").sticky}),lme=C8||R8(function(){var t=E8("^r","gy");return t.lastIndex=2,t.exec("str")!=null}),_8={BROKEN_CARET:lme,MISSED_STICKY:sme,UNSUPPORTED_Y:C8},ume=dt,cme=nr,fme=cme.RegExp,mY=ume(function(){var t=fme(".","s");return!(t.dotAll&&t.exec(`
`)&&t.flags==="s")}),hme=dt,dme=nr,pme=dme.RegExp,gY=hme(function(){var t=pme("(?<a>b)","g");return t.exec("b").groups.a!=="b"||"b".replace(t,"$<a>c")!=="bc"}),Pf=en,c6=mt,mme=Gr,gme=pY,yme=_8,vme=mc.exports,bme=kp,wme=Ts.get,Sme=mY,Rme=gY,Eme=vme("native-string-replace",String.prototype.replace),Y2=RegExp.prototype.exec,X_=Y2,Cme=c6("".charAt),_me=c6("".indexOf),Tme=c6("".replace),X5=c6("".slice),Q_=function(){var t=/a/,e=/b*/g;return Pf(Y2,t,"a"),Pf(Y2,e,"a"),t.lastIndex!==0||e.lastIndex!==0}(),yY=yme.BROKEN_CARET,Z_=/()??/.exec("")[1]!==void 0,Ome=Q_||Z_||yY||Sme||Rme;Ome&&(X_=function(e){var r=this,n=wme(r),i=mme(e),o=n.raw,a,s,l,u,c,f,h;if(o)return o.lastIndex=r.lastIndex,a=Pf(X_,o,i),r.lastIndex=o.lastIndex,a;var d=n.groups,p=yY&&r.sticky,m=Pf(gme,r),g=r.source,v=0,S=i;if(p&&(m=Tme(m,"y",""),_me(m,"g")===-1&&(m+="g"),S=X5(i,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&Cme(i,r.lastIndex-1)!==`
`)&&(g="(?: "+g+")",S=" "+S,v++),s=new RegExp("^(?:"+g+")",m)),Z_&&(s=new RegExp("^"+g+"$(?!\\s)",m)),Q_&&(l=r.lastIndex),u=Pf(Y2,p?s:r,S),p?u?(u.input=X5(u.input,v),u[0]=X5(u[0],v),u.index=r.lastIndex,r.lastIndex+=u[0].length):r.lastIndex=0:Q_&&u&&(r.lastIndex=r.global?u.index+u[0].length:l),Z_&&u&&u.length>1&&Pf(Eme,u[0],s,function(){for(c=1;c<arguments.length-2;c++)arguments[c]===void 0&&(u[c]=void 0)}),u&&d)for(u.groups=f=bme(null),c=0;c<d.length;c++)h=d[c],f[h[0]]=u[h[1]];return u});var f6=X_,Ame=tt,x9=f6;Ame({target:"RegExp",proto:!0,forced:/./.exec!==x9},{exec:x9});var xme=o1,vY=Function.prototype,I9=vY.apply,M9=vY.call,Ec=typeof Reflect=="object"&&Reflect.apply||(xme?M9.bind(I9):function(){return M9.apply(I9,arguments)}),N9=b1,P9=so,Ime=f6,k9=dt,bY=lr,Mme=wc,Nme=bY("species"),Q5=RegExp.prototype,h6=function(t,e,r,n){var i=bY(t),o=!k9(function(){var u={};return u[i]=function(){return 7},""[t](u)!=7}),a=o&&!k9(function(){var u=!1,c=/a/;return t==="split"&&(c={},c.constructor={},c.constructor[Nme]=function(){return c},c.flags="",c[i]=/./[i]),c.exec=function(){return u=!0,null},c[i](""),!u});if(!o||!a||r){var s=N9(/./[i]),l=e(i,""[t],function(u,c,f,h,d){var p=N9(u),m=c.exec;return m===Ime||m===Q5.exec?o&&!d?{done:!0,value:s(c,f,h)}:{done:!0,value:p(f,c,h)}:{done:!1}});P9(String.prototype,t,l[0]),P9(Q5,i,l[1])}n&&Mme(Q5[i],"sham",!0)},Pme=s8.charAt,T8=function(t,e,r){return e+(r?Pme(t,e).length:1)},O8=mt,kme=wi,$me=Math.floor,Z5=O8("".charAt),Lme=O8("".replace),J5=O8("".slice),Dme=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Fme=/\$([$&'`]|\d{1,2})/g,Hme=function(t,e,r,n,i,o){var a=r+t.length,s=n.length,l=Fme;return i!==void 0&&(i=kme(i),l=Dme),Lme(o,l,function(u,c){var f;switch(Z5(c,0)){case"$":return"$";case"&":return t;case"`":return J5(e,0,r);case"'":return J5(e,a);case"<":f=i[J5(c,1,-1)];break;default:var h=+c;if(h===0)return u;if(h>s){var d=$me(h/10);return d===0?u:d<=s?n[d-1]===void 0?Z5(c,1):n[d-1]+Z5(c,1):u}f=n[h-1]}return f===void 0?"":f})},$9=en,Bme=$r,Ume=cr,Vme=ga,jme=f6,Wme=TypeError,d6=function(t,e){var r=t.exec;if(Ume(r)){var n=$9(r,t,e);return n!==null&&Bme(n),n}if(Vme(t)==="RegExp")return $9(jme,t,e);throw Wme("RegExp#exec called on incompatible receiver")},zme=Ec,L9=en,p6=mt,Gme=h6,Yme=dt,Kme=$r,qme=cr,Xme=No,Qme=Sl,Zme=bc,Lc=Gr,Jme=bi,ege=T8,tge=vc,rge=Hme,nge=d6,ige=lr,J_=ige("replace"),oge=Math.max,age=Math.min,sge=p6([].concat),eE=p6([].push),D9=p6("".indexOf),F9=p6("".slice),lge=function(t){return t===void 0?t:String(t)},uge=function(){return"a".replace(/./,"$0")==="$0"}(),H9=function(){return/./[J_]?/./[J_]("a","$0")==="":!1}(),cge=!Yme(function(){var t=/./;return t.exec=function(){var e=[];return e.groups={a:"7"},e},"".replace(t,"$<a>")!=="7"});Gme("replace",function(t,e,r){var n=H9?"$":"$0";return[function(o,a){var s=Jme(this),l=Xme(o)?void 0:tge(o,J_);return l?L9(l,o,s,a):L9(e,Lc(s),o,a)},function(i,o){var a=Kme(this),s=Lc(i);if(typeof o=="string"&&D9(o,n)===-1&&D9(o,"$<")===-1){var l=r(e,a,s,o);if(l.done)return l.value}var u=qme(o);u||(o=Lc(o));var c=a.global;if(c){var f=a.unicode;a.lastIndex=0}for(var h=[];;){var d=nge(a,s);if(d===null||(eE(h,d),!c))break;var p=Lc(d[0]);p===""&&(a.lastIndex=ege(s,Zme(a.lastIndex),f))}for(var m="",g=0,v=0;v<h.length;v++){d=h[v];for(var S=Lc(d[0]),b=oge(age(Qme(d.index),s.length),0),E=[],T=1;T<d.length;T++)eE(E,lge(d[T]));var N=d.groups;if(u){var L=sge([S],E,b,s);N!==void 0&&eE(L,N);var V=Lc(zme(o,void 0,L))}else V=rge(S,s,b,E,N,o);b>=g&&(m+=F9(s,g,b)+V,g=b+S.length)}return m+F9(s,g)}]},!cge||!uge||H9);var fge=dt,hge=lr,dge=s1,pge=hge("species"),R1=function(t){return dge>=51||!fge(function(){var e=[],r=e.constructor={};return r[pge]=function(){return{foo:1}},e[t](Boolean).foo!==1})},mge=tt,gge=Rc.filter,yge=R1,vge=yge("filter");mge({target:"Array",proto:!0,forced:!vge},{filter:function(e){return gge(this,e,arguments.length>1?arguments[1]:void 0)}});var bge=nr,wY=bge,A8={},wge=lr;A8.f=wge;var B9=wY,Sge=Rr,Rge=A8,Ege=ei.f,x8=function(t){var e=B9.Symbol||(B9.Symbol={});Sge(e,t)||Ege(e,t,{value:Rge.f(t)})},Cge=en,_ge=_s,Tge=lr,Oge=so,SY=function(){var t=_ge("Symbol"),e=t&&t.prototype,r=e&&e.valueOf,n=Tge("toPrimitive");e&&!e[n]&&Oge(e,n,function(i){return Cge(r,this)},{arity:1})},Age=x8,xge=SY;Age("toPrimitive");xge();var Ige=$r,Mge=fG,Nge=TypeError,Pge=function(t){if(Ige(this),t==="string"||t==="default")t="string";else if(t!=="number")throw Nge("Incorrect hint");return Mge(this,t)},kge=Rr,$ge=so,Lge=Pge,Dge=lr,U9=Dge("toPrimitive"),V9=Date.prototype;kge(V9,U9)||$ge(V9,U9,Lge);var j9=Z4.exports,Fge=ei,E1=function(t,e,r){return r.get&&j9(r.get,e,{getter:!0}),r.set&&j9(r.set,e,{setter:!0}),Fge.f(t,e,r)},m6=tt,I8=nr,M8=en,Hge=mt,fh=zr,hh=Np,Bge=dt,gn=Rr,Uge=wl,eT=$r,g6=Li,N8=r6,Vge=Gr,tT=p1,Og=kp,RY=f1,jge=Sc,EY=c8,Wge=y1,CY=ya,_Y=ei,zge=q4,TY=m1,tE=so,Gge=E1,P8=mc.exports,Yge=n6,OY=c1,W9=e6,Kge=lr,qge=A8,Xge=x8,Qge=SY,Zge=a6,AY=Ts,y6=Rc.forEach,li=Yge("hidden"),v6="Symbol",Ag="prototype",Jge=AY.set,z9=AY.getterFor(v6),Ki=Object[Ag],Lu=I8.Symbol,Fm=Lu&&Lu[Ag],eye=I8.TypeError,rE=I8.QObject,xY=CY.f,Jl=_Y.f,IY=EY.f,tye=TY.f,MY=Hge([].push),ws=P8("symbols"),C1=P8("op-symbols"),rye=P8("wks"),rT=!rE||!rE[Ag]||!rE[Ag].findChild,nT=fh&&Bge(function(){return Og(Jl({},"a",{get:function(){return Jl(this,"a",{value:7}).a}})).a!=7})?function(t,e,r){var n=xY(Ki,e);n&&delete Ki[e],Jl(t,e,r),n&&t!==Ki&&Jl(Ki,e,n)}:Jl,nE=function(t,e){var r=ws[t]=Og(Fm);return Jge(r,{type:v6,tag:t,description:e}),fh||(r.description=e),r},b6=function(e,r,n){e===Ki&&b6(C1,r,n),eT(e);var i=N8(r);return eT(n),gn(ws,i)?(n.enumerable?(gn(e,li)&&e[li][i]&&(e[li][i]=!1),n=Og(n,{enumerable:tT(0,!1)})):(gn(e,li)||Jl(e,li,tT(1,{})),e[li][i]=!0),nT(e,i,n)):Jl(e,i,n)},k8=function(e,r){eT(e);var n=g6(r),i=RY(n).concat(kY(n));return y6(i,function(o){(!fh||M8(iT,n,o))&&b6(e,o,n[o])}),e},nye=function(e,r){return r===void 0?Og(e):k8(Og(e),r)},iT=function(e){var r=N8(e),n=M8(tye,this,r);return this===Ki&&gn(ws,r)&&!gn(C1,r)?!1:n||!gn(this,r)||!gn(ws,r)||gn(this,li)&&this[li][r]?n:!0},NY=function(e,r){var n=g6(e),i=N8(r);if(!(n===Ki&&gn(ws,i)&&!gn(C1,i))){var o=xY(n,i);return o&&gn(ws,i)&&!(gn(n,li)&&n[li][i])&&(o.enumerable=!0),o}},PY=function(e){var r=IY(g6(e)),n=[];return y6(r,function(i){!gn(ws,i)&&!gn(OY,i)&&MY(n,i)}),n},kY=function(t){var e=t===Ki,r=IY(e?C1:g6(t)),n=[];return y6(r,function(i){gn(ws,i)&&(!e||gn(Ki,i))&&MY(n,ws[i])}),n};hh||(Lu=function(){if(Uge(Fm,this))throw eye("Symbol is not a constructor");var e=!arguments.length||arguments[0]===void 0?void 0:Vge(arguments[0]),r=W9(e),n=function(i){this===Ki&&M8(n,C1,i),gn(this,li)&&gn(this[li],r)&&(this[li][r]=!1),nT(this,r,tT(1,i))};return fh&&rT&&nT(Ki,r,{configurable:!0,set:n}),nE(r,e)},Fm=Lu[Ag],tE(Fm,"toString",function(){return z9(this).tag}),tE(Lu,"withoutSetter",function(t){return nE(W9(t),t)}),TY.f=iT,_Y.f=b6,zge.f=k8,CY.f=NY,jge.f=EY.f=PY,Wge.f=kY,qge.f=function(t){return nE(Kge(t),t)},fh&&(Gge(Fm,"description",{configurable:!0,get:function(){return z9(this).description}}),tE(Ki,"propertyIsEnumerable",iT,{unsafe:!0})));m6({global:!0,constructor:!0,wrap:!0,forced:!hh,sham:!hh},{Symbol:Lu});y6(RY(rye),function(t){Xge(t)});m6({target:v6,stat:!0,forced:!hh},{useSetter:function(){rT=!0},useSimple:function(){rT=!1}});m6({target:"Object",stat:!0,forced:!hh,sham:!fh},{create:nye,defineProperty:b6,defineProperties:k8,getOwnPropertyDescriptor:NY});m6({target:"Object",stat:!0,forced:!hh},{getOwnPropertyNames:PY});Qge();Zge(Lu,v6);OY[li]=!0;var iye=Np,$Y=iye&&!!Symbol.for&&!!Symbol.keyFor,oye=tt,aye=_s,sye=Rr,lye=Gr,LY=mc.exports,uye=$Y,iE=LY("string-to-symbol-registry"),cye=LY("symbol-to-string-registry");oye({target:"Symbol",stat:!0,forced:!uye},{for:function(t){var e=lye(t);if(sye(iE,e))return iE[e];var r=aye("Symbol")(e);return iE[e]=r,cye[r]=e,r}});var fye=tt,hye=Rr,dye=l1,pye=Pp,mye=mc.exports,gye=$Y,G9=mye("symbol-to-string-registry");fye({target:"Symbol",stat:!0,forced:!gye},{keyFor:function(e){if(!dye(e))throw TypeError(pye(e)+" is not a symbol");if(hye(G9,e))return G9[e]}});var yye=mt,_1=yye([].slice),vye=mt,Y9=Dp,bye=cr,K9=ga,wye=Gr,q9=vye([].push),Sye=function(t){if(bye(t))return t;if(!!Y9(t)){for(var e=t.length,r=[],n=0;n<e;n++){var i=t[n];typeof i=="string"?q9(r,i):(typeof i=="number"||K9(i)=="Number"||K9(i)=="String")&&q9(r,wye(i))}var o=r.length,a=!0;return function(s,l){if(a)return a=!1,l;if(Y9(this))return l;for(var u=0;u<o;u++)if(r[u]===s)return l}}},Rye=tt,DY=_s,FY=Ec,Eye=en,T1=mt,HY=dt,X9=cr,Q9=l1,BY=_1,Cye=Sye,_ye=Np,Tye=String,Qs=DY("JSON","stringify"),v0=T1(/./.exec),Z9=T1("".charAt),Oye=T1("".charCodeAt),Aye=T1("".replace),xye=T1(1 .toString),Iye=/[\uD800-\uDFFF]/g,J9=/^[\uD800-\uDBFF]$/,eP=/^[\uDC00-\uDFFF]$/,tP=!_ye||HY(function(){var t=DY("Symbol")();return Qs([t])!="[null]"||Qs({a:t})!="{}"||Qs(Object(t))!="{}"}),rP=HY(function(){return Qs("\uDF06\uD834")!=='"\\udf06\\ud834"'||Qs("\uDEAD")!=='"\\udead"'}),Mye=function(t,e){var r=BY(arguments),n=Cye(e);if(!(!X9(n)&&(t===void 0||Q9(t))))return r[1]=function(i,o){if(X9(n)&&(o=Eye(n,this,Tye(i),o)),!Q9(o))return o},FY(Qs,null,r)},Nye=function(t,e,r){var n=Z9(r,e-1),i=Z9(r,e+1);return v0(J9,t)&&!v0(eP,i)||v0(eP,t)&&!v0(J9,n)?"\\u"+xye(Oye(t,0),16):t};Qs&&Rye({target:"JSON",stat:!0,arity:3,forced:tP||rP},{stringify:function(e,r,n){var i=BY(arguments),o=FY(tP?Mye:Qs,null,i);return rP&&typeof o=="string"?Aye(o,Iye,Nye):o}});var Pye=tt,kye=Np,$ye=dt,UY=y1,Lye=wi,Dye=!kye||$ye(function(){UY.f(1)});Pye({target:"Object",stat:!0,forced:Dye},{getOwnPropertySymbols:function(e){var r=UY.f;return r?r(Lye(e)):[]}});var Fye=tt,Hye=zr,Bye=nr,b0=mt,Uye=Rr,Vye=cr,jye=wl,Wye=Gr,zye=E1,Gye=_G,Pa=Bye.Symbol,Il=Pa&&Pa.prototype;if(Hye&&Vye(Pa)&&(!("description"in Il)||Pa().description!==void 0)){var nP={},w0=function(){var e=arguments.length<1||arguments[0]===void 0?void 0:Wye(arguments[0]),r=jye(Il,this)?new Pa(e):e===void 0?Pa():Pa(e);return e===""&&(nP[r]=!0),r};Gye(w0,Pa),w0.prototype=Il,Il.constructor=w0;var Yye=String(Pa("test"))=="Symbol(test)",Kye=b0(Il.valueOf),qye=b0(Il.toString),Xye=/^Symbol\((.*)\)[^)]+$/,Qye=b0("".replace),Zye=b0("".slice);zye(Il,"description",{configurable:!0,get:function(){var e=Kye(this);if(Uye(nP,e))return"";var r=qye(e),n=Yye?Zye(r,7,-1):Qye(r,Xye,"$1");return n===""?void 0:n}}),Fye({global:!0,constructor:!0,forced:!0},{Symbol:w0})}var Jye=mt,VY=Jye(1 .valueOf),jY=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,eve=mt,tve=bi,rve=Gr,oT=jY,iP=eve("".replace),nve=RegExp("^["+oT+"]+"),ive=RegExp("(^|[^"+oT+"])["+oT+"]+$"),oE=function(t){return function(e){var r=rve(tve(e));return t&1&&(r=iP(r,nve,"")),t&2&&(r=iP(r,ive,"$1")),r}},WY={start:oE(1),end:oE(2),trim:oE(3)},ove=tt,zY=Tse,ave=zr,GY=nr,YY=wY,KY=mt,sve=i6,oP=Rr,lve=v8,uve=wl,cve=l1,qY=hG,fve=dt,hve=Sc.f,dve=ya.f,pve=ei.f,mve=VY,gve=WY.trim,w6="Number",jf=GY[w6];YY[w6];var $8=jf.prototype,yve=GY.TypeError,vve=KY("".slice),S0=KY("".charCodeAt),bve=function(t){var e=qY(t,"number");return typeof e=="bigint"?e:wve(e)},wve=function(t){var e=qY(t,"number"),r,n,i,o,a,s,l,u;if(cve(e))throw yve("Cannot convert a Symbol value to a number");if(typeof e=="string"&&e.length>2){if(e=gve(e),r=S0(e,0),r===43||r===45){if(n=S0(e,2),n===88||n===120)return NaN}else if(r===48){switch(S0(e,1)){case 66:case 98:i=2,o=49;break;case 79:case 111:i=8,o=55;break;default:return+e}for(a=vve(e,2),s=a.length,l=0;l<s;l++)if(u=S0(a,l),u<48||u>o)return NaN;return parseInt(a,i)}}return+e},L8=sve(w6,!jf(" 0o1")||!jf("0b1")||jf("+0x1")),Sve=function(t){return uve($8,t)&&fve(function(){mve(t)})},S6=function(e){var r=arguments.length<1?0:jf(bve(e));return Sve(this)?lve(Object(r),this,S6):r};S6.prototype=$8;L8&&!zY&&($8.constructor=S6);ove({global:!0,constructor:!0,wrap:!0,forced:L8},{Number:S6});var Rve=function(t,e){for(var r=ave?hve(e):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,i;r.length>n;n++)oP(e,i=r[n])&&!oP(t,i)&&pve(t,i,dve(e,i))};(L8||zY)&&Rve(YY[w6],jf);var Eve=tt,Cve=t8;Eve({target:"Object",stat:!0},{setPrototypeOf:Cve});var _ve=tt,Tve=dt,Ove=wi,XY=o6,Ave=TG,xve=Tve(function(){XY(1)});_ve({target:"Object",stat:!0,forced:xve,sham:!Ave},{getPrototypeOf:function(e){return XY(Ove(e))}});var QY=mt,Ive=yc,Mve=Wr,Nve=Rr,aP=_1,Pve=o1,ZY=Function,kve=QY([].concat),$ve=QY([].join),aE={},Lve=function(t,e,r){if(!Nve(aE,e)){for(var n=[],i=0;i<e;i++)n[i]="a["+i+"]";aE[e]=ZY("C,a","return new C("+$ve(n,",")+")")}return aE[e](t,r)},Dve=Pve?ZY.bind:function(e){var r=Ive(this),n=r.prototype,i=aP(arguments,1),o=function(){var s=kve(i,aP(arguments));return this instanceof o?Lve(r,s.length,s):r.apply(e,s)};return Mve(n)&&(o.prototype=n),o},Fve=u6,Hve=Pp,Bve=TypeError,JY=function(t){if(Fve(t))return t;throw Bve(Hve(t)+" is not a constructor")},Uve=tt,Vve=_s,sE=Ec,jve=Dve,sP=JY,Wve=$r,lP=Wr,zve=kp,eK=dt,D8=Vve("Reflect","construct"),Gve=Object.prototype,Yve=[].push,tK=eK(function(){function t(){}return!(D8(function(){},[],t)instanceof t)}),rK=!eK(function(){D8(function(){})}),uP=tK||rK;Uve({target:"Reflect",stat:!0,forced:uP,sham:uP},{construct:function(e,r){sP(e),Wve(r);var n=arguments.length<3?e:sP(arguments[2]);if(rK&&!tK)return D8(e,r,n);if(e==n){switch(r.length){case 0:return new e;case 1:return new e(r[0]);case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[1],r[2]);case 4:return new e(r[0],r[1],r[2],r[3])}var i=[null];return sE(Yve,i,r),new(sE(jve,e,i))}var o=n.prototype,a=zve(lP(o)?o:Gve),s=sE(e,a,r);return lP(s)?s:a}});var cP=Rr,Kve=function(t){return t!==void 0&&(cP(t,"value")||cP(t,"writable"))},qve=tt,Xve=en,Qve=Wr,Zve=$r,Jve=Kve,e1e=ya,t1e=o6;function nK(t,e){var r=arguments.length<3?t:arguments[2],n,i;if(Zve(t)===r)return t[e];if(n=e1e.f(t,e),n)return Jve(n)?n.value:n.get===void 0?void 0:Xve(n.get,r);if(Qve(i=t1e(t)))return nK(i,e,r)}qve({target:"Reflect",stat:!0},{get:nK});var r1e=tt,n1e=dt,i1e=Li,iK=ya.f,oK=zr,o1e=!oK||n1e(function(){iK(1)});r1e({target:"Object",stat:!0,forced:o1e,sham:!oK},{getOwnPropertyDescriptor:function(e,r){return iK(i1e(e),r)}});var a1e=x8;a1e("iterator");var s1e=tt,fP=Dp,l1e=u6,u1e=Wr,hP=u1,c1e=ao,f1e=Li,h1e=Lp,d1e=lr,p1e=R1,m1e=_1,g1e=p1e("slice"),y1e=d1e("species"),lE=Array,v1e=Math.max;s1e({target:"Array",proto:!0,forced:!g1e},{slice:function(e,r){var n=f1e(this),i=c1e(n),o=hP(e,i),a=hP(r===void 0?i:r,i),s,l,u;if(fP(n)&&(s=n.constructor,l1e(s)&&(s===lE||fP(s.prototype))?s=void 0:u1e(s)&&(s=s[y1e],s===null&&(s=void 0)),s===lE||s===void 0))return m1e(n,o,a);for(l=new(s===void 0?lE:s)(v1e(a-o,0)),u=0;o<a;o++,u++)o in n&&h1e(l,u,n[o]);return l.length=u,l}});var b1e=zr,w1e=g1.EXISTS,aK=mt,S1e=E1,sK=Function.prototype,R1e=aK(sK.toString),lK=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,E1e=aK(lK.exec),C1e="name";b1e&&!w1e&&S1e(sK,C1e,{configurable:!0,get:function(){try{return E1e(lK,R1e(this))[1]}catch{return""}}});var _1e=$r,T1e=UG,O1e=function(t,e,r,n){try{return n?e(_1e(r)[0],r[1]):e(r)}catch(i){T1e(t,"throw",i)}},A1e=w1,x1e=en,I1e=wi,M1e=O1e,N1e=HG,P1e=u6,k1e=ao,dP=Lp,$1e=BG,L1e=m8,pP=Array,D1e=function(e){var r=I1e(e),n=P1e(this),i=arguments.length,o=i>1?arguments[1]:void 0,a=o!==void 0;a&&(o=A1e(o,i>2?arguments[2]:void 0));var s=L1e(r),l=0,u,c,f,h,d,p;if(s&&!(this===pP&&N1e(s)))for(h=$1e(r,s),d=h.next,c=n?new this:[];!(f=x1e(d,h)).done;l++)p=a?M1e(h,o,[f.value,l],!0):f.value,dP(c,l,p);else for(u=k1e(r),c=n?new this(u):pP(u);u>l;l++)p=a?o(r[l],l):r[l],dP(c,l,p);return c.length=l,c},F1e=tt,H1e=D1e,B1e=WG,U1e=!B1e(function(t){Array.from(t)});F1e({target:"Array",stat:!0,forced:U1e},{from:H1e});var V1e=tt,j1e=l8,W1e=dt,z1e=Wr,G1e=$p.exports.onFreeze,aT=Object.freeze,Y1e=W1e(function(){aT(1)});V1e({target:"Object",stat:!0,forced:Y1e,sham:!j1e},{freeze:function(e){return aT&&z1e(e)?aT(G1e(e)):e}});var K1e=g1.PROPER,q1e=dt,mP=jY,gP="\u200B\x85\u180E",X1e=function(t){return q1e(function(){return!!mP[t]()||gP[t]()!==gP||K1e&&mP[t].name!==t})},Q1e=tt,Z1e=WY.trim,J1e=X1e;Q1e({target:"String",proto:!0,forced:J1e("trim")},{trim:function(){return Z1e(this)}});var e0e=tt,t0e=X4.includes,r0e=dt,n0e=h1,i0e=r0e(function(){return!Array(1).includes()});e0e({target:"Array",proto:!0,forced:i0e},{includes:function(e){return t0e(this,e,arguments.length>1?arguments[1]:void 0)}});n0e("includes");var o0e=en,a0e=Rr,s0e=wl,l0e=pY,yP=RegExp.prototype,uK=function(t){var e=t.flags;return e===void 0&&!("flags"in yP)&&!a0e(t,"flags")&&s0e(yP,t)?o0e(l0e,t):e},u0e=g1.PROPER,c0e=so,f0e=$r,vP=Gr,h0e=dt,d0e=uK,F8="toString",p0e=RegExp.prototype,cK=p0e[F8],m0e=h0e(function(){return cK.call({source:"a",flags:"b"})!="/a/b"}),g0e=u0e&&cK.name!=F8;(m0e||g0e)&&c0e(RegExp.prototype,F8,function(){var e=f0e(this),r=vP(e.source),n=vP(d0e(e));return"/"+r+"/"+n},{unsafe:!0});var y0e=tt,v0e=s8.codeAt;y0e({target:"String",proto:!0},{codePointAt:function(e){return v0e(this,e)}});var b0e=Sl,w0e=Gr,S0e=bi,R0e=RangeError,fK=function(e){var r=w0e(S0e(this)),n="",i=b0e(e);if(i<0||i==1/0)throw R0e("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(r+=r))i&1&&(n+=r);return n},hK=mt,E0e=bc,bP=Gr,C0e=fK,_0e=bi,T0e=hK(C0e),O0e=hK("".slice),A0e=Math.ceil,wP=function(t){return function(e,r,n){var i=bP(_0e(e)),o=E0e(r),a=i.length,s=n===void 0?" ":bP(n),l,u;return o<=a||s==""?i:(l=o-a,u=T0e(s,A0e(l/s.length)),u.length>l&&(u=O0e(u,0,l)),t?i+u:u+i)}},x0e={start:wP(!1),end:wP(!0)},I0e=gc,M0e=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(I0e),N0e=tt,P0e=x0e.start,k0e=M0e;N0e({target:"String",proto:!0,forced:k0e},{padStart:function(e){return P0e(this,e,arguments.length>1?arguments[1]:void 0)}});var $0e=TypeError,L0e=9007199254740991,dK=function(t){if(t>L0e)throw $0e("Maximum allowed index exceeded");return t},D0e=tt,F0e=dt,H0e=Dp,B0e=Wr,U0e=wi,V0e=ao,SP=dK,RP=Lp,j0e=w8,W0e=R1,z0e=lr,G0e=s1,pK=z0e("isConcatSpreadable"),Y0e=G0e>=51||!F0e(function(){var t=[];return t[pK]=!1,t.concat()[0]!==t}),K0e=function(t){if(!B0e(t))return!1;var e=t[pK];return e!==void 0?!!e:H0e(t)},q0e=!Y0e||!W0e("concat");D0e({target:"Array",proto:!0,arity:1,forced:q0e},{concat:function(e){var r=U0e(this),n=j0e(r,0),i=0,o,a,s,l,u;for(o=-1,s=arguments.length;o<s;o++)if(u=o===-1?r:arguments[o],K0e(u))for(l=V0e(u),SP(i+l),a=0;a<l;a++,i++)a in u&&RP(n,i,u[a]);else SP(i+1),RP(n,i++,u);return n.length=i,n}});var X0e=Wr,Q0e=ga,Z0e=lr,J0e=Z0e("match"),H8=function(t){var e;return X0e(t)&&((e=t[J0e])!==void 0?!!e:Q0e(t)=="RegExp")},ebe=H8,tbe=TypeError,B8=function(t){if(ebe(t))throw tbe("The method doesn't accept regular expressions");return t},rbe=lr,nbe=rbe("match"),U8=function(t){var e=/./;try{"/./"[t](e)}catch{try{return e[nbe]=!1,"/./"[t](e)}catch{}}return!1},ibe=tt,obe=mt,abe=B8,sbe=bi,EP=Gr,lbe=U8,ube=obe("".indexOf);ibe({target:"String",proto:!0,forced:!lbe("includes")},{includes:function(e){return!!~ube(EP(sbe(this)),EP(abe(e)),arguments.length>1?arguments[1]:void 0)}});var cbe=_s,fbe=E1,hbe=lr,dbe=zr,CP=hbe("species"),mK=function(t){var e=cbe(t);dbe&&e&&!e[CP]&&fbe(e,CP,{configurable:!0,get:function(){return this}})},pbe=kp,mbe=E1,_P=u8,gbe=w1,ybe=y8,vbe=No,bbe=g8,wbe=r8,R0=n8,Sbe=mK,im=zr,TP=$p.exports.fastKey,gK=Ts,OP=gK.set,uE=gK.getterFor,yK={getConstructor:function(t,e,r,n){var i=t(function(u,c){ybe(u,o),OP(u,{type:e,index:pbe(null),first:void 0,last:void 0,size:0}),im||(u.size=0),vbe(c)||bbe(c,u[n],{that:u,AS_ENTRIES:r})}),o=i.prototype,a=uE(e),s=function(u,c,f){var h=a(u),d=l(u,c),p,m;return d?d.value=f:(h.last=d={index:m=TP(c,!0),key:c,value:f,previous:p=h.last,next:void 0,removed:!1},h.first||(h.first=d),p&&(p.next=d),im?h.size++:u.size++,m!=="F"&&(h.index[m]=d)),u},l=function(u,c){var f=a(u),h=TP(c),d;if(h!=="F")return f.index[h];for(d=f.first;d;d=d.next)if(d.key==c)return d};return _P(o,{clear:function(){for(var c=this,f=a(c),h=f.index,d=f.first;d;)d.removed=!0,d.previous&&(d.previous=d.previous.next=void 0),delete h[d.index],d=d.next;f.first=f.last=void 0,im?f.size=0:c.size=0},delete:function(u){var c=this,f=a(c),h=l(c,u);if(h){var d=h.next,p=h.previous;delete f.index[h.index],h.removed=!0,p&&(p.next=d),d&&(d.previous=p),f.first==h&&(f.first=d),f.last==h&&(f.last=p),im?f.size--:c.size--}return!!h},forEach:function(c){for(var f=a(this),h=gbe(c,arguments.length>1?arguments[1]:void 0),d;d=d?d.next:f.first;)for(h(d.value,d.key,this);d&&d.removed;)d=d.previous},has:function(c){return!!l(this,c)}}),_P(o,r?{get:function(c){var f=l(this,c);return f&&f.value},set:function(c,f){return s(this,c===0?0:c,f)}}:{add:function(c){return s(this,c=c===0?0:c,c)}}),im&&mbe(o,"size",{configurable:!0,get:function(){return a(this).size}}),i},setStrong:function(t,e,r){var n=e+" Iterator",i=uE(e),o=uE(n);wbe(t,e,function(a,s){OP(this,{type:n,target:a,state:i(a),kind:s,last:void 0})},function(){for(var a=o(this),s=a.kind,l=a.last;l&&l.removed;)l=l.previous;return!a.target||!(a.last=l=l?l.next:a.state.first)?(a.target=void 0,R0(void 0,!0)):s=="keys"?R0(l.key,!1):s=="values"?R0(l.value,!1):R0([l.key,l.value],!1)},r?"entries":"values",!r,!0),Sbe(e)}},Rbe=l6,Ebe=yK;Rbe("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Ebe);var AP=$r,Cbe=JY,_be=No,Tbe=lr,Obe=Tbe("species"),Abe=function(t,e){var r=AP(t).constructor,n;return r===void 0||_be(n=AP(r)[Obe])?e:Cbe(n)},xbe=Ec,om=en,V8=mt,Ibe=h6,Mbe=$r,Nbe=No,Pbe=H8,xP=bi,kbe=Abe,$be=T8,Lbe=bc,cE=Gr,Dbe=vc,IP=f8,MP=d6,Fbe=f6,Hbe=_8,Bbe=dt,Dc=Hbe.UNSUPPORTED_Y,NP=4294967295,Ube=Math.min,vK=[].push,Vbe=V8(/./.exec),Fc=V8(vK),am=V8("".slice),jbe=!Bbe(function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var r="ab".split(t);return r.length!==2||r[0]!=="a"||r[1]!=="b"});Ibe("split",function(t,e,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(i,o){var a=cE(xP(this)),s=o===void 0?NP:o>>>0;if(s===0)return[];if(i===void 0)return[a];if(!Pbe(i))return om(e,a,i,s);for(var l=[],u=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),c=0,f=new RegExp(i.source,u+"g"),h,d,p;(h=om(Fbe,f,a))&&(d=f.lastIndex,!(d>c&&(Fc(l,am(a,c,h.index)),h.length>1&&h.index<a.length&&xbe(vK,l,IP(h,1)),p=h[0].length,c=d,l.length>=s)));)f.lastIndex===h.index&&f.lastIndex++;return c===a.length?(p||!Vbe(f,""))&&Fc(l,""):Fc(l,am(a,c)),l.length>s?IP(l,0,s):l}:"0".split(void 0,0).length?n=function(i,o){return i===void 0&&o===0?[]:om(e,this,i,o)}:n=e,[function(o,a){var s=xP(this),l=Nbe(o)?void 0:Dbe(o,t);return l?om(l,o,s,a):om(n,cE(s),o,a)},function(i,o){var a=Mbe(this),s=cE(i),l=r(n,a,s,o,n!==e);if(l.done)return l.value;var u=kbe(a,RegExp),c=a.unicode,f=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(Dc?"g":"y"),h=new u(Dc?"^(?:"+a.source+")":a,f),d=o===void 0?NP:o>>>0;if(d===0)return[];if(s.length===0)return MP(h,s)===null?[s]:[];for(var p=0,m=0,g=[];m<s.length;){h.lastIndex=Dc?0:m;var v=MP(h,Dc?am(s,m):s),S;if(v===null||(S=Ube(Lbe(h.lastIndex+(Dc?m:0)),s.length))===p)m=$be(s,m,c);else{if(Fc(g,am(s,p,m)),g.length===d)return g;for(var b=1;b<=v.length-1;b++)if(Fc(g,v[b]),g.length===d)return g;m=p=S}}return Fc(g,am(s,p)),g}]},!jbe,Dc);function Wbe(t){for(var e=t.length,r=0;r<e;)t[r]=[t[r]],r+=1}function PP(t,e){for(var r=e.length,n=0;n<r;)t.push(e[n]),n+=1}function zb(t){var e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;for(var r=t.length,n=t[0].length,i=0;i<r;i++)for(var o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Hn(t,e,r,n){var i=-1,o=t,a=r;Array.isArray(t)||(o=Array.from(t));var s=o.length;for(n&&s&&(i+=1,a=o[i]),i+=1;i<s;)a=e(a,o[i],i,o),i+=1;return a}function eo(t,e){var r=0,n=t;Array.isArray(t)||(n=Array.from(t));for(var i=n.length,o=[],a=-1;r<i;){var s=n[r];e(s,r,n)&&(a+=1,o[a]=s),r+=1}return o}function bt(t,e){var r=0,n=t;Array.isArray(t)||(n=Array.from(t));for(var i=n.length,o=[],a=-1;r<i;){var s=n[r];a+=1,o[a]=e(s,r,n),r+=1}return o}function Q(t,e){var r=0,n=t;Array.isArray(t)||(n=Array.from(t));for(var i=n.length;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function bK(t){var e=[];return Q(t,function(r){e.indexOf(r)===-1&&e.push(r)}),e}function kP(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=[].concat(e),i=n[0],o=n.slice(1),a=i;return Q(o,function(s){a=a.filter(function(l){return!s.includes(l)})}),a}function $P(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function Gt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var i=Hn(t,function(o,a,s){var l=a.replace(/\r?\n\s*/g,""),u=r[s]?r[s]:"";return o+l+u},"");return i.trim()}var LP,DP,FP,HP,BP,UP;function Wf(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function sT(t){return sT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sT(t)}function Vr(t){var e;switch(sT(t)){case"string":case"number":e="".concat(t);break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function He(t){return typeof t<"u"}function tr(t){return typeof t>"u"}function an(t){return t===null||t===""||tr(t)}function zbe(t){return Object.prototype.toString.call(t)==="[object RegExp]"}var Hm="length",Qm=function(e){return parseInt(e,16)},VP=function(e){return parseInt(e,10)},K2=function(e,r,n){return e.substr(r,n)},Zm=function(e){return e.codePointAt(0)-65},lT=function(e){return"".concat(e).replace(/\-/g,"")},Gbe=function(e){return Qm(K2(lT(e),Qm("12"),Zm("F")))/(Qm(K2(lT(e),Zm("B"),~~![][Hm]))||9)},Ybe=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},jP=!1,WP={invalid:function(){return Gt(LP||(LP=Wf([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(e){var r=e.keyValidityDate,n=e.hotVersion;return Gt(DP||(DP=Wf([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),r,n,r)},missing:function(){return Gt(FP||(FP=Wf([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},zP={invalid:function(){return Gt(HP||(HP=Wf([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(e){var r=e.keyValidityDate,n=e.hotVersion;return Gt(BP||(BP=Wf([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),r,n,r)},missing:function(){return Gt(UP||(UP=Wf([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function Kbe(t,e){var r=!an(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="12.3.3",o,a="invalid",s="invalid";t=lT(t||"");var l=qbe(t);if(r||n||l)if(l){var u=qt("28/03/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),f=Gbe(t);o=qt((f+1)*864e5,"x").format("MMMM DD, YYYY"),c>f?(a="expired",s="expired"):(a="valid",s="valid")}else n?(a="non_commercial",s="valid"):(a="invalid",s="invalid");else a="missing",s="missing";if(Ybe()&&(a="valid",s="valid"),!jP&&a!=="valid"){var h=WP[a]({keyValidityDate:o,hotVersion:i});h&&console[a==="non_commercial"?"info":"warn"](WP[a]({keyValidityDate:o,hotVersion:i})),jP=!0}if(s!=="valid"&&e.parentNode){var d=zP[s]({keyValidityDate:o,hotVersion:i});if(d){var p=document.createElement("div");p.className="hot-display-license-info",p.innerHTML=zP[s]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(p,e.nextSibling)}}}function qbe(t){var e=[][Hm],r=e;if(t[Hm]!==Zm("Z"))return!1;for(var n="",i="B<H4P+".split(""),o=Zm(i.shift());o;o=Zm(i.shift()||"A"))--o<""[Hm]?r=r|(VP("".concat(VP(Qm(n)+(Qm(K2(t,Math.abs(o),2))+[]).padStart(2,"0"))))%97||2)>>1:n=K2(t,o,o?i[Hm]===1?9:8:6);return r===e}var Xbe=wi,GP=u1,Qbe=ao,Zbe=function(e){for(var r=Xbe(this),n=Qbe(r),i=arguments.length,o=GP(i>1?arguments[1]:void 0,n),a=i>2?arguments[2]:void 0,s=a===void 0?n:GP(a,n);s>o;)r[o++]=e;return r},Jbe=tt,e2e=Zbe,t2e=h1;Jbe({target:"Array",proto:!0},{fill:e2e});t2e("fill");var r2e=Rc.forEach,n2e=Fp,i2e=n2e("forEach"),o2e=i2e?[].forEach:function(e){return r2e(this,e,arguments.length>1?arguments[1]:void 0)},YP=nr,KP=iY,a2e=oY,fE=o2e,s2e=wc,wK=function(t){if(t&&t.forEach!==fE)try{s2e(t,"forEach",fE)}catch{t.forEach=fE}};for(var hE in KP)KP[hE]&&wK(YP[hE]&&YP[hE].prototype);wK(a2e);function qP(t,e,r){return e=l2e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l2e(t){var e=u2e(t,"string");return Ss(e)==="symbol"?e:String(e)}function u2e(t,e){if(Ss(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ss(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ss(t){return Ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ss(t)}function xg(t){var e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},St(t,function(r,n){n!=="__children"&&(r&&Ss(r)==="object"&&!Array.isArray(r)?e[n]=xg(r):Array.isArray(r)?r.length&&Ss(r[0])==="object"&&!Array.isArray(r[0])?e[n]=[xg(r[0])]:e[n]=[]:e[n]=null)})),e}function Rl(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Jr(t,e,r){var n=Array.isArray(r);return St(e,function(i,o){(n===!1||r.includes(o))&&(t[o]=i)}),t}function R6(t,e){St(e,function(r,n){e[n]&&Ss(e[n])==="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),R6(t[n],e[n])):t[n]=e[n]})}function Zn(t){return Ss(t)==="object"?JSON.parse(JSON.stringify(t)):t}function di(t){var e={};return St(t,function(r,n){e[n]=r}),e}function ir(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Q(r,function(i){t.MIXINS.push(i.MIXIN_NAME),St(i,function(o,a){if(t.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof o=="function")t.prototype[a]=o;else{var s=function(c,f){var h="_".concat(c),d=function(m){var g=m;return(Array.isArray(g)||wt(g))&&(g=Zn(g)),g};return function(){return this[h]===void 0&&(this[h]=d(f)),this[h]}},l=function(c){var f="_".concat(c);return function(h){this[f]=h}};Object.defineProperty(t.prototype,a,{get:s(a,o),set:l(a),configurable:!0})}})}),t}function SK(t,e){return JSON.stringify(t)===JSON.stringify(e)}function wt(t){return Object.prototype.toString.call(t)==="[object Object]"}function Os(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function St(t,e){for(var r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function c2e(t,e){var r=e.split("."),n=t;return St(r,function(i){if(n=n[i],n===void 0)return n=void 0,!1}),n}function dE(t,e,r){var n=e.split("."),i=t;n.forEach(function(o,a){a!==n.length-1?(Nr(i,o)||(i[o]={}),i=i[o]):i[o]=r})}function j8(t){if(!wt(t))return 0;var e=function r(n){var i=0;return wt(n)?St(n,function(o,a){a!=="__children"&&(i+=r(o))}):i+=1,i};return e(t)}function dh(t){var e,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),i=(e={_touched:!1},qP(e,n,t),qP(e,"isTouched",function(){return this._touched}),e);return Object.defineProperty(i,r,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),i}function Nr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var oi=function(e){var r={value:!1};return r.test=function(n,i){r.value=e(n,i)},r},va={chrome:oi(function(t,e){return/Chrome/.test(t)&&/Google/.test(e)}),chromeWebKit:oi(function(t){return/CriOS/.test(t)}),edge:oi(function(t){return/Edge/.test(t)}),edgeWebKit:oi(function(t){return/EdgiOS/.test(t)}),firefox:oi(function(t){return/Firefox/.test(t)}),firefoxWebKit:oi(function(t){return/FxiOS/.test(t)}),ie:oi(function(t){return/Trident/.test(t)}),ie9:oi(function(){return!!document.documentMode}),mobile:oi(function(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)}),safari:oi(function(t,e){return/Safari/.test(t)&&/Apple Computer/.test(e)})},O1={mac:oi(function(t){return/^Mac/.test(t)}),win:oi(function(t){return/^Win/.test(t)}),linux:oi(function(t){return/^Linux/.test(t)}),ios:oi(function(t){return/iPhone|iPad|iPod/i.test(t)})};function f2e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.userAgent,r=e===void 0?navigator.userAgent:e,n=t.vendor,i=n===void 0?navigator.vendor:n;St(va,function(o){var a=o.test;return void a(r,i)})}function h2e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.platform,r=e===void 0?navigator.platform:e;St(O1,function(n){var i=n.test;return void i(r)})}f2e();h2e();function RK(){return va.chrome.value}function d2e(){return va.chromeWebKit.value}function pE(){return va.firefox.value}function p2e(){return va.firefoxWebKit.value}function m2e(){return va.safari.value}function g2e(){return va.edge.value}function y2e(){return va.ie.value}function v2e(){return va.ie9.value}function na(){return va.mobile.value}function EK(){return O1.ios.value}function CK(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,e=t.maxTouchPoints;return e>2&&O1.mac.value}function XP(){return O1.win.value}function QP(){return O1.mac.value}var Ge={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:pE()?182:174,AUDIO_MUTE:pE()?181:173,AUDIO_UP:pE()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},b2e=[Ge.ALT,Ge.ARROW_DOWN,Ge.ARROW_LEFT,Ge.ARROW_RIGHT,Ge.ARROW_UP,Ge.AUDIO_DOWN,Ge.AUDIO_MUTE,Ge.AUDIO_UP,Ge.BACKSPACE,Ge.CAPS_LOCK,Ge.DELETE,Ge.END,Ge.ENTER,Ge.ESCAPE,Ge.F1,Ge.F2,Ge.F3,Ge.F4,Ge.F5,Ge.F6,Ge.F7,Ge.F8,Ge.F9,Ge.F10,Ge.F11,Ge.F12,Ge.F13,Ge.F14,Ge.F15,Ge.F16,Ge.F17,Ge.F18,Ge.F19,Ge.HOME,Ge.INSERT,Ge.MEDIA_NEXT,Ge.MEDIA_PLAY_PAUSE,Ge.MEDIA_PREV,Ge.MEDIA_STOP,Ge.NULL,Ge.NUM_LOCK,Ge.PAGE_DOWN,Ge.PAGE_UP,Ge.PAUSE,Ge.SCROLL_LOCK,Ge.SHIFT,Ge.TAB];function w2e(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function _K(t){return b2e.includes(t)}function S2e(t){return[Ge.CONTROL,Ge.COMMAND_LEFT,Ge.COMMAND_RIGHT,Ge.COMMAND_FIREFOX].includes(t)}function Ig(t,e){var r=e.split("|"),n=!1;return Q(r,function(i){if(t===Ge[i])return n=!0,!1}),n}function la(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Rf(t){return t.isImmediatePropagationEnabled===!1}function zu(t){return t.button===2}function W8(t){return t.button===0}var R2e=ei.f,E2e=function(t,e,r){r in t||R2e(t,r,{configurable:!0,get:function(){return e[r]},set:function(n){e[r]=n}})},C2e=zr,z8=nr,A1=mt,_2e=i6,T2e=v8,O2e=wc,A2e=Sc.f,ZP=wl,x2e=H8,JP=Gr,I2e=uK,TK=_8,M2e=E2e,N2e=so,P2e=dt,k2e=Rr,$2e=Ts.enforce,L2e=mK,D2e=lr,OK=mY,AK=gY,F2e=D2e("match"),Zs=z8.RegExp,Ef=Zs.prototype,H2e=z8.SyntaxError,B2e=A1(Ef.exec),q2=A1("".charAt),ek=A1("".replace),tk=A1("".indexOf),U2e=A1("".slice),V2e=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Du=/a/g,mE=/a/g,j2e=new Zs(Du)!==Du,xK=TK.MISSED_STICKY,W2e=TK.UNSUPPORTED_Y,z2e=C2e&&(!j2e||xK||OK||AK||P2e(function(){return mE[F2e]=!1,Zs(Du)!=Du||Zs(mE)==mE||Zs(Du,"i")!="/a/i"})),G2e=function(t){for(var e=t.length,r=0,n="",i=!1,o;r<=e;r++){if(o=q2(t,r),o==="\\"){n+=o+q2(t,++r);continue}!i&&o==="."?n+="[\\s\\S]":(o==="["?i=!0:o==="]"&&(i=!1),n+=o)}return n},Y2e=function(t){for(var e=t.length,r=0,n="",i=[],o={},a=!1,s=!1,l=0,u="",c;r<=e;r++){if(c=q2(t,r),c==="\\")c=c+q2(t,++r);else if(c==="]")a=!1;else if(!a)switch(!0){case c==="[":a=!0;break;case c==="(":B2e(V2e,U2e(t,r+1))&&(r+=2,s=!0),n+=c,l++;continue;case(c===">"&&s):if(u===""||k2e(o,u))throw new H2e("Invalid capture group name");o[u]=!0,i[i.length]=[u,l],s=!1,u="";continue}s?u+=c:n+=c}return[n,i]};if(_2e("RegExp",z2e)){for(var Ml=function(e,r){var n=ZP(Ef,this),i=x2e(e),o=r===void 0,a=[],s=e,l,u,c,f,h,d;if(!n&&i&&o&&e.constructor===Ml)return e;if((i||ZP(Ef,e))&&(e=e.source,o&&(r=I2e(s))),e=e===void 0?"":JP(e),r=r===void 0?"":JP(r),s=e,OK&&"dotAll"in Du&&(u=!!r&&tk(r,"s")>-1,u&&(r=ek(r,/s/g,""))),l=r,xK&&"sticky"in Du&&(c=!!r&&tk(r,"y")>-1,c&&W2e&&(r=ek(r,/y/g,""))),AK&&(f=Y2e(e),e=f[0],a=f[1]),h=T2e(Zs(e,r),n?this:Ef,Ml),(u||c||a.length)&&(d=$2e(h),u&&(d.dotAll=!0,d.raw=Ml(G2e(e),l)),c&&(d.sticky=!0),a.length&&(d.groups=a)),e!==s)try{O2e(h,"source",s===""?"(?:)":s)}catch{}return h},rk=A2e(Zs),nk=0;rk.length>nk;)M2e(Ml,Zs,rk[nk++]);Ef.constructor=Ml,Ml.prototype=Ef,N2e(z8,"RegExp",Ml,{constructor:!0})}L2e("RegExp");var K2e=tt,q2e=mt,X2e=a1,Q2e=Li,Z2e=Fp,J2e=q2e([].join),ewe=X2e!=Object,twe=ewe||!Z2e("join",",");K2e({target:"Array",proto:!0,forced:twe},{join:function(e){return J2e(Q2e(this),e===void 0?",":e)}});function uT(t){return uT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uT(t)}function G8(t){return window.requestAnimationFrame(t)}function rwe(){return!!document.documentElement.classList}function nwe(){return!!document.createTextNode("test").textContent}function iwe(){return!!window.getComputedStyle}function X2(t){window.cancelAnimationFrame(t)}function IK(){return"ontouchstart"in window}var cT;function owe(){var t=document.createElement("TABLE");t.style.borderSpacing="0",t.style.borderWidth="0",t.style.padding="0";var e=document.createElement("TBODY");t.appendChild(e),e.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",t.insertBefore(r,e),document.body.appendChild(t),cT=t.offsetHeight<2*t.lastChild.offsetHeight,document.body.removeChild(t)}function MK(){return cT===void 0&&owe(),cT}var Hc;function awe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Hc||((typeof Intl>"u"?"undefined":uT(Intl))==="object"?Hc=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Hc=function(n,i){return"".concat(n).localeCompare(i)}:Hc=function(n,i){return n===i?0:n>i?-1:1},Hc)}var sm;function swe(){if(sm!==void 0)return sm;try{var t={get passive(){sm=!0}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch{sm=!1}return sm}/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function Vs(t){return Vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vs(t)}function fT(t,e){return fT=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},fT(t,e)}function lwe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gb(t,e,r){return lwe()?Gb=Reflect.construct:Gb=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&fT(u,a.prototype),u},Gb.apply(null,arguments)}function go(t){return uwe(t)||cwe(t)||fwe(t)||hwe()}function uwe(t){if(Array.isArray(t))return hT(t)}function cwe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function fwe(t,e){if(!!t){if(typeof t=="string")return hT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hT(t,e)}}function hT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function hwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var dwe=Object.hasOwnProperty,ik=Object.setPrototypeOf,pwe=Object.isFrozen,mwe=Object.getPrototypeOf,gwe=Object.getOwnPropertyDescriptor,Jn=Object.freeze,Io=Object.seal,ywe=Object.create,NK=typeof Reflect<"u"&&Reflect,Q2=NK.apply,dT=NK.construct;Q2||(Q2=function(e,r,n){return e.apply(r,n)});Jn||(Jn=function(e){return e});Io||(Io=function(e){return e});dT||(dT=function(e,r){return Gb(e,go(r))});var vwe=to(Array.prototype.forEach),ok=to(Array.prototype.pop),lm=to(Array.prototype.push),Yb=to(String.prototype.toLowerCase),gE=to(String.prototype.toString),bwe=to(String.prototype.match),ho=to(String.prototype.replace),wwe=to(String.prototype.indexOf),Swe=to(String.prototype.trim),Bn=to(RegExp.prototype.test),yE=Rwe(TypeError);function to(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return Q2(t,e,n)}}function Rwe(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return dT(t,r)}}function Ct(t,e,r){r=r||Yb,ik&&ik(t,null);for(var n=e.length;n--;){var i=e[n];if(typeof i=="string"){var o=r(i);o!==i&&(pwe(e)||(e[n]=o),i=o)}t[i]=!0}return t}function Nl(t){var e=ywe(null),r;for(r in t)Q2(dwe,t,[r])===!0&&(e[r]=t[r]);return e}function E0(t,e){for(;t!==null;){var r=gwe(t,e);if(r){if(r.get)return to(r.get);if(typeof r.value=="function")return to(r.value)}t=mwe(t)}function n(i){return console.warn("fallback value for",i),null}return n}var ak=Jn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),vE=Jn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),bE=Jn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Ewe=Jn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),wE=Jn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Cwe=Jn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),sk=Jn(["#text"]),lk=Jn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),SE=Jn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),uk=Jn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),C0=Jn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),_we=Io(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Twe=Io(/<%[\w\W]*|[\w\W]*%>/gm),Owe=Io(/\${[\w\W]*}/gm),Awe=Io(/^data-[\-\w.\u00B7-\uFFFF]/),xwe=Io(/^aria-[\-\w]+$/),Iwe=Io(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Mwe=Io(/^(?:\w+script|data):/i),Nwe=Io(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Pwe=Io(/^html$/i),kwe=function(){return typeof window>"u"?null:window},$we=function(e,r){if(Vs(e)!=="object"||typeof e.createPolicy!="function")return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML:function(s){return s},createScriptURL:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function PK(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:kwe(),e=function(fe){return PK(fe)};if(e.version="2.4.5",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var r=t.document,n=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,a=t.Node,s=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,f=t.HTMLFormElement,h=t.DOMParser,d=t.trustedTypes,p=s.prototype,m=E0(p,"cloneNode"),g=E0(p,"nextSibling"),v=E0(p,"childNodes"),S=E0(p,"parentNode");if(typeof o=="function"){var b=n.createElement("template");b.content&&b.content.ownerDocument&&(n=b.content.ownerDocument)}var E=$we(d,r),T=E?E.createHTML(""):"",N=n,L=N.implementation,V=N.createNodeIterator,B=N.createDocumentFragment,k=N.getElementsByTagName,M=r.importNode,G={};try{G=Nl(n).documentMode?n.documentMode:{}}catch{}var j={};e.isSupported=typeof S=="function"&&L&&typeof L.createHTMLDocument<"u"&&G!==9;var q=_we,te=Twe,pe=Owe,ne=Awe,O=xwe,y=Mwe,R=Nwe,C=Iwe,A=null,P=Ct({},[].concat(go(ak),go(vE),go(bE),go(wE),go(sk))),H=null,Y=Ct({},[].concat(go(lk),go(SE),go(uk),go(C0))),z=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),oe=null,me=null,re=!0,ge=!0,ve=!1,ie=!0,be=!1,ce=!1,_e=!1,Ie=!1,Oe=!1,Ae=!1,xe=!1,I=!0,D=!1,U="user-content-",ae=!0,X=!1,le={},ee=null,Z=Ct({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ue=null,K=Ct({},["audio","video","img","source","image","track"]),se=null,we=Ct({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Se="http://www.w3.org/1998/Math/MathML",Me="http://www.w3.org/2000/svg",qe="http://www.w3.org/1999/xhtml",ke=qe,We=!1,Ke=null,Xe=Ct({},[Se,Me,qe],gE),nt,Rt=["application/xhtml+xml","text/html"],it="text/html",st,rt=null,Lt=n.createElement("form"),kt=function(fe){return fe instanceof RegExp||fe instanceof Function},It=function(fe){rt&&rt===fe||((!fe||Vs(fe)!=="object")&&(fe={}),fe=Nl(fe),nt=Rt.indexOf(fe.PARSER_MEDIA_TYPE)===-1?nt=it:nt=fe.PARSER_MEDIA_TYPE,st=nt==="application/xhtml+xml"?gE:Yb,A="ALLOWED_TAGS"in fe?Ct({},fe.ALLOWED_TAGS,st):P,H="ALLOWED_ATTR"in fe?Ct({},fe.ALLOWED_ATTR,st):Y,Ke="ALLOWED_NAMESPACES"in fe?Ct({},fe.ALLOWED_NAMESPACES,gE):Xe,se="ADD_URI_SAFE_ATTR"in fe?Ct(Nl(we),fe.ADD_URI_SAFE_ATTR,st):we,ue="ADD_DATA_URI_TAGS"in fe?Ct(Nl(K),fe.ADD_DATA_URI_TAGS,st):K,ee="FORBID_CONTENTS"in fe?Ct({},fe.FORBID_CONTENTS,st):Z,oe="FORBID_TAGS"in fe?Ct({},fe.FORBID_TAGS,st):{},me="FORBID_ATTR"in fe?Ct({},fe.FORBID_ATTR,st):{},le="USE_PROFILES"in fe?fe.USE_PROFILES:!1,re=fe.ALLOW_ARIA_ATTR!==!1,ge=fe.ALLOW_DATA_ATTR!==!1,ve=fe.ALLOW_UNKNOWN_PROTOCOLS||!1,ie=fe.ALLOW_SELF_CLOSE_IN_ATTR!==!1,be=fe.SAFE_FOR_TEMPLATES||!1,ce=fe.WHOLE_DOCUMENT||!1,Oe=fe.RETURN_DOM||!1,Ae=fe.RETURN_DOM_FRAGMENT||!1,xe=fe.RETURN_TRUSTED_TYPE||!1,Ie=fe.FORCE_BODY||!1,I=fe.SANITIZE_DOM!==!1,D=fe.SANITIZE_NAMED_PROPS||!1,ae=fe.KEEP_CONTENT!==!1,X=fe.IN_PLACE||!1,C=fe.ALLOWED_URI_REGEXP||C,ke=fe.NAMESPACE||qe,z=fe.CUSTOM_ELEMENT_HANDLING||{},fe.CUSTOM_ELEMENT_HANDLING&&kt(fe.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(z.tagNameCheck=fe.CUSTOM_ELEMENT_HANDLING.tagNameCheck),fe.CUSTOM_ELEMENT_HANDLING&&kt(fe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(z.attributeNameCheck=fe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),fe.CUSTOM_ELEMENT_HANDLING&&typeof fe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(z.allowCustomizedBuiltInElements=fe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),be&&(ge=!1),Ae&&(Oe=!0),le&&(A=Ct({},go(sk)),H=[],le.html===!0&&(Ct(A,ak),Ct(H,lk)),le.svg===!0&&(Ct(A,vE),Ct(H,SE),Ct(H,C0)),le.svgFilters===!0&&(Ct(A,bE),Ct(H,SE),Ct(H,C0)),le.mathMl===!0&&(Ct(A,wE),Ct(H,uk),Ct(H,C0))),fe.ADD_TAGS&&(A===P&&(A=Nl(A)),Ct(A,fe.ADD_TAGS,st)),fe.ADD_ATTR&&(H===Y&&(H=Nl(H)),Ct(H,fe.ADD_ATTR,st)),fe.ADD_URI_SAFE_ATTR&&Ct(se,fe.ADD_URI_SAFE_ATTR,st),fe.FORBID_CONTENTS&&(ee===Z&&(ee=Nl(ee)),Ct(ee,fe.FORBID_CONTENTS,st)),ae&&(A["#text"]=!0),ce&&Ct(A,["html","head","body"]),A.table&&(Ct(A,["tbody"]),delete oe.tbody),Jn&&Jn(fe),rt=fe)},gt=Ct({},["mi","mo","mn","ms","mtext"]),Kr=Ct({},["foreignobject","desc","title","annotation-xml"]),rn=Ct({},["title","style","font","a","script"]),Lr=Ct({},vE);Ct(Lr,bE),Ct(Lr,Ewe);var fo=Ct({},wE);Ct(fo,Cwe);var Jp=function(fe){var ye=S(fe);(!ye||!ye.tagName)&&(ye={namespaceURI:ke,tagName:"template"});var Te=Yb(fe.tagName),Dt=Yb(ye.tagName);return Ke[fe.namespaceURI]?fe.namespaceURI===Me?ye.namespaceURI===qe?Te==="svg":ye.namespaceURI===Se?Te==="svg"&&(Dt==="annotation-xml"||gt[Dt]):Boolean(Lr[Te]):fe.namespaceURI===Se?ye.namespaceURI===qe?Te==="math":ye.namespaceURI===Me?Te==="math"&&Kr[Dt]:Boolean(fo[Te]):fe.namespaceURI===qe?ye.namespaceURI===Me&&!Kr[Dt]||ye.namespaceURI===Se&&!gt[Dt]?!1:!fo[Te]&&(rn[Te]||!Lr[Te]):!!(nt==="application/xhtml+xml"&&Ke[fe.namespaceURI]):!1},Cn=function(fe){lm(e.removed,{element:fe});try{fe.parentNode.removeChild(fe)}catch{try{fe.outerHTML=T}catch{fe.remove()}}},et=function(fe,ye){try{lm(e.removed,{attribute:ye.getAttributeNode(fe),from:ye})}catch{lm(e.removed,{attribute:null,from:ye})}if(ye.removeAttribute(fe),fe==="is"&&!H[fe])if(Oe||Ae)try{Cn(ye)}catch{}else try{ye.setAttribute(fe,"")}catch{}},Et=function(fe){var ye,Te;if(Ie)fe="<remove></remove>"+fe;else{var Dt=bwe(fe,/^[\r\n\t ]+/);Te=Dt&&Dt[0]}nt==="application/xhtml+xml"&&ke===qe&&(fe='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+fe+"</body></html>");var ri=E?E.createHTML(fe):fe;if(ke===qe)try{ye=new h().parseFromString(ri,nt)}catch{}if(!ye||!ye.documentElement){ye=L.createDocument(ke,"template",null);try{ye.documentElement.innerHTML=We?T:ri}catch{}}var kn=ye.body||ye.documentElement;return fe&&Te&&kn.insertBefore(n.createTextNode(Te),kn.childNodes[0]||null),ke===qe?k.call(ye,ce?"html":"body")[0]:ce?ye.documentElement:kn},Wt=function(fe){return V.call(fe.ownerDocument||fe,fe,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},mr=function(fe){return fe instanceof f&&(typeof fe.nodeName!="string"||typeof fe.textContent!="string"||typeof fe.removeChild!="function"||!(fe.attributes instanceof c)||typeof fe.removeAttribute!="function"||typeof fe.setAttribute!="function"||typeof fe.namespaceURI!="string"||typeof fe.insertBefore!="function"||typeof fe.hasChildNodes!="function")},Mt=function(fe){return Vs(a)==="object"?fe instanceof a:fe&&Vs(fe)==="object"&&typeof fe.nodeType=="number"&&typeof fe.nodeName=="string"},_r=function(fe,ye,Te){!j[fe]||vwe(j[fe],function(Dt){Dt.call(e,ye,Te,rt)})},qr=function(fe){var ye;if(_r("beforeSanitizeElements",fe,null),mr(fe)||Bn(/[\u0080-\uFFFF]/,fe.nodeName))return Cn(fe),!0;var Te=st(fe.nodeName);if(_r("uponSanitizeElement",fe,{tagName:Te,allowedTags:A}),fe.hasChildNodes()&&!Mt(fe.firstElementChild)&&(!Mt(fe.content)||!Mt(fe.content.firstElementChild))&&Bn(/<[/\w]/g,fe.innerHTML)&&Bn(/<[/\w]/g,fe.textContent)||Te==="select"&&Bn(/<template/i,fe.innerHTML))return Cn(fe),!0;if(!A[Te]||oe[Te]){if(!oe[Te]&&kc(Te)&&(z.tagNameCheck instanceof RegExp&&Bn(z.tagNameCheck,Te)||z.tagNameCheck instanceof Function&&z.tagNameCheck(Te)))return!1;if(ae&&!ee[Te]){var Dt=S(fe)||fe.parentNode,ri=v(fe)||fe.childNodes;if(ri&&Dt)for(var kn=ri.length,_n=kn-1;_n>=0;--_n)Dt.insertBefore(m(ri[_n],!0),g(fe))}return Cn(fe),!0}return fe instanceof s&&!Jp(fe)||(Te==="noscript"||Te==="noembed")&&Bn(/<\/no(script|embed)/i,fe.innerHTML)?(Cn(fe),!0):(be&&fe.nodeType===3&&(ye=fe.textContent,ye=ho(ye,q," "),ye=ho(ye,te," "),ye=ho(ye,pe," "),fe.textContent!==ye&&(lm(e.removed,{element:fe.cloneNode()}),fe.textContent=ye)),_r("afterSanitizeElements",fe,null),!1)},Tr=function(fe,ye,Te){if(I&&(ye==="id"||ye==="name")&&(Te in n||Te in Lt))return!1;if(!(ge&&!me[ye]&&Bn(ne,ye))){if(!(re&&Bn(O,ye))){if(!H[ye]||me[ye]){if(!(kc(fe)&&(z.tagNameCheck instanceof RegExp&&Bn(z.tagNameCheck,fe)||z.tagNameCheck instanceof Function&&z.tagNameCheck(fe))&&(z.attributeNameCheck instanceof RegExp&&Bn(z.attributeNameCheck,ye)||z.attributeNameCheck instanceof Function&&z.attributeNameCheck(ye))||ye==="is"&&z.allowCustomizedBuiltInElements&&(z.tagNameCheck instanceof RegExp&&Bn(z.tagNameCheck,Te)||z.tagNameCheck instanceof Function&&z.tagNameCheck(Te))))return!1}else if(!se[ye]){if(!Bn(C,ho(Te,R,""))){if(!((ye==="src"||ye==="xlink:href"||ye==="href")&&fe!=="script"&&wwe(Te,"data:")===0&&ue[fe])){if(!(ve&&!Bn(y,ho(Te,R,"")))){if(Te)return!1}}}}}}return!0},kc=function(fe){return fe.indexOf("-")>0},Ra=function(fe){var ye,Te,Dt,ri;_r("beforeSanitizeAttributes",fe,null);var kn=fe.attributes;if(!!kn){var _n={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:H};for(ri=kn.length;ri--;){ye=kn[ri];var r0=ye,un=r0.name,g5=r0.namespaceURI;if(Te=un==="value"?ye.value:Swe(ye.value),Dt=st(un),_n.attrName=Dt,_n.attrValue=Te,_n.keepAttr=!0,_n.forceKeepAttr=void 0,_r("uponSanitizeAttribute",fe,_n),Te=_n.attrValue,!_n.forceKeepAttr&&(et(un,fe),!!_n.keepAttr)){if(!ie&&Bn(/\/>/i,Te)){et(un,fe);continue}be&&(Te=ho(Te,q," "),Te=ho(Te,te," "),Te=ho(Te,pe," "));var iN=st(fe.nodeName);if(!!Tr(iN,Dt,Te)){if(D&&(Dt==="id"||Dt==="name")&&(et(un,fe),Te=U+Te),E&&Vs(d)==="object"&&typeof d.getAttributeType=="function"&&!g5)switch(d.getAttributeType(iN,Dt)){case"TrustedHTML":Te=E.createHTML(Te);break;case"TrustedScriptURL":Te=E.createScriptURL(Te);break}try{g5?fe.setAttributeNS(g5,un,Te):fe.setAttribute(un,Te),ok(e.removed)}catch{}}}}_r("afterSanitizeAttributes",fe,null)}},xl=function Ve(fe){var ye,Te=Wt(fe);for(_r("beforeSanitizeShadowDOM",fe,null);ye=Te.nextNode();)_r("uponSanitizeShadowNode",ye,null),!qr(ye)&&(ye.content instanceof i&&Ve(ye.content),Ra(ye));_r("afterSanitizeShadowDOM",fe,null)};return e.sanitize=function(Ve){var fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ye,Te,Dt,ri,kn;if(We=!Ve,We&&(Ve="<!-->"),typeof Ve!="string"&&!Mt(Ve)){if(typeof Ve.toString!="function")throw yE("toString is not a function");if(Ve=Ve.toString(),typeof Ve!="string")throw yE("dirty is not a string, aborting")}if(!e.isSupported){if(Vs(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Ve=="string")return t.toStaticHTML(Ve);if(Mt(Ve))return t.toStaticHTML(Ve.outerHTML)}return Ve}if(_e||It(fe),e.removed=[],typeof Ve=="string"&&(X=!1),X){if(Ve.nodeName){var _n=st(Ve.nodeName);if(!A[_n]||oe[_n])throw yE("root node is forbidden and cannot be sanitized in-place")}}else if(Ve instanceof a)ye=Et("<!---->"),Te=ye.ownerDocument.importNode(Ve,!0),Te.nodeType===1&&Te.nodeName==="BODY"||Te.nodeName==="HTML"?ye=Te:ye.appendChild(Te);else{if(!Oe&&!be&&!ce&&Ve.indexOf("<")===-1)return E&&xe?E.createHTML(Ve):Ve;if(ye=Et(Ve),!ye)return Oe?null:xe?T:""}ye&&Ie&&Cn(ye.firstChild);for(var r0=Wt(X?Ve:ye);Dt=r0.nextNode();)Dt.nodeType===3&&Dt===ri||qr(Dt)||(Dt.content instanceof i&&xl(Dt.content),Ra(Dt),ri=Dt);if(ri=null,X)return Ve;if(Oe){if(Ae)for(kn=B.call(ye.ownerDocument);ye.firstChild;)kn.appendChild(ye.firstChild);else kn=ye;return(H.shadowroot||H.shadowrootmod)&&(kn=M.call(r,kn,!0)),kn}var un=ce?ye.outerHTML:ye.innerHTML;return ce&&A["!doctype"]&&ye.ownerDocument&&ye.ownerDocument.doctype&&ye.ownerDocument.doctype.name&&Bn(Pwe,ye.ownerDocument.doctype.name)&&(un="<!DOCTYPE "+ye.ownerDocument.doctype.name+`>
`+un),be&&(un=ho(un,q," "),un=ho(un,te," "),un=ho(un,pe," ")),E&&xe?E.createHTML(un):un},e.setConfig=function(Ve){It(Ve),_e=!0},e.clearConfig=function(){rt=null,_e=!1},e.isValidAttribute=function(Ve,fe,ye){rt||It({});var Te=st(Ve),Dt=st(fe);return Tr(Te,Dt,ye)},e.addHook=function(Ve,fe){typeof fe=="function"&&(j[Ve]=j[Ve]||[],lm(j[Ve],fe))},e.removeHook=function(Ve){if(j[Ve])return ok(j[Ve])},e.removeHooks=function(Ve){j[Ve]&&(j[Ve]=[])},e.removeAllHooks=function(){j={}},e}var Lwe=PK();function gs(t){return t[0].toUpperCase()+t.substr(1)}function kK(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function $K(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function LK(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(t).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n]})}function ck(t){return Y8("".concat(t),{ALLOWED_TAGS:[]})}function Y8(t,e){return Lwe.sanitize(t,e)}function fk(t){return Bwe(t)||Hwe(t)||Fwe(t)||Dwe()}function Dwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fwe(t,e){if(!!t){if(typeof t=="string")return pT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pT(t,e)}}function Hwe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Bwe(t){if(Array.isArray(t))return pT(t)}function pT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Uwe(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function Vwe(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Z2(t){return Vwe(t)&&t.parent}function Fu(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,i=n.ELEMENT_NODE,o=n.DOCUMENT_FRAGMENT_NODE,a=t;a!=null&&a!==r;){var s=a,l=s.nodeType,u=s.nodeName;if(l===i&&(e.includes(u)||e.includes(a)))return a;var c=a,f=c.host;f&&l===o?a=f:a=a.parentNode}return null}function _0(t,e,r){for(var n=[],i=t;i&&(i=Fu(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;var o=n.length;return o?n[o-1]:null}function Hu(t,e){var r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function jwe(t){var e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function Pl(t,e,r){var n=r.parentElement.querySelector(".ht_clone_".concat(t));return n?n.contains(e):null}var mT,gT,yT;function T0(t){return!t||!t.length?[]:t.filter(function(e){return!!e})}if(rwe()){var hk=function(e){var r=e.createElement("div");return r.classList.add("test","test2"),r.classList.contains("test2")};mT=function(e,r){return e.classList===void 0||typeof r!="string"||r===""?!1:e.classList.contains(r)},gT=function(e,r){var n=e.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=T0(i),i.length>0)if(hk(n)){var o;(o=e.classList).add.apply(o,fk(i))}else for(var a=0;i[a];)e.classList.add(i[a]),a+=1},yT=function(e,r){var n=e.ownerDocument,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=T0(i),i.length>0)if(hk(n)){var o;(o=e.classList).remove.apply(o,fk(i))}else for(var a=0;i[a];)e.classList.remove(i[a]),a+=1}}else{var RE=function(e){return new RegExp("(\\s|^)".concat(e,"(\\s|$)"))};mT=function(e,r){return e.className!==void 0&&RE(r).test(e.className)},gT=function(e,r){var n=e.className,i=r;if(typeof i=="string"&&(i=i.split(" ")),i=T0(i),n==="")n=i.join(" ");else for(var o=0;o<i.length;o++)i[o]&&!RE(i[o]).test(n)&&(n+=" ".concat(i[o]));e.className=n},yT=function(e,r){var n=0,i=e.className,o=r;for(typeof o=="string"&&(o=o.split(" ")),o=T0(o);o[n];)i=i.replace(RE(o[n])," ").trim(),n+=1;e.className!==i&&(e.className=i)}}function at(t,e){return mT(t,e)}function Re(t,e){gT(t,e)}function ut(t,e){yT(t,e)}function DK(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1)for(var e=t.childNodes,r=e.length-1;r>=0;r--)DK(e[r])}function ua(t){for(var e;e=t.lastChild;)t.removeChild(e)}var Wwe=/(<(.*)>|&(.*);)/;function Hp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Wwe.test(e)?t.innerHTML=r?Y8(e):e:Gu(t,e)}function Gu(t,e){var r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?nwe?r.textContent=e:r.data=e:(ua(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Mg(t){for(var e=t.ownerDocument.documentElement,r=t;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return Mg(r.host.impl);if(r.host)return Mg(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Zr(t){var e=t.ownerDocument,r=e.defaultView,n=e.documentElement,i=t,o,a,s,l;if(MK()&&i.firstChild&&i.firstChild.nodeName==="CAPTION")return l=i.getBoundingClientRect(),{top:l.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:l.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(o=i.offsetLeft,a=i.offsetTop,s=i;(i=i.offsetParent)&&i!==e.body;)o+=i.offsetLeft,a+=i.offsetTop,s=i;return s&&s.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:o,top:a}}function Ng(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=t.scrollY;return e===void 0&&(e=t.document.documentElement.scrollTop),e}function ph(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=t.scrollX;return e===void 0&&(e=t.document.documentElement.scrollLeft),e}function J2(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Ng(e):t.scrollTop}function vT(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?ph(e):t.scrollLeft}function ew(t){var e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);for(var n=["auto","scroll"],i=iwe(),o=t.parentNode;o&&o.style&&e.body!==o;){var a=o.style,s=a.overflow,l=a.overflowX,u=a.overflowY;if([s,l,u].includes("scroll"))return o;if(i){var c=r.getComputedStyle(o);if(s=c.overflow,l=c.overflowX,u=c.overflowY,n.includes(s)||n.includes(l)||n.includes(u))return o}if(o.clientHeight<=o.scrollHeight+1&&(n.includes(u)||n.includes(s))||o.clientWidth<=o.scrollWidth+1&&(n.includes(l)||n.includes(s)))return o;o=o.parentNode}return r}function Pg(t){for(var e=t.ownerDocument,r=e.defaultView,n=t.parentNode;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var i=Yu(n,r),o=["scroll","hidden","auto"],a=i.getPropertyValue("overflow"),s=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(a)||o.includes(s)||o.includes(l))return n;n=n.parentNode}return r}function kg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?"".concat(r.innerWidth,"px"):e==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=t.style[e];if(n!==""&&n!==void 0)return n;var i=Yu(t,r);if(i[e]!==""&&i[e]!==void 0)return i[e]}function Yu(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function Qt(t){return t.offsetWidth}function wr(t){return MK()&&t.firstChild&&t.firstChild.nodeName==="CAPTION"?t.offsetHeight+t.firstChild.offsetHeight:t.offsetHeight}function zs(t){return t.clientHeight||t.innerHeight}function Kb(t){return t.clientWidth||t.innerWidth}function FK(t){var e=t.ownerDocument;if(t.selectionStart)return t.selectionStart;if(e.selection){t.focus();var r=e.selection.createRange();if(r===null)return 0;var n=t.createTextRange(),i=n.duplicate();return n.moveToBookmark(r.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}return 0}function zwe(t){var e=t.ownerDocument;if(t.selectionEnd)return t.selectionEnd;if(e.selection){var r=e.selection.createRange();if(r===null)return 0;var n=t.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function Gwe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=t.document,r="";return t.getSelection?r=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(r=e.selection.createRange().text),r}function dk(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=t.document;t.getSelection?t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges():e.selection&&e.selection.empty()}function E6(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{var n=t.parentNode,i=n.style.display;n.style.display="block",t.setSelectionRange(e,r),n.style.display=i}}}var EE;function Ywe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";var r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);var n=e.offsetWidth;r.style.overflow="scroll";var i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i}function yn(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return EE===void 0&&(EE=Ywe(t)),EE}function Kwe(t){return t.offsetWidth!==t.clientWidth}function qwe(t){return t.offsetHeight!==t.clientHeight}function K8(t,e,r){v2e()?(t.style.top=r,t.style.left=e):m2e()?t.style["-webkit-transform"]="translate3d(".concat(e,",").concat(r,",0)"):t.style.transform="translate3d(".concat(e,",").concat(r,",0)")}function C6(t){t.style.transform&&t.style.transform!==""?t.style.transform="":t.style["-webkit-transform"]&&t.style["-webkit-transform"]!==""&&(t.style["-webkit-transform"]="")}function tw(t){var e=["INPUT","SELECT","TEXTAREA"];return t&&(e.indexOf(t.nodeName)>-1||t.contentEditable==="true")}function q8(t){return tw(t)&&t.hasAttribute("data-hot-input")===!1}function Xwe(t){var e=t.ownerDocument.activeElement;q8(e)||t.select()}function HK(t){return!t.parentNode}function Qwe(t,e){var r=new IntersectionObserver(function(n,i){n.forEach(function(o){o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body});r.observe(t)}var Zwe=l6,Jwe=yK;Zwe("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Jwe);var eSe=zr,tSe=Dp,rSe=TypeError,nSe=Object.getOwnPropertyDescriptor,iSe=eSe&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),oSe=iSe?function(t,e){if(tSe(t)&&!nSe(t,"length").writable)throw rSe("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},aSe=tt,sSe=wi,lSe=u1,uSe=Sl,cSe=ao,fSe=oSe,hSe=dK,dSe=w8,pSe=Lp,CE=cY,mSe=R1,gSe=mSe("splice"),ySe=Math.max,vSe=Math.min;aSe({target:"Array",proto:!0,forced:!gSe},{splice:function(e,r){var n=sSe(this),i=cSe(n),o=lSe(e,i),a=arguments.length,s,l,u,c,f,h;for(a===0?s=l=0:a===1?(s=0,l=i-o):(s=a-2,l=vSe(ySe(uSe(r),0),i-o)),hSe(i+s-l),u=dSe(n,l),c=0;c<l;c++)f=o+c,f in n&&pSe(u,c,n[f]);if(u.length=l,s<l){for(c=o;c<i-l;c++)f=c+l,h=c+s,f in n?n[h]=n[f]:CE(n,h);for(c=i;c>i-l+s;c--)CE(n,c-1)}else if(s>l)for(c=i-l;c>o;c--)f=c+l-1,h=c+s-1,f in n?n[h]=n[f]:CE(n,h);for(c=0;c<s;c++)n[c+o]=arguments[c+2];return fSe(n,i-l+s),u}});function Xt(){if(He(console)){var t;(t=console).warn.apply(t,arguments)}}function X8(){if(He(console)){var t;(t=console).error.apply(t,arguments)}}var bSe=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",wSe=TypeError,BK=function(t,e){if(t<e)throw wSe("Not enough arguments");return t},UK=nr,SSe=Ec,RSe=cr,ESe=bSe,CSe=gc,_Se=_1,TSe=BK,OSe=UK.Function,ASe=/MSIE .\./.test(CSe)||ESe&&function(){var t=UK.Bun.version.split(".");return t.length<3||t[0]==0&&(t[1]<3||t[1]==3&&t[2]==0)}(),Q8=function(t,e){var r=e?2:1;return ASe?function(n,i){var o=TSe(arguments.length,1)>r,a=RSe(n)?n:OSe(n),s=o?_Se(arguments,r):[],l=o?function(){SSe(a,this,s)}:a;return e?t(l,i):t(l)}:t},xSe=tt,VK=nr,ISe=Q8,pk=ISe(VK.setInterval,!0);xSe({global:!0,bind:!0,forced:VK.setInterval!==pk},{setInterval:pk});var MSe=tt,jK=nr,NSe=Q8,mk=NSe(jK.setTimeout,!0);MSe({global:!0,bind:!0,forced:jK.setTimeout!==mk},{setTimeout:mk});var PSe=tt,kSe=mt,$Se=Dp,LSe=kSe([].reverse),gk=[1,2];PSe({target:"Array",proto:!0,forced:String(gk)===String(gk.reverse())},{reverse:function(){return $Se(this)&&(this.length=this.length),LSe(this)}});function sr(t){return typeof t=="function"}function WK(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=this,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout(function(){n=t.apply(o,s)},e),n}return i}function zK(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return t.apply(this,r.concat(a))}}function DSe(t){var e=t.length;function r(n){return function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];var l=n.concat(a),u;return l.length>=e?u=t.apply(this,l):u=r(l),u}}return r([])}function bT(t,e,r,n,i,o,a,s){return He(s)?t.call(e,r,n,i,o,a,s):He(a)?t.call(e,r,n,i,o,a):He(o)?t.call(e,r,n,i,o):He(i)?t.call(e,r,n,i):He(n)?t.call(e,r,n):He(r)?t.call(e,r):t.call(e)}function $g(t){return $g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$g(t)}var yk;function FSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,BSe(n.key),n)}}function HSe(t,e,r){return e&&vk(t.prototype,e),r&&vk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function BSe(t){var e=USe(t,"string");return $g(e)==="symbol"?e:String(e)}function USe(t,e){if($g(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if($g(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VSe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var Bc=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],jSe=Gt(yk||(yk=VSe([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),_E=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),TE=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),GK=function(){function t(){FSe(this,t),this.globalBucket=this.createEmptyBucket()}return HSe(t,[{key:"createEmptyBucket",value:function(){var r=Object.create(null);return Q(Bc,function(n){return r[n]=[]}),r}},{key:"getBucket",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return r?(r.pluginHookBucket||(r.pluginHookBucket=this.createEmptyBucket()),r.pluginHookBucket):this.globalBucket}},{key:"add",value:function(r,n){var i=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))Q(n,function(l){return i.add(r,l,o)});else{_E.has(r)&&Xt(LK(jSe,{hookName:r,removedInVersion:_E.get(r)})),TE.has(r)&&Xt(TE.get(r));var a=this.getBucket(o);if(typeof a[r]>"u"&&(this.register(r),a[r]=[]),n.skip=!1,a[r].indexOf(n)===-1){var s=!1;n.initialHook&&Q(a[r],function(l,u){if(l.initialHook)return a[r][u]=n,s=!0,!1}),s||a[r].push(n)}}return this}},{key:"once",value:function(r,n){var i=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?Q(n,function(a){return i.once(r,a,o)}):(n.runOnce=!0,this.add(r,n,o))}},{key:"remove",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=this.getBucket(i);return typeof o[r]<"u"&&o[r].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=this.getBucket(n);return!!(i[r]!==void 0&&i[r].length)}},{key:"run",value:function(r,n,i,o,a,s,l,u){{var c=this.globalBucket[n],f=c?c.length:0,h=0;if(f)for(;h<f;){if(!c[h]||c[h].skip){h+=1;continue}var d=bT(c[h],r,i,o,a,s,l,u);d!==void 0&&(i=d),c[h]&&c[h].runOnce&&this.remove(n,c[h]),h+=1}}{var p=this.getBucket(r)[n],m=p?p.length:0,g=0;if(m)for(;g<m;){if(!p[g]||p[g].skip){g+=1;continue}var v=bT(p[g],r,i,o,a,s,l,u);v!==void 0&&(i=v),p[g]&&p[g].runOnce&&this.remove(n,p[g],r),g+=1}}return i}},{key:"destroy",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;St(this.getBucket(r),function(n,i,o){return o[i].length=0})}},{key:"register",value:function(r){this.isRegistered(r)||Bc.push(r)}},{key:"deregister",value:function(r){this.isRegistered(r)&&Bc.splice(Bc.indexOf(r),1)}},{key:"isDeprecated",value:function(r){return TE.has(r)||_E.has(r)}},{key:"isRegistered",value:function(r){return Bc.indexOf(r)>=0}},{key:"getRegistered",value:function(){return Bc}}],[{key:"getSingleton",value:function(){return zSe()}}]),t}(),WSe=new GK;function zSe(){return WSe}const Ue=GK;function bk(t){return qSe(t)||KSe(t)||YSe(t)||GSe()}function GSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YSe(t,e){if(!!t){if(typeof t=="string")return wT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wT(t,e)}}function KSe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function qSe(t){if(Array.isArray(t))return wT(t)}function wT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var OE=new Map;function lo(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";OE.has(t)||OE.set(t,new Map);var e=OE.get(t);function r(s,l){e.set(s,l)}function n(s){return e.get(s)}function i(s){return e.has(s)}function o(){return bk(e.keys())}function a(){return bk(e.values())}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:a}}var ST=new WeakMap,x1=lo("editors"),XSe=x1.register,YK=x1.getItem,KK=x1.hasItem;x1.getNames;x1.getValues;function QSe(t){var e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},Ue.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function qK(t,e){var r;if(typeof t=="function")ST.get(t)||Oi(null,t),r=ST.get(t);else if(typeof t=="string")r=YK(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(t,'"'));return r.getInstance(e)}function wk(t){if(typeof t=="function")return t;if(!KK(t))throw Error('No registered editor found under "'.concat(t,'" name'));return YK(t).getConstructor()}function Oi(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);var r=new QSe(e);typeof t=="string"&&XSe(t,r),ST.set(e,r)}function Lg(t){return Lg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lg(t)}function ZSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,e6e(n.key),n)}}function JSe(t,e,r){return e&&Sk(t.prototype,e),r&&Sk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function e6e(t){var e=t6e(t,"string");return Lg(e)==="symbol"?e:String(e)}function t6e(t,e){if(Lg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Lg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var r6e=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ZSe(this,t),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}return JSe(t,[{key:"addEventListener",value:function(r,n,i){var o=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(l){i.call(this,n6e(l))}return typeof a!="boolean"&&!swe()&&(a=!1),this.context.eventListeners.push({element:r,event:n,callback:i,callbackProxy:s,options:a,eventManager:this}),r.addEventListener(n,s,a),function(){o.removeEventListener(r,n,i)}}},{key:"removeEventListener",value:function(r,n,i){for(var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,s;a;)if(a-=1,s=this.context.eventListeners[a],s.event===n&&s.element===r){if(i&&i!==s.callback||o&&s.eventManager!==this)continue;this.context.eventListeners.splice(a,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}},{key:"clearEvents",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!!this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var i=this.context.eventListeners[n];r&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options))}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(r,n){var i=r.document,o=r;i||(i=r.ownerDocument?r.ownerDocument:r,o=i.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},s;i.createEvent?(s=i.createEvent("MouseEvents"),s.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,i.body.parentNode)):s=i.createEventObject(),r.dispatchEvent?r.dispatchEvent(s):r.fireEvent("on".concat(n),s)}}]),t}();function n6e(t){var e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),la(this)},t}const Er=r6e;function Dg(t){return Dg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dg(t)}function i6e(t,e){return l6e(t)||s6e(t,e)||a6e(t,e)||o6e()}function o6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a6e(t,e){if(!!t){if(typeof t=="string")return Rk(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Rk(t,e)}}function Rk(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s6e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function l6e(t){if(Array.isArray(t))return t}function u6e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ek(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f6e(n.key),n)}}function c6e(t,e,r){return e&&Ek(t.prototype,e),r&&Ek(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function f6e(t){var e=h6e(t,"string");return Dg(e)==="symbol"?e:String(e)}function h6e(t,e){if(Dg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Dg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _6="editorManager.navigation",Jm="editorManager.handlingEditor",RT=function(){function t(e,r,n){var i=this;u6e(this,t),this.instance=e,this.tableMeta=r,this.selection=n,this.eventManager=new Er(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var o=this.instance.getShortcutManager();o.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return i.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!i.destroyed&&i.instance.isListening()&&i.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,s,l){return i.onCellDblClick(a,s,l)})}return c6e(t,[{key:"registerShortcuts",value:function(){var r=this,n=this.instance.getShortcutManager(),i=n.getContext("grid"),o=n.getContext("editor"),a={group:Jm};o.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(l,u){r.closeEditorAndSaveChanges(n.isCtrlPressed()),r.moveSelectionAfterEnter(u.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){r.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),r.activeEditor.focus()}}],a),i.addShortcuts([{keys:[["F2"]],callback:function(l){r.openEditor(null,l,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){r.instance.emptySelectedCells(),r.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(l,u){r.instance.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,l,!0):r.moveSelectionAfterEnter(u.includes("shift")),la(l)}}],a)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(r){this.lock||this.closeEditor(r)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var r=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(m){m&&r.prepareEditor()});return}var n=this.instance.getSelectedRangeLast().highlight,i=n.row,o=n.col,a=this.instance.runHooks("modifyGetCellCoords",i,o),s=i,l=o;if(Array.isArray(a)){var u=i6e(a,2);s=u[0],l=u[1]}this.cellProperties=this.instance.getCellMeta(s,l);var c=this.instance.rootDocument.activeElement;if(c&&q8(c)&&c.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var f=this.instance.getCell(i,o,!0);if(f){var h=this.instance.getCellEditor(this.cellProperties),d=this.instance.colToProp(l),p=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(s),l);this.activeEditor=qK(h,this.instance),this.activeEditor.prepare(i,o,d,f,p,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var o=this.instance.getSelectedRangeLast().highlight,a=o.row,s=o.col,l=this.instance.rowIndexMapper.getRenderableFromVisualIndex(a),u=this.instance.columnIndexMapper.getRenderableFromVisualIndex(s);this.instance.view.scrollViewport(this.instance._createCellCoords(l,u)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(r,n))}},{key:"closeEditor",value:function(r,n,i){this.activeEditor?this.activeEditor.finishEditing(r,n,i):i&&i(!1)}},{key:"closeEditorAndSaveChanges",value:function(r){this.closeEditor(!1,r)}},{key:"closeEditorAndRestoreOriginalValue",value:function(r){this.closeEditor(!0,r)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var r=this.instance.getCellEditor(this.cellProperties),n=this.instance.getSelectedRangeLast().highlight,i=n.row,o=n.col,a=this.instance,s=a.rowIndexMapper,l=a.columnIndexMapper,u=s.isHidden(this.instance.toPhysicalRow(i))||l.isHidden(this.instance.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!r||u)}},{key:"moveSelectionAfterEnter",value:function(r){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;r?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(r){var n=this;if(!!this.instance.isListening()){var i=r.keyCode;if(!!this.selection.isSelected()){var o=(r.ctrlKey||r.metaKey)&&!r.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!_K(i)&&!S2e(i)&&!o&&!this.isEditorOpened()){var a=this.instance.getShortcutManager(),s=a.getContext("editor"),l={runOnlyIf:function(){return He(n.instance.getSelected())},group:_6};s.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.instance.selection.transformStart(0,-1*n.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.instance.selection.transformStart(0,n.instance.getDirectionFactor())}}],l),this.openEditor("",r)}}}}},{key:"onCellDblClick",value:function(r,n,i){i.nodeName==="TD"&&this.openEditor(null,r,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),t}(),Ck=new WeakMap;RT.getInstance=function(t,e,r){var n=Ck.get(t);return n||(n=new RT(t,e,r),Ck.set(t,n)),n};const d6e=RT;var p6e="hooksRefRegisterer",XK={_hooksStorage:Object.create(null),addHook:function(e,r){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,r),this._hooksStorage[e].push(r),this},removeHooksByKey:function(e){var r=this;Q(this._hooksStorage[e]||[],function(n){r.hot.removeHook(e,n)})},clearHooks:function(){var e=this;St(this._hooksStorage,function(r,n){return e.removeHooksByKey(n)}),this._hooksStorage={}}};Os(XK,"MIXIN_NAME",p6e,{writable:!1,enumerable:!1});const m6e=XK;function mh(t){return mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mh(t)}function g6e(t,e){return w6e(t)||b6e(t,e)||v6e(t,e)||y6e()}function y6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v6e(t,e){if(!!t){if(typeof t=="string")return _k(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _k(t,e)}}function _k(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function b6e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function w6e(t){if(Array.isArray(t))return t}function S6e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ET(t,e)}function ET(t,e){return ET=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ET(t,e)}function R6e(t){var e=_6e();return function(){var n=rw(t),i;if(e){var o=rw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return E6e(this,i)}}function E6e(t,e){if(e&&(mh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return C6e(t)}function C6e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rw(t){return rw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rw(t)}function Tk(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ok(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,T6e(n.key),n)}}function Ak(t,e,r){return e&&Ok(t.prototype,e),r&&Ok(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function T6e(t){var e=O6e(t,"string");return mh(e)==="symbol"?e:String(e)}function O6e(t,e){if(mh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var A6e="base",fn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),CT="baseEditor",Bp=function(){function t(e){Tk(this,t),this.hot=e,this.instance=e,this.state=fn.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return Ak(t,[{key:"_fireCallbacks",value:function(r){this._closeCallback&&(this._closeCallback(r),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(r,n,i,o,a,s){this.TD=o,this.row=r,this.col=n,this.prop=i,this.originalValue=a,this.cellProperties=s,this.state=fn.VIRGIN}},{key:"extend",value:function(){return function(r){S6e(i,r);var n=R6e(i);function i(){return Tk(this,i),n.apply(this,arguments)}return Ak(i)}(this.constructor)}},{key:"saveValue",value:function(r,n){var i=this,o,a,s,l;if(n){var u=this.hot.getSelectedLast();o=Math.max(Math.min(u[0],u[2]),0),a=Math.max(Math.min(u[1],u[3]),0),s=Math.max(u[0],u[2]),l=Math.max(u[1],u[3])}else{var c=[this.row,this.col,null,null];o=c[0],a=c[1],s=c[2],l=c[3]}var f=this.hot.runHooks("modifyGetCellCoords",o,a);if(Array.isArray(f)){var h=g6e(f,2);o=h[0],a=h[1]}var d=this.hot.getShortcutManager(),p=d.getContext("editor"),m={runOnlyIf:function(){return He(i.hot.getSelected())},group:CT};this.isInFullEditMode()&&p.addShortcuts([{keys:[["ArrowUp"]],callback:function(){i.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){i.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){i.hot.selection.transformStart(0,-1*i.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){i.hot.selection.transformStart(0,i.hot.getDirectionFactor())}}],m),this.hot.populateFromArray(o,a,r,s,l,"edit")}},{key:"beginEditing",value:function(r,n){if(this.state===fn.VIRGIN){var i=this.hot,o=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(o,a)),this.state=fn.EDITING,this.isInFullEditMode()){var s=typeof r=="string"?r:Vr(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(r,n,i){var o=this,a;if(i){var s=this._closeCallback;this._closeCallback=function(f){s&&s(f),i(f),o.hot.view.render()}}if(!this.isWaiting()){var l=this.hot.getShortcutManager(),u=l.getContext("editor");if(u.removeShortcutsByGroup(CT),u.removeShortcutsByGroup(_6),this.state===fn.VIRGIN){this.hot._registerTimeout(function(){o._fireCallbacks(!0)});return}if(this.state===fn.EDITING){if(r){this.cancelChanges(),this.hot.view.render();return}var c=this.getValue();this.cellProperties.trimWhitespace?a=[[typeof c=="string"?String.prototype.trim.call(c||""):c]]:a=[[c]],this.state=fn.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(f){o.state=fn.FINISHED,o.discardEditor(f)}):(this.state=fn.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=fn.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(r){if(this.state===fn.FINISHED)if(r===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=fn.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=fn.VIRGIN,this._fireCallbacks(!0);var n=this.hot.getShortcutManager();n.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===fn.WAITING}},{key:"getEditedCellRect",value:function(){var r,n=this.getEditedCell();if(!!n){var i=this.hot.view._wt,o=i.wtOverlays,a=i.wtViewport,s=this.hot.rootWindow,l=Zr(n),u=Qt(n),c=Zr(this.hot.rootElement),f=Qt(this.hot.rootElement),h=o.topOverlay.holder,d=o.inlineStartOverlay.holder,p=h!==s?h.scrollTop:0,m=d!==s?d.scrollLeft:0,g=s.innerWidth-c.left-f,v=(r=o.getParentOverlay(n))!==null&&r!==void 0?r:this.hot.view._wt,S=v.wtTable,b=S.name,E=["master","inline_start"].includes(b)?p:0,T=["master","top","bottom"].includes(b)?m:0,N=l.top===c.top?0:1,L=l.top-c.top-N-E,V=0;this.hot.isRtl()?V=s.innerWidth-l.left-u-g-1+T:V=l.left-c.left-1-T,["top","top_inline_start_corner"].includes(b)&&(L+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(V+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));var B=this.hot.hasColHeaders(),k=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),M=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),G=this.hot.rowIndexMapper.getRenderableIndexesLength(),j=G-this.hot.view._wt.getSetting("fixedRowsBottom");(B&&k<=0||k===j)&&(L+=1),M<=0&&(V+=1);var q=a.rowsRenderCalculator.startPosition,te=a.columnsRenderCalculator.startPosition,pe=Math.abs(o.inlineStartOverlay.getScrollPosition()),ne=o.topOverlay.getScrollPosition(),O=yn(this.hot.rootDocument),y=n.offsetTop+q-ne,R=0;if(this.hot.isRtl()){var C=n.offsetLeft;C>=0?R=S.getWidth()-n.offsetLeft:R=Math.abs(C),R+=te-pe-u}else R=n.offsetLeft+te-pe;var A=Yu(this.TD,this.hot.rootWindow),P=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",H=parseInt(A[P],10)>0?0:1,Y=parseInt(A.borderTopWidth,10)>0?0:1,z=Qt(n)+H,oe=wr(n)+Y,me=Kwe(h)?O:0,re=qwe(d)?O:0,ge=this.hot.view.maximumVisibleElementWidth(R)-me+H,ve=Math.max(this.hot.view.maximumVisibleElementHeight(y)-re+Y,23);return{top:L,start:V,height:oe,maxHeight:ve,width:z,maxWidth:ge}}}},{key:"getEditedCellsLayerClass",value:function(){var r=this.checkEditorSection();switch(r){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var r=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=r-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}],[{key:"EDITOR_TYPE",get:function(){return A6e}}]),t}();ir(Bp,m6e);var x6e=tt,I6e=Rc.map,M6e=R1,N6e=M6e("map");x6e({target:"Array",proto:!0,forced:!N6e},{map:function(e){return I6e(this,e,arguments.length>1?arguments[1]:void 0)}});function P6e(t){return D6e(t)||L6e(t)||$6e(t)||k6e()}function k6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $6e(t,e){if(!!t){if(typeof t=="string")return _T(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _T(t,e)}}function L6e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function D6e(t){if(Array.isArray(t))return _T(t)}function _T(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function TT(t){return TT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},TT(t)}function zi(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=TT(t);if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);var n=Array.from(new Set(["."].concat(P6e(e)))).map(function(i){return"\\".concat(i)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function F6e(t){return zi(t,[","])}function Ye(t,e,r){var n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function OT(t,e,r){var n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function QK(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function H6e(){var t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},e,r=document.body,n=document.createTextNode(""),i=document.createElement("SPAN"),o=function(d,p,m){d.addEventListener(p,m,!1)},a=function(d,p,m){d.removeEventListener(p,m,!1)},s=function(d){var p,m;d?/^[a-zA-Z \.,\\\/\|0-9]$/.test(d)||(d="."):d="",n.textContent!==void 0?n.textContent=e.value+d:n.data=e.value+d,i.style.position="absolute",i.style.fontSize=f(e).fontSize,i.style.fontFamily=f(e).fontFamily,i.style.whiteSpace="pre",r.appendChild(i),p=i.clientWidth+2,r.removeChild(i),e.style.height=t.minHeight+"px",t.minWidth>p?e.style.width=t.minWidth+"px":p>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=p+"px",m=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>m?e.style.height=t.minHeight+"px":t.maxHeight<m?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=m+"px"},l=function(){window.setTimeout(s,0)},u=function(d){if(d&&d.minHeight)if(d.minHeight=="inherit")t.minHeight=e.clientHeight;else{var p=parseInt(d.minHeight);isNaN(p)||(t.minHeight=p)}if(d&&d.maxHeight)if(d.maxHeight=="inherit")t.maxHeight=e.clientHeight;else{var m=parseInt(d.maxHeight);isNaN(m)||(t.maxHeight=m)}if(d&&d.minWidth)if(d.minWidth=="inherit")t.minWidth=e.clientWidth;else{var g=parseInt(d.minWidth);isNaN(g)||(t.minWidth=g)}if(d&&d.maxWidth)if(d.maxWidth=="inherit")t.maxWidth=e.clientWidth;else{var v=parseInt(d.maxWidth);isNaN(v)||(t.maxWidth=v)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))},c=function(d,p,m){e=d,u(p),e.nodeName=="TEXTAREA"&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),m&&(o(e,"change",s),o(e,"cut",l),o(e,"paste",l),o(e,"drop",l),o(e,"keydown",l),o(e,"focus",s),o(e,"compositionstart",l),o(e,"compositionupdate",l),o(e,"compositionend",l)),s()};function f(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(d,p,m){c(d,p,m)},unObserve:function(){a(e,"change",s),a(e,"cut",l),a(e,"paste",l),a(e,"drop",l),a(e,"keydown",l),a(e,"focus",s),a(e,"compositionstart",l),a(e,"compositionupdate",l),a(e,"compositionend",l)},resize:s}}function xk(t,e){for(var r=FK(e),n=e.value.split(`
`),i=r,o=0,a=0;a<n.length;a++){var s=n[a];a!==0&&(o+=n[a-1].length+1);var l=o+s.length;if(t==="home"?i=o:t==="end"&&(i=l),r<=l)break}E6(e,i)}function gh(t){return gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gh(t)}function Ik(t,e){return j6e(t)||V6e(t,e)||U6e(t,e)||B6e()}function B6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function U6e(t,e){if(!!t){if(typeof t=="string")return Mk(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Mk(t,e)}}function Mk(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function V6e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function j6e(t){if(Array.isArray(t))return t}function W6e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,G6e(n.key),n)}}function z6e(t,e,r){return e&&Nk(t.prototype,e),r&&Nk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function G6e(t){var e=Y6e(t,"string");return gh(e)==="symbol"?e:String(e)}function Y6e(t,e){if(gh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eg(){return typeof Reflect<"u"&&Reflect.get?eg=Reflect.get.bind():eg=function(e,r,n){var i=K6e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},eg.apply(this,arguments)}function K6e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ku(t),t!==null););return t}function q6e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&AT(t,e)}function AT(t,e){return AT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},AT(t,e)}function X6e(t){var e=Z6e();return function(){var n=Ku(t),i;if(e){var o=Ku(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Q6e(this,i)}}function Q6e(t,e){if(e&&(gh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZK(t)}function ZK(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Z6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ku(t){return Ku=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ku(t)}var J6e="ht_editor_visible",O0="ht_editor_hidden",Pk="textEditor",eRe="text",Cc=function(t){q6e(r,t);var e=X6e(r);function r(n){var i;return W6e(this,r),i=e.call(this,n),i.eventManager=new Er(ZK(i)),i.autoResize=H6e(),i.TEXTAREA=void 0,i.textareaStyle=void 0,i.TEXTAREA_PARENT=void 0,i.textareaParentStyle=void 0,i.layerClass=void 0,i.createElements(),i.bindEvents(),i.hot.addHookOnce("afterDestroy",function(){return i.destroy()}),i}return z6e(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(i){this.TEXTAREA.value=i}},{key:"open",value:function(){var i=this;this.refreshDimensions(),this.showEditableElement();var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(a){return i.onAfterDocumentKeyDown(a)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(i,o,a,s,l,u){var c=this.state;if(eg(Ku(r.prototype),"prepare",this).call(this,i,o,a,s,l,u),!u.readOnly){this.refreshDimensions(!0);var f=u.allowInvalid,h=u.fragmentSelection;f&&(this.TEXTAREA.value=""),c!==fn.FINISHED&&this.hideEditableElement();var d=!h;d&&!na()&&this.focus()}}},{key:"beginEditing",value:function(i,o){this.state===fn.VIRGIN&&(this.TEXTAREA.value="",eg(Ku(r.prototype),"beginEditing",this).call(this,i,o))}},{key:"focus",value:function(){this.TEXTAREA.select(),E6(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var i=this.hot.rootDocument;this.TEXTAREA=i.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Re(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=i.createElement("DIV"),Re(this.TEXTAREA_PARENT,"handsontableInputHolder"),at(this.TEXTAREA_PARENT,this.layerClass)&&ut(this.TEXTAREA_PARENT,this.layerClass),Re(this.TEXTAREA_PARENT,O0),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(y2e()||g2e())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ut(this.TEXTAREA_PARENT,this.layerClass),Re(this.TEXTAREA_PARENT,O0)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var i=this.TEXTAREA_PARENT.childNodes,o=!1;Ye(i.length-1,function(a){var s=i[a];if(at(s,"handsontableEditor"))return o=!0,!1}),at(this.TEXTAREA_PARENT,O0)&&ut(this.TEXTAREA_PARENT,O0),o?(this.layerClass=J6e,Re(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Re(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var i=this.hot.toPhysicalRow(this.row),o=this.hot.getSourceDataAtCell(i,this.col);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==fn.EDITING&&!i)){if(this.TD=this.getEditedCell(),!this.TD){i||this.close();return}var o=this.getEditedCellRect(),a=o.top,s=o.start,l=o.width,u=o.maxWidth,c=o.height,f=o.maxHeight;this.textareaParentStyle.top="".concat(a,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(s,"px"),this.showEditableElement();var h=Yu(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var d=Yu(this.TEXTAREA),p=parseInt(d.paddingLeft,10)+parseInt(d.paddingRight,10),m=parseInt(d.paddingTop,10)+parseInt(d.paddingBottom,10),g=l-p,v=c-m,S=u-p,b=f-m;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(g,S),minHeight:Math.min(v,b),maxWidth:S,maxHeight:b},!0)}}},{key:"bindEvents",value:function(){var i=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(o){return o.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(o){return o.stopPropagation()}),EK()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return i.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){i.refreshDimensions(),i.focus()}),this.addHook("afterRowResize",function(){i.refreshDimensions(),i.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),a=o.getContext("editor"),s={runOnlyIf:function(){return He(i.hot.getSelected())},group:Pk},l=function(){i.hot.rootDocument.execCommand("insertText",!1,`
`)};a.addShortcuts([{keys:[["Tab"]],callback:function(c){var f=i.hot.getSettings(),h=typeof f.tabMoves=="function"?f.tabMoves(c):f.tabMoves;i.hot.selection.transformStart(h.row,h.col,!0)}},{keys:[["Shift","Tab"]],callback:function(c){var f=i.hot.getSettings(),h=typeof f.tabMoves=="function"?f.tabMoves(c):f.tabMoves;i.hot.selection.transformStart(-h.row,-h.col)}},{keys:[["Control","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(c){return!i.hot.selection.isMultiple()&&!c.altKey},relativeToGroup:Jm,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return l(),!1},runOnlyIf:function(){return!i.hot.selection.isMultiple()},relativeToGroup:Jm,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return l(),!1},relativeToGroup:Jm,position:"before"},{keys:[["PageUp"]],callback:function(){i.hot.selection.transformStart(-i.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){i.hot.selection.transformStart(i.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(c,f){var h=Ik(f,1),d=h[0];xk(d,i.TEXTAREA)}},{keys:[["End"]],callback:function(c,f){var h=Ik(f,1),d=h[0];xk(d,i.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){i.hot._registerTimeout(function(){i.autoResize.resize()},10)}}],s)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup(_6),o.removeShortcutsByGroup(Pk),o.removeShortcutsByGroup(CT)}},{key:"onAfterDocumentKeyDown",value:function(i){var o=[Ge.ARROW_UP,Ge.ARROW_RIGHT,Ge.ARROW_DOWN,Ge.ARROW_LEFT];o.indexOf(i.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(i.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return eRe}}]),r}(Bp);function yh(t){return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yh(t)}function tRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nRe(n.key),n)}}function rRe(t,e,r){return e&&kk(t.prototype,e),r&&kk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function nRe(t){var e=iRe(t,"string");return yh(e)==="symbol"?e:String(e)}function iRe(t,e){if(yh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yo(){return typeof Reflect<"u"&&Reflect.get?yo=Reflect.get.bind():yo=function(e,r,n){var i=oRe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},yo.apply(this,arguments)}function oRe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=xi(t),t!==null););return t}function aRe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xT(t,e)}function xT(t,e){return xT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},xT(t,e)}function sRe(t){var e=cRe();return function(){var n=xi(t),i;if(e){var o=xi(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return lRe(this,i)}}function lRe(t,e){if(e&&(yh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uRe(t)}function uRe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xi(t){return xi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xi(t)}var $k="handsontableEditor",fRe="handsontable",Z8=function(t){aRe(r,t);var e=sRe(r);function r(){return tRe(this,r),e.apply(this,arguments)}return rRe(r,[{key:"open",value:function(){yo(xi(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),E6(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),yo(xi(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(i,o,a,s,l,u){yo(xi(r.prototype),"prepare",this).call(this,i,o,a,s,l,u);var c=this,f={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(d,p){var m=this.getSourceData(p.row,p.col);m!==void 0&&c.setValue(m),c.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Jr(f,u.handsontable),this.htOptions=f}},{key:"beginEditing",value:function(i,o){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||yo(xi(r.prototype),"beginEditing",this).call(this,i,o)}},{key:"createElements",value:function(){yo(xi(r.prototype),"createElements",this).call(this);var i=this.hot.rootDocument.createElement("DIV");i.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(i),this.htContainer=i,this.assignHooks()}},{key:"finishEditing",value:function(i,o,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var s=this.htEditor.getInstance().getValue();s!==void 0&&this.setValue(s)}yo(xi(r.prototype),"finishEditing",this).call(this,i,o,a)}},{key:"assignHooks",value:function(){var i=this;this.hot.addHook("afterDestroy",function(){i.htEditor&&i.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),a=o.getContext("editor");yo(xi(r.prototype),"registerShortcuts",this).call(this);var s={group:$k,relativeToGroup:_6,position:"before"},l=function(c,f){var h=i.htEditor.getInstance();if(c!==void 0&&(c<0||h.flipped&&c>h.countRows()-1?h.deselectCell():h.selectCell(c,0),h.getData().length))return f.preventDefault(),la(f),i.hot.listen(),i.TEXTAREA.focus(),!1};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(c){var f=i.htEditor.getInstance(),h,d;return!f.getSelectedLast()&&f.flipped?h=f.countRows()-1:f.getSelectedLast()&&(f.flipped?(d=f.getSelectedLast()[0],h=Math.max(0,d-1)):(d=f.getSelectedLast()[0],h=d-1)),l(h,c)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(c){var f=i.htEditor.getInstance(),h,d;if(!f.getSelectedLast()&&!f.flipped)h=0;else if(f.getSelectedLast()){if(f.flipped)h=f.getSelectedLast()[0]+1;else if(!f.flipped){var p=f.countRows()-1;d=f.getSelectedLast()[0],h=Math.min(p,d+1)}}return l(h,c)},preventDefault:!1}],s)}},{key:"unregisterShortcuts",value:function(){yo(xi(r.prototype),"unregisterShortcuts",this).call(this);var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup($k)}}],[{key:"EDITOR_TYPE",get:function(){return fRe}}]),r}(Cc),hRe="base";function I1(t,e,r,n,i,o,a){var s=[],l=[];a.className&&Re(e,a.className),a.readOnly&&s.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?s.push(a.invalidCellClassName):l.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&s.push(a.noWordWrapClassName),!o&&a.placeholder&&s.push(a.placeholderCellClassName),ut(e,l),Re(e,s)}I1.RENDERER_TYPE=hRe;var dRe="text";function El(t,e,r,n,i,o,a){I1.apply(this,[t,e,r,n,i,o,a]);var s=o;if(!s&&a.placeholder&&(s=a.placeholder),s=Vr(s),a.trimWhitespace&&(s=s.trim()),a.rendererTemplate){ua(e);var l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(r),e.appendChild(l)}else Gu(e,s)}El.RENDERER_TYPE=dRe;function vh(t){return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vh(t)}function pRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,JK(n.key),n)}}function mRe(t,e,r){return e&&Lk(t.prototype,e),r&&Lk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function iu(){return typeof Reflect<"u"&&Reflect.get?iu=Reflect.get.bind():iu=function(e,r,n){var i=gRe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},iu.apply(this,arguments)}function gRe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Va(t),t!==null););return t}function yRe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&IT(t,e)}function IT(t,e){return IT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},IT(t,e)}function vRe(t){var e=wRe();return function(){var n=Va(t),i;if(e){var o=Va(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return bRe(this,i)}}function bRe(t,e){if(e&&(vh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MT(t)}function MT(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Va(t){return Va=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Va(t)}function SRe(t,e,r){return e=JK(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JK(t){var e=RRe(t,"string");return vh(e)==="symbol"?e:String(e)}function RRe(t,e){if(vh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var AE=new WeakMap,ERe="autocomplete",J8=function(t){yRe(r,t);var e=vRe(r);function r(n){var i;return pRe(this,r),i=e.call(this,n),SRe(MT(i),"sortByRelevance",function(o,a,s){var l=[],u=[],c=o.length,f=a.length,h,d,p,m;if(c===0){for(p=0;p<f;p++)u.push(p);return u}for(p=0;p<f;p++){if(d=ck(Vr(a[p])),s)m=d.indexOf(o);else{var g=this.cellProperties.locale;m=d.toLocaleLowerCase(g).indexOf(o.toLocaleLowerCase(g))}m!==-1&&(h=d.length-m-c,l.push({baseIndex:p,index:m,charsLeft:h,value:d}))}for(l.sort(function(v,S){if(S.index===-1)return-1;if(v.index===-1)return 1;if(v.index<S.index)return-1;if(S.index<v.index)return 1;if(v.index===S.index){if(v.charsLeft<S.charsLeft)return-1;if(v.charsLeft>S.charsLeft)return 1}return 0}),p=0,f=l.length;p<f;p++)u.push(l[p].baseIndex);return u}),i.query=null,i.strippedChoices=[],i.rawChoices=[],AE.set(MT(i),{skipOne:!1,isMacOS:i.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),i}return mRe(r,[{key:"getValue",value:function(){var i=this,o=this.rawChoices.find(function(a){var s=i.stripValueIfNeeded(a);return s===i.TEXTAREA.value});return He(o)?o:this.TEXTAREA.value}},{key:"createElements",value:function(){iu(Va(r.prototype),"createElements",this).call(this),Re(this.htContainer,"autocompleteEditor"),Re(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var i=this,o=AE.get(this);iu(Va(r.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),s=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var l=yn();l===0&&o.isMacOS&&(l+=15),this.addHook("beforeKeyDown",function(u){return i.onBeforeKeyDown(u)}),a.updateSettings({colWidths:s?[Qt(this.TEXTAREA)-2]:void 0,width:s?Qt(this.TEXTAREA)+l:void 0,renderer:function(c,f,h,d,p,m,g){El(c,f,h,d,p,m,g);var v=i.cellProperties,S=v.filteringCaseSensitive,b=v.allowHtml,E=v.locale,T=i.query,N=Vr(m),L,V;N&&!b&&(L=S===!0?N.indexOf(T):N.toLocaleLowerCase(E).indexOf(T.toLocaleLowerCase(E)),L!==-1&&(V=N.substr(L,T.length),N=N.replace(V,"<strong>".concat(V,"</strong>")))),f.innerHTML=N},autoColumnSize:!0}),o.skipOne&&(o.skipOne=!1),this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),iu(Va(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(i){iu(Va(r.prototype),"discardEditor",this).call(this,i),this.hot.view.render()}},{key:"queryChoices",value:function(i){var o=this,a=this.cellProperties.source;this.query=i,typeof a=="function"?a.call(this.cellProperties,i,function(s){o.rawChoices=s,o.updateChoicesList(o.stripValuesIfNeeded(s))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(i){var o=FK(this.TEXTAREA),a=zwe(this.TEXTAREA),s=this.cellProperties.sortByRelevance,l=this.cellProperties.filter,u=null,c=null,f=i;s&&(u=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),f,this.cellProperties.filteringCaseSensitive));var h=Array.isArray(u)?u.length:0;if(l===!1)h&&(c=u[0]);else{for(var d=[],p=0,m=f.length;p<m&&!(s&&h<=p);p++)h?d.push(f[u[p]]):d.push(f[p]);c=0,f=d}this.strippedChoices=f,this.htEditor.loadData(zb([f])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(c),this.hot.listen(),E6(this.TEXTAREA,o,o===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var i=Pg(this.hot.view._wt.wtTable.TABLE),o=i===this.hot.rootWindow,a=this.cellProperties.preventOverflow;if(o||!o&&(a||a==="horizontal"))return!1;var s=Zr(this.TEXTAREA),l=wr(this.TEXTAREA),u=this.getDropdownHeight(),c=i.scrollTop,f=wr(this.hot.view._wt.wtTable.THEAD),h=Zr(i),d=s.top-h.top-f+c,p=i.scrollHeight-d-f-l,m=u>p&&d>p;return m?this.flipDropdown(u):this.unflipDropdown(),this.limitDropdownIfNeeded(m?d:p,u),m}},{key:"limitDropdownIfNeeded",value:function(i,o){if(o>i){var a=0,s=0,l=0,u=null;do l=this.htEditor.getRowHeight(s)||this.htEditor.view._wt.getSetting("defaultRowHeight"),a+=l,s+=1;while(a<i);u=a-l,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+o-u,"px")),this.setDropdownHeight(a-l)}}},{key:"flipDropdown",value:function(i){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="".concat(-i,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var i=this.htEditor.rootElement.style;i.position="absolute",i.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var i=this.htEditor.getColWidth(0)+yn(this.hot.rootDocument)+2,o=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:o?void 0:i}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(i){this.htEditor.updateSettings({height:i})}},{key:"highlightBestMatchingChoice",value:function(i){typeof i=="number"?this.htEditor.selectCell(i,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var i=this.htEditor.getInstance().getRowHeight(0)||23,o=this.cellProperties.visibleRows;return this.strippedChoices.length>=o?o*i:this.strippedChoices.length*i+8}},{key:"stripValueIfNeeded",value:function(i){return this.stripValuesIfNeeded([i])[0]}},{key:"stripValuesIfNeeded",value:function(i){var o=this.cellProperties.allowHtml,a=bt(i,function(l){return Vr(l)}),s=bt(a,function(l){return o?l:ck(l)});return s}},{key:"allowKeyEventPropagation",value:function(i){var o=this.htEditor.getSelectedRangeLast(),a={row:o?o.from.row:-1},s=!1;return i===Ge.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(s=!0),i===Ge.ARROW_UP&&a.row>-1&&(s=!0),s}},{key:"onBeforeKeyDown",value:function(i){var o=this,a=AE.get(this);if(a.skipOne=!1,w2e(i.keyCode)||i.keyCode===Ge.BACKSPACE||i.keyCode===Ge.DELETE||i.keyCode===Ge.INSERT){var s=10;if(i.keyCode===Ge.C&&(i.ctrlKey||i.metaKey))return;this.isOpened()||(s+=10),this.htEditor&&this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value),a.skipOne=!0},s)}}}],[{key:"EDITOR_TYPE",get:function(){return ERe}}]),r}(Z8);function bh(t){return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bh(t)}function CRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,TRe(n.key),n)}}function _Re(t,e,r){return e&&Dk(t.prototype,e),r&&Dk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function TRe(t){var e=ORe(t,"string");return bh(e)==="symbol"?e:String(e)}function ORe(t,e){if(bh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ARe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&NT(t,e)}function NT(t,e){return NT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},NT(t,e)}function xRe(t){var e=NRe();return function(){var n=nw(t),i;if(e){var o=nw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return IRe(this,i)}}function IRe(t,e){if(e&&(bh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MRe(t)}function MRe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function NRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nw(t){return nw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nw(t)}var PRe="checkbox",eq=function(t){ARe(r,t);var e=xRe(r);function r(){return CRe(this,r),e.apply(this,arguments)}return _Re(r,[{key:"beginEditing",value:function(i,o){if(o&&o.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');at(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return PRe}}]),r}(Bp),tq={exports:{}};const kRe=Mz(uae);/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,e){(function(r,n){var i;{try{i=kRe}catch{}t.exports=n(i)}})(ch,function(r){var n=typeof r=="function",i=!!window.addEventListener,o=window.document,a=window.setTimeout,s=function(O,y,R,C){i?O.addEventListener(y,R,!!C):O.attachEvent("on"+y,R)},l=function(O,y,R,C){i?O.removeEventListener(y,R,!!C):O.detachEvent("on"+y,R)},u=function(O){return O.trim?O.trim():O.replace(/^\s+|\s+$/g,"")},c=function(O,y){return(" "+O.className+" ").indexOf(" "+y+" ")!==-1},f=function(O,y){c(O,y)||(O.className=O.className===""?y:O.className+" "+y)},h=function(O,y){O.className=u((" "+O.className+" ").replace(" "+y+" "," "))},d=function(O){return/Array/.test(Object.prototype.toString.call(O))},p=function(O){return/Date/.test(Object.prototype.toString.call(O))&&!isNaN(O.getTime())},m=function(O){var y=O.getDay();return y===0||y===6},g=function(O){return O%4===0&&O%100!==0||O%400===0},v=function(O,y){return[31,g(O)?29:28,31,30,31,30,31,31,30,31,30,31][y]},S=function(O){p(O)&&O.setHours(0,0,0,0)},b=function(O,y){return O.getTime()===y.getTime()},E=function(O,y,R){var C,A;for(C in y)A=O[C]!==void 0,A&&typeof y[C]=="object"&&y[C]!==null&&y[C].nodeName===void 0?p(y[C])?R&&(O[C]=new Date(y[C].getTime())):d(y[C])?R&&(O[C]=y[C].slice(0)):O[C]=E({},y[C],R):(R||!A)&&(O[C]=y[C]);return O},T=function(O,y,R){var C;o.createEvent?(C=o.createEvent("HTMLEvents"),C.initEvent(y,!0,!1),C=E(C,R),O.dispatchEvent(C)):o.createEventObject&&(C=o.createEventObject(),C=E(C,R),O.fireEvent("on"+y,C))},N=function(O){return O.month<0&&(O.year-=Math.ceil(Math.abs(O.month)/12),O.month+=12),O.month>11&&(O.year+=Math.floor(Math.abs(O.month)/12),O.month-=12),O},L={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},V=function(O,y,R){for(y+=O.firstDay;y>=7;)y-=7;return R?O.i18n.weekdaysShort[y]:O.i18n.weekdays[y]},B=function(O){var y=[],R="false";if(O.isEmpty)if(O.showDaysInNextAndPreviousMonths)y.push("is-outside-current-month"),O.enableSelectionDaysInNextAndPreviousMonths||y.push("is-selection-disabled");else return'<td class="is-empty"></td>';return O.isDisabled&&y.push("is-disabled"),O.isToday&&y.push("is-today"),O.isSelected&&(y.push("is-selected"),R="true"),O.hasEvent&&y.push("has-event"),O.isInRange&&y.push("is-inrange"),O.isStartRange&&y.push("is-startrange"),O.isEndRange&&y.push("is-endrange"),'<td data-day="'+O.day+'" class="'+y.join(" ")+'" aria-selected="'+R+'"><button class="pika-button pika-day" type="button" data-pika-year="'+O.year+'" data-pika-month="'+O.month+'" data-pika-day="'+O.day+'">'+O.day+"</button></td>"},k=function(O,y){O.setHours(0,0,0,0);var R=O.getDate(),C=O.getDay(),A=y,P=A-1,H=7,Y=function(ge){return(ge+H-1)%H};O.setDate(R+P-Y(C));var z=new Date(O.getFullYear(),0,A),oe=24*60*60*1e3,me=(O.getTime()-z.getTime())/oe,re=1+Math.round((me-P+Y(z.getDay()))/H);return re},M=function(O,y,R,C){var A=new Date(R,y,O),P=n?r(A).isoWeek():k(A,C);return'<td class="pika-week">'+P+"</td>"},G=function(O,y,R,C){return'<tr class="pika-row'+(R?" pick-whole-week":"")+(C?" is-selected":"")+'">'+(y?O.reverse():O).join("")+"</tr>"},j=function(O){return"<tbody>"+O.join("")+"</tbody>"},q=function(O){var y,R=[];for(O.showWeekNumber&&R.push("<th></th>"),y=0;y<7;y++)R.push('<th scope="col"><abbr title="'+V(O,y)+'">'+V(O,y,!0)+"</abbr></th>");return"<thead><tr>"+(O.isRTL?R.reverse():R).join("")+"</tr></thead>"},te=function(O,y,R,C,A,P){var H,Y,z,oe=O._o,me=R===oe.minYear,re=R===oe.maxYear,ge='<div id="'+P+'" class="pika-title" role="heading" aria-live="assertive">',ve,ie,be=!0,ce=!0;for(z=[],H=0;H<12;H++)z.push('<option value="'+(R===A?H-y:12+H-y)+'"'+(H===C?' selected="selected"':"")+(me&&H<oe.minMonth||re&&H>oe.maxMonth?' disabled="disabled"':"")+">"+oe.i18n.months[H]+"</option>");for(ve='<div class="pika-label">'+oe.i18n.months[C]+'<select class="pika-select pika-select-month" tabindex="-1">'+z.join("")+"</select></div>",d(oe.yearRange)?(H=oe.yearRange[0],Y=oe.yearRange[1]+1):(H=R-oe.yearRange,Y=1+R+oe.yearRange),z=[];H<Y&&H<=oe.maxYear;H++)H>=oe.minYear&&z.push('<option value="'+H+'"'+(H===R?' selected="selected"':"")+">"+H+"</option>");return ie='<div class="pika-label">'+R+oe.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+z.join("")+"</select></div>",oe.showMonthAfterYear?ge+=ie+ve:ge+=ve+ie,me&&(C===0||oe.minMonth>=C)&&(be=!1),re&&(C===11||oe.maxMonth<=C)&&(ce=!1),y===0&&(ge+='<button class="pika-prev'+(be?"":" is-disabled")+'" type="button">'+oe.i18n.previousMonth+"</button>"),y===O._o.numberOfMonths-1&&(ge+='<button class="pika-next'+(ce?"":" is-disabled")+'" type="button">'+oe.i18n.nextMonth+"</button>"),ge+="</div>"},pe=function(O,y,R){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+R+'">'+q(O)+j(y)+"</table>"},ne=function(O){var y=this,R=y.config(O);y._onMouseDown=function(A){if(!!y._v){A=A||window.event;var P=A.target||A.srcElement;if(!!P)if(c(P,"is-disabled")||(c(P,"pika-button")&&!c(P,"is-empty")&&!c(P.parentNode,"is-disabled")?(y.setDate(new Date(P.getAttribute("data-pika-year"),P.getAttribute("data-pika-month"),P.getAttribute("data-pika-day"))),R.bound&&a(function(){y.hide(),R.blurFieldOnSelect&&R.field&&R.field.blur()},100)):c(P,"pika-prev")?y.prevMonth():c(P,"pika-next")&&y.nextMonth()),c(P,"pika-select"))y._c=!0;else if(A.preventDefault)A.preventDefault();else return A.returnValue=!1,!1}},y._onChange=function(A){A=A||window.event;var P=A.target||A.srcElement;!P||(c(P,"pika-select-month")?y.gotoMonth(P.value):c(P,"pika-select-year")&&y.gotoYear(P.value))},y._onKeyChange=function(A){if(A=A||window.event,y.isVisible())switch(A.keyCode){case 13:case 27:R.field&&R.field.blur();break;case 37:y.adjustDate("subtract",1);break;case 38:y.adjustDate("subtract",7);break;case 39:y.adjustDate("add",1);break;case 40:y.adjustDate("add",7);break;case 8:case 46:y.setDate(null);break}},y._parseFieldValue=function(){if(R.parse)return R.parse(R.field.value,R.format);if(n){var A=r(R.field.value,R.format,R.formatStrict);return A&&A.isValid()?A.toDate():null}else return new Date(Date.parse(R.field.value))},y._onInputChange=function(A){var P;A.firedBy!==y&&(P=y._parseFieldValue(),p(P)&&y.setDate(P),y._v||y.show())},y._onInputFocus=function(){y.show()},y._onInputClick=function(){y.show()},y._onInputBlur=function(){var A=o.activeElement;do if(c(A,"pika-single"))return;while(A=A.parentNode);y._c||(y._b=a(function(){y.hide()},50)),y._c=!1},y._onClick=function(A){A=A||window.event;var P=A.target||A.srcElement,H=P;if(!!P){!i&&c(P,"pika-select")&&(P.onchange||(P.setAttribute("onchange","return;"),s(P,"change",y._onChange)));do if(c(H,"pika-single")||H===R.trigger)return;while(H=H.parentNode);y._v&&P!==R.trigger&&H!==R.trigger&&y.hide()}},y.el=o.createElement("div"),y.el.className="pika-single"+(R.isRTL?" is-rtl":"")+(R.theme?" "+R.theme:""),s(y.el,"mousedown",y._onMouseDown,!0),s(y.el,"touchend",y._onMouseDown,!0),s(y.el,"change",y._onChange),R.keyboardInput&&s(o,"keydown",y._onKeyChange),R.field&&(R.container?R.container.appendChild(y.el):R.bound?o.body.appendChild(y.el):R.field.parentNode.insertBefore(y.el,R.field.nextSibling),s(R.field,"change",y._onInputChange),R.defaultDate||(R.defaultDate=y._parseFieldValue(),R.setDefaultDate=!0));var C=R.defaultDate;p(C)?R.setDefaultDate?y.setDate(C,!0):y.gotoDate(C):y.gotoDate(new Date),R.bound?(this.hide(),y.el.className+=" is-bound",s(R.trigger,"click",y._onInputClick),s(R.trigger,"focus",y._onInputFocus),s(R.trigger,"blur",y._onInputBlur)):this.show()};return ne.prototype={config:function(O){this._o||(this._o=E({},L,!0));var y=E(this._o,O,!0);y.isRTL=!!y.isRTL,y.field=y.field&&y.field.nodeName?y.field:null,y.theme=typeof y.theme=="string"&&y.theme?y.theme:null,y.bound=!!(y.bound!==void 0?y.field&&y.bound:y.field),y.trigger=y.trigger&&y.trigger.nodeName?y.trigger:y.field,y.disableWeekends=!!y.disableWeekends,y.disableDayFn=typeof y.disableDayFn=="function"?y.disableDayFn:null;var R=parseInt(y.numberOfMonths,10)||1;if(y.numberOfMonths=R>4?4:R,p(y.minDate)||(y.minDate=!1),p(y.maxDate)||(y.maxDate=!1),y.minDate&&y.maxDate&&y.maxDate<y.minDate&&(y.maxDate=y.minDate=!1),y.minDate&&this.setMinDate(y.minDate),y.maxDate&&this.setMaxDate(y.maxDate),d(y.yearRange)){var C=new Date().getFullYear()-10;y.yearRange[0]=parseInt(y.yearRange[0],10)||C,y.yearRange[1]=parseInt(y.yearRange[1],10)||C}else y.yearRange=Math.abs(parseInt(y.yearRange,10))||L.yearRange,y.yearRange>100&&(y.yearRange=100);return y},toString:function(O){return O=O||this._o.format,p(this._d)?this._o.toString?this._o.toString(this._d,O):n?r(this._d).format(O):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(O,y){n&&r.isMoment(O)&&this.setDate(O.toDate(),y)},getDate:function(){return p(this._d)?new Date(this._d.getTime()):null},setDate:function(O,y){if(!O)return this._d=null,this._o.field&&(this._o.field.value="",T(this._o.field,"change",{firedBy:this})),this.draw();if(typeof O=="string"&&(O=new Date(Date.parse(O))),!!p(O)){var R=this._o.minDate,C=this._o.maxDate;p(R)&&O<R?O=R:p(C)&&O>C&&(O=C),this._d=new Date(O.getTime()),S(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),T(this._o.field,"change",{firedBy:this})),!y&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(O){var y=!0;if(!!p(O)){if(this.calendars){var R=new Date(this.calendars[0].year,this.calendars[0].month,1),C=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),A=O.getTime();C.setMonth(C.getMonth()+1),C.setDate(C.getDate()-1),y=A<R.getTime()||C.getTime()<A}y&&(this.calendars=[{month:O.getMonth(),year:O.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(O,y){var R=this.getDate()||new Date,C=parseInt(y)*24*60*60*1e3,A;O==="add"?A=new Date(R.valueOf()+C):O==="subtract"&&(A=new Date(R.valueOf()-C)),this.setDate(A)},adjustCalendars:function(){this.calendars[0]=N(this.calendars[0]);for(var O=1;O<this._o.numberOfMonths;O++)this.calendars[O]=N({month:this.calendars[0].month+O,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(O){isNaN(O)||(this.calendars[0].month=parseInt(O,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(O){isNaN(O)||(this.calendars[0].year=parseInt(O,10),this.adjustCalendars())},setMinDate:function(O){O instanceof Date?(S(O),this._o.minDate=O,this._o.minYear=O.getFullYear(),this._o.minMonth=O.getMonth()):(this._o.minDate=L.minDate,this._o.minYear=L.minYear,this._o.minMonth=L.minMonth,this._o.startRange=L.startRange),this.draw()},setMaxDate:function(O){O instanceof Date?(S(O),this._o.maxDate=O,this._o.maxYear=O.getFullYear(),this._o.maxMonth=O.getMonth()):(this._o.maxDate=L.maxDate,this._o.maxYear=L.maxYear,this._o.maxMonth=L.maxMonth,this._o.endRange=L.endRange),this.draw()},setStartRange:function(O){this._o.startRange=O},setEndRange:function(O){this._o.endRange=O},draw:function(O){if(!(!this._v&&!O)){var y=this._o,R=y.minYear,C=y.maxYear,A=y.minMonth,P=y.maxMonth,H="",Y;this._y<=R&&(this._y=R,!isNaN(A)&&this._m<A&&(this._m=A)),this._y>=C&&(this._y=C,!isNaN(P)&&this._m>P&&(this._m=P));for(var z=0;z<y.numberOfMonths;z++)Y="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),H+='<div class="pika-lendar">'+te(this,z,this.calendars[z].year,this.calendars[z].month,this.calendars[0].year,Y)+this.render(this.calendars[z].year,this.calendars[z].month,Y)+"</div>";this.el.innerHTML=H,y.bound&&y.field.type!=="hidden"&&a(function(){y.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),y.bound&&y.field.setAttribute("aria-label",y.ariaLabel)}},adjustPosition:function(){var O,y,R,C,A,P,H,Y,z,oe,me,re;if(!this._o.container){if(this.el.style.position="absolute",O=this._o.trigger,y=O,R=this.el.offsetWidth,C=this.el.offsetHeight,A=window.innerWidth||o.documentElement.clientWidth,P=window.innerHeight||o.documentElement.clientHeight,H=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,me=!0,re=!0,typeof O.getBoundingClientRect=="function")oe=O.getBoundingClientRect(),Y=oe.left+window.pageXOffset,z=oe.bottom+window.pageYOffset;else for(Y=y.offsetLeft,z=y.offsetTop+y.offsetHeight;y=y.offsetParent;)Y+=y.offsetLeft,z+=y.offsetTop;(this._o.reposition&&Y+R>A||this._o.position.indexOf("right")>-1&&Y-R+O.offsetWidth>0)&&(Y=Y-R+O.offsetWidth,me=!1),(this._o.reposition&&z+C>P+H||this._o.position.indexOf("top")>-1&&z-C-O.offsetHeight>0)&&(z=z-C-O.offsetHeight,re=!1),this.el.style.left=Y+"px",this.el.style.top=z+"px",f(this.el,me?"left-aligned":"right-aligned"),f(this.el,re?"bottom-aligned":"top-aligned"),h(this.el,me?"right-aligned":"left-aligned"),h(this.el,re?"top-aligned":"bottom-aligned")}},render:function(O,y,R){var C=this._o,A=new Date,P=v(O,y),H=new Date(O,y,1).getDay(),Y=[],z=[];S(A),C.firstDay>0&&(H-=C.firstDay,H<0&&(H+=7));for(var oe=y===0?11:y-1,me=y===11?0:y+1,re=y===0?O-1:O,ge=y===11?O+1:O,ve=v(re,oe),ie=P+H,be=ie;be>7;)be-=7;ie+=7-be;for(var ce=!1,_e=0,Ie=0;_e<ie;_e++){var Oe=new Date(O,y,1+(_e-H)),Ae=p(this._d)?b(Oe,this._d):!1,xe=b(Oe,A),I=C.events.indexOf(Oe.toDateString())!==-1,D=_e<H||_e>=P+H,U=1+(_e-H),ae=y,X=O,le=C.startRange&&b(C.startRange,Oe),ee=C.endRange&&b(C.endRange,Oe),Z=C.startRange&&C.endRange&&C.startRange<Oe&&Oe<C.endRange,ue=C.minDate&&Oe<C.minDate||C.maxDate&&Oe>C.maxDate||C.disableWeekends&&m(Oe)||C.disableDayFn&&C.disableDayFn(Oe);D&&(_e<H?(U=ve+U,ae=oe,X=re):(U=U-P,ae=me,X=ge));var K={day:U,month:ae,year:X,hasEvent:I,isSelected:Ae,isToday:xe,isDisabled:ue,isEmpty:D,isStartRange:le,isEndRange:ee,isInRange:Z,showDaysInNextAndPreviousMonths:C.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:C.enableSelectionDaysInNextAndPreviousMonths};C.pickWholeWeek&&Ae&&(ce=!0),z.push(B(K)),++Ie===7&&(C.showWeekNumber&&z.unshift(M(_e-H,y,O,C.firstWeekOfYearMinDays)),Y.push(G(z,C.isRTL,C.pickWholeWeek,ce)),z=[],Ie=0,ce=!1)}return pe(C,Y,R)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(s(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var O=this._v;O!==!1&&(this._o.bound&&l(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),f(this.el,"is-hidden"),this._v=!1,O!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var O=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),O.keyboardInput&&l(o,"keydown",this._onKeyChange),O.field&&(l(O.field,"change",this._onInputChange),O.bound&&(l(O.trigger,"click",this._onInputClick),l(O.trigger,"focus",this._onInputFocus),l(O.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},ne})})(tq);const Fk=tq.exports;function wh(t){return wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wh(t)}function $Re(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,DRe(n.key),n)}}function LRe(t,e,r){return e&&Hk(t.prototype,e),r&&Hk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function DRe(t){var e=FRe(t,"string");return wh(e)==="symbol"?e:String(e)}function FRe(t,e){if(wh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fa(){return typeof Reflect<"u"&&Reflect.get?Fa=Reflect.get.bind():Fa=function(e,r,n){var i=HRe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Fa.apply(this,arguments)}function HRe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=So(t),t!==null););return t}function BRe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&PT(t,e)}function PT(t,e){return PT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},PT(t,e)}function URe(t){var e=WRe();return function(){var n=So(t),i;if(e){var o=So(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return VRe(this,i)}}function VRe(t,e){if(e&&(wh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jRe(t)}function jRe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function WRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function So(t){return So=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},So(t)}var rq="date",Bk="dateEditor",nq=function(t){BRe(r,t);var e=URe(r);function r(n){var i;return $Re(this,r),i=e.call(this,n),i.defaultDateFormat="DD/MM/YYYY",i.isCellEdited=!1,i.parentDestroyed=!1,i.$datePicker=null,i}return LRe(r,[{key:"init",value:function(){var i=this;if(typeof qt!="function")throw new Error("You need to include moment.js to your project.");if(typeof Fk!="function")throw new Error("You need to include Pikaday to your project.");Fa(So(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){i.parentDestroyed=!0,i.destroyElements()})}},{key:"createElements",value:function(){Fa(So(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Re(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var i=new Er(this);i.addEventListener(this.datePicker,"mousedown",function(o){return o.stopPropagation()})}},{key:"destroyElements",value:function(){var i=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),i&&i.removeChild(this.datePicker)}},{key:"prepare",value:function(i,o,a,s,l,u){Fa(So(r.prototype),"prepare",this).call(this,i,o,a,s,l,u)}},{key:"open",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=this.hot.getShortcutManager(),a=o.getContext("editor");Fa(So(r.prototype),"open",this).call(this),this.showDatepicker(i),a.addShortcut({keys:[["Enter"]],callback:function(l){l.stopPropagation()},group:Bk})}},{key:"close",value:function(){var i,o=this;this._opened=!1,(i=this.$datePicker)!==null&&i!==void 0&&i.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){o.instance._refreshBorders()});var a=this.hot.getShortcutManager(),s=a.getContext("editor");s.removeShortcutsByGroup(Bk),Fa(So(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(i){var a=this.originalValue;a!==void 0&&this.setValue(a)}Fa(So(r.prototype),"finishEditing",this).call(this,i,o)}},{key:"showDatepicker",value:function(i){var o=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,s=this.instance.view.isMouseDown(),l=i?_K(i.keyCode):!1,u;this.datePicker.style.display="block",this.$datePicker=new Fk(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+o.top+wr(this.TD),"px");var c=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?c=o.right-Qt(this.datePicker):c=o.left,this.datePickerStyle.left="".concat(c,"px"),this.originalValue?(u=this.originalValue,qt(u,a,!0).isValid()&&this.$datePicker.setMoment(qt(u,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!l&&!s&&this.setValue("")):this.cellProperties.defaultDate?(u=this.cellProperties.defaultDate,qt(u,a,!0).isValid()&&this.$datePicker.setMoment(qt(u,a),!0),!l&&!s&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var i=this,o=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&R6(a,this.cellProperties.datePickerConfig);var s=a.onSelect,l=a.onClose;return a.field=o,a.trigger=o,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.isRTL=!1,a.onSelect=function(u){var c=u;isNaN(c.getTime())||(c=qt(c).format(i.cellProperties.dateFormat||i.defaultDateFormat)),i.setValue(c),i.hideDatepicker(),s&&s()},a.onClose=function(){i.parentDestroyed||i.finishEditing(!1),l&&l()},a}}],[{key:"EDITOR_TYPE",get:function(){return rq}}]),r}(Cc);function Sh(t){return Sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sh(t)}function zRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Uk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,YRe(n.key),n)}}function GRe(t,e,r){return e&&Uk(t.prototype,e),r&&Uk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function YRe(t){var e=KRe(t,"string");return Sh(e)==="symbol"?e:String(e)}function KRe(t,e){if(Sh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qb(){return typeof Reflect<"u"&&Reflect.get?qb=Reflect.get.bind():qb=function(e,r,n){var i=qRe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},qb.apply(this,arguments)}function qRe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Rh(t),t!==null););return t}function XRe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kT(t,e)}function kT(t,e){return kT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kT(t,e)}function QRe(t){var e=e5e();return function(){var n=Rh(t),i;if(e){var o=Rh(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ZRe(this,i)}}function ZRe(t,e){if(e&&(Sh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JRe(t)}function JRe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function e5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rh(t){return Rh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rh(t)}var t5e="dropdown",e3=function(t){XRe(r,t);var e=QRe(r);function r(){return zRe(this,r),e.apply(this,arguments)}return GRe(r,[{key:"prepare",value:function(i,o,a,s,l,u){qb(Rh(r.prototype),"prepare",this).call(this,i,o,a,s,l,u),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return t5e}}]),r}(J8);Ue.getSingleton().add("beforeValidate",function(t,e,r){var n=this.getCellMeta(e,this.propToCol(r));n.editor===e3&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function Eh(t){return Eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Eh(t)}function r5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i5e(n.key),n)}}function n5e(t,e,r){return e&&Vk(t.prototype,e),r&&Vk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function i5e(t){var e=o5e(t,"string");return Eh(e)==="symbol"?e:String(e)}function o5e(t,e){if(Eh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function a5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$T(t,e)}function $T(t,e){return $T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$T(t,e)}function s5e(t){var e=c5e();return function(){var n=iw(t),i;if(e){var o=iw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return l5e(this,i)}}function l5e(t,e){if(e&&(Eh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u5e(t)}function u5e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function iw(t){return iw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iw(t)}var f5e="numeric",iq=function(t){a5e(r,t);var e=s5e(r);function r(){return r5e(this,r),e.apply(this,arguments)}return n5e(r,null,[{key:"EDITOR_TYPE",get:function(){return f5e}}]),r}(Cc);function Ch(t){return Ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ch(t)}function h5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p5e(n.key),n)}}function d5e(t,e,r){return e&&jk(t.prototype,e),r&&jk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function p5e(t){var e=m5e(t,"string");return Ch(e)==="symbol"?e:String(e)}function m5e(t,e){if(Ch(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xb(){return typeof Reflect<"u"&&Reflect.get?Xb=Reflect.get.bind():Xb=function(e,r,n){var i=g5e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Xb.apply(this,arguments)}function g5e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=_h(t),t!==null););return t}function y5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&LT(t,e)}function LT(t,e){return LT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},LT(t,e)}function v5e(t){var e=S5e();return function(){var n=_h(t),i;if(e){var o=_h(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return b5e(this,i)}}function b5e(t,e){if(e&&(Ch(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w5e(t)}function w5e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _h(t){return _h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_h(t)}var R5e="password",oq=function(t){y5e(r,t);var e=v5e(r);function r(){return h5e(this,r),e.apply(this,arguments)}return d5e(r,[{key:"createElements",value:function(){Xb(_h(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,ua(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return R5e}}]),r}(Cc);function qu(t){return qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qu(t)}function E5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_5e(n.key),n)}}function C5e(t,e,r){return e&&Wk(t.prototype,e),r&&Wk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _5e(t){var e=T5e(t,"string");return qu(e)==="symbol"?e:String(e)}function T5e(t,e){if(qu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qb(){return typeof Reflect<"u"&&Reflect.get?Qb=Reflect.get.bind():Qb=function(e,r,n){var i=O5e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Qb.apply(this,arguments)}function O5e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Th(t),t!==null););return t}function A5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&DT(t,e)}function DT(t,e){return DT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},DT(t,e)}function x5e(t){var e=N5e();return function(){var n=Th(t),i;if(e){var o=Th(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return I5e(this,i)}}function I5e(t,e){if(e&&(qu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return M5e(t)}function M5e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function N5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Th(t){return Th=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Th(t)}var xE="ht_editor_visible",zk="selectEditor",P5e="select",k5e=function(t){A5e(r,t);var e=x5e(r);function r(){return E5e(this,r),e.apply(this,arguments)}return C5e(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Re(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(i){this.select.value=i}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var i=this.hot.getShortcutManager();i.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",at(this.select,xE)&&ut(this.select,xE),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var i=this;this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){return i.refreshDimensions()}),this.addHook("afterRowResize",function(){return i.refreshDimensions()})}},{key:"prepare",value:function(i,o,a,s,l,u){var c=this;Qb(Th(r.prototype),"prepare",this).call(this,i,o,a,s,l,u);var f=this.cellProperties.selectOptions,h;typeof f=="function"?h=this.prepareOptions(f(this.row,this.col,this.prop)):h=this.prepareOptions(f),ua(this.select),St(h,function(d,p){var m=c.hot.rootDocument.createElement("OPTION");m.value=p,Hp(m,d),c.select.appendChild(m)})}},{key:"prepareOptions",value:function(i){var o={};if(Array.isArray(i))for(var a=0,s=i.length;a<s;a++)o[i[a]]=i[a];else qu(i)==="object"&&(o=i);return o}},{key:"refreshValue",value:function(){var i=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===fn.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var i=this.getEditedCellRect(),o=i.top,a=i.start,s=i.width,l=i.height,u=this.select.style;u.height="".concat(l,"px"),u.width="".concat(s,"px"),u.top="".concat(o,"px"),u[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),u.margin="0px",Re(this.select,xE)}}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),a=o.getContext("editor"),s={group:zk};this.isInFullEditMode()!==!1&&a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var u=i.select.selectedIndex-1;u>=0&&(i.select[u].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var u=i.select.selectedIndex+1;u<=i.select.length-1&&(i.select[u].selected=!0)}}],s)}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("editor");o.removeShortcutsByGroup(zk)}}],[{key:"EDITOR_TYPE",get:function(){return P5e}}]),r}(Bp);function Oh(t){return Oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oh(t)}function $5e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,D5e(n.key),n)}}function L5e(t,e,r){return e&&Gk(t.prototype,e),r&&Gk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function D5e(t){var e=F5e(t,"string");return Oh(e)==="symbol"?e:String(e)}function F5e(t,e){if(Oh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zb(){return typeof Reflect<"u"&&Reflect.get?Zb=Reflect.get.bind():Zb=function(e,r,n){var i=H5e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Zb.apply(this,arguments)}function H5e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ah(t),t!==null););return t}function B5e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&FT(t,e)}function FT(t,e){return FT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},FT(t,e)}function U5e(t){var e=W5e();return function(){var n=Ah(t),i;if(e){var o=Ah(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return V5e(this,i)}}function V5e(t,e){if(e&&(Oh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return j5e(t)}function j5e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function W5e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ah(t){return Ah=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ah(t)}var z5e="time",aq=function(t){B5e(r,t);var e=U5e(r);function r(){return $5e(this,r),e.apply(this,arguments)}return L5e(r,[{key:"prepare",value:function(i,o,a,s,l,u){Zb(Ah(r.prototype),"prepare",this).call(this,i,o,a,s,l,u),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return z5e}}]),r}(Cc);function G5e(){Oi(Bp),Oi(J8),Oi(eq),Oi(nq),Oi(e3),Oi(Z8),Oi(iq),Oi(oq),Oi(k5e),Oi(Cc),Oi(aq)}var Y5e="html";function t3(t,e,r,n,i,o,a){I1.apply(this,[t,e,r,n,i,o,a]),Hp(e,o==null?"":o,!1)}t3.RENDERER_TYPE=Y5e;var K5e="autocomplete";function Up(t,e,r,n,i,o,a){var s=t.rootDocument,l=a.allowHtml?t3:El,u=s.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(s.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,r,n,i,o,a]),e.firstChild||e.appendChild(s.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),Re(e,"htAutocomplete"),!t.acArrowListener){var c=new Er(t);t.acArrowListener=function(f){at(f.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(r,n),e)},c.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",function(){c.destroy()})}}Up.RENDERER_TYPE=K5e;var Yk=new WeakMap,Kk=new WeakMap,q5e="htBadValue",xh="data-row",Ih="data-col",X5e="checkboxRenderer",sq="checkbox";Ue.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,r){var n=e.label,i=e.type,o=e.row,a=e.column,s=e.prop;if(i===sq){if(n){var l=n.value,u=n.property,c=r;if(l)c=typeof l=="function"?l(o,a,s,r):l;else if(u){var f=this.getDataAtRowProp(o,u);c=f!==null?f:r}t=c}return t}});function r3(t,e,r,n,i,o,a){var s=t.rootDocument;I1.apply(this,[t,e,r,n,i,o,a]),Q5e(t);var l=Z5e(s),u=a.label,c=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),ua(e),o===a.checkedTemplate||Vr(o).toLocaleLowerCase(a.locale)===Vr(a.checkedTemplate).toLocaleLowerCase(a.locale)?l.checked=!0:o===a.uncheckedTemplate||Vr(o).toLocaleLowerCase(a.locale)===Vr(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?l.checked=!1:an(o)?Re(l,"noValue"):(l.style.display="none",Re(l,q5e),c=!0),l.setAttribute(xh,r),l.setAttribute(Ih,n),!c&&u){var f="";if(u.value)f=typeof u.value=="function"?u.value.call(this,r,n,i,o):u.value;else if(u.property){var h=t.getDataAtRowProp(r,u.property);f=h!==null?h:""}var d=J5e(s,f,u.separated!==!0);u.position==="before"?u.separated?(e.appendChild(d),e.appendChild(l)):(d.appendChild(l),l=d):(!u.position||u.position==="after")&&(u.separated?(e.appendChild(l),e.appendChild(d)):(d.insertBefore(l,d.firstChild),l=d))}(!u||u&&!u.separated)&&e.appendChild(l),c&&e.appendChild(s.createTextNode("#bad-value#")),Yk.has(t)||(Yk.set(t,!0),p());function p(){var v=t.getShortcutManager(),S=v.getContext("grid"),b={group:X5e};S.addShortcuts([{keys:[["space"]],callback:function(){return m(),!g()}},{keys:[["enter"]],callback:function(){return m(),!g()},runOnlyIf:function(){return t.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return m(!0),!g()},relativeToGroup:Jm,position:"before"}],b)}function m(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=t.getSelectedRange();if(!!S)for(var b=0;b<S.length;b++){for(var E=S[b].getTopStartCorner(),T=E.row,N=E.col,L=S[b].getBottomEndCorner(),V=L.row,B=L.col,k=[],M=T;M<=V;M+=1)for(var G=N;G<=B;G+=1){var j=t.getCellMeta(M,G);if(j.type!=="checkbox")return;if(j.readOnly!==!0){typeof j.checkedTemplate>"u"&&(j.checkedTemplate=!0),typeof j.uncheckedTemplate>"u"&&(j.uncheckedTemplate=!1);var q=t.getDataAtCell(M,G);v===!1?[j.checkedTemplate,j.checkedTemplate.toString()].includes(q)?k.push([M,G,j.uncheckedTemplate]):[j.uncheckedTemplate,j.uncheckedTemplate.toString(),null,void 0].includes(q)&&k.push([M,G,j.checkedTemplate]):k.push([M,G,j.uncheckedTemplate])}}k.length>0&&t.setDataAtCell(k)}}function g(){var v=t.getSelectedRange();if(!!v){for(var S=0;S<v.length;S++)for(var b=v[S].getTopStartCorner(),E=v[S].getBottomEndCorner(),T=b.row;T<=E.row;T++)for(var N=b.col;N<=E.col;N++){var L=t.getCellMeta(T,N);if(L.type!=="checkbox")return!1;var V=t.getCell(T,N);if(V==null)return!0;var B=V.querySelectorAll("input[type=checkbox]");if(B.length>0&&!L.readOnly)return!0}return!1}}}r3.RENDERER_TYPE=sq;function Q5e(t){var e=Kk.get(t);if(!e){var r=t.rootElement;e=new Er(t),e.addEventListener(r,"click",function(n){return tEe(n,t)}),e.addEventListener(r,"mouseup",function(n){return eEe(n,t)}),e.addEventListener(r,"change",function(n){return rEe(n,t)}),Kk.set(t,e)}return e}function Z5e(t){var e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function J5e(t,e,r){var n=t.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(t.createTextNode(e)),n.cloneNode(!0)}function eEe(t,e){var r=t.target;!n3(r)||!r.hasAttribute(xh)||!r.hasAttribute(Ih)||setTimeout(e.listen,10)}function tEe(t,e){var r=t.target;if(!!n3(r)&&!(!r.hasAttribute(xh)||!r.hasAttribute(Ih))){var n=parseInt(r.getAttribute(xh),10),i=parseInt(r.getAttribute(Ih),10),o=e.getCellMeta(n,i);o.readOnly&&t.preventDefault()}}function rEe(t,e){var r=t.target;if(!!n3(r)&&!(!r.hasAttribute(xh)||!r.hasAttribute(Ih))){var n=parseInt(r.getAttribute(xh),10),i=parseInt(r.getAttribute(Ih),10),o=e.getCellMeta(n,i);if(!o.readOnly){var a=null;t.target.checked?a=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:a=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(n,i,a)}}}function n3(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}var lq={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(){return function r(n,i,o){function a(u,c){if(!i[u]){if(!n[u]){var f=typeof i0=="function"&&i0;if(!c&&f)return f(u,!0);if(s)return s(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var d=i[u]={exports:{}};n[u][0].call(d.exports,function(p){return a(n[u][1][p]||p)},d,d.exports,r,n,i,o)}return i[u].exports}for(var s=typeof i0=="function"&&i0,l=0;l<o.length;l++)a(o[l]);return a}({1:[function(r,n,i){(function(o){var a,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",f=c+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,p=9007199254740991,m=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],g=1e7,v=1e9;function S(B){var k=0|B;return 0<B||B===k?k:k-1}function b(B){for(var k,M,G=1,j=B.length,q=B[0]+"";G<j;){for(k=B[G++]+"",M=d-k.length;M--;k="0"+k);q+=k}for(j=q.length;q.charCodeAt(--j)===48;);return q.slice(0,j+1||1)}function E(B,k){var M,G,j=B.c,q=k.c,te=B.s,pe=k.s,ne=B.e,O=k.e;if(!te||!pe)return null;if(M=j&&!j[0],G=q&&!q[0],M||G)return M?G?0:-pe:te;if(te!=pe)return te;if(M=te<0,G=ne==O,!j||!q)return G?0:!j^M?1:-1;if(!G)return O<ne^M?1:-1;for(pe=(ne=j.length)<(O=q.length)?ne:O,te=0;te<pe;te++)if(j[te]!=q[te])return j[te]>q[te]^M?1:-1;return ne==O?0:O<ne^M?1:-1}function T(B,k,M,G){if(B<k||M<B||B!==(B<0?l(B):u(B)))throw Error(c+(G||"Argument")+(typeof B=="number"?B<k||M<B?" out of range: ":" not an integer: ":" not a primitive number: ")+String(B))}function N(B){var k=B.c.length-1;return S(B.e/d)==k&&B.c[k]%2!=0}function L(B,k){return(1<B.length?B.charAt(0)+"."+B.slice(1):B)+(k<0?"e":"e+")+k}function V(B,k,M){var G,j;if(k<0){for(j=M+".";++k;j+=M);B=j+B}else if(++k>(G=B.length)){for(j=M,k-=G;--k;j+=M);B+=j}else k<G&&(B=B.slice(0,k)+"."+B.slice(k));return B}(a=function B(k){var M,G,j,q,te,pe,ne,O,y,R,C=ce.prototype={constructor:ce,toString:null,valueOf:null},A=new ce(1),P=20,H=4,Y=-7,z=21,oe=-1e7,me=1e7,re=!1,ge=1,ve=0,ie={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},be="0123456789abcdefghijklmnopqrstuvwxyz";function ce(I,D){var U,ae,X,le,ee,Z,ue,K,se=this;if(!(se instanceof ce))return new ce(I,D);if(D==null){if(I instanceof ce)return se.s=I.s,se.e=I.e,void(se.c=(I=I.c)?I.slice():I);if((Z=typeof I=="number")&&0*I==0){if(se.s=1/I<0?(I=-I,-1):1,I===~~I){for(le=0,ee=I;10<=ee;ee/=10,le++);return se.e=le,void(se.c=[I])}K=String(I)}else{if(K=String(I),!s.test(K))return j(se,K,Z);se.s=K.charCodeAt(0)==45?(K=K.slice(1),-1):1}-1<(le=K.indexOf("."))&&(K=K.replace(".","")),0<(ee=K.search(/e/i))?(le<0&&(le=ee),le+=+K.slice(ee+1),K=K.substring(0,ee)):le<0&&(le=K.length)}else{if(T(D,2,be.length,"Base"),K=String(I),D==10)return Ae(se=new ce(I instanceof ce?I:K),P+se.e+1,H);if(Z=typeof I=="number"){if(0*I!=0)return j(se,K,Z,D);if(se.s=1/I<0?(K=K.slice(1),-1):1,ce.DEBUG&&15<K.replace(/^0\.0*|\./,"").length)throw Error(f+I);Z=!1}else se.s=K.charCodeAt(0)===45?(K=K.slice(1),-1):1;for(U=be.slice(0,D),le=ee=0,ue=K.length;ee<ue;ee++)if(U.indexOf(ae=K.charAt(ee))<0){if(ae=="."){if(le<ee){le=ue;continue}}else if(!X&&(K==K.toUpperCase()&&(K=K.toLowerCase())||K==K.toLowerCase()&&(K=K.toUpperCase()))){X=!0,ee=-1,le=0;continue}return j(se,String(I),Z,D)}-1<(le=(K=G(K,D,10,se.s)).indexOf("."))?K=K.replace(".",""):le=K.length}for(ee=0;K.charCodeAt(ee)===48;ee++);for(ue=K.length;K.charCodeAt(--ue)===48;);if(K=K.slice(ee,++ue)){if(ue-=ee,Z&&ce.DEBUG&&15<ue&&(p<I||I!==u(I)))throw Error(f+se.s*I);if(me<(le=le-ee-1))se.c=se.e=null;else if(le<oe)se.c=[se.e=0];else{if(se.e=le,se.c=[],ee=(le+1)%d,le<0&&(ee+=d),ee<ue){for(ee&&se.c.push(+K.slice(0,ee)),ue-=d;ee<ue;)se.c.push(+K.slice(ee,ee+=d));K=K.slice(ee),ee=d-K.length}else ee-=ue;for(;ee--;K+="0");se.c.push(+K)}}else se.c=[se.e=0]}function _e(I,D,U,ae){var X,le,ee,Z,ue;if(U==null?U=H:T(U,0,8),!I.c)return I.toString();if(X=I.c[0],ee=I.e,D==null)ue=b(I.c),ue=ae==1||ae==2&&(ee<=Y||z<=ee)?L(ue,ee):V(ue,ee,"0");else if(le=(I=Ae(new ce(I),D,U)).e,Z=(ue=b(I.c)).length,ae==1||ae==2&&(D<=le||le<=Y)){for(;Z<D;ue+="0",Z++);ue=L(ue,le)}else if(D-=ee,ue=V(ue,le,"0"),Z<le+1){if(0<--D)for(ue+=".";D--;ue+="0");}else if(0<(D+=le-Z))for(le+1==Z&&(ue+=".");D--;ue+="0");return I.s<0&&X?"-"+ue:ue}function Ie(I,D){for(var U,ae=1,X=new ce(I[0]);ae<I.length;ae++){if(!(U=new ce(I[ae])).s){X=U;break}D.call(X,U)&&(X=U)}return X}function Oe(I,D,U){for(var ae=1,X=D.length;!D[--X];D.pop());for(X=D[0];10<=X;X/=10,ae++);return(U=ae+U*d-1)>me?I.c=I.e=null:I.c=U<oe?[I.e=0]:(I.e=U,D),I}function Ae(I,D,U,ae){var X,le,ee,Z,ue,K,se,we=I.c,Se=m;if(we){e:{for(X=1,Z=we[0];10<=Z;Z/=10,X++);if((le=D-X)<0)le+=d,ee=D,se=(ue=we[K=0])/Se[X-ee-1]%10|0;else if((K=l((le+1)/d))>=we.length){if(!ae)break e;for(;we.length<=K;we.push(0));ue=se=0,ee=(le%=d)-d+(X=1)}else{for(ue=Z=we[K],X=1;10<=Z;Z/=10,X++);se=(ee=(le%=d)-d+X)<0?0:ue/Se[X-ee-1]%10|0}if(ae=ae||D<0||we[K+1]!=null||(ee<0?ue:ue%Se[X-ee-1]),ae=U<4?(se||ae)&&(U==0||U==(I.s<0?3:2)):5<se||se==5&&(U==4||ae||U==6&&(0<le?0<ee?ue/Se[X-ee]:0:we[K-1])%10&1||U==(I.s<0?8:7)),D<1||!we[0])return we.length=0,ae?(D-=I.e+1,we[0]=Se[(d-D%d)%d],I.e=-D||0):we[0]=I.e=0,I;if(le==0?(we.length=K,Z=1,K--):(we.length=K+1,Z=Se[d-le],we[K]=0<ee?u(ue/Se[X-ee]%Se[ee])*Z:0),ae)for(;;){if(K==0){for(le=1,ee=we[0];10<=ee;ee/=10,le++);for(ee=we[0]+=Z,Z=1;10<=ee;ee/=10,Z++);le!=Z&&(I.e++,we[0]==h&&(we[0]=1));break}if(we[K]+=Z,we[K]!=h)break;we[K--]=0,Z=1}for(le=we.length;we[--le]===0;we.pop());}I.e>me?I.c=I.e=null:I.e<oe&&(I.c=[I.e=0])}return I}function xe(I){var D,U=I.e;return U===null?I.toString():(D=b(I.c),D=U<=Y||z<=U?L(D,U):V(D,U,"0"),I.s<0?"-"+D:D)}return ce.clone=B,ce.ROUND_UP=0,ce.ROUND_DOWN=1,ce.ROUND_CEIL=2,ce.ROUND_FLOOR=3,ce.ROUND_HALF_UP=4,ce.ROUND_HALF_DOWN=5,ce.ROUND_HALF_EVEN=6,ce.ROUND_HALF_CEIL=7,ce.ROUND_HALF_FLOOR=8,ce.EUCLID=9,ce.config=ce.set=function(I){var D,U;if(I!=null){if(typeof I!="object")throw Error(c+"Object expected: "+I);if(I.hasOwnProperty(D="DECIMAL_PLACES")&&(T(U=I[D],0,v,D),P=U),I.hasOwnProperty(D="ROUNDING_MODE")&&(T(U=I[D],0,8,D),H=U),I.hasOwnProperty(D="EXPONENTIAL_AT")&&((U=I[D])&&U.pop?(T(U[0],-v,0,D),T(U[1],0,v,D),Y=U[0],z=U[1]):(T(U,-v,v,D),Y=-(z=U<0?-U:U))),I.hasOwnProperty(D="RANGE"))if((U=I[D])&&U.pop)T(U[0],-v,-1,D),T(U[1],1,v,D),oe=U[0],me=U[1];else{if(T(U,-v,v,D),!U)throw Error(c+D+" cannot be zero: "+U);oe=-(me=U<0?-U:U)}if(I.hasOwnProperty(D="CRYPTO")){if((U=I[D])!==!!U)throw Error(c+D+" not true or false: "+U);if(U){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw re=!U,Error(c+"crypto unavailable");re=U}else re=U}if(I.hasOwnProperty(D="MODULO_MODE")&&(T(U=I[D],0,9,D),ge=U),I.hasOwnProperty(D="POW_PRECISION")&&(T(U=I[D],0,v,D),ve=U),I.hasOwnProperty(D="FORMAT")){if(typeof(U=I[D])!="object")throw Error(c+D+" not an object: "+U);ie=U}if(I.hasOwnProperty(D="ALPHABET")){if(typeof(U=I[D])!="string"||/^.$|[+-.\s]|(.).*\1/.test(U))throw Error(c+D+" invalid: "+U);be=U}}return{DECIMAL_PLACES:P,ROUNDING_MODE:H,EXPONENTIAL_AT:[Y,z],RANGE:[oe,me],CRYPTO:re,MODULO_MODE:ge,POW_PRECISION:ve,FORMAT:ie,ALPHABET:be}},ce.isBigNumber=function(I){return I instanceof ce||I&&I._isBigNumber===!0||!1},ce.maximum=ce.max=function(){return Ie(arguments,C.lt)},ce.minimum=ce.min=function(){return Ie(arguments,C.gt)},ce.random=(q=9007199254740992,te=Math.random()*q&2097151?function(){return u(Math.random()*q)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(I){var D,U,ae,X,le,ee=0,Z=[],ue=new ce(A);if(I==null?I=P:T(I,0,v),X=l(I/d),re)if(crypto.getRandomValues){for(D=crypto.getRandomValues(new Uint32Array(X*=2));ee<X;)9e15<=(le=131072*D[ee]+(D[ee+1]>>>11))?(U=crypto.getRandomValues(new Uint32Array(2)),D[ee]=U[0],D[ee+1]=U[1]):(Z.push(le%1e14),ee+=2);ee=X/2}else{if(!crypto.randomBytes)throw re=!1,Error(c+"crypto unavailable");for(D=crypto.randomBytes(X*=7);ee<X;)9e15<=(le=281474976710656*(31&D[ee])+1099511627776*D[ee+1]+4294967296*D[ee+2]+16777216*D[ee+3]+(D[ee+4]<<16)+(D[ee+5]<<8)+D[ee+6])?crypto.randomBytes(7).copy(D,ee):(Z.push(le%1e14),ee+=7);ee=X/7}if(!re)for(;ee<X;)(le=te())<9e15&&(Z[ee++]=le%1e14);for(X=Z[--ee],I%=d,X&&I&&(le=m[d-I],Z[ee]=u(X/le)*le);Z[ee]===0;Z.pop(),ee--);if(ee<0)Z=[ae=0];else{for(ae=-1;Z[0]===0;Z.splice(0,1),ae-=d);for(ee=1,le=Z[0];10<=le;le/=10,ee++);ee<d&&(ae-=d-ee)}return ue.e=ae,ue.c=Z,ue}),ce.sum=function(){for(var I=1,D=arguments,U=new ce(D[0]);I<D.length;)U=U.plus(D[I++]);return U},G=function(){var I="0123456789";function D(U,ae,X,le){for(var ee,Z,ue=[0],K=0,se=U.length;K<se;){for(Z=ue.length;Z--;ue[Z]*=ae);for(ue[0]+=le.indexOf(U.charAt(K++)),ee=0;ee<ue.length;ee++)ue[ee]>X-1&&(ue[ee+1]==null&&(ue[ee+1]=0),ue[ee+1]+=ue[ee]/X|0,ue[ee]%=X)}return ue.reverse()}return function(U,ae,X,le,ee){var Z,ue,K,se,we,Se,Me,qe,ke=U.indexOf("."),We=P,Ke=H;for(0<=ke&&(se=ve,ve=0,U=U.replace(".",""),Se=(qe=new ce(ae)).pow(U.length-ke),ve=se,qe.c=D(V(b(Se.c),Se.e,"0"),10,X,I),qe.e=qe.c.length),K=se=(Me=D(U,ae,X,ee?(Z=be,I):(Z=I,be))).length;Me[--se]==0;Me.pop());if(!Me[0])return Z.charAt(0);if(ke<0?--K:(Se.c=Me,Se.e=K,Se.s=le,Me=(Se=M(Se,qe,We,Ke,X)).c,we=Se.r,K=Se.e),ke=Me[ue=K+We+1],se=X/2,we=we||ue<0||Me[ue+1]!=null,we=Ke<4?(ke!=null||we)&&(Ke==0||Ke==(Se.s<0?3:2)):se<ke||ke==se&&(Ke==4||we||Ke==6&&1&Me[ue-1]||Ke==(Se.s<0?8:7)),ue<1||!Me[0])U=we?V(Z.charAt(1),-We,Z.charAt(0)):Z.charAt(0);else{if(Me.length=ue,we)for(--X;++Me[--ue]>X;)Me[ue]=0,ue||(++K,Me=[1].concat(Me));for(se=Me.length;!Me[--se];);for(ke=0,U="";ke<=se;U+=Z.charAt(Me[ke++]));U=V(U,K,Z.charAt(0))}return U}}(),M=function(){function I(ae,X,le){var ee,Z,ue,K,se=0,we=ae.length,Se=X%g,Me=X/g|0;for(ae=ae.slice();we--;)se=((Z=Se*(ue=ae[we]%g)+(ee=Me*ue+(K=ae[we]/g|0)*Se)%g*g+se)/le|0)+(ee/g|0)+Me*K,ae[we]=Z%le;return se&&(ae=[se].concat(ae)),ae}function D(ae,X,le,ee){var Z,ue;if(le!=ee)ue=ee<le?1:-1;else for(Z=ue=0;Z<le;Z++)if(ae[Z]!=X[Z]){ue=ae[Z]>X[Z]?1:-1;break}return ue}function U(ae,X,le,ee){for(var Z=0;le--;)ae[le]-=Z,Z=ae[le]<X[le]?1:0,ae[le]=Z*ee+ae[le]-X[le];for(;!ae[0]&&1<ae.length;ae.splice(0,1));}return function(ae,X,le,ee,Z){var ue,K,se,we,Se,Me,qe,ke,We,Ke,Xe,nt,Rt,it,st,rt,Lt,kt=ae.s==X.s?1:-1,It=ae.c,gt=X.c;if(!(It&&It[0]&&gt&&gt[0]))return new ce(ae.s&&X.s&&(It?!gt||It[0]!=gt[0]:gt)?It&&It[0]==0||!gt?0*kt:kt/0:NaN);for(We=(ke=new ce(kt)).c=[],kt=le+(K=ae.e-X.e)+1,Z||(Z=h,K=S(ae.e/d)-S(X.e/d),kt=kt/d|0),se=0;gt[se]==(It[se]||0);se++);if(gt[se]>(It[se]||0)&&K--,kt<0)We.push(1),we=!0;else{for(it=It.length,rt=gt.length,kt+=2,1<(Se=u(Z/(gt[se=0]+1)))&&(gt=I(gt,Se,Z),It=I(It,Se,Z),rt=gt.length,it=It.length),Rt=rt,Xe=(Ke=It.slice(0,rt)).length;Xe<rt;Ke[Xe++]=0);Lt=gt.slice(),Lt=[0].concat(Lt),st=gt[0],gt[1]>=Z/2&&st++;do{if(Se=0,(ue=D(gt,Ke,rt,Xe))<0){if(nt=Ke[0],rt!=Xe&&(nt=nt*Z+(Ke[1]||0)),1<(Se=u(nt/st)))for(Z<=Se&&(Se=Z-1),qe=(Me=I(gt,Se,Z)).length,Xe=Ke.length;D(Me,Ke,qe,Xe)==1;)Se--,U(Me,rt<qe?Lt:gt,qe,Z),qe=Me.length,ue=1;else Se==0&&(ue=Se=1),qe=(Me=gt.slice()).length;if(qe<Xe&&(Me=[0].concat(Me)),U(Ke,Me,Xe,Z),Xe=Ke.length,ue==-1)for(;D(gt,Ke,rt,Xe)<1;)Se++,U(Ke,rt<Xe?Lt:gt,Xe,Z),Xe=Ke.length}else ue===0&&(Se++,Ke=[0]);We[se++]=Se,Ke[0]?Ke[Xe++]=It[Rt]||0:(Ke=[It[Rt]],Xe=1)}while((Rt++<it||Ke[0]!=null)&&kt--);we=Ke[0]!=null,We[0]||We.splice(0,1)}if(Z==h){for(se=1,kt=We[0];10<=kt;kt/=10,se++);Ae(ke,le+(ke.e=se+K*d-1)+1,ee,we)}else ke.e=K,ke.r=+we;return ke}}(),pe=/^(-?)0([xbo])(?=\w[\w.]*$)/i,ne=/^([^.]+)\.$/,O=/^\.([^.]+)$/,y=/^-?(Infinity|NaN)$/,R=/^\s*\+(?=[\w.])|^\s+|\s+$/g,j=function(I,D,U,ae){var X,le=U?D:D.replace(R,"");if(y.test(le))I.s=isNaN(le)?null:le<0?-1:1,I.c=I.e=null;else{if(!U&&(le=le.replace(pe,function(ee,Z,ue){return X=(ue=ue.toLowerCase())=="x"?16:ue=="b"?2:8,ae&&ae!=X?ee:Z}),ae&&(X=ae,le=le.replace(ne,"$1").replace(O,"0.$1")),D!=le))return new ce(le,X);if(ce.DEBUG)throw Error(c+"Not a"+(ae?" base "+ae:"")+" number: "+D);I.c=I.e=I.s=null}},C.absoluteValue=C.abs=function(){var I=new ce(this);return I.s<0&&(I.s=1),I},C.comparedTo=function(I,D){return E(this,new ce(I,D))},C.decimalPlaces=C.dp=function(I,D){var U,ae,X;if(I!=null)return T(I,0,v),D==null?D=H:T(D,0,8),Ae(new ce(this),I+this.e+1,D);if(!(U=this.c))return null;if(ae=((X=U.length-1)-S(this.e/d))*d,X=U[X])for(;X%10==0;X/=10,ae--);return ae<0&&(ae=0),ae},C.dividedBy=C.div=function(I,D){return M(this,new ce(I,D),P,H)},C.dividedToIntegerBy=C.idiv=function(I,D){return M(this,new ce(I,D),0,1)},C.exponentiatedBy=C.pow=function(I,D){var U,ae,X,le,ee,Z,ue,K,se=this;if((I=new ce(I)).c&&!I.isInteger())throw Error(c+"Exponent not an integer: "+xe(I));if(D!=null&&(D=new ce(D)),ee=14<I.e,!se.c||!se.c[0]||se.c[0]==1&&!se.e&&se.c.length==1||!I.c||!I.c[0])return K=new ce(Math.pow(+xe(se),ee?2-N(I):+xe(I))),D?K.mod(D):K;if(Z=I.s<0,D){if(D.c?!D.c[0]:!D.s)return new ce(NaN);(ae=!Z&&se.isInteger()&&D.isInteger())&&(se=se.mod(D))}else{if(9<I.e&&(0<se.e||se.e<-1||(se.e==0?1<se.c[0]||ee&&24e7<=se.c[1]:se.c[0]<8e13||ee&&se.c[0]<=9999975e7)))return le=se.s<0&&N(I)?-0:0,-1<se.e&&(le=1/le),new ce(Z?1/le:le);ve&&(le=l(ve/d+2))}for(ue=ee?(U=new ce(.5),Z&&(I.s=1),N(I)):(X=Math.abs(+xe(I)))%2,K=new ce(A);;){if(ue){if(!(K=K.times(se)).c)break;le?K.c.length>le&&(K.c.length=le):ae&&(K=K.mod(D))}if(X){if((X=u(X/2))===0)break;ue=X%2}else if(Ae(I=I.times(U),I.e+1,1),14<I.e)ue=N(I);else{if((X=+xe(I))==0)break;ue=X%2}se=se.times(se),le?se.c&&se.c.length>le&&(se.c.length=le):ae&&(se=se.mod(D))}return ae?K:(Z&&(K=A.div(K)),D?K.mod(D):le?Ae(K,ve,H,void 0):K)},C.integerValue=function(I){var D=new ce(this);return I==null?I=H:T(I,0,8),Ae(D,D.e+1,I)},C.isEqualTo=C.eq=function(I,D){return E(this,new ce(I,D))===0},C.isFinite=function(){return!!this.c},C.isGreaterThan=C.gt=function(I,D){return 0<E(this,new ce(I,D))},C.isGreaterThanOrEqualTo=C.gte=function(I,D){return(D=E(this,new ce(I,D)))===1||D===0},C.isInteger=function(){return!!this.c&&S(this.e/d)>this.c.length-2},C.isLessThan=C.lt=function(I,D){return E(this,new ce(I,D))<0},C.isLessThanOrEqualTo=C.lte=function(I,D){return(D=E(this,new ce(I,D)))===-1||D===0},C.isNaN=function(){return!this.s},C.isNegative=function(){return this.s<0},C.isPositive=function(){return 0<this.s},C.isZero=function(){return!!this.c&&this.c[0]==0},C.minus=function(I,D){var U,ae,X,le,ee=this,Z=ee.s;if(D=(I=new ce(I,D)).s,!Z||!D)return new ce(NaN);if(Z!=D)return I.s=-D,ee.plus(I);var ue=ee.e/d,K=I.e/d,se=ee.c,we=I.c;if(!ue||!K){if(!se||!we)return se?(I.s=-D,I):new ce(we?ee:NaN);if(!se[0]||!we[0])return we[0]?(I.s=-D,I):new ce(se[0]?ee:H==3?-0:0)}if(ue=S(ue),K=S(K),se=se.slice(),Z=ue-K){for((X=(le=Z<0)?(Z=-Z,se):(K=ue,we)).reverse(),D=Z;D--;X.push(0));X.reverse()}else for(ae=(le=(Z=se.length)<(D=we.length))?Z:D,Z=D=0;D<ae;D++)if(se[D]!=we[D]){le=se[D]<we[D];break}if(le&&(X=se,se=we,we=X,I.s=-I.s),0<(D=(ae=we.length)-(U=se.length)))for(;D--;se[U++]=0);for(D=h-1;Z<ae;){if(se[--ae]<we[ae]){for(U=ae;U&&!se[--U];se[U]=D);--se[U],se[ae]+=h}se[ae]-=we[ae]}for(;se[0]==0;se.splice(0,1),--K);return se[0]?Oe(I,se,K):(I.s=H==3?-1:1,I.c=[I.e=0],I)},C.modulo=C.mod=function(I,D){var U,ae,X=this;return I=new ce(I,D),!X.c||!I.s||I.c&&!I.c[0]?new ce(NaN):!I.c||X.c&&!X.c[0]?new ce(X):(ge==9?(ae=I.s,I.s=1,U=M(X,I,0,3),I.s=ae,U.s*=ae):U=M(X,I,0,ge),(I=X.minus(U.times(I))).c[0]||ge!=1||(I.s=X.s),I)},C.multipliedBy=C.times=function(I,D){var U,ae,X,le,ee,Z,ue,K,se,we,Se,Me,qe,ke,We,Ke=this,Xe=Ke.c,nt=(I=new ce(I,D)).c;if(!(Xe&&nt&&Xe[0]&&nt[0]))return!Ke.s||!I.s||Xe&&!Xe[0]&&!nt||nt&&!nt[0]&&!Xe?I.c=I.e=I.s=null:(I.s*=Ke.s,Xe&&nt?(I.c=[0],I.e=0):I.c=I.e=null),I;for(ae=S(Ke.e/d)+S(I.e/d),I.s*=Ke.s,(ue=Xe.length)<(we=nt.length)&&(qe=Xe,Xe=nt,nt=qe,X=ue,ue=we,we=X),X=ue+we,qe=[];X--;qe.push(0));for(ke=h,We=g,X=we;0<=--X;){for(U=0,Se=nt[X]%We,Me=nt[X]/We|0,le=X+(ee=ue);X<le;)U=((K=Se*(K=Xe[--ee]%We)+(Z=Me*K+(se=Xe[ee]/We|0)*Se)%We*We+qe[le]+U)/ke|0)+(Z/We|0)+Me*se,qe[le--]=K%ke;qe[le]=U}return U?++ae:qe.splice(0,1),Oe(I,qe,ae)},C.negated=function(){var I=new ce(this);return I.s=-I.s||null,I},C.plus=function(I,D){var U,ae=this,X=ae.s;if(D=(I=new ce(I,D)).s,!X||!D)return new ce(NaN);if(X!=D)return I.s=-D,ae.minus(I);var le=ae.e/d,ee=I.e/d,Z=ae.c,ue=I.c;if(!le||!ee){if(!Z||!ue)return new ce(X/0);if(!Z[0]||!ue[0])return ue[0]?I:new ce(Z[0]?ae:0*X)}if(le=S(le),ee=S(ee),Z=Z.slice(),X=le-ee){for((U=0<X?(ee=le,ue):(X=-X,Z)).reverse();X--;U.push(0));U.reverse()}for((X=Z.length)-(D=ue.length)<0&&(U=ue,ue=Z,Z=U,D=X),X=0;D;)X=(Z[--D]=Z[D]+ue[D]+X)/h|0,Z[D]=h===Z[D]?0:Z[D]%h;return X&&(Z=[X].concat(Z),++ee),Oe(I,Z,ee)},C.precision=C.sd=function(I,D){var U,ae,X;if(I!=null&&I!==!!I)return T(I,1,v),D==null?D=H:T(D,0,8),Ae(new ce(this),I,D);if(!(U=this.c))return null;if(ae=(X=U.length-1)*d+1,X=U[X]){for(;X%10==0;X/=10,ae--);for(X=U[0];10<=X;X/=10,ae++);}return I&&this.e+1>ae&&(ae=this.e+1),ae},C.shiftedBy=function(I){return T(I,-p,p),this.times("1e"+I)},C.squareRoot=C.sqrt=function(){var I,D,U,ae,X,le=this,ee=le.c,Z=le.s,ue=le.e,K=P+4,se=new ce("0.5");if(Z!==1||!ee||!ee[0])return new ce(!Z||Z<0&&(!ee||ee[0])?NaN:ee?le:1/0);if((U=(Z=Math.sqrt(+xe(le)))==0||Z==1/0?(((D=b(ee)).length+ue)%2==0&&(D+="0"),Z=Math.sqrt(+D),ue=S((ue+1)/2)-(ue<0||ue%2),new ce(D=Z==1/0?"1e"+ue:(D=Z.toExponential()).slice(0,D.indexOf("e")+1)+ue)):new ce(Z+"")).c[0]){for((Z=(ue=U.e)+K)<3&&(Z=0);;)if(X=U,U=se.times(X.plus(M(le,X,K,1))),b(X.c).slice(0,Z)===(D=b(U.c)).slice(0,Z)){if(U.e<ue&&--Z,(D=D.slice(Z-3,Z+1))!="9999"&&(ae||D!="4999")){+D&&(+D.slice(1)||D.charAt(0)!="5")||(Ae(U,U.e+P+2,1),I=!U.times(U).eq(le));break}if(!ae&&(Ae(X,X.e+P+2,0),X.times(X).eq(le))){U=X;break}K+=4,Z+=4,ae=1}}return Ae(U,U.e+P+1,H,I)},C.toExponential=function(I,D){return I!=null&&(T(I,0,v),I++),_e(this,I,D,1)},C.toFixed=function(I,D){return I!=null&&(T(I,0,v),I=I+this.e+1),_e(this,I,D)},C.toFormat=function(I,D,U){var ae;if(U==null)I!=null&&D&&typeof D=="object"?(U=D,D=null):I&&typeof I=="object"?(U=I,I=D=null):U=ie;else if(typeof U!="object")throw Error(c+"Argument not an object: "+U);if(ae=this.toFixed(I,D),this.c){var X,le=ae.split("."),ee=+U.groupSize,Z=+U.secondaryGroupSize,ue=U.groupSeparator||"",K=le[0],se=le[1],we=this.s<0,Se=we?K.slice(1):K,Me=Se.length;if(Z&&(X=ee,ee=Z,Me-=Z=X),0<ee&&0<Me){for(X=Me%ee||ee,K=Se.substr(0,X);X<Me;X+=ee)K+=ue+Se.substr(X,ee);0<Z&&(K+=ue+Se.slice(X)),we&&(K="-"+K)}ae=se?K+(U.decimalSeparator||"")+((Z=+U.fractionGroupSize)?se.replace(new RegExp("\\d{"+Z+"}\\B","g"),"$&"+(U.fractionGroupSeparator||"")):se):K}return(U.prefix||"")+ae+(U.suffix||"")},C.toFraction=function(I){var D,U,ae,X,le,ee,Z,ue,K,se,we,Se,Me=this,qe=Me.c;if(I!=null&&(!(Z=new ce(I)).isInteger()&&(Z.c||Z.s!==1)||Z.lt(A)))throw Error(c+"Argument "+(Z.isInteger()?"out of range: ":"not an integer: ")+xe(Z));if(!qe)return new ce(Me);for(D=new ce(A),K=U=new ce(A),ae=ue=new ce(A),Se=b(qe),le=D.e=Se.length-Me.e-1,D.c[0]=m[(ee=le%d)<0?d+ee:ee],I=!I||0<Z.comparedTo(D)?0<le?D:K:Z,ee=me,me=1/0,Z=new ce(Se),ue.c[0]=0;se=M(Z,D,0,1),(X=U.plus(se.times(ae))).comparedTo(I)!=1;)U=ae,ae=X,K=ue.plus(se.times(X=K)),ue=X,D=Z.minus(se.times(X=D)),Z=X;return X=M(I.minus(U),ae,0,1),ue=ue.plus(X.times(K)),U=U.plus(X.times(ae)),ue.s=K.s=Me.s,we=M(K,ae,le*=2,H).minus(Me).abs().comparedTo(M(ue,U,le,H).minus(Me).abs())<1?[K,ae]:[ue,U],me=ee,we},C.toNumber=function(){return+xe(this)},C.toPrecision=function(I,D){return I!=null&&T(I,1,v),_e(this,I,D,2)},C.toString=function(I){var D,U=this,ae=U.s,X=U.e;return X===null?ae?(D="Infinity",ae<0&&(D="-"+D)):D="NaN":(D=I==null?X<=Y||z<=X?L(b(U.c),X):V(b(U.c),X,"0"):I===10?V(b((U=Ae(new ce(U),P+X+1,H)).c),U.e,"0"):(T(I,2,be.length,"Base"),G(V(b(U.c),X,"0"),10,I,ae,!0)),ae<0&&U.c[0]&&(D="-"+D)),D},C.valueOf=C.toJSON=function(){return xe(this)},C._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(C[Symbol.toStringTag]="BigNumber",C[Symbol.for("nodejs.util.inspect.custom")]=C.valueOf),k!=null&&ce.set(k),ce}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=a)})(this)},{}],2:[function(r,n,i){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var a=o%10;return~~(o%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,i){function o(S,b){return function(E){if(Array.isArray(E))return E}(S)||function(E,T){var N=[],L=!0,V=!1,B=void 0;try{for(var k,M=E[Symbol.iterator]();!(L=(k=M.next()).done)&&(N.push(k.value),!T||N.length!==T);L=!0);}catch(G){V=!0,B=G}finally{try{L||M.return==null||M.return()}finally{if(V)throw B}}return N}(S,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),s=r("./validating"),l=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},f={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(S){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},E=2<arguments.length?arguments[2]:void 0;if(typeof b=="string"&&(b=l.parseFormat(b)),!s.validateFormat(b))return"ERROR: invalid format";var T=b.prefix||"",N=b.postfix||"",L=function(V,B,k){switch(B.output){case"currency":return B=v(B,a.currentCurrencyDefaultFormat()),function(be,ce,_e){var Ie=_e.currentCurrency(),Oe=Object.assign({},f,ce),Ae=void 0,xe="",I=!!Oe.totalLength||!!Oe.forceAverage||Oe.average,D=ce.currencyPosition||Ie.position,U=ce.currencySymbol||Ie.symbol;Oe.spaceSeparated&&(xe=" "),D==="infix"&&(Ae=xe+U+xe);var ae=g({instance:be,providedFormat:ce,state:_e,decimalSeparator:Ae});return D==="prefix"&&(ae=be._value<0&&Oe.negative==="sign"?"-".concat(xe).concat(U).concat(ae.slice(1)):U+xe+ae),D&&D!=="postfix"||(ae=ae+(xe=I?"":xe)+U),ae}(V,B,a);case"percent":return B=v(B,a.currentPercentageDefaultFormat()),function(be,ce,_e,Ie){var Oe=ce.prefixSymbol,Ae=g({instance:Ie(100*be._value),providedFormat:ce,state:_e}),xe=Object.assign({},f,ce);return Oe?"%".concat(xe.spaceSeparated?" ":"").concat(Ae):"".concat(Ae).concat(xe.spaceSeparated?" ":"","%")}(V,B,a,k);case"byte":return B=v(B,a.currentByteDefaultFormat()),A=V,H=a,Y=k,z=(P=B).base||"binary",oe=c[z],me=d(A._value,oe.suffixes,oe.scale),re=me.value,ge=me.suffix,ve=g({instance:Y(re),providedFormat:P,state:H,defaults:H.currentByteDefaultFormat()}),ie=H.currentAbbreviations(),"".concat(ve).concat(ie.spaced?" ":"").concat(ge);case"time":return B=v(B,a.currentTimeDefaultFormat()),O=V,y=Math.floor(O._value/60/60),R=Math.floor((O._value-60*y*60)/60),C=Math.round(O._value-60*y*60-60*R),"".concat(y,":").concat(R<10?"0":"").concat(R,":").concat(C<10?"0":"").concat(C);case"ordinal":return B=v(B,a.currentOrdinalDefaultFormat()),M=V,G=B,q=(j=a).currentOrdinal(),te=Object.assign({},f,G),pe=g({instance:M,providedFormat:G,state:j}),ne=q(M._value),"".concat(pe).concat(te.spaceSeparated?" ":"").concat(ne);case"number":default:return g({instance:V,providedFormat:B,numbro:k})}var M,G,j,q,te,pe,ne,O,y,R,C,A,P,H,Y,z,oe,me,re,ge,ve,ie}(S,b,E);return L=(L=T+L)+N}function d(S,b,E){var T=b[0],N=Math.abs(S);if(E<=N){for(var L=1;L<b.length;++L){var V=Math.pow(E,L),B=Math.pow(E,L+1);if(V<=N&&N<B){T=b[L],S/=V;break}}T===b[0]&&(S/=Math.pow(E,b.length-1),T=b[b.length-1])}return{value:S,suffix:T}}function p(S){for(var b="",E=0;E<S;E++)b+="0";return b}function m(S,b){return S.toString().indexOf("e")!==-1?function(E,T){var N=E.toString(),L=o(N.split("e"),2),V=L[0],B=L[1],k=o(V.split("."),2),M=k[0],G=k[1],j=G===void 0?"":G;if(0<+B)N=M+j+p(B-j.length);else{var q=".";q=+M<0?"-0".concat(q):"0".concat(q);var te=(p(-B-1)+Math.abs(M)+j).substr(0,T);te.length<T&&(te+=p(T-te.length)),N=q+te}return 0<+B&&0<T&&(N+=".".concat(p(T))),N}(S,b):(Math.round(+"".concat(S,"e+").concat(b))/Math.pow(10,b)).toFixed(b)}function g(S){var b=S.instance,E=S.providedFormat,T=S.state,N=T===void 0?a:T,L=S.decimalSeparator,V=S.defaults,B=V===void 0?N.currentDefaults():V,k=b._value;if(k===0&&N.hasZeroFormat())return N.getZeroFormat();if(!isFinite(k))return k.toString();var M,G,j,q,te,pe,ne,O,y=Object.assign({},f,B,E),R=y.totalLength,C=R?0:y.characteristic,A=y.optionalCharacteristic,P=y.forceAverage,H=!!R||!!P||y.average,Y=R?-1:H&&E.mantissa===void 0?0:y.mantissa,z=!R&&(E.optionalMantissa===void 0?Y===-1:y.optionalMantissa),oe=y.trimMantissa,me=y.thousandSeparated,re=y.spaceSeparated,ge=y.negative,ve=y.forceSign,ie=y.exponential,be="";if(H){var ce=function(I){var D=I.value,U=I.forceAverage,ae=I.abbreviations,X=I.spaceSeparated,le=X!==void 0&&X,ee=I.totalLength,Z=ee===void 0?0:ee,ue="",K=Math.abs(D),se=-1;if(K>=Math.pow(10,12)&&!U||U==="trillion"?(ue=ae.trillion,D/=Math.pow(10,12)):K<Math.pow(10,12)&&K>=Math.pow(10,9)&&!U||U==="billion"?(ue=ae.billion,D/=Math.pow(10,9)):K<Math.pow(10,9)&&K>=Math.pow(10,6)&&!U||U==="million"?(ue=ae.million,D/=Math.pow(10,6)):(K<Math.pow(10,6)&&K>=Math.pow(10,3)&&!U||U==="thousand")&&(ue=ae.thousand,D/=Math.pow(10,3)),ue&&(ue=(le?" ":"")+ue),Z){var we=D.toString().split(".")[0];se=Math.max(Z-we.length,0)}return{value:D,abbreviation:ue,mantissaPrecision:se}}({value:k,forceAverage:P,abbreviations:N.currentAbbreviations(),spaceSeparated:re,totalLength:R});k=ce.value,be+=ce.abbreviation,R&&(Y=ce.mantissaPrecision)}if(ie){var _e=(G=(M={value:k,characteristicPrecision:C}).value,j=M.characteristicPrecision,q=j===void 0?0:j,te=o(G.toExponential().split("e"),2),pe=te[0],ne=te[1],O=+pe,q&&1<q&&(O*=Math.pow(10,q-1),ne=0<=(ne=+ne-(q-1))?"+".concat(ne):ne),{value:O,abbreviation:"e".concat(ne)});k=_e.value,be=_e.abbreviation+be}var Ie,Oe,Ae,xe=function(I,D,U,ae,X){if(ae===-1)return I;var le=m(D,ae),ee=o(le.toString().split("."),2),Z=ee[0],ue=ee[1],K=ue===void 0?"":ue;if(K.match(/^0+$/)&&(U||X))return Z;var se=K.match(/0+$/);return X&&se?"".concat(Z,".").concat(K.toString().slice(0,se.index)):le.toString()}(k.toString(),k,z,Y,oe);return xe=function(I,D,U,ae,X){var le=ae.currentDelimiters(),ee=le.thousands;X=X||le.decimal;var Z=le.thousandsSize||3,ue=I.toString(),K=ue.split(".")[0],se=ue.split(".")[1];return U&&(D<0&&(K=K.slice(1)),function(we,Se){for(var Me=[],qe=0,ke=we;0<ke;ke--)qe===Se&&(Me.unshift(ke),qe=0),qe++;return Me}(K.length,Z).forEach(function(we,Se){K=K.slice(0,we+Se)+ee+K.slice(we+Se)}),D<0&&(K="-".concat(K))),ue=se?K+X+se:K}(xe=function(I,D,U,ae){var X=I,le=o(X.toString().split("."),2),ee=le[0],Z=le[1];if(ee.match(/^-?0$/)&&U)return Z?"".concat(ee.replace("0",""),".").concat(Z):ee.replace("0","");if(ee.length<ae)for(var ue=ae-ee.length,K=0;K<ue;K++)X="0".concat(X);return X.toString()}(xe,0,A,C),k,me,N,L),(H||ie)&&(xe=xe+be),(ve||k<0)&&(Ie=xe,Ae=ge,xe=(Oe=k)===0?Ie:+Ie==0?Ie.replace("-",""):0<Oe?"+".concat(Ie):Ae==="sign"?Ie:"(".concat(Ie.replace("-",""),")")),xe}function v(S,b){if(!S)return b;var E=Object.keys(S);return E.length===1&&E[0]==="output"?b:S}n.exports=function(S){return{format:function(){for(var b=arguments.length,E=new Array(b),T=0;T<b;T++)E[T]=arguments[T];return h.apply(void 0,E.concat([S]))},getByteUnit:function(){for(var b=arguments.length,E=new Array(b),T=0;T<b;T++)E[T]=arguments[T];return function(N){var L=c.general;return d(N._value,L.suffixes,L.scale).suffix}.apply(void 0,E.concat([S]))},getBinaryByteUnit:function(){for(var b=arguments.length,E=new Array(b),T=0;T<b;T++)E[T]=arguments[T];return function(N){var L=c.binary;return d(N._value,L.suffixes,L.scale).suffix}.apply(void 0,E.concat([S]))},getDecimalByteUnit:function(){for(var b=arguments.length,E=new Array(b),T=0;T<b;T++)E[T]=arguments[T];return function(N){var L=c.decimal;return d(N._value,L.suffixes,L.scale).suffix}.apply(void 0,E.concat([S]))},formatOrDefault:v}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,i){var o=r("./en-US"),a=r("./validating"),s=r("./parsing"),l={},u=void 0,c={},f=null,h={};function d(m){u=m}function p(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return p().currency},l.currentAbbreviations=function(){return p().abbreviations},l.currentDelimiters=function(){return p().delimiters},l.currentOrdinal=function(){return p().ordinal},l.currentDefaults=function(){return Object.assign({},p().defaults,h)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().timeFormat)},l.setDefaults=function(m){m=s.parseFormat(m),a.validateFormat(m)&&(h=m)},l.getZeroFormat=function(){return f},l.setZeroFormat=function(m){return f=typeof m=="string"?m:null},l.hasZeroFormat=function(){return f!==null},l.languageData=function(m){if(m){if(c[m])return c[m];throw new Error('Unknown tag "'.concat(m,'"'))}return p()},l.registerLanguage=function(m){var g=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(m))throw new Error("Invalid language data");c[m.languageTag]=m,g&&d(m.languageTag)},l.setLanguage=function(m){var g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[m]){var v=m.split("-")[0],S=Object.keys(c).find(function(b){return b.split("-")[0]===v});return c[S]?void d(S):void d(g)}d(m)},l.registerLanguage(o),u=o.languageTag,n.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,i){n.exports=function(o){return{loadLanguagesInNode:function(a){return s=o,void a.forEach(function(l){var u=void 0;try{u=r("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&s.registerLanguage(u)});var s}}}},{}],6:[function(r,n,i){var o=r("bignumber.js");function a(s,l,u){var c=new o(s._value),f=l;return u.isNumbro(l)&&(f=l._value),f=new o(f),s._value=c.minus(f).toNumber(),s}n.exports=function(s){return{add:function(l,u){return f=u,h=s,d=new o((c=l)._value),p=f,h.isNumbro(f)&&(p=f._value),p=new o(p),c._value=d.plus(p).toNumber(),c;var c,f,h,d,p},subtract:function(l,u){return a(l,u,s)},multiply:function(l,u){return f=u,h=s,d=new o((c=l)._value),p=f,h.isNumbro(f)&&(p=f._value),p=new o(p),c._value=d.times(p).toNumber(),c;var c,f,h,d,p},divide:function(l,u){return f=u,h=s,d=new o((c=l)._value),p=f,h.isNumbro(f)&&(p=f._value),p=new o(p),c._value=d.dividedBy(p).toNumber(),c;var c,f,h,d,p},set:function(l,u){return c=l,h=f=u,s.isNumbro(f)&&(h=f._value),c._value=h,c;var c,f,h},difference:function(l,u){return c=u,a(h=(f=s)(l._value),c,f),Math.abs(h._value);var c,f,h}}}},{"bignumber.js":1}],7:[function(r,n,i){function o(g,v){for(var S=0;S<v.length;S++){var b=v[S];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}var a=r("./globalState"),s=r("./validating"),l=r("./loading")(m),u=r("./unformatting"),c=r("./formatting")(m),f=r("./manipulating")(m),h=r("./parsing"),d=function(){function g(b){(function(E,T){if(!(E instanceof T))throw new TypeError("Cannot call a class as a function")})(this,g),this._value=b}var v,S;return v=g,(S=[{key:"clone",value:function(){return m(this._value)}},{key:"format",value:function(){var b=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,b)}},{key:"formatCurrency",value:function(b){return typeof b=="string"&&(b=h.parseFormat(b)),(b=c.formatOrDefault(b,a.currentCurrencyDefaultFormat())).output="currency",c.format(this,b)}},{key:"formatTime",value:function(){var b=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return b.output="time",c.format(this,b)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(b){return f.difference(this,b)}},{key:"add",value:function(b){return f.add(this,b)}},{key:"subtract",value:function(b){return f.subtract(this,b)}},{key:"multiply",value:function(b){return f.multiply(this,b)}},{key:"divide",value:function(b){return f.divide(this,b)}},{key:"set",value:function(b){return f.set(this,p(b))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(v.prototype,S),g}();function p(g){var v=g;return m.isNumbro(g)?v=g._value:typeof g=="string"?v=m.unformat(g):isNaN(g)&&(v=NaN),v}function m(g){return new d(p(g))}m.version="2.1.2",m.isNumbro=function(g){return g instanceof d},m.language=a.currentLanguage,m.registerLanguage=a.registerLanguage,m.setLanguage=a.setLanguage,m.languages=a.languages,m.languageData=a.languageData,m.zeroFormat=a.setZeroFormat,m.defaultFormat=a.currentDefaults,m.setDefaults=a.setDefaults,m.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,m.validate=s.validate,m.loadLanguagesInNode=l.loadLanguagesInNode,m.unformat=u.unformat,n.exports=m},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,i){n.exports={parseFormat:function(o){var a,s,l,u,c,f,h,d,p,m,g,v,S,b,E,T,N,L,V,B,k=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(s=k,o=(l=(a=o).match(/^{([^}]*)}/))?(s.prefix=l[1],a.slice(l[0].length)):a,c=k,function(M,G){if(M.indexOf("$")===-1){if(M.indexOf("%")===-1)return M.indexOf("bd")!==-1?(G.output="byte",G.base="general"):M.indexOf("b")!==-1?(G.output="byte",G.base="binary"):M.indexOf("d")!==-1?(G.output="byte",G.base="decimal"):M.indexOf(":")===-1?M.indexOf("o")!==-1&&(G.output="ordinal"):G.output="time";G.output="percent"}else G.output="currency"}(o=(f=(u=o).match(/{([^}]*)}$/))?(c.postfix=f[1],u.slice(0,-f[0].length)):u,k),h=k,(d=o.match(/[1-9]+[0-9]*/))&&(h.totalLength=+d[0]),p=k,(m=o.split(".")[0].match(/0+/))&&(p.characteristic=m[0].length),function(M,G){if(M.indexOf(".")!==-1){var j=M.split(".")[0];G.optionalCharacteristic=j.indexOf("0")===-1}}(o,k),g=k,o.indexOf("a")!==-1&&(g.average=!0),S=k,(v=o).indexOf("K")!==-1?S.forceAverage="thousand":v.indexOf("M")!==-1?S.forceAverage="million":v.indexOf("B")!==-1?S.forceAverage="billion":v.indexOf("T")!==-1&&(S.forceAverage="trillion"),function(M,G){var j=M.split(".")[1];if(j){var q=j.match(/0+/);q&&(G.mantissa=q[0].length)}}(o,k),E=k,(b=o).match(/\[\.]/)?E.optionalMantissa=!0:b.match(/\./)&&(E.optionalMantissa=!1),T=k,o.indexOf(",")!==-1&&(T.thousandSeparated=!0),N=k,o.indexOf(" ")!==-1&&(N.spaceSeparated=!0),V=k,(L=o).match(/^\+?\([^)]*\)$/)&&(V.negative="parenthesis"),L.match(/^\+?-/)&&(V.negative="sign"),B=k,o.match(/^\+/)&&(B.forceSign=!0),k)}}},{}],9:[function(r,n,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",f=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,p=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===h?0:function m(g,v){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",b=3<arguments.length?arguments[3]:void 0,E=4<arguments.length?arguments[4]:void 0,T=5<arguments.length?arguments[5]:void 0,N=6<arguments.length?arguments[6]:void 0;if(!isNaN(+g))return+g;var L="",V=g.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(V!==g)return-1*m(V,v,S,b,E,T,N);for(var B=0;B<o.length;B++){var k=o[B];if((L=g.replace(k.key,""))!==g)return m(L,v,S,b,E,T,N)*k.factor}if((L=g.replace("%",""))!==g)return m(L,v,S,b,E,T,N)/100;var M=parseFloat(g);if(!isNaN(M)){var G=b(M);if(G&&G!=="."&&(L=g.replace(new RegExp("".concat(a(G),"$")),""))!==g)return m(L,v,S,b,E,T,N);var j={};Object.keys(T).forEach(function(R){j[T[R]]=R});for(var q=Object.keys(j).sort().reverse(),te=q.length,pe=0;pe<te;pe++){var ne=q[pe],O=j[ne];if((L=g.replace(ne,""))!==g){var y=void 0;switch(O){case"thousand":y=Math.pow(10,3);break;case"million":y=Math.pow(10,6);break;case"billion":y=Math.pow(10,9);break;case"trillion":y=Math.pow(10,12)}return m(L,v,S,b,E,T,N)*y}}}}(function(m,g){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=m.replace(v,"");return S=(S=S.replace(new RegExp("([0-9])".concat(a(g.thousands),"([0-9])"),"g"),"$1$2")).replace(g.decimal,".")}(l,u,c),u,c,f,h,d,p)}n.exports={unformat:function(l,u){var c,f,h,d=r("./globalState"),p=d.currentDelimiters(),m=d.currentCurrency().symbol,g=d.currentOrdinal(),v=d.getZeroFormat(),S=d.currentAbbreviations(),b=void 0;if(typeof l=="string")b=function(E,T){if(!E.indexOf(":")||T.thousands===":")return!1;var N=E.split(":");if(N.length!==3)return!1;var L=+N[0],V=+N[1],B=+N[2];return!isNaN(L)&&!isNaN(V)&&!isNaN(B)}(l,p)?(c=l.split(":"),f=+c[0],h=+c[1],+c[2]+60*h+3600*f):s(l,p,m,g,v,S,u);else{if(typeof l!="number")return;b=l}if(b!==void 0)return b}}},{"./globalState":4}],10:[function(r,n,i){function o(p){return function(m){if(Array.isArray(m)){for(var g=0,v=new Array(m.length);g<m.length;g++)v[g]=m[g];return v}}(p)||function(m){if(Symbol.iterator in Object(m)||Object.prototype.toString.call(m)==="[object Arguments]")return Array.from(m)}(p)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(p)}var s=r("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(p,m){return m.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(p){return p.output==="byte"}},characteristic:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(p){return 0<=p},message:"value must be positive"},{restriction:function(p,m){return!m.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(p,m){return m.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(p){return p.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function f(p){return!!s.unformat(p)}function h(p,m,g){var v=3<arguments.length&&arguments[3]!==void 0&&arguments[3],S=Object.keys(p).map(function(b){if(!m[b])return console.error("".concat(g," Invalid key: ").concat(b)),!1;var E=p[b],T=m[b];if(typeof T=="string"&&(T={type:T}),T.type==="format"){if(!h(E,u,"[Validate ".concat(b,"]"),!0))return!1}else if(a(E)!==T.type)return console.error("".concat(g," ").concat(b,' type mismatched: "').concat(T.type,'" expected, "').concat(a(E),'" provided')),!1;if(T.restrictions&&T.restrictions.length)for(var N=T.restrictions.length,L=0;L<N;L++){var V=T.restrictions[L],B=V.restriction,k=V.message;if(!B(E,p))return console.error("".concat(g," ").concat(b," invalid value: ").concat(k)),!1}return T.restriction&&!T.restriction(E,p)?(console.error("".concat(g," ").concat(b," invalid value: ").concat(T.message)),!1):T.validValues&&T.validValues.indexOf(E)===-1?(console.error("".concat(g," ").concat(b," invalid value: must be among ").concat(JSON.stringify(T.validValues),', "').concat(E,'" provided')),!1):!(T.children&&!h(E,T.children,"[Validate ".concat(b,"]")))});return v||S.push.apply(S,o(Object.keys(m).map(function(b){var E=m[b];if(typeof E=="string"&&(E={type:E}),E.mandatory){var T=E.mandatory;if(typeof T=="function"&&(T=T(p)),T&&p[b]===void 0)return console.error("".concat(g,' Missing mandatory key "').concat(b,'"')),!1}return!0}))),S.reduce(function(b,E){return b&&E},!0)}function d(p){return h(p,u,"[Validate format]")}n.exports={validate:function(p,m){var g=f(p),v=d(m);return g&&v},validateFormat:d,validateInput:f,validateLanguage:function(p){return h(p,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(lq);const kl=lq.exports;var nEe="numeric";function i3(t,e,r,n,i,o,a){var s=o;if(zi(s)){var l=a.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,f=a.className||"",h=f.length?f.split(" "):[];if(typeof u<"u"&&!kl.languages()[u]){var d=u.replace("-",""),p=kl.allLanguages?kl.allLanguages[u]:kl[d];p&&kl.registerLanguage(p)}kl.setLanguage(u),s=kl(s).format(c||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),e.dir="ltr"}El(t,e,r,n,i,s,a)}i3.RENDERER_TYPE=nEe;var iEe="password";function o3(t,e,r,n,i,o,a){El.apply(this,[t,e,r,n,i,o,a]);var s=a.hashLength||e.innerHTML.length,l=a.hashSymbol||"*",u="";Ye(s-1,function(){u+=l}),Hp(e,u)}o3.RENDERER_TYPE=iEe;var oEe="time";function a3(t,e,r,n,i,o,a){El.apply(this,[t,e,r,n,i,o,a]),e.dir="ltr"}a3.RENDERER_TYPE=oEe;var M1=lo("renderers"),aEe=M1.register,sEe=M1.getItem,uq=M1.hasItem;M1.getNames;M1.getValues;function qk(t){if(typeof t=="function")return t;if(!uq(t))throw Error('No registered renderer found under "'.concat(t,'" name'));return sEe(t)}function Ma(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),aEe(t,e)}function lEe(){Ma(Up),Ma(I1),Ma(r3),Ma(t3),Ma(i3),Ma(o3),Ma(El),Ma(a3)}var uEe="autocomplete";function T6(t,e){var r=t;if(r==null&&(r=""),this.allowEmpty&&r===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,Xk(r,e)):Xk(r,e)(this.source):e(!0)}T6.VALIDATOR_TYPE=uEe;function Xk(t,e){var r=t;return function(n){for(var i=!1,o=0,a=n.length;o<a;o++)if(r===n[o]){i=!0;break}e(i)}}var cEe=Object.is||function(e,r){return e===r?e!==0||1/e===1/r:e!=e&&r!=r},fEe=en,hEe=h6,dEe=$r,pEe=No,mEe=bi,Qk=cEe,Zk=Gr,gEe=vc,yEe=d6;hEe("search",function(t,e,r){return[function(i){var o=mEe(this),a=pEe(i)?void 0:gEe(i,t);return a?fEe(a,i,o):new RegExp(i)[t](Zk(o))},function(n){var i=dEe(this),o=Zk(n),a=r(e,i,o);if(a.done)return a.value;var s=i.lastIndex;Qk(s,0)||(i.lastIndex=0);var l=yEe(i,o);return Qk(i.lastIndex,s)||(i.lastIndex=s),l===null?-1:l.index}]});function vEe(t){var e=new Date(t);return isNaN(new Date("".concat(t,"T00:00")).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}var bEe="date";function s3(t,e){var r=qK(rq,this.instance),n=t,i=!0;n==null&&(n="");var o=qt(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=qt(new Date(n)).isValid()||o;if(this.allowEmpty&&n===""&&(a=!0,o=!0),a||(i=!1),!a&&o&&(i=!0),a&&!o)if(this.correctFormat===!0){var s=wEe(n,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,s,"dateValidator"),i=!0}else i=!1;e(i)}s3.VALIDATOR_TYPE=bEe;function wEe(t,e){var r=qt(vEe(t)),n=qt(t,e),i=t.search(/[A-z]/g)>-1,o;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?o=r:o=n,o.format(e)}var SEe="numeric";function l3(t,e){var r=t;r==null&&(r=""),this.allowEmpty&&r===""?e(!0):e(r===""?!1:zi(t))}l3.VALIDATOR_TYPE=SEe;var REe=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],EEe="time";function u3(t,e){var r=this.timeFormat||"h:mm:ss a",n=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;var o=/^\d{1,2}$/.test(i);o&&(i+=":00");var a=qt(i,REe,!0).isValid()?qt(i):qt(i,r),s=a.isValid(),l=qt(i,r,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(s=!0,l=!0),s||(n=!1),!s&&l&&(n=!0),s&&!l)if(this.correctFormat===!0){var u=a.format(r),c=this.instance.toVisualRow(this.row),f=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,f,u,"timeValidator"),n=!0}else n=!1;e(n)}u3.VALIDATOR_TYPE=EEe;var N1=lo("validators"),CEe=N1.register,_Ee=N1.getItem,cq=N1.hasItem;N1.getNames;N1.getValues;function TEe(t){if(typeof t=="function")return t;if(!cq(t))throw Error('No registered validator found under "'.concat(t,'" name'));return _Ee(t)}function Bm(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),CEe(t,e)}function OEe(){Bm(T6),Bm(s3),Bm(l3),Bm(u3)}var AEe="autocomplete",xEe={CELL_TYPE:AEe,editor:J8,renderer:Up,validator:T6},IEe="checkbox",MEe={CELL_TYPE:IEe,editor:eq,renderer:r3},NEe="date",PEe={CELL_TYPE:NEe,editor:nq,renderer:Up,validator:s3},kEe="dropdown",$Ee={CELL_TYPE:kEe,editor:e3,renderer:Up,validator:T6},LEe="handsontable",DEe={CELL_TYPE:LEe,editor:Z8,renderer:Up},FEe="numeric",HEe={CELL_TYPE:FEe,editor:iq,renderer:i3,validator:l3,dataType:"number"},BEe="password",UEe={CELL_TYPE:BEe,editor:oq,renderer:o3,copyable:!1},VEe="text",fq={CELL_TYPE:VEe,editor:Cc,renderer:El},jEe="time",WEe={CELL_TYPE:jEe,editor:aq,renderer:a3,validator:u3},P1=lo("cellTypes"),zEe=P1.register,GEe=P1.getItem,hq=P1.hasItem;P1.getNames;P1.getValues;function YEe(t){if(!hq(t))throw Error('You declared cell type "'.concat(t,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return GEe(t)}function Yo(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);var r=e,n=r.editor,i=r.renderer,o=r.validator;n&&Oi(t,n),i&&Ma(t,i),o&&Bm(t,o),zEe(t,e)}function KEe(){Yo(xEe),Yo(MEe),Yo(PEe),Yo($Ee),Yo(DEe),Yo(HEe),Yo(UEe),Yo(fq),Yo(WEe)}var qEe=l6,XEe=ZG;qEe("WeakSet",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},XEe);function QEe(t){return eCe(t)||JEe(t)||dq(t)||ZEe()}function ZEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JEe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function eCe(t){if(Array.isArray(t))return HT(t)}function tCe(t,e){return iCe(t)||nCe(t,e)||dq(t,e)||rCe()}function rCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dq(t,e){if(!!t){if(typeof t=="string")return HT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HT(t,e)}}function HT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function nCe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function iCe(t){if(Array.isArray(t))return t}var BT="asc",oCe="desc",Jk=new Map([[BT,[-1,1]],[oCe,[1,-1]]]),aCe=function(e){return"The priority '".concat(e,"' is already declared in a map.")},sCe=function(e){return"The priority '".concat(e,"' is not a number.")};function lCe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.errorPriorityExists,r=t.errorPriorityNaN,n=new Map;e=sr(e)?e:aCe,r=sr(r)?r:sCe;function i(a,s){if(!zi(a))throw new Error(r(a));if(n.has(a))throw new Error(e(a));n.set(a,s)}function o(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:BT,s=Jk.get(a)||Jk.get(BT),l=tCe(s,2),u=l[0],c=l[1];return QEe(n).sort(function(f,h){return f[0]<h[0]?u:c}).map(function(f){return f[1]})}return{addItem:i,getItems:o}}function uCe(t){return hCe(t)||fCe(t)||pq(t)||cCe()}function cCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fCe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function hCe(t){if(Array.isArray(t))return UT(t)}function e$(t,e){return mCe(t)||pCe(t,e)||pq(t,e)||dCe()}function dCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pq(t,e){if(!!t){if(typeof t=="string")return UT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return UT(t,e)}}function UT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function pCe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function mCe(t){if(Array.isArray(t))return t}var gCe=function(e){return"The id '".concat(e,"' is already declared in a map.")};function O6(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.errorIdExists,r=new Map;e=sr(e)?e:gCe;function n(c,f){if(u(c))throw new Error(e(c));r.set(c,f)}function i(c){return r.delete(c)}function o(){r.clear()}function a(c){var f=l().find(function(p){var m=e$(p,2),g=m[0],v=m[1];return c===v?g:!1})||[null],h=e$(f,1),d=h[0];return d}function s(c){return r.get(c)}function l(){return uCe(r)}function u(c){return r.has(c)}return{addItem:n,clear:o,getId:a,getItem:s,getItems:l,hasItem:u,removeItem:i}}function yCe(t){return SCe(t)||wCe(t)||bCe(t)||vCe()}function vCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bCe(t,e){if(!!t){if(typeof t=="string")return VT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VT(t,e)}}function wCe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function SCe(t){if(Array.isArray(t))return VT(t)}function VT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var RCe=function(e){return"'".concat(e,"' value is already declared in a unique set.")};function ECe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.errorItemExists,r=new Set;e=sr(e)?e:RCe;function n(a){if(r.has(a))throw new Error(e(a));r.add(a)}function i(){return yCe(r)}function o(){r.clear()}return{addItem:n,clear:o,getItems:i}}function CCe(t,e){return OCe(t)||TCe(t,e)||mq(t,e)||_Ce()}function _Ce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TCe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function OCe(t){if(Array.isArray(t))return t}function t$(t){return ICe(t)||xCe(t)||mq(t)||ACe()}function ACe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mq(t,e){if(!!t){if(typeof t=="string")return jT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jT(t,e)}}function xCe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ICe(t){if(Array.isArray(t))return jT(t)}function jT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var c3=function(e){return'There is already registered "'.concat(e,'" plugin.')},MCe=function(e){return'There is already registered plugin on priority "'.concat(e,'".')},NCe=function(e){return'The priority "'.concat(e,'" is not a number.')},gq=lCe({errorPriorityExists:MCe,errorPriorityNaN:NCe}),yq=ECe({errorItemExists:c3}),WT=O6({errorIdExists:c3});function vq(){return[].concat(t$(gq.getItems()),t$(yq.getItems()))}function f3(t){var e=gs(t);return WT.getItem(e)}function PCe(t){return!!f3(t)}function Ht(t,e,r){var n=$Ce(t,e,r),i=CCe(n,3);t=i[0],e=i[1],r=i[2],f3(t)===void 0&&kCe(t,e,r)}function kCe(t,e,r){var n=gs(t);if(WT.hasItem(n))throw new Error(c3(n));r===void 0?yq.addItem(n):gq.addItem(r,n),WT.addItem(n,e)}function $Ce(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}function Fg(t){return Fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fg(t)}function LCe(t,e){return BCe(t)||HCe(t,e)||FCe(t,e)||DCe()}function DCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FCe(t,e){if(!!t){if(typeof t=="string")return r$(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return r$(t,e)}}function r$(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function HCe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function BCe(t){if(Array.isArray(t))return t}function UCe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jCe(n.key),n)}}function VCe(t,e,r){return e&&n$(t.prototype,e),r&&n$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function jCe(t){var e=WCe(t,"string");return Fg(e)==="symbol"?e:String(e)}function WCe(t,e){if(Fg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Fg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zCe(t,e){GCe(t,e),e.add(t)}function GCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YCe(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}var i$=new Map([["plugin",PCe],["cell-type",hq],["editor",KK],["renderer",uq],["validator",cq]]),KCe="base",$l=new WeakMap,IE=[],Lo=null,o$=new WeakSet,jt=function(){function t(e){var r=this;UCe(this,t),zCe(this,o$),Os(this,"hot",e,{writable:!1}),$l.set(this,{hooks:{}}),Lo=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return VCe(t,[{key:"init",value:function(){var r=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,i=Array.isArray(n)?n:[];if(i.length>0){var o=[];if(i.forEach(function(u){var c=u.split(":"),f=LCe(c,2),h=f[0],d=f[1];if(!i$.has(h))throw new Error('Unknown plugin dependency type "'.concat(h,'" was found.'));i$.get(h)(d)||o.push(" - ".concat(d," (").concat(h,")"))}),o.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(o.join(`
`),`
`)].join("");IE.push(a)}}Lo||(Lo=vq()),Lo.indexOf("UndoRedo")>=0&&Lo.splice(Lo.indexOf("UndoRedo"),1),Lo.indexOf(this.pluginName)>=0&&Lo.splice(Lo.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){r.isEnabled&&r.isEnabled()&&r.enablePlugin()});var s=Lo.length===0;if(s){if(IE.length>0){var l=["".concat(IE.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(l)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(r,n){$l.get(this).hooks[r]=$l.get(this).hooks[r]||[];var i=$l.get(this).hooks[r];this.hot.addHook(r,n),i.push(n),$l.get(this).hooks[r]=i}},{key:"removeHooks",value:function(r){var n=this;Q($l.get(this).hooks[r]||[],function(i){n.hot.removeHook(r,i)})}},{key:"clearHooks",value:function(){var r=this,n=$l.get(this).hooks;St(n,function(i,o){return r.removeHooks(o)}),n.length=0}},{key:"callOnPluginsReady",value:function(r){this.isPluginsReady?r():this.pluginsInitializedCallbacks.push(r)}},{key:"onAfterPluginsInitialized",value:function(){Q(this.pluginsInitializedCallbacks,function(r){return r()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(r){var n=YCe(this,o$,qCe).call(this,r);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(r))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var r=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),St(this,function(n,i){i!=="hot"&&(r[i]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return KCe}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),t}();function qCe(t){if(!t)return!1;var e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(var r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function Hg(t){return Hg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hg(t)}function XCe(t,e){return e_e(t)||JCe(t,e)||ZCe(t,e)||QCe()}function QCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZCe(t,e){if(!!t){if(typeof t=="string")return a$(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a$(t,e)}}function a$(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function JCe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function e_e(t){if(Array.isArray(t))return t}function t_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n_e(n.key),n)}}function r_e(t,e,r){return e&&s$(t.prototype,e),r&&s$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function n_e(t){var e=i_e(t,"string");return Hg(e)==="symbol"?e:String(e)}function i_e(t,e){if(Hg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Hg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var o_e=function(){function t(e){t_e(this,t),this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return r_e(t,[{key:"addRow",value:function(r,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={row:r};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"addColumnHeadersRow",value:function(r){var n=this.hot.getColHeader(0);if(n!=null){var i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}},{key:"addColumn",value:function(r,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={col:r};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(r)!==null&&this.hot.view.appendColHeader(r,this.table.th),this.table.tBody.appendChild(this.createCol(r)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"getHeights",value:function(r){this.injected||this.injectTable(),Q(this.rows,function(n){r(n.row,wr(n.table)-1)})}},{key:"getWidths",value:function(r){this.injected||this.injectTable(),Q(this.columns,function(n){var i=n.table.getBoundingClientRect(),o=i.width;r(n.col,Math.ceil(o))})}},{key:"setSettings",value:function(r){this.settings=r}},{key:"setSetting",value:function(r,n){this.settings||(this.settings={}),this.settings[r]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(r){return this.settings?this.settings[r]:null}},{key:"createColGroupsCol",value:function(){var r=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(i){Q(i.strings,function(o){n.appendChild(r.createColElement(o.col))})}),n}},{key:"createRow",value:function(r){var n=this,i=this.hot.rootDocument,o=i.createDocumentFragment(),a=i.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(r,a),o.appendChild(a)),this.samples.forEach(function(s){Q(s.strings,function(l){var u=l.col,c=n.hot.getCellMeta(r,u);c.col=u,c.row=r;var f=n.hot.getCellRenderer(c),h=i.createElement("td");h.setAttribute("ghost-table",1),f(n.hot,h,r,u,n.hot.colToProp(u),l.value,c),o.appendChild(h)})}),o}},{key:"appendColumnHeadersRow",value:function(){var r=this,n=this.hot.rootDocument,i=n.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");o.push([-1,a]),i.appendChild(a)}this.samples.forEach(function(s){Q(s.strings,function(l){var u=l.col,c=n.createElement("th");o.push([u,c]),i.appendChild(c)})}),this.table.tHead.appendChild(i),Q(o,function(s){var l=XCe(s,2),u=l[0],c=l[1];r.hot.view.appendColHeader(u,c)})}},{key:"createCol",value:function(r){var n=this,i=this.hot.rootDocument,o=i.createDocumentFragment();return this.samples.forEach(function(a){Q(a.strings,function(s){var l=s.row,u=n.hot.getCellMeta(l,r);u.col=r,u.row=l;var c=n.hot.getCellRenderer(u),f=i.createElement("td"),h=i.createElement("tr");f.setAttribute("ghost-table",1),c(n.hot,f,l,r,n.hot.colToProp(r),s.value,u),h.appendChild(f),o.appendChild(h)})}),o}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((r||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(r){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(r),"px"),n}},{key:"createTable",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),o=n.createElement("table"),a=n.createElement("thead"),s=n.createElement("tbody"),l=n.createElement("colgroup"),u=n.createElement("tr"),c=n.createElement("th");return this.isVertical()&&o.appendChild(l),this.isHorizontal()&&(u.appendChild(c),a.appendChild(u),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(a),this.isVertical()&&s.appendChild(u),o.appendChild(s),Re(o,r),i.appendChild(o),{fragment:i,table:o,tHead:a,tBody:s,colGroup:l,tr:u,th:c}}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),o=n.createElement("div"),a="htGhostTable htAutoSize ".concat(r.trim());return Re(o,a),i.appendChild(o),{fragment:i,container:o}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),t}();const bq=o_e;var a_e=tt,s_e=wi,wq=f1,l_e=dt,u_e=l_e(function(){wq(1)});a_e({target:"Object",stat:!0,forced:u_e},{keys:function(e){return wq(s_e(e))}});function Bg(t){return Bg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bg(t)}function c_e(t,e,r){return e=Sq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Sq(n.key),n)}}function h_e(t,e,r){return e&&l$(t.prototype,e),r&&l$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Sq(t){var e=d_e(t,"string");return Bg(e)==="symbol"?e:String(e)}function d_e(t,e){if(Bg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Bg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var p_e=function(){function t(e){f_e(this,t),this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}return h_e(t,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:t.SAMPLE_COUNT}},{key:"setSampleCount",value:function(r){this.customSampleCount=r}},{key:"setAllowDuplicates",value:function(r){this.allowDuplicates=r}},{key:"generateRowSamples",value:function(r,n){return this.generateSamples("row",n,r)}},{key:"generateColumnSamples",value:function(r,n){return this.generateSamples("col",n,r)}},{key:"generateSamples",value:function(r,n,i){var o=this,a=new Map,s=typeof i=="number"?{from:i,to:i}:i,l=s.from,u=s.to;return Ye(l,u,function(c){var f=o.generateSample(r,n,c);a.set(c,f)}),a}},{key:"generateSample",value:function(r,n,i){var o=this;if(r!=="row"&&r!=="col")throw new Error("Unsupported sample type");var a=new Map,s=r==="row"?"col":"row",l=[];return Ye(n.from,n.to,function(u){var c=r==="row"?o.dataFactory(i,u):o.dataFactory(u,i),f=c.value,h=c.bundleSeed,d=typeof h=="string"&&h.length>0,p;d?p=h:wt(f)?p="".concat(Object.keys(f).length):Array.isArray(f)?p="".concat(f.length):p="".concat(Vr(f).length),a.has(p)||a.set(p,{needed:o.getSampleCount(),strings:[]});var m=a.get(p);if(m.needed){var g=l.indexOf(f)>-1;(!g||o.allowDuplicates||d)&&(m.strings.push(c_e({value:f},s,u)),l.push(f),m.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),t}();const Rq=p_e;var eu=1,Dn=2;function Ug(t){return Ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ug(t)}function m_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,y_e(n.key),n)}}function g_e(t,e,r){return e&&u$(t.prototype,e),r&&u$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function y_e(t){var e=v_e(t,"string");return Ug(e)==="symbol"?e:String(e)}function v_e(t,e){if(Ug(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ug(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Uc=new WeakMap,b_e=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.viewportSize,n=e.scrollOffset,i=e.totalItems,o=e.itemSizeFn,a=e.overrideFn,s=e.calculationType,l=e.stretchMode,u=e.stretchingItemWidthFn,c=u===void 0?function(h){return h}:u,f=e.inlineStartOffset;m_e(this,t),Uc.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:i,columnWidthFn:o,overrideFn:a,calculationType:s,stretchingColumnWidthFn:c,inlineStartOffset:f}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return g_e(t,[{key:"calculate",value:function(){for(var r=0,n=!0,i=[],o,a=0,s=0,l=Uc.get(this),u=l.calculationType,c=l.overrideFn,f=l.scrollOffset,h=Math.max(l.scrollOffset,0),d=l.totalColumns,p=l.viewportWidth,m=h>0?p+1:p,g=0;g<d;g++)if(o=this._getColumnWidth(g),r<=h&&u!==Dn&&(this.startColumn=g,a=o),r>=h&&r+(u===Dn?o:0)<=h+m&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=g,a=o),this.endColumn=g),i.push(r),r+=o,s=o,u!==Dn&&(this.endColumn=g),r>=h+p){n=!1;break}var v=f+p-m,S=u===Dn?0:s,b=u===Dn?a:0;if(v<-1*l.inlineStartOffset||f>i.at(-1)+S||-1*l.scrollOffset-l.viewportWidth>-1*b?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var E=i[this.endColumn]+o-i[this.startColumn-1];if((E<=p||u!==Dn)&&(this.startColumn-=1),E>p)break}u===eu&&this.startColumn!==null&&c&&c(this),this.startPosition=i[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(r){if(this.stretch!=="none"){var n=r;this.totalTargetWidth=n;for(var i=Uc.get(this),o=i.totalColumns,a=0,s=0;s<o;s++){var l=this._getColumnWidth(s),u=i.stretchingColumnWidthFn(void 0,s);typeof u=="number"?n-=u:a+=l}var c=n-a;if(this.stretch==="all"&&c>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var f=this._getColumnWidth(o-1),h=c+f;this.stretchLastWidth=h>=0?h:f}}}},{key:"getStretchedColumnWidth",value:function(r,n){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(r,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(r)),i}},{key:"_getStretchedAllColumnWidth",value:function(r,n){var i=0,o=Uc.get(this),a=o.totalColumns;if(!this.stretchAllColumnsWidth[r]){var s=Math.round(n*this.stretchAllRatio),l=o.stretchingColumnWidthFn(s,r);l===void 0?this.stretchAllColumnsWidth[r]=s:this.stretchAllColumnsWidth[r]=isNaN(l)?this._getColumnWidth(r):l}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var u=0;u<this.stretchAllColumnsWidth.length;u++)i+=this.stretchAllColumnsWidth[u];i!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-i)}return this.stretchAllColumnsWidth[r]}},{key:"_getStretchedLastColumnWidth",value:function(r){var n=Uc.get(this),i=n.totalColumns;return r===i-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(r){var n=Uc.get(this).columnWidthFn(r);return isNaN(n)&&(n=t.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),t}();const h3=b_e;function Vg(t){return Vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vg(t)}function w_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,R_e(n.key),n)}}function S_e(t,e,r){return e&&c$(t.prototype,e),r&&c$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function R_e(t){var e=E_e(t,"string");return Vg(e)==="symbol"?e:String(e)}function E_e(t,e){if(Vg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Vg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var f$=new WeakMap,C_e=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.viewportSize,n=e.scrollOffset,i=e.totalItems,o=e.itemSizeFn,a=e.overrideFn,s=e.calculationType,l=e.scrollbarHeight;w_e(this,t),f$.set(this,{viewportHeight:r,scrollOffset:n,totalRows:i,rowHeightFn:o,overrideFn:a,calculationType:s,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return S_e(t,[{key:"calculate",value:function(){for(var r=f$.get(this),n=r.calculationType,i=r.overrideFn,o=r.rowHeightFn,a=r.scrollOffset,s=Math.max(r.scrollOffset,0),l=r.totalRows,u=r.viewportHeight,c=r.horizontalScrollbarHeight||0,f=0,h=!0,d=[],p,m=0,g=0,v=0;v<l;v++)if(p=o(v),isNaN(p)&&(p=t.DEFAULT_HEIGHT),f<=s&&n!==Dn&&(this.startRow=v,m=p),f>=s&&f+(n===Dn?p:0)<=s+u-c&&(this.startRow===null&&(this.startRow=v,m=p),this.endRow=v),d.push(f),f+=p,g=p,n!==Dn&&(this.endRow=v),f>=s+u-c){h=!1;break}var S=a+u-c,b=n===Dn?m:0,E=n===Dn?0:g;if(S<b||a>d.at(-1)+E?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===l-1&&h)for(this.startRow=this.endRow;this.startRow>0;){var T=d[this.endRow]+p-d[this.startRow-1];if((T<=u-c||n!==Dn)&&(this.startRow-=1),T>=u-c)break}n===eu&&this.startRow!==null&&i&&i(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),l<this.endRow&&(this.endRow=l-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),t}();const Eq=C_e;function jg(t){return jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jg(t)}function __e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Cq(n.key),n)}}function T_e(t,e,r){return e&&h$(t.prototype,e),r&&h$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function O_e(t,e,r){A_e(t,e),e.set(t,r)}function A_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function d$(t,e,r){return e=Cq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cq(t){var e=x_e(t,"string");return jg(e)==="symbol"?e:String(e)}function x_e(t,e){if(jg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(jg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function um(t,e){var r=_q(t,e,"get");return I_e(t,r)}function I_e(t,e){return e.get?e.get.call(t):e.value}function M_e(t,e,r){var n=_q(t,e,"set");return N_e(t,n,r),r}function _q(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function N_e(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Ll=new WeakMap,P_e=function(){function t(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;__e(this,t),d$(this,"row",null),d$(this,"col",null),O_e(this,Ll,{writable:!0,value:!1}),M_e(this,Ll,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}return T_e(t,[{key:"isValid",value:function(r){return!(this.row<0||this.col<0||this.row>=r.getSetting("totalRows")||this.col>=r.getSetting("totalColumns"))}},{key:"isEqual",value:function(r){return r===this?!0:this.row===r.row&&this.col===r.col}},{key:"isSouthEastOf",value:function(r){return this.row>=r.row&&(um(this,Ll)?this.col<=r.col:this.col>=r.col)}},{key:"isNorthWestOf",value:function(r){return this.row<=r.row&&(um(this,Ll)?this.col>=r.col:this.col<=r.col)}},{key:"isSouthWestOf",value:function(r){return this.row>=r.row&&(um(this,Ll)?this.col>=r.col:this.col<=r.col)}},{key:"isNorthEastOf",value:function(r){return this.row<=r.row&&(um(this,Ll)?this.col<=r.col:this.col>=r.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new t(this.row,this.col,um(this,Ll))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),t}();const ow=P_e;function Wg(t){return Wg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wg(t)}function k_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tq(n.key),n)}}function $_e(t,e,r){return e&&p$(t.prototype,e),r&&p$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function L_e(t,e,r){D_e(t,e),e.set(t,r)}function D_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ME(t,e,r){return e=Tq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Tq(t){var e=F_e(t,"string");return Wg(e)==="symbol"?e:String(e)}function F_e(t,e){if(Wg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Wg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Do(t,e){var r=Oq(t,e,"get");return H_e(t,r)}function H_e(t,e){return e.get?e.get.call(t):e.value}function B_e(t,e,r){var n=Oq(t,e,"set");return U_e(t,n,r),r}function Oq(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function U_e(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Fi=new WeakMap,V_e=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;k_e(this,t),ME(this,"highlight",null),ME(this,"from",null),ME(this,"to",null),L_e(this,Fi,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=r.clone(),this.to=n.clone(),B_e(this,Fi,i)}return $_e(t,[{key:"setHighlight",value:function(r){return this.highlight=r.clone().normalize(),this}},{key:"setFrom",value:function(r){return this.from=r.clone(),this}},{key:"setTo",value:function(r){return this.to=r.clone(),this}},{key:"isValid",value:function(r){return this.from.isValid(r)&&this.to.isValid(r)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var r=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var r=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(r,n)-Math.min(r,n)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(r){var n=r.row,i=r.col,o=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return o.row<=n&&a.row>=n&&o.col<=i&&a.col>=i}},{key:"includesRange",value:function(r){return this.includes(r.getOuterTopStartCorner())&&this.includes(r.getOuterBottomEndCorner())}},{key:"isEqual",value:function(r){return Math.min(this.from.row,this.to.row)===Math.min(r.from.row,r.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(r.from.row,r.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(r.from.col,r.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(r.from.col,r.to.col)}},{key:"overlaps",value:function(r){return r.isSouthEastOf(this.getOuterTopLeftCorner())&&r.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(r){return this.getOuterTopLeftCorner().isSouthEastOf(r)||this.getOuterBottomRightCorner().isSouthEastOf(r)}},{key:"isNorthWestOf",value:function(r){return this.getOuterTopLeftCorner().isNorthWestOf(r)||this.getOuterBottomRightCorner().isNorthWestOf(r)}},{key:"isOverlappingHorizontally",value:function(r){return this.getOuterTopRightCorner().col>=r.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=r.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=r.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=r.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(r){return this.getOuterBottomRightCorner().row>=r.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=r.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=r.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=r.getOuterTopRightCorner().row}},{key:"expand",value:function(r){var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return r.row<n.row||r.col<n.col||r.row>i.row||r.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,r.row),Math.min(n.col,r.col)),this.to=this._createCellCoords(Math.max(i.row,r.row),Math.max(i.col,r.col)),!0):!1}},{key:"expandByRange",value:function(r){if(this.includesRange(r)||!this.overlaps(r))return!1;var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),a=r.getOuterTopStartCorner(),s=r.getOuterBottomEndCorner(),l=Math.min(n.row,a.row),u=Math.min(n.col,a.col),c=Math.max(i.row,s.row),f=Math.max(i.col,s.col),h=this._createCellCoords(l,u),d=this._createCellCoords(c,f);return this.from=h,this.to=d,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(r){switch(r){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var i=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=i[0],this.to=i[1];break;case"SE-NW":var o=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=o[0],this.to=o[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var r=this.getDirection();switch(r){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Do(this,Fi)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Do(this,Fi)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Do(this,Fi)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Do(this,Fi)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Do(this,Fi)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Do(this,Fi)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Do(this,Fi)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Do(this,Fi)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(r,n){return n&&n.includes(r)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:r.isEqual(this.getOuterTopLeftCorner())||r.isEqual(this.getOuterTopRightCorner())||r.isEqual(this.getOuterBottomLeftCorner())||r.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(r,n){if(!(r instanceof ow))return!1;if(n){var i=n.from,o=n.to;if(n.includes(r)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(i.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,i.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}if(r.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(r.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(r.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(r.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(r){if(!this.includesRange(r))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(r.from.row,r.to.row),bottom:Math.max(r.from.row,r.to.row),left:Math.min(r.from.col,r.to.col),right:Math.max(r.from.col,r.to.col)},o=[];return n.top===i.top&&o.push("top"),n.right===i.right&&o.push("right"),n.bottom===i.bottom&&o.push("bottom"),n.left===i.left&&o.push("left"),o}},{key:"getInner",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],o=r.row;o<=n.row;o++)for(var a=r.col;a<=n.col;a++)!(this.from.row===o&&this.from.col===a)&&!(this.to.row===o&&this.to.col===a)&&i.push(this._createCellCoords(o,a));return i}},{key:"getAll",value:function(){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[],o=r.row;o<=n.row;o++)for(var a=r.col;a<=n.col;a++)r.row===o&&r.col===a?i.push(r):n.row===o&&n.col===a?i.push(n):i.push(this._createCellCoords(o,a));return i}},{key:"forAll",value:function(r){for(var n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=n.row;o<=i.row;o++)for(var a=n.col;a<=i.col;a++){var s=r(o,a);if(s===!1)return}}},{key:"clone",value:function(){return new t(this.highlight,this.from,this.to,Do(this,Fi))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(r,n){return new ow(r,n,Do(this,Fi))}}]),t}();const d3=V_e;function zg(t){return zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zg(t)}function j_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,z_e(n.key),n)}}function W_e(t,e,r){return e&&m$(t.prototype,e),r&&m$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function z_e(t){var e=G_e(t,"string");return zg(e)==="symbol"?e:String(e)}function G_e(t,e){if(zg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(zg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Vc=new WeakMap,Y_e=function(){function t(e,r,n,i,o,a){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;j_e(this,t),this.wtSettings=n,this.domBindings=r,this.wtTable=o,this.selections=a,this.parent=s,this.eventManager=i,this.facadeGetter=e,Vc.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return W_e(t,[{key:"registerEvents",value:function(){var r=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(o){return r.onContextMenu(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(o){return r.onMouseOver(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(o){return r.onMouseOut(o)});var n=function(){r.eventManager.addEventListener(r.wtTable.holder,"touchstart",function(a){return r.onTouchStart(a)}),r.eventManager.addEventListener(r.wtTable.holder,"touchend",function(a){return r.onTouchEnd(a)}),r.momentumScrolling||(r.momentumScrolling={}),r.eventManager.addEventListener(r.wtTable.holder,"scroll",function(){clearTimeout(r.momentumScrolling._timeout),r.momentumScrolling.ongoing||r.wtSettings.getSetting("onBeforeTouchScroll"),r.momentumScrolling.ongoing=!0,r.momentumScrolling._timeout=setTimeout(function(){r.touchApplied||(r.momentumScrolling.ongoing=!1,r.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},i=function(){r.eventManager.addEventListener(r.wtTable.holder,"mouseup",function(a){return r.onMouseUp(a)}),r.eventManager.addEventListener(r.wtTable.holder,"mousedown",function(a){return r.onMouseDown(a)})};na()?n():(IK()&&n(),i())}},{key:"selectedCellWasTouched",value:function(r){var n=Vc.get(this),i=this.parentCell(r),o=i.coords;if(n.selectedCellBeforeTouchEnd&&o){var a=[o.row,n.selectedCellBeforeTouchEnd.from.row],s=a[0],l=a[1],u=[o.col,n.selectedCellBeforeTouchEnd.from.col],c=u[0],f=u[1];return s===l&&c===f}return!1}},{key:"parentCell",value:function(r){var n={},i=this.wtTable.TABLE,o=_0(r,["TD","TH"],i);return o?(n.coords=this.wtTable.getCoords(o),n.TD=o):at(r,"wtBorder")&&at(r,"current")?(n.coords=this.selections.getCell().cellRange.highlight,n.TD=this.wtTable.getCell(n.coords)):at(r,"wtBorder")&&at(r,"area")&&this.selections.createOrGetArea().cellRange&&(n.coords=this.selections.createOrGetArea().cellRange.to,n.TD=this.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(r){var n=Vc.get(this),i=this.domBindings.rootDocument.activeElement,o=zK(Uwe,r.target),a=r.target;if(!(a===i||o(0)===i||o(1)===i)){var s=this.parentCell(a);at(a,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",r,a):s.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",r,s.coords,s.TD),(r.button===0||this.touchApplied)&&s.TD&&(n.dblClickOrigin[0]=s.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(r){if(this.wtSettings.has("onCellContextMenu")){var n=this.parentCell(r.target);n.TD&&this.callListener("onCellContextMenu",r,n.coords,n.TD)}}},{key:"onMouseOver",value:function(r){if(!!this.wtSettings.has("onCellMouseOver")){var n=this.wtTable.TABLE,i=_0(r.target,["TD","TH"],n),o=this.parent||this;i&&i!==o.lastMouseOver&&Hu(i,n)&&(o.lastMouseOver=i,this.callListener("onCellMouseOver",r,this.wtTable.getCoords(i),i))}}},{key:"onMouseOut",value:function(r){if(!!this.wtSettings.has("onCellMouseOut")){var n=this.wtTable.TABLE,i=_0(r.target,["TD","TH"],n),o=_0(r.relatedTarget,["TD","TH"],n);i&&i!==o&&Hu(i,n)&&this.callListener("onCellMouseOut",r,this.wtTable.getCoords(i),i)}}},{key:"onMouseUp",value:function(r){var n=Vc.get(this),i=this.parentCell(r.target);i.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",r,i.coords,i.TD),!(r.button!==0&&!this.touchApplied)&&(i.TD===n.dblClickOrigin[0]&&i.TD===n.dblClickOrigin[1]?(at(r.target,"corner")?this.callListener("onCellCornerDblClick",r,i.coords,i.TD):this.callListener("onCellDblClick",r,i.coords,i.TD),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):i.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=i.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(r){var n=Vc.get(this);n.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(r)}},{key:"onTouchEnd",value:function(r){var n,i=r.target,o=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,a=He(o)&&o.row>=0&&o.col>=0,s=r.cancelable&&a&&this.wtSettings.getSetting("isDataViewInstance");if(s){var l=["A","BUTTON","INPUT"];EK()&&(d2e()||p2e())&&this.selectedCellWasTouched(i)&&!l.includes(i.tagName)?r.preventDefault():this.selectedCellWasTouched(i)||r.preventDefault()}this.onMouseUp(r),this.touchApplied=!1}},{key:"callListener",value:function(r,n,i,o){var a=this.wtSettings.getSettingPure(r);a&&a(n,i,o,this.facadeGetter())}},{key:"destroy",value:function(){var r=Vc.get(this);clearTimeout(r.dblClickTimeout[0]),clearTimeout(r.dblClickTimeout[1]),this.eventManager.destroy()}}]),t}();const Aq=Y_e;function Gg(t){return Gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gg(t)}function K_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,X_e(n.key),n)}}function q_e(t,e,r){return e&&g$(t.prototype,e),r&&g$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function X_e(t){var e=Q_e(t,"string");return Gg(e)==="symbol"?e:String(e)}function Q_e(t,e){if(Gg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Gg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Z_e=function(){function t(e,r,n){K_e(this,t),this.offset=e,this.total=r,this.countTH=n}return q_e(t,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),t}();const J_e=Z_e;function Yg(t){return Yg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yg(t)}function eTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rTe(n.key),n)}}function tTe(t,e,r){return e&&y$(t.prototype,e),r&&y$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function rTe(t){var e=nTe(t,"string");return Yg(e)==="symbol"?e:String(e)}function nTe(t,e){if(Yg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Yg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var iTe=function(){function t(e,r,n){eTe(this,t),this.offset=e,this.total=r,this.countTH=n}return tTe(t,[{key:"offsetted",value:function(r){return r+this.offset}},{key:"unOffsetted",value:function(r){return r-this.offset}},{key:"renderedToSource",value:function(r){return this.offsetted(r)}},{key:"sourceToRendered",value:function(r){return this.unOffsetted(r)}},{key:"offsettedTH",value:function(r){return r-this.countTH}},{key:"unOffsettedTH",value:function(r){return r+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(r){return this.renderedToSource(this.offsettedTH(r))}},{key:"sourceRowToVisibleColHeadedRow",value:function(r){return this.unOffsettedTH(this.sourceToRendered(r))}}]),t}();const oTe=iTe;var aTe=0,aw=1,sw=2;function Kg(t){return Kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kg(t)}function sTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,uTe(n.key),n)}}function lTe(t,e,r){return e&&v$(t.prototype,e),r&&v$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function uTe(t){var e=cTe(t,"string");return Kg(e)==="symbol"?e:String(e)}function cTe(t,e){if(Kg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Kg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var b$=function(){function t(){sTe(this,t),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return lTe(t,[{key:"setSize",value:function(r){this.currentSize=this.nextSize,this.nextSize=r}},{key:"setOffset",value:function(r){this.currentOffset=this.nextOffset,this.nextOffset=r}}]),t}();function qg(t){return qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qg(t)}function fTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dTe(n.key),n)}}function hTe(t,e,r){return e&&w$(t.prototype,e),r&&w$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dTe(t){var e=pTe(t,"string");return qg(e)==="symbol"?e:String(e)}function pTe(t,e){if(qg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(qg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mTe=function(){function t(){fTe(this,t),this.size=new b$,this.workingSpace=aTe,this.sharedSize=null}return hTe(t,[{key:"setSize",value:function(r){this.size.setSize(r)}},{key:"setOffset",value:function(r){this.size.setOffset(r)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof b$}},{key:"isPlaceOn",value:function(r){return this.workingSpace===r}},{key:"append",value:function(r){this.workingSpace=aw,r.workingSpace=sw,this.sharedSize=r.getViewSize()}},{key:"prepend",value:function(r){this.workingSpace=sw,r.workingSpace=aw,this.sharedSize=r.getViewSize()}}]),t}();function Xg(t){return Xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xg(t)}function gTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vTe(n.key),n)}}function yTe(t,e,r){return e&&S$(t.prototype,e),r&&S$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vTe(t){var e=bTe(t,"string");return Xg(e)==="symbol"?e:String(e)}function bTe(t,e){if(Xg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Xg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xq=function(){function t(e,r,n){gTe(this,t),this.rootNode=e,this.nodesPool=r,this.sizeSet=new mTe,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return yTe(t,[{key:"setSize",value:function(r){return this.sizeSet.setSize(r),this}},{key:"setOffset",value:function(r){return this.sizeSet.setOffset(r),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(r){return r<this.collectedNodes.length?this.collectedNodes[r]:null}},{key:"getCurrentNode",value:function(){var r=this.collectedNodes.length;return r>0?this.collectedNodes[r-1]:null}},{key:"getRenderedChildCount",value:function(){var r=this.rootNode,n=this.sizeSet,i=0;if(this.isSharedViewSet())for(var o=r.firstElementChild;o;){if(o.tagName===this.childNodeType)i+=1;else if(n.isPlaceOn(aw))break;o=o.nextElementSibling}else i=r.childElementCount;return i}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var r=this.rootNode,n=this.sizeSet,i=this.isSharedViewSet(),o=n.getViewSize(),a=o.nextSize,s=this.getRenderedChildCount();s<a;){var l=this.nodesPool();!i||i&&n.isPlaceOn(sw)?r.appendChild(l):r.insertBefore(l,r.firstChild),s+=1}for(var u=i&&n.isPlaceOn(aw);s>a;)r.removeChild(u?r.firstChild:r.lastChild),s-=1}},{key:"render",value:function(){var r=this.rootNode,n=this.sizeSet,i=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(sw)&&(i+=n.sharedSize.nextSize);var o=r.childNodes[i];if(o.tagName!==this.childNodeType){var a=this.nodesPool();r.replaceChild(a,o),o=a}this.collectedNodes.push(o),this.visualIndex+=1}},{key:"end",value:function(){}}]),t}();function Mh(t){return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mh(t)}function wTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,RTe(n.key),n)}}function STe(t,e,r){return e&&R$(t.prototype,e),r&&R$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function RTe(t){var e=ETe(t,"string");return Mh(e)==="symbol"?e:String(e)}function ETe(t,e){if(Mh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zT(t,e)}function zT(t,e){return zT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},zT(t,e)}function _Te(t){var e=ATe();return function(){var n=lw(t),i;if(e){var o=lw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return TTe(this,i)}}function TTe(t,e){if(e&&(Mh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OTe(t)}function OTe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ATe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lw(t){return lw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lw(t)}var Iq=function(t){CTe(r,t);var e=_Te(r);function r(){return wTe(this,r),e.apply(this,arguments)}return STe(r,[{key:"prependView",value:function(i){return this.sizeSet.prepend(i.sizeSet),i.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(i){return this.sizeSet.append(i.sizeSet),i.sizeSet.prepend(this.sizeSet),this}}]),r}(xq);function Qg(t){return Qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qg(t)}function xTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,MTe(n.key),n)}}function ITe(t,e,r){return e&&E$(t.prototype,e),r&&E$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function MTe(t){var e=NTe(t,"string");return Qg(e)==="symbol"?e:String(e)}function NTe(t,e){if(Qg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Qg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var PTe=function(){function t(e){xTe(this,t),this.nodeType=e.toUpperCase()}return ITe(t,[{key:"setRootDocument",value:function(r){this.rootDocument=r}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),t}();function Zg(t){return Zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zg(t)}function kTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,LTe(n.key),n)}}function $Te(t,e,r){return e&&C$(t.prototype,e),r&&C$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function LTe(t){var e=DTe(t,"string");return Zg(e)==="symbol"?e:String(e)}function DTe(t,e){if(Zg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Zg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var k1=function(){function t(e,r){kTe(this,t),this.nodesPool=typeof e=="string"?new PTe(e):null,this.nodeType=e,this.rootNode=r,this.table=null,this.renderedNodes=0}return $Te(t,[{key:"setTable",value:function(r){this.nodesPool&&this.nodesPool.setRootDocument(r.rootDocument),this.table=r}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),t}();function Nh(t){return Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nh(t)}function FTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,BTe(n.key),n)}}function HTe(t,e,r){return e&&_$(t.prototype,e),r&&_$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function BTe(t){var e=UTe(t,"string");return Nh(e)==="symbol"?e:String(e)}function UTe(t,e){if(Nh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&GT(t,e)}function GT(t,e){return GT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},GT(t,e)}function jTe(t){var e=GTe();return function(){var n=uw(t),i;if(e){var o=uw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return WTe(this,i)}}function WTe(t,e){if(e&&(Nh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zTe(t)}function zTe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function GTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uw(t){return uw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},uw(t)}var YTe=function(t){VTe(r,t);var e=jTe(r);function r(){var n;return FTe(this,r),n=e.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return HTe(r,[{key:"obtainOrderView",value:function(i){var o=this,a;return this.orderViews.has(i)?a=this.orderViews.get(i):(a=new Iq(i,function(s){return o.nodesPool.obtain(o.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,a)),a}},{key:"render",value:function(){for(var i=this.table,o=i.rowsToRender,a=i.rowHeaderFunctions,s=i.rowHeadersCount,l=i.rows,u=i.cells,c=0;c<o;c++){var f=this.table.renderedRowToSource(c),h=l.getRenderedNode(c);this.sourceRowIndex=f;var d=this.obtainOrderView(h),p=u.obtainOrderView(h);d.appendView(p).setSize(s).setOffset(this.table.renderedColumnToSource(0)).start();for(var m=0;m<s;m++){d.render();var g=d.getCurrentNode();g.className="",g.removeAttribute("style"),a[m](f,g,m)}d.end()}}}]),r}(k1);function Ph(t){return Ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ph(t)}function KTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,XTe(n.key),n)}}function qTe(t,e,r){return e&&T$(t.prototype,e),r&&T$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function XTe(t){var e=QTe(t,"string");return Ph(e)==="symbol"?e:String(e)}function QTe(t,e){if(Ph(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ZTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&YT(t,e)}function YT(t,e){return YT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},YT(t,e)}function JTe(t){var e=rOe();return function(){var n=cw(t),i;if(e){var o=cw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return eOe(this,i)}}function eOe(t,e){if(e&&(Ph(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tOe(t)}function tOe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cw(t){return cw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cw(t)}var nOe=function(t){ZTe(r,t);var e=JTe(r);function r(n){return KTe(this,r),e.call(this,null,n)}return qTe(r,[{key:"adjust",value:function(){var i=this.table,o=i.columnHeadersCount,a=i.rowHeadersCount,s=this.rootNode.firstChild;if(o){for(var l=this.table.columnsToRender,u=l+a,c=0,f=o;c<f;c++){for(s=this.rootNode.childNodes[c],s||(s=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(s)),this.renderedNodes=s.childNodes.length;this.renderedNodes<u;)s.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>u;)s.removeChild(s.lastChild),this.renderedNodes-=1}var h=this.rootNode.childNodes.length;if(h>o)for(var d=o;d<h;d++)this.rootNode.removeChild(this.rootNode.lastChild)}else s&&ua(s)}},{key:"render",value:function(){for(var i=this.table.columnHeadersCount,o=0;o<i;o+=1)for(var a=this.table,s=a.columnHeaderFunctions,l=a.columnsToRender,u=a.rowHeadersCount,c=this.rootNode.childNodes[o],f=-1*u;f<l;f+=1){var h=this.table.renderedColumnToSource(f),d=c.childNodes[f+u];d.className="",d.removeAttribute("style"),s[o](h,d,o)}}}]),r}(k1);function kh(t){return kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kh(t)}function iOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aOe(n.key),n)}}function oOe(t,e,r){return e&&O$(t.prototype,e),r&&O$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function aOe(t){var e=sOe(t,"string");return kh(e)==="symbol"?e:String(e)}function sOe(t,e){if(kh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lOe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&KT(t,e)}function KT(t,e){return KT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},KT(t,e)}function uOe(t){var e=hOe();return function(){var n=fw(t),i;if(e){var o=fw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return cOe(this,i)}}function cOe(t,e){if(e&&(kh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fOe(t)}function fOe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fw(t){return fw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fw(t)}var dOe=function(t){lOe(r,t);var e=uOe(r);function r(n){return iOe(this,r),e.call(this,null,n)}return oOe(r,[{key:"adjust",value:function(){for(var i=this.table,o=i.columnsToRender,a=i.rowHeadersCount,s=o+a;this.renderedNodes<s;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>s;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var i=this.table,o=i.columnsToRender,a=i.rowHeadersCount,s=0;s<a;s++){var l=this.table.renderedColumnToSource(s),u=this.table.columnUtils.getHeaderWidth(l);this.rootNode.childNodes[s].style.width="".concat(u,"px")}for(var c=0;c<o;c++){var f=this.table.renderedColumnToSource(c),h=this.table.columnUtils.getStretchedColumnWidth(f);this.rootNode.childNodes[c+a].style.width="".concat(h,"px")}var d=this.rootNode.firstChild;d&&Re(d,"rowHeader")}}]),r}(k1);function $h(t){return $h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$h(t)}var A$;function pOe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function mOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yOe(n.key),n)}}function gOe(t,e,r){return e&&x$(t.prototype,e),r&&x$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function yOe(t){var e=vOe(t,"string");return $h(e)==="symbol"?e:String(e)}function vOe(t,e){if($h(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if($h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bOe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qT(t,e)}function qT(t,e){return qT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},qT(t,e)}function wOe(t){var e=EOe();return function(){var n=hw(t),i;if(e){var o=hw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return SOe(this,i)}}function SOe(t,e){if(e&&($h(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ROe(t)}function ROe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function EOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hw(t){return hw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hw(t)}var I$=!1,COe=function(t){bOe(r,t);var e=wOe(r);function r(n){var i;return mOe(this,r),i=e.call(this,"TR",n),i.orderView=new xq(n,function(o){return i.nodesPool.obtain(o)},i.nodeType),i}return gOe(r,[{key:"getRenderedNode",value:function(i){return this.orderView.getNode(i)}},{key:"render",value:function(){var i=this.table.rowsToRender;!I$&&i>1e3&&(I$=!0,Xt(Gt(A$||(A$=pOe([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(i).setOffset(this.table.renderedRowToSource(0)).start();for(var o=0;o<i;o++)this.orderView.render();this.orderView.end()}}]),r}(k1);function Lh(t){return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lh(t)}function _Oe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function M$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,OOe(n.key),n)}}function TOe(t,e,r){return e&&M$(t.prototype,e),r&&M$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function OOe(t){var e=AOe(t,"string");return Lh(e)==="symbol"?e:String(e)}function AOe(t,e){if(Lh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xOe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&XT(t,e)}function XT(t,e){return XT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},XT(t,e)}function IOe(t){var e=POe();return function(){var n=dw(t),i;if(e){var o=dw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return MOe(this,i)}}function MOe(t,e){if(e&&(Lh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NOe(t)}function NOe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function POe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dw(t){return dw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dw(t)}var kOe=function(t){xOe(r,t);var e=IOe(r);function r(){var n;return _Oe(this,r),n=e.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return TOe(r,[{key:"obtainOrderView",value:function(i){var o=this,a;return this.orderViews.has(i)?a=this.orderViews.get(i):(a=new Iq(i,function(s){return o.nodesPool.obtain(o.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,a)),a}},{key:"render",value:function(){for(var i=this.table,o=i.rowsToRender,a=i.columnsToRender,s=i.rows,l=i.rowHeaders,u=0;u<o;u++){var c=this.table.renderedRowToSource(u),f=s.getRenderedNode(u);this.sourceRowIndex=c;var h=this.obtainOrderView(f),d=l.obtainOrderView(f);h.prependView(d).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var p=0;p<a;p++){h.render();var m=h.getCurrentNode(),g=this.table.renderedColumnToSource(p);at(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),this.table.cellRenderer(c,g,m)}h.end()}}}]),r}(k1);function Jg(t){return Jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jg(t)}function $Oe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,DOe(n.key),n)}}function LOe(t,e,r){return e&&N$(t.prototype,e),r&&N$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function DOe(t){var e=FOe(t,"string");return Jg(e)==="symbol"?e:String(e)}function FOe(t,e){if(Jg(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Jg(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var HOe=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;$Oe(this,t),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return LOe(t,[{key:"setAxisUtils",value:function(r,n){this.rowUtils=r,this.columnUtils=n}},{key:"setViewportSize",value:function(r,n){this.rowsToRender=r,this.columnsToRender=n}},{key:"setFilters",value:function(r,n){this.rowFilter=r,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(r,n){this.rowHeaderFunctions=r,this.rowHeadersCount=r.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.rowHeaders,i=r.columnHeaders,o=r.colGroup,a=r.rows,s=r.cells;n.setTable(this),i.setTable(this),o.setTable(this),a.setTable(this),s.setTable(this),this.rowHeaders=n,this.columnHeaders=i,this.colGroup=o,this.rows=a,this.cells=s}},{key:"renderedRowToSource",value:function(r){return this.rowFilter.renderedToSource(r)}},{key:"renderedColumnToSource",value:function(r){return this.columnFilter.renderedToSource(r)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var r=this.rowsToRender,n=this.rows,i=0;i<r;i++){var o=n.getRenderedNode(i);if(o.firstChild){var a=this.renderedRowToSource(i),s=this.rowUtils.getHeight(a);s?o.firstChild.style.height="".concat(s-1,"px"):o.firstChild.style.height=""}}}}]),t}();function ey(t){return ey=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ey(t)}function BOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,VOe(n.key),n)}}function UOe(t,e,r){return e&&P$(t.prototype,e),r&&P$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function VOe(t){var e=jOe(t,"string");return ey(e)==="symbol"?e:String(e)}function jOe(t,e){if(ey(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ey(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var WOe=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.TABLE,n=e.THEAD,i=e.COLGROUP,o=e.TBODY,a=e.rowUtils,s=e.columnUtils,l=e.cellRenderer;BOe(this,t),this.renderer=new HOe(r,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new YTe,columnHeaders:new nOe(n),colGroup:new dOe(i),rows:new COe(o),cells:new kOe}),this.renderer.setAxisUtils(a,s)}return UOe(t,[{key:"setFilters",value:function(r,n){return this.renderer.setFilters(r,n),this}},{key:"setViewportSize",value:function(r,n){return this.renderer.setViewportSize(r,n),this}},{key:"setHeaderContentRenderers",value:function(r,n){return this.renderer.setHeaderContentRenderers(r,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),t}();function ty(t){return ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ty(t)}function zOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,YOe(n.key),n)}}function GOe(t,e,r){return e&&k$(t.prototype,e),r&&k$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function YOe(t){var e=KOe(t,"string");return ty(e)==="symbol"?e:String(e)}function KOe(t,e){if(ty(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ty(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qOe=function(){function t(e,r){zOe(this,t),this.dataAccessObject=e,this.wtSettings=r,this.headerWidths=new Map}return GOe(t,[{key:"getWidth",value:function(r){return this.wtSettings.getSetting("columnWidth",r)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(r){var n=this.dataAccessObject.wtViewport.columnsRenderCalculator,i=this.getWidth(r);if(n){var o=n.getStretchedColumnWidth(r,i);o&&(i=o)}return i}},{key:"getHeaderHeight",value:function(r){var n=this.wtSettings.getSetting("defaultRowHeight"),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[r];return i!==void 0&&(n=n?Math.max(n,i):i),n}},{key:"getHeaderWidth",value:function(r){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(r))}},{key:"calculateWidths",value:function(){var r=this.wtSettings,n=this.dataAccessObject,i=n.wtTable,o=n.wtViewport,a=n.cloneSource,s=a?a.wtTable.holder:i.holder,l=s.offsetHeight<s.scrollHeight?yn():0,u=r.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-l),u=r.getSetting("onModifyRowHeaderWidth",u),u!=null)for(var c=r.getSetting("rowHeaders").length,f=r.getSetting("defaultColumnWidth"),h=0;h<c;h++){var d=Array.isArray(u)?u[h]:u;d=d==null?f:d,this.headerWidths.set(h,d)}}}]),t}();function ry(t){return ry=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ry(t)}function XOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ZOe(n.key),n)}}function QOe(t,e,r){return e&&$$(t.prototype,e),r&&$$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZOe(t){var e=JOe(t,"string");return ry(e)==="symbol"?e:String(e)}function JOe(t,e){if(ry(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ry(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var e7e=function(){function t(e,r){XOe(this,t),this.dataAccessObject=e,this.wtSettings=r}return QOe(t,[{key:"getHeight",value:function(r){var n=this.wtSettings.getSetting("rowHeight",r),i=this.dataAccessObject.wtViewport.oversizedRows[r];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}]),t}();function ny(t){return ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ny(t)}function t7e(t){return i7e(t)||n7e(t)||Mq(t)||r7e()}function r7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n7e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function i7e(t){if(Array.isArray(t))return QT(t)}function o7e(t,e){return l7e(t)||s7e(t,e)||Mq(t,e)||a7e()}function a7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mq(t,e){if(!!t){if(typeof t=="string")return QT(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QT(t,e)}}function QT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s7e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function l7e(t){if(Array.isArray(t))return t}function u7e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function L$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Nq(n.key),n)}}function c7e(t,e,r){return e&&L$(t.prototype,e),r&&L$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fo(t,e,r){return e=Nq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nq(t){var e=f7e(t,"string");return ny(e)==="symbol"?e:String(e)}function f7e(t,e){if(ny(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ny(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var h7e=function(){function t(e,r,n,i,o){var a=this;u7e(this,t),Fo(this,"wtSettings",null),Fo(this,"domBindings",void 0),Fo(this,"TBODY",null),Fo(this,"THEAD",null),Fo(this,"COLGROUP",null),Fo(this,"hasTableHeight",!0),Fo(this,"hasTableWidth",!0),Fo(this,"isTableVisible",!1),Fo(this,"tableOffset",0),Fo(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,DK(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(s)}),this.rowUtils=new e7e(this.dataAccessObject,this.wtSettings),this.columnUtils=new qOe(this.dataAccessObject,this.wtSettings),this.tableRenderer=new WOe({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return c7e(t,[{key:"is",value:function(r){return this.name===r}},{key:"fixTableDomTree",value:function(){var r=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=r.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=r.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=r.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!at(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,r),i.appendChild(r)),i.style.position="relative",i}},{key:"createHider",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!at(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,r),i.appendChild(r)),i}},{key:"createHolder",value:function(r){var n=r.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!at(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,r),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),i.appendChild(r)),i}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wtSettings,i=this.dataAccessObject,o=i.wtOverlays,a=i.wtViewport,s=n.getSetting("totalRows"),l=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),c=u.length,f=n.getSetting("columnHeaders"),h=f.length,d=!1,p=r;if(this.isMaster&&(this.holderOffset=Zr(this.holder),p=a.createRenderCalculators(p),c&&!n.getSetting("fixedColumnsStart"))){var m=o.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=m!==0,g!==this.correctHeaderWidth&&(p=!1)}if(this.isMaster&&(d=o.updateStateOfRendering()),p)this.isMaster&&a.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=Zr(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var v=s>0?this.getFirstRenderedRow():0,S=l>0?this.getFirstRenderedColumn():0;this.rowFilter=new oTe(v,s,h),this.columnFilter=new J_e(S,l,c);var b=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var E={};this.wtSettings.getSetting("beforeDraw",!0,E),b=E.skipRender!==!0}if(b){this.tableRenderer.setHeaderContentRenderers(u,f),(this.is(ta)||this.is(Js))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var T;if(this.isMaster&&(T=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(ta))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var N=Qt(this.hider),L=Qt(this.TABLE);N!==0&&L!==N&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),T!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(ta)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var V=!1;return this.isMaster&&(V=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(V=o.bottomOverlay.resetFixedPosition()||V),V=o.inlineStartOverlay.resetFixedPosition()||V,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),V?(o.refreshAll(),o.adjustElementsSize()):this.refreshSelections(p),d&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(r){for(var n=this.columnFilter.renderedToSource(r),i=this.wtSettings.getSetting("columnHeaders").length,o=this.wtSettings.getSetting("defaultRowHeight"),a,s,l,u=this.wtSettings.getSetting("columnHeaderHeight")||[];i;)i-=1,a=this.getColumnHeaderHeight(i),s=this.getColumnHeader(n,i),s&&(l=zs(s),(!a&&o<l||a<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),Array.isArray(u)?u[i]!==null&&u[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(u[i]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]||u))}},{key:"adjustColumnHeaderHeights",value:function(){for(var r=this.wtSettings,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=r.getSetting("columnHeaders"),a=0,s=o.length;a<s;a++)if(i[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(i[a],"px")}}},{key:"resetOversizedRows",value:function(){var r=this.wtSettings,n=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(ta))&&!r.getSetting("externalRowCalculator"))for(var i=this.getRenderedRowsCount(),o=0;o<i;o++){var a=this.rowFilter.renderedToSource(o);n.oversizedRows&&n.oversizedRows[a]&&(n.oversizedRows[a]=void 0)}}},{key:"removeClassFromCells",value:function(r){for(var n=this.TABLE.querySelectorAll(".".concat(r)),i=0,o=n.length;i<o;i++)ut(n[i],r)}},{key:"refreshSelections",value:function(r){var n=this.wtSettings,i=this.dataAccessObject.selections;if(!!i){var o=Array.from(i),a=o.length;if(r){for(var s=[],l=0;l<a;l++){for(var u=o[l].settings,c=u.highlightHeaderClassName,f=u.highlightRowClassName,h=u.highlightColumnClassName,d=o[l].classNames,p=d.length,m=0;m<p;m++)s.includes(d[m])||s.push(d[m]);c&&!s.includes(c)&&s.push(c),f&&!s.includes(f)&&s.push(f),h&&!s.includes(h)&&s.push(h)}var g=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(g))for(var v=0;v<g.length;v++)s.push(g[v]);for(var S=s.length,b=0;b<S;b++)this.removeClassFromCells(s[b])}for(var E=0;E<a;E++)o[E].draw(this.facadeGetter(),r)}}},{key:"getCell",value:function(r){var n=r.row,i=r.col,o=this.wtSettings.getSetting("onModifyGetCellCoords",n,i);if(o&&Array.isArray(o)){var a=o7e(o,2);n=a[0],i=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;var s=this.getRow(n);if(!s&&n>=0)throw new Error("TR was expected to be rendered but is not");var l=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!l&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return l}},{key:"getRow",value:function(r){var n=null,i=null;if(r<0){var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceRowToVisibleColHeadedRow(r),i=this.THEAD}else{var a;n=(a=this.rowFilter)===null||a===void 0?void 0:a.sourceToRendered(r),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}},{key:"getColumnHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]}},{key:"getColumnHeaders",value:function(r){var n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r);return this.THEAD.childNodes.forEach(function(o){var a=o.childNodes[i];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var i=this.wtSettings.getSetting("rowHeaders").length;if(!(n>=i)){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)];return o==null?void 0:o.childNodes[n]}}}},{key:"getRowHeaders",value:function(r){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],i=this.wtSettings.getSetting("rowHeaders").length,o=0;o<i;o++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)],s=a==null?void 0:a.childNodes[o];s&&n.push(s)}return n}},{key:"getCoords",value:function(r){var n=r;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Fu(n,["TD","TH"])),n===null)return null;var i=n.parentNode,o=i.parentNode,a=jwe(i),s=n.cellIndex;if(Pl(Zu,n,this.wtRootElement)||Pl(Xu,n,this.wtRootElement))o.nodeName==="THEAD"&&(a-=o.childNodes.length);else if(Pl(Js,n,this.wtRootElement)||Pl(ta,n,this.wtRootElement)){var l=this.wtSettings.getSetting("totalRows");a=l-o.childNodes.length+a}else o===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return Pl(Zu,n,this.wtRootElement)||Pl(Qu,n,this.wtRootElement)||Pl(Js,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(a,s)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var r=this.TBODY.childNodes.length,n=r*this.wtSettings.getSetting("defaultRowHeight"),i=zs(this.TBODY)-1,o,a,s,l,u;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;r;)r-=1,s=this.rowFilter.renderedToSource(r),o=this.getRowHeight(s),l=this.getTrForRow(s),u=l.querySelector("th"),u?a=zs(u):a=zs(l)-1,(!o&&this.wtSettings.getSetting("defaultRowHeight")<a||o<a)&&(a+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=a)}}},{key:"getTrForRow",value:function(r){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)]}},{key:"isColumnHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("rowHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowHeaderRendered",value:function(r){if(r>=0)return!1;var n=this.wtSettings.getSetting("columnHeaders"),i=n.length;return Math.abs(r)<=i}},{key:"isRowBeforeRenderedRows",value:function(r){var n=this.getFirstRenderedRow();return r<0&&n<=0?!this.isRowHeaderRendered(r):r<n}},{key:"isRowAfterRenderedRows",value:function(r){return r>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(r){var n=this.getFirstRenderedColumn();return r<0&&n<=0?!this.isColumnHeaderRendered(r):r<n}},{key:"isColumnAfterRenderedColumns",value:function(r){return this.columnFilter&&r>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(r){return this.columnFilter&&r>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(r){return this.rowFilter&&r>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(r){return this.columnFilter&&this.columnFilter.sourceToRendered(r)<0&&r>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(r){return this.rowUtils.getHeight(r)}},{key:"getColumnHeaderHeight",value:function(r){return this.columnUtils.getHeaderHeight(r)}},{key:"getColumnWidth",value:function(r){return this.columnUtils.getWidth(r)}},{key:"getStretchedColumnWidth",value:function(r){return this.columnUtils.getStretchedColumnWidth(r)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return Qt(this.TABLE)}},{key:"getHeight",value:function(){return wr(this.TABLE)}},{key:"getTotalWidth",value:function(){var r=Qt(this.hider);return r!==0?r:this.getWidth()}},{key:"getTotalHeight",value:function(){var r=wr(this.hider);return r!==0?r:this.getHeight()}},{key:"isVisible",value:function(){return Mg(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(r){var n=sr(r)?r():null;return Array.isArray(n)?(n=t7e(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(r){var n=r;return typeof r!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),t}();const Vp=h7e;var d7e="stickyRowsBottom",Pq={getFirstRenderedRow:function(){var e=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsBottom"),n=e-r;return e===0||r===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Os(Pq,"MIXIN_NAME",d7e,{writable:!1,enumerable:!1});const kq=Pq;var p7e="stickyColumnsStart",$q={getFirstRenderedColumn:function(){var e=this.wtSettings.getSetting("totalColumns");return e===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Os($q,"MIXIN_NAME",p7e,{writable:!1,enumerable:!1});const p3=$q;function Dh(t){return Dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dh(t)}function D$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g7e(n.key),n)}}function m7e(t,e,r){return e&&D$(t.prototype,e),r&&D$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function g7e(t){var e=y7e(t,"string");return Dh(e)==="symbol"?e:String(e)}function y7e(t,e){if(Dh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function v7e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b7e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ZT(t,e)}function ZT(t,e){return ZT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ZT(t,e)}function w7e(t){var e=E7e();return function(){var n=pw(t),i;if(e){var o=pw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return S7e(this,i)}}function S7e(t,e){if(e&&(Dh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return R7e(t)}function R7e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function E7e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pw(t){return pw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pw(t)}var m3=function(t){b7e(r,t);var e=w7e(r);function r(n,i,o,a){return v7e(this,r),e.call(this,n,i,o,a,Js)}return m7e(r)}(Vp);ir(m3,kq);ir(m3,p3);const C7e=m3;var Xu="top",ta="bottom",Qu="inline_start",Zu="top_inline_start_corner",Js="bottom_inline_start_corner",_7e=[Xu,ta,Qu,Zu,Js],T7e=new Map([[Xu,"ht_clone_".concat(Xu)],[ta,"ht_clone_".concat(ta)],[Qu,"ht_clone_".concat(Qu," ht_clone_left")],[Zu,"ht_clone_".concat(Zu," ht_clone_top_left_corner")],[Js,"ht_clone_".concat(Js," ht_clone_bottom_left_corner")]]),O7e=Wr,A7e=Math.floor,x7e=Number.isInteger||function(e){return!O7e(e)&&isFinite(e)&&A7e(e)===e},I7e=tt,M7e=x7e;I7e({target:"Number",stat:!0},{isInteger:M7e});function iy(t){return iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iy(t)}function N7e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lq(n.key),n)}}function P7e(t,e,r){return e&&F$(t.prototype,e),r&&F$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function NE(t,e,r){return e=Lq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lq(t){var e=k7e(t,"string");return iy(e)==="symbol"?e:String(e)}function k7e(t,e){if(iy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(iy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $7e=function(){function t(e){N7e(this,t),NE(this,"dataAccessObject",void 0),NE(this,"lastScrolledColumnPos",-1),NE(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}return P7e(t,[{key:"scrollViewport",value:function(r,n,i,o,a){var s=this.scrollViewportHorizontally(r.col,i,a),l=this.scrollViewportVertically(r.row,n,o);return s||l}},{key:"scrollViewportHorizontally",value:function(r,n,i){var o=this.dataAccessObject,a=o.drawn,s=o.totalColumns;if(!a||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn(),c=n===void 0&&i===void 0,f=this.dataAccessObject,h=f.fixedColumnsStart,d=f.inlineStartOverlay;if(c&&r<h)return!1;var p=!1;return l===-1?p=d.scrollTo(r,c?r>this.lastScrolledColumnPos:n):(c&&(r<l||r>u)||!c)&&(p=d.scrollTo(r,c?r>u:n)),p&&(this.lastScrolledColumnPos=r),p}},{key:"scrollViewportVertically",value:function(r,n,i){var o=this.dataAccessObject,a=o.drawn,s=o.totalRows;if(!a||!Number.isInteger(r)||r<0||r>s)return!1;var l=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),c=n===void 0&&i===void 0,f=this.dataAccessObject,h=f.fixedRowsBottom,d=f.fixedRowsTop,p=f.topOverlay;if(c&&(r<d||r>s-h-1))return!1;var m=!1;return l===-1?m=p.scrollTo(r,c?r>this.lastScrolledRowPos:i):(c&&(r<l||r>u)||!c)&&(m=p.scrollTo(r,c?r>u:i)),m&&(this.lastScrolledRowPos=r),m}},{key:"getFirstVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,o=r.wtViewport,a=r.totalRows,s=r.fixedRowsTop,l=r.rootWindow,u=i.getFirstVisibleRow();if(n.mainTableScrollableElement===l){var c=Zr(i.wtRootElement),f=zs(i.hider),h=zs(l),d=J2(l,l);if(c.top+f-h<=d){var p=o.getColumnHeaderHeight();p+=n.sumCellSizes(0,s);for(var m=a;m>0;m--)if(p+=n.sumCellSizes(m-1,m),c.top+f-p<=d){u=m;break}}}return u}},{key:"getLastVisibleRow",value:function(){var r=this.dataAccessObject,n=r.topOverlay,i=r.wtTable,o=r.wtViewport,a=r.totalRows,s=r.rootWindow,l=i.getLastVisibleRow();if(n.mainTableScrollableElement===s){var u=Zr(i.wtRootElement),c=J2(s,s);if(u.top>c){for(var f=zs(s),h=o.getColumnHeaderHeight(),d=1;d<=a;d++)if(h+=n.sumCellSizes(d-1,d),u.top+h-c>=f){l=d-2;break}}}return l}},{key:"getFirstVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.inlineStartOverlay,i=r.wtTable,o=r.wtViewport,a=r.totalColumns,s=r.rootWindow,l=i.getFirstVisibleColumn();if(n.mainTableScrollableElement===s){var u=Zr(i.wtRootElement),c=Kb(i.hider),f=Kb(s),h=Math.abs(vT(s,s));if(u.left+c-f<=h){for(var d=o.getRowHeaderWidth(),p=a;p>0;p--)if(d+=n.sumCellSizes(p-1,p),u.left+c-d<=h){l=p;break}}}return l}},{key:"getLastVisibleColumn",value:function(){var r=this.dataAccessObject,n=r.wtSettings,i=r.inlineStartOverlay,o=r.wtTable,a=r.wtViewport,s=r.totalColumns,l=r.rootWindow,u=o.getLastVisibleColumn();if(i.mainTableScrollableElement===l){var c=n.getSetting("rtlMode"),f=null;if(c){var h=o.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document,p=d.documentElement.offsetWidth;f=Math.abs(h.right-p)}else{var m=Zr(o.wtRootElement);f=m.left}var g=Math.abs(vT(l,l));if(f>g){for(var v=Kb(l),S=a.getRowHeaderWidth(),b=1;b<=s;b++)if(S+=i.sumCellSizes(b-1,b),f+S-g>=v){u=b-2;break}}}return u}}]),t}();const L7e=$7e;function oy(t){return oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oy(t)}function D7e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function H$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dq(n.key),n)}}function F7e(t,e,r){return e&&H$(t.prototype,e),r&&H$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function po(t,e,r){return e=Dq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Dq(t){var e=H7e(t,"string");return oy(e)==="symbol"?e:String(e)}function H7e(t,e){if(oy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(oy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var g3=function(){function t(e,r){D7e(this,t),po(this,"wtTable",void 0),po(this,"wtScroll",void 0),po(this,"wtViewport",void 0),po(this,"wtOverlays",void 0),po(this,"selections",void 0),po(this,"wtEvent",void 0),po(this,"guid","wt_".concat(kK())),po(this,"drawInterrupted",!1),po(this,"drawn",!1),po(this,"domBindings",void 0),po(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new L7e(this.createScrollDao())}return F7e(t,[{key:"eventManager",get:function(){return new Er(this)}},{key:"findOriginalHeaders",value:function(){var r=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(o,a){Gu(a,r[o])}])}}},{key:"createCellCoords",value:function(r,n){return new ow(r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(r,n,i){return new d3(r,n,i,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!r&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(r);var i=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(r.row<o&&r.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(r);if(r.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(r);if(r.col<s&&r.row>=i-a){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(r)}else{if(r.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(r);if(r.row<i&&r.row>=i-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(r)}return this.wtTable.getCell(r)}},{key:"scrollViewport",value:function(r,n,i,o,a){return r.col<0||r.row<0?!1:this.wtScroll.scrollViewport(r,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return r<0?!1:this.wtScroll.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var r=this;return{get drawn(){return r.drawn},get topOverlay(){return r.wtOverlays.topOverlay},get inlineStartOverlay(){return r.wtOverlays.inlineStartOverlay},get wtTable(){return r.wtTable},get wtViewport(){return r.wtViewport},get wtSettings(){return r.wtSettings},get rootWindow(){return r.domBindings.rootWindow},get totalRows(){return r.wtSettings.getSetting("totalRows")},get totalColumns(){return r.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return r.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return r.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return r.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var r=this;return{get wot(){return r},get parentTableOffset(){return r.cloneSource.wtTable.tableOffset},get cloneSource(){return r.cloneSource},get workspaceWidth(){return r.wtViewport.getWorkspaceWidth()},get wtViewport(){return r.wtViewport},get wtOverlays(){return r.wtOverlays},get selections(){return r.selections},get drawn(){return r.drawn},set drawn(n){r.drawn=n},get wtTable(){return r.wtTable},get startColumnRendered(){return r.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return r.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return r.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return r.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return r.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return r.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return r.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return r.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return r.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return r.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return r.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return r.wtViewport.rowsVisibleCalculator.count}}}}]),t}();function Fh(t){return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fh(t)}function B$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fq(n.key),n)}}function B7e(t,e,r){return e&&B$(t.prototype,e),r&&B$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function U7e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function V7e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&JT(t,e)}function JT(t,e){return JT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},JT(t,e)}function j7e(t){var e=z7e();return function(){var n=mw(t),i;if(e){var o=mw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return W7e(this,i)}}function W7e(t,e){if(e&&(Fh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jb(t)}function Jb(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function z7e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mw(t){return mw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mw(t)}function U$(t,e,r){return e=Fq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fq(t){var e=G7e(t,"string");return Fh(e)==="symbol"?e:String(e)}function G7e(t,e){if(Fh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Y7e=function(t){V7e(r,t);var e=j7e(r);function r(n,i,o){var a;U7e(this,r),a=e.call(this,n,i),U$(Jb(a),"cloneSource",void 0),U$(Jb(a),"cloneOverlay",void 0);var s=a.wtSettings.getSetting("facade",Jb(a));return a.cloneSource=o.source,a.cloneOverlay=o.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),s,a.domBindings,a.wtSettings),a.wtViewport=o.viewport,a.selections=o.selections,a.wtEvent=new Aq(s,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,o.event),a.findOriginalHeaders(),a}return B7e(r)}(g3);function ay(t){return ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ay(t)}function K7e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function V$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Hq(n.key),n)}}function q7e(t,e,r){return e&&V$(t.prototype,e),r&&V$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function X7e(t,e,r){return e=Hq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hq(t){var e=Q7e(t,"string");return ay(e)==="symbol"?e:String(e)}function Q7e(t,e){if(ay(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ay(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $1=function(){function t(e,r,n,i,o){K7e(this,t),X7e(this,"wtSettings",null),Os(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;var a=this.wot.wtTable,s=a.TABLE,l=a.hider,u=a.spreader,c=a.holder,f=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=l,this.spreader=u,this.holder=c,this.wtRootElement=f,this.trimmingContainer=Pg(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return q7e(t,[{key:"updateStateOfRendering",value:function(){var r=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=r!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Pg(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var r=this.wot.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=ew(r.TABLE)}},{key:"getRelativeCellPosition",value:function(r,n,i){if(this.clone.wtTable.holder.contains(r)===!1){Xt("The provided element is not a child of the ".concat(this.type," overlay"));return}var o=this.mainTableScrollableElement===this.domBindings.rootWindow,a=i<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),l=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(u),top:u.offsetTop},f={start:this.getRelativeStartPosition(r),top:r.offsetTop},h=null;return o?h=this.getRelativeCellPositionWithinWindow(s,a,f,c):h=this.getRelativeCellPositionWithinHolder(s,l,a,f,c),h}},{key:"getRelativeStartPosition",value:function(r){return this.isRtl()?r.offsetParent.offsetWidth-r.offsetLeft-r.offsetWidth:r.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(r,n,i,o){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,l=0;if(!n)s=o.start;else{var u=a.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(a.left+a.width+yn())),s=u<=0?-1*u:0}if(r){var c=this.clone.wtTable.TABLE.getBoundingClientRect();l=c.top-a.top}else l=o.top;return{start:i.start+s,top:i.top+l}}},{key:"getRelativeCellPositionWithinHolder",value:function(r,n,i,o,a){var s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},l=0,u=0;if(i||(l=s.horizontal-a.start),n){var c=this.wot.wtTable.wtRootElement.getBoundingClientRect(),f=this.clone.wtTable.TABLE.getBoundingClientRect();u=f.top*-1+c.top}else r||(u=s.vertical-a.top);return{start:o.start-l,top:o.top-u}}},{key:"makeClone",value:function(){if(_7e.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var r=this.wot.wtTable,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,a=i.createElement("DIV"),s=i.createElement("TABLE"),l=r.wtRootElement.parentNode;a.className="".concat(T7e.get(this.type)," handsontable"),a.setAttribute("dir",this.isRtl()?"rtl":"ltr"),a.style.position="absolute",a.style.top=0,a.style.overflow="visible",this.isRtl()?a.style.right=0:a.style.left=0,s.className=r.TABLE.className,a.appendChild(s),l.appendChild(a);var u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Xu||u==="vertical"&&this.type===Qu?this.mainTableScrollableElement=o:o.getComputedStyle(l).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=ew(r.TABLE),new Y7e(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(r),this.needFullRender=n}},{key:"reset",value:function(){if(!!this.clone){var r=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=r.style,o=n.style,a=r.parentNode.style;Q([i,o,a],function(s){s.width="",s.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),t}();function Hh(t){return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hh(t)}function e2(t,e,r){return Bq()?e2=Reflect.construct.bind():e2=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&gw(u,a.prototype),u},e2.apply(null,arguments)}function Z7e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,eAe(n.key),n)}}function J7e(t,e,r){return e&&j$(t.prototype,e),r&&j$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function eAe(t){var e=tAe(t,"string");return Hh(e)==="symbol"?e:String(e)}function tAe(t,e){if(Hh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gw(t,e)}function gw(t,e){return gw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gw(t,e)}function nAe(t){var e=Bq();return function(){var n=yw(t),i;if(e){var o=yw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return iAe(this,i)}}function iAe(t,e){if(e&&(Hh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oAe(t)}function oAe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yw(t){return yw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yw(t)}var aAe=function(t){rAe(r,t);var e=nAe(r);function r(n,i,o,a,s,l){var u;return Z7e(this,r),u=e.call(this,n,i,Js,o,a),u.bottomOverlay=s,u.inlineStartOverlay=l,u}return J7e(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return e2(C7e,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot;if(this.updateTrimmingContainer(),!i.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(o.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var a=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();o.style[this.isRtl()?"right":"left"]="".concat(a,"px"),o.style.bottom="".concat(s,"px")}else C6(o),this.repositionOverlay();var l=wr(this.clone.wtTable.TABLE),u=Qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(l=0),o.style.height="".concat(l,"px"),o.style.width="".concat(u,"px"),!1}},{key:"repositionOverlay",value:function(){var i=this.wot,o=i.wtTable,a=i.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-o.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=yn(s)),l.style.bottom="".concat(u,"px")}}]),r}($1),sAe="calculatedColumns",Uq={getFirstRenderedColumn:function(){var e=this.dataAccessObject.startColumnRendered;return e===null?-1:e},getFirstVisibleColumn:function(){var e=this.dataAccessObject.startColumnVisible;return e===null?-1:e},getLastRenderedColumn:function(){var e=this.dataAccessObject.endColumnRendered;return e===null?-1:e},getLastVisibleColumn:function(){var e=this.dataAccessObject.endColumnVisible;return e===null?-1:e},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Os(Uq,"MIXIN_NAME",sAe,{writable:!1,enumerable:!1});const y3=Uq;function Bh(t){return Bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bh(t)}function W$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,uAe(n.key),n)}}function lAe(t,e,r){return e&&W$(t.prototype,e),r&&W$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function uAe(t){var e=cAe(t,"string");return Bh(e)==="symbol"?e:String(e)}function cAe(t,e){if(Bh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eO(t,e)}function eO(t,e){return eO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},eO(t,e)}function dAe(t){var e=gAe();return function(){var n=vw(t),i;if(e){var o=vw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return pAe(this,i)}}function pAe(t,e){if(e&&(Bh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mAe(t)}function mAe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vw(t){return vw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vw(t)}var v3=function(t){hAe(r,t);var e=dAe(r);function r(n,i,o,a){return fAe(this,r),e.call(this,n,i,o,a,ta)}return lAe(r)}(Vp);ir(v3,kq);ir(v3,y3);const yAe=v3;function Uh(t){return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uh(t)}function t2(t,e,r){return jq()?t2=Reflect.construct.bind():t2=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&bw(u,a.prototype),u},t2.apply(null,arguments)}function vAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function z$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wq(n.key),n)}}function bAe(t,e,r){return e&&z$(t.prototype,e),r&&z$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bw(t,e)}function bw(t,e){return bw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bw(t,e)}function SAe(t){var e=jq();return function(){var n=ww(t),i;if(e){var o=ww(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return RAe(this,i)}}function RAe(t,e){if(e&&(Uh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vq(t)}function Vq(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ww(t){return ww=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ww(t)}function EAe(t,e,r){return e=Wq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wq(t){var e=CAe(t,"string");return Uh(e)==="symbol"?e:String(e)}function CAe(t,e){if(Uh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _Ae=function(t){wAe(r,t);var e=SAe(r);function r(n,i,o,a){var s;return vAe(this,r),s=e.call(this,n,i,ta,o,a),EAe(Vq(s),"cachedFixedRowsBottom",-1),s.cachedFixedRowsBottom=s.wtSettings.getSetting("fixedRowsBottom"),s}return bAe(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t2(yAe,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.domBindings.rootWindow,o=this.clone.wtTable.holder.parentNode;o.style.top="";var a=0,s=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===i&&(!s||s!=="vertical")?(a=this.getOverlayOffset(),o.style.bottom="".concat(a,"px")):(a=this.getScrollPosition(),this.repositionOverlay());var l=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),l}},{key:"repositionOverlay",value:function(){var i=this.wot,o=i.wtTable,a=i.wtViewport,s=this.domBindings.rootDocument,l=this.clone.wtTable.holder.parentNode,u=0;a.hasVerticalScroll()||(u+=a.getWorkspaceHeight()-o.getTotalHeight()),a.hasVerticalScroll()&&a.hasHorizontalScroll()&&(u+=yn(s)),l.style.bottom="".concat(u,"px")}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===o?(o.scrollTo(ph(o),i),a=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wot,s=a.wtTable,l=a.wtSettings,u=l.getSetting("defaultRowHeight"),c=i,f=0;c<o;){var h=s.getRowHeight(c);f+=h===void 0?u:h,c+=1}return f}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot,o=i.wtTable,a=i.wtViewport,s=this.domBindings,l=s.rootDocument,u=s.rootWindow,c=yn(l),f=this.clone.wtTable.holder.parentNode,h=f.style,d=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==u||d==="horizontal"){var p=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(p-=c),p=Math.min(p,o.wtRootElement.scrollWidth),h.width="".concat(p,"px")}else h.width="";this.clone.wtTable.holder.style.width=h.width;var m=wr(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(m=0),h.height="".concat(m,"px")}},{key:"adjustRootChildrenSize",value:function(){var i=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height=i.parentNode.style.height}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[i]=""}},{key:"scrollTo",value:function(i,o){var a=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;o&&l.offsetHeight!==l.clientHeight&&(u=yn(this.domBindings.rootDocument)),o?(a+=this.sumCellSizes(0,i+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),i),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return J2(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===i&&(!o||o!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l,c=this.domBindings.rootDocument.documentElement.clientHeight;a=Math.max(this.getTableParentOffset()-this.getScrollPosition()-c+s,0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(i){var o=this.wtSettings.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==o,s=this.wtSettings.getSetting("columnHeaders"),l=!1;if((a||o===0)&&s.length>0){var u=this.wot.wtTable.holder.parentNode,c=at(u,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),i||this.wtSettings.getSetting("totalRows")===0?(Re(u,"innerBorderBottom"),l=!c):(ut(u,"innerBorderBottom"),l=c)}return l}}]),r}($1),TAe="calculatedRows",zq={getFirstRenderedRow:function(){var e=this.dataAccessObject.startRowRendered;return e===null?-1:e},getFirstVisibleRow:function(){var e=this.dataAccessObject.startRowVisible;return e===null?-1:e},getLastRenderedRow:function(){var e=this.dataAccessObject.endRowRendered;return e===null?-1:e},getLastVisibleRow:function(){var e=this.dataAccessObject.endRowVisible;return e===null?-1:e},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Os(zq,"MIXIN_NAME",TAe,{writable:!1,enumerable:!1});const Gq=zq;function Vh(t){return Vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vh(t)}function G$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,AAe(n.key),n)}}function OAe(t,e,r){return e&&G$(t.prototype,e),r&&G$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function AAe(t){var e=xAe(t,"string");return Vh(e)==="symbol"?e:String(e)}function xAe(t,e){if(Vh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function MAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tO(t,e)}function tO(t,e){return tO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},tO(t,e)}function NAe(t){var e=$Ae();return function(){var n=Sw(t),i;if(e){var o=Sw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return PAe(this,i)}}function PAe(t,e){if(e&&(Vh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kAe(t)}function kAe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $Ae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sw(t){return Sw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sw(t)}var b3=function(t){MAe(r,t);var e=NAe(r);function r(n,i,o,a){return IAe(this,r),e.call(this,n,i,o,a,Qu)}return OAe(r)}(Vp);ir(b3,Gq);ir(b3,p3);const LAe=b3;function jh(t){return jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jh(t)}function r2(t,e,r){return Yq()?r2=Reflect.construct.bind():r2=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&Rw(u,a.prototype),u},r2.apply(null,arguments)}function DAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,HAe(n.key),n)}}function FAe(t,e,r){return e&&Y$(t.prototype,e),r&&Y$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function HAe(t){var e=BAe(t,"string");return jh(e)==="symbol"?e:String(e)}function BAe(t,e){if(jh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rw(t,e)}function Rw(t,e){return Rw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Rw(t,e)}function VAe(t){var e=Yq();return function(){var n=Ew(t),i;if(e){var o=Ew(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return jAe(this,i)}}function jAe(t,e){if(e&&(jh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WAe(t)}function WAe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Yq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ew(t){return Ew=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ew(t)}var zAe=function(t){UAe(r,t);var e=VAe(r);function r(n,i,o,a){return DAe(this,r),e.call(this,n,i,Qu,o,a)}return FAe(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r2(LAe,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot.wtTable;if(!this.needFullRender||!i.holder.parentNode)return!1;var o=this.domBindings.rootWindow,a=this.clone.wtTable.holder.parentNode,s=this.wtSettings.getSetting("preventOverflow"),l=0;this.trimmingContainer===o&&(!s||s!=="horizontal")?(l=this.getOverlayOffset()*(this.isRtl()?-1:1),K8(a,"".concat(l,"px"),"0px")):(l=this.getScrollPosition(),C6(a));var u=this.adjustHeaderBordersPosition(l);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,a=!1;return this.isRtl()&&(i=-i),this.mainTableScrollableElement===o&&o.scrollX!==i?(o.scrollTo(i,Ng(o)),a=!0):this.mainTableScrollableElement.scrollLeft!==i&&(this.mainTableScrollableElement.scrollLeft=i,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wtSettings.getSetting("defaultColumnWidth"),s=i,l=0;s<o;)l+=this.wot.wtTable.getStretchedColumnWidth(s)||a,s+=1;return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,o=this.domBindings,a=o.rootDocument,s=o.rootWindow,l=yn(a),u=this.clone.wtTable.holder.parentNode,c=u.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||f==="vertical"){var h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=l),h=Math.min(h,i.wtRootElement.scrollHeight),c.height="".concat(h,"px")}else c.height="";this.clone.wtTable.holder.style.height=c.height;var d=Qt(this.clone.wtTable.TABLE);c.width="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,o=this.clone.wtTable.holder,a=this.wot.selections,s=this.facadeGetter(),l=Math.abs((i=a==null?void 0:a.getCell().getBorder(s).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.height=this.hider.style.height,o.style.height=o.parentNode.style.height,o.style.width="".concat(parseInt(o.parentNode.style.width,10)+l,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalColumns"),o=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style[o]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(i,o){var a=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,u=0;if(o){var c=this.wot.wtTable.getColumnWidth(i),f=this.wot.wtViewport.getViewportWidth();c>f&&(o=!1)}return o&&l.offsetWidth!==l.clientWidth&&(u=yn(this.domBindings.rootDocument)),o?(a+=this.sumCellSizes(0,i+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),i),a+=u,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var i=this.wtSettings.getSetting("preventOverflow"),o=0;return!i&&this.trimmingContainer===this.domBindings.rootWindow&&(o=this.wot.wtTable.holderOffset.left),o}},{key:"getScrollPosition",value:function(){return Math.abs(vT(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===i&&(!o||o!=="horizontal")){this.isRtl()?a=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var s=this.wot.wtTable.getTotalWidth(),l=this.clone.wtTable.getTotalWidth(),u=s-l;a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(i){var o=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("rowHeaders"),s=this.wtSettings.getSetting("fixedColumnsStart"),l=this.wtSettings.getSetting("totalRows");l?ut(o,"emptyRows"):Re(o,"emptyRows");var u=!1;if(s&&!a.length)Re(o,"innerBorderLeft innerBorderInlineStart");else if(!s&&a.length){var c=at(o,"innerBorderInlineStart");i?(Re(o,"innerBorderLeft innerBorderInlineStart"),u=!c):(ut(o,"innerBorderLeft innerBorderInlineStart"),u=c)}return u}}]),r}($1),GAe="stickyRowsTop",Kq={getFirstRenderedRow:function(){var e=this.wtSettings.getSetting("totalRows");return e===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Os(Kq,"MIXIN_NAME",GAe,{writable:!1,enumerable:!1});const qq=Kq;function Wh(t){return Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wh(t)}function K$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,KAe(n.key),n)}}function YAe(t,e,r){return e&&K$(t.prototype,e),r&&K$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function KAe(t){var e=qAe(t,"string");return Wh(e)==="symbol"?e:String(e)}function qAe(t,e){if(Wh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rO(t,e)}function rO(t,e){return rO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},rO(t,e)}function ZAe(t){var e=t4e();return function(){var n=Cw(t),i;if(e){var o=Cw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return JAe(this,i)}}function JAe(t,e){if(e&&(Wh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return e4e(t)}function e4e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function t4e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cw(t){return Cw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cw(t)}var w3=function(t){QAe(r,t);var e=ZAe(r);function r(n,i,o,a){return XAe(this,r),e.call(this,n,i,o,a,Zu)}return YAe(r)}(Vp);ir(w3,qq);ir(w3,p3);const r4e=w3;function zh(t){return zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zh(t)}function n2(t,e,r){return Xq()?n2=Reflect.construct.bind():n2=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&_w(u,a.prototype),u},n2.apply(null,arguments)}function n4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function q$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qq(n.key),n)}}function i4e(t,e,r){return e&&q$(t.prototype,e),r&&q$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function o4e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_w(t,e)}function _w(t,e){return _w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_w(t,e)}function a4e(t){var e=Xq();return function(){var n=Tw(t),i;if(e){var o=Tw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return s4e(this,i)}}function s4e(t,e){if(e&&(zh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nO(t)}function nO(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tw(t){return Tw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tw(t)}function X$(t,e,r){return e=Qq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qq(t){var e=l4e(t,"string");return zh(e)==="symbol"?e:String(e)}function l4e(t,e){if(zh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var u4e=function(t){o4e(r,t);var e=a4e(r);function r(n,i,o,a,s,l){var u;return n4e(this,r),u=e.call(this,n,i,Zu,o,a),X$(nO(u),"topOverlay",void 0),X$(nO(u),"inlineStartOverlay",void 0),u.topOverlay=s,u.inlineStartOverlay=l,u}return i4e(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n2(r4e,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var o=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),a=this.topOverlay.getOverlayOffset();K8(i,"".concat(o,"px"),"".concat(a,"px"))}else C6(i);var s=wr(this.clone.wtTable.TABLE),l=Qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),i.style.height="".concat(s,"px"),i.style.width="".concat(l,"px"),!1}}]),r}($1);function Gh(t){return Gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gh(t)}function Q$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f4e(n.key),n)}}function c4e(t,e,r){return e&&Q$(t.prototype,e),r&&Q$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function f4e(t){var e=h4e(t,"string");return Gh(e)==="symbol"?e:String(e)}function h4e(t,e){if(Gh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function d4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p4e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&iO(t,e)}function iO(t,e){return iO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},iO(t,e)}function m4e(t){var e=v4e();return function(){var n=Ow(t),i;if(e){var o=Ow(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return g4e(this,i)}}function g4e(t,e){if(e&&(Gh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y4e(t)}function y4e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v4e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ow(t){return Ow=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ow(t)}var S3=function(t){p4e(r,t);var e=m4e(r);function r(n,i,o,a){return d4e(this,r),e.call(this,n,i,o,a,Xu)}return c4e(r)}(Vp);ir(S3,qq);ir(S3,y3);const b4e=S3;function Yh(t){return Yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yh(t)}function i2(t,e,r){return Jq()?i2=Reflect.construct.bind():i2=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&Aw(u,a.prototype),u},i2.apply(null,arguments)}function w4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Z$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,eX(n.key),n)}}function S4e(t,e,r){return e&&Z$(t.prototype,e),r&&Z$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function R4e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Aw(t,e)}function Aw(t,e){return Aw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Aw(t,e)}function E4e(t){var e=Jq();return function(){var n=xw(t),i;if(e){var o=xw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return C4e(this,i)}}function C4e(t,e){if(e&&(Yh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zq(t)}function Zq(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xw(t){return xw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xw(t)}function _4e(t,e,r){return e=eX(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eX(t){var e=T4e(t,"string");return Yh(e)==="symbol"?e:String(e)}function T4e(t,e){if(Yh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var O4e=function(t){R4e(r,t);var e=E4e(r);function r(n,i,o,a){var s;return w4e(this,r),s=e.call(this,n,i,Xu,o,a),_4e(Zq(s),"cachedFixedRowsTop",-1),s.cachedFixedRowsTop=s.wtSettings.getSetting("fixedRowsTop"),s}return S4e(r,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return i2(b4e,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var i=this.clone.wtTable.holder.parentNode,o=this.domBindings.rootWindow,a=this.wtSettings.getSetting("preventOverflow"),s=0,l=!1;if(this.trimmingContainer===o&&(!a||a!=="vertical")){var u=this.wot.wtTable,c=u.hider.getBoundingClientRect(),f=Math.ceil(c.bottom),h=i.offsetHeight;l=f===h,s=this.getOverlayOffset(),K8(i,"0px","".concat(s,"px"))}else s=this.getScrollPosition(),C6(i);var d=this.adjustHeaderBordersPosition(s,l);return this.adjustElementsSize(),d}},{key:"setScrollPosition",value:function(i){var o=this.domBindings.rootWindow,a=!1;return this.mainTableScrollableElement===o&&o.scrollY!==i?(o.scrollTo(ph(o),i),a=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,a=!0),a}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wtSettings.getSetting("defaultRowHeight"),s=i,l=0;s<o;){var u=this.wot.wtTable.getRowHeight(s);l+=u===void 0?a:u,s+=1}return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot.wtTable,o=this.domBindings,a=o.rootDocument,s=o.rootWindow,l=yn(a),u=this.clone.wtTable.holder.parentNode,c=u.style,f=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||f==="horizontal"){var h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=l),h=Math.min(h,i.wtRootElement.scrollWidth),c.width="".concat(h,"px")}else c.width="";this.clone.wtTable.holder.style.width=c.width;var d=wr(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(d=0),c.height="".concat(d,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,o=this.clone.wtTable.holder,a=this.wot.selections,s=this.facadeGetter(),l=Math.abs((i=a==null?void 0:a.getCell().getBorder(s).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height="".concat(parseInt(o.parentNode.style.height,10)+l,"px")}},{key:"applyToDOM",value:function(){var i=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var i=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[i]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[i]=""}},{key:"scrollTo",value:function(i,o){var a=this.wot,s=this.wtSettings,l=a.cloneSource?a.cloneSource:a,u=l.wtTable.holder,c=this.getTableParentOffset(),f=0;if(o){var h=this.wot.wtTable.getRowHeight(i),d=this.wot.wtViewport.getViewportHeight();h>d&&(o=!1)}if(o&&u.offsetHeight!==u.clientHeight&&(f=yn(this.domBindings.rootDocument)),o){var p=s.getSetting("fixedRowsBottom"),m=s.getSetting("totalRows");c+=this.sumCellSizes(0,i+1),c-=a.wtViewport.getViewportHeight()-this.sumCellSizes(m-p,m),c+=1}else c+=this.sumCellSizes(s.getSetting("fixedRowsTop"),i);return c+=f,this.setScrollPosition(c)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return J2(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var i=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),a=0;if(this.trimmingContainer===i&&(!o||o!=="vertical")){var s=this.wot.wtTable.getTotalHeight(),l=this.clone.wtTable.getTotalHeight(),u=s-l;a=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),a>u&&(a=0)}return a}},{key:"adjustHeaderBordersPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,s=this.wtSettings.getSetting("totalColumns");s?ut(a,"emptyColumns"):Re(a,"emptyColumns");var l=!1;if(!o){var u=this.wtSettings.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==u,f=this.wtSettings.getSetting("columnHeaders");if((c||u===0)&&f.length>0){var h=at(a,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),i||this.wtSettings.getSetting("totalRows")===0?(Re(a,"innerBorderTop"),l=!h):(ut(a,"innerBorderTop"),l=h)}}return l}}]),r}($1);function sy(t){return sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sy(t)}function js(t,e,r){return A4e()?js=Reflect.construct.bind():js=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),u=new l;return a&&oO(u,a.prototype),u},js.apply(null,arguments)}function A4e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function oO(t,e){return oO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},oO(t,e)}function x4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function J$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tX(n.key),n)}}function I4e(t,e,r){return e&&J$(t.prototype,e),r&&J$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ca(t,e,r){return e=tX(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tX(t){var e=M4e(t,"string");return sy(e)==="symbol"?e:String(e)}function M4e(t,e){if(sy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(sy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var N4e=function(){function t(e,r,n,i,o,a){var s=this;x4e(this,t),Ca(this,"wot",null),Ca(this,"topOverlay",null),Ca(this,"bottomOverlay",null),Ca(this,"inlineStartOverlay",null),Ca(this,"topInlineStartCornerOverlay",null),Ca(this,"bottomInlineStartCornerOverlay",null),Ca(this,"browserLineHeight",void 0),Ca(this,"wtSettings",null),Ca(this,"resizeObserver",new ResizeObserver(function(h){G8(function(){!Array.isArray(h)||!h.length||s.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var l=this.domBindings,u=l.rootDocument,c=l.rootWindow;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=yn(u);var f=c.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=f?a.holder:ew(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}return I4e(t,[{key:"getOverlays",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return r&&n.push(this.wtTable),n}},{key:"initBrowserLineHeight",value:function(){var r=this.domBindings,n=r.rootWindow,i=r.rootDocument,o=n.getComputedStyle(i.body),a=parseInt(o.lineHeight,10),s=parseInt(o.fontSize,10)*1.2;this.browserLineHeight=a||s}},{key:"initOverlays",value:function(){var r=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=js(O4e,r),this.bottomOverlay=js(_Ae,r),this.inlineStartOverlay=js(zAe,r),this.topInlineStartCornerOverlay=js(u4e,r.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=js(aAe,r.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var r=this.topOverlay.updateStateOfRendering();return r=this.bottomOverlay.updateStateOfRendering()||r,r=this.inlineStartOverlay.updateStateOfRendering()||r,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(r=this.topInlineStartCornerOverlay.updateStateOfRendering()||r),this.bottomOverlay.needFullRender&&(r=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||r)),r}},{key:"refreshAll",value:function(){if(!!this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var r=this,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,s=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(i.documentElement,"keydown",function(p){return r.onKeyDown(p)}),this.eventManager.addEventListener(i.documentElement,"keyup",function(){return r.onKeyUp()}),this.eventManager.addEventListener(i,"visibilitychange",function(){return r.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(p){return r.onTableScroll(p)},{passive:!0}),a!==s&&this.eventManager.addEventListener(s,"scroll",function(p){return r.onTableScroll(p)},{passive:!0});var l=o.devicePixelRatio&&o.devicePixelRatio>1,u=this.scrollableElement===o,c=this.wtSettings.getSetting("preventWheel"),f={passive:u};(c||l||!RK())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(p){return r.onCloneWheel(p,c)},f);var h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(function(p){if(p&&p.needFullRender){var m=p.clone.wtTable.holder;r.eventManager.addEventListener(m,"wheel",function(g){return r.onCloneWheel(g,c)},f)}});var d;this.eventManager.addEventListener(o,"resize",function(){clearTimeout(d),d=setTimeout(function(){r.wtSettings.getSetting("onWindowResize")},200)}),u||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(r){var n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,a=r.target;this.keyPressed&&(o!==n&&a!==n&&!r.target.contains(o)||i!==n&&a!==n&&!r.target.contains(i))||this.syncScrollPositions(r)}},{key:"onCloneWheel",value:function(r,n){var i=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,s=r.target,l=a!==i&&s!==i&&!s.contains(a),u=o!==i&&s!==i&&!s.contains(o);if(!(this.keyPressed&&(l||u))){var c=this.translateMouseWheelToScroll(r);(n||this.scrollableElement!==i&&c)&&r.preventDefault()}}},{key:"onKeyDown",value:function(r){this.keyPressed=Ig(r.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(r){var n=isNaN(r.deltaY)?-1*r.wheelDeltaY:r.deltaY,i=isNaN(r.deltaX)?-1*r.wheelDeltaX:r.deltaX;r.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);var o=this.scrollVertically(n),a=this.scrollHorizontally(i);return o||a}},{key:"scrollVertically",value:function(r){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=r,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(r){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=r,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var r=this.domBindings.rootWindow,n=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,o=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=o[0],s=o[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==r.scrollX,this.verticalScrolling=i.scrollTop!==s||this.lastScrollY!==r.scrollY,this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY,this.horizontalScrolling){n.scrollLeft=a;var l=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;l&&(l.scrollLeft=a)}this.verticalScrolling&&(i.scrollTop=s),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var r=this.topOverlay.mainTableScrollableElement,n=r.scrollLeft,i=r.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var r=this.wtTable,n=this.domBindings.rootWindow;n.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=r.holder:this.scrollableElement=ew(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.updateLastSpreaderSize();n&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(r),this.inlineStartOverlay.refresh(r),this.topOverlay.refresh(r),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(r),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(r)}},{key:"updateLastSpreaderSize",value:function(){var r=this.wtTable.spreader,n=r.clientWidth,i=r.clientHeight,o=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),o}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtViewport,i=this.wtTable,o=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),l=n.getColumnHeaderHeight(),u=i.hider.style;if(u.width="".concat(s+this.inlineStartOverlay.sumCellSizes(0,o),"px"),u.height="".concat(l+this.topOverlay.sumCellSizes(0,a)+1,"px"),this.scrollbarSize>0){var c=i.wtRootElement,f=c.scrollHeight,h=c.scrollWidth,d=i.holder,p=d.scrollHeight,m=d.scrollWidth;this.hasScrollbarRight=f<p,this.hasScrollbarBottom=h<m,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>f&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(r),this.inlineStartOverlay.adjustElementsSize(r),this.bottomOverlay.adjustElementsSize(r)}},{key:"applyToDOM",value:function(){!this.wtTable.isVisible()||(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(r){if(!r)return null;var n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return Q(n,function(o){!o||o.clone&&o.clone.wtTable.TABLE.contains(r)&&(i=o.clone)}),i}},{key:"syncOverlayTableClassNames",value:function(){var r=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Q(n,function(i){!i||(i.clone.wtTable.TABLE.className=r.className)})}}]),t}();const P4e=N4e;function ly(t){return ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ly(t)}function k4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rX(n.key),n)}}function $4e(t,e,r){return e&&eL(t.prototype,e),r&&eL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function tL(t,e,r){return e=rX(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rX(t){var e=L4e(t,"string");return ly(e)==="symbol"?e:String(e)}function L4e(t,e){if(ly(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ly(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var D4e=function(){function t(e){var r=this;k4e(this,t),tL(this,"settings",{}),tL(this,"defaults",Object.freeze(this.getDefaults())),St(this.defaults,function(n,i){if(e[i]!==void 0)r.settings[i]=e[i];else{if(n===void 0)throw new Error('A required setting "'.concat(i,'" was not provided'));r.settings[i]=n}})}return $4e(t,[{key:"getDefaults",value:function(){var r=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return r.getSetting("fixedColumnsStart")>0||r.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return r.getSetting("fixedRowsTop")>0||r.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return r.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(i,o,a){var s=r.getSetting("data",i,o);Gu(a,s==null?"":s)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(i){return i},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(i){return i},onBeforeHighlightingColumnHeader:function(i){return i},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(r,n){var i=this;return n===void 0?St(r,function(o,a){i.settings[a]=o}):this.settings[r]=n,this}},{key:"getSetting",value:function(r,n,i,o,a){return typeof this.settings[r]=="function"?this.settings[r](n,i,o,a):n!==void 0&&Array.isArray(this.settings[r])?this.settings[r][n]:this.settings[r]}},{key:"getSettingPure",value:function(r){return this.settings[r]}},{key:"has",value:function(r){return!!this.settings[r]}}]),t}();function Kh(t){return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kh(t)}function F4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,B4e(n.key),n)}}function H4e(t,e,r){return e&&rL(t.prototype,e),r&&rL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function B4e(t){var e=U4e(t,"string");return Kh(e)==="symbol"?e:String(e)}function U4e(t,e){if(Kh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function V4e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&aO(t,e)}function aO(t,e){return aO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},aO(t,e)}function j4e(t){var e=G4e();return function(){var n=Iw(t),i;if(e){var o=Iw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return W4e(this,i)}}function W4e(t,e){if(e&&(Kh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return z4e(t)}function z4e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function G4e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Iw(t){return Iw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Iw(t)}var R3=function(t){V4e(r,t);var e=j4e(r);function r(n,i,o,a){return F4e(this,r),e.call(this,n,i,o,a,"master")}return H4e(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var i=Pg(this.wtRootElement),o=this.domBindings.rootWindow;if(i===o){var a=this.wtSettings.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var s=i.parentElement,l=kg(i,"height",o),u=kg(i,"overflow",o),c=this.holder.style,f=i.scrollWidth,h=i.scrollHeight,d=i.getBoundingClientRect(),p=d.width,m=d.height,g=["auto","hidden","scroll"];if(s&&g.includes(u)){var v=i.cloneNode(!1);v.style.overflow="auto",v.style.position="absolute",i.nextElementSibling?s.insertBefore(v,i.nextElementSibling):s.appendChild(v);var S=parseInt(Yu(v,o).height,10);s.removeChild(v),S===0&&(m=0)}m=Math.min(m,h),c.height=l==="auto"?"auto":"".concat(m,"px"),p=Math.min(p,f),c.width="".concat(p,"px"),c.overflow="",this.hasTableHeight=c.height==="auto"?!0:m>0,this.hasTableWidth=p>0}this.isTableVisible=Mg(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var i=this.wtSettings,o=this.dataAccessObject.wtViewport,a="master",s=i.getSetting("columnHeaders"),l=s.length;if(l&&!o.hasOversizedColumnHeadersMarked[a]){for(var u=i.getSetting("rowHeaders"),c=u.length,f=this.getRenderedColumnsCount(),h=0;h<l;h++)for(var d=-1*c;d<f;d++)this.markIfOversizedColumnHeader(d);o.hasOversizedColumnHeadersMarked[a]=!0}}}]),r}(Vp);ir(R3,Gq);ir(R3,y3);const Y4e=R3;function uy(t){return uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uy(t)}function K4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,X4e(n.key),n)}}function q4e(t,e,r){return e&&nL(t.prototype,e),r&&nL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function X4e(t){var e=Q4e(t,"string");return uy(e)==="symbol"?e:String(e)}function Q4e(t,e){if(uy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(uy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Z4e=function(){function t(e,r,n,i,o){var a=this;K4e(this,t),this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return q4e(t,[{key:"getWorkspaceHeight",value:function(){var r=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,i=0;if(n===this.domBindings.rootWindow)i=r.documentElement.clientHeight;else{var o=wr(n);i=o>0&&n.clientHeight>0?n.clientHeight:1/0}return i}},{key:"getWorkspaceWidth",value:function(){var r=this.wtSettings,n=this.domBindings,i=n.rootDocument,o=n.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=i.documentElement.offsetWidth,l=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),c=r.getSetting("rtlMode"),f=this.wtTable.TABLE.getBoundingClientRect(),h=c?f.right-s:f.left,d=s-h,p,m;if(u)return Qt(this.wtTable.wtRootElement);if(r.getSetting("freezeOverlays")?p=Math.min(d,s):p=Math.min(this.getContainerFillWidth(),d,s),a===o&&l>0&&this.sumColumnWidths(0,l-1)>p)return i.documentElement.clientWidth;if(a!==o&&(m=kg(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o),m==="scroll"||m==="hidden"||m==="auto"))return Math.max(p,a.clientWidth);var g=r.getSetting("stretchH");return g==="none"||!g?Math.max(p,Qt(this.wtTable.TABLE)):p}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(r,n){for(var i=0,o=r;o<n;)i+=this.wtTable.getColumnWidth(o),o+=1;return i}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var r=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",r.appendChild(n);var i=n.offsetWidth;return this.containerWidth=i,r.removeChild(n),i}},{key:"getWorkspaceOffset",value:function(){return Zr(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var r=this.wtSettings.getSetting("columnHeaders");return r.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=wr(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var r=this.getWorkspaceHeight();if(r===1/0)return r;var n=this.getColumnHeaderHeight();return n>0&&(r-=n),r}},{key:"getRowHeaderWidth",value:function(){var r=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(r){this.rowHeaderWidth=0;for(var i=0,o=n.length;i<o;i++)this.rowHeaderWidth+=r[i]||r}if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var s=0,l=n.length;s<l;s++)a?(this.rowHeaderWidth+=Qt(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var r=this.getWorkspaceWidth();if(r===1/0)return r;var n=this.getRowHeaderWidth();return n>0?r-n:r}},{key:"createRowsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:eu,n=this.wtSettings,i=this.wtTable,o,a,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&r===eu?o=1/0:o=this.getViewportHeight();var l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,u=n.getSetting("fixedRowsTop"),c=n.getSetting("fixedRowsBottom"),f=n.getSetting("totalRows");return u&&l>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,u),l+=s,o-=s),c&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(f-c,f),o-=s),i.holder.clientHeight===i.holder.offsetHeight?a=0:a=yn(this.domBindings.rootDocument),new Eq({viewportSize:o,scrollOffset:l,totalItems:n.getSetting("totalRows"),itemSizeFn:function(d){return i.getRowHeight(d)},overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:a})}},{key:"createColumnsCalculator",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:eu,n=this.wtSettings,i=this.wtTable,o=this.getViewportWidth(),a=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var s=n.getSetting("fixedColumnsStart");if(s&&a>=0){var l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);a+=l,o-=l}return i.holder.clientWidth!==i.holder.offsetWidth&&(o-=yn(this.domBindings.rootDocument)),new h3({viewportSize:o,scrollOffset:a,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(c){return i.getColumnWidth(c)},overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:r,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(c,f){return n.getSetting("onBeforeStretchingColumnWidth",c,f)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=r;if(n){var i=this.createRowsCalculator(Dn),o=this.createColumnsCalculator(Dn);this.areAllProposedVisibleRowsAlreadyRendered(i)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(eu),this.columnsRenderCalculator=this.createColumnsCalculator(eu)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(Dn),this.columnsVisibleCalculator=this.createColumnsCalculator(Dn)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(r){if(!this.rowsVisibleCalculator)return!1;var n=r.startRow,i=r.endRow,o=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!o;var a=this.rowsRenderCalculator,s=a.startRow,l=a.endRow;return n<s||n===s&&n>0?!1:!(i>l||i===l&&i<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(r){if(!this.columnsVisibleCalculator)return!1;var n=r.startColumn,i=r.endColumn,o=r.isVisibleInTrimmingContainer;if(n===null&&i===null)return!o;var a=this.columnsRenderCalculator,s=a.startColumn,l=a.endColumn;return n<s||n===s&&n>0?!1:!(i>l||i===l&&i<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){St(this.hasOversizedColumnHeadersMarked,function(r,n,i){i[n]=void 0})}}]),t}();const J4e=Z4e;function qh(t){return qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qh(t)}function e8e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,r8e(n.key),n)}}function t8e(t,e,r){return e&&iL(t.prototype,e),r&&iL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function r8e(t){var e=n8e(t,"string");return qh(e)==="symbol"?e:String(e)}function n8e(t,e){if(qh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function i8e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sO(t,e)}function sO(t,e){return sO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sO(t,e)}function o8e(t){var e=s8e();return function(){var n=Mw(t),i;if(e){var o=Mw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return a8e(this,i)}}function a8e(t,e){if(e&&(qh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lO(t)}function lO(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s8e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mw(t){return Mw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mw(t)}var l8e=function(t){i8e(r,t);var e=o8e(r);function r(n,i){var o;e8e(this,r),o=e.call(this,n,new D4e(i));var a=o.wtSettings.getSetting("facade",lO(o));return o.wtTable=new Y4e(o.getTableDao(),a,o.domBindings,o.wtSettings),o.wtViewport=new J4e(o.getViewportDao(),o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.selections=o.wtSettings.getSetting("selections"),o.wtEvent=new Aq(a,o.domBindings,o.wtSettings,o.eventManager,o.wtTable,o.selections),o.wtOverlays=new P4e(lO(o),a,o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.exportSettingsAsClassNames(),o.findOriginalHeaders(),o}return t8e(r,[{key:"exportSettingsAsClassNames",value:function(){var i=this,o={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},a=[],s=[];St(o,function(l,u){i.wtSettings.getSetting(u).length&&s.push(l),a.push(l)}),ut(this.wtTable.wtRootElement.parentNode,a),Re(this.wtTable.wtRootElement.parentNode,s)}},{key:"getViewportDao",value:function(){var i=this;return{get wot(){return i},get topOverlayTrimmingContainer(){return i.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return i.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return i.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return i.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return i.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return i.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return i.wtOverlays.topOverlay},get inlineStartOverlay(){return i.wtOverlays.inlineStartOverlay},get bottomOverlay(){return i.wtOverlays.bottomOverlay}}}}]),r}(g3);function cy(t){return cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cy(t)}function u8e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f8e(n.key),n)}}function c8e(t,e,r){return e&&oL(t.prototype,e),r&&oL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function f8e(t){var e=h8e(t,"string");return cy(e)==="symbol"?e:String(e)}function h8e(t,e){if(cy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(cy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var d8e=function(){function t(e){u8e(this,t),e instanceof g3?this._wot=e:this._initFromSettings(e)}return c8e(t,[{key:"_initFromSettings",value:function(r){r.facade=function(n){var i=new t(n);return function(){return i}},this._wot=new l8e(r.table,r)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(r){this._wot.drawn=r}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(r){this._wot.drawInterrupted=r}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(r){this._wot.lastMouseOver=r}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(r){this._wot.momentumScrolling=r}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(r){this._wot.touchApplied=r}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(r){this._wot.eventListeners=r}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(r,n){return this._wot.createCellCoords(r,n)}},{key:"createCellRange",value:function(r,n,i){return this._wot.createCellRange(r,n,i)}},{key:"draw",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(r),this}},{key:"getCell",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(r,n)}},{key:"scrollViewport",value:function(r,n,i,o,a){return this._wot.scrollViewport(r,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wot.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wot.scrollViewportVertically(r,n,i)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(r,n){return this._wot.wtSettings.update(r,n),this}},{key:"getSetting",value:function(r,n,i,o,a){return this._wot.wtSettings.getSetting(r,n,i,o,a)}},{key:"hasSetting",value:function(r){return this._wot.wtSettings.hasSetting(r)}},{key:"destroy",value:function(){this._wot.destroy()}}]),t}(),p8e=zr,nX=mt,m8e=f1,g8e=Li,y8e=m1.f,v8e=nX(y8e),b8e=nX([].push),aL=function(t){return function(e){for(var r=g8e(e),n=m8e(r),i=n.length,o=0,a=[],s;i>o;)s=n[o++],(!p8e||v8e(r,s))&&b8e(a,t?[s,r[s]]:r[s]);return a}},w8e={entries:aL(!0),values:aL(!1)},S8e=tt,R8e=w8e.values;S8e({target:"Object",stat:!0},{values:function(e){return R8e(e)}});function fy(t){return fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fy(t)}function PE(t,e){return T8e(t)||_8e(t,e)||C8e(t,e)||E8e()}function E8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C8e(t,e){if(!!t){if(typeof t=="string")return sL(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sL(t,e)}}function sL(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _8e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function T8e(t){if(Array.isArray(t))return t}function O8e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,x8e(n.key),n)}}function A8e(t,e,r){return e&&lL(t.prototype,e),r&&lL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function x8e(t){var e=I8e(t,"string");return fy(e)==="symbol"?e:String(e)}function I8e(t,e){if(fy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var M8e=function(){function t(e,r){O8e(this,t),r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return A8e(t,[{key:"registerListeners",value:function(){var r=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return r.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return r.onMouseUp()});for(var i=function(l){var u=r.main.childNodes[l];r.eventManager.addEventListener(u,"mouseenter",function(c){return r.onMouseEnter(c,r.main.childNodes[l])})},o=0,a=this.main.childNodes.length;o<a;o++)i(o)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(r,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;r.preventDefault(),la(r);var i=this,o=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function s(u){if(u.clientY<Math.floor(a.top)||u.clientY>Math.ceil(a.top+a.height)||u.clientX<Math.floor(a.left)||u.clientX>Math.ceil(a.left+a.width))return!0}function l(u){s(u)&&(i.eventManager.removeEventListener(o,"mousemove",l),n.style.display="block")}this.eventManager.addEventListener(o,"mousemove",l)}},{key:"createBorders",value:function(r){var n=this.wot.rootDocument;this.main=n.createElement("div");var i=["top","start","bottom","end","corner"],o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(var a=0;a<5;a++){var s=i[a],l=n.createElement("div");l.className="wtBorder ".concat(this.settings.className||""),this.settings[s]&&this.settings[s].hide&&(l.className+=" hidden"),o=l.style,o.backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:r.border.color,o.height=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),o.width=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(r.border.width,"px"),this.main.appendChild(l)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),na()&&this.createMultipleSelectorHandles(),this.disappear();var u=this.wot.wtTable,c=u.bordersHolder;c||(c=n.createElement("div"),c.className="htBorders",u.bordersHolder=c,u.spreader.appendChild(c)),c.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var r=this,n=this.wot.rootDocument;this.selectionHandles={top:n.createElement("DIV"),topHitArea:n.createElement("DIV"),bottom:n.createElement("DIV"),bottomHitArea:n.createElement("DIV")};var i=10,o=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var a={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px")};St(a,function(l,u){r.selectionHandles.styles.bottomHitArea[u]=l,r.selectionHandles.styles.topHitArea[u]=l});var s={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};St(s,function(l,u){r.selectionHandles.styles.bottom[u]=l,r.selectionHandles.styles.top[u]=l}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(r,n){var i=this.wot.selections.createOrGetArea();return!!(i.cellRange&&(r!==i.cellRange.to.row||n!==i.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(r,n,i,o,a,s){var l=this.wot.wtSettings.getSetting("rtlMode"),u=l?"right":"left",c=this.selectionHandles.styles,f=c.top,h=c.topHitArea,d=c.bottom,p=c.bottomHitArea,m=parseInt(f.borderWidth,10),g=parseInt(f.width,10),v=parseInt(h.width,10),S=this.wot.wtTable.getWidth(),b=this.wot.wtTable.getHeight();f.top="".concat(parseInt(i-g-1,10),"px"),f[u]="".concat(parseInt(o-g-1,10),"px"),h.top="".concat(parseInt(i-v/4*3,10),"px"),h[u]="".concat(parseInt(o-v/4*3,10),"px");var E=Math.min(parseInt(o+a,10),S-g-m*2),T=Math.min(parseInt(o+a-v/4,10),S-v-m*2);d[u]="".concat(E,"px"),p[u]="".concat(T,"px");var N=Math.min(parseInt(i+s,10),b-g-m*2),L=Math.min(parseInt(i+s-v/4,10),b-v-m*2);d.top="".concat(N,"px"),p.top="".concat(L,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(f.display="block",h.display="block",this.isPartRange(r,n)?(d.display="none",p.display="none"):(d.display="block",p.display="block")):(f.display="none",d.display="none",h.display="none",p.display="none"),r===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(f.zIndex="9999",h.zIndex="9999"):(f.zIndex="",h.zIndex="")}},{key:"appear",value:function(r){if(!this.disabled){for(var n=this.wot,i=n.wtTable,o=n.rootDocument,a=n.rootWindow,s,l,u,c,f,h,d=i.getRenderedRowsCount(),p=0;p<d;p+=1){var m=i.rowFilter.renderedToSource(p);if(m>=r[0]&&m<=r[2]){s=m,f=r[0];break}}for(var g=d-1;g>=0;g-=1){var v=i.rowFilter.renderedToSource(g);if(v>=r[0]&&v<=r[2]){l=v;break}}for(var S=i.getRenderedColumnsCount(),b=0;b<S;b+=1){var E=i.columnFilter.renderedToSource(b);if(E>=r[1]&&E<=r[3]){u=E,h=r[1];break}}for(var T=S-1;T>=0;T-=1){var N=i.columnFilter.renderedToSource(T);if(N>=r[1]&&N<=r[3]){c=N;break}}if(s===void 0||u===void 0){this.disappear();return}var L=i.getCell(this.wot.createCellCoords(s,u)),V=s!==l||u!==c,B=V?i.getCell(this.wot.createCellCoords(l,c)):L,k=Zr(L),M=V?Zr(B):k,G=Zr(i.TABLE),j=Qt(i.TABLE),q=k.top,te=k.left,pe=this.wot.wtSettings.getSetting("rtlMode"),ne=0,O=0;if(pe){var y=Qt(L),R=a.innerWidth-G.left-j;O=te+y-M.left,ne=a.innerWidth-te-y-R-1}else O=M.left+Qt(B)-te,ne=te-G.left-1;if(this.isEntireColumnSelected(s,l)){var C=this.getDimensionsFromHeader("columns",u,c,f,G),A=null;if(C){var P=PE(C,3);A=P[0],ne=P[1],O=P[2]}A&&(L=A)}var H=q-G.top-1,Y=M.top+wr(B)-q;if(this.isEntireRowSelected(u,c)){var z=this.getDimensionsFromHeader("rows",s,l,h,G),oe=null;if(z){var me=PE(z,3);oe=me[0],H=me[1],Y=me[2]}oe&&(L=oe)}var re=Yu(L,a);parseInt(re.borderTopWidth,10)>0&&(H+=1,Y=Y>0?Y-1:0),parseInt(re[pe?"borderRightWidth":"borderLeftWidth"],10)>0&&(ne+=1,O=O>0?O-1:0);var ge=pe?"right":"left";this.topStyle.top="".concat(H,"px"),this.topStyle[ge]="".concat(ne,"px"),this.topStyle.width="".concat(O,"px"),this.topStyle.display="block",this.startStyle.top="".concat(H,"px"),this.startStyle[ge]="".concat(ne,"px"),this.startStyle.height="".concat(Y,"px"),this.startStyle.display="block";var ve=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(H+Y-ve,"px"),this.bottomStyle[ge]="".concat(ne,"px"),this.bottomStyle.width="".concat(O,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(H,"px"),this.endStyle[ge]="".concat(ne+O-ve,"px"),this.endStyle.height="".concat(Y+1,"px"),this.endStyle.display="block";var ie=this.settings.border.cornerVisible;ie=typeof ie=="function"?ie(this.settings.layerLevel):ie;var be=this.wot.getSetting("onModifyGetCellCoords",l,c),ce=l,_e=c;if(be&&Array.isArray(be)){var Ie=PE(be,4);ce=Ie[2],_e=Ie[3]}if(na()||!ie||this.isPartRange(ce,_e))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(H+Y+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[ge]="".concat(ne+O+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var Oe=Pg(i.TABLE),Ae=Oe===a;Ae&&(Oe=o.documentElement);var xe=parseInt(this.cornerDefaultStyle.width,10)/2,I=parseInt(this.cornerDefaultStyle.height,10)/2;if(c===this.wot.getSetting("totalColumns")-1){var D=Ae?B.getBoundingClientRect().left:B.offsetLeft,U=!1,ae=0;pe?(ae=D-parseInt(this.cornerDefaultStyle.width,10)/2,U=ae<0):(ae=D+Qt(B)+parseInt(this.cornerDefaultStyle.width,10)/2,U=ae>=Kb(Oe)),U&&(this.cornerStyle[ge]="".concat(Math.floor(ne+O+this.cornerCenterPointOffset-xe),"px"),this.cornerStyle[pe?"borderLeftWidth":"borderRightWidth"]=0)}if(l===this.wot.getSetting("totalRows")-1){var X=Ae?B.getBoundingClientRect().top:B.offsetTop,le=X+wr(B)+parseInt(this.cornerDefaultStyle.height,10)/2,ee=le>=zs(Oe);ee&&(this.cornerStyle.top="".concat(Math.floor(H+Y+this.cornerCenterPointOffset-I),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}na()&&this.updateMultipleSelectionHandlesPosition(l,c,H,ne,O,Y)}}},{key:"isEntireColumnSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(r,n){return r===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(r,n,i,o,a){var s=this.wot.wtTable,l=s.wtRootElement.parentNode,u=null,c=null,f=null,h=null,d=null,p=null,m=null,g=null;switch(r){case"rows":u=function(){return s.getRowHeader.apply(s,arguments)},c=function(){return wr.apply(void 0,arguments)},f="ht__selection--rows",p="top";break;case"columns":u=function(){return s.getColumnHeader.apply(s,arguments)},c=function(){return Qt.apply(void 0,arguments)},f="ht__selection--columns",p="left";break}if(l.classList.contains(f)){var v=this.wot.getSetting("columnHeaders").length;if(m=u(n,v-o),g=u(i,v-o),!m||!g)return!1;var S=Zr(m),b=Zr(g);return m&&g&&(h=S[p]-a[p]-1,d=b[p]+c(g)-S[p]),[m,h,d]}return!1}},{key:"changeBorderStyle",value:function(r,n){var i=this[r].style,o=n[r];!o||o.hide?Re(this[r],"hidden"):(at(this[r],"hidden")&&ut(this[r],"hidden"),i.backgroundColor=o.color,(r==="top"||r==="bottom")&&(i.height="".concat(o.width,"px")),(r==="start"||r==="end")&&(i.width="".concat(o.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(r){var n={width:1,color:"#000"},i=this[r].style;i.backgroundColor=n.color,i.width="".concat(n.width,"px"),i.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(r,n){this.changeBorderToDefaultStyle(r),n?Re(this[r],"hidden"):ut(this[r],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",na()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),t}();const N8e=M8e;function P8e(t,e){return D8e(t)||L8e(t,e)||$8e(t,e)||k8e()}function k8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $8e(t,e){if(!!t){if(typeof t=="string")return uL(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uL(t,e)}}function uL(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function L8e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function D8e(t){if(Array.isArray(t))return t}function Xh(t){return Xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xh(t)}function F8e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,B8e(n.key),n)}}function H8e(t,e,r){return e&&cL(t.prototype,e),r&&cL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function B8e(t){var e=U8e(t,"string");return Xh(e)==="symbol"?e:String(e)}function U8e(t,e){if(Xh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var V8e=function(){function t(e,r){F8e(this,t),this.settings=e,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return H8e(t,[{key:"getBorder",value:function(r){return this.instanceBorders[r.guid]||(this.instanceBorders[r.guid]=new N8e(r,this.settings)),this.instanceBorders[r.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(r){return this.isEmpty()?this.cellRange=this.settings.createCellRange(r):this.cellRange.expand(r),this}},{key:"replace",value:function(r,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(r))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(r))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var r=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[r.row,r.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(r,n,i,o){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=r.wtTable.getCell(this.settings.createCellCoords(n,i));if(Xh(s)==="object"){var l=o;a&&(l=this.classNameGenerator(s),this.classNames.includes(l)||this.classNames.push(l)),Re(s,l)}return this}},{key:"linearClassNameGenerator",value:function(r,n){return function i(o){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return r;var s=a>=0?a:n,l=r;s-=1;var u=s===0?r:"".concat(r,"-").concat(s);if(at(o,u)){var c=s+1;l="".concat(r,"-").concat(c)}else l=i(o,s);return l}}},{key:"draw",value:function(r){if(this.isEmpty()){this.settings.border&&this.getBorder(r).disappear();return}var n=r.wtTable.getRenderedRowsCount(),i=r.wtTable.getRenderedColumnsCount(),o=this.getCorners(),a=P8e(o,4),s=a[0],l=a[1],u=a[2],c=a[3],f=this.settings,h=f.highlightHeaderClassName,d=f.highlightColumnClassName,p=f.highlightRowClassName,m=f.highlightOnlyClosestHeader,g=f.selectionType,v=g===void 0||["active-header","header"].includes(g);if(v&&l!==null&&c!==null)for(var S=0,b=0;b<i;b+=1){var E=r.wtTable.columnFilter.renderedToSource(b);if(E>=l&&E<=c){var T=r.wtTable.getColumnHeaders(E),N=T.length-1;m&&T.length>1&&(T=[T[N]]);for(var L=0;L<T.length;L+=1){var V=[],B=T[L];h&&V.push(h),d&&V.push(d),L=m?N:L;var k=r.getSetting("onBeforeHighlightingColumnHeader",E,L,{selectionType:g,columnCursor:S,selectionWidth:c-l+1,classNames:V});k!==E&&(B=r.wtTable.getColumnHeader(k,L)),Re(B,V)}S+=1}}if(s!==null&&u!==null)for(var M=0,G=0;G<n;G+=1){var j=r.wtTable.rowFilter.renderedToSource(G);if(v&&j>=s&&j<=u){var q=r.wtTable.getRowHeaders(j),te=q.length-1;m&&q.length>1&&(q=[q[te]]);for(var pe=0;pe<q.length;pe+=1){var ne=[],O=q[pe];h&&ne.push(h),p&&ne.push(p),pe=m?te:pe;var y=r.getSetting("onBeforeHighlightingRowHeader",j,pe,{selectionType:g,rowCursor:M,selectionHeight:u-s+1,classNames:ne});y!==j&&(O=r.wtTable.getRowHeader(y,pe)),Re(O,ne)}M+=1}if(l!==null&&c!==null)for(var R=0;R<i;R+=1){var C=r.wtTable.columnFilter.renderedToSource(R);j>=s&&j<=u&&C>=l&&C<=c?this.settings.className&&this.addClassAtCoords(r,j,C,this.settings.className,this.settings.markIntersections):j>=s&&j<=u?p&&this.addClassAtCoords(r,j,C,p):C>=l&&C<=c&&d&&this.addClassAtCoords(r,j,C,d);var A=r.getSetting("onAfterDrawSelection",j,C,this.settings.layerLevel);typeof A=="string"&&this.addClassAtCoords(r,j,C,A)}}r.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(r).appear(o)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(r){return r.destroy()})}}]),t}();const j8e=V8e;var W8e=tt,z8e=Rc.findIndex,G8e=h1,uO="findIndex",iX=!0;uO in[]&&Array(1)[uO](function(){iX=!1});W8e({target:"Array",proto:!0,forced:iX},{findIndex:function(e){return z8e(this,e,arguments.length>1?arguments[1]:void 0)}});G8e(uO);var Y8e="localHooks",oX={_localHooks:Object.create(null),addLocalHook:function(e,r){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(r),this},runLocalHooks:function(e,r,n,i,o,a,s){if(this._localHooks[e])for(var l=this._localHooks[e].length,u=0;u<l;u++)bT(this._localHooks[e][u],this,r,n,i,o,a,s)},clearLocalHooks:function(){return this._localHooks={},this}};Os(oX,"MIXIN_NAME",Y8e,{writable:!1,enumerable:!1});const Si=oX;function hy(t){return hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hy(t)}function K8e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,X8e(n.key),n)}}function q8e(t,e,r){return e&&fL(t.prototype,e),r&&fL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function X8e(t){var e=Q8e(t,"string");return hy(e)==="symbol"?e:String(e)}function Q8e(t,e){if(hy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(hy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _c=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;K8e(this,t),this.indexedValues=[],this.initValueOrFn=e}return q8e(t,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(r){var n=this.indexedValues;if(r<n.length)return n[r]}},{key:"setValues",value:function(r){this.indexedValues=r.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(r,n){return r<this.indexedValues.length?(this.indexedValues[r]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,sr(this.initValueOrFn)?Ye(n-1,function(i){return r.indexedValues.push(r.initValueOrFn(i))}):Ye(n-1,function(){return r.indexedValues.push(r.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(r){return this.setDefaultValues(r),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),t}();ir(_c,Si);function kE(t){return t3e(t)||e3e(t)||J8e(t)||Z8e()}function Z8e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J8e(t,e){if(!!t){if(typeof t=="string")return cO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cO(t,e)}}function e3e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function t3e(t){if(Array.isArray(t))return cO(t)}function cO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function E3(t,e,r,n){var i=r.length?r[0]:void 0;return[].concat(kE(t.slice(0,i)),kE(r.map(function(o,a){return sr(n)?n(o,a):n})),kE(i===void 0?[]:t.slice(i)))}function C3(t,e){return eo(t,function(r,n){return e.includes(n)===!1})}function Qh(t){return Qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qh(t)}function r3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i3e(n.key),n)}}function n3e(t,e,r){return e&&hL(t.prototype,e),r&&hL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function i3e(t){var e=o3e(t,"string");return Qh(e)==="symbol"?e:String(e)}function o3e(t,e){if(Qh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tg(){return typeof Reflect<"u"&&Reflect.get?tg=Reflect.get.bind():tg=function(e,r,n){var i=a3e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},tg.apply(this,arguments)}function a3e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ju(t),t!==null););return t}function s3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fO(t,e)}function fO(t,e){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fO(t,e)}function l3e(t){var e=f3e();return function(){var n=Ju(t),i;if(e){var o=Ju(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return u3e(this,i)}}function u3e(t,e){if(e&&(Qh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c3e(t)}function c3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ju(t){return Ju=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ju(t)}var Cl=function(t){s3e(r,t);var e=l3e(r);function r(){return r3e(this,r),e.apply(this,arguments)}return n3e(r,[{key:"insert",value:function(i,o){this.indexedValues=E3(this.indexedValues,i,o,this.initValueOrFn),tg(Ju(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=C3(this.indexedValues,i),tg(Ju(r.prototype),"remove",this).call(this,i)}}]),r}(_c);function Zh(t){return Zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zh(t)}function h3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p3e(n.key),n)}}function d3e(t,e,r){return e&&dL(t.prototype,e),r&&dL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function p3e(t){var e=m3e(t,"string");return Zh(e)==="symbol"?e:String(e)}function m3e(t,e){if(Zh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function g3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hO(t,e)}function hO(t,e){return hO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hO(t,e)}function y3e(t){var e=w3e();return function(){var n=Nw(t),i;if(e){var o=Nw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return v3e(this,i)}}function v3e(t,e){if(e&&(Zh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return b3e(t)}function b3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nw(t){return Nw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Nw(t)}var A6=function(t){g3e(r,t);var e=y3e(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return h3e(this,r),e.call(this,n)}return d3e(r,[{key:"getHiddenIndexes",value:function(){return Hn(this.getValues(),function(i,o,a){return o&&i.push(a),i},[])}}]),r}(Cl);function $E(t){return C3e(t)||E3e(t)||R3e(t)||S3e()}function S3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R3e(t,e){if(!!t){if(typeof t=="string")return dO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dO(t,e)}}function E3e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function C3e(t){if(Array.isArray(t))return dO(t)}function dO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _3(t,e,r){return[].concat($E(t.slice(0,e)),$E(r),$E(t.slice(e)))}function dy(t,e){return eo(t,function(r){return e.includes(r)===!1})}function T3(t,e){return bt(t,function(r){return r-e.filter(function(n){return n<r}).length})}function O3(t,e){var r=e[0],n=e.length;return bt(t,function(i){return i>=r?i+n:i})}function Jh(t){return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jh(t)}function _3e(t){return x3e(t)||A3e(t)||O3e(t)||T3e()}function T3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function O3e(t,e){if(!!t){if(typeof t=="string")return pO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pO(t,e)}}function A3e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function x3e(t){if(Array.isArray(t))return pO(t)}function pO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function I3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sX(n.key),n)}}function M3e(t,e,r){return e&&pL(t.prototype,e),r&&pL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ha(){return typeof Reflect<"u"&&Reflect.get?Ha=Reflect.get.bind():Ha=function(e,r,n){var i=N3e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ha.apply(this,arguments)}function N3e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ro(t),t!==null););return t}function P3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mO(t,e)}function mO(t,e){return mO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mO(t,e)}function k3e(t){var e=L3e();return function(){var n=Ro(t),i;if(e){var o=Ro(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return $3e(this,i)}}function $3e(t,e){if(e&&(Jh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aX(t)}function aX(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function L3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ro(t){return Ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ro(t)}function D3e(t,e,r){return e=sX(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sX(t){var e=F3e(t,"string");return Jh(e)==="symbol"?e:String(e)}function F3e(t,e){if(Jh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var x6=function(t){P3e(r,t);var e=k3e(r);function r(){var n;I3e(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),D3e(aX(n),"orderOfIndexes",[]),n}return M3e(r,[{key:"getValues",value:function(){var i=this;return this.orderOfIndexes.map(function(o){return i.indexedValues[o]})}},{key:"setValues",value:function(i){this.orderOfIndexes=_3e(Array(i.length).keys()),Ha(Ro(r.prototype),"setValues",this).call(this,i)}},{key:"setValueAtIndex",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return i<this.indexedValues.length?(this.indexedValues[i]=o,this.orderOfIndexes.includes(i)===!1&&this.orderOfIndexes.splice(a,0,i),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(i){this.orderOfIndexes=dy(this.orderOfIndexes,[i]),sr(this.initValueOrFn)?Ha(Ro(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn(i)):Ha(Ro(r.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,Ha(Ro(r.prototype),"setDefaultValues",this).call(this,i)}},{key:"insert",value:function(i,o){this.indexedValues=E3(this.indexedValues,i,o,this.initValueOrFn),this.orderOfIndexes=O3(this.orderOfIndexes,o),Ha(Ro(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=C3(this.indexedValues,i),this.orderOfIndexes=dy(this.orderOfIndexes,i),this.orderOfIndexes=T3(this.orderOfIndexes,i),Ha(Ro(r.prototype),"remove",this).call(this,i)}},{key:"getEntries",value:function(){var i=this;return this.orderOfIndexes.map(function(o){return[o,i.getValueAtIndex(o)]})}}]),r}(_c);function ed(t){return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ed(t)}function H3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,U3e(n.key),n)}}function B3e(t,e,r){return e&&mL(t.prototype,e),r&&mL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function U3e(t){var e=V3e(t,"string");return ed(e)==="symbol"?e:String(e)}function V3e(t,e){if(ed(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function j3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gO(t,e)}function gO(t,e){return gO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gO(t,e)}function W3e(t){var e=Y3e();return function(){var n=Pw(t),i;if(e){var o=Pw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return z3e(this,i)}}function z3e(t,e){if(e&&(ed(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G3e(t)}function G3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Y3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pw(t){return Pw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pw(t)}var L1=function(t){j3e(r,t);var e=W3e(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return H3e(this,r),e.call(this,n)}return B3e(r,[{key:"getTrimmedIndexes",value:function(){return Hn(this.getValues(),function(i,o,a){return o&&i.push(a),i},[])}}]),r}(Cl),gL=new Map([["indexesSequence",{getListWithInsertedItems:_3,getListWithRemovedItems:dy}],["physicallyIndexed",{getListWithInsertedItems:E3,getListWithRemovedItems:C3}]]),lX=function(e){if(gL.has(e)===!1)throw new Error("Alter strategy with ID '".concat(e,"' does not exist."));return gL.get(e)};function td(t){return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},td(t)}function K3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,X3e(n.key),n)}}function q3e(t,e,r){return e&&yL(t.prototype,e),r&&yL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function X3e(t){var e=Q3e(t,"string");return td(e)==="symbol"?e:String(e)}function Q3e(t,e){if(td(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rg(){return typeof Reflect<"u"&&Reflect.get?rg=Reflect.get.bind():rg=function(e,r,n){var i=Z3e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},rg.apply(this,arguments)}function Z3e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ec(t),t!==null););return t}function J3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yO(t,e)}function yO(t,e){return yO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yO(t,e)}function exe(t){var e=nxe();return function(){var n=ec(t),i;if(e){var o=ec(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return txe(this,i)}}function txe(t,e){if(e&&(td(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rxe(t)}function rxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ec(t){return ec=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ec(t)}var uX=function(t){J3e(r,t);var e=exe(r);function r(){return K3e(this,r),e.call(this,function(n){return n})}return q3e(r,[{key:"insert",value:function(i,o){var a=O3(this.indexedValues,o);this.indexedValues=_3(a,i,o),rg(ec(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){var o=dy(this.indexedValues,i);this.indexedValues=T3(o,i),rg(ec(r.prototype),"remove",this).call(this,i)}}]),r}(_c),vL=new Map([["hiding",A6],["index",_c],["linkedPhysicalIndexToValue",x6],["physicalIndexToValue",Cl],["trimming",L1]]);function ixe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!vL.has(t))throw new Error('The provided map type ("'.concat(t,'") does not exist.'));return new(vL.get(t))(e)}function py(t){return py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},py(t)}function oxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sxe(n.key),n)}}function axe(t,e,r){return e&&bL(t.prototype,e),r&&bL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function sxe(t){var e=lxe(t,"string");return py(e)==="symbol"?e:String(e)}function lxe(t,e){if(py(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(py(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var A3=function(){function t(){oxe(this,t),this.collection=new Map}return axe(t,[{key:"register",value:function(r,n){var i=this;this.collection.has(r)===!1&&(this.collection.set(r,n),n.addLocalHook("change",function(){return i.runLocalHooks("change",n)}))}},{key:"unregister",value:function(r){var n=this.collection.get(r);He(n)&&(n.destroy(),this.collection.delete(r),this.runLocalHooks("change",n))}},{key:"unregisterAll",value:function(){var r=this;this.collection.forEach(function(n,i){return r.unregister(i)}),this.collection.clear()}},{key:"get",value:function(r){return tr(r)?Array.from(this.collection.values()):this.collection.get(r)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(r){this.collection.forEach(function(n){n.remove(r)})}},{key:"insertToEvery",value:function(r,n){this.collection.forEach(function(i){i.insert(r,n)})}},{key:"initEvery",value:function(r){this.collection.forEach(function(n){n.init(r)})}}]),t}();ir(A3,Si);function rd(t){return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rd(t)}function uxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fxe(n.key),n)}}function cxe(t,e,r){return e&&wL(t.prototype,e),r&&wL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function fxe(t){var e=hxe(t,"string");return rd(e)==="symbol"?e:String(e)}function hxe(t,e){if(rd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dxe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vO(t,e)}function vO(t,e){return vO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vO(t,e)}function pxe(t){var e=yxe();return function(){var n=kw(t),i;if(e){var o=kw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return mxe(this,i)}}function mxe(t,e){if(e&&(rd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gxe(t)}function gxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kw(t){return kw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kw(t)}var SL=function(t){dxe(r,t);var e=pxe(r);function r(n,i){var o;return uxe(this,r),o=e.call(this),o.mergedValuesCache=[],o.aggregationFunction=n,o.fallbackValue=i,o}return cxe(r,[{key:"getMergedValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(i===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var o=bt(this.get(),function(f){return f.getValues()}),a=[],s=He(o[0])&&o[0].length||0,l=0;l<s;l+=1){for(var u=[],c=0;c<this.getLength();c+=1)u.push(o[c][l]);a.push(u)}return bt(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(i,o){var a=this.getMergedValues(o)[i];return He(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(A3);function my(t){return my=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},my(t)}function vxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function RL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wxe(n.key),n)}}function bxe(t,e,r){return e&&RL(t.prototype,e),r&&RL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wxe(t){var e=Sxe(t,"string");return my(e)==="symbol"?e:String(e)}function Sxe(t,e){if(my(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(my(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rxe(t,e,r){Exe(t,e),e.set(t,r)}function Exe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cxe(t,e,r){var n=cX(t,e,"set");return _xe(t,n,r),r}function _xe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function Txe(t,e){var r=cX(t,e,"get");return Oxe(t,r)}function cX(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function Oxe(t,e){return e.get?e.get.call(t):e.value}var LE=new WeakMap,fX=function(){function t(){vxe(this,t),Rxe(this,LE,{writable:!0,value:[]})}return bxe(t,[{key:"subscribe",value:function(r){return this.addLocalHook("change",r),this._write(Txe(this,LE)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(r){return r.length>0&&this.runLocalHooks("change",r),this}},{key:"_writeInitialChanges",value:function(r){Cxe(this,LE,r)}}]),t}();ir(fX,Si);function EL(t,e){for(var r=[],n=0,i=0;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function gy(t){return gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gy(t)}function Axe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function CL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ixe(n.key),n)}}function xxe(t,e,r){return e&&CL(t.prototype,e),r&&CL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ixe(t){var e=Mxe(t,"string");return gy(e)==="symbol"?e:String(e)}function Mxe(t,e){if(gy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(gy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cm(t,e,r){Nxe(t,e),e.set(t,r)}function Nxe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hi(t,e){var r=hX(t,e,"get");return Pxe(t,r)}function Pxe(t,e){return e.get?e.get.call(t):e.value}function A0(t,e,r){var n=hX(t,e,"set");return kxe(t,n,r),r}function hX(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function kxe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var x0=new WeakMap,fm=new WeakMap,I0=new WeakMap,M0=new WeakMap,N0=new WeakMap,$xe=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.initialIndexValue;Axe(this,t),cm(this,x0,{writable:!0,value:new Set}),cm(this,fm,{writable:!0,value:[]}),cm(this,I0,{writable:!0,value:[]}),cm(this,M0,{writable:!0,value:!1}),cm(this,N0,{writable:!0,value:!1}),A0(this,N0,r!=null?r:!1)}return xxe(t,[{key:"createObserver",value:function(){var r=this,n=new fX;return Hi(this,x0).add(n),n.addLocalHook("unsubscribe",function(){Hi(r,x0).delete(n)}),n._writeInitialChanges(EL(Hi(this,fm),Hi(this,I0))),n}},{key:"emit",value:function(r){var n=Hi(this,I0);(!Hi(this,M0)||Hi(this,fm).length!==r.length)&&(r.length===0?r=new Array(n.length).fill(Hi(this,N0)):A0(this,fm,new Array(r.length).fill(Hi(this,N0))),Hi(this,M0)||(A0(this,M0,!0),n=Hi(this,fm)));var i=EL(n,r);Hi(this,x0).forEach(function(o){return o._write(i)}),A0(this,I0,r)}}]),t}();function yy(t){return yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yy(t)}var _L;function DE(t){return Hxe(t)||Fxe(t)||Dxe(t)||Lxe()}function Lxe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dxe(t,e){if(!!t){if(typeof t=="string")return bO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bO(t,e)}}function Fxe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Hxe(t){if(Array.isArray(t))return bO(t)}function bO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Bxe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Uxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jxe(n.key),n)}}function Vxe(t,e,r){return e&&TL(t.prototype,e),r&&TL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function jxe(t){var e=Wxe(t,"string");return yy(e)==="symbol"?e:String(e)}function Wxe(t,e){if(yy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(yy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var OL=new Set(["getFirstNotHiddenIndex"]),wO=function(){function t(){var e=this;Uxe(this,t),this.indexesSequence=new uX,this.trimmingMapsCollection=new SL(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new SL(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new A3,this.hidingChangesObservable=new $xe({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){e.indexesSequenceChanged=!0,e.updateCache(),e.runLocalHooks("change",e.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){e.trimmedIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",r,e.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){e.hiddenIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",r,e.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){e.runLocalHooks("change",r,e.variousMapsCollection)})}return Vxe(t,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(r){if(r!=="hiding")throw new Error('Unsupported index map type "'.concat(r,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(r,n,i){return this.registerMap(r,ixe(n,i))}},{key:"registerMap",value:function(r,n){if(this.trimmingMapsCollection.get(r)||this.hidingMapsCollection.get(r)||this.variousMapsCollection.get(r))throw Error('Map with name "'.concat(r,'" has been already registered.'));n instanceof L1?this.trimmingMapsCollection.register(r,n):n instanceof A6?this.hidingMapsCollection.register(r,n):this.variousMapsCollection.register(r,n);var i=this.getNumberOfIndexes();return i>0&&n.init(i),n}},{key:"unregisterMap",value:function(r){this.trimmingMapsCollection.unregister(r),this.hidingMapsCollection.unregister(r),this.variousMapsCollection.unregister(r)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(r){var n=this.notTrimmedIndexesCache[r];return He(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(r){var n=this.renderablePhysicalIndexesCache[r];return He(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(r){var n=this.fromPhysicalToVisualIndexesCache.get(r);return He(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(r){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(r))}},{key:"getRenderableFromVisualIndex",value:function(r){var n=this.fromVisualToRenderableIndexesCache.get(r);return He(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r-n;OL.has("getFirstNotHiddenIndex")&&(OL.delete("getFirstNotHiddenIndex"),Xt(Gt(_L||(_L=Bxe([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var a=this.getPhysicalFromVisualIndex(r);return a===null?i===!0&&o!==r-n?this.getFirstNotHiddenIndex(o,-n,!1,o):null:this.isHidden(a)===!1?r:this.getFirstNotHiddenIndex(r+n,n,i,o)}},{key:"getNearestNotHiddenIndex",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.getPhysicalFromVisualIndex(r);if(o===null)return null;if(this.fromVisualToRenderableIndexesCache.has(r))return r;var a=Array.from(this.fromVisualToRenderableIndexesCache.keys()),s=-1;return n>0?s=a.findIndex(function(l){return l>r}):s=a.reverse().findIndex(function(l){return l<r}),s===-1?i?this.getNearestNotHiddenIndex(r,-n,!1):null:a[s]}},{key:"initToLength",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=DE(new Array(r).keys()),this.notHiddenIndexesCache=DE(new Array(r).keys()),this.suspendOperations(),this.indexesSequence.init(r),this.trimmingMapsCollection.initEvery(r),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(r),this.variousMapsCollection.initEvery(r),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(r){var n=this.getNumberOfIndexes();if(r<n){var i=DE(Array(this.getNumberOfIndexes()-r).keys()).map(function(o){return o+r});this.removeIndexes(i)}else this.insertIndexes(n,r-n)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(r){this.indexesSequence.setValues(r)}},{key:"getNotTrimmedIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var i=this.getIndexesSequence();return i.filter(function(o){return r.isTrimmed(o)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var i=this.getIndexesSequence();return i.filter(function(o){return r.isHidden(o)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var i=this.getNotTrimmedIndexes();return i.filter(function(o){return r.isHidden(o)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(r,n){var i=this;typeof r=="number"&&(r=[r]);var o=bt(r,function(f){return i.getPhysicalFromVisualIndex(f)}),a=this.getNotTrimmedIndexesLength(),s=r.length,l=dy(this.getIndexesSequence(),o),u=a-s;if(n+s<a){var c=l.filter(function(f){return i.isTrimmed(f)===!1})[n];u=l.indexOf(c)}this.setIndexesSequence(_3(l,u,o))}},{key:"isTrimmed",value:function(r){return this.trimmingMapsCollection.getMergedValueAtIndex(r)}},{key:"isHidden",value:function(r){return this.hidingMapsCollection.getMergedValueAtIndex(r)}},{key:"insertIndexes",value:function(r,n){var i=this.getNotTrimmedIndexes()[r],o=He(i)?i:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=bt(new Array(n).fill(o),function(l,u){return l+u});this.suspendOperations(),this.indexesSequence.insert(a,s),this.trimmingMapsCollection.insertToEvery(a,s),this.hidingMapsCollection.insertToEvery(a,s),this.variousMapsCollection.insertToEvery(a,s),this.resumeOperations()}},{key:"removeIndexes",value:function(r){this.suspendOperations(),this.indexesSequence.remove(r),this.trimmingMapsCollection.removeFromEvery(r),this.hidingMapsCollection.removeFromEvery(r),this.variousMapsCollection.removeFromEvery(r),this.resumeOperations()}},{key:"updateCache",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(r===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var r=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var r=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<r;n+=1){var i=this.getPhysicalFromRenderableIndex(n),o=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(o,n)}}}]),t}();ir(wO,Si);function nd(t){return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nd(t)}function AL(t,e){return Kxe(t)||Yxe(t,e)||Gxe(t,e)||zxe()}function zxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gxe(t,e){if(!!t){if(typeof t=="string")return xL(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xL(t,e)}}function xL(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Yxe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function Kxe(t){if(Array.isArray(t))return t}function qxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function IL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qxe(n.key),n)}}function Xxe(t,e,r){return e&&IL(t.prototype,e),r&&IL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qxe(t){var e=Zxe(t,"string");return nd(e)==="symbol"?e:String(e)}function Zxe(t,e){if(nd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ou(){return typeof Reflect<"u"&&Reflect.get?ou=Reflect.get.bind():ou=function(e,r,n){var i=Jxe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ou.apply(this,arguments)}function Jxe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ja(t),t!==null););return t}function eIe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&SO(t,e)}function SO(t,e){return SO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},SO(t,e)}function tIe(t){var e=nIe();return function(){var n=ja(t),i;if(e){var o=ja(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return rIe(this,i)}}function rIe(t,e){if(e&&(nd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dX(t)}function dX(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ja(t){return ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ja(t)}Ue.getSingleton().register("modifyAutoColumnSizeSeed");var hm="autoColumnSize",iIe=10,FE=new WeakMap,oIe="autoColumnSize",aIe=function(t){eIe(r,t);var e=tIe(r);function r(n){var i;return qxe(this,r),i=e.call(this,n),FE.set(dX(i),{cachedColumnHeaders:[]}),i.ghostTable=new bq(i.hot),i.samplesGenerator=new Rq(function(o,a){var s=i.hot.getCellMeta(o,a),l="";s.spanned||(l=i.hot.getDataAtCell(o,a));var u="";return i.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=i.hot.runHooks("modifyAutoColumnSizeSeed",u,s,l)),{value:l,bundleSeed:u}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredColumns=0,i.columnWidthsMap=new Cl,i.hot.columnIndexMapper.registerMap(oIe,i.columnWidthsMap),i.addHook("beforeColumnResize",function(o,a,s){return i.onBeforeColumnResize(o,a,s)}),i}return Xxe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[hm]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[hm];o&&o.useHeaders!==null&&o.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",o.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(a){return i.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return i.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return i.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,s){return i.getColumnWidth(s,a)}),this.addHook("afterInit",function(){return i.onAfterInit()}),ou(ja(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var i=this.findColumnsWhereHeaderWasChanged();i.length&&(this.clearCache(i),this.calculateVisibleColumnsWidth()),ou(ja(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=this;ou(ja(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(o,a,s){return i.onBeforeColumnResize(o,a,s)})}},{key:"calculateVisibleColumnsWidth",value:function(){var i=this.hot.countRows();if(!!i){var o=this.hot.renderCall,a=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn();a===-1||s===-1||this.calculateColumnsWidth({from:a,to:s},void 0,o)}}},{key:"calculateColumnsWidth",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof o=="number"?{from:o,to:o}:o,u=typeof a=="number"?{from:a,to:a}:a;Ye(l.from,l.to,function(c){var f=i.hot.toPhysicalColumn(c);if(f===null&&(f=c),s||i.columnWidthsMap.getValueAtIndex(f)===null&&!i.hot._getColWidthFromSettings(f)){var h=i.samplesGenerator.generateColumnSamples(c,u);Q(h,function(d){var p=AL(d,2),m=p[0],g=p[1];return i.ghostTable.addColumn(m,g)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){i.ghostTable.getWidths(function(c,f){var h=i.hot.toPhysicalColumn(c);i.columnWidthsMap.setValueAtIndex(h,f)})},!0),this.measuredColumns=l.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,s=this.hot.countCols()-1,l=null;this.inProgress=!0;var u=function f(){if(!i.hot){X2(l),i.inProgress=!1;return}i.calculateColumnsWidth({from:a,to:Math.min(a+r.CALCULATION_STEP,s)},o),a=a+r.CALCULATION_STEP+1,a<s?l=G8(f):(X2(l),i.inProgress=!1,i.hot.view.adjustElementsSize())},c=this.getSyncCalculationLimit();this.firstCalculation&&c>=0&&(this.calculateColumnsWidth({from:0,to:c},o),this.firstCalculation=!1,a=c+1),a<s?u():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[hm],o=i&&Nr(i,"samplingRatio")?i.samplingRatio:void 0,a=i&&Nr(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[hm],o=r.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return wt(i)&&(o=i.syncLimit,$K(o)?o=QK(a,o):o>>=0),Math.min(o,a)}},{key:"getColumnWidth",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=o;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(i)),a&&typeof s=="number"&&(s=Math.max(s,h3.DEFAULT_WIDTH))),s}},{key:"getFirstVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var o=i.wtTable.getFirstVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(i.wtViewport.columnsRenderCalculator){var a=i.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var i=this.hot.view._wt;if(i.wtViewport.columnsVisibleCalculator){var o=i.wtTable.getLastVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(i.wtViewport.columnsRenderCalculator){var a=i.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var i=this.hot.getColHeader(),o=FE.get(this),a=o.cachedColumnHeaders,s=Hn(i,function(l,u,c){var f=a.length;return(f-1<c||a[c]!==u)&&l.push(c),f-1<c?a.push(u):a[c]=u,l},[]);return s}},{key:"clearCache",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];o.length?this.hot.batchExecution(function(){Q(o,function(a){i.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!eo(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){i.hot&&i.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(i){var o=this,a=bt(i,function(s){var l=AL(s,2),u=l[1];return o.hot.toPhysicalColumn(o.hot.propToCol(u))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(i,o,a){var s=i;return a&&(this.calculateColumnsWidth(o,void 0,!0),s=this.getColumnWidth(o,void 0,!1)),s}},{key:"onAfterInit",value:function(){FE.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(i){var o=eo(i,function(s){var l;return He((l=s.address)===null||l===void 0?void 0:l.col)}),a=bt(o,function(s){return s.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),ou(ja(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return hm}},{key:"PLUGIN_PRIORITY",get:function(){return iIe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(jt),au={horizontal:"horizontal",vertical:"vertical"};function sIe(t,e,r,n){var i=r.length,o=r?r[0].length:0,a=[],s=e.row-t.row,l=e.col-t.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],c=0;c<l;c++){var f=parseInt(r[0][c],10),h=parseInt(r[i-1][c],10),d=(n==="down"?h-f:f-h)/(i-1)||0;u.push(d)}a.push(u)}if(["right","left"].indexOf(n)!==-1)for(var p=0;p<s;p++){var m=parseInt(r[p][0],10),g=parseInt(r[p][o-1],10),v=(n==="right"?g-m:m-g)/(o-1)||0;a.push([v])}return a}function lIe(t,e,r){var n,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",n=r(e[0],e[1]),i=r(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",n=r(e[0],t[3]+1),i=r(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",n=r(e[0],e[1]),i=r(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",n=r(t[2]+1,e[1]),i=r(e[2],e[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:n,endOfDragCoords:i}}function uIe(t){var e={};return t===!0?(e.directions=Object.keys(au),e.autoInsertRow=!0):wt(t)?(He(t.autoInsertRow)?t.direction===au.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,He(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(au)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function id(t){return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},id(t)}function cIe(t){return dIe(t)||hIe(t)||pX(t)||fIe()}function fIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hIe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function dIe(t){if(Array.isArray(t))return RO(t)}function pIe(t,e){return yIe(t)||gIe(t,e)||pX(t,e)||mIe()}function mIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pX(t,e){if(!!t){if(typeof t=="string")return RO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RO(t,e)}}function RO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function gIe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function yIe(t){if(Array.isArray(t))return t}function vIe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ML(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wIe(n.key),n)}}function bIe(t,e,r){return e&&ML(t.prototype,e),r&&ML(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wIe(t){var e=SIe(t,"string");return id(e)==="symbol"?e:String(e)}function SIe(t,e){if(id(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function su(){return typeof Reflect<"u"&&Reflect.get?su=Reflect.get.bind():su=function(e,r,n){var i=RIe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},su.apply(this,arguments)}function RIe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Wa(t),t!==null););return t}function EIe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&EO(t,e)}function EO(t,e){return EO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},EO(t,e)}function CIe(t){var e=TIe();return function(){var n=Wa(t),i;if(e){var o=Wa(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _Ie(this,i)}}function _Ie(t,e){if(e&&(id(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mX(t)}function mX(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function TIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wa(t){return Wa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wa(t)}Ue.getSingleton().register("modifyAutofillRange");Ue.getSingleton().register("beforeAutofill");Ue.getSingleton().register("afterAutofill");var NL="autofill",OIe=20,AIe=["fillHandle"],xIe="insert_row_below",IIe=200,MIe=function(t){EIe(r,t);var e=CIe(r);function r(n){var i;return vIe(this,r),i=e.call(this,n),i.eventManager=new Er(mX(i)),i.addingStarted=!1,i.mouseDownOnCellCorner=!1,i.mouseDragOutside=!1,i.handleDraggedCells=0,i.directions=[],i.autoInsertRow=!1,i}return bIe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(o){return i.onAfterCellCornerMouseDown(o)}),this.addHook("afterOnCellCornerDblClick",function(o){return i.onCellCornerDblClick(o)}),this.addHook("beforeOnCellMouseOver",function(o,a){return i.onBeforeCellMouseOver(a)}),su(Wa(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),su(Wa(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),su(Wa(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var i=this,o=this.hot.getSelectedRangeLast(),a=o.getTopStartCorner(),s=a.row,l=a.col,u=o.getBottomEndCorner(),c=u.row,f=u.col,h=this.hot.runHooks("modifyCopyableRange",[{startRow:s,startCol:l,endRow:c,endCol:f}]),d=[],p=[],m=[];return Q(h,function(g){for(var v=g.startRow;v<=g.endRow;v+=1)d.indexOf(v)===-1&&d.push(v);for(var S=g.startCol;S<=g.endCol;S+=1)p.indexOf(S)===-1&&p.push(S)}),Q(d,function(g){var v=[];Q(p,function(S){v.push(i.hot.getCopyableData(g,S))}),m.push(v)}),m}},{key:"fillIn",value:function(){var i=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var o=this.hot.selection.highlight.getFill().getVisualCorners(),a=pIe(o,4),s=a[0],l=a[1],u=a[2],c=a[3],f=this.hot.getSelectedRangeLast(),h=f.getTopStartCorner(),d=f.getBottomEndCorner();this.resetSelectionOfDraggedArea();var p=[h.row,h.col,d.row,d.col],m=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,s),Math.min(h.col,l),Math.max(d.row,u),Math.max(d.col,c)],p),g=lIe(p,m,function(O,y){return i.hot._createCellCoords(O,y)}),v=g.directionOfDrag,S=g.startOfDragCoords,b=g.endOfDragCoords;if(S&&S.row>-1&&S.col>-1){var E=this.getSelectionData(),T=f.clone(),N=this.hot._createCellRange(S,S,b),L=this.hot.runHooks("beforeAutofill",E,T,N,v);if(L===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var V=sIe(S,b,E,v),B=L,k=L;if(["up","left"].indexOf(v)>-1&&!(k.length===1&&k[0].length===0))if(B=[],v==="up")for(var M=b.row-S.row+1,G=M%k.length,j=0;j<M;j++)B.push(k[(j+(k.length-G))%k.length]);else for(var q=b.col-S.col+1,te=q%k[0].length,pe=0;pe<k.length;pe++){B.push([]);for(var ne=0;ne<q;ne++)B[pe].push(k[pe][(ne+(k[pe].length-te))%k[pe].length])}this.hot.populateFromArray(S.row,S.col,B,b.row,b.col,"".concat(this.pluginName,".fill"),null,v,V),this.setSelection(m),this.hot.runHooks("afterAutofill",B,T,N,v),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(i){return i.row<0&&(i.row=0),i.col<0&&(i.col=0),i}},{key:"getCoordsOfDragAndDropBorders",value:function(i){var o=this.hot.getSelectedRangeLast(),a=o.getBottomEndCorner(),s=i;if(this.directions.includes(au.vertical)&&this.directions.includes(au.horizontal)){var l=o.getTopStartCorner();(a.col<=i.col||l.col>=i.col)&&(s=this.hot._createCellCoords(a.row,i.col)),(a.row<i.row||l.row>i.row)&&(s=this.hot._createCellCoords(i.row,a.col))}else if(this.directions.includes(au.vertical))s=this.hot._createCellCoords(i.row,a.col);else if(this.directions.includes(au.horizontal))s=this.hot._createCellCoords(a.row,i.col);else return;return this.reduceSelectionAreaIfNeeded(s)}},{key:"showBorder",value:function(i){var o=this.getCoordsOfDragAndDropBorders(i);o&&this.redrawBorders(o)}},{key:"addRow",value:function(){var i=this;this.hot._registerTimeout(function(){i.hot.alter(xIe,void 0,1,"".concat(i.pluginName,".fill")),i.addingStarted=!1},IIe)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var i=this.hot.getSelectedLast(),o=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();i[2]<a-1&&o[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(i){for(var o=this.hot.getData(),a=this.hot.countRows(),s,l=i[2]+1;l<a;l++){for(var u=i[1];u<=i[3];u++){var c=o[l][u];if(c)return-1}var f=o[l][i[1]-1],h=o[l][i[3]+1];(!!f||!!h)&&(s=l)}return s}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(i,o){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(i[0],i[1])).add(this.hot._createCellCoords(o,i[3])).commit()}},{key:"setSelection",value:function(i){var o;(o=this.hot).selectCell.apply(o,cIe(bt(i,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var i=this.hot.getSelectedLast(),o=this.getIndexOfLastAdjacentFilledInRow(i);return o===-1||o===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(i,o),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(i){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(i).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(i){var o=this.hot.rootDocument.documentElement,a=Zr(this.hot.table).top-(this.hot.rootWindow.pageYOffset||o.scrollTop)+wr(this.hot.table),s=Zr(this.hot.table).left-(this.hot.rootWindow.pageXOffset||o.scrollLeft)+Qt(this.hot.table);return i.clientY>a&&i.clientX<=s}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(o,"mousemove",function(a){return i.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var i=this.selectAdjacent();i&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(i){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(i),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(i){var o=this.getIfMouseWasDraggedOutside(i);this.addingStarted===!1&&this.handleDraggedCells>0&&o?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var i=uIe(this.hot.getSettings().fillHandle);this.directions=i.directions,this.autoInsertRow=i.autoInsertRow}},{key:"destroy",value:function(){su(Wa(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return NL}},{key:"PLUGIN_PRIORITY",get:function(){return OIe}},{key:"SETTING_KEYS",get:function(){return[NL].concat(AIe)}}]),r}(jt);function od(t){return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},od(t)}function NIe(t,e){return LIe(t)||$Ie(t,e)||kIe(t,e)||PIe()}function PIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kIe(t,e){if(!!t){if(typeof t=="string")return PL(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PL(t,e)}}function PL(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function $Ie(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function LIe(t){if(Array.isArray(t))return t}function DIe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,HIe(n.key),n)}}function FIe(t,e,r){return e&&kL(t.prototype,e),r&&kL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function HIe(t){var e=BIe(t,"string");return od(e)==="symbol"?e:String(e)}function BIe(t,e){if(od(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zf(){return typeof Reflect<"u"&&Reflect.get?zf=Reflect.get.bind():zf=function(e,r,n){var i=UIe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},zf.apply(this,arguments)}function UIe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=el(t),t!==null););return t}function VIe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&CO(t,e)}function CO(t,e){return CO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},CO(t,e)}function jIe(t){var e=GIe();return function(){var n=el(t),i;if(e){var o=el(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return WIe(this,i)}}function WIe(t,e){if(e&&(od(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zIe(t)}function zIe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function GIe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function el(t){return el=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},el(t)}var P0="autoRowSize",YIe=40,KIe="autoRowSize",qIe=function(t){VIe(r,t);var e=jIe(r);function r(n){var i;return DIe(this,r),i=e.call(this,n),i.rowHeightsMap=void 0,i.headerHeight=null,i.ghostTable=new bq(i.hot),i.samplesGenerator=new Rq(function(o,a){var s;return o>=0?s=i.hot.getDataAtCell(o,a):o===-1&&(s=i.hot.getColHeader(a)),{value:s}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredRows=0,i.rowHeightsMap=new Cl,i.hot.rowIndexMapper.registerMap(KIe,i.rowHeightsMap),i.addHook("beforeRowResize",function(o,a,s){return i.onBeforeRowResize(o,a,s)}),i}return FIe(r,[{key:"isEnabled",value:function(){var i=this.hot.getSettings()[P0];return i===!0||wt(i)}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeChangeRender",function(o){return i.onBeforeChange(o)}),this.addHook("beforeColumnResize",function(){return i.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(o){return i.onBeforeViewRender(o)}),this.addHook("modifyRowHeight",function(o,a){return i.getRowHeight(a,o)}),this.addHook("modifyColumnHeaderHeight",function(){return i.getColumnHeaderHeight()}),zf(el(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this;this.headerHeight=null,zf(el(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(o,a,s){return i.onBeforeRowResize(o,a,s)})}},{key:"calculateRowsHeight",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof o=="number"?{from:o,to:o}:o,u=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var c=this.samplesGenerator.generateRowSamples(-1,u);this.ghostTable.addColumnHeadersRow(c.get(-1))}Ye(l.from,l.to,function(f){if(s||i.rowHeightsMap.getValueAtIndex(f)===null){var h=i.samplesGenerator.generateRowSamples(f,u);Q(h,function(d){var p=NIe(d,2),m=p[0],g=p[1];return i.ghostTable.addRow(m,g)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){i.ghostTable.getHeights(function(f,h){f<0?i.headerHeight=h:i.rowHeightsMap.setValueAtIndex(i.hot.toPhysicalRow(f),h)})},!0),this.measuredRows=l.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,s=this.hot.countRows()-1,l=null;this.inProgress=!0;var u=function f(){if(!i.hot){X2(l),i.inProgress=!1;return}i.calculateRowsHeight({from:a,to:Math.min(a+r.CALCULATION_STEP,s)},o),a=a+r.CALCULATION_STEP+1,a<s?l=G8(f):(X2(l),i.inProgress=!1,i.hot.view.adjustElementsSize(!0),i.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&i.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},c=this.getSyncCalculationLimit();this.firstCalculation&&c>=0&&(this.calculateRowsHeight({from:0,to:c},o),this.firstCalculation=!1,a=c+1),a<s?u():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[P0],o=i&&Nr(i,"samplingRatio")?i.samplingRatio:void 0,a=i&&Nr(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){Mg(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[P0],o=r.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return wt(i)&&(o=i.syncLimit,$K(o)?o=QK(a,o):o>>=0),Math.min(o,a)}},{key:"getRowHeight",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=i<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(i)),s=o;return a!==null&&a>(o||0)&&(s=a),s}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getFirstVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var i=this.hot.view._wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getLastVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(i){var o=this,a=typeof i=="number"?{from:i,to:i}:i,s=a.from,l=a.to;this.hot.batchExecution(function(){Ye(Math.min(s,l),Math.max(s,l),function(u){o.rowHeightsMap.setValueAtIndex(u,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!eo(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){var i=this.hot.renderCall,o=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),s=this.getLastVisibleRow();if(!(a===-1||s===-1)){if(this.calculateRowsHeight({from:a,to:s},void 0,i),o){var l=this.hot.countRows()-1;this.calculateRowsHeight({from:l-o,to:l})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(i,o){this.clearCacheByRange({from:i,to:o}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(i,o,a){var s=i;return a&&(this.calculateRowsHeight(o,void 0,!0),s=this.getRowHeight(o)),s}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){i.hot&&i.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(i){var o=null;i.length===1?o=i[0][0]:i.length>1&&(o={from:i[0][0],to:i[i.length-1][0]}),o!==null&&this.clearCacheByRange(o)}},{key:"destroy",value:function(){this.ghostTable.clean(),zf(el(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return P0}},{key:"PLUGIN_PRIORITY",get:function(){return YIe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(jt);function ad(t){return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ad(t)}function XIe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $L(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ZIe(n.key),n)}}function QIe(t,e,r){return e&&$L(t.prototype,e),r&&$L(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZIe(t){var e=JIe(t,"string");return ad(e)==="symbol"?e:String(e)}function JIe(t,e){if(ad(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ng(){return typeof Reflect<"u"&&Reflect.get?ng=Reflect.get.bind():ng=function(e,r,n){var i=eMe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ng.apply(this,arguments)}function eMe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=tc(t),t!==null););return t}function tMe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_O(t,e)}function _O(t,e){return _O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_O(t,e)}function rMe(t){var e=oMe();return function(){var n=tc(t),i;if(e){var o=tc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return nMe(this,i)}}function nMe(t,e){if(e&&(ad(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iMe(t)}function iMe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tc(t){return tc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tc(t)}var gX=lX("physicallyIndexed"),aMe=gX.getListWithInsertedItems,sMe=gX.getListWithRemovedItems,lMe=function(t){tMe(r,t);var e=rMe(r);function r(){return XIe(this,r),e.call(this,function(n){return n})}return QIe(r,[{key:"insert",value:function(i,o){var a=O3(this.indexedValues,o);this.indexedValues=aMe(a,i,o,this.initValueOrFn),ng(tc(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){var o=sMe(this.indexedValues,i);this.indexedValues=T3(o,i),ng(tc(r.prototype),"remove",this).call(this,i)}}]),r}(_c);const uMe=lMe;function sd(t){return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sd(t)}function cMe(t){return pMe(t)||dMe(t)||hMe(t)||fMe()}function fMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hMe(t,e){if(!!t){if(typeof t=="string")return TO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TO(t,e)}}function dMe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function pMe(t){if(Array.isArray(t))return TO(t)}function TO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function mMe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yMe(n.key),n)}}function gMe(t,e,r){return e&&LL(t.prototype,e),r&&LL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function yMe(t){var e=vMe(t,"string");return sd(e)==="symbol"?e:String(e)}function vMe(t,e){if(sd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ig(){return typeof Reflect<"u"&&Reflect.get?ig=Reflect.get.bind():ig=function(e,r,n){var i=bMe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ig.apply(this,arguments)}function bMe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=rc(t),t!==null););return t}function wMe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&OO(t,e)}function OO(t,e){return OO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},OO(t,e)}function SMe(t){var e=CMe();return function(){var n=rc(t),i;if(e){var o=rc(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return RMe(this,i)}}function RMe(t,e){if(e&&(sd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EMe(t)}function EMe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function CMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rc(t){return rc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rc(t)}var yX=lX("physicallyIndexed"),_Me=yX.getListWithInsertedItems,TMe=yX.getListWithRemovedItems,OMe=function(t){wMe(r,t);var e=SMe(r);function r(){return mMe(this,r),e.call(this,function(n){return n})}return gMe(r,[{key:"insert",value:function(i,o){var a=this;this.indexedValues=_Me(this.indexedValues,i,o,function(s,l){return a.getNextValue(l)}),ig(rc(r.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=TMe(this.indexedValues,i),ig(rc(r.prototype),"remove",this).call(this,i)}},{key:"getNextValue",value:function(i){return Math.max.apply(Math,cMe(this.getValues()))+1+i}}]),r}(_c);const AMe=OMe;function ld(t){return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ld(t)}function xMe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function DL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,MMe(n.key),n)}}function IMe(t,e,r){return e&&DL(t.prototype,e),r&&DL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function MMe(t){var e=NMe(t,"string");return ld(e)==="symbol"?e:String(e)}function NMe(t,e){if(ld(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ld(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gf(){return typeof Reflect<"u"&&Reflect.get?Gf=Reflect.get.bind():Gf=function(e,r,n){var i=PMe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Gf.apply(this,arguments)}function PMe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=tl(t),t!==null););return t}function kMe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&AO(t,e)}function AO(t,e){return AO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},AO(t,e)}function $Me(t){var e=FMe();return function(){var n=tl(t),i;if(e){var o=tl(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return LMe(this,i)}}function LMe(t,e){if(e&&(ld(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DMe(t)}function DMe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function FMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tl(t){return tl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tl(t)}var HE="bindRowsWithHeaders",HMe=210,BMe="loose",UMe=new Map([["loose",uMe],["strict",AMe]]),VMe=function(t){kMe(r,t);var e=$Me(r);function r(n){var i;return xMe(this,r),i=e.call(this,n),i.headerIndexes=null,i}return IMe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[HE]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[HE];typeof o!="string"&&(o=BMe);var a=UMe.get(o);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(s){return i.onModifyRowHeader(s)}),Gf(tl(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),Gf(tl(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(i){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(i))}},{key:"destroy",value:function(){Gf(tl(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return HE}},{key:"PLUGIN_PRIORITY",get:function(){return HMe}}]),r}(jt);function ud(t){return ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ud(t)}function FL(t){return GMe(t)||zMe(t)||WMe(t)||jMe()}function jMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WMe(t,e){if(!!t){if(typeof t=="string")return xO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xO(t,e)}}function zMe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function GMe(t){if(Array.isArray(t))return xO(t)}function xO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function YMe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function HL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vX(n.key),n)}}function KMe(t,e,r){return e&&HL(t.prototype,e),r&&HL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function lu(){return typeof Reflect<"u"&&Reflect.get?lu=Reflect.get.bind():lu=function(e,r,n){var i=qMe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},lu.apply(this,arguments)}function qMe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=za(t),t!==null););return t}function XMe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&IO(t,e)}function IO(t,e){return IO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},IO(t,e)}function QMe(t){var e=JMe();return function(){var n=za(t),i;if(e){var o=za(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ZMe(this,i)}}function ZMe(t,e){if(e&&(ud(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cf(t)}function Cf(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function JMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function za(t){return za=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},za(t)}function eNe(t,e,r){tNe(t,e),e.set(t,r)}function tNe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BE(t,e,r){return e=vX(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vX(t){var e=rNe(t,"string");return ud(e)==="symbol"?e:String(e)}function rNe(t,e){if(ud(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function BL(t,e){var r=bX(t,e,"get");return nNe(t,r)}function nNe(t,e){return e.get?e.get.call(t):e.value}function UE(t,e,r){var n=bX(t,e,"set");return iNe(t,n,r),r}function bX(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function iNe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var VE="collapsibleColumns",oNe=290,aNe=["nestedHeaders"],jc="collapsibleIndicator",UL=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),Wc=new WeakMap,sNe=function(t){XMe(r,t);var e=QMe(r);function r(){var n;YMe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),BE(Cf(n),"nestedHeadersPlugin",null),BE(Cf(n),"eventManager",new Er(Cf(n))),BE(Cf(n),"headerStateManager",null),eNe(Cf(n),Wc,{writable:!0,value:null}),n}return KMe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[VE]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),a=o.nestedHeaders;a||Xt("You need to configure the Nested Headers plugin in order to use collapsible headers."),UE(this,Wc,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(s,l,u){return i.onBeforeOnCellMouseDown(s,l,u)}),lu(za(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(!!this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var i=this.hot.getSettings(),o=i.collapsibleColumns;typeof o=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(o)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(o))}lu(za(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),UE(this,Wc,null),this.nestedHeadersPlugin=null,this.clearButtons(),lu(za(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(!!this.hot.view){var i=this.hot.view._wt.getSetting("columnHeaders").length,o=this.hot.view._wt.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,l=function(c){c&&c.parentNode.removeChild(c)};Ye(0,i-1,function(u){var c=o.childNodes[u],f=a.childNodes[u],h=s?s.childNodes[u]:null;Ye(0,c.childNodes.length-1,function(d){var p=c.childNodes[d].querySelector(".".concat(jc));l(p),f&&f.childNodes[d]&&(p=f.childNodes[d].querySelector(".".concat(jc)),l(p)),s&&h&&h.childNodes[d]&&(p=h.childNodes[d].querySelector(".".concat(jc)),l(p))})})}}},{key:"expandSection",value:function(i){this.toggleCollapsibleSection([i],"expand")}},{key:"collapseSection",value:function(i){this.toggleCollapsibleSection([i],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(i){var o=this,a=this.headerStateManager.mapNodes(function(s){var l=s.collapsible,u=s.origColspan,c=s.headerLevel,f=s.columnIndex,h=s.isCollapsed;if(l===!0&&u>1&&(h&&i==="expand"||!h&&i==="collapse"))return{row:o.headerStateManager.levelToRowCoords(c),col:f}});this.toggleCollapsibleSection(a,i)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(i,o){var a=this;if(!UL.has(o))throw new Error("Unsupported action is passed (".concat(o,")."));if(!!Array.isArray(i)){var s=eo(i,function(g){var v=g.row;return v<0}),l=s.length>0;Q(s,function(g){var v,S=g.row,b=g.col,E=(v=a.headerStateManager.getHeaderSettings(S,b))!==null&&v!==void 0?v:{},T=E.collapsible,N=E.isCollapsed;if(!T||N&&o==="collapse"||!N&&o==="expand")return l=!1,!1});var u=[],c=[];l&&Q(s,function(g){var v=g.row,S=g.col,b=a.headerStateManager.triggerNodeModification(o,v,S),E=b.colspanCompensation,T=b.affectedColumns,N=b.rollbackModification;E>0&&(c.push.apply(c,FL(T)),u.push(N))});var f=this.getCollapsedColumns(),h=[];o==="collapse"?h=bK([].concat(FL(f),c)):o==="expand"&&(h=eo(f,function(g){return!c.includes(g)}));var d=UL.get(o),p=this.hot.runHooks(d.beforeHook,f,h,l);if(p===!1){Q(u,function(g){g()});return}this.hot.batchExecution(function(){Q(c,function(g){BL(a,Wc).setValueAtIndex(a.hot.toPhysicalColumn(g),d.hideColumn)})},!0);var m=this.getCollapsedColumns().length!==f.length;this.hot.runHooks(d.afterHook,f,h,l,m),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return BL(this,Wc).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(i,o,a){var s,l=(s=this.headerStateManager.getHeaderSettings(a,i))!==null&&s!==void 0?s:{},u=l.collapsible,c=l.origColspan,f=l.isCollapsed,h=u&&c>1&&i>=this.hot.getSettings().fixedColumnsStart,d=o.querySelector(".".concat(jc));if(h)d||(d=this.hot.rootDocument.createElement("div"),Re(d,jc),o.querySelector("div:first-child").appendChild(d)),ut(d,["collapsed","expanded"]),f?(Re(d,"collapsed"),Gu(d,"+")):(Re(d,"expanded"),Gu(d,"-"));else{var p;(p=d)===null||p===void 0||p.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(i,o){at(i.target,jc)&&(at(i.target,"expanded")?(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([o],"collapse")):at(i.target,"collapsed")&&(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([o],"expand")),la(i))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,o){o||this.updatePlugin()}},{key:"destroy",value:function(){UE(this,Wc,null),lu(za(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return VE}},{key:"PLUGIN_PRIORITY",get:function(){return oNe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[VE].concat(aNe)}}]),r}(jt),lNe=tt,uNe=zr,cNe=CG,fNe=Li,hNe=ya,dNe=Lp;lNe({target:"Object",stat:!0,sham:!uNe},{getOwnPropertyDescriptors:function(e){for(var r=fNe(e),n=hNe.f,i=cNe(r),o={},a=0,s,l;i.length>a;)l=n(r,s=i[a++]),l!==void 0&&dNe(o,s,l);return o}});var VL=zr,pNe=mt,mNe=en,gNe=dt,jE=f1,yNe=y1,vNe=m1,bNe=wi,wNe=a1,zc=Object.assign,jL=Object.defineProperty,SNe=pNe([].concat),RNe=!zc||gNe(function(){if(VL&&zc({b:1},zc(jL({},"a",{enumerable:!0,get:function(){jL(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var t={},e={},r=Symbol(),n="abcdefghijklmnopqrst";return t[r]=7,n.split("").forEach(function(i){e[i]=i}),zc({},t)[r]!=7||jE(zc({},e)).join("")!=n})?function(e,r){for(var n=bNe(e),i=arguments.length,o=1,a=yNe.f,s=vNe.f;i>o;)for(var l=wNe(arguments[o++]),u=a?SNe(jE(l),a(l)):jE(l),c=u.length,f=0,h;c>f;)h=u[f++],(!VL||mNe(s,l,h))&&(n[h]=l[h]);return n}:zc,ENe=tt,WL=RNe;ENe({target:"Object",stat:!0,arity:2,forced:Object.assign!==WL},{assign:WL});function vy(t){return vy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vy(t)}function zL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function CNe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zL(Object(r),!0).forEach(function(n){_Ne(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _Ne(t,e,r){return e=wX(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GL(t,e){return xNe(t)||ANe(t,e)||ONe(t,e)||TNe()}function TNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ONe(t,e){if(!!t){if(typeof t=="string")return YL(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YL(t,e)}}function YL(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ANe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function xNe(t){if(Array.isArray(t))return t}function INe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function KL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wX(n.key),n)}}function MNe(t,e,r){return e&&KL(t.prototype,e),r&&KL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wX(t){var e=NNe(t,"string");return vy(e)==="symbol"?e:String(e)}function NNe(t,e){if(vy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(vy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var PNe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],kNe=!1,$Ne=!0,LNe=!0,DNe=function(){function t(e,r){INe(this,t),this.hot=e,this.sortingStates=new x6,this.sortEmptyCells=kNe,this.indicator=$Ne,this.headerAction=LNe,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return MNe(t,[{key:"updateAllColumnsProperties",value:function(r){var n=this;!wt(r)||St(r,function(i,o){PNe.includes(o)&&(n[o]=i)})}},{key:"getAllColumnsProperties",value:function(){var r={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(r.compareFunctionFactory=this.compareFunctionFactory),r}},{key:"getSortOrderOfColumn",value:function(r){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(r){return r=this.hot.toPhysicalColumn(r),this.sortingStates.getEntries().findIndex(function(n){var i=GL(n,1),o=i[0];return o===r})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(r){return wt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(r)))}},{key:"getSortStates",value:function(){var r=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(i){var o=GL(i,2),a=o[0],s=o[1];return CNe({column:r.hot.toVisualColumn(a)},s)})}},{key:"getColumnSortState",value:function(r){var n=this.getSortOrderOfColumn(r);if(He(n))return{column:r,sortOrder:n}}},{key:"setSortStates",value:function(r){this.sortingStates.clear();for(var n=0;n<r.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(r[n].column),{sortOrder:r[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),t}(),$w="asc",Lw="desc",FNe="colHeader";function HNe(t){if(wt(t)===!1)return!1;var e=t.column,r=t.sortOrder;return Number.isInteger(e)&&[$w,Lw].includes(r)}function BNe(t){if(t.some(function(r){return HNe(r)===!1}))return!1;var e=t.map(function(r){var n=r.column;return n});return new Set(e).size===e.length}function qL(t){if(t!==Lw)return t===$w?Lw:$w}function XL(t){var e=t.querySelector(".".concat(FNe));return e}function QL(t,e){if(t<0||!e.parentNode)return!1;var r=e.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(e.parentNode)-r.length;return n===-1}function MO(t,e,r){return t===-1&&e>=0&&zu(r)===!1}var UNe="ascending",VNe="descending",SX="indicatorDisabled",RX="columnSorting",EX="sortAction",CX=new Map([[$w,UNe],[Lw,VNe]]);function jNe(t,e,r,n){var i=[RX];if(n&&i.push(EX),r===!1)return i.push(SX),i;var o=t.getSortOrderOfColumn(e);return He(o)&&i.push(CX.get(o)),i}function WNe(){return Array.from(CX.values()).concat(EX,SX,RX)}function _X(t,e,r){var n=e.locale;return function(i,o){var a=r.sortEmptyCells;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof o=="string"&&(o=o.toLocaleLowerCase(n)),i===o?oa:an(i)?an(o)?oa:a&&t==="asc"?vr:br:an(o)?a&&t==="asc"?br:vr:isNaN(i)&&!isNaN(o)?t==="asc"?br:vr:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?vr:br:i>o?t==="asc"?br:vr:oa}}var TX="default";function zNe(t,e,r){return function(n,i){var o=parseFloat(n),a=parseFloat(i),s=r.sortEmptyCells;if(o===a||isNaN(o)&&isNaN(a))return oa;if(s){if(an(n))return t==="asc"?vr:br;if(an(i))return t==="asc"?br:vr}return isNaN(o)?br:isNaN(a)?vr:o<a?t==="asc"?vr:br:o>a?t==="asc"?br:vr:oa}}var GNe="numeric";function YNe(t,e,r){var n=e.checkedTemplate,i=e.uncheckedTemplate,o=r.sortEmptyCells;return function(a,s){var l=an(a),u=an(s),c=l?i:a,f=u?i:s,h=c===i||c===n,d=f===i||f===n;if(o===!1){if(l&&u===!1)return br;if(l===!1&&u)return vr}return h===!1&&d?t==="asc"?vr:br:h&&d===!1?t==="asc"?br:vr:h===!1&&d===!1?_X(t,e,r)(a,s):c===i&&f===n?t==="asc"?vr:br:c===n&&f===i?t==="asc"?br:vr:oa}}var KNe="checkbox";function qNe(t,e,r){return function(n,i){var o=r.sortEmptyCells;if(n===i)return oa;if(an(n))return an(i)?oa:o&&t==="asc"?vr:br;if(an(i))return o&&t==="asc"?br:vr;var a=e.dateFormat,s=qt(n,a),l=qt(i,a);return s.isValid()?l.isValid()?l.isAfter(s)?t==="asc"?vr:br:l.isBefore(s)?t==="asc"?br:vr:oa:vr:br}}var XNe="date",x3=lo("sorting.compareFunctionFactory"),I6=x3.register,ZL=x3.getItem,QNe=x3.hasItem,OX=lo("sorting.mainSortComparator"),AX=OX.register,ZNe=OX.getItem;function xX(t){return QNe(t)?ZL(t):ZL(TX)}I6(GNe,zNe);I6(KNe,YNe);I6(XNe,qNe);I6(TX,_X);var oa=0,vr=-1,br=1;function JNe(t,e){for(var r=ZNe(e),n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];t.sort(r.apply(void 0,i))}function JL(t){return n9e(t)||r9e(t)||t9e(t)||e9e()}function e9e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t9e(t,e){if(!!t){if(typeof t=="string")return eD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eD(t,e)}}function eD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function r9e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function n9e(t){if(Array.isArray(t))return t}function i9e(t,e){return function(r,n){var i=JL(r),o=i.slice(1),a=JL(n),s=a.slice(1);return function(u){var c=t[u],f=e[u],h=o[u],d=s[u],p=f.columnSorting,m=p.compareFunctionFactory?p.compareFunctionFactory:xX(f.type),g=m(c,f,p)(h,d);return g}(0)}}function cd(t){return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cd(t)}var o9e=["column"],a9e=["column"];function Gc(t){return c9e(t)||u9e(t)||l9e(t)||s9e()}function s9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l9e(t,e){if(!!t){if(typeof t=="string")return NO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NO(t,e)}}function u9e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function c9e(t){if(Array.isArray(t))return NO(t)}function NO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function tD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function rD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tD(Object(r),!0).forEach(function(n){f9e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function f9e(t,e,r){return e=IX(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nD(t,e){if(t==null)return{};var r=h9e(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function h9e(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function d9e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,IX(n.key),n)}}function p9e(t,e,r){return e&&iD(t.prototype,e),r&&iD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function IX(t){var e=m9e(t,"string");return cd(e)==="symbol"?e:String(e)}function m9e(t,e){if(cd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uu(){return typeof Reflect<"u"&&Reflect.get?uu=Reflect.get.bind():uu=function(e,r,n){var i=g9e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},uu.apply(this,arguments)}function g9e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ga(t),t!==null););return t}function y9e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&PO(t,e)}function PO(t,e){return PO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},PO(t,e)}function v9e(t){var e=S9e();return function(){var n=Ga(t),i;if(e){var o=Ga(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return b9e(this,i)}}function b9e(t,e){if(e&&(cd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w9e(t)}function w9e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S9e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ga(t){return Ga=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ga(t)}var kO="columnSorting",R9e=50,oD="append",E9e="replace";AX(kO,i9e);Ue.getSingleton().register("beforeColumnSort");Ue.getSingleton().register("afterColumnSort");var MX=function(t){y9e(r,t);var e=v9e(r);function r(n){var i;return d9e(this,r),i=e.call(this,n),i.columnStatesManager=null,i.columnMetaCache=null,i.pluginKey=kO,i.indexesSequenceCache=null,i}return p9e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnStatesManager=new DNe(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Cl(function(o){var a=i.hot.toVisualColumn(o);return a===null&&(a=o),i.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(o,a){return i.onAfterGetColHeader(o,a)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(o,a){return i.onAfterOnCellMouseDown(o,a)}),this.addHook("afterInit",function(){return i.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.hot.view&&this.loadOrSortBySettings(),uu(Ga(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this,o=function(s,l){var u=XL(l);QL(s,l)===!1||u===null||i.updateHeaderClasses(u)};this.hot.addHook("afterGetColHeader",o),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("afterGetColHeader",o)}),this.hot.batchExecution(function(){i.indexesSequenceCache!==null&&(i.hot.rowIndexMapper.setIndexesSequence(i.indexesSequenceCache.getValues()),i.hot.rowIndexMapper.unregisterMap(i.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,uu(Ga(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){var o=this.getSortConfig(),a=this.getNormalizedSortConfigs(i),s=this.areValidSortConfigs(a),l=this.hot.runHooks("beforeColumnSort",o,a,s);l!==!1&&(o.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new uX),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",o,s?a:o,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(i){return He(i)?this.columnStatesManager.getColumnSortState(i):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(i){var o=this.getNormalizedSortConfigs(i);this.areValidSortConfigs(o)&&this.columnStatesManager.setSortStates(o)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i.slice(0,1):[i]}},{key:"areValidSortConfigs",value:function(i){var o=this.hot.countCols();return BNe(i)&&i.every(function(a){var s=a.column;return s<=o&&s>=0})}},{key:"saveAllSortSettings",value:function(i){var o=this,a=this.columnStatesManager.getAllColumnsProperties(),s=function(u){var c=u.column,f=nD(u,o9e);return rD({column:o.hot.toPhysicalColumn(c)},f)};a.initialConfig=bt(i,s),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var i=this,o={};this.hot.runHooks("persistentStateLoad","columnSorting",o);var a=o.value,s=function(u){var c=u.column,f=nD(u,a9e);return rD({column:i.hot.toVisualColumn(c)},f)};return He(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=bt(a.initialConfig,s)),a}},{key:"getColumnNextConfig",value:function(i){var o=this.columnStatesManager.getSortOrderOfColumn(i);if(He(o)){var a=qL(o);return He(a)?{column:i,sortOrder:a}:void 0}var s=this.hot.countCols();if(Number.isInteger(i)&&i>=0&&i<s)return{column:i,sortOrder:qL()}}},{key:"getNextSortConfig",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:oD,a=this.columnStatesManager.getIndexOfColumnInSortQueue(i),s=a!==-1,l=this.getSortConfig(),u=this.getColumnNextConfig(i);if(s){if(tr(u))return[].concat(Gc(l.slice(0,a)),Gc(l.slice(a+1)));if(o===oD)return[].concat(Gc(l.slice(0,a)),Gc(l.slice(a+1)),[u]);if(o===E9e)return[].concat(Gc(l.slice(0,a)),[u],Gc(l.slice(a+1)))}return He(u)?l.concat(u):l}},{key:"getPluginColumnConfig",value:function(i){if(wt(i)){var o=i[this.pluginKey];if(wt(o))return o}return{}}},{key:"getMergedPluginSettings",value:function(i){var o=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,i),l=Object.getPrototypeOf(s);return Array.isArray(l.columns)?Object.assign(a,o,this.getPluginColumnConfig(l.columns[i])):sr(l.columns)?Object.assign(a,o,this.getPluginColumnConfig(l.columns(i))):Object.assign(a,o)}},{key:"getFirstCellSettings",value:function(i){var o=this.hot.getCellMeta(0,i),a=Object.create(o);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(i)),a}},{key:"getNumberOfRowsToSort",value:function(i){var o=this.hot.getSettings();return o.maxRows<=i?o.maxRows:i-o.minSpareRows}},{key:"sortByPresetSortStates",value:function(i){var o=this;if(i.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],s=this.hot.countRows(),l=function(g){return bt(i,function(v){return o.hot.getDataAtCell(g,v.column)})},u=0;u<this.getNumberOfRowsToSort(s);u+=1)a.push([this.hot.toPhysicalRow(u)].concat(l(u)));var c=bt(a,function(m){return m[0]});JNe(a,this.pluginKey,bt(i,function(m){return m.sortOrder}),bt(i,function(m){return o.getFirstCellSettings(m.column)}));for(var f=a.length;f<s;f+=1)a.push([f].concat(l(f)));var h=bt(a,function(m){return m[0]}),d=new Map(bt(c,function(m,g){return[m,h[g]]})),p=bt(this.hot.rowIndexMapper.getIndexesSequence(),function(m){return d.has(m)?d.get(m):m});this.hot.rowIndexMapper.setIndexesSequence(p)}},{key:"loadOrSortBySettings",value:function(){var i=this.getAllSavedSortSettings();if(wt(i))this.sortBySettings(i);else{var o=this.hot.getSettings()[this.pluginKey];this.sortBySettings(o)}}},{key:"sortBySettings",value:function(i){if(wt(i)){this.columnStatesManager.updateAllColumnsProperties(i);var o=i.initialConfig;(Array.isArray(o)||wt(o))&&this.sort(o)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(i,o){var a=XL(o);if(!(QL(i,o)===!1||a===null)){var s=this.getFirstCellSettings(i)[this.pluginKey],l=s.indicator,u=s.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,i,l,u)}}},{key:"updateHeaderClasses",value:function(i){if(ut(i,WNe()),this.enabled!==!1){for(var o=arguments.length,a=new Array(o>1?o-1:0),s=1;s<o;s++)a[s-1]=arguments[s];Re(i,jNe.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(i){uu(Ga(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),He(i[this.pluginKey])&&this.sortBySettings(i[this.pluginKey])}},{key:"onAfterLoadData",value:function(i){i===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(i,o){var a=this.getFirstCellSettings(o)[this.pluginKey],s=a.headerAction;return s&&i.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){MO(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,o){MO(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(o.col)),this.sort(this.getColumnNextConfig(o.col)))}},{key:"destroy",value:function(){var i;(i=this.columnStatesManager)===null||i===void 0||i.destroy(),uu(Ga(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return kO}},{key:"PLUGIN_PRIORITY",get:function(){return R9e}}]),r}(jt),C9e=tt,I3=mt,_9e=Sl,T9e=VY,O9e=fK,aD=dt,A9e=RangeError,NX=String,PX=Math.floor,$O=I3(O9e),sD=I3("".slice),dm=I3(1 .toFixed),kf=function(t,e,r){return e===0?r:e%2===1?kf(t,e-1,r*t):kf(t*t,e/2,r)},x9e=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e},Yc=function(t,e,r){for(var n=-1,i=r;++n<6;)i+=e*t[n],t[n]=i%1e7,i=PX(i/1e7)},WE=function(t,e){for(var r=6,n=0;--r>=0;)n+=t[r],t[r]=PX(n/e),n=n%e*1e7},lD=function(t){for(var e=6,r="";--e>=0;)if(r!==""||e===0||t[e]!==0){var n=NX(t[e]);r=r===""?n:r+$O("0",7-n.length)+n}return r},I9e=aD(function(){return dm(8e-5,3)!=="0.000"||dm(.9,0)!=="1"||dm(1.255,2)!=="1.25"||dm(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!aD(function(){dm({})});C9e({target:"Number",proto:!0,forced:I9e},{toFixed:function(e){var r=T9e(this),n=_9e(e),i=[0,0,0,0,0,0],o="",a="0",s,l,u,c;if(n<0||n>20)throw A9e("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return NX(r);if(r<0&&(o="-",r=-r),r>1e-21)if(s=x9e(r*kf(2,69,1))-69,l=s<0?r*kf(2,-s,1):r/kf(2,s,1),l*=4503599627370496,s=52-s,s>0){for(Yc(i,0,l),u=n;u>=7;)Yc(i,1e7,0),u-=7;for(Yc(i,kf(10,u,1),0),u=s-1;u>=23;)WE(i,1<<23),u-=23;WE(i,1<<u),Yc(i,1,1),WE(i,2),a=lD(i)}else Yc(i,0,l),Yc(i,1<<-s,0),a=lD(i)+$O("0",n);return n>0?(c=a.length,a=o+(c<=n?"0."+$O("0",n-c)+a:sD(a,0,c-n)+"."+sD(a,c-n))):a=o+a,a}});function by(t){return by=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},by(t)}function M9e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,P9e(n.key),n)}}function N9e(t,e,r){return e&&uD(t.prototype,e),r&&uD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function P9e(t){var e=k9e(t,"string");return by(e)==="symbol"?e:String(e)}function k9e(t,e){if(by(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(by(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $9e=function(){function t(e,r){M9e(this,t),this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return N9e(t,[{key:"getEndpoint",value:function(r){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[r]:this.endpoints[r]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(r){return this.parseSettings(r.call(this))}},{key:"parseSettings",value:function(r){var n=this,i=[],o=r;if(!o&&typeof this.settings=="function"){this.settingsType="function";return}return o||(o=this.settings),Q(o,function(a){var s={};n.assignSetting(a,s,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,s,"reversedRowCoords",!1),n.assignSetting(a,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,s,"sourceColumn",a.destinationColumn),n.assignSetting(a,s,"type","sum"),n.assignSetting(a,s,"forceNumeric",!1),n.assignSetting(a,s,"suppressDataTypeErrors",!0),n.assignSetting(a,s,"suppressDataTypeErrors",!0),n.assignSetting(a,s,"customFunction",null),n.assignSetting(a,s,"readOnly",!0),n.assignSetting(a,s,"roundFloat",!1),i.push(s)}),i}},{key:"assignSetting",value:function(r,n,i,o){if(i==="ranges"&&r[i]===void 0){n[i]=o;return}else if(i==="ranges"&&r[i].length===0)return;if(r[i]===void 0){if(o instanceof Error)throw o;n[i]=o}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-r[i]-1:n[i]=r[i]}},{key:"resetSetupBeforeStructureAlteration",value:function(r,n,i){if(this.settingsType==="function"){var o=r.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();Q(a,function(s){o==="row"&&s.destinationRow>=n&&(r==="insert_row"?s.alterRowOffset=i:r==="remove_row"&&(s.alterRowOffset=-1*i)),o==="col"&&s.destinationColumn>=n&&(r==="insert_col"?s.alterColumnOffset=i:r==="remove_col"&&(s.alterColumnOffset=-1*i))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(r,n,i,o,a){var s=this,l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var u=function m(){return s.hot.removeHook("beforeViewRender",m),s.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",u);return}var c=r.indexOf("row")>-1?"row":"col",f=r.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=r.indexOf("move_row")===0,p=n;Q(h,function(m){c==="row"&&m.destinationRow>=p&&(m.alterRowOffset=f*i),c==="col"&&m.destinationColumn>=p&&(m.alterColumnOffset=f*i)}),this.resetAllEndpoints(h,!d),d?Q(h,function(m){s.extendEndpointRanges(m,p,o[0],o.length),s.recreatePhysicalRanges(m),s.clearOffsetInformation(m)}):Q(h,function(m){s.shiftEndpointCoordinates(m,p)}),l&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(r){r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(r,n,i,o){Q(r.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?i>a[1]?a[1]+=o:i<a[0]&&(a[0]-=o):i>=a[0]&&i<=a[1]&&(a[1]-=o,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(r){var n=this,i=r.ranges,o=[],a=[];Q(i,function(s){var l=[];if(s[1])for(var u=s[0];u<=s[1];u++)l.push(n.hot.toPhysicalRow(u));else l.push(n.hot.toPhysicalRow(s[0]));a.push(l)}),Q(a,function(s){var l=[];Q(s,function(u,c){c===0?l.push(u):s[c]!==s[c-1]+1&&(l.push(s[c-1]),o.push(l),l=[],l.push(u)),c===s.length-1&&(l.push(u),o.push(l))})}),r.ranges=o}},{key:"shiftEndpointCoordinates",value:function(r,n){r.alterRowOffset&&r.alterRowOffset!==0?(r.destinationRow+=r.alterRowOffset||0,Q(r.ranges,function(i){Q(i,function(o,a){o>=n&&(i[a]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&r.alterColumnOffset!==0&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=n.some(function(a){var s=a.alterRowOffset||0,l=a.alterColumnOffset||0;return a.destinationRow+s>=r.hot.countRows()||a.destinationColumn+l>=r.hot.countCols()});o||(this.cellsToSetCache=[],Q(n,function(a){r.resetEndpointValue(a,i)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var r=this;this.cellsToSetCache=[],Q(this.getAllEndpoints(),function(n){r.currentEndpoint=n,r.plugin.calculate(n),r.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(r){var n=this,i=[];this.cellsToSetCache=[],Q(r,function(o,a,s){"".concat(o[2]||"")!=="".concat(o[3])&&Q(n.getAllEndpoints(),function(l,u){n.hot.propToCol(s[a][1])===l.sourceColumn&&i.indexOf(u)===-1&&i.push(u)})}),Q(i,function(o){n.refreshEndpoint(n.getEndpoint(o))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(r){this.currentEndpoint=r,this.plugin.calculate(r),this.setEndpointValue(r),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=r.alterRowOffset||0,o=r.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(r.destinationRow+(n?i:0)),this.hot.toVisualColumn(r.destinationColumn+(n?o:0)),""])}},{key:"setEndpointValue",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.hot.toVisualRow(r.destinationRow);if(r.destinationRow>=this.hot.countRows()||r.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var a=this.hot.toVisualRow(r.destinationRow);if(a!==null){var s=this.hot.getCellMeta(a,r.destinationColumn);(n==="init"||s.readOnly!==r.readOnly)&&(s.readOnly=r.readOnly,s.className="columnSummaryResult")}r.roundFloat&&!isNaN(r.result)&&(r.result=r.result.toFixed(r.roundFloat)),i?this.hot.setDataAtCell(o,r.destinationColumn,r.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,r.destinationColumn,r.result]),r.alterRowOffset=void 0,r.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){Xt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),t}();const L9e=$9e;function zE(t){return t==null||isNaN(t)}function fd(t){return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fd(t)}var cD;function D9e(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function F9e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,B9e(n.key),n)}}function H9e(t,e,r){return e&&fD(t.prototype,e),r&&fD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function B9e(t){var e=U9e(t,"string");return fd(e)==="symbol"?e:String(e)}function U9e(t,e){if(fd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function o2(){return typeof Reflect<"u"&&Reflect.get?o2=Reflect.get.bind():o2=function(e,r,n){var i=V9e(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},o2.apply(this,arguments)}function V9e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=hd(t),t!==null););return t}function j9e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&LO(t,e)}function LO(t,e){return LO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},LO(t,e)}function W9e(t){var e=Y9e();return function(){var n=hd(t),i;if(e){var o=hd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return z9e(this,i)}}function z9e(t,e){if(e&&(fd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G9e(t)}function G9e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Y9e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hd(t){return hd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hd(t)}var GE="columnSummary",K9e=220,q9e=function(t){j9e(r,t);var e=W9e(r);function r(n){var i;return F9e(this,r),i=e.call(this,n),i.endpoints=null,i}return H9e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[GE]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.settings=this.hot.getSettings()[GE],this.endpoints=new L9e(this,this.settings),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeCreateRow",function(o,a,s){return i.endpoints.resetSetupBeforeStructureAlteration("insert_row",o,a,null,s)}),this.addHook("beforeCreateCol",function(o,a,s){return i.endpoints.resetSetupBeforeStructureAlteration("insert_col",o,a,null,s)}),this.addHook("beforeRemoveRow",function(){for(var o,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(o=i.endpoints).resetSetupBeforeStructureAlteration.apply(o,["remove_row"].concat(s))}),this.addHook("beforeRemoveCol",function(){for(var o,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(o=i.endpoints).resetSetupBeforeStructureAlteration.apply(o,["remove_col"].concat(s))}),this.addHook("afterCreateRow",function(o,a,s){return i.endpoints.resetSetupAfterStructureAlteration("insert_row",o,a,null,s)}),this.addHook("afterCreateCol",function(o,a,s){return i.endpoints.resetSetupAfterStructureAlteration("insert_col",o,a,null,s)}),this.addHook("afterRemoveRow",function(){for(var o,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(o=i.endpoints).resetSetupAfterStructureAlteration.apply(o,["remove_row"].concat(s))}),this.addHook("afterRemoveCol",function(){for(var o,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(o=i.endpoints).resetSetupAfterStructureAlteration.apply(o,["remove_col"].concat(s))}),this.addHook("afterRowMove",function(){return i.onAfterRowMove.apply(i,arguments)}),o2(hd(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(i){switch(i.type.toLowerCase()){case"sum":i.result=this.calculateSum(i);break;case"min":i.result=this.calculateMinMax(i,i.type);break;case"max":i.result=this.calculateMinMax(i,i.type);break;case"count":i.result=this.countEntries(i);break;case"average":i.result=this.calculateAverage(i);break;case"custom":i.result=i.customFunction.call(this,i);break}}},{key:"calculateSum",value:function(i){var o=this,a=0;return St(i.ranges,function(s){a+=o.getPartialSum(s,i.sourceColumn)}),a}},{key:"getPartialSum",value:function(i,o){var a=0,s=i[1]||i[0],l=null,u=0;do{if(l=this.getCellValue(s,o),l=zE(l)?null:l,l!==null){var c=("".concat(l).split(".")[1]||[]).length||1;c>u&&(u=c)}a+=l||0,s-=1}while(s>=i[0]);return Math.round(a*Math.pow(10,u))/Math.pow(10,u)}},{key:"calculateMinMax",value:function(i,o){var a=this,s=null;return St(i.ranges,function(l){var u=a.getPartialMinMax(l,i.sourceColumn,o);if(s===null&&u!==null&&(s=u),u!==null)switch(o){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}}),s===null?"Not enough data":s}},{key:"getPartialMinMax",value:function(i,o,a){var s=null,l=i[1]||i[0],u;do{if(u=this.getCellValue(l,o),u=zE(u)?null:u,s===null)s=u;else if(u!==null)switch(a){case"min":s=Math.min(s,u);break;case"max":s=Math.max(s,u);break}l-=1}while(l>=i[0]);return s}},{key:"countEmpty",value:function(i,o){var a,s=0,l=i[1]||i[0];do a=this.getCellValue(l,o),a=zE(a)?null:a,a===null&&(s+=1),l-=1;while(l>=i[0]);return s}},{key:"countEntries",value:function(i){var o=this,a=0,s=i.ranges;return St(s,function(l){var u=l[1]===void 0?1:l[1]-l[0]+1,c=o.countEmpty(l,i.sourceColumn);a+=u,a-=c}),a}},{key:"calculateAverage",value:function(i){var o=this.calculateSum(i),a=this.countEntries(i);return o/a}},{key:"getCellValue",value:function(i,o){var a=this.hot.toVisualRow(i),s=this.hot.toVisualColumn(o),l=this.hot.getSourceDataAtCell(i,o),u="";if(a!==null&&s!==null&&(u=this.hot.getCellMeta(a,s).className||""),u.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof l=="string"&&(l=l.replace(/,/,".")),l=parseFloat(l)),isNaN(l)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Gt(cD||(cD=D9e(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),i,o));return l}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(i,o){i&&o!=="ColumnSummary.reset"&&o!=="ColumnSummary.set"&&o!=="loadData"&&this.endpoints.refreshChangedEndpoints(i)}},{key:"onAfterRowMove",value:function(i,o){this.endpoints.resetSetupBeforeStructureAlteration("move_row",i[0],i.length,i,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",o,i.length,i,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return GE}},{key:"PLUGIN_PRIORITY",get:function(){return K9e}}]),r}(jt);function wy(t){return wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wy(t)}function X9e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Z9e(n.key),n)}}function Q9e(t,e,r){return e&&hD(t.prototype,e),r&&hD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Z9e(t){var e=J9e(t,"string");return wy(e)==="symbol"?e:String(e)}function J9e(t,e){if(wy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(wy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ePe=function(){function t(e,r){X9e(this,t),this.rootDocument=e,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return Q9e(t,[{key:"setPosition",value:function(r,n){this.editorStyle.left="".concat(r,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(r,n){if(r&&n){var i=this.getInputElement();i.style.width="".concat(r,"px"),i.style.height="".concat(n,"px")}}},{key:"getSize",value:function(){return{width:Qt(this.getInputElement()),height:wr(this.getInputElement())}}},{key:"resetSize",value:function(){var r=this.getInputElement();r.style.width="",r.style.height=""}},{key:"setReadOnlyState",value:function(r){var n=this.getInputElement();n.readOnly=r}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=r||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var r=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return r.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Re(this.container,t.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Re(r,t.CLASS_EDITOR),Re(n,t.CLASS_INPUT),r.appendChild(n),this.container.appendChild(r),r}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(t.CLASS_INPUT))}},{key:"destroy",value:function(){var r=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,r&&r.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),t}();const tPe=ePe;var vt="---------";function rPe(){return{name:vt}}function nPe(t){return bt(t,function(e){return{start:e.getTopStartCorner(),end:e.getBottomEndCorner()}})}function k0(t){return at(t,"htSeparator")}function iPe(t){return at(t,"htSubmenu")}function $0(t){return at(t,"htDisabled")}function L0(t){return at(t,"htSelectionDisabled")}function Tc(t){var e=t.getSelected();return!e||e[0]<0?null:e}function oPe(t,e){if(t.indexOf(e)!==-1)return t;var r=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(e)}function aPe(t,e){if(t.indexOf(e)!==-1)return t;var r=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(e)}function Dl(t,e){var r={};return Q(t,function(n){n.forAll(function(i,o){i>=0&&o>=0&&(r[i]||(r[i]=[]),r[i][o]=e(i,o))})}),r}function Hs(t,e,r,n,i){Q(t,function(o){o.forAll(function(a,s){a>=0&&s>=0&&sPe(a,s,e,r,n,i)})})}function sPe(t,e,r,n,i,o){var a=i(t,e),s=n;a.className&&(r==="vertical"?s=oPe(a.className,n):s=aPe(a.className,n)),o(t,e,"className",s)}function Qo(t,e){var r=!1;return Array.isArray(t)&&Q(t,function(n){return n.forAll(function(i,o){if(i>=0&&o>=0&&e(i,o))return r=!0,!1}),r}),r}function ka(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function lPe(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function kX(t,e){for(var r=t.slice(0),n=0;n<r.length&&r[n].name===e;)r.shift();return r}function uPe(t,e){var r=t.slice(0);return r.reverse(),r=kX(r,e),r.reverse(),r}function cPe(t){var e=[];return Q(t,function(r,n){n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function fPe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vt,r=t.slice(0);return r=kX(r,e),r=uPe(r,e),r=cPe(r),r}function Sy(t){return Sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sy(t)}function hPe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pPe(n.key),n)}}function dPe(t,e,r){return e&&dD(t.prototype,e),r&&dD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function pPe(t){var e=mPe(t,"string");return Sy(e)==="symbol"?e:String(e)}function mPe(t,e){if(Sy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Sy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gPe=250,yPe=250,$X=function(){function t(e){hPe(this,t),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}return dPe(t,[{key:"hide",value:function(){var r=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){r.wasLastActionShow===!1&&r.runLocalHooks("hide")},yPe)}},{key:"show",value:function(r){this.wasLastActionShow=!0,this.showDebounced(r)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gPe;this.showDebounced=WK(function(i){r.wasLastActionShow&&r.runLocalHooks("show",i.from.row,i.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),t}();ir($X,Si);const vPe=$X;var LX="ContextMenu:items",ct=LX,M3="".concat(ct,".noItems"),N3="".concat(ct,".insertRowAbove"),P3="".concat(ct,".insertRowBelow"),k3="".concat(ct,".insertColumnOnTheLeft"),$3="".concat(ct,".insertColumnOnTheRight"),L3="".concat(ct,".removeRow"),D3="".concat(ct,".removeColumn"),F3="".concat(ct,".undo"),H3="".concat(ct,".redo"),B3="".concat(ct,".readOnly"),U3="".concat(ct,".clearColumn"),V3="".concat(ct,".copy"),j3="".concat(ct,".copyWithHeaders"),W3="".concat(ct,".copyWithGroupHeaders"),z3="".concat(ct,".copyHeadersOnly"),G3="".concat(ct,".cut"),Y3="".concat(ct,".freezeColumn"),K3="".concat(ct,".unfreezeColumn"),q3="".concat(ct,".mergeCells"),X3="".concat(ct,".unmergeCells"),Q3="".concat(ct,".addComment"),Z3="".concat(ct,".editComment"),J3="".concat(ct,".removeComment"),ex="".concat(ct,".readOnlyComment"),tx="".concat(ct,".align"),rx="".concat(ct,".align.left"),nx="".concat(ct,".align.center"),ix="".concat(ct,".align.right"),ox="".concat(ct,".align.justify"),ax="".concat(ct,".align.top"),sx="".concat(ct,".align.middle"),lx="".concat(ct,".align.bottom"),ux="".concat(ct,".borders"),cx="".concat(ct,".borders.top"),fx="".concat(ct,".borders.right"),hx="".concat(ct,".borders.bottom"),dx="".concat(ct,".borders.left"),px="".concat(ct,".borders.remove"),mx="".concat(ct,".nestedHeaders.insertChildRow"),gx="".concat(ct,".nestedHeaders.detachFromParent"),yx="".concat(ct,".hideColumn"),vx="".concat(ct,".showColumn"),bx="".concat(ct,".hideRow"),wx="".concat(ct,".showRow"),ti="Filters:",Cr="".concat(ti,"conditions"),M6="".concat(Cr,".none"),Sx="".concat(Cr,".isEmpty"),Rx="".concat(Cr,".isNotEmpty"),Ex="".concat(Cr,".isEqualTo"),Cx="".concat(Cr,".isNotEqualTo"),_x="".concat(Cr,".beginsWith"),Tx="".concat(Cr,".endsWith"),Ox="".concat(Cr,".contains"),Ax="".concat(Cr,".doesNotContain"),bPe="".concat(Cr,".byValue"),xx="".concat(Cr,".greaterThan"),Ix="".concat(Cr,".greaterThanOrEqualTo"),Mx="".concat(Cr,".lessThan"),Nx="".concat(Cr,".lessThanOrEqualTo"),Px="".concat(Cr,".isBetween"),kx="".concat(Cr,".isNotBetween"),$x="".concat(Cr,".after"),Lx="".concat(Cr,".before"),Dx="".concat(Cr,".today"),Fx="".concat(Cr,".tomorrow"),Hx="".concat(Cr,".yesterday"),Bx="".concat(ti,"labels.filterByCondition"),Ux="".concat(ti,"labels.filterByValue"),Vx="".concat(ti,"labels.conjunction"),N6="".concat(ti,"labels.disjunction"),Dw="".concat(ti,"values.blankCells"),jx="".concat(ti,"buttons.selectAll"),Wx="".concat(ti,"buttons.clear"),zx="".concat(ti,"buttons.ok"),Gx="".concat(ti,"buttons.cancel"),Yx="".concat(ti,"buttons.placeholder.search"),Kx="".concat(ti,"buttons.placeholder.value"),qx="".concat(ti,"buttons.placeholder.secondValue");const wPe=Object.freeze(Object.defineProperty({__proto__:null,CONTEXT_MENU_ITEMS_NAMESPACE:LX,CONTEXTMENU_ITEMS_NO_ITEMS:M3,CONTEXTMENU_ITEMS_ROW_ABOVE:N3,CONTEXTMENU_ITEMS_ROW_BELOW:P3,CONTEXTMENU_ITEMS_INSERT_LEFT:k3,CONTEXTMENU_ITEMS_INSERT_RIGHT:$3,CONTEXTMENU_ITEMS_REMOVE_ROW:L3,CONTEXTMENU_ITEMS_REMOVE_COLUMN:D3,CONTEXTMENU_ITEMS_UNDO:F3,CONTEXTMENU_ITEMS_REDO:H3,CONTEXTMENU_ITEMS_READ_ONLY:B3,CONTEXTMENU_ITEMS_CLEAR_COLUMN:U3,CONTEXTMENU_ITEMS_COPY:V3,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:j3,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:W3,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:z3,CONTEXTMENU_ITEMS_CUT:G3,CONTEXTMENU_ITEMS_FREEZE_COLUMN:Y3,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:K3,CONTEXTMENU_ITEMS_MERGE_CELLS:q3,CONTEXTMENU_ITEMS_UNMERGE_CELLS:X3,CONTEXTMENU_ITEMS_ADD_COMMENT:Q3,CONTEXTMENU_ITEMS_EDIT_COMMENT:Z3,CONTEXTMENU_ITEMS_REMOVE_COMMENT:J3,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:ex,CONTEXTMENU_ITEMS_ALIGNMENT:tx,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:rx,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:nx,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:ix,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:ox,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:ax,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:sx,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:lx,CONTEXTMENU_ITEMS_BORDERS:ux,CONTEXTMENU_ITEMS_BORDERS_TOP:cx,CONTEXTMENU_ITEMS_BORDERS_RIGHT:fx,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:hx,CONTEXTMENU_ITEMS_BORDERS_LEFT:dx,CONTEXTMENU_ITEMS_REMOVE_BORDERS:px,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:mx,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:gx,CONTEXTMENU_ITEMS_HIDE_COLUMN:yx,CONTEXTMENU_ITEMS_SHOW_COLUMN:vx,CONTEXTMENU_ITEMS_HIDE_ROW:bx,CONTEXTMENU_ITEMS_SHOW_ROW:wx,FILTERS_NAMESPACE:ti,FILTERS_CONDITIONS_NAMESPACE:Cr,FILTERS_CONDITIONS_NONE:M6,FILTERS_CONDITIONS_EMPTY:Sx,FILTERS_CONDITIONS_NOT_EMPTY:Rx,FILTERS_CONDITIONS_EQUAL:Ex,FILTERS_CONDITIONS_NOT_EQUAL:Cx,FILTERS_CONDITIONS_BEGINS_WITH:_x,FILTERS_CONDITIONS_ENDS_WITH:Tx,FILTERS_CONDITIONS_CONTAINS:Ox,FILTERS_CONDITIONS_NOT_CONTAIN:Ax,FILTERS_CONDITIONS_BY_VALUE:bPe,FILTERS_CONDITIONS_GREATER_THAN:xx,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Ix,FILTERS_CONDITIONS_LESS_THAN:Mx,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:Nx,FILTERS_CONDITIONS_BETWEEN:Px,FILTERS_CONDITIONS_NOT_BETWEEN:kx,FILTERS_CONDITIONS_AFTER:$x,FILTERS_CONDITIONS_BEFORE:Lx,FILTERS_CONDITIONS_TODAY:Dx,FILTERS_CONDITIONS_TOMORROW:Fx,FILTERS_CONDITIONS_YESTERDAY:Hx,FILTERS_DIVS_FILTER_BY_CONDITION:Bx,FILTERS_DIVS_FILTER_BY_VALUE:Ux,FILTERS_LABELS_CONJUNCTION:Vx,FILTERS_LABELS_DISJUNCTION:N6,FILTERS_VALUES_BLANK_CELLS:Dw,FILTERS_BUTTONS_SELECT_ALL:jx,FILTERS_BUTTONS_CLEAR:Wx,FILTERS_BUTTONS_OK:zx,FILTERS_BUTTONS_CANCEL:Gx,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:Yx,FILTERS_BUTTONS_PLACEHOLDER_VALUE:Kx,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:qx},Symbol.toStringTag,{value:"Module"}));function dd(t){return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dd(t)}function YE(t,e,r){return e=DX(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SPe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,DX(n.key),n)}}function RPe(t,e,r){return e&&pD(t.prototype,e),r&&pD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function DX(t){var e=EPe(t,"string");return dd(e)==="symbol"?e:String(e)}function EPe(t,e){if(dd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cu(){return typeof Reflect<"u"&&Reflect.get?cu=Reflect.get.bind():cu=function(e,r,n){var i=CPe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},cu.apply(this,arguments)}function CPe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ya(t),t!==null););return t}function _Pe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&DO(t,e)}function DO(t,e){return DO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},DO(t,e)}function TPe(t){var e=APe();return function(){var n=Ya(t),i;if(e){var o=Ya(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return OPe(this,i)}}function OPe(t,e){if(e&&(dd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FX(t)}function FX(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function APe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ya(t){return Ya=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ya(t)}var KE="comments",xPe=60,D0=new WeakMap,Ho="comment",Kc="value",mD="style",F0="readOnly",IPe=function(t){_Pe(r,t);var e=TPe(r);function r(n){var i;return SPe(this,r),i=e.call(this,n),i.editor=null,i.displaySwitch=null,i.eventManager=null,i.range={},i.preventEditorAutoSwitch=!1,D0.set(FX(i),{tempEditorDimensions:{},cellBelowCursor:null}),i}return RPe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[KE]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.editor||(this.editor=new tPe(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Er(this)),this.displaySwitch||(this.displaySwitch=new vPe(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(o){return i.addToContextMenu(o)}),this.addHook("afterRenderer",function(o,a,s,l,u,c){return i.onAfterRenderer(o,c)}),this.addHook("afterScrollHorizontally",function(){return i.hide()}),this.addHook("afterScrollVertically",function(){return i.hide()}),this.addHook("afterBeginEditing",function(){return i.hide()}),this.displaySwitch.addLocalHook("hide",function(){return i.hide()}),this.displaySwitch.addLocalHook("show",function(o,a){return i.showAtCell(o,a)}),this.registerListeners(),cu(Ya(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),cu(Ya(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){cu(Ya(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var i=this,o=this.hot.rootDocument;this.eventManager.addEventListener(o,"mouseover",function(a){return i.onMouseOver(a)}),this.eventManager.addEventListener(o,"mousedown",function(a){return i.onMouseDown(a)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return i.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return i.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return i.onEditorMouseUp(a)})}},{key:"setRange",value:function(i){this.range=i}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(i){var o=Fu(i.target,"TD","TBODY");return!!(o&&at(o,"htCommentCell")&&Fu(o,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(i){return this.editor.getInputElement()===i.target}},{key:"setComment",value:function(i){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.editor.getValue(),a="";i!=null?a=i:o!=null&&(a=o);var s=this.range.from.row,l=this.range.from.col;this.updateCommentMeta(s,l,YE({},Kc,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(i,o,a){this.setRange({from:this.hot._createCellCoords(i,o)}),this.setComment(a)}},{key:"removeComment",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Ho),i&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(i,o)}),this.removeComment(a)}},{key:"getComment",value:function(){var i=this.range.from.row,o=this.range.from.col;return this.getCommentMeta(i,o,Kc)}},{key:"getCommentAtCell",value:function(i,o){return this.getCommentMeta(i,o,Kc)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.range.from,o=i.row,a=i.col;if(o<0||o>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(s[Ho]?s[Ho][Kc]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(i,o){return this.setRange({from:this.hot._createCellCoords(i,o)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var i,o,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var s=this.hot,l=s.rowIndexMapper,u=s.columnIndexMapper,c=this.range.from,f=c.row,h=c.col,d=l.getRenderableFromVisualIndex(f),p=u.getRenderableFromVisualIndex(h),m=d===null;this.editor.setPosition(0,0),d===null&&(d=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,-1))),p===null&&(p=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));var g=d===null,v=p===null;d=(i=d)!==null&&i!==void 0?i:0,p=(o=p)!==null&&o!==void 0?o:0;var S=this.hot,b=S.rootWindow,E=S.view._wt,T=E.wtTable,N=E.getCell({row:d,col:p},!0),L=this.getCommentMeta(f,h,mD);L?this.editor.setSize(L.width,L.height):this.editor.resetSize();var V=v?0:T.getStretchedColumnWidth(p),B=m&&!g?wr(N):0,k=N.getBoundingClientRect(),M=k.left,G=k.top,j=k.width,q=k.height,te=this.editor.getSize(),pe=te.width,ne=te.height,O=this.hot.rootWindow,y=O.innerWidth,R=O.innerHeight,C=this.hot.rootDocument.documentElement,A=M+b.scrollX+V,P=G+b.scrollY+B;this.hot.isRtl()&&(A-=pe+V),this.hot.isLtr()&&M+j+pe>y?A=M+b.scrollX-pe-1:this.hot.isRtl()&&A<-(C.scrollWidth-C.clientWidth)&&(A=M+b.scrollX+V+1),G+ne>R&&(P-=ne-q+1),this.editor.setPosition(A,P),this.editor.setReadOnlyState(this.getCommentMeta(f,h,F0))}}},{key:"checkSelectionCommentsConsistency",value:function(){var i=this.hot.getSelectedRangeLast();if(!i)return!1;var o=!1,a=i.getTopStartCorner();return this.getCommentMeta(a.row,a.col,Kc)&&(o=!0),o}},{key:"updateCommentMeta",value:function(i,o,a){var s=this.hot.getCellMeta(i,o)[Ho],l;s?(l=Zn(s),R6(l,a)):l=a,this.hot.setCellMeta(i,o,Ho,l)}},{key:"getCommentMeta",value:function(i,o,a){var s=this.hot.getCellMeta(i,o);if(!!s[Ho])return s[Ho][a]}},{key:"onMouseDown",value:function(i){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(i)){var o=Fu(i.target,"TD","TBODY"),a=null;o&&(a=this.hot.getCoords(o)),(!o||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}}},{key:"onMouseOver",value:function(i){var o=D0.get(this),a=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||at(i.target,"wtBorder")||o.cellBelowCursor===i.target||!this.editor))if(o.cellBelowCursor=a.elementFromPoint(i.clientX,i.clientY),this.targetIsCellWithComment(i)){var s=this.hot._createCellRange(this.hot.getCoords(i.target));this.displaySwitch.show(s)}else Hu(i.target,a)&&!this.targetIsCommentTextArea(i)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(i,o){o[Ho]&&o[Ho][Kc]&&Re(i,o.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(i){var o=D0.get(this);o.tempEditorDimensions={width:Qt(i.target),height:wr(i.target)}}},{key:"onEditorMouseUp",value:function(i){var o=D0.get(this),a=Qt(i.target),s=wr(i.target);(a!==o.tempEditorDimensions.width+1||s!==o.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,YE({},mD,{width:a,height:s}))}},{key:"onContextMenuAddComment",value:function(){var i=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:i.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var i=this,o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,o.forAll(function(a,s){a>=0&&s>=0&&i.removeCommentAtCell(a,s,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var i=this,o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,o.forAll(function(a,s){if(a>=0&&s>=0){var l=!!i.getCommentMeta(a,s,F0);i.updateCommentMeta(a,s,YE({},F0,!l))}})}},{key:"addToContextMenu",value:function(i){var o=this,a=function(){return o.hot.rowIndexMapper.getRenderableIndexesLength()>0&&o.hot.columnIndexMapper.getRenderableIndexesLength()>0};i.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return o.checkSelectionCommentsConsistency()?o.hot.getTranslatedPhrase(Z3):o.hot.getTranslatedPhrase(Q3)},callback:function(){return o.onContextMenuAddComment()},disabled:function(){return a()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(J3)},callback:function(){return o.onContextMenuRemoveComment()},disabled:function(){return a()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var l=this,u=this.getTranslatedPhrase(ex),c=Qo(this.getSelectedRangeLast(),function(f,h){var d=l.getCellMeta(f,h)[Ho];if(d&&(d=d[F0]),d)return!0});return c&&(u=ka(u)),u},callback:function(){return o.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner())||!o.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var i=this.hot.getSettings()[KE];if(wt(i))return i.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),cu(Ya(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return KE}},{key:"PLUGIN_PRIORITY",get:function(){return xPe}}]),r}(jt);function Ry(t){return Ry=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ry(t)}function MPe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,PPe(n.key),n)}}function NPe(t,e,r){return e&&gD(t.prototype,e),r&&gD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function PPe(t){var e=kPe(t,"string");return Ry(e)==="symbol"?e:String(e)}function kPe(t,e){if(Ry(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ry(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $Pe=function(){function t(e){MPe(this,t),this.hot=e,this.commands={},this.commonCallback=null}return NPe(t,[{key:"registerCommand",value:function(r,n){this.commands[r]=n}},{key:"setCommonCallback",value:function(r){this.commonCallback=r}},{key:"execute",value:function(r){for(var n=this,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var s=r.split(":"),l=s[0],u=s.length===2?s[1]:null,c=this.commands[l];if(!c)throw new Error("Menu command '".concat(l,"' not exists."));if(u&&c.submenu&&(c=LPe(u,c.submenu.items)),c.disabled!==!0&&!(typeof c.disabled=="function"&&c.disabled.call(this.hot)===!0)&&!Nr(c,"submenu")){var f=[];typeof c.callback=="function"&&f.push(c.callback),typeof this.commonCallback=="function"&&f.push(this.commonCallback),o.unshift(s.join(":")),Q(f,function(h){return h.apply(n.hot,o)})}}}]),t}();function LPe(t,e){var r;return Q(e,function(n){var i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}const HX=$Pe;var ji="alignment";function DPe(){return{key:ji,name:function(){return this.getTranslatedPhrase(tx)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(ji,":left"),name:function(){var e=this,r=this.getTranslatedPhrase(rx),n=Qo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(r=ka(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Dl(r,function(a,s){return e.getCellMeta(a,s).className}),i="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",n,r,i,o),Hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(ji,":center"),name:function(){var e=this,r=this.getTranslatedPhrase(nx),n=Qo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(r=ka(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Dl(r,function(a,s){return e.getCellMeta(a,s).className}),i="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",n,r,i,o),Hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(ji,":right"),name:function(){var e=this,r=this.getTranslatedPhrase(ix),n=Qo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(r=ka(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Dl(r,function(a,s){return e.getCellMeta(a,s).className}),i="horizontal",o="htRight";this.runHooks("beforeCellAlignment",n,r,i,o),Hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(ji,":justify"),name:function(){var e=this,r=this.getTranslatedPhrase(ox),n=Qo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(r=ka(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Dl(r,function(a,s){return e.getCellMeta(a,s).className}),i="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",n,r,i,o),Hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{name:vt},{key:"".concat(ji,":top"),name:function(){var e=this,r=this.getTranslatedPhrase(ax),n=Qo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(r=ka(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Dl(r,function(a,s){return e.getCellMeta(a,s).className}),i="vertical",o="htTop";this.runHooks("beforeCellAlignment",n,r,i,o),Hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(ji,":middle"),name:function(){var e=this,r=this.getTranslatedPhrase(sx),n=Qo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(r=ka(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Dl(r,function(a,s){return e.getCellMeta(a,s).className}),i="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",n,r,i,o),Hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1},{key:"".concat(ji,":bottom"),name:function(){var e=this,r=this.getTranslatedPhrase(lx),n=Qo(this.getSelectedRange(),function(i,o){var a=e.getCellMeta(i,o).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(r=ka(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Dl(r,function(a,s){return e.getCellMeta(a,s).className}),i="vertical",o="htBottom";this.runHooks("beforeCellAlignment",n,r,i,o),Hs(r,i,o,function(a,s){return e.getCellMeta(a,s)},function(a,s,l,u){return e.setCellMeta(a,s,l,u)}),this.render()},disabled:!1}]}}}var P6="clear_column";function FPe(){return{key:P6,name:function(){return this.getTranslatedPhrase(U3)},callback:function(e,r){var n=r[0].start.col,i=r[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(r[0].start.row,r[0].end.row),i,"ContextMenu.clearColumn")},disabled:function(){var e=Tc(this);return e?!this.selection.isSelectedByColumnHeader():!0}}}var D1="col_left";function HPe(){return{key:D1,name:function(){return this.getTranslatedPhrase(k3)},callback:function(){var e=this.getSelectedRangeLast().getTopLeftCorner(),r=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(r,e.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=Tc(this);if(!e)return!0;if(this.selection.isSelectedByCorner()){var r=this.countCols();return r===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var F1="col_right";function BPe(){return{key:F1,name:function(){return this.getTranslatedPhrase($3)},callback:function(){var e=this.getSelectedRangeLast().getTopRightCorner(),r=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(r,e.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=Tc(this);return e?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var H1="make_read_only";function UPe(){return{key:H1,name:function(){var e=this,r=this.getTranslatedPhrase(B3),n=Qo(this.getSelectedRange(),function(i,o){return e.getCellMeta(i,o).readOnly});return n&&(r=ka(r)),r},callback:function(){var e=this,r=this.getSelectedRange(),n=Qo(r,function(i,o){return e.getCellMeta(i,o).readOnly});Q(r,function(i){i.forAll(function(o,a){o>=0&&a>=0&&e.setCellMeta(o,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var k6="redo";function VPe(){return{key:k6,name:function(){return this.getTranslatedPhrase(H3)},callback:function(){this.redo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function BX(t,e){return GPe(t)||zPe(t,e)||WPe(t,e)||jPe()}function jPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WPe(t,e){if(!!t){if(typeof t=="string")return yD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yD(t,e)}}function yD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zPe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function GPe(t){if(Array.isArray(t))return t}function FO(t){return FO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},FO(t)}var $6=0,L6=1,UX=2,Xx=3,YPe=[Xx,UX],KPe=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],qE=Symbol("root"),vD=Symbol("child");function pd(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qE;if(e!==qE&&e!==vD)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(t),n=e===qE,i=$6;if(r){var o=t[0];if(t.length===0)i=L6;else if(n&&o instanceof d3)i=Xx;else if(n&&Array.isArray(o))i=pd(o,vD);else if(t.length>=2&&t.length<=4){var a=!t.some(function(s,l){return!KPe[l].includes(FO(s))});a&&(i=UX)}}return i}function Ey(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.keepDirection,n=r===void 0?!1:r,i=e.propToCol;if(!YPe.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){var a=t===Xx,s=a?o.from.row:o[0],l=a?o.from.col:o[1],u=a?o.to.row:o[2],c=a?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),tr(u)&&(u=s),tr(c)&&(c=l),!n){var f=s,h=l,d=u,p=c;s=Math.min(f,d),l=Math.min(h,p),u=Math.max(f,d),c=Math.max(h,p)}return[s,l,u,c]}}function qPe(t){var e=pd(t);if(e===$6||e===L6)return[];var r=Ey(e),n=new Set;Q(t,function(a){var s=r(a),l=BX(s,4),u=l[1],c=l[3],f=Math.max(u,0),h=c-f+1;Q(Array.from(new Array(h),function(d,p){return f+p}),function(d){n.has(d)||n.add(d)})});var i=Array.from(n).sort(function(a,s){return a-s}),o=Hn(i,function(a,s,l,u){return l!==0&&s===u[l-1]+1?a[a.length-1][1]+=1:a.push([s,1]),a},[]);return o}function XPe(t){var e=pd(t);if(e===$6||e===L6)return[];var r=Ey(e),n=new Set;Q(t,function(a){var s=r(a),l=BX(s,3),u=l[0],c=l[2],f=Math.max(u,0),h=c-f+1;Q(Array.from(new Array(h),function(d,p){return f+p}),function(d){n.has(d)||n.add(d)})});var i=Array.from(n).sort(function(a,s){return a-s}),o=Hn(i,function(a,s,l,u){return l!==0&&s===u[l-1]+1?a[a.length-1][1]+=1:a.push([s,1]),a},[]);return o}function Ms(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof t=="number"&&t>=0&&t<e}function QPe(t,e){return tke(t)||eke(t,e)||JPe(t,e)||ZPe()}function ZPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JPe(t,e){if(!!t){if(typeof t=="string")return bD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bD(t,e)}}function bD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function eke(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function tke(t){if(Array.isArray(t))return t}var B1="remove_col";function rke(){return{key:B1,name:function(){var e=this.getSelected(),r=0;if(e)if(e.length>1)r=1;else{var n=QPe(e[0],4),i=n[1],o=n[3];i-o!==0&&(r=1)}return this.getTranslatedPhrase(D3,r)},callback:function(){this.alter("remove_col",qPe(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=Tc(this);if(!e)return!0;var r=this.countCols();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByRowHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function nke(t,e){return ske(t)||ake(t,e)||oke(t,e)||ike()}function ike(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oke(t,e){if(!!t){if(typeof t=="string")return wD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wD(t,e)}}function wD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ake(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function ske(t){if(Array.isArray(t))return t}var D6="remove_row";function lke(){return{key:D6,name:function(){var e=this.getSelected(),r=0;if(e)if(e.length>1)r=1;else{var n=nke(e[0],3),i=n[0],o=n[2];i-o!==0&&(r=1)}return this.getTranslatedPhrase(L3,r)},callback:function(){this.alter("remove_row",XPe(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var e=Tc(this);if(!e)return!0;var r=this.countRows();return this.selection.isSelectedByCorner()?r===0:this.selection.isSelectedByColumnHeader()||r===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var F6="row_above";function uke(){return{key:F6,name:function(){return this.getTranslatedPhrase(N3)},callback:function(){var e=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",e.row,1,"ContextMenu.rowAbove")},disabled:function(){var e=Tc(this);if(!e)return!0;if(this.selection.isSelectedByCorner()){var r=this.countRows();return r===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var H6="row_below";function cke(){return{key:H6,name:function(){return this.getTranslatedPhrase(P3)},callback:function(){var e=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",e.row,1,"ContextMenu.rowBelow")},disabled:function(){var e=Tc(this);return e?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Cy="no_items";function fke(){return{key:Cy,name:function(){return this.getTranslatedPhrase(M3)},disabled:!0,isCommand:!1}}var B6="undo";function hke(){return{key:B6,name:function(){return this.getTranslatedPhrase(F3)},callback:function(){this.undo()},hidden:function(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function _y(t){return _y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_y(t)}var Un;function Ri(t,e,r){return e=dke(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dke(t){var e=pke(t,"string");return _y(e)==="symbol"?e:String(e)}function pke(t,e){if(_y(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(_y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mke=[F6,H6,D1,F1,P6,D6,B1,B6,k6,H1,ji,vt,Cy],gke=(Un={},Ri(Un,vt,rPe),Ri(Un,Cy,fke),Ri(Un,F6,uke),Ri(Un,H6,cke),Ri(Un,D1,HPe),Ri(Un,F1,BPe),Ri(Un,P6,FPe),Ri(Un,D6,lke),Ri(Un,B1,rke),Ri(Un,B6,hke),Ri(Un,k6,VPe),Ri(Un,H1,UPe),Ri(Un,ji,DPe),Un);function VX(){var t={};return St(gke,function(e,r){t[r]=e()}),t}function Ty(t){return Ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ty(t)}function yke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function SD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bke(n.key),n)}}function vke(t,e,r){return e&&SD(t.prototype,e),r&&SD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function bke(t){var e=wke(t,"string");return Ty(e)==="symbol"?e:String(e)}function wke(t,e){if(Ty(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ty(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ske=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;yke(this,t),this.hot=e,this.predefinedItems=VX(),this.defaultOrderPattern=r}return vke(t,[{key:"setPredefinedItems",value:function(r){var n=this,i={};this.defaultOrderPattern.length=0,St(r,function(o,a){var s="";o.name===vt?(i[vt]=o,s=vt):isNaN(parseInt(a,10))?(o.key=o.key===void 0?a:o.key,i[a]=o,s=o.key):(i[o.key]=o,s=o.key),n.defaultOrderPattern.push(s)}),this.predefinedItems=i}},{key:"getItems",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Rke(r,this.defaultOrderPattern,this.predefinedItems)}}]),t}();function Rke(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),wt(i)?St(i,function(o,a){var s=r[typeof o=="string"?o:a];s||(s=o),wt(o)?Jr(s,o):typeof s=="string"&&(s={name:s}),s.key===void 0&&(s.key=a),n.push(s)}):Q(i,function(o,a){var s=r[o];!s&&mke.indexOf(o)>=0||(s||(s={name:o,key:"".concat(a)}),wt(o)&&Jr(s,o),s.key===void 0&&(s.key=a),n.push(s))}),n}const jX=Ske;function Oy(t){return Oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oy(t)}function Eke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function RD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_ke(n.key),n)}}function Cke(t,e,r){return e&&RD(t.prototype,e),r&&RD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _ke(t){var e=Tke(t,"string");return Oy(e)==="symbol"?e:String(e)}function Tke(t,e){if(Oy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Oy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Oke=function(){function t(e,r){Eke(this,t);var n=Ng(r),i=ph(r),o,a,s,l,u,c;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),s=parseInt(e.left,10),u=e.height||0,c=e.width||0,a=o,l=s,o+=n,s+=i):this.type==="event"&&(o=parseInt(e.pageY,10),s=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,a=o-n,l=s-i),this.top=o,this.topRelative=a,this.left=s,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}return Cke(t,[{key:"getSourceType",value:function(r){var n="literal";return r instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(r){return this.topRelative>=r.offsetHeight}},{key:"fitsBelow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+r.offsetHeight<=n}},{key:"fitsOnRight",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+r.offsetWidth<=n}},{key:"fitsOnLeft",value:function(r){return this.leftRelative>=r.offsetWidth}}]),t}();const Ake=Oke;var xke=gc,Ike=/(?:ipad|iphone|ipod).*applewebkit/i.test(xke),Mke=ga,WX=typeof process<"u"&&Mke(process)=="process",Ii=nr,Nke=Ec,Pke=w1,ED=cr,kke=Rr,zX=dt,CD=pG,$ke=_1,_D=t6,Lke=BK,Dke=Ike,Fke=WX,HO=Ii.setImmediate,BO=Ii.clearImmediate,Hke=Ii.process,XE=Ii.Dispatch,Bke=Ii.Function,TD=Ii.MessageChannel,Uke=Ii.String,QE=0,og={},OD="onreadystatechange",Ay,Fl,ZE,JE;zX(function(){Ay=Ii.location});var Qx=function(t){if(kke(og,t)){var e=og[t];delete og[t],e()}},eC=function(t){return function(){Qx(t)}},AD=function(t){Qx(t.data)},xD=function(t){Ii.postMessage(Uke(t),Ay.protocol+"//"+Ay.host)};(!HO||!BO)&&(HO=function(e){Lke(arguments.length,1);var r=ED(e)?e:Bke(e),n=$ke(arguments,1);return og[++QE]=function(){Nke(r,void 0,n)},Fl(QE),QE},BO=function(e){delete og[e]},Fke?Fl=function(t){Hke.nextTick(eC(t))}:XE&&XE.now?Fl=function(t){XE.now(eC(t))}:TD&&!Dke?(ZE=new TD,JE=ZE.port2,ZE.port1.onmessage=AD,Fl=Pke(JE.postMessage,JE)):Ii.addEventListener&&ED(Ii.postMessage)&&!Ii.importScripts&&Ay&&Ay.protocol!=="file:"&&!zX(xD)?(Fl=xD,Ii.addEventListener("message",AD,!1)):OD in _D("script")?Fl=function(t){CD.appendChild(_D("script"))[OD]=function(){CD.removeChild(this),Qx(t)}}:Fl=function(t){setTimeout(eC(t),0)});var GX={set:HO,clear:BO},Vke=tt,jke=nr,ID=GX.clear;Vke({global:!0,bind:!0,enumerable:!0,forced:jke.clearImmediate!==ID},{clearImmediate:ID});var Wke=tt,YX=nr,MD=GX.set,zke=Q8,ND=YX.setImmediate?zke(MD,!1):MD;Wke({global:!0,bind:!0,enumerable:!0,forced:YX.setImmediate!==ND},{setImmediate:ND});var Gke=en,Yke=h6,Kke=$r,qke=No,Xke=bc,tC=Gr,Qke=bi,Zke=vc,Jke=T8,PD=d6;Yke("match",function(t,e,r){return[function(i){var o=Qke(this),a=qke(i)?void 0:Zke(i,t);return a?Gke(a,i,o):new RegExp(i)[t](tC(o))},function(n){var i=Kke(this),o=tC(n),a=r(e,i,o);if(a.done)return a.value;if(!i.global)return PD(i,o);var s=i.unicode;i.lastIndex=0;for(var l=[],u=0,c;(c=PD(i,o))!==null;){var f=tC(c[0]);l[u]=f,f===""&&(i.lastIndex=Jke(o,Xke(i.lastIndex),s)),u++}return u===0?null:l}]});var e$e=Ec,t$e=Li,r$e=Sl,n$e=ao,i$e=Fp,o$e=Math.min,UO=[].lastIndexOf,KX=!!UO&&1/[1].lastIndexOf(1,-0)<0,a$e=i$e("lastIndexOf"),s$e=KX||!a$e,l$e=s$e?function(e){if(KX)return e$e(UO,this,arguments)||0;var r=t$e(this),n=n$e(r),i=n-1;for(arguments.length>1&&(i=o$e(i,r$e(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in r&&r[i]===e)return i||0;return-1}:UO,u$e=tt,kD=l$e;u$e({target:"Array",proto:!0,forced:kD!==[].lastIndexOf},{lastIndexOf:kD});var c$e=yc,f$e=wi,h$e=a1,d$e=ao,p$e=TypeError,$D=function(t){return function(e,r,n,i){c$e(r);var o=f$e(e),a=h$e(o),s=d$e(o),l=t?s-1:0,u=t?-1:1;if(n<2)for(;;){if(l in a){i=a[l],l+=u;break}if(l+=u,t?l<0:s<=l)throw p$e("Reduce of empty array with no initial value")}for(;t?l>=0:s>l;l+=u)l in a&&(i=r(i,a[l],l,o));return i}},m$e={left:$D(!1),right:$D(!0)},g$e=tt,y$e=m$e.left,v$e=Fp,LD=s1,b$e=WX,w$e=!b$e&&LD>79&&LD<83,S$e=w$e||!v$e("reduce");g$e({target:"Array",proto:!0,forced:S$e},{reduce:function(e){var r=arguments.length;return y$e(this,e,r,r>1?arguments[1]:void 0)}});function rC(t){return _$e(t)||C$e(t)||E$e(t)||R$e()}function R$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E$e(t,e){if(!!t){if(typeof t=="string")return VO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VO(t,e)}}function C$e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function _$e(t){if(Array.isArray(t))return VO(t)}function VO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var qX={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},T$e=new RegExp(Object.keys(qX).map(function(t){return"(".concat(t,")")}).join("|"),"gi");function O$e(t){return(t&&t.nodeName||"")==="TABLE"}function DD(t){for(var e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData.apply(t,n),o=i.length,a=o>0?i[0].length:0,s=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,f=e?1:0,h=0;h<o;h+=1){for(var d=e&&h===0,p=[],m=0;m<a;m+=1){var g=!d&&r&&m===0,v="";if(d)v="<th>".concat(t.getColHeader(m-c),"</th>");else if(g)v="<th>".concat(t.getRowHeader(h-f),"</th>");else{var S=i[h][m],b=t.getCellMeta(h-f,m-c),E=b.hidden,T=b.rowspan,N=b.colspan;if(!E){var L=[];if(T&&L.push('rowspan="'.concat(T,'"')),N&&L.push('colspan="'.concat(N,'"')),an(S))v="<td ".concat(L.join(" "),"></td>");else{var V=S.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");v="<td ".concat(L.join(" "),">").concat(V,"</td>")}}}p.push(v)}var B=["<tr>"].concat(p,["</tr>"]).join("");d?l.splice(1,0,B):u.splice(-1,0,B)}return s.splice(1,0,l.join(""),u.join("")),s.join("")}function FD(t){for(var e=t.length,r=["<table>"],n=0;n<e;n+=1){var i=t[n],o=i.length,a=[];n===0&&r.push("<tbody>");for(var s=0;s<o;s+=1){var l=i[s],u=an(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function A$e(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);var o=t;if(typeof o=="string"){var a=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(A){var P=A.match(/<td\b[^>]*?>/g)[0],H=A.substring(P.length,A.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),Y="</td>";return"".concat(P).concat(H).concat(Y)});i.insertAdjacentHTML("afterbegin","".concat(a)),o=i.querySelector("table")}if(!(!o||!O$e(o))){var s=i.querySelector('meta[name$="enerator"]'),l=o.querySelector("tbody th")!==null,u=o.querySelector("tr"),c=u?Array.from(u.cells).reduce(function(A,P){return A+P.colSpan},0)-(l?1:0):0,f=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[],d=!1,p=0,m=0;if(o.tHead){var g=Array.from(o.tHead.rows).filter(function(A){var P=A.querySelector("td")!==null;return P&&h.push(A),!P});p=g.length,d=p>0,p>1?r.nestedHeaders=Array.from(g).reduce(function(A,P){var H=Array.from(P.cells).reduce(function(Y,z,oe){if(l&&oe===0)return Y;var me=z.colSpan,re=z.innerHTML,ge=me>1?{label:re,colspan:me}:re;return Y.push(ge),Y},[]);return A.push(H),A},[]):d&&(r.colHeaders=Array.from(g[0].children).reduce(function(A,P,H){return l&&H===0||A.push(P.innerHTML),A},[]))}h.length&&(r.fixedRowsTop=h.length),f.length&&(r.fixedRowsBottom=f.length);var v=[].concat(h,rC(Array.from(o.tBodies).reduce(function(A,P){return A.push.apply(A,rC(Array.from(P.rows))),A},[])),rC(f));m=v.length;for(var S=new Array(m),b=0;b<m;b++)S[b]=new Array(c);for(var E=[],T=[],N=0;N<m;N++)for(var L=v[N],V=Array.from(L.cells),B=V.length,k=0;k<B;k++){var M=V[k],G=M.nodeName,j=M.innerHTML,q=M.rowSpan,te=M.colSpan,pe=S[N].findIndex(function(A){return A===void 0});if(G==="TD"){if(q>1||te>1){for(var ne=N;ne<N+q;ne++)if(ne<m)for(var O=pe;O<pe+te;O++)S[ne][O]=null;var y=M.getAttribute("style"),R=y&&y.includes("mso-ignore:colspan");R||E.push({col:pe,row:N,rowspan:q,colspan:te})}var C="";s&&/excel/gi.test(s.content)?C=j.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):C=j.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[N][pe]=C.replace(T$e,function(A){return qX[A]})}else T.push(j)}return E.length&&(r.mergeCells=E),T.length&&(r.rowHeaders=T),S.length&&(r.data=S),r}}function HD(t){var e=t.isShiftKey,r=t.isLeftClick,n=t.isRightClick,i=t.coords,o=t.selection,a=t.controller,s=t.cellCoordsFactory,l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!a.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!a.cell?o.setRangeEnd(s(i.row,i.col)):u&&i.row<0&&!a.column?o.setRangeEnd(s(l.to.row,i.col)):c&&i.col<0&&!a.row?o.setRangeEnd(s(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!a.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!a.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{var f=!o.inInSelection(i),h=r||n&&f;i.row<0&&i.col>=0&&!a.column?h&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!a.row?h&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!a.cell?h&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0)}}function x$e(t){var e=t.isLeftClick,r=t.coords,n=t.selection,i=t.controller,o=t.cellCoordsFactory;if(!!e){var a=n.isSelectedByRowHeader(),s=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();s&&!i.column?n.setRangeEnd(o(u-1,r.col)):a&&!i.row?n.setRangeEnd(o(r.row,l-1)):i.cell||n.setRangeEnd(r)}}var I$e=new Map([["mousedown",HD],["mouseover",x$e],["touchstart",HD]]);function BD(t,e){var r=e.coords,n=e.selection,i=e.controller,o=e.cellCoordsFactory;I$e.get(t.type)({coords:r,selection:n,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:W8(t)||t.type==="touchstart",isRightClick:zu(t)})}var XX=new WeakMap,Zx=Symbol("rootInstance");function M$e(t){XX.set(t,!0)}function N$e(t){return t===Zx}function jO(t){return XX.has(t)}function xy(t){return xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xy(t)}function pm(t,e){return $$e(t)||k$e(t,e)||QX(t,e)||P$e()}function P$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k$e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function $$e(t){if(Array.isArray(t))return t}function UD(t){return F$e(t)||D$e(t)||QX(t)||L$e()}function L$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QX(t,e){if(!!t){if(typeof t=="string")return WO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WO(t,e)}}function D$e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function F$e(t){if(Array.isArray(t))return WO(t)}function WO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function H$e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ZX(n.key),n)}}function B$e(t,e,r){return e&&VD(t.prototype,e),r&&VD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function jD(t,e,r){U$e(t,e),e.set(t,r)}function U$e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ns(t,e,r){return e=ZX(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZX(t){var e=V$e(t,"string");return xy(e)==="symbol"?e:String(e)}function V$e(t,e){if(xy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(xy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WD(t,e){var r=JX(t,e,"get");return j$e(t,r)}function j$e(t,e){return e.get?e.get.call(t):e.value}function zD(t,e,r){var n=JX(t,e,"set");return W$e(t,n,r),r}function JX(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function W$e(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Hl=new WeakMap,nC=new WeakMap,iC=new WeakMap,z$e=function(){function t(e){H$e(this,t),Ns(this,"instance",void 0),Ns(this,"eventManager",void 0),Ns(this,"settings",void 0),Ns(this,"THEAD",void 0),Ns(this,"TBODY",void 0),Ns(this,"_wt",void 0),Ns(this,"activeWt",void 0),jD(this,nC,{writable:!0,value:0}),jD(this,iC,{writable:!0,value:0}),Ns(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new Er(this.instance),this.settings=this.instance.getSettings(),Hl.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return B$e(t,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(r)}},{key:"getCellAtCoords",value:function(r,n){var i=this._wt.getCell(r,n);return i<0?null:i}},{key:"scrollViewport",value:function(r,n,i,o,a){return this._wt.scrollViewport(r,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(r,n,i){return this._wt.scrollViewportHorizontally(r,n,i)}},{key:"scrollViewportVertically",value:function(r,n,i){return this._wt.scrollViewportVertically(r,n,i)}},{key:"createElements",value:function(){var r=Hl.get(this),n=this.instance,i=n.rootElement,o=n.rootDocument,a=i.getAttribute("style");a&&i.setAttribute("data-originalstyle",a),Re(i,"handsontable"),r.table=o.createElement("TABLE"),Re(r.table,"htCore"),this.instance.getSettings().tableClassName&&Re(r.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),r.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),r.table.appendChild(this.TBODY),this.instance.table=r.table,this.instance.container.insertBefore(r.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var r=this,n=Hl.get(this),i=this.instance,o=i.rootElement,a=i.rootDocument,s=i.selection,l=a.documentElement;this.eventManager.addEventListener(o,"mousedown",function(u){if(n.selectionMouseDown=!0,!r.isTextSelectionAllowed(u.target)){var c=r.instance.rootWindow;dk(c),u.preventDefault(),c.focus()}}),this.eventManager.addEventListener(o,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(o,"mousemove",function(u){n.selectionMouseDown&&!r.isTextSelectionAllowed(u.target)&&(r.settings.fragmentSelection&&dk(r.instance.rootWindow),u.preventDefault())}),this.eventManager.addEventListener(l,"keyup",function(u){s.isInProgress()&&!u.shiftKey&&s.finish()}),this.eventManager.addEventListener(l,"mouseup",function(u){s.isInProgress()&&W8(u)&&s.finish(),n.mouseDown=!1,(q8(a.activeElement)||!s.isSelected()&&!s.isSelectedByAnyHeader()&&!o.contains(u.target)&&!zu(u))&&r.instance.unlisten()}),this.eventManager.addEventListener(l,"contextmenu",function(u){s.isInProgress()&&zu(u)&&(s.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(l,"touchend",function(){s.isInProgress()&&s.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(l,"mousedown",function(u){var c=u.target,f=u.x||u.clientX,h=u.y||u.clientY,d=u.target;if(!(n.mouseDown||!o||!r.instance.view)){var p=r.instance.view._wt.wtTable.holder;if(d===p){var m=yn(a);if(a.elementFromPoint(f+m,h)!==p||a.elementFromPoint(f,h+m)!==p)return}else for(;d!==l;){if(d===null){if(u.isTargetWebComponent)break;return}if(d===o)return;d=d.parentNode}var g=typeof r.settings.outsideClickDeselects=="function"?r.settings.outsideClickDeselects(c):r.settings.outsideClickDeselects;g?r.instance.deselectCell():r.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(u){r.settings.fragmentSelection||tw(u.target)||u.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(r){var n,i=r.row,o=r.col;return(n=this.instance)._createCellCoords.apply(n,UD(this.translateFromRenderableToVisualIndex(i,o)))}},{key:"translateFromRenderableToVisualIndex",value:function(r,n){var i=r>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(r):r,o=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=r),o===null&&(o=n),[i,o]}},{key:"countRenderableIndexes",value:function(r,n){var i=Math.min(r.getNotTrimmedIndexesLength(),n),o=r.getNearestNotHiddenIndex(i-1,-1);return o===null?0:r.getRenderableFromVisualIndex(o)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(r,n){return this.countNotHiddenIndexes(r,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(r,n,i,o){if(isNaN(r)||r<0)return 0;var a=i.getNearestNotHiddenIndex(r,n),s=i.getRenderableFromVisualIndex(a);if(!Number.isInteger(s))return 0;var l=0;return n<0?l=s+1:n>0&&(l=o-s),l}},{key:"countNotHiddenFixedColumnsStart",value:function(){var r=this.instance.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),r)-1;return this.countNotHiddenColumnIndexes(n,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var r=this.instance.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),r)-1;return this.countNotHiddenRowIndexes(n,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var r=this.instance.countRows(),n=Math.max(r-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var r=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>r&&this.instance.countRenderedCols()>n}},{key:"initializeWalkontable",value:function(){var r=this,n=Hl.get(this),i={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return jO(r.instance)},preventOverflow:function(){return r.settings.preventOverflow},preventWheel:function(){return r.settings.preventWheel},stretchH:function(){return r.settings.stretchH},data:function(c,f){var h;return(h=r.instance).getDataAtCell.apply(h,UD(r.translateFromRenderableToVisualIndex(c,f)))},totalRows:function(){return r.countRenderableRows()},totalColumns:function(){return r.countRenderableColumns()},fixedColumnsStart:function(){return r.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return r.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return r.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return r.settings.fixedColumnsStart>0||i.rowHeaders().length>0},shouldRenderTopOverlay:function(){return r.settings.fixedRowsTop>0||i.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return r.settings.fixedRowsBottom>0},minSpareRows:function(){return r.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var c=[];return r.instance.hasRowHeaders()&&c.push(function(f,h){var d=f>=0?r.instance.rowIndexMapper.getVisualFromRenderableIndex(f):f;r.appendRowHeader(d,h)}),r.instance.runHooks("afterGetRowHeaderRenderers",c),zD(r,iC,c.length),c},columnHeaders:function(){var c=[];return r.instance.hasColHeaders()&&c.push(function(f,h){var d=f>=0?r.instance.columnIndexMapper.getVisualFromRenderableIndex(f):f;r.appendColHeader(d,h)}),r.instance.runHooks("afterGetColumnHeaderRenderers",c),zD(r,nC,c.length),c},columnWidth:function(c){var f=r.instance.columnIndexMapper.getVisualFromRenderableIndex(c);return r.instance.getColWidth(f===null?c:f)},rowHeight:function(c){var f=r.instance.rowIndexMapper.getVisualFromRenderableIndex(c);return r.instance.getRowHeight(f===null?c:f)},cellRenderer:function(c,f,h){var d=r.translateFromRenderableToVisualIndex(c,f),p=pm(d,2),m=p[0],g=p[1],v=r.instance.runHooks("modifyGetCellCoords",m,g),S=m,b=g;if(Array.isArray(v)){var E=pm(v,2);S=E[0],b=E[1]}var T=r.instance.getCellMeta(S,b),N=r.instance.colToProp(b),L=r.instance.getDataAtRowProp(S,N);r.instance.hasHook("beforeValueRender")&&(L=r.instance.runHooks("beforeValueRender",L,T)),r.instance.runHooks("beforeRenderer",h,m,g,N,L,T),r.instance.getCellRenderer(T)(r.instance,h,m,g,N,L,T),r.instance.runHooks("afterRenderer",h,m,g,N,L,T)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return r.settings.fragmentSelection},onWindowResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onContainerElementResize:function(){r.instance&&!r.instance.isDestroyed&&r.instance.refreshDimensions()},onCellMouseDown:function(c,f,h,d){var p=r.translateFromRenderableToVisualCoords(f),m={row:!1,column:!1,cell:!1};r.instance.listen(),r.activeWt=d,n.mouseDown=!0,r.instance.runHooks("beforeOnCellMouseDown",c,p,h,m),!Rf(c)&&(BD(c,{coords:p,selection:r.instance.selection,controller:m,cellCoordsFactory:function(v,S){return r.instance._createCellCoords(v,S)}}),r.instance.runHooks("afterOnCellMouseDown",c,p,h),r.activeWt=r._wt)},onCellContextMenu:function(c,f,h,d){var p=r.translateFromRenderableToVisualCoords(f);r.activeWt=d,n.mouseDown=!1,r.instance.selection.isInProgress()&&r.instance.selection.finish(),r.instance.runHooks("beforeOnCellContextMenu",c,p,h),!Rf(c)&&(r.instance.runHooks("afterOnCellContextMenu",c,p,h),r.activeWt=r._wt)},onCellMouseOut:function(c,f,h,d){var p=r.translateFromRenderableToVisualCoords(f);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOut",c,p,h),!Rf(c)&&(r.instance.runHooks("afterOnCellMouseOut",c,p,h),r.activeWt=r._wt)},onCellMouseOver:function(c,f,h,d){var p=r.translateFromRenderableToVisualCoords(f),m={row:!1,column:!1,cell:!1};r.activeWt=d,r.instance.runHooks("beforeOnCellMouseOver",c,p,h,m),!Rf(c)&&(n.mouseDown&&BD(c,{coords:p,selection:r.instance.selection,controller:m,cellCoordsFactory:function(v,S){return r.instance._createCellCoords(v,S)}}),r.instance.runHooks("afterOnCellMouseOver",c,p,h),r.activeWt=r._wt)},onCellMouseUp:function(c,f,h,d){var p=r.translateFromRenderableToVisualCoords(f);r.activeWt=d,r.instance.runHooks("beforeOnCellMouseUp",c,p,h),!(Rf(c)||r.instance.isDestroyed)&&(r.instance.runHooks("afterOnCellMouseUp",c,p,h),r.activeWt=r._wt)},onCellCornerMouseDown:function(c){c.preventDefault(),r.instance.runHooks("afterOnCellCornerMouseDown",c)},onCellCornerDblClick:function(c){c.preventDefault(),r.instance.runHooks("afterOnCellCornerDblClick",c)},beforeDraw:function(c,f){return r.beforeRender(c,f)},onDraw:function(c){return r.afterRender(c)},onScrollVertically:function(){return r.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return r.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return r.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(c,f,h){var d=r.instance.rowIndexMapper,p=d.getVisualFromRenderableIndex(c),m=r.instance.runHooks("beforeHighlightingRowHeader",p,f,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(m,1))},onBeforeHighlightingColumnHeader:function(c,f,h){var d=r.instance.columnIndexMapper,p=d.getVisualFromRenderableIndex(c),m=r.instance.runHooks("beforeHighlightingColumnHeader",p,f,h);return d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(m,1))},onAfterDrawSelection:function(c,f,h){var d,p=r.translateFromRenderableToVisualIndex(c,f),m=pm(p,2),g=m[0],v=m[1],S=r.instance.selection.getSelectedRange(),b=S.size();if(b>0){var E=(h!=null?h:0)+1-b,T=S.peekByIndex(E);d=[T.from.row,T.from.col,T.to.row,T.to.col]}return r.instance.runHooks("afterDrawSelection",g,v,d,h)},onBeforeDrawBorders:function(c,f){var h=pm(c,4),d=h[0],p=h[1],m=h[2],g=h[3],v=[r.instance.rowIndexMapper.getVisualFromRenderableIndex(d),r.instance.columnIndexMapper.getVisualFromRenderableIndex(p),r.instance.rowIndexMapper.getVisualFromRenderableIndex(m),r.instance.columnIndexMapper.getVisualFromRenderableIndex(g)];return r.instance.runHooks("beforeDrawBorders",v,f)},onBeforeTouchScroll:function(){return r.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return r.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(c,f){var h=r.instance.columnIndexMapper.getVisualFromRenderableIndex(f);return r.instance.runHooks("beforeStretchingColumnWidth",c,h)},onModifyRowHeaderWidth:function(c){return r.instance.runHooks("modifyRowHeaderWidth",c)},onModifyGetCellCoords:function(c,f,h){var d=r.instance.rowIndexMapper,p=r.instance.columnIndexMapper,m=f>=0?p.getVisualFromRenderableIndex(f):f,g=c>=0?d.getVisualFromRenderableIndex(c):c,v=r.instance.runHooks("modifyGetCellCoords",g,m,h);if(Array.isArray(v)){var S=pm(v,4),b=S[0],E=S[1],T=S[2],N=S[3];return[b>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(b,1)):b,E>=0?p.getRenderableFromVisualIndex(p.getNearestNotHiddenIndex(E,1)):E,T>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(T,-1)):T,N>=0?p.getRenderableFromVisualIndex(p.getNearestNotHiddenIndex(N,-1)):N]}},viewportRowCalculatorOverride:function(c){var f=r.settings.viewportRowRenderingOffset;if(f==="auto"&&r.settings.fixedRowsTop&&(f=10),f>0||f==="auto"){var h=r.countRenderableRows(),d=c.startRow,p=c.endRow;if(typeof f=="number")c.startRow=Math.max(d-f,0),c.endRow=Math.min(p+f,h-1);else if(f==="auto"){var m=Math.ceil(p/h*12);c.startRow=Math.max(d-m,0),c.endRow=Math.min(p+m,h-1)}}r.instance.runHooks("afterViewportRowCalculatorOverride",c)},viewportColumnCalculatorOverride:function(c){var f=r.settings.viewportColumnRenderingOffset;if(f==="auto"&&r.settings.fixedColumnsStart&&(f=10),f>0||f==="auto"){var h=r.countRenderableColumns(),d=c.startColumn,p=c.endColumn;if(typeof f=="number"&&(c.startColumn=Math.max(d-f,0),c.endColumn=Math.min(p+f,h-1)),f==="auto"){var m=Math.ceil(p/h*6);c.startColumn=Math.max(d-m,0),c.endColumn=Math.min(p+m,h-1)}}r.instance.runHooks("afterViewportColumnCalculatorOverride",c)},rowHeaderWidth:function(){return r.settings.rowHeaderWidth},columnHeaderHeight:function(){var c=r.instance.runHooks("modifyColumnHeaderHeight");return r.settings.columnHeaderHeight||c}};this.instance.runHooks("beforeInitWalkontable",i),this._wt=new d8e(i),this.activeWt=this._wt;var o=this._wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),s=a.width,l=a.height;this.setLastSize(s,l),this.eventManager.addEventListener(o,"mousedown",function(u){u.target===o&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(o,"contextmenu",function(u){u.target===o&&u.which===3&&u.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){r.settings.observeDOMVisibility&&r._wt.drawInterrupted&&(r.instance.forceFullRender=!0,r.render())})}},{key:"isTextSelectionAllowed",value:function(r){if(tw(r))return!0;var n=Hu(r,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Hl.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var r,n;return(r=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&r!==void 0?r:!1}},{key:"isCellEdited",value:function(){var r=this.instance.getActiveEditor();return r&&r.isOpened()}},{key:"beforeRender",value:function(r,n){r&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(r){r&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(r,n){if(n.firstChild){var i=n.firstChild;if(!at(i,"relative")){ua(n),this.appendRowHeader(r,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),r,this.instance.getRowHeader)}else{var o=this.instance,a=o.rootDocument,s=o.getRowHeader,l=a.createElement("div"),u=a.createElement("span");l.className="relative",u.className="rowHeader",this.updateCellHeader(u,r,s),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetRowHeader",r,n)}},{key:"appendColHeader",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){var a=n.firstChild;at(a,"relative")?this.updateCellHeader(a.querySelector(".colHeader"),r,i,o):(ua(n),this.appendColHeader(r,n,i,o))}else{var s=this.instance.rootDocument,l=s.createElement("div"),u=s.createElement("span");l.className="relative",u.className="colHeader",this.updateCellHeader(u,r,i,o),l.appendChild(u),n.appendChild(l)}this.instance.runHooks("afterGetColHeader",r,n,o)}},{key:"updateCellHeader",value:function(r,n,i){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=n,s=this._wt.wtOverlays.getParentOverlay(r)||this._wt;r.parentNode&&(at(r,"colHeader")?a=s.wtTable.columnFilter.sourceToRendered(n):at(r,"rowHeader")&&(a=s.wtTable.rowFilter.sourceToRendered(n))),a>-1?Hp(r,i(n,o)):(Gu(r,String.fromCharCode(160)),Re(r,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(r){var n=this._wt.wtViewport.getWorkspaceWidth(),i=n-r;return i>0?i:0}},{key:"maximumVisibleElementHeight",value:function(r){var n=this._wt.wtViewport.getWorkspaceHeight(),i=n-r;return i>0?i:0}},{key:"setLastSize",value:function(r,n){var i=Hl.get(this),o=[r,n];i.lastWidth=o[0],i.lastHeight=o[1]}},{key:"getLastSize",value:function(){var r=Hl.get(this);return{width:r.lastWidth,height:r.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return WD(this,nC)}},{key:"getRowHeadersCount",value:function(){return WD(this,iC)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),t}();const G$e=z$e;function zO(t){return zO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zO(t)}var Y$e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",GD=Y$e.length;function K$e(t){for(var e=t+1,r="",n;e>0;)n=(e-1)%GD,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/GD,10);return r}function YD(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t,n=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(r=[t]),r.forEach(function(i,o){Array.isArray(i)?i.forEach(function(a,s){n.push([o+e,s,a])}):Object.keys(i).forEach(function(a){n.push([o+e,a,i[a]])})}),n}function eQ(t){var e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&wt(t[0])&&(e=j8(t[0]))),e}function q$e(t){return!!(Array.isArray(t)&&t.length&&t.every(function(e){return Array.isArray(e)}))}function X$e(t){return!!(Array.isArray(t)&&t.length&&t.every(function(e){return zO(e)==="object"&&!Array.isArray(e)&&e!==null}))}function Iy(t){return Iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Iy(t)}function Q$e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function KD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,J$e(n.key),n)}}function Z$e(t,e,r){return e&&KD(t.prototype,e),r&&KD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function J$e(t){var e=eLe(t,"string");return Iy(e)==="symbol"?e:String(e)}function eLe(t,e){if(Iy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Iy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var tLe=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Q$e(this,t),this.hot=e,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return Z$e(t,[{key:"modifyRowData",value:function(r){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",r)),n!==void 0&&!Number.isInteger(n)?n:this.data[r]}},{key:"getData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,r)}},{key:"setData",value:function(r){this.data=r}},{key:"getAtColumn",value:function(r){var n=this,i=[];return Q(this.data,function(o,a){var s=n.getAtCell(a,r);i.push(s)}),i}},{key:"getAtRow",value:function(r,n,i){var o=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=n===void 0&&i===void 0,l=null,u=null;if(l=this.modifyRowData(r),Array.isArray(l))u=[],s?l.forEach(function(h,d){u[d]=o.getAtPhysicalCell(r,d,l)}):Ye(n,i,function(h){u[h-n]=o.getAtPhysicalCell(r,h,l)});else if(wt(l)||sr(l))if(a?u=[]:u={},!s||a){var c=0,f=this.countFirstRowKeys()-1;Ye(c,f,function(h){var d=o.colToProp(h);if(h>=(n||c)&&h<=(i||f)&&!Number.isInteger(d)){var p=o.getAtPhysicalCell(r,d,l);a?u.push(p):dE(u,d,p)}})}else St(l,function(h,d){dE(u,d,o.getAtPhysicalCell(r,d,l))});return u}},{key:"setAtCell",value:function(r,n,i){if(!(r>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var o=dh(i);this.hot.runHooks("modifySourceData",r,this.propToCol(n),o,"set"),o.isTouched()&&(i=o.value)}Number.isInteger(n)?this.data[r][n]=i:dE(this.data[r],n,i)}}},{key:"getAtPhysicalCell",value:function(r,n,i){var o=null;if(i&&(typeof n=="string"?o=c2e(i,n):typeof n=="function"?o=n(i):o=i[n]),this.hot.hasHook("modifySourceData")){var a=dh(o);this.hot.runHooks("modifySourceData",r,this.colToProp(n),a,"get"),a.isTouched()&&(o=a.value)}return o}},{key:"getAtCell",value:function(r,n){var i=this.modifyRowData(r);return this.getAtPhysicalCell(r,this.colToProp(n),i)}},{key:"getByRange",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,s=null,l=null,u=null,c=null;n===null||i===null?(a=!0,s=0,u=this.countRows()-1):(s=Math.min(n.row,i.row),l=Math.min(n.col,i.col),u=Math.max(n.row,i.row),c=Math.max(n.col,i.col));var f=[];return Ye(s,u,function(h){f.push(a?r.getAtRow(h,void 0,void 0,o):r.getAtRow(h,l,c,o))}),f}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var r=this.hot.runHooks("modifySourceLength");if(Number.isInteger(r))return r}return this.data.length}},{key:"countFirstRowKeys",value:function(){return eQ(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),t}();const rLe=tLe;var qD;function nLe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function iLe(t,e){return St(e,function(r,n){tr(t[n])&&(t[n]=r)}),t}function tQ(t){var e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=e.exec(t);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):t}function rQ(t){He(t)&&X8(Gt(qD||(qD=nLe(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),t))}function oLe(t,e){var r=Array.isArray(t)&&Number.isInteger(e);return r?t[e]:t}var nQ=lo("phraseFormatters"),aLe=nQ.register,sLe=nQ.getValues;function lLe(t,e){aLe(t,e)}function uLe(){return sLe()}lLe("pluralize",oLe);function My(t){return My=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},My(t)}var Pe;function $e(t,e,r){return e=cLe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cLe(t){var e=fLe(t,"string");return My(e)==="symbol"?e:String(e)}function fLe(t,e){if(My(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(My(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var hLe=(Pe={languageCode:"en-US"},$e(Pe,M3,"No available options"),$e(Pe,N3,"Insert row above"),$e(Pe,P3,"Insert row below"),$e(Pe,k3,"Insert column left"),$e(Pe,$3,"Insert column right"),$e(Pe,L3,["Remove row","Remove rows"]),$e(Pe,D3,["Remove column","Remove columns"]),$e(Pe,F3,"Undo"),$e(Pe,H3,"Redo"),$e(Pe,B3,"Read only"),$e(Pe,U3,"Clear column"),$e(Pe,tx,"Alignment"),$e(Pe,rx,"Left"),$e(Pe,nx,"Center"),$e(Pe,ix,"Right"),$e(Pe,ox,"Justify"),$e(Pe,ax,"Top"),$e(Pe,sx,"Middle"),$e(Pe,lx,"Bottom"),$e(Pe,Y3,"Freeze column"),$e(Pe,K3,"Unfreeze column"),$e(Pe,ux,"Borders"),$e(Pe,cx,"Top"),$e(Pe,fx,"Right"),$e(Pe,hx,"Bottom"),$e(Pe,dx,"Left"),$e(Pe,px,"Remove border(s)"),$e(Pe,Q3,"Add comment"),$e(Pe,Z3,"Edit comment"),$e(Pe,J3,"Delete comment"),$e(Pe,ex,"Read-only comment"),$e(Pe,q3,"Merge cells"),$e(Pe,X3,"Unmerge cells"),$e(Pe,V3,"Copy"),$e(Pe,j3,["Copy with header","Copy with headers"]),$e(Pe,W3,["Copy with group header","Copy with group headers"]),$e(Pe,z3,["Copy header only","Copy headers only"]),$e(Pe,G3,"Cut"),$e(Pe,mx,"Insert child row"),$e(Pe,gx,"Detach from parent"),$e(Pe,yx,["Hide column","Hide columns"]),$e(Pe,vx,["Show column","Show columns"]),$e(Pe,bx,["Hide row","Hide rows"]),$e(Pe,wx,["Show row","Show rows"]),$e(Pe,M6,"None"),$e(Pe,Sx,"Is empty"),$e(Pe,Rx,"Is not empty"),$e(Pe,Ex,"Is equal to"),$e(Pe,Cx,"Is not equal to"),$e(Pe,_x,"Begins with"),$e(Pe,Tx,"Ends with"),$e(Pe,Ox,"Contains"),$e(Pe,Ax,"Does not contain"),$e(Pe,xx,"Greater than"),$e(Pe,Ix,"Greater than or equal to"),$e(Pe,Mx,"Less than"),$e(Pe,Nx,"Less than or equal to"),$e(Pe,Px,"Is between"),$e(Pe,kx,"Is not between"),$e(Pe,$x,"After"),$e(Pe,Lx,"Before"),$e(Pe,Dx,"Today"),$e(Pe,Fx,"Tomorrow"),$e(Pe,Hx,"Yesterday"),$e(Pe,Dw,"Blank cells"),$e(Pe,Bx,"Filter by condition"),$e(Pe,Ux,"Filter by value"),$e(Pe,Vx,"And"),$e(Pe,N6,"Or"),$e(Pe,jx,"Select all"),$e(Pe,Wx,"Clear"),$e(Pe,zx,"OK"),$e(Pe,Gx,"Cancel"),$e(Pe,Yx,"Search"),$e(Pe,Kx,"Value"),$e(Pe,qx,"Second value"),Pe);const iQ=hLe;var GO=iQ.languageCode,U6=lo("languagesDictionaries"),dLe=U6.register,oQ=U6.getItem,pLe=U6.hasItem,mLe=U6.getValues;aQ(iQ);function aQ(t,e){var r=t,n=e;return wt(t)&&(n=t,r=n.languageCode),gLe(r,n),dLe(r,Zn(n)),Zn(n)}function gLe(t,e){t!==GO&&iLe(e,oQ(GO))}function sQ(t){return Jx(t)?Zn(oQ(t)):null}function Jx(t){return pLe(t)}function yLe(){return mLe()}function lQ(t,e,r){var n=sQ(t);if(n===null)return null;var i=n[e];if(tr(i))return null;var o=vLe(i,r);return Array.isArray(o)?o[0]:o}function vLe(t,e){var r=t;return Q(uLe(),function(n){r=n(t,e)}),r}function bLe(t){var e=tQ(t);return Jx(e)||(e=GO,rQ(t)),e}var V6="active-header",j6="area",Ny="cell",eI="fill",U1="header",tI="custom-selection";function md(t){return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},md(t)}function wLe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function XD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cQ(n.key),n)}}function SLe(t,e,r){return e&&XD(t.prototype,e),r&&XD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function a2(){return typeof Reflect<"u"&&Reflect.get?a2=Reflect.get.bind():a2=function(e,r,n){var i=RLe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},a2.apply(this,arguments)}function RLe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=gd(t),t!==null););return t}function ELe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&YO(t,e)}function YO(t,e){return YO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},YO(t,e)}function CLe(t){var e=TLe();return function(){var n=gd(t),i;if(e){var o=gd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _Le(this,i)}}function _Le(t,e){if(e&&(md(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uQ(t)}function uQ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function TLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gd(t){return gd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gd(t)}function OLe(t,e,r){return e=cQ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cQ(t){var e=ALe(t,"string");return md(e)==="symbol"?e:String(e)}function ALe(t,e){if(md(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xLe=function(t){ELe(r,t);var e=CLe(r);function r(n,i){var o;return wLe(this,r),o=e.call(this,n,null),OLe(uQ(o),"visualCellRange",null),o.visualCellRange=i||null,o.commit(),o}return SLe(r,[{key:"add",value:function(i){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(i):this.visualCellRange.expand(i),this}},{key:"clear",value:function(){return this.visualCellRange=null,a2(gd(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(i){var o=i.from,a=i.to,s=this.getNearestNotHiddenCoords(o,1),l=this.getNearestNotHiddenCoords(a,-1);if(s===null||l===null)return null;if(s.row>l.row||s.col>l.col){var u=this.settings.type==="header"||this.settings.type==="active-header";if(!u)return null;s=o,l=a}return this.settings.createCellRange(s,s,l)}},{key:"getNearestNotHiddenCoords",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o,s=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),i.row,o);if(s===null)return null;var l=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),i.col,a);return l===null?null:this.settings.createCellCoords(s,l)}},{key:"getNearestNotHiddenIndex",value:function(i,o,a){if(o<0)return o;var s=i.getNearestNotHiddenIndex(o,a),l=this.settings.type==="header"||this.settings.type==="active-header";return l&&s===null?-1:s}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var i=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return i===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(i.from,i.to),this}},{key:"syncWith",value:function(i){var o=i.getVerticalDirection()==="N-S"?1:-1,a=i.getHorizontalDirection()==="W-E"?1:-1,s=this.getNearestNotHiddenCoords(i.from.clone().normalize(),o,a);if(s!==null&&i.overlaps(s)){if(this.cellRange===null){var l=this.settings.visualToRenderableCoords(s);this.cellRange=this.settings.createCellRange(l)}return i.setHighlight(s),this}return i.setHighlight(i.from),this}},{key:"getCorners",value:function(){var i=this.cellRange,o=i.from,a=i.to,s=o.row===null||a.row===null,l=o.col===null||a.col===null,u=this.settings.createCellCoords(s?null:Math.min(o.row,a.row),l?null:Math.min(o.col,a.col)),c=this.settings.createCellCoords(s?null:Math.max(o.row,a.row),l?null:Math.max(o.col,a.col));return[u.row,u.col,c.row,c.col]}},{key:"getVisualCorners",value:function(){var i=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),o=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[i.row,i.col,o.row,o.col]}},{key:"createRenderableCellRange",value:function(i,o){var a=this.settings.visualToRenderableCoords(i),s=this.settings.visualToRenderableCoords(o);return this.settings.createCellRange(a,a,s)}}]),r}(j8e);const jp=xLe;function Py(t){return Py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Py(t)}var ILe=["activeHeaderClassName"];function QD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ZD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?QD(Object(r),!0).forEach(function(n){MLe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):QD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function MLe(t,e,r){return e=NLe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NLe(t){var e=PLe(t,"string");return Py(e)==="symbol"?e:String(e)}function PLe(t,e){if(Py(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Py(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kLe(t,e){if(t==null)return{};var r=$Le(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function $Le(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function LLe(t){var e=t.activeHeaderClassName,r=kLe(t,ILe),n=new jp(ZD(ZD({highlightHeaderClassName:e},r),{},{selectionType:V6}));return n}function ky(t){return ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ky(t)}var DLe=["layerLevel","areaCornerVisible"];function JD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function eF(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?JD(Object(r),!0).forEach(function(n){FLe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):JD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function FLe(t,e,r){return e=HLe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HLe(t){var e=BLe(t,"string");return ky(e)==="symbol"?e:String(e)}function BLe(t,e){if(ky(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ky(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ULe(t,e){if(t==null)return{};var r=VLe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function VLe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function jLe(t){var e=t.layerLevel,r=t.areaCornerVisible,n=ULe(t,DLe),i=new jp(eF(eF({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:j6}));return i}function $y(t){return $y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$y(t)}var WLe=["cellCornerVisible"];function tF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function rF(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tF(Object(r),!0).forEach(function(n){zLe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function zLe(t,e,r){return e=GLe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GLe(t){var e=YLe(t,"string");return $y(e)==="symbol"?e:String(e)}function YLe(t,e){if($y(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if($y(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KLe(t,e){if(t==null)return{};var r=qLe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function qLe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function XLe(t){var e=t.cellCornerVisible,r=KLe(t,WLe),n=new jp(rF(rF({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e}},r),{},{selectionType:Ny}));return n}function Ly(t){return Ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ly(t)}var QLe=["border","visualCellRange"];function nF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function oC(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nF(Object(r),!0).forEach(function(n){ZLe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ZLe(t,e,r){return e=JLe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JLe(t){var e=eDe(t,"string");return Ly(e)==="symbol"?e:String(e)}function eDe(t,e){if(Ly(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ly(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tDe(t,e){if(t==null)return{};var r=rDe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function rDe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function nDe(t){var e=t.border,r=t.visualCellRange,n=tDe(t,QLe),i=new jp(oC(oC(oC({},e),n),{},{selectionType:tI}),r);return i}function Dy(t){return Dy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dy(t)}function iF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function oF(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?iF(Object(r),!0).forEach(function(n){iDe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function iDe(t,e,r){return e=oDe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oDe(t){var e=aDe(t,"string");return Dy(e)==="symbol"?e:String(e)}function aDe(t,e){if(Dy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Dy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sDe(t){if(t==null)throw new TypeError("Cannot destructure "+t)}function lDe(t){var e=Object.assign({},(sDe(t),t)),r=new jp(oF(oF({className:"fill",border:{width:1,color:"#ff0000"}},e),{},{selectionType:eI}));return r}function Fy(t){return Fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fy(t)}var uDe=["headerClassName","rowClassName","columnClassName"];function aF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function sF(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?aF(Object(r),!0).forEach(function(n){cDe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):aF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function cDe(t,e,r){return e=fDe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fDe(t){var e=hDe(t,"string");return Fy(e)==="symbol"?e:String(e)}function hDe(t,e){if(Fy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Fy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dDe(t,e){if(t==null)return{};var r=pDe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function pDe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function mDe(t){var e=t.headerClassName,r=t.rowClassName,n=t.columnClassName,i=dDe(t,uDe),o=new jp(sF(sF({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:r,highlightColumnClassName:n},i),{},{highlightOnlyClosestHeader:!0,selectionType:U1}));return o}function Hy(t){return Hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hy(t)}function lF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function gDe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lF(Object(r),!0).forEach(function(n){yDe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function yDe(t,e,r){return e=vDe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vDe(t){var e=bDe(t,"string");return Hy(e)==="symbol"?e:String(e)}function bDe(t,e){if(Hy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Hy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fQ=lo("highlight/types"),Wp=fQ.register,wDe=fQ.getItem;Wp(V6,LLe);Wp(j6,jLe);Wp(Ny,XLe);Wp(tI,nDe);Wp(eI,lDe);Wp(U1,mDe);function qc(t,e){return wDe(t)(gDe({type:t},e))}function By(t){return By=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},By(t)}function Ps(t){return CDe(t)||EDe(t)||RDe(t)||SDe()}function SDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RDe(t,e){if(!!t){if(typeof t=="string")return KO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KO(t,e)}}function EDe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function CDe(t){if(Array.isArray(t))return KO(t)}function KO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function uF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function mm(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?uF(Object(r),!0).forEach(function(n){_De(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):uF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _De(t,e,r){return e=hQ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hQ(n.key),n)}}function ODe(t,e,r){return e&&cF(t.prototype,e),r&&cF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function hQ(t){var e=ADe(t,"string");return By(e)==="symbol"?e:String(e)}function ADe(t,e){if(By(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(By(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xDe=function(t){function e(r){TDe(this,e),this.options=r,this.layerLevel=0,this.cell=qc(Ny,r),this.fill=qc(eI,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return ODe(e,[{key:"isEnabledFor",value:function(n,i){var o=n;n===Ny&&(o="current");var a=this.options.disabledCellSelection(i.row,i.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(o)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,i;return this.areas.has(n)?i=this.areas.get(n):(i=qc(j6,mm({layerLevel:n},this.options)),this.areas.set(n,i)),i}},{key:"getAreas",value:function(){return Ps(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,i;return this.headers.has(n)?i=this.headers.get(n):(i=qc(U1,mm({},this.options)),this.headers.set(n,i)),i}},{key:"getHeaders",value:function(){return Ps(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,i;return this.activeHeaders.has(n)?i=this.activeHeaders.get(n):(i=qc(V6,mm({},this.options)),this.activeHeaders.set(n,i)),i}},{key:"getActiveHeaders",value:function(){return Ps(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Ps(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(qc(tI,mm(mm({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),Q(this.areas.values(),function(n){return void n.clear()}),Q(this.headers.values(),function(n){return void n.clear()}),Q(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:t,value:function(){return[this.cell,this.fill].concat(Ps(this.areas.values()),Ps(this.headers.values()),Ps(this.activeHeaders.values()),Ps(this.customSelections))[Symbol.iterator]()}}]),e}(Symbol.iterator);const IDe=xDe;function Uy(t){return Uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uy(t)}function MDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,PDe(n.key),n)}}function NDe(t,e,r){return e&&fF(t.prototype,e),r&&fF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function PDe(t){var e=kDe(t,"string");return Uy(e)==="symbol"?e:String(e)}function kDe(t,e){if(Uy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Uy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $De=function(t){function e(r){MDe(this,e),this.ranges=[],this.createCellRange=r}return NDe(e,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(this.createCellRange(n)),this}},{key:"add",value:function(n){return this.ranges.push(this.createCellRange(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(i){return i.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=this.size()+n-1,o;return i>=0&&(o=this.ranges[i]),o}},{key:t,value:function(){return this.ranges[Symbol.iterator]()}}]),e}(Symbol.iterator);const LDe=$De;function Vy(t){return Vy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vy(t)}function DDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,HDe(n.key),n)}}function FDe(t,e,r){return e&&hF(t.prototype,e),r&&hF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function HDe(t){var e=BDe(t,"string");return Vy(e)==="symbol"?e:String(e)}function BDe(t,e){if(Vy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Vy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var dQ=function(){function t(e,r){DDe(this,t),this.range=e,this.options=r}return FDe(t,[{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.options.createCellCoords(r,n),a=this.range.current().highlight,s=this.options.visualToRenderableCoords(a),l=s.row,u=s.col,c=a,f=0,h=0;if(this.runLocalHooks("beforeTransformStart",o),l!==null&&u!==null){var d=this.options.countRows(),p=this.options.countCols(),m=this.options.fixedRowsBottom(),g=this.options.minSpareRows(),v=this.options.minSpareCols(),S=this.options.autoWrapRow(),b=this.options.autoWrapCol();l+r>d-1?i&&g>0&&!(m&&l>=d-m-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):b&&(o.row=1-d,o.col=u+o.col===p-1?1-p:1):b&&l+o.row<0&&u+o.col>=0&&(o.row=d-1,o.col=u+o.col===0?p-1:-1),u+o.col>p-1?i&&v>0?(this.runLocalHooks("insertColRequire",p),p=this.options.countCols()):S&&(o.row=l+o.row===d-1?1-d:1,o.col=1-p):S&&u+o.col<0&&l+o.row>=0&&(o.row=l+o.row===0?d-1:-1,o.col=p-1);var E=this.options.createCellCoords(l+o.row,u+o.col);f=0,h=0,E.row<0?(f=-1,E.row=0):E.row>0&&E.row>=d&&(f=1,E.row=d-1),E.col<0?(h=-1,E.col=0):E.col>0&&E.col>=p&&(h=1,E.col=p-1),c=this.options.renderableToVisualCoords(E)}return this.runLocalHooks("afterTransformStart",c,f,h),c}},{key:"transformEnd",value:function(r,n){var i=this.options.createCellCoords(r,n),o=this.range.current(),a=o.to,s=0,l=0;this.runLocalHooks("beforeTransformEnd",i);var u=this.options.visualToRenderableCoords(o.highlight),c=u.row,f=u.col;if(c!==null&&f!==null){var h=this.options.countRows(),d=this.options.countCols(),p=this.options.visualToRenderableCoords(o.to),m=p.row,g=p.col,v=this.options.createCellCoords(m+i.row,g+i.col);s=0,l=0,v.row<0?(s=-1,v.row=0):v.row>0&&v.row>=h&&(s=1,v.row=h-1),v.col<0?(l=-1,v.col=0):v.col>0&&v.col>=d&&(l=1,v.col=d-1),a=this.options.renderableToVisualCoords(v)}return this.runLocalHooks("afterTransformEnd",a,s,l),a}}]),t}();ir(dQ,Si);const UDe=dQ;function jy(t){return jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jy(t)}var dF;function pF(t,e){return zDe(t)||WDe(t,e)||jDe(t,e)||VDe()}function VDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jDe(t,e){if(!!t){if(typeof t=="string")return mF(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mF(t,e)}}function mF(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function WDe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function zDe(t){if(Array.isArray(t))return t}function GDe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function YDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qDe(n.key),n)}}function KDe(t,e,r){return e&&gF(t.prototype,e),r&&gF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function qDe(t){var e=XDe(t,"string");return jy(e)==="symbol"?e:String(e)}function XDe(t,e){if(jy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(jy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var pQ=function(){function t(e,r){var n=this;YDe(this,t),this.settings=e,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new LDe(function(i,o,a){return n.tableProps.createCellRange(i,o,a)}),this.highlight=new IDe({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:function(o,a){return n.tableProps.isDisabledCellSelection(o,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,a){return n.tableProps.createCellCoords(o,a)},createCellRange:function(o,a,s){return n.tableProps.createCellRange(o,a,s)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new UDe(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,a){return n.tableProps.createCellCoords(o,a)},fixedRowsBottom:function(){return e.fixedRowsBottom},minSpareRows:function(){return e.minSpareRows},minSpareCols:function(){return e.minSpareCols},autoWrapRow:function(){return e.autoWrapRow},autoWrapCol:function(){return e.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(o))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(o))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(o))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(o))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(o))}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(o))})}return KDe(t,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.settings.selectionMode==="multiple",a=tr(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,s=r.row<0,l=r.col<0,u=s&&l,c=r.clone();this.selectedByCorner=u,this.runLocalHooks("beforeSetRangeStart".concat(i?"Only":""),c),(!o||o&&!a&&tr(n))&&this.selectedRange.clear(),this.selectedRange.add(c),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!u&&l&&this.selectedByRowHeader.add(this.getLayerLevel()),!u&&s&&this.selectedByColumnHeader.add(this.getLayerLevel()),i||this.setRangeEnd(r)}},{key:"setRangeStartOnly",value:function(r,n){this.setRangeStart(r,n,!0)}},{key:"setRangeEnd",value:function(r){if(!this.selectedRange.isEmpty()){var n=r.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var i=this.selectedRange.current();this.settings.selectionMode!=="single"&&i.setTo(this.tableProps.createCellCoords(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Ny,i.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(i);var o=this.getLayerLevel();o<this.highlight.layerLevel&&(Q(this.highlight.getAreas(),function(m){return void m.clear()}),Q(this.highlight.getHeaders(),function(m){return void m.clear()}),Q(this.highlight.getActiveHeaders(),function(m){return void m.clear()})),this.highlight.useLayerLevel(o);var a=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();if(a.clear(),s.clear(),l.clear(),this.highlight.isEnabledFor(j6,i.highlight)&&(this.isMultiple()||o>=1)&&(a.add(i.from).add(i.to).commit(),o===1)){var u=this.selectedRange.previous();this.highlight.useLayerLevel(o-1).createOrGetArea().add(u.from).commit().syncWith(u),this.highlight.useLayerLevel(o)}if(this.highlight.isEnabledFor(U1,i.highlight)){var c=this.tableProps.countRowsTranslated()===0,f=this.tableProps.countColsTranslated()===0,h=i;if((c||f)&&(h=i.clone()),c&&(h.from.row=-1),f&&(h.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&h.from.normalize(),s.add(h.from).commit()):s.add(h.from).add(h.to).commit(),this.isEntireRowSelected()){var d=this.tableProps.countCols()===i.getWidth();d&&l.add(this.tableProps.createCellCoords(i.from.row,-1)).add(this.tableProps.createCellCoords(i.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var p=this.tableProps.countRows()===i.getHeight();p&&l.add(this.tableProps.createCellCoords(-1,i.from.col)).add(this.tableProps.createCellCoords(-1,i.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",r)}}},{key:"isMultiple",value:function(){var r=dh(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}},{key:"transformStart",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(r,n,i))}},{key:"transformEnd",value:function(r,n){this.setRangeEnd(this.transformation.transformEnd(r,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(r)&&this.isEntireRowSelected(r)}},{key:"isEntireRowSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(r)}},{key:"isSelectedByColumnHeader",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(r)}},{key:"isEntireColumnSelected",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return r===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(r)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(r){return this.selectedRange.includes(r)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(r){return Number.isInteger(r)&&r!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){!this.isSelected()||(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.tableProps.countRows(),o=this.tableProps.countCols();if(!(!r&&!n&&(i===0||o===0))){var a=this.tableProps.createCellCoords(n?-1:0,r?-1:0),s=this.tableProps.createCellCoords(i-1,o-1);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(s),this.finish()}}},{key:"selectCells",value:function(r){var n=this,i=pd(r);if(i===L6)return!1;if(i===$6)throw new Error(Gt(dF||(dF=GDe([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var o=Ey(i,{propToCol:function(c){return n.tableProps.propToCol(c)},keepDirection:!0}),a=this.tableProps.countRows(),s=this.tableProps.countCols(),l=!r.some(function(u){var c=o(u),f=pF(c,4),h=f[0],d=f[1],p=f[2],m=f[3],g=Ms(h,a)&&Ms(d,s)&&Ms(p,a)&&Ms(m,s);return!g});return l&&(this.clear(),Q(r,function(u){var c=o(u),f=pF(c,4),h=f[0],d=f[1],p=f[2],m=f[3];n.setRangeStartOnly(n.tableProps.createCellCoords(h,d),!1),n.setRangeEnd(n.tableProps.createCellCoords(p,m)),n.finish()})),l}},{key:"selectColumns",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=typeof r=="string"?this.tableProps.propToCol(r):r,a=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countCols(),l=this.tableProps.countRows(),u=Ms(o,s)&&Ms(a,s);return u&&(this.setRangeStartOnly(this.tableProps.createCellCoords(i,o)),this.setRangeEnd(this.tableProps.createCellCoords(l-1,a)),this.finish()),u}},{key:"selectRows",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=this.tableProps.countRows(),a=this.tableProps.countCols(),s=Ms(r,o)&&Ms(n,o);return s&&(this.setRangeStartOnly(this.tableProps.createCellCoords(r,i)),this.setRangeEnd(this.tableProps.createCellCoords(n,a-1)),this.finish()),s}},{key:"refresh",value:function(){var r=this.highlight.getCustomSelections();if(r.forEach(function(u){u.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),i=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(var o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);var a=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();a.commit(),s.commit(),l.commit()}this.highlight.useLayerLevel(i)}}}]),t}();ir(pQ,Si);const QDe=pQ;var ZDe=tt,mQ=b1,JDe=ya.f,eFe=bc,yF=Gr,tFe=B8,rFe=bi,nFe=U8,vF=mQ("".startsWith),iFe=mQ("".slice),oFe=Math.min,gQ=nFe("startsWith"),aFe=!gQ&&!!function(){var t=JDe(String.prototype,"startsWith");return t&&!t.writable}();ZDe({target:"String",proto:!0,forced:!aFe&&!gQ},{startsWith:function(e){var r=yF(rFe(this));tFe(e);var n=eFe(oFe(arguments.length>1?arguments[1]:void 0,r.length)),i=yF(e);return vF?vF(r,i,n):iFe(r,n,n+i.length)===i}});var bF=/^(\r\n|\n\r|\r|\n)/,sFe=/^[^\t\r\n]+/,wF=/^\t/;function lFe(t){var e=[[""]];if(t.length===0)return e;for(var r=0,n=0,i;t.length>0&&i!==t.length;)if(i=t.length,t.match(wF))t=t.replace(wF,""),r+=1,e[n][r]="";else if(t.match(bF))t=t.replace(bF,""),r=0,n+=1,e[n]=[""];else{var o="";if(t.startsWith('"')){for(var a=0,s=!0;s;){var l=t.slice(0,1);l==='"'&&(a+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&a%2===0)&&(s=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(c){return new Array(Math.floor(c.length/2)).fill('"').join("")})}else{var u=t.match(sFe);o=u?u[0]:"",t=t.slice(o.length)}e[n][r]=o}return e}function ag(t){var e,r,n,i,o="",a;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(o+="	"),a=t[e][n],typeof a=="string"?a.indexOf(`
`)>-1?o+='"'.concat(a.replace(/"/g,'""'),'"'):o+=a:a==null?o+="":o+=a;e!==r-1&&(o+=`
`)}return o}function aC(t){return hFe(t)||fFe(t)||cFe(t)||uFe()}function uFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cFe(t,e){if(!!t){if(typeof t=="string")return qO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qO(t,e)}}function fFe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function hFe(t){if(Array.isArray(t))return qO(t)}function qO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function yd(t){return yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yd(t)}function dFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function SF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mFe(n.key),n)}}function pFe(t,e,r){return e&&SF(t.prototype,e),r&&SF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mFe(t){var e=gFe(t,"string");return yd(e)==="symbol"?e:String(e)}function gFe(t,e){if(yd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yFe=function(){function t(e,r,n){dFe(this,t),this.instance=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return pFe(t,[{key:"createMap",value:function(){var r=this.getSchema();if(typeof r>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,i;if(this.colToPropCache=[],this.propToColCache=new Map,n){var o=0,a=0,s=!1;if(typeof n=="function"){var l=j8(r);o=l>0?l:this.countFirstRowKeys(),s=!0}else{var u=this.tableMeta.maxCols;o=Math.min(u,n.length)}for(i=0;i<o;i++){var c=s?n(i):n[i];if(wt(c)){if(typeof c.data<"u"){var f=s?a:i;this.colToPropCache[f]=c.data,this.propToColCache.set(c.data,f)}a+=1}}}else this.recursiveDuckColumns(r)}},{key:"countFirstRowKeys",value:function(){return eQ(this.dataSource)}},{key:"recursiveDuckColumns",value:function(r,n,i){var o=this,a=n,s=i,l;return typeof a>"u"&&(a=0,s=""),yd(r)==="object"&&!Array.isArray(r)&&St(r,function(u,c){u===null?(l=s+c,o.colToPropCache.push(l),o.propToColCache.set(l,a),a+=1):a=o.recursiveDuckColumns(u,a,"".concat(c,"."))}),a}},{key:"colToProp",value:function(r){if(Number.isInteger(r)===!1)return r;var n=this.instance.toPhysicalColumn(r);return n===null?r:this.colToPropCache&&He(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(r){var n=this.propToColCache.get(r);if(He(n))return this.instance.toVisualColumn(n);var i=this.instance.toVisualColumn(r);return i===null?r:i}},{key:"getSchema",value:function(){var r=this.tableMeta.dataSchema;return r?typeof r=="function"?r():r:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?xg(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=o.source,s=o.mode,l=s===void 0?"above":s,u=this.instance.countSourceRows(),c=u,f=0,h=r;(typeof h!="number"||h>=u)&&(h=u),h<this.instance.countRows()&&(c=this.instance.toPhysicalRow(h));var d=this.instance.runHooks("beforeCreateRow",h,i,a);if(d===!1||c===null)return{delta:0};for(var p=this.tableMeta.maxRows,m=this.getSchema().length,g=[],v=function(){var E=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?E=Zn(n.getSchema()):(E=[],Ye(m-1,function(){return E.push(null)})):n.instance.dataType==="function"?E=n.tableMeta.dataSchema(h+f):(E={},R6(E,n.getSchema())),g.push(E),f+=1};f<i&&u+f<p;)v();this.instance.rowIndexMapper.insertIndexes(h,f),l==="below"&&(c=Math.min(c+1,u)),this.spliceData(c,0,g);var S=this.instance.toVisualRow(c);return this.instance.countSourceRows()===g.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),f>0&&(r==null?this.metaManager.createRow(null,f):a!=="auto"&&this.metaManager.createRow(c,i)),this.instance.runHooks("afterCreateRow",S,f,a),this.instance.forceFullRender=!0,{delta:f,startPhysicalIndex:c}}},{key:"createCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.source,a=i.mode,s=a===void 0?"start":a;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var l=this.dataSource,u=this.tableMeta.maxCols,c=this.instance.countSourceCols(),f=r;(typeof f!="number"||f>=c)&&(f=c);var h=this.instance.runHooks("beforeCreateCol",f,n,o);if(h===!1)return{delta:0};var d=c;f<this.instance.countCols()&&(d=this.instance.toPhysicalColumn(f));var p=this.instance.countSourceRows(),m=this.instance.countCols(),g=0,v=d;s==="end"&&(v=Math.min(v+1,c));for(var S=v;g<n&&m<u;){if(typeof f!="number"||f>=m)if(p>0)for(var b=0;b<p;b+=1)typeof l[b]>"u"&&(l[b]=[]),l[b].push(null);else l.push([null]);else for(var E=0;E<p;E++)l[E].splice(v,0,null);g+=1,v+=1,m+=1}this.instance.columnIndexMapper.insertIndexes(f,g),g>0&&(r==null?this.metaManager.createColumn(null,g):o!=="auto"&&this.metaManager.createColumn(S,n));var T=this.instance.toVisualColumn(S);return this.instance.runHooks("afterCreateCol",T,g,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:S}}},{key:"removeRow",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,a=Number.isInteger(r)?r:-i,s=this.visualRowsToPhysical(a,i),l=this.instance.countSourceRows();a=(l+a)%l;var u=this.instance.runHooks("beforeRemoveRow",a,s.length,s,o);if(u===!1)return!1;var c=s.length;if(this.filterData(a,c,s),a<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(s);var f=He(this.tableMeta.columns)||He(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&f===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var h=s.slice(0).sort(function(d,p){return p-d});return h.forEach(function(d){n.metaManager.removeRow(d,1)}),this.instance.runHooks("afterRemoveRow",a,c,s,o),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var o=typeof r!="number"?-n:r;o=(this.instance.countCols()+o)%this.instance.countCols();var a=this.visualColumnsToPhysical(o,n),s=a.slice(0).sort(function(S,b){return b-S}),l=this.instance.runHooks("beforeRemoveCol",o,n,a,i);if(l===!1)return!1;for(var u=!0,c=s.length,f=this.dataSource,h=0;h<c;h++)u&&a[0]!==a[h]-h&&(u=!1);if(u)for(var d=0,p=this.instance.countSourceRows();d<p;d++)f[d].splice(a[0],n),d===0&&this.metaManager.removeColumn(a[0],n);else for(var m=0,g=this.instance.countSourceRows();m<g;m++)for(var v=0;v<c;v++)f[m].splice(s[v],1),m===0&&this.metaManager.removeColumn(s[v],1);return o<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",o,n,a,i),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(r,n,i){for(var o=this.instance.getDataAtCol(r),a=o.slice(n,n+i),s=o.slice(n+i),l=arguments.length,u=new Array(l>3?l-3:0),c=3;c<l;c++)u[c-3]=arguments[c];PP(u,s);for(var f=0;f<i;)u.push(null),f+=1;return Wbe(u),this.instance.populateFromArray(n,r,u,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(r,n,i){for(var o=this.instance.getSourceDataAtRow(r),a=o.slice(n,n+i),s=o.slice(n+i),l=arguments.length,u=new Array(l>3?l-3:0),c=3;c<l;c++)u[c-3]=arguments[c];PP(u,s);for(var f=0;f<i;)u.push(null),f+=1;return this.instance.populateFromArray(r,n,[u],null,null,"spliceRow"),a}},{key:"spliceData",value:function(r,n,i){var o=this,a=this.instance.runHooks("beforeDataSplice",r,n,i);if(a!==!1){var s=[].concat(aC(this.dataSource.slice(0,r)),aC(i),aC(this.dataSource.slice(r)));this.dataSource.length=0,s.forEach(function(l){return o.dataSource.push(l)})}}},{key:"filterData",value:function(r,n,i){var o=this.instance.runHooks("filterData",r,n,i);Array.isArray(o)===!1&&(o=this.dataSource.filter(function(a,s){return i.indexOf(s)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}},{key:"get",value:function(r,n){var i=this.instance.toPhysicalRow(r),o=this.dataSource[i],a=this.instance.runHooks("modifyRowData",i);o=isNaN(a)?a:o;var s=null;if(o&&o.hasOwnProperty&&Nr(o,n))s=o[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var l=n.split("."),u=o;if(!u)return null;for(var c=0,f=l.length;c<f;c++)if(u=u[l[c]],typeof u>"u")return null;s=u}else typeof n=="function"&&(s=n(this.dataSource.slice(i,i+1)[0]));if(this.instance.hasHook("modifyData")){var h=dh(s);this.instance.runHooks("modifyData",i,this.propToCol(n),h,"get"),h.isTouched()&&(s=h.value)}return s}},{key:"getCopyable",value:function(r,n){return this.instance.getCellMeta(r,this.propToCol(n)).copyable?this.get(r,n):""}},{key:"set",value:function(r,n,i){var o=this.instance.toPhysicalRow(r),a=i,s=this.dataSource[o],l=this.instance.runHooks("modifyRowData",o);if(s=isNaN(l)?l:s,this.instance.hasHook("modifyData")){var u=dh(a);this.instance.runHooks("modifyData",o,this.propToCol(n),u,"set"),u.isTouched()&&(a=u.value)}if(s&&s.hasOwnProperty&&Nr(s,n))s[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var c=n.split("."),f=s,h=0,d;for(h=0,d=c.length-1;h<d;h++)typeof f[c[h]]>"u"&&(f[c[h]]={}),f=f[c[h]];f[c[h]]=a}else typeof n=="function"?n(this.dataSource.slice(o,o+1)[0],a):s[n]=a}},{key:"visualRowsToPhysical",value:function(r,n){for(var i=this.instance.countSourceRows(),o=[],a=(i+r)%i,s=n,l;a<i&&s;)l=this.instance.toPhysicalRow(a),o.push(l),s-=1,a+=1;return o}},{key:"visualColumnsToPhysical",value:function(r,n){for(var i=this.instance.countCols(),o=[],a=(i+r)%i,s=n;a<i&&s;){var l=this.instance.toPhysicalColumn(a);o.push(l),s-=1,a+=1}return o}},{key:"clear",value:function(){for(var r=0;r<this.instance.countSourceRows();r++)for(var n=0;n<this.instance.countCols();n++)this.set(r,this.colToProp(n),"")}},{key:"getLength",value:function(){var r=this.tableMeta.maxRows,n;r<0||r===0?n=0:n=r||1/0;var i=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}},{key:"getAll",value:function(){var r={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return r.row-n.row===0&&!this.instance.countSourceRows()?[]:this.getRange(r,n,t.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(r,n,i){var o=[],a,s,l,u=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(u===0||c===0)return[];var f=i===t.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(u-1,0),Math.max(r.row,n.row)),d=Math.min(Math.max(c-1,0),Math.max(r.col,n.col));for(a=Math.min(r.row,n.row);a<=h;a++){l=[];var p=a>=0?this.instance.toPhysicalRow(a):a;for(s=Math.min(r.col,n.col);s<=d&&p!==null;s++)l.push(f.call(this,a,this.colToProp(s)));p!==null&&o.push(l)}return o}},{key:"getText",value:function(r,n){return ag(this.getRange(r,n,t.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(r,n){return ag(this.getRange(r,n,t.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),t}();const vFe=yFe;function bFe(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!Nr(e,t)}function W6(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,n=typeof e.type=="string"?YEe(e.type):e.type;if(t._automaticallyAssignedMetaProps&&St(e,function(o,a){return void t._automaticallyAssignedMetaProps.delete(a)}),!!wt(n)){r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);var i={};St(n,function(o,a){if(bFe(a,r)){var s;i[a]=o,(s=t._automaticallyAssignedMetaProps)===null||s===void 0||s.add(a)}}),Jr(t,i)}}function wFe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Rl(r,t);for(var n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function s2(t){return Number.isInteger(t)&&t>=0}function l2(t,e){if(!t())throw new Error("Assertion failed: ".concat(e))}function H0(t){return t==null}function XO(t){return XO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},XO(t)}const yQ=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(e){var r,n,i;for(r=0,n=this.countRows();r<n;r++)if(i=this.getDataAtCell(r,e),an(i)===!1)return!1;return!0},isEmptyRow:function(e){var r,n,i,o;for(r=0,n=this.countCols();r<n;r++)if(i=this.getDataAtCell(e,r),an(i)===!1)return XO(i)==="object"?(o=this.getCellMeta(e,r),SK(this.getSchema()[o.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function Wy(t){return Wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wy(t)}function RF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function EF(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?RF(Object(r),!0).forEach(function(n){SFe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):RF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function SFe(t,e,r){return e=bQ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bQ(n.key),n)}}function vQ(t,e,r){return e&&CF(t.prototype,e),r&&CF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function bQ(t){var e=RFe(t,"string");return Wy(e)==="symbol"?e:String(e)}function RFe(t,e){if(Wy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Wy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wQ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function EFe(){return vQ(function t(){wQ(this,t)})}var CFe=function(){function t(e){wQ(this,t),this.metaCtor=EFe(),this.meta=this.metaCtor.prototype,Jr(this.meta,yQ()),this.meta.instance=e}return vQ(t,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){var n;Jr(this.meta,r),W6(this.meta,EF(EF({},r),{},{type:(n=r.type)!==null&&n!==void 0?n:this.meta.type}),r)}}]),t}();function zy(t){return zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zy(t)}function _Fe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _F(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,OFe(n.key),n)}}function TFe(t,e,r){return e&&_F(t.prototype,e),r&&_F(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function OFe(t){var e=AFe(t,"string");return zy(e)==="symbol"?e:String(e)}function AFe(t,e){if(zy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(zy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xFe=function(){function t(e){_Fe(this,t);var r=e.getMetaConstructor();this.meta=new r}return TFe(t,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(r){Jr(this.meta,r),W6(this.meta,r,r)}}]),t}();function Gy(t){return Gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gy(t)}function TF(t){return PFe(t)||NFe(t)||MFe(t)||IFe()}function IFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MFe(t,e){if(!!t){if(typeof t=="string")return QO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QO(t,e)}}function NFe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function PFe(t){if(Array.isArray(t))return QO(t)}function QO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function kFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,LFe(n.key),n)}}function $Fe(t,e,r){return e&&OF(t.prototype,e),r&&OF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function LFe(t){var e=DFe(t,"string");return Gy(e)==="symbol"?e:String(e)}function DFe(t,e){if(Gy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Gy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ZO=function(t){function e(r){kFe(this,e),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return $Fe(e,[{key:"obtain",value:function(n){l2(function(){return s2(n)},"Expecting an unsigned number.");var i=this._getStorageIndexByKey(n),o;if(i>=0)o=this.data[i],o===void 0&&(o=this.valueFactory(n),this.data[i]=o);else if(o=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=o,this.index[n]=a}else this.data.push(o),this.index[n]=this.data.length-1;return o}},{key:"insert",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;l2(function(){return s2(n)||H0(n)},"Expecting an unsigned number or null/undefined argument.");for(var o=[],a=this.data.length,s=0;s<i;s++)o.push(a+s),this.data.push(void 0);var l=H0(n)?this.index.length:n;this.index=[].concat(TF(this.index.slice(0,l)),o,TF(this.index.slice(l)))}},{key:"remove",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;l2(function(){return s2(n)||H0(n)},"Expecting an unsigned number or null/undefined argument.");for(var o=this.index.splice(H0(n)?this.index.length-i:n,i),a=0;a<o.length;a++){var s=o[a];typeof s=="number"&&this.holes.add(s)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return eo(this.data,function(i,o){return!n.holes.has(o)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],i=0;i<this.data.length;i++){var o=this._getKeyByStorageIndex(i);o!==-1&&n.push([o,this.data[i]])}var a=0;return{next:function(){if(a<n.length){var l=n[a];return a+=1,{value:l,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:t,value:function(){return this.entries()}}]),e}(Symbol.iterator);function Yy(t){return Yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yy(t)}function FFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,BFe(n.key),n)}}function HFe(t,e,r){return e&&AF(t.prototype,e),r&&AF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function BFe(t){var e=UFe(t,"string");return Yy(e)==="symbol"?e:String(e)}function UFe(t,e){if(Yy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Yy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var VFe=["data","width"],jFe=function(){function t(e){var r=this;FFe(this,t),this.globalMeta=e,this.metas=new ZO(function(){return r._createMeta()})}return HFe(t,[{key:"updateMeta",value:function(r,n){var i=this.getMeta(r);Jr(i,n),W6(i,n)}},{key:"createColumn",value:function(r,n){this.metas.insert(r,n)}},{key:"removeColumn",value:function(r,n){this.metas.remove(r,n)}},{key:"getMeta",value:function(r){return this.metas.obtain(r)}},{key:"getMetaConstructor",value:function(r){return this.metas.obtain(r).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return wFe(this.globalMeta.getMetaConstructor(),VFe).prototype}}]),t}();function Ky(t){return Ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ky(t)}function WFe(t){return KFe(t)||YFe(t)||GFe(t)||zFe()}function zFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GFe(t,e){if(!!t){if(typeof t=="string")return JO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JO(t,e)}}function YFe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function KFe(t){if(Array.isArray(t))return JO(t)}function JO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function qFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,QFe(n.key),n)}}function XFe(t,e,r){return e&&xF(t.prototype,e),r&&xF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function QFe(t){var e=ZFe(t,"string");return Ky(e)==="symbol"?e:String(e)}function ZFe(t,e){if(Ky(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ky(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var JFe=function(){function t(e){var r=this;qFe(this,t),this.columnMeta=e,this.metas=new ZO(function(){return r._createRow()})}return XFe(t,[{key:"updateMeta",value:function(r,n,i){var o=this.getMeta(r,n);Jr(o,i),W6(o,i)}},{key:"createRow",value:function(r,n){this.metas.insert(r,n)}},{key:"createColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(r,n)}},{key:"removeRow",value:function(r,n){this.metas.remove(r,n)}},{key:"removeColumn",value:function(r,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(r,n)}},{key:"getMeta",value:function(r,n,i){var o=this.metas.obtain(r).obtain(n);return i===void 0?o:o[i]}},{key:"setMeta",value:function(r,n,i,o){var a,s=this.metas.obtain(r).obtain(n);(a=s._automaticallyAssignedMetaProps)===null||a===void 0||a.delete(i),s[i]=o}},{key:"removeMeta",value:function(r,n,i){var o=this.metas.obtain(r).obtain(n);delete o[i]}},{key:"getMetas",value:function(){for(var r=[],n=Array.from(this.metas.values()),i=0;i<n.length;i++)r.push.apply(r,WFe(n[i].values()));return r}},{key:"getMetasAtRow",value:function(r){l2(function(){return s2(r)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(r)?Array.from(n.get(r).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var r=this;return new ZO(function(n){return r._createMeta(n)})}},{key:"_createMeta",value:function(r){var n=this.columnMeta.getMetaConstructor(r);return new n}}]),t}();function qy(t){return qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qy(t)}function eHe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function IF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rHe(n.key),n)}}function tHe(t,e,r){return e&&IF(t.prototype,e),r&&IF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function rHe(t){var e=nHe(t,"string");return qy(e)==="symbol"?e:String(e)}function nHe(t,e){if(qy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(qy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var SQ=function(){function t(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];eHe(this,t),this.hot=e,this.globalMeta=new CFe(e),this.tableMeta=new xFe(this.globalMeta),this.columnMeta=new jFe(this.globalMeta),this.cellMeta=new JFe(this.columnMeta),i.forEach(function(o){return new o(r)}),this.globalMeta.updateMeta(n)}return tHe(t,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(r){this.globalMeta.updateMeta(r)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(r){this.tableMeta.updateMeta(r)}},{key:"getColumnMeta",value:function(r){return this.columnMeta.getMeta(r)}},{key:"updateColumnMeta",value:function(r,n){this.columnMeta.updateMeta(r,n)}},{key:"getCellMeta",value:function(r,n,i){var o=i.visualRow,a=i.visualColumn,s=this.cellMeta.getMeta(r,n);return s.visualRow=o,s.visualCol=a,s.row=r,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}},{key:"getCellMetaKeyValue",value:function(r,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(r,n,i)}},{key:"setCellMeta",value:function(r,n,i,o){this.cellMeta.setMeta(r,n,i,o)}},{key:"updateCellMeta",value:function(r,n,i){this.cellMeta.updateMeta(r,n,i)}},{key:"removeCellMeta",value:function(r,n,i){this.cellMeta.removeMeta(r,n,i)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(r){return this.cellMeta.getMetasAtRow(r)}},{key:"createRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(r,n)}},{key:"removeRow",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(r,n)}},{key:"createColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(r,n),this.columnMeta.createColumn(r,n)}},{key:"removeColumn",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(r,n),this.columnMeta.removeColumn(r,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),t}();ir(SQ,Si);function Fw(t){return Fw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fw(t)}function MF(t,e,r,n){var i=n.hotInstance,o=n.dataMap,a=n.dataSource,s=n.internalSource,l=n.source,u=n.metaManager,c=n.firstRun,f=gs(s),h=i.getSettings();Array.isArray(h.dataSchema)?i.dataType="array":sr(h.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks("before".concat(f),t,c,l);var d=new vFe(i,t,u);if(e(d),Fw(t)==="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){var p=d.getSchema();t=[];var m,g=0,v=0;for(g=0,v=h.startRows;g<v;g++)if((i.dataType==="object"||i.dataType==="function")&&h.dataSchema)m=Zn(p),t.push(m);else if(i.dataType==="array")m=Zn(p[0]),t.push(m);else{m=[];for(var S=0,b=h.startCols;S<b;S++)m.push(null);t.push(m)}}else throw new Error("".concat(s," only accepts array of objects or array of arrays (").concat(Fw(t)," given)"));Array.isArray(t[0])&&(i.dataType="array"),h.data=t,d.dataSource=t,a.data=t,a.dataType=i.dataType,a.colToProp=d.colToProp.bind(d),a.propToCol=d.propToCol.bind(d),a.countCachedColumns=d.countCachedColumns.bind(d),r(d),i.runHooks("after".concat(f),t,c,l),c||(i.runHooks("afterChange",null,s),i.render())}function Xy(t){return Xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xy(t)}function iHe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function NF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aHe(n.key),n)}}function oHe(t,e,r){return e&&NF(t.prototype,e),r&&NF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function aHe(t){var e=sHe(t,"string");return Xy(e)==="symbol"?e:String(e)}function sHe(t,e){if(Xy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Xy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lHe=function(){function t(e){var r=this;iHe(this,t),this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),Ue.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return oHe(t,[{key:"extendCellMeta",value:function(r){var n,i=r.row,o=r.col;if(!((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(o))){var a=r.visualRow,s=r.visualCol,l=this.metaManager.hot,u=l.colToProp(s);r.prop=u,l.runHooks("beforeGetCellMeta",a,s,r);var c=Nr(r,"type")?r.type:null,f=sr(r.cells)?r.cells(i,o,u):null;if(c)if(f){var h;f.type=(h=f.type)!==null&&h!==void 0?h:c}else f={type:c};f&&this.metaManager.updateCellMeta(i,o,f),l.runHooks("afterGetCellMeta",a,s,r),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(o)}}}]),t}();function Qy(t){return Qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qy(t)}function uHe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fHe(n.key),n)}}function cHe(t,e,r){return e&&PF(t.prototype,e),r&&PF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function fHe(t){var e=hHe(t,"string");return Qy(e)==="symbol"?e:String(e)}function hHe(t,e){if(Qy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Qy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var dHe=function(){function t(e){uHe(this,t),this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(n){var i=this.metaManager.hot.isRtl();if(i&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(n,i,o){if(!o)throw new Error("The `".concat(n,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return cHe(t,[{key:"extendMetaProps",value:function(){var r=this;this.propDescriptors.forEach(function(n,i){var o=n.target,a=n.onChange,s=a===void 0?function(){}:a,l=typeof o=="string",u=l?o:i,c="_".concat(u);r.metaManager.globalMeta.meta[c]=r.metaManager.globalMeta.meta[u],r.installPropWatcher(i,c,s),l&&r.installPropWatcher(o,c,s)})}},{key:"installPropWatcher",value:function(r,n,i){var o=this;Object.defineProperty(this.metaManager.globalMeta.meta,r,{get:function(){return this[n]},set:function(s){var l=!o.usageTracker.has(r);o.usageTracker.add(r),i.call(o,r,s,l),this[n]=s},enumerable:!0,configurable:!0})}}]),t}(),kF=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),B0=function(e){return e.map(function(r){var n=r.toLowerCase();return kF.has(n)?kF.get(n):n}).sort().join("+")},pHe=function(e){return e.split("+")},$F=function(e){return e.toLowerCase()},LF;function mHe(t){return vHe(t)||yHe(t)||RQ(t)||gHe()}function gHe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yHe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function vHe(t){if(Array.isArray(t))return e7(t)}function bHe(t,e){return RHe(t)||SHe(t,e)||RQ(t,e)||wHe()}function wHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RQ(t,e){if(!!t){if(typeof t=="string")return e7(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e7(t,e)}}function e7(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function SHe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function RHe(t){if(Array.isArray(t))return t}function EHe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var CHe=function(e){var r=O6({errorIdExists:function(c){return'The "'.concat(c,'" shortcut is already registered in the "').concat(e,'" context.')}}),n=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=c.keys,h=c.callback,d=c.group,p=c.runOnlyIf,m=p===void 0?function(){return!0}:p,g=c.captureCtrl,v=g===void 0?!1:g,S=c.preventDefault,b=S===void 0?!0:S,E=c.stopPropagation,T=E===void 0?!1:E,N=c.relativeToGroup,L=c.position;if(tr(d))throw new Error("You need to define the shortcut's group.");if(sr(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(f)===!1)throw new Error(Gt(LF||(LF=EHe([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var V={callback:h,group:d,runOnlyIf:m,captureCtrl:v,preventDefault:b,stopPropagation:T};if(He(N)){var B=[N,L];V.relativeToGroup=B[0],V.position=B[1]}f.forEach(function(k){var M=B0(k),G=r.hasItem(M);if(G){var j=r.getItem(M),q=j.findIndex(function(te){return te.group===N});q!==-1?L==="before"?q-=1:q+=1:q=j.length,j.splice(q,0,V)}else r.addItem(M,[V])})},i=function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c.forEach(function(h){St(f,function(d,p){Object.prototype.hasOwnProperty.call(h,p)===!1&&(h[p]=f[p])}),n(h)})},o=function(c){var f=B0(c);r.removeItem(f)},a=function(c){var f=r.getItems();f.forEach(function(h){var d=bHe(h,2),p=d[0],m=d[1],g=m.filter(function(v){return v.group!==c});g.length===0?o(pHe(p)):(m.length=0,m.push.apply(m,mHe(g)))})},s=function(c){var f=B0(c),h=r.getItem(f);return He(h)?h.slice():[]},l=function(c){var f=B0(c);return r.hasItem(f)};return{addShortcut:n,addShortcuts:i,getShortcuts:s,hasShortcut:l,removeShortcutsByKeys:o,removeShortcutsByGroup:a}};function _He(){var t=new Set;return{press:function(r){t.add(r)},release:function(r){t.delete(r)},releaseAll:function(){t.clear()},isPressed:function(r){return t.has(r)}}}var THe=["meta","alt","shift","control"],gm=_He();function OHe(t,e,r,n,i){var o=function(d){return THe.includes(d)},a=function(d){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,m=[];return d.altKey&&m.push("alt"),p&&(d.ctrlKey||d.metaKey)?m.push("control/meta"):(d.ctrlKey&&m.push("control"),d.metaKey&&m.push("meta")),d.shiftKey&&m.push("shift"),m},s=function(d){if(e(d)!==!1){var p=r(d);if(!(d.keyCode===229||p===!1||Rf(d))){var m=$F(d.key),g=[];o(m)?gm.press(m):g=a(d);var v=[m].concat(g),S=i(d,v);!S&&(QP()&&g.includes("meta")||!QP()&&g.includes("control"))&&i(d,[m].concat(a(d,!0))),n(d)}}},l=function(d){if(e(d)!==!1){var p=$F(d.key);o(p)!==!1&&gm.release(p)}},u=function(){gm.releaseAll()},c=function(){for(var d=t;d;)d.document.documentElement.addEventListener("keydown",s),d.document.documentElement.addEventListener("keyup",l),d.document.documentElement.addEventListener("blur",u),d=Z2(d)},f=function(){for(var d=t;d;)d.document.documentElement.removeEventListener("keydown",s),d.document.documentElement.removeEventListener("keyup",l),d.document.documentElement.removeEventListener("blur",u),d=Z2(d)};return{mount:c,unmount:f,isPressed:function(d){return gm.isPressed(d)},releasePressedKeys:function(){return gm.releaseAll()}}}var AHe=function(e){var r=e.ownerWindow,n=e.handleEvent,i=e.beforeKeyDown,o=e.afterKeyDown,a=O6({errorIdExists:function(m){return'The "'.concat(m,'" context name is already registered.')}}),s="grid",l=function(m){var g=CHe(m);return a.addItem(m,g),g},u=function(){return s},c=function(m){return a.getItem(m)},f=function(m){s=m},h=!1,d=OHe(r,n,i,o,function(p,m){var g=c(u()),v=!1;if(!g.hasShortcut(m))return v;for(var S=g.getShortcuts(m),b=0;b<S.length;b++){var E=S[b],T=E.callback,N=E.runOnlyIf,L=E.preventDefault,V=E.stopPropagation,B=E.captureCtrl;if(N(p)!==!1&&(h=B,v=T(p,m)===!1,h=!1,L&&p.preventDefault(),V&&p.stopPropagation(),v))break}return v});return d.mount(),{addContext:l,getActiveContextName:u,getContext:c,setActiveContextName:f,isCtrlPressed:function(){return!h&&(d.isPressed("control")||d.isPressed("meta"))},releasePressedKeys:function(){return d.releasePressedKeys()},destroy:function(){return d.unmount()}}},DF,FF;function ii(t){return ii=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ii(t)}function HF(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Bo(t,e){return MHe(t)||IHe(t,e)||EQ(t,e)||xHe()}function xHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IHe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function MHe(t){if(Array.isArray(t))return t}function Xc(t){return kHe(t)||PHe(t)||EQ(t)||NHe()}function NHe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EQ(t,e){if(!!t){if(typeof t=="string")return t7(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t7(t,e)}}function PHe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function kHe(t){if(Array.isArray(t))return t7(t)}function t7(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var $He="gridDefault",sC=null,U0=new Set;function rI(t,e){var r,n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,a=this,s=new Er(a),l,u,c,f,h=!0;N$e(i)&&M$e(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",p=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",p),this.isRtl=function(){return p==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},e.language=bLe(e.language);var m=new SQ(a,e,[lHe,dHe]),g=m.getTableMeta(),v=m.getGlobalMeta(),S=O6();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),jO(this)&&Kbe(e.licenseKey,t),this.guid="ht_".concat(kK()),this.columnIndexMapper=new wO,this.rowIndexMapper=new wO,u=new rLe(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var b=function(R){var C=R.row,A=R.col;return a._createCellCoords(C>=0?a.rowIndexMapper.getRenderableFromVisualIndex(C):C,A>=0?a.columnIndexMapper.getRenderableFromVisualIndex(A):A)},E=function(R){var C=R.row,A=R.col;return a._createCellCoords(C>=0?a.rowIndexMapper.getVisualFromRenderableIndex(C):C,A>=0?a.columnIndexMapper.getVisualFromRenderableIndex(A):A)},T=new QDe(g,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(R){return l.propToCol(R)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(R,C){return a._createCellCoords(R,C)},createCellRange:function(R,C,A){return a._createCellRange(R,C,A)},visualToRenderableCoords:b,renderableToVisualCoords:E,isDisabledCellSelection:function(R,C){return a.getCellMeta(R,C).disableVisualSelection}});this.selection=T;var N=function(R){var C=R.hiddenIndexesChanged;C&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",N),this.rowIndexMapper.addLocalHook("cacheUpdated",N),this.selection.addLocalHook("beforeSetRangeStart",function(y){n.runHooks("beforeSetRangeStart",y)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(y){n.runHooks("beforeSetRangeStartOnly",y)}),this.selection.addLocalHook("beforeSetRangeEnd",function(y){n.runHooks("beforeSetRangeEnd",y),y.row<0&&(y.row=n.view._wt.wtTable.getFirstVisibleRow()),y.col<0&&(y.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(y){var R=dh(!1),C=n.selection.getSelectedRange(),A=C.current(),P=A.from,H=A.to,Y=C.size()-1;n.runHooks("afterSelection",P.row,P.col,H.row,H.col,R,Y),n.runHooks("afterSelectionByProp",P.row,a.colToProp(P.col),H.row,a.colToProp(H.col),R,Y);var z=n.selection.isSelectedByAnyHeader(),oe=n.selection.selectedRange.current(),me=!0;o&&(me=!1),R.isTouched()&&(me=!R.value);var re=n.selection.isSelectedByRowHeader(),ge=n.selection.isSelectedByColumnHeader();me!==!1&&(z?re?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(y.row)):ge&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(y.col)):oe&&!n.selection.isMultiple()?n.view.scrollViewport(b(oe.from)):n.view.scrollViewport(b(y))),re&&ge?Re(n.rootElement,["ht__selection--rows","ht__selection--columns"]):re?(ut(n.rootElement,"ht__selection--columns"),Re(n.rootElement,"ht__selection--rows")):ge?(ut(n.rootElement,"ht__selection--rows"),Re(n.rootElement,"ht__selection--columns")):ut(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(y){var R=y.length-1,C=y[R],A=C.from,P=C.to;n.runHooks("afterSelectionEnd",A.row,A.col,P.row,P.col,R),n.runHooks("afterSelectionEndByProp",A.row,a.colToProp(A.col),P.row,a.colToProp(P.col),R)}),this.selection.addLocalHook("afterIsMultipleSelection",function(y){var R=n.runHooks("afterIsMultipleSelection",y.value);y.value&&(y.value=R)}),this.selection.addLocalHook("beforeModifyTransformStart",function(y){n.runHooks("modifyTransformStart",y)}),this.selection.addLocalHook("afterModifyTransformStart",function(y,R,C){n.runHooks("afterModifyTransformStart",y,R,C)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(y){n.runHooks("modifyTransformEnd",y)}),this.selection.addLocalHook("afterModifyTransformEnd",function(y,R,C){n.runHooks("afterModifyTransformEnd",y,R,C)}),this.selection.addLocalHook("afterDeselect",function(){f.destroyEditor(),n._refreshBorders(),ut(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(y){n.alter("insert_row_above",y,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(y){n.alter("insert_col_start",y,1,"auto")}),c={alter:function(R,C){var A,P,H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Y=arguments.length>3?arguments[3]:void 0,z=arguments.length>4?arguments[4]:void 0,oe=function(Ke){if(Ke.length===0)return[];var Xe=Xc(Ke);Xe.sort(function(Rt,it){var st=Bo(Rt,1),rt=st[0],Lt=Bo(it,1),kt=Lt[0];return rt===kt?0:rt>kt?1:-1});var nt=Hn(Xe,function(Rt,it){var st=Bo(it,2),rt=st[0],Lt=st[1],kt=Rt[Rt.length-1],It=Bo(kt,2),gt=It[0],Kr=It[1],rn=gt+Kr;if(rt<=rn){var Lr=Math.max(Lt-(rn-rt),0);kt[1]+=Lr}else Rt.push([rt,Lt]);return Rt},[Xe[0]]);return nt};switch(R){case"insert_row":U0.has(R)||(U0.add(R),Xt(Gt(DF||(DF=HF(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),R)));case"insert_row_below":case"insert_row_above":var me=a.countSourceRows();if(g.maxRows===me)return;var re=R==="insert_row_below"?"below":"above";C=(A=C)!==null&&A!==void 0?A:R==="insert_row"||re==="below"?me:0;var ge=l.createRow(C,H,{source:Y,mode:re}),ve=ge.delta,ie=ge.startPhysicalIndex;if(ve){var be=T.selectedRange.current(),ce=be==null?void 0:be.from,_e=ce==null?void 0:ce.row,Ie=a.toVisualRow(ie);if(T.isSelectedByCorner())a.selectAll();else if(He(_e)&&_e>=Ie){var Oe=be.to,Ae=Oe.row,xe=Oe.col,I=ce.col;T.isSelectedByRowHeader()&&(I=-1),T.getSelectedRange().pop(),T.setRangeStartOnly(a._createCellCoords(_e+ve,I),!0),T.setRangeEnd(a._createCellCoords(Ae+ve,xe))}else a._refreshBorders()}break;case"insert_col":U0.has(R)||(U0.add(R),Xt(Gt(FF||(FF=HF(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),R)));case"insert_col_start":case"insert_col_end":var D=R==="insert_col_end"?"end":"start";C=(P=C)!==null&&P!==void 0?P:R==="insert_col"||D==="end"?a.countSourceCols():0;var U=l.createCol(C,H,{source:Y,mode:D}),ae=U.delta,X=U.startPhysicalIndex;if(ae){if(Array.isArray(g.colHeaders)){var le=[a.toVisualColumn(X),0];le.length+=ae,Array.prototype.splice.apply(g.colHeaders,le)}var ee=T.selectedRange.current(),Z=ee==null?void 0:ee.from,ue=Z==null?void 0:Z.col,K=a.toVisualColumn(X);if(T.isSelectedByCorner())a.selectAll();else if(He(ue)&&ue>=K){var se=ee.to,we=se.row,Se=se.col,Me=Z.row;T.isSelectedByColumnHeader()&&(Me=-1),T.getSelectedRange().pop(),T.setRangeStartOnly(a._createCellCoords(Me,ue+ae),!0),T.setRangeEnd(a._createCellCoords(we,Se+ae))}else a._refreshBorders()}break;case"remove_row":var qe=function(Ke){var Xe=0;Q(Ke,function(nt){var Rt=Bo(nt,2),it=Rt[0],st=Rt[1],rt=an(it)?a.countRows()-1:Math.max(it-Xe,0);Number.isInteger(it)&&(it=Math.max(it-Xe,0));var Lt=l.removeRow(it,st,Y);if(!!Lt){var kt=a.countRows(),It=g.fixedRowsTop;It>=rt+1&&(g.fixedRowsTop-=Math.min(st,It-rt));var gt=g.fixedRowsBottom;gt&&rt>=kt-gt&&(g.fixedRowsBottom-=Math.min(st,gt)),Xe+=st}})};Array.isArray(C)?qe(oe(C)):qe([[C,H]]),c.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var ke=function(Ke){var Xe=0;Q(Ke,function(nt){var Rt=Bo(nt,2),it=Rt[0],st=Rt[1],rt=an(it)?a.countCols()-1:Math.max(it-Xe,0),Lt=a.toPhysicalColumn(rt);Number.isInteger(it)&&(it=Math.max(it-Xe,0));var kt=l.removeCol(it,st,Y);if(!!kt){var It=g.fixedColumnsStart;It>=rt+1&&(g.fixedColumnsStart-=Math.min(st,It-rt)),Array.isArray(g.colHeaders)&&(typeof Lt>"u"&&(Lt=-1),g.colHeaders.splice(Lt,st)),Xe+=st}})};Array.isArray(C)?ke(oe(C)):ke([[C,H]]),c.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(R,'"'))}z||c.adjustRowsAndCols()},adjustRowsAndCols:function(){var R=g.minRows,C=g.minSpareRows,A=g.minCols,P=g.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&T.deselect(),R){var H=a.countRows();H<R&&l.createRow(H,R-H,{source:"auto"})}if(C){var Y=a.countEmptyRows(!0);if(Y<C){var z=C-Y,oe=Math.min(z,g.maxRows-a.countSourceRows());l.createRow(a.countRows(),oe,{source:"auto"})}}{var me;(A||P)&&(me=a.countEmptyCols(!0));var re=a.countCols();if(A&&!g.columns&&re<A){var ge=A-re;me+=ge,l.createCol(re,ge,{source:"auto"})}if(P&&!g.columns&&a.dataType==="array"&&me<P){re=a.countCols();var ve=P-me,ie=Math.min(ve,g.maxCols-re);l.createCol(re,ie,{source:"auto"})}}if(T.isSelected()){var be=a.countRows(),ce=a.countCols();Q(T.selectedRange,function(_e){var Ie=!1,Oe=_e.from.row,Ae=_e.from.col,xe=_e.to.row,I=_e.to.col;Oe>be-1?(Oe=be-1,Ie=!0,xe>Oe&&(xe=Oe)):xe>be-1&&(xe=be-1,Ie=!0,Oe>xe&&(Oe=xe)),Ae>ce-1?(Ae=ce-1,Ie=!0,I>Ae&&(I=Ae)):I>ce-1&&(I=ce-1,Ie=!0,Ae>I&&(Ae=I)),Ie&&a.selectCell(Oe,Ae,xe,I)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(R,C,A,P,H,Y,z){var oe,me,re,ge,ve=[],ie={},be=[],ce=R.row,_e=R.col;if(me=C.length,me===0)return!1;var Ie=0,Oe=0;switch(wt(A)&&(Ie=A.col-_e+1,Oe=A.row-ce+1),H){case"shift_down":var Ae=zb(C),xe=Ae.length,I=Math.max(xe,Ie),D=a.getData().slice(ce),U=zb(D).slice(_e,_e+I);for(re=0;re<I;re+=1)if(re<xe){for(oe=0,me=Ae[re].length;oe<Oe-me;oe+=1)Ae[re].push(Ae[re][oe%me]);re<U.length?be.push(Ae[re].concat(U[re])):be.push(Ae[re].concat(new Array(D.length).fill(null)))}else be.push(Ae[re%xe].concat(U[re]));a.populateFromArray(ce,_e,zb(be));break;case"shift_right":var ae=C.length,X=Math.max(ae,Oe),le=a.getData().slice(ce).map(function(It){return It.slice(_e)});for(oe=0;oe<X;oe+=1)if(oe<ae){for(re=0,ge=C[oe].length;re<Ie-ge;re+=1)C[oe].push(C[oe][re%ge]);if(oe<le.length)for(var ee=0;ee<le[oe].length;ee+=1)C[oe].push(le[oe][ee]);else{var Z;(Z=C[oe]).push.apply(Z,Xc(new Array(le[0].length).fill(null)))}}else C.push(C[oe%me].slice(0,X).concat(le[oe]));a.populateFromArray(ce,_e,C);break;case"overwrite":default:ie.row=R.row,ie.col=R.col;var ue={row:A&&R?A.row-R.row+1:1,col:A&&R?A.col-R.col+1:1},K=0,se=0,we=!0,Se,Me=function(gt){var Kr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,rn=C[gt%C.length];return Kr!==null?rn[Kr%rn.length]:rn},qe=C.length,ke=A?A.row-R.row+1:0;for(A?me=ke:me=Math.max(qe,ke),oe=0;oe<me&&!(A&&ie.row>A.row&&ke>qe||!g.allowInsertRow&&ie.row>a.countRows()-1||ie.row>=g.maxRows);oe++){var We=oe-K,Ke=Me(We).length,Xe=A?A.col-R.col+1:0;if(A?ge=Xe:ge=Math.max(Ke,Xe),ie.col=R.col,Se=a.getCellMeta(ie.row,ie.col),(P==="CopyPaste.paste"||P==="Autofill.fill")&&Se.skipRowOnPaste){K+=1,ie.row+=1,me+=1;continue}for(se=0,re=0;re<ge&&!(A&&ie.col>A.col&&Xe>Ke||!g.allowInsertColumn&&ie.col>a.countCols()-1||ie.col>=g.maxCols);re++){if(Se=a.getCellMeta(ie.row,ie.col),(P==="CopyPaste.paste"||P==="Autofill.fill")&&Se.skipColumnOnPaste){se+=1,ie.col+=1,ge+=1;continue}if(Se.readOnly&&P!=="UndoRedo.undo"){ie.col+=1;continue}var nt=re-se,Rt=Me(We,nt),it=a.getDataAtCell(ie.row,ie.col),st={row:We,col:nt};if(P==="Autofill.fill"){var rt=a.runHooks("beforeAutofillInsidePopulate",st,Y,C,z,{},ue);rt&&(Rt=tr(rt.value)?Rt:rt.value)}if(Rt!==null&&ii(Rt)==="object")if(Array.isArray(Rt)&&it===null&&(it=[]),it===null||ii(it)!=="object")we=!1;else{var Lt=xg(Array.isArray(it)?it:it[0]||it),kt=xg(Array.isArray(Rt)?Rt:Rt[0]||Rt);SK(Lt,kt)||Array.isArray(Lt)&&Array.isArray(kt)?Rt=Zn(Rt):we=!1}else it!==null&&ii(it)==="object"&&(we=!1);we&&ve.push([ie.row,ie.col,Rt]),we=!0,ie.col+=1}ie.row+=1}a.setDataAtCell(ve,null,null,P||"populateFromArray");break}}};function L(y){var R=tQ(y);Jx(R)?(a.runHooks("beforeLanguageChange",R),v.language=R,a.runHooks("afterLanguageChange",R)):rQ(y)}function V(y,R){var C=y==="className"?a.rootElement:a.table;if(h)Re(C,R);else{var A=[],P=[];v[y]&&(A=Array.isArray(v[y])?v[y]:$P(v[y])),R&&(P=Array.isArray(R)?R:$P(R));var H=kP(A,P),Y=kP(P,A);H.length&&ut(C,H),Y.length&&Re(C,Y)}v[y]=R}this.init=function(){u.setData(g.data),a.runHooks("beforeInit"),(na()||CK())&&Re(a.rootElement,"mobile"),this.updateSettings(g,!0),this.view=new G$e(this),f=d6e.getInstance(a,g,T),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),!!h&&a.rootElement.offsetParent===null&&Qwe(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),ii(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function B(){var y=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,y=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&y===!1&&(y=!0,this.onQueueEmpty(this.valid))}}}function k(y){var R=y.replace(",",".");return isNaN(parseFloat(R))===!1?parseFloat(R):y}function M(y,R,C){if(!!y.length){var A=a.getActiveEditor(),P=a.runHooks("beforeChange",y,R||"edit"),H=!0;if(P===!1){A&&A.cancelChanges();return}var Y=new B;Y.onQueueEmpty=function(be){A&&H&&A.cancelChanges(),C(be)};for(var z=y.length-1;z>=0;z--)if(y[z]===null)y.splice(z,1);else{var oe=Bo(y[z],4),me=oe[0],re=oe[1],ge=oe[3],ve=l.propToCol(re),ie=a.getCellMeta(me,ve);ie.type==="numeric"&&typeof ge=="string"&&F6e(ge)&&(y[z][3]=k(ge)),a.getCellValidator(ie)&&(Y.addValidatorToQueue(),a.validateCell(y[z][3],ie,function(be,ce){return function(_e){if(typeof _e!="boolean")throw new Error("Validation error: result is not boolean");if(_e===!1&&ce.allowInvalid===!1){H=!1,y.splice(be,1),ce.valid=!0;var Ie=a.getCell(ce.visualRow,ce.visualCol);Ie!==null&&ut(Ie,g.invalidCellClassName)}Y.removeValidatorFormQueue()}}(z,ie),R))}Y.checkIfQueueIsEmpty()}}function G(y,R){var C=y.length-1;if(!(C<0)){for(;C>=0;C--){var A=!1;if(y[C]===null){y.splice(C,1);continue}if(!((y[C][2]===null||y[C][2]===void 0)&&(y[C][3]===null||y[C][3]===void 0))){if(g.allowInsertRow)for(;y[C][0]>a.countRows()-1;){var P=l.createRow(void 0,void 0,{source:R}),H=P.delta;if(H===0){A=!0;break}}if(a.dataType==="array"&&(!g.columns||g.columns.length===0)&&g.allowInsertColumn)for(;l.propToCol(y[C][1])>a.countCols()-1;){var Y=l.createCol(void 0,void 0,{source:R}),z=Y.delta;if(z===0){A=!0;break}}A||l.set(y[C][0],y[C][1],y[C][3])}}a.forceFullRender=!0,c.adjustRowsAndCols(),a.runHooks("beforeChangeRender",y,R),f.lockEditor(),a._refreshBorders(null),f.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",y,R||"edit");var oe=a.getActiveEditor();oe&&He(oe.refreshValue)&&oe.refreshValue()}}this._createCellCoords=function(y,R){return a.view._wt.createCellCoords(y,R)},this._createCellRange=function(y,R,C){return a.view._wt.createCellRange(y,R,C)},this.validateCell=function(y,R,C,A){var P=a.getCellValidator(R);function H(Y){var z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!z||R.hidden===!0){C(Y);return}var oe=R.visualCol,me=R.visualRow,re=a.getCell(me,oe,!0);if(re&&re.nodeName!=="TH"){var ge=a.rowIndexMapper.getRenderableFromVisualIndex(me),ve=a.columnIndexMapper.getRenderableFromVisualIndex(oe);a.view._wt.getSetting("cellRenderer",ge,ve,re)}C(Y)}zbe(P)&&(P=function(Y){return function(z,oe){oe(Y.test(z))}}(P)),sr(P)?(y=a.runHooks("beforeValidate",y,R.visualRow,R.prop,A),a._registerImmediate(function(){P.call(R,y,function(Y){!a||(Y=a.runHooks("afterValidate",Y,y,R.visualRow,R.prop,A),R.valid=Y,H(Y),a.runHooks("postAfterValidate",Y,y,R.visualRow,R.prop,A))})})):a._registerImmediate(function(){R.valid=!0,H(R.valid,!1)})};function j(y,R,C){return Array.isArray(y)?y:[[y,R,C]]}this.setDataAtCell=function(y,R,C,A){var P=j(y,R,C),H=[],Y=A,z,oe,me;for(z=0,oe=P.length;z<oe;z++){if(ii(P[z])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof P[z][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");P[z][1]>=this.countCols()?me=P[z][1]:me=l.colToProp(P[z][1]),H.push([P[z][0],me,u.getAtCell(this.toPhysicalRow(P[z][0]),P[z][1]),P[z][2]])}!Y&&ii(y)==="object"&&(Y=R),a.runHooks("afterSetDataAtCell",H,Y),M(H,Y,function(){G(H,Y)})},this.setDataAtRowProp=function(y,R,C,A){var P=j(y,R,C),H=[],Y=A,z,oe;for(z=0,oe=P.length;z<oe;z++)H.push([P[z][0],P[z][1],u.getAtCell(this.toPhysicalRow(P[z][0]),P[z][1]),P[z][2]]);!Y&&ii(y)==="object"&&(Y=R),a.runHooks("afterSetDataAtRowProp",H,Y),M(H,Y,function(){G(H,Y)})},this.listen=function(){a&&!a.isListening()&&(sC=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(sC=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return sC===a.guid},this.destroyEditor=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(y,R)},this.populateFromArray=function(y,R,C,A,P,H,Y,z,oe){if(!(ii(C)==="object"&&ii(C[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var me=typeof A=="number"?a._createCellCoords(A,P):null;return c.populateFromArray(a._createCellCoords(y,R),C,me,H,Y,z,oe)},this.spliceCol=function(y,R,C){for(var A,P=arguments.length,H=new Array(P>3?P-3:0),Y=3;Y<P;Y++)H[Y-3]=arguments[Y];return(A=l).spliceCol.apply(A,[y,R,C].concat(H))},this.spliceRow=function(y,R,C){for(var A,P=arguments.length,H=new Array(P>3?P-3:0),Y=3;Y<P;Y++)H[Y-3]=arguments[Y];return(A=l).spliceRow.apply(A,[y,R,C].concat(H))},this.getSelected=function(){if(T.isSelected())return bt(T.getSelectedRange(),function(y){var R=y.from,C=y.to;return[R.row,R.col,C.row,C.col]})},this.getSelectedLast=function(){var y=this.getSelected(),R;return y&&y.length>0&&(R=y[y.length-1]),R},this.getSelectedRange=function(){if(T.isSelected())return Array.from(T.getSelectedRange())},this.getSelectedRangeLast=function(){var y=this.getSelectedRange(),R;return y&&y.length>0&&(R=y[y.length-1]),R},this.emptySelectedCells=function(y){var R=this;if(!(!T.isSelected()||this.countRows()===0||this.countCols()===0)){var C=[];Q(T.getSelectedRange(),function(A){var P=A.getTopStartCorner(),H=A.getBottomEndCorner();Ye(P.row,H.row,function(Y){Ye(P.col,H.col,function(z){R.getCellMeta(Y,z).readOnly||C.push([Y,z,null])})})}),C.length>0&&this.setDataAtCell(C,y)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var y=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(y,0),!this.isRenderSuspended()&&y===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(f.lockEditor(),this._refreshBorders(null),f.unlockEditor()))},this.batchRender=function(y){this.suspendRender();var R=y();return this.resumeRender(),R},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(R,0),(!this.isExecutionSuspended()&&R===this.executionSuspendedCounter||y)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(y){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var C=y();return this.resumeExecution(R),C},this.batch=function(y){this.suspendRender(),this.suspendExecution();var R=y();return this.resumeExecution(),this.resumeRender(),R},this.refreshDimensions=function(){if(!!a.view){var y=a.view.getLastSize(),R=y.width,C=y.height,A=a.rootElement.getBoundingClientRect(),P=A.width,H=A.height,Y=P!==R||H!==C,z=a.runHooks("beforeRefreshDimensions",{width:R,height:C},{width:P,height:H},Y)===!1;z||((Y||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(P,H),a.render()),a.runHooks("afterRefreshDimensions",{width:R,height:C},{width:P,height:H},Y))}},this.updateData=function(y,R){var C=this;MF(y,function(A){l=A},function(A){l=A,a.columnIndexMapper.fitToLength(C.getInitialColumnCount()),a.rowIndexMapper.fitToLength(C.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:a,dataMap:l,dataSource:u,internalSource:"updateData",source:R,metaManager:m,firstRun:h})},this.loadData=function(y,R){MF(y,function(C){l=C},function(){m.clearCellsCache(),a.initIndexMappers(),c.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:l,dataSource:u,internalSource:"loadData",source:R,metaManager:m,firstRun:h})},this.getInitialColumnCount=function(){var y=g.columns,R=0;if(Array.isArray(y))R=y.length;else if(sr(y))if(a.dataType==="array")for(var C=this.countSourceCols(),A=0;A<C;A+=1)y(A)&&(R+=1);else(a.dataType==="object"||a.dataType==="function")&&(R=l.colToPropCache.length);else if(He(g.dataSchema)){var P=l.getSchema();R=Array.isArray(P)?P.length:j8(P)}else R=this.countSourceCols();return R},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(y,R,C,A){return tr(y)?l.getAll():l.getRange(a._createCellCoords(y,R),a._createCellCoords(C,A),l.DESTINATION_RENDERER)},this.getCopyableText=function(y,R,C,A){return l.getCopyableText(a._createCellCoords(y,R),a._createCellCoords(C,A))},this.getCopyableData=function(y,R){return l.getCopyable(y,l.colToProp(R))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(y){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,C=(h?a.loadData:a.updateData).bind(this),A=!1,P,H;if(He(y.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(He(y.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(He(y.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(P in y)P==="data"||(P==="language"?L(y.language):P==="className"?V("className",y.className):P==="tableClassName"&&a.table?(V("tableClassName",y.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):Ue.getSingleton().isRegistered(P)||Ue.getSingleton().isDeprecated(P)?(sr(y[P])||Array.isArray(y[P]))&&(y[P].initialHook=!0,a.addHook(P,y[P])):!R&&Nr(y,P)&&(v[P]=y[P]));y.data===void 0&&g.data===void 0?C(null,"updateSettings"):y.data!==void 0?C(y.data,"updateSettings"):y.columns!==void 0&&(l.createMap(),a.initIndexMappers());var Y=a.countCols(),z=g.columns;if(z&&sr(z)&&(A=!0),(y.cell!==void 0||y.cells!==void 0||y.columns!==void 0)&&m.clearCache(),Y>0)for(P=0,H=0;P<Y;P++){if(z){var oe=A?z(P):z[H];oe&&m.updateColumnMeta(H,oe)}H+=1}He(y.cell)&&St(y.cell,function(be){a.setCellMetaObject(be.row,be.col,be)}),a.runHooks("afterCellMetaReset");var me=a.rootElement.style.height;me!==""&&(me=parseInt(a.rootElement.style.height,10));var re=y.height;if(sr(re)&&(re=re()),R){var ge=a.rootElement.getAttribute("style");ge&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(re===null){var ve=a.rootElement.getAttribute("data-initialstyle");ve&&(ve.indexOf("height")>-1||ve.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",ve):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else re!==void 0&&(a.rootElement.style.height=isNaN(re)?"".concat(re):"".concat(re,"px"),a.rootElement.style.overflow="hidden");if(typeof y.width<"u"){var ie=y.width;sr(ie)&&(ie=ie()),a.rootElement.style.width=isNaN(ie)?"".concat(ie):"".concat(ie,"px")}R||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",y)),c.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,f.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),f.unlockEditor()),!R&&a.view&&(me===""||re===""||re===void 0)&&me!==re&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var y=a.getSelectedLast();if(g.getValue){if(sr(g.getValue))return g.getValue.call(a);if(y)return a.getData()[y[0][0]][g.getValue]}else if(y)return a.getDataAtCell(y[0],y[1])},this.getSettings=function(){return g},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(y,R,C,A,P){c.alter(y,R,C,A,P)},this.getCell=function(y,R){var C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=R,P=y;if(R>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(R)))return null;A=this.columnIndexMapper.getRenderableFromVisualIndex(R)}if(y>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(y)))return null;P=this.rowIndexMapper.getRenderableFromVisualIndex(y)}return P===null||A===null?null:a.view.getCellAtCoords(a._createCellCoords(P,A),C)},this.getCoords=function(y){var R=this.view._wt.wtTable.getCoords(y);if(R===null)return null;var C=R.row,A=R.col,P=C,H=A;return C>=0&&(P=this.rowIndexMapper.getVisualFromRenderableIndex(C)),A>=0&&(H=this.columnIndexMapper.getVisualFromRenderableIndex(A)),a._createCellCoords(P,H)},this.colToProp=function(y){return l.colToProp(y)},this.propToCol=function(y){return l.propToCol(y)},this.toVisualRow=function(y){return n.rowIndexMapper.getVisualFromPhysicalIndex(y)},this.toVisualColumn=function(y){return n.columnIndexMapper.getVisualFromPhysicalIndex(y)},this.toPhysicalRow=function(y){return n.rowIndexMapper.getPhysicalFromVisualIndex(y)},this.toPhysicalColumn=function(y){return n.columnIndexMapper.getPhysicalFromVisualIndex(y)},this.getDataAtCell=function(y,R){return l.get(y,l.colToProp(R))},this.getDataAtRowProp=function(y,R){return l.get(y,R)},this.getDataAtCol=function(y){for(var R=[],C=l.getRange(a._createCellCoords(0,y),a._createCellCoords(g.data.length-1,y),l.DESTINATION_RENDERER),A=0;A<C.length;A+=1)for(var P=0;P<C[A].length;P+=1)R.push(C[A][P]);return R},this.getDataAtProp=function(y){for(var R=[],C=l.getRange(a._createCellCoords(0,l.propToCol(y)),a._createCellCoords(g.data.length-1,l.propToCol(y)),l.DESTINATION_RENDERER),A=0;A<C.length;A+=1)for(var P=0;P<C[A].length;P+=1)R.push(C[A][P]);return R},this.getSourceData=function(y,R,C,A){var P;return y===void 0?P=u.getData():P=u.getByRange(a._createCellCoords(y,R),a._createCellCoords(C,A)),P},this.getSourceDataArray=function(y,R,C,A){var P;return y===void 0?P=u.getData(!0):P=u.getByRange(a._createCellCoords(y,R),a._createCellCoords(C,A),!0),P},this.getSourceDataAtCol=function(y){return u.getAtColumn(y)},this.setSourceDataAtCell=function(y,R,C,A){var P=j(y,R,C),H=this.hasHook("afterSetSourceDataAtCell"),Y=[];H&&Q(P,function(oe){var me=Bo(oe,3),re=me[0],ge=me[1],ve=me[2];Y.push([re,ge,u.getAtCell(re,ge),ve])}),Q(P,function(oe){var me=Bo(oe,3),re=me[0],ge=me[1],ve=me[2];u.setAtCell(re,ge,ve)}),H&&this.runHooks("afterSetSourceDataAtCell",Y,A),this.render();var z=a.getActiveEditor();z&&He(z.refreshValue)&&z.refreshValue()},this.getSourceDataAtRow=function(y){return u.getAtRow(y)},this.getSourceDataAtCell=function(y,R){return u.getAtCell(y,R)},this.getDataAtRow=function(y){var R=l.getRange(a._createCellCoords(y,0),a._createCellCoords(y,this.countCols()-1),l.DESTINATION_RENDERER);return R[0]||[]},this.getDataType=function(y,R,C,A){var P=this,H=y===void 0?[0,0,this.countRows(),this.countCols()]:[y,R,C,A],Y=H[0],z=H[1],oe=H[2],me=H[3],re=null,ge=null;oe===void 0&&(oe=Y),me===void 0&&(me=z);var ve="mixed";return Ye(Math.max(Math.min(Y,oe),0),Math.max(Y,oe),function(ie){var be=!0;return Ye(Math.max(Math.min(z,me),0),Math.max(z,me),function(ce){var _e=P.getCellMeta(ie,ce);return ge=_e.type,re?be=re===ge:re=ge,be}),ve=be?ge:"mixed",be}),ve},this.removeCellMeta=function(y,R,C){var A=[this.toPhysicalRow(y),this.toPhysicalColumn(R)],P=A[0],H=A[1],Y=m.getCellMetaKeyValue(P,H,C),z=a.runHooks("beforeRemoveCellMeta",y,R,C,Y);z!==!1&&(m.removeCellMeta(P,H,C),a.runHooks("afterRemoveCellMeta",y,R,C,Y)),Y=null},this.spliceCellsMeta=function(y){for(var R=this,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,A=arguments.length,P=new Array(A>2?A-2:0),H=2;H<A;H++)P[H-2]=arguments[H];if(P.length>0&&!Array.isArray(P[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");C>0&&m.removeRow(this.toPhysicalRow(y),C),P.length>0&&Q(P.reverse(),function(Y){m.createRow(R.toPhysicalRow(y)),Q(Y,function(z,oe){return R.setCellMetaObject(y,oe,z)})}),a.render()},this.setCellMetaObject=function(y,R,C){var A=this;ii(C)==="object"&&St(C,function(P,H){A.setCellMeta(y,R,H,P)})},this.setCellMeta=function(y,R,C,A){var P=a.runHooks("beforeSetCellMeta",y,R,C,A);if(P!==!1){var H=y,Y=R;y<this.countRows()&&(H=this.toPhysicalRow(y)),R<this.countCols()&&(Y=this.toPhysicalColumn(R)),m.setCellMeta(H,Y,C,A),a.runHooks("afterSetCellMeta",y,R,C,A)}},this.getCellsMeta=function(){return m.getCellsMeta()},this.getCellMeta=function(y,R){var C=this.toPhysicalRow(y),A=this.toPhysicalColumn(R);return C===null&&(C=y),A===null&&(A=R),m.getCellMeta(C,A,{visualRow:y,visualColumn:R})},this.getCellMetaAtRow=function(y){return m.getCellsMetaAtRow(y)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||g.columns)},this.getCellRenderer=function(y,R){var C=typeof y=="number"?a.getCellMeta(y,R).renderer:y.renderer;return typeof C=="string"?qk(C):tr(C)?qk("text"):C},this.getCellEditor=function(y,R){var C=typeof y=="number"?a.getCellMeta(y,R).editor:y.editor;return typeof C=="string"?wk(C):tr(C)?wk("text"):C},this.getCellValidator=function(y,R){var C=typeof y=="number"?a.getCellMeta(y,R).validator:y.validator;return typeof C=="string"?TEe(C):C},this.validateCells=function(y){this._validateCells(y)},this.validateRows=function(y,R){if(!Array.isArray(y))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(R,y)},this.validateColumns=function(y,R){if(!Array.isArray(y))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(R,void 0,y)},this._validateCells=function(y,R,C){var A=new B;y&&(A.onQueueEmpty=y);for(var P=a.countRows()-1;P>=0;){if(R!==void 0&&R.indexOf(P)===-1){P-=1;continue}for(var H=a.countCols()-1;H>=0;){if(C!==void 0&&C.indexOf(H)===-1){H-=1;continue}A.addValidatorToQueue(),a.validateCell(a.getDataAtCell(P,H),a.getCellMeta(P,H),function(Y){if(typeof Y!="boolean")throw new Error("Validation error: result is not boolean");Y===!1&&(A.valid=!1),A.removeValidatorFormQueue()},"validateCells"),H-=1}P-=1}A.checkIfQueueIsEmpty()},this.getRowHeader=function(y){var R=g.rowHeaders,C=y;return C!==void 0&&(C=a.runHooks("modifyRowHeader",C)),C===void 0?(R=[],Ye(a.countRows()-1,function(A){R.push(a.getRowHeader(A))})):Array.isArray(R)&&R[C]!==void 0?R=R[C]:sr(R)?R=R(C):R&&typeof R!="string"&&typeof R!="number"&&(R=C+1),R},this.hasRowHeaders=function(){return!!g.rowHeaders},this.hasColHeaders=function(){if(g.colHeaders!==void 0&&g.colHeaders!==null)return!!g.colHeaders;for(var y=0,R=a.countCols();y<R;y++)if(a.getColHeader(y))return!0;return!1},this.getColHeader=function(y){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,C=a.runHooks("modifyColHeader",y);if(C===void 0){for(var A=[],P=a.countCols(),H=0;H<P;H++)A.push(a.getColHeader(H));return A}var Y=g.colHeaders,z=function(ge){for(var ve=[],ie=a.countCols(),be=0;be<ie;be++)sr(g.columns)&&g.columns(be)&&ve.push(be);return ve[ge]},oe=a.toPhysicalColumn(C),me=z(oe);return g.colHeaders===!1?Y=null:g.columns&&sr(g.columns)&&g.columns(me)&&g.columns(me).title?Y=g.columns(me).title:g.columns&&g.columns[oe]&&g.columns[oe].title?Y=g.columns[oe].title:Array.isArray(g.colHeaders)&&g.colHeaders[oe]!==void 0?Y=g.colHeaders[oe]:sr(g.colHeaders)?Y=g.colHeaders(oe):g.colHeaders&&typeof g.colHeaders!="string"&&typeof g.colHeaders!="number"&&(Y=K$e(C)),Y=a.runHooks("modifyColumnHeaderValue",Y,y,R),Y},this._getColWidthFromSettings=function(y){var R;if(y>=0){var C=a.getCellMeta(0,y);R=C.width}if((R===void 0||R===g.width)&&(R=g.colWidths),R!=null){switch(ii(R)){case"object":R=R[y];break;case"function":R=R(y);break}typeof R=="string"&&(R=parseInt(R,10))}return R},this.getColWidth=function(y){var R=a._getColWidthFromSettings(y);return R=a.runHooks("modifyColWidth",R,y),R===void 0&&(R=h3.DEFAULT_WIDTH),R},this._getRowHeightFromSettings=function(y){var R=g.rowHeights;if(R!=null){switch(ii(R)){case"object":R=R[y];break;case"function":R=R(y);break}typeof R=="string"&&(R=parseInt(R,10))}return R},this.getRowHeight=function(y){var R=a._getRowHeightFromSettings(y);return R=a.runHooks("modifyRowHeight",R,y),R},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){var y=g.maxCols,R=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(y,R)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=0;return OT(a.countRows()-1,function(C){if(a.isEmptyRow(C))R+=1;else if(y===!0)return!1}),R},this.countEmptyCols=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=0;return OT(a.countCols()-1,function(C){if(a.isEmptyCol(C))R+=1;else if(y===!0)return!1}),R},this.isEmptyRow=function(y){return g.isEmptyRow.call(a,y)},this.isEmptyCol=function(y){return g.isEmptyCol.call(a,y)},this.selectCell=function(y,R,C,A){var P=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,H=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return tr(y)||tr(R)?!1:this.selectCells([[y,R,C,A]],P,H)},this.selectCells=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;R===!1&&(o=!0);var A=T.selectCells(y);return A&&C&&a.listen(),o=!1,A},this.selectColumns=function(y){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y;return T.selectColumns(y,R)},this.selectRows=function(y){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y;return T.selectRows(y,R)},this.deselectCell=function(){T.deselect()},this.selectAll=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,R=y&&this.hasRowHeaders(),C=y&&this.hasColHeaders();o=!0,T.selectAll(R,C),o=!1};var q=function(R,C){return R.getNearestNotHiddenIndex(C,1,!0)};this.scrollViewportTo=function(y,R){var C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,P=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,H=!C,Y=!A,z=y,oe=R;if(P){var me=Number.isInteger(y),re=Number.isInteger(R),ge=me?q(this.rowIndexMapper,y):void 0,ve=re?q(this.columnIndexMapper,R):void 0;if(ge===null||ve===null)return!1;z=me?a.rowIndexMapper.getRenderableFromVisualIndex(ge):void 0,oe=re?a.columnIndexMapper.getRenderableFromVisualIndex(ve):void 0}var ie=Number.isInteger(z),be=Number.isInteger(oe);return ie&&be?a.view.scrollViewport(a._createCellCoords(z,oe),H,A,C,Y):ie&&be===!1?a.view.scrollViewportVertically(z,H,C):be&&ie===!1?a.view.scrollViewportHorizontally(oe,A,Y):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),m.clearCache(),jO(a)){var y=this.rootDocument.querySelector(".hot-display-license-info");y&&y.parentNode.removeChild(y)}ua(a.rootElement),s.destroy(),f&&f.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),S.getItems().forEach(function(R){var C=Bo(R,2),A=C[1];A.destroy()}),S.clear(),a.runHooks("afterDestroy")},!0),Ue.getSingleton().destroy(a),St(a,function(R,C,A){sr(R)?A[C]=te(C):C!=="guid"&&(A[C]=null)}),a.isDestroyed=!0,l&&l.destroy(),a.rowIndexMapper=null,a.columnIndexMapper=null,l=null,c=null,T=null,f=null,a=null};function te(y){return function(){throw new Error('The "'.concat(y,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return f.getActiveEditor()},this.getPlugin=function(y){var R=gs(y);return R==="UndoRedo"?this.undoRedo:S.getItem(R)},this.getPluginName=function(y){return y===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:S.getId(y)},this.getInstance=function(){return a},this.addHook=function(y,R){Ue.getSingleton().add(y,R,a)},this.hasHook=function(y){return Ue.getSingleton().has(y,a)||Ue.getSingleton().has(y)},this.addHookOnce=function(y,R){Ue.getSingleton().once(y,R,a)},this.removeHook=function(y,R){Ue.getSingleton().remove(y,R,a)},this.runHooks=function(y,R,C,A,P,H,Y){return Ue.getSingleton().run(a,y,R,C,A,P,H,Y)},this.getTranslatedPhrase=function(y,R){return lQ(g.language,y,R)},this.toHTML=function(){return DD(n)},this.toTableElement=function(){var y=n.rootDocument.createElement("div");return y.insertAdjacentHTML("afterbegin",DD(n)),y.firstElementChild},this.timeouts=[],this._registerTimeout=function(y){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,C=y;typeof C=="function"&&(C=setTimeout(C,R)),this.timeouts.push(C)},this._clearTimeouts=function(){Q(this.timeouts,function(y){clearTimeout(y)})},this.immediates=[],this._registerImmediate=function(y){this.immediates.push(setImmediate(y))},this._clearImmediates=function(){Q(this.immediates,function(y){clearImmediate(y)})},this._refreshBorders=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;f.destroyEditor(y),a.view.render(),R&&T.isSelected()&&f.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var pe=AHe({handleEvent:function(R){var C=a.isListening(),A=(R==null?void 0:R.key)!==void 0;return C&&A},beforeKeyDown:function(R){return n.runHooks("beforeKeyDown",R)},afterKeyDown:function(R){n.isDestroyed||a.runHooks("afterDocumentKeyDown",R)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(y){y.ctrlKey===!1&&y.metaKey===!1&&pe.releasePressedKeys()}),this.getShortcutManager=function(){return pe};var ne=pe.addContext("grid"),O={runOnlyIf:function(){return He(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:$He};pe.setActiveContextName("grid"),ne.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var R=a.getSelectedRange(),C=R[R.length-1].highlight,A=C.row,P=C.col,H=a.getDataAtCell(A,P),Y=new Map,z=0;z<R.length;z++)R[z].forAll(function(oe,me){if(oe>=0&&me>=0&&(oe!==A||me!==P)){var re=a.getCellMeta(oe,me),ge=re.readOnly;ge||Y.set("".concat(oe,"x").concat(me),[oe,me,H])}});a.setDataAtCell(Array.from(Y.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){T.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){T.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){T.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var R=a.getSelectedRangeLast(),C=R.from,A=R.to,P=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);T.setRangeStart(C.clone()),T.setRangeEnd(a._createCellCoords(P,A.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){T.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){T.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){T.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var R=a.getSelectedRangeLast(),C=R.from,A=R.to,P=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);T.setRangeStart(C.clone()),T.setRangeEnd(a._createCellCoords(P,A.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){T.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var R,C=a.getSelectedRangeLast().highlight.row,A=(R=a.columnIndexMapper).getNearestNotHiddenIndex.apply(R,Xc(a.isRtl()?[a.countCols()-1,-1]:[0,1]));T.setRangeStart(a._createCellCoords(C,A))}},{keys:[["ArrowLeft","Shift"]],callback:function(){T.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var R,C=a.getSelectedRangeLast(),A=C.from,P=C.to,H=(R=a.columnIndexMapper).getNearestNotHiddenIndex.apply(R,Xc(a.isRtl()?[a.countCols()-1,-1]:[0,1]));T.setRangeStart(A.clone()),T.setRangeEnd(a._createCellCoords(P.row,H))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){T.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var R,C=a.getSelectedRangeLast().highlight.row,A=(R=a.columnIndexMapper).getNearestNotHiddenIndex.apply(R,Xc(a.isRtl()?[0,1]:[a.countCols()-1,-1]));T.setRangeStart(a._createCellCoords(C,A))}},{keys:[["ArrowRight","Shift"]],callback:function(){T.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var R,C=a.getSelectedRangeLast(),A=C.from,P=C.to,H=(R=a.columnIndexMapper).getNearestNotHiddenIndex.apply(R,Xc(a.isRtl()?[0,1]:[a.countCols()-1,-1]));T.setRangeStart(A.clone()),T.setRangeEnd(a._createCellCoords(P.row,H))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var R=parseInt(a.getSettings().fixedColumnsStart,10),C=a.getSelectedRangeLast().highlight.row,A=a.columnIndexMapper.getNearestNotHiddenIndex(R,1);T.setRangeStart(a._createCellCoords(C,A))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){T.setRangeEnd(a._createCellCoords(T.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var R=parseInt(a.getSettings().fixedRowsTop,10),C=parseInt(a.getSettings().fixedColumnsStart,10),A=a.rowIndexMapper.getNearestNotHiddenIndex(R,1),P=a.columnIndexMapper.getNearestNotHiddenIndex(C,1);T.setRangeStart(a._createCellCoords(A,P))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){T.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){T.setRangeEnd(a._createCellCoords(T.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var R=parseInt(a.getSettings().fixedRowsBottom,10),C=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-R-1,-1),A=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);T.setRangeStart(a._createCellCoords(C,A))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){T.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var R=a.getSelectedRangeLast(),C=R.to,A=Math.max(C.row-a.countVisibleRows(),0),P=a.rowIndexMapper.getNearestNotHiddenIndex(A,1);if(P!==null){var H=a._createCellCoords(P,C.col),Y=C.row-a.view.getFirstFullyVisibleRow(),z=Math.max(H.row-Y,0);T.setRangeEnd(H),a.scrollViewportTo(z)}}},{keys:[["PageDown"]],callback:function(){T.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var R=a.getSelectedRangeLast(),C=R.to,A=Math.min(C.row+a.countVisibleRows(),a.countRows()-1),P=a.rowIndexMapper.getNearestNotHiddenIndex(A,-1);if(P!==null){var H=a._createCellCoords(P,C.col),Y=C.row-a.view.getFirstFullyVisibleRow(),z=Math.min(H.row-Y,a.countRows()-1);T.setRangeEnd(H),a.scrollViewportTo(z)}}},{keys:[["Tab"]],callback:function(R){var C=typeof g.tabMoves=="function"?g.tabMoves(R):g.tabMoves;T.transformStart(C.row,C.col,!0)}},{keys:[["Shift","Tab"]],callback:function(R){var C=typeof g.tabMoves=="function"?g.tabMoves(R):g.tabMoves;T.transformStart(-C.row,-C.col)}}],O),vq().forEach(function(y){var R=f3(y);S.addItem(y,new R(n))}),Ue.getSingleton().run(a,"construct")}function Zy(t){return Zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zy(t)}function BF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function UF(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?BF(Object(r),!0).forEach(function(n){LHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):BF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function LHe(t,e,r){return e=CQ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DHe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,CQ(n.key),n)}}function FHe(t,e,r){return e&&VF(t.prototype,e),r&&VF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function CQ(t){var e=HHe(t,"string");return Zy(e)==="symbol"?e:String(e)}function HHe(t,e){if(Zy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Zy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jF=215,_Q="menu",BHe=_Q,TQ=function(){function t(e,r){DHe(this,t),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:jF,container:this.hot.rootDocument.documentElement},this.eventManager=new Er(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return FHe(t,[{key:"registerEvents",value:function(){for(var r=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(i){return r.onDocumentMouseDown(i)}),this.eventManager.addEventListener(n.document,"contextmenu",function(i){return r.onDocumentContextMenu(i)}),n=Z2(n)}},{key:"setMenuItems",value:function(r){this.menuItems=r}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[r]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var r=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=WK(function(d){return r.openSubMenu(d)},300),i=this.options.minWidth||jF,o=!1,a=eo(this.menuItems,function(d){return d.key===Cy&&(o=!0),lPe(d,r.hot)});if(a.length<1&&!o)a.push(VX()[Cy]);else if(a.length===0)return;a=fPe(a,vt);var s=!1,l={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(p){return He(p)&&p<i?i:p},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(p,m,g,v,S,b){return r.menuItemRenderer(p,m,g,v,S,b)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(p,m){r.isAllSubMenusClosed()?n(m.row):r.openSubMenu(m.row)},rowHeights:function(p){return a[p].name===vt?1:23},afterOnCellContextMenu:function(p){p.preventDefault(),XP()&&s&&r.hasSelectedItem()&&r.close(!0)},beforeOnCellMouseUp:function(p){r.hasSelectedItem()&&(s=!r.isCommandPassive(r.getSelectedItem()),r.executeCommand(p))},afterOnCellMouseUp:function(p){(!XP()||!zu(p))&&s&&r.hasSelectedItem()&&(na()||CK()?setTimeout(function(){return r.close(!0)},325):r.close(!0))},afterUnlisten:function(){!r.hasSelectedItem()&&r.isOpened()&&r.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new rI(this.container,l),this.hotMenu.addHook("afterInit",function(){return r.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return r.onAfterSelection.apply(r,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var u=this.hotMenu.getShortcutManager(),c=u.addContext(BHe),f={group:_Q},h=UF(UF({},f),{},{runOnlyIf:function(p){return tw(p.target)===!1||r.container.contains(p.target)===!1}});u.setActiveContextName("menu"),c.addShortcuts([{keys:[["Escape"]],callback:function(){r.keyEvent=!0,r.close(),r.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,p?r.selectNextCell(p[0],p[1]):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,p?r.selectPrevCell(p[0],p[1]):r.selectLastCell(),r.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var p=r.hotMenu.getSelectedLast();if(r.keyEvent=!0,p){var m=r.openSubMenu(p[0]);m&&m.selectFirstCell()}r.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,p&&r.isSubMenu()&&(r.close(),r.parentMenu&&r.parentMenu.hotMenu.listen()),r.keyEvent=!1}},{keys:[["Enter"]],callback:function(p){var m=r.hotMenu.getSelectedLast();r.keyEvent=!0,r.hotMenu.getSourceDataAtRow(m[0]).submenu||(r.executeCommand(p),r.close(!0)),r.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,p?r.hotMenu.selection.transformStart(-r.hotMenu.countVisibleRows(),0):r.selectFirstCell(),r.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var p=r.hotMenu.getSelectedLast();r.keyEvent=!0,p?r.hotMenu.selection.transformStart(r.hotMenu.countVisibleRows(),0):r.selectLastCell(),r.keyEvent=!1}}],h),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;!this.isOpened()||(r&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(r){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(r,0);if(this.closeAllSubMenus(),!n||!iPe(n))return!1;var i=this.hotMenu.getSourceDataAtRow(r),o=new t(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(i.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=o,o}},{key:"closeSubMenu",value:function(r){var n=this.hotMenu.getSourceDataAtRow(r),i=this.hotSubMenus[n.key];i&&(i.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var r=this;Q(this.hotMenu.getData(),function(n,i){return r.closeSubMenu(i)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var r=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),r&&r.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(r){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,r),!this.isCommandPassive(n)){var i=this.hot.getSelectedRange(),o=i?nPe(i):[];this.runLocalHooks("executeCommand",n.key,o,r),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,o,r)}}}},{key:"isCommandPassive",value:function(r){var n=r.isCommand,i=r.name,o=r.disabled,a=r.submenu,s=o===!0||typeof o=="function"&&o.call(this.hot)===!0;return n===!1||i===vt||s===!0||a}},{key:"setPosition",value:function(r){var n=new Ake(r,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),this.hot.isLtr()?this.setHorizontalPositionForLtr(n):this.setHorizontalPositionForRtl(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setHorizontalPositionForRtl",value:function(r){r.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(r):this.setPositionOnRightOfCursor(r)}},{key:"setHorizontalPositionForLtr",value:function(r){r.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(r):this.setPositionOnLeftOfCursor(r)}},{key:"setPositionAboveCursor",value:function(r){var n=this.offset.above+r.top-this.container.offsetHeight;this.isSubMenu()&&(n=r.top+r.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(r){var n=this.offset.below+r.top+1;this.isSubMenu()&&(n=r.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(r){var n=r.left;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),o=i.right;n+=r.cellWidth+o-(r.left+r.cellWidth)}else n+=this.offset.right;this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(r){var n=this.offset.left+r.left-this.container.offsetWidth;if(this.isSubMenu()){var i=this.parentMenu.container.getBoundingClientRect(),o=i.left;n-=r.left-o}this.container.style.left="".concat(n,"px")}},{key:"selectFirstCell",value:function(){var r=this.hotMenu.getCell(0,0);k0(r)||$0(r)||L0(r)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var r=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(r,0);k0(n)||$0(n)||L0(n)?this.selectPrevCell(r,0):(this.hotMenu.selectCell(r,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(r,0,!0,!1))}},{key:"selectNextCell",value:function(r,n){var i=r+1,o=i<this.hotMenu.countRows()?this.hotMenu.getCell(i,n):null;!o||(k0(o)||$0(o)||L0(o)?this.selectNextCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"selectPrevCell",value:function(r,n){var i=r-1,o=i>=0?this.hotMenu.getCell(i,n):null;!o||(k0(o)||$0(o)||L0(o)?this.selectPrevCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"menuItemRenderer",value:function(r,n,i,o,a,s){var l=this,u=r.getSourceDataAtRow(i),c=this.hot.rootDocument.createElement("div"),f=function(v){return Nr(v,"submenu")},h=function(v){return new RegExp(vt,"i").test(v.name)},d=function(v){return v.disabled===!0||typeof v.disabled=="function"&&v.disabled.call(l.hot)===!0},p=function(v){return v.disableSelection},m=s;typeof m=="function"&&(m=m.call(this.hot)),ua(n),Re(c,"htItemWrapper"),n.appendChild(c),h(u)?Re(n,"htSeparator"):typeof u.renderer=="function"?(Re(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(r,c,i,o,a,m))):Hp(c,m),d(u)?(Re(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):p(u)?(Re(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()})):f(u)?(Re(n,"htSubmenu"),p(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,o,void 0,void 0,!1,!1)})):(ut(n,["htSubmenu","htDisabled"]),p(u)?this.eventManager.addEventListener(n,"mouseenter",function(){return r.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return r.selectCell(i,o,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,i=r,o;return i&&(sr(i)&&(i=i.call(this.hot),i===null||tr(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i="".concat(this.options.className,"Sub_").concat(i),o=n.querySelector(".".concat(this.options.className,".").concat(i))),o||(o=n.createElement("div"),Re(o,"htMenu ".concat(this.options.className)),i&&Re(o,i),this.options.container.appendChild(o)),o}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var r=this.hotMenu.view._wt.wtTable,n=this.hotMenu.getSettings().data,i=r.hider.style,o=r.holder.style,a=parseInt(i.width,10),s=Hn(n,function(l,u){return l+(u.name===vt?1:26)},0);o.width="".concat(a+3,"px"),o.height="".concat(s+3,"px"),i.height=o.height}},{key:"onAfterSelection",value:function(r,n,i,o,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(r){!this.isOpened()||(this.options.standalone&&this.hotMenu&&!Hu(r.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Hu(r.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(r){!this.isOpened()||at(r.target,"htCore")&&Hu(r.target,this.hotMenu.rootElement)&&r.preventDefault()}}]),t}();ir(TQ,Si);const nI=TQ;function vd(t){return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vd(t)}function UHe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jHe(n.key),n)}}function VHe(t,e,r){return e&&WF(t.prototype,e),r&&WF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function jHe(t){var e=WHe(t,"string");return vd(e)==="symbol"?e:String(e)}function WHe(t,e){if(vd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fu(){return typeof Reflect<"u"&&Reflect.get?fu=Reflect.get.bind():fu=function(e,r,n){var i=zHe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},fu.apply(this,arguments)}function zHe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ka(t),t!==null););return t}function GHe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r7(t,e)}function r7(t,e){return r7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},r7(t,e)}function YHe(t){var e=qHe();return function(){var n=Ka(t),i;if(e){var o=Ka(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return KHe(this,i)}}function KHe(t,e){if(e&&(vd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OQ(t)}function OQ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qHe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ka(t){return Ka=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ka(t)}var V0="contextMenu",XHe=70;Ue.getSingleton().register("afterContextMenuDefaultOptions");Ue.getSingleton().register("beforeContextMenuShow");Ue.getSingleton().register("afterContextMenuShow");Ue.getSingleton().register("afterContextMenuHide");Ue.getSingleton().register("afterContextMenuExecute");var AQ=function(t){GHe(r,t);var e=YHe(r);function r(n){var i;return UHe(this,r),i=e.call(this,n),i.eventManager=new Er(OQ(i)),i.commandExecutor=new HX(i.hot),i.itemsFactory=null,i.menu=null,i}return VHe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[V0]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[V0];typeof o.callback=="function"&&this.commandExecutor.setCommonCallback(o.callback),this.menu=new nI(this.hot,{className:"htContextMenu",keepInViewport:!0,container:o.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return(a=i.executeCommand).call.apply(a,[i].concat(l))}),this.addHook("afterOnCellContextMenu",function(a){return i.onAfterOnCellContextMenu(a)}),fu(Ka(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),fu(Ka(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),fu(Ka(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(i){if(!!this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var o=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,c=l.left;o=u-Ng(i.view),a=c-ph(i.view)}else o=-1*Ng(this.menu.hotMenu.rootWindow),a=-1*ph(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(i.pageY,10)+o,left:parseInt(i.pageX,10)+a})}}},{key:"close",value:function(){!this.menu||(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(i){var o;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(o=this.commandExecutor).execute.apply(o,[i].concat(s))}},{key:"prepareMenuItems",value:function(){var i=this;this.itemsFactory=new jX(this.hot,r.DEFAULT_ITEMS);var o=this.hot.getSettings()[V0],a={items:this.itemsFactory.getItems(o)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var s=this.itemsFactory.getItems(o);this.hot.runHooks("beforeContextMenuSetItems",s),this.menu.setMenuItems(s),Q(s,function(l){return i.commandExecutor.registerCommand(l.key,l)})}},{key:"onAfterOnCellContextMenu",value:function(i){var o=this.hot.getSettings(),a=o.rowHeaders,s=o.colHeaders;function l(c){return c.nodeName==="TD"||c.parentNode.nodeName==="TD"}var u=i.target;this.close(),!at(u,"handsontableInput")&&(i.preventDefault(),i.stopPropagation(),!(!(a||s)&&!l(u)&&!(at(u,"current")&&at(u,"wtBorder")))&&this.open(i))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),fu(Ka(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return V0}},{key:"PLUGIN_PRIORITY",get:function(){return XHe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[F6,H6,vt,D1,F1,vt,D6,B1,vt,B6,k6,vt,H1,vt,ji]}}]),r}(jt);AQ.SEPARATOR={name:vt};function QHe(t){return{key:"copy",name:function(){return this.getTranslatedPhrase(V3)},callback:function(){t.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function ZHe(t){return{key:"copy_column_headers_only",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(z3,n)},callback:function(){t.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function JHe(t){return{key:"copy_with_column_group_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(W3,n)},callback:function(){t.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function eBe(t){return{key:"copy_with_column_headers",name:function(){var r=this.getSelectedRangeLast(),n=r?Math.min(r.getWidth()-1,1):0;return this.getTranslatedPhrase(j3,n)},callback:function(){t.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function tBe(t){return{key:"cut",name:function(){return this.getTranslatedPhrase(G3)},callback:function(){t.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var r=this.getSelected();return!r||r.length>1},hidden:!1}}function Jy(t){return Jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jy(t)}function rBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,iBe(n.key),n)}}function nBe(t,e,r){return e&&zF(t.prototype,e),r&&zF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function iBe(t){var e=oBe(t,"string");return Jy(e)==="symbol"?e:String(e)}function oBe(t,e){if(Jy(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Jy(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var aBe=function(){function t(){rBe(this,t),this.data={}}return nBe(t,[{key:"setData",value:function(r,n){this.data[r]=n}},{key:"getData",value:function(r){return this.data[r]||void 0}}]),t}();function ev(t){return ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ev(t)}function GF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lBe(n.key),n)}}function sBe(t,e,r){return e&&GF(t.prototype,e),r&&GF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function lBe(t){var e=uBe(t,"string");return ev(e)==="symbol"?e:String(e)}function uBe(t,e){if(ev(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ev(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var fBe=sBe(function t(){cBe(this,t),this.clipboardData=new aBe});function tv(t){return tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tv(t)}function hBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function YF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pBe(n.key),n)}}function dBe(t,e,r){return e&&YF(t.prototype,e),r&&YF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function pBe(t){var e=mBe(t,"string");return tv(e)==="symbol"?e:String(e)}function mBe(t,e){if(tv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(tv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var iI=function(){function t(e){hBe(this,t),this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new Er(this),this.listenersCount=new WeakSet,this.container=e}return dBe(t,[{key:"useSecondaryElement",value:function(){var r=vBe(this.container);this.listenersCount.has(r)||(this.listenersCount.add(r),KF(this.eventManager,r,this)),this.mainElement=r}},{key:"setFocusableElement",value:function(r){this.listenersCount.has(r)||(this.listenersCount.add(r),KF(this.eventManager,r,this)),this.mainElement=r}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",na()||Xwe(this.mainElement)}}]),t}();ir(iI,Si);var Hw=new WeakMap;function gBe(t){var e=new iI(t),r=Hw.get(t);return r=isNaN(r)?0:r,Hw.set(t,r+1),e}function yBe(t){t.eventManager.clear()}var lC=function(e,r){return function(n){return r.runLocalHooks(e,n)}};function KF(t,e,r){t.addEventListener(e,"copy",lC("copy",r)),t.addEventListener(e,"cut",lC("cut",r)),t.addEventListener(e,"paste",lC("paste",r))}var Bw=new WeakMap;function vBe(t){var e=Bw.get(t);if(e)return e.parentElement||t.appendChild(e),e;var r=t.defaultView?t:t.ownerDocument,n=r.createElement("textarea");return Bw.set(t,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",t.appendChild(n),n}function qF(t){if(t instanceof iI){var e=Hw.get(t.container);if(e=isNaN(e)?0:e,e>0&&(e-=1),yBe(t),e<=0){e=0;var r=Bw.get(t.container);r&&r.parentNode&&(r.parentNode.removeChild(r),Bw.delete(t.container)),t.mainElement=null}Hw.set(t.container,e)}}function rv(t){return rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rv(t)}function bBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function XF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,SBe(n.key),n)}}function wBe(t,e,r){return e&&XF(t.prototype,e),r&&XF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function SBe(t){var e=RBe(t,"string");return rv(e)==="symbol"?e:String(e)}function RBe(t,e){if(rv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(rv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QF(t,e){xQ(t,e),e.add(t)}function Qc(t,e,r){xQ(t,e),e.set(t,r)}function xQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function j0(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}function Wn(t,e){var r=IQ(t,e,"get");return EBe(t,r)}function EBe(t,e){return e.get?e.get.call(t):e.value}function Zc(t,e,r){var n=IQ(t,e,"set");return CBe(t,n,r),r}function IQ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function CBe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var ks=new WeakMap,uC=new WeakMap,ym=new WeakMap,n7=new WeakMap,i7=new WeakMap,vm=new WeakMap,W0=new WeakSet,ZF=new WeakSet,_Be=function(){function t(e){var r=e.countRows,n=e.countColumns,i=e.rowsLimit,o=e.columnsLimit,a=e.countColumnHeaders;bBe(this,t),QF(this,ZF),QF(this,W0),Qc(this,ks,{writable:!0,value:void 0}),Qc(this,uC,{writable:!0,value:void 0}),Qc(this,ym,{writable:!0,value:void 0}),Qc(this,n7,{writable:!0,value:void 0}),Qc(this,i7,{writable:!0,value:void 0}),Qc(this,vm,{writable:!0,value:void 0}),Zc(this,uC,r),Zc(this,ym,n),Zc(this,n7,i),Zc(this,i7,o),Zc(this,vm,a)}return wBe(t,[{key:"setSelectedRange",value:function(r){Zc(this,ks,r)}},{key:"getCellsRange",value:function(){if(Wn(this,uC).call(this)===0||Wn(this,ym).call(this)===0)return null;var r=Wn(this,ks).getTopStartCorner(),n=r.row,i=r.col,o=Wn(this,ks).getBottomEndCorner(),a=o.row,s=o.col,l=j0(this,ZF,TBe).call(this,n,a),u=j0(this,W0,cC).call(this,i,s),c=a!==l||s!==u;return{isRangeTrimmed:c,startRow:n,startCol:i,endRow:l,endCol:u}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(Wn(this,ym).call(this)===0||Wn(this,vm).call(this)===0)return null;var r=Wn(this,ks).getTopStartCorner(),n=r.col,i=Wn(this,ks).getBottomEndCorner(),o=i.col,a=j0(this,W0,cC).call(this,n,o),s=o!==a;return{isRangeTrimmed:s,startRow:-1,startCol:n,endRow:-1,endCol:a}}},{key:"getAllColumnHeadersRange",value:function(){if(Wn(this,ym).call(this)===0||Wn(this,vm).call(this)===0)return null;var r=Wn(this,ks).getTopStartCorner(),n=r.col,i=Wn(this,ks).getBottomEndCorner(),o=i.col,a=j0(this,W0,cC).call(this,n,o),s=o!==a;return{isRangeTrimmed:s,startRow:-Wn(this,vm).call(this),startCol:n,endRow:-1,endCol:a}}}]),t}();function cC(t,e){return Math.min(e,Math.max(t+Wn(this,i7).call(this)-1,t))}function TBe(t,e){return Math.min(e,Math.max(t+Wn(this,n7).call(this)-1,t))}function MQ(t){var e=[],r=[];return Q(t,function(n){var i=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);Ye(i,o,function(l){e.indexOf(l)===-1&&e.push(l)});var a=Math.min(n.startCol,n.endCol),s=Math.max(n.startCol,n.endCol);Ye(a,s,function(l){r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function OBe(t,e){return MBe(t)||IBe(t,e)||xBe(t,e)||ABe()}function ABe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xBe(t,e){if(!!t){if(typeof t=="string")return JF(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JF(t,e)}}function JF(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function IBe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function MBe(t){if(Array.isArray(t))return t}function nc(t){return nc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nc(t)}function NBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,PQ(n.key),n)}}function PBe(t,e,r){return e&&eH(t.prototype,e),r&&eH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function hu(){return typeof Reflect<"u"&&Reflect.get?hu=Reflect.get.bind():hu=function(e,r,n){var i=kBe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},hu.apply(this,arguments)}function kBe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=qa(t),t!==null););return t}function $Be(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o7(t,e)}function o7(t,e){return o7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},o7(t,e)}function LBe(t){var e=FBe();return function(){var n=qa(t),i;if(e){var o=qa(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return DBe(this,i)}}function DBe(t,e){if(e&&(nc(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jn(t)}function jn(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function FBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qa(t){return qa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qa(t)}function HBe(t,e){NQ(t,e),e.add(t)}function Bl(t,e,r){NQ(t,e),e.set(t,r)}function NQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jc(t,e,r){return e=PQ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PQ(t){var e=BBe(t,"string");return nc(e)==="symbol"?e:String(e)}function BBe(t,e){if(nc(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(nc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UBe(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}function Ei(t,e){var r=kQ(t,e,"get");return VBe(t,r)}function VBe(t,e){return e.get?e.get.call(t):e.value}function _a(t,e,r){var n=kQ(t,e,"set");return jBe(t,n,r),r}function kQ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function jBe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}Ue.getSingleton().register("afterCopyLimit");Ue.getSingleton().register("modifyCopyableRange");Ue.getSingleton().register("beforeCut");Ue.getSingleton().register("afterCut");Ue.getSingleton().register("beforePaste");Ue.getSingleton().register("afterPaste");Ue.getSingleton().register("beforeCopy");Ue.getSingleton().register("afterCopy");var z0="copyPaste",WBe=80,zBe=["fragmentSelection"],tH=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),fC=new WeakMap,hC=new WeakMap,dC=new WeakMap,ef=new WeakMap,G0=new WeakMap,Y0=new WeakMap,tf=new WeakMap,rH=new WeakSet,GBe=function(t){$Be(r,t);var e=LBe(r);function r(){var n;NBe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),HBe(jn(n),rH),Jc(jn(n),"columnsLimit",1/0),Jc(jn(n),"rowsLimit",1/0),Jc(jn(n),"pasteMode","overwrite"),Jc(jn(n),"uiContainer",n.hot.rootDocument.body),Bl(jn(n),fC,{writable:!0,value:!1}),Bl(jn(n),hC,{writable:!0,value:!1}),Bl(jn(n),dC,{writable:!0,value:!1}),Bl(jn(n),ef,{writable:!0,value:"cells-only"}),Bl(jn(n),G0,{writable:!0,value:!1}),Bl(jn(n),Y0,{writable:!0,value:!1}),Bl(jn(n),tf,{writable:!0,value:new _Be({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),Jc(jn(n),"copyableRanges",[]),Jc(jn(n),"focusableElement",void 0),n}return PBe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[z0]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),a=o[z0];if(nc(a)==="object"){var s,l;this.pasteMode=(s=a.pasteMode)!==null&&s!==void 0?s:this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,_a(this,fC,!!a.copyColumnHeaders),_a(this,hC,!!a.copyColumnGroupHeaders),_a(this,dC,!!a.copyColumnHeadersOnly),this.uiContainer=(l=a.uiContainer)!==null&&l!==void 0?l:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(u){return i.onAfterContextMenuDefaultOptions(u)}),this.addHook("afterOnCellMouseUp",function(){return i.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return i.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return i.onBeforeKeyDown()}),this.focusableElement=gBe(this.uiContainer),this.focusableElement.addLocalHook("copy",function(u){return i.onCopy(u)}).addLocalHook("cut",function(u){return i.onCut(u)}).addLocalHook("paste",function(u){return i.onPaste(u)}),hu(qa(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),hu(qa(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&qF(this.focusableElement),hu(qa(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";_a(this,ef,i),_a(this,G0,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){_a(this,Y0,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(i){return ag(this.getRangedData(i))}},{key:"getRangedData",value:function(i){var o=this,a=[],s=MQ(i),l=s.rows,u=s.columns;return Q(l,function(c){var f=[];Q(u,function(h){c<0?f.push(o.hot.getColHeader(h,c)):f.push(o.hot.getCopyableData(c,h))}),a.push(f)}),a}},{key:"paste",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;if(!(!i&&!o)){var a=new fBe;i&&a.clipboardData.setData("text/plain",i),o&&a.clipboardData.setData("text/html",o),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var i=this.hot.getSelectedRangeLast();if(!!i){Ei(this,tf).setSelectedRange(i);var o=new Map([["headers",null],["cells",null]]);Ei(this,ef)==="column-headers-only"?o.set("headers",Ei(this,tf).getMostBottomColumnHeadersRange()):(Ei(this,ef)==="with-column-headers"?o.set("headers",Ei(this,tf).getMostBottomColumnHeadersRange()):Ei(this,ef)==="with-column-group-headers"&&o.set("headers",Ei(this,tf).getAllColumnHeadersRange()),o.set("cells",Ei(this,tf).getCellsRange())),this.copyableRanges=Array.from(o.values()).filter(function(f){return f!==null}).map(function(f){var h=f.startRow,d=f.startCol,p=f.endRow,m=f.endCol;return{startRow:h,startCol:d,endRow:p,endCol:m}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var a=o.get("cells");if(a!==null&&a.isRangeTrimmed){var s=a.startRow,l=a.startCol,u=a.endRow,c=a.endCol;this.hot.runHooks("afterCopyLimit",u-s+1,c-l+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var i,o=(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.TEXTAREA;o?this.focusableElement.setFocusableElement(o):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var i;return(i=this.hot.getActiveEditor())===null||i===void 0?void 0:i.isOpened()}},{key:"populateValues",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!!i.length){for(var a=i.length,s=i[0].length,l=[],u=o.getTopStartCorner(),c=u.row,f=u.col,h=o.getBottomEndCorner(),d=h.row,p=h.col,m=c,g=f,v=c,S=f;l.length<a||m<=d;){var b=this.hot.getCellMeta(m,f),E=b.skipRowOnPaste,T=b.visualRow;if(m=T+1,E!==!0){v=T,g=f;for(var N=[],L=l.length%a;N.length<s||g<=p;){var V=this.hot.getCellMeta(c,g),B=V.skipColumnOnPaste,k=V.visualCol;if(g=k+1,B!==!0){S=k;var M=N.length%s;N.push(i[L][M])}}l.push(N)}}return this.hot.populateFromArray(c,f,l,void 0,void 0,"CopyPaste.paste",this.pasteMode),[c,f,v,S]}}},{key:"onCopy",value:function(i){if(!(!this.hot.isListening()&&!Ei(this,G0)||this.isEditorOpened())){this.setCopyableText(),_a(this,G0,!1);var o=this.getRangedData(this.copyableRanges),a=UBe(this,rH,YBe).call(this,this.copyableRanges),s=!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a);if(s){var l=ag(o);if(i&&i.clipboardData){var u=FD(o,this.hot.rootDocument);i.clipboardData.setData("text/plain",l),i.clipboardData.setData("text/html",[tH,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,a)}_a(this,ef,"cells-only"),i.preventDefault()}}},{key:"onCut",value:function(i){if(!(!this.hot.isListening()&&!Ei(this,Y0)||this.isEditorOpened())){this.setCopyableText(),_a(this,Y0,!1);var o=this.getRangedData(this.copyableRanges),a=!!this.hot.runHooks("beforeCut",o,this.copyableRanges);if(a){var s=ag(o);if(i&&i.clipboardData){var l=FD(o,this.hot.rootDocument);i.clipboardData.setData("text/plain",s),i.clipboardData.setData("text/html",[tH,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}i.preventDefault()}}},{key:"onPaste",value:function(i){if(!(!this.hot.isListening()||this.isEditorOpened())){i&&i.preventDefault&&i.preventDefault();var o;if(i&&typeof i.clipboardData<"u"){var a=Y8(i.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var s=A$e(a,this.hot.rootDocument);o=s.data}else o=i.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=lFe(o)),!(o&&o.length===0)&&this.hot.runHooks("beforePaste",o,this.copyableRanges)!==!1){var l=this.populateValues(o),u=OBe(l,4),c=u[0],f=u[1],h=u[2],d=u[3];this.hot.selectCell(c,f,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:"---------"},QHe(this)),Ei(this,fC)&&i.items.push(eBe(this)),Ei(this,hC)&&i.items.push(JHe(this)),Ei(this,dC)&&i.items.push(ZHe(this)),i.items.push(tBe(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&Gwe())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var i=this.hot.rootDocument.activeElement,o=this.hot.getActiveEditor();!o||i!==this.focusableElement.getFocusableElement()&&i!==o.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(qF(this.focusableElement),this.focusableElement=null),hu(qa(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return z0}},{key:"SETTING_KEYS",get:function(){return[z0].concat(zBe)}},{key:"PLUGIN_PRIORITY",get:function(){return WBe}}]),r}(jt);function YBe(t){for(var e=MQ(t),r=e.rows,n=0,i=0;i<r.length&&!(r[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function $Q(t,e){return"border_row".concat(t,"col").concat(e)}function Um(){return{width:1,color:"#000"}}function Xa(){return{hide:!0}}function KBe(){return{width:1,color:"#000",cornerVisible:!1}}function pC(t){if(He(t.start)||He(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(He(t.end)||He(t.right)){var r;t.end=(r=t.end)!==null&&r!==void 0?r:t.right}return delete t.left,delete t.right,t}function bm(t){return He(t.start)&&(t.left=t.start),He(t.end)&&(t.right=t.end),t}function mC(t,e){return{id:$Q(t,e),border:KBe(),row:t,col:e,top:Xa(),bottom:Xa(),start:Xa(),end:Xa()}}function qBe(t,e){return Nr(e,"border")&&e.border&&(t.border=e.border),Nr(e,"top")&&He(e.top)&&(e.top?(wt(e.top)||(e.top=Um()),t.top=e.top):(e.top=Xa(),t.top=e.top)),Nr(e,"bottom")&&He(e.bottom)&&(e.bottom?(wt(e.bottom)||(e.bottom=Um()),t.bottom=e.bottom):(e.bottom=Xa(),t.bottom=e.bottom)),Nr(e,"start")&&He(e.start)&&(e.start?(wt(e.start)||(e.start=Um()),t.start=e.start):(e.start=Xa(),t.start=e.start)),Nr(e,"end")&&He(e.end)&&(e.end?(wt(e.end)||(e.end=Um()),t.end=e.end):(e.end=Xa(),t.end=e.end)),t}function Rs(t,e){var r=!1;return Q(t.getSelectedRange(),function(n){n.forAll(function(i,o){if(!(i<0||o<0)){var a=t.getCellMeta(i,o).borders;if(a)if(e){if(!Nr(a[e],"hide")||a[e].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function z6(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function XBe(t){return t.some(function(e){return He(e.left)||He(e.right)})}function QBe(t){return t.some(function(e){return He(e.start)||He(e.end)})}var ZBe=new Map([["left","start"],["right","end"]]);function JBe(t){var e;return(e=ZBe.get(t))!==null&&e!==void 0?e:t}function eUe(t){return{key:"borders:bottom",name:function(){var r=this.getTranslatedPhrase(hx),n=Rs(this,"bottom");return n&&(r=z6(r)),r},callback:function(r,n){var i=Rs(this,"bottom");t.prepareBorder(n,"bottom",i)}}}function tUe(t){var e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var n=this.getTranslatedPhrase(dx),i=Rs(this,e);return i&&(n=z6(n)),n},callback:function(n,i){var o=Rs(this,e);t.prepareBorder(i,e,o)}}}function rUe(t){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(px)},callback:function(r,n){t.prepareBorder(n,"noBorders")},disabled:function(){return!Rs(this)}}}function nUe(t){var e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var n=this.getTranslatedPhrase(fx),i=Rs(this,e);return i&&(n=z6(n)),n},callback:function(n,i){var o=Rs(this,e);t.prepareBorder(i,e,o)}}}function iUe(t){return{key:"borders:top",name:function(){var r=this.getTranslatedPhrase(cx),n=Rs(this,"top");return n&&(r=z6(r)),r},callback:function(r,n){var i=Rs(this,"top");t.prepareBorder(n,"top",i)}}}function bd(t){return bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bd(t)}function nH(t,e){return lUe(t)||sUe(t,e)||aUe(t,e)||oUe()}function oUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aUe(t,e){if(!!t){if(typeof t=="string")return iH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iH(t,e)}}function iH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function sUe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function lUe(t){if(Array.isArray(t))return t}function uUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,DQ(n.key),n)}}function cUe(t,e,r){return e&&oH(t.prototype,e),r&&oH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function du(){return typeof Reflect<"u"&&Reflect.get?du=Reflect.get.bind():du=function(e,r,n){var i=fUe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},du.apply(this,arguments)}function fUe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Qa(t),t!==null););return t}function hUe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a7(t,e)}function a7(t,e){return a7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},a7(t,e)}function dUe(t){var e=mUe();return function(){var n=Qa(t),i;if(e){var o=Qa(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return pUe(this,i)}}function pUe(t,e){if(e&&(bd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LQ(t)}function LQ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function mUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qa(t){return Qa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qa(t)}function gUe(t,e,r){return e=DQ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DQ(t){var e=yUe(t,"string");return bd(e)==="symbol"?e:String(e)}function yUe(t,e){if(bd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var K0="customBorders",vUe=90,bUe=function(t){hUe(r,t);var e=dUe(r);function r(){var n;uUe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),gUe(LQ(n),"savedBorders",[]),n}return cUe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[K0]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(o){return i.onAfterContextMenuDefaultOptions(o)}),this.addHook("init",function(){return i.onAfterInit()}),du(Qa(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),du(Qa(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),du(Qa(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(i,o){var a=this,s=["top","bottom","start","end"],l=null;o&&(this.checkSettingsCohesion([o]),s=Object.keys(o),l=pC(o));var u=pd(i),c=Ey(u);Q(i,function(f){for(var h=c(f),d=nH(h,4),p=d[0],m=d[1],g=d[2],v=d[3],S=function(T){for(var N=function(B){Q(s,function(k){a.prepareBorderFromCustomAdded(T,B,l,JBe(k))})},L=m;L<=v;L+=1)N(L)},b=p;b<=g;b+=1)S(b)}),this.hot.view.render()}},{key:"getBorders",value:function(i){var o=this;if(!Array.isArray(i))return this.savedBorders;var a=pd(i),s=Ey(a),l=[];return Q(i,function(u){for(var c=s(u),f=nH(c,4),h=f[0],d=f[1],p=f[2],m=f[3],g=function(b){for(var E=function(L){Q(o.savedBorders,function(V){V.row===b&&V.col===L&&l.push(bm(V))})},T=d;T<=m;T+=1)E(T)},v=h;v<=p;v+=1)g(v)}),l}},{key:"clearBorders",value:function(i){var o=this;i?this.setBorders(i):(Q(this.savedBorders,function(a){o.clearBordersFromSelectionSettings(a.id),o.clearNullCellRange(),o.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(i,o){var a=this.checkSavedBorders(i);a||this.savedBorders.push(i);var s=this.hot._createCellRange(this.hot._createCellCoords(i.row,i.col)),l=this.checkCustomSelections(i,s,o);l||this.hot.selection.highlight.addCustomSelection({border:i,visualCellRange:s})}},{key:"prepareBorderFromCustomAdded",value:function(i,o,a,s){var l=this.hot.countRows(),u=this.hot.countCols();if(!(i>=l||o>=u)){var c=mC(i,o);a&&(c=qBe(c,a),Q(this.hot.selection.highlight.customSelections,function(f){if(c.id===f.settings.id)return Object.assign(f.settings,a),c.id=f.settings.id,c.top=f.settings.top,c.bottom=f.settings.bottom,c.start=f.settings.start,c.end=f.settings.end,!1})),this.hot.setCellMeta(i,o,"borders",bm(c)),this.insertBorderIntoSettings(c,s)}}},{key:"prepareBorderFromCustomAddedRange",value:function(i,o){var a=this,s=Math.min(i.to.row,this.hot.countRows()-1),l=Math.min(i.to.col,this.hot.countCols()-1);Ye(i.from.row,s,function(u){Ye(i.from.col,l,function(c){var f=mC(u,c),h=0;u===i.from.row&&Nr(o,"top")&&(h+=1,f.top=o.top),u===i.to.row&&Nr(o,"bottom")&&(h+=1,f.bottom=o.bottom),c===i.from.col&&Nr(o,"start")&&(h+=1,f.start=o.start),c===i.to.col&&Nr(o,"end")&&(h+=1,f.end=o.end),h>0&&(a.hot.setCellMeta(u,c,"borders",bm(f)),a.insertBorderIntoSettings(f))})})}},{key:"removeAllBorders",value:function(i,o){var a=$Q(i,o);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(i,o,"borders")}},{key:"setBorder",value:function(i,o,a,s){var l=this.hot.getCellMeta(i,o).borders;if(!l||l.border===void 0?l=mC(i,o):l=pC(l),s){l[a]=Xa();var u=this.countHide(l);if(u===4)this.removeAllBorders(i,o);else{var c=this.checkCustomSelectionsFromContextMenu(l,a,s);c||this.insertBorderIntoSettings(l),this.hot.setCellMeta(i,o,"borders",bm(l))}}else{l[a]=Um();var f=this.checkCustomSelectionsFromContextMenu(l,a,s);f||this.insertBorderIntoSettings(l),this.hot.setCellMeta(i,o,"borders",bm(l))}}},{key:"prepareBorder",value:function(i,o,a){var s=this;Q(i,function(l){var u=l.start,c=l.end;if(u.row===c.row&&u.col===c.col)o==="noBorders"?s.removeAllBorders(u.row,u.col):s.setBorder(u.row,u.col,o,a);else switch(o){case"noBorders":Ye(u.col,c.col,function(f){Ye(u.row,c.row,function(h){s.removeAllBorders(h,f)})});break;case"top":Ye(u.col,c.col,function(f){s.setBorder(u.row,f,o,a)});break;case"bottom":Ye(u.col,c.col,function(f){s.setBorder(c.row,f,o,a)});break;case"start":Ye(u.row,c.row,function(f){s.setBorder(f,u.col,o,a)});break;case"end":Ye(u.row,c.row,function(f){s.setBorder(f,c.col,o,a)});break}})}},{key:"createCustomBorders",value:function(i){var o=this;Q(i,function(a){var s=pC(a);a.range?o.prepareBorderFromCustomAddedRange(a.range,s):o.prepareBorderFromCustomAdded(a.row,a.col,s)})}},{key:"countHide",value:function(i){var o=i.top,a=i.bottom,s=i.start,l=i.end,u=[o,a,s,l];return Hn(u,function(c,f){var h=c;return f&&f.hide&&(h+=1),h},0)}},{key:"clearBordersFromSelectionSettings",value:function(i){var o=bt(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(i);o>-1&&this.hot.selection.highlight.customSelections[o].clear()}},{key:"clearNullCellRange",value:function(){var i=this;Q(this.hot.selection.highlight.customSelections,function(o,a){if(o.cellRange===null)return i.hot.selection.highlight.customSelections[a].destroy(),i.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var i=this;Q(this.savedBorders,function(o){i.clearBordersFromSelectionSettings(o.id),i.clearNullCellRange()})}},{key:"spliceBorder",value:function(i){var o=bt(this.savedBorders,function(a){return a.id}).indexOf(i);o>-1&&this.savedBorders.splice(o,1)}},{key:"checkSavedBorders",value:function(i){var o=this,a=!1,s=this.countHide(i);return s===4?(this.spliceBorder(i.id),a=!0):Q(this.savedBorders,function(l,u){if(i.id===l.id)return o.savedBorders[u]=i,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(i,o,a){var s=!1;return Q(this.hot.selection.highlight.customSelections,function(l){if(i.id===l.settings.id)return St(l.instanceBorders,function(u){u.toggleHiddenClass(o,a)}),s=!0,!1}),s}},{key:"checkCustomSelections",value:function(i,o,a){var s=this.countHide(i),l=!1;return s===4?(this.removeAllBorders(i.row,i.col),l=!0):Q(this.hot.selection.highlight.customSelections,function(u){if(i.id===u.settings.id)return u.visualCellRange=o,u.commit(),a&&St(u.instanceBorders,function(c){c.changeBorderStyle(a,i)}),l=!0,!1}),l}},{key:"changeBorderSettings",value:function(){var i=this.hot.getSettings()[K0];if(Array.isArray(i)){var o=Zn(i);this.checkSettingsCohesion(o),o.length||(this.savedBorders=o),this.createCustomBorders(o)}else i!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(i){var o=XBe(i),a=QBe(i);if(o&&a)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&o)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(i){!this.hot.getSettings()[K0]||i.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(ux)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[iUe(this),nUe(this),eUe(this),tUe(this),rUe(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){du(Qa(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return K0}},{key:"PLUGIN_PRIORITY",get:function(){return vUe}}]),r}(jt);function wd(t){return wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wd(t)}function wUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,RUe(n.key),n)}}function SUe(t,e,r){return e&&aH(t.prototype,e),r&&aH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function RUe(t){var e=EUe(t,"string");return wd(e)==="symbol"?e:String(e)}function EUe(t,e){if(wd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pu(){return typeof Reflect<"u"&&Reflect.get?pu=Reflect.get.bind():pu=function(e,r,n){var i=CUe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},pu.apply(this,arguments)}function CUe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Za(t),t!==null););return t}function _Ue(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s7(t,e)}function s7(t,e){return s7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},s7(t,e)}function TUe(t){var e=AUe();return function(){var n=Za(t),i;if(e){var o=Za(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return OUe(this,i)}}function OUe(t,e){if(e&&(wd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FQ(t)}function FQ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function AUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Za(t){return Za=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Za(t)}var sH="dragToScroll",xUe=100,IUe=function(t){_Ue(r,t);var e=TUe(r);function r(n){var i;return wUe(this,r),i=e.call(this,n),i.eventManager=new Er(FQ(i)),i.boundaries=null,i.callback=null,i.listening=!1,i}return SUe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[sH]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(o){return i.setupListening(o)}),this.addHook("afterOnCellCornerMouseDown",function(o){return i.setupListening(o)}),this.registerEvents(),pu(Za(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),pu(Za(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),pu(Za(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(i){this.boundaries=i}},{key:"setCallback",value:function(i){this.callback=i}},{key:"check",value:function(i,o){var a=0,s=0;o<this.boundaries.top?s=o-this.boundaries.top:o>this.boundaries.bottom&&(s=o-this.boundaries.bottom),i<this.boundaries.left?a=i-this.boundaries.left:i>this.boundaries.right&&(a=i-this.boundaries.right),this.callback(a,s)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var i=this,o=this.hot.rootWindow,a=o;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return i.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return i.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(s){return i.onMouseMove(s)}),a=Z2(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(i){if(!zu(i)){var o=this.hot.view._wt.wtTable.holder;o!==this.hot.rootWindow&&(this.setBoundaries(o.getBoundingClientRect()),this.setCallback(function(a,s){a<0?o.scrollLeft-=50:a>0&&(o.scrollLeft+=50),s<0?o.scrollTop-=20:s>0&&(o.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(i){!this.isListening()||this.check(i.clientX,i.clientY)}},{key:"destroy",value:function(){pu(Za(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return sH}},{key:"PLUGIN_PRIORITY",get:function(){return xUe}}]),r}(jt);function Sd(t){return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sd(t)}function MUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,PUe(n.key),n)}}function NUe(t,e,r){return e&&lH(t.prototype,e),r&&lH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function PUe(t){var e=kUe(t,"string");return Sd(e)==="symbol"?e:String(e)}function kUe(t,e){if(Sd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mu(){return typeof Reflect<"u"&&Reflect.get?mu=Reflect.get.bind():mu=function(e,r,n){var i=$Ue(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},mu.apply(this,arguments)}function $Ue(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ja(t),t!==null););return t}function LUe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l7(t,e)}function l7(t,e){return l7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},l7(t,e)}function DUe(t){var e=HUe();return function(){var n=Ja(t),i;if(e){var o=Ja(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return FUe(this,i)}}function FUe(t,e){if(e&&(Sd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HQ(t)}function HQ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function HUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ja(t){return Ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ja(t)}Ue.getSingleton().register("afterDropdownMenuDefaultOptions");Ue.getSingleton().register("beforeDropdownMenuShow");Ue.getSingleton().register("afterDropdownMenuShow");Ue.getSingleton().register("afterDropdownMenuHide");Ue.getSingleton().register("afterDropdownMenuExecute");var gC="dropdownMenu",BUe=230,yC="changeType",BQ=function(t){LUe(r,t);var e=DUe(r);function r(n){var i;return MUe(this,r),i=e.call(this,n),i.eventManager=new Er(HQ(i)),i.commandExecutor=new HX(i.hot),i.itemsFactory=null,i.menu=null,i.hot.addHook("afterGetColHeader",function(o,a){return i.onAfterGetColHeader(o,a)}),i}return NUe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[gC]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.itemsFactory=new jX(this.hot,r.DEFAULT_ITEMS);var o=this.hot.getSettings()[gC],a={items:this.itemsFactory.getItems(o)};this.registerEvents(),typeof o.callback=="function"&&this.commandExecutor.setCommonCallback(o.callback),mu(Ja(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){i.hot.runHooks("afterDropdownMenuDefaultOptions",a),i.itemsFactory.setPredefinedItems(a.items);var s=i.itemsFactory.getItems(o);i.menu&&i.menu.destroy(),i.menu=new nI(i.hot,{className:"htDropdownMenu",keepInViewport:!0,container:o.uiContainer||i.hot.rootDocument.body}),i.hot.runHooks("beforeDropdownMenuSetItems",s),i.menu.setMenuItems(s),i.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),i.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),i.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),i.menu.addLocalHook("executeCommand",function(){for(var l,u=arguments.length,c=new Array(u),f=0;f<u;f++)c[f]=arguments[f];return(l=i.executeCommand).call.apply(l,[i].concat(c))}),Q(s,function(l){return i.commandExecutor.registerCommand(l.key,l)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),mu(Ja(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),mu(Ja(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(o){return i.onTableClick(o)})}},{key:"open",value:function(i){!this.menu||(this.menu.open(),i.width&&this.menu.setOffset("left",i.width),this.menu.setPosition(i))}},{key:"close",value:function(){!this.menu||this.menu.close()}},{key:"executeCommand",value:function(i){for(var o,a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(o=this.commandExecutor).execute.apply(o,[i].concat(s))}},{key:"setListening",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(i?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(i){if(i.stopPropagation(),at(i.target,yC)&&!this.menu.isOpened()){var o=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),u=l.top,c=l.left;o=u,a=c}var f=i.target.getBoundingClientRect();this.open({left:f.left+a,top:f.top+i.target.offsetHeight+3+o,width:f.width,height:f.height})}}},{key:"onAfterGetColHeader",value:function(i,o){var a=o.parentNode;if(!!a){var s=a.parentNode.childNodes,l=Array.prototype.indexOf.call(s,a);if(!(i<0||l!==s.length-1)){var u=o.querySelector(".".concat(yC));if(!(this.enabled&&u)){if(!this.enabled){u&&u.parentNode.removeChild(u);return}var c=this.hot.rootDocument.createElement("button");c.className=yC,c.type="button",c.onclick=function(){return!1},o.firstChild.insertBefore(c,o.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),mu(Ja(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return gC}},{key:"PLUGIN_PRIORITY",get:function(){return BUe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[D1,F1,vt,B1,vt,P6,vt,H1,vt,ji]}}]),r}(jt);BQ.SEPARATOR={name:vt};function nv(t){return nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nv(t)}function UUe(t,e){return zUe(t)||WUe(t,e)||jUe(t,e)||VUe()}function VUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jUe(t,e){if(!!t){if(typeof t=="string")return uH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uH(t,e)}}function uH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function WUe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function zUe(t){if(Array.isArray(t))return t}function GUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,KUe(n.key),n)}}function YUe(t,e,r){return e&&cH(t.prototype,e),r&&cH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function KUe(t){var e=qUe(t,"string");return nv(e)==="symbol"?e:String(e)}function qUe(t,e){if(nv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(nv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var XUe=function(){function t(e){GUe(this,t),this.hot=e,this.options={}}return YUe(t,[{key:"setOptions",value:function(r){this.options=r}},{key:"getData",value:function(){var r=this,n=this._getDataRange(),i=n.startRow,o=n.startCol,a=n.endRow,s=n.endCol,l=this.options,u=[];return Ye(i,a,function(c){var f=[];!l.exportHiddenRows&&r._isHiddenRow(c)||(Ye(o,s,function(h){!l.exportHiddenColumns&&r._isHiddenColumn(h)||f.push(r.hot.getDataAtCell(c,h))}),u.push(f))}),u}},{key:"getRowHeaders",value:function(){var r=this,n=[];if(this.options.rowHeaders){var i=this._getDataRange(),o=i.startRow,a=i.endRow,s=this.hot.getRowHeader();Ye(o,a,function(l){!r.options.exportHiddenRows&&r._isHiddenRow(l)||n.push(s[l])})}return n}},{key:"getColumnHeaders",value:function(){var r=this,n=[];if(this.options.columnHeaders){var i=this._getDataRange(),o=i.startCol,a=i.endCol,s=this.hot.getColHeader();Ye(o,a,function(l){!r.options.exportHiddenColumns&&r._isHiddenColumn(l)||n.push(s[l])})}return n}},{key:"_getDataRange",value:function(){var r=this.hot.countCols()-1,n=this.hot.countRows()-1,i=UUe(this.options.range,4),o=i[0],a=o===void 0?0:o,s=i[1],l=s===void 0?0:s,u=i[2],c=u===void 0?n:u,f=i[3],h=f===void 0?r:f;return a=Math.max(a,0),l=Math.max(l,0),c=Math.min(c,n),h=Math.min(h,r),{startRow:a,startCol:l,endRow:c,endCol:h}}},{key:"_isHiddenRow",value:function(r){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(r))}},{key:"_isHiddenColumn",value:function(r){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(r))}}]),t}();const QUe=XUe;function iv(t){return iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iv(t)}function ZUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,eVe(n.key),n)}}function JUe(t,e,r){return e&&fH(t.prototype,e),r&&fH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function eVe(t){var e=tVe(t,"string");return iv(e)==="symbol"?e:String(e)}function tVe(t,e){if(iv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(iv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var rVe=function(){function t(e,r){ZUe(this,t),this.dataProvider=e,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return JUe(t,[{key:"_mergeOptions",value:function(r){var n=di(this.constructor.DEFAULT_OPTIONS),i=new Date;return n=Jr(di(t.DEFAULT_OPTIONS),n),n=Jr(n,r),n.filename=LK(n.filename,{YYYY:i.getFullYear(),MM:"".concat(i.getMonth()+1).padStart(2,"0"),DD:"".concat(i.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),t}();const nVe=rVe;function Rd(t){return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rd(t)}function iVe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aVe(n.key),n)}}function oVe(t,e,r){return e&&hH(t.prototype,e),r&&hH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function aVe(t){var e=sVe(t,"string");return Rd(e)==="symbol"?e:String(e)}function sVe(t,e){if(Rd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lVe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u7(t,e)}function u7(t,e){return u7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},u7(t,e)}function uVe(t){var e=hVe();return function(){var n=Uw(t),i;if(e){var o=Uw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return cVe(this,i)}}function cVe(t,e){if(e&&(Rd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fVe(t)}function fVe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Uw(t){return Uw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Uw(t)}var dVe=String.fromCharCode(13),pVe=String.fromCharCode(34),mVe=String.fromCharCode(10),gVe=function(t){lVe(r,t);var e=uVe(r);function r(){return iVe(this,r),e.apply(this,arguments)}return oVe(r,[{key:"export",value:function(){var i=this,o=this.options,a=this.dataProvider.getData(),s=this.dataProvider.getColumnHeaders(),l=s.length>0,u=this.dataProvider.getRowHeaders(),c=u.length>0,f=o.bom?String.fromCharCode(65279):"";return l&&(s=bt(s,function(h){return i._escapeCell(h,!0)}),c&&(f+=o.columnDelimiter),f+=s.join(o.columnDelimiter),f+=o.rowDelimiter),Q(a,function(h,d){d>0&&(f+=o.rowDelimiter),c&&(f+=i._escapeCell(u[d])+o.columnDelimiter),f+=h.map(function(p){return i._escapeCell(p)}).join(o.columnDelimiter)}),f}},{key:"_escapeCell",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=Vr(i);return a!==""&&(o||a.indexOf(dVe)>=0||a.indexOf(pVe)>=0||a.indexOf(mVe)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(nVe);const yVe=gVe;function ov(t){return ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ov(t)}function vVe(t,e,r){return e=bVe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bVe(t){var e=wVe(t,"string");return ov(e)==="symbol"?e:String(e)}function wVe(t,e){if(ov(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ov(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var SVe="csv",c7=vVe({},SVe,yVe);function RVe(t,e,r){return typeof c7[t]=="function"?new c7[t](e,r):null}function Ed(t){return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ed(t)}function EVe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_Ve(n.key),n)}}function CVe(t,e,r){return e&&dH(t.prototype,e),r&&dH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _Ve(t){var e=TVe(t,"string");return Ed(e)==="symbol"?e:String(e)}function TVe(t,e){if(Ed(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OVe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f7(t,e)}function f7(t,e){return f7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},f7(t,e)}function AVe(t){var e=MVe();return function(){var n=Vw(t),i;if(e){var o=Vw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return xVe(this,i)}}function xVe(t,e){if(e&&(Ed(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IVe(t)}function IVe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function MVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vw(t){return Vw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vw(t)}var NVe="exportFile",PVe=240,kVe=function(t){OVe(r,t);var e=AVe(r);function r(){return EVe(this,r),e.apply(this,arguments)}return CVe(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(i,o).export()}},{key:"exportAsBlob",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(i,o))}},{key:"downloadFile",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,s=a.rootDocument,l=a.rootWindow,u=this._createTypeFormatter(i,o),c=this._createBlob(u),f=l.URL||l.webkitURL,h=s.createElement("a"),d="".concat(u.options.filename,".").concat(u.options.fileExtension);if(h.download!==void 0){var p=f.createObjectURL(c);h.style.display="none",h.setAttribute("href",p),h.setAttribute("download",d),s.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),s.body.removeChild(h),setTimeout(function(){f.revokeObjectURL(p)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(c,d)}},{key:"_createTypeFormatter",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!c7[i])throw new Error('Export format type "'.concat(i,'" is not supported.'));return RVe(i,new QUe(this.hot),o)}},{key:"_createBlob",value:function(i){var o=null;return typeof Blob<"u"&&(o=new Blob([i.export()],{type:"".concat(i.options.mimeType,";charset=").concat(i.options.encoding)})),o}}],[{key:"PLUGIN_KEY",get:function(){return NVe}},{key:"PLUGIN_PRIORITY",get:function(){return PVe}}]),r}(jt);function av(t){return av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},av(t)}function $Ve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,DVe(n.key),n)}}function LVe(t,e,r){return e&&pH(t.prototype,e),r&&pH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function DVe(t){var e=FVe(t,"string");return av(e)==="symbol"?e:String(e)}function FVe(t,e){if(av(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(av(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var UQ=function(){function t(e,r){var n=r.id,i=r.stateless,o=i===void 0?!0:i;$Ve(this,t),this.hot=e,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=o?null:this.hot.columnIndexMapper.registerMap(this.stateId,new x6)}return LVe(t,[{key:"reset",value:function(){Q(this.elements,function(r){return r.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(r){this.state&&this.setState(this.state.getValueAtIndex(r))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(r){this.state&&this.state.setValueAtIndex(r,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Q(this.elements,function(r){return r.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),t}();ir(UQ,Si);const G6=UQ;var sv={};function pl(t,e){if(!sv[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));var r=sv[t],n=r.condition,i=r.descriptor,o=e;return i.inputValuesDecorator&&(o=i.inputValuesDecorator(o)),function(a){return n.apply(a.meta.instance,[].concat([a],[o]))}}function gu(t){if(!sv[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));return sv[t].descriptor}function Yr(t,e,r){r.key=t,sv[t]={condition:e,descriptor:r}}var hn="none";function HVe(){return!0}Yr(hn,HVe,{name:M6,inputsCount:0,showOperators:!1});var sg="empty";function BVe(t){return an(t.value)}Yr(sg,BVe,{name:Sx,inputsCount:0,showOperators:!0});var u2="not_empty";function UVe(t,e){return!pl(sg,e)(t)}Yr(u2,UVe,{name:Rx,inputsCount:0,showOperators:!0});function VVe(t,e){return GVe(t)||zVe(t,e)||WVe(t,e)||jVe()}function jVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WVe(t,e){if(!!t){if(typeof t=="string")return mH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mH(t,e)}}function mH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zVe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function GVe(t){if(Array.isArray(t))return t}var lg="eq";function YVe(t,e){var r=VVe(e,1),n=r[0];return Vr(t.value).toLocaleLowerCase(t.meta.locale)===Vr(n)}Yr(lg,YVe,{name:Ex,inputsCount:1,showOperators:!0});var c2="neq";function KVe(t,e){return!pl(lg,e)(t)}Yr(c2,KVe,{name:Cx,inputsCount:1,showOperators:!0});function qVe(t,e){return JVe(t)||ZVe(t,e)||QVe(t,e)||XVe()}function XVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QVe(t,e){if(!!t){if(typeof t=="string")return gH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gH(t,e)}}function gH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ZVe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function JVe(t){if(Array.isArray(t))return t}var VQ="gt";function eje(t,e){var r=qVe(e,1),n=r[0],i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}Yr(VQ,eje,{name:xx,inputsCount:1,showOperators:!0});function tje(t,e){return oje(t)||ije(t,e)||nje(t,e)||rje()}function rje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nje(t,e){if(!!t){if(typeof t=="string")return yH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yH(t,e)}}function yH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ije(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function oje(t){if(Array.isArray(t))return t}var jQ="gte";function aje(t,e){var r=tje(e,1),n=r[0],i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}Yr(jQ,aje,{name:Ix,inputsCount:1,showOperators:!0});function sje(t,e){return fje(t)||cje(t,e)||uje(t,e)||lje()}function lje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uje(t,e){if(!!t){if(typeof t=="string")return vH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vH(t,e)}}function vH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function cje(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function fje(t){if(Array.isArray(t))return t}var WQ="lt";function hje(t,e){var r=sje(e,1),n=r[0],i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}Yr(WQ,hje,{name:Mx,inputsCount:1,showOperators:!0});function dje(t,e){return yje(t)||gje(t,e)||mje(t,e)||pje()}function pje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mje(t,e){if(!!t){if(typeof t=="string")return bH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bH(t,e)}}function bH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function gje(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function yje(t){if(Array.isArray(t))return t}var zQ="lte";function vje(t,e){var r=dje(e,1),n=r[0],i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}Yr(zQ,vje,{name:Nx,inputsCount:1,showOperators:!0});function bje(t,e){return Eje(t)||Rje(t,e)||Sje(t,e)||wje()}function wje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sje(t,e){if(!!t){if(typeof t=="string")return wH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wH(t,e)}}function wH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Rje(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function Eje(t){if(Array.isArray(t))return t}var oI="date_after";function Cje(t,e){var r=bje(e,1),n=r[0],i=qt(t.value,t.meta.dateFormat),o=qt(n,t.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)>=0}Yr(oI,Cje,{name:$x,inputsCount:1,showOperators:!0});function _je(t,e){return xje(t)||Aje(t,e)||Oje(t,e)||Tje()}function Tje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oje(t,e){if(!!t){if(typeof t=="string")return SH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SH(t,e)}}function SH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Aje(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function xje(t){if(Array.isArray(t))return t}var aI="date_before";function Ije(t,e){var r=_je(e,1),n=r[0],i=qt(t.value,t.meta.dateFormat),o=qt(n,t.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)<=0}Yr(aI,Ije,{name:Lx,inputsCount:1,showOperators:!0});function Mje(t,e){return $je(t)||kje(t,e)||Pje(t,e)||Nje()}function Nje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pje(t,e){if(!!t){if(typeof t=="string")return RH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RH(t,e)}}function RH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function kje(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function $je(t){if(Array.isArray(t))return t}var jw="between";function Lje(t,e){var r=Mje(e,2),n=r[0],i=r[1],o=n,a=i;if(t.meta.type==="numeric"){var s=parseFloat(o,10),l=parseFloat(a,10);o=Math.min(s,l),a=Math.max(s,l)}else if(t.meta.type==="date"){var u=pl(aI,[a]),c=pl(oI,[o]);return u(t)&&c(t)}return t.value>=o&&t.value<=a}Yr(jw,Lje,{name:Px,inputsCount:2,showOperators:!0});var GQ="not_between";function Dje(t,e){return!pl(jw,e)(t)}Yr(GQ,Dje,{name:kx,inputsCount:2,showOperators:!0});function Fje(t,e){return Vje(t)||Uje(t,e)||Bje(t,e)||Hje()}function Hje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bje(t,e){if(!!t){if(typeof t=="string")return EH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EH(t,e)}}function EH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Uje(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function Vje(t){if(Array.isArray(t))return t}var YQ="begins_with";function jje(t,e){var r=Fje(e,1),n=r[0];return Vr(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Vr(n))}Yr(YQ,jje,{name:_x,inputsCount:1,showOperators:!0});var Wje=tt,KQ=b1,zje=ya.f,Gje=bc,CH=Gr,Yje=B8,Kje=bi,qje=U8,_H=KQ("".endsWith),Xje=KQ("".slice),Qje=Math.min,qQ=qje("endsWith"),Zje=!qQ&&!!function(){var t=zje(String.prototype,"endsWith");return t&&!t.writable}();Wje({target:"String",proto:!0,forced:!Zje&&!qQ},{endsWith:function(e){var r=CH(Kje(this));Yje(e);var n=arguments.length>1?arguments[1]:void 0,i=r.length,o=n===void 0?i:Qje(Gje(n),i),a=CH(e);return _H?_H(r,a,o):Xje(r,o-a.length,o)===a}});function Jje(t,e){return nWe(t)||rWe(t,e)||tWe(t,e)||eWe()}function eWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tWe(t,e){if(!!t){if(typeof t=="string")return TH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TH(t,e)}}function TH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function rWe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function nWe(t){if(Array.isArray(t))return t}var XQ="ends_with";function iWe(t,e){var r=Jje(e,1),n=r[0];return Vr(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Vr(n))}Yr(XQ,iWe,{name:Tx,inputsCount:1,showOperators:!0});function oWe(t,e){return uWe(t)||lWe(t,e)||sWe(t,e)||aWe()}function aWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sWe(t,e){if(!!t){if(typeof t=="string")return OH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OH(t,e)}}function OH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function lWe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function uWe(t){if(Array.isArray(t))return t}var sI="contains";function cWe(t,e){var r=oWe(e,1),n=r[0];return Vr(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Vr(n))>=0}Yr(sI,cWe,{name:Ox,inputsCount:1,showOperators:!0});var QQ="not_contains";function fWe(t,e){return!pl(sI,e)(t)}Yr(QQ,fWe,{name:Ax,inputsCount:1,showOperators:!0});var ZQ="date_tomorrow";function hWe(t){var e=qt(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(qt().subtract(-1,"days").startOf("day"),"d"):!1}Yr(ZQ,hWe,{name:Fx,inputsCount:0});var JQ="date_today";function dWe(t){var e=qt(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(qt().startOf("day"),"d"):!1}Yr(JQ,dWe,{name:Dx,inputsCount:0});var eZ="date_yesterday";function pWe(t){var e=qt(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(qt().subtract(1,"days").startOf("day"),"d"):!1}Yr(eZ,pWe,{name:Hx,inputsCount:0});awe();function mWe(t,e){var r=t;return r===""&&(r="(".concat(e,")")),r}var h7=new Set([1]).has(1),gWe=h7&&typeof Array.from=="function";function V1(t){var e=t;return h7&&(e=new Set(e)),function(r){var n;return h7?n=e.has(r):n=!!~e.indexOf(r),n}}function tZ(t){return t==null?"":t}function d7(t){var e=t;return gWe?e=Array.from(new Set(e)):e=bK(e),e=e.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),e}function AH(t,e,r,n){var i=[],o=t===e,a;return o||(a=V1(e)),Q(t,function(s){var l=!1;(o||a(s))&&(l=!0);var u={checked:l,value:s,visualValue:mWe(s,r)};n&&n(u),i.push(u)}),i}function rZ(t,e){return wWe(t)||bWe(t,e)||vWe(t,e)||yWe()}function yWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vWe(t,e){if(!!t){if(typeof t=="string")return xH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xH(t,e)}}function xH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function bWe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function wWe(t){if(Array.isArray(t))return t}var yu="by_value";function SWe(t,e){var r=rZ(e,1),n=r[0];return n(t.value)}Yr(yu,SWe,{name:"By value",inputsCount:0,inputValuesDecorator:function(e){var r=rZ(e,1),n=r[0];return[V1(n)]},showOperators:!1});var lv={};function RWe(t){if(!lv[t])throw Error('Operation with id "'.concat(t,'" does not exist.'));var e=lv[t].func;return function(r,n){return e(r,n)}}function EWe(t){return lv[t].name}function lI(t,e,r){lv[t]={name:e,func:r}}var rl="conjunction",CWe=Vx;function _We(t,e){return t.every(function(r){return r.func(e)})}lI(rl,CWe,_We);var Ww="disjunction",TWe=N6;function OWe(t,e){return t.some(function(r){return r.func(e)})}lI(Ww,TWe,OWe);var uI="disjunctionWithExtraCondition",AWe=N6;function xWe(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(function(r){return r.func(e)})&&t[t.length-1].func(e)}lI(uI,AWe,xWe);function uv(t){return uv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uv(t)}var wm;function vC(t,e,r){return e=IWe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IWe(t){var e=MWe(t,"string");return uv(e)==="symbol"?e:String(e)}function MWe(t,e){if(uv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(uv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var NWe="numeric",nZ="text",PWe="date",IH=(wm={},vC(wm,NWe,[hn,vt,sg,u2,vt,lg,c2,vt,VQ,jQ,WQ,zQ,jw,GQ]),vC(wm,nZ,[hn,vt,sg,u2,vt,lg,c2,vt,YQ,XQ,vt,sI,QQ]),vC(wm,PWe,[hn,vt,sg,u2,vt,lg,c2,vt,aI,oI,jw,vt,ZQ,JQ,eZ]),wm);function kWe(t){var e=[],r=t;return IH[r]||(r=nZ),Q(IH[r],function(n){var i;n===vt?i={name:vt}:i=di(gu(n)),e.push(i)}),e}function cv(t){return cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cv(t)}function $We(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function MH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,DWe(n.key),n)}}function LWe(t,e,r){return e&&MH(t.prototype,e),r&&MH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function DWe(t){var e=FWe(t,"string");return cv(e)==="symbol"?e:String(e)}function FWe(t,e){if(cv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(cv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bC="built",wC="building",NH=["click","input","keydown","keypress","keyup","focus","blur","change"],iZ=function(){function t(e,r){$We(this,t),this.hot=e,this.eventManager=new Er(this),this.options=Jr(t.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return LWe(t,[{key:"setValue",value:function(r){this.options.value=r,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===wC?this._element:this.buildState===bC?(this.update(),this._element):(this.buildState=wC,this.build(),this.buildState=bC,this._element)}},{key:"isBuilt",value:function(){return this.buildState===bC}},{key:"translateIfPossible",value:function(r){return typeof r=="string"&&r.startsWith(ti)?this.hot.getTranslatedPhrase(r):r}},{key:"build",value:function(){var r=this,n=function(a,s){r.eventManager.addEventListener(a,s,function(l){return r.runLocalHooks(s,l,r)})};if(this.buildState||(this.buildState=wC),this.options.className&&Re(this._element,this.options.className),this.options.children.length)Q(this.options.children,function(o){return r._element.appendChild(o.element)});else if(this.options.wrapIt){var i=this.hot.rootDocument.createElement(this.options.tagName);St(this.options,function(o,a){i[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(i[a]=r.translateIfPossible(o))}),this._element.appendChild(i),Q(NH,function(o){return n(i,o)})}else Q(NH,function(o){return n(r._element,o)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return di({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),t}();ir(iZ,Si);const nl=iZ;function Cd(t){return Cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cd(t)}function HWe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,UWe(n.key),n)}}function BWe(t,e,r){return e&&PH(t.prototype,e),r&&PH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function UWe(t){var e=VWe(t,"string");return Cd(e)==="symbol"?e:String(e)}function VWe(t,e){if(Cd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function f2(){return typeof Reflect<"u"&&Reflect.get?f2=Reflect.get.bind():f2=function(e,r,n){var i=jWe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},f2.apply(this,arguments)}function jWe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=_d(t),t!==null););return t}function WWe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p7(t,e)}function p7(t,e){return p7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},p7(t,e)}function zWe(t){var e=YWe();return function(){var n=_d(t),i;if(e){var o=_d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return GWe(this,i)}}function GWe(t,e){if(e&&(Cd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oZ(t)}function oZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function YWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _d(t){return _d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_d(t)}var q0=new WeakMap,KWe=function(t){WWe(r,t);var e=zWe(r);function r(n,i){var o;return HWe(this,r),o=e.call(this,n,Jr(r.DEFAULTS,i)),q0.set(oZ(o),{}),o.registerHooks(),o}return BWe(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()}),this.addLocalHook("keyup",function(o){return i.onKeyup(o)})}},{key:"build",value:function(){f2(_d(r.prototype),"build",this).call(this);var i=q0.get(this),o=this.hot.rootDocument.createElement("div");i.input=this._element.firstChild,Re(this._element,"htUIInput"),Re(o,"htUIInputIcon"),this._element.appendChild(o),this.update()}},{key:"update",value:function(){if(!!this.isBuilt()){var i=q0.get(this).input;i.type=this.options.type,i.placeholder=this.translateIfPossible(this.options.placeholder),i.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&q0.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(i){this.options.value=i.target.value}}],[{key:"DEFAULTS",get:function(){return di({placeholder:"",type:"text",tagName:"input"})}}]),r}(nl);const Yf=KWe;function Td(t){return Td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Td(t)}function qWe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,QWe(n.key),n)}}function XWe(t,e,r){return e&&kH(t.prototype,e),r&&kH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function QWe(t){var e=ZWe(t,"string");return Td(e)==="symbol"?e:String(e)}function ZWe(t,e){if(Td(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kf(){return typeof Reflect<"u"&&Reflect.get?Kf=Reflect.get.bind():Kf=function(e,r,n){var i=JWe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Kf.apply(this,arguments)}function JWe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=il(t),t!==null););return t}function eze(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m7(t,e)}function m7(t,e){return m7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},m7(t,e)}function tze(t){var e=nze();return function(){var n=il(t),i;if(e){var o=il(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return rze(this,i)}}function rze(t,e){if(e&&(Td(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aZ(t)}function aZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function il(t){return il=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},il(t)}var X0=new WeakMap,ize=function(t){eze(r,t);var e=tze(r);function r(n,i){var o;return qWe(this,r),o=e.call(this,n,Jr(r.DEFAULTS,i)),X0.set(aZ(o),{}),o.menu=null,o.items=[],o.registerHooks(),o}return XWe(r,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()})}},{key:"setItems",value:function(i){this.items=this.translateNames(i),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(i){var o=this;return Q(i,function(a){a.name=o.translateIfPossible(a.name)}),i}},{key:"build",value:function(){var i=this;Kf(il(r.prototype),"build",this).call(this),this.menu=new nI(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var o=new nl(this.hot,{className:"htUISelectCaption"}),a=new nl(this.hot,{className:"htUISelectDropdown"}),s=X0.get(this);s.caption=o,s.captionElement=o.element,s.dropdown=a,Q([o,a],function(l){return i._element.appendChild(l.element)}),this.menu.addLocalHook("select",function(l){return i.onMenuSelect(l)}),this.menu.addLocalHook("afterClose",function(){return i.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(!!this.isBuilt()){var i;this.options.value?i=this.options.value.name:i=this.menu.hot.getTranslatedPhrase(M6),X0.get(this).captionElement.textContent=i,Kf(il(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var i=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?i.left-5:i.left-31,top:i.top-1,width:i.width,height:i.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(i){i.name!==vt&&(this.options.value=i,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var i=X0.get(this),o=i.caption,a=i.dropdown;o&&o.destroy(),a&&a.destroy(),Kf(il(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return di({className:"htUISelect",wrapIt:!1})}}]),r}(nl);const $H=ize;function Od(t){return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Od(t)}function oze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sze(n.key),n)}}function aze(t,e,r){return e&&LH(t.prototype,e),r&&LH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function sze(t){var e=lze(t,"string");return Od(e)==="symbol"?e:String(e)}function lze(t,e){if(Od(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function h2(){return typeof Reflect<"u"&&Reflect.get?h2=Reflect.get.bind():h2=function(e,r,n){var i=uze(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},h2.apply(this,arguments)}function uze(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ad(t),t!==null););return t}function cze(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g7(t,e)}function g7(t,e){return g7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},g7(t,e)}function fze(t){var e=pze();return function(){var n=Ad(t),i;if(e){var o=Ad(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return hze(this,i)}}function hze(t,e){if(e&&(Od(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dze(t)}function dze(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ad(t){return Ad=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ad(t)}var mze=function(t){cze(r,t);var e=fze(r);function r(n,i){var o;return oze(this,r),o=e.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.addSeparator=i.addSeparator,o.elements.push(new $H(o.hot,{menuContainer:i.menuContainer})),o.elements.push(new Yf(o.hot,{placeholder:Kx})),o.elements.push(new Yf(o.hot,{placeholder:qx})),o.registerHooks(),o}return aze(r,[{key:"registerHooks",value:function(){var i=this;this.getSelectElement().addLocalHook("select",function(o){return i.onConditionSelect(o)}),this.getSelectElement().addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),Q(this.getInputElements(),function(o){o.addLocalHook("keydown",function(a){return i.onInputKeyDown(a)})})}},{key:"setState",value:function(i){var o=this;if(this.reset(),!!i){var a=di(i.command);a.name.startsWith(Cr)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),Q(i.args,function(s,l){if(l>a.inputsCount-1)return!1;var u=o.getInputElement(l);u.setValue(s),u[a.inputsCount>l?"show":"hide"](),l||setTimeout(function(){return u.focus()},10)})}}},{key:"getState",value:function(){var i=this.getSelectElement().getValue()||gu(hn),o=[];return Q(this.getInputElements(),function(a,s){i.inputsCount>s&&o.push(a.getValue())}),{command:i,args:o}}},{key:"updateState",value:function(i,o){var a=gu(i?i.name:hn);this.state.setValueAtIndex(o,{command:a,args:i?i.args:[]}),i||Q(this.getInputElements(),function(s){return s.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof $H})[0]}},{key:"getInputElement",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[i]}},{key:"getInputElements",value:function(){return this.elements.filter(function(i){return i instanceof Yf})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(a,s,l,u,c,f){Re(s.parentNode,"htFiltersMenuCondition"),i.addSeparator&&Re(s.parentNode,"border");var h=i.hot.rootDocument.createElement("div");return Re(h,"htFiltersMenuLabel"),h.textContent=f,s.appendChild(h),s.parentNode.hasAttribute("ghost-table")||Q(i.elements,function(d){return s.appendChild(d.element)}),s}}}},{key:"reset",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn(),o=[gu(hn)];if(i!==null){var a=i.visualIndex;o=kWe(this.hot.getDataType(0,a,this.hot.countRows(),a))}Q(this.getInputElements(),function(s){return s.hide()}),this.getSelectElement().setItems(o),h2(Ad(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(o[0])}},{key:"onConditionSelect",value:function(i){Q(this.getInputElements(),function(o,a){o[i.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return o.focus()},10)}),this.runLocalHooks("change",i)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(i){Ig(i.keyCode,"ENTER")?(this.runLocalHooks("accept"),la(i)):Ig(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),la(i))}}]),r}(G6);const SC=mze;function xd(t){return xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xd(t)}function gze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function DH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vze(n.key),n)}}function yze(t,e,r){return e&&DH(t.prototype,e),r&&DH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vze(t){var e=bze(t,"string");return xd(e)==="symbol"?e:String(e)}function bze(t,e){if(xd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(xd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function d2(){return typeof Reflect<"u"&&Reflect.get?d2=Reflect.get.bind():d2=function(e,r,n){var i=wze(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},d2.apply(this,arguments)}function wze(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Id(t),t!==null););return t}function Sze(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y7(t,e)}function y7(t,e){return y7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},y7(t,e)}function Rze(t){var e=Cze();return function(){var n=Id(t),i;if(e){var o=Id(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Eze(this,i)}}function Eze(t,e){if(e&&(xd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sZ(t)}function sZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Cze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Id(t){return Id=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Id(t)}var Q0=new WeakMap,_ze=function(t){Sze(r,t);var e=Rze(r);function r(n,i){var o;return gze(this,r),o=e.call(this,n,Jr(r.DEFAULTS,i)),Q0.set(sZ(o),{}),o}return yze(r,[{key:"build",value:function(){d2(Id(r.prototype),"build",this).call(this);var i=Q0.get(this);i.input=this._element.firstChild;var o=this.hot.rootDocument.createElement("label");o.textContent=this.translateIfPossible(this.options.label.textContent),o.htmlFor=this.translateIfPossible(this.options.label.htmlFor),i.label=o,this._element.appendChild(o),this.update()}},{key:"update",value:function(){if(!!this.isBuilt()){var i=Q0.get(this);i.input.checked=this.options.checked,i.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=i,this.update()}},{key:"focus",value:function(){this.isBuilt()&&Q0.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return di({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(nl);const FH=_ze;function Md(t){return Md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Md(t)}var HH;function Tze(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Oze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function BH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xze(n.key),n)}}function Aze(t,e,r){return e&&BH(t.prototype,e),r&&BH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function xze(t){var e=Ize(t,"string");return Md(e)==="symbol"?e:String(e)}function Ize(t,e){if(Md(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mze(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v7(t,e)}function v7(t,e){return v7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},v7(t,e)}function Nze(t){var e=$ze();return function(){var n=zw(t),i;if(e){var o=zw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Pze(this,i)}}function Pze(t,e){if(e&&(Md(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kze(t)}function kze(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $ze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zw(t){return zw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zw(t)}var UH=0,Lze=function(t){Mze(r,t);var e=Nze(r);function r(n,i){var o;return Oze(this,r),o=e.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.buildOperatorsElement(),o}return Aze(r,[{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(a,s){return Re(s.parentNode,"htFiltersMenuOperators"),s.parentNode.hasAttribute("ghost-table")||Q(i.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"buildOperatorsElement",value:function(){var i=this,o=[rl,Ww];Q(o,function(a){var s=new FH(i.hot,{name:"operator",label:{htmlFor:a,textContent:EWe(a)},value:a,checked:a===o[UH],id:a});s.addLocalHook("change",function(l){return i.onRadioInputChange(l)}),i.elements.push(s)})}},{key:"setChecked",value:function(i){if(this.elements.length<i)throw Error(Gt(HH||(HH=Tze(["Radio button with index "," doesn't exist."])),i));Q(this.elements,function(o,a){o.setChecked(a===i)})}},{key:"getActiveOperationId",value:function(){var i=this.elements.find(function(o){return o instanceof FH&&o.isChecked()});return i?i.getValue():rl}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(i){this.reset(),i&&this.getActiveOperationId()!==i&&Q(this.elements,function(o){o.setChecked(o.getValue()===i)})}},{key:"updateState",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rl,o=arguments.length>1?arguments[1]:void 0,a=i;a===uI&&(a=Ww),this.state.setValueAtIndex(o,a)}},{key:"reset",value:function(){this.setChecked(UH)}},{key:"onRadioInputChange",value:function(i){this.setState(i.target.value)}}]),r}(G6);const Dze=Lze;var Fze=mt,Hze=bi,VH=Gr,Bze=/"/g,Uze=Fze("".replace),Vze=function(t,e,r,n){var i=VH(Hze(t)),o="<"+e;return r!==""&&(o+=" "+r+'="'+Uze(VH(n),Bze,"&quot;")+'"'),o+">"+i+"</"+e+">"},jze=dt,Wze=function(t){return jze(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})},zze=tt,Gze=Vze,Yze=Wze;zze({target:"String",proto:!0,forced:Yze("link")},{link:function(e){return Gze(this,"a","href",e)}});function Nd(t){return Nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nd(t)}function Kze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xze(n.key),n)}}function qze(t,e,r){return e&&jH(t.prototype,e),r&&jH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Xze(t){var e=Qze(t,"string");return Nd(e)==="symbol"?e:String(e)}function Qze(t,e){if(Nd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function p2(){return typeof Reflect<"u"&&Reflect.get?p2=Reflect.get.bind():p2=function(e,r,n){var i=Zze(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},p2.apply(this,arguments)}function Zze(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Pd(t),t!==null););return t}function Jze(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b7(t,e)}function b7(t,e){return b7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},b7(t,e)}function eGe(t){var e=rGe();return function(){var n=Pd(t),i;if(e){var o=Pd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return tGe(this,i)}}function tGe(t,e){if(e&&(Nd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lZ(t)}function lZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pd(t){return Pd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pd(t)}var RC=new WeakMap,nGe=function(t){Jze(r,t);var e=eGe(r);function r(n,i){var o;return Kze(this,r),o=e.call(this,n,Jr(r.DEFAULTS,i)),RC.set(lZ(o),{}),o}return qze(r,[{key:"build",value:function(){p2(Pd(r.prototype),"build",this).call(this);var i=RC.get(this);i.link=this._element.firstChild}},{key:"update",value:function(){!this.isBuilt()||(RC.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return di({href:"#",tagName:"a"})}}]),r}(nl);const WH=nGe;function kd(t){return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kd(t)}function zH(t){return sGe(t)||aGe(t)||oGe(t)||iGe()}function iGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oGe(t,e){if(!!t){if(typeof t=="string")return w7(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w7(t,e)}}function aGe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function sGe(t){if(Array.isArray(t))return w7(t)}function w7(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function lGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function GH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cGe(n.key),n)}}function uGe(t,e,r){return e&&GH(t.prototype,e),r&&GH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function cGe(t){var e=fGe(t,"string");return kd(e)==="symbol"?e:String(e)}function fGe(t,e){if(kd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qf(){return typeof Reflect<"u"&&Reflect.get?qf=Reflect.get.bind():qf=function(e,r,n){var i=hGe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},qf.apply(this,arguments)}function hGe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ol(t),t!==null););return t}function dGe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&S7(t,e)}function S7(t,e){return S7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},S7(t,e)}function pGe(t){var e=gGe();return function(){var n=ol(t),i;if(e){var o=ol(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return mGe(this,i)}}function mGe(t,e){if(e&&(kd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uZ(t)}function uZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ol(t){return ol=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ol(t)}var yGe=new WeakMap,vGe="multipleSelect.itemBox",bGe=function(t){dGe(r,t);var e=pGe(r);function r(n,i){var o;return lGe(this,r),o=e.call(this,n,Jr(r.DEFAULTS,i)),yGe.set(uZ(o),{}),o.searchInput=new Yf(o.hot,{placeholder:Yx,className:"htUIMultipleSelectSearch"}),o.selectAllUI=new WH(o.hot,{textContent:jx,className:"htUISelectAll"}),o.clearAllUI=new WH(o.hot,{textContent:Wx,className:"htUIClearAll"}),o.items=[],o.itemsBox=null,o.registerHooks(),o}return uGe(r,[{key:"registerHooks",value:function(){var i=this;this.searchInput.addLocalHook("keydown",function(o){return i.onInputKeyDown(o)}),this.searchInput.addLocalHook("input",function(o){return i.onInput(o)}),this.selectAllUI.addLocalHook("click",function(o){return i.onSelectAllClick(o)}),this.clearAllUI.addLocalHook("click",function(o){return i.onClearAllClick(o)})}},{key:"setItems",value:function(i){this.items=i,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(i){this.locale=i}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return zH(this.items)}},{key:"getValue",value:function(){return SGe(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var i=this;qf(ol(r.prototype),"build",this).call(this);var o=this.hot.rootDocument,a=o.createElement("div"),s=new nl(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(s.element),this._element.appendChild(a);var l=function(c){if(!!i._element){i.itemsBox&&i.itemsBox.destroy(),Re(c,"htUIMultipleSelectHot"),i.itemsBox=new i.hot.constructor(c,{data:i.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(p,m,g,v,S,b){p.title=b.instance.getDataAtRowProp(m,b.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return i.itemsBox.container.scrollWidth-yn(o)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:i.hot.isRtl()?"rtl":"ltr"}),i.itemsBox.init();var f=i.itemsBox.getShortcutManager(),h=f.getContext("grid");h.addShortcut({keys:[["Escape"]],callback:function(p){i.runLocalHooks("keydown",p,i)},group:vGe})}};l(a),setTimeout(function(){return l(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){!this.isBuilt()||(this.itemsBox.loadData(wGe(this.items,this.options.value)),qf(ol(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,qf(ol(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(i){var o=this,a=i.target.value.toLocaleLowerCase(this.getLocale()),s;a===""?s=zH(this.items):s=eo(this.items,function(l){return"".concat(l.value).toLocaleLowerCase(o.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(s)}},{key:"onInputKeyDown",value:function(i){this.runLocalHooks("keydown",i,this);var o=zK(Ig,i.keyCode);o("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(la(i),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(i){var o=[];i.preventDefault(),Q(this.itemsBox.getSourceData(),function(a,s){a.checked=!0,o.push(YD(a,s)[0])}),this.itemsBox.setSourceDataAtCell(o)}},{key:"onClearAllClick",value:function(i){var o=[];i.preventDefault(),Q(this.itemsBox.getSourceData(),function(a,s){a.checked=!1,o.push(YD(a,s)[0])}),this.itemsBox.setSourceDataAtCell(o)}}],[{key:"DEFAULTS",get:function(){return di({className:"htUIMultipleSelect",value:[]})}}]),r}(nl);const YH=bGe;function wGe(t,e){var r=V1(e);return bt(t,function(n){return n.checked=r(n.value),n})}function SGe(t){var e=[];return Q(t,function(r){r.checked&&e.push(r.value)}),e}function $d(t){return $d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$d(t)}function RGe(t,e){return TGe(t)||_Ge(t,e)||CGe(t,e)||EGe()}function EGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CGe(t,e){if(!!t){if(typeof t=="string")return KH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KH(t,e)}}function KH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _Ge(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function TGe(t){if(Array.isArray(t))return t}function OGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xGe(n.key),n)}}function AGe(t,e,r){return e&&qH(t.prototype,e),r&&qH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function xGe(t){var e=IGe(t,"string");return $d(e)==="symbol"?e:String(e)}function IGe(t,e){if($d(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if($d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function m2(){return typeof Reflect<"u"&&Reflect.get?m2=Reflect.get.bind():m2=function(e,r,n){var i=MGe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},m2.apply(this,arguments)}function MGe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ld(t),t!==null););return t}function NGe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&R7(t,e)}function R7(t,e){return R7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},R7(t,e)}function PGe(t){var e=LGe();return function(){var n=Ld(t),i;if(e){var o=Ld(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return kGe(this,i)}}function kGe(t,e){if(e&&($d(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Ge(t)}function $Ge(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function LGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ld(t){return Ld=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ld(t)}var DGe=function(t){NGe(r,t);var e=PGe(r);function r(n,i){var o;return OGe(this,r),o=e.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.elements.push(new YH(o.hot)),o.registerHooks(),o}return AGe(r,[{key:"registerHooks",value:function(){var i=this;this.getMultipleSelectElement().addLocalHook("keydown",function(o){return i.onInputKeyDown(o)})}},{key:"setState",value:function(i){if(this.reset(),i&&i.command.key===yu){var o=this.getMultipleSelectElement();o.setItems(i.itemsSnapshot),o.setValue(i.args[0]),o.setLocale(i.locale)}}},{key:"getState",value:function(){var i=this.getMultipleSelectElement(),o=i.getItems();return{command:{key:i.isSelectedAllValues()||!o.length?hn:yu},args:[i.getValue()],itemsSnapshot:o}}},{key:"updateState",value:function(i){var o=this,a=function(l,u,c,f,h){var d=eo(u,function(N){return N.name===yu}),p=RGe(d,1),m=p[0],g={},v=o.hot.getTranslatedPhrase(Dw);if(m){var S=d7(bt(f(l,h),function(N){return N.value}));c&&(m.args[0]=c);var b=[],E=AH(S,m.args[0],v,function(N){N.checked&&b.push(N.value)}),T=i.editedConditionStack.column;g.locale=o.hot.getCellMeta(0,T).locale,g.args=[b],g.command=gu(yu),g.itemsSnapshot=E}else g.args=[],g.command=gu(hn);o.state.setValueAtIndex(l,g)};a(i.editedConditionStack.column,i.editedConditionStack.conditions,i.conditionArgsChange,i.filteredRowsFactory),i.dependentConditionStacks.length&&a(i.dependentConditionStacks[0].column,i.dependentConditionStacks[0].conditions,i.conditionArgsChange,i.filteredRowsFactory,i.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof YH})[0]}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(a,s,l,u,c,f){Re(s.parentNode,"htFiltersMenuValue");var h=i.hot.rootDocument.createElement("div");return Re(h,"htFiltersMenuLabel"),h.textContent=f,s.appendChild(h),s.parentNode.hasAttribute("ghost-table")||Q(i.elements,function(d){return s.appendChild(d.element)}),s}}}},{key:"reset",value:function(){var i=this.hot.getTranslatedPhrase(Dw),o=d7(this._getColumnVisibleValues()),a=AH(o,o,i);this.getMultipleSelectElement().setItems(a),m2(Ld(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(o);var s=this.hot.getPlugin("filters").getSelectedColumn();s!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}},{key:"onInputKeyDown",value:function(i){Ig(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),la(i))}},{key:"_getColumnVisibleValues",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn();return i===null?[]:bt(this.hot.getDataAtCol(i.visualIndex),function(o){return tZ(o)})}}]),r}(G6);const FGe=DGe;function Dd(t){return Dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dd(t)}function HGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function XH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,UGe(n.key),n)}}function BGe(t,e,r){return e&&XH(t.prototype,e),r&&XH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function UGe(t){var e=VGe(t,"string");return Dd(e)==="symbol"?e:String(e)}function VGe(t,e){if(Dd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jGe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&E7(t,e)}function E7(t,e){return E7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},E7(t,e)}function WGe(t){var e=YGe();return function(){var n=Gw(t),i;if(e){var o=Gw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return zGe(this,i)}}function zGe(t,e){if(e&&(Dd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GGe(t)}function GGe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function YGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gw(t){return Gw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gw(t)}var KGe=function(t){jGe(r,t);var e=WGe(r);function r(n,i){var o;return HGe(this,r),o=e.call(this,n,{id:i.id,stateless:!0}),o.name=i.name,o.elements.push(new Yf(o.hot,{type:"button",value:zx,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),o.elements.push(new Yf(o.hot,{type:"button",value:Gx,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),o.registerHooks(),o}return BGe(r,[{key:"registerHooks",value:function(){var i=this;Q(this.elements,function(o){o.addLocalHook("click",function(a,s){return i.onButtonClick(a,s)})})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(a,s){return Re(s.parentNode,"htFiltersMenuActionBar"),s.parentNode.hasAttribute("ghost-table")||Q(i.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(i,o){o.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(G6);const qGe=KGe;function fv(t){return fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fv(t)}var QH,ZH;function JH(t,e){return JGe(t)||ZGe(t,e)||QGe(t,e)||XGe()}function XGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QGe(t,e){if(!!t){if(typeof t=="string")return eB(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eB(t,e)}}function eB(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ZGe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function JGe(t){if(Array.isArray(t))return t}function tB(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function eYe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rYe(n.key),n)}}function tYe(t,e,r){return e&&rB(t.prototype,e),r&&rB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function rYe(t){var e=nYe(t,"string");return fv(e)==="symbol"?e:String(e)}function nYe(t,e){if(fv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var nB="ConditionCollection.filteringStates",cZ=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;eYe(this,t),this.hot=e,this.isMapRegistrable=r,this.filteringStates=new x6,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(nB,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return tYe(t,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(r,n){var i,o=this.filteringStates.getValueAtIndex(n),a=(i=o==null?void 0:o.conditions)!==null&&i!==void 0?i:[],s=o==null?void 0:o.operation;return this.isMatchInConditions(a,r,s)}},{key:"isMatchInConditions",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:rl;return r.length?RWe(i)(r,n):!0}},{key:"addCondition",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:rl,o=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,r).locale,s=bt(n.args,function(f){return typeof f=="string"?f.toLocaleLowerCase(a):f}),l=n.name||n.command.key;this.runLocalHooks("beforeAdd",r);var u=this.getOperation(r);if(u){if(u!==i)throw Error(Gt(QH||(QH=tB(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),r,u))}else if(tr(lv[i]))throw new Error(Gt(ZH||(ZH=tB(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),i));var c=this.getConditions(r);c.length===0?this.filteringStates.setValueAtIndex(r,{operation:i,conditions:[{name:l,args:s,func:pl(l,s)}]},o):c.push({name:l,args:s,func:pl(l,s)}),this.runLocalHooks("afterAdd",r)}},{key:"getConditions",value:function(r){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(r))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(r){var n;return(n=this.filteringStates.getValueAtIndex(r))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(r){var n=JH(r,1),i=n[0];return i})}},{key:"getColumnStackPosition",value:function(r){return this.getFilteredColumns().indexOf(r)}},{key:"exportAllConditions",value:function(){return Hn(this.filteringStates.getEntries(),function(r,n){var i=JH(n,2),o=i[0],a=i[1],s=a.operation,l=a.conditions;return r.push({column:o,operation:s,conditions:bt(l,function(u){var c=u.name,f=u.args;return{name:c,args:f}})}),r},[])}},{key:"importAllConditions",value:function(r){var n=this;this.clean(),Q(r,function(i){Q(i.conditions,function(o){return n.addCondition(i.column,o)})})}},{key:"removeConditions",value:function(r){this.runLocalHooks("beforeRemove",r),this.filteringStates.clearValue(r),this.runLocalHooks("afterRemove",r)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(r,n){var i=this.getConditions(r);return n?i.some(function(o){return o.name===n}):i.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(nB),this.filteringStates=null,this.clearLocalHooks()}}]),t}();ir(cZ,Si);const fZ=cZ;function hv(t){return hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hv(t)}function iYe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aYe(n.key),n)}}function oYe(t,e,r){return e&&iB(t.prototype,e),r&&iB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function aYe(t){var e=sYe(t,"string");return hv(e)==="symbol"?e:String(e)}function sYe(t,e){if(hv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(hv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lYe=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};iYe(this,t),this.conditionCollection=e,this.columnDataFactory=r}return oYe(t,[{key:"filter",value:function(){var r=this,n=[];return Q(this.conditionCollection.getFilteredColumns(),function(i,o){var a=r.columnDataFactory(i);o&&(a=r._getIntersectData(a,n)),n=r.filterByColumn(i,a)}),n}},{key:"filterByColumn",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=[];return Q(i,function(a){a!==void 0&&n.conditionCollection.isMatch(a,r)&&o.push(a)}),o}},{key:"_getIntersectData",value:function(r,n){var i=[];return Q(n,function(o){var a=o.meta.visualRow;r[a]!==void 0&&(i[a]=r[a])}),i}}]),t}();const hZ=lYe;function dv(t){return dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dv(t)}function uYe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fYe(n.key),n)}}function cYe(t,e,r){return e&&oB(t.prototype,e),r&&oB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function fYe(t){var e=hYe(t,"string");return dv(e)==="symbol"?e:String(e)}function hYe(t,e){if(dv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(dv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var dZ=function(){function t(e,r){var n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};uYe(this,t),this.hot=e,this.conditionCollection=r,this.columnDataFactory=i,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(o){return n._onConditionBeforeModify(o)}),this.conditionCollection.addLocalHook("afterRemove",function(o){return n.updateStatesAtColumn(o)}),this.conditionCollection.addLocalHook("afterAdd",function(o){return n.updateStatesAtColumn(o)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return cYe(t,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var r=this;this.grouping=!1,Q(this.changes,function(n){r.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(r){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(r)}},{key:"updateStatesAtColumn",value:function(r,n){var i=this;if(this.grouping){this.changes.indexOf(r)===-1&&this.changes.push(r);return}var o=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(r);a===-1&&(a=this.latestEditedColumnPosition);var s=o.slice(0,a),l=o.slice(a);l.length&&l[0].column===r&&l.shift();var u=DSe(function(f,h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],p=new fZ(i.hot,!1),m=[].concat(f,d);p.importAllConditions(m);var g=i.columnDataFactory(h),v;p.isEmpty()?v=g:v=new hZ(p,function(b){return i.columnDataFactory(b)}).filter(),v=bt(v,function(b){return b.meta.visualRow});var S=V1(v);return p.destroy(),eo(g,function(b){return S(b.meta.visualRow)})})(s),c=[].concat(this.conditionCollection.getConditions(r));this.runLocalHooks("update",{editedConditionStack:{column:r,conditions:c},dependentConditionStacks:l,filteredRowsFactory:u,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var r=this;Q(this.latestOrderStack,function(n){r.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var r=this;this.clearLocalHooks(),St(this,function(n,i){r[i]=null})}}]),t}();ir(dZ,Si);const dYe=dZ;function Fd(t){return Fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fd(t)}var aB;function pYe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function mYe(t,e){return bYe(t)||vYe(t,e)||yYe(t,e)||gYe()}function gYe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yYe(t,e){if(!!t){if(typeof t=="string")return sB(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sB(t,e)}}function sB(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function vYe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function bYe(t){if(Array.isArray(t))return t}function wYe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,RYe(n.key),n)}}function SYe(t,e,r){return e&&lB(t.prototype,e),r&&lB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function RYe(t){var e=EYe(t,"string");return Fd(e)==="symbol"?e:String(e)}function EYe(t,e){if(Fd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xf(){return typeof Reflect<"u"&&Reflect.get?Xf=Reflect.get.bind():Xf=function(e,r,n){var i=CYe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Xf.apply(this,arguments)}function CYe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=al(t),t!==null););return t}function _Ye(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&C7(t,e)}function C7(t,e){return C7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},C7(t,e)}function TYe(t){var e=AYe();return function(){var n=al(t),i;if(e){var o=al(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return OYe(this,i)}}function OYe(t,e){if(e&&(Fd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pZ(t)}function pZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function AYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function al(t){return al=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},al(t)}var uB="filters",xYe=250,IYe=function(t){_Ye(r,t);var e=TYe(r);function r(n){var i;return wYe(this,r),i=e.call(this,n),i.eventManager=new Er(pZ(i)),i.dropdownMenuPlugin=null,i.conditionCollection=null,i.conditionUpdateObserver=null,i.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),i.filtersRowsMap=null,i.hot.addHook("afterGetColHeader",function(o,a){return i.onAfterGetColHeader(o,a)}),i}return SYe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[uB]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new L1),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var o=this.hot.getSettings().dropdownMenu,a=o&&o.uiContainer||this.hot.rootDocument.body,s=function(d){return d.addLocalHook("accept",function(){return i.onActionBarSubmit("accept")}),d.addLocalHook("cancel",function(){return i.onActionBarSubmit("cancel")}),d.addLocalHook("change",function(p){return i.onComponentChange(d,p)}),d},l=function(){return"".concat(i.hot.getTranslatedPhrase(Bx),":")},u=function(){return"".concat(i.hot.getTranslatedPhrase(Ux),":")};if(!this.components.get("filter_by_condition")){var c=new SC(this.hot,{id:"filter_by_condition",name:l,addSeparator:!1,menuContainer:a});c.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition",s(c))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Dze(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var f=new SC(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});f.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition2",s(f))}this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new FGe(this.hot,{id:"filter_by_value",name:u}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new qGe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new fZ(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new dYe(this.hot,this.conditionCollection,function(h){return i.getDataMapAtColumn(h)}),this.conditionUpdateObserver.addLocalHook("update",function(h){return i.updateComponents(h)})),this.components.forEach(function(h){return h.show()}),this.addHook("beforeDropdownMenuSetItems",function(h){return i.onBeforeDropdownMenuSetItems(h)}),this.addHook("afterDropdownMenuDefaultOptions",function(h){return i.onAfterDropdownMenuDefaultOptions(h)}),this.addHook("afterDropdownMenuShow",function(){return i.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return i.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(h){return i.onAfterChange(h)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),Xf(al(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;if(this.enabled){var o;(o=this.dropdownMenuPlugin)!==null&&o!==void 0&&o.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,s){a.destroy(),i.components.set(s,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}Xf(al(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(i,o,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:rl,l=this.hot.toPhysicalColumn(i);this.conditionCollection.addCondition(l,{command:{key:o},args:a},s)}},{key:"removeConditions",value:function(i){var o=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(o)}},{key:"clearConditions",value:function(i){if(i===void 0)this.conditionCollection.clean();else{var o=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(o)}}},{key:"filter",value:function(){var i=this,o=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),s=[],l=this.conditionCollection.exportAllConditions(),u=this.hot.runHooks("beforeFilter",l);if(u!==!1)if(a){var c=[];this.hot.batchExecution(function(){i.filtersRowsMap.clear(),s=bt(o.filter(),function(h){return h.meta.visualRow});var f=V1(s);Ye(i.hot.countSourceRows()-1,function(h){f(h)||c.push(h)}),Q(c,function(h){i.filtersRowsMap.setValueAtIndex(h,!0)})},!0),s.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",l),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var i,o=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return o?{visualIndex:o.col,physicalIndex:this.hot.toPhysicalColumn(o.col)}:null}},{key:"clearColumnSelection",value:function(){var i=this.getSelectedColumn();i!==null&&this.hot.selectCell(0,i.visualIndex)}},{key:"getDataMapAtColumn",value:function(i){var o=this,a=this.hot.toVisualColumn(i),s=[];return Q(this.hot.getSourceDataAtCol(a),function(l,u){var c,f=o.hot.getCellMeta(u,a),h=f.row,d=f.col,p=f.visualCol,m=f.visualRow,g=f.type,v=f.instance,S=f.dateFormat,b=f.locale,E=(c=o.hot.getDataAtCell(o.hot.toVisualRow(u),a))!==null&&c!==void 0?c:l;s.push({meta:{row:h,col:d,visualCol:p,visualRow:m,type:g,instance:v,dateFormat:S,locale:b},value:tZ(E)})}),s}},{key:"onAfterChange",value:function(i){var o=this;i&&Q(i,function(a){var s=mYe(a,2),l=s[1],u=o.hot.propToCol(l);o.conditionCollection.hasConditions(u)&&o.updateValueComponentCondition(u)})}},{key:"updateValueComponentCondition",value:function(i){var o=this.hot.getDataAtCol(i),a=d7(o);this.conditionUpdateObserver.updateStatesAtColumn(i,a)}},{key:"restoreComponents",value:function(i){var o,a=(o=this.getSelectedColumn())===null||o===void 0?void 0:o.physicalIndex;i.forEach(function(s){s.isHidden()||s.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var i=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){i.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(i){i.items.push({name:vt}),this.components.forEach(function(o){i.items.push(o.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(i,o,a,s){var l=i;return l===Ww&&o.command.key!==hn&&a.command.key!==hn&&s.command.key!==hn?l=uI:s.command.key!==hn&&(o.command.key===hn||a.command.key===hn)&&(l=rl),l}},{key:"onActionBarSubmit",value:function(i){var o;if(i==="accept"){var a=this.getSelectedColumn();if(a===null){var s;(s=this.dropdownMenuPlugin)===null||s===void 0||s.close();return}var l=a.physicalIndex,u=this.components.get("filter_by_condition").getState(),c=this.components.get("filter_by_condition2").getState(),f=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),u,c,f);this.conditionUpdateObserver.groupChanges();var d=this.conditionCollection.getColumnStackPosition(l);d===-1&&(d=void 0),this.conditionCollection.removeConditions(l),u.command.key!==hn&&(this.conditionCollection.addCondition(l,u,h,d),c.command.key!==hn&&this.conditionCollection.addCondition(l,c,h,d)),f.command.key!==hn&&this.conditionCollection.addCondition(l,f,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(function(p){return p.saveState(l)}),this.filtersRowsMap.clear(),this.filter()}(o=this.dropdownMenuPlugin)===null||o===void 0||o.close()}},{key:"onComponentChange",value:function(i,o){this.updateDependentComponentsVisibility(),i.constructor===SC&&!o.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var i=this.components.get("filter_by_condition"),o=i.getState(),a=o.command,s=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,s):this.hideComponents.apply(this,s)}},{key:"onAfterGetColHeader",value:function(i,o){var a=this.hot.toPhysicalColumn(i);this.enabled&&this.conditionCollection.hasConditions(a)?Re(o,"htFiltersActive"):ut(o,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new hZ(o,function(a){return i.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(i){var o;if(!!((o=this.dropdownMenuPlugin)!==null&&o!==void 0&&o.enabled)){var a=i.editedConditionStack,s=a.conditions,l=a.column,u=s.filter(function(h){return h.name===yu}),c=s.filter(function(h){return h.name!==yu});if(u.length>=2||c.length>=3)Xt(Gt(aB||(aB=pYe([`The filter conditions have been applied properly, but couldn\u2019t be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldn\u2019t be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var f=this.conditionCollection.getOperation(l);this.components.get("filter_by_condition").updateState(c[0],l),this.components.get("filter_by_condition2").updateState(c[1],l),this.components.get("filter_operators").updateState(f,l),this.components.get("filter_by_value").updateState(i)}}}},{key:"getIndexesOfComponents",value:function(){var i=[];if(!this.dropdownMenuPlugin)return i;for(var o=this.dropdownMenuPlugin.menu,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return Q(s,function(u){Q(o.menuItems,function(c,f){c.key===u.getMenuItemDescriptor().key&&i.push(f)})}),i}},{key:"changeComponentsVisibility",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!!this.dropdownMenuPlugin){for(var o=this.dropdownMenuPlugin.menu,a=o.hotMenu,s=a.getPlugin("hiddenRows"),l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];var f=this.getIndexesOfComponents.apply(this,u);i?s.showRows(f):s.hideRows(f),a.render()}}},{key:"hideComponents",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(o))}},{key:"showComponents",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(o))}},{key:"destroy",value:function(){var i=this;this.enabled&&(this.components.forEach(function(o,a){o!==null&&(o.destroy(),i.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),Xf(al(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return uB}},{key:"PLUGIN_PRIORITY",get:function(){return xYe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(jt);function pv(t){return pv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pv(t)}function cB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ug(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cB(Object(r),!0).forEach(function(n){MYe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cB(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function MYe(t,e,r){return e=NYe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NYe(t){var e=PYe(t,"string");return pv(e)==="symbol"?e:String(e)}function PYe(t,e){if(pv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(pv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mZ="internal-use-in-handsontable",kYe={licenseKey:mZ,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function gZ(t){var e,r;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Yn])===null||e===void 0||(r=e.language)===null||r===void 0?void 0:r.langCode}}function yZ(t){return Object.keys(t).reduce(function(e,r){return r!=="hyperformula"&&(e[r]=t[r]),e},{})}function $Ye(t){var e,r=t[Yn],n=yZ(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=gZ(t);return ug(ug(ug({},kYe),n),i)}function LYe(t){var e,r=t[Yn],n=yZ(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=gZ(t);return ug(ug({},n),i)}function _7(t){return _7=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_7(t)}function Y6(){var t="engine_relationship",e=lo(Yn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function cI(){var t="shared_engine_usage",e=lo(Yn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function DYe(t){var e=t.getSettings(),r=e[Yn],n=r==null?void 0:r.engine;if(r===!0||tr(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return FYe((i=n.hyperformula)!==null&&i!==void 0?i:n,e,t)}else if(_7(n)==="object"&&tr(n.hyperformula)){var o=Y6(),a=cI().get(n);return o.has(n)||o.set(n,[]),o.get(n).push(t),a&&a.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:mZ}),n}return null}function FYe(t,e,r){var n=e[Yn],i=$Ye(e),o=Y6(),a=cI();HYe(t,n.functions),BYe(t,n.language);var s=t.buildEmpty(i);return o.set(s,[r]),a.set(s,[r.guid]),UYe(s,n.namedExpressions),s.on("sheetAdded",function(){s.rebuildAndRecalculate()}),s.on("sheetRemoved",function(){s.rebuildAndRecalculate()}),s}function fB(t){var e,r=Y6(),n=r.size===0?[]:Array.from((e=r.get(t))!==null&&e!==void 0?e:[]);return new Map(n.map(function(i){return[i.getPlugin("formulas").sheetId,i]}))}function hB(t,e){if(t){var r=Y6(),n=r.get(t),i=cI(),o=i.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),n.length===0&&r.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function HYe(t,e){e&&e.forEach(function(r){var n=r.name,i=r.plugin,o=r.translations;try{t.registerFunction(n,i,o)}catch(a){Xt(a.message)}})}function BYe(t,e){if(e){var r=e.langCode;try{t.registerLanguage(r,e)}catch(n){Xt(n.message)}}}function UYe(t,e){e&&(t.suspendEvaluation(),e.forEach(function(r){var n=r.name,i=r.expression,o=r.scope,a=r.options;try{t.addNamedExpression(n,i,o,a)}catch(s){Xt(s.message)}}),t.resumeEvaluation())}function VYe(t,e){return(tr(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}function vZ(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function jYe(t){return vZ(t)?t.substr(1):t}function WYe(t){return YYe(t)||GYe(t)||bZ(t)||zYe()}function zYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GYe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function YYe(t){if(Array.isArray(t))return T7(t)}function dB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function pB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dB(Object(r),!0).forEach(function(n){g2(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dB(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ml(t){return ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ml(t)}function rf(t,e){return XYe(t)||qYe(t,e)||bZ(t,e)||KYe()}function KYe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bZ(t,e){if(!!t){if(typeof t=="string")return T7(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T7(t,e)}}function T7(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function qYe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function XYe(t){if(Array.isArray(t))return t}function QYe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wZ(n.key),n)}}function ZYe(t,e,r){return e&&mB(t.prototype,e),r&&mB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vu(){return typeof Reflect<"u"&&Reflect.get?vu=Reflect.get.bind():vu=function(e,r,n){var i=JYe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},vu.apply(this,arguments)}function JYe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=es(t),t!==null););return t}function eKe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&O7(t,e)}function O7(t,e){return O7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},O7(t,e)}function tKe(t){var e=nKe();return function(){var n=es(t),i;if(e){var o=es(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return rKe(this,i)}}function rKe(t,e){if(e&&(ml(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xl(t)}function Xl(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nKe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function es(t){return es=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},es(t)}function g2(t,e,r){return e=wZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wZ(t){var e=iKe(t,"string");return ml(e)==="symbol"?e:String(e)}function iKe(t,e){if(ml(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ml(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EC(t,e,r){oKe(t,e),e.set(t,r)}function oKe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nf(t,e,r){var n=SZ(t,e,"set");return aKe(t,n,r),r}function aKe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function of(t,e){var r=SZ(t,e,"get");return sKe(t,r)}function SZ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function sKe(t,e){return e.get?e.get.call(t):e.value}var Yn="formulas",lKe=260,gB="row_move";Ue.getSingleton().register("afterNamedExpressionAdded");Ue.getSingleton().register("afterNamedExpressionRemoved");Ue.getSingleton().register("afterSheetAdded");Ue.getSingleton().register("afterSheetRemoved");Ue.getSingleton().register("afterSheetRenamed");Ue.getSingleton().register("afterFormulasValuesUpdate");var af=function(e){return e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto"},Ul=new WeakMap,CC=new WeakMap,Sm=new WeakMap,uKe=function(t){eKe(r,t);var e=tKe(r);function r(){var n;QYe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),EC(Xl(n),Ul,{writable:!0,value:!1}),EC(Xl(n),CC,{writable:!0,value:!1}),EC(Xl(n),Sm,{writable:!0,value:[["valuesUpdated",function(){var s;return(s=n).onEngineValuesUpdated.apply(s,arguments)}],["namedExpressionAdded",function(){var s;return(s=n).onEngineNamedExpressionsAdded.apply(s,arguments)}],["namedExpressionRemoved",function(){var s;return(s=n).onEngineNamedExpressionsRemoved.apply(s,arguments)}],["sheetAdded",function(){var s;return(s=n).onEngineSheetAdded.apply(s,arguments)}],["sheetRenamed",function(){var s;return(s=n).onEngineSheetRenamed.apply(s,arguments)}],["sheetRemoved",function(){var s;return(s=n).onEngineSheetRemoved.apply(s,arguments)}]]}),g2(Xl(n),"staticRegister",lo("formulas")),g2(Xl(n),"engine",null),g2(Xl(n),"sheetName",null),n}return ZYe(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Yn]}},{key:"enablePlugin",value:function(){var i,o=this;if(!this.enabled){if(this.engine=(i=DYe(this.hot))!==null&&i!==void 0?i:this.engine,!this.engine){Xt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return o.onBeforeLoadData.apply(o,arguments)}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeUpdateData",function(){return o.onBeforeLoadData.apply(o,arguments)}),this.addHook("afterUpdateData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("modifyData",function(){return o.onModifyData.apply(o,arguments)}),this.addHook("modifySourceData",function(){return o.onModifySourceData.apply(o,arguments)}),this.addHook("beforeValidate",function(){return o.onBeforeValidate.apply(o,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return o.onAfterSetSourceDataAtCell.apply(o,arguments)}),this.addHook("afterSetDataAtCell",function(){return o.onAfterSetDataAtCell.apply(o,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return o.onAfterSetDataAtCell.apply(o,arguments)}),this.addHook("beforeCreateRow",function(){return o.onBeforeCreateRow.apply(o,arguments)}),this.addHook("beforeCreateCol",function(){return o.onBeforeCreateCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("beforeRemoveCol",function(){return o.onBeforeRemoveCol.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("beforeUndo",function(s){(s==null?void 0:s.actionType)!==gB&&o.engine.undo()}),this.addHook("beforeRedo",function(s){(s==null?void 0:s.actionType)!==gB&&o.engine.redo()}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("beforeAutofill",function(){return o.onBeforeAutofill.apply(o,arguments)}),of(this,Sm).forEach(function(s){var l=rf(s,2),u=l[0],c=l[1];return o.engine.on(u,c)}),vu(es(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;of(this,Sm).forEach(function(o){var a=rf(o,2),s=a[0],l=a[1];return i.engine.off(s,l)}),hB(this.engine,this.hot),this.engine=null,vu(es(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(i){this.engine.updateConfig(LYe(this.hot.getSettings()));var o=this.hot.getSettings()[Yn];if(He(o)&&He(o.sheetName)&&o.sheetName!==this.sheetName&&this.switchSheet(o.sheetName),!i.data&&this.sheetName===null){var a=this.hot.getSettings()[Yn].sheetName;a&&this.engine.doesSheetExist(a)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(a!=null?a:void 0,this.hot.getSourceDataArray())}vu(es(r.prototype),"updatePlugin",this).call(this,i)}},{key:"destroy",value:function(){var i=this;of(this,Sm).forEach(function(o){var a,s=rf(o,2),l=s[0],u=s[1];return(a=i.engine)===null||a===void 0?void 0:a.off(l,u)}),nf(this,Sm,null),hB(this.engine,this.hot),this.engine=null,vu(es(r.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(i,o,a,s,l){return!l&&i>=a?s+(i-a):o}},{key:"toPhysicalRowPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalRow(i),this.hot.countRows(),this.hot.countSourceRows(),o)}},{key:"toPhysicalColumnPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalColumn(i),this.hot.countCols(),this.hot.countSourceCols(),o)}},{key:"addSheet",value:function(i,o){if(He(o)&&!q$e(o))return Xt("The provided data should be an array of arrays."),!1;if(i!=null&&this.engine.doesSheetExist(i))return Xt("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(i!=null?i:void 0);return o&&this.engine.setSheetContent(this.engine.getSheetId(a),o),a}catch(s){return Xt(s.message),!1}}},{key:"switchSheet",value:function(i){if(!this.engine.doesSheetExist(i)){X8("The sheet named `".concat(i,"` does not exist, switch aborted."));return}this.sheetName=i;var o=this.engine.getSheetSerialized(this.sheetId);o.length>0&&this.hot.loadData(o,"".concat(gs(Yn),".switchSheet"))}},{key:"getCellType",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(i),l=this.hot.toPhysicalColumn(o);return s!==null&&l!==null?this.engine.getCellType({sheet:a,row:s,col:l}):"EMPTY"}},{key:"isFormulaCellType",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(i),l=this.hot.toPhysicalColumn(o);return s===null||l===null?!1:this.engine.doesCellHaveFormula({sheet:a,row:s,col:l})}},{key:"renderDependentSheets",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=new Set;i.forEach(function(l){var u,c=l==null||(u=l.address)===null||u===void 0?void 0:u.sheet;c!==void 0&&(s.has(c)||s.add(c))}),fB(this.engine).forEach(function(l,u){if((a||u!==o.sheetId)&&s.has(u)){var c;l.render(),(c=l.view)===null||c===void 0||c.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=function(c){var f,h=(f=c==null?void 0:c.address)!==null&&f!==void 0?f:{},d=h.row,p=h.col,m=h.sheet;return He(m)?"".concat(m,":").concat(d,"x").concat(p):""},l=new Set(a.map(function(u){return s(u)}));i.forEach(function(u){var c,f,h=(c=u.address)!==null&&c!==void 0?c:{},d=h.row,p=h.col,m=He(d)?o.hot.toVisualRow(d):null,g=He(p)?o.hot.toVisualColumn(p):null;if(!(m===null||g===null)){var v=u==null||(f=u.address)===null||f===void 0?void 0:f.sheet,S=s(u);if(v!==void 0&&!l.has(S)){var b=fB(o.engine).get(v);if(!b)return;b.validateCell(b.getDataAtCell(m,g),b.getCellMeta(m,g),function(){})}}})}},{key:"syncChangeWithEngine",value:function(i,o,a){var s={row:this.toPhysicalRowPosition(i),col:this.toPhysicalColumnPosition(o),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){Xt("Not possible to set cell data at ".concat(JSON.stringify(s)));return}return this.engine.setCellContents(s,a)}},{key:"onBeforeValidate",value:function(i,o,a){var s=this.hot.propToCol(a);if(this.isFormulaCellType(o,s)){var l={row:this.hot.toPhysicalRow(o),col:this.hot.toPhysicalColumn(s),sheet:this.sheetId},u=this.engine.getCellValue(l);return ml(u)==="object"&&u!==null?u.value:u}return i}},{key:"onBeforeAutofill",value:function(i,o,a){var s=this,l=function(h){return pB(pB({},h),{},{sheet:s.sheetId})},u={start:l(o.getTopStartCorner()),end:l(o.getBottomEndCorner())},c={start:l(a.getTopStartCorner()),end:l(a.getBottomEndCorner())};return this.engine.isItPossibleToSetCellContents(c)===!1?!1:this.engine.getFillRangeData(u,c)}},{key:"onBeforeLoadData",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(gs(Yn))||nf(this,CC,tr(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(gs(Yn)))if(this.sheetName=VYe(this.engine,this.hot.getSettings()[Yn].sheetName),of(this,CC))this.switchSheet(this.sheetName);else{var s=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,s)){nf(this,Ul,!0);var l=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(l),nf(this,Ul,!1)}}}},{key:"onModifyData",value:function(i,o,a,s){if(!(s!=="get"||of(this,Ul)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(i),u=this.isFormulaCellType(l,o);if(!u){var c=this.getCellType(l,o);if(c!=="ARRAY"){vZ(a.value)&&(a.value=jYe(a.value));return}}var f={row:i,col:this.toPhysicalColumnPosition(o),sheet:this.sheetId},h=this.engine.getCellValue(f),d=ml(h)==="object"&&h!==null?h.value:h;a.value=d}}},{key:"onModifySourceData",value:function(i,o,a,s){if(!(s!=="get"||of(this,Ul)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(i),u=this.hot.propToCol(o),c=this.isFormulaCellType(l,u);if(!c){var f=this.getCellType(l,u);if(f!=="ARRAY")return}var h=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(h.width===0&&h.height===0)){var d={row:i,col:this.toPhysicalColumnPosition(u),sheet:this.sheetId};a.value=this.engine.getCellSerialized(d)}}}},{key:"onAfterSetDataAtCell",value:function(i,o){var a=this;if(!af(o)){var s=[],l=[],u=this.engine.batch(function(){i.forEach(function(c){var f=rf(c,4),h=f[0],d=f[1],p=f[3],m=a.hot.propToCol(d),g=a.hot.toPhysicalRow(h),v=a.hot.toPhysicalColumn(m),S={row:g,col:v,sheet:a.sheetId};g!==null&&v!==null?a.syncChangeWithEngine(h,m,p):s.push([h,m,p]),l.push({address:S})})});s.length&&this.hot.addHookOnce("afterChange",function(){var c=a.engine.batch(function(){s.forEach(function(f){var h=rf(f,3),d=h[0],p=h[1],m=h[2];a.syncChangeWithEngine(d,p,m)})});a.renderDependentSheets(c,!0)}),this.renderDependentSheets(u),this.validateDependentCells(u,l)}}},{key:"onAfterSetSourceDataAtCell",value:function(i,o){var a=this;if(!af(o)){var s=[],l=[];i.forEach(function(u){var c=rf(u,4),f=c[0],h=c[1],d=c[3],p=a.hot.propToCol(h);if(!!zi(p)){var m={row:f,col:a.toPhysicalColumnPosition(p),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(m)){Xt("Not possible to set source cell data at ".concat(JSON.stringify(m)));return}l.push({address:m}),s.push.apply(s,WYe(a.engine.setCellContents(m,d)))}}),this.renderDependentSheets(s),this.validateDependentCells(s,l)}}},{key:"onBeforeCreateRow",value:function(i,o){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(i),o]))return!1}},{key:"onBeforeCreateCol",value:function(i,o){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(i),o]))return!1}},{key:"onBeforeRemoveRow",value:function(i,o,a){var s=this,l=a.every(function(u){return s.engine.isItPossibleToRemoveRows(s.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(i,o,a){var s=this,l=a.every(function(u){return s.engine.isItPossibleToRemoveColumns(s.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(i,o,a){if(!af(a)){var s=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(i),o]);this.renderDependentSheets(s)}}},{key:"onAfterCreateCol",value:function(i,o,a){if(!af(a)){var s=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(i),o]);this.renderDependentSheets(s)}}},{key:"onAfterRemoveRow",value:function(i,o,a,s){var l=this;if(!af(s)){var u=a.sort().reverse(),c=this.engine.batch(function(){u.forEach(function(f){l.engine.removeRows(l.sheetId,[f,1])})});this.renderDependentSheets(c)}}},{key:"onAfterRemoveCol",value:function(i,o,a,s){var l=this;if(!af(s)){var u=a.sort().reverse(),c=this.engine.batch(function(){u.forEach(function(f){l.engine.removeColumns(l.sheetId,[f,1])})});this.renderDependentSheets(c)}}},{key:"onAfterDetachChild",value:function(i,o,a){var s,l=this;nf(this,Ul,!0);var u=this.hot.getSourceDataArray(a,0,a+(((s=o.__children)===null||s===void 0?void 0:s.length)||0),this.hot.countSourceCols());nf(this,Ul,!1),u.forEach(function(c,f){c.forEach(function(h,d){l.engine.setCellContents({col:d,row:a+f,sheet:l.sheetId},[[h]])})})}},{key:"onEngineValuesUpdated",value:function(i){this.hot.runHooks("afterFormulasValuesUpdate",i)}},{key:"onEngineNamedExpressionsAdded",value:function(i,o){this.hot.runHooks("afterNamedExpressionAdded",i,o)}},{key:"onEngineNamedExpressionsRemoved",value:function(i,o){this.hot.runHooks("afterNamedExpressionRemoved",i,o)}},{key:"onEngineSheetAdded",value:function(i){this.hot.runHooks("afterSheetAdded",i)}},{key:"onEngineSheetRenamed",value:function(i,o){this.hot.runHooks("afterSheetRenamed",i,o)}},{key:"onEngineSheetRemoved",value:function(i,o){this.hot.runHooks("afterSheetRemoved",i,o)}}],[{key:"PLUGIN_KEY",get:function(){return Yn}},{key:"PLUGIN_PRIORITY",get:function(){return lKe}}]),r}(jt);function cKe(t,e){return pKe(t)||dKe(t,e)||hKe(t,e)||fKe()}function fKe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hKe(t,e){if(!!t){if(typeof t=="string")return yB(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yB(t,e)}}function yB(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function dKe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function pKe(t){if(Array.isArray(t))return t}function mKe(t){return{key:"hidden_columns_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=cKe(r,4),o=i[1],a=i[3];o-a!==0&&(n=1)}return this.getTranslatedPhrase(yx,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,o=Math.max(Math.min(n.col,i.col),0),a=Math.max(n.col,i.col),s=[],l=o;l<=a;l+=1)s.push(l);t.hideColumns(s);var u=s[s.length-1],c=this.columnIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(c)&&c>=0?this.selectColumns(c):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Z0(t){return bKe(t)||vKe(t)||yKe(t)||gKe()}function gKe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yKe(t,e){if(!!t){if(typeof t=="string")return A7(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A7(t,e)}}function vKe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bKe(t){if(Array.isArray(t))return A7(t)}function A7(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function wKe(t){var e=[];return{key:"hidden_columns_show",name:function(){var n=e.length>1?1:0;return this.getTranslatedPhrase(vx,n)},callback:function(){var n,i;if(e.length!==0){var o=e[0],a=e[e.length-1];o=(n=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&n!==void 0?n:0,a=(i=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0);var s=a-o+1===this.countCols();s||this.selectColumns(o,a)}},disabled:!1,hidden:function(){var n=this,i=bt(t.getHiddenColumns(),function(S){return n.toPhysicalColumn(S)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;e.length=0;var o=this.getSelectedRangeLast(),a=o.getTopStartCorner().col,s=o.getBottomEndCorner().col,l=this.columnIndexMapper,u=l.getRenderableFromVisualIndex(a),c=l.getRenderableFromVisualIndex(s),f=l.getNotTrimmedIndexes(),h=[];if(a!==s){var d=s-a+1,p=c-u+1;if(d>p){var m=f.slice(a,s+1);h.push.apply(h,Z0(m.filter(function(S){return i.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,Z0(f.slice(0,a)));else if(u===null)h.push.apply(h,Z0(f.slice(0,this.countCols())));else{var g=this.countCols()-1,v=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,-1));c===v&&g>s&&h.push.apply(h,Z0(f.slice(s+1)))}return Q(h,function(S){e.push(n.toVisualColumn(S))}),e.length===0}}}function Hd(t){return Hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hd(t)}function SKe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,EKe(n.key),n)}}function RKe(t,e,r){return e&&vB(t.prototype,e),r&&vB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function EKe(t){var e=CKe(t,"string");return Hd(e)==="symbol"?e:String(e)}function CKe(t,e){if(Hd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bu(){return typeof Reflect<"u"&&Reflect.get?bu=Reflect.get.bind():bu=function(e,r,n){var i=_Ke(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},bu.apply(this,arguments)}function _Ke(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ts(t),t!==null););return t}function TKe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x7(t,e)}function x7(t,e){return x7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},x7(t,e)}function OKe(t){var e=xKe();return function(){var n=ts(t),i;if(e){var o=ts(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return AKe(this,i)}}function AKe(t,e){if(e&&(Hd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return I7(t)}function I7(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xKe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ts(t){return ts=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ts(t)}function bB(t,e,r){IKe(t,e),e.set(t,r)}function IKe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ci(t,e){var r=RZ(t,e,"get");return MKe(t,r)}function MKe(t,e){return e.get?e.get.call(t):e.value}function Rm(t,e,r){var n=RZ(t,e,"set");return NKe(t,n,r),r}function RZ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function NKe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}Ue.getSingleton().register("beforeHideColumns");Ue.getSingleton().register("afterHideColumns");Ue.getSingleton().register("beforeUnhideColumns");Ue.getSingleton().register("afterUnhideColumns");var _C="hiddenColumns",PKe=310,Uo=new WeakMap,Vo=new WeakMap,kKe=function(t){TKe(r,t);var e=OKe(r);function r(){var n;SKe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),bB(I7(n),Uo,{writable:!0,value:{}}),bB(I7(n),Vo,{writable:!0,value:null}),n}return RKe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[_C]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[_C];wt(o)&&(Rm(this,Uo,o),tr(o.copyPasteEnabled)&&(o.copyPasteEnabled=!0)),Rm(this,Vo,new A6),Ci(this,Vo).addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,Ci(this,Vo)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(a,s,l){return i.onAfterGetCellMeta(a,s,l)}),this.addHook("modifyColWidth",function(a,s){return i.onModifyColWidth(a,s)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(a){return i.onModifyCopyableRange(a)}),bu(ts(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),bu(ts(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Rm(this,Uo,{}),bu(ts(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(i){var o=this,a=this.getHiddenColumns(),s=this.isValidConfig(i),l=a,u=Ci(this,Vo).getValues().slice(),c=i.length>0;if(s&&c){var f=i.map(function(d){return o.hot.toPhysicalColumn(d)});Q(f,function(d){u[d]=!1}),l=Hn(u,function(d,p,m){return p&&d.push(o.hot.toVisualColumn(m)),d},[])}var h=this.hot.runHooks("beforeUnhideColumns",a,l,s&&c);h!==!1&&(s&&c&&Ci(this,Vo).setValues(u),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,l,s&&c,s&&l.length<a.length))}},{key:"showColumn",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.showColumns(o)}},{key:"hideColumns",value:function(i){var o=this,a=this.getHiddenColumns(),s=this.isValidConfig(i),l=a;s&&(l=Array.from(new Set(a.concat(i))));var u=this.hot.runHooks("beforeHideColumns",a,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){Q(i,function(c){Ci(o,Vo).setValueAtIndex(o.hot.toPhysicalColumn(c),!0)})},!0),this.hot.runHooks("afterHideColumns",a,l,s,s&&l.length>a.length))}},{key:"hideColumn",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.hideColumns(o)}},{key:"getHiddenColumns",value:function(){var i=this;return bt(Ci(this,Vo).getHiddenIndexes(),function(o){return i.hot.toVisualColumn(o)})}},{key:"isHidden",value:function(i){return Ci(this,Vo).getValueAtIndex(this.hot.toPhysicalColumn(i))||!1}},{key:"isValidConfig",value:function(i){var o=this.hot.countCols();return Array.isArray(i)&&i.length>0?i.every(function(a){return Number.isInteger(a)&&a>=0&&a<o}):!1}},{key:"resetCellsMeta",value:function(){Q(this.hot.getCellsMeta(),function(i){i&&(i.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(i,o){if(this.isHidden(o))return 0;if(Ci(this,Uo).indicators&&(this.isHidden(o+1)||this.isHidden(o-1))&&typeof i=="number"&&this.hot.hasColHeaders())return i+15}},{key:"onAfterGetCellMeta",value:function(i,o,a){if(Ci(this,Uo).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipColumnOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var s=a.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenColumn");l>-1&&s.splice(l,1),a.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var o=this;if(Ci(this,Uo).copyPasteEnabled)return i;var a=[],s=function(u,c,f,h){a.push({startRow:u,endRow:c,startCol:f,endCol:h})};return Q(i,function(l){var u=!0,c=0;Ye(l.startCol,l.endCol,function(f){o.isHidden(f)?(u||s(l.startRow,l.endRow,c,f-1),u=!0):(u&&(c=f),f===l.endCol&&s(l.startRow,l.endRow,c,f),u=!1)})}),a}},{key:"onAfterGetColHeader",value:function(i,o){if(!(!Ci(this,Uo).indicators||i<0)){var a=[];i>=1&&this.isHidden(i-1)&&a.push("afterHiddenColumn"),i<this.hot.countCols()-1&&this.isHidden(i+1)&&a.push("beforeHiddenColumn"),Re(o,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:vt},mKe(this),wKe(this))}},{key:"onMapInit",value:function(){Array.isArray(Ci(this,Uo).columns)&&this.hideColumns(Ci(this,Uo).columns)}},{key:"destroy",value:function(){Rm(this,Uo,null),Rm(this,Vo,null),bu(ts(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return _C}},{key:"PLUGIN_PRIORITY",get:function(){return PKe}}]),r}(jt);function $Ke(t,e){return HKe(t)||FKe(t,e)||DKe(t,e)||LKe()}function LKe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DKe(t,e){if(!!t){if(typeof t=="string")return wB(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wB(t,e)}}function wB(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function FKe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function HKe(t){if(Array.isArray(t))return t}function BKe(t){return{key:"hidden_rows_hide",name:function(){var r=this.getSelectedLast(),n=0;if(Array.isArray(r)){var i=$Ke(r,3),o=i[0],a=i[2];o-a!==0&&(n=1)}return this.getTranslatedPhrase(bx,n)},callback:function(){for(var r=this.getSelectedRangeLast(),n=r.from,i=r.to,o=Math.max(Math.min(n.row,i.row),0),a=Math.max(n.row,i.row),s=[],l=o;l<=a;l+=1)s.push(l);t.hideRows(s);var u=s[s.length-1],c=this.rowIndexMapper.getNearestNotHiddenIndex(u,1,!0);Number.isInteger(c)&&c>=0?this.selectRows(c):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function J0(t){return WKe(t)||jKe(t)||VKe(t)||UKe()}function UKe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VKe(t,e){if(!!t){if(typeof t=="string")return M7(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M7(t,e)}}function jKe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function WKe(t){if(Array.isArray(t))return M7(t)}function M7(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zKe(t){var e=[];return{key:"hidden_rows_show",name:function(){var n=e.length>1?1:0;return this.getTranslatedPhrase(wx,n)},callback:function(){var n,i;if(e.length!==0){var o=e[0],a=e[e.length-1];o=(n=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&n!==void 0?n:0,a=(i=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0);var s=a-o+1===this.countRows();s||this.selectRows(o,a)}},disabled:!1,hidden:function(){var n=this,i=bt(t.getHiddenRows(),function(S){return n.toPhysicalRow(S)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;e.length=0;var o=this.getSelectedRangeLast(),a=o.getTopStartCorner().row,s=o.getBottomEndCorner().row,l=this.rowIndexMapper,u=l.getRenderableFromVisualIndex(a),c=l.getRenderableFromVisualIndex(s),f=l.getNotTrimmedIndexes(),h=[];if(a!==s){var d=s-a+1,p=c-u+1;if(d>p){var m=f.slice(a,s+1);h.push.apply(h,J0(m.filter(function(S){return i.includes(S)})))}}else if(u===0&&u<a)h.push.apply(h,J0(f.slice(0,a)));else if(u===null)h.push.apply(h,J0(f.slice(0,this.countRows())));else{var g=this.countRows()-1,v=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,-1));c===v&&g>s&&h.push.apply(h,J0(f.slice(s+1)))}return Q(h,function(S){e.push(n.toVisualRow(S))}),e.length===0}}}function Bd(t){return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bd(t)}function GKe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function SB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,KKe(n.key),n)}}function YKe(t,e,r){return e&&SB(t.prototype,e),r&&SB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function KKe(t){var e=qKe(t,"string");return Bd(e)==="symbol"?e:String(e)}function qKe(t,e){if(Bd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wu(){return typeof Reflect<"u"&&Reflect.get?wu=Reflect.get.bind():wu=function(e,r,n){var i=XKe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},wu.apply(this,arguments)}function XKe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=rs(t),t!==null););return t}function QKe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&N7(t,e)}function N7(t,e){return N7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},N7(t,e)}function ZKe(t){var e=eqe();return function(){var n=rs(t),i;if(e){var o=rs(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return JKe(this,i)}}function JKe(t,e){if(e&&(Bd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P7(t)}function P7(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rs(t){return rs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rs(t)}function RB(t,e,r){tqe(t,e),e.set(t,r)}function tqe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bi(t,e){var r=EZ(t,e,"get");return rqe(t,r)}function rqe(t,e){return e.get?e.get.call(t):e.value}function Em(t,e,r){var n=EZ(t,e,"set");return nqe(t,n,r),r}function EZ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function nqe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}Ue.getSingleton().register("beforeHideRows");Ue.getSingleton().register("afterHideRows");Ue.getSingleton().register("beforeUnhideRows");Ue.getSingleton().register("afterUnhideRows");var TC="hiddenRows",iqe=320,Ta=new WeakMap,jo=new WeakMap,oqe=function(t){QKe(r,t);var e=ZKe(r);function r(){var n;GKe(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),RB(P7(n),Ta,{writable:!0,value:{}}),RB(P7(n),jo,{writable:!0,value:null}),n}return YKe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[TC]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[TC];wt(o)&&(Em(this,Ta,o),tr(o.copyPasteEnabled)&&(o.copyPasteEnabled=!0)),Em(this,jo,new A6),Bi(this,jo).addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,Bi(this,jo)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(a,s,l){return i.onAfterGetCellMeta(a,s,l)}),this.addHook("modifyRowHeight",function(a,s){return i.onModifyRowHeight(a,s)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(a){return i.onModifyCopyableRange(a)}),wu(rs(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),wu(rs(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Em(this,Ta,{}),wu(rs(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(i){var o=this,a=this.getHiddenRows(),s=this.isValidConfig(i),l=a,u=Bi(this,jo).getValues().slice(),c=i.length>0;if(s&&c){var f=i.map(function(d){return o.hot.toPhysicalRow(d)});Q(f,function(d){u[d]=!1}),l=Hn(u,function(d,p,m){return p&&d.push(o.hot.toVisualRow(m)),d},[])}var h=this.hot.runHooks("beforeUnhideRows",a,l,s&&c);h!==!1&&(s&&c&&Bi(this,jo).setValues(u),this.hot.runHooks("afterUnhideRows",a,l,s&&c,s&&l.length<a.length))}},{key:"showRow",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.showRows(o)}},{key:"hideRows",value:function(i){var o=this,a=this.getHiddenRows(),s=this.isValidConfig(i),l=a;s&&(l=Array.from(new Set(a.concat(i))));var u=this.hot.runHooks("beforeHideRows",a,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){Q(i,function(c){Bi(o,jo).setValueAtIndex(o.hot.toPhysicalRow(c),!0)})},!0),this.hot.runHooks("afterHideRows",a,l,s,s&&l.length>a.length))}},{key:"hideRow",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.hideRows(o)}},{key:"getHiddenRows",value:function(){var i=this;return bt(Bi(this,jo).getHiddenIndexes(),function(o){return i.hot.toVisualRow(o)})}},{key:"isHidden",value:function(i){return Bi(this,jo).getValueAtIndex(this.hot.toPhysicalRow(i))||!1}},{key:"isValidConfig",value:function(i){var o=this.hot.countRows();return Array.isArray(i)&&i.length>0?i.every(function(a){return Number.isInteger(a)&&a>=0&&a<o}):!1}},{key:"resetCellsMeta",value:function(){Q(this.hot.getCellsMeta(),function(i){i&&(i.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(i,o){return this.isHidden(o)?0:i}},{key:"onAfterGetCellMeta",value:function(i,o,a){if(Bi(this,Ta).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipRowOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var s=a.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenRow");l>-1&&s.splice(l,1),a.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var o=this;if(Bi(this,Ta).copyPasteEnabled)return i;var a=[],s=function(u,c,f,h){a.push({startRow:u,endRow:c,startCol:f,endCol:h})};return Q(i,function(l){var u=!0,c=0;Ye(l.startRow,l.endRow,function(f){o.isHidden(f)?(u||s(c,f-1,l.startCol,l.endCol),u=!0):(u&&(c=f),f===l.endRow&&s(c,f,l.startCol,l.endCol),u=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(i,o){if(!(!Bi(this,Ta).indicators||i<0)){var a=[];i>=1&&this.isHidden(i-1)&&a.push("afterHiddenRow"),i<this.hot.countRows()-1&&this.isHidden(i+1)&&a.push("beforeHiddenRow"),Re(o,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:vt},BKe(this),zKe(this))}},{key:"onMapInit",value:function(){Array.isArray(Bi(this,Ta).rows)&&this.hideRows(Bi(this,Ta).rows)}},{key:"destroy",value:function(){Em(this,Ta,null),Em(this,jo,null),wu(rs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return TC}},{key:"PLUGIN_PRIORITY",get:function(){return iqe}}]),r}(jt);function aqe(t,e){return cqe(t)||uqe(t,e)||lqe(t,e)||sqe()}function sqe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lqe(t,e){if(!!t){if(typeof t=="string")return EB(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EB(t,e)}}function EB(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function uqe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function cqe(t){if(Array.isArray(t))return t}function fqe(t){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(Y3)},callback:function(r,n){var i=aqe(n,1),o=i[0].start.col;t.freezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function hqe(t,e){return gqe(t)||mqe(t,e)||pqe(t,e)||dqe()}function dqe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pqe(t,e){if(!!t){if(typeof t=="string")return CB(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CB(t,e)}}function CB(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function mqe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function gqe(t){if(Array.isArray(t))return t}function yqe(t){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(K3)},callback:function(r,n){var i=hqe(n,1),o=i[0].start.col;t.unfreezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var r=this.getSelectedRange(),n=!1;return(r===void 0||r.length>1||r[0].from.col!==r[0].to.col||r[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Ud(t){return Ud=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ud(t)}function vqe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _B(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wqe(n.key),n)}}function bqe(t,e,r){return e&&_B(t.prototype,e),r&&_B(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wqe(t){var e=Sqe(t,"string");return Ud(e)==="symbol"?e:String(e)}function Sqe(t,e){if(Ud(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ud(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qf(){return typeof Reflect<"u"&&Reflect.get?Qf=Reflect.get.bind():Qf=function(e,r,n){var i=Rqe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Qf.apply(this,arguments)}function Rqe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=sl(t),t!==null););return t}function Eqe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&k7(t,e)}function k7(t,e){return k7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},k7(t,e)}function Cqe(t){var e=Tqe();return function(){var n=sl(t),i;if(e){var o=sl(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _qe(this,i)}}function _qe(t,e){if(e&&(Ud(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CZ(t)}function CZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Tqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sl(t){return sl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sl(t)}Ue.getSingleton().register("beforeColumnFreeze");Ue.getSingleton().register("afterColumnFreeze");Ue.getSingleton().register("beforeColumnUnfreeze");Ue.getSingleton().register("afterColumnUnfreeze");var TB="manualColumnFreeze",Oqe=110,Cm=new WeakMap,Aqe=function(t){Eqe(r,t);var e=Cqe(r);function r(n){var i;return vqe(this,r),i=e.call(this,n),Cm.set(CZ(i),{afterFirstUse:!1}),i}return bqe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[TB]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(o){return i.addContextMenuEntry(o)}),this.addHook("beforeColumnMove",function(o,a){return i.onBeforeColumnMove(o,a)}),Qf(sl(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=Cm.get(this);i.afterFirstUse=!1,Qf(sl(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Qf(sl(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(i){var o=Cm.get(this),a=this.hot.getSettings(),s=a.fixedColumnsStart<this.hot.countCols()&&i>a.fixedColumnsStart-1;o.afterFirstUse||(o.afterFirstUse=!0);var l=this.hot.runHooks("beforeColumnFreeze",i,s);l!==!1&&(s&&(this.hot.columnIndexMapper.moveIndexes(i,a.fixedColumnsStart),a._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",i,s))}},{key:"unfreezeColumn",value:function(i){var o=Cm.get(this),a=this.hot.getSettings(),s=a.fixedColumnsStart>0&&i<=a.fixedColumnsStart-1;o.afterFirstUse||(o.afterFirstUse=!0);var l=this.hot.runHooks("beforeColumnUnfreeze",i,s);l!==!1&&(s&&(a._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(i,a.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",i,s))}},{key:"addContextMenuEntry",value:function(i){i.items.push({name:"---------"},fqe(this),yqe(this))}},{key:"onBeforeColumnMove",value:function(i,o){var a=Cm.get(this);if(a.afterFirstUse){var s=this.hot.getSettings().fixedColumnsStart;if(o<s||i.some(function(l){return l<s}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return TB}},{key:"PLUGIN_PRIORITY",get:function(){return Oqe}}]),r}(jt);function mv(t){return mv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mv(t)}function xqe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mqe(n.key),n)}}function Iqe(t,e,r){return e&&OB(t.prototype,e),r&&OB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Mqe(t){var e=Nqe(t,"string");return mv(e)==="symbol"?e:String(e)}function Nqe(t,e){if(mv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(mv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var OC=0,AB=1,xB=2,sf="px",Pqe=function(){function t(e){xqe(this,t),this.hot=e,this._element=null,this.state=OC,this.inlineProperty=e.isRtl()?"right":"left"}return Iqe(t,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=xB}},{key:"build",value:function(){this.state===OC&&(this._element=this.hot.rootDocument.createElement("div"),this.state=AB)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=OC}},{key:"isAppended",value:function(){return this.state===xB}},{key:"isBuilt",value:function(){return this.state>=AB}},{key:"setPosition",value:function(r,n){zi(r)&&(this._element.style.top=r+sf),zi(n)&&(this._element.style[this.inlineProperty]=n+sf)}},{key:"getPosition",value:function(){var r=this._element.style;return{top:r.top?parseInt(r.top,10):0,start:r[this.inlineProperty]?parseInt(r[this.inlineProperty],10):0}}},{key:"setSize",value:function(r,n){zi(r)&&(this._element.style.width=r+sf),zi(n)&&(this._element.style.height=n+sf)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){zi(r)&&(this._element.style.marginTop=r+sf),zi(n)&&(this._element.style["margin".concat(gs(this.inlineProperty))]=n+sf)}},{key:"getOffset",value:function(){var r=this._element.style,n="margin".concat(gs(this.inlineProperty));return{top:r.marginTop?parseInt(r.marginTop,10):0,start:r[n]?parseInt(r[n],10):0}}}]),t}();const _Z=Pqe;function Vd(t){return Vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vd(t)}function kqe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function IB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lqe(n.key),n)}}function $qe(t,e,r){return e&&IB(t.prototype,e),r&&IB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Lqe(t){var e=Dqe(t,"string");return Vd(e)==="symbol"?e:String(e)}function Dqe(t,e){if(Vd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function y2(){return typeof Reflect<"u"&&Reflect.get?y2=Reflect.get.bind():y2=function(e,r,n){var i=Fqe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},y2.apply(this,arguments)}function Fqe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=jd(t),t!==null););return t}function Hqe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$7(t,e)}function $7(t,e){return $7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$7(t,e)}function Bqe(t){var e=jqe();return function(){var n=jd(t),i;if(e){var o=jd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Uqe(this,i)}}function Uqe(t,e){if(e&&(Vd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vqe(t)}function Vqe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jd(t){return jd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jd(t)}var Wqe="ht__manualColumnMove--backlight",zqe=function(t){Hqe(r,t);var e=Bqe(r);function r(){return kqe(this,r),e.apply(this,arguments)}return $qe(r,[{key:"build",value:function(){y2(jd(r.prototype),"build",this).call(this),Re(this._element,Wqe)}}]),r}(_Z);const Gqe=zqe;function Wd(t){return Wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wd(t)}function Yqe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function MB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qqe(n.key),n)}}function Kqe(t,e,r){return e&&MB(t.prototype,e),r&&MB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function qqe(t){var e=Xqe(t,"string");return Wd(e)==="symbol"?e:String(e)}function Xqe(t,e){if(Wd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function v2(){return typeof Reflect<"u"&&Reflect.get?v2=Reflect.get.bind():v2=function(e,r,n){var i=Qqe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},v2.apply(this,arguments)}function Qqe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=zd(t),t!==null););return t}function Zqe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&L7(t,e)}function L7(t,e){return L7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},L7(t,e)}function Jqe(t){var e=rXe();return function(){var n=zd(t),i;if(e){var o=zd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return eXe(this,i)}}function eXe(t,e){if(e&&(Wd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tXe(t)}function tXe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rXe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zd(t){return zd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zd(t)}var nXe="ht__manualColumnMove--guideline",iXe=function(t){Zqe(r,t);var e=Jqe(r);function r(){return Yqe(this,r),e.apply(this,arguments)}return Kqe(r,[{key:"build",value:function(){v2(zd(r.prototype),"build",this).call(this),Re(this._element,nXe)}}]),r}(_Z);const oXe=iXe;function Gd(t){return Gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gd(t)}function aXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function NB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lXe(n.key),n)}}function sXe(t,e,r){return e&&NB(t.prototype,e),r&&NB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function lXe(t){var e=uXe(t,"string");return Gd(e)==="symbol"?e:String(e)}function uXe(t,e){if(Gd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Su(){return typeof Reflect<"u"&&Reflect.get?Su=Reflect.get.bind():Su=function(e,r,n){var i=cXe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Su.apply(this,arguments)}function cXe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ns(t),t!==null););return t}function fXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&D7(t,e)}function D7(t,e){return D7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},D7(t,e)}function hXe(t){var e=pXe();return function(){var n=ns(t),i;if(e){var o=ns(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return dXe(this,i)}}function dXe(t,e){if(e&&(Gd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return F7(t)}function F7(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pXe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ns(t){return ns=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ns(t)}Ue.getSingleton().register("beforeColumnMove");Ue.getSingleton().register("afterColumnMove");var AC="manualColumnMove",mXe=120,$s=new WeakMap,PB="ht__manualColumnMove",eb="show-ui",xC="on-moving--columns",IC="after-selection--columns",gXe=function(t){fXe(r,t);var e=hXe(r);function r(n){var i;return aXe(this,r),i=e.call(this,n),$s.set(F7(i),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),i.eventManager=new Er(F7(i)),i.backlight=new Gqe(n),i.guideline=new oXe(n),i}return sXe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[AC]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollVertically",function(){return i.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),Re(this.hot.rootElement,PB),Su(ns(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),Su(ns(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){ut(this.hot.rootElement,PB),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Su(ns(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(i,o){return this.moveColumns([i],o)}},{key:"moveColumns",value:function(i,o){var a=$s.get(this),s=a.cachedDropIndex,l=this.isMovePossible(i,o),u=this.hot.runHooks("beforeColumnMove",i,o,s,l);if(a.cachedDropIndex=void 0,u!==!1){l&&this.hot.columnIndexMapper.moveIndexes(i,o);var c=l&&this.isColumnOrderChanged(i,o);return this.hot.runHooks("afterColumnMove",i,o,s,l,c),c}}},{key:"dragColumn",value:function(i,o){return this.dragColumns([i],o)}},{key:"dragColumns",value:function(i,o){var a=this.countFinalIndex(i,o),s=$s.get(this);return s.cachedDropIndex=o,this.moveColumns(i,a)}},{key:"isMovePossible",value:function(i,o){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=i.length+o>a,l=o<0,u=i.some(function(f){return f<0}),c=i.some(function(f){return f>=a});return!(s||l||u||c)}},{key:"isColumnOrderChanged",value:function(i,o){return i.some(function(a,s){return a-s!==o})}},{key:"countFinalIndex",value:function(i,o){var a=Hn(i,function(s,l){return l<o&&(s+=1),s},0);return o-a}},{key:"getColumnsWidth",value:function(i,o){for(var a=this.hot.columnIndexMapper,s=0,l=i;l<=o;l+=1){var u=a.getRenderableFromVisualIndex(l);l<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:u!==null&&(s+=this.hot.view._wt.wtTable.getStretchedColumnWidth(u)||0)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[AC];if(Array.isArray(i))this.moveColumns(i,0);else if(i!==void 0){var o=this.persistentStateLoad();o.length&&this.moveColumns(o,0)}}},{key:"isFixedColumnsStart",value:function(i){return i<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",i),i.value?i.value:[]}},{key:"prepareColumnsToMoving",value:function(i,o){var a=[];return Ye(i,o,function(s){a.push(s)}),a}},{key:"refreshPositions",value:function(){var i=$s.get(this),o=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(i.hoveredColumn)&&o>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1));var a=this.hot.view._wt.wtTable,s=this.hot.view._wt.wtOverlays.scrollableElement,l=typeof s.scrollX=="number"?s.scrollX:s.scrollLeft,u=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,i.hoveredColumn-1),c=a.hider.offsetWidth,f=a.TBODY.offsetLeft,h=this.backlight.getOffset().start,d=this.backlight.getSize().width,p=0,m=0;if(this.hot.isRtl()){var g=this.hot.rootWindow,v=Qt(this.hot.rootElement),S=g.innerWidth-i.rootElementOffset-v;m=g.innerWidth-i.target.eventPageX-S-(s.scrollX===void 0?l:0)}else m=i.target.eventPageX-(i.rootElementOffset-(s.scrollX===void 0?l:0));if(i.hasRowHeaders&&(p=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(i.hoveredColumn)&&(u+=l),u+=p,i.hoveredColumn<0)i.fixedColumnsStart>0?i.target.col=0:i.target.col=o>0?o-1:o;else if(i.target.TD.offsetWidth/2+u<=m){var b=i.hoveredColumn>=i.countCols?i.countCols-1:i.hoveredColumn;i.target.col=b+1,u+=i.target.TD.offsetWidth}else i.target.col=i.hoveredColumn;var E=m,T=u;m+d+h>=c?E=c-d-h:m+h<f+p&&(E=f+p+Math.abs(h)),u>=c-1?T=c-1:T===0?T=1:s.scrollX!==void 0&&i.hoveredColumn<i.fixedColumnsStart&&(T-=i.rootElementOffset<=s.scrollX?i.rootElementOffset:0),this.backlight.setPosition(null,E),this.guideline.setPosition(null,T)}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(a){return i.onMouseMove(a)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){var l=this.hot.view._wt.wtTable,u=this.hot.selection.isSelectedByColumnHeader(),c=this.hot.getSelectedRangeLast(),f=$s.get(this),h=at(i.target,"sortAction");if(!c||!u||f.pressed||i.button!==0||h){f.pressed=!1,f.columnsToMove.length=0,ut(this.hot.rootElement,[xC,eb]);return}var d=this.guideline.isBuilt()&&!this.guideline.isAppended(),p=this.backlight.isBuilt()&&!this.backlight.isAppended();d&&p&&(this.guideline.appendTo(l.hider),this.backlight.appendTo(l.hider));var m=c.from,g=c.to,v=Math.min(m.col,g.col),S=Math.max(m.col,g.col);if(o.row<0&&o.col>=v&&o.col<=S){s.column=!0,f.pressed=!0,f.target.eventPageX=i.pageX,f.target.eventOffsetX=i.offsetX,f.hoveredColumn=o.col,f.target.TD=a,f.target.col=o.col,f.columnsToMove=this.prepareColumnsToMoving(v,S),f.hasRowHeaders=!!this.hot.getSettings().rowHeaders,f.countCols=this.hot.countCols(),f.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,f.rootElementOffset=Zr(this.hot.rootElement).left;var b=f.hasRowHeaders?-1:0,E=l.holder.scrollTop+l.getColumnHeaderHeight(0)+1,T=o.col<f.fixedColumnsStart,N=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),L=Math.abs(i.offsetX-(this.hot.isRtl()?i.target.offsetWidth:0)),V=this.getColumnsWidth(v,o.col-1)+L,B=this.getColumnsWidth(b,v-1)+(T?N:0)+V;this.backlight.setPosition(E,B),this.backlight.setSize(this.getColumnsWidth(v,S),l.hider.offsetHeight-E),this.backlight.setOffset(null,-V),Re(this.hot.rootElement,xC)}else ut(this.hot.rootElement,IC),f.pressed=!1,f.columnsToMove.length=0}},{key:"onMouseMove",value:function(i){var o=$s.get(this);if(!!o.pressed){if(i.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}o.target.eventPageX=i.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,a,s){var l=this.hot.getSelectedRangeLast(),u=$s.get(this);!l||!u.pressed||(u.columnsToMove.indexOf(o.col)>-1?ut(this.hot.rootElement,eb):Re(this.hot.rootElement,eb),s.row=!0,s.column=!0,s.cell=!0,u.hoveredColumn=o.col,u.target.TD=a)}},{key:"onMouseUp",value:function(){var i=$s.get(this),o=i.target.col,a=i.columnsToMove.length;if(i.hoveredColumn=void 0,i.pressed=!1,i.backlightWidth=0,ut(this.hot.rootElement,[xC,eb,IC]),this.hot.selection.isSelectedByColumnHeader()&&Re(this.hot.rootElement,IC),!(a<1||o===void 0)){var s=i.columnsToMove[0],l=this.hot.toPhysicalColumn(s),u=this.dragColumns(i.columnsToMove,o);if(i.columnsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var c=this.hot.toVisualColumn(l),f=c+a-1;this.hot.selectColumns(c,f)}}}},{key:"onAfterScrollVertically",value:function(){var i=this.hot.view._wt.wtTable,o=i.getColumnHeaderHeight(0)+1,a=i.holder.scrollTop,s=o+a;this.backlight.setPosition(s),this.backlight.setSize(null,i.hider.offsetHeight-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Su(ns(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return AC}},{key:"PLUGIN_PRIORITY",get:function(){return mXe}}]),r}(jt);function Yd(t){return Yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yd(t)}function yXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bXe(n.key),n)}}function vXe(t,e,r){return e&&kB(t.prototype,e),r&&kB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function bXe(t){var e=wXe(t,"string");return Yd(e)==="symbol"?e:String(e)}function wXe(t,e){if(Yd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ru(){return typeof Reflect<"u"&&Reflect.get?Ru=Reflect.get.bind():Ru=function(e,r,n){var i=SXe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ru.apply(this,arguments)}function SXe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=is(t),t!==null););return t}function RXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&H7(t,e)}function H7(t,e){return H7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},H7(t,e)}function EXe(t){var e=_Xe();return function(){var n=is(t),i;if(e){var o=is(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return CXe(this,i)}}function CXe(t,e){if(e&&(Yd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B7(t)}function B7(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _Xe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function is(t){return is=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},is(t)}var tb="manualColumnResize",TXe=130,$B="manualColumnWidths",MC=new WeakMap,OXe=function(t){RXe(r,t);var e=EXe(r);function r(n){var i;yXe(this,r),i=e.call(this,n);var o=i.hot.rootDocument;return i.currentTH=null,i.currentCol=null,i.selectedCols=[],i.currentWidth=null,i.newSize=null,i.startY=null,i.startWidth=null,i.startOffset=null,i.handle=o.createElement("DIV"),i.guide=o.createElement("DIV"),i.eventManager=new Er(B7(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.columnWidthsMap=void 0,MC.set(B7(i),{config:void 0}),Re(i.handle,"manualColumnResizer"),Re(i.guide,"manualColumnResizerGuide"),i}return vXe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[tb]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnWidthsMap=new Cl,this.columnWidthsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(o,a){return i.onModifyColWidth(o,a)}),this.addHook("beforeStretchingColumnWidth",function(o,a){return i.onBeforeStretchingColumnWidth(o,a)}),this.addHook("beforeColumnResize",function(o,a,s){return i.onBeforeColumnResize(o,a,s)}),this.bindEvents(),Ru(is(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ru(is(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=MC.get(this);i.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),Ru(is(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",$B,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",$B,i),i.value}},{key:"setManualSize",value:function(i,o){var a=Math.max(o,20),s=this.hot.toPhysicalColumn(i);return this.columnWidthsMap.setValueAtIndex(s,a),a}},{key:"clearManualSize",value:function(i){var o=this.hot.toPhysicalColumn(i);this.columnWidthsMap.setValueAtIndex(o,null)}},{key:"onMapInit",value:function(){var i=this,o=MC.get(this),a=this.hot.getSettings()[tb],s=this.loadManualColumnWidths();typeof s<"u"?this.hot.batchExecution(function(){s.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0),o.config=a):a===!0&&Array.isArray(o.config)&&this.hot.batchExecution(function(){o.config.forEach(function(l,u){i.columnWidthsMap.setValueAtIndex(u,l)})},!0)}},{key:"setupHandlePosition",value:function(i){var o=this;if(!!i.parentNode){this.currentTH=i;var a=this.hot.view._wt,s=a.wtTable.getCoords(this.currentTH),l=s.col;if(!(l<0)){var u=wr(this.currentTH),c=this.currentTH.getBoundingClientRect(),f=l<a.getSetting("fixedColumnsStart"),h;f&&(h=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),h||(h=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.selectedCols=[];var d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){var p=this.hot.getSelectedRange();Q(p,function(m){var g=m.getTopStartCorner().col,v=m.getBottomEndCorner().col;Ye(g,v,function(S){o.selectedCols.includes(S)||o.selectedCols.push(S)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=h.start-6,this.startWidth=parseInt(c.width,10),this.handle.style.top="".concat(h.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(wr(this.handle),10),o=parseInt(this.handle.style.top,10)+i,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Re(this.handle,"active"),Re(this.guide,"active"),this.guide.style.top="".concat(o,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(a-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){ut(this.handle,"active"),ut(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(i){return!!Fu(i,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"onMouseOver",value:function(i){if(!HK(i.target)&&this.checkIfColumnHeader(i.target)){var o=this.getClosestTHParent(i.target);if(!o)return;var a=o.getAttribute("colspan");o&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(o))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},a=function(u,c){var f=i.hot.runHooks("beforeColumnResize",i.newSize,u,!0);f!==void 0&&(i.newSize=f),i.hot.getSettings().stretchH==="all"?i.clearManualSize(u):i.setManualSize(u,i.newSize),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,u,!0),c&&o()};if(this.dblclick>=2){var s=this.selectedCols.length;s>1?(Q(this.selectedCols,function(l){a(l)}),o()):Q(this.selectedCols,function(l){a(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var o=this;at(i.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return o.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=i.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(i){var o=this;if(this.pressed){var a=(i.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+a,Q(this.selectedCols,function(s){o.newSize=o.setManualSize(s,o.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},a=function(u,c){i.hot.runHooks("beforeColumnResize",i.newSize,u,!1),c&&o(),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var s=this.selectedCols.length;s>1?(Q(this.selectedCols,function(l){a(l)}),o()):Q(this.selectedCols,function(l){a(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,o=this.hot,a=o.rootWindow,s=o.rootElement;this.eventManager.addEventListener(s,"mouseover",function(l){return i.onMouseOver(l)}),this.eventManager.addEventListener(s,"mousedown",function(l){return i.onMouseDown(l)}),this.eventManager.addEventListener(a,"mousemove",function(l){return i.onMouseMove(l)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyColWidth",value:function(i,o){var a=i;if(this.enabled){var s=this.hot.toPhysicalColumn(o),l=this.columnWidthsMap.getValueAtIndex(s);this.hot.getSettings()[tb]&&l&&(a=l)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(i,o){var a=this.columnWidthsMap.getValueAtIndex(o);return a===null&&(a=i),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){Ru(is(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return tb}},{key:"PLUGIN_PRIORITY",get:function(){return TXe}}]),r}(jt);function gv(t){return gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gv(t)}function AXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,IXe(n.key),n)}}function xXe(t,e,r){return e&&LB(t.prototype,e),r&&LB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function IXe(t){var e=MXe(t,"string");return gv(e)==="symbol"?e:String(e)}function MXe(t,e){if(gv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(gv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var NC=0,DB=1,FB=2,lf="px",NXe=function(){function t(e){AXe(this,t),this.hot=e,this._element=null,this.state=NC}return xXe(t,[{key:"appendTo",value:function(r){r.appendChild(this._element),this.state=FB}},{key:"build",value:function(){this.state===NC&&(this._element=this.hot.rootDocument.createElement("div"),this.state=DB)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=NC}},{key:"isAppended",value:function(){return this.state===FB}},{key:"isBuilt",value:function(){return this.state>=DB}},{key:"setPosition",value:function(r,n){r!==void 0&&(this._element.style.top=r+lf),n!==void 0&&(this._element.style.left=n+lf)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(r,n){r&&(this._element.style.width=r+lf),n&&(this._element.style.height=n+lf)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(r,n){r&&(this._element.style.marginTop=r+lf),n&&(this._element.style.marginLeft=n+lf)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),t}();const TZ=NXe;function Kd(t){return Kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kd(t)}function PXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function HB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$Xe(n.key),n)}}function kXe(t,e,r){return e&&HB(t.prototype,e),r&&HB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $Xe(t){var e=LXe(t,"string");return Kd(e)==="symbol"?e:String(e)}function LXe(t,e){if(Kd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function b2(){return typeof Reflect<"u"&&Reflect.get?b2=Reflect.get.bind():b2=function(e,r,n){var i=DXe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},b2.apply(this,arguments)}function DXe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=qd(t),t!==null););return t}function FXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&U7(t,e)}function U7(t,e){return U7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},U7(t,e)}function HXe(t){var e=VXe();return function(){var n=qd(t),i;if(e){var o=qd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return BXe(this,i)}}function BXe(t,e){if(e&&(Kd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UXe(t)}function UXe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function VXe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qd(t){return qd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qd(t)}var jXe="ht__manualRowMove--backlight",WXe=function(t){FXe(r,t);var e=HXe(r);function r(){return PXe(this,r),e.apply(this,arguments)}return kXe(r,[{key:"build",value:function(){b2(qd(r.prototype),"build",this).call(this),Re(this._element,jXe)}}]),r}(TZ);const zXe=WXe;function Xd(t){return Xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xd(t)}function GXe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function BB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,KXe(n.key),n)}}function YXe(t,e,r){return e&&BB(t.prototype,e),r&&BB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function KXe(t){var e=qXe(t,"string");return Xd(e)==="symbol"?e:String(e)}function qXe(t,e){if(Xd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Xd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function w2(){return typeof Reflect<"u"&&Reflect.get?w2=Reflect.get.bind():w2=function(e,r,n){var i=XXe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},w2.apply(this,arguments)}function XXe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Qd(t),t!==null););return t}function QXe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&V7(t,e)}function V7(t,e){return V7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},V7(t,e)}function ZXe(t){var e=tQe();return function(){var n=Qd(t),i;if(e){var o=Qd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return JXe(this,i)}}function JXe(t,e){if(e&&(Xd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eQe(t)}function eQe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tQe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qd(t){return Qd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qd(t)}var rQe="ht__manualRowMove--guideline",nQe=function(t){QXe(r,t);var e=ZXe(r);function r(){return GXe(this,r),e.apply(this,arguments)}return YXe(r,[{key:"build",value:function(){w2(Qd(r.prototype),"build",this).call(this),Re(this._element,rQe)}}]),r}(TZ);const iQe=nQe;function Zd(t){return Zd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zd(t)}function oQe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function UB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sQe(n.key),n)}}function aQe(t,e,r){return e&&UB(t.prototype,e),r&&UB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function sQe(t){var e=lQe(t,"string");return Zd(e)==="symbol"?e:String(e)}function lQe(t,e){if(Zd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Zd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Eu(){return typeof Reflect<"u"&&Reflect.get?Eu=Reflect.get.bind():Eu=function(e,r,n){var i=uQe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Eu.apply(this,arguments)}function uQe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=os(t),t!==null););return t}function cQe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j7(t,e)}function j7(t,e){return j7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},j7(t,e)}function fQe(t){var e=dQe();return function(){var n=os(t),i;if(e){var o=os(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return hQe(this,i)}}function hQe(t,e){if(e&&(Zd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return W7(t)}function W7(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dQe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function os(t){return os=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},os(t)}Ue.getSingleton().register("beforeRowMove");Ue.getSingleton().register("afterRowMove");var PC="manualRowMove",pQe=140,Ls=new WeakMap,VB="ht__manualRowMove",rb="show-ui",kC="on-moving--rows",$C="after-selection--rows",mQe=function(t){cQe(r,t);var e=fQe(r);function r(n){var i;return oQe(this,r),i=e.call(this,n),Ls.set(W7(i),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),i.eventManager=new Er(W7(i)),i.backlight=new zXe(n),i.guideline=new iQe(n),i}return aQe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PC]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollHorizontally",function(){return i.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.buildPluginUI(),this.registerEvents(),Re(this.hot.rootElement,VB),Eu(os(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),Eu(os(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){ut(this.hot.rootElement,VB),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Eu(os(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(i,o){return this.moveRows([i],o)}},{key:"moveRows",value:function(i,o){var a=Ls.get(this),s=a.cachedDropIndex,l=this.isMovePossible(i,o),u=this.hot.runHooks("beforeRowMove",i,o,s,l);if(a.cachedDropIndex=void 0,u!==!1){l&&this.hot.rowIndexMapper.moveIndexes(i,o);var c=l&&this.isRowOrderChanged(i,o);return this.hot.runHooks("afterRowMove",i,o,s,l,c),c}}},{key:"dragRow",value:function(i,o){return this.dragRows([i],o)}},{key:"dragRows",value:function(i,o){var a=this.countFinalIndex(i,o),s=Ls.get(this);return s.cachedDropIndex=o,this.moveRows(i,a)}},{key:"isMovePossible",value:function(i,o){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=i.length+o>a,l=o<0,u=i.some(function(f){return f<0}),c=i.some(function(f){return f>=a});return!(s||l||u||c)}},{key:"isRowOrderChanged",value:function(i,o){return i.some(function(a,s){return a-s!==o})}},{key:"countFinalIndex",value:function(i,o){var a=Hn(i,function(s,l){return l<o&&(s+=1),s},0);return o-a}},{key:"getRowsHeight",value:function(i,o){for(var a=this.hot.rowIndexMapper,s=0,l=i;l<=o;l++){var u=a.getRenderableFromVisualIndex(l);u!==null&&(s+=this.hot.view._wt.wtTable.getRowHeight(u)||23)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[PC];if(Array.isArray(i))this.moveRows(i,0);else if(i!==void 0){var o=this.persistentStateLoad();o.length&&this.moveRows(o,0)}}},{key:"isFixedRowTop",value:function(i){return i<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(i){return i>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualRowMove",i),i.value?i.value:[]}},{key:"prepareRowsToMoving",value:function(){var i=this.hot.getSelectedRangeLast(),o=[];if(!i)return o;var a=i.from,s=i.to,l=Math.min(a.row,s.row),u=Math.max(a.row,s.row);return Ye(l,u,function(c){o.push(c)}),o}},{key:"refreshPositions",value:function(){var i=Ls.get(this),o=i.target.coords,a=this.hot.view.getFirstFullyVisibleRow(),s=this.hot.view.getLastFullyVisibleRow(),l=this.hot.countRows();this.isFixedRowTop(o.row)&&a>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a-1,-1)),this.isFixedRowBottom(o.row)&&s<l&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(s+1,1),void 0,!0);var u=this.hot.view._wt.wtTable,c=i.target.TD,f=Zr(this.hot.rootElement),h=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,o.row-1),d=i.target.eventPageY-f.top+u.holder.scrollTop,p=u.hider.offsetHeight,m=u.TBODY.offsetTop,g=this.backlight.getOffset().top,v=this.backlight.getSize().height;this.isFixedRowTop(o.row)&&(h+=u.holder.scrollTop),o.row<0?i.target.row=a>0?a-1:a:c.offsetHeight/2+h<=d?(i.target.row=o.row+1,h+=o.row===0?c.offsetHeight-1:c.offsetHeight):i.target.row=o.row;var S=d,b=h;d+v+g>=p?S=p-v-g:d+g<m&&(S=m+Math.abs(g)),h>=p-1&&(b=p-1),this.backlight.setPosition(S),this.guideline.setPosition(b)}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(a){return i.onMouseMove(a)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){var l=this.hot.view._wt,u=l.wtTable,c=l.wtViewport,f=this.hot.selection.isSelectedByRowHeader(),h=this.hot.getSelectedRangeLast(),d=Ls.get(this);if(!h||!f||d.pressed||i.button!==0){d.pressed=!1,d.rowsToMove.length=0,ut(this.hot.rootElement,[kC,rb]);return}var p=this.guideline.isBuilt()&&!this.guideline.isAppended(),m=this.backlight.isBuilt()&&!this.backlight.isAppended();p&&m&&(this.guideline.appendTo(u.hider),this.backlight.appendTo(u.hider));var g=h.from,v=h.to,S=Math.min(g.row,v.row),b=Math.max(g.row,v.row);if(o.col<0&&o.row>=S&&o.row<=b){s.row=!0,d.pressed=!0,d.target.eventPageY=i.pageY,d.target.coords=o,d.target.TD=a,d.rowsToMove=this.prepareRowsToMoving();var E=u.holder.scrollLeft+c.getRowHeaderWidth();this.backlight.setPosition(null,E),this.backlight.setSize(u.hider.offsetWidth-E,this.getRowsHeight(S,b)),this.backlight.setOffset((this.getRowsHeight(S,o.row-1)+i.offsetY)*-1,null),Re(this.hot.rootElement,kC),this.refreshPositions()}else ut(this.hot.rootElement,$C),d.pressed=!1,d.rowsToMove.length=0}},{key:"onMouseMove",value:function(i){var o=Ls.get(this);if(!!o.pressed){if(i.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}o.target.eventPageY=i.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,a,s){var l=this.hot.getSelectedRangeLast(),u=Ls.get(this);!l||!u.pressed||(u.rowsToMove.indexOf(o.row)>-1?ut(this.hot.rootElement,rb):Re(this.hot.rootElement,rb),s.row=!0,s.column=!0,s.cell=!0,u.target.coords=o,u.target.TD=a)}},{key:"onMouseUp",value:function(){var i=Ls.get(this),o=i.target.row,a=i.rowsToMove.length;if(i.pressed=!1,i.backlightHeight=0,ut(this.hot.rootElement,[kC,rb,$C]),this.hot.selection.isSelectedByRowHeader()&&Re(this.hot.rootElement,$C),!(a<1||o===void 0)){var s=i.rowsToMove[0],l=this.hot.toPhysicalRow(s),u=this.dragRows(i.rowsToMove,o);if(i.rowsToMove.length=0,u===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var c=this.hot.toVisualRow(l),f=c+a-1;this.hot.selectRows(c,f)}}}},{key:"onAfterScrollHorizontally",value:function(){var i=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtViewport.getRowHeaderWidth(),a=i.holder.scrollLeft,s=o+a;this.backlight.setPosition(null,s),this.backlight.setSize(i.hider.offsetWidth-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Eu(os(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PC}},{key:"PLUGIN_PRIORITY",get:function(){return pQe}}]),r}(jt);function Jd(t){return Jd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jd(t)}function gQe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vQe(n.key),n)}}function yQe(t,e,r){return e&&jB(t.prototype,e),r&&jB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vQe(t){var e=bQe(t,"string");return Jd(e)==="symbol"?e:String(e)}function bQe(t,e){if(Jd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Jd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cu(){return typeof Reflect<"u"&&Reflect.get?Cu=Reflect.get.bind():Cu=function(e,r,n){var i=wQe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Cu.apply(this,arguments)}function wQe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=as(t),t!==null););return t}function SQe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&z7(t,e)}function z7(t,e){return z7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},z7(t,e)}function RQe(t){var e=CQe();return function(){var n=as(t),i;if(e){var o=as(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return EQe(this,i)}}function EQe(t,e){if(e&&(Jd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G7(t)}function G7(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function CQe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function as(t){return as=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},as(t)}var nb="manualRowResize",_Qe=30,WB="manualRowHeights",LC=new WeakMap,TQe=function(t){SQe(r,t);var e=RQe(r);function r(n){var i;gQe(this,r),i=e.call(this,n);var o=i.hot.rootDocument;return i.currentTH=null,i.currentRow=null,i.selectedRows=[],i.currentHeight=null,i.newSize=null,i.startY=null,i.startHeight=null,i.startOffset=null,i.handle=o.createElement("DIV"),i.guide=o.createElement("DIV"),i.eventManager=new Er(G7(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.rowHeightsMap=void 0,LC.set(G7(i),{config:void 0}),Re(i.handle,"manualRowResizer"),Re(i.guide,"manualRowResizerGuide"),i}return yQe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[nb]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.rowHeightsMap=new Cl,this.rowHeightsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(o,a){return i.onModifyRowHeight(o,a)}),this.bindEvents(),Cu(as(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Cu(as(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=LC.get(this);i.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),Cu(as(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",WB,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",WB,i),i.value}},{key:"setManualSize",value:function(i,o){var a=this.hot.toPhysicalRow(i),s=Math.max(o,Eq.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,s),s}},{key:"setupHandlePosition",value:function(i){var o=this;this.currentTH=i;var a=this.hot.view,s=a._wt,l=s.wtTable.getCoords(this.currentTH),u=l.row;if(!(u<0)){var c=Qt(this.currentTH),f=this.currentTH.getBoundingClientRect(),h=u<s.getSetting("fixedRowsTop"),d=u>=a.countNotHiddenRowIndexes(0,1)-s.getSetting("fixedRowsBottom"),p;h?p=s.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col):d&&(p=s.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),p||(p=s.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.selectedRows=[];var m=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&m){var g=this.hot.getSelectedRange();Q(g,function(v){var S=v.getTopStartCorner().row,b=v.getBottomStartCorner().row;Ye(S,b,function(E){o.selectedRows.includes(E)||o.selectedRows.push(E)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=p.top-6,this.startHeight=parseInt(f.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(p.start,"px"),this.handle.style.width="".concat(c,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(Qt(this.handle),10),o=parseInt(this.handle.style[this.inlineDir],10)+i,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Re(this.handle,"active"),Re(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(o,"px"),this.guide.style.width="".concat(a-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){ut(this.handle,"active"),ut(this.guide,"active")}},{key:"checkIfRowHeader",value:function(i){var o,a,s=Fu(i,["TH"],this.hot.rootElement);return s&&((o=i.parentNode)===null||o===void 0||(a=o.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"getActualRowHeight",value:function(i){var o=this.hot.view._wt.wtTable.getRowHeight(i);return o!==void 0&&this.newSize<o?o:this.newSize}},{key:"onMouseOver",value:function(i){if(!HK(i.target)&&this.checkIfRowHeader(i.target)){var o=this.getClosestTHParent(i.target);o&&(this.pressed||this.setupHandlePosition(o))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},a=function(u,c){var f=i.hot.runHooks("beforeRowResize",i.getActualRowHeight(u),u,!0);f!==void 0&&(i.newSize=f),i.setManualSize(u,i.newSize),i.hot.runHooks("afterRowResize",i.getActualRowHeight(u),u,!0),c&&o()};if(this.dblclick>=2){var s=this.selectedRows.length;s>1?(Q(this.selectedRows,function(l){a(l)}),o()):Q(this.selectedRows,function(l){a(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var o=this;at(i.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return o.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=i.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(i){var o=this;this.pressed&&(this.currentHeight=this.startHeight+(i.pageY-this.startY),Q(this.selectedRows,function(a){o.newSize=o.setManualSize(a,o.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},a=function(u,c){i.hot.runHooks("beforeRowResize",i.getActualRowHeight(u),u,!1),c&&o(),i.saveManualRowHeights(),i.hot.runHooks("afterRowResize",i.getActualRowHeight(u),u,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var s=this.selectedRows.length;s>1?(Q(this.selectedRows,function(l){a(l)}),o()):Q(this.selectedRows,function(l){a(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,o=this.hot,a=o.rootElement,s=o.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(l){return i.onMouseOver(l)}),this.eventManager.addEventListener(a,"mousedown",function(l){return i.onMouseDown(l)}),this.eventManager.addEventListener(s,"mousemove",function(l){return i.onMouseMove(l)}),this.eventManager.addEventListener(s,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyRowHeight",value:function(i,o){var a=i;if(this.enabled){var s=this.hot.toPhysicalRow(o),l=this.rowHeightsMap.getValueAtIndex(s);this.hot.getSettings()[nb]&&l&&(a=l)}return a}},{key:"onMapInit",value:function(){var i=this,o=LC.get(this),a=this.hot.getSettings()[nb],s=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof s<"u"?s.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)}):Array.isArray(a)?(a.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)}),o.config=a):a===!0&&Array.isArray(o.config)&&o.config.forEach(function(l,u){i.rowHeightsMap.setValueAtIndex(u,l)})},!0)}},{key:"destroy",value:function(){Cu(as(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return nb}},{key:"PLUGIN_PRIORITY",get:function(){return _Qe}}]),r}(jt);function yv(t){return yv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yv(t)}var zB,GB,YB,KB;function ib(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function OQe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xQe(n.key),n)}}function AQe(t,e,r){return e&&qB(t.prototype,e),r&&qB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function xQe(t){var e=IQe(t,"string");return yv(e)==="symbol"?e:String(e)}function IQe(t,e){if(yv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(yv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var MQe=function(){function t(e,r,n,i,o,a){OQe(this,t),this.row=e,this.col=r,this.rowspan=n,this.colspan=i,this.removed=!1,this.cellCoordsFactory=o,this.cellRangeFactory=a}return AQe(t,[{key:"normalize",value:function(r){var n=r.countRows(),i=r.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col)}},{key:"includes",value:function(r,n){return this.row<=r&&this.col<=n&&this.row+this.rowspan-1>=r&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(r){return this.col<=r&&this.col+this.colspan-1>=r}},{key:"includesVertically",value:function(r){return this.row<=r&&this.row+this.rowspan-1>=r}},{key:"shift",value:function(r,n){var i=r[0]||r[1],o=n+Math.abs(r[0]||r[1])-1,a=r[0]?"colspan":"rowspan",s=r[0]?"col":"row",l=Math.min(n,o),u=Math.max(n,o),c=this[s],f=this[s]+this[a]-1;if(c>=n&&(this[s]+=i),i>0)n<=f&&n>c&&(this[a]+=i);else if(i<0){if(l<=c&&u>=f)return this.removed=!0,!1;if(c>=l&&c<=u){var h=u-c+1,d=Math.abs(i)-h;this[s]-=d+i,this[a]-=h}else if(c<=l&&f>=u)this[a]+=i;else if(c<=l&&f>=l&&f<u){var p=f-l+1;this[a]-=p}}return!0}},{key:"isFarther",value:function(r,n){return r?n==="down"?r.row+r.rowspan-1<this.row+this.rowspan-1:n==="up"?r.row>this.row:n==="right"?r.col+r.colspan-1<this.col+this.colspan-1:n==="left"?r.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(r){return Gt(zB||(zB=ib(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),r.row,r.col,r.rowspan,r.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(r){return Gt(GB||(GB=ib(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),r.row,r.col)}},{key:"IS_SINGLE_CELL",value:function(r){return Gt(YB||(YB=ib(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),r.row,r.col)}},{key:"ZERO_SPAN_WARNING",value:function(r){return Gt(KB||(KB=ib(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),r.row,r.col)}},{key:"containsNegativeValues",value:function(r){return r.row<0||r.col<0||r.rowspan<0||r.colspan<0}},{key:"isSingleCell",value:function(r){return r.colspan===1&&r.rowspan===1}},{key:"containsZeroSpan",value:function(r){return r.colspan===0||r.rowspan===0}},{key:"isOutOfBounds",value:function(r,n,i){return r.row<0||r.col<0||r.row>=n||r.row+r.rowspan-1>=n||r.col>=i||r.col+r.colspan-1>=i}}]),t}();const Ko=MQe;function Y7(t,e,r,n){e?e.row===r&&e.col===n?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function vv(t){return vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vv(t)}var XB;function NQe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function QB(t){return LQe(t)||$Qe(t)||kQe(t)||PQe()}function PQe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kQe(t,e){if(!!t){if(typeof t=="string")return K7(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K7(t,e)}}function $Qe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function LQe(t){if(Array.isArray(t))return K7(t)}function K7(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function DQe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ZB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,HQe(n.key),n)}}function FQe(t,e,r){return e&&ZB(t.prototype,e),r&&ZB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function HQe(t){var e=BQe(t,"string");return vv(e)==="symbol"?e:String(e)}function BQe(t,e){if(vv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(vv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var UQe=function(){function t(e){DQe(this,t),this.plugin=e,this.mergedCells=[],this.hot=e.hot}return FQe(t,[{key:"get",value:function(r,n){var i=this.mergedCells,o=!1;return Q(i,function(a){return a.row<=r&&a.row+a.rowspan-1>=r&&a.col<=n&&a.col+a.colspan-1>=n?(o=a,!1):!0}),o}},{key:"getByRange",value:function(r){var n=this.mergedCells,i=!1;return Q(n,function(o){return o.row<=r.from.row&&o.row+o.rowspan-1>=r.to.row&&o.col<=r.from.col&&o.col+o.colspan-1>=r.to.col?(i=o,i):!0}),i}},{key:"getWithinRange",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.mergedCells,a=[],s=r;if(!s.includesRange){var l=this.hot._createCellCoords(s.from.row,s.from.col),u=this.hot._createCellCoords(s.to.row,s.to.col);s=this.hot._createCellRange(l,l,u)}return Q(o,function(c){var f=n.hot._createCellCoords(c.row,c.col),h=n.hot._createCellCoords(c.row+c.rowspan-1,c.col+c.colspan-1),d=n.hot._createCellRange(f,f,h);i?s.overlaps(d)&&a.push(c):s.includesRange(d)&&a.push(c)}),a.length?a:!1}},{key:"add",value:function(r){var n=this.mergedCells,i=r.row,o=r.col,a=r.rowspan,s=r.colspan,l=new Ko(i,o,a,s,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(i,o),c=this.isOverlapping(l);return!u&&!c?(this.hot&&l.normalize(this.hot),n.push(l),l):(Xt(t.IS_OVERLAPPING_WARNING(l)),!1)}},{key:"remove",value:function(r,n){var i=this.mergedCells,o=this.get(r,n),a=o?this.mergedCells.indexOf(o):-1;return o&&a!==-1?(i.splice(a,1),o):!1}},{key:"clear",value:function(){var r=this,n=this.mergedCells,i=[],o=[];Q(n,function(a){var s=r.hot.getCell(a.row,a.col);s&&i.push([s,r.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,Q(i,function(a,s){Ye(0,a.rowspan-1,function(l){Ye(0,a.colspan-1,function(u){if(u!==0||l!==0){var c=r.hot.getCell(a.row+l,a.col+u);c&&o.push([c,null,null,null])}})}),i[s][1]=null}),Q(i,function(a){Y7.apply(void 0,QB(a))}),Q(o,function(a){Y7.apply(void 0,QB(a))})}},{key:"isOverlapping",value:function(r){var n=this,i=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(r.row,r.col),this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1)),o=!1;return Q(this.mergedCells,function(a){var s=n.hot._createCellRange(n.hot._createCellCoords(0,0),n.hot._createCellCoords(a.row,a.col),n.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1));return s.overlaps(i)?(o=!0,!1):!0}),o}},{key:"isFirstRenderableMergedCell",value:function(r,n){var i=this.get(r,n);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===r&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===n}},{key:"getFirstRenderableCoords",value:function(r,n){var i=this.get(r,n);if(!i||this.isFirstRenderableMergedCell(r,n))return this.hot._createCellCoords(r,n);var o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(o,a)}},{key:"shiftCollections",value:function(r,n,i){var o=this,a=[0,0];switch(r){case"right":a[0]+=i;break;case"left":a[0]-=i;break;case"down":a[1]+=i;break;case"up":a[1]-=i;break}Q(this.mergedCells,function(s){s.shift(a,n)}),OT(this.mergedCells.length-1,0,function(s){var l=o.mergedCells[s];l&&l.removed&&o.mergedCells.splice(o.mergedCells.indexOf(l),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(r){return Gt(XB||(XB=NQe(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),r.row,r.col)}}]),t}();const VQe=UQe;function bv(t){return bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bv(t)}function Vl(t,e){return GQe(t)||zQe(t,e)||WQe(t,e)||jQe()}function jQe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WQe(t,e){if(!!t){if(typeof t=="string")return JB(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JB(t,e)}}function JB(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zQe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function GQe(t){if(Array.isArray(t))return t}function YQe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qQe(n.key),n)}}function KQe(t,e,r){return e&&eU(t.prototype,e),r&&eU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function qQe(t){var e=XQe(t,"string");return bv(e)==="symbol"?e:String(e)}function XQe(t,e){if(bv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(bv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var QQe=function(){function t(e){YQe(this,t),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return KQe(t,[{key:"correctSelectionAreaSize",value:function(r){if(r[0]===r[2]&&r[1]===r[3]){var n=this.mergedCellsCollection.get(r[0],r[1]);n&&(r[2]=r[0]+n.rowspan-1,r[3]=r[1]+n.colspan-1)}}},{key:"getDirection",value:function(r,n){var i=null;return n[0]===r[0]&&n[1]===r[1]&&n[3]===r[3]?i="down":n[2]===r[2]&&n[1]===r[1]&&n[3]===r[3]?i="up":n[1]===r[1]&&n[2]===r[2]?i="right":i="left",i}},{key:"snapDragArea",value:function(r,n,i,o){var a=n.slice(0),s=this.getAutofillSize(r,n,i),l=Vl(r,4),u=l[0],c=l[1],f=l[2],h=l[3],d=["up","down"].indexOf(i)>-1,p=d?f-u+1:h-c+1,m=Math.floor(s/p)*p,g=s-m,v=this.getFarthestCollection(r,n,i,o);if(v){if(i==="down"){var S=v.row+v.rowspan-u-g,b=a[2]+S;b>=this.plugin.hot.countRows()?a[2]-=g:a[2]+=g?S:0}else if(i==="right"){var E=v.col+v.colspan-c-g,T=a[3]+E;T>=this.plugin.hot.countCols()?a[3]-=g:a[3]+=g?E:0}else if(i==="up"){var N=f-g-v.row+1,L=a[0]+N;L<0?a[0]+=g:a[0]-=g?N:0}else if(i==="left"){var V=h-g-v.col+1,B=a[1]+V;B<0?a[1]+=g:a[1]-=g?V:0}}return this.updateCurrentFillCache({baseArea:r,dragDirection:i,foundMergedCells:o,fillSize:s,dragArea:a,cycleLength:p}),a}},{key:"updateCurrentFillCache",value:function(r){this.currentFillData||(this.currentFillData={}),Jr(this.currentFillData,r)}},{key:"getAutofillSize",value:function(r,n,i){var o=Vl(r,4),a=o[0],s=o[1],l=o[2],u=o[3],c=Vl(n,4),f=c[0],h=c[1],d=c[2],p=c[3];switch(i){case"up":return a-f;case"down":return d-l;case"left":return s-h;case"right":return p-u;default:return null}}},{key:"getDragArea",value:function(r,n,i){var o=Vl(r,4),a=o[0],s=o[1],l=o[2],u=o[3],c=Vl(n,4),f=c[0],h=c[1],d=c[2],p=c[3];switch(i){case"up":return[f,h,a-1,u];case"down":return[l+1,s,d,u];case"left":return[f,h,l,s-1];case"right":return[a,u+1,d,p];default:return null}}},{key:"getFarthestCollection",value:function(r,n,i,o){var a=Vl(r,4),s=a[0],l=a[1],u=a[2],c=a[3],f=["up","down"].indexOf(i)>-1,h=f?u:c,d=f?s:l,p=this.getAutofillSize(r,n,i),m=f?u-s+1:c-l+1,g=Math.floor(p/m)*m,v=p-g,S=null,b=null,E=null;switch(i){case"up":S="includesVertically",E=h-v+1;break;case"left":S="includesHorizontally",E=h-v+1;break;case"down":S="includesVertically",E=d+v-1;break;case"right":S="includesHorizontally",E=d+v-1;break}return Q(o,function(T){T[S](E)&&T.isFarther(b,i)&&(b=T)}),b}},{key:"recreateAfterDataPopulation",value:function(r){if(!!this.currentFillData){var n=this.getRangeFromChanges(r),i=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,a=function(h,d){switch(o){case"up":return h.row-d>=n.from.row;case"down":return h.row+h.rowspan-1+d<=n.to.row;case"left":return h.col-d>=n.from.column;case"right":return h.col+h.colspan-1+d<=n.to.column;default:return null}},s=0,l=null,u=1;do for(var c=0;c<i.length;c+=1){if(l=i[c],s=u*this.currentFillData.cycleLength,a(l,s))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:l.row-s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-s,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+s,colspan:l.colspan});break}c===i.length-1&&(u+=1)}while(a(l,s));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(r){var n=this,i={min:null,max:null},o={min:null,max:null};return Q(r,function(a){var s=a[0],l=n.plugin.hot.propToCol(a[1]);(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s),(o.min===null||l<o.min)&&(o.min=l),(o.max===null||l>o.max)&&(o.max=l)}),{from:{row:i.min,column:o.min},to:{row:i.max,column:o.max}}}},{key:"dragAreaOverlapsCollections",value:function(r,n,i){var o=this.getDragArea(r,n,i),a=Vl(o,4),s=a[0],l=a[1],u=a[2],c=a[3],f=this.plugin.hot._createCellCoords(s,l),h=this.plugin.hot._createCellCoords(u,c),d=this.plugin.hot._createCellRange(f,f,h);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}]),t}();const ZQe=QQe;function wv(t){return wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wv(t)}function JQe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tZe(n.key),n)}}function eZe(t,e,r){return e&&tU(t.prototype,e),r&&tU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function tZe(t){var e=rZe(t,"string");return wv(e)==="symbol"?e:String(e)}function rZe(t,e){if(wv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(wv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var nZe=function(){function t(e){JQe(this,t),this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return eZe(t,[{key:"snapDelta",value:function(r,n,i){var o=n.to,a=o.row+r.row,s=o.col+r.col;r.row?this.jumpOverMergedCell(r,i,a):r.col&&this.jumpOverMergedCell(r,i,s)}},{key:"jumpOverMergedCell",value:function(r,n,i){var o=r.row||r.col,a=null,s=null,l=null;r.row?(a=n.includesVertically(i),s=n.row,l=n.getLastRow()):r.col&&(a=n.includesHorizontally(i),s=n.col,l=n.getLastColumn()),o!==0&&(o>0?a&&i!==s&&(o+=l-i+1):a&&i!==l&&(o-=i-s+1),r.row?r.row=o:r.col&&(r.col=o))}},{key:"getUpdatedSelectionRange",value:function(r,n){return this.hot._createCellRange(r.highlight,r.from,this.hot._createCellCoords(r.to.row+n.row,r.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(r,n,i,o){var a=Math.min(i[0],i[2]),s=Math.min(i[1],i[3]),l=Math.max(i[0],i[2]),u=Math.max(i[1],i[3]);if(o!==void 0){var c=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(r,n);if(!!c){var f=this.plugin.mergedCellsCollection.get(r,n);if(!!f){var h=f.getLastRow(),d=f.getLastColumn(),p=a<=f.row&&s<=f.col&&l>=h&&u>=d;if(p)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(o);if(this.plugin.selectionCalculations.isMergeCellFullySelected(f,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(r,n){var i=[];if(!n||!r)return!1;for(var o=0;o<r.rowspan;o+=1)for(var a=0;a<r.colspan;a+=1)i.push(this.hot._createCellCoords(r.row+o,r.col+a));for(var s=0;s<i.length;s+=1){for(var l=[],u=0;u<n.length;u+=1)l[u]=n[u].includes(i[s]);if(!l.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var r=[],n=0;n<=7;n+=1)r.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return r.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),r}}]),t}();const iZe=nZe;function oZe(t){return{key:"mergeCells",name:function(){var r=this.getSelectedLast();if(r){var n=t.mergedCellsCollection.get(r[0],r[1]);if(n.row===r[0]&&n.col===r[1]&&n.row+n.rowspan-1===r[2]&&n.col+n.colspan-1===r[3])return this.getTranslatedPhrase(X3)}return this.getTranslatedPhrase(q3)},callback:function(){t.toggleMergeOnSelection()},disabled:function(){var r=this.getSelectedLast();if(!r)return!0;var n=Ko.isSingleCell({row:r[0],col:r[1],rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function ep(t){return ep=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ep(t)}function aZe(t,e){return uZe(t)||lZe(t,e)||OZ(t,e)||sZe()}function sZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lZe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function uZe(t){if(Array.isArray(t))return t}function cZe(t){return dZe(t)||hZe(t)||OZ(t)||fZe()}function fZe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OZ(t,e){if(!!t){if(typeof t=="string")return q7(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q7(t,e)}}function hZe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function dZe(t){if(Array.isArray(t))return q7(t)}function q7(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function pZe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gZe(n.key),n)}}function mZe(t,e,r){return e&&rU(t.prototype,e),r&&rU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function gZe(t){var e=yZe(t,"string");return ep(e)==="symbol"?e:String(e)}function yZe(t,e){if(ep(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ep(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zf(){return typeof Reflect<"u"&&Reflect.get?Zf=Reflect.get.bind():Zf=function(e,r,n){var i=vZe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Zf.apply(this,arguments)}function vZe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ll(t),t!==null););return t}function bZe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&X7(t,e)}function X7(t,e){return X7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},X7(t,e)}function wZe(t){var e=RZe();return function(){var n=ll(t),i;if(e){var o=ll(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return SZe(this,i)}}function SZe(t,e){if(e&&(ep(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AZ(t)}function AZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function RZe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ll(t){return ll=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ll(t)}Ue.getSingleton().register("beforeMergeCells");Ue.getSingleton().register("afterMergeCells");Ue.getSingleton().register("beforeUnmergeCells");Ue.getSingleton().register("afterUnmergeCells");var Vm="mergeCells",EZe=150,nU=new WeakMap,iU=Vm,CZe=function(t){bZe(r,t);var e=wZe(r);function r(n){var i;return pZe(this,r),i=e.call(this,n),nU.set(AZ(i),{lastDesiredCoords:null}),i.mergedCellsCollection=null,i.autofillCalculations=null,i.selectionCalculations=null,i}return mZe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Vm]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mergedCellsCollection=new VQe(this),this.autofillCalculations=new ZQe(this),this.selectionCalculations=new iZe(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("modifyTransformStart",function(){return i.onModifyTransformStart.apply(i,arguments)}),this.addHook("afterModifyTransformStart",function(){return i.onAfterModifyTransformStart.apply(i,arguments)}),this.addHook("modifyTransformEnd",function(){return i.onModifyTransformEnd.apply(i,arguments)}),this.addHook("modifyGetCellCoords",function(){return i.onModifyGetCellCoords.apply(i,arguments)}),this.addHook("beforeSetRangeStart",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeEnd",function(){return i.onBeforeSetRangeEnd.apply(i,arguments)}),this.addHook("afterIsMultipleSelection",function(){return i.onAfterIsMultipleSelection.apply(i,arguments)}),this.addHook("afterRenderer",function(){return i.onAfterRenderer.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.addMergeActionsToContextMenu.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(){return i.onAfterGetCellMeta.apply(i,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return i.onAfterViewportRowCalculatorOverride.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),this.addHook("modifyAutofillRange",function(){return i.onModifyAutofillRange.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeDrawBorders",function(){return i.onBeforeDrawAreaBorders.apply(i,arguments)}),this.addHook("afterDrawSelection",function(){return i.onAfterDrawSelection.apply(i,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return i.onBeforeRemoveCellClassNames.apply(i,arguments)}),this.addHook("beforeUndoStackChange",function(o,a){if(a==="MergeCells")return!1}),this.registerShortcuts(),Zf(ll(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),Zf(ll(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var i=this.hot.getSettings()[Vm];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(i),Zf(ll(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var i=this;if(!!RK()){var o=[],a=[];this.mergedCellsCollection.mergedCells.forEach(function(s){for(var l=s.row,u=s.rowspan,c=l+1;c<l+u;c++)a.push(c)}),a=cZe(new Set(a)),a.forEach(function(s){var l=i.hot.rowIndexMapper.getRenderableFromVisualIndex(s);i.hot.view._wt.wtOverlays.getOverlays(!0).map(function(u){return(u==null?void 0:u.name)==="master"?u:u.clone.wtTable}).forEach(function(u){var c=u.getRow(l);c&&(c.style.background=kg(c,"backgroundColor").replace(")",", 0.99)"),o.push(c))})}),this.hot._registerTimeout(function(){o.forEach(function(s){s.style.background=kg(s,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(i){var o=!0;return i?(Ko.containsNegativeValues(i)?(Xt(Ko.NEGATIVE_VALUES_WARNING(i)),o=!1):Ko.isOutOfBounds(i,this.hot.countRows(),this.hot.countCols())?(Xt(Ko.IS_OUT_OF_BOUNDS_WARNING(i)),o=!1):Ko.isSingleCell(i)?(Xt(Ko.IS_SINGLE_CELL(i)),o=!1):Ko.containsZeroSpan(i)&&(Xt(Ko.ZERO_SPAN_WARNING(i)),o=!1),o):!1}},{key:"generateFromSettings",value:function(i){var o=this;if(Array.isArray(i)){var a=[];if(Q(i,function(s){if(!!o.validateSetting(s)){var l=o.hot._createCellCoords(s.row,s.col),u=o.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),c=o.hot._createCellRange(l,l,u);o.mergeRange(c,!0,!0),Ye(s.row,s.row+s.rowspan-1,function(f){Ye(s.col,s.col+s.colspan-1,function(h){f===s.row&&h===s.col||a.push([f,h,null])})})}}),a.length===0)return;this.hot.setDataAtCell(a)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return o?!0:this.validateSetting(i)}},{key:"toggleMergeOnSelection",value:function(){var i=this.hot.getSelectedRangeLast();if(!!i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var o=i.from,a=i.to;this.toggleMerge(i),this.hot.selectCell(o.row,o.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!!i){i.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var o=i.from,a=i.to;this.unmergeRange(i,!0),this.mergeRange(i),this.hot.selectCell(o.row,o.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!!i){var o=i.from,a=i.to;this.unmergeRange(i,!0),this.hot.selectCell(o.row,o.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=i.getTopStartCorner(),u=i.getBottomEndCorner(),c={row:l.row,col:l.col,rowspan:u.row-l.row+1,colspan:u.col-l.col+1},f=[],h=null;if(!this.canMergeRange(c,a))return!1;this.hot.runHooks("beforeMergeCells",i,a),Ye(0,c.rowspan-1,function(p){Ye(0,c.colspan-1,function(m){var g=null;f[p]||(f[p]=[]),p===0&&m===0?g=o.hot.getSourceDataAtCell(o.hot.toPhysicalRow(c.row),o.hot.toPhysicalColumn(c.col)):o.hot.setCellMeta(c.row+p,c.col+m,"hidden",!0),f[p][m]=g})}),this.hot.setCellMeta(c.row,c.col,"spanned",!0);var d=this.mergedCellsCollection.add(c);return d?(s?h=[c.row,c.col,f]:this.hot.populateFromArray(c.row,c.col,f,void 0,void 0,this.pluginName),a||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",i,c,a),h):!0}},{key:"unmergeRange",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.mergedCellsCollection.getWithinRange(i);!s||(this.hot.runHooks("beforeUnmergeCells",i,a),Q(s,function(l){o.mergedCellsCollection.remove(l.row,l.col),Ye(0,l.rowspan-1,function(u){Ye(0,l.colspan-1,function(c){o.hot.removeCellMeta(l.row+u,l.col+c,"hidden")})}),o.hot.removeCellMeta(l.row,l.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",i,a),this.hot.render())}},{key:"toggleMerge",value:function(i){var o=this.mergedCellsCollection.get(i.from.row,i.from.col),a=o.row===i.from.row&&o.col===i.from.col&&o.row+o.rowspan-1===i.to.row&&o.col+o.colspan-1===i.to.col;a?this.unmergeRange(i):this.mergeSelection(i)}},{key:"merge",value:function(i,o,a,s){var l=this.hot._createCellCoords(i,o),u=this.hot._createCellCoords(a,s);this.mergeRange(this.hot._createCellRange(l,l,u))}},{key:"unmerge",value:function(i,o,a,s){var l=this.hot._createCellCoords(i,o),u=this.hot._createCellCoords(a,s);this.unmergeRange(this.hot._createCellRange(l,l,u))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[Vm]),this.hot.render()}},{key:"registerShortcuts",value:function(){var i=this,o=this.hot.getShortcutManager(),a=o.getContext("grid");a.addShortcut({keys:[["Control","m"]],callback:function(){i.toggleMerge(i.hot.getSelectedRangeLast()),i.hot.render()},runOnlyIf:function(l){return!l.altKey},group:iU})}},{key:"unregisterShortcuts",value:function(){var i=this.hot.getShortcutManager(),o=i.getContext("grid");o.removeShortcutsByGroup(iU)}},{key:"onAfterIsMultipleSelection",value:function(i){if(i){for(var o=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),s=0;s<o.length;s+=1)if(a.from.row===o[s].row&&a.from.col===o[s].col&&a.to.row===o[s].row+o[s].rowspan-1&&a.to.col===o[s].col+o[s].colspan-1)return!1}return i}},{key:"onModifyTransformStart",value:function(i){var o=nU.get(this),a=this.hot.getSelectedRangeLast(),s={row:i.row,col:i.col},l=null,u=this.hot._createCellCoords(a.highlight.row,a.highlight.col),c=this.mergedCellsCollection.get(u.row,u.col);if(o.lastDesiredCoords||(o.lastDesiredCoords=this.hot._createCellCoords(null,null)),c){var f=this.hot._createCellCoords(c.row,c.col),h=this.hot._createCellCoords(c.row+c.rowspan-1,c.col+c.colspan-1),d=this.hot._createCellRange(f,f,h);d.includes(o.lastDesiredCoords)||(o.lastDesiredCoords=this.hot._createCellCoords(null,null)),s.row=o.lastDesiredCoords.row?o.lastDesiredCoords.row-u.row:s.row,s.col=o.lastDesiredCoords.col?o.lastDesiredCoords.col-u.col:s.col,i.row>0?s.row=c.row+c.rowspan-1-u.row+i.row:i.row<0&&(s.row=u.row-c.row+i.row),i.col>0?s.col=c.col+c.colspan-1-u.col+i.col:i.col<0&&(s.col=u.col-c.col+i.col)}l=this.hot._createCellCoords(a.highlight.row+s.row,a.highlight.col+s.col);var p=this.mergedCellsCollection.get(l.row,l.col);if(p){var m=this.mergedCellsCollection.getFirstRenderableCoords(p.row,p.col);o.lastDesiredCoords=l,s={row:m.row-u.row,col:m.col-u.col}}s.row!==0&&(i.row=s.row),s.col!==0&&(i.col=s.col)}},{key:"onModifyTransformEnd",value:function(i){var o=this,a=this.hot.getSelectedRangeLast(),s=di(i),l=this.selectionCalculations.getUpdatedSelectionRange(a,i),u=di(s),c=this.mergedCellsCollection.getWithinRange(l,!0);do u=di(s),this.selectionCalculations.getUpdatedSelectionRange(a,s),Q(c,function(f){o.selectionCalculations.snapDelta(s,a,f)});while(s.row!==u.row||s.col!==u.col);i.row=s.row,i.col=s.col}},{key:"onModifyGetCellCoords",value:function(i,o){if(!(i<0||o<0)){var a=this.mergedCellsCollection.get(i,o);if(!!a){var s=a.row,l=a.col,u=a.colspan,c=a.rowspan;return[s,l,s+c-1,l+u-1]}}}},{key:"addMergeActionsToContextMenu",value:function(i){i.items.push({name:"---------"},oZe(this))}},{key:"onAfterRenderer",value:function(i,o,a){var s=this.mergedCellsCollection.get(o,a),l=wt(s)?di(s):void 0;if(wt(l)){var u=this.hot,c=u.rowIndexMapper,f=u.columnIndexMapper,h=l.row,d=l.col,p=l.colspan,m=l.rowspan,g=this.translateMergedCellToRenderable(h,m,d,p),v=aZe(g,2),S=v[0],b=v[1],E=c.getRenderableFromVisualIndex(o),T=f.getRenderableFromVisualIndex(a),N=S-E+1,L=b-T+1;l.row=c.getNearestNotHiddenIndex(l.row,1),l.col=f.getNearestNotHiddenIndex(l.col,1),l.rowspan=Math.min(l.rowspan,N),l.colspan=Math.min(l.colspan,L)}Y7(i,l,o,a)}},{key:"onBeforeSetRangeStart",value:function(i){if(this.mergedCellsCollection.isFirstRenderableMergedCell(i.row,i.col)){var o=this.mergedCellsCollection.get(i.row,i.col),a=[o.row,o.col];i.row=a[0],i.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(i){var o=this.hot.getSelectedRangeLast();o.highlight=this.hot._createCellCoords(o.highlight.row,o.highlight.col),o.to=i;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var s=0;s<this.mergedCellsCollection.mergedCells.length;s+=1){var l=this.mergedCellsCollection.mergedCells[s],u=l.getRange();o.expandByRange(u)&&(i.row=o.to.row,i.col=o.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(i,o,a){var s=this.mergedCellsCollection.get(i,o);s&&(s.row!==i||s.col!==o?a.copyable=!1:(a.rowspan=s.rowspan,a.colspan=s.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(i){var o=this.hot.countCols();this.modifyViewportRowStart(i,o),this.modifyViewportRowEnd(i,o)}},{key:"modifyViewportRowStart",value:function(i,o){for(var a=this.hot.rowIndexMapper,s=a.getVisualFromRenderableIndex(i.startRow),l=0;l<o;l+=1){var u=this.mergedCellsCollection.get(s,l);if(wt(u)){var c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.row,1));if(c<i.startRow){i.startRow=c,this.modifyViewportRowStart(i,o);return}}}}},{key:"modifyViewportRowEnd",value:function(i,o){for(var a=this.hot.rowIndexMapper,s=a.getVisualFromRenderableIndex(i.endRow),l=0;l<o;l+=1){var u=this.mergedCellsCollection.get(s,l);if(wt(u)){var c=u.row+u.rowspan-1,f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(c,-1));if(f>i.endRow){i.endRow=f,this.modifyViewportRowEnd(i,o);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){var o=this.hot.countRows();this.modifyViewportColumnStart(i,o),this.modifyViewportColumnEnd(i,o)}},{key:"modifyViewportColumnStart",value:function(i,o){for(var a=this.hot.columnIndexMapper,s=a.getVisualFromRenderableIndex(i.startColumn),l=0;l<o;l+=1){var u=this.mergedCellsCollection.get(l,s);if(wt(u)){var c=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(u.col,1));if(c<i.startColumn){i.startColumn=c,this.modifyViewportColumnStart(i,o);return}}}}},{key:"modifyViewportColumnEnd",value:function(i,o){for(var a=this.hot.columnIndexMapper,s=a.getVisualFromRenderableIndex(i.endColumn),l=0;l<o;l+=1){var u=this.mergedCellsCollection.get(l,s);if(wt(u)){var c=u.col+u.colspan-1,f=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(c,-1));if(f>i.endColumn){i.endColumn=f,this.modifyViewportColumnEnd(i,o);return}}}}},{key:"translateMergedCellToRenderable",value:function(i,o,a,s){var l=this.hot,u=l.rowIndexMapper,c=l.columnIndexMapper,f,h;o===0?f=u.getNearestNotHiddenIndex(i,1):f=u.getNearestNotHiddenIndex(i+o-1,-1),s===0?h=c.getNearestNotHiddenIndex(a,1):h=c.getNearestNotHiddenIndex(a+s-1,-1);var d=i>=0?u.getRenderableFromVisualIndex(f):i,p=a>=0?c.getRenderableFromVisualIndex(h):a;return[d,p]}},{key:"onModifyAutofillRange",value:function(i,o){this.autofillCalculations.correctSelectionAreaSize(o);var a=this.autofillCalculations.getDirection(o,i),s=i;if(this.autofillCalculations.dragAreaOverlapsCollections(o,s,a))return s=o,s;var l=this.mergedCellsCollection.getWithinRange({from:{row:o[0],col:o[1]},to:{row:o[2],col:o[3]}});return l&&(s=this.autofillCalculations.snapDragArea(o,s,a,l)),s}},{key:"onAfterCreateCol",value:function(i,o){this.mergedCellsCollection.shiftCollections("right",i,o)}},{key:"onAfterRemoveCol",value:function(i,o){this.mergedCellsCollection.shiftCollections("left",i,o)}},{key:"onAfterCreateRow",value:function(i,o,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",i,o)}},{key:"onAfterRemoveRow",value:function(i,o){this.mergedCellsCollection.shiftCollections("up",i,o)}},{key:"onAfterChange",value:function(i,o){o==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(i)}},{key:"onBeforeDrawAreaBorders",value:function(i,o){if(o&&o==="area"){var a=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getWithinRange(a);Q(s,function(l){a.getBottomEndCorner().row===l.getLastRow()&&a.getBottomEndCorner().col===l.getLastColumn()&&(i[2]=l.row,i[3]=l.col)})}}},{key:"onAfterModifyTransformStart",value:function(i,o,a){if(!!this.enabled){var s=this.mergedCellsCollection.get(i.row,i.col);if(!!s){var l=o>0,u=o<0,c=a<0,f=a>0,h=s.row+s.rowspan-1===this.hot.countRows()-1,d=s.row===0,p=s.col+s.colspan-1===this.hot.countCols()-1,m=s.col===0;(l&&h||u&&d||f&&p||c&&m)&&(i.row=s.row,i.col=s.col)}}}},{key:"onAfterDrawSelection",value:function(i,o,a,s){if(!!a)return this.selectionCalculations.getSelectedMergedCellClassName(i,o,a,s)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return Vm}},{key:"PLUGIN_PRIORITY",get:function(){return EZe}}]),r}(jt);function oU(t){return AZe(t)||OZe(t)||TZe(t)||_Ze()}function _Ze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TZe(t,e){if(!!t){if(typeof t=="string")return aU(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aU(t,e)}}function aU(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function OZe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function AZe(t){if(Array.isArray(t))return t}function xZe(t,e){return function(r,n){var i=oU(r),o=i.slice(1),a=oU(n),s=a.slice(1);return function l(u){var c=t[u],f=e[u],h=o[u],d=s[u],p=f.multiColumnSorting,m=p.compareFunctionFactory?p.compareFunctionFactory:xX(f.type),g=m(c,f,p)(h,d);if(g===oa){var v=u+1;if(typeof e[v]<"u")return l(v)}return g}(0)}}var sU;function IZe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function lU(){Xt(Gt(sU||(sU=IZe(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var xZ="sort";function MZe(t,e,r){var n=[];return r===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push("".concat(xZ,"-").concat(t.getIndexOfColumnInSortQueue(e)+1)),n}function NZe(t){var e=t.className.split(" "),r=new RegExp("^".concat(xZ,"-[0-9]{1,2}$"));return e.filter(function(n){return r.test(n)})}function tp(t){return tp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tp(t)}function PZe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$Ze(n.key),n)}}function kZe(t,e,r){return e&&uU(t.prototype,e),r&&uU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $Ze(t){var e=LZe(t,"string");return tp(e)==="symbol"?e:String(e)}function LZe(t,e){if(tp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(tp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ai(){return typeof Reflect<"u"&&Reflect.get?Ai=Reflect.get.bind():Ai=function(e,r,n){var i=DZe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ai.apply(this,arguments)}function DZe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Gn(t),t!==null););return t}function FZe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Q7(t,e)}function Q7(t,e){return Q7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Q7(t,e)}function HZe(t){var e=VZe();return function(){var n=Gn(t),i;if(e){var o=Gn(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return BZe(this,i)}}function BZe(t,e){if(e&&(tp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UZe(t)}function UZe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function VZe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gn(t){return Gn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gn(t)}var Z7="multiColumnSorting",jZe=170,WZe="append",cU="columnSorting";AX(Z7,xZe);var zZe=function(t){FZe(r,t);var e=HZe(r);function r(n){var i;return PZe(this,r),i=e.call(this,n),i.pluginKey=Z7,i}return kZe(r,[{key:"isEnabled",value:function(){return Ai(Gn(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[cU]&&lU(),Ai(Gn(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ai(Gn(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){Ai(Gn(r.prototype),"sort",this).call(this,i)}},{key:"clearSort",value:function(){Ai(Gn(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Ai(Gn(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(i){return Ai(Gn(r.prototype),"getSortConfig",this).call(this,i)}},{key:"setSortConfig",value:function(i){Ai(Gn(r.prototype),"setSortConfig",this).call(this,i)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i:[i]}},{key:"updateHeaderClasses",value:function(i){for(var o,a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(o=Ai(Gn(r.prototype),"updateHeaderClasses",this)).call.apply(o,[this,i].concat(s)),ut(i,NZe(i)),this.enabled!==!1&&Re(i,MZe.apply(void 0,s))}},{key:"onUpdateSettings",value:function(i){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[cU]&&lU(),Ai(Gn(r.prototype),"onUpdateSettings",this).call(this,i)}},{key:"onAfterOnCellMouseDown",value:function(i,o){MO(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(o.col),this.sort(this.getNextSortConfig(o.col,WZe))):this.sort(this.getColumnNextConfig(o.col)))}}],[{key:"PLUGIN_KEY",get:function(){return Z7}},{key:"PLUGIN_PRIORITY",get:function(){return jZe}}]),r}(MX);function rp(t){return rp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rp(t)}function GZe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,KZe(n.key),n)}}function YZe(t,e,r){return e&&fU(t.prototype,e),r&&fU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function KZe(t){var e=qZe(t,"string");return rp(e)==="symbol"?e:String(e)}function qZe(t,e){if(rp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(rp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function S2(){return typeof Reflect<"u"&&Reflect.get?S2=Reflect.get.bind():S2=function(e,r,n){var i=XZe(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},S2.apply(this,arguments)}function XZe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=np(t),t!==null););return t}function QZe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&J7(t,e)}function J7(t,e){return J7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},J7(t,e)}function ZZe(t){var e=tJe();return function(){var n=np(t),i;if(e){var o=np(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return JZe(this,i)}}function JZe(t,e){if(e&&(rp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eJe(t)}function eJe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tJe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function np(t){return np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},np(t)}var rJe="multipleSelectionHandles",nJe=160,iJe=function(t){QZe(r,t);var e=ZZe(r);function r(n){var i;return GZe(this,r),i=e.call(this,n),i.dragged=[],i.eventManager=null,i.lastSetCell=null,i}return YZe(r,[{key:"isEnabled",value:function(){return na()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Er(this)),this.registerListeners(),S2(np(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var i=this,o=this,a=this.hot.rootElement;function s(l){if(o.dragged.length===1)return o.dragged.splice(0,o.dragged.length),!0;var u=o.dragged.indexOf(l);if(u===-1)return!1;u===0?o.dragged=o.dragged.slice(0,1):u===1&&(o.dragged=o.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(l){var u;if(at(l.target,"topSelectionHandle-HitArea"))return u=o.hot.getSelectedRangeLast(),o.dragged.push("top"),o.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1;if(at(l.target,"bottomSelectionHandle-HitArea"))return u=o.hot.getSelectedRangeLast(),o.dragged.push("bottom"),o.touchStartRange={width:u.getWidth(),height:u.getHeight(),direction:u.getDirection()},l.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(l){if(at(l.target,"topSelectionHandle-HitArea"))return s.call(o,"top"),o.touchStartRange=void 0,l.preventDefault(),!1;if(at(l.target,"bottomSelectionHandle-HitArea"))return s.call(o,"bottom"),o.touchStartRange=void 0,l.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(l){var u=i.hot.rootDocument,c,f,h,d,p,m;if(o.dragged.length!==0){var g=u.elementFromPoint(l.touches[0].clientX,l.touches[0].clientY);!g||g===o.lastSetCell||((g.nodeName==="TD"||g.nodeName==="TH")&&(c=o.hot.getCoords(g),c.col===-1&&(c.col=0),f=o.hot.getSelectedRangeLast(),h=f.getWidth(),d=f.getHeight(),p=f.getDirection(),h===1&&d===1&&o.hot.selection.setRangeEnd(c),m=o.getCurrentRangeCoords(f,c,o.touchStartRange.direction,p,o.dragged[0]),m.start!==null&&o.hot.selection.setRangeStart(m.start),o.hot.selection.setRangeEnd(m.end),o.lastSetCell=g),l.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(i,o,a,s,l){var u=i.getTopStartCorner(),c=i.getBottomEndCorner(),f=i.getBottomStartCorner(),h=i.getTopEndCorner(),d={start:null,end:null};switch(a){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":l==="top"?d={start:this.hot._createCellCoords(o.row,i.highlight.col),end:this.hot._createCellCoords(f.row,o.col)}:d={start:this.hot._createCellCoords(i.highlight.row,o.col),end:this.hot._createCellCoords(o.row,u.col)};break;case"SE-NW":l==="bottom"&&(d={start:this.hot._createCellCoords(c.row,o.col),end:this.hot._createCellCoords(o.row,u.col)});break}break;case"NW-SE":switch(s){case"NE-SW":l==="top"?d={start:o,end:f}:d.end=o;break;case"NW-SE":l==="top"?d={start:o,end:c}:d.end=o;break;case"SE-NW":l==="top"?d={start:o,end:u}:d.end=o;break;case"SW-NE":l==="top"?d={start:o,end:h}:d.end=o;break}break;case"SW-NE":switch(s){case"NW-SE":l==="bottom"?d={start:this.hot._createCellCoords(o.row,u.col),end:this.hot._createCellCoords(f.row,o.col)}:d={start:this.hot._createCellCoords(u.row,o.col),end:this.hot._createCellCoords(o.row,c.col)};break;case"SW-NE":l==="top"?d={start:this.hot._createCellCoords(i.highlight.row,o.col),end:this.hot._createCellCoords(o.row,c.col)}:d={start:this.hot._createCellCoords(o.row,u.col),end:this.hot._createCellCoords(u.row,o.col)};break;case"SE-NW":l==="bottom"?d={start:this.hot._createCellCoords(o.row,h.col),end:this.hot._createCellCoords(u.row,o.col)}:l==="top"&&(d={start:f,end:o});break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":l==="top"&&(d.end=o);break;case"SE-NW":l==="top"?d.end=o:d={start:o,end:u};break}break}return d}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return rJe}},{key:"PLUGIN_PRIORITY",get:function(){return nJe}}]),r}(jt);function eA(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.label,r=e===void 0?"":e,n=t.colspan,i=n===void 0?1:n,o=t.origColspan,a=o===void 0?1:o,s=t.collapsible,l=s===void 0?!1:s,u=t.crossHiddenColumns,c=u===void 0?[]:u,f=t.isCollapsed,h=f===void 0?!1:f,d=t.isHidden,p=d===void 0?!1:d,m=t.isRoot,g=m===void 0?!1:m,v=t.isPlaceholder,S=v===void 0?!1:v;return{label:r,colspan:i,origColspan:a,collapsible:l,isCollapsed:h,crossHiddenColumns:c,isHidden:p,isRoot:g,isPlaceholder:S}}function IZ(){return{label:"",isPlaceholder:!0}}function hU(t){return lJe(t)||sJe(t)||aJe(t)||oJe()}function oJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aJe(t,e){if(!!t){if(typeof t=="string")return tA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tA(t,e)}}function sJe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function lJe(t){if(Array.isArray(t))return tA(t)}function tA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function uJe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(e===0)return r;Q(t,function(i){var o=[],a=0;r.push(o),Q(i,function(s){var l=eA();if(wt(s)){var u=s.label,c=s.colspan;l.label=Vr(u),typeof c=="number"&&c>1&&(l.colspan=c,l.origColspan=c)}else l.label=Vr(s);a+=l.origColspan;var f=!1;if(a>=e&&(l.colspan=l.origColspan-(a-e),l.origColspan=l.colspan,f=!0),o.push(l),l.colspan>1)for(var h=0;h<l.colspan-1;h++)o.push(IZ());return!f})});var n=Math.max.apply(Math,hU(bt(r,function(i){return i.length})));return Q(r,function(i){if(i.length<n){var o=bt(new Array(n-i.length),function(){return eA()});i.splice.apply(i,[i.length,0].concat(hU(o)))}}),r}function Sv(t){return Sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sv(t)}var cJe=["row","col"];function dU(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function fJe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dU(Object(r),!0).forEach(function(n){hJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dU(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hJe(t,e,r){return e=MZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dJe(t,e){if(t==null)return{};var r=pJe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function pJe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function mJe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,MZ(n.key),n)}}function gJe(t,e,r){return e&&pU(t.prototype,e),r&&pU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function MZ(t){var e=yJe(t,"string");return Sv(e)==="symbol"?e:String(e)}function yJe(t,e){if(Sv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Sv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DC(t,e,r){vJe(t,e),e.set(t,r)}function vJe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mo(t,e){var r=NZ(t,e,"get");return bJe(t,r)}function bJe(t,e){return e.get?e.get.call(t):e.value}function _m(t,e,r){var n=NZ(t,e,"set");return wJe(t,n,r),r}function NZ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function wJe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var mU=["label","collapsible"],Oa=new WeakMap,jl=new WeakMap,FC=new WeakMap,SJe=function(){function t(){mJe(this,t),DC(this,Oa,{writable:!0,value:[]}),DC(this,jl,{writable:!0,value:0}),DC(this,FC,{writable:!0,value:1/0})}return gJe(t,[{key:"setColumnsLimit",value:function(r){_m(this,FC,r)}},{key:"setData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];_m(this,Oa,uJe(r,mo(this,FC))),_m(this,jl,mo(this,Oa).length)}},{key:"getData",value:function(){return mo(this,Oa)}},{key:"mergeWith",value:function(r){var n=this;Q(r,function(i){var o=i.row,a=i.col,s=dJe(i,cJe),l=n.getHeaderSettings(o,a);l!==null&&Jr(l,s,mU)})}},{key:"map",value:function(r){Q(mo(this,Oa),function(n){Q(n,function(i){var o=r(fJe({},i));wt(o)&&Jr(i,o,mU)})})}},{key:"getHeaderSettings",value:function(r,n){var i;if(r>=mo(this,jl)||r<0)return null;var o=mo(this,Oa)[r];return n>=o.length?null:(i=o[n])!==null&&i!==void 0?i:null}},{key:"getHeadersSettings",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,o=[];if(r>=mo(this,jl)||r<0)return o;for(var a=mo(this,Oa)[r],s=0,l=n;l<a.length;l++){var u=a[l];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=u.colspan,o.push(u),u.colspan>1&&(l+=u.colspan-1),s===i)break;if(s>i)throw new Error("The last column settings cannot overlap the other header layers")}return o}},{key:"getLayersCount",value:function(){return mo(this,jl)}},{key:"getColumnsCount",value:function(){return mo(this,jl)>0?mo(this,Oa)[0].length:0}},{key:"clear",value:function(){_m(this,Oa,[]),_m(this,jl,0)}}]),t}();function Rv(t){return Rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rv(t)}function gU(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function yU(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gU(Object(r),!0).forEach(function(n){R2(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gU(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function RJe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,PZ(n.key),n)}}function EJe(t,e,r){return e&&vU(t.prototype,e),r&&vU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function R2(t,e,r){return e=PZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PZ(t){var e=CJe(t,"string");return Rv(e)==="symbol"?e:String(e)}function CJe(t,e){if(Rv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Rv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _Je(t){return xJe(t)||AJe(t)||OJe(t)||TJe()}function TJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OJe(t,e){if(!!t){if(typeof t=="string")return rA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rA(t,e)}}function AJe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function xJe(t){if(Array.isArray(t))return rA(t)}function rA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var IJe="DF-pre-order";function kZ(t,e){for(var r=t.call(e,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=kZ.call(this.childs[n],t,e)}return r}var MJe="DF-post-order";function $Z(t,e){for(var r=0;r<this.childs.length;r++){var n=$Z.call(this.childs[r],t,e);if(n===!1)return!1}return t.call(e,this)}var LZ="BF";function NJe(t,e){var r=[this];function n(){if(r.length!==0){var i=r.shift();r.push.apply(r,_Je(i.childs)),t.call(e,i)!==!1&&n()}}n()}var PJe=LZ,bU=new Map([[IJe,kZ],[MJe,$Z],[LZ,NJe]]),wU=function(){function t(e){RJe(this,t),R2(this,"data",{}),R2(this,"parent",null),R2(this,"childs",[]),this.data=e}return EJe(t,[{key:"addChild",value:function(r){r.parent=this,this.childs.push(r)}},{key:"cloneTree",value:function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new t(yU({},r.data)),i=0;i<r.childs.length;i++)n.addChild(this.cloneTree(r.childs[i]));return n}},{key:"replaceTreeWith",value:function(r){this.data=yU({},r.data),this.childs=[];for(var n=0;n<r.childs.length;n++)this.addChild(r.childs[n])}},{key:"walkDown",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:PJe;if(!bU.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));bU.get(n).call(this,r,this)}},{key:"walkUp",value:function(r){var n=this,i=function o(a){var s=r.call(n,a);s!==!1&&a.parent!==null&&o(a.parent)};i(this)}}]),t}();function Ev(t){return Ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ev(t)}function SU(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function RU(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?SU(Object(r),!0).forEach(function(n){kJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):SU(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function kJe(t,e,r){return e=DZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Je(t,e){return HJe(t)||FJe(t,e)||DJe(t,e)||LJe()}function LJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DJe(t,e){if(!!t){if(typeof t=="string")return EU(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EU(t,e)}}function EU(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function FJe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function HJe(t){if(Array.isArray(t))return t}function BJe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function CU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,DZ(n.key),n)}}function UJe(t,e,r){return e&&CU(t.prototype,e),r&&CU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function DZ(t){var e=VJe(t,"string");return Ev(e)==="symbol"?e:String(e)}function VJe(t,e){if(Ev(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ev(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HC(t,e,r){jJe(t,e),e.set(t,r)}function jJe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vn(t,e){var r=FZ(t,e,"get");return WJe(t,r)}function WJe(t,e){return e.get?e.get.call(t):e.value}function zJe(t,e,r){var n=FZ(t,e,"set");return GJe(t,n,r),r}function FZ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function GJe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var uf=new WeakMap,Wl=new WeakMap,cf=new WeakMap,YJe=function(){function t(e){BJe(this,t),HC(this,uf,{writable:!0,value:new Map}),HC(this,Wl,{writable:!0,value:new Map}),HC(this,cf,{writable:!0,value:null}),zJe(this,cf,e)}return UJe(t,[{key:"getRoots",value:function(){return Array.from(Vn(this,uf).values())}},{key:"getRootByColumn",value:function(r){var n;return Vn(this,Wl).has(r)&&(n=Vn(this,uf).get(Vn(this,Wl).get(r))),n}},{key:"getNode",value:function(r,n){var i=this.getRootByColumn(n);if(!!i){var o=n-Vn(this,Wl).get(n),a=0,s;return i.walkDown(function(l){var u=l.data,c=u.origColspan,f=u.headerLevel;if(r===f){if(o>=a&&o<=a+c-1)return s=l,s.data.isRoot=n===s.data.columnIndex,!1;a+=c}}),s}}},{key:"rebuildTreeIndex",value:function(){var r=this,n=0;Vn(this,Wl).clear(),Q(Vn(this,uf),function(i){for(var o=$Je(i,2),a=o[1].data.colspan,s=n;s<n+a;s++)Vn(r,Wl).set(s,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var r=Vn(this,cf).getColumnsCount(),n=0;n<r;){var i=Vn(this,cf).getHeaderSettings(0,n),o=new wU;Vn(this,uf).set(n,o),this.buildLeaves(o,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(r,n,i){var o=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,s=Vn(this,cf).getHeadersSettings(i,n,a);i+=1,Q(s,function(l){var u=RU(RU({},l),{},{headerLevel:i-1,columnIndex:n}),c;i===1?(r.data=u,c=r):(c=new wU(u),r.addChild(c)),i<Vn(o,cf).getLayersCount()&&o.buildLeaves(c,n,i,l.origColspan),n+=l.origColspan})}},{key:"clear",value:function(){Vn(this,uf).clear(),Vn(this,Wl).clear()}}]),t}();function HZ(t,e){t.walkDown(function(r){var n=r.data,i=r.childs;if(!n.isHidden&&(e(n.columnIndex),i.length===0))for(var o=1;o<n.colspan;o++)e(n.columnIndex+o)})}function Yw(t,e){var r=t.childs;if(r.length!==0)return r[0].data[e]}function Kw(t){return Yw(t,"origColspan")===t.data.origColspan}function fI(t){var e=t.data,r=t.childs;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=Kw(t);if(n)return fI(r[0]);e.isCollapsed=!1;var i=r.slice(1),o=new Set,a=0;if(i.length>0)Q(i,function(f){f.replaceTreeWith(f.data.clonedTree),f.data.clonedTree=null;var h=f.data;a+=h.colspan,HZ(f,function(d){o.add(d)})});else{var s=e.colspan,l=e.origColspan,u=e.columnIndex;a=l-s;for(var c=1;c<l;c++)o.add(u+c)}return t.walkUp(function(f){var h=f.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):Kw(f)&&(h.isCollapsed=Yw(f,"isCollapsed"))}),{rollbackModification:function(){return hI(t)},affectedColumns:Array.from(o),colspanCompensation:a}}function hI(t){var e,r=t.data,n=t.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var i=Kw(t);if(i)return hI(n[0]);r.isCollapsed=!0;var o=n.slice(1),a=new Set;if(o.length>0)Q(o,function(h){HZ(h,function(d){a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(d){var p=d.data;p.isHidden=!0})});else for(var s=r.origColspan,l=r.columnIndex,u=1;u<s;u++){var c=l+u;a.add(c)}var f=r.colspan-((e=Yw(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(function(h){var d=h.data;d.colspan-=f,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):Kw(h)&&(d.isCollapsed=Yw(h,"isCollapsed"))}),{rollbackModification:function(){return fI(t)},affectedColumns:Array.from(a),colspanCompensation:f}}var _U;function KJe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function qJe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Gt(_U||(_U=KJe([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=t.data.crossHiddenColumns;if(!r.includes(e)){var n=!1;t.walkUp(function(i){var o=i.data.collapsible;if(o)return n=!0,!1}),!n&&t.walkUp(function(i){var o=i.data;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}}var TU;function XJe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function QJe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Gt(TU||(TU=XJe([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=t.data.crossHiddenColumns;if(!!r.includes(e)){var n=!1;t.walkUp(function(i){var o=i.data.collapsible;if(o)return n=!0,!1}),!n&&t.walkUp(function(i){var o=i.data;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}}var OU=new Map([["collapse",hI],["expand",fI],["hide-column",qJe],["show-column",QJe]]);function ZJe(t,e,r){if(!OU.has(t))throw new Error('The node modifier action ("'.concat(t,'") does not exist.'));return OU.get(t)(e,r)}var JJe=["crossHiddenColumns"];function eet(t,e){if(t==null)return{};var r=tet(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function tet(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function ob(t){var e=[];return Q(t,function(r){r.walkDown(function(n){for(var i=n.data,o=i.origColspan,a=i.columnIndex,s=i.headerLevel,l=i.crossHiddenColumns,u=net(e,s),c=!1,f=a;f<a+o;f++){var h=l.includes(f);if(h||c)u.push(IZ());else{var d=ret(i);d.isRoot=!0,u.push(d),c=!0}}})}),e}function ret(t){var e=eA(t);e.crossHiddenColumns;var r=eet(e,JJe);return r}function net(t,e){var r;return Array.isArray(t[e])?r=t[e]:(r=[],t[e]=r),r}function Cv(t){return Cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cv(t)}var iet=["row"];function AU(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function xU(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?AU(Object(r),!0).forEach(function(n){oet(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):AU(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function oet(t,e,r){return e=BZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aet(t,e){if(t==null)return{};var r=set(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(r[n]=t[n]))}return r}function set(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function uet(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function IU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,BZ(n.key),n)}}function cet(t,e,r){return e&&IU(t.prototype,e),r&&IU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function BZ(t){var e=fet(t,"string");return Cv(e)==="symbol"?e:String(e)}function fet(t,e){if(Cv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Cv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function BC(t,e,r){het(t,e),e.set(t,r)}function het(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tm(t,e,r){var n=UZ(t,e,"set");return det(t,n,r),r}function det(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function Or(t,e){var r=UZ(t,e,"get");return pet(t,r)}function UZ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function pet(t,e){return e.get?e.get.call(t):e.value}var Wo=new WeakMap,_i=new WeakMap,zl=new WeakMap,met=function(){function t(){uet(this,t),BC(this,Wo,{writable:!0,value:new SJe}),BC(this,_i,{writable:!0,value:new YJe(Or(this,Wo))}),BC(this,zl,{writable:!0,value:[[]]})}return cet(t,[{key:"setState",value:function(r){Or(this,Wo).setData(r);var n=!1;try{Or(this,_i).buildTree()}catch{Or(this,_i).clear(),Or(this,Wo).clear(),n=!0}return Tm(this,zl,ob(Or(this,_i).getRoots())),n}},{key:"setColumnsLimit",value:function(r){Or(this,Wo).setColumnsLimit(r)}},{key:"mergeStateWith",value:function(r){var n=this,i=bt(r,function(o){var a=o.row,s=aet(o,iet);return xU({row:a<0?n.rowCoordsToLevel(a):a},s)});Or(this,Wo).mergeWith(i),Or(this,_i).buildTree(),Tm(this,zl,ob(Or(this,_i).getRoots()))}},{key:"mapState",value:function(r){Or(this,Wo).map(r),Or(this,_i).buildTree(),Tm(this,zl,ob(Or(this,_i).getRoots()))}},{key:"mapNodes",value:function(r){return Hn(Or(this,_i).getRoots(),function(n,i){return i.walkDown(function(o){var a=r(o.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(r,n,i){n<0&&(n=this.rowCoordsToLevel(n));var o=Or(this,_i).getNode(n,i),a;return o&&(a=ZJe(r,o,i),Tm(this,zl,ob(Or(this,_i).getRoots()))),a}},{key:"triggerColumnModification",value:function(r,n){return this.triggerNodeModification(r,-1,n)}},{key:"rowCoordsToLevel",value:function(r){if(r>=0)return null;var n=r+Math.max(this.getLayersCount(),1);return n<0?null:n}},{key:"levelToRowCoords",value:function(r){if(r<0)return null;var n=r-Math.max(this.getLayersCount(),1);return n>=0?null:n}},{key:"getHeaderSettings",value:function(r,n){var i,o;return r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount()?null:(i=(o=Or(this,zl)[r])===null||o===void 0?void 0:o[n])!==null&&i!==void 0?i:null}},{key:"getHeaderTreeNodeData",value:function(r,n){if(r<0&&(r=this.rowCoordsToLevel(r)),r===null||r>=this.getLayersCount())return null;var i=Or(this,_i).getNode(r,n);return i?xU({},i.data):null}},{key:"findLeftMostColumnIndex",value:function(r,n){var i,o=(i=this.getHeaderSettings(r,n))!==null&&i!==void 0?i:{isRoot:!0},a=o.isRoot;if(a)return n;for(var s=n-1;s>=0;){var l,u=(l=this.getHeaderSettings(r,s))!==null&&l!==void 0?l:{isRoot:!0},c=u.isRoot;if(c)break;s-=1}return s}},{key:"getLayersCount",value:function(){return Or(this,Wo).getLayersCount()}},{key:"getColumnsCount",value:function(){return Or(this,Wo).getColumnsCount()}},{key:"clear",value:function(){Tm(this,zl,[]),Or(this,Wo).clear(),Or(this,_i).clear()}}]),t}();function _v(t){return _v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_v(t)}function get(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function MU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,VZ(n.key),n)}}function yet(t,e,r){return e&&MU(t.prototype,e),r&&MU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Om(t,e,r){return e=VZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VZ(t){var e=vet(t,"string");return _v(e)==="symbol"?e:String(e)}function vet(t,e){if(_v(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(_v(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bet=function(){function t(e,r){get(this,t),Om(this,"hot",void 0),Om(this,"nestedHeaderSettingsGetter",void 0),Om(this,"layersCount",0),Om(this,"container",void 0),Om(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return yet(t,[{key:"setLayersCount",value:function(r){return this.layersCount=r,this}},{key:"getWidth",value:function(r){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(r))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(var i=0;i<n;i++){var o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),a=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(a,r[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(r){for(var n=this.hot,i=n.rootDocument,o=n.columnIndexMapper,a=i.createDocumentFragment(),s=i.createElement("table"),l=!!this.hot.getSettings().dropdownMenu,u=o.getRenderableIndexesLength(),c=0;c<this.layersCount;c++){for(var f=i.createElement("tr"),h=0;h<u;h++){var d=o.getVisualFromRenderableIndex(h);d===null&&(d=h);var p=i.createElement("th"),m=this.nestedHeaderSettingsGetter(c,d);if(m&&(!m.isPlaceholder||m.isHidden)){var g=m.label;l&&(g+='<button class="changeType"></button>'),Hp(p,g),p.colSpan=m.colspan,f.appendChild(p)}}s.appendChild(f)}a.appendChild(s),r.appendChild(a)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),t}();const wet=bet;function ip(t){return ip=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ip(t)}var NU,PU;function kU(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Ret(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $U(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jZ(n.key),n)}}function Eet(t,e,r){return e&&$U(t.prototype,e),r&&$U(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _u(){return typeof Reflect<"u"&&Reflect.get?_u=Reflect.get.bind():_u=function(e,r,n){var i=Cet(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},_u.apply(this,arguments)}function Cet(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ss(t),t!==null););return t}function _et(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nA(t,e)}function nA(t,e){return nA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},nA(t,e)}function Tet(t){var e=Aet();return function(){var n=ss(t),i;if(e){var o=ss(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Oet(this,i)}}function Oet(t,e){if(e&&(ip(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jm(t)}function jm(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Aet(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ss(t){return ss=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ss(t)}function LU(t,e,r){return e=jZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jZ(t){var e=xet(t,"string");return ip(e)==="symbol"?e:String(e)}function xet(t,e){if(ip(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ip(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DU(t,e,r){Iet(t,e),e.set(t,r)}function Iet(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ab(t,e,r){var n=WZ(t,e,"set");return Met(t,n,r),r}function Met(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function gr(t,e){var r=WZ(t,e,"get");return Net(t,r)}function WZ(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function Net(t,e){return e.get?e.get.call(t):e.value}var FU="nestedHeaders",Pet=280,Dr=new WeakMap,Ds=new WeakMap,ket=function(t){_et(r,t);var e=Tet(r);function r(){var n;Ret(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o)),DU(jm(n),Dr,{writable:!0,value:new met}),DU(jm(n),Ds,{writable:!0,value:null}),LU(jm(n),"ghostTable",new wet(n.hot,function(s,l){return n.getHeaderSettings(s,l)})),LU(jm(n),"detectedOverlappedHeaders",!1),n}return Eet(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[FU]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),a=o.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&Xt(Gt(NU||(NU=kU([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(){return i.onAfterOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(s){return i.onAfterGetColumnHeaderRenderers(s)}),this.addHook("modifyColWidth",function(){return i.onModifyColWidth.apply(i,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return i.onModifyColumnHeaderValue.apply(i,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return i.onBeforeHighlightingColumnHeader.apply(i,arguments)}),this.addHook("beforeCopy",function(){return i.onBeforeCopy.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),_u(ss(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var i=this;if(!!this.hot.view){var o=this.hot.getSettings(),a=o.nestedHeaders;gr(this,Dr).setColumnsLimit(this.hot.countCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=gr(this,Dr).setState(a)),this.detectedOverlappedHeaders&&Xt(Gt(PU||(PU=kU([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(s,l){var u=s===!0?"hide-column":"show-column";gr(i,Dr).triggerColumnModification(u,l)}),!gr(this,Ds)&&this.enabled&&ab(this,Ds,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(s){s.forEach(function(l){var u=l.op,c=l.index,f=l.newValue;if(u==="replace"){var h=f===!0?"hide-column":"show-column";gr(i,Dr).triggerColumnModification(h,c)}}),i.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),_u(ss(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),gr(this,Dr).clear(),gr(this,Ds).unsubscribe(),ab(this,Ds,null),this.ghostTable.clear(),_u(ss(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return gr(this,Dr)}},{key:"getLayersCount",value:function(){return gr(this,Dr).getLayersCount()}},{key:"getHeaderSettings",value:function(i,o){return gr(this,Dr).getHeaderSettings(i,o)}},{key:"clearColspans",value:function(){if(!!this.hot.view)for(var i=this.hot.view._wt,o=i.getSetting("columnHeaders").length,a=i.wtTable.THEAD,s=i.wtOverlays.topOverlay.clone.wtTable.THEAD,l=i.wtOverlays.topInlineStartCornerOverlay?i.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,u=0;u<o;u++){var c=a.childNodes[u];if(!c)break;for(var f=s.childNodes[u],h=l?l.childNodes[u]:null,d=0,p=c.childNodes.length;d<p;d++)c.childNodes[d].removeAttribute("colspan"),ut(c.childNodes[d],"hiddenHeader"),f&&f.childNodes[d]&&(f.childNodes[d].removeAttribute("colspan"),ut(f.childNodes[d],"hiddenHeader")),l&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),ut(h.childNodes[d],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(i){var o=this,a=this.hot.view._wt.getSetting("fixedColumnsStart");return function(s,l){var u,c=o.hot,f=c.columnIndexMapper,h=c.view,d=f.getVisualFromRenderableIndex(s);d===null&&(d=s),l.removeAttribute("colspan"),ut(l,"hiddenHeader");var p=(u=gr(o,Dr).getHeaderSettings(i,d))!==null&&u!==void 0?u:{label:""},m=p.colspan,g=p.isHidden,v=p.isPlaceholder;if(v||g)Re(l,"hiddenHeader");else if(m>1){var S,b,E=h._wt.wtOverlays,T=(S=E.topInlineStartCornerOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(l),N=(b=E.inlineStartOverlay)===null||b===void 0?void 0:b.clone.wtTable.THEAD.contains(l),L=T||N?Math.min(m,a-s):m;L>1&&l.setAttribute("colspan",L)}o.hot.view.appendColHeader(d,l,function(){return o.getColumnHeaderValue.apply(o,arguments)},i)}}},{key:"getColumnHeaderValue",value:function(i,o){var a,s=(a=gr(this,Dr).getHeaderSettings(o,i))!==null&&a!==void 0?a:{},l=s.isHidden,u=s.isPlaceholder;return u||l?"":this.hot.getColHeader(i,o)}},{key:"onBeforeHighlightingColumnHeader",value:function(i,o,a){var s=gr(this,Dr).getHeaderTreeNodeData(o,i);if(!s)return i;var l=a.classNames,u=a.columnCursor,c=a.selectionType,f=a.selectionWidth,h=gr(this,Dr).getHeaderSettings(o,i),d=h.isRoot,p=h.colspan;if(c===U1){if(!d)return s.columnIndex}else c===V6&&(p>f-u||!d)&&(l.length=0);return i}},{key:"onBeforeCopy",value:function(i,o,a){var s=a.columnHeadersCount;if(s!==0)for(var l=0;l<o.length;l++){var u=o[l],c=u.startRow,f=u.startCol,h=u.endRow,d=u.endCol,p=h-c+1,m=f-d+1;if(c>=0||m===1)break;for(var g=f;g<=d;g++)for(var v=c;v<=h;v++){var S,b=p+v,E=g-f;if(E!==0){var T=(S=gr(this,Dr).getHeaderTreeNodeData(v,g))===null||S===void 0?void 0:S.isRoot;T===!1&&(i[b][E]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){var l=this._getHeaderTreeNodeDataByCoords(o);l&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,o){var a=this._getHeaderTreeNodeDataByCoords(o);if(!!a){var s=this.hot.selection,l=s.isSelected()?s.getSelectedRange().current():null,u=[],c=a.columnIndex,f=a.origColspan,h=!s.inInSelection(o);i.shiftKey&&l?o.col<l.from.col?u.push(l.getTopEndCorner().col,c,o.row):o.col>l.from.col?u.push(l.getTopStartCorner().col,c+f-1,o.row):u.push(c,c+f-1,o.row):(W8(i)||zu(i)&&h)&&u.push(c,c+f-1,o.row),s.selectColumns.apply(s,u)}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,a,s){var l;if(!!this.hot.view.isMouseDown()){var u=this._getHeaderTreeNodeDataByCoords(o);if(!!u){var c=u.columnIndex,f=u.origColspan,h=this.hot.getSelectedRangeLast(),d=h.getTopStartCorner(),p=h.getBottomEndCorner(),m=h.from;s.column=!0,s.cell=!0;var g=[];o.col<m.col?g.push(p.col,c):o.col>m.col?g.push(d.col,c+f-1):g.push(c,c+f-1),(l=this.hot).selectColumns.apply(l,g)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(i){i.length=0;for(var o=0;o<gr(this,Dr).getLayersCount();o++)i.push(this.headerRendererFactory(o))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){for(var o=gr(this,Dr).getLayersCount(),a=i.startColumn,s=!!o,l=0;l<o;l++){var u=gr(this,Dr).findLeftMostColumnIndex(l,i.startColumn),c=this.hot.columnIndexMapper.getRenderableFromVisualIndex(u);if(u>=0&&(s=!1),zi(c)&&c<i.startColumn){a=c;break}}i.startColumn=s?gr(this,Dr).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(i,o){var a=this.ghostTable.getWidth(o);return i>a?i:a}},{key:"onModifyColumnHeaderValue",value:function(i,o,a){var s,l=(s=gr(this,Dr).getHeaderTreeNodeData(a,o))!==null&&s!==void 0?s:{label:""},u=l.label;return u}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,o){o||this.updatePlugin()}},{key:"destroy",value:function(){ab(this,Dr,null),gr(this,Ds)!==null&&(gr(this,Ds).unsubscribe(),ab(this,Ds,null)),_u(ss(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(i){if(!(i.row>=0||i.col<0))return gr(this,Dr).getHeaderTreeNodeData(i.row,i.col)}}],[{key:"PLUGIN_KEY",get:function(){return FU}},{key:"PLUGIN_PRIORITY",get:function(){return Pet}}]),r}(jt);function HU(t){return Fet(t)||Det(t)||Let(t)||$et()}function $et(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Let(t,e){if(!!t){if(typeof t=="string")return iA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iA(t,e)}}function Det(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Fet(t){if(Array.isArray(t))return iA(t)}function iA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function op(t){return op=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},op(t)}function Het(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function BU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Uet(n.key),n)}}function Bet(t,e,r){return e&&BU(t.prototype,e),r&&BU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Uet(t){var e=Vet(t,"string");return op(e)==="symbol"?e:String(e)}function Vet(t,e){if(op(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(op(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jet=function(){function t(e,r){Het(this,t),this.hot=r,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return Bet(t,[{key:"setData",value:function(r){this.data=r}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var r=null;return this.plugin.disableCoreAPIModifiers(),r=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),r}},{key:"updateWithData",value:function(r){this.setData(r),this.rewriteCache()}},{key:"rewriteCache",value:function(){var r=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ye(0,this.data.length-1,function(n){r.cacheNode(r.data[n],0,null)})}},{key:"cacheNode",value:function(r,n,i){var o=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(r),this.cache.rows.push(r),this.cache.nodeInfo.set(r,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(r)&&Q(r.__children,function(a){o.cacheNode(a,n+1,r)})}},{key:"getDataObject",value:function(r){return r==null?null:this.cache.rows[r]}},{key:"readTreeNodes",value:function(r,n,i,o){var a=this,s=!1,l=n;if(isNaN(l)&&l.end)return l;var u=r;return u||(u={__children:this.data},s=!0,l-=1),i!=null&&l===i?{result:u,end:!0}:o!=null&&u===o?{result:l,end:!0}:(l+=1,u.__children&&Q(u.__children,function(c){if(a.parentReference.set(c,s?null:u),l=a.readTreeNodes(c,l,i,o),isNaN(l)&&l.end)return!1}),l)}},{key:"mockParent",value:function(){var r=this.mockNode();return r.__children=this.data,r}},{key:"mockNode",value:function(){var r={};return St(this.data[0],function(n,i){r[i]=null}),r}},{key:"getRowIndex",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).row}},{key:"getRowIndexWithinParent",value:function(r){var n=null;isNaN(r)?n=r:n=this.getDataObject(r);var i=this.getRowParent(r);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}},{key:"countAllRows",value:function(){var r={__children:this.data};return this.countChildren(r)}},{key:"countChildren",value:function(r){var n=this,i=0,o=r;return isNaN(o)||(o=this.getDataObject(o)),!o||!o.__children?0:(Q(o.__children,function(a){i+=1,a.__children&&(i+=n.countChildren(a))}),i)}},{key:"getRowParent",value:function(r){var n;return isNaN(r)?n=r:n=this.getDataObject(r),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(r){return!r||op(r)!=="object"?null:this.cache.nodeInfo.get(r).parent}},{key:"getRowLevel",value:function(r){var n=null;return isNaN(r)?n=r:n=this.getDataObject(r),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(r){return r==null?null:this.cache.nodeInfo.get(r).level}},{key:"hasChildren",value:function(r){var n=r;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(r){return this.getRowParent(r)!==null}},{key:"getChild",value:function(r,n){var i;return((i=r.__children)===null||i===void 0?void 0:i[n])||null}},{key:"isRowHighestLevel",value:function(r){return!this.isChild(r)}},{key:"isParent",value:function(r){var n,i=r;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(r,n){var i=n;this.hot.runHooks("beforeAddChild",r,i);var o=null;r&&(o=this.getRowIndex(r)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(r)+1,1);var a=r;r||(a=this.mockParent()),a.__children||(a.__children=[]),i||(i=this.mockNode()),a.__children.push(i),this.rewriteCache();var s=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",r,i)}},{key:"addChildAtIndex",value:function(r,n,i){var o=i,a;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",r,o,n),r){var s=this.getRowIndex(r),l=s+n+1;this.hot.runHooks("beforeCreateRow",l,1),r.__children.splice(n,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),a=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);o=this.getDataObject(a),this.hot.runHooks("afterAddChild",r,o,n)}},{key:"addSibling",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",i=this.translateTrimmedRow(r),o=this.getRowParent(i),a=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(o,a+1,null);break;case"above":this.addChildAtIndex(o,a,null);break}}},{key:"detachFromParent",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=null,a=[];Array.isArray(r)?(Ye(r[0],r[2],function(v){var S=n.translateTrimmedRow(v);a.push(n.getDataObject(S))}),Ye(0,a.length-2,function(v){n.detachFromParent(a[v],!1)}),o=a[a.length-1]):o=r;var s=this.getRowIndex(o),l=this.countChildren(o),u=this.getRowIndexWithinParent(o),c=this.getRowParent(o),f=this.getRowParent(c),h=this.getRowIndex(f),d=null;if(this.hot.runHooks("beforeDetachChild",c,o),u!=null){var p=Array.from(new Array(s+l+1).keys()).splice(-1*(l+1));if(this.hot.runHooks("beforeRemoveRow",s,l+1,p,this.plugin.pluginName),c.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,l+1,p,this.plugin.pluginName),f){d=h+this.countChildren(f);var m=this.getChild(f,this.countChildren(f)-1),g=this.getRowIndex(m);this.hot.runHooks("beforeCreateRow",g+1,l+1,this.plugin.pluginName),f.__children.push(o)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,l+1,this.plugin.pluginName),this.data.push(o)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,l+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",c,o,this.getRowIndex(o)),i&&this.hot.render()}},{key:"filterData",value:function(r,n,i){var o=this,a=[];Q(i,function(s){a.push(o.getDataObject(s))}),Q(a,function(s){var l=o.getRowIndexWithinParent(s),u=o.getRowParent(s);u===null?o.data.splice(l,1):u.__children.splice(l,1)}),this.rewriteCache()}},{key:"spliceData",value:function(r,n,i){var o=this.getDataObject(r-1),a=null,s=r;if(o&&o.__children&&o.__children.length===0?(a=o,s=0):r<this.countAllRows()&&(a=this.getRowParent(r),s=this.getRowIndexWithinParent(r)),a)if(i){var l;(l=a.__children).splice.apply(l,[s,n].concat(HU(i)))}else a.__children.splice(s,n);else if(i){var u;(u=this.data).splice.apply(u,[s,n].concat(HU(i)))}else this.data.splice(s,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(r){var n=r,i=null;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(r,n,i,o){var a=n===this.hot.countRows(),s=this.getRowParent(r),l=this.getRowIndexWithinParent(r),u=s.__children.slice(l,l+1),c=r>n,f=a?this.getRowParent(n-1):this.getRowParent(n);f==null&&(f=this.getRowParent(n-1)),f==null&&(f=this.getDataObject(n-1)),f?f.__children||(f.__children=[]):(f=this.getDataObject(n),f.__children=[]);var h=a||i||o?f.__children.length:this.getRowIndexWithinParent(n),d=s===f;f.__children.splice(h,0,u[0]),s.__children.splice(l+(c&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(f)}},{key:"translateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(r):r}},{key:"untranslateTrimmedRow",value:function(r){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(r):r}}]),t}();const Wet=jet;function Tv(t){return Tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tv(t)}function UU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Get(n.key),n)}}function zet(t,e,r){return e&&UU(t.prototype,e),r&&UU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Get(t){var e=Yet(t,"string");return Tv(e)==="symbol"?e:String(e)}function Yet(t,e){if(Tv(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Tv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ket(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var qet=zet(function t(e,r){Ket(this,t),this.hot=r,this.plugin=e});const dI=qet;function ap(t){return ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ap(t)}function Xet(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zet(n.key),n)}}function Qet(t,e,r){return e&&VU(t.prototype,e),r&&VU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zet(t){var e=Jet(t,"string");return ap(e)==="symbol"?e:String(e)}function Jet(t,e){if(ap(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ap(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ett(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oA(t,e)}function oA(t,e){return oA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},oA(t,e)}function ttt(t){var e=itt();return function(){var n=qw(t),i;if(e){var o=qw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return rtt(this,i)}}function rtt(t,e){if(e&&(ap(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ntt(t)}function ntt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function itt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qw(t){return qw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qw(t)}var ott=function(t){ett(r,t);var e=ttt(r);function r(n,i){var o;return Xet(this,r),o=e.call(this,n,i),o.dataManager=o.plugin.dataManager,o.collapsingUI=o.plugin.collapsingUI,o.rowHeaderWidthCache=null,o}return Qet(r,[{key:"appendLevelIndicators",value:function(i,o){var a=this.hot.toPhysicalRow(i),s=this.dataManager.getRowLevel(a),l=this.dataManager.getDataObject(a),u=o.getElementsByTagName("DIV")[0],c=u.querySelector("span.rowHeader"),f=u.querySelectorAll('[class^="ht_nesting"]');if(Q(f,function(m){m&&u.removeChild(m)}),Re(o,r.CSS_CLASSES.indicatorContainer),s){var h=this.hot.rootDocument,d=c.cloneNode(!0);u.innerHTML="",Ye(0,s-1,function(){var m=h.createElement("SPAN");Re(m,r.CSS_CLASSES.emptyIndicator),u.appendChild(m)}),u.appendChild(d)}if(this.dataManager.hasChildren(l)){var p=this.hot.rootDocument.createElement("DIV");Re(o,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?Re(p,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):Re(p,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),u.appendChild(p)}}},{key:"updateRowHeaderWidth",value:function(i){var o=i;o||(o=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*o+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(dI);const zZ=ott;function sp(t){return sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sp(t)}function jU(t){return utt(t)||ltt(t)||stt(t)||att()}function att(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function stt(t,e){if(!!t){if(typeof t=="string")return aA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aA(t,e)}}function ltt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function utt(t){if(Array.isArray(t))return aA(t)}function aA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ctt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,htt(n.key),n)}}function ftt(t,e,r){return e&&WU(t.prototype,e),r&&WU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function htt(t){var e=dtt(t,"string");return sp(e)==="symbol"?e:String(e)}function dtt(t,e){if(sp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(sp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ptt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sA(t,e)}function sA(t,e){return sA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sA(t,e)}function mtt(t){var e=vtt();return function(){var n=Xw(t),i;if(e){var o=Xw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return gtt(this,i)}}function gtt(t,e){if(e&&(sp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ytt(t)}function ytt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function vtt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xw(t){return Xw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xw(t)}var btt=function(t){ptt(r,t);var e=mtt(r);function r(n,i){var o;return ctt(this,r),o=e.call(this,n,i),o.dataManager=o.plugin.dataManager,o.collapsedRows=[],o.collapsedRowsStash={stash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,s)},shiftStash:function(s,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;l==null&&(l=1/0),Q(o.lastCollapsedRows,function(c,f){c>=s&&c<l&&(o.lastCollapsedRows[f]=c+u)})},applyStash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;o.collapseMultipleChildren(o.lastCollapsedRows,s),o.lastCollapsedRows=void 0},trimStash:function(s,l){Ye(s,s+l-1,function(u){var c=o.lastCollapsedRows.indexOf(u);c>-1&&o.lastCollapsedRows.splice(c,1)})}},o}return ftt(r,[{key:"collapseChildren",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,c=null,f=null;return isNaN(i)?(u=i,c=this.dataManager.getRowIndex(u)):(u=this.dataManager.getDataObject(i),c=i),this.dataManager.hasChildren(u)&&Q(u.__children,function(h){l.push(o.dataManager.getRowIndex(h))}),f=this.collapseRows(l,!0,!1),s&&this.trimRows(f),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(c)===-1&&this.collapsedRows.push(c),f}},{key:"collapseMultipleChildren",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];Q(i,function(u){l.push.apply(l,jU(o.collapseChildren(u,!1,!1)))}),s&&this.trimRows(l),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([i],o)}},{key:"collapseRows",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return Q(i,function(u){l.push(u),a&&o.collapseChildRows(u,l)}),s&&this.trimRows(l),l}},{key:"collapseChildRows",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var l=this.dataManager.getDataObject(i);Q(l.__children,function(u){var c=o.dataManager.getRowIndex(u);a.push(c),o.collapseChildRows(c,a)})}s&&this.trimRows(a)}},{key:"expandRow",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([i],o)}},{key:"expandRows",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return Q(i,function(u){l.push(u),a&&o.expandChildRows(u,l)}),s&&this.untrimRows(l),l}},{key:"expandChildRows",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var l=this.dataManager.getDataObject(i);Q(l.__children,function(u){if(!o.isAnyParentCollapsed(u)){var c=o.dataManager.getRowIndex(u);a.push(c),o.expandChildRows(c,a)}})}s&&this.untrimRows(a)}},{key:"expandChildren",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],u=null,c=null,f=null;return isNaN(i)?(u=i,c=this.dataManager.getRowIndex(i)):(u=this.dataManager.getDataObject(i),c=i),this.collapsedRows.splice(this.collapsedRows.indexOf(c),1),this.dataManager.hasChildren(u)&&Q(u.__children,function(h){var d=o.dataManager.getRowIndex(h);l.push(d)}),f=this.expandRows(l,!0,!1),s&&this.untrimRows(f),a&&this.renderAndAdjust(),f}},{key:"expandMultipleChildren",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];Q(i,function(u){l.push.apply(l,jU(o.expandChildren(u,!1,!1)))}),s&&this.untrimRows(l),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var i=this,o=this.dataManager.getData(),a=[];Q(o,function(s){i.dataManager.hasChildren(s)&&a.push(s)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var i=this,o=this.dataManager.getData(),a=[];Q(o,function(s){i.dataManager.hasChildren(s)&&a.push(s)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(i){var o=this;this.hot.batchExecution(function(){Q(i,function(a){o.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(i){var o=this;this.hot.batchExecution(function(){Q(i,function(a){o.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(i){var o=this,a=isNaN(i)?i:this.dataManager.getDataObject(i),s=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&Q(a.__children,function(l){var u=o.dataManager.getRowIndex(l);if(!o.plugin.collapsedRowsMap.getValueAtIndex(u))return s=!1,!1}),s}},{key:"isAnyParentCollapsed",value:function(i){for(var o=i;o!==null;){o=this.dataManager.getRowParent(o);var a=this.dataManager.getRowIndex(o);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(i,o){if(!(o.col>=0)){var a=this.translateTrimmedRow(o.row);at(i.target,zZ.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),la(i))}}},{key:"translateTrimmedRow",value:function(i){return this.hot.toPhysicalRow(i)}},{key:"untranslateTrimmedRow",value:function(i){return this.hot.toVisualRow(i)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(dI);const wtt=btt;function lp(t){return lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lp(t)}function Stt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ett(n.key),n)}}function Rtt(t,e,r){return e&&zU(t.prototype,e),r&&zU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ett(t){var e=Ctt(t,"string");return lp(e)==="symbol"?e:String(e)}function Ctt(t,e){if(lp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(lp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _tt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lA(t,e)}function lA(t,e){return lA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lA(t,e)}function Ttt(t){var e=Att();return function(){var n=Qw(t),i;if(e){var o=Qw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ott(this,i)}}function Ott(t,e){if(e&&(lp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GZ(t)}function GZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Att(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qw(t){return Qw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qw(t)}var GU=new WeakMap,xtt=function(t){_tt(r,t);var e=Ttt(r);function r(n,i){var o;return Stt(this,r),o=e.call(this,n,i),GU.set(GZ(o),{row_above:function(s,l){var u=l[l.length-1];o.dataManager.addSibling(u.start.row,"above")},row_below:function(s,l){var u=l[l.length-1];o.dataManager.addSibling(u.start.row,"below")}}),o.dataManager=o.plugin.dataManager,o}return Rtt(r,[{key:"appendOptions",value:function(i){var o=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(mx)},callback:function(){var l=o.dataManager.translateTrimmedRow(o.hot.getSelectedLast()[0]),u=o.dataManager.getDataObject(l);o.dataManager.addChild(u)},disabled:function(){var l=o.hot.getSelectedLast();return!l||l[0]<0||o.hot.selection.isSelectedByColumnHeader()||o.hot.countRows()>=o.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(gx)},callback:function(){o.dataManager.detachFromParent(o.hot.getSelectedLast())},disabled:function(){var l=o.hot.getSelectedLast(),u=o.dataManager.translateTrimmedRow(l[0]),c=o.dataManager.getRowParent(u);return!c||!l||l[0]<0||o.hot.selection.isSelectedByColumnHeader()||o.hot.countRows()>=o.hot.getSettings().maxRows}},{name:"---------"}];return Ye(0,i.items.length-1,function(s){if(s===0)return Q(a,function(l,u){i.items.splice(s+u,0,l)}),!1}),this.modifyRowInsertingOptions(i)}},{key:"modifyRowInsertingOptions",value:function(i){var o=GU.get(this);return Ye(0,i.items.length-1,function(a){var s=o[i.items[a].key];s!=null&&(i.items[a].callback=s)}),i}}]),r}(dI);const Itt=xtt;function Ov(t){return Ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ov(t)}var YU;function KU(t){return ktt(t)||Ptt(t)||Ntt(t)||Mtt()}function Mtt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ntt(t,e){if(!!t){if(typeof t=="string")return uA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uA(t,e)}}function Ptt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ktt(t){if(Array.isArray(t))return uA(t)}function uA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function $tt(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Ltt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ftt(n.key),n)}}function Dtt(t,e,r){return e&&qU(t.prototype,e),r&&qU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ftt(t){var e=Htt(t,"string");return Ov(e)==="symbol"?e:String(e)}function Htt(t,e){if(Ov(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ov(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Btt=function(){function t(e){Ltt(this,t),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}return Dtt(t,[{key:"onBeforeRowMove",value:function(r,n,i,o){var a=this,s=this.displayAPICompatibilityWarning({rows:r,finalIndex:n,dropIndex:i,movePossible:o});if(s)return!1;this.movedToCollapsed=!1;var l=i===this.hot.countRows(),u=l?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i),c=!0,f=r.map(function(g){if(!c)return!1;var v=a.dataManager.translateTrimmedRow(g);return c=a.shouldAllowMoving(v,u),v}),h=f.indexOf(u)===-1;if(!c||!h)return!1;var d=this.getBaseParent(f),p=this.getTargetParent(l,u),m=d===p;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(p),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(f,u,m),this.moveRows(f,u,p),this.dataManager.rewriteCache(),this.moveCellsMeta(f,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",r,n,i,o,o&&this.isRowOrderChanged(r,n)),this.hot.render(),this.selectCells(r,i),!1}},{key:"displayAPICompatibilityWarning",value:function(r){var n=r.rows,i=r.finalIndex,o=r.dropIndex,a=r.movePossible,s=!1;return tr(o)&&(Xt(Gt(YU||(YU=$tt([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,i,o,a,!1),s=!0),s}},{key:"shouldAllowMoving",value:function(r,n){return!(this.dataManager.isParent(r)||this.dataManager.isRowHighestLevel(r)||r===n||n===0)}},{key:"getBaseParent",value:function(r){return this.dataManager.getRowParent(r[0])}},{key:"getTargetParent",value:function(r,n){var i=this.dataManager.getRowParent(r?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}},{key:"shiftCollapsibleParentsLocations",value:function(r,n,i){i||(Math.max.apply(Math,KU(r))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(r[0],n,-1*r.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,r[0],r.length))}},{key:"moveRows",value:function(r,n,i){var o=this,a=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(function(){r.forEach(function(s){o.dataManager.moveRow(s,n,o.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(r,n){var i=this,o,a=[],s=Math.max.apply(Math,KU(r))<n;r.forEach(function(l){a.push(i.hot.getCellMetaAtRow(l))}),this.hot.spliceCellsMeta(r[0],r.length),(o=this.hot).spliceCellsMeta.apply(o,[n-(s?a.length:0),0].concat(a))}},{key:"selectCells",value:function(r,n){var i=r.length,o=0,a=0,s=null,l=null;if(this.movedToCollapsed){var u=null;r[i-1]<n?u=this.dataManager.translateTrimmedRow(n-i):u=this.dataManager.translateTrimmedRow(n);var c=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),f=this.dataManager.getRowIndex(c);o=this.dataManager.untranslateTrimmedRow(f),a=o}else r[i-1]<n?(a=n-1,o=a-i+1):(o=n,a=o+i-1);s=this.hot.selection,l=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(o,0)),s.setRangeEnd(this.hot._createCellCoords(a,l),!0)}},{key:"isRowOrderChanged",value:function(r,n){return r.some(function(i,o){return i-o!==n})}}]),t}();function up(t){return up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},up(t)}function Utt(t){return ztt(t)||Wtt(t)||jtt(t)||Vtt()}function Vtt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jtt(t,e){if(!!t){if(typeof t=="string")return cA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cA(t,e)}}function Wtt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ztt(t){if(Array.isArray(t))return cA(t)}function cA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Gtt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function XU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ktt(n.key),n)}}function Ytt(t,e,r){return e&&XU(t.prototype,e),r&&XU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ktt(t){var e=qtt(t,"string");return up(e)==="symbol"?e:String(e)}function qtt(t,e){if(up(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(up(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tu(){return typeof Reflect<"u"&&Reflect.get?Tu=Reflect.get.bind():Tu=function(e,r,n){var i=Xtt(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Tu.apply(this,arguments)}function Xtt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ls(t),t!==null););return t}function Qtt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fA(t,e)}function fA(t,e){return fA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fA(t,e)}function Ztt(t){var e=ert();return function(){var n=ls(t),i;if(e){var o=ls(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Jtt(this,i)}}function Jtt(t,e){if(e&&(up(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YZ(t)}function YZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ert(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ls(t){return ls=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ls(t)}var UC="nestedRows",trt=300,Aa=new WeakMap,rrt="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",nrt=function(t){Qtt(r,t);var e=Ztt(r);function r(n){var i;return Gtt(this,r),i=e.call(this,n),i.dataManager=null,i.headersUI=null,i.collapsedRowsMap=null,Aa.set(YZ(i),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),i}return Ytt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[UC]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new L1),this.dataManager=new Wet(this,this.hot),this.collapsingUI=new wtt(this,this.hot),this.headersUI=new zZ(this,this.hot),this.contextMenuUI=new Itt(this,this.hot),this.rowMoveController=new Btt(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("beforeViewRender",function(){return i.onBeforeViewRender.apply(i,arguments)}),this.addHook("modifyRowData",function(){return i.onModifyRowData.apply(i,arguments)}),this.addHook("modifySourceLength",function(){return i.onModifySourceLength.apply(i,arguments)}),this.addHook("beforeDataSplice",function(){return i.onBeforeDataSplice.apply(i,arguments)}),this.addHook("filterData",function(){return i.onFilterData.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("beforeAddChild",function(){return i.onBeforeAddChild.apply(i,arguments)}),this.addHook("afterAddChild",function(){return i.onAfterAddChild.apply(i,arguments)}),this.addHook("beforeDetachChild",function(){return i.onBeforeDetachChild.apply(i,arguments)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return i.onModifyRowHeaderWidth.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("beforeRowMove",function(){return i.onBeforeRowMove.apply(i,arguments)}),this.addHook("beforeLoadData",function(o){return i.onBeforeLoadData(o)}),this.addHook("beforeUpdateData",function(o){return i.onBeforeLoadData(o)}),Tu(ls(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),Tu(ls(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var i=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(i),Tu(ls(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(i,o,a,s){return this.rowMoveController.onBeforeRowMove(i,o,a,s)}},{key:"disableCoreAPIModifiers",value:function(){var i=Aa.get(this);i.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var i=Aa.get(this);i.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a){this.collapsingUI.toggleState(i,o,a)}},{key:"onModifyRowData",value:function(i){var o=Aa.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.getDataObject(i)}},{key:"onModifySourceLength",value:function(){var i=Aa.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(i,o,a){var s=Aa.get(this);return s.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(i)?!0:(this.dataManager.spliceData(i,o,a),!1)}},{key:"onFilterData",value:function(i,o,a){var s=Aa.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],o),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*o),this.dataManager.filterData(i,o,a),s.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(i){return this.contextMenuUI.appendOptions(i)}},{key:"onAfterGetRowHeader",value:function(i,o){this.headersUI.appendLevelIndicators(i,o)}},{key:"onModifyRowHeaderWidth",value:function(i){return this.headersUI.rowHeaderWidthCache||i}},{key:"onAfterRemoveRow",value:function(i,o,a,s){var l=this;if(s!==this.pluginName){var u=Aa.get(this);setTimeout(function(){u.skipRender=null,l.headersUI.updateRowHeaderWidth(),l.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(i,o,a){var s=this,l=Array.from(a.reduce(function(u,c){if(s.dataManager.isParent(c)){var f=s.dataManager.getDataObject(c).__children;return u.add(c),Array.isArray(f)&&f.forEach(function(h){return u.add(s.dataManager.getRowIndex(h))}),u}return u.add(c)},new Set));a.length=0,a.push.apply(a,l)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(i,o){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(o)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(i,o,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var i=Math.max.apply(Math,Utt(this.dataManager.cache.levels));i>0&&this.headersUI.updateRowHeaderWidth(i)}},{key:"onBeforeViewRender",value:function(i,o){var a=Aa.get(this);a.skipRender&&(o.skipRender=!0)}},{key:"destroy",value:function(){Tu(ls(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(i){if(!X$e(i)){X8(rrt),this.hot.getSettings()[UC]=!1,this.disablePlugin();return}this.dataManager.setData(i),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return UC}},{key:"PLUGIN_PRIORITY",get:function(){return trt}}]),r}(jt);function Av(t){return Av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Av(t)}function irt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,art(n.key),n)}}function ort(t,e,r){return e&&QU(t.prototype,e),r&&QU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function art(t){var e=srt(t,"string");return Av(e)==="symbol"?e:String(e)}function srt(t,e){if(Av(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Av(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lrt=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;irt(this,t),this.rootWindow=r,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}return ort(t,[{key:"saveValue",value:function(r,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(r),JSON.stringify(n)),this.savedKeys.indexOf(r)===-1&&(this.savedKeys.push(r),this.saveSavedKeys())}},{key:"loadValue",value:function(r,n){var i=typeof r>"u"?n:r,o=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(i));return o===null?void 0:JSON.parse(o)}},{key:"reset",value:function(r){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(r))}},{key:"resetAll",value:function(){var r=this;Q(this.savedKeys,function(n,i){r.rootWindow.localStorage.removeItem("".concat(r.prefix,"_").concat(r.savedKeys[i]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof r=="string"?JSON.parse(r):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),t}();const urt=lrt;function cp(t){return cp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cp(t)}function crt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ZU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hrt(n.key),n)}}function frt(t,e,r){return e&&ZU(t.prototype,e),r&&ZU(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function hrt(t){var e=drt(t,"string");return cp(e)==="symbol"?e:String(e)}function drt(t,e){if(cp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(cp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ou(){return typeof Reflect<"u"&&Reflect.get?Ou=Reflect.get.bind():Ou=function(e,r,n){var i=prt(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ou.apply(this,arguments)}function prt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=us(t),t!==null););return t}function mrt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hA(t,e)}function hA(t,e){return hA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},hA(t,e)}function grt(t){var e=brt();return function(){var n=us(t),i;if(e){var o=us(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return yrt(this,i)}}function yrt(t,e){if(e&&(cp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vrt(t)}function vrt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function brt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function us(t){return us=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},us(t)}Ue.getSingleton().register("persistentStateSave");Ue.getSingleton().register("persistentStateLoad");Ue.getSingleton().register("persistentStateReset");var JU="persistentState",wrt=0,Srt=function(t){mrt(r,t);var e=grt(r);function r(n){var i;return crt(this,r),i=e.call(this,n),i.storage=void 0,i}return frt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[JU]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.storage||(this.storage=new urt(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(o,a){return i.saveValue(o,a)}),this.addHook("persistentStateLoad",function(o,a){return i.loadValue(o,a)}),this.addHook("persistentStateReset",function(){return i.resetValue()}),Ou(us(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,Ou(us(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ou(us(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(i,o){o.value=this.storage.loadValue(i)}},{key:"saveValue",value:function(i,o){this.storage.saveValue(i,o)}},{key:"resetValue",value:function(i){typeof i>"u"?this.storage.resetAll():this.storage.reset(i)}},{key:"destroy",value:function(){Ou(us(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return JU}},{key:"PLUGIN_PRIORITY",get:function(){return wrt}}]),r}(jt);function fp(t){return fp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fp(t)}function Rrt(t){return Trt(t)||_rt(t)||Crt(t)||Ert()}function Ert(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Crt(t,e){if(!!t){if(typeof t=="string")return dA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dA(t,e)}}function _rt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Trt(t){if(Array.isArray(t))return dA(t)}function dA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ort(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eV(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xrt(n.key),n)}}function Art(t,e,r){return e&&eV(t.prototype,e),r&&eV(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function xrt(t){var e=Irt(t,"string");return fp(e)==="symbol"?e:String(e)}function Irt(t,e){if(fp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Au(){return typeof Reflect<"u"&&Reflect.get?Au=Reflect.get.bind():Au=function(e,r,n){var i=Mrt(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Au.apply(this,arguments)}function Mrt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=cs(t),t!==null););return t}function Nrt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pA(t,e)}function pA(t,e){return pA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},pA(t,e)}function Prt(t){var e=Lrt();return function(){var n=cs(t),i;if(e){var o=cs(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return krt(this,i)}}function krt(t,e){if(e&&(fp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $rt(t)}function $rt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Lrt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cs(t){return cs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cs(t)}var VC="search",Drt=190,Frt="htSearchResult",Hrt=function(e,r,n,i,o){e.getCellMeta(r,n).isSearchResult=o},Brt=function(e,r,n){return tr(e)||e===null||!e.toLocaleLowerCase||e.length===0||tr(r)||r===null?!1:r.toString().toLocaleLowerCase(n.locale).indexOf(e.toLocaleLowerCase(n.locale))!==-1},Urt=function(t){Nrt(r,t);var e=Prt(r);function r(n){var i;return Ort(this,r),i=e.call(this,n),i.callback=Hrt,i.queryMethod=Brt,i.searchResultClass=Frt,i}return Art(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[VC]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[VC];this.updatePluginSettings(o),this.addHook("beforeRenderer",function(){return i.onBeforeRenderer.apply(i,arguments)}),Au(cs(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this,o=function(){return i.onBeforeRenderer.apply(i,arguments)};this.hot.addHook("beforeRenderer",o),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("beforeRenderer",o)}),Au(cs(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Au(cs(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),l=this.hot.countRows(),u=this.hot.countCols(),c=[],f=this.hot;return Ye(0,l-1,function(h){Ye(0,u-1,function(d){var p=o.hot.getDataAtCell(h,d),m=o.hot.getCellMeta(h,d),g=m.search.callback||a,v=m.search.queryMethod||s,S=v(i,p,m);if(S){var b={row:h,col:d,data:p};c.push(b)}g&&g(f,h,d,p,S)})}),c}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(i){this.callback=i}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(i){this.queryMethod=i}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(i){this.searchResultClass=i}},{key:"updatePluginSettings",value:function(i){wt(i)&&(i.searchResultClass&&this.setSearchResultClass(i.searchResultClass),i.queryMethod&&this.setQueryMethod(i.queryMethod),i.callback&&this.setCallback(i.callback))}},{key:"onBeforeRenderer",value:function(i,o,a,s,l,u){var c=u.className||[],f=[];if(typeof c=="string")f=c.split(" ");else{var h;(h=f).push.apply(h,Rrt(c))}this.isEnabled()&&u.isSearchResult?f.includes(this.searchResultClass)||f.push("".concat(this.searchResultClass)):f.includes(this.searchResultClass)&&f.splice(f.indexOf(this.searchResultClass),1),u.className=f.join(" ")}},{key:"destroy",value:function(){Au(cs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return VC}},{key:"PLUGIN_PRIORITY",get:function(){return Drt}}]),r}(jt);function hp(t){return hp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hp(t)}function Vrt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tV(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wrt(n.key),n)}}function jrt(t,e,r){return e&&tV(t.prototype,e),r&&tV(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Wrt(t){var e=zrt(t,"string");return hp(e)==="symbol"?e:String(e)}function zrt(t,e){if(hp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(hp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jf(){return typeof Reflect<"u"&&Reflect.get?Jf=Reflect.get.bind():Jf=function(e,r,n){var i=Grt(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Jf.apply(this,arguments)}function Grt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ul(t),t!==null););return t}function Yrt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mA(t,e)}function mA(t,e){return mA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},mA(t,e)}function Krt(t){var e=Qrt();return function(){var n=ul(t),i;if(e){var o=ul(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return qrt(this,i)}}function qrt(t,e){if(e&&(hp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xrt(t)}function Xrt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qrt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ul(t){return ul=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ul(t)}var Zrt="touchScroll",Jrt=200,ent=function(t){Yrt(r,t);var e=Krt(r);function r(n){var i;return Vrt(this,r),i=e.call(this,n),i.scrollbars=[],i.clones=[],i.lockedCollection=!1,i.freezeOverlays=!1,i}return jrt(r,[{key:"isEnabled",value:function(){return IK()}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterViewRender",function(){return i.onAfterViewRender()}),this.registerEvents(),Jf(ul(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,Jf(ul(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Jf(ul(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.addHook("beforeTouchScroll",function(){return i.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return i.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var i=this.hot.view._wt.wtOverlays,o=i.topOverlay,a=i.bottomOverlay,s=i.inlineStartOverlay,l=i.topInlineStartCornerOverlay,u=i.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(o),a.clone&&this.scrollbars.push(a),this.scrollbars.push(s),l&&this.scrollbars.push(l),u&&u.clone&&this.scrollbars.push(u),this.clones=[],o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),s.needFullRender&&this.clones.push(s.clone.wtTable.holder.parentNode),l&&this.clones.push(l.clone.wtTable.holder.parentNode),u&&u.clone&&this.clones.push(u.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,Q(this.clones,function(i){Re(i,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var i=this;this.freezeOverlays=!1,Q(this.clones,function(o){ut(o,"hide-tween"),Re(o,"show-tween")}),this.hot._registerTimeout(function(){Q(i.clones,function(o){ut(o,"show-tween")})},400),Q(this.scrollbars,function(o){o.refresh(),o.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return Zrt}},{key:"PLUGIN_PRIORITY",get:function(){return Jrt}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(jt);function dp(t){return dp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dp(t)}function tnt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rV(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nnt(n.key),n)}}function rnt(t,e,r){return e&&rV(t.prototype,e),r&&rV(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function nnt(t){var e=int(t,"string");return dp(e)==="symbol"?e:String(e)}function int(t,e){if(dp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(dp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xu(){return typeof Reflect<"u"&&Reflect.get?xu=Reflect.get.bind():xu=function(e,r,n){var i=ont(e,r);if(!!i){var o=Object.getOwnPropertyDescriptor(i,r);return o.get?o.get.call(arguments.length<3?e:n):o.value}},xu.apply(this,arguments)}function ont(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=fs(t),t!==null););return t}function ant(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gA(t,e)}function gA(t,e){return gA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gA(t,e)}function snt(t){var e=cnt();return function(){var n=fs(t),i;if(e){var o=fs(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return lnt(this,i)}}function lnt(t,e){if(e&&(dp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return unt(t)}function unt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cnt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fs(t){return fs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fs(t)}var sb="trimRows",fnt=330,hnt=function(t){ant(r,t);var e=snt(r);function r(n){var i;return tnt(this,r),i=e.call(this,n),i.trimmedRowsMap=null,i}return rnt(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[sb]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new L1),this.trimmedRowsMap.addLocalHook("init",function(){return i.onMapInit()}),xu(fs(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var i=this,o=this.hot.getSettings()[sb];Array.isArray(o)&&this.hot.batchExecution(function(){i.trimmedRowsMap.clear(),Q(o,function(a){i.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),xu(fs(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),xu(fs(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(i){var o=this,a=this.getTrimmedRows(),s=this.isValidConfig(i),l=a;s&&(l=Array.from(new Set(a.concat(i))));var u=this.hot.runHooks("beforeTrimRow",a,l,s);u!==!1&&(s&&this.hot.batchExecution(function(){Q(i,function(c){o.trimmedRowsMap.setValueAtIndex(c,!0)})},!0),this.hot.runHooks("afterTrimRow",a,l,s,s&&l.length>a.length))}},{key:"trimRow",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.trimRows(o)}},{key:"untrimRows",value:function(i){var o=this.getTrimmedRows(),a=this.isValidConfig(i),s=o,l=this.trimmedRowsMap.getValues().slice(),u=i.length>0;a&&u&&(Q(i,function(f){l[f]=!1}),s=Hn(l,function(f,h,d){return h&&f.push(d),f},[]));var c=this.hot.runHooks("beforeUntrimRow",o,s,a&&u);c!==!1&&(a&&u&&this.trimmedRowsMap.setValues(l),this.hot.runHooks("afterUntrimRow",o,s,a&&u,a&&s.length<o.length))}},{key:"untrimRow",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.untrimRows(o)}},{key:"isTrimmed",value:function(i){return this.trimmedRowsMap.getValueAtIndex(i)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(i){var o=this.hot.countSourceRows();return i.every(function(a){return Number.isInteger(a)&&a>=0&&a<o})}},{key:"onMapInit",value:function(){var i=this,o=this.hot.getSettings()[sb];Array.isArray(o)&&this.hot.batchExecution(function(){Q(o,function(a){i.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){xu(fs(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return sb}},{key:"PLUGIN_PRIORITY",get:function(){return fnt}}]),r}(jt);function pp(t){return pp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pp(t)}function KZ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nV(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dnt(n.key),n)}}function qZ(t,e,r){return e&&nV(t.prototype,e),r&&nV(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dnt(t){var e=pnt(t,"string");return pp(e)==="symbol"?e:String(e)}function pnt(t,e){if(pp(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(pp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XZ(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yA(t,e)}function yA(t,e){return yA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},yA(t,e)}function QZ(t){var e=ynt();return function(){var n=Zw(t),i;if(e){var o=Zw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return mnt(this,i)}}function mnt(t,e){if(e&&(pp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gnt(t)}function gnt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ynt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zw(t){return Zw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zw(t)}function vnt(t){return Snt(t)||wnt(t)||JZ(t)||bnt()}function bnt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wnt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Snt(t){if(Array.isArray(t))return vA(t)}function ZZ(t,e){return Cnt(t)||Ent(t,e)||JZ(t,e)||Rnt()}function Rnt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JZ(t,e){if(!!t){if(typeof t=="string")return vA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vA(t,e)}}function vA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ent(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,a,s=[],l=!0,u=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}function Cnt(t){if(Array.isArray(t))return t}var eJ="undoRedo",_nt="undoRedo";function De(t){var e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(r,n){var i=this,o=r&&r.length;if(!!o){var a=r.find(function(l){var u=ZZ(l,4),c=u[2],f=u[3];return c!==f});if(!!a){var s=function(){var u=r.reduce(function(f,h){return f.push(vnt(h)),f},[]);Q(u,function(f){f[1]=t.propToCol(f[1])});var c=o>1?i.getSelected():[[u[0][0],u[0][1]]];return new De.ChangeAction(u,c)};e.done(s,n)}}}),t.addHook("afterCreateRow",function(r,n,i){e.done(function(){return new De.CreateRowAction(r,n)},i)}),t.addHook("beforeRemoveRow",function(r,n,i,o){var a=function(){var l=t.toPhysicalRow(r),u=Zn(e.instance.getSourceData(l,0,l+n-1,e.instance.countSourceCols()-1));return new De.RemoveRowAction(l,u,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(a,o)}),t.addHook("afterCreateCol",function(r,n,i){e.done(function(){return new De.CreateColumnAction(r,n)},i)}),t.addHook("beforeRemoveCol",function(r,n,i,o){var a=function(){var l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+r)%e.instance.countCols(),c=[],f=[],h=[];Ye(l.length-1,function(m){var g=[],v=l[m];Ye(u,u+(n-1),function(S){g.push(v[t.toPhysicalColumn(S)])}),c.push(g)}),Ye(n-1,function(m){h.push(t.toPhysicalColumn(u+m))}),Array.isArray(t.getSettings().colHeaders)&&Ye(n-1,function(m){f.push(t.getSettings().colHeaders[t.toPhysicalColumn(u+m)]||null)});var d=t.columnIndexMapper.getIndexesSequence(),p=t.rowIndexMapper.getIndexesSequence();return new De.RemoveColumnAction(u,h,c,f,d,p,t.getSettings().fixedColumnsStart)};e.done(a,o)}),t.addHook("beforeCellAlignment",function(r,n,i,o){e.done(function(){return new De.CellAlignmentAction(r,n,i,o)})}),t.addHook("beforeFilter",function(r){e.done(function(){return new De.FiltersAction(r)})}),t.addHook("beforeRowMove",function(r,n){r!==!1&&e.done(function(){return new De.RowMoveAction(r,n)})}),t.addHook("beforeMergeCells",function(r,n){n||e.done(function(){return new De.MergeCellsAction(t,r)})}),t.addHook("afterUnmergeCells",function(r,n){n||e.done(function(){return new De.UnmergeCellsAction(t,r)})}),t.addHook("afterInit",function(){e.init()})}De.prototype.done=function(t,e){if(!this.ignoreNewActions){var r=e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto";if(!r){var n=this.doneActions.slice(),i=this.instance.runHooks("beforeUndoStackChange",n,e);if(i!==!1){var o=t(),a=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};De.prototype.undo=function(){if(this.isUndoAvailable()){var t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);var e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());var r=Zn(e),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,function(){i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};De.prototype.redo=function(){if(this.isRedoAvailable()){var t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);var e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());var r=Zn(e),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,function(){i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};De.prototype.isUndoAvailable=function(){return this.doneActions.length>0};De.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};De.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};De.prototype.isEnabled=function(){return this.enabled};De.prototype.enable=function(){if(!this.isEnabled()){var t=this.instance;this.enabled=!0,Ant(t),this.registerShortcuts(),t.addHook("afterChange",tJ)}};De.prototype.disable=function(){if(!!this.isEnabled()){var t=this.instance;this.enabled=!1,xnt(t),this.unregisterShortcuts(),t.removeHook("afterChange",tJ)}};De.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};De.Action=function(){};De.Action.prototype.undo=function(){};De.Action.prototype.redo=function(){};De.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Rl(De.ChangeAction,De.Action);De.ChangeAction.prototype.undo=function(t,e){for(var r=Zn(this.changes),n=t.countEmptyRows(!0),i=t.countEmptyCols(!0),o=0,a=r.length;o<a;o++)r[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.undo");for(var s=0,l=r.length;s<l;s++){var u=ZZ(r[s],2),c=u[0],f=u[1];t.getSettings().minSpareRows&&c+1+t.getSettings().minSpareRows===t.countRows()&&n===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(c+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&f+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(f+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};De.ChangeAction.prototype.redo=function(t,e){for(var r=Zn(this.changes),n=0,i=r.length;n<i;n++)r[n].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};De.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Rl(De.CreateRowAction,De.Action);De.CreateRowAction.prototype.undo=function(t,e){var r=t.countRows(),n=t.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};De.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};De.RemoveRowAction=function(t,e,r,n,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=i};Rl(De.RemoveRowAction,De.Action);De.RemoveRowAction.prototype.undo=function(t,e){var r=this,n=t.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(o,a){Object.keys(o).forEach(function(s){var l=parseInt(s,10);i.push([r.index+a,isNaN(l)?s:l,o[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};De.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};De.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Rl(De.CreateColumnAction,De.Action);De.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};De.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};De.RemoveColumnAction=function(t,e,r,n,i,o,a){this.index=t,this.indexes=e,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};Rl(De.RemoveColumnAction,De.Action);De.RemoveColumnAction.prototype.undo=function(t,e){var r=this,n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var i=this.indexes.slice(0).sort(),o=function(h,d,p){return p[r.indexes.indexOf(i[d])]},a=this.data.length,s=[],l=0;l<a;l++)s.push(bt(this.data[l],o));var u=bt(this.headers,o),c=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Q(t.getSourceDataArray(),function(f,h){Q(i,function(d,p){f[d]=s[h][p],c.push([h,d,f[d]])})}),t.setSourceDataAtCell(c,void 0,void 0,"UndoRedo.undo"),t.columnIndexMapper.insertIndexes(i[0],i.length),typeof this.headers<"u"&&Q(u,function(f,h){t.getSettings().colHeaders[i[h]]=f}),t.batchExecution(function(){t.rowIndexMapper.setIndexesSequence(r.rowPositions),t.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};De.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};De.CellAlignmentAction=function(t,e,r,n){this.stateBefore=t,this.range=e,this.type=r,this.alignment=n};De.CellAlignmentAction.prototype.undo=function(t,e){var r=this;Q(this.range,function(n){n.forAll(function(i,o){i>=0&&o>=0&&t.setCellMeta(i,o,"className",r.stateBefore[i][o]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};De.CellAlignmentAction.prototype.redo=function(t,e){Hs(this.range,this.type,this.alignment,function(r,n){return t.getCellMeta(r,n)},function(r,n,i,o){return t.setCellMeta(r,n,i,o)}),t.addHookOnce("afterViewRender",e),t.render()};De.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};Rl(De.FiltersAction,De.Action);De.FiltersAction.prototype.undo=function(t,e){var r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};De.FiltersAction.prototype.redo=function(t,e){var r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var Tnt=function(t){XZ(r,t);var e=QZ(r);function r(n,i){var o;KZ(this,r),o=e.call(this),o.cellRange=i;var a=o.cellRange.getTopStartCorner(),s=o.cellRange.getBottomEndCorner();return o.rangeData=n.getData(a.row,a.col,s.row,s.col),o}return qZ(r,[{key:"undo",value:function(i,o){var a=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),a.unmergeRange(this.cellRange,!0);var s=this.cellRange.getTopStartCorner();i.populateFromArray(s.row,s.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(i,o){var a=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),a.mergeRange(this.cellRange)}}]),r}(De.Action);De.MergeCellsAction=Tnt;var Ont=function(t){XZ(r,t);var e=QZ(r);function r(n,i){var o;return KZ(this,r),o=e.call(this),o.cellRange=i,o}return qZ(r,[{key:"undo",value:function(i,o){var a=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(i,o){var a=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),a.unmergeRange(this.cellRange,!0),i.render()}}]),r}(De.Action);De.UnmergeCellsAction=Ont;De.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};Rl(De.RowMoveAction,De.Action);De.RowMoveAction.prototype.undo=function(t,e){var r=this,n=t.getPlugin("manualRowMove"),i=[].concat(this.rows),o=i.filter(function(c){return c>r.finalIndex}),a=i.filter(function(c){return c<=r.finalIndex}),s=o.sort(function(c,f){return f-c}).concat(a.sort(function(c,f){return c-f}));t.addHookOnce("afterViewRender",e);for(var l=0;l<s.length;l+=1){var u=t.toVisualRow(s[l]);n.moveRow(u,s[l])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};De.RowMoveAction.prototype.redo=function(t,e){var r=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),r.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};De.prototype.init=function(){var t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};De.prototype.registerShortcuts=function(){var t=this,e=this.instance.getShortcutManager(),r=e.getContext("grid"),n=function(a){return!a.altKey},i={runOnlyIf:n,group:eJ};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){t.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){t.redo()}}],i)};De.prototype.unregisterShortcuts=function(){var t=this.instance.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(eJ)};function tJ(t,e){var r=this;if(e==="loadData")return r.undoRedo.clear()}function Ant(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function xnt(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}var j1=Ue.getSingleton();j1.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});j1.register("beforeUndo");j1.register("afterUndo");j1.register("beforeRedo");j1.register("afterRedo");De.PLUGIN_KEY=_nt;De.SETTING_KEYS=!0;function Int(){Ht(aIe),Ht(MIe),Ht(qIe),Ht(VMe),Ht(sNe),Ht(MX),Ht(q9e),Ht(IPe),Ht(AQ),Ht(GBe),Ht(bUe),Ht(IUe),Ht(BQ),Ht(kVe),Ht(IYe),Ht(uKe),Ht(kKe),Ht(oqe),Ht(Aqe),Ht(gXe),Ht(OXe),Ht(mQe),Ht(TQe),Ht(CZe),Ht(zZe),Ht(iJe),Ht(ket),Ht(nrt),Ht(Srt),Ht(Urt),Ht(ent),Ht(hnt),Ht(De)}function Mnt(){G5e(),lEe(),OEe(),KEe(),Int()}Yo(fq);At.editors={BaseEditor:Bp};function At(t,e){var r=new rI(t,e||{},Zx);return r.init(),r}At.Core=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new rI(t,e,Zx)};At.DefaultSettings=yQ();At.hooks=Ue.getSingleton();At.CellCoords=ow;At.CellRange=d3;At.packageName="handsontable";At.buildDate="28/03/2023 12:24:11";At.version="12.3.3";At.languages={dictionaryKeys:wPe,getLanguageDictionary:sQ,getLanguagesDictionaries:yLe,registerLanguageDictionary:aQ,getTranslatedPhrase:lQ};function iV(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Nnt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?iV(Object(r),!0).forEach(function(n){Pnt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iV(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function xv(t){return xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xv(t)}function mp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oV(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nJ(n.key),n)}}function gp(t,e,r){return e&&oV(t.prototype,e),r&&oV(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Pnt(t,e,r){return e=nJ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Iv(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bA(t,e)}function Jw(t){return Jw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jw(t)}function bA(t,e){return bA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bA(t,e)}function knt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rJ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $nt(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rJ(t)}function Mv(t){var e=knt();return function(){var n=Jw(t),i;if(e){var o=Jw(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return $nt(this,i)}}function Lnt(t){return Dnt(t)||Fnt(t)||Hnt(t)||Bnt()}function Dnt(t){if(Array.isArray(t))return wA(t)}function Fnt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Hnt(t,e){if(!!t){if(typeof t=="string")return wA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wA(t,e)}}function wA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Bnt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Unt(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nJ(t){var e=Unt(t,"string");return typeof e=="symbol"?e:String(e)}var jC=null,Vnt="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",jnt="The Handsontable instance bound to this component was destroyed and cannot be used properly.",eS="global",Wnt="hot-wrapper-editor-container";function znt(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function SA(t,e){var r=de.Children.toArray(t),n=de.Children.count(t),i=null;return n!==0&&(n===1&&r[0].props[e]?i=r[0]:i=r.find(function(o){return o.props[e]!==void 0})),i||null}function iJ(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function oJ(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=arguments.length>1?arguments[1]:void 0;if(e===null)return null;var r=sJ(e.props,!1);return r.className="".concat(Wnt," ").concat(r.className),Nz.createPortal(de.createElement("div",Object.assign({},r),e),t.body)}function aJ(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:eS,n=SA(t,"hot-editor"),i=iJ(n);return n?de.cloneElement(n,{emitEditorInstance:function(a,s){e.get(i)||e.set(i,new Map);var l=e.get(i);l.set(s!=null?s:eS,a)},editorColumnScope:r,isEditor:!0}):null}function Gnt(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;r||(r=document),jC||(jC=r.createDocumentFragment());var n=r.createElement("DIV");jC.appendChild(n);var i=de.cloneElement(t,Nnt({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:Nz.createPortal(i,n,"".concat(e.row,"-").concat(e.col,"-").concat(Math.random())),portalContainer:n}}function sJ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}var lJ=function(){function t(){mp(this,t)}return gp(t,null,[{key:"getSettings",value:function(r){var n={};if(r.settings){var i=r.settings;for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])}for(var a in r)a!=="settings"&&a!=="children"&&r.hasOwnProperty(a)&&(n[a]=r[a]);return n}}]),t}(),Ynt=function(t){Iv(r,t);var e=Mv(r);function r(){return mp(this,r),e.apply(this,arguments)}return gp(r,[{key:"getSettingsProps",value:function(){var i=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(o){return!i.internalProps.includes(o)}).reduce(function(o,a){return o[a]=i.props[a],o},{})}},{key:"getLocalEditorElement",value:function(){return aJ(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var i=this.props._getChildElementByType(this.props.children,"hot-renderer"),o=this.getLocalEditorElement();this.columnSettings=lJ.getSettings(this.getSettingsProps()),i!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(i),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),o!==null&&(this.columnSettings.editor=this.props._getEditorClass(o,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var i=this.props._getOwnerDocument(),o=oJ(i,this.getLocalEditorElement());return de.createElement(de.Fragment,null,o)}}]),r}(de.Component),Knt=function(t){Iv(r,t);var e=Mv(r);function r(){var n;return mp(this,r),n=e.apply(this,arguments),n.state={portals:[]},n}return gp(r,[{key:"render",value:function(){return de.createElement(de.Fragment,null,this.state.portals)}}]),r}(de.Component),qnt="12.3.3";function pI(t,e){return e={exports:{}},t(e,e.exports),e.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sn=typeof Symbol=="function"&&Symbol.for,mI=Sn?Symbol.for("react.element"):60103,gI=Sn?Symbol.for("react.portal"):60106,K6=Sn?Symbol.for("react.fragment"):60107,q6=Sn?Symbol.for("react.strict_mode"):60108,X6=Sn?Symbol.for("react.profiler"):60114,Q6=Sn?Symbol.for("react.provider"):60109,Z6=Sn?Symbol.for("react.context"):60110,yI=Sn?Symbol.for("react.async_mode"):60111,J6=Sn?Symbol.for("react.concurrent_mode"):60111,eR=Sn?Symbol.for("react.forward_ref"):60112,tR=Sn?Symbol.for("react.suspense"):60113,Xnt=Sn?Symbol.for("react.suspense_list"):60120,rR=Sn?Symbol.for("react.memo"):60115,nR=Sn?Symbol.for("react.lazy"):60116,Qnt=Sn?Symbol.for("react.block"):60121,Znt=Sn?Symbol.for("react.fundamental"):60117,Jnt=Sn?Symbol.for("react.responder"):60118,eit=Sn?Symbol.for("react.scope"):60119;function Di(t){if(xv(t)==="object"&&t!==null){var e=t.$$typeof;switch(e){case mI:switch(t=t.type,t){case yI:case J6:case K6:case X6:case q6:case tR:return t;default:switch(t=t&&t.$$typeof,t){case Z6:case eR:case nR:case rR:case Q6:return t;default:return e}}case gI:return e}}}function uJ(t){return Di(t)===J6}var tit=yI,rit=J6,nit=Z6,iit=Q6,oit=mI,ait=eR,sit=K6,lit=nR,uit=rR,cit=gI,fit=X6,hit=q6,dit=tR,pit=function(e){return uJ(e)||Di(e)===yI},mit=uJ,git=function(e){return Di(e)===Z6},yit=function(e){return Di(e)===Q6},vit=function(e){return xv(e)==="object"&&e!==null&&e.$$typeof===mI},bit=function(e){return Di(e)===eR},wit=function(e){return Di(e)===K6},Sit=function(e){return Di(e)===nR},Rit=function(e){return Di(e)===rR},Eit=function(e){return Di(e)===gI},Cit=function(e){return Di(e)===X6},_it=function(e){return Di(e)===q6},Tit=function(e){return Di(e)===tR},Oit=function(e){return typeof e=="string"||typeof e=="function"||e===K6||e===J6||e===X6||e===q6||e===tR||e===Xnt||xv(e)==="object"&&e!==null&&(e.$$typeof===nR||e.$$typeof===rR||e.$$typeof===Q6||e.$$typeof===Z6||e.$$typeof===eR||e.$$typeof===Znt||e.$$typeof===Jnt||e.$$typeof===eit||e.$$typeof===Qnt)},Ait=Di,xit={AsyncMode:tit,ConcurrentMode:rit,ContextConsumer:nit,ContextProvider:iit,Element:oit,ForwardRef:ait,Fragment:sit,Lazy:lit,Memo:uit,Portal:cit,Profiler:fit,StrictMode:hit,Suspense:dit,isAsyncMode:pit,isConcurrentMode:mit,isContextConsumer:git,isContextProvider:yit,isElement:vit,isForwardRef:bit,isFragment:wit,isLazy:Sit,isMemo:Rit,isPortal:Eit,isProfiler:Cit,isStrictMode:_it,isSuspense:Tit,isValidElementType:Oit,typeOf:Ait},er=pI(function(t,e){});er.AsyncMode;er.ConcurrentMode;er.ContextConsumer;er.ContextProvider;er.Element;er.ForwardRef;er.Fragment;er.Lazy;er.Memo;er.Portal;er.Profiler;er.StrictMode;er.Suspense;er.isAsyncMode;er.isConcurrentMode;er.isContextConsumer;er.isContextProvider;er.isElement;er.isForwardRef;er.isFragment;er.isLazy;er.isMemo;er.isPortal;er.isProfiler;er.isStrictMode;er.isSuspense;er.isValidElementType;er.typeOf;pI(function(t){t.exports=xit});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var aV=Object.getOwnPropertySymbols,Iit=Object.prototype.hasOwnProperty,Mit=Object.prototype.propertyIsEnumerable;function Nit(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function Pit(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(e).map(function(o){return e[o]});if(n.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(o){i[o]=o}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}Pit();var kit="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",$it=kit;Function.call.bind(Object.prototype.hasOwnProperty);function cJ(){}function fJ(){}fJ.resetWarningCache=cJ;var Lit=function(){function e(i,o,a,s,l,u){if(u!==$it){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function r(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:r,element:e,elementType:e,instanceOf:r,node:e,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:fJ,resetWarningCache:cJ};return n.PropTypes=n,n},Dit=pI(function(t){t.exports=Lit()}),WC=Dit,hJ=function(t){Iv(r,t);var e=Mv(r);function r(){var n;return mp(this,r),n=e.apply(this,arguments),n.id=null,n.__hotInstance=null,n.hotElementRef=null,n.columnSettings=[],n.renderersPortalManager=null,n.portalCacheArray=[],n.renderedCellCache=new Map,n.editorCache=new Map,n.componentRendererColumns=new Map,n}return gp(r,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(jnt),null)},set:function(i){this.__hotInstance=i}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(i){this.hotElementRef=i}},{key:"getRendererWrapper",value:function(i){var o=this;return function(a,s,l,u,c,f,h){var d=o.getRenderedCellCache();if(d.has("".concat(l,"-").concat(u))&&(s.innerHTML=d.get("".concat(l,"-").concat(u)).innerHTML),s&&!s.getAttribute("ghost-table")){for(var p=Gnt(i,{TD:s,row:l,col:u,prop:c,value:f,cellProperties:h,isRenderer:!0},s.ownerDocument),m=p.portal,g=p.portalContainer;s.firstChild;)s.removeChild(s.firstChild);s.appendChild(g),o.portalCacheArray.push(m)}return d.set("".concat(l,"-").concat(u),s),s}}},{key:"getEditorClass",value:function(i){var o,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:eS,s=iJ(i),l=(o=this.getEditorCache().get(s))===null||o===void 0?void 0:o.get(a);return this.makeEditorClass(l)}},{key:"makeEditorClass",value:function(i){var o=function(a){Iv(l,a);var s=Mv(l);function l(u){var c;return mp(this,l),c=s.call(this,u),i.hotCustomEditorInstance=rJ(c),c.editorComponent=i,c}return gp(l,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),l}(At.editors.BaseEditor);return Object.getOwnPropertyNames(At.editors.BaseEditor.prototype).forEach(function(a){a!=="constructor"&&(o.prototype[a]=function(){for(var s,l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];return(s=i[a]).call.apply(s,[i].concat(u))})}),o}},{key:"getGlobalRendererElement",value:function(){return SA(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return aJ(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var i=lJ.getSettings(this.props),o=this.getGlobalRendererElement(),a=this.getGlobalEditorElement();return i.columns=this.columnSettings.length?this.columnSettings:i.columns,a?i.editor=this.getEditorClass(a,eS):i.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),o?(i.renderer=this.getRendererWrapper(o),this.componentRendererColumns.set("global",!0)):i.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),i}},{key:"displayAutoSizeWarning",value:function(i){var o,a;this.hotInstance&&((o=this.hotInstance.getPlugin("autoRowSize"))!==null&&o!==void 0&&o.enabled||(a=this.hotInstance.getPlugin("autoColumnSize"))!==null&&a!==void 0&&a.enabled)&&this.componentRendererColumns.size>0&&znt(Vnt)}},{key:"setHotColumnSettings",value:function(i,o){this.columnSettings[o]=i}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var i=this;this.renderersPortalManager.setState({portals:Lnt(this.portalCacheArray)},function(){i.portalCacheArray=[]})}},{key:"updateHot",value:function(i){this.hotInstance&&this.hotInstance.updateSettings(i,!1)}},{key:"setRenderersPortalManagerRef",value:function(i){this.renderersPortalManager=i}},{key:"componentDidMount",value:function(){var i=this,o=this.createNewGlobalSettings();this.hotInstance=new At.Core(this.hotElementRef,o),this.hotInstance.addHook("beforeViewRender",function(){return i.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return i.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(o)}},{key:"componentDidUpdate",value:function(){this.clearCache();var i=this.createNewGlobalSettings();this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var i=this,o=sJ(this.props),a=function(f){return f.type===Ynt},s=de.Children.toArray(this.props.children),l=s.filter(function(c){return a(c)}).map(function(c,f){return de.cloneElement(c,{_componentRendererColumns:i.componentRendererColumns,_emitColumnSettings:i.setHotColumnSettings.bind(i),_columnIndex:f,_getChildElementByType:SA.bind(i),_getRendererWrapper:i.getRendererWrapper.bind(i),_getEditorClass:i.getEditorClass.bind(i),_getOwnerDocument:i.getOwnerDocument.bind(i),_getEditorCache:i.getEditorCache.bind(i),children:c.props.children})}),u=oJ(this.getOwnerDocument(),this.getGlobalEditorElement());return de.createElement(de.Fragment,null,de.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},o),l),de.createElement(Knt,{ref:this.setRenderersPortalManagerRef.bind(this)}),u)}}],[{key:"version",get:function(){return qnt}}]),r}(de.Component);hJ.propTypes={style:WC.object,id:WC.string,className:WC.string};de.Component;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var Mr;(function(t){t.RELATIVE="RELATIVE",t.ABSOLUTE="ABSOLUTE"})(Mr||(Mr={}));class Kn{constructor(e,r,n){this.type=e,this.col=r,this.sheet=n}static absolute(e,r){return new Kn(Mr.ABSOLUTE,e,r)}static relative(e,r){return new Kn(Mr.RELATIVE,e,r)}static compareByAbsoluteAddress(e){return(r,n)=>r.toSimpleColumnAddress(e).col-n.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===Mr.ABSOLUTE}isColumnRelative(){return this.type===Mr.RELATIVE}isAbsolute(){return this.type===Mr.ABSOLUTE&&this.sheet!==void 0}moved(e,r,n){const i=this.sheet===void 0?void 0:e;return new Kn(this.type,this.col+r,i)}shiftedByColumns(e){return new Kn(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const r=xo(this,e);let n=this.col;return this.isColumnRelative()&&(n=e.col+this.col),Bee(r,n)}shiftRelativeDimensions(e,r){const n=this.isColumnRelative()?this.col+e:this.col;return new Kn(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,r){const n=this.isColumnAbsolute()?this.col+e:this.col;return new Kn(this.type,n,this.sheet)}withSheet(e){return new Kn(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const r=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case Mr.RELATIVE:return`${r}#COLR${this.col}`;case Mr.ABSOLUTE:return`${r}#COLA${this.col}`}}unparse(e){const r=this.toSimpleColumnAddress(e);if(plt(r))return;const n=wI(r.col);return`${this.type===Mr.ABSOLUTE?"$":""}${n}`}exceedsSheetSizeLimits(e){return this.col>=e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ln{constructor(e,r,n){this.type=e,this.row=r,this.sheet=n}static absolute(e,r){return new Ln(Mr.ABSOLUTE,e,r)}static relative(e,r){return new Ln(Mr.RELATIVE,e,r)}static compareByAbsoluteAddress(e){return(r,n)=>r.toSimpleRowAddress(e).row-n.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===Mr.ABSOLUTE}isRowRelative(){return this.type===Mr.RELATIVE}isAbsolute(){return this.type===Mr.ABSOLUTE&&this.sheet!==void 0}moved(e,r,n){const i=this.sheet===void 0?void 0:e;return new Ln(this.type,this.row+n,i)}shiftedByRows(e){return new Ln(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const r=xo(this,e);let n=this.row;return this.isRowRelative()&&(n=e.row+this.row),Hee(r,n)}shiftRelativeDimensions(e,r){const n=this.isRowRelative()?this.row+r:this.row;return new Ln(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,r){const n=this.isRowAbsolute()?this.row+r:this.row;return new Ln(this.type,n,this.sheet)}withSheet(e){return new Ln(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const r=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case Mr.RELATIVE:return`${r}#ROWR${this.row}`;case Mr.ABSOLUTE:return`${r}#ROWA${this.row}`}}unparse(e){const r=this.toSimpleRowAddress(e);return dlt(r)?void 0:`${this.type===Mr.ABSOLUTE?"$":""}${r.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var zt;(function(t){t.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",t.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",t.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",t.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"})(zt||(zt={}));class Kt{constructor(e,r,n,i){this.col=e,this.row=r,this.type=n,this.sheet=i}static fromColAndRow(e,r,n){return(e.isColumnAbsolute()&&r.isRowAbsolute()?Kt.absolute.bind(this):e.isColumnAbsolute()?Kt.absoluteCol.bind(this):r.isRowAbsolute()?Kt.absoluteRow.bind(this):Kt.relative.bind(this))(e.col,r.row,n)}static relative(e,r,n){return new Kt(e,r,zt.CELL_REFERENCE_RELATIVE,n)}static absolute(e,r,n){return new Kt(e,r,zt.CELL_REFERENCE_ABSOLUTE,n)}static absoluteCol(e,r,n){return new Kt(e,r,zt.CELL_REFERENCE_ABSOLUTE_COL,n)}static absoluteRow(e,r,n){return new Kt(e,r,zt.CELL_REFERENCE_ABSOLUTE_ROW,n)}toSimpleCellAddress(e){const r=xo(this,e);return this.type===zt.CELL_REFERENCE_ABSOLUTE?Le(r,this.col,this.row):this.type===zt.CELL_REFERENCE_ABSOLUTE_ROW?Le(r,e.col+this.col,this.row):this.type===zt.CELL_REFERENCE_ABSOLUTE_COL?Le(r,this.col,e.row+this.row):Le(r,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?Mr.RELATIVE:Mr.ABSOLUTE;return new Kn(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?Mr.RELATIVE:Mr.ABSOLUTE;return new Ln(e,this.row,this.sheet)}toSimpleColumnAddress(e){const r=xo(this,e);let n=this.col;return this.isColumnRelative()&&(n+=e.col),Bee(r,n)}toSimpleRowAddress(e){const r=xo(this,e);let n=this.row;return this.isRowRelative()&&(n+=e.row),Hee(r,n)}isRowAbsolute(){return this.type===zt.CELL_REFERENCE_ABSOLUTE||this.type===zt.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===zt.CELL_REFERENCE_ABSOLUTE||this.type===zt.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===zt.CELL_REFERENCE_RELATIVE||this.type===zt.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===zt.CELL_REFERENCE_RELATIVE||this.type===zt.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===zt.CELL_REFERENCE_ABSOLUTE&&this.sheet!==void 0}shiftedByRows(e){return new Kt(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new Kt(this.col+e,this.row,this.type,this.sheet)}moved(e,r,n){const i=this.sheet===void 0?void 0:e;return new Kt(this.col+r,this.row+n,this.type,i)}withSheet(e){return new Kt(this.col,this.row,this.type,e)}isInvalid(e){return hi(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,r){const n=this.isColumnAbsolute()?this.col:this.col+e,i=this.isRowAbsolute()?this.row:this.row+r;return new Kt(n,i,this.type,this.sheet)}shiftAbsoluteDimensions(e,r){const n=this.isColumnRelative()?this.col:this.col+e,i=this.isRowRelative()?this.row:this.row+r;return new Kt(n,i,this.type,this.sheet)}hash(e){const r=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case zt.CELL_REFERENCE_RELATIVE:return`${r}#${this.row}R${this.col}`;case zt.CELL_REFERENCE_ABSOLUTE:return`${r}#${this.row}A${this.col}`;case zt.CELL_REFERENCE_ABSOLUTE_COL:return`${r}#${this.row}AC${this.col}`;case zt.CELL_REFERENCE_ABSOLUTE_ROW:return`${r}#${this.row}AR${this.col}`}}unparse(e){const r=this.toSimpleCellAddress(e);if(hi(r))return;const n=wI(r.col),i=this.type===zt.CELL_REFERENCE_ABSOLUTE||this.type===zt.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===zt.CELL_REFERENCE_ABSOLUTE||this.type===zt.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${n}${i}${r.row+1}`}exceedsSheetSizeLimits(e,r){return this.row>=r||this.col>=e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const W1=":",qn="$",Fit="\\s+",Hit="[ \\t\\n\\r]+",iR="A-Za-z\xC0-\u02AF",vI=`${iR}0-9_.`,dJ=`[${iR}0-9_]+`,Bit="'(((?!').|'')*)'",zp=`(${dJ}|${Bit})!`,pJ=`(${zp})?\\${qn}?[A-Za-z]+\\${qn}?[0-9]+`,sV=`(${zp})?\\${qn}?[A-Za-z]+`,lV=`(${zp})?\\${qn}?[0-9]+`,mJ="[rR][0-9]*[cC][0-9]*",Uit=`(${pJ})[^${vI}]`,gJ=`[${iR}_][${vI}]*`,Vit=["0","1","2","3","4","5","6","7","8","9"],yJ=[...Array.from(Array(26)).map((t,e)=>e+"A".charCodeAt(0)),...Array.from(Array(26)).map((t,e)=>e+"a".charCodeAt(0)),...Array.from(Array(687-192+1)).map((t,e)=>e+192)].map(t=>String.fromCharCode(t));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const vJ=new RegExp(`^(${zp})?(\\${qn}?)([A-Za-z]+)(\\${qn}?)([0-9]+)$`),jit=new RegExp(`^(${zp})?(\\${qn}?)([A-Za-z]+)$`),Wit=new RegExp(`^(${zp})?(\\${qn}?)([0-9]+)$`),zit=new RegExp(`^${dJ}$`),_f=(t,e,r)=>{const n=vJ.exec(e),i=bI(n[6]);let o=oR(n,t);if(o===void 0)return;o===null&&(o=void 0);const a=Number(n[8])-1;return n[5]===qn&&n[7]===qn?Kt.absolute(i,a,o):n[5]===qn?Kt.absoluteCol(i,a-r.row,o):n[7]===qn?Kt.absoluteRow(i-r.col,a,o):Kt.relative(i-r.col,a-r.row,o)},tS=(t,e,r)=>{const n=jit.exec(e);let i=oR(n,t);if(i===void 0)return;i===null&&(i=void 0);const o=bI(n[6]);return n[5]===qn?Kn.absolute(o,i):Kn.relative(o-r.col,i)},rS=(t,e,r)=>{const n=Wit.exec(e);let i=oR(n,t);if(i===void 0)return;i===null&&(i=void 0);const o=Number(n[6])-1;return n[5]===qn?Ln.absolute(o,i):Ln.relative(o-r.row,i)},RA=(t,e,r)=>{const n=vJ.exec(e),i=bI(n[6]);let o=oR(n,t);if(o===void 0)return;o===null&&(o=r);const a=Number(n[8])-1;return Le(o,i,a)},Git=(t,e,r)=>{const n=e.split(W1);if(n.length!==2)return;const[i,o]=n,a=RA(t,i,r);if(a===void 0)return;const s=RA(t,o,a.sheet);if(s!==void 0&&a.sheet===s.sheet)return FA(a,s)},nS=(t,e,r)=>{const n=wI(e.col),i=bJ(e.sheet,t);if(i!==void 0)return r!==e.sheet?`${i}!${n}${e.row+1}`:`${n}${e.row+1}`},Yit=(t,e,r)=>{const n=nS(t,e.start,r),i=nS(t,e.end,e.start.sheet);if(!(n===void 0||i===void 0))return`${n}${W1}${i}`};function bI(t){return t.length===1?t.toUpperCase().charCodeAt(0)-65:t.split("").reduce((e,r)=>e*26+(r.toUpperCase().charCodeAt(0)-64),0)-1}function wI(t){let e="";for(;t>=0;)e=String.fromCharCode(t%26+97)+e,t=Math.floor(t/26)-1;return e.toUpperCase()}function bJ(t,e){let r=e(t);if(r!==void 0)return zit.test(r)?r:(r=r.replace(/'/g,"''"),`'${r}'`)}function oR(t,e){var r;let n=(r=t[3])!==null&&r!==void 0?r:t[2];return n?(n=n.replace(/''/g,"'"),e(n)):null}function Zt(t){return t&&t.length===0}function As(t){return t==null?[]:Object.keys(t)}function Fn(t){for(var e=[],r=Object.keys(t),n=0;n<r.length;n++)e.push(t[r[n]]);return e}function Kit(t,e){for(var r=[],n=As(t),i=0;i<n.length;i++){var o=n[i];r.push(e.call(null,t[o],o))}return r}function Fe(t,e){for(var r=[],n=0;n<t.length;n++)r.push(e.call(null,t[n],n));return r}function gi(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];Array.isArray(n)?e=e.concat(gi(n)):e.push(n)}return e}function ro(t){return Zt(t)?void 0:t[0]}function wJ(t){var e=t&&t.length;return e?t[e-1]:void 0}function Je(t,e){if(Array.isArray(t))for(var r=0;r<t.length;r++)e.call(null,t[r],r);else if(RI(t))for(var n=As(t),r=0;r<n.length;r++){var i=n[r],o=t[i];e.call(null,o,i)}else throw Error("non exhaustive match")}function ca(t){return typeof t=="string"}function no(t){return t===void 0}function _l(t){return t instanceof Function}function On(t,e){return e===void 0&&(e=1),t.slice(e,t.length)}function Nv(t,e){return e===void 0&&(e=1),t.slice(0,t.length-e)}function Po(t,e){var r=[];if(Array.isArray(t))for(var n=0;n<t.length;n++){var i=t[n];e.call(null,i)&&r.push(i)}return r}function ic(t,e){return Po(t,function(r){return!e(r)})}function uo(t,e){for(var r=Object.keys(t),n={},i=0;i<r.length;i++){var o=r[i],a=t[o];e(a)&&(n[o]=a)}return n}function Ze(t,e){return RI(t)?t.hasOwnProperty(e):!1}function ln(t,e){return yp(t,function(r){return r===e})!==void 0}function yi(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r]);return e}function z1(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}function yp(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(e.call(null,n))return n}}function qit(t,e){for(var r=[],n=0;n<t.length;n++){var i=t[n];e.call(null,i)&&r.push(i)}return r}function Nn(t,e,r){for(var n=Array.isArray(t),i=n?t:Fn(t),o=n?[]:As(t),a=r,s=0;s<i.length;s++)a=e.call(null,a,i[s],n?s:o[s]);return a}function G1(t){return ic(t,function(e){return e==null})}function SI(t,e){e===void 0&&(e=function(n){return n});var r=[];return Nn(t,function(n,i){var o=e(i);return ln(r,o)?n:(r.push(o),n.concat(i))},[])}function Oo(t){return Array.isArray(t)}function Es(t){return t instanceof RegExp}function RI(t){return t instanceof Object}function Ji(t,e){for(var r=0;r<t.length;r++)if(!e(t[r],r))return!1;return!0}function aR(t,e){return ic(t,function(r){return ln(e,r)})}function SJ(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return!0;return!1}function Xit(t,e){for(var r=0;r<t.length;r++)if(t[r]===e)return r;return-1}function ko(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n++)for(var i=e[n],o=As(i),a=0;a<o.length;a++){var s=o[a];t[s]=i[s]}return t}function Qit(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n++){var i=e[n];if(!no(i))for(var o=As(i),a=0;a<o.length;a++){var s=o[a];Ze(t,s)||(t[s]=i[s])}}return t}function sR(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Qit.apply(null,[{}].concat(t))}function RJ(t,e){var r={};return Je(t,function(n){var i=e(n),o=r[i];o?o.push(n):r[i]=[n]}),r}function uV(t,e){for(var r=z1(t),n=As(e),i=0;i<n.length;i++){var o=n[i],a=e[o];r[o]=a}return r}function cn(){}function cV(t){return t}function Zit(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];e.push(n!==void 0?n:void 0)}return e}function EA(t){console&&console.error&&console.error("Error: "+t)}function EI(t){console&&console.warn&&console.warn("Warning: "+t)}function fV(){return typeof Map=="function"}function Jit(t,e){e.forEach(function(r){var n=r.prototype;Object.getOwnPropertyNames(n).forEach(function(i){if(i!=="constructor"){var o=Object.getOwnPropertyDescriptor(n,i);o&&(o.get||o.set)?Object.defineProperty(t.prototype,i,o):t.prototype[i]=r.prototype[i]}})})}function EJ(t){function e(){}e.prototype=t;var r=new e;function n(){return typeof r.bar}return n(),n(),t}function iS(t){return t[t.length-1]}function CJ(t){var e=new Date().getTime(),r=t(),n=new Date().getTime(),i=n-e;return{time:i,value:r}}var Gp={exports:{}};(function(t){(function(e,r){t.exports?t.exports=r():e.regexpToAst=r()})(typeof self<"u"?self:ch,function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(m){this.idx=m.idx,this.input=m.input,this.groupIdx=m.groupIdx},e.prototype.pattern=function(m){this.idx=0,this.input=m,this.groupIdx=0,this.consumeChar("/");var g=this.disjunction();this.consumeChar("/");for(var v={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":s(v,"global");break;case"i":s(v,"ignoreCase");break;case"m":s(v,"multiLine");break;case"u":s(v,"unicode");break;case"y":s(v,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:v,value:g}},e.prototype.disjunction=function(){var m=[];for(m.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),m.push(this.alternative());return{type:"Disjunction",value:m}},e.prototype.alternative=function(){for(var m=[];this.isTerm();)m.push(this.term());return{type:"Alternative",value:m}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var m;switch(this.popChar()){case"=":m="Lookahead";break;case"!":m="NegativeLookahead";break}l(m);var g=this.disjunction();return this.consumeChar(")"),{type:m,value:g}}u()},e.prototype.quantifier=function(m){var g;switch(this.popChar()){case"*":g={atLeast:0,atMost:1/0};break;case"+":g={atLeast:1,atMost:1/0};break;case"?":g={atLeast:0,atMost:1};break;case"{":var v=this.integerIncludingZero();switch(this.popChar()){case"}":g={atLeast:v,atMost:v};break;case",":var S;this.isDigit()?(S=this.integerIncludingZero(),g={atLeast:v,atMost:S}):g={atLeast:v,atMost:1/0},this.consumeChar("}");break}if(m===!0&&g===void 0)return;l(g);break}if(!(m===!0&&g===void 0))return l(g),this.peekChar(0)==="?"?(this.consumeChar("?"),g.greedy=!1):g.greedy=!0,g.type="Quantifier",g},e.prototype.atom=function(){var m;switch(this.peekChar()){case".":m=this.dotAll();break;case"\\":m=this.atomEscape();break;case"[":m=this.characterClass();break;case"(":m=this.group();break}return m===void 0&&this.isPatternCharacter()&&(m=this.patternCharacter()),l(m),this.isQuantifier()&&(m.quantifier=this.quantifier()),m},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[o(`
`),o("\r"),o("\u2028"),o("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var m=this.positiveInteger();return{type:"GroupBackReference",value:m}},e.prototype.characterClassEscape=function(){var m,g=!1;switch(this.popChar()){case"d":m=f;break;case"D":m=f,g=!0;break;case"s":m=d;break;case"S":m=d,g=!0;break;case"w":m=h;break;case"W":m=h,g=!0;break}return l(m),{type:"Set",value:m,complement:g}},e.prototype.controlEscapeAtom=function(){var m;switch(this.popChar()){case"f":m=o("\f");break;case"n":m=o(`
`);break;case"r":m=o("\r");break;case"t":m=o("	");break;case"v":m=o("\v");break}return l(m),{type:"Character",value:m}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var m=this.popChar();if(/[a-zA-Z]/.test(m)===!1)throw Error("Invalid ");var g=m.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:g}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:o("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var m=this.popChar();return{type:"Character",value:o(m)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var m=this.popChar();return{type:"Character",value:o(m)}}},e.prototype.characterClass=function(){var m=[],g=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),g=!0);this.isClassAtom();){var v=this.classAtom(),S=v.type==="Character";if(S&&this.isRangeDash()){this.consumeChar("-");var b=this.classAtom(),E=b.type==="Character";if(E){if(b.value<v.value)throw Error("Range out of order in character class");m.push({from:v.value,to:b.value})}else a(v.value,m),m.push(o("-")),a(b.value,m)}else a(v.value,m)}return this.consumeChar("]"),{type:"Set",complement:g,value:m}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:o("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var m=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),m=!1;break;default:this.groupIdx++;break}var g=this.disjunction();this.consumeChar(")");var v={type:"Group",capturing:m,value:g};return m&&(v.idx=this.groupIdx),v},e.prototype.positiveInteger=function(){var m=this.popChar();if(i.test(m)===!1)throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)m+=this.popChar();return parseInt(m,10)},e.prototype.integerIncludingZero=function(){var m=this.popChar();if(n.test(m)===!1)throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)m+=this.popChar();return parseInt(m,10)},e.prototype.patternCharacter=function(){var m=this.popChar();switch(m){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:o(m)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},e.prototype.isDigit=function(){return n.test(this.peekChar(0))},e.prototype.isClassAtom=function(m){switch(m===void 0&&(m=0),this.peekChar(m)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},e.prototype.isQuantifier=function(){var m=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(m)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(m){for(var g="",v=0;v<m;v++){var S=this.popChar();if(r.test(S)===!1)throw Error("Expecting a HexDecimal digits");g+=S}var b=parseInt(g,16);return{type:"Character",value:b}},e.prototype.peekChar=function(m){return m===void 0&&(m=0),this.input[this.idx+m]},e.prototype.popChar=function(){var m=this.peekChar(0);return this.consumeChar(),m},e.prototype.consumeChar=function(m){if(m!==void 0&&this.input[this.idx]!==m)throw Error("Expected: '"+m+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var r=/[0-9a-fA-F]/,n=/[0-9]/,i=/[1-9]/;function o(m){return m.charCodeAt(0)}function a(m,g){m.length!==void 0?m.forEach(function(v){g.push(v)}):g.push(m)}function s(m,g){if(m[g]===!0)throw"duplicate flag "+g;m[g]=!0}function l(m){if(m===void 0)throw Error("Internal Error - Should never get here!")}function u(){throw Error("Internal Error - Should never get here!")}var c,f=[];for(c=o("0");c<=o("9");c++)f.push(c);var h=[o("_")].concat(f);for(c=o("a");c<=o("z");c++)h.push(c);for(c=o("A");c<=o("Z");c++)h.push(c);var d=[o(" "),o("\f"),o(`
`),o("\r"),o("	"),o("\v"),o("	"),o("\xA0"),o("\u1680"),o("\u2000"),o("\u2001"),o("\u2002"),o("\u2003"),o("\u2004"),o("\u2005"),o("\u2006"),o("\u2007"),o("\u2008"),o("\u2009"),o("\u200A"),o("\u2028"),o("\u2029"),o("\u202F"),o("\u205F"),o("\u3000"),o("\uFEFF")];function p(){}return p.prototype.visitChildren=function(m){for(var g in m){var v=m[g];m.hasOwnProperty(g)&&(v.type!==void 0?this.visit(v):Array.isArray(v)&&v.forEach(function(S){this.visit(S)},this))}},p.prototype.visit=function(m){switch(m.type){case"Pattern":this.visitPattern(m);break;case"Flags":this.visitFlags(m);break;case"Disjunction":this.visitDisjunction(m);break;case"Alternative":this.visitAlternative(m);break;case"StartAnchor":this.visitStartAnchor(m);break;case"EndAnchor":this.visitEndAnchor(m);break;case"WordBoundary":this.visitWordBoundary(m);break;case"NonWordBoundary":this.visitNonWordBoundary(m);break;case"Lookahead":this.visitLookahead(m);break;case"NegativeLookahead":this.visitNegativeLookahead(m);break;case"Character":this.visitCharacter(m);break;case"Set":this.visitSet(m);break;case"Group":this.visitGroup(m);break;case"GroupBackReference":this.visitGroupBackReference(m);break;case"Quantifier":this.visitQuantifier(m);break}this.visitChildren(m)},p.prototype.visitPattern=function(m){},p.prototype.visitFlags=function(m){},p.prototype.visitDisjunction=function(m){},p.prototype.visitAlternative=function(m){},p.prototype.visitStartAnchor=function(m){},p.prototype.visitEndAnchor=function(m){},p.prototype.visitWordBoundary=function(m){},p.prototype.visitNonWordBoundary=function(m){},p.prototype.visitLookahead=function(m){},p.prototype.visitNegativeLookahead=function(m){},p.prototype.visitCharacter=function(m){},p.prototype.visitSet=function(m){},p.prototype.visitGroup=function(m){},p.prototype.visitGroupBackReference=function(m){},p.prototype.visitQuantifier=function(m){},{RegExpParser:e,BaseRegExpVisitor:p,VERSION:"0.4.0"}})})(Gp);var E2={},eot=new Gp.exports.RegExpParser;function lR(t){var e=t.toString();if(E2.hasOwnProperty(e))return E2[e];var r=eot.pattern(e);return E2[e]=r,r}function tot(){E2={}}var rot=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),_J="Complement Sets are not supported for first char optimization",oS=`Unable to use "first char" lexer optimizations:
`;function not(t,e){e===void 0&&(e=!1);try{var r=lR(t),n=CA(r.value,{},r.flags.ignoreCase);return n}catch(o){if(o.message===_J)e&&EI(""+oS+("	Unable to optimize: < "+t.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var i="";e&&(i=`
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),EA(oS+`
`+("	Failed parsing: < "+t.toString()+` >
`)+("	Using the regexp-to-ast library version: "+Gp.exports.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+i)}}return[]}function CA(t,e,r){switch(t.type){case"Disjunction":for(var n=0;n<t.value.length;n++)CA(t.value[n],e,r);break;case"Alternative":for(var i=t.value,n=0;n<i.length;n++){var o=i[n];switch(o.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var a=o;switch(a.type){case"Character":lb(a.value,e,r);break;case"Set":if(a.complement===!0)throw Error(_J);Je(a.value,function(u){if(typeof u=="number")lb(u,e,r);else{var c=u;if(r===!0)for(var f=c.from;f<=c.to;f++)lb(f,e,r);else{for(var f=c.from;f<=c.to&&f<Wm;f++)lb(f,e,r);if(c.to>=Wm)for(var h=c.from>=Wm?c.from:Wm,d=c.to,p=gl(h),m=gl(d),g=p;g<=m;g++)e[g]=g}}});break;case"Group":CA(a.value,e,r);break;default:throw Error("Non Exhaustive Match")}var s=a.quantifier!==void 0&&a.quantifier.atLeast===0;if(a.type==="Group"&&_A(a)===!1||a.type!=="Group"&&s===!1)break}break;default:throw Error("non exhaustive match!")}return Fn(e)}function lb(t,e,r){var n=gl(t);e[n]=n,r===!0&&iot(t,e)}function iot(t,e){var r=String.fromCharCode(t),n=r.toUpperCase();if(n!==r){var i=gl(n.charCodeAt(0));e[i]=i}else{var o=r.toLowerCase();if(o!==r){var i=gl(o.charCodeAt(0));e[i]=i}}}function hV(t,e){return yp(t.value,function(r){if(typeof r=="number")return ln(e,r);var n=r;return yp(e,function(i){return n.from<=i&&i<=n.to})!==void 0})}function _A(t){return t.quantifier&&t.quantifier.atLeast===0?!0:t.value?Oo(t.value)?Ji(t.value,_A):_A(t.value):!1}var oot=function(t){rot(e,t);function e(r){var n=t.call(this)||this;return n.targetCharCodes=r,n.found=!1,n}return e.prototype.visitChildren=function(r){if(this.found!==!0){switch(r.type){case"Lookahead":this.visitLookahead(r);return;case"NegativeLookahead":this.visitNegativeLookahead(r);return}t.prototype.visitChildren.call(this,r)}},e.prototype.visitCharacter=function(r){ln(this.targetCharCodes,r.value)&&(this.found=!0)},e.prototype.visitSet=function(r){r.complement?hV(r,this.targetCharCodes)===void 0&&(this.found=!0):hV(r,this.targetCharCodes)!==void 0&&(this.found=!0)},e}(Gp.exports.BaseRegExpVisitor);function CI(t,e){if(e instanceof RegExp){var r=lR(e),n=new oot(t);return n.visit(r),n.found}else return yp(e,function(i){return ln(t,i.charCodeAt(0))})!==void 0}var TJ=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),fa="PATTERN",Iu="defaultMode",ub="modes",OJ=typeof new RegExp("(?:)").sticky=="boolean";function aot(t,e){e=sR(e,{useSticky:OJ,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(S,b){return b()}});var r=e.tracer;r("initCharCodeToOptimizedIndexMap",function(){xot()});var n;r("Reject Lexer.NA",function(){n=ic(t,function(S){return S[fa]===mi.NA})});var i=!1,o;r("Transform Patterns",function(){i=!1,o=Fe(n,function(S){var b=S[fa];if(Es(b)){var E=b.source;return E.length===1&&E!=="^"&&E!=="$"&&E!=="."?E:E.length===2&&E[0]==="\\"&&!ln(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],E[1])?E[1]:e.useSticky?pV(b):dV(b)}else{if(_l(b))return i=!0,{exec:b};if(Ze(b,"exec"))return i=!0,b;if(typeof b=="string"){if(b.length===1)return b;var T=b.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),N=new RegExp(T);return e.useSticky?pV(N):dV(N)}else throw Error("non exhaustive match")}})});var a,s,l,u,c;r("misc mapping",function(){a=Fe(n,function(S){return S.tokenTypeIdx}),s=Fe(n,function(S){var b=S.GROUP;if(b!==mi.SKIPPED){if(ca(b))return b;if(no(b))return!1;throw Error("non exhaustive match")}}),l=Fe(n,function(S){var b=S.LONGER_ALT;if(b){var E=Xit(n,b);return E}}),u=Fe(n,function(S){return S.PUSH_MODE}),c=Fe(n,function(S){return Ze(S,"POP_MODE")})});var f;r("Line Terminator Handling",function(){var S=IJ(e.lineTerminatorCharacters);f=Fe(n,function(b){return!1}),e.positionTracking!=="onlyOffset"&&(f=Fe(n,function(b){if(Ze(b,"LINE_BREAKS"))return b.LINE_BREAKS;if(xJ(b,S)===!1)return CI(S,b.PATTERN)}))});var h,d,p,m;r("Misc Mapping #2",function(){h=Fe(n,AJ),d=Fe(o,Tot),p=Nn(n,function(S,b){var E=b.GROUP;return ca(E)&&E!==mi.SKIPPED&&(S[E]=[]),S},{}),m=Fe(o,function(S,b){return{pattern:o[b],longerAlt:l[b],canLineTerminator:f[b],isCustom:h[b],short:d[b],group:s[b],push:u[b],pop:c[b],tokenTypeIdx:a[b],tokenType:n[b]}})});var g=!0,v=[];return e.safeMode||r("First Char Optimization",function(){v=Nn(n,function(S,b,E){if(typeof b.PATTERN=="string"){var T=b.PATTERN.charCodeAt(0),N=gl(T);zC(S,N,m[E])}else if(Oo(b.START_CHARS_HINT)){var L;Je(b.START_CHARS_HINT,function(B){var k=typeof B=="string"?B.charCodeAt(0):B,M=gl(k);L!==M&&(L=M,zC(S,M,m[E]))})}else if(Es(b.PATTERN))if(b.PATTERN.unicode)g=!1,e.ensureOptimizations&&EA(""+oS+("	Unable to analyze < "+b.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var V=not(b.PATTERN,e.ensureOptimizations);Zt(V)&&(g=!1),Je(V,function(B){zC(S,B,m[E])})}else e.ensureOptimizations&&EA(""+oS+("	TokenType: <"+b.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),g=!1;return S},[])}),r("ArrayPacking",function(){v=Zit(v)}),{emptyGroups:p,patternIdxToConfig:m,charCodeToPatternIdxToConfig:v,hasCustom:i,canBeOptimized:g}}function sot(t,e){var r=[],n=uot(t);r=r.concat(n.errors);var i=cot(n.valid),o=i.valid;return r=r.concat(i.errors),r=r.concat(lot(o)),r=r.concat(vot(o)),r=r.concat(bot(o,e)),r=r.concat(wot(o)),r}function lot(t){var e=[],r=Po(t,function(n){return Es(n[fa])});return e=e.concat(hot(r)),e=e.concat(mot(r)),e=e.concat(got(r)),e=e.concat(yot(r)),e=e.concat(dot(r)),e}function uot(t){var e=Po(t,function(i){return!Ze(i,fa)}),r=Fe(e,function(i){return{message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:jr.MISSING_PATTERN,tokenTypes:[i]}}),n=aR(t,e);return{errors:r,valid:n}}function cot(t){var e=Po(t,function(i){var o=i[fa];return!Es(o)&&!_l(o)&&!Ze(o,"exec")&&!ca(o)}),r=Fe(e,function(i){return{message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:jr.INVALID_PATTERN,tokenTypes:[i]}}),n=aR(t,e);return{errors:r,valid:n}}var fot=/[^\\][\$]/;function hot(t){var e=function(i){TJ(o,i);function o(){var a=i!==null&&i.apply(this,arguments)||this;return a.found=!1,a}return o.prototype.visitEndAnchor=function(a){this.found=!0},o}(Gp.exports.BaseRegExpVisitor),r=Po(t,function(i){var o=i[fa];try{var a=lR(o),s=new e;return s.visit(a),s.found}catch{return fot.test(o.source)}}),n=Fe(r,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:jr.EOI_ANCHOR_FOUND,tokenTypes:[i]}});return n}function dot(t){var e=Po(t,function(n){var i=n[fa];return i.test("")}),r=Fe(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' must not match an empty string",type:jr.EMPTY_MATCH_PATTERN,tokenTypes:[n]}});return r}var pot=/[^\\[][\^]|^\^/;function mot(t){var e=function(i){TJ(o,i);function o(){var a=i!==null&&i.apply(this,arguments)||this;return a.found=!1,a}return o.prototype.visitStartAnchor=function(a){this.found=!0},o}(Gp.exports.BaseRegExpVisitor),r=Po(t,function(i){var o=i[fa];try{var a=lR(o),s=new e;return s.visit(a),s.found}catch{return pot.test(o.source)}}),n=Fe(r,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:jr.SOI_ANCHOR_FOUND,tokenTypes:[i]}});return n}function got(t){var e=Po(t,function(n){var i=n[fa];return i instanceof RegExp&&(i.multiline||i.global)}),r=Fe(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:jr.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[n]}});return r}function yot(t){var e=[],r=Fe(t,function(o){return Nn(t,function(a,s){return o.PATTERN.source===s.PATTERN.source&&!ln(e,s)&&s.PATTERN!==mi.NA&&(e.push(s),a.push(s)),a},[])});r=G1(r);var n=Po(r,function(o){return o.length>1}),i=Fe(n,function(o){var a=Fe(o,function(l){return l.name}),s=ro(o).PATTERN;return{message:"The same RegExp pattern ->"+s+"<-"+("has been used in all of the following Token Types: "+a.join(", ")+" <-"),type:jr.DUPLICATE_PATTERNS_FOUND,tokenTypes:o}});return i}function vot(t){var e=Po(t,function(n){if(!Ze(n,"GROUP"))return!1;var i=n.GROUP;return i!==mi.SKIPPED&&i!==mi.NA&&!ca(i)}),r=Fe(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:jr.INVALID_GROUP_TYPE_FOUND,tokenTypes:[n]}});return r}function bot(t,e){var r=Po(t,function(i){return i.PUSH_MODE!==void 0&&!ln(e,i.PUSH_MODE)}),n=Fe(r,function(i){var o="Token Type: ->"+i.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+i.PUSH_MODE+"<-which does not exist";return{message:o,type:jr.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}});return n}function wot(t){var e=[],r=Nn(t,function(n,i,o){var a=i.PATTERN;return a===mi.NA||(ca(a)?n.push({str:a,idx:o,tokenType:i}):Es(a)&&Rot(a)&&n.push({str:a.source,idx:o,tokenType:i})),n},[]);return Je(t,function(n,i){Je(r,function(o){var a=o.str,s=o.idx,l=o.tokenType;if(i<s&&Sot(a,n.PATTERN)){var u="Token: ->"+l.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+n.name+"<-")+`in the lexer's definition.
See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:u,type:jr.UNREACHABLE_PATTERN,tokenTypes:[n,l]})}})}),e}function Sot(t,e){if(Es(e)){var r=e.exec(t);return r!==null&&r.index===0}else{if(_l(e))return e(t,0,[],{});if(Ze(e,"exec"))return e.exec(t,0,[],{});if(typeof e=="string")return e===t;throw Error("non exhaustive match")}}function Rot(t){var e=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return yp(e,function(r){return t.source.indexOf(r)!==-1})===void 0}function dV(t){var e=t.ignoreCase?"i":"";return new RegExp("^(?:"+t.source+")",e)}function pV(t){var e=t.ignoreCase?"iy":"y";return new RegExp(""+t.source,e)}function Eot(t,e,r){var n=[];return Ze(t,Iu)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+Iu+`> property in its definition
`,type:jr.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Ze(t,ub)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+ub+`> property in its definition
`,type:jr.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Ze(t,ub)&&Ze(t,Iu)&&!Ze(t.modes,t.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+Iu+": <"+t.defaultMode+`>which does not exist
`,type:jr.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Ze(t,ub)&&Je(t.modes,function(i,o){Je(i,function(a,s){no(a)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+o+"> at index: <"+s+`>
`),type:jr.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),n}function Cot(t,e,r){var n=[],i=!1,o=G1(gi(Kit(t.modes,function(l){return l}))),a=ic(o,function(l){return l[fa]===mi.NA}),s=IJ(r);return e&&Je(a,function(l){var u=xJ(l,s);if(u!==!1){var c=Aot(l,u),f={message:c,type:u.issue,tokenType:l};n.push(f)}else Ze(l,"LINE_BREAKS")?l.LINE_BREAKS===!0&&(i=!0):CI(s,l.PATTERN)&&(i=!0)}),e&&!i&&n.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:jr.NO_LINE_BREAKS_FLAGS}),n}function _ot(t){var e={},r=As(t);return Je(r,function(n){var i=t[n];if(Oo(i))e[n]=[];else throw Error("non exhaustive match")}),e}function AJ(t){var e=t.PATTERN;if(Es(e))return!1;if(_l(e))return!0;if(Ze(e,"exec"))return!0;if(ca(e))return!1;throw Error("non exhaustive match")}function Tot(t){return ca(t)&&t.length===1?t.charCodeAt(0):!1}var Oot={test:function(t){for(var e=t.length,r=this.lastIndex;r<e;r++){var n=t.charCodeAt(r);if(n===10)return this.lastIndex=r+1,!0;if(n===13)return t.charCodeAt(r+1)===10?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function xJ(t,e){if(Ze(t,"LINE_BREAKS"))return!1;if(Es(t.PATTERN)){try{CI(e,t.PATTERN)}catch(r){return{issue:jr.IDENTIFY_TERMINATOR,errMsg:r.message}}return!1}else{if(ca(t.PATTERN))return!1;if(AJ(t))return{issue:jr.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function Aot(t,e){if(e.issue===jr.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+t.name+`> Token Type
`)+("	 Root cause: "+e.errMsg+`.
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===jr.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+t.name+`> Token Type
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function IJ(t){var e=Fe(t,function(r){return ca(r)&&r.length>0?r.charCodeAt(0):r});return e}function zC(t,e,r){t[e]===void 0?t[e]=[r]:t[e].push(r)}var Wm=256;function gl(t){return t<Wm?t:C2[t]}var C2=[];function xot(){if(Zt(C2)){C2=new Array(65536);for(var t=0;t<65536;t++)C2[t]=t>255?255+~~(t/255):t}}function uR(t,e){var r=t.tokenTypeIdx;return r===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[r]===!0}function aS(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}var mV=1,MJ={};function Y1(t){var e=Iot(t);Mot(e),Pot(e),Not(e),Je(e,function(r){r.isParent=r.categoryMatches.length>0})}function Iot(t){for(var e=yi(t),r=t,n=!0;n;){r=G1(gi(Fe(r,function(o){return o.CATEGORIES})));var i=aR(r,e);e=e.concat(i),Zt(i)?n=!1:r=i}return e}function Mot(t){Je(t,function(e){PJ(e)||(MJ[mV]=e,e.tokenTypeIdx=mV++),gV(e)&&!Oo(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),gV(e)||(e.CATEGORIES=[]),kot(e)||(e.categoryMatches=[]),$ot(e)||(e.categoryMatchesMap={})})}function Not(t){Je(t,function(e){e.categoryMatches=[],Je(e.categoryMatchesMap,function(r,n){e.categoryMatches.push(MJ[n].tokenTypeIdx)})})}function Pot(t){Je(t,function(e){NJ([],e)})}function NJ(t,e){Je(t,function(r){e.categoryMatchesMap[r.tokenTypeIdx]=!0}),Je(e.CATEGORIES,function(r){var n=t.concat(e);ln(n,r)||NJ(n,r)})}function PJ(t){return Ze(t,"tokenTypeIdx")}function gV(t){return Ze(t,"CATEGORIES")}function kot(t){return Ze(t,"categoryMatches")}function $ot(t){return Ze(t,"categoryMatchesMap")}function Lot(t){return Ze(t,"tokenTypeIdx")}var Dot={buildUnableToPopLexerModeMessage:function(t){return"Unable to pop Lexer Mode after encountering Token ->"+t.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(t,e,r,n,i){return"unexpected character: ->"+t.charAt(e)+"<- at offset: "+e+","+(" skipped "+r+" characters.")}},jr;(function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(jr||(jr={}));var zm={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:Dot,traceInitPerf:!1,skipValidations:!1};Object.freeze(zm);var mi=function(){function t(e,r){var n=this;if(r===void 0&&(r=zm),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof r=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=uV(zm,r);var i=this.config.traceInitPerf;i===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof i=="number"&&(this.traceInitMaxIdent=i,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var o,a=!0;n.TRACE_INIT("Lexer Config handling",function(){if(n.config.lineTerminatorsPattern===zm.lineTerminatorsPattern)n.config.lineTerminatorsPattern=Oot;else if(n.config.lineTerminatorCharacters===zm.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(r.safeMode&&r.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');n.trackStartLines=/full|onlyStart/i.test(n.config.positionTracking),n.trackEndLines=/full/i.test(n.config.positionTracking),Oo(e)?(o={modes:{}},o.modes[Iu]=yi(e),o[Iu]=Iu):(a=!1,o=z1(e))}),n.config.skipValidations===!1&&(n.TRACE_INIT("performRuntimeChecks",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(Eot(o,n.trackStartLines,n.config.lineTerminatorCharacters))}),n.TRACE_INIT("performWarningRuntimeChecks",function(){n.lexerDefinitionWarning=n.lexerDefinitionWarning.concat(Cot(o,n.trackStartLines,n.config.lineTerminatorCharacters))})),o.modes=o.modes?o.modes:{},Je(o.modes,function(c,f){o.modes[f]=ic(c,function(h){return no(h)})});var s=As(o.modes);if(Je(o.modes,function(c,f){n.TRACE_INIT("Mode: <"+f+"> processing",function(){if(n.modes.push(f),n.config.skipValidations===!1&&n.TRACE_INIT("validatePatterns",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(sot(c,s))}),Zt(n.lexerDefinitionErrors)){Y1(c);var h;n.TRACE_INIT("analyzeTokenTypes",function(){h=aot(c,{lineTerminatorCharacters:n.config.lineTerminatorCharacters,positionTracking:r.positionTracking,ensureOptimizations:r.ensureOptimizations,safeMode:r.safeMode,tracer:n.TRACE_INIT.bind(n)})}),n.patternIdxToConfig[f]=h.patternIdxToConfig,n.charCodeToPatternIdxToConfig[f]=h.charCodeToPatternIdxToConfig,n.emptyGroups=uV(n.emptyGroups,h.emptyGroups),n.hasCustom=h.hasCustom||n.hasCustom,n.canModeBeOptimized[f]=h.canBeOptimized}})}),n.defaultMode=o.defaultMode,!Zt(n.lexerDefinitionErrors)&&!n.config.deferDefinitionErrorsHandling){var l=Fe(n.lexerDefinitionErrors,function(c){return c.message}),u=l.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+u)}Je(n.lexerDefinitionWarning,function(c){EI(c.message)}),n.TRACE_INIT("Choosing sub-methods implementations",function(){if(OJ?(n.chopInput=cV,n.match=n.matchWithTest):(n.updateLastIndex=cn,n.match=n.matchWithExec),a&&(n.handleModes=cn),n.trackStartLines===!1&&(n.computeNewColumn=cV),n.trackEndLines===!1&&(n.updateTokenEndLineColumnLocation=cn),/full/i.test(n.config.positionTracking))n.createTokenInstance=n.createFullToken;else if(/onlyStart/i.test(n.config.positionTracking))n.createTokenInstance=n.createStartOnlyToken;else if(/onlyOffset/i.test(n.config.positionTracking))n.createTokenInstance=n.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+n.config.positionTracking+'"');n.hasCustom?(n.addToken=n.addTokenUsingPush,n.handlePayload=n.handlePayloadWithCustom):(n.addToken=n.addTokenUsingMemberAccess,n.handlePayload=n.handlePayloadNoCustom)}),n.TRACE_INIT("Failed Optimization Warnings",function(){var c=Nn(n.canModeBeOptimized,function(f,h,d){return h===!1&&f.push(d),f},[]);if(r.ensureOptimizations&&!Zt(c))throw Error("Lexer Modes: < "+c.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),n.TRACE_INIT("clearRegExpParserCache",function(){tot()}),n.TRACE_INIT("toFastProperties",function(){EJ(n)})})}return t.prototype.tokenize=function(e,r){if(r===void 0&&(r=this.defaultMode),!Zt(this.lexerDefinitionErrors)){var n=Fe(this.lexerDefinitionErrors,function(a){return a.message}),i=n.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}var o=this.tokenizeInternal(e,r);return o},t.prototype.tokenizeInternal=function(e,r){var n=this,i,o,a,s,l,u,c,f,h,d,p,m,g,v,S=e,b=S.length,E=0,T=0,N=this.hasCustom?0:Math.floor(e.length/10),L=new Array(N),V=[],B=this.trackStartLines?1:void 0,k=this.trackStartLines?1:void 0,M=_ot(this.emptyGroups),G=this.trackStartLines,j=this.config.lineTerminatorsPattern,q=0,te=[],pe=[],ne=[],O=[];Object.freeze(O);var y=void 0;function R(){return te}function C(I){var D=gl(I),U=pe[D];return U===void 0?O:U}var A=function(I){if(ne.length===1&&I.tokenType.PUSH_MODE===void 0){var D=n.config.errorMessageProvider.buildUnableToPopLexerModeMessage(I);V.push({offset:I.startOffset,line:I.startLine!==void 0?I.startLine:void 0,column:I.startColumn!==void 0?I.startColumn:void 0,length:I.image.length,message:D})}else{ne.pop();var U=wJ(ne);te=n.patternIdxToConfig[U],pe=n.charCodeToPatternIdxToConfig[U],q=te.length;var ae=n.canModeBeOptimized[U]&&n.config.safeMode===!1;pe&&ae?y=C:y=R}};function P(I){ne.push(I),pe=this.charCodeToPatternIdxToConfig[I],te=this.patternIdxToConfig[I],q=te.length,q=te.length;var D=this.canModeBeOptimized[I]&&this.config.safeMode===!1;pe&&D?y=C:y=R}P.call(this,r);for(var H;E<b;){l=null;var Y=S.charCodeAt(E),z=y(Y),oe=z.length;for(i=0;i<oe;i++){H=z[i];var me=H.pattern;u=null;var re=H.short;if(re!==!1?Y===re&&(l=me):H.isCustom===!0?(v=me.exec(S,E,L,M),v!==null?(l=v[0],v.payload!==void 0&&(u=v.payload)):l=null):(this.updateLastIndex(me,E),l=this.match(me,e,E)),l!==null){if(s=H.longerAlt,s!==void 0){var ge=te[s],ve=ge.pattern;c=null,ge.isCustom===!0?(v=ve.exec(S,E,L,M),v!==null?(a=v[0],v.payload!==void 0&&(c=v.payload)):a=null):(this.updateLastIndex(ve,E),a=this.match(ve,e,E)),a&&a.length>l.length&&(l=a,u=c,H=ge)}break}}if(l!==null){if(f=l.length,h=H.group,h!==void 0&&(d=H.tokenTypeIdx,p=this.createTokenInstance(l,E,d,H.tokenType,B,k,f),this.handlePayload(p,u),h===!1?T=this.addToken(L,T,p):M[h].push(p)),e=this.chopInput(e,f),E=E+f,k=this.computeNewColumn(k,f),G===!0&&H.canLineTerminator===!0){var ie=0,be=void 0,ce=void 0;j.lastIndex=0;do be=j.test(l),be===!0&&(ce=j.lastIndex-1,ie++);while(be===!0);ie!==0&&(B=B+ie,k=f-ce,this.updateTokenEndLineColumnLocation(p,h,ce,ie,B,k,f))}this.handleModes(H,A,P,p)}else{for(var _e=E,Ie=B,Oe=k,Ae=!1;!Ae&&E<b;)for(S.charCodeAt(E),e=this.chopInput(e,1),E++,o=0;o<q;o++){var xe=te[o],me=xe.pattern,re=xe.short;if(re!==!1?S.charCodeAt(E)===re&&(Ae=!0):xe.isCustom===!0?Ae=me.exec(S,E,L,M)!==null:(this.updateLastIndex(me,E),Ae=me.exec(e)!==null),Ae===!0)break}m=E-_e,g=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(S,_e,m,Ie,Oe),V.push({offset:_e,line:Ie,column:Oe,length:m,message:g})}}return this.hasCustom||(L.length=T),{tokens:L,groups:M,errors:V}},t.prototype.handleModes=function(e,r,n,i){if(e.pop===!0){var o=e.push;r(i),o!==void 0&&n.call(this,o)}else e.push!==void 0&&n.call(this,e.push)},t.prototype.chopInput=function(e,r){return e.substring(r)},t.prototype.updateLastIndex=function(e,r){e.lastIndex=r},t.prototype.updateTokenEndLineColumnLocation=function(e,r,n,i,o,a,s){var l,u;r!==void 0&&(l=n===s-1,u=l?-1:0,i===1&&l===!0||(e.endLine=o+u,e.endColumn=a-1+-u))},t.prototype.computeNewColumn=function(e,r){return e+r},t.prototype.createTokenInstance=function(){return null},t.prototype.createOffsetOnlyToken=function(e,r,n,i){return{image:e,startOffset:r,tokenTypeIdx:n,tokenType:i}},t.prototype.createStartOnlyToken=function(e,r,n,i,o,a){return{image:e,startOffset:r,startLine:o,startColumn:a,tokenTypeIdx:n,tokenType:i}},t.prototype.createFullToken=function(e,r,n,i,o,a,s){return{image:e,startOffset:r,endOffset:r+s-1,startLine:o,endLine:o,startColumn:a,endColumn:a+s-1,tokenTypeIdx:n,tokenType:i}},t.prototype.addToken=function(e,r,n){return 666},t.prototype.addTokenUsingPush=function(e,r,n){return e.push(n),r},t.prototype.addTokenUsingMemberAccess=function(e,r,n){return e[r]=n,r++,r},t.prototype.handlePayload=function(e,r){},t.prototype.handlePayloadNoCustom=function(e,r){},t.prototype.handlePayloadWithCustom=function(e,r){r!==null&&(e.payload=r)},t.prototype.match=function(e,r,n){return null},t.prototype.matchWithTest=function(e,r,n){var i=e.test(r);return i===!0?r.substring(n,e.lastIndex):null},t.prototype.matchWithExec=function(e,r){var n=e.exec(r);return n!==null?n[0]:n},t.prototype.TRACE_INIT=function(e,r){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+e+">");var i=CJ(r),o=i.time,a=i.value,s=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(n+"<-- <"+e+"> time: "+o+"ms"),this.traceInitIndent--,a}else return r()},t.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",t.NA=/NOT_APPLICABLE/,t}();function eh(t){return kJ(t)?t.LABEL:t.name}function kJ(t){return ca(t.LABEL)&&t.LABEL!==""}var Fot="parent",yV="categories",vV="label",bV="group",wV="push_mode",SV="pop_mode",RV="longer_alt",EV="line_breaks",CV="start_chars_hint";function Pt(t){return Hot(t)}function Hot(t){var e=t.pattern,r={};if(r.name=t.name,no(e)||(r.PATTERN=e),Ze(t,Fot))throw`The parent property is no longer supported.
See: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.`;return Ze(t,yV)&&(r.CATEGORIES=t[yV]),Y1([r]),Ze(t,vV)&&(r.LABEL=t[vV]),Ze(t,bV)&&(r.GROUP=t[bV]),Ze(t,SV)&&(r.POP_MODE=t[SV]),Ze(t,wV)&&(r.PUSH_MODE=t[wV]),Ze(t,RV)&&(r.LONGER_ALT=t[RV]),Ze(t,EV)&&(r.LINE_BREAKS=t[EV]),Ze(t,CV)&&(r.START_CHARS_HINT=t[CV]),r}var oc=Pt({name:"EOF",pattern:mi.NA});Y1([oc]);function _I(t,e,r,n,i,o,a,s){return{image:e,startOffset:r,endOffset:n,startLine:i,endLine:o,startColumn:a,endColumn:s,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function Yt(t,e){return uR(t,e)}var xs=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ba=function(){function t(e){this.definition=e}return t.prototype.accept=function(e){e.visit(this),Je(this.definition,function(r){r.accept(e)})},t}(),Pi=function(t){xs(e,t);function e(r){var n=t.call(this,[])||this;return n.idx=1,ko(n,uo(r,function(i){return i!==void 0})),n}return Object.defineProperty(e.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(r){},enumerable:!0,configurable:!0}),e.prototype.accept=function(r){r.visit(this)},e}(ba),Yp=function(t){xs(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.orgText="",ko(n,uo(r,function(i){return i!==void 0})),n}return e}(ba),vi=function(t){xs(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.ignoreAmbiguities=!1,ko(n,uo(r,function(i){return i!==void 0})),n}return e}(ba),In=function(t){xs(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,ko(n,uo(r,function(i){return i!==void 0})),n}return e}(ba),io=function(t){xs(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,ko(n,uo(r,function(i){return i!==void 0})),n}return e}(ba),oo=function(t){xs(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,ko(n,uo(r,function(i){return i!==void 0})),n}return e}(ba),Ur=function(t){xs(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,ko(n,uo(r,function(i){return i!==void 0})),n}return e}(ba),ki=function(t){xs(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,ko(n,uo(r,function(i){return i!==void 0})),n}return e}(ba),$i=function(t){xs(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,ko(n,uo(r,function(i){return i!==void 0})),n}return e}(ba),Sr=function(){function t(e){this.idx=1,ko(this,uo(e,function(r){return r!==void 0}))}return t.prototype.accept=function(e){e.visit(this)},t}();function Bot(t){return Fe(t,_2)}function _2(t){function e(i){return Fe(i,_2)}if(t instanceof Pi)return{type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};if(t instanceof vi)return{type:"Flat",definition:e(t.definition)};if(t instanceof In)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof io)return{type:"RepetitionMandatory",name:t.name,idx:t.idx,definition:e(t.definition)};if(t instanceof oo)return{type:"RepetitionMandatoryWithSeparator",name:t.name,idx:t.idx,separator:_2(new Sr({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof ki)return{type:"RepetitionWithSeparator",name:t.name,idx:t.idx,separator:_2(new Sr({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof Ur)return{type:"Repetition",name:t.name,idx:t.idx,definition:e(t.definition)};if(t instanceof $i)return{type:"Alternation",name:t.name,idx:t.idx,definition:e(t.definition)};if(t instanceof Sr){var r={type:"Terminal",name:t.terminalType.name,label:eh(t.terminalType),idx:t.idx},n=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(r.pattern=Es(n)?n.source:n),r}else{if(t instanceof Yp)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}}var cR=function(){function t(){}return t.prototype.walk=function(e,r){var n=this;r===void 0&&(r=[]),Je(e.definition,function(i,o){var a=On(e.definition,o+1);if(i instanceof Pi)n.walkProdRef(i,a,r);else if(i instanceof Sr)n.walkTerminal(i,a,r);else if(i instanceof vi)n.walkFlat(i,a,r);else if(i instanceof In)n.walkOption(i,a,r);else if(i instanceof io)n.walkAtLeastOne(i,a,r);else if(i instanceof oo)n.walkAtLeastOneSep(i,a,r);else if(i instanceof ki)n.walkManySep(i,a,r);else if(i instanceof Ur)n.walkMany(i,a,r);else if(i instanceof $i)n.walkOr(i,a,r);else throw Error("non exhaustive match")})},t.prototype.walkTerminal=function(e,r,n){},t.prototype.walkProdRef=function(e,r,n){},t.prototype.walkFlat=function(e,r,n){var i=r.concat(n);this.walk(e,i)},t.prototype.walkOption=function(e,r,n){var i=r.concat(n);this.walk(e,i)},t.prototype.walkAtLeastOne=function(e,r,n){var i=[new In({definition:e.definition})].concat(r,n);this.walk(e,i)},t.prototype.walkAtLeastOneSep=function(e,r,n){var i=_V(e,r,n);this.walk(e,i)},t.prototype.walkMany=function(e,r,n){var i=[new In({definition:e.definition})].concat(r,n);this.walk(e,i)},t.prototype.walkManySep=function(e,r,n){var i=_V(e,r,n);this.walk(e,i)},t.prototype.walkOr=function(e,r,n){var i=this,o=r.concat(n);Je(e.definition,function(a){var s=new vi({definition:[a]});i.walk(s,o)})},t}();function _V(t,e,r){var n=[new In({definition:[new Sr({terminalType:t.separator})].concat(t.definition)})],i=n.concat(e,r);return i}var Oc=function(){function t(){}return t.prototype.visit=function(e){var r=e;switch(r.constructor){case Pi:return this.visitNonTerminal(r);case vi:return this.visitFlat(r);case In:return this.visitOption(r);case io:return this.visitRepetitionMandatory(r);case oo:return this.visitRepetitionMandatoryWithSeparator(r);case ki:return this.visitRepetitionWithSeparator(r);case Ur:return this.visitRepetition(r);case $i:return this.visitAlternation(r);case Sr:return this.visitTerminal(r);case Yp:return this.visitRule(r);default:throw Error("non exhaustive match")}},t.prototype.visitNonTerminal=function(e){},t.prototype.visitFlat=function(e){},t.prototype.visitOption=function(e){},t.prototype.visitRepetition=function(e){},t.prototype.visitRepetitionMandatory=function(e){},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){},t.prototype.visitRepetitionWithSeparator=function(e){},t.prototype.visitAlternation=function(e){},t.prototype.visitTerminal=function(e){},t.prototype.visitRule=function(e){},t}(),Uot=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();function Vot(t){return t instanceof vi||t instanceof In||t instanceof Ur||t instanceof io||t instanceof oo||t instanceof ki||t instanceof Sr||t instanceof Yp}function sS(t,e){e===void 0&&(e=[]);var r=t instanceof In||t instanceof Ur||t instanceof ki;return r?!0:t instanceof $i?SJ(t.definition,function(n){return sS(n,e)}):t instanceof Pi&&ln(e,t)?!1:t instanceof ba?(t instanceof Pi&&e.push(t),Ji(t.definition,function(n){return sS(n,e)})):!1}function jot(t){return t instanceof $i}function Eo(t){if(t instanceof Pi)return"SUBRULE";if(t instanceof In)return"OPTION";if(t instanceof $i)return"OR";if(t instanceof io)return"AT_LEAST_ONE";if(t instanceof oo)return"AT_LEAST_ONE_SEP";if(t instanceof ki)return"MANY_SEP";if(t instanceof Ur)return"MANY";if(t instanceof Sr)return"CONSUME";throw Error("non exhaustive match")}var Wot=function(t){Uot(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.separator="-",r.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},r}return e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(r){var n=r.terminalType.name+this.separator+"Terminal";Ze(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(r)},e.prototype.visitNonTerminal=function(r){var n=r.nonTerminalName+this.separator+"Terminal";Ze(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(r)},e.prototype.visitOption=function(r){this.dslMethods.option.push(r)},e.prototype.visitRepetitionWithSeparator=function(r){this.dslMethods.repetitionWithSeparator.push(r)},e.prototype.visitRepetitionMandatory=function(r){this.dslMethods.repetitionMandatory.push(r)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.dslMethods.repetitionMandatoryWithSeparator.push(r)},e.prototype.visitRepetition=function(r){this.dslMethods.repetition.push(r)},e.prototype.visitAlternation=function(r){this.dslMethods.alternation.push(r)},e}(Oc),cb=new Wot;function zot(t){cb.reset(),t.accept(cb);var e=cb.dslMethods;return cb.reset(),e}function K1(t){if(t instanceof Pi)return K1(t.referencedRule);if(t instanceof Sr)return Kot(t);if(Vot(t))return Got(t);if(jot(t))return Yot(t);throw Error("non exhaustive match")}function Got(t){for(var e=[],r=t.definition,n=0,i=r.length>n,o,a=!0;i&&a;)o=r[n],a=sS(o),e=e.concat(K1(o)),n=n+1,i=r.length>n;return SI(e)}function Yot(t){var e=Fe(t.definition,function(r){return K1(r)});return SI(gi(e))}function Kot(t){return[t.terminalType]}var $J="_~IN~_",qot=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Xot=function(t){qot(e,t);function e(r){var n=t.call(this)||this;return n.topProd=r,n.follows={},n}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(r,n,i){},e.prototype.walkProdRef=function(r,n,i){var o=Zot(r.referencedRule,r.idx)+this.topProd.name,a=n.concat(i),s=new vi({definition:a}),l=K1(s);this.follows[o]=l},e}(cR);function Qot(t){var e={};return Je(t,function(r){var n=new Xot(r).startWalking();ko(e,n)}),e}function Zot(t,e){return t.name+e+$J}var Jot=4,Tl=8,eat=8,th=1<<Tl,lS=2<<Tl,cg=3<<Tl,fg=4<<Tl,hg=5<<Tl,$f=6<<Tl;function dg(t,e,r){return r|e|t}var tat=32-eat;function LJ(t,e,r,n){var i=n+1<<tat;return dg(t,e,r)|i}var rat=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();function TV(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset)}function OV(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}function nat(t,e,r){t.children[r]===void 0?t.children[r]=[e]:t.children[r].push(e)}function AV(t,e,r){t.children[e]===void 0?t.children[e]=[r]:t.children[e].push(r)}var TI=function(t){rat(e,t);function e(r){var n=t.call(this)||this;return n.result=[],n.ruleIdx=r,n}return e.prototype.collectNamedDSLMethod=function(r,n,i){if(!no(r.name)){var o=void 0;if(r instanceof In||r instanceof Ur||r instanceof io||r instanceof $i)o=new n({definition:r.definition,idx:r.idx});else if(r instanceof oo||r instanceof ki)o=new n({definition:r.definition,idx:r.idx,separator:r.separator});else throw Error("non exhaustive match");var a=[o],s=dg(this.ruleIdx,i,r.idx);this.result.push({def:a,key:s,name:r.name,orgProd:r})}},e.prototype.visitOption=function(r){this.collectNamedDSLMethod(r,In,lS)},e.prototype.visitRepetition=function(r){this.collectNamedDSLMethod(r,Ur,cg)},e.prototype.visitRepetitionMandatory=function(r){this.collectNamedDSLMethod(r,io,fg)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.collectNamedDSLMethod(r,oo,$f)},e.prototype.visitRepetitionWithSeparator=function(r){this.collectNamedDSLMethod(r,ki,hg)},e.prototype.visitAlternation=function(r){var n=this;this.collectNamedDSLMethod(r,$i,th);var i=r.definition.length>1;Je(r.definition,function(o,a){if(!no(o.name)){var s=o.definition;i?s=[new In({definition:o.definition})]:s=o.definition;var l=LJ(n.ruleIdx,th,r.idx,a);n.result.push({def:s,key:l,name:o.name,orgProd:o})}})},e}(Oc);function iat(t,e){var r={allRuleNames:[]};return Je(t,function(n){var i=e[n.name];r.allRuleNames.push(n.name);var o=new TI(i);n.accept(o),Je(o.result,function(a){a.def,a.key;var s=a.name;r.allRuleNames.push(n.name+s)})}),r}var Ac=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),oat=function(t){Ac(e,t);function e(r,n){var i=t.call(this)||this;return i.topProd=r,i.path=n,i.possibleTokTypes=[],i.nextProductionName="",i.nextProductionOccurrence=0,i.found=!1,i.isAtEndOfPath=!1,i}return e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=yi(this.path.ruleStack).reverse(),this.occurrenceStack=yi(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(r,n){n===void 0&&(n=[]),this.found||t.prototype.walk.call(this,r,n)},e.prototype.walkProdRef=function(r,n,i){if(r.referencedRule.name===this.nextProductionName&&r.idx===this.nextProductionOccurrence){var o=n.concat(i);this.updateExpectedNext(),this.walk(r.referencedRule,o)}},e.prototype.updateExpectedNext=function(){Zt(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(cR),aat=function(t){Ac(e,t);function e(r,n){var i=t.call(this,r,n)||this;return i.path=n,i.nextTerminalName="",i.nextTerminalOccurrence=0,i.nextTerminalName=i.path.lastTok.name,i.nextTerminalOccurrence=i.path.lastTokOccurrence,i}return e.prototype.walkTerminal=function(r,n,i){if(this.isAtEndOfPath&&r.terminalType.name===this.nextTerminalName&&r.idx===this.nextTerminalOccurrence&&!this.found){var o=n.concat(i),a=new vi({definition:o});this.possibleTokTypes=K1(a),this.found=!0}},e}(oat),fR=function(t){Ac(e,t);function e(r,n){var i=t.call(this)||this;return i.topRule=r,i.occurrence=n,i.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},i}return e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(cR),sat=function(t){Ac(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.walkMany=function(r,n,i){if(r.idx===this.occurrence){var o=ro(n.concat(i));this.result.isEndOfRule=o===void 0,o instanceof Sr&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkMany.call(this,r,n,i)},e}(fR),xV=function(t){Ac(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.walkManySep=function(r,n,i){if(r.idx===this.occurrence){var o=ro(n.concat(i));this.result.isEndOfRule=o===void 0,o instanceof Sr&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkManySep.call(this,r,n,i)},e}(fR),lat=function(t){Ac(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.walkAtLeastOne=function(r,n,i){if(r.idx===this.occurrence){var o=ro(n.concat(i));this.result.isEndOfRule=o===void 0,o instanceof Sr&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkAtLeastOne.call(this,r,n,i)},e}(fR),IV=function(t){Ac(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.walkAtLeastOneSep=function(r,n,i){if(r.idx===this.occurrence){var o=ro(n.concat(i));this.result.isEndOfRule=o===void 0,o instanceof Sr&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkAtLeastOneSep.call(this,r,n,i)},e}(fR);function TA(t,e,r){r===void 0&&(r=[]),r=yi(r);var n=[],i=0;function o(u){return u.concat(On(t,i+1))}function a(u){var c=TA(o(u),e,r);return n.concat(c)}for(;r.length<e&&i<t.length;){var s=t[i];if(s instanceof vi)return a(s.definition);if(s instanceof Pi)return a(s.definition);if(s instanceof In)n=a(s.definition);else if(s instanceof io){var l=s.definition.concat([new Ur({definition:s.definition})]);return a(l)}else if(s instanceof oo){var l=[new vi({definition:s.definition}),new Ur({definition:[new Sr({terminalType:s.separator})].concat(s.definition)})];return a(l)}else if(s instanceof ki){var l=s.definition.concat([new Ur({definition:[new Sr({terminalType:s.separator})].concat(s.definition)})]);n=a(l)}else if(s instanceof Ur){var l=s.definition.concat([new Ur({definition:s.definition})]);n=a(l)}else{if(s instanceof $i)return Je(s.definition,function(u){n=a(u.definition)}),n;if(s instanceof Sr)r.push(s.terminalType);else throw Error("non exhaustive match")}i++}return n.push({partialPath:r,suffixDef:On(t,i)}),n}function DJ(t,e,r,n){var i="EXIT_NONE_TERMINAL",o=[i],a="EXIT_ALTERNATIVE",s=!1,l=e.length,u=l-n-1,c=[],f=[];for(f.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!Zt(f);){var h=f.pop();if(h===a){s&&wJ(f).idx<=u&&f.pop();continue}var d=h.def,p=h.idx,m=h.ruleStack,g=h.occurrenceStack;if(!Zt(d)){var v=d[0];if(v===i){var S={idx:p,def:On(d),ruleStack:Nv(m),occurrenceStack:Nv(g)};f.push(S)}else if(v instanceof Sr)if(p<l-1){var b=p+1,E=e[b];if(r(E,v.terminalType)){var S={idx:b,def:On(d),ruleStack:m,occurrenceStack:g};f.push(S)}}else if(p===l-1)c.push({nextTokenType:v.terminalType,nextTokenOccurrence:v.idx,ruleStack:m,occurrenceStack:g}),s=!0;else throw Error("non exhaustive match");else if(v instanceof Pi){var T=yi(m);T.push(v.nonTerminalName);var N=yi(g);N.push(v.idx);var S={idx:p,def:v.definition.concat(o,On(d)),ruleStack:T,occurrenceStack:N};f.push(S)}else if(v instanceof In){var L={idx:p,def:On(d),ruleStack:m,occurrenceStack:g};f.push(L),f.push(a);var V={idx:p,def:v.definition.concat(On(d)),ruleStack:m,occurrenceStack:g};f.push(V)}else if(v instanceof io){var B=new Ur({definition:v.definition,idx:v.idx}),k=v.definition.concat([B],On(d)),S={idx:p,def:k,ruleStack:m,occurrenceStack:g};f.push(S)}else if(v instanceof oo){var M=new Sr({terminalType:v.separator}),B=new Ur({definition:[M].concat(v.definition),idx:v.idx}),k=v.definition.concat([B],On(d)),S={idx:p,def:k,ruleStack:m,occurrenceStack:g};f.push(S)}else if(v instanceof ki){var L={idx:p,def:On(d),ruleStack:m,occurrenceStack:g};f.push(L),f.push(a);var M=new Sr({terminalType:v.separator}),G=new Ur({definition:[M].concat(v.definition),idx:v.idx}),k=v.definition.concat([G],On(d)),V={idx:p,def:k,ruleStack:m,occurrenceStack:g};f.push(V)}else if(v instanceof Ur){var L={idx:p,def:On(d),ruleStack:m,occurrenceStack:g};f.push(L),f.push(a);var G=new Ur({definition:v.definition,idx:v.idx}),k=v.definition.concat([G],On(d)),V={idx:p,def:k,ruleStack:m,occurrenceStack:g};f.push(V)}else if(v instanceof $i)for(var j=v.definition.length-1;j>=0;j--){var q=v.definition[j],te={idx:p,def:q.definition.concat(On(d)),ruleStack:m,occurrenceStack:g};f.push(te),f.push(a)}else if(v instanceof vi)f.push({idx:p,def:v.definition.concat(On(d)),ruleStack:m,occurrenceStack:g});else if(v instanceof Yp)f.push(uat(v,p,m,g));else throw Error("non exhaustive match")}}return c}function uat(t,e,r,n){var i=yi(r);i.push(t.name);var o=yi(n);return o.push(1),{idx:e,def:t.definition,ruleStack:i,occurrenceStack:o}}var FJ=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),rr;(function(t){t[t.OPTION=0]="OPTION",t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"})(rr||(rr={}));function cat(t){if(t instanceof In)return rr.OPTION;if(t instanceof Ur)return rr.REPETITION;if(t instanceof io)return rr.REPETITION_MANDATORY;if(t instanceof oo)return rr.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof ki)return rr.REPETITION_WITH_SEPARATOR;if(t instanceof $i)return rr.ALTERNATION;throw Error("non exhaustive match")}function fat(t,e,r,n,i,o){var a=OI(t,e,r),s=UJ(a)?aS:uR;return o(a,n,s,i)}function hat(t,e,r,n,i,o){var a=AI(t,e,i,r),s=UJ(a)?aS:uR;return o(a[0],s,n)}function dat(t,e,r,n){var i=t.length,o=Ji(t,function(l){return Ji(l,function(u){return u.length===1})});if(e)return function(l){for(var u=Fe(l,function(b){return b.GATE}),c=0;c<i;c++){var f=t[c],h=f.length,d=u[c];if(d!==void 0&&d.call(this)===!1)continue;e:for(var p=0;p<h;p++){for(var m=f[p],g=m.length,v=0;v<g;v++){var S=this.LA(v+1);if(r(S,m[v])===!1)continue e}return c}}};if(o&&!n){var a=Fe(t,function(l){return gi(l)}),s=Nn(a,function(l,u,c){return Je(u,function(f){Ze(l,f.tokenTypeIdx)||(l[f.tokenTypeIdx]=c),Je(f.categoryMatches,function(h){Ze(l,h)||(l[h]=c)})}),l},[]);return function(){var l=this.LA(1);return s[l.tokenTypeIdx]}}else return function(){for(var l=0;l<i;l++){var u=t[l],c=u.length;e:for(var f=0;f<c;f++){for(var h=u[f],d=h.length,p=0;p<d;p++){var m=this.LA(p+1);if(r(m,h[p])===!1)continue e}return l}}}}function pat(t,e,r){var n=Ji(t,function(u){return u.length===1}),i=t.length;if(n&&!r){var o=gi(t);if(o.length===1&&Zt(o[0].categoryMatches)){var a=o[0],s=a.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===s}}else{var l=Nn(o,function(u,c,f){return u[c.tokenTypeIdx]=!0,Je(c.categoryMatches,function(h){u[h]=!0}),u},[]);return function(){var u=this.LA(1);return l[u.tokenTypeIdx]===!0}}}else return function(){e:for(var u=0;u<i;u++){for(var c=t[u],f=c.length,h=0;h<f;h++){var d=this.LA(h+1);if(e(d,c[h])===!1)continue e}return!0}return!1}}var mat=function(t){FJ(e,t);function e(r,n,i){var o=t.call(this)||this;return o.topProd=r,o.targetOccurrence=n,o.targetProdType=i,o}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(r,n,i,o){return r.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=i.concat(o),!0):!1},e.prototype.walkOption=function(r,n,i){this.checkIsTarget(r,rr.OPTION,n,i)||t.prototype.walkOption.call(this,r,n,i)},e.prototype.walkAtLeastOne=function(r,n,i){this.checkIsTarget(r,rr.REPETITION_MANDATORY,n,i)||t.prototype.walkOption.call(this,r,n,i)},e.prototype.walkAtLeastOneSep=function(r,n,i){this.checkIsTarget(r,rr.REPETITION_MANDATORY_WITH_SEPARATOR,n,i)||t.prototype.walkOption.call(this,r,n,i)},e.prototype.walkMany=function(r,n,i){this.checkIsTarget(r,rr.REPETITION,n,i)||t.prototype.walkOption.call(this,r,n,i)},e.prototype.walkManySep=function(r,n,i){this.checkIsTarget(r,rr.REPETITION_WITH_SEPARATOR,n,i)||t.prototype.walkOption.call(this,r,n,i)},e}(cR),HJ=function(t){FJ(e,t);function e(r,n,i){var o=t.call(this)||this;return o.targetOccurrence=r,o.targetProdType=n,o.targetRef=i,o.result=[],o}return e.prototype.checkIsTarget=function(r,n){r.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||r===this.targetRef)&&(this.result=r.definition)},e.prototype.visitOption=function(r){this.checkIsTarget(r,rr.OPTION)},e.prototype.visitRepetition=function(r){this.checkIsTarget(r,rr.REPETITION)},e.prototype.visitRepetitionMandatory=function(r){this.checkIsTarget(r,rr.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.checkIsTarget(r,rr.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(r){this.checkIsTarget(r,rr.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(r){this.checkIsTarget(r,rr.ALTERNATION)},e}(Oc);function MV(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=[];return e}function GC(t){for(var e=[""],r=0;r<t.length;r++){for(var n=t[r],i=[],o=0;o<e.length;o++){var a=e[o];i.push(a+"_"+n.tokenTypeIdx);for(var s=0;s<n.categoryMatches.length;s++){var l="_"+n.categoryMatches[s];i.push(a+l)}}e=i}return e}function gat(t,e,r){for(var n=0;n<t.length;n++)if(n!==r)for(var i=t[n],o=0;o<e.length;o++){var a=e[o];if(i[a]===!0)return!1}return!0}function BJ(t,e){for(var r=Fe(t,function(c){return TA([c],1)}),n=MV(r.length),i=Fe(r,function(c){var f={};return Je(c,function(h){var d=GC(h.partialPath);Je(d,function(p){f[p]=!0})}),f}),o=r,a=1;a<=e;a++){var s=o;o=MV(s.length);for(var l=function(c){for(var f=s[c],h=0;h<f.length;h++){var d=f[h].partialPath,p=f[h].suffixDef,m=GC(d),g=gat(i,m,c);if(g||Zt(p)||d.length===e){var v=n[c];if(OA(v,d)===!1){v.push(d);for(var S=0;S<m.length;S++){var b=m[S];i[c][b]=!0}}}else{var E=TA(p,a+1,d);o[c]=o[c].concat(E),Je(E,function(T){var N=GC(T.partialPath);Je(N,function(L){i[c][L]=!0})})}}},u=0;u<s.length;u++)l(u)}return n}function OI(t,e,r,n){var i=new HJ(t,rr.ALTERNATION,n);return e.accept(i),BJ(i.result,r)}function AI(t,e,r,n){var i=new HJ(t,r);e.accept(i);var o=i.result,a=new mat(e,t,r),s=a.startWalking(),l=new vi({definition:o}),u=new vi({definition:s});return BJ([l,u],n)}function OA(t,e){e:for(var r=0;r<t.length;r++){var n=t[r];if(n.length===e.length){for(var i=0;i<n.length;i++){var o=e[i],a=n[i],s=o===a||a.categoryMatchesMap[o.tokenTypeIdx]!==void 0;if(s===!1)continue e}return!0}}return!1}function yat(t,e){return t.length<e.length&&Ji(t,function(r,n){var i=e[n];return r===i||i.categoryMatchesMap[r.tokenTypeIdx]})}function UJ(t){return Ji(t,function(e){return Ji(e,function(r){return Ji(r,function(n){return Zt(n.categoryMatches)})})})}var xI=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();function vat(t,e,r,n,i,o){var a=Fe(t,function(S){return wat(S,i)}),s=Fe(t,function(S){return WJ(S,S,i)}),l=[],u=[],c=[];Ji(s,Zt)&&(l=Fe(t,function(S){return Aat(S,i)}),u=Fe(t,function(S){return xat(S,e,n,i)}),c=Nat(t,e,i));var f=$at(t,r,i),h=Fe(r,function(S){return _at(S,i)}),d=bat(t,i),p=Lat(t,i),m=Fe(t,function(S){return Mat(S,i)}),g=Fe(t,function(S){return Eat(S,i)}),v=Fe(t,function(S){return Tat(S,t,o,i)});return gi(a.concat(h,d,p,c,s,l,u,f,m,g,v))}function bat(t,e){var r=[];return Je(t,function(n){var i=new TI("");n.accept(i);var o=Fe(i.result,function(a){return a.orgProd});r.push(Fe(o,function(a){return Cat(n,a,e)}))}),gi(r)}function wat(t,e){var r=new Rat;t.accept(r);var n=r.allProductions,i=RJ(n,Sat),o=uo(i,function(s){return s.length>1}),a=Fe(Fn(o),function(s){var l=ro(s),u=e.buildDuplicateFoundError(t,s),c=Eo(l),f={message:u,type:bn.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:c,occurrence:l.idx},h=VJ(l);return h&&(f.parameter=h),f});return a}function Sat(t){return Eo(t)+"_#_"+t.idx+"_#_"+VJ(t)}function VJ(t){return t instanceof Sr?t.terminalType.name:t instanceof Pi?t.nonTerminalName:""}var Rat=function(t){xI(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.allProductions=[],r}return e.prototype.visitNonTerminal=function(r){this.allProductions.push(r)},e.prototype.visitOption=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionWithSeparator=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionMandatory=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.allProductions.push(r)},e.prototype.visitRepetition=function(r){this.allProductions.push(r)},e.prototype.visitAlternation=function(r){this.allProductions.push(r)},e.prototype.visitTerminal=function(r){this.allProductions.push(r)},e}(Oc),ac=/^[a-zA-Z_]\w*$/,jJ=new RegExp(ac.source.replace("^","^\\$"));function Eat(t,e){var r=[],n=t.name;return n.match(ac)||r.push({message:e.buildInvalidRuleNameError({topLevelRule:t,expectedPattern:ac}),type:bn.INVALID_RULE_NAME,ruleName:n}),r}function Cat(t,e,r){var n=[],i;return e.name.match(jJ)||(i=r.buildInvalidNestedRuleNameError(t,e),n.push({message:i,type:bn.INVALID_NESTED_RULE_NAME,ruleName:t.name})),n}function _at(t,e){var r=[],n=t.name;return n.match(ac)||r.push({message:e.buildTokenNameError({tokenType:t,expectedPattern:ac}),type:bn.INVALID_TOKEN_NAME}),r}function Tat(t,e,r,n){var i=[],o=Nn(e,function(s,l){return l.name===t.name?s+1:s},0);if(o>1){var a=n.buildDuplicateRuleNameError({topLevelRule:t,grammarName:r});i.push({message:a,type:bn.DUPLICATE_RULE_NAME,ruleName:t.name})}return i}function Oat(t,e,r){var n=[],i;return ln(e,t)||(i="Invalid rule override, rule: ->"+t+"<- cannot be overridden in the grammar: ->"+r+"<-as it is not defined in any of the super grammars ",n.push({message:i,type:bn.INVALID_RULE_OVERRIDE,ruleName:t})),n}function WJ(t,e,r,n){n===void 0&&(n=[]);var i=[],o=T2(e.definition);if(Zt(o))return[];var a=t.name,s=ln(o,t);s&&i.push({message:r.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:n}),type:bn.LEFT_RECURSION,ruleName:a});var l=aR(o,n.concat([t])),u=Fe(l,function(c){var f=yi(n);return f.push(c),WJ(t,c,r,f)});return i.concat(gi(u))}function T2(t){var e=[];if(Zt(t))return e;var r=ro(t);if(r instanceof Pi)e.push(r.referencedRule);else if(r instanceof vi||r instanceof In||r instanceof io||r instanceof oo||r instanceof ki||r instanceof Ur)e=e.concat(T2(r.definition));else if(r instanceof $i)e=gi(Fe(r.definition,function(a){return T2(a.definition)}));else if(!(r instanceof Sr))throw Error("non exhaustive match");var n=sS(r),i=t.length>1;if(n&&i){var o=On(t);return e.concat(T2(o))}else return e}var II=function(t){xI(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.alternations=[],r}return e.prototype.visitAlternation=function(r){this.alternations.push(r)},e}(Oc);function Aat(t,e){var r=new II;t.accept(r);var n=r.alternations,i=Nn(n,function(o,a){var s=Nv(a.definition),l=Fe(s,function(u,c){var f=DJ([u],[],null,1);return Zt(f)?{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:a,emptyChoiceIdx:c}),type:bn.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:a.idx,alternative:c+1}:null});return o.concat(G1(l))},[]);return i}function xat(t,e,r,n){var i=new II;t.accept(i);var o=i.alternations,a=r[t.name];a&&(o=ic(o,function(l){return a[Eo(l)+(l.idx===0?"":l.idx)]})),o=ic(o,function(l){return l.ignoreAmbiguities===!0});var s=Nn(o,function(l,u){var c=u.idx,f=u.maxLookahead||e,h=OI(c,t,f,u),d=Pat(h,u,t,n),p=kat(h,u,t,n);return l.concat(d,p)},[]);return s}var Iat=function(t){xI(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.allProductions=[],r}return e.prototype.visitRepetitionWithSeparator=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionMandatory=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.allProductions.push(r)},e.prototype.visitRepetition=function(r){this.allProductions.push(r)},e}(Oc);function Mat(t,e){var r=new II;t.accept(r);var n=r.alternations,i=Nn(n,function(o,a){return a.definition.length>255&&o.push({message:e.buildTooManyAlternativesError({topLevelRule:t,alternation:a}),type:bn.TOO_MANY_ALTS,ruleName:t.name,occurrence:a.idx}),o},[]);return i}function Nat(t,e,r){var n=[];return Je(t,function(i){var o=new Iat;i.accept(o);var a=o.allProductions;Je(a,function(s){var l=cat(s),u=s.maxLookahead||e,c=s.idx,f=AI(c,i,l,u),h=f[0];if(Zt(gi(h))){var d=r.buildEmptyRepetitionError({topLevelRule:i,repetition:s});n.push({message:d,type:bn.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),n}function Pat(t,e,r,n){var i=[],o=Nn(t,function(s,l,u){return e.definition[u].ignoreAmbiguities===!0||Je(l,function(c){var f=[u];Je(t,function(h,d){u!==d&&OA(h,c)&&e.definition[d].ignoreAmbiguities!==!0&&f.push(d)}),f.length>1&&!OA(i,c)&&(i.push(c),s.push({alts:f,path:c}))}),s},[]),a=Fe(o,function(s){var l=Fe(s.alts,function(c){return c+1}),u=n.buildAlternationAmbiguityError({topLevelRule:r,alternation:e,ambiguityIndices:l,prefixPath:s.path});return{message:u,type:bn.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:e.idx,alternatives:[s.alts]}});return a}function kat(t,e,r,n){var i=[],o=Nn(t,function(a,s,l){var u=Fe(s,function(c){return{idx:l,path:c}});return a.concat(u)},[]);return Je(o,function(a){var s=e.definition[a.idx];if(s.ignoreAmbiguities!==!0){var l=a.idx,u=a.path,c=qit(o,function(h){return e.definition[h.idx].ignoreAmbiguities!==!0&&h.idx<l&&yat(h.path,u)}),f=Fe(c,function(h){var d=[h.idx+1,l+1],p=e.idx===0?"":e.idx,m=n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:e,ambiguityIndices:d,prefixPath:h.path});return{message:m,type:bn.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:p,alternatives:d}});i=i.concat(f)}}),i}function $at(t,e,r){var n=[],i=Fe(e,function(o){return o.name});return Je(t,function(o){var a=o.name;if(ln(i,a)){var s=r.buildNamespaceConflictError(o);n.push({message:s,type:bn.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:a})}}),n}function Lat(t,e){var r=[];return Je(t,function(n){var i=new TI("");n.accept(i);var o=RJ(i.result,function(s){return s.name}),a=uo(o,function(s){return s.length>1});Je(Fn(a),function(s){var l=Fe(s,function(c){return c.orgProd}),u=e.buildDuplicateNestedRuleNameError(n,l);r.push({message:u,type:bn.DUPLICATE_NESTED_NAME,ruleName:n.name})})}),r}var zJ={buildMismatchTokenMessage:function(t){var e=t.expected,r=t.actual;t.previous,t.ruleName;var n=kJ(e),i=n?"--> "+eh(e)+" <--":"token of type --> "+e.name+" <--",o="Expecting "+i+" but found --> '"+r.image+"' <--";return o},buildNotAllInputParsedMessage:function(t){var e=t.firstRedundant;return t.ruleName,"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(t){var e=t.expectedPathsPerAlt,r=t.actual;t.previous;var n=t.customUserDescription;t.ruleName;var i="Expecting: ",o=ro(r).image,a=`
but found: '`+o+"'";if(n)return i+n+a;var s=Nn(e,function(f,h){return f.concat(h)},[]),l=Fe(s,function(f){return"["+Fe(f,function(h){return eh(h)}).join(", ")+"]"}),u=Fe(l,function(f,h){return"  "+(h+1)+". "+f}),c=`one of these possible Token sequences:
`+u.join(`
`);return i+c+a},buildEarlyExitMessage:function(t){var e=t.expectedIterationPaths,r=t.actual,n=t.customUserDescription;t.ruleName;var i="Expecting: ",o=ro(r).image,a=`
but found: '`+o+"'";if(n)return i+n+a;var s=Fe(e,function(u){return"["+Fe(u,function(c){return eh(c)}).join(",")+"]"}),l=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+s.join(" ,")+">");return i+l+a}};Object.freeze(zJ);var Dat={buildRuleNotFoundError:function(t,e){var r="Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+t.name+"<-";return r}},MI={buildDuplicateFoundError:function(t,e){function r(c){return c instanceof Sr?c.terminalType.name:c instanceof Pi?c.nonTerminalName:""}var n=t.name,i=ro(e),o=i.idx,a=Eo(i),s=r(i),l=o>0,u="->"+a+(l?o:"")+"<- "+(s?"with argument: ->"+s+"<-":"")+`
                  appears more than once (`+e.length+" times) in the top level rule: ->"+n+`<-.                  
                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return u=u.replace(/[ \t]+/g," "),u=u.replace(/\s\s+/g,`
`),u},buildInvalidNestedRuleNameError:function(t,e){var r="Invalid nested rule name: ->"+e.name+"<- inside rule: ->"+t.name+`<-
`+("it must match the pattern: ->"+jJ.toString()+`<-.
`)+"Note that this means a nested rule name must start with the '$'(dollar) sign.";return r},buildDuplicateNestedRuleNameError:function(t,e){var r=ro(e).name,n="Duplicate nested rule name: ->"+r+"<- inside rule: ->"+t.name+`<-
A nested name must be unique in the scope of a top level grammar rule.`;return n},buildNamespaceConflictError:function(t){var e=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+t.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return e},buildAlternationPrefixAmbiguityError:function(t){var e=Fe(t.prefixPath,function(i){return eh(i)}).join(", "),r=t.alternation.idx===0?"":t.alternation.idx,n="Ambiguous alternatives: <"+t.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+r+"> inside <"+t.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`)+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return n},buildAlternationAmbiguityError:function(t){var e=Fe(t.prefixPath,function(i){return eh(i)}).join(", "),r=t.alternation.idx===0?"":t.alternation.idx,n="Ambiguous Alternatives Detected: <"+t.ambiguityIndices.join(" ,")+"> in <OR"+r+">"+(" inside <"+t.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`);return n=n+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,n},buildEmptyRepetitionError:function(t){var e=Eo(t.repetition);t.repetition.idx!==0&&(e+=t.repetition.idx);var r="The repetition <"+e+"> within Rule <"+t.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return r},buildTokenNameError:function(t){var e=t.tokenType.name,r="Invalid Grammar Token name: ->"+e+"<- it must match the pattern: ->"+t.expectedPattern.toString()+"<-";return r},buildEmptyAlternationError:function(t){var e="Ambiguous empty alternative: <"+(t.emptyChoiceIdx+1)+">"+(" in <OR"+t.alternation.idx+"> inside <"+t.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return e},buildTooManyAlternativesError:function(t){var e=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+t.alternation.idx+"> inside <"+t.topLevelRule.name+`> Rule.
 has `+(t.alternation.definition.length+1)+" alternatives.");return e},buildLeftRecursionError:function(t){var e=t.topLevelRule.name,r=Fe(t.leftRecursionPath,function(o){return o.name}),n=e+" --> "+r.concat([e]).join(" --> "),i=`Left Recursion found in grammar.
`+("rule: <"+e+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+n+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return i},buildInvalidRuleNameError:function(t){var e=t.topLevelRule.name,r=t.expectedPattern.toString(),n="Invalid grammar rule name: ->"+e+"<- it must match the pattern: ->"+r+"<-";return n},buildDuplicateRuleNameError:function(t){var e;t.topLevelRule instanceof Yp?e=t.topLevelRule.name:e=t.topLevelRule;var r="Duplicate definition, rule: ->"+e+"<- is already defined in the grammar: ->"+t.grammarName+"<-";return r}},Fat=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();function Hat(t,e){var r=new Bat(t,e);return r.resolveRefs(),r.errors}var Bat=function(t){Fat(e,t);function e(r,n){var i=t.call(this)||this;return i.nameToTopRule=r,i.errMsgProvider=n,i.errors=[],i}return e.prototype.resolveRefs=function(){var r=this;Je(Fn(this.nameToTopRule),function(n){r.currTopLevel=n,n.accept(r)})},e.prototype.visitNonTerminal=function(r){var n=this.nameToTopRule[r.nonTerminalName];if(n)r.referencedRule=n;else{var i=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,r);this.errors.push({message:i,type:bn.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:r.nonTerminalName})}},e}(Oc);function Uat(t){t=sR(t,{errMsgProvider:Dat});var e={};return Je(t.rules,function(r){e[r.name]=r}),Hat(e,t.errMsgProvider)}function Vat(t){return t=sR(t,{errMsgProvider:MI,ignoredIssues:{}}),vat(t.rules,t.maxLookahead,t.tokenTypes,t.ignoredIssues,t.errMsgProvider,t.grammarName)}var GJ="MismatchedTokenException",YJ="NoViableAltException",KJ="EarlyExitException",qJ="NotAllInputParsedException",XJ=[GJ,YJ,KJ,qJ];Object.freeze(XJ);function uS(t){return ln(XJ,t.name)}function NI(t,e,r){this.name=GJ,this.message=t,this.token=e,this.previousToken=r,this.resyncedTokens=[]}NI.prototype=Error.prototype;function QJ(t,e,r){this.name=YJ,this.message=t,this.token=e,this.previousToken=r,this.resyncedTokens=[]}QJ.prototype=Error.prototype;function ZJ(t,e){this.name=qJ,this.message=t,this.token=e,this.resyncedTokens=[]}ZJ.prototype=Error.prototype;function JJ(t,e,r){this.name=KJ,this.message=t,this.token=e,this.previousToken=r,this.resyncedTokens=[]}JJ.prototype=Error.prototype;var YC={},eee="InRuleRecoveryException";function tee(t){this.name=eee,this.message=t}tee.prototype=Error.prototype;var jat=function(){function t(){}return t.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Ze(e,"recoveryEnabled")?e.recoveryEnabled:fi.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=Wat)},t.prototype.getTokenToInsert=function(e){var r=_I(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return r.isInsertedInRecovery=!0,r},t.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},t.prototype.tryInRepetitionRecovery=function(e,r,n,i){for(var o=this,a=this.findReSyncTokenType(),s=this.exportLexerState(),l=[],u=!1,c=this.LA(1),f=this.LA(1),h=function(){var d=o.LA(0),p=o.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:c,previous:d,ruleName:o.getCurrRuleFullName()}),m=new NI(p,c,o.LA(0));m.resyncedTokens=Nv(l),o.SAVE_ERROR(m)};!u;)if(this.tokenMatcher(f,i)){h();return}else if(n.call(this)){h(),e.apply(this,r);return}else this.tokenMatcher(f,a)?u=!0:(f=this.SKIP_TOKEN(),this.addToResyncTokens(f,l));this.importLexerState(s)},t.prototype.shouldInRepetitionRecoveryBeTried=function(e,r,n){return!(n===!1||e===void 0||r===void 0||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,r)))},t.prototype.getFollowsForInRuleRecovery=function(e,r){var n=this.getCurrentGrammarPath(e,r),i=this.getNextPossibleTokenTypes(n);return i},t.prototype.tryInRuleRecovery=function(e,r){if(this.canRecoverWithSingleTokenInsertion(e,r)){var n=this.getTokenToInsert(e);return n}if(this.canRecoverWithSingleTokenDeletion(e)){var i=this.SKIP_TOKEN();return this.consumeToken(),i}throw new tee("sad sad panda")},t.prototype.canPerformInRuleRecovery=function(e,r){return this.canRecoverWithSingleTokenInsertion(e,r)||this.canRecoverWithSingleTokenDeletion(e)},t.prototype.canRecoverWithSingleTokenInsertion=function(e,r){var n=this;if(!this.canTokenTypeBeInsertedInRecovery(e)||Zt(r))return!1;var i=this.LA(1),o=yp(r,function(a){return n.tokenMatcher(i,a)})!==void 0;return o},t.prototype.canRecoverWithSingleTokenDeletion=function(e){var r=this.tokenMatcher(this.LA(2),e);return r},t.prototype.isInCurrentRuleReSyncSet=function(e){var r=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(r);return ln(n,e)},t.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),r=this.LA(1),n=2;;){var i=r.tokenType;if(ln(e,i))return i;r=this.LA(n),n++}},t.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return YC;var e=this.getLastExplicitRuleShortName(),r=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:r,inRule:this.shortRuleNameToFullName(n)}},t.prototype.buildFullFollowKeyStack=function(){var e=this,r=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return Zt(this.LAST_EXPLICIT_RULE_STACK)||(r=Fe(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_STACK[i]}),n=Fe(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_OCCURRENCE_STACK[i]})),Fe(r,function(i,o){return o===0?YC:{ruleName:e.shortRuleNameToFullName(i),idxInCallingRule:n[o],inRule:e.shortRuleNameToFullName(r[o-1])}})},t.prototype.flattenFollowSet=function(){var e=this,r=Fe(this.buildFullFollowKeyStack(),function(n){return e.getFollowSetFromFollowKey(n)});return gi(r)},t.prototype.getFollowSetFromFollowKey=function(e){if(e===YC)return[oc];var r=e.ruleName+e.idxInCallingRule+$J+e.inRule;return this.resyncFollows[r]},t.prototype.addToResyncTokens=function(e,r){return this.tokenMatcher(e,oc)||r.push(e),r},t.prototype.reSyncTo=function(e){for(var r=[],n=this.LA(1);this.tokenMatcher(n,e)===!1;)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,r);return Nv(r)},t.prototype.attemptInRepetitionRecovery=function(e,r,n,i,o,a,s){},t.prototype.getCurrentGrammarPath=function(e,r){var n=this.getHumanReadableRuleStack(),i=yi(this.RULE_OCCURRENCE_STACK),o={ruleStack:n,occurrenceStack:i,lastTok:e,lastTokOccurrence:r};return o},t.prototype.getHumanReadableRuleStack=function(){var e=this;return Zt(this.LAST_EXPLICIT_RULE_STACK)?Fe(this.RULE_STACK,function(r){return e.shortRuleNameToFullName(r)}):Fe(this.LAST_EXPLICIT_RULE_STACK,function(r){return e.shortRuleNameToFullName(e.RULE_STACK[r])})},t}();function Wat(t,e,r,n,i,o,a){var s=this.getKeyForAutomaticLookahead(n,i),l=this.firstAfterRepMap[s];if(l===void 0){var u=this.getCurrRuleFullName(),c=this.getGAstProductions()[u],f=new o(c,i);l=f.startWalking(),this.firstAfterRepMap[s]=l}var h=l.token,d=l.occurrence,p=l.isEndOfRule;this.RULE_STACK.length===1&&p&&h===void 0&&(h=oc,d=1),this.shouldInRepetitionRecoveryBeTried(h,d,a)&&this.tryInRepetitionRecovery(t,e,r,h)}var zat=function(){function t(){}return t.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=Ze(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:fi.dynamicTokensEnabled,this.maxLookahead=Ze(e,"maxLookahead")?e.maxLookahead:fi.maxLookahead,this.lookAheadFuncsCache=fV()?new Map:[],fV()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},t.prototype.preComputeLookaheadFunctions=function(e){var r=this;Je(e,function(n){r.TRACE_INIT(n.name+" Rule Lookahead",function(){var i=zot(n),o=i.alternation,a=i.repetition,s=i.option,l=i.repetitionMandatory,u=i.repetitionMandatoryWithSeparator,c=i.repetitionWithSeparator;Je(o,function(f){var h=f.idx===0?"":f.idx;r.TRACE_INIT(""+Eo(f)+h,function(){var d=fat(f.idx,n,f.maxLookahead||r.maxLookahead,f.hasPredicates,r.dynamicTokensEnabled,r.lookAheadBuilderForAlternatives),p=dg(r.fullRuleNameToShort[n.name],th,f.idx);r.setLaFuncCache(p,d)})}),Je(a,function(f){r.computeLookaheadFunc(n,f.idx,cg,rr.REPETITION,f.maxLookahead,Eo(f))}),Je(s,function(f){r.computeLookaheadFunc(n,f.idx,lS,rr.OPTION,f.maxLookahead,Eo(f))}),Je(l,function(f){r.computeLookaheadFunc(n,f.idx,fg,rr.REPETITION_MANDATORY,f.maxLookahead,Eo(f))}),Je(u,function(f){r.computeLookaheadFunc(n,f.idx,$f,rr.REPETITION_MANDATORY_WITH_SEPARATOR,f.maxLookahead,Eo(f))}),Je(c,function(f){r.computeLookaheadFunc(n,f.idx,hg,rr.REPETITION_WITH_SEPARATOR,f.maxLookahead,Eo(f))})})})},t.prototype.computeLookaheadFunc=function(e,r,n,i,o,a){var s=this;this.TRACE_INIT(""+a+(r===0?"":r),function(){var l=hat(r,e,o||s.maxLookahead,s.dynamicTokensEnabled,i,s.lookAheadBuilderForOptional),u=dg(s.fullRuleNameToShort[e.name],n,r);s.setLaFuncCache(u,l)})},t.prototype.lookAheadBuilderForOptional=function(e,r,n){return pat(e,r,n)},t.prototype.lookAheadBuilderForAlternatives=function(e,r,n,i){return dat(e,r,n,i)},t.prototype.getKeyForAutomaticLookahead=function(e,r){var n=this.getLastExplicitRuleShortName();return dg(n,e,r)},t.prototype.getLaFuncFromCache=function(e){},t.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},t.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},t.prototype.setLaFuncCache=function(e,r){},t.prototype.setLaFuncCacheUsingMap=function(e,r){this.lookAheadFuncsCache.set(e,r)},t.prototype.setLaFuncUsingObj=function(e,r){this.lookAheadFuncsCache[e]=r},t}();function Gat(t){return hR(t.constructor)}var Yat=/^\s*function\s*(\S*)\s*\(/,NV="name";function hR(t){var e=t.name;if(e)return e;var r=t.toString().match(Yat)[1];return r}function ree(t,e){var r=Object.getOwnPropertyDescriptor(t,NV);return no(r)||r.configurable?(Object.defineProperty(t,NV,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0):!1}function Kat(t,e){for(var r=As(t),n=r.length,i=0;i<n;i++)for(var o=r[i],a=t[o],s=a.length,l=0;l<s;l++){var u=a[l];u.tokenTypeIdx===void 0&&(u.fullName!==void 0?this[u.fullName](u.children,e):this[u.name](u.children,e))}}function qat(t,e){var r=function(){};ree(r,t+"BaseSemantics");var n={visit:function(i,o){if(Oo(i)&&(i=i[0]),!no(i))return i.fullName!==void 0?this[i.fullName](i.children,o):this[i.name](i.children,o)},validateVisitor:function(){var i=Qat(this,e);if(!Zt(i)){var o=Fe(i,function(a){return a.msg});throw Error("Errors Detected in CST Visitor <"+hR(this.constructor)+`>:
	`+(""+o.join(`

`).replace(/\n/g,`
	`)))}}};return r.prototype=n,r.prototype.constructor=r,r._RULE_NAMES=e,r}function Xat(t,e,r){var n=function(){};ree(n,t+"BaseSemanticsWithDefaults");var i=Object.create(r.prototype);return Je(e,function(o){i[o]=Kat}),n.prototype=i,n.prototype.constructor=n,n}var cS;(function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"})(cS||(cS={}));function Qat(t,e){var r=Zat(t,e),n=est(t,e);return r.concat(n)}function Zat(t,e){var r=Fe(e,function(n){if(!_l(t[n]))return{msg:"Missing visitor method: <"+n+"> on "+hR(t.constructor)+" CST Visitor.",type:cS.MISSING_METHOD,methodName:n}});return G1(r)}var Jat=["constructor","visit","validateVisitor"];function est(t,e){var r=[];for(var n in t)ac.test(n)&&_l(t[n])&&!ln(Jat,n)&&!ln(e,n)&&r.push({msg:"Redundant visitor method: <"+n+"> on "+hR(t.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`+("For utility methods on visitor classes use methods names that do not match /"+ac.source+"/."),type:cS.REDUNDANT_METHOD,methodName:n});return r}var tst=function(){function t(){}return t.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=Ze(e,"outputCst")?e.outputCst:fi.outputCst,this.nodeLocationTracking=Ze(e,"nodeLocationTracking")?e.nodeLocationTracking:fi.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=cn,this.cstFinallyStateUpdate=cn,this.cstPostTerminal=cn,this.cstPostNonTerminal=cn,this.cstPostRule=cn,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=OV,this.setNodeLocationFromNode=OV,this.cstPostRule=cn,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=cn,this.setNodeLocationFromNode=cn,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=TV,this.setNodeLocationFromNode=TV,this.cstPostRule=cn,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=cn,this.setNodeLocationFromNode=cn,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=cn,this.setNodeLocationFromNode=cn,this.cstPostRule=cn,this.setInitialNodeLocation=cn;else throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"')},t.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},t.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},t.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.setInitialNodeLocationFullRegular=function(e){var r=this.LA(1);e.location={startOffset:r.startOffset,startLine:r.startLine,startColumn:r.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.cstNestedInvocationStateUpdate=function(e,r){var n={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},t.prototype.cstInvocationStateUpdate=function(e,r){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var n={name:e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},t.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},t.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},t.prototype.cstPostRuleFull=function(e){var r=this.LA(0),n=e.location;n.startOffset<=r.startOffset?(n.endOffset=r.endOffset,n.endLine=r.endLine,n.endColumn=r.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},t.prototype.cstPostRuleOnlyOffset=function(e){var r=this.LA(0),n=e.location;n.startOffset<=r.startOffset?n.endOffset=r.endOffset:n.startOffset=NaN},t.prototype.cstPostTerminal=function(e,r){var n=this.CST_STACK[this.CST_STACK.length-1];nat(n,r,e),this.setNodeLocationFromToken(n.location,r)},t.prototype.cstPostNonTerminal=function(e,r){if(this.isBackTracking()!==!0){var n=this.CST_STACK[this.CST_STACK.length-1];AV(n,r,e),this.setNodeLocationFromNode(n.location,e.location)}},t.prototype.getBaseCstVisitorConstructor=function(){if(no(this.baseCstVisitorConstructor)){var e=qat(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},t.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(no(this.baseCstVisitorWithDefaultsConstructor)){var e=Xat(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},t.prototype.nestedRuleBeforeClause=function(e,r){var n;if(e.NAME!==void 0)return n=e.NAME,this.nestedRuleInvocationStateUpdate(n,r),n},t.prototype.nestedAltBeforeClause=function(e,r,n,i){var o=this.getLastExplicitRuleShortName(),a=LJ(o,n,r,i),s;if(e.NAME!==void 0)return s=e.NAME,this.nestedRuleInvocationStateUpdate(s,a),{shortName:a,nestedName:s}},t.prototype.nestedRuleFinallyClause=function(e,r){var n=this.CST_STACK,i=n[n.length-1];this.nestedRuleFinallyStateUpdate();var o=n[n.length-1];AV(o,r,i),this.setNodeLocationFromNode(o.location,i.location)},t.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},t.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},t.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},t.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},t.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},t.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},t.prototype.nestedRuleInvocationStateUpdate=function(e,r){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(r),this.cstNestedInvocationStateUpdate(e,r)},t.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},t}(),rst=function(){function t(){}return t.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(t.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),t.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):hS},t.prototype.LA=function(e){var r=this.currIdx+e;return r<0||this.tokVectorLength<=r?hS:this.tokVector[r]},t.prototype.consumeToken=function(){this.currIdx++},t.prototype.exportLexerState=function(){return this.currIdx},t.prototype.importLexerState=function(e){this.currIdx=e},t.prototype.resetLexerState=function(){this.currIdx=-1},t.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},t.prototype.getLexerPosition=function(){return this.exportLexerState()},t}(),nst=function(){function t(){}return t.prototype.ACTION=function(e){return e.call(this)},t.prototype.consume=function(e,r,n){return this.consumeInternal(r,e,n)},t.prototype.subrule=function(e,r,n){return this.subruleInternal(r,e,n)},t.prototype.option=function(e,r){return this.optionInternal(r,e)},t.prototype.or=function(e,r){return this.orInternal(r,e)},t.prototype.many=function(e,r){return this.manyInternal(e,r)},t.prototype.atLeastOne=function(e,r){return this.atLeastOneInternal(e,r)},t.prototype.CONSUME=function(e,r){return this.consumeInternal(e,0,r)},t.prototype.CONSUME1=function(e,r){return this.consumeInternal(e,1,r)},t.prototype.CONSUME2=function(e,r){return this.consumeInternal(e,2,r)},t.prototype.CONSUME3=function(e,r){return this.consumeInternal(e,3,r)},t.prototype.CONSUME4=function(e,r){return this.consumeInternal(e,4,r)},t.prototype.CONSUME5=function(e,r){return this.consumeInternal(e,5,r)},t.prototype.CONSUME6=function(e,r){return this.consumeInternal(e,6,r)},t.prototype.CONSUME7=function(e,r){return this.consumeInternal(e,7,r)},t.prototype.CONSUME8=function(e,r){return this.consumeInternal(e,8,r)},t.prototype.CONSUME9=function(e,r){return this.consumeInternal(e,9,r)},t.prototype.SUBRULE=function(e,r){return this.subruleInternal(e,0,r)},t.prototype.SUBRULE1=function(e,r){return this.subruleInternal(e,1,r)},t.prototype.SUBRULE2=function(e,r){return this.subruleInternal(e,2,r)},t.prototype.SUBRULE3=function(e,r){return this.subruleInternal(e,3,r)},t.prototype.SUBRULE4=function(e,r){return this.subruleInternal(e,4,r)},t.prototype.SUBRULE5=function(e,r){return this.subruleInternal(e,5,r)},t.prototype.SUBRULE6=function(e,r){return this.subruleInternal(e,6,r)},t.prototype.SUBRULE7=function(e,r){return this.subruleInternal(e,7,r)},t.prototype.SUBRULE8=function(e,r){return this.subruleInternal(e,8,r)},t.prototype.SUBRULE9=function(e,r){return this.subruleInternal(e,9,r)},t.prototype.OPTION=function(e){return this.optionInternal(e,0)},t.prototype.OPTION1=function(e){return this.optionInternal(e,1)},t.prototype.OPTION2=function(e){return this.optionInternal(e,2)},t.prototype.OPTION3=function(e){return this.optionInternal(e,3)},t.prototype.OPTION4=function(e){return this.optionInternal(e,4)},t.prototype.OPTION5=function(e){return this.optionInternal(e,5)},t.prototype.OPTION6=function(e){return this.optionInternal(e,6)},t.prototype.OPTION7=function(e){return this.optionInternal(e,7)},t.prototype.OPTION8=function(e){return this.optionInternal(e,8)},t.prototype.OPTION9=function(e){return this.optionInternal(e,9)},t.prototype.OR=function(e){return this.orInternal(e,0)},t.prototype.OR1=function(e){return this.orInternal(e,1)},t.prototype.OR2=function(e){return this.orInternal(e,2)},t.prototype.OR3=function(e){return this.orInternal(e,3)},t.prototype.OR4=function(e){return this.orInternal(e,4)},t.prototype.OR5=function(e){return this.orInternal(e,5)},t.prototype.OR6=function(e){return this.orInternal(e,6)},t.prototype.OR7=function(e){return this.orInternal(e,7)},t.prototype.OR8=function(e){return this.orInternal(e,8)},t.prototype.OR9=function(e){return this.orInternal(e,9)},t.prototype.MANY=function(e){this.manyInternal(0,e)},t.prototype.MANY1=function(e){this.manyInternal(1,e)},t.prototype.MANY2=function(e){this.manyInternal(2,e)},t.prototype.MANY3=function(e){this.manyInternal(3,e)},t.prototype.MANY4=function(e){this.manyInternal(4,e)},t.prototype.MANY5=function(e){this.manyInternal(5,e)},t.prototype.MANY6=function(e){this.manyInternal(6,e)},t.prototype.MANY7=function(e){this.manyInternal(7,e)},t.prototype.MANY8=function(e){this.manyInternal(8,e)},t.prototype.MANY9=function(e){this.manyInternal(9,e)},t.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},t.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},t.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},t.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},t.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},t.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},t.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},t.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},t.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},t.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},t.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},t.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},t.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},t.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},t.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},t.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},t.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},t.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},t.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},t.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},t.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},t.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},t.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},t.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},t.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},t.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},t.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},t.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},t.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},t.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},t.prototype.RULE=function(e,r,n){if(n===void 0&&(n=dS),ln(this.definedRulesNames,e)){var i=MI.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),o={message:i,type:bn.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(o)}this.definedRulesNames.push(e);var a=this.defineRule(e,r,n);return this[e]=a,a},t.prototype.OVERRIDE_RULE=function(e,r,n){n===void 0&&(n=dS);var i=[];i=i.concat(Oat(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,i);var o=this.defineRule(e,r,n);return this[e]=o,o},t.prototype.BACKTRACK=function(e,r){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return e.apply(this,r),!0}catch(i){if(uS(i))return!1;throw i}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},t.prototype.getGAstProductions=function(){return this.gastProductionsCache},t.prototype.getSerializedGastProductions=function(){return Bot(Fn(this.gastProductionsCache))},t}(),ist=function(){function t(){}return t.prototype.initRecognizerEngine=function(e,r){if(this.className=Gat(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=aS,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Ze(r,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(Oo(e)){if(Zt(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(Oo(e))this.tokensMap=Nn(e,function(a,s){return a[s.name]=s,a},{});else if(Ze(e,"modes")&&Ji(gi(Fn(e.modes)),Lot)){var n=gi(Fn(e.modes)),i=SI(n);this.tokensMap=Nn(i,function(a,s){return a[s.name]=s,a},{})}else if(RI(e))this.tokensMap=z1(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=oc;var o=Ji(Fn(e),function(a){return Zt(a.categoryMatches)});this.tokenMatcher=o?aS:uR,Y1(Fn(this.tokensMap))},t.prototype.defineRule=function(e,r,n){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var i=Ze(n,"resyncEnabled")?n.resyncEnabled:dS.resyncEnabled,o=Ze(n,"recoveryValueFunc")?n.recoveryValueFunc:dS.recoveryValueFunc,a=this.ruleShortNameIdx<<Jot+Tl;this.ruleShortNameIdx++,this.shortRuleNameToFull[a]=e,this.fullRuleNameToShort[e]=a;function s(c){try{if(this.outputCst===!0){r.apply(this,c);var f=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(f),f}else return r.apply(this,c)}catch(h){return this.invokeRuleCatch(h,i,o)}finally{this.ruleFinallyStateUpdate()}}var l;l=function(c,f){return c===void 0&&(c=0),this.ruleInvocationStateUpdate(a,e,c),s.call(this,f)};var u="ruleName";return l[u]=e,l.originalGrammarAction=r,l},t.prototype.invokeRuleCatch=function(e,r,n){var i=this.RULE_STACK.length===1,o=r&&!this.isBackTracking()&&this.recoveryEnabled;if(uS(e)){var a=e;if(o){var s=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(s))if(a.resyncedTokens=this.reSyncTo(s),this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];return l.recoveredNode=!0,l}else return n();else{if(this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];l.recoveredNode=!0,a.partialCstResult=l}throw a}}else{if(i)return this.moveToTerminatedState(),n();throw a}}else throw e},t.prototype.optionInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(lS,r),i=this.nestedRuleBeforeClause(e,n);try{return this.optionInternalLogic(e,r,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.optionInternalNoCst=function(e,r){var n=this.getKeyForAutomaticLookahead(lS,r);return this.optionInternalLogic(e,r,n)},t.prototype.optionInternalLogic=function(e,r,n){var i=this,o=this.getLaFuncFromCache(n),a,s;if(e.DEF!==void 0){if(a=e.DEF,s=e.GATE,s!==void 0){var l=o;o=function(){return s.call(i)&&l.call(i)}}}else a=e;if(o.call(this)===!0)return a.call(this)},t.prototype.atLeastOneInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(fg,e),i=this.nestedRuleBeforeClause(r,n);try{return this.atLeastOneInternalLogic(e,r,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.atLeastOneInternalNoCst=function(e,r){var n=this.getKeyForAutomaticLookahead(fg,e);this.atLeastOneInternalLogic(e,r,n)},t.prototype.atLeastOneInternalLogic=function(e,r,n){var i=this,o=this.getLaFuncFromCache(n),a,s;if(r.DEF!==void 0){if(a=r.DEF,s=r.GATE,s!==void 0){var l=o;o=function(){return s.call(i)&&l.call(i)}}}else a=r;if(o.call(this)===!0)for(var u=this.doSingleRepetition(a);o.call(this)===!0&&u===!0;)u=this.doSingleRepetition(a);else throw this.raiseEarlyExitException(e,rr.REPETITION_MANDATORY,r.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,r],o,fg,e,lat)},t.prototype.atLeastOneSepFirstInternal=function(e,r){var n=this.getKeyForAutomaticLookahead($f,e),i=this.nestedRuleBeforeClause(r,n);try{this.atLeastOneSepFirstInternalLogic(e,r,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.atLeastOneSepFirstInternalNoCst=function(e,r){var n=this.getKeyForAutomaticLookahead($f,e);this.atLeastOneSepFirstInternalLogic(e,r,n)},t.prototype.atLeastOneSepFirstInternalLogic=function(e,r,n){var i=this,o=r.DEF,a=r.SEP,s=this.getLaFuncFromCache(n);if(s.call(this)===!0){o.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),a)};this.tokenMatcher(this.LA(1),a)===!0;)this.CONSUME(a),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,a,l,o,IV],l,$f,e,IV)}else throw this.raiseEarlyExitException(e,rr.REPETITION_MANDATORY_WITH_SEPARATOR,r.ERR_MSG)},t.prototype.manyInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(cg,e),i=this.nestedRuleBeforeClause(r,n);try{return this.manyInternalLogic(e,r,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.manyInternalNoCst=function(e,r){var n=this.getKeyForAutomaticLookahead(cg,e);return this.manyInternalLogic(e,r,n)},t.prototype.manyInternalLogic=function(e,r,n){var i=this,o=this.getLaFuncFromCache(n),a,s;if(r.DEF!==void 0){if(a=r.DEF,s=r.GATE,s!==void 0){var l=o;o=function(){return s.call(i)&&l.call(i)}}}else a=r;for(var u=!0;o.call(this)===!0&&u===!0;)u=this.doSingleRepetition(a);this.attemptInRepetitionRecovery(this.manyInternal,[e,r],o,cg,e,sat,u)},t.prototype.manySepFirstInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(hg,e),i=this.nestedRuleBeforeClause(r,n);try{this.manySepFirstInternalLogic(e,r,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.manySepFirstInternalNoCst=function(e,r){var n=this.getKeyForAutomaticLookahead(hg,e);this.manySepFirstInternalLogic(e,r,n)},t.prototype.manySepFirstInternalLogic=function(e,r,n){var i=this,o=r.DEF,a=r.SEP,s=this.getLaFuncFromCache(n);if(s.call(this)===!0){o.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),a)};this.tokenMatcher(this.LA(1),a)===!0;)this.CONSUME(a),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,a,l,o,xV],l,hg,e,xV)}},t.prototype.repetitionSepSecondInternal=function(e,r,n,i,o){for(;n();)this.CONSUME(r),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,r,n,i,o],n,$f,e,o)},t.prototype.doSingleRepetition=function(e){var r=this.getLexerPosition();e.call(this);var n=this.getLexerPosition();return n>r},t.prototype.orInternalNoCst=function(e,r){var n=Oo(e)?e:e.DEF,i=this.getKeyForAutomaticLookahead(th,r),o=this.getLaFuncFromCache(i),a=o.call(this,n);if(a!==void 0){var s=n[a];return s.ALT.call(this)}this.raiseNoAltException(r,e.ERR_MSG)},t.prototype.orInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(th,r),i=this.nestedRuleBeforeClause(e,n);try{var o=Oo(e)?e:e.DEF,a=this.getLaFuncFromCache(n),s=a.call(this,o);if(s!==void 0){var l=o[s],u=this.nestedAltBeforeClause(l,r,th,s);try{return l.ALT.call(this)}finally{u!==void 0&&this.nestedRuleFinallyClause(u.shortName,u.nestedName)}}this.raiseNoAltException(r,e.ERR_MSG)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},t.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var e=this.LA(1),r=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new ZJ(r,e))}},t.prototype.subruleInternal=function(e,r,n){var i;try{var o=n!==void 0?n.ARGS:void 0;return i=e.call(this,r,o),this.cstPostNonTerminal(i,n!==void 0&&n.LABEL!==void 0?n.LABEL:e.ruleName),i}catch(a){this.subruleInternalError(a,n,e.ruleName)}},t.prototype.subruleInternalError=function(e,r,n){throw uS(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,r!==void 0&&r.LABEL!==void 0?r.LABEL:n),delete e.partialCstResult),e},t.prototype.consumeInternal=function(e,r,n){var i;try{var o=this.LA(1);this.tokenMatcher(o,e)===!0?(this.consumeToken(),i=o):this.consumeInternalError(e,o,n)}catch(a){i=this.consumeInternalRecovery(e,r,a)}return this.cstPostTerminal(n!==void 0&&n.LABEL!==void 0?n.LABEL:e.name,i),i},t.prototype.consumeInternalError=function(e,r,n){var i,o=this.LA(0);throw n!==void 0&&n.ERR_MSG?i=n.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:r,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new NI(i,r,o))},t.prototype.consumeInternalRecovery=function(e,r,n){if(this.recoveryEnabled&&n.name==="MismatchedTokenException"&&!this.isBackTracking()){var i=this.getFollowsForInRuleRecovery(e,r);try{return this.tryInRuleRecovery(e,i)}catch(o){throw o.name===eee?n:o}}else throw n},t.prototype.saveRecogState=function(){var e=this.errors,r=yi(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:r,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},t.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},t.prototype.ruleInvocationStateUpdate=function(e,r,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(r,e)},t.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},t.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},t.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},t.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),oc)},t.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},t}(),ost=function(){function t(){}return t.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=sR(e.errorMessageProvider,fi.errorMessageProvider)},t.prototype.SAVE_ERROR=function(e){if(uS(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:yi(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(t.prototype,"errors",{get:function(){return yi(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),t.prototype.raiseEarlyExitException=function(e,r,n){for(var i=this.getCurrRuleFullName(),o=this.getGAstProductions()[i],a=AI(e,o,r,this.maxLookahead),s=a[0],l=[],u=1;u<=this.maxLookahead;u++)l.push(this.LA(u));var c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:s,actual:l,previous:this.LA(0),customUserDescription:n,ruleName:i});throw this.SAVE_ERROR(new JJ(c,this.LA(1),this.LA(0)))},t.prototype.raiseNoAltException=function(e,r){for(var n=this.getCurrRuleFullName(),i=this.getGAstProductions()[n],o=OI(e,i,this.maxLookahead),a=[],s=1;s<=this.maxLookahead;s++)a.push(this.LA(s));var l=this.LA(0),u=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:o,actual:a,previous:l,customUserDescription:r,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new QJ(u,this.LA(1),l))},t}(),ast=function(){function t(){}return t.prototype.initContentAssist=function(){},t.prototype.computeContentAssist=function(e,r){var n=this.gastProductionsCache[e];if(no(n))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return DJ([n],r,this.tokenMatcher,this.maxLookahead)},t.prototype.getNextPossibleTokenTypes=function(e){var r=ro(e.ruleStack),n=this.getGAstProductions(),i=n[r],o=new aat(i,e).startWalking();return o},t}(),dR={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(dR);var PV=!0,kV=Math.pow(2,Tl)-1,nee=Pt({name:"RECORDING_PHASE_TOKEN",pattern:mi.NA});Y1([nee]);var iee=_I(nee,`This IToken indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(iee);var sst={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,children:{}},lst=function(){function t(){}return t.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},t.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var r=function(i){var o=i>0?i:"";e["CONSUME"+o]=function(a,s){return this.consumeInternalRecord(a,i,s)},e["SUBRULE"+o]=function(a,s){return this.subruleInternalRecord(a,i,s)},e["OPTION"+o]=function(a){return this.optionInternalRecord(a,i)},e["OR"+o]=function(a){return this.orInternalRecord(a,i)},e["MANY"+o]=function(a){this.manyInternalRecord(i,a)},e["MANY_SEP"+o]=function(a){this.manySepFirstInternalRecord(i,a)},e["AT_LEAST_ONE"+o]=function(a){this.atLeastOneInternalRecord(i,a)},e["AT_LEAST_ONE_SEP"+o]=function(a){this.atLeastOneSepFirstInternalRecord(i,a)}},n=0;n<10;n++)r(n);e.consume=function(i,o,a){return this.consumeInternalRecord(o,i,a)},e.subrule=function(i,o,a){return this.subruleInternalRecord(o,i,a)},e.option=function(i,o){return this.optionInternalRecord(o,i)},e.or=function(i,o){return this.orInternalRecord(o,i)},e.many=function(i,o){this.manyInternalRecord(i,o)},e.atLeastOne=function(i,o){this.atLeastOneInternalRecord(i,o)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},t.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var r=0;r<10;r++){var n=r>0?r:"";delete e["CONSUME"+n],delete e["SUBRULE"+n],delete e["OPTION"+n],delete e["OR"+n],delete e["MANY"+n],delete e["MANY_SEP"+n],delete e["AT_LEAST_ONE"+n],delete e["AT_LEAST_ONE_SEP"+n]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})},t.prototype.ACTION_RECORD=function(e){},t.prototype.BACKTRACK_RECORD=function(e,r){return function(){return!0}},t.prototype.LA_RECORD=function(e){return hS},t.prototype.topLevelRuleRecord=function(e,r){try{var n=new Yp({definition:[],name:e});return n.name=e,this.recordingProdStack.push(n),r.call(this),this.recordingProdStack.pop(),n}catch(i){if(i.KNOWN_RECORDER_ERROR!==!0)try{i.message=i.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording`}catch{throw i}throw i}},t.prototype.optionInternalRecord=function(e,r){return Am.call(this,In,e,r)},t.prototype.atLeastOneInternalRecord=function(e,r){Am.call(this,io,r,e)},t.prototype.atLeastOneSepFirstInternalRecord=function(e,r){Am.call(this,oo,r,e,PV)},t.prototype.manyInternalRecord=function(e,r){Am.call(this,Ur,r,e)},t.prototype.manySepFirstInternalRecord=function(e,r){Am.call(this,ki,r,e,PV)},t.prototype.orInternalRecord=function(e,r){return ust.call(this,e,r)},t.prototype.subruleInternalRecord=function(e,r,n){if(fS(r),!e||Ze(e,"ruleName")===!1){var i=new Error("<SUBRULE"+$V(r)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var o=iS(this.recordingProdStack),a=e.ruleName,s=new Pi({idx:r,nonTerminalName:a,referencedRule:void 0});return o.definition.push(s),this.outputCst?sst:dR},t.prototype.consumeInternalRecord=function(e,r,n){if(fS(r),!PJ(e)){var i=new Error("<CONSUME"+$V(r)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var o=iS(this.recordingProdStack),a=new Sr({idx:r,terminalType:e});return o.definition.push(a),iee},t}();function Am(t,e,r,n){n===void 0&&(n=!1),fS(r);var i=iS(this.recordingProdStack),o=_l(e)?e:e.DEF,a=new t({definition:[],idx:r});return Ze(e,"NAME")&&(a.name=e.NAME),n&&(a.separator=e.SEP),Ze(e,"MAX_LOOKAHEAD")&&(a.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(a),o.call(this),i.definition.push(a),this.recordingProdStack.pop(),dR}function ust(t,e){var r=this;fS(e);var n=iS(this.recordingProdStack),i=Oo(t)===!1,o=i===!1?t:t.DEF,a=new $i({definition:[],idx:e,ignoreAmbiguities:i&&t.IGNORE_AMBIGUITIES===!0});Ze(t,"NAME")&&(a.name=t.NAME),Ze(t,"MAX_LOOKAHEAD")&&(a.maxLookahead=t.MAX_LOOKAHEAD);var s=SJ(o,function(l){return _l(l.GATE)});return a.hasPredicates=s,n.definition.push(a),Je(o,function(l){var u=new vi({definition:[]});a.definition.push(u),Ze(l,"NAME")&&(u.name=l.NAME),Ze(l,"IGNORE_AMBIGUITIES")?u.ignoreAmbiguities=l.IGNORE_AMBIGUITIES:Ze(l,"GATE")&&(u.ignoreAmbiguities=!0),r.recordingProdStack.push(u),l.ALT.call(r),r.recordingProdStack.pop()}),dR}function $V(t){return t===0?"":""+t}function fS(t){if(t<0||t>kV){var e=new Error("Invalid DSL Method idx value: <"+t+`>
	`+("Idx value must be a none negative value smaller than "+(kV+1)));throw e.KNOWN_RECORDER_ERROR=!0,e}}var cst=function(){function t(){}return t.prototype.initPerformanceTracer=function(e){if(Ze(e,"traceInitPerf")){var r=e.traceInitPerf,n=typeof r=="number";this.traceInitMaxIdent=n?r:1/0,this.traceInitPerf=n?r>0:r}else this.traceInitMaxIdent=0,this.traceInitPerf=fi.traceInitPerf;this.traceInitIndent=-1},t.prototype.TRACE_INIT=function(e,r){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+e+">");var i=CJ(r),o=i.time,a=i.value,s=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(n+"<-- <"+e+"> time: "+o+"ms"),this.traceInitIndent--,a}else return r()},t}(),oee=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),hS=_I(oc,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(hS);var fi=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:zJ,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),dS=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),bn;(function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",t[t.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"})(bn||(bn={}));function fst(t){return t===void 0&&(t=void 0),function(){return t}}var PI=function(){function t(e,r){r===void 0&&(r=fi),this.ignoredIssues=fi.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var n=this;n.initErrorHandler(r),n.initLexerAdapter(),n.initLooksAhead(r),n.initRecognizerEngine(e,r),n.initRecoverable(r),n.initTreeBuilder(r),n.initContentAssist(),n.initGastRecorder(r),n.initPerformanceTracer(r),Ze(r,"ignoredIssues")&&r.ignoredIssues!==fi.ignoredIssues&&EI(`The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.`),this.ignoredIssues=Ze(r,"ignoredIssues")?r.ignoredIssues:fi.ignoredIssues,this.skipValidations=Ze(r,"skipValidations")?r.skipValidations:fi.skipValidations}return t.performSelfAnalysis=function(e){e.performSelfAnalysis()},t.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",function(){var r;e.selfAnalysisDone=!0;var n=e.className;e.TRACE_INIT("toFastProps",function(){EJ(e)}),e.TRACE_INIT("Grammar Recording",function(){try{e.enableRecording(),Je(e.definedRulesNames,function(o){var a=e[o],s=a.originalGrammarAction,l=void 0;e.TRACE_INIT(o+" Rule",function(){l=e.topLevelRuleRecord(o,s)}),e.gastProductionsCache[o]=l})}finally{e.disableRecording()}});var i=[];if(e.TRACE_INIT("Grammar Resolving",function(){i=Uat({rules:Fn(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,i)}),e.TRACE_INIT("Grammar Validations",function(){if(Zt(i)&&e.skipValidations===!1){var o=Vat({rules:Fn(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:Fn(e.tokensMap),ignoredIssues:e.ignoredIssues,errMsgProvider:MI,grammarName:n});e.definitionErrors.push.apply(e.definitionErrors,o)}}),Zt(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",function(){var o=Qot(Fn(e.gastProductionsCache));e.resyncFollows=o}),e.TRACE_INIT("ComputeLookaheadFunctions",function(){e.preComputeLookaheadFunctions(Fn(e.gastProductionsCache))})),e.TRACE_INIT("expandAllNestedRuleNames",function(){var o=iat(Fn(e.gastProductionsCache),e.fullRuleNameToShort);e.allRuleNames=o.allRuleNames}),!t.DEFER_DEFINITION_ERRORS_HANDLING&&!Zt(e.definitionErrors))throw r=Fe(e.definitionErrors,function(o){return o.message}),new Error(`Parser Definition Errors detected:
 `+r.join(`
-------------------------------
`))})},t.DEFER_DEFINITION_ERRORS_HANDLING=!1,t}();Jit(PI,[jat,zat,tst,rst,ist,nst,ost,ast,lst,cst]);(function(t){oee(e,t);function e(r,n){n===void 0&&(n=fi);var i=this,o=z1(n);return o.outputCst=!0,i=t.call(this,r,o)||this,i}return e})(PI);var hst=function(t){oee(e,t);function e(r,n){n===void 0&&(n=fi);var i=this,o=z1(n);return o.outputCst=!1,i=t.call(this,r,o)||this,i}return e}(PI);/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const LV=(t,e)=>({type:t,message:e});var Hr;(function(t){t.LexingError="LexingError",t.ParserError="ParsingError",t.StaticOffsetError="StaticOffsetError",t.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",t.RangeOffsetNotAllowed="RangeOffsetNotAllowed"})(Hr||(Hr={}));var F;(function(t){t.EMPTY="EMPTY",t.NUMBER="NUMBER",t.STRING="STRING",t.MINUS_UNARY_OP="MINUS_UNARY_OP",t.PLUS_UNARY_OP="PLUS_UNARY_OP",t.PERCENT_OP="PERCENT_OP",t.CONCATENATE_OP="CONCATENATE_OP",t.EQUALS_OP="EQUALS_OP",t.NOT_EQUAL_OP="NOT_EQUAL_OP",t.GREATER_THAN_OP="GREATER_THAN_OP",t.LESS_THAN_OP="LESS_THAN_OP",t.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",t.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",t.PLUS_OP="PLUS_OP",t.MINUS_OP="MINUS_OP",t.TIMES_OP="TIMES_OP",t.DIV_OP="DIV_OP",t.POWER_OP="POWER_OP",t.FUNCTION_CALL="FUNCTION_CALL",t.NAMED_EXPRESSION="NAMED_EXPRESSION",t.PARENTHESIS="PARENTHESES",t.CELL_REFERENCE="CELL_REFERENCE",t.CELL_RANGE="CELL_RANGE",t.COLUMN_RANGE="COLUMN_RANGE",t.ROW_RANGE="ROW_RANGE",t.ERROR="ERROR",t.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",t.ARRAY="ARRAY"})(F||(F={}));var qi;(function(t){t[t.RELATIVE=0]="RELATIVE",t[t.START_ABSOLUTE=1]="START_ABSOLUTE",t[t.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"})(qi||(qi={}));const dst=t=>({type:F.EMPTY,leadingWhitespace:t==null?void 0:t.image}),pst=(t,e)=>({type:F.NUMBER,value:t,leadingWhitespace:e==null?void 0:e.image}),mst=t=>{var e;return{type:F.STRING,value:t.image.slice(1,-1),leadingWhitespace:(e=t.leadingWhitespace)===null||e===void 0?void 0:e.image}},DV=(t,e)=>({type:F.CELL_REFERENCE,reference:t,leadingWhitespace:e==null?void 0:e.image}),FV=(t,e,r,n)=>(kI(t,e,r),{type:F.CELL_RANGE,start:t,end:e,sheetReferenceType:r,leadingWhitespace:n}),gst=(t,e,r,n)=>(kI(t,e,r),{type:F.COLUMN_RANGE,start:t,end:e,sheetReferenceType:r,leadingWhitespace:n==null?void 0:n.image}),yst=(t,e,r,n)=>(kI(t,e,r),{type:F.ROW_RANGE,start:t,end:e,sheetReferenceType:r,leadingWhitespace:n==null?void 0:n.image}),vst=(t,e,r)=>({type:F.CONCATENATE_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),bst=(t,e,r)=>({type:F.EQUALS_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),wst=(t,e,r)=>({type:F.NOT_EQUAL_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),Sst=(t,e,r)=>({type:F.GREATER_THAN_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),Rst=(t,e,r)=>({type:F.LESS_THAN_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),Est=(t,e,r)=>({type:F.GREATER_THAN_OR_EQUAL_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),Cst=(t,e,r)=>({type:F.LESS_THAN_OR_EQUAL_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),_st=(t,e,r)=>({type:F.PLUS_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),Tst=(t,e,r)=>({type:F.MINUS_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),Ost=(t,e,r)=>({type:F.TIMES_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),Ast=(t,e,r)=>({type:F.DIV_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),xst=(t,e,r)=>({type:F.POWER_OP,left:t,right:e,leadingWhitespace:r==null?void 0:r.image}),Ist=(t,e)=>({type:F.MINUS_UNARY_OP,value:t,leadingWhitespace:e==null?void 0:e.image}),Mst=(t,e)=>({type:F.PLUS_UNARY_OP,value:t,leadingWhitespace:e==null?void 0:e.image}),Nst=(t,e)=>({type:F.PERCENT_OP,value:t,leadingWhitespace:e==null?void 0:e.image}),Pst=(t,e,r,n)=>({type:F.FUNCTION_CALL,procedureName:t,args:e,leadingWhitespace:r==null?void 0:r.image,internalWhitespace:n==null?void 0:n.image}),HV=(t,e,r)=>({type:F.ARRAY,args:t,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:r==null?void 0:r.image}),kst=(t,e)=>({type:F.NAMED_EXPRESSION,expressionName:t,leadingWhitespace:e==null?void 0:e.image}),$st=(t,e,r)=>({type:F.PARENTHESIS,expression:t,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:r==null?void 0:r.image}),Jo=(t,e)=>({type:F.ERROR,error:t,leadingWhitespace:e==null?void 0:e.image}),ff=(t,e,r)=>({type:F.ERROR_WITH_RAW_INPUT,error:e,rawInput:t,leadingWhitespace:r==null?void 0:r.image}),AA=()=>({type:F.ERROR,error:x.parsingError()});function kI(t,e,r){if(t.sheet!==void 0&&e.sheet===void 0||t.sheet===void 0&&e.sheet!==void 0)throw new Error("Start address inconsistent with end address");if(t.sheet===void 0&&r!==qi.RELATIVE||t.sheet!==void 0&&r===qi.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function $t(t,e){return(e!=null?e:"")+t}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const aee={[F.PLUS_OP]:"+",[F.MINUS_OP]:"-",[F.TIMES_OP]:"*",[F.DIV_OP]:"/",[F.CONCATENATE_OP]:"&",[F.POWER_OP]:"^",[F.EQUALS_OP]:"=",[F.NOT_EQUAL_OP]:"<>",[F.GREATER_THAN_OP]:">",[F.GREATER_THAN_OR_EQUAL_OP]:">=",[F.LESS_THAN_OP]:"<",[F.LESS_THAN_OR_EQUAL_OP]:"<="};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Lst=(t,e,r,n)=>({ast:t,relativeDependencies:e,hasVolatileFunction:r,hasStructuralChangeFunction:n});class Dst{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,r){const n=mR(r,this.functionRegistry),i=Lst(r,n,Bs(r,this.functionRegistry.isFunctionVolatile),Bs(r,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,i),i}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,r){const n=this.cache.get(e);return n!==void 0?n.ast:(this.set(e,r),r)}}const Bs=(t,e)=>{switch(t.type){case F.EMPTY:case F.NUMBER:case F.STRING:case F.ERROR:case F.ERROR_WITH_RAW_INPUT:case F.CELL_REFERENCE:case F.CELL_RANGE:case F.COLUMN_RANGE:case F.ROW_RANGE:case F.NAMED_EXPRESSION:return!1;case F.PERCENT_OP:case F.PLUS_UNARY_OP:case F.MINUS_UNARY_OP:return Bs(t.value,e);case F.CONCATENATE_OP:case F.EQUALS_OP:case F.NOT_EQUAL_OP:case F.LESS_THAN_OP:case F.GREATER_THAN_OP:case F.LESS_THAN_OR_EQUAL_OP:case F.GREATER_THAN_OR_EQUAL_OP:case F.MINUS_OP:case F.PLUS_OP:case F.TIMES_OP:case F.DIV_OP:case F.POWER_OP:return Bs(t.left,e)||Bs(t.right,e);case F.PARENTHESIS:return Bs(t.expression,e);case F.FUNCTION_CALL:return e(t.procedureName)?!0:t.args.some(r=>Bs(r,e));case F.ARRAY:return t.args.some(r=>r.some(n=>Bs(n,e)))}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class W{}W.DistinctSigns="Distinct signs.";W.WrongArgNumber="Wrong number of arguments.";W.EmptyArg="Empty function argument.";W.EmptyArray="Empty array not allowed.";W.ArrayDimensions="Array dimensions are not compatible.";W.NoSpaceForArrayResult="No space for array result.";W.ValueSmall="Value too small.";W.ValueLarge="Value too large.";W.BadCriterion="Incorrect criterion.";W.RangeManySheets="Range spans more than one sheet.";W.CellRangeExpected="Cell range expected.";W.WrongDimension="Wrong range dimension.";W.ScalarExpected="Cell range not allowed.";W.NumberCoercion="Value cannot be coerced to number.";W.NumberExpected="Number argument expected.";W.IntegerExpected="Value needs to be an integer.";W.BadMode="Mode not recognized.";W.DateBounds="Date outside of bounds.";W.OutOfSheet="Resulting reference is out of the sheet.";W.WrongType="Wrong type of argument.";W.NaN="NaN or infinite value encountered.";W.EqualLength="Ranges need to be of equal length.";W.Negative="Value cannot be negative.";W.NotBinary="String does not represent a binary number.";W.NotOctal="String does not represent an octal number.";W.NotHex="String does not represent a hexadecimal number.";W.EndStartPeriod="End period needs to be at least start period.";W.CellRefExpected="Cell reference expected.";W.EmptyRange="Empty range not allowed.";W.BadRef="Address is not correct.";W.NumberRange="Number-only range expected.";W.ValueNotFound="Value not found.";W.ValueBaseLarge="Value in base too large.";W.ValueBaseSmall="Value in base too small.";W.ValueBaseLong="Value in base too long.";W.NegativeLength="Length cannot be negative.";W.PatternNotFound="Pattern not found.";W.OneValue="Needs at least one value.";W.TwoValues="Range needs to contain at least two elements.";W.ThreeValues="Range needs to contain at least three elements.";W.IndexBounds="Index out of bounds.";W.IndexLarge="Index too large.";W.Formula="Expected formula.";W.NegativeCount="Count cannot be negative.";W.ParseError="Parsing error.";W.SheetRef="Sheet does not exist.";W.PeriodLong="Period number cannot exceed life length.";W.InvalidDate="Invalid date.";W.BitshiftLong="Result of bitshift is too long.";W.EmptyString="Empty-string argument not allowed.";W.LengthBounds="Length out of bounds.";W.NegativeTime="Time cannot be negative.";W.NoDefault="No default option.";W.Selector="Selector cannot exceed the number of arguments.";W.StartEndDate="Start date needs to be earlier than end date.";W.IncorrectDateTime="String does not represent correct DateTime.";W.CharacterCodeBounds="Character code out of bounds.";W.NonZero="Argument cannot be 0.";W.LessThanOne="Argument cannot be less than 1.";W.WeekendString="Incorrect weekend bitmask string.";W.InvalidRoman="Invalid roman numeral.";W.WrongOrder="Wrong order of values.";W.ComplexNumberExpected="Complex number expected.";W.ShouldBeIorJ="Should be 'i' or 'j'.";W.SizeMismatch="Array dimensions mismatched.";W.FunctionName=t=>`Function name ${t} not recognized.`;W.NamedExpressionName=t=>`Named expression ${t} not recognized.`;W.LicenseKey=t=>`License key is ${t}.`;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Fst{constructor(){this.POSSIBLE_START_CHARACTERS=[...yJ,...Vit,qn,"'","_"],this.cellReferenceRegexp=new RegExp(Uit,"y")}match(e,r){this.cellReferenceRegexp.lastIndex=r;const n=this.cellReferenceRegexp.exec(e+"@");return n==null||n[1]==null?null:(n[0]=n[1],n)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Hst{constructor(){this.POSSIBLE_START_CHARACTERS=[...yJ,"_"],this.namedExpressionRegexp=new RegExp(gJ,"y"),this.r1c1CellRefRegexp=new RegExp(`^${mJ}$`)}match(e,r){this.namedExpressionRegexp.lastIndex=r;const n=this.namedExpressionRegexp.exec(e);return n==null||n[0]==null||this.r1c1CellRefRegexp.test(n[0])?null:n}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Pv=Pt({name:"AdditionOp",pattern:mi.NA}),xA=Pt({name:"PlusOp",pattern:/\+/,categories:Pv}),IA=Pt({name:"MinusOp",pattern:/-/,categories:Pv}),pR=Pt({name:"MultiplicationOp",pattern:mi.NA}),see=Pt({name:"TimesOp",pattern:/\*/,categories:pR}),lee=Pt({name:"DivOp",pattern:/\//,categories:pR}),MA=Pt({name:"PowerOp",pattern:/\^/}),uee=Pt({name:"PercentOp",pattern:/%/}),Ol=Pt({name:"BooleanOp",pattern:mi.NA}),NA=Pt({name:"EqualsOp",pattern:/=/,categories:Ol}),cee=Pt({name:"NotEqualOp",pattern:/<>/,categories:Ol}),fee=Pt({name:"GreaterThanOp",pattern:/>/,categories:Ol}),hee=Pt({name:"LessThanOp",pattern:/</,categories:Ol}),dee=Pt({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:Ol}),pee=Pt({name:"LessThanOrEqualOp",pattern:/<=/,categories:Ol}),mee=Pt({name:"ConcatenateOp",pattern:/&/}),PA=Pt({name:"LParen",pattern:/\(/}),O2=Pt({name:"RParen",pattern:/\)/}),gee=Pt({name:"ArrayLParen",pattern:/{/}),yee=Pt({name:"ArrayRParen",pattern:/}/}),vee=Pt({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),bee=Pt({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),kv=Pt({name:"RangeSeparator",pattern:new RegExp(W1)}),$I=Pt({name:"ColumnRange",pattern:new RegExp(`${sV}${W1}${sV}`)}),LI=Pt({name:"RowRange",pattern:new RegExp(`${lV}${W1}${lV}`)}),DI=Pt({name:"ProcedureName",pattern:new RegExp(`([${iR}][${vI}]*)\\(`)}),KC=new Fst,Gs=Pt({name:"CellReference",pattern:KC.match.bind(KC),start_chars_hint:KC.POSSIBLE_START_CHARACTERS,line_breaks:!1}),qC=new Hst,wee=Pt({name:"NamedExpression",pattern:qC.match.bind(qC),start_chars_hint:qC.POSSIBLE_START_CHARACTERS,line_breaks:!1}),FI=t=>{const e=t.translationPackage.getFunctionTranslation("OFFSET"),r=t.errorMapping,n=t.translationPackage.buildFunctionMapping(),i=new RegExp(t.ignoreWhiteSpace==="standard"?Hit:Fit),o=Pt({name:"WhiteSpace",pattern:i}),a=Pt({name:"ArrayRowSep",pattern:t.arrayRowSeparator}),s=Pt({name:"ArrayColSep",pattern:t.arrayColumnSeparator}),l=Pt({name:"NumberLiteral",pattern:new RegExp(`(([${t.decimalSeparator}]\\d+)|(\\d+([${t.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),u=Pt({name:"OffsetProcedureName",pattern:new RegExp(e,"i")});let c,f;t.functionArgSeparator===t.arrayColumnSeparator?(c=s,f=[]):t.functionArgSeparator===t.arrayRowSeparator?(c=a,f=[]):(c=Pt({name:"ArgSeparator",pattern:t.functionArgSeparator}),f=[c]);const h=[o,xA,IA,see,lee,MA,NA,cee,uee,dee,pee,fee,hee,PA,O2,gee,yee,u,DI,kv,...f,$I,LI,l,vee,bee,mee,Ol,Pv,pR,Gs,wee,a,s];return{ArgSeparator:c,NumberLiteral:l,OffsetProcedureName:u,ArrayRowSeparator:a,ArrayColSeparator:s,WhiteSpace:o,allTokens:h,errorMapping:r,functionMapping:n,decimalSeparator:t.decimalSeparator,maxColumns:t.maxColumns,maxRows:t.maxRows}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Lf extends hst{constructor(e,r){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:fst(dst())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var n;const i=this.CONSUME(DI),o=i.image.toUpperCase().slice(0,-1),a=(n=this.lexerConfig.functionMapping[o])!==null&&n!==void 0?n:o,s=[];let l=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var c;const f=this.CONSUME(this.lexerConfig.ArgSeparator);l.type===F.EMPTY&&(l.leadingWhitespace=(c=f.leadingWhitespace)===null||c===void 0?void 0:c.image),s.push(l),l=this.SUBRULE2(this.booleanExpressionOrEmpty)}),s.push(l),s.length===1&&s[0].type===F.EMPTY&&(s.length=0);const u=this.CONSUME(O2);return Pst(a,s,i.leadingWhitespace,u.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{const n=this.CONSUME(wee);return kst(n.image,n.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{const n=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(PA),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{n.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(O2),this.handleOffsetHeuristic(n)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{const n=this.CONSUME($I),[i,o]=n.image.split(":"),a=this.ACTION(()=>tS(this.sheetMapping,i,this.formulaAddress)),s=this.ACTION(()=>tS(this.sheetMapping,o,this.formulaAddress));if(a===void 0||s===void 0)return Jo(new x($.REF));if(a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||s.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return ff(n.image,new x($.NAME),n.leadingWhitespace);if(a.sheet===void 0&&s.sheet!==void 0)return this.parsingError(Hr.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:c}=Lf.fixSheetIdsForRangeEnds(a,s);return gst(l,u,c,n.leadingWhitespace)}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{const n=this.CONSUME(LI),[i,o]=n.image.split(":"),a=this.ACTION(()=>rS(this.sheetMapping,i,this.formulaAddress)),s=this.ACTION(()=>rS(this.sheetMapping,o,this.formulaAddress));if(a===void 0||s===void 0)return Jo(new x($.REF));if(a.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||s.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return ff(n.image,new x($.NAME),n.leadingWhitespace);if(a.sheet===void 0&&s.sheet!==void 0)return this.parsingError(Hr.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:c}=Lf.fixSheetIdsForRangeEnds(a,s);return yst(l,u,c,n.leadingWhitespace)}),this.cellReference=this.RULE("cellReference",()=>{const n=this.CONSUME(Gs),i=this.ACTION(()=>_f(this.sheetMapping,n.image,this.formulaAddress));return i===void 0?ff(n.image,new x($.REF),n.leadingWhitespace):i.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?ff(n.image,new x($.NAME),n.leadingWhitespace):DV(i,n.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",n=>{var i;const o=this.CONSUME(Gs),a=this.ACTION(()=>_f(this.sheetMapping,n.image,this.formulaAddress)),s=this.ACTION(()=>_f(this.sheetMapping,o.image,this.formulaAddress));return a===void 0||s===void 0?this.ACTION(()=>ff(`${n.image}:${o.image}`,new x($.REF),n.leadingWhitespace)):a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||s.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>ff(`${n.image}:${o.image}`,new x($.NAME),n.leadingWhitespace)):this.buildCellRange(a,s,(i=n.leadingWhitespace)===null||i===void 0?void 0:i.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",n=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[n]})},{ALT:()=>{var i;const o=this.SUBRULE(this.offsetProcedureExpression),a=this.ACTION(()=>_f(this.sheetMapping,n.image,this.formulaAddress));return a===void 0?Jo(new x($.REF)):o.type===F.CELL_REFERENCE?this.buildCellRange(a,o.reference,(i=n.leadingWhitespace)===null||i===void 0?void 0:i.image):this.parsingError(Hr.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{const n=this.CONSUME(Gs);return this.CONSUME2(kv),this.SUBRULE(this.endOfRangeExpression,{ARGS:[n]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",n=>{const i=this.CONSUME(Gs),o=this.ACTION(()=>_f(this.sheetMapping,i.image,this.formulaAddress));return o===void 0?this.ACTION(()=>Jo(new x($.REF))):this.buildCellRange(n.reference,o,n.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",n=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[n]})},{ALT:()=>{const i=this.SUBRULE(this.offsetProcedureExpression);return i.type===F.CELL_REFERENCE?this.buildCellRange(n.reference,i.reference,n.leadingWhitespace):this.parsingError(Hr.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{const n=this.SUBRULE(this.offsetProcedureExpression);let i;return this.OPTION(()=>{this.CONSUME(kv),n.type===F.CELL_RANGE?i=this.parsingError(Hr.RangeOffsetNotAllowed,"Range offset not allowed here"):i=this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[n]})}),i!==void 0?i:n}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{const n=[[]];return n[n.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),n[n.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),n.push([]),n[n.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),HV(n)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{const n=this.CONSUME(PA),i=this.SUBRULE(this.booleanExpression),o=this.CONSUME(O2);return $st(i,n.leadingWhitespace,o.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{const n=this.CONSUME(gee),i=this.SUBRULE(this.insideArrayExpression),o=this.CONSUME(yee);return HV(i.args,n.leadingWhitespace,o.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=n=>{const i=n.replace(this.lexerConfig.decimalSeparator,".");return Number(i)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var n;return this.OR((n=this.atomicExpCache)!==null&&n!==void 0?n:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const i=this.CONSUME(this.lexerConfig.NumberLiteral);return pst(this.numericStringToNumber(i.image),i.leadingWhitespace)}},{ALT:()=>{const i=this.CONSUME(vee);return mst(i)}},{ALT:()=>{const i=this.CONSUME(bee),o=i.image.toUpperCase(),a=this.lexerConfig.errorMapping[o];return a?Jo(new x(a),i.leadingWhitespace):this.parsingError(Hr.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{const n=this.SUBRULE(this.positiveAtomicExpression),i=this.OPTION(()=>this.CONSUME(uee));return i?Nst(n,i.leadingWhitespace):n}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{const n=this.CONSUME(Pv),i=this.SUBRULE(this.atomicExpression);return Yt(n,xA)?Mst(i,n.leadingWhitespace):Yt(n,IA)?Ist(i,n.leadingWhitespace):(this.customParsingError=LV(Hr.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let n=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{const i=this.CONSUME(MA),o=this.SUBRULE2(this.atomicExpression);Yt(i,MA)?n=xst(n,o,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let n=this.SUBRULE(this.powerExpression);return this.MANY(()=>{const i=this.CONSUME(pR),o=this.SUBRULE2(this.powerExpression);Yt(i,see)?n=Ost(n,o,i.leadingWhitespace):Yt(i,lee)?n=Ast(n,o,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.additionExpression=this.RULE("additionExpression",()=>{let n=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{const i=this.CONSUME(Pv),o=this.SUBRULE2(this.multiplicationExpression);Yt(i,xA)?n=_st(n,o,i.leadingWhitespace):Yt(i,IA)?n=Tst(n,o,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let n=this.SUBRULE(this.additionExpression);return this.MANY(()=>{const i=this.CONSUME(mee),o=this.SUBRULE2(this.additionExpression);n=vst(n,o,i.leadingWhitespace)}),n}),this.booleanExpression=this.RULE("booleanExpression",()=>{let n=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{const i=this.CONSUME(Ol),o=this.SUBRULE2(this.concatenateExpression);Yt(i,NA)?n=bst(n,o,i.leadingWhitespace):Yt(i,cee)?n=wst(n,o,i.leadingWhitespace):Yt(i,fee)?n=Sst(n,o,i.leadingWhitespace):Yt(i,hee)?n=Rst(n,o,i.leadingWhitespace):Yt(i,dee)?n=Est(n,o,i.leadingWhitespace):Yt(i,pee)?n=Cst(n,o,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.formula=this.RULE("formula",()=>(this.CONSUME(NA),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.sheetMapping=r,this.formulaAddress=Le(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,r){this.input=e;let n=this.formulaWithContext(r),i=[];return this.customParsingError&&i.push(this.customParsingError),i=i.concat(this.errors.map(o=>({type:Hr.ParserError,message:o.message}))),i.length>0&&(n=AA()),{ast:n,errors:i}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,r,n){if(e.sheet===void 0&&r.sheet!==void 0)return this.parsingError(Hr.ParserError,"Malformed range expression");const{firstEnd:i,secondEnd:o,sheetRefType:a}=Lf.fixSheetIdsForRangeEnds(e,r);return FV(i,o,a,n)}static fixSheetIdsForRangeEnds(e,r){const n=Lf.rangeSheetReferenceType(e.sheet,r.sheet),i=e.sheet!==void 0&&r.sheet===void 0?r.withSheet(e.sheet):r;return{firstEnd:e,secondEnd:i,sheetRefType:n}}handleOffsetHeuristic(e){const r=e[0];if(r.type!==F.CELL_REFERENCE)return this.parsingError(Hr.StaticOffsetError,"First argument to OFFSET is not a reference");const n=e[1];let i;if(n.type===F.NUMBER&&Number.isInteger(n.value))i=n.value;else if(n.type===F.PLUS_UNARY_OP&&n.value.type===F.NUMBER&&Number.isInteger(n.value.value))i=n.value.value;else if(n.type===F.MINUS_UNARY_OP&&n.value.type===F.NUMBER&&Number.isInteger(n.value.value))i=-n.value.value;else return this.parsingError(Hr.StaticOffsetError,"Second argument to OFFSET is not a static number");const o=e[2];let a;if(o.type===F.NUMBER&&Number.isInteger(o.value))a=o.value;else if(o.type===F.PLUS_UNARY_OP&&o.value.type===F.NUMBER&&Number.isInteger(o.value.value))a=o.value.value;else if(o.type===F.MINUS_UNARY_OP&&o.value.type===F.NUMBER&&Number.isInteger(o.value.value))a=-o.value.value;else return this.parsingError(Hr.StaticOffsetError,"Third argument to OFFSET is not a static number");const s=e[3];let l;if(s===void 0)l=1;else if(s.type===F.NUMBER){if(l=s.value,l<1)return this.parsingError(Hr.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(l))return this.parsingError(Hr.StaticOffsetError,"Fourth argument to OFFSET is not integer")}else return this.parsingError(Hr.StaticOffsetError,"Fourth argument to OFFSET is not a static number");const u=e[4];let c;if(u===void 0)c=1;else if(u.type===F.NUMBER){if(c=u.value,c<1)return this.parsingError(Hr.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(c))return this.parsingError(Hr.StaticOffsetError,"Fifth argument to OFFSET is not integer")}else return this.parsingError(Hr.StaticOffsetError,"Fifth argument to OFFSET is not a static number");const f=new Kt(r.reference.col+a,r.reference.row+i,r.reference.type);let h=f.col,d=f.row;if((r.reference.type===zt.CELL_REFERENCE_RELATIVE||r.reference.type===zt.CELL_REFERENCE_ABSOLUTE_COL)&&(d=d+this.formulaAddress.row),(r.reference.type===zt.CELL_REFERENCE_RELATIVE||r.reference.type===zt.CELL_REFERENCE_ABSOLUTE_ROW)&&(h=h+this.formulaAddress.col),h<0||d<0)return Jo(new x($.REF,W.OutOfSheet));if(c===1&&l===1)return DV(f);{const p=new Kt(f.col+c-1,f.row+l-1,f.type);return FV(f,p,qi.RELATIVE)}}parsingError(e,r){return this.customParsingError=LV(e,r),AA()}static rangeSheetReferenceType(e,r){return e===void 0?qi.RELATIVE:r===void 0?qi.START_ABSOLUTE:qi.BOTH_ABSOLUTE}}class pS{constructor(e){this.lexerConfig=e,this.lexer=new mi(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const r=this.lexer.tokenize(e);let n=r.tokens;return n=this.trimTrailingWhitespaces(n),n=this.skipWhitespacesInsideRanges(n),n=this.skipWhitespacesBeforeArgSeparators(n),r.tokens=n,r}skipWhitespacesInsideRanges(e){return pS.filterTokensByNeighbors(e,(r,n,i)=>(Yt(r,Gs)||Yt(r,kv))&&Yt(n,this.lexerConfig.WhiteSpace)&&(Yt(i,Gs)||Yt(i,kv)))}skipWhitespacesBeforeArgSeparators(e){return pS.filterTokensByNeighbors(e,(r,n,i)=>!Yt(r,this.lexerConfig.ArgSeparator)&&Yt(n,this.lexerConfig.WhiteSpace)&&Yt(i,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,r){if(e.length<3)return e;let n=0;const i=[e[n++]];for(;n<e.length-1;)r(e[n-1],e[n],e[n+1])||i.push(e[n]),++n;return i.push(e[n]),i}trimTrailingWhitespaces(e){return e.length>0&&Yt(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class See{constructor(e,r,n,i){this.config=e,this.lexerConfig=r,this.sheetMappingFn=n,this.namedExpressions=i}unparse(e,r){return"="+this.unparseAst(e,r)}unparseAst(e,r){var n,i;switch(e.type){case F.EMPTY:return $t("",e.leadingWhitespace);case F.NUMBER:return $t(Ree(e.value,this.config.decimalSeparator),e.leadingWhitespace);case F.STRING:return $t('"'+e.value+'"',e.leadingWhitespace);case F.FUNCTION_CALL:{const o=e.args.map(l=>l!==void 0?this.unparseAst(l,r):"").join(this.config.functionArgSeparator),s=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+o+$t(")",e.internalWhitespace);return $t(s,e.leadingWhitespace)}case F.NAMED_EXPRESSION:{const o=(n=this.namedExpressions.nearestNamedExpression(e.expressionName,r.sheet))===null||n===void 0?void 0:n.displayName;return $t(o||e.expressionName,e.leadingWhitespace)}case F.CELL_REFERENCE:{let o;return e.reference.sheet!==void 0?o=this.unparseSheetName(e.reference.sheet)+"!":o="",o+=(i=e.reference.unparse(r))!==null&&i!==void 0?i:this.config.translationPackage.getErrorTranslation($.REF),$t(o,e.leadingWhitespace)}case F.COLUMN_RANGE:case F.ROW_RANGE:case F.CELL_RANGE:return $t(this.formatRange(e,r),e.leadingWhitespace);case F.PLUS_UNARY_OP:{const o=this.unparseAst(e.value,r);return $t("+",e.leadingWhitespace)+o}case F.MINUS_UNARY_OP:{const o=this.unparseAst(e.value,r);return $t("-",e.leadingWhitespace)+o}case F.PERCENT_OP:return this.unparseAst(e.value,r)+$t("%",e.leadingWhitespace);case F.ERROR:{const o=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:$.ERROR);return $t(o,e.leadingWhitespace)}case F.ERROR_WITH_RAW_INPUT:return $t(e.rawInput,e.leadingWhitespace);case F.PARENTHESIS:{const a="("+this.unparseAst(e.expression,r)+$t(")",e.internalWhitespace);return $t(a,e.leadingWhitespace)}case F.ARRAY:{const o="{"+e.args.map(a=>a.map(s=>this.unparseAst(s,r)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+$t("}",e.internalWhitespace);return $t(o,e.leadingWhitespace)}default:{const o=this.unparseAst(e.left,r),a=this.unparseAst(e.right,r);return o+$t(aee[e.type],e.leadingWhitespace)+a}}}unparseSheetName(e){const r=bJ(e,this.sheetMappingFn);if(r===void 0)throw new yr(e);return r}formatRange(e,r){let n="",i="";e.start.sheet!==void 0&&e.sheetReferenceType!==qi.RELATIVE&&(n=this.unparseSheetName(e.start.sheet)+"!"),e.end.sheet!==void 0&&e.sheetReferenceType===qi.BOTH_ABSOLUTE&&(i=this.unparseSheetName(e.end.sheet)+"!");const o=e.start.unparse(r),a=e.end.unparse(r);return o===void 0||a===void 0?this.config.translationPackage.getErrorTranslation($.REF):`${n}${o}:${i}${a}`}}function Ree(t,e){return t.toString().replace(".",e)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class pg{constructor(e,r,n){this.config=e,this.functionRegistry=r,this.sheetMapping=n,this.statsCacheUsed=0,this.lexerConfig=FI(e),this.lexer=new pS(this.lexerConfig),this.formulaParser=new Lf(this.lexerConfig,this.sheetMapping),this.cache=new Dst(this.functionRegistry)}parse(e,r){this.formulaAddress=r;const n=this.tokenizeFormula(e);if(n.errors.length>0){const f=n.errors.map(h=>({type:Hr.LexingError,message:h.message}));return{ast:AA(),errors:f,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const i=this.computeHashFromTokens(n.tokens,r);let o=this.cache.get(i);if(o!==void 0)++this.statsCacheUsed;else{const f=this.bindWhitespacesToTokens(n.tokens),h=this.formulaParser.parseFromTokens(f,r);if(h.errors.length>0)return Object.assign(Object.assign({},h),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});o=this.cache.set(i,h.ast)}const{ast:a,hasVolatileFunction:s,hasStructuralChangeFunction:l}=o,u=this.convertReversedRangesToRegularRanges(a),c=mR(u,this.functionRegistry);return{ast:u,errors:[],hasVolatileFunction:s,hasStructuralChangeFunction:l,dependencies:c}}convertReversedRangesToRegularRanges(e){switch(e.type){case F.EMPTY:case F.NUMBER:case F.STRING:case F.ERROR:case F.ERROR_WITH_RAW_INPUT:case F.CELL_REFERENCE:case F.NAMED_EXPRESSION:return e;case F.CELL_RANGE:{const{start:r,end:n}=e,i=this.orderCellRangeEnds(r,n);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case F.COLUMN_RANGE:{const{start:r,end:n}=e,i=this.orderColumnRangeEnds(r,n);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case F.ROW_RANGE:{const{start:r,end:n}=e,i=this.orderRowRangeEnds(r,n);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case F.PERCENT_OP:case F.PLUS_UNARY_OP:case F.MINUS_UNARY_OP:{const r=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:r})}case F.CONCATENATE_OP:case F.EQUALS_OP:case F.NOT_EQUAL_OP:case F.LESS_THAN_OP:case F.GREATER_THAN_OP:case F.LESS_THAN_OR_EQUAL_OP:case F.GREATER_THAN_OR_EQUAL_OP:case F.MINUS_OP:case F.PLUS_OP:case F.TIMES_OP:case F.DIV_OP:case F.POWER_OP:{const r=this.convertReversedRangesToRegularRanges(e.left),n=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:r,right:n})}case F.PARENTHESIS:{const r=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:r})}case F.FUNCTION_CALL:{const r=e.args.map(n=>this.convertReversedRangesToRegularRanges(n));return Object.assign(Object.assign({},e),{args:r})}case F.ARRAY:{const r=e.args.map(n=>n.map(i=>this.convertReversedRangesToRegularRanges(i)));return Object.assign(Object.assign({},e),{args:r})}}}orderCellRangeEnds(e,r){const n=[e,r],[i,o]=n.map(c=>c.toColumnAddress()).sort(Kn.compareByAbsoluteAddress(this.formulaAddress)),[a,s]=n.map(c=>c.toRowAddress()).sort(Ln.compareByAbsoluteAddress(this.formulaAddress)),[l,u]=n.map(c=>c.sheet).sort(pg.compareSheetIds.bind(this));return{start:Kt.fromColAndRow(i,a,l),end:Kt.fromColAndRow(o,s,u)}}orderColumnRangeEnds(e,r){const n=[e,r],[i,o]=n.sort(Kn.compareByAbsoluteAddress(this.formulaAddress)),[a,s]=n.map(l=>l.sheet).sort(pg.compareSheetIds.bind(this));return{start:new Kn(i.type,i.col,a),end:new Kn(o.type,o.col,s)}}orderRowRangeEnds(e,r){const n=[e,r],[i,o]=n.sort(Ln.compareByAbsoluteAddress(this.formulaAddress)),[a,s]=n.map(l=>l.sheet).sort(pg.compareSheetIds.bind(this));return{start:new Ln(i.type,i.row,a),end:new Ln(o.type,o.row,s)}}static compareSheetIds(e,r){return e=e!=null?e:1/0,r=r!=null?r:1/0,e-r}fetchCachedResultForAst(e){const r=this.computeHashFromAst(e);return this.fetchCachedResult(r)}fetchCachedResult(e){const r=this.cache.get(e);if(r===void 0)throw new Error("There is no AST with such key in the cache");{const{ast:n,hasVolatileFunction:i,hasStructuralChangeFunction:o,relativeDependencies:a}=r;return{ast:n,errors:[],hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:a}}}computeHashFromTokens(e,r){var n;let i="",o=0;for(;o<e.length;){const a=e[o];if(Yt(a,Gs)){const s=_f(this.sheetMapping,a.image,r);s===void 0?i=i.concat(a.image):i=i.concat(s.hash(!0))}else if(Yt(a,DI)){const s=a.image.toUpperCase().slice(0,-1),l=(n=this.lexerConfig.functionMapping[s])!==null&&n!==void 0?n:s;i=i.concat(l,"(")}else if(Yt(a,$I)){const[s,l]=a.image.split(":"),u=tS(this.sheetMapping,s,r),c=tS(this.sheetMapping,l,r);u===void 0||c===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",c.hash(!0))}else if(Yt(a,LI)){const[s,l]=a.image.split(":"),u=rS(this.sheetMapping,s,r),c=rS(this.sheetMapping,l,r);u===void 0||c===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",c.hash(!0))}else i=i.concat(a.image);o++}return i}rememberNewAst(e){const r=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(r,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case F.EMPTY:return e.leadingWhitespace||"";case F.NUMBER:return $t(Ree(e.value,this.config.decimalSeparator),e.leadingWhitespace);case F.STRING:return $t('"'+e.value+'"',e.leadingWhitespace);case F.NAMED_EXPRESSION:return $t(e.expressionName,e.leadingWhitespace);case F.FUNCTION_CALL:{const r=e.args.map(i=>this.computeHashOfAstNode(i)).join(this.config.functionArgSeparator),n=e.procedureName+"("+r+$t(")",e.internalWhitespace);return $t(n,e.leadingWhitespace)}case F.CELL_REFERENCE:return $t(e.reference.hash(!0),e.leadingWhitespace);case F.COLUMN_RANGE:case F.ROW_RANGE:case F.CELL_RANGE:{const r=e.start.hash(e.sheetReferenceType!==qi.RELATIVE),n=e.end.hash(e.sheetReferenceType===qi.BOTH_ABSOLUTE);return $t(r+":"+n,e.leadingWhitespace)}case F.MINUS_UNARY_OP:return $t("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case F.PLUS_UNARY_OP:return $t("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case F.PERCENT_OP:return this.computeHashOfAstNode(e.value)+$t("%",e.leadingWhitespace);case F.ERROR:{const r=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:$.ERROR);return $t(r,e.leadingWhitespace)}case F.ERROR_WITH_RAW_INPUT:return $t(e.rawInput,e.leadingWhitespace);case F.ARRAY:{const r=e.args.map(n=>n.map(i=>this.computeHashOfAstNode(i)).join(",")).join(";");return $t("{"+r+$t("}",e.internalWhitespace),e.leadingWhitespace)}case F.PARENTHESIS:{const n="("+this.computeHashOfAstNode(e.expression)+$t(")",e.internalWhitespace);return $t(n,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+$t(aee[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const r=[],n=e[0];Yt(n,this.lexerConfig.WhiteSpace)||r.push(n);for(let i=1;i<e.length;++i){const o=e[i];if(Yt(o,this.lexerConfig.WhiteSpace))continue;const a=e[i-1];Yt(a,this.lexerConfig.WhiteSpace)&&(o.leadingWhitespace=a),r.push(o)}return r}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Tf=(t,e,r,n)=>{switch(t.type){case F.EMPTY:case F.NUMBER:case F.STRING:case F.ERROR:return;case F.NAMED_EXPRESSION:{n&&r.push(new Ys(t.expressionName));return}case F.CELL_REFERENCE:{n&&r.push(new Eee(t.reference));return}case F.CELL_RANGE:{n&&t.start.sheet===t.end.sheet&&r.push(new Bst(t.start,t.end));return}case F.COLUMN_RANGE:{n&&t.start.sheet===t.end.sheet&&r.push(new Ust(t.start,t.end));return}case F.ROW_RANGE:{n&&t.start.sheet===t.end.sheet&&r.push(new Vst(t.start,t.end));return}case F.PERCENT_OP:case F.PLUS_UNARY_OP:case F.MINUS_UNARY_OP:{Tf(t.value,e,r,!0);return}case F.CONCATENATE_OP:case F.EQUALS_OP:case F.NOT_EQUAL_OP:case F.LESS_THAN_OP:case F.GREATER_THAN_OP:case F.LESS_THAN_OR_EQUAL_OP:case F.GREATER_THAN_OR_EQUAL_OP:case F.MINUS_OP:case F.PLUS_OP:case F.TIMES_OP:case F.DIV_OP:case F.POWER_OP:Tf(t.left,e,r,!0),Tf(t.right,e,r,!0);return;case F.PARENTHESIS:Tf(t.expression,e,r,n);return;case F.FUNCTION_CALL:{const i=!e.doesFunctionNeedArgumentToBeComputed(t.procedureName);t.args.forEach(o=>Tf(o,e,r,i));return}}},mR=(t,e)=>{const r=new Array;return Tf(t,e,r,!0),r};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Eee{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class Bst{constructor(e,r){this.start=e,this.end=r}absolutize(e){return new ze(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class Ust{constructor(e,r){this.start=e,this.end=r}absolutize(e){const r=this.start.toSimpleColumnAddress(e),n=this.end.toSimpleColumnAddress(e);return new ys(r.sheet,r.col,n.col)}}class Vst{constructor(e,r){this.start=e,this.end=r}absolutize(e){const r=this.start.toSimpleRowAddress(e),n=this.end.toSimpleRowAddress(e);return new vs(r.sheet,r.row,n.row)}}class Ys{constructor(e){this.name=e}absolutize(e){return this}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const ea=(t,e)=>t.map(r=>r.absolutize(e)),jst=t=>t.filter(e=>e instanceof Ys?!0:e instanceof ze?!(hi(e.start)||hi(e.end)):!hi(e));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const _t=Symbol("Empty value");function Ne(t){return t instanceof wa?t.val:t}class wa{constructor(e,r){this.val=e,this.format=r}fromNumber(e){return new this.constructor(e)}}function HI(t,e){if(typeof t=="number")return e;{const r=t.fromNumber(e);return r.format=t.format,r}}class BI extends wa{getDetailedType(){return Be.NUMBER_DATE}}class kA extends wa{getDetailedType(){return Be.NUMBER_CURRENCY}}class UI extends wa{getDetailedType(){return Be.NUMBER_TIME}}class VI extends wa{getDetailedType(){return Be.NUMBER_DATETIME}}class A2 extends wa{getDetailedType(){return Be.NUMBER_PERCENT}}function Ft(t){return typeof t=="number"||t instanceof wa}var Be;(function(t){t.NUMBER_RAW="NUMBER_RAW",t.NUMBER_DATE="NUMBER_DATE",t.NUMBER_TIME="NUMBER_TIME",t.NUMBER_DATETIME="NUMBER_DATETIME",t.NUMBER_CURRENCY="NUMBER_CURRENCY",t.NUMBER_PERCENT="NUMBER_PERCENT"})(Be||(Be={}));function Wst(t){return t instanceof wa?t.getDetailedType():Be.NUMBER_RAW}function zst(t){if(t instanceof wa)return t.format}function mS(t){return t instanceof wa?{type:t.getDetailedType(),format:t.format}:{type:Be.NUMBER_RAW}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class je{constructor(e,r,n,i){this._data=e,this.range=r,this.dependencyGraph=n,this._hasOnlyNumbers=i,this.size=e===void 0?new yt(r.effectiveWidth(n),r.effectiveHeight(n)):new yt(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,r,n){return new je(e,r,n,!0)}static onlyNumbers(e){return new je(e,void 0,void 0,!0)}static onlyValues(e){return new je(e,void 0,void 0,void 0)}static onlyRange(e,r){return new je(void 0,e,r,void 0)}static fromScalar(e){return new je([[e]],void 0,void 0,void 0)}isAdHoc(){return this.range===void 0}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let r=0;r<this._data.length;r++)for(let n=0;n<this._data[0].length;n++)e.push(this._data[r][n]);return e}*effectiveAddressesFromData(e){for(let r=0;r<this.data.length;++r){const n=this.data[r];for(let i=0;i<n.length;++i)yield Le(e.sheet,e.col+i,e.row+r)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let r=0;r<this.size.height;++r)for(let n=0;n<this.size.width;++n)yield[this._data[r][n],Le(e.sheet,e.col+n,e.row+r)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(this._hasOnlyNumbers===void 0){this._hasOnlyNumbers=!0;for(const e of this.data)for(const r of e)if(typeof r!="number")return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),(e=this._data)!==null&&e!==void 0?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){this._data===void 0&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{const r=this.dependencyGraph.getCellValue(e);return r instanceof je?(this._hasOnlyNumbers=!1,new x($.VALUE,W.ScalarExpected)):(Ft(r)||(this._hasOnlyNumbers=!1),r)}))}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class cl{constructor(){this.changes=new Map}static empty(){return new cl}addAll(e){for(const r of e.changes.values())this.add(r.address,r);return this}addChange(e,r,n){this.addInterpreterValue(e,r,n)}exportChanges(e){let r=[];return this.changes.forEach(n=>{const i=e.exportChange(n);Array.isArray(i)?r=r.concat(i):r.push(i)}),r}getChanges(){return Array.from(this.changes.values())}isEmpty(){return this.changes.size===0}add(e,r){const n=r.value;if(n instanceof je)for(const i of n.effectiveAddressesFromData(e))this.changes.delete(`${i.sheet},${i.col},${i.row}`);this.changes.set(I2(e),r)}addInterpreterValue(e,r,n){this.add(r,{address:r,value:e,oldValue:n})}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class pi{constructor(e,r,n){if(this.sheet=e,this.rowStart=r,this.rowEnd=n,r<0)throw Error("Starting row cant be less than 0");if(n<r)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,r,n){return new pi(e,r,r+n-1)}static fromRowStartAndEnd(e,r,n){return new pi(e,r,n)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const r=Math.max(this.rowStart,e.rowStart),n=Math.min(this.rowEnd,e.rowEnd);return r>n?null:new pi(this.sheet,r,n)}firstRow(){return new pi(this.sheet,this.rowStart,this.rowStart)}}class Mi{constructor(e,r,n){if(this.sheet=e,this.columnStart=r,this.columnEnd=n,r<0)throw Error("Starting column cant be less than 0");if(n<r)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,r,n){return new Mi(e,r,r+n-1)}static fromColumnStartAndEnd(e,r,n){return new Mi(e,r,n)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const r=Math.max(this.columnStart,e.columnStart),n=Math.min(this.columnEnd,e.columnEnd);return r>n?null:new Mi(this.sheet,r,n)}firstColumn(){return new Mi(this.sheet,this.columnStart,this.columnStart)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var ot;(function(t){t.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",t.PARSER="PARSER",t.GRAPH_BUILD="GRAPH_BUILD",t.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",t.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",t.TOP_SORT="TOP_SORT",t.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",t.EVALUATION="EVALUATION",t.VLOOKUP="VLOOKUP",t.TRANSFORM_ASTS="TRANSFORM_ASTS",t.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",t.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",t.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",t.ADJUSTING_RANGES="ADJUSTING_RANGES",t.ADJUSTING_GRAPH="ADJUSTING_GRAPH",t.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",t.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(ot||(ot={}));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Cee{constructor(){this.stats=new Map([[ot.CRITERION_FUNCTION_FULL_CACHE_USED,0],[ot.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const r=((e=this.stats.get(ot.CRITERION_FUNCTION_FULL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(ot.CRITERION_FUNCTION_FULL_CACHE_USED,r)}incrementCriterionFunctionPartialCacheUsed(){var e;const r=((e=this.stats.get(ot.CRITERION_FUNCTION_PARTIAL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(ot.CRITERION_FUNCTION_PARTIAL_CACHE_USED,r)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(ot.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(ot.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var r;const n=Date.now(),i=this.startTimes.get(e);if(i){let o=(r=this.stats.get(e))!==null&&r!==void 0?r:0;o+=n-i,this.stats.set(e,o),this.startTimes.delete(e)}else throw Error(`Statistics ${e} not started`)}measure(e,r){this.start(e);const n=r();return this.end(e),n}snapshot(){return new Map(this.stats)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Gst extends Cee{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class yr extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class _ee extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class $v extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class Bu extends Error{constructor(){super("Sheet size limit exceeded")}}class $A extends Error{constructor(){super("This is not a formula")}}class Tee extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class Qr extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class Lv extends Error{constructor(e,r){super(`Sheets ${e} and ${r} are not equal.`)}}class Oee extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class Aee extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class Dv extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class xee extends Error{constructor(){super("There is no operation to undo")}}class Iee extends Error{constructor(){super("There is no operation to redo")}}class Mee extends Error{constructor(){super("There is nothing to paste")}}function Yst(t,e){switch(typeof e){case"function":case"symbol":return e.toString();case"bigint":return"BigInt("+e.toString()+")";default:return e instanceof RegExp?"RegExp("+e.toString()+")":e}}class Nee extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,Yst,4)}`)}}class Bt extends Error{constructor(e,r){super(`Expected value of type: ${e} for config parameter: ${r}`)}}class Kst extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class Pee extends Error{constructor(e,r){super(`Config parameter ${e} should be at least ${r}`)}}class kee extends Error{constructor(e,r){super(`Config parameter ${e} should be at most ${r}`)}}class $ee extends Error{constructor(e,r){super(`Expected one of ${e} for config parameter: ${r}`)}}class Lee extends Error{constructor(){super("Computations are suspended")}}class Of extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class Dee extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class LA extends Error{constructor(){super("Language not registered.")}}class Fee extends Error{constructor(){super("Language already registered.")}}class vp extends Error{static functionNotDeclaredInPlugin(e,r){return new vp(`Function with id ${e} not declared in plugin ${r}`)}static functionMethodNotFound(e,r){return new vp(`Function method ${e} not found in plugin ${r}`)}}class Uu extends Error{static cannotRegisterFunctionWithId(e){return new Uu(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new Uu(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new Uu("Cannot unregister protected plugin")}}class Df extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class gS extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class jI extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class qst extends Error{constructor(e,r){super(`Alias id ${e} in plugin ${r} already defined as a function or alias.`)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Xst{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const r=this.mapping.get(e.sheet);if(r===void 0)throw new yr(e.sheet);return r.getCell(e)}fetchCell(e){const r=this.mapping.get(e.sheet);if(r===void 0)throw new yr(e.sheet);const n=r.getCell(e);if(!n)throw Error("Vertex for address missing in AddressMapping");return n}strategyFor(e){const r=this.mapping.get(e);if(r===void 0)throw new yr(e);return r}addSheet(e,r){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,r)}autoAddSheet(e,r,n){const{height:i,width:o,fill:a}=n,s=this.policy.call(a);this.addSheet(e,new s(o,i))}getCellValue(e){const r=this.getCell(e);return r===void 0?_t:r instanceof Ir?r.getArrayCellValue(e):r.getCellValue()}getRawValue(e){const r=this.getCell(e);return r instanceof fl?r.getValues().rawValue:r instanceof Ir?r.getArrayCellRawValue(e):null}setCell(e,r){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized");n.setCell(e,r)}moveCell(e,r){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized.");if(e.sheet!==r.sheet)throw Error("Cannot move cells between sheets.");if(n.has(r))throw new Error("Cannot move cell. Destination already occupied.");const i=n.getCell(e);if(i===void 0)throw new Error("Cannot move cell. No cell with such address.");this.setCell(r,i),this.removeCell(e)}removeCell(e){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.removeCell(e)}has(e){const r=this.mapping.get(e.sheet);return r===void 0?!1:r.has(e)}getHeight(e){const r=this.mapping.get(e);if(r===void 0)throw new yr(e);return r.getHeight()}getWidth(e){const r=this.mapping.get(e);if(!r)throw new yr(e);return r.getWidth()}addRows(e,r,n){const i=this.mapping.get(e);if(i===void 0)throw new yr(e);i.addRows(r,n)}removeRows(e){const r=this.mapping.get(e.sheet);if(r===void 0)throw new yr(e.sheet);r.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,r,n){const i=this.mapping.get(e);if(i===void 0)throw new yr(e);i.addColumns(r,n)}removeColumns(e){const r=this.mapping.get(e.sheet);if(r===void 0)throw new yr(e.sheet);r.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,r]of this.mapping.entries())yield*r.getEntries(e)}*sheetEntries(e){const r=this.mapping.get(e);if(r!==void 0)yield*r.getEntries(e);else throw new yr(e)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Qst{constructor(){this.arrayMapping=new Map}getArray(e){const r=this.getArrayByCorner(e.start);if(r!=null&&r.getRange().sameAs(e))return r}getArrayByCorner(e){return this.arrayMapping.get(I2(e))}setArray(e,r){this.arrayMapping.set(I2(e.start),r)}removeArray(e){typeof e=="string"?this.arrayMapping.delete(e):this.arrayMapping.delete(I2(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[r,n]of this.arrayMapping.entries())n.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[r,n])}*arraysInCols(e){for(const[r,n]of this.arrayMapping.entries())n.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[r,n])}isFormulaArrayInRow(e,r){for(const n of this.arrayMapping.values())if(n.spansThroughSheetRows(e,r))return!0;return!1}isFormulaArrayInAllRows(e){let r=!0;for(const n of e.rows())this.isFormulaArrayInRow(e.sheet,n)||(r=!1);return r}isFormulaArrayInColumn(e,r){for(const n of this.arrayMapping.values())if(n.spansThroughSheetColumn(e,r))return!0;return!1}isFormulaArrayInAllColumns(e){let r=!0;for(const n of e.columns())this.isFormulaArrayInColumn(e.sheet,n)||(r=!1);return r}isFormulaArrayInRange(e){for(const r of this.arrayMapping.values())if(r.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const r of this.arrayMapping.values())if(r.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,r,n){this.updateArrayVerticesInSheet(e,(i,o)=>{const a=o.getRange();return r<=a.start.row?[a.shifted(0,n),o]:void 0})}moveArrayVerticesAfterColumnByColumns(e,r,n){this.updateArrayVerticesInSheet(e,(i,o)=>{const a=o.getRange();return r<=a.start.col?[a.shifted(n,0),o]:void 0})}updateArrayVerticesInSheet(e,r){const n=Array();for(const[i,o]of this.arrayMapping.entries()){if(o.sheet!==e)continue;const a=r(i,o);a!==void 0&&(this.removeArray(i),n.push(a))}n.forEach(([i,o])=>{this.setArray(i,o)})}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Gm{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,r){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class bp{constructor(e){this.size=new yt(e.length>0?e[0].length:0,e.length),this.array=e}static fromInterpreterValue(e){return e instanceof je?new bp(e.data):new bp([[e]])}simpleRangeValue(){return je.onlyValues(this.array)}addRows(e,r){this.array.splice(e,0,...this.nullArrays(r,this.width())),this.size.height+=r}addColumns(e,r){for(let n=0;n<this.height();n++)this.array[n].splice(e,0,...new Array(r).fill(_t));this.size.width+=r}removeRows(e,r){if(this.outOfBound(0,e)||this.outOfBound(0,r))throw Error("Array index out of bound");const n=r-e+1;this.array.splice(e,n),this.size.height-=n}removeColumns(e,r){if(this.outOfBound(e,0)||this.outOfBound(r,0))throw Error("Array index out of bound");const n=r-e+1;for(const i of this.array)i.splice(e,n);this.size.width-=n}nullArrays(e,r){const n=[];for(let i=0;i<e;++i)n.push(new Array(r).fill(_t));return n}get(e,r){if(this.outOfBound(e,r))throw Error("Array index out of bound");return this.array[r][e]}set(e,r,n){if(this.outOfBound(e,r))throw Error("Array index out of bound");this.array[r][e]=n}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height||(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width))throw"Resizing to smaller array"}outOfBound(e,r){return e<0||r<0||r>this.size.height-1||e>this.size.width-1}}class XC{constructor(e,r){this.error=e,this.size=r}get(e,r){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ni{constructor(e,r,n){this.formula=e,this.cellAddress=r,this.version=n}get width(){return 1}get height(){return 1}static fromAst(e,r,n,i){return n.isScalar()?new hs(e,r,i):new Ir(e,r,n,i)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[r,n,i]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=r,this.cellAddress=n,this.version=i}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class Ir extends Ni{constructor(e,r,n,i=0){super(e,r,i),n.isRef?this.array=new XC(new x($.REF,W.NoSpaceForArrayResult),yt.error()):this.array=new Gm(n)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof x)return this.setErrorValue(e),e;const r=bp.fromInterpreterValue(e);return r.resize(this.array.size),this.array=r,e}getCellValue(){if(this.array instanceof Gm)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof Gm))return this.array.simpleRangeValue()}getArrayCellValue(e){const r=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;try{return this.array.get(r,n)}catch{return new x($.REF)}}getArrayCellRawValue(e){const r=this.getArrayCellValue(e);if(!(r instanceof x||r===_t))return Ne(r)}setArrayCellValue(e,r){const n=e.col-this.cellAddress.col,i=e.row-this.cellAddress.row;this.array instanceof bp&&this.array.set(n,i,r)}setNoSpace(){return this.array=new XC(new x($.SPILL,W.NoSpaceForArrayResult),yt.error()),this.getCellValue()}getRange(){return ze.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return ze.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,r,n=r){return this.cellAddress.sheet===e&&this.cellAddress.row<=n&&r<this.cellAddress.row+this.height}spansThroughSheetColumn(e,r,n=r){return this.cellAddress.sheet===e&&this.cellAddress.col<=n&&r<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof Gm)}columnsFromArray(){return Mi.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return pi.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return Hv(this.cellAddress,e)}setErrorValue(e){this.array=new XC(e,this.array.size)}}class hs extends Ni{constructor(e,r,n){super(e,r,n)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(this.cachedCellValue!==void 0)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return this.cachedCellValue!==void 0}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class $n{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,r){this.functionCache.set(e,r)}getCriterionFunctionValue(e,r){var n;return(n=this.getCriterionFunctionValues(e).get(r))===null||n===void 0?void 0:n[0]}getCriterionFunctionValues(e){var r;return(r=this.criterionFunctionCache.get(e))!==null&&r!==void 0?r:new Map}setCriterionFunctionValues(e,r){this.criterionFunctionCache.set(e,r)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Zst=(t,e,r,n,i)=>{if(e instanceof $n){const s=e.range.intersectionWith(r);return s!==void 0?Array.from(s.addresses(i)):[]}let o,a;if(e instanceof Ni)o=e.getFormula(n),a=e.getAddress(n);else return[];return mR(o,t).filter(s=>s instanceof Eee).map(s=>s.dependency.toSimpleCellAddress(a)).filter(s=>r.addressInRange(s))};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var $a;(function(t){t[t.ON_STACK=0]="ON_STACK",t[t.PROCESSED=1]="PROCESSED",t[t.POPPED=2]="POPPED"})($a||($a={}));class Jst{constructor(e){this.dependencyQuery=e,this.nodes=new Set,this.specialNodes=new Set,this.specialNodesStructuralChanges=new Set,this.specialNodesRecentlyChanged=new Set,this.infiniteRanges=new Set,this.edges=new Map}addNode(e){this.nodes.add(e),this.edges.has(e)||this.edges.set(e,new Set)}addEdge(e,r){if(!this.nodes.has(e))throw new Error(`Unknown node ${e}`);if(!this.nodes.has(r))throw new Error(`Unknown node ${r}`);this.edges.get(e).add(r)}removeEdge(e,r){if(this.existsEdge(e,r))this.edges.get(e).delete(r);else throw new Error("Edge does not exist")}softRemoveEdge(e,r){var n;(n=this.edges.get(e))===null||n===void 0||n.delete(r)}removeIncomingEdges(e){this.edges.forEach(r=>{r.delete(e)})}adjacentNodes(e){return this.edges.get(e)}adjacentNodesCount(e){return this.adjacentNodes(e).size}hasNode(e){return this.nodes.has(e)}nodesCount(){return this.nodes.size}edgesCount(){let e=0;return this.edges.forEach(r=>e+=r.size),e}removeNode(e){for(const r of this.adjacentNodes(e).values())this.markNodeAsSpecialRecentlyChanged(r);return this.edges.delete(e),this.nodes.delete(e),this.specialNodes.delete(e),this.specialNodesRecentlyChanged.delete(e),this.specialNodesStructuralChanges.delete(e),this.infiniteRanges.delete(e),this.removeDependencies(e)}markNodeAsSpecial(e){this.specialNodes.add(e)}markNodeAsSpecialRecentlyChanged(e){this.nodes.has(e)&&this.specialNodesRecentlyChanged.add(e)}markNodeAsChangingWithStructure(e){this.specialNodesStructuralChanges.add(e)}clearSpecialNodesRecentlyChanged(){this.specialNodesRecentlyChanged.clear()}markNodeAsInfiniteRange(e){this.infiniteRanges.add(e)}existsEdge(e,r){var n,i;return(i=(n=this.edges.get(e))===null||n===void 0?void 0:n.has(r))!==null&&i!==void 0?i:!1}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(Array.from(this.nodes),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,r,n){const i=new Map,o=new Map,a=new Map,s=new Set,l=new Map,u=[];let c=0;const f=new Set;e.reverse(),e.forEach(m=>{if(l.get(m)!==void 0)return;const g=[m],v=[];for(l.set(m,$a.ON_STACK);g.length>0;){const S=g[g.length-1];switch(l.get(S)){case $a.ON_STACK:{i.set(S,c),o.set(S,c),v.push(S),c++,this.adjacentNodes(S).forEach(b=>{i.get(b)===void 0&&(g.push(b),a.set(b,S),l.set(b,$a.ON_STACK))}),l.set(S,$a.PROCESSED);break}case $a.PROCESSED:{let b;if(b=i.get(S),this.adjacentNodes(S).forEach(E=>{s.has(E)||(a.get(E)===S?b=Math.min(b,o.get(E)):b=Math.min(b,i.get(E)))}),o.set(S,b),b===i.get(S)){const E=[];do E.push(v[v.length-1]),v.pop();while(E[E.length-1]!==S);E.forEach(T=>{s.add(T)}),u.push(...E),E.length>1&&E.forEach(T=>{f.add(T)})}g.pop(),l.set(S,$a.POPPED);break}case $a.POPPED:{g.pop();break}}}});const h=new Set(e),d=[],p=[];return u.reverse(),u.forEach(m=>{f.has(m)||this.adjacentNodes(m).has(m)?(p.push(m),n(m),this.adjacentNodes(m).forEach(g=>h.add(g))):(d.push(m),h.has(m)&&r(m)&&this.adjacentNodes(m).forEach(g=>h.add(g)))}),{sorted:d,cycled:p}}getDependencies(e){const r=[];return this.edges.forEach((n,i)=>{n.has(e)&&r.push(i)}),r}removeDependencies(e){const r=this.dependencyQuery(e);for(const n of r)this.softRemoveEdge(n,e);return r}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class elt{constructor(){this.rangeMapping=new Map}getMappingSize(e){var r,n;return(n=(r=this.rangeMapping.get(e))===null||r===void 0?void 0:r.size)!==null&&n!==void 0?n:0}setRange(e){let r=this.rangeMapping.get(e.getStart().sheet);r===void 0&&(r=new Map,this.rangeMapping.set(e.getStart().sheet,r));const n=x2(e.getStart(),e.getEnd());r.set(n,e)}removeRange(e){const r=e.getStart().sheet,n=this.rangeMapping.get(r);if(n===void 0)return;const i=x2(e.getStart(),e.getEnd());n.delete(i),n.size===0&&this.rangeMapping.delete(r)}getRange(e,r){const n=this.rangeMapping.get(e.sheet),i=x2(e,r);return n==null?void 0:n.get(i)}fetchRange(e,r){const n=this.getRange(e,r);if(!n)throw Error("Range does not exist");return n}truncateRanges(e,r){const n=Array(),i=Array(),o=Array(),a=e.sheet;for(const[l,u]of this.entriesFromSheet(e.sheet)){const c=u.range;e.start<=r(u.range.end)&&(c.removeSpan(e),c.shouldBeRemoved()?(this.removeByKey(a,l),n.push(u)):i.push([l,u]),o.push(u))}const s=[];i.sort((l,u)=>rlt(l[1],u[1],r));for(const[l,u]of i){const c=tlt(u.range);if(c===l)continue;const f=this.getByKey(a,c);this.removeByKey(a,l),f!==void 0&&u!=f?s.push([f,u]):this.setRange(u)}return{verticesToRemove:n,verticesToMerge:s,verticesWithChangedSize:o}}moveAllRangesInSheetAfterRowByRows(e,r,n){return this.updateVerticesFromSheet(e,(i,o)=>r<=o.start.row?(o.range.shiftByRows(n),{changedSize:!1,vertex:o}):r>o.start.row&&r<=o.end.row?(o.range.expandByRows(n),{changedSize:!0,vertex:o}):void 0)}moveAllRangesInSheetAfterColumnByColumns(e,r,n){return this.updateVerticesFromSheet(e,(i,o)=>r<=o.start.col?(o.range.shiftByColumns(n),{changedSize:!1,vertex:o}):r>o.start.col&&r<=o.end.col?(o.range.expandByColumns(n),{changedSize:!0,vertex:o}):void 0)}moveRangesInsideSourceRange(e,r,n,i){this.updateVerticesFromSheet(e.sheet,(o,a)=>{if(e.containsRange(a.range))return a.range.shiftByColumns(r),a.range.shiftByRows(n),a.range.moveToSheet(i),{changedSize:!1,vertex:a}})}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const r=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),r}return[][Symbol.iterator]()}*rangesInSheet(e){const r=this.rangeMapping.get(e);!r||(yield*r.values())}*rangeVerticesContainedInRange(e){for(const r of this.rangesInSheet(e.sheet))e.containsRange(r.range)&&(yield r)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const r=Le(e.end.sheet,e.end.col,e.end.row-1),n=this.getRange(e.start,r);if(n!==void 0){const i=ze.fromSimpleCellAddresses(Le(e.start.sheet,e.start.col,e.end.row),e.end);return{smallerRangeVertex:n,restRange:i}}}return{restRange:e}}*entriesFromSheet(e){const r=this.rangeMapping.get(e);!r||(yield*r.entries())}removeByKey(e,r){this.rangeMapping.get(e).delete(r)}getByKey(e,r){var n;return(n=this.rangeMapping.get(e))===null||n===void 0?void 0:n.get(r)}updateVerticesFromSheet(e,r){const n=Array();for(const[i,o]of this.entriesFromSheet(e)){const a=r(i,o);a!==void 0&&(this.removeByKey(e,i),n.push(a))}return n.forEach(i=>{this.setRange(i.vertex)}),{verticesWithChangedSize:n.filter(i=>i.changedSize).map(i=>i.vertex)}}}function x2(t,e){return`${t.col},${t.row},${e.col},${e.row}`}function tlt(t){return x2(t.start,t.end)}const rlt=(t,e,r)=>{const n=r(t.range.start),i=r(t.range.start);if(n===i){const o=r(t.range.end),a=r(e.range.end);return o-a}else return n-i};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class nlt{constructor(e,r,n){this.functions=e,this.errors=r,this.ui=n,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,r)=>(e[this.functions[r]]=r,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,r)=>(e[this.errors[r]]=r,e),{})}isFunctionTranslated(e){return this.functions[e]!==void 0}getFunctionTranslations(e){const r=[];for(const n of e)this.isFunctionTranslated(n)&&r.push(this.functions[n]);return r}getFunctionTranslation(e){const r=this.functions[e];if(r===void 0)throw new Of(`functions.${e}`);return r}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===$.LIC)return`#${$.LIC}!`;const r=this.errors[e];if(r===void 0)throw new Of(`errors.${e}`);return r}getUITranslation(e){const r=this.ui[e];if(r===void 0)throw new Of(`ui.${e}`);return r}checkUI(){for(const e of Object.values(Fv))if(!(e in this.ui))throw new Of(`ui.${e}`)}checkErrors(){for(const e of Object.values($))if(!(e in this.errors)&&e!==$.LIC)throw new Of(`errors.${e}`)}checkFunctionTranslations(e){const r=new Set(Object.getOwnPropertyNames(e));for(const n of Object.getOwnPropertyNames(this._protectedTranslations))if(r.has(n))throw new Dee(n)}}function ilt(t){return new nlt(Object.assign({},t.functions),Object.assign({},t.errors),Object.assign({},t.ui))}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var Fv;(function(t){t.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"})(Fv||(Fv={}));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Af(t){return t.toLowerCase()}class olt{constructor(e,r){this.id=e,this.displayName=r}get canonicalName(){return Af(this.displayName)}}class alt{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=r=>{const n=this.mappingFromCanonicalName.get(Af(r));if(n===void 0)throw new _ee(r);return n.id},this.get=r=>{var n;return(n=this.mappingFromCanonicalName.get(Af(r)))===null||n===void 0?void 0:n.id},this.fetchDisplayName=r=>this.fetchSheetById(r).displayName,this.sheetNamePrefix=e.getUITranslation(Fv.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const r=Af(e);if(this.mappingFromCanonicalName.has(r))throw new $v(e);this.lastSheetId++;const n=new olt(this.lastSheetId,e);return this.store(n),n.id}removeSheet(e){const r=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(r.canonicalName),this.mappingFromId.delete(r.id)}getDisplayName(e){var r;return(r=this.mappingFromId.get(e))===null||r===void 0?void 0:r.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(Af(e))}renameSheet(e,r){const n=this.fetchSheetById(e),i=n.displayName;if(i===r)return;const o=this.mappingFromCanonicalName.get(Af(r));if(o!==void 0&&o.id!==n.id)throw new $v(r);const a=n.canonicalName;return this.mappingFromCanonicalName.delete(a),n.displayName=r,this.store(n),i}sheetNames(){return Array.from(this.mappingFromId.values()).map(e=>e.displayName)}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const r=this.mappingFromId.get(e);if(r===void 0)throw new yr(e);return r}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class WI{constructor(e,r,n,i,o,a,s,l){this.addressMapping=e,this.rangeMapping=r,this.sheetMapping=n,this.arrayMapping=i,this.stats=o,this.lazilyTransformingAstService=a,this.functionRegistry=s,this.namedExpressions=l,this.changes=cl.empty(),this.dependencyQueryAddresses=u=>{if(u instanceof $n)return this.rangeDependencyQuery(u).map(([c,f])=>c);{const c=this.formulaDependencyQuery(u);if(c!==void 0){const[f,h]=c;return h.map(d=>d instanceof Ys?this.namedExpressions.namedExpressionOrPlaceholder(d.name,f.sheet).address:Br(d)?d:FA(d.start,d.end))}else return[]}},this.dependencyQueryVertices=u=>{if(u instanceof $n)return this.rangeDependencyQuery(u).map(([c,f])=>f);{const c=this.formulaDependencyQuery(u);if(c!==void 0){const[f,h]=c;return h.map(d=>{if(d instanceof ze)return this.rangeMapping.fetchRange(d.start,d.end);if(d instanceof Ys){const p=this.namedExpressions.namedExpressionOrPlaceholder(d.name,f.sheet);return this.addressMapping.fetchCell(p.address)}else return this.addressMapping.fetchCell(d)})}else return[]}},this.rangeDependencyQuery=u=>{const c=[],{smallerRangeVertex:f,restRange:h}=this.rangeMapping.findSmallerRange(u.range);let d;f!==void 0&&this.graph.adjacentNodes(f).has(u)?(d=h,c.push([new ze(f.start,f.end),f])):d=u.range;for(const p of d.addresses(this)){const m=this.addressMapping.getCell(p);m instanceof Ba&&(m.address=p),m!==void 0&&c.push([p,m])}return c},this.formulaDependencyQuery=u=>{let c,f;if(u instanceof Ni)f=u.getAddress(this.lazilyTransformingAstService),c=u.getFormula(this.lazilyTransformingAstService);else return;const h=mR(c,this.functionRegistry);return[f,ea(h,f)]},this.graph=new Jst(this.dependencyQueryVertices)}static buildEmpty(e,r,n,i,o){return new WI(new Xst(r.chooseAddressMappingPolicy),new elt,new alt(r.translationPackage),new Qst,o,e,n,i)}setFormulaToCell(e,r,n,i,o,a){const s=Ni.fromAst(r,e,i,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(s),this.processCellDependencies(n,s),this.graph.markNodeAsSpecialRecentlyChanged(s),o&&this.markAsVolatile(s),a&&this.markAsDependentOnStructureChange(s),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,r){const n=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(n,r),this.addressMapping.setCell(e,r),this.graph.markNodeAsSpecialRecentlyChanged(r),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,r){const n=this.shrinkPossibleArrayAndGetCell(e);if(n instanceof Ir&&this.arrayMapping.removeArray(n.getRange()),n instanceof fl)n.getValues().rawValue!==r.rawValue&&(n.setValues(r),this.graph.markNodeAsSpecialRecentlyChanged(n));else{const i=new fl(r.parsedValue,r.rawValue);this.exchangeOrAddGraphNode(n,i),this.addressMapping.setCell(e,i),this.graph.markNodeAsSpecialRecentlyChanged(i)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const r=this.shrinkPossibleArrayAndGetCell(e);if(r===void 0)return cl.empty();if(this.graph.adjacentNodes(r).size>0){const n=new Ba(e);this.exchangeGraphNode(r,n),this.graph.adjacentNodesCount(n)===0?(this.removeVertex(n),this.addressMapping.removeCell(e)):(this.graph.markNodeAsSpecialRecentlyChanged(n),this.addressMapping.setCell(e,n))}else this.removeVertex(r),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}ensureThatVertexIsNonArrayCellVertex(e){if(e instanceof Ir)throw new Error("Illegal operation")}clearRecentlyChangedVertices(){this.graph.clearSpecialNodesRecentlyChanged()}verticesToRecompute(){return new Set([...this.graph.specialNodesRecentlyChanged,...this.volatileVertices()])}processCellDependencies(e,r){e.forEach(n=>{if(n instanceof ze){const i=n;let o=this.getRange(i.start,i.end);o===void 0&&(o=new $n(i),this.rangeMapping.setRange(o)),this.graph.addNode(o),i.isFinite()||this.graph.markNodeAsInfiniteRange(o);const{smallerRangeVertex:a,restRange:s}=this.rangeMapping.findSmallerRange(i);if(a!==void 0){if(this.graph.addEdge(a,o),o.bruteForce){o.bruteForce=!1;for(const u of i.addresses(this))this.graph.removeEdge(this.fetchCell(u),o)}}else o.bruteForce=!0;const l=this.arrayMapping.getArray(s);if(l!==void 0)this.graph.addEdge(l,o);else for(const u of s.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(u),o);this.graph.addEdge(o,r),i.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(o)}else if(n instanceof Ys){const i=r.getAddress(this.lazilyTransformingAstService).sheet,o=this.fetchNamedExpressionVertex(n.name,i);this.graph.addEdge(o,r)}else this.graph.addEdge(this.fetchCellOrCreateEmpty(n),r)})}fetchNamedExpressionVertex(e,r){const n=this.namedExpressions.namedExpressionOrPlaceholder(e,r);return this.fetchCellOrCreateEmpty(n.address)}exchangeNode(e,r){const n=this.fetchCellOrCreateEmpty(e),i=this.fetchCellOrCreateEmpty(r);this.addressMapping.removeCell(e),this.exchangeGraphNode(n,i)}correctInfiniteRangesDependency(e){let r;for(const n of this.graph.infiniteRanges){const i=n;i.range.addressInRange(e)&&(r=r!=null?r:this.fetchCellOrCreateEmpty(e),this.graph.addEdge(r,i))}}fetchCellOrCreateEmpty(e){let r=this.addressMapping.getCell(e);return r===void 0&&(r=new Ba(e),this.graph.addNode(r),this.addressMapping.setCell(e,r)),r}removeRows(e){this.stats.measure(ot.ADJUSTING_GRAPH,()=>{for(const[n,i]of this.addressMapping.entriesFromRowsSpan(e)){for(const o of this.graph.adjacentNodes(i))this.graph.markNodeAsSpecialRecentlyChanged(o);if(i instanceof Ir)if(i.isLeftCorner(n))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(ot.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(e)});const r=this.stats.measure(ot.ADJUSTING_RANGES,()=>{const n=this.truncateRanges(e,i=>i.row);return this.getArrayVerticesRelatedToRanges(n)});return this.stats.measure(ot.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:r,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){this.clearSheet(e);for(const[r,n]of this.addressMapping.sheetEntries(e)){for(const i of this.graph.adjacentNodes(n))this.graph.markNodeAsSpecialRecentlyChanged(i);this.removeVertex(n),this.addressMapping.removeCell(r)}this.stats.measure(ot.ADJUSTING_RANGES,()=>{const r=this.rangeMapping.removeRangesInSheet(e);for(const n of r)this.removeVertex(n);this.stats.measure(ot.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeSheet(e)})})}clearSheet(e){const r=new Set;for(const[n,i]of this.addressMapping.sheetEntries(e))i instanceof Ir?r.add(i):this.setCellEmpty(n);for(const n of r.values())this.setArrayEmpty(n);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(ot.ADJUSTING_GRAPH,()=>{for(const[n,i]of this.addressMapping.entriesFromColumnsSpan(e)){for(const o of this.graph.adjacentNodes(i))this.graph.markNodeAsSpecialRecentlyChanged(o);if(i instanceof Ir)if(i.isLeftCorner(n))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(ot.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(e)});const r=this.stats.measure(ot.ADJUSTING_RANGES,()=>{const n=this.truncateRanges(e,i=>i.col);return this.getArrayVerticesRelatedToRanges(n)});return this.stats.measure(ot.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:r,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(ot.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});const r=this.stats.measure(ot.ADJUSTING_RANGES,()=>{const n=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(n.verticesWithChangedSize)});this.stats.measure(ot.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)});for(const n of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsSpecialRecentlyChanged(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:r}}addColumns(e){this.stats.measure(ot.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});const r=this.stats.measure(ot.ADJUSTING_RANGES,()=>{const n=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(n.verticesWithChangedSize)});this.stats.measure(ot.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns));for(const n of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsSpecialRecentlyChanged(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:r,contentChanges:this.getAndClearContentChanges()}}ensureNoArrayInRange(e){if(this.arrayMapping.isFormulaArrayInRange(e))throw Error("It is not possible to move / replace cells with array")}isThereSpaceForArray(e){const r=e.getRangeOrUndef();if(r===void 0)return!1;for(const n of r.addresses(this)){const i=this.addressMapping.getCell(n);if(i!==void 0&&!(i instanceof Ba)&&i!==e)return!1}return!0}moveCells(e,r,n,i){for(const o of e.addressesWithDirection(r,n,this)){const a=Le(i,o.col+r,o.row+n);let s=this.addressMapping.getCell(o);const l=this.addressMapping.getCell(a);if(this.addressMapping.removeCell(o),s!==void 0){this.graph.markNodeAsSpecialRecentlyChanged(s),this.addressMapping.setCell(a,s);let u;for(const c of this.graph.adjacentNodes(s))c instanceof $n&&!e.containsRange(c.range)&&(u=u!=null?u:this.fetchCellOrCreateEmpty(o),this.graph.addEdge(u,c),this.graph.removeEdge(s,c));u&&(this.graph.markNodeAsSpecialRecentlyChanged(u),this.addressMapping.setCell(o,u))}if(l!==void 0){s===void 0&&this.addressMapping.removeCell(a);for(const u of this.graph.adjacentNodes(l))s=s!=null?s:this.fetchCellOrCreateEmpty(a),this.graph.addEdge(s,u),this.graph.markNodeAsSpecialRecentlyChanged(s);this.removeVertex(l)}}for(const o of this.rangeMapping.rangeVerticesContainedInRange(e))for(const a of this.graph.adjacentNodes(o))if(a instanceof $n&&!e.containsRange(a.range)){this.graph.removeEdge(o,a);for(const s of o.range.addresses(this)){const l=this.fetchCellOrCreateEmpty(s);this.graph.addEdge(l,a),this.addressMapping.setCell(s,l),this.graph.markNodeAsSpecialRecentlyChanged(l)}}this.rangeMapping.moveRangesInsideSourceRange(e,r,n,i)}setArrayEmpty(e){const r=ze.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),n=this.graph.adjacentNodes(e);for(const i of r.addresses(this))this.addressMapping.removeCell(i);for(const i of n.values()){const o=Zst(this.functionRegistry,i,e.getRange(),this.lazilyTransformingAstService,this);for(const a of o){const s=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(s,i)}o.length>0&&this.graph.markNodeAsSpecialRecentlyChanged(i)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,r){this.graph.addNode(r),this.addressMapping.setCell(e,r)}addArrayVertex(e,r){this.graph.addNode(r),this.setAddressMappingForArrayVertex(r,e)}*arrayFormulaNodes(){for(const e of this.graph.nodes)e instanceof Ir&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}existsVertex(e){return this.addressMapping.has(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const r=this.addressMapping.getCellValue(e);return r instanceof je?new x($.VALUE,W.ScalarExpected):r}existsEdge(e,r){return this.graph.existsEdge(e,r)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}setArray(e,r){this.arrayMapping.setArray(e,r)}getRange(e,r){return this.rangeMapping.getRange(e,r)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsSpecial(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.nodes.values())e instanceof hs&&e.ensureRecentData(this.lazilyTransformingAstService)}volatileVertices(){return this.graph.specialNodes}getArrayVerticesRelatedToRanges(e){const r=e.map(n=>this.graph.hasNode(n)?Array.from(this.graph.adjacentNodes(n)).filter(i=>i instanceof Ir):[]);return new Set(...r)}*rawValuesFromRange(e){for(const r of e.addresses(this)){const n=this.getScalarValue(r);n!==_t&&(yield[Ne(n),r])}}*entriesFromRange(e){for(const r of e.addresses(this))yield[r,this.getCell(r)]}exchangeGraphNode(e,r){this.graph.addNode(r);const n=this.graph.adjacentNodes(e);this.removeVertex(e),n.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(r,i)})}exchangeOrAddGraphNode(e,r){e?this.exchangeGraphNode(e,r):this.graph.addNode(r)}computeListOfValuesInRange(e){const r=[];for(const n of e.addresses(this)){const i=this.getScalarValue(n);r.push(i)}return r}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const r of this.adjacentArrayVertices(e)){let n;r instanceof Ni?n=this.formulaDirectDependenciesToArray(r,e):n=this.rangeDirectDependenciesToArray(r,e);let i=!1;for(const[o,a]of n)e.isLeftCorner(o)&&(i=!0),this.graph.addEdge(a,r),this.graph.markNodeAsSpecialRecentlyChanged(a);i||this.graph.removeEdge(e,r)}this.graph.markNodeAsSpecialRecentlyChanged(e)}isArrayInternalCell(e){const r=this.getCell(e);return r instanceof Ir&&!r.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=cl.empty(),e}getAdjacentNodesAddresses(e){const r=this.graph.adjacentNodes(e),n=[];return r.forEach(i=>{const o=i;o instanceof $n?n.push(FA(o.start,o.end)):n.push(o.getAddress(this.lazilyTransformingAstService))}),n}correctInfiniteRangesDependenciesByRangeVertex(e){for(const r of this.graph.infiniteRanges){const n=r,i=e.range.intersectionWith(n.range);if(i!==void 0)for(const o of i.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(o),r)}}cleanAddressMappingUnderArray(e){const r=e.getRange();for(const n of r.addresses(this)){const i=e.getArrayCellValue(n);this.getCell(n)===e?e.isLeftCorner(n)?this.changes.addChange(new x($.REF),n,i):(this.addressMapping.removeCell(n),this.changes.addChange(_t,n,i)):this.changes.addChange(_t,n,i)}}*formulaDirectDependenciesToArray(e,r){var n;const[,i]=(n=this.formulaDependencyQuery(e))!==null&&n!==void 0?n:[];if(i!==void 0){for(const o of i)if(!(o instanceof Ys||o instanceof ze)&&r.getRange().addressInRange(o)){const a=this.fetchCellOrCreateEmpty(o);yield[o,a]}}}*rangeDirectDependenciesToArray(e,r){const{restRange:n}=this.rangeMapping.findSmallerRange(e.range);for(const i of n.addresses(this))if(r.getRange().addressInRange(i)){const o=this.fetchCellOrCreateEmpty(i);yield[i,o]}}*adjacentArrayVertices(e){const r=this.graph.adjacentNodes(e);for(const n of r)(n instanceof Ni||n instanceof $n)&&(yield n)}addStructuralNodesToChangeSet(){for(const e of this.graph.specialNodesStructuralChanges)this.graph.markNodeAsSpecialRecentlyChanged(e)}fixRangesWhenAddingRows(e,r,n){const i=Array.from(this.rangeMapping.rangesInSheet(e));for(const o of i)if(o.range.includesRow(r+n))if(o.bruteForce){const a=o.range.rangeWithSameWidth(r,n);for(const s of a.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(s),o)}else{let a=o,s=this.rangeMapping.findSmallerRange(a.range);if(s.smallerRangeVertex!==void 0)continue;for(;s.smallerRangeVertex===void 0;){const l=new $n(ze.spanFrom(a.range.start,a.range.width(),a.range.height()-1));this.rangeMapping.setRange(l),this.graph.addNode(l);const u=new ze(Le(a.range.start.sheet,a.range.start.col,a.range.end.row),a.range.end);this.addAllFromRange(u,a),this.graph.addEdge(l,a),a=l,s=this.rangeMapping.findSmallerRange(a.range)}this.graph.addEdge(s.smallerRangeVertex,a),this.addAllFromRange(s.restRange,a),this.graph.removeEdge(s.smallerRangeVertex,o)}}addAllFromRange(e,r){for(const n of e.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(n),r)}fixRangesWhenAddingColumns(e,r,n){for(const i of this.rangeMapping.rangesInSheet(e))if(i.range.includesColumn(r+n)){let o;i.bruteForce?o=i.range.rangeWithSameHeight(r,n):o=ze.spanFrom(Le(e,r,i.range.end.row),n,1);for(const a of o.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(a),i)}}exchangeOrAddFormulaVertex(e){const r=e.getAddress(this.lazilyTransformingAstService),n=ze.spanFrom(r,e.width,e.height),i=this.shrinkPossibleArrayAndGetCell(r);if(e instanceof Ir&&this.setArray(n,e),this.exchangeOrAddGraphNode(i,e),this.addressMapping.setCell(r,e),e instanceof Ir){if(!this.isThereSpaceForArray(e))return;for(const o of n.addresses(this)){if(e.isLeftCorner(o))continue;const a=this.getCell(o);this.exchangeOrAddGraphNode(a,e)}}for(const o of n.addresses(this))this.addressMapping.setCell(o,e)}setAddressMappingForArrayVertex(e,r){if(this.addressMapping.setCell(r,e),!(e instanceof Ir))return;const n=ze.spanFromOrUndef(r,e.width,e.height);if(n!==void 0&&(this.setArray(n,e),!!this.isThereSpaceForArray(e)))for(const i of n.addresses(this))this.addressMapping.setCell(i,e)}truncateRanges(e,r){const{verticesToRemove:n,verticesToMerge:i,verticesWithChangedSize:o}=this.rangeMapping.truncateRanges(e,r);for(const[a,s]of i)this.mergeRangeVertices(a,s);for(const a of n)this.removeVertexAndCleanupDependencies(a);return o}fixArraysAfterAddingRow(e,r,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,r,n),!(r<=0))for(const[,i]of this.arrayMapping.arraysInRows(pi.fromRowStartAndEnd(e,r-1,r-1))){const o=i.getRange();for(let a=o.start.col;a<=o.end.col;++a)for(let s=r;s<=o.end.row;++s){const l=Le(e,a,s),u=Le(e,a,s+n),c=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(_t,u,c)}}}fixArraysAfterRemovingRows(e,r,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,r,-n),!(r<=0))for(const[,i]of this.arrayMapping.arraysInRows(pi.fromRowStartAndEnd(e,r-1,r-1)))if(this.isThereSpaceForArray(i))for(const o of i.getRange().addresses(this))this.addressMapping.setCell(o,i);else this.setNoSpaceIfArray(i)}fixArraysAfterAddingColumn(e,r,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,r,n),!(r<=0))for(const[,i]of this.arrayMapping.arraysInCols(Mi.fromColumnStartAndEnd(e,r-1,r-1))){const o=i.getRange();for(let a=o.start.row;a<=o.end.row;++a)for(let s=r;s<=o.end.col;++s){const l=Le(e,s,a),u=Le(e,s+n,a),c=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(_t,u,c)}}}fixArraysAfterRemovingColumns(e,r,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,r,-n),!(r<=0))for(const[,i]of this.arrayMapping.arraysInCols(Mi.fromColumnStartAndEnd(e,r-1,r-1)))if(this.isThereSpaceForArray(i))for(const o of i.getRange().addresses(this))this.addressMapping.setCell(o,i);else this.setNoSpaceIfArray(i)}shrinkPossibleArrayAndGetCell(e){const r=this.getCell(e);return r instanceof Ir?(this.setNoSpaceIfArray(r),this.getCell(e)):r}setNoSpaceIfArray(e){e instanceof Ir&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof $n&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,r){const n=this.graph.adjacentNodes(r);this.removeVertexAndCleanupDependencies(r),this.graph.softRemoveEdge(e,r),n.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(e,i)})}removeVertexAndCleanupDependencies(e){const r=new Set(this.graph.removeNode(e));for(;r.size>0;){const n=r.values().next().value;r.delete(n),this.graph.hasNode(n)&&this.graph.adjacentNodesCount(n)===0&&((n instanceof $n||n instanceof Ba)&&this.graph.removeNode(n).forEach(i=>r.add(i)),n instanceof $n?this.rangeMapping.removeRange(n):n instanceof Ba&&this.addressMapping.removeCell(n.address))}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ba{constructor(e){this.address=e}getCellValue(){return _t}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class fl{constructor(e,r){this.parsedValue=e,this.rawValue=r}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}setCellValue(e){throw"SetCellValue is deprecated for ValueCellVertex"}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class rh{constructor(e,r){this.errors=e,this.rawInput=r}getCellValue(){return x.parsingError()}getFormula(){return this.rawInput}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class slt{constructor(e,r){this.width=e,this.height=r,this.mapping=new Map}getCell(e){var r;return(r=this.mapping.get(e.col))===null||r===void 0?void 0:r.get(e.row)}setCell(e,r){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let n=this.mapping.get(e.col);n||(n=new Map,this.mapping.set(e.col,n)),n.set(e.row,r)}has(e){var r;return!!(!((r=this.mapping.get(e.col))===null||r===void 0)&&r.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var r;(r=this.mapping.get(e.col))===null||r===void 0||r.delete(e.row)}addRows(e,r){this.mapping.forEach(n=>{const i=new Map;n.forEach((o,a)=>{a>=e&&(i.set(a+r,o),n.delete(a))}),i.forEach((o,a)=>{n.set(a,o)})}),this.height+=r}addColumns(e,r){const n=new Map;this.mapping.forEach((i,o)=>{o>=e&&(n.set(o+r,i),this.mapping.delete(o))}),n.forEach((i,o)=>{this.mapping.set(o,i)}),this.width+=r}removeRows(e){this.mapping.forEach(i=>{const o=new Map;i.forEach((a,s)=>{s>=e.rowStart&&(i.delete(s),s>e.rowEnd&&o.set(s-e.numberOfRows,a))}),o.forEach((a,s)=>{i.set(s,a)})});const r=Math.min(this.height-1,e.rowEnd),n=Math.max(0,r-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){const r=new Map;this.mapping.forEach((o,a)=>{a>=e.columnStart&&(this.mapping.delete(a),a>e.columnEnd&&r.set(a-e.numberOfColumns,o))}),r.forEach((o,a)=>{this.mapping.set(a,o)});const n=Math.min(this.width-1,e.columnEnd),i=Math.max(0,n-e.columnStart+1);this.width=Math.max(0,this.width-i)}*getEntries(e){for(const[r,n]of this.mapping)for(const[i,o]of n)yield[Le(e,r,i),o]}*verticesFromColumn(e){const r=this.mapping.get(e);if(r!==void 0)for(const[n,i]of r)yield i}*verticesFromRow(e){for(const r of this.mapping.values()){const n=r.get(e);n!==void 0&&(yield n)}}*verticesFromColumnsSpan(e){for(const r of e.columns()){const n=this.mapping.get(r);if(n!==void 0)for(const[i,o]of n)yield o}}*verticesFromRowsSpan(e){for(const r of this.mapping.values())for(const n of e.rows()){const i=r.get(n);i!==void 0&&(yield i)}}*entriesFromRowsSpan(e){for(const[r,n]of this.mapping.entries())for(const i of e.rows()){const o=n.get(i);o!==void 0&&(yield[Le(e.sheet,r,i),o])}}*entriesFromColumnsSpan(e){for(const r of e.columns()){const n=this.mapping.get(r);if(n!==void 0)for(const[i,o]of n.entries())yield[Le(e.sheet,r,i),o]}}*vertices(){for(const[e,r]of this.mapping)for(const[n,i]of r)i!==void 0&&(yield i)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class llt{constructor(e,r){this.width=e,this.height=r,this.mapping=new Array(r);for(let n=0;n<r;n++)this.mapping[n]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,r){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=r}has(e){const r=this.mapping[e.row];return r?!!r[e.col]:!1}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){this.mapping[e.row]!==void 0&&delete this.mapping[e.row][e.col]}addRows(e,r){const n=[];for(let i=0;i<r;i++)n.push(new Array(this.width));this.mapping.splice(e,0,...n),this.height+=r}addColumns(e,r){for(let n=0;n<this.height;n++)this.mapping[n].splice(e,0,...new Array(r));this.width+=r}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const r=Math.min(this.height-1,e.rowEnd),n=Math.max(0,r-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){for(let i=0;i<this.height;i++)this.mapping[i].splice(e.columnStart,e.numberOfColumns);const r=Math.min(this.width-1,e.columnEnd),n=Math.max(0,r-e.columnStart+1);this.width=Math.max(0,this.width-n)}*getEntries(e){for(let r=0;r<this.height;++r)for(let n=0;n<this.width;++n){const i=this.getCellVertex(n,r);i&&(yield[Le(e,n,r),i])}}*verticesFromColumn(e){for(let r=0;r<this.height;++r){const n=this.getCellVertex(e,r);n&&(yield n)}}*verticesFromRow(e){for(let r=0;r<this.width;++r){const n=this.getCellVertex(r,e);n&&(yield n)}}*verticesFromColumnsSpan(e){for(let r=e.columnStart;r<=e.columnEnd;++r)for(let n=0;n<this.height;++n){const i=this.getCellVertex(r,n);i&&(yield i)}}*verticesFromRowsSpan(e){for(let r=0;r<this.width;++r)for(let n=e.rowStart;n<=e.rowEnd;++n){const i=this.getCellVertex(r,n);i&&(yield i)}}*entriesFromRowsSpan(e){for(let r=0;r<this.width;++r)for(let n=e.rowStart;n<=e.rowEnd;++n){const i=this.getCellVertex(r,n);i&&(yield[Le(e.sheet,r,n),i])}}*entriesFromColumnsSpan(e){for(let r=0;r<this.height;++r)for(let n=e.columnStart;n<=e.columnEnd;++n){const i=this.getCellVertex(n,r);i&&(yield[Le(e.sheet,n,r),i])}}*vertices(){for(let e=0;e<this.height;++e)for(let r=0;r<this.width;++r){const n=this.getCellVertex(r,e);n&&(yield n)}}getCellVertex(e,r){var n;return(n=this.mapping[r])===null||n===void 0?void 0:n[e]}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var $;(function(t){t.DIV_BY_ZERO="DIV_BY_ZERO",t.NAME="NAME",t.VALUE="VALUE",t.NUM="NUM",t.NA="NA",t.CYCLE="CYCLE",t.REF="REF",t.SPILL="SPILL",t.LIC="LIC",t.ERROR="ERROR"})($||($={}));var ui;(function(t){t.FORMULA="FORMULA",t.VALUE="VALUE",t.ARRAY="ARRAY",t.EMPTY="EMPTY",t.ARRAYFORMULA="ARRAYFORMULA"})(ui||(ui={}));const ult=(t,e)=>t instanceof Ir?t.isLeftCorner(e)?ui.ARRAYFORMULA:ui.ARRAY:t instanceof hs||t instanceof rh?ui.FORMULA:t instanceof fl?ui.VALUE:ui.EMPTY;var yS;(function(t){t.EMPTY="EMPTY",t.NUMBER="NUMBER",t.STRING="STRING",t.BOOLEAN="BOOLEAN",t.ERROR="ERROR"})(yS||(yS={}));var DA;(function(t){t.NUMBER="NUMBER"})(DA||(DA={}));const To=Object.assign(Object.assign({},yS),DA),clt=Object.assign(Object.assign({},yS),Be),BV=t=>{switch(t){case To.EMPTY:return 0;case To.NUMBER:return 1;case To.STRING:return 2;case To.BOOLEAN:return 3;case To.ERROR:return 4}throw new Error("Cell value not computed")},vS=t=>{if(t===_t)return To.EMPTY;if(t instanceof x||t instanceof je)return To.ERROR;if(typeof t=="string")return To.STRING;if(Ft(t))return To.NUMBER;if(typeof t=="boolean")return To.BOOLEAN;throw new Error("Cell value not computed")},flt=t=>Ft(t)?Wst(t):vS(t),hlt=t=>{if(Ft(t))return zst(t)};class x{constructor(e,r,n){this.type=e,this.message=r,this.root=n}static parsingError(){return new x($.ERROR,W.ParseError)}attachRootVertex(e){return this.root===void 0?new x(this.type,this.message,e):this}}const Hee=(t,e)=>({sheet:t,row:e}),dlt=t=>t.row<0,Bee=(t,e)=>({sheet:t,col:e}),plt=t=>t.col<0,Le=(t,e,r)=>({sheet:t,col:e,row:r}),hi=t=>t.col<0||t.row<0,mlt=(t,e,r,n)=>Le(e,t.col+r,t.row+n),I2=t=>`${t.sheet},${t.row},${t.col}`;function Br(t){return t&&(typeof t=="object"||typeof t=="function")?"col"in t&&typeof t.col=="number"&&"row"in t&&typeof t.row=="number"&&"sheet"in t&&typeof t.sheet=="number":!1}const xo=(t,e)=>{var r;return(r=t.sheet)!==null&&r!==void 0?r:e.sheet},Hv=(t,e)=>t.sheet===e.sheet&&t.col===e.col&&t.row===e.row;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const glt="AbsoluteCellRange: Wrong range size";function Ti(t){return t&&(typeof t=="object"||typeof t=="function")?"start"in t&&Br(t.start)&&"end"in t&&Br(t.end):!1}const FA=(t,e)=>({start:t,end:e});class ze{constructor(e,r){if(e.sheet!==r.sheet)throw new Lv(e.sheet,r.sheet);this.start=Le(e.sheet,e.col,e.row),this.end=Le(r.sheet,r.col,r.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,r){if(e.sheet!==r.sheet)throw new Lv(e.sheet,r.sheet);const n=r.col-e.col,i=r.row-e.row;return Number.isFinite(i)&&Number.isFinite(n)?new ze(e,r):Number.isFinite(i)?new vs(e.sheet,e.row,r.row):new ys(e.sheet,e.col,r.col)}static fromAst(e,r){return e.type===F.CELL_RANGE?ze.fromCellRange(e,r):e.type===F.COLUMN_RANGE?ys.fromColumnRange(e,r):vs.fromRowRangeAst(e,r)}static fromAstOrUndef(e,r){try{return ze.fromAst(e,r)}catch{return}}static fromCellRange(e,r){return new ze(e.start.toSimpleCellAddress(r),e.end.toSimpleCellAddress(r))}static spanFrom(e,r,n){const i=ze.spanFromOrUndef(e,r,n);if(i===void 0)throw new Error(glt);return i}static spanFromOrUndef(e,r,n){if(!Number.isFinite(r)&&Number.isFinite(n))return e.col!==0?void 0:new vs(e.sheet,e.row,e.row+n-1);if(!Number.isFinite(n)&&Number.isFinite(r))return e.row!==0?void 0:new ys(e.sheet,e.col,e.col+r-1);if(Number.isFinite(n)&&Number.isFinite(r))return new ze(e,Le(e.sheet,e.col+r-1,e.row+n-1))}static fromCoordinates(e,r,n,i,o){return new ze(Le(e,r,n),Le(e,i,o))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet!==e.sheet?!1:this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const r=Math.max(this.start.row,e.start.row),n=Math.min(this.end.row,e.end.row),i=Math.max(this.start.col,e.start.col),o=Math.min(this.end.col,e.end.col);if(!(r>n||i>o))return new ze(Le(this.sheet,i,r),Le(this.sheet,o,n))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,r){return ze.spanFrom(Le(this.sheet,this.start.col+e,this.start.row+r),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof pi?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,r){return ze.spanFrom(Le(this.sheet,this.start.col,e),this.width(),r)}rangeWithSameHeight(e,r){return ze.spanFrom(Le(this.sheet,e,this.start.row),r,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let r=0;r<this.height();++r){e[r]=[];for(let n=0;n<this.width();++n){const i=Le(this.sheet,this.start.col+n,this.start.row+r);e[r].push(i)}}return e}withStart(e){return new ze(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return Hv(this.start,e.start)&&Hv(this.end,e.end)}addressesArrayMap(e,r){const n=[];let i=this.start.row;for(;i<=this.effectiveEndRow(e);){let o=this.start.col;const a=[];for(;o<=this.effectiveEndColumn(e);)a.push(r(Le(this.start.sheet,o,i))),o++;n.push(a),i++}return n}addresses(e){const r=[];let n=this.start.row;const i=this.effectiveEndRow(e),o=this.effectiveEndColumn(e);for(;n<=i;){let a=this.start.col;for(;a<=o;)r.push(Le(this.start.sheet,a,n)),a++;n++}return r}*addressesWithDirection(e,r,n){if(e>0)if(r>0){let i=this.effectiveEndRow(n);for(;i>=this.start.row;){let o=this.effectiveEndColumn(n);for(;o>=this.start.col;)yield Le(this.start.sheet,o,i),o-=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(n);){let o=this.effectiveEndColumn(n);for(;o>=this.start.col;)yield Le(this.start.sheet,o,i),o-=1;i+=1}}else if(r>0){let i=this.effectiveEndRow(n);for(;i>=this.start.row;){let o=this.start.col;for(;o<=this.effectiveEndColumn(n);)yield Le(this.start.sheet,o,i),o+=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(n);){let o=this.start.col;for(;o<=this.effectiveEndColumn(n);)yield Le(this.start.sheet,o,i),o+=1;i+=1}}}getAddress(e,r){if(e<0||r<0||r>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return Le(this.start.sheet,this.start.col+e,this.start.row+r)}exceedsSheetSizeLimits(e,r){return this.end.col>=e||this.end.row>=r}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,r){if(!(e>this.end.row)){if(r<this.start.row){const n=r-e+1;return this.shiftByRows(-n)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(r,this.end.row)-e+1}}removeColumns(e,r){if(!(e>this.end.col)){if(r<this.start.col){const n=r-e+1;return this.shiftByColumns(-n)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(r,this.end.col)-e+1}}}class ys extends ze{constructor(e,r,n){super(Le(e,r,0),Le(e,n,Number.POSITIVE_INFINITY))}static fromColumnRange(e,r){const n=e.start.toSimpleColumnAddress(r),i=e.end.toSimpleColumnAddress(r);if(n.sheet!==i.sheet)throw new Lv(n.sheet,i.sheet);return new ys(n.sheet,n.col,i.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,r){return new ys(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,r){return new ys(this.sheet,e,e+r-1)}exceedsSheetSizeLimits(e,r){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,r){}}class vs extends ze{constructor(e,r,n){super(Le(e,0,r),Le(e,Number.POSITIVE_INFINITY,n))}static fromRowRangeAst(e,r){const n=e.start.toSimpleRowAddress(r),i=e.end.toSimpleRowAddress(r);if(n.sheet!==i.sheet)throw new Lv(n.sheet,i.sheet);return new vs(n.sheet,n.row,i.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,r){return new vs(this.sheet,this.start.row+r,this.end.row+r)}rangeWithSameWidth(e,r){return new vs(this.sheet,e,e+r-1)}exceedsSheetSizeLimits(e,r){return this.end.row>=r}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,r){}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class aa{constructor(e,r,n){this.formulaAddress=e,this.arraysFlag=r,this.formulaVertex=n}}var Uee={exports:{}};(function(t){(function(e){for(var r=[null,0,{}],n=10,i=44032,o=4352,a=4449,s=4519,l=19,u=21,c=28,f=u*c,h=l*f,d=function(O,y){this.codepoint=O,this.feature=y},p={},m=[],g=0;g<=255;++g)m[g]=0;function v(O,y,R){var C=p[y];return C||(C=O(y,R),!!C.feature&&++m[y>>8&255]>n&&(p[y]=C)),C}function S(O,y,R){var C=y&65280,A=d.udata[C]||{},P=A[y];return P?new d(y,P):new d(y,r)}function b(O,y,R){return R?O(y,R):new d(y,null)}function E(O,y,R){var C;if(y<o||o+l<=y&&y<i||i+h<y)return O(y,R);if(o<=y&&y<o+l){var A={},P=(y-o)*u;for(C=0;C<u;++C)A[a+C]=i+c*(C+P);return new d(y,[,,A])}var H=y-i,Y=H%c,z=[];if(Y!==0)z[0]=[i+H-Y,s+Y];else for(z[0]=[o+Math.floor(H/f),a+Math.floor(H%f/c)],z[2]={},C=1;C<c;++C)z[2][s+C]=y+C;return new d(y,z)}function T(O,y,R){return y<60||13311<y&&y<42607?new d(y,r):O(y,R)}var N=[T,v,b,E,S];d.fromCharCode=N.reduceRight(function(O,y){return function(R,C){return y(O,R,C)}},null),d.isHighSurrogate=function(O){return O>=55296&&O<=56319},d.isLowSurrogate=function(O){return O>=56320&&O<=57343},d.prototype.prepFeature=function(){this.feature||(this.feature=d.fromCharCode(this.codepoint,!0).feature)},d.prototype.toString=function(){if(this.codepoint<65536)return String.fromCharCode(this.codepoint);var O=this.codepoint-65536;return String.fromCharCode(Math.floor(O/1024)+55296,O%1024+56320)},d.prototype.getDecomp=function(){return this.prepFeature(),this.feature[0]||null},d.prototype.isCompatibility=function(){return this.prepFeature(),!!this.feature[1]&&this.feature[1]&1<<8},d.prototype.isExclude=function(){return this.prepFeature(),!!this.feature[1]&&this.feature[1]&1<<9},d.prototype.getCanonicalClass=function(){return this.prepFeature(),this.feature[1]?this.feature[1]&255:0},d.prototype.getComposite=function(O){if(this.prepFeature(),!this.feature[2])return null;var y=this.feature[2][O.codepoint];return y?d.fromCharCode(y):null};var L=function(O){this.str=O,this.cursor=0};L.prototype.next=function(){if(!!this.str&&this.cursor<this.str.length){var O=this.str.charCodeAt(this.cursor++),y;return d.isHighSurrogate(O)&&this.cursor<this.str.length&&d.isLowSurrogate(y=this.str.charCodeAt(this.cursor))&&(O=(O-55296)*1024+(y-56320)+65536,++this.cursor),d.fromCharCode(O)}else return this.str=null,null};var V=function(O,y){this.it=O,this.canonical=y,this.resBuf=[]};V.prototype.next=function(){function O(R,C){var A=C.getDecomp();if(!!A&&!(R&&C.isCompatibility())){for(var P=[],H=0;H<A.length;++H){var Y=O(R,d.fromCharCode(A[H]));P=P.concat(Y)}return P}else return[C]}if(this.resBuf.length===0){var y=this.it.next();if(!y)return null;this.resBuf=O(this.canonical,y)}return this.resBuf.shift()};var B=function(O){this.it=O,this.resBuf=[]};B.prototype.next=function(){var O;if(this.resBuf.length===0)do{var y=this.it.next();if(!y)break;O=y.getCanonicalClass();var R=this.resBuf.length;if(O!==0)for(;R>0;--R){var C=this.resBuf[R-1],A=C.getCanonicalClass();if(A<=O)break}this.resBuf.splice(R,0,y)}while(O!==0);return this.resBuf.shift()};var k=function(O){this.it=O,this.procBuf=[],this.resBuf=[],this.lastClass=null};k.prototype.next=function(){for(;this.resBuf.length===0;){var O=this.it.next();if(!O){this.resBuf=this.procBuf,this.procBuf=[];break}if(this.procBuf.length===0)this.lastClass=O.getCanonicalClass(),this.procBuf.push(O);else{var y=this.procBuf[0],R=y.getComposite(O),C=O.getCanonicalClass();!!R&&(this.lastClass<C||this.lastClass===0)?this.procBuf[0]=R:(C===0&&(this.resBuf=this.procBuf,this.procBuf=[]),this.lastClass=C,this.procBuf.push(O))}}return this.resBuf.shift()};var M=function(O,y){switch(O){case"NFD":return new B(new V(new L(y),!0));case"NFKD":return new B(new V(new L(y),!1));case"NFC":return new k(new B(new V(new L(y),!0)));case"NFKC":return new k(new B(new V(new L(y),!1)))}throw O+" is invalid"},G=function(O,y){for(var R=M(O,y),C="",A;A=R.next();)C+=A.toString();return C};function j(O){return G("NFD",O)}function q(O){return G("NFKD",O)}function te(O){return G("NFC",O)}function pe(O){return G("NFKC",O)}d.udata={0:{60:[,,{824:8814}],61:[,,{824:8800}],62:[,,{824:8815}],65:[,,{768:192,769:193,770:194,771:195,772:256,774:258,775:550,776:196,777:7842,778:197,780:461,783:512,785:514,803:7840,805:7680,808:260}],66:[,,{775:7682,803:7684,817:7686}],67:[,,{769:262,770:264,775:266,780:268,807:199}],68:[,,{775:7690,780:270,803:7692,807:7696,813:7698,817:7694}],69:[,,{768:200,769:201,770:202,771:7868,772:274,774:276,775:278,776:203,777:7866,780:282,783:516,785:518,803:7864,807:552,808:280,813:7704,816:7706}],70:[,,{775:7710}],71:[,,{769:500,770:284,772:7712,774:286,775:288,780:486,807:290}],72:[,,{770:292,775:7714,776:7718,780:542,803:7716,807:7720,814:7722}],73:[,,{768:204,769:205,770:206,771:296,772:298,774:300,775:304,776:207,777:7880,780:463,783:520,785:522,803:7882,808:302,816:7724}],74:[,,{770:308}],75:[,,{769:7728,780:488,803:7730,807:310,817:7732}],76:[,,{769:313,780:317,803:7734,807:315,813:7740,817:7738}],77:[,,{769:7742,775:7744,803:7746}],78:[,,{768:504,769:323,771:209,775:7748,780:327,803:7750,807:325,813:7754,817:7752}],79:[,,{768:210,769:211,770:212,771:213,772:332,774:334,775:558,776:214,777:7886,779:336,780:465,783:524,785:526,795:416,803:7884,808:490}],80:[,,{769:7764,775:7766}],82:[,,{769:340,775:7768,780:344,783:528,785:530,803:7770,807:342,817:7774}],83:[,,{769:346,770:348,775:7776,780:352,803:7778,806:536,807:350}],84:[,,{775:7786,780:356,803:7788,806:538,807:354,813:7792,817:7790}],85:[,,{768:217,769:218,770:219,771:360,772:362,774:364,776:220,777:7910,778:366,779:368,780:467,783:532,785:534,795:431,803:7908,804:7794,808:370,813:7798,816:7796}],86:[,,{771:7804,803:7806}],87:[,,{768:7808,769:7810,770:372,775:7814,776:7812,803:7816}],88:[,,{775:7818,776:7820}],89:[,,{768:7922,769:221,770:374,771:7928,772:562,775:7822,776:376,777:7926,803:7924}],90:[,,{769:377,770:7824,775:379,780:381,803:7826,817:7828}],97:[,,{768:224,769:225,770:226,771:227,772:257,774:259,775:551,776:228,777:7843,778:229,780:462,783:513,785:515,803:7841,805:7681,808:261}],98:[,,{775:7683,803:7685,817:7687}],99:[,,{769:263,770:265,775:267,780:269,807:231}],100:[,,{775:7691,780:271,803:7693,807:7697,813:7699,817:7695}],101:[,,{768:232,769:233,770:234,771:7869,772:275,774:277,775:279,776:235,777:7867,780:283,783:517,785:519,803:7865,807:553,808:281,813:7705,816:7707}],102:[,,{775:7711}],103:[,,{769:501,770:285,772:7713,774:287,775:289,780:487,807:291}],104:[,,{770:293,775:7715,776:7719,780:543,803:7717,807:7721,814:7723,817:7830}],105:[,,{768:236,769:237,770:238,771:297,772:299,774:301,776:239,777:7881,780:464,783:521,785:523,803:7883,808:303,816:7725}],106:[,,{770:309,780:496}],107:[,,{769:7729,780:489,803:7731,807:311,817:7733}],108:[,,{769:314,780:318,803:7735,807:316,813:7741,817:7739}],109:[,,{769:7743,775:7745,803:7747}],110:[,,{768:505,769:324,771:241,775:7749,780:328,803:7751,807:326,813:7755,817:7753}],111:[,,{768:242,769:243,770:244,771:245,772:333,774:335,775:559,776:246,777:7887,779:337,780:466,783:525,785:527,795:417,803:7885,808:491}],112:[,,{769:7765,775:7767}],114:[,,{769:341,775:7769,780:345,783:529,785:531,803:7771,807:343,817:7775}],115:[,,{769:347,770:349,775:7777,780:353,803:7779,806:537,807:351}],116:[,,{775:7787,776:7831,780:357,803:7789,806:539,807:355,813:7793,817:7791}],117:[,,{768:249,769:250,770:251,771:361,772:363,774:365,776:252,777:7911,778:367,779:369,780:468,783:533,785:535,795:432,803:7909,804:7795,808:371,813:7799,816:7797}],118:[,,{771:7805,803:7807}],119:[,,{768:7809,769:7811,770:373,775:7815,776:7813,778:7832,803:7817}],120:[,,{775:7819,776:7821}],121:[,,{768:7923,769:253,770:375,771:7929,772:563,775:7823,776:255,777:7927,778:7833,803:7925}],122:[,,{769:378,770:7825,775:380,780:382,803:7827,817:7829}],160:[[32],256],168:[[32,776],256,{768:8173,769:901,834:8129}],170:[[97],256],175:[[32,772],256],178:[[50],256],179:[[51],256],180:[[32,769],256],181:[[956],256],184:[[32,807],256],185:[[49],256],186:[[111],256],188:[[49,8260,52],256],189:[[49,8260,50],256],190:[[51,8260,52],256],192:[[65,768]],193:[[65,769]],194:[[65,770],,{768:7846,769:7844,771:7850,777:7848}],195:[[65,771]],196:[[65,776],,{772:478}],197:[[65,778],,{769:506}],198:[,,{769:508,772:482}],199:[[67,807],,{769:7688}],200:[[69,768]],201:[[69,769]],202:[[69,770],,{768:7872,769:7870,771:7876,777:7874}],203:[[69,776]],204:[[73,768]],205:[[73,769]],206:[[73,770]],207:[[73,776],,{769:7726}],209:[[78,771]],210:[[79,768]],211:[[79,769]],212:[[79,770],,{768:7890,769:7888,771:7894,777:7892}],213:[[79,771],,{769:7756,772:556,776:7758}],214:[[79,776],,{772:554}],216:[,,{769:510}],217:[[85,768]],218:[[85,769]],219:[[85,770]],220:[[85,776],,{768:475,769:471,772:469,780:473}],221:[[89,769]],224:[[97,768]],225:[[97,769]],226:[[97,770],,{768:7847,769:7845,771:7851,777:7849}],227:[[97,771]],228:[[97,776],,{772:479}],229:[[97,778],,{769:507}],230:[,,{769:509,772:483}],231:[[99,807],,{769:7689}],232:[[101,768]],233:[[101,769]],234:[[101,770],,{768:7873,769:7871,771:7877,777:7875}],235:[[101,776]],236:[[105,768]],237:[[105,769]],238:[[105,770]],239:[[105,776],,{769:7727}],241:[[110,771]],242:[[111,768]],243:[[111,769]],244:[[111,770],,{768:7891,769:7889,771:7895,777:7893}],245:[[111,771],,{769:7757,772:557,776:7759}],246:[[111,776],,{772:555}],248:[,,{769:511}],249:[[117,768]],250:[[117,769]],251:[[117,770]],252:[[117,776],,{768:476,769:472,772:470,780:474}],253:[[121,769]],255:[[121,776]]},256:{256:[[65,772]],257:[[97,772]],258:[[65,774],,{768:7856,769:7854,771:7860,777:7858}],259:[[97,774],,{768:7857,769:7855,771:7861,777:7859}],260:[[65,808]],261:[[97,808]],262:[[67,769]],263:[[99,769]],264:[[67,770]],265:[[99,770]],266:[[67,775]],267:[[99,775]],268:[[67,780]],269:[[99,780]],270:[[68,780]],271:[[100,780]],274:[[69,772],,{768:7700,769:7702}],275:[[101,772],,{768:7701,769:7703}],276:[[69,774]],277:[[101,774]],278:[[69,775]],279:[[101,775]],280:[[69,808]],281:[[101,808]],282:[[69,780]],283:[[101,780]],284:[[71,770]],285:[[103,770]],286:[[71,774]],287:[[103,774]],288:[[71,775]],289:[[103,775]],290:[[71,807]],291:[[103,807]],292:[[72,770]],293:[[104,770]],296:[[73,771]],297:[[105,771]],298:[[73,772]],299:[[105,772]],300:[[73,774]],301:[[105,774]],302:[[73,808]],303:[[105,808]],304:[[73,775]],306:[[73,74],256],307:[[105,106],256],308:[[74,770]],309:[[106,770]],310:[[75,807]],311:[[107,807]],313:[[76,769]],314:[[108,769]],315:[[76,807]],316:[[108,807]],317:[[76,780]],318:[[108,780]],319:[[76,183],256],320:[[108,183],256],323:[[78,769]],324:[[110,769]],325:[[78,807]],326:[[110,807]],327:[[78,780]],328:[[110,780]],329:[[700,110],256],332:[[79,772],,{768:7760,769:7762}],333:[[111,772],,{768:7761,769:7763}],334:[[79,774]],335:[[111,774]],336:[[79,779]],337:[[111,779]],340:[[82,769]],341:[[114,769]],342:[[82,807]],343:[[114,807]],344:[[82,780]],345:[[114,780]],346:[[83,769],,{775:7780}],347:[[115,769],,{775:7781}],348:[[83,770]],349:[[115,770]],350:[[83,807]],351:[[115,807]],352:[[83,780],,{775:7782}],353:[[115,780],,{775:7783}],354:[[84,807]],355:[[116,807]],356:[[84,780]],357:[[116,780]],360:[[85,771],,{769:7800}],361:[[117,771],,{769:7801}],362:[[85,772],,{776:7802}],363:[[117,772],,{776:7803}],364:[[85,774]],365:[[117,774]],366:[[85,778]],367:[[117,778]],368:[[85,779]],369:[[117,779]],370:[[85,808]],371:[[117,808]],372:[[87,770]],373:[[119,770]],374:[[89,770]],375:[[121,770]],376:[[89,776]],377:[[90,769]],378:[[122,769]],379:[[90,775]],380:[[122,775]],381:[[90,780]],382:[[122,780]],383:[[115],256,{775:7835}],416:[[79,795],,{768:7900,769:7898,771:7904,777:7902,803:7906}],417:[[111,795],,{768:7901,769:7899,771:7905,777:7903,803:7907}],431:[[85,795],,{768:7914,769:7912,771:7918,777:7916,803:7920}],432:[[117,795],,{768:7915,769:7913,771:7919,777:7917,803:7921}],439:[,,{780:494}],452:[[68,381],256],453:[[68,382],256],454:[[100,382],256],455:[[76,74],256],456:[[76,106],256],457:[[108,106],256],458:[[78,74],256],459:[[78,106],256],460:[[110,106],256],461:[[65,780]],462:[[97,780]],463:[[73,780]],464:[[105,780]],465:[[79,780]],466:[[111,780]],467:[[85,780]],468:[[117,780]],469:[[220,772]],470:[[252,772]],471:[[220,769]],472:[[252,769]],473:[[220,780]],474:[[252,780]],475:[[220,768]],476:[[252,768]],478:[[196,772]],479:[[228,772]],480:[[550,772]],481:[[551,772]],482:[[198,772]],483:[[230,772]],486:[[71,780]],487:[[103,780]],488:[[75,780]],489:[[107,780]],490:[[79,808],,{772:492}],491:[[111,808],,{772:493}],492:[[490,772]],493:[[491,772]],494:[[439,780]],495:[[658,780]],496:[[106,780]],497:[[68,90],256],498:[[68,122],256],499:[[100,122],256],500:[[71,769]],501:[[103,769]],504:[[78,768]],505:[[110,768]],506:[[197,769]],507:[[229,769]],508:[[198,769]],509:[[230,769]],510:[[216,769]],511:[[248,769]],66045:[,220]},512:{512:[[65,783]],513:[[97,783]],514:[[65,785]],515:[[97,785]],516:[[69,783]],517:[[101,783]],518:[[69,785]],519:[[101,785]],520:[[73,783]],521:[[105,783]],522:[[73,785]],523:[[105,785]],524:[[79,783]],525:[[111,783]],526:[[79,785]],527:[[111,785]],528:[[82,783]],529:[[114,783]],530:[[82,785]],531:[[114,785]],532:[[85,783]],533:[[117,783]],534:[[85,785]],535:[[117,785]],536:[[83,806]],537:[[115,806]],538:[[84,806]],539:[[116,806]],542:[[72,780]],543:[[104,780]],550:[[65,775],,{772:480}],551:[[97,775],,{772:481}],552:[[69,807],,{774:7708}],553:[[101,807],,{774:7709}],554:[[214,772]],555:[[246,772]],556:[[213,772]],557:[[245,772]],558:[[79,775],,{772:560}],559:[[111,775],,{772:561}],560:[[558,772]],561:[[559,772]],562:[[89,772]],563:[[121,772]],658:[,,{780:495}],688:[[104],256],689:[[614],256],690:[[106],256],691:[[114],256],692:[[633],256],693:[[635],256],694:[[641],256],695:[[119],256],696:[[121],256],728:[[32,774],256],729:[[32,775],256],730:[[32,778],256],731:[[32,808],256],732:[[32,771],256],733:[[32,779],256],736:[[611],256],737:[[108],256],738:[[115],256],739:[[120],256],740:[[661],256],66272:[,220]},768:{768:[,230],769:[,230],770:[,230],771:[,230],772:[,230],773:[,230],774:[,230],775:[,230],776:[,230,{769:836}],777:[,230],778:[,230],779:[,230],780:[,230],781:[,230],782:[,230],783:[,230],784:[,230],785:[,230],786:[,230],787:[,230],788:[,230],789:[,232],790:[,220],791:[,220],792:[,220],793:[,220],794:[,232],795:[,216],796:[,220],797:[,220],798:[,220],799:[,220],800:[,220],801:[,202],802:[,202],803:[,220],804:[,220],805:[,220],806:[,220],807:[,202],808:[,202],809:[,220],810:[,220],811:[,220],812:[,220],813:[,220],814:[,220],815:[,220],816:[,220],817:[,220],818:[,220],819:[,220],820:[,1],821:[,1],822:[,1],823:[,1],824:[,1],825:[,220],826:[,220],827:[,220],828:[,220],829:[,230],830:[,230],831:[,230],832:[[768],230],833:[[769],230],834:[,230],835:[[787],230],836:[[776,769],230],837:[,240],838:[,230],839:[,220],840:[,220],841:[,220],842:[,230],843:[,230],844:[,230],845:[,220],846:[,220],848:[,230],849:[,230],850:[,230],851:[,220],852:[,220],853:[,220],854:[,220],855:[,230],856:[,232],857:[,220],858:[,220],859:[,230],860:[,233],861:[,234],862:[,234],863:[,233],864:[,234],865:[,234],866:[,233],867:[,230],868:[,230],869:[,230],870:[,230],871:[,230],872:[,230],873:[,230],874:[,230],875:[,230],876:[,230],877:[,230],878:[,230],879:[,230],884:[[697]],890:[[32,837],256],894:[[59]],900:[[32,769],256],901:[[168,769]],902:[[913,769]],903:[[183]],904:[[917,769]],905:[[919,769]],906:[[921,769]],908:[[927,769]],910:[[933,769]],911:[[937,769]],912:[[970,769]],913:[,,{768:8122,769:902,772:8121,774:8120,787:7944,788:7945,837:8124}],917:[,,{768:8136,769:904,787:7960,788:7961}],919:[,,{768:8138,769:905,787:7976,788:7977,837:8140}],921:[,,{768:8154,769:906,772:8153,774:8152,776:938,787:7992,788:7993}],927:[,,{768:8184,769:908,787:8008,788:8009}],929:[,,{788:8172}],933:[,,{768:8170,769:910,772:8169,774:8168,776:939,788:8025}],937:[,,{768:8186,769:911,787:8040,788:8041,837:8188}],938:[[921,776]],939:[[933,776]],940:[[945,769],,{837:8116}],941:[[949,769]],942:[[951,769],,{837:8132}],943:[[953,769]],944:[[971,769]],945:[,,{768:8048,769:940,772:8113,774:8112,787:7936,788:7937,834:8118,837:8115}],949:[,,{768:8050,769:941,787:7952,788:7953}],951:[,,{768:8052,769:942,787:7968,788:7969,834:8134,837:8131}],953:[,,{768:8054,769:943,772:8145,774:8144,776:970,787:7984,788:7985,834:8150}],959:[,,{768:8056,769:972,787:8e3,788:8001}],961:[,,{787:8164,788:8165}],965:[,,{768:8058,769:973,772:8161,774:8160,776:971,787:8016,788:8017,834:8166}],969:[,,{768:8060,769:974,787:8032,788:8033,834:8182,837:8179}],970:[[953,776],,{768:8146,769:912,834:8151}],971:[[965,776],,{768:8162,769:944,834:8167}],972:[[959,769]],973:[[965,769]],974:[[969,769],,{837:8180}],976:[[946],256],977:[[952],256],978:[[933],256,{769:979,776:980}],979:[[978,769]],980:[[978,776]],981:[[966],256],982:[[960],256],1008:[[954],256],1009:[[961],256],1010:[[962],256],1012:[[920],256],1013:[[949],256],1017:[[931],256],66422:[,230],66423:[,230],66424:[,230],66425:[,230],66426:[,230]},1024:{1024:[[1045,768]],1025:[[1045,776]],1027:[[1043,769]],1030:[,,{776:1031}],1031:[[1030,776]],1036:[[1050,769]],1037:[[1048,768]],1038:[[1059,774]],1040:[,,{774:1232,776:1234}],1043:[,,{769:1027}],1045:[,,{768:1024,774:1238,776:1025}],1046:[,,{774:1217,776:1244}],1047:[,,{776:1246}],1048:[,,{768:1037,772:1250,774:1049,776:1252}],1049:[[1048,774]],1050:[,,{769:1036}],1054:[,,{776:1254}],1059:[,,{772:1262,774:1038,776:1264,779:1266}],1063:[,,{776:1268}],1067:[,,{776:1272}],1069:[,,{776:1260}],1072:[,,{774:1233,776:1235}],1075:[,,{769:1107}],1077:[,,{768:1104,774:1239,776:1105}],1078:[,,{774:1218,776:1245}],1079:[,,{776:1247}],1080:[,,{768:1117,772:1251,774:1081,776:1253}],1081:[[1080,774]],1082:[,,{769:1116}],1086:[,,{776:1255}],1091:[,,{772:1263,774:1118,776:1265,779:1267}],1095:[,,{776:1269}],1099:[,,{776:1273}],1101:[,,{776:1261}],1104:[[1077,768]],1105:[[1077,776]],1107:[[1075,769]],1110:[,,{776:1111}],1111:[[1110,776]],1116:[[1082,769]],1117:[[1080,768]],1118:[[1091,774]],1140:[,,{783:1142}],1141:[,,{783:1143}],1142:[[1140,783]],1143:[[1141,783]],1155:[,230],1156:[,230],1157:[,230],1158:[,230],1159:[,230],1217:[[1046,774]],1218:[[1078,774]],1232:[[1040,774]],1233:[[1072,774]],1234:[[1040,776]],1235:[[1072,776]],1238:[[1045,774]],1239:[[1077,774]],1240:[,,{776:1242}],1241:[,,{776:1243}],1242:[[1240,776]],1243:[[1241,776]],1244:[[1046,776]],1245:[[1078,776]],1246:[[1047,776]],1247:[[1079,776]],1250:[[1048,772]],1251:[[1080,772]],1252:[[1048,776]],1253:[[1080,776]],1254:[[1054,776]],1255:[[1086,776]],1256:[,,{776:1258}],1257:[,,{776:1259}],1258:[[1256,776]],1259:[[1257,776]],1260:[[1069,776]],1261:[[1101,776]],1262:[[1059,772]],1263:[[1091,772]],1264:[[1059,776]],1265:[[1091,776]],1266:[[1059,779]],1267:[[1091,779]],1268:[[1063,776]],1269:[[1095,776]],1272:[[1067,776]],1273:[[1099,776]]},1280:{1415:[[1381,1410],256],1425:[,220],1426:[,230],1427:[,230],1428:[,230],1429:[,230],1430:[,220],1431:[,230],1432:[,230],1433:[,230],1434:[,222],1435:[,220],1436:[,230],1437:[,230],1438:[,230],1439:[,230],1440:[,230],1441:[,230],1442:[,220],1443:[,220],1444:[,220],1445:[,220],1446:[,220],1447:[,220],1448:[,230],1449:[,230],1450:[,220],1451:[,230],1452:[,230],1453:[,222],1454:[,228],1455:[,230],1456:[,10],1457:[,11],1458:[,12],1459:[,13],1460:[,14],1461:[,15],1462:[,16],1463:[,17],1464:[,18],1465:[,19],1466:[,19],1467:[,20],1468:[,21],1469:[,22],1471:[,23],1473:[,24],1474:[,25],1476:[,230],1477:[,220],1479:[,18]},1536:{1552:[,230],1553:[,230],1554:[,230],1555:[,230],1556:[,230],1557:[,230],1558:[,230],1559:[,230],1560:[,30],1561:[,31],1562:[,32],1570:[[1575,1619]],1571:[[1575,1620]],1572:[[1608,1620]],1573:[[1575,1621]],1574:[[1610,1620]],1575:[,,{1619:1570,1620:1571,1621:1573}],1608:[,,{1620:1572}],1610:[,,{1620:1574}],1611:[,27],1612:[,28],1613:[,29],1614:[,30],1615:[,31],1616:[,32],1617:[,33],1618:[,34],1619:[,230],1620:[,230],1621:[,220],1622:[,220],1623:[,230],1624:[,230],1625:[,230],1626:[,230],1627:[,230],1628:[,220],1629:[,230],1630:[,230],1631:[,220],1648:[,35],1653:[[1575,1652],256],1654:[[1608,1652],256],1655:[[1735,1652],256],1656:[[1610,1652],256],1728:[[1749,1620]],1729:[,,{1620:1730}],1730:[[1729,1620]],1746:[,,{1620:1747}],1747:[[1746,1620]],1749:[,,{1620:1728}],1750:[,230],1751:[,230],1752:[,230],1753:[,230],1754:[,230],1755:[,230],1756:[,230],1759:[,230],1760:[,230],1761:[,230],1762:[,230],1763:[,220],1764:[,230],1767:[,230],1768:[,230],1770:[,220],1771:[,230],1772:[,230],1773:[,220]},1792:{1809:[,36],1840:[,230],1841:[,220],1842:[,230],1843:[,230],1844:[,220],1845:[,230],1846:[,230],1847:[,220],1848:[,220],1849:[,220],1850:[,230],1851:[,220],1852:[,220],1853:[,230],1854:[,220],1855:[,230],1856:[,230],1857:[,230],1858:[,220],1859:[,230],1860:[,220],1861:[,230],1862:[,220],1863:[,230],1864:[,220],1865:[,230],1866:[,230],2027:[,230],2028:[,230],2029:[,230],2030:[,230],2031:[,230],2032:[,230],2033:[,230],2034:[,220],2035:[,230]},2048:{2070:[,230],2071:[,230],2072:[,230],2073:[,230],2075:[,230],2076:[,230],2077:[,230],2078:[,230],2079:[,230],2080:[,230],2081:[,230],2082:[,230],2083:[,230],2085:[,230],2086:[,230],2087:[,230],2089:[,230],2090:[,230],2091:[,230],2092:[,230],2093:[,230],2137:[,220],2138:[,220],2139:[,220],2276:[,230],2277:[,230],2278:[,220],2279:[,230],2280:[,230],2281:[,220],2282:[,230],2283:[,230],2284:[,230],2285:[,220],2286:[,220],2287:[,220],2288:[,27],2289:[,28],2290:[,29],2291:[,230],2292:[,230],2293:[,230],2294:[,220],2295:[,230],2296:[,230],2297:[,220],2298:[,220],2299:[,230],2300:[,230],2301:[,230],2302:[,230],2303:[,230]},2304:{2344:[,,{2364:2345}],2345:[[2344,2364]],2352:[,,{2364:2353}],2353:[[2352,2364]],2355:[,,{2364:2356}],2356:[[2355,2364]],2364:[,7],2381:[,9],2385:[,230],2386:[,220],2387:[,230],2388:[,230],2392:[[2325,2364],512],2393:[[2326,2364],512],2394:[[2327,2364],512],2395:[[2332,2364],512],2396:[[2337,2364],512],2397:[[2338,2364],512],2398:[[2347,2364],512],2399:[[2351,2364],512],2492:[,7],2503:[,,{2494:2507,2519:2508}],2507:[[2503,2494]],2508:[[2503,2519]],2509:[,9],2524:[[2465,2492],512],2525:[[2466,2492],512],2527:[[2479,2492],512]},2560:{2611:[[2610,2620],512],2614:[[2616,2620],512],2620:[,7],2637:[,9],2649:[[2582,2620],512],2650:[[2583,2620],512],2651:[[2588,2620],512],2654:[[2603,2620],512],2748:[,7],2765:[,9],68109:[,220],68111:[,230],68152:[,230],68153:[,1],68154:[,220],68159:[,9],68325:[,230],68326:[,220]},2816:{2876:[,7],2887:[,,{2878:2891,2902:2888,2903:2892}],2888:[[2887,2902]],2891:[[2887,2878]],2892:[[2887,2903]],2893:[,9],2908:[[2849,2876],512],2909:[[2850,2876],512],2962:[,,{3031:2964}],2964:[[2962,3031]],3014:[,,{3006:3018,3031:3020}],3015:[,,{3006:3019}],3018:[[3014,3006]],3019:[[3015,3006]],3020:[[3014,3031]],3021:[,9]},3072:{3142:[,,{3158:3144}],3144:[[3142,3158]],3149:[,9],3157:[,84],3158:[,91],3260:[,7],3263:[,,{3285:3264}],3264:[[3263,3285]],3270:[,,{3266:3274,3285:3271,3286:3272}],3271:[[3270,3285]],3272:[[3270,3286]],3274:[[3270,3266],,{3285:3275}],3275:[[3274,3285]],3277:[,9]},3328:{3398:[,,{3390:3402,3415:3404}],3399:[,,{3390:3403}],3402:[[3398,3390]],3403:[[3399,3390]],3404:[[3398,3415]],3405:[,9],3530:[,9],3545:[,,{3530:3546,3535:3548,3551:3550}],3546:[[3545,3530]],3548:[[3545,3535],,{3530:3549}],3549:[[3548,3530]],3550:[[3545,3551]]},3584:{3635:[[3661,3634],256],3640:[,103],3641:[,103],3642:[,9],3656:[,107],3657:[,107],3658:[,107],3659:[,107],3763:[[3789,3762],256],3768:[,118],3769:[,118],3784:[,122],3785:[,122],3786:[,122],3787:[,122],3804:[[3755,3737],256],3805:[[3755,3745],256]},3840:{3852:[[3851],256],3864:[,220],3865:[,220],3893:[,220],3895:[,220],3897:[,216],3907:[[3906,4023],512],3917:[[3916,4023],512],3922:[[3921,4023],512],3927:[[3926,4023],512],3932:[[3931,4023],512],3945:[[3904,4021],512],3953:[,129],3954:[,130],3955:[[3953,3954],512],3956:[,132],3957:[[3953,3956],512],3958:[[4018,3968],512],3959:[[4018,3969],256],3960:[[4019,3968],512],3961:[[4019,3969],256],3962:[,130],3963:[,130],3964:[,130],3965:[,130],3968:[,130],3969:[[3953,3968],512],3970:[,230],3971:[,230],3972:[,9],3974:[,230],3975:[,230],3987:[[3986,4023],512],3997:[[3996,4023],512],4002:[[4001,4023],512],4007:[[4006,4023],512],4012:[[4011,4023],512],4025:[[3984,4021],512],4038:[,220]},4096:{4133:[,,{4142:4134}],4134:[[4133,4142]],4151:[,7],4153:[,9],4154:[,9],4237:[,220],4348:[[4316],256],69702:[,9],69759:[,9],69785:[,,{69818:69786}],69786:[[69785,69818]],69787:[,,{69818:69788}],69788:[[69787,69818]],69797:[,,{69818:69803}],69803:[[69797,69818]],69817:[,9],69818:[,7]},4352:{69888:[,230],69889:[,230],69890:[,230],69934:[[69937,69927]],69935:[[69938,69927]],69937:[,,{69927:69934}],69938:[,,{69927:69935}],69939:[,9],69940:[,9],70003:[,7],70080:[,9]},4608:{70197:[,9],70198:[,7],70377:[,7],70378:[,9]},4864:{4957:[,230],4958:[,230],4959:[,230],70460:[,7],70471:[,,{70462:70475,70487:70476}],70475:[[70471,70462]],70476:[[70471,70487]],70477:[,9],70502:[,230],70503:[,230],70504:[,230],70505:[,230],70506:[,230],70507:[,230],70508:[,230],70512:[,230],70513:[,230],70514:[,230],70515:[,230],70516:[,230]},5120:{70841:[,,{70832:70844,70842:70843,70845:70846}],70843:[[70841,70842]],70844:[[70841,70832]],70846:[[70841,70845]],70850:[,9],70851:[,7]},5376:{71096:[,,{71087:71098}],71097:[,,{71087:71099}],71098:[[71096,71087]],71099:[[71097,71087]],71103:[,9],71104:[,7]},5632:{71231:[,9],71350:[,9],71351:[,7]},5888:{5908:[,9],5940:[,9],6098:[,9],6109:[,230]},6144:{6313:[,228]},6400:{6457:[,222],6458:[,230],6459:[,220]},6656:{6679:[,230],6680:[,220],6752:[,9],6773:[,230],6774:[,230],6775:[,230],6776:[,230],6777:[,230],6778:[,230],6779:[,230],6780:[,230],6783:[,220],6832:[,230],6833:[,230],6834:[,230],6835:[,230],6836:[,230],6837:[,220],6838:[,220],6839:[,220],6840:[,220],6841:[,220],6842:[,220],6843:[,230],6844:[,230],6845:[,220]},6912:{6917:[,,{6965:6918}],6918:[[6917,6965]],6919:[,,{6965:6920}],6920:[[6919,6965]],6921:[,,{6965:6922}],6922:[[6921,6965]],6923:[,,{6965:6924}],6924:[[6923,6965]],6925:[,,{6965:6926}],6926:[[6925,6965]],6929:[,,{6965:6930}],6930:[[6929,6965]],6964:[,7],6970:[,,{6965:6971}],6971:[[6970,6965]],6972:[,,{6965:6973}],6973:[[6972,6965]],6974:[,,{6965:6976}],6975:[,,{6965:6977}],6976:[[6974,6965]],6977:[[6975,6965]],6978:[,,{6965:6979}],6979:[[6978,6965]],6980:[,9],7019:[,230],7020:[,220],7021:[,230],7022:[,230],7023:[,230],7024:[,230],7025:[,230],7026:[,230],7027:[,230],7082:[,9],7083:[,9],7142:[,7],7154:[,9],7155:[,9]},7168:{7223:[,7],7376:[,230],7377:[,230],7378:[,230],7380:[,1],7381:[,220],7382:[,220],7383:[,220],7384:[,220],7385:[,220],7386:[,230],7387:[,230],7388:[,220],7389:[,220],7390:[,220],7391:[,220],7392:[,230],7394:[,1],7395:[,1],7396:[,1],7397:[,1],7398:[,1],7399:[,1],7400:[,1],7405:[,220],7412:[,230],7416:[,230],7417:[,230]},7424:{7468:[[65],256],7469:[[198],256],7470:[[66],256],7472:[[68],256],7473:[[69],256],7474:[[398],256],7475:[[71],256],7476:[[72],256],7477:[[73],256],7478:[[74],256],7479:[[75],256],7480:[[76],256],7481:[[77],256],7482:[[78],256],7484:[[79],256],7485:[[546],256],7486:[[80],256],7487:[[82],256],7488:[[84],256],7489:[[85],256],7490:[[87],256],7491:[[97],256],7492:[[592],256],7493:[[593],256],7494:[[7426],256],7495:[[98],256],7496:[[100],256],7497:[[101],256],7498:[[601],256],7499:[[603],256],7500:[[604],256],7501:[[103],256],7503:[[107],256],7504:[[109],256],7505:[[331],256],7506:[[111],256],7507:[[596],256],7508:[[7446],256],7509:[[7447],256],7510:[[112],256],7511:[[116],256],7512:[[117],256],7513:[[7453],256],7514:[[623],256],7515:[[118],256],7516:[[7461],256],7517:[[946],256],7518:[[947],256],7519:[[948],256],7520:[[966],256],7521:[[967],256],7522:[[105],256],7523:[[114],256],7524:[[117],256],7525:[[118],256],7526:[[946],256],7527:[[947],256],7528:[[961],256],7529:[[966],256],7530:[[967],256],7544:[[1085],256],7579:[[594],256],7580:[[99],256],7581:[[597],256],7582:[[240],256],7583:[[604],256],7584:[[102],256],7585:[[607],256],7586:[[609],256],7587:[[613],256],7588:[[616],256],7589:[[617],256],7590:[[618],256],7591:[[7547],256],7592:[[669],256],7593:[[621],256],7594:[[7557],256],7595:[[671],256],7596:[[625],256],7597:[[624],256],7598:[[626],256],7599:[[627],256],7600:[[628],256],7601:[[629],256],7602:[[632],256],7603:[[642],256],7604:[[643],256],7605:[[427],256],7606:[[649],256],7607:[[650],256],7608:[[7452],256],7609:[[651],256],7610:[[652],256],7611:[[122],256],7612:[[656],256],7613:[[657],256],7614:[[658],256],7615:[[952],256],7616:[,230],7617:[,230],7618:[,220],7619:[,230],7620:[,230],7621:[,230],7622:[,230],7623:[,230],7624:[,230],7625:[,230],7626:[,220],7627:[,230],7628:[,230],7629:[,234],7630:[,214],7631:[,220],7632:[,202],7633:[,230],7634:[,230],7635:[,230],7636:[,230],7637:[,230],7638:[,230],7639:[,230],7640:[,230],7641:[,230],7642:[,230],7643:[,230],7644:[,230],7645:[,230],7646:[,230],7647:[,230],7648:[,230],7649:[,230],7650:[,230],7651:[,230],7652:[,230],7653:[,230],7654:[,230],7655:[,230],7656:[,230],7657:[,230],7658:[,230],7659:[,230],7660:[,230],7661:[,230],7662:[,230],7663:[,230],7664:[,230],7665:[,230],7666:[,230],7667:[,230],7668:[,230],7669:[,230],7676:[,233],7677:[,220],7678:[,230],7679:[,220]},7680:{7680:[[65,805]],7681:[[97,805]],7682:[[66,775]],7683:[[98,775]],7684:[[66,803]],7685:[[98,803]],7686:[[66,817]],7687:[[98,817]],7688:[[199,769]],7689:[[231,769]],7690:[[68,775]],7691:[[100,775]],7692:[[68,803]],7693:[[100,803]],7694:[[68,817]],7695:[[100,817]],7696:[[68,807]],7697:[[100,807]],7698:[[68,813]],7699:[[100,813]],7700:[[274,768]],7701:[[275,768]],7702:[[274,769]],7703:[[275,769]],7704:[[69,813]],7705:[[101,813]],7706:[[69,816]],7707:[[101,816]],7708:[[552,774]],7709:[[553,774]],7710:[[70,775]],7711:[[102,775]],7712:[[71,772]],7713:[[103,772]],7714:[[72,775]],7715:[[104,775]],7716:[[72,803]],7717:[[104,803]],7718:[[72,776]],7719:[[104,776]],7720:[[72,807]],7721:[[104,807]],7722:[[72,814]],7723:[[104,814]],7724:[[73,816]],7725:[[105,816]],7726:[[207,769]],7727:[[239,769]],7728:[[75,769]],7729:[[107,769]],7730:[[75,803]],7731:[[107,803]],7732:[[75,817]],7733:[[107,817]],7734:[[76,803],,{772:7736}],7735:[[108,803],,{772:7737}],7736:[[7734,772]],7737:[[7735,772]],7738:[[76,817]],7739:[[108,817]],7740:[[76,813]],7741:[[108,813]],7742:[[77,769]],7743:[[109,769]],7744:[[77,775]],7745:[[109,775]],7746:[[77,803]],7747:[[109,803]],7748:[[78,775]],7749:[[110,775]],7750:[[78,803]],7751:[[110,803]],7752:[[78,817]],7753:[[110,817]],7754:[[78,813]],7755:[[110,813]],7756:[[213,769]],7757:[[245,769]],7758:[[213,776]],7759:[[245,776]],7760:[[332,768]],7761:[[333,768]],7762:[[332,769]],7763:[[333,769]],7764:[[80,769]],7765:[[112,769]],7766:[[80,775]],7767:[[112,775]],7768:[[82,775]],7769:[[114,775]],7770:[[82,803],,{772:7772}],7771:[[114,803],,{772:7773}],7772:[[7770,772]],7773:[[7771,772]],7774:[[82,817]],7775:[[114,817]],7776:[[83,775]],7777:[[115,775]],7778:[[83,803],,{775:7784}],7779:[[115,803],,{775:7785}],7780:[[346,775]],7781:[[347,775]],7782:[[352,775]],7783:[[353,775]],7784:[[7778,775]],7785:[[7779,775]],7786:[[84,775]],7787:[[116,775]],7788:[[84,803]],7789:[[116,803]],7790:[[84,817]],7791:[[116,817]],7792:[[84,813]],7793:[[116,813]],7794:[[85,804]],7795:[[117,804]],7796:[[85,816]],7797:[[117,816]],7798:[[85,813]],7799:[[117,813]],7800:[[360,769]],7801:[[361,769]],7802:[[362,776]],7803:[[363,776]],7804:[[86,771]],7805:[[118,771]],7806:[[86,803]],7807:[[118,803]],7808:[[87,768]],7809:[[119,768]],7810:[[87,769]],7811:[[119,769]],7812:[[87,776]],7813:[[119,776]],7814:[[87,775]],7815:[[119,775]],7816:[[87,803]],7817:[[119,803]],7818:[[88,775]],7819:[[120,775]],7820:[[88,776]],7821:[[120,776]],7822:[[89,775]],7823:[[121,775]],7824:[[90,770]],7825:[[122,770]],7826:[[90,803]],7827:[[122,803]],7828:[[90,817]],7829:[[122,817]],7830:[[104,817]],7831:[[116,776]],7832:[[119,778]],7833:[[121,778]],7834:[[97,702],256],7835:[[383,775]],7840:[[65,803],,{770:7852,774:7862}],7841:[[97,803],,{770:7853,774:7863}],7842:[[65,777]],7843:[[97,777]],7844:[[194,769]],7845:[[226,769]],7846:[[194,768]],7847:[[226,768]],7848:[[194,777]],7849:[[226,777]],7850:[[194,771]],7851:[[226,771]],7852:[[7840,770]],7853:[[7841,770]],7854:[[258,769]],7855:[[259,769]],7856:[[258,768]],7857:[[259,768]],7858:[[258,777]],7859:[[259,777]],7860:[[258,771]],7861:[[259,771]],7862:[[7840,774]],7863:[[7841,774]],7864:[[69,803],,{770:7878}],7865:[[101,803],,{770:7879}],7866:[[69,777]],7867:[[101,777]],7868:[[69,771]],7869:[[101,771]],7870:[[202,769]],7871:[[234,769]],7872:[[202,768]],7873:[[234,768]],7874:[[202,777]],7875:[[234,777]],7876:[[202,771]],7877:[[234,771]],7878:[[7864,770]],7879:[[7865,770]],7880:[[73,777]],7881:[[105,777]],7882:[[73,803]],7883:[[105,803]],7884:[[79,803],,{770:7896}],7885:[[111,803],,{770:7897}],7886:[[79,777]],7887:[[111,777]],7888:[[212,769]],7889:[[244,769]],7890:[[212,768]],7891:[[244,768]],7892:[[212,777]],7893:[[244,777]],7894:[[212,771]],7895:[[244,771]],7896:[[7884,770]],7897:[[7885,770]],7898:[[416,769]],7899:[[417,769]],7900:[[416,768]],7901:[[417,768]],7902:[[416,777]],7903:[[417,777]],7904:[[416,771]],7905:[[417,771]],7906:[[416,803]],7907:[[417,803]],7908:[[85,803]],7909:[[117,803]],7910:[[85,777]],7911:[[117,777]],7912:[[431,769]],7913:[[432,769]],7914:[[431,768]],7915:[[432,768]],7916:[[431,777]],7917:[[432,777]],7918:[[431,771]],7919:[[432,771]],7920:[[431,803]],7921:[[432,803]],7922:[[89,768]],7923:[[121,768]],7924:[[89,803]],7925:[[121,803]],7926:[[89,777]],7927:[[121,777]],7928:[[89,771]],7929:[[121,771]]},7936:{7936:[[945,787],,{768:7938,769:7940,834:7942,837:8064}],7937:[[945,788],,{768:7939,769:7941,834:7943,837:8065}],7938:[[7936,768],,{837:8066}],7939:[[7937,768],,{837:8067}],7940:[[7936,769],,{837:8068}],7941:[[7937,769],,{837:8069}],7942:[[7936,834],,{837:8070}],7943:[[7937,834],,{837:8071}],7944:[[913,787],,{768:7946,769:7948,834:7950,837:8072}],7945:[[913,788],,{768:7947,769:7949,834:7951,837:8073}],7946:[[7944,768],,{837:8074}],7947:[[7945,768],,{837:8075}],7948:[[7944,769],,{837:8076}],7949:[[7945,769],,{837:8077}],7950:[[7944,834],,{837:8078}],7951:[[7945,834],,{837:8079}],7952:[[949,787],,{768:7954,769:7956}],7953:[[949,788],,{768:7955,769:7957}],7954:[[7952,768]],7955:[[7953,768]],7956:[[7952,769]],7957:[[7953,769]],7960:[[917,787],,{768:7962,769:7964}],7961:[[917,788],,{768:7963,769:7965}],7962:[[7960,768]],7963:[[7961,768]],7964:[[7960,769]],7965:[[7961,769]],7968:[[951,787],,{768:7970,769:7972,834:7974,837:8080}],7969:[[951,788],,{768:7971,769:7973,834:7975,837:8081}],7970:[[7968,768],,{837:8082}],7971:[[7969,768],,{837:8083}],7972:[[7968,769],,{837:8084}],7973:[[7969,769],,{837:8085}],7974:[[7968,834],,{837:8086}],7975:[[7969,834],,{837:8087}],7976:[[919,787],,{768:7978,769:7980,834:7982,837:8088}],7977:[[919,788],,{768:7979,769:7981,834:7983,837:8089}],7978:[[7976,768],,{837:8090}],7979:[[7977,768],,{837:8091}],7980:[[7976,769],,{837:8092}],7981:[[7977,769],,{837:8093}],7982:[[7976,834],,{837:8094}],7983:[[7977,834],,{837:8095}],7984:[[953,787],,{768:7986,769:7988,834:7990}],7985:[[953,788],,{768:7987,769:7989,834:7991}],7986:[[7984,768]],7987:[[7985,768]],7988:[[7984,769]],7989:[[7985,769]],7990:[[7984,834]],7991:[[7985,834]],7992:[[921,787],,{768:7994,769:7996,834:7998}],7993:[[921,788],,{768:7995,769:7997,834:7999}],7994:[[7992,768]],7995:[[7993,768]],7996:[[7992,769]],7997:[[7993,769]],7998:[[7992,834]],7999:[[7993,834]],8e3:[[959,787],,{768:8002,769:8004}],8001:[[959,788],,{768:8003,769:8005}],8002:[[8e3,768]],8003:[[8001,768]],8004:[[8e3,769]],8005:[[8001,769]],8008:[[927,787],,{768:8010,769:8012}],8009:[[927,788],,{768:8011,769:8013}],8010:[[8008,768]],8011:[[8009,768]],8012:[[8008,769]],8013:[[8009,769]],8016:[[965,787],,{768:8018,769:8020,834:8022}],8017:[[965,788],,{768:8019,769:8021,834:8023}],8018:[[8016,768]],8019:[[8017,768]],8020:[[8016,769]],8021:[[8017,769]],8022:[[8016,834]],8023:[[8017,834]],8025:[[933,788],,{768:8027,769:8029,834:8031}],8027:[[8025,768]],8029:[[8025,769]],8031:[[8025,834]],8032:[[969,787],,{768:8034,769:8036,834:8038,837:8096}],8033:[[969,788],,{768:8035,769:8037,834:8039,837:8097}],8034:[[8032,768],,{837:8098}],8035:[[8033,768],,{837:8099}],8036:[[8032,769],,{837:8100}],8037:[[8033,769],,{837:8101}],8038:[[8032,834],,{837:8102}],8039:[[8033,834],,{837:8103}],8040:[[937,787],,{768:8042,769:8044,834:8046,837:8104}],8041:[[937,788],,{768:8043,769:8045,834:8047,837:8105}],8042:[[8040,768],,{837:8106}],8043:[[8041,768],,{837:8107}],8044:[[8040,769],,{837:8108}],8045:[[8041,769],,{837:8109}],8046:[[8040,834],,{837:8110}],8047:[[8041,834],,{837:8111}],8048:[[945,768],,{837:8114}],8049:[[940]],8050:[[949,768]],8051:[[941]],8052:[[951,768],,{837:8130}],8053:[[942]],8054:[[953,768]],8055:[[943]],8056:[[959,768]],8057:[[972]],8058:[[965,768]],8059:[[973]],8060:[[969,768],,{837:8178}],8061:[[974]],8064:[[7936,837]],8065:[[7937,837]],8066:[[7938,837]],8067:[[7939,837]],8068:[[7940,837]],8069:[[7941,837]],8070:[[7942,837]],8071:[[7943,837]],8072:[[7944,837]],8073:[[7945,837]],8074:[[7946,837]],8075:[[7947,837]],8076:[[7948,837]],8077:[[7949,837]],8078:[[7950,837]],8079:[[7951,837]],8080:[[7968,837]],8081:[[7969,837]],8082:[[7970,837]],8083:[[7971,837]],8084:[[7972,837]],8085:[[7973,837]],8086:[[7974,837]],8087:[[7975,837]],8088:[[7976,837]],8089:[[7977,837]],8090:[[7978,837]],8091:[[7979,837]],8092:[[7980,837]],8093:[[7981,837]],8094:[[7982,837]],8095:[[7983,837]],8096:[[8032,837]],8097:[[8033,837]],8098:[[8034,837]],8099:[[8035,837]],8100:[[8036,837]],8101:[[8037,837]],8102:[[8038,837]],8103:[[8039,837]],8104:[[8040,837]],8105:[[8041,837]],8106:[[8042,837]],8107:[[8043,837]],8108:[[8044,837]],8109:[[8045,837]],8110:[[8046,837]],8111:[[8047,837]],8112:[[945,774]],8113:[[945,772]],8114:[[8048,837]],8115:[[945,837]],8116:[[940,837]],8118:[[945,834],,{837:8119}],8119:[[8118,837]],8120:[[913,774]],8121:[[913,772]],8122:[[913,768]],8123:[[902]],8124:[[913,837]],8125:[[32,787],256],8126:[[953]],8127:[[32,787],256,{768:8141,769:8142,834:8143}],8128:[[32,834],256],8129:[[168,834]],8130:[[8052,837]],8131:[[951,837]],8132:[[942,837]],8134:[[951,834],,{837:8135}],8135:[[8134,837]],8136:[[917,768]],8137:[[904]],8138:[[919,768]],8139:[[905]],8140:[[919,837]],8141:[[8127,768]],8142:[[8127,769]],8143:[[8127,834]],8144:[[953,774]],8145:[[953,772]],8146:[[970,768]],8147:[[912]],8150:[[953,834]],8151:[[970,834]],8152:[[921,774]],8153:[[921,772]],8154:[[921,768]],8155:[[906]],8157:[[8190,768]],8158:[[8190,769]],8159:[[8190,834]],8160:[[965,774]],8161:[[965,772]],8162:[[971,768]],8163:[[944]],8164:[[961,787]],8165:[[961,788]],8166:[[965,834]],8167:[[971,834]],8168:[[933,774]],8169:[[933,772]],8170:[[933,768]],8171:[[910]],8172:[[929,788]],8173:[[168,768]],8174:[[901]],8175:[[96]],8178:[[8060,837]],8179:[[969,837]],8180:[[974,837]],8182:[[969,834],,{837:8183}],8183:[[8182,837]],8184:[[927,768]],8185:[[908]],8186:[[937,768]],8187:[[911]],8188:[[937,837]],8189:[[180]],8190:[[32,788],256,{768:8157,769:8158,834:8159}]},8192:{8192:[[8194]],8193:[[8195]],8194:[[32],256],8195:[[32],256],8196:[[32],256],8197:[[32],256],8198:[[32],256],8199:[[32],256],8200:[[32],256],8201:[[32],256],8202:[[32],256],8209:[[8208],256],8215:[[32,819],256],8228:[[46],256],8229:[[46,46],256],8230:[[46,46,46],256],8239:[[32],256],8243:[[8242,8242],256],8244:[[8242,8242,8242],256],8246:[[8245,8245],256],8247:[[8245,8245,8245],256],8252:[[33,33],256],8254:[[32,773],256],8263:[[63,63],256],8264:[[63,33],256],8265:[[33,63],256],8279:[[8242,8242,8242,8242],256],8287:[[32],256],8304:[[48],256],8305:[[105],256],8308:[[52],256],8309:[[53],256],8310:[[54],256],8311:[[55],256],8312:[[56],256],8313:[[57],256],8314:[[43],256],8315:[[8722],256],8316:[[61],256],8317:[[40],256],8318:[[41],256],8319:[[110],256],8320:[[48],256],8321:[[49],256],8322:[[50],256],8323:[[51],256],8324:[[52],256],8325:[[53],256],8326:[[54],256],8327:[[55],256],8328:[[56],256],8329:[[57],256],8330:[[43],256],8331:[[8722],256],8332:[[61],256],8333:[[40],256],8334:[[41],256],8336:[[97],256],8337:[[101],256],8338:[[111],256],8339:[[120],256],8340:[[601],256],8341:[[104],256],8342:[[107],256],8343:[[108],256],8344:[[109],256],8345:[[110],256],8346:[[112],256],8347:[[115],256],8348:[[116],256],8360:[[82,115],256],8400:[,230],8401:[,230],8402:[,1],8403:[,1],8404:[,230],8405:[,230],8406:[,230],8407:[,230],8408:[,1],8409:[,1],8410:[,1],8411:[,230],8412:[,230],8417:[,230],8421:[,1],8422:[,1],8423:[,230],8424:[,220],8425:[,230],8426:[,1],8427:[,1],8428:[,220],8429:[,220],8430:[,220],8431:[,220],8432:[,230]},8448:{8448:[[97,47,99],256],8449:[[97,47,115],256],8450:[[67],256],8451:[[176,67],256],8453:[[99,47,111],256],8454:[[99,47,117],256],8455:[[400],256],8457:[[176,70],256],8458:[[103],256],8459:[[72],256],8460:[[72],256],8461:[[72],256],8462:[[104],256],8463:[[295],256],8464:[[73],256],8465:[[73],256],8466:[[76],256],8467:[[108],256],8469:[[78],256],8470:[[78,111],256],8473:[[80],256],8474:[[81],256],8475:[[82],256],8476:[[82],256],8477:[[82],256],8480:[[83,77],256],8481:[[84,69,76],256],8482:[[84,77],256],8484:[[90],256],8486:[[937]],8488:[[90],256],8490:[[75]],8491:[[197]],8492:[[66],256],8493:[[67],256],8495:[[101],256],8496:[[69],256],8497:[[70],256],8499:[[77],256],8500:[[111],256],8501:[[1488],256],8502:[[1489],256],8503:[[1490],256],8504:[[1491],256],8505:[[105],256],8507:[[70,65,88],256],8508:[[960],256],8509:[[947],256],8510:[[915],256],8511:[[928],256],8512:[[8721],256],8517:[[68],256],8518:[[100],256],8519:[[101],256],8520:[[105],256],8521:[[106],256],8528:[[49,8260,55],256],8529:[[49,8260,57],256],8530:[[49,8260,49,48],256],8531:[[49,8260,51],256],8532:[[50,8260,51],256],8533:[[49,8260,53],256],8534:[[50,8260,53],256],8535:[[51,8260,53],256],8536:[[52,8260,53],256],8537:[[49,8260,54],256],8538:[[53,8260,54],256],8539:[[49,8260,56],256],8540:[[51,8260,56],256],8541:[[53,8260,56],256],8542:[[55,8260,56],256],8543:[[49,8260],256],8544:[[73],256],8545:[[73,73],256],8546:[[73,73,73],256],8547:[[73,86],256],8548:[[86],256],8549:[[86,73],256],8550:[[86,73,73],256],8551:[[86,73,73,73],256],8552:[[73,88],256],8553:[[88],256],8554:[[88,73],256],8555:[[88,73,73],256],8556:[[76],256],8557:[[67],256],8558:[[68],256],8559:[[77],256],8560:[[105],256],8561:[[105,105],256],8562:[[105,105,105],256],8563:[[105,118],256],8564:[[118],256],8565:[[118,105],256],8566:[[118,105,105],256],8567:[[118,105,105,105],256],8568:[[105,120],256],8569:[[120],256],8570:[[120,105],256],8571:[[120,105,105],256],8572:[[108],256],8573:[[99],256],8574:[[100],256],8575:[[109],256],8585:[[48,8260,51],256],8592:[,,{824:8602}],8594:[,,{824:8603}],8596:[,,{824:8622}],8602:[[8592,824]],8603:[[8594,824]],8622:[[8596,824]],8653:[[8656,824]],8654:[[8660,824]],8655:[[8658,824]],8656:[,,{824:8653}],8658:[,,{824:8655}],8660:[,,{824:8654}]},8704:{8707:[,,{824:8708}],8708:[[8707,824]],8712:[,,{824:8713}],8713:[[8712,824]],8715:[,,{824:8716}],8716:[[8715,824]],8739:[,,{824:8740}],8740:[[8739,824]],8741:[,,{824:8742}],8742:[[8741,824]],8748:[[8747,8747],256],8749:[[8747,8747,8747],256],8751:[[8750,8750],256],8752:[[8750,8750,8750],256],8764:[,,{824:8769}],8769:[[8764,824]],8771:[,,{824:8772}],8772:[[8771,824]],8773:[,,{824:8775}],8775:[[8773,824]],8776:[,,{824:8777}],8777:[[8776,824]],8781:[,,{824:8813}],8800:[[61,824]],8801:[,,{824:8802}],8802:[[8801,824]],8804:[,,{824:8816}],8805:[,,{824:8817}],8813:[[8781,824]],8814:[[60,824]],8815:[[62,824]],8816:[[8804,824]],8817:[[8805,824]],8818:[,,{824:8820}],8819:[,,{824:8821}],8820:[[8818,824]],8821:[[8819,824]],8822:[,,{824:8824}],8823:[,,{824:8825}],8824:[[8822,824]],8825:[[8823,824]],8826:[,,{824:8832}],8827:[,,{824:8833}],8828:[,,{824:8928}],8829:[,,{824:8929}],8832:[[8826,824]],8833:[[8827,824]],8834:[,,{824:8836}],8835:[,,{824:8837}],8836:[[8834,824]],8837:[[8835,824]],8838:[,,{824:8840}],8839:[,,{824:8841}],8840:[[8838,824]],8841:[[8839,824]],8849:[,,{824:8930}],8850:[,,{824:8931}],8866:[,,{824:8876}],8872:[,,{824:8877}],8873:[,,{824:8878}],8875:[,,{824:8879}],8876:[[8866,824]],8877:[[8872,824]],8878:[[8873,824]],8879:[[8875,824]],8882:[,,{824:8938}],8883:[,,{824:8939}],8884:[,,{824:8940}],8885:[,,{824:8941}],8928:[[8828,824]],8929:[[8829,824]],8930:[[8849,824]],8931:[[8850,824]],8938:[[8882,824]],8939:[[8883,824]],8940:[[8884,824]],8941:[[8885,824]]},8960:{9001:[[12296]],9002:[[12297]]},9216:{9312:[[49],256],9313:[[50],256],9314:[[51],256],9315:[[52],256],9316:[[53],256],9317:[[54],256],9318:[[55],256],9319:[[56],256],9320:[[57],256],9321:[[49,48],256],9322:[[49,49],256],9323:[[49,50],256],9324:[[49,51],256],9325:[[49,52],256],9326:[[49,53],256],9327:[[49,54],256],9328:[[49,55],256],9329:[[49,56],256],9330:[[49,57],256],9331:[[50,48],256],9332:[[40,49,41],256],9333:[[40,50,41],256],9334:[[40,51,41],256],9335:[[40,52,41],256],9336:[[40,53,41],256],9337:[[40,54,41],256],9338:[[40,55,41],256],9339:[[40,56,41],256],9340:[[40,57,41],256],9341:[[40,49,48,41],256],9342:[[40,49,49,41],256],9343:[[40,49,50,41],256],9344:[[40,49,51,41],256],9345:[[40,49,52,41],256],9346:[[40,49,53,41],256],9347:[[40,49,54,41],256],9348:[[40,49,55,41],256],9349:[[40,49,56,41],256],9350:[[40,49,57,41],256],9351:[[40,50,48,41],256],9352:[[49,46],256],9353:[[50,46],256],9354:[[51,46],256],9355:[[52,46],256],9356:[[53,46],256],9357:[[54,46],256],9358:[[55,46],256],9359:[[56,46],256],9360:[[57,46],256],9361:[[49,48,46],256],9362:[[49,49,46],256],9363:[[49,50,46],256],9364:[[49,51,46],256],9365:[[49,52,46],256],9366:[[49,53,46],256],9367:[[49,54,46],256],9368:[[49,55,46],256],9369:[[49,56,46],256],9370:[[49,57,46],256],9371:[[50,48,46],256],9372:[[40,97,41],256],9373:[[40,98,41],256],9374:[[40,99,41],256],9375:[[40,100,41],256],9376:[[40,101,41],256],9377:[[40,102,41],256],9378:[[40,103,41],256],9379:[[40,104,41],256],9380:[[40,105,41],256],9381:[[40,106,41],256],9382:[[40,107,41],256],9383:[[40,108,41],256],9384:[[40,109,41],256],9385:[[40,110,41],256],9386:[[40,111,41],256],9387:[[40,112,41],256],9388:[[40,113,41],256],9389:[[40,114,41],256],9390:[[40,115,41],256],9391:[[40,116,41],256],9392:[[40,117,41],256],9393:[[40,118,41],256],9394:[[40,119,41],256],9395:[[40,120,41],256],9396:[[40,121,41],256],9397:[[40,122,41],256],9398:[[65],256],9399:[[66],256],9400:[[67],256],9401:[[68],256],9402:[[69],256],9403:[[70],256],9404:[[71],256],9405:[[72],256],9406:[[73],256],9407:[[74],256],9408:[[75],256],9409:[[76],256],9410:[[77],256],9411:[[78],256],9412:[[79],256],9413:[[80],256],9414:[[81],256],9415:[[82],256],9416:[[83],256],9417:[[84],256],9418:[[85],256],9419:[[86],256],9420:[[87],256],9421:[[88],256],9422:[[89],256],9423:[[90],256],9424:[[97],256],9425:[[98],256],9426:[[99],256],9427:[[100],256],9428:[[101],256],9429:[[102],256],9430:[[103],256],9431:[[104],256],9432:[[105],256],9433:[[106],256],9434:[[107],256],9435:[[108],256],9436:[[109],256],9437:[[110],256],9438:[[111],256],9439:[[112],256],9440:[[113],256],9441:[[114],256],9442:[[115],256],9443:[[116],256],9444:[[117],256],9445:[[118],256],9446:[[119],256],9447:[[120],256],9448:[[121],256],9449:[[122],256],9450:[[48],256]},10752:{10764:[[8747,8747,8747,8747],256],10868:[[58,58,61],256],10869:[[61,61],256],10870:[[61,61,61],256],10972:[[10973,824],512]},11264:{11388:[[106],256],11389:[[86],256],11503:[,230],11504:[,230],11505:[,230]},11520:{11631:[[11617],256],11647:[,9],11744:[,230],11745:[,230],11746:[,230],11747:[,230],11748:[,230],11749:[,230],11750:[,230],11751:[,230],11752:[,230],11753:[,230],11754:[,230],11755:[,230],11756:[,230],11757:[,230],11758:[,230],11759:[,230],11760:[,230],11761:[,230],11762:[,230],11763:[,230],11764:[,230],11765:[,230],11766:[,230],11767:[,230],11768:[,230],11769:[,230],11770:[,230],11771:[,230],11772:[,230],11773:[,230],11774:[,230],11775:[,230]},11776:{11935:[[27597],256],12019:[[40863],256]},12032:{12032:[[19968],256],12033:[[20008],256],12034:[[20022],256],12035:[[20031],256],12036:[[20057],256],12037:[[20101],256],12038:[[20108],256],12039:[[20128],256],12040:[[20154],256],12041:[[20799],256],12042:[[20837],256],12043:[[20843],256],12044:[[20866],256],12045:[[20886],256],12046:[[20907],256],12047:[[20960],256],12048:[[20981],256],12049:[[20992],256],12050:[[21147],256],12051:[[21241],256],12052:[[21269],256],12053:[[21274],256],12054:[[21304],256],12055:[[21313],256],12056:[[21340],256],12057:[[21353],256],12058:[[21378],256],12059:[[21430],256],12060:[[21448],256],12061:[[21475],256],12062:[[22231],256],12063:[[22303],256],12064:[[22763],256],12065:[[22786],256],12066:[[22794],256],12067:[[22805],256],12068:[[22823],256],12069:[[22899],256],12070:[[23376],256],12071:[[23424],256],12072:[[23544],256],12073:[[23567],256],12074:[[23586],256],12075:[[23608],256],12076:[[23662],256],12077:[[23665],256],12078:[[24027],256],12079:[[24037],256],12080:[[24049],256],12081:[[24062],256],12082:[[24178],256],12083:[[24186],256],12084:[[24191],256],12085:[[24308],256],12086:[[24318],256],12087:[[24331],256],12088:[[24339],256],12089:[[24400],256],12090:[[24417],256],12091:[[24435],256],12092:[[24515],256],12093:[[25096],256],12094:[[25142],256],12095:[[25163],256],12096:[[25903],256],12097:[[25908],256],12098:[[25991],256],12099:[[26007],256],12100:[[26020],256],12101:[[26041],256],12102:[[26080],256],12103:[[26085],256],12104:[[26352],256],12105:[[26376],256],12106:[[26408],256],12107:[[27424],256],12108:[[27490],256],12109:[[27513],256],12110:[[27571],256],12111:[[27595],256],12112:[[27604],256],12113:[[27611],256],12114:[[27663],256],12115:[[27668],256],12116:[[27700],256],12117:[[28779],256],12118:[[29226],256],12119:[[29238],256],12120:[[29243],256],12121:[[29247],256],12122:[[29255],256],12123:[[29273],256],12124:[[29275],256],12125:[[29356],256],12126:[[29572],256],12127:[[29577],256],12128:[[29916],256],12129:[[29926],256],12130:[[29976],256],12131:[[29983],256],12132:[[29992],256],12133:[[3e4],256],12134:[[30091],256],12135:[[30098],256],12136:[[30326],256],12137:[[30333],256],12138:[[30382],256],12139:[[30399],256],12140:[[30446],256],12141:[[30683],256],12142:[[30690],256],12143:[[30707],256],12144:[[31034],256],12145:[[31160],256],12146:[[31166],256],12147:[[31348],256],12148:[[31435],256],12149:[[31481],256],12150:[[31859],256],12151:[[31992],256],12152:[[32566],256],12153:[[32593],256],12154:[[32650],256],12155:[[32701],256],12156:[[32769],256],12157:[[32780],256],12158:[[32786],256],12159:[[32819],256],12160:[[32895],256],12161:[[32905],256],12162:[[33251],256],12163:[[33258],256],12164:[[33267],256],12165:[[33276],256],12166:[[33292],256],12167:[[33307],256],12168:[[33311],256],12169:[[33390],256],12170:[[33394],256],12171:[[33400],256],12172:[[34381],256],12173:[[34411],256],12174:[[34880],256],12175:[[34892],256],12176:[[34915],256],12177:[[35198],256],12178:[[35211],256],12179:[[35282],256],12180:[[35328],256],12181:[[35895],256],12182:[[35910],256],12183:[[35925],256],12184:[[35960],256],12185:[[35997],256],12186:[[36196],256],12187:[[36208],256],12188:[[36275],256],12189:[[36523],256],12190:[[36554],256],12191:[[36763],256],12192:[[36784],256],12193:[[36789],256],12194:[[37009],256],12195:[[37193],256],12196:[[37318],256],12197:[[37324],256],12198:[[37329],256],12199:[[38263],256],12200:[[38272],256],12201:[[38428],256],12202:[[38582],256],12203:[[38585],256],12204:[[38632],256],12205:[[38737],256],12206:[[38750],256],12207:[[38754],256],12208:[[38761],256],12209:[[38859],256],12210:[[38893],256],12211:[[38899],256],12212:[[38913],256],12213:[[39080],256],12214:[[39131],256],12215:[[39135],256],12216:[[39318],256],12217:[[39321],256],12218:[[39340],256],12219:[[39592],256],12220:[[39640],256],12221:[[39647],256],12222:[[39717],256],12223:[[39727],256],12224:[[39730],256],12225:[[39740],256],12226:[[39770],256],12227:[[40165],256],12228:[[40565],256],12229:[[40575],256],12230:[[40613],256],12231:[[40635],256],12232:[[40643],256],12233:[[40653],256],12234:[[40657],256],12235:[[40697],256],12236:[[40701],256],12237:[[40718],256],12238:[[40723],256],12239:[[40736],256],12240:[[40763],256],12241:[[40778],256],12242:[[40786],256],12243:[[40845],256],12244:[[40860],256],12245:[[40864],256]},12288:{12288:[[32],256],12330:[,218],12331:[,228],12332:[,232],12333:[,222],12334:[,224],12335:[,224],12342:[[12306],256],12344:[[21313],256],12345:[[21316],256],12346:[[21317],256],12358:[,,{12441:12436}],12363:[,,{12441:12364}],12364:[[12363,12441]],12365:[,,{12441:12366}],12366:[[12365,12441]],12367:[,,{12441:12368}],12368:[[12367,12441]],12369:[,,{12441:12370}],12370:[[12369,12441]],12371:[,,{12441:12372}],12372:[[12371,12441]],12373:[,,{12441:12374}],12374:[[12373,12441]],12375:[,,{12441:12376}],12376:[[12375,12441]],12377:[,,{12441:12378}],12378:[[12377,12441]],12379:[,,{12441:12380}],12380:[[12379,12441]],12381:[,,{12441:12382}],12382:[[12381,12441]],12383:[,,{12441:12384}],12384:[[12383,12441]],12385:[,,{12441:12386}],12386:[[12385,12441]],12388:[,,{12441:12389}],12389:[[12388,12441]],12390:[,,{12441:12391}],12391:[[12390,12441]],12392:[,,{12441:12393}],12393:[[12392,12441]],12399:[,,{12441:12400,12442:12401}],12400:[[12399,12441]],12401:[[12399,12442]],12402:[,,{12441:12403,12442:12404}],12403:[[12402,12441]],12404:[[12402,12442]],12405:[,,{12441:12406,12442:12407}],12406:[[12405,12441]],12407:[[12405,12442]],12408:[,,{12441:12409,12442:12410}],12409:[[12408,12441]],12410:[[12408,12442]],12411:[,,{12441:12412,12442:12413}],12412:[[12411,12441]],12413:[[12411,12442]],12436:[[12358,12441]],12441:[,8],12442:[,8],12443:[[32,12441],256],12444:[[32,12442],256],12445:[,,{12441:12446}],12446:[[12445,12441]],12447:[[12424,12426],256],12454:[,,{12441:12532}],12459:[,,{12441:12460}],12460:[[12459,12441]],12461:[,,{12441:12462}],12462:[[12461,12441]],12463:[,,{12441:12464}],12464:[[12463,12441]],12465:[,,{12441:12466}],12466:[[12465,12441]],12467:[,,{12441:12468}],12468:[[12467,12441]],12469:[,,{12441:12470}],12470:[[12469,12441]],12471:[,,{12441:12472}],12472:[[12471,12441]],12473:[,,{12441:12474}],12474:[[12473,12441]],12475:[,,{12441:12476}],12476:[[12475,12441]],12477:[,,{12441:12478}],12478:[[12477,12441]],12479:[,,{12441:12480}],12480:[[12479,12441]],12481:[,,{12441:12482}],12482:[[12481,12441]],12484:[,,{12441:12485}],12485:[[12484,12441]],12486:[,,{12441:12487}],12487:[[12486,12441]],12488:[,,{12441:12489}],12489:[[12488,12441]],12495:[,,{12441:12496,12442:12497}],12496:[[12495,12441]],12497:[[12495,12442]],12498:[,,{12441:12499,12442:12500}],12499:[[12498,12441]],12500:[[12498,12442]],12501:[,,{12441:12502,12442:12503}],12502:[[12501,12441]],12503:[[12501,12442]],12504:[,,{12441:12505,12442:12506}],12505:[[12504,12441]],12506:[[12504,12442]],12507:[,,{12441:12508,12442:12509}],12508:[[12507,12441]],12509:[[12507,12442]],12527:[,,{12441:12535}],12528:[,,{12441:12536}],12529:[,,{12441:12537}],12530:[,,{12441:12538}],12532:[[12454,12441]],12535:[[12527,12441]],12536:[[12528,12441]],12537:[[12529,12441]],12538:[[12530,12441]],12541:[,,{12441:12542}],12542:[[12541,12441]],12543:[[12467,12488],256]},12544:{12593:[[4352],256],12594:[[4353],256],12595:[[4522],256],12596:[[4354],256],12597:[[4524],256],12598:[[4525],256],12599:[[4355],256],12600:[[4356],256],12601:[[4357],256],12602:[[4528],256],12603:[[4529],256],12604:[[4530],256],12605:[[4531],256],12606:[[4532],256],12607:[[4533],256],12608:[[4378],256],12609:[[4358],256],12610:[[4359],256],12611:[[4360],256],12612:[[4385],256],12613:[[4361],256],12614:[[4362],256],12615:[[4363],256],12616:[[4364],256],12617:[[4365],256],12618:[[4366],256],12619:[[4367],256],12620:[[4368],256],12621:[[4369],256],12622:[[4370],256],12623:[[4449],256],12624:[[4450],256],12625:[[4451],256],12626:[[4452],256],12627:[[4453],256],12628:[[4454],256],12629:[[4455],256],12630:[[4456],256],12631:[[4457],256],12632:[[4458],256],12633:[[4459],256],12634:[[4460],256],12635:[[4461],256],12636:[[4462],256],12637:[[4463],256],12638:[[4464],256],12639:[[4465],256],12640:[[4466],256],12641:[[4467],256],12642:[[4468],256],12643:[[4469],256],12644:[[4448],256],12645:[[4372],256],12646:[[4373],256],12647:[[4551],256],12648:[[4552],256],12649:[[4556],256],12650:[[4558],256],12651:[[4563],256],12652:[[4567],256],12653:[[4569],256],12654:[[4380],256],12655:[[4573],256],12656:[[4575],256],12657:[[4381],256],12658:[[4382],256],12659:[[4384],256],12660:[[4386],256],12661:[[4387],256],12662:[[4391],256],12663:[[4393],256],12664:[[4395],256],12665:[[4396],256],12666:[[4397],256],12667:[[4398],256],12668:[[4399],256],12669:[[4402],256],12670:[[4406],256],12671:[[4416],256],12672:[[4423],256],12673:[[4428],256],12674:[[4593],256],12675:[[4594],256],12676:[[4439],256],12677:[[4440],256],12678:[[4441],256],12679:[[4484],256],12680:[[4485],256],12681:[[4488],256],12682:[[4497],256],12683:[[4498],256],12684:[[4500],256],12685:[[4510],256],12686:[[4513],256],12690:[[19968],256],12691:[[20108],256],12692:[[19977],256],12693:[[22235],256],12694:[[19978],256],12695:[[20013],256],12696:[[19979],256],12697:[[30002],256],12698:[[20057],256],12699:[[19993],256],12700:[[19969],256],12701:[[22825],256],12702:[[22320],256],12703:[[20154],256]},12800:{12800:[[40,4352,41],256],12801:[[40,4354,41],256],12802:[[40,4355,41],256],12803:[[40,4357,41],256],12804:[[40,4358,41],256],12805:[[40,4359,41],256],12806:[[40,4361,41],256],12807:[[40,4363,41],256],12808:[[40,4364,41],256],12809:[[40,4366,41],256],12810:[[40,4367,41],256],12811:[[40,4368,41],256],12812:[[40,4369,41],256],12813:[[40,4370,41],256],12814:[[40,4352,4449,41],256],12815:[[40,4354,4449,41],256],12816:[[40,4355,4449,41],256],12817:[[40,4357,4449,41],256],12818:[[40,4358,4449,41],256],12819:[[40,4359,4449,41],256],12820:[[40,4361,4449,41],256],12821:[[40,4363,4449,41],256],12822:[[40,4364,4449,41],256],12823:[[40,4366,4449,41],256],12824:[[40,4367,4449,41],256],12825:[[40,4368,4449,41],256],12826:[[40,4369,4449,41],256],12827:[[40,4370,4449,41],256],12828:[[40,4364,4462,41],256],12829:[[40,4363,4457,4364,4453,4523,41],256],12830:[[40,4363,4457,4370,4462,41],256],12832:[[40,19968,41],256],12833:[[40,20108,41],256],12834:[[40,19977,41],256],12835:[[40,22235,41],256],12836:[[40,20116,41],256],12837:[[40,20845,41],256],12838:[[40,19971,41],256],12839:[[40,20843,41],256],12840:[[40,20061,41],256],12841:[[40,21313,41],256],12842:[[40,26376,41],256],12843:[[40,28779,41],256],12844:[[40,27700,41],256],12845:[[40,26408,41],256],12846:[[40,37329,41],256],12847:[[40,22303,41],256],12848:[[40,26085,41],256],12849:[[40,26666,41],256],12850:[[40,26377,41],256],12851:[[40,31038,41],256],12852:[[40,21517,41],256],12853:[[40,29305,41],256],12854:[[40,36001,41],256],12855:[[40,31069,41],256],12856:[[40,21172,41],256],12857:[[40,20195,41],256],12858:[[40,21628,41],256],12859:[[40,23398,41],256],12860:[[40,30435,41],256],12861:[[40,20225,41],256],12862:[[40,36039,41],256],12863:[[40,21332,41],256],12864:[[40,31085,41],256],12865:[[40,20241,41],256],12866:[[40,33258,41],256],12867:[[40,33267,41],256],12868:[[21839],256],12869:[[24188],256],12870:[[25991],256],12871:[[31631],256],12880:[[80,84,69],256],12881:[[50,49],256],12882:[[50,50],256],12883:[[50,51],256],12884:[[50,52],256],12885:[[50,53],256],12886:[[50,54],256],12887:[[50,55],256],12888:[[50,56],256],12889:[[50,57],256],12890:[[51,48],256],12891:[[51,49],256],12892:[[51,50],256],12893:[[51,51],256],12894:[[51,52],256],12895:[[51,53],256],12896:[[4352],256],12897:[[4354],256],12898:[[4355],256],12899:[[4357],256],12900:[[4358],256],12901:[[4359],256],12902:[[4361],256],12903:[[4363],256],12904:[[4364],256],12905:[[4366],256],12906:[[4367],256],12907:[[4368],256],12908:[[4369],256],12909:[[4370],256],12910:[[4352,4449],256],12911:[[4354,4449],256],12912:[[4355,4449],256],12913:[[4357,4449],256],12914:[[4358,4449],256],12915:[[4359,4449],256],12916:[[4361,4449],256],12917:[[4363,4449],256],12918:[[4364,4449],256],12919:[[4366,4449],256],12920:[[4367,4449],256],12921:[[4368,4449],256],12922:[[4369,4449],256],12923:[[4370,4449],256],12924:[[4366,4449,4535,4352,4457],256],12925:[[4364,4462,4363,4468],256],12926:[[4363,4462],256],12928:[[19968],256],12929:[[20108],256],12930:[[19977],256],12931:[[22235],256],12932:[[20116],256],12933:[[20845],256],12934:[[19971],256],12935:[[20843],256],12936:[[20061],256],12937:[[21313],256],12938:[[26376],256],12939:[[28779],256],12940:[[27700],256],12941:[[26408],256],12942:[[37329],256],12943:[[22303],256],12944:[[26085],256],12945:[[26666],256],12946:[[26377],256],12947:[[31038],256],12948:[[21517],256],12949:[[29305],256],12950:[[36001],256],12951:[[31069],256],12952:[[21172],256],12953:[[31192],256],12954:[[30007],256],12955:[[22899],256],12956:[[36969],256],12957:[[20778],256],12958:[[21360],256],12959:[[27880],256],12960:[[38917],256],12961:[[20241],256],12962:[[20889],256],12963:[[27491],256],12964:[[19978],256],12965:[[20013],256],12966:[[19979],256],12967:[[24038],256],12968:[[21491],256],12969:[[21307],256],12970:[[23447],256],12971:[[23398],256],12972:[[30435],256],12973:[[20225],256],12974:[[36039],256],12975:[[21332],256],12976:[[22812],256],12977:[[51,54],256],12978:[[51,55],256],12979:[[51,56],256],12980:[[51,57],256],12981:[[52,48],256],12982:[[52,49],256],12983:[[52,50],256],12984:[[52,51],256],12985:[[52,52],256],12986:[[52,53],256],12987:[[52,54],256],12988:[[52,55],256],12989:[[52,56],256],12990:[[52,57],256],12991:[[53,48],256],12992:[[49,26376],256],12993:[[50,26376],256],12994:[[51,26376],256],12995:[[52,26376],256],12996:[[53,26376],256],12997:[[54,26376],256],12998:[[55,26376],256],12999:[[56,26376],256],13e3:[[57,26376],256],13001:[[49,48,26376],256],13002:[[49,49,26376],256],13003:[[49,50,26376],256],13004:[[72,103],256],13005:[[101,114,103],256],13006:[[101,86],256],13007:[[76,84,68],256],13008:[[12450],256],13009:[[12452],256],13010:[[12454],256],13011:[[12456],256],13012:[[12458],256],13013:[[12459],256],13014:[[12461],256],13015:[[12463],256],13016:[[12465],256],13017:[[12467],256],13018:[[12469],256],13019:[[12471],256],13020:[[12473],256],13021:[[12475],256],13022:[[12477],256],13023:[[12479],256],13024:[[12481],256],13025:[[12484],256],13026:[[12486],256],13027:[[12488],256],13028:[[12490],256],13029:[[12491],256],13030:[[12492],256],13031:[[12493],256],13032:[[12494],256],13033:[[12495],256],13034:[[12498],256],13035:[[12501],256],13036:[[12504],256],13037:[[12507],256],13038:[[12510],256],13039:[[12511],256],13040:[[12512],256],13041:[[12513],256],13042:[[12514],256],13043:[[12516],256],13044:[[12518],256],13045:[[12520],256],13046:[[12521],256],13047:[[12522],256],13048:[[12523],256],13049:[[12524],256],13050:[[12525],256],13051:[[12527],256],13052:[[12528],256],13053:[[12529],256],13054:[[12530],256]},13056:{13056:[[12450,12497,12540,12488],256],13057:[[12450,12523,12501,12449],256],13058:[[12450,12531,12506,12450],256],13059:[[12450,12540,12523],256],13060:[[12452,12491,12531,12464],256],13061:[[12452,12531,12481],256],13062:[[12454,12457,12531],256],13063:[[12456,12473,12463,12540,12489],256],13064:[[12456,12540,12459,12540],256],13065:[[12458,12531,12473],256],13066:[[12458,12540,12512],256],13067:[[12459,12452,12522],256],13068:[[12459,12521,12483,12488],256],13069:[[12459,12525,12522,12540],256],13070:[[12460,12525,12531],256],13071:[[12460,12531,12510],256],13072:[[12462,12460],256],13073:[[12462,12491,12540],256],13074:[[12461,12517,12522,12540],256],13075:[[12462,12523,12480,12540],256],13076:[[12461,12525],256],13077:[[12461,12525,12464,12521,12512],256],13078:[[12461,12525,12513,12540,12488,12523],256],13079:[[12461,12525,12527,12483,12488],256],13080:[[12464,12521,12512],256],13081:[[12464,12521,12512,12488,12531],256],13082:[[12463,12523,12476,12452,12525],256],13083:[[12463,12525,12540,12493],256],13084:[[12465,12540,12473],256],13085:[[12467,12523,12490],256],13086:[[12467,12540,12509],256],13087:[[12469,12452,12463,12523],256],13088:[[12469,12531,12481,12540,12512],256],13089:[[12471,12522,12531,12464],256],13090:[[12475,12531,12481],256],13091:[[12475,12531,12488],256],13092:[[12480,12540,12473],256],13093:[[12487,12471],256],13094:[[12489,12523],256],13095:[[12488,12531],256],13096:[[12490,12494],256],13097:[[12494,12483,12488],256],13098:[[12495,12452,12484],256],13099:[[12497,12540,12475,12531,12488],256],13100:[[12497,12540,12484],256],13101:[[12496,12540,12524,12523],256],13102:[[12500,12450,12473,12488,12523],256],13103:[[12500,12463,12523],256],13104:[[12500,12467],256],13105:[[12499,12523],256],13106:[[12501,12449,12521,12483,12489],256],13107:[[12501,12451,12540,12488],256],13108:[[12502,12483,12471,12455,12523],256],13109:[[12501,12521,12531],256],13110:[[12504,12463,12479,12540,12523],256],13111:[[12506,12477],256],13112:[[12506,12491,12498],256],13113:[[12504,12523,12484],256],13114:[[12506,12531,12473],256],13115:[[12506,12540,12472],256],13116:[[12505,12540,12479],256],13117:[[12509,12452,12531,12488],256],13118:[[12508,12523,12488],256],13119:[[12507,12531],256],13120:[[12509,12531,12489],256],13121:[[12507,12540,12523],256],13122:[[12507,12540,12531],256],13123:[[12510,12452,12463,12525],256],13124:[[12510,12452,12523],256],13125:[[12510,12483,12495],256],13126:[[12510,12523,12463],256],13127:[[12510,12531,12471,12519,12531],256],13128:[[12511,12463,12525,12531],256],13129:[[12511,12522],256],13130:[[12511,12522,12496,12540,12523],256],13131:[[12513,12460],256],13132:[[12513,12460,12488,12531],256],13133:[[12513,12540,12488,12523],256],13134:[[12516,12540,12489],256],13135:[[12516,12540,12523],256],13136:[[12518,12450,12531],256],13137:[[12522,12483,12488,12523],256],13138:[[12522,12521],256],13139:[[12523,12500,12540],256],13140:[[12523,12540,12502,12523],256],13141:[[12524,12512],256],13142:[[12524,12531,12488,12466,12531],256],13143:[[12527,12483,12488],256],13144:[[48,28857],256],13145:[[49,28857],256],13146:[[50,28857],256],13147:[[51,28857],256],13148:[[52,28857],256],13149:[[53,28857],256],13150:[[54,28857],256],13151:[[55,28857],256],13152:[[56,28857],256],13153:[[57,28857],256],13154:[[49,48,28857],256],13155:[[49,49,28857],256],13156:[[49,50,28857],256],13157:[[49,51,28857],256],13158:[[49,52,28857],256],13159:[[49,53,28857],256],13160:[[49,54,28857],256],13161:[[49,55,28857],256],13162:[[49,56,28857],256],13163:[[49,57,28857],256],13164:[[50,48,28857],256],13165:[[50,49,28857],256],13166:[[50,50,28857],256],13167:[[50,51,28857],256],13168:[[50,52,28857],256],13169:[[104,80,97],256],13170:[[100,97],256],13171:[[65,85],256],13172:[[98,97,114],256],13173:[[111,86],256],13174:[[112,99],256],13175:[[100,109],256],13176:[[100,109,178],256],13177:[[100,109,179],256],13178:[[73,85],256],13179:[[24179,25104],256],13180:[[26157,21644],256],13181:[[22823,27491],256],13182:[[26126,27835],256],13183:[[26666,24335,20250,31038],256],13184:[[112,65],256],13185:[[110,65],256],13186:[[956,65],256],13187:[[109,65],256],13188:[[107,65],256],13189:[[75,66],256],13190:[[77,66],256],13191:[[71,66],256],13192:[[99,97,108],256],13193:[[107,99,97,108],256],13194:[[112,70],256],13195:[[110,70],256],13196:[[956,70],256],13197:[[956,103],256],13198:[[109,103],256],13199:[[107,103],256],13200:[[72,122],256],13201:[[107,72,122],256],13202:[[77,72,122],256],13203:[[71,72,122],256],13204:[[84,72,122],256],13205:[[956,8467],256],13206:[[109,8467],256],13207:[[100,8467],256],13208:[[107,8467],256],13209:[[102,109],256],13210:[[110,109],256],13211:[[956,109],256],13212:[[109,109],256],13213:[[99,109],256],13214:[[107,109],256],13215:[[109,109,178],256],13216:[[99,109,178],256],13217:[[109,178],256],13218:[[107,109,178],256],13219:[[109,109,179],256],13220:[[99,109,179],256],13221:[[109,179],256],13222:[[107,109,179],256],13223:[[109,8725,115],256],13224:[[109,8725,115,178],256],13225:[[80,97],256],13226:[[107,80,97],256],13227:[[77,80,97],256],13228:[[71,80,97],256],13229:[[114,97,100],256],13230:[[114,97,100,8725,115],256],13231:[[114,97,100,8725,115,178],256],13232:[[112,115],256],13233:[[110,115],256],13234:[[956,115],256],13235:[[109,115],256],13236:[[112,86],256],13237:[[110,86],256],13238:[[956,86],256],13239:[[109,86],256],13240:[[107,86],256],13241:[[77,86],256],13242:[[112,87],256],13243:[[110,87],256],13244:[[956,87],256],13245:[[109,87],256],13246:[[107,87],256],13247:[[77,87],256],13248:[[107,937],256],13249:[[77,937],256],13250:[[97,46,109,46],256],13251:[[66,113],256],13252:[[99,99],256],13253:[[99,100],256],13254:[[67,8725,107,103],256],13255:[[67,111,46],256],13256:[[100,66],256],13257:[[71,121],256],13258:[[104,97],256],13259:[[72,80],256],13260:[[105,110],256],13261:[[75,75],256],13262:[[75,77],256],13263:[[107,116],256],13264:[[108,109],256],13265:[[108,110],256],13266:[[108,111,103],256],13267:[[108,120],256],13268:[[109,98],256],13269:[[109,105,108],256],13270:[[109,111,108],256],13271:[[80,72],256],13272:[[112,46,109,46],256],13273:[[80,80,77],256],13274:[[80,82],256],13275:[[115,114],256],13276:[[83,118],256],13277:[[87,98],256],13278:[[86,8725,109],256],13279:[[65,8725,109],256],13280:[[49,26085],256],13281:[[50,26085],256],13282:[[51,26085],256],13283:[[52,26085],256],13284:[[53,26085],256],13285:[[54,26085],256],13286:[[55,26085],256],13287:[[56,26085],256],13288:[[57,26085],256],13289:[[49,48,26085],256],13290:[[49,49,26085],256],13291:[[49,50,26085],256],13292:[[49,51,26085],256],13293:[[49,52,26085],256],13294:[[49,53,26085],256],13295:[[49,54,26085],256],13296:[[49,55,26085],256],13297:[[49,56,26085],256],13298:[[49,57,26085],256],13299:[[50,48,26085],256],13300:[[50,49,26085],256],13301:[[50,50,26085],256],13302:[[50,51,26085],256],13303:[[50,52,26085],256],13304:[[50,53,26085],256],13305:[[50,54,26085],256],13306:[[50,55,26085],256],13307:[[50,56,26085],256],13308:[[50,57,26085],256],13309:[[51,48,26085],256],13310:[[51,49,26085],256],13311:[[103,97,108],256]},27136:{92912:[,1],92913:[,1],92914:[,1],92915:[,1],92916:[,1]},27392:{92976:[,230],92977:[,230],92978:[,230],92979:[,230],92980:[,230],92981:[,230],92982:[,230]},42496:{42607:[,230],42612:[,230],42613:[,230],42614:[,230],42615:[,230],42616:[,230],42617:[,230],42618:[,230],42619:[,230],42620:[,230],42621:[,230],42652:[[1098],256],42653:[[1100],256],42655:[,230],42736:[,230],42737:[,230]},42752:{42864:[[42863],256],43e3:[[294],256],43001:[[339],256]},43008:{43014:[,9],43204:[,9],43232:[,230],43233:[,230],43234:[,230],43235:[,230],43236:[,230],43237:[,230],43238:[,230],43239:[,230],43240:[,230],43241:[,230],43242:[,230],43243:[,230],43244:[,230],43245:[,230],43246:[,230],43247:[,230],43248:[,230],43249:[,230]},43264:{43307:[,220],43308:[,220],43309:[,220],43347:[,9],43443:[,7],43456:[,9]},43520:{43696:[,230],43698:[,230],43699:[,230],43700:[,220],43703:[,230],43704:[,230],43710:[,230],43711:[,230],43713:[,230],43766:[,9]},43776:{43868:[[42791],256],43869:[[43831],256],43870:[[619],256],43871:[[43858],256],44013:[,9]},48128:{113822:[,1]},53504:{119134:[[119127,119141],512],119135:[[119128,119141],512],119136:[[119135,119150],512],119137:[[119135,119151],512],119138:[[119135,119152],512],119139:[[119135,119153],512],119140:[[119135,119154],512],119141:[,216],119142:[,216],119143:[,1],119144:[,1],119145:[,1],119149:[,226],119150:[,216],119151:[,216],119152:[,216],119153:[,216],119154:[,216],119163:[,220],119164:[,220],119165:[,220],119166:[,220],119167:[,220],119168:[,220],119169:[,220],119170:[,220],119173:[,230],119174:[,230],119175:[,230],119176:[,230],119177:[,230],119178:[,220],119179:[,220],119210:[,230],119211:[,230],119212:[,230],119213:[,230],119227:[[119225,119141],512],119228:[[119226,119141],512],119229:[[119227,119150],512],119230:[[119228,119150],512],119231:[[119227,119151],512],119232:[[119228,119151],512]},53760:{119362:[,230],119363:[,230],119364:[,230]},54272:{119808:[[65],256],119809:[[66],256],119810:[[67],256],119811:[[68],256],119812:[[69],256],119813:[[70],256],119814:[[71],256],119815:[[72],256],119816:[[73],256],119817:[[74],256],119818:[[75],256],119819:[[76],256],119820:[[77],256],119821:[[78],256],119822:[[79],256],119823:[[80],256],119824:[[81],256],119825:[[82],256],119826:[[83],256],119827:[[84],256],119828:[[85],256],119829:[[86],256],119830:[[87],256],119831:[[88],256],119832:[[89],256],119833:[[90],256],119834:[[97],256],119835:[[98],256],119836:[[99],256],119837:[[100],256],119838:[[101],256],119839:[[102],256],119840:[[103],256],119841:[[104],256],119842:[[105],256],119843:[[106],256],119844:[[107],256],119845:[[108],256],119846:[[109],256],119847:[[110],256],119848:[[111],256],119849:[[112],256],119850:[[113],256],119851:[[114],256],119852:[[115],256],119853:[[116],256],119854:[[117],256],119855:[[118],256],119856:[[119],256],119857:[[120],256],119858:[[121],256],119859:[[122],256],119860:[[65],256],119861:[[66],256],119862:[[67],256],119863:[[68],256],119864:[[69],256],119865:[[70],256],119866:[[71],256],119867:[[72],256],119868:[[73],256],119869:[[74],256],119870:[[75],256],119871:[[76],256],119872:[[77],256],119873:[[78],256],119874:[[79],256],119875:[[80],256],119876:[[81],256],119877:[[82],256],119878:[[83],256],119879:[[84],256],119880:[[85],256],119881:[[86],256],119882:[[87],256],119883:[[88],256],119884:[[89],256],119885:[[90],256],119886:[[97],256],119887:[[98],256],119888:[[99],256],119889:[[100],256],119890:[[101],256],119891:[[102],256],119892:[[103],256],119894:[[105],256],119895:[[106],256],119896:[[107],256],119897:[[108],256],119898:[[109],256],119899:[[110],256],119900:[[111],256],119901:[[112],256],119902:[[113],256],119903:[[114],256],119904:[[115],256],119905:[[116],256],119906:[[117],256],119907:[[118],256],119908:[[119],256],119909:[[120],256],119910:[[121],256],119911:[[122],256],119912:[[65],256],119913:[[66],256],119914:[[67],256],119915:[[68],256],119916:[[69],256],119917:[[70],256],119918:[[71],256],119919:[[72],256],119920:[[73],256],119921:[[74],256],119922:[[75],256],119923:[[76],256],119924:[[77],256],119925:[[78],256],119926:[[79],256],119927:[[80],256],119928:[[81],256],119929:[[82],256],119930:[[83],256],119931:[[84],256],119932:[[85],256],119933:[[86],256],119934:[[87],256],119935:[[88],256],119936:[[89],256],119937:[[90],256],119938:[[97],256],119939:[[98],256],119940:[[99],256],119941:[[100],256],119942:[[101],256],119943:[[102],256],119944:[[103],256],119945:[[104],256],119946:[[105],256],119947:[[106],256],119948:[[107],256],119949:[[108],256],119950:[[109],256],119951:[[110],256],119952:[[111],256],119953:[[112],256],119954:[[113],256],119955:[[114],256],119956:[[115],256],119957:[[116],256],119958:[[117],256],119959:[[118],256],119960:[[119],256],119961:[[120],256],119962:[[121],256],119963:[[122],256],119964:[[65],256],119966:[[67],256],119967:[[68],256],119970:[[71],256],119973:[[74],256],119974:[[75],256],119977:[[78],256],119978:[[79],256],119979:[[80],256],119980:[[81],256],119982:[[83],256],119983:[[84],256],119984:[[85],256],119985:[[86],256],119986:[[87],256],119987:[[88],256],119988:[[89],256],119989:[[90],256],119990:[[97],256],119991:[[98],256],119992:[[99],256],119993:[[100],256],119995:[[102],256],119997:[[104],256],119998:[[105],256],119999:[[106],256],12e4:[[107],256],120001:[[108],256],120002:[[109],256],120003:[[110],256],120005:[[112],256],120006:[[113],256],120007:[[114],256],120008:[[115],256],120009:[[116],256],120010:[[117],256],120011:[[118],256],120012:[[119],256],120013:[[120],256],120014:[[121],256],120015:[[122],256],120016:[[65],256],120017:[[66],256],120018:[[67],256],120019:[[68],256],120020:[[69],256],120021:[[70],256],120022:[[71],256],120023:[[72],256],120024:[[73],256],120025:[[74],256],120026:[[75],256],120027:[[76],256],120028:[[77],256],120029:[[78],256],120030:[[79],256],120031:[[80],256],120032:[[81],256],120033:[[82],256],120034:[[83],256],120035:[[84],256],120036:[[85],256],120037:[[86],256],120038:[[87],256],120039:[[88],256],120040:[[89],256],120041:[[90],256],120042:[[97],256],120043:[[98],256],120044:[[99],256],120045:[[100],256],120046:[[101],256],120047:[[102],256],120048:[[103],256],120049:[[104],256],120050:[[105],256],120051:[[106],256],120052:[[107],256],120053:[[108],256],120054:[[109],256],120055:[[110],256],120056:[[111],256],120057:[[112],256],120058:[[113],256],120059:[[114],256],120060:[[115],256],120061:[[116],256],120062:[[117],256],120063:[[118],256]},54528:{120064:[[119],256],120065:[[120],256],120066:[[121],256],120067:[[122],256],120068:[[65],256],120069:[[66],256],120071:[[68],256],120072:[[69],256],120073:[[70],256],120074:[[71],256],120077:[[74],256],120078:[[75],256],120079:[[76],256],120080:[[77],256],120081:[[78],256],120082:[[79],256],120083:[[80],256],120084:[[81],256],120086:[[83],256],120087:[[84],256],120088:[[85],256],120089:[[86],256],120090:[[87],256],120091:[[88],256],120092:[[89],256],120094:[[97],256],120095:[[98],256],120096:[[99],256],120097:[[100],256],120098:[[101],256],120099:[[102],256],120100:[[103],256],120101:[[104],256],120102:[[105],256],120103:[[106],256],120104:[[107],256],120105:[[108],256],120106:[[109],256],120107:[[110],256],120108:[[111],256],120109:[[112],256],120110:[[113],256],120111:[[114],256],120112:[[115],256],120113:[[116],256],120114:[[117],256],120115:[[118],256],120116:[[119],256],120117:[[120],256],120118:[[121],256],120119:[[122],256],120120:[[65],256],120121:[[66],256],120123:[[68],256],120124:[[69],256],120125:[[70],256],120126:[[71],256],120128:[[73],256],120129:[[74],256],120130:[[75],256],120131:[[76],256],120132:[[77],256],120134:[[79],256],120138:[[83],256],120139:[[84],256],120140:[[85],256],120141:[[86],256],120142:[[87],256],120143:[[88],256],120144:[[89],256],120146:[[97],256],120147:[[98],256],120148:[[99],256],120149:[[100],256],120150:[[101],256],120151:[[102],256],120152:[[103],256],120153:[[104],256],120154:[[105],256],120155:[[106],256],120156:[[107],256],120157:[[108],256],120158:[[109],256],120159:[[110],256],120160:[[111],256],120161:[[112],256],120162:[[113],256],120163:[[114],256],120164:[[115],256],120165:[[116],256],120166:[[117],256],120167:[[118],256],120168:[[119],256],120169:[[120],256],120170:[[121],256],120171:[[122],256],120172:[[65],256],120173:[[66],256],120174:[[67],256],120175:[[68],256],120176:[[69],256],120177:[[70],256],120178:[[71],256],120179:[[72],256],120180:[[73],256],120181:[[74],256],120182:[[75],256],120183:[[76],256],120184:[[77],256],120185:[[78],256],120186:[[79],256],120187:[[80],256],120188:[[81],256],120189:[[82],256],120190:[[83],256],120191:[[84],256],120192:[[85],256],120193:[[86],256],120194:[[87],256],120195:[[88],256],120196:[[89],256],120197:[[90],256],120198:[[97],256],120199:[[98],256],120200:[[99],256],120201:[[100],256],120202:[[101],256],120203:[[102],256],120204:[[103],256],120205:[[104],256],120206:[[105],256],120207:[[106],256],120208:[[107],256],120209:[[108],256],120210:[[109],256],120211:[[110],256],120212:[[111],256],120213:[[112],256],120214:[[113],256],120215:[[114],256],120216:[[115],256],120217:[[116],256],120218:[[117],256],120219:[[118],256],120220:[[119],256],120221:[[120],256],120222:[[121],256],120223:[[122],256],120224:[[65],256],120225:[[66],256],120226:[[67],256],120227:[[68],256],120228:[[69],256],120229:[[70],256],120230:[[71],256],120231:[[72],256],120232:[[73],256],120233:[[74],256],120234:[[75],256],120235:[[76],256],120236:[[77],256],120237:[[78],256],120238:[[79],256],120239:[[80],256],120240:[[81],256],120241:[[82],256],120242:[[83],256],120243:[[84],256],120244:[[85],256],120245:[[86],256],120246:[[87],256],120247:[[88],256],120248:[[89],256],120249:[[90],256],120250:[[97],256],120251:[[98],256],120252:[[99],256],120253:[[100],256],120254:[[101],256],120255:[[102],256],120256:[[103],256],120257:[[104],256],120258:[[105],256],120259:[[106],256],120260:[[107],256],120261:[[108],256],120262:[[109],256],120263:[[110],256],120264:[[111],256],120265:[[112],256],120266:[[113],256],120267:[[114],256],120268:[[115],256],120269:[[116],256],120270:[[117],256],120271:[[118],256],120272:[[119],256],120273:[[120],256],120274:[[121],256],120275:[[122],256],120276:[[65],256],120277:[[66],256],120278:[[67],256],120279:[[68],256],120280:[[69],256],120281:[[70],256],120282:[[71],256],120283:[[72],256],120284:[[73],256],120285:[[74],256],120286:[[75],256],120287:[[76],256],120288:[[77],256],120289:[[78],256],120290:[[79],256],120291:[[80],256],120292:[[81],256],120293:[[82],256],120294:[[83],256],120295:[[84],256],120296:[[85],256],120297:[[86],256],120298:[[87],256],120299:[[88],256],120300:[[89],256],120301:[[90],256],120302:[[97],256],120303:[[98],256],120304:[[99],256],120305:[[100],256],120306:[[101],256],120307:[[102],256],120308:[[103],256],120309:[[104],256],120310:[[105],256],120311:[[106],256],120312:[[107],256],120313:[[108],256],120314:[[109],256],120315:[[110],256],120316:[[111],256],120317:[[112],256],120318:[[113],256],120319:[[114],256]},54784:{120320:[[115],256],120321:[[116],256],120322:[[117],256],120323:[[118],256],120324:[[119],256],120325:[[120],256],120326:[[121],256],120327:[[122],256],120328:[[65],256],120329:[[66],256],120330:[[67],256],120331:[[68],256],120332:[[69],256],120333:[[70],256],120334:[[71],256],120335:[[72],256],120336:[[73],256],120337:[[74],256],120338:[[75],256],120339:[[76],256],120340:[[77],256],120341:[[78],256],120342:[[79],256],120343:[[80],256],120344:[[81],256],120345:[[82],256],120346:[[83],256],120347:[[84],256],120348:[[85],256],120349:[[86],256],120350:[[87],256],120351:[[88],256],120352:[[89],256],120353:[[90],256],120354:[[97],256],120355:[[98],256],120356:[[99],256],120357:[[100],256],120358:[[101],256],120359:[[102],256],120360:[[103],256],120361:[[104],256],120362:[[105],256],120363:[[106],256],120364:[[107],256],120365:[[108],256],120366:[[109],256],120367:[[110],256],120368:[[111],256],120369:[[112],256],120370:[[113],256],120371:[[114],256],120372:[[115],256],120373:[[116],256],120374:[[117],256],120375:[[118],256],120376:[[119],256],120377:[[120],256],120378:[[121],256],120379:[[122],256],120380:[[65],256],120381:[[66],256],120382:[[67],256],120383:[[68],256],120384:[[69],256],120385:[[70],256],120386:[[71],256],120387:[[72],256],120388:[[73],256],120389:[[74],256],120390:[[75],256],120391:[[76],256],120392:[[77],256],120393:[[78],256],120394:[[79],256],120395:[[80],256],120396:[[81],256],120397:[[82],256],120398:[[83],256],120399:[[84],256],120400:[[85],256],120401:[[86],256],120402:[[87],256],120403:[[88],256],120404:[[89],256],120405:[[90],256],120406:[[97],256],120407:[[98],256],120408:[[99],256],120409:[[100],256],120410:[[101],256],120411:[[102],256],120412:[[103],256],120413:[[104],256],120414:[[105],256],120415:[[106],256],120416:[[107],256],120417:[[108],256],120418:[[109],256],120419:[[110],256],120420:[[111],256],120421:[[112],256],120422:[[113],256],120423:[[114],256],120424:[[115],256],120425:[[116],256],120426:[[117],256],120427:[[118],256],120428:[[119],256],120429:[[120],256],120430:[[121],256],120431:[[122],256],120432:[[65],256],120433:[[66],256],120434:[[67],256],120435:[[68],256],120436:[[69],256],120437:[[70],256],120438:[[71],256],120439:[[72],256],120440:[[73],256],120441:[[74],256],120442:[[75],256],120443:[[76],256],120444:[[77],256],120445:[[78],256],120446:[[79],256],120447:[[80],256],120448:[[81],256],120449:[[82],256],120450:[[83],256],120451:[[84],256],120452:[[85],256],120453:[[86],256],120454:[[87],256],120455:[[88],256],120456:[[89],256],120457:[[90],256],120458:[[97],256],120459:[[98],256],120460:[[99],256],120461:[[100],256],120462:[[101],256],120463:[[102],256],120464:[[103],256],120465:[[104],256],120466:[[105],256],120467:[[106],256],120468:[[107],256],120469:[[108],256],120470:[[109],256],120471:[[110],256],120472:[[111],256],120473:[[112],256],120474:[[113],256],120475:[[114],256],120476:[[115],256],120477:[[116],256],120478:[[117],256],120479:[[118],256],120480:[[119],256],120481:[[120],256],120482:[[121],256],120483:[[122],256],120484:[[305],256],120485:[[567],256],120488:[[913],256],120489:[[914],256],120490:[[915],256],120491:[[916],256],120492:[[917],256],120493:[[918],256],120494:[[919],256],120495:[[920],256],120496:[[921],256],120497:[[922],256],120498:[[923],256],120499:[[924],256],120500:[[925],256],120501:[[926],256],120502:[[927],256],120503:[[928],256],120504:[[929],256],120505:[[1012],256],120506:[[931],256],120507:[[932],256],120508:[[933],256],120509:[[934],256],120510:[[935],256],120511:[[936],256],120512:[[937],256],120513:[[8711],256],120514:[[945],256],120515:[[946],256],120516:[[947],256],120517:[[948],256],120518:[[949],256],120519:[[950],256],120520:[[951],256],120521:[[952],256],120522:[[953],256],120523:[[954],256],120524:[[955],256],120525:[[956],256],120526:[[957],256],120527:[[958],256],120528:[[959],256],120529:[[960],256],120530:[[961],256],120531:[[962],256],120532:[[963],256],120533:[[964],256],120534:[[965],256],120535:[[966],256],120536:[[967],256],120537:[[968],256],120538:[[969],256],120539:[[8706],256],120540:[[1013],256],120541:[[977],256],120542:[[1008],256],120543:[[981],256],120544:[[1009],256],120545:[[982],256],120546:[[913],256],120547:[[914],256],120548:[[915],256],120549:[[916],256],120550:[[917],256],120551:[[918],256],120552:[[919],256],120553:[[920],256],120554:[[921],256],120555:[[922],256],120556:[[923],256],120557:[[924],256],120558:[[925],256],120559:[[926],256],120560:[[927],256],120561:[[928],256],120562:[[929],256],120563:[[1012],256],120564:[[931],256],120565:[[932],256],120566:[[933],256],120567:[[934],256],120568:[[935],256],120569:[[936],256],120570:[[937],256],120571:[[8711],256],120572:[[945],256],120573:[[946],256],120574:[[947],256],120575:[[948],256]},55040:{120576:[[949],256],120577:[[950],256],120578:[[951],256],120579:[[952],256],120580:[[953],256],120581:[[954],256],120582:[[955],256],120583:[[956],256],120584:[[957],256],120585:[[958],256],120586:[[959],256],120587:[[960],256],120588:[[961],256],120589:[[962],256],120590:[[963],256],120591:[[964],256],120592:[[965],256],120593:[[966],256],120594:[[967],256],120595:[[968],256],120596:[[969],256],120597:[[8706],256],120598:[[1013],256],120599:[[977],256],120600:[[1008],256],120601:[[981],256],120602:[[1009],256],120603:[[982],256],120604:[[913],256],120605:[[914],256],120606:[[915],256],120607:[[916],256],120608:[[917],256],120609:[[918],256],120610:[[919],256],120611:[[920],256],120612:[[921],256],120613:[[922],256],120614:[[923],256],120615:[[924],256],120616:[[925],256],120617:[[926],256],120618:[[927],256],120619:[[928],256],120620:[[929],256],120621:[[1012],256],120622:[[931],256],120623:[[932],256],120624:[[933],256],120625:[[934],256],120626:[[935],256],120627:[[936],256],120628:[[937],256],120629:[[8711],256],120630:[[945],256],120631:[[946],256],120632:[[947],256],120633:[[948],256],120634:[[949],256],120635:[[950],256],120636:[[951],256],120637:[[952],256],120638:[[953],256],120639:[[954],256],120640:[[955],256],120641:[[956],256],120642:[[957],256],120643:[[958],256],120644:[[959],256],120645:[[960],256],120646:[[961],256],120647:[[962],256],120648:[[963],256],120649:[[964],256],120650:[[965],256],120651:[[966],256],120652:[[967],256],120653:[[968],256],120654:[[969],256],120655:[[8706],256],120656:[[1013],256],120657:[[977],256],120658:[[1008],256],120659:[[981],256],120660:[[1009],256],120661:[[982],256],120662:[[913],256],120663:[[914],256],120664:[[915],256],120665:[[916],256],120666:[[917],256],120667:[[918],256],120668:[[919],256],120669:[[920],256],120670:[[921],256],120671:[[922],256],120672:[[923],256],120673:[[924],256],120674:[[925],256],120675:[[926],256],120676:[[927],256],120677:[[928],256],120678:[[929],256],120679:[[1012],256],120680:[[931],256],120681:[[932],256],120682:[[933],256],120683:[[934],256],120684:[[935],256],120685:[[936],256],120686:[[937],256],120687:[[8711],256],120688:[[945],256],120689:[[946],256],120690:[[947],256],120691:[[948],256],120692:[[949],256],120693:[[950],256],120694:[[951],256],120695:[[952],256],120696:[[953],256],120697:[[954],256],120698:[[955],256],120699:[[956],256],120700:[[957],256],120701:[[958],256],120702:[[959],256],120703:[[960],256],120704:[[961],256],120705:[[962],256],120706:[[963],256],120707:[[964],256],120708:[[965],256],120709:[[966],256],120710:[[967],256],120711:[[968],256],120712:[[969],256],120713:[[8706],256],120714:[[1013],256],120715:[[977],256],120716:[[1008],256],120717:[[981],256],120718:[[1009],256],120719:[[982],256],120720:[[913],256],120721:[[914],256],120722:[[915],256],120723:[[916],256],120724:[[917],256],120725:[[918],256],120726:[[919],256],120727:[[920],256],120728:[[921],256],120729:[[922],256],120730:[[923],256],120731:[[924],256],120732:[[925],256],120733:[[926],256],120734:[[927],256],120735:[[928],256],120736:[[929],256],120737:[[1012],256],120738:[[931],256],120739:[[932],256],120740:[[933],256],120741:[[934],256],120742:[[935],256],120743:[[936],256],120744:[[937],256],120745:[[8711],256],120746:[[945],256],120747:[[946],256],120748:[[947],256],120749:[[948],256],120750:[[949],256],120751:[[950],256],120752:[[951],256],120753:[[952],256],120754:[[953],256],120755:[[954],256],120756:[[955],256],120757:[[956],256],120758:[[957],256],120759:[[958],256],120760:[[959],256],120761:[[960],256],120762:[[961],256],120763:[[962],256],120764:[[963],256],120765:[[964],256],120766:[[965],256],120767:[[966],256],120768:[[967],256],120769:[[968],256],120770:[[969],256],120771:[[8706],256],120772:[[1013],256],120773:[[977],256],120774:[[1008],256],120775:[[981],256],120776:[[1009],256],120777:[[982],256],120778:[[988],256],120779:[[989],256],120782:[[48],256],120783:[[49],256],120784:[[50],256],120785:[[51],256],120786:[[52],256],120787:[[53],256],120788:[[54],256],120789:[[55],256],120790:[[56],256],120791:[[57],256],120792:[[48],256],120793:[[49],256],120794:[[50],256],120795:[[51],256],120796:[[52],256],120797:[[53],256],120798:[[54],256],120799:[[55],256],120800:[[56],256],120801:[[57],256],120802:[[48],256],120803:[[49],256],120804:[[50],256],120805:[[51],256],120806:[[52],256],120807:[[53],256],120808:[[54],256],120809:[[55],256],120810:[[56],256],120811:[[57],256],120812:[[48],256],120813:[[49],256],120814:[[50],256],120815:[[51],256],120816:[[52],256],120817:[[53],256],120818:[[54],256],120819:[[55],256],120820:[[56],256],120821:[[57],256],120822:[[48],256],120823:[[49],256],120824:[[50],256],120825:[[51],256],120826:[[52],256],120827:[[53],256],120828:[[54],256],120829:[[55],256],120830:[[56],256],120831:[[57],256]},59392:{125136:[,220],125137:[,220],125138:[,220],125139:[,220],125140:[,220],125141:[,220],125142:[,220]},60928:{126464:[[1575],256],126465:[[1576],256],126466:[[1580],256],126467:[[1583],256],126469:[[1608],256],126470:[[1586],256],126471:[[1581],256],126472:[[1591],256],126473:[[1610],256],126474:[[1603],256],126475:[[1604],256],126476:[[1605],256],126477:[[1606],256],126478:[[1587],256],126479:[[1593],256],126480:[[1601],256],126481:[[1589],256],126482:[[1602],256],126483:[[1585],256],126484:[[1588],256],126485:[[1578],256],126486:[[1579],256],126487:[[1582],256],126488:[[1584],256],126489:[[1590],256],126490:[[1592],256],126491:[[1594],256],126492:[[1646],256],126493:[[1722],256],126494:[[1697],256],126495:[[1647],256],126497:[[1576],256],126498:[[1580],256],126500:[[1607],256],126503:[[1581],256],126505:[[1610],256],126506:[[1603],256],126507:[[1604],256],126508:[[1605],256],126509:[[1606],256],126510:[[1587],256],126511:[[1593],256],126512:[[1601],256],126513:[[1589],256],126514:[[1602],256],126516:[[1588],256],126517:[[1578],256],126518:[[1579],256],126519:[[1582],256],126521:[[1590],256],126523:[[1594],256],126530:[[1580],256],126535:[[1581],256],126537:[[1610],256],126539:[[1604],256],126541:[[1606],256],126542:[[1587],256],126543:[[1593],256],126545:[[1589],256],126546:[[1602],256],126548:[[1588],256],126551:[[1582],256],126553:[[1590],256],126555:[[1594],256],126557:[[1722],256],126559:[[1647],256],126561:[[1576],256],126562:[[1580],256],126564:[[1607],256],126567:[[1581],256],126568:[[1591],256],126569:[[1610],256],126570:[[1603],256],126572:[[1605],256],126573:[[1606],256],126574:[[1587],256],126575:[[1593],256],126576:[[1601],256],126577:[[1589],256],126578:[[1602],256],126580:[[1588],256],126581:[[1578],256],126582:[[1579],256],126583:[[1582],256],126585:[[1590],256],126586:[[1592],256],126587:[[1594],256],126588:[[1646],256],126590:[[1697],256],126592:[[1575],256],126593:[[1576],256],126594:[[1580],256],126595:[[1583],256],126596:[[1607],256],126597:[[1608],256],126598:[[1586],256],126599:[[1581],256],126600:[[1591],256],126601:[[1610],256],126603:[[1604],256],126604:[[1605],256],126605:[[1606],256],126606:[[1587],256],126607:[[1593],256],126608:[[1601],256],126609:[[1589],256],126610:[[1602],256],126611:[[1585],256],126612:[[1588],256],126613:[[1578],256],126614:[[1579],256],126615:[[1582],256],126616:[[1584],256],126617:[[1590],256],126618:[[1592],256],126619:[[1594],256],126625:[[1576],256],126626:[[1580],256],126627:[[1583],256],126629:[[1608],256],126630:[[1586],256],126631:[[1581],256],126632:[[1591],256],126633:[[1610],256],126635:[[1604],256],126636:[[1605],256],126637:[[1606],256],126638:[[1587],256],126639:[[1593],256],126640:[[1601],256],126641:[[1589],256],126642:[[1602],256],126643:[[1585],256],126644:[[1588],256],126645:[[1578],256],126646:[[1579],256],126647:[[1582],256],126648:[[1584],256],126649:[[1590],256],126650:[[1592],256],126651:[[1594],256]},61696:{127232:[[48,46],256],127233:[[48,44],256],127234:[[49,44],256],127235:[[50,44],256],127236:[[51,44],256],127237:[[52,44],256],127238:[[53,44],256],127239:[[54,44],256],127240:[[55,44],256],127241:[[56,44],256],127242:[[57,44],256],127248:[[40,65,41],256],127249:[[40,66,41],256],127250:[[40,67,41],256],127251:[[40,68,41],256],127252:[[40,69,41],256],127253:[[40,70,41],256],127254:[[40,71,41],256],127255:[[40,72,41],256],127256:[[40,73,41],256],127257:[[40,74,41],256],127258:[[40,75,41],256],127259:[[40,76,41],256],127260:[[40,77,41],256],127261:[[40,78,41],256],127262:[[40,79,41],256],127263:[[40,80,41],256],127264:[[40,81,41],256],127265:[[40,82,41],256],127266:[[40,83,41],256],127267:[[40,84,41],256],127268:[[40,85,41],256],127269:[[40,86,41],256],127270:[[40,87,41],256],127271:[[40,88,41],256],127272:[[40,89,41],256],127273:[[40,90,41],256],127274:[[12308,83,12309],256],127275:[[67],256],127276:[[82],256],127277:[[67,68],256],127278:[[87,90],256],127280:[[65],256],127281:[[66],256],127282:[[67],256],127283:[[68],256],127284:[[69],256],127285:[[70],256],127286:[[71],256],127287:[[72],256],127288:[[73],256],127289:[[74],256],127290:[[75],256],127291:[[76],256],127292:[[77],256],127293:[[78],256],127294:[[79],256],127295:[[80],256],127296:[[81],256],127297:[[82],256],127298:[[83],256],127299:[[84],256],127300:[[85],256],127301:[[86],256],127302:[[87],256],127303:[[88],256],127304:[[89],256],127305:[[90],256],127306:[[72,86],256],127307:[[77,86],256],127308:[[83,68],256],127309:[[83,83],256],127310:[[80,80,86],256],127311:[[87,67],256],127338:[[77,67],256],127339:[[77,68],256],127376:[[68,74],256]},61952:{127488:[[12411,12363],256],127489:[[12467,12467],256],127490:[[12469],256],127504:[[25163],256],127505:[[23383],256],127506:[[21452],256],127507:[[12487],256],127508:[[20108],256],127509:[[22810],256],127510:[[35299],256],127511:[[22825],256],127512:[[20132],256],127513:[[26144],256],127514:[[28961],256],127515:[[26009],256],127516:[[21069],256],127517:[[24460],256],127518:[[20877],256],127519:[[26032],256],127520:[[21021],256],127521:[[32066],256],127522:[[29983],256],127523:[[36009],256],127524:[[22768],256],127525:[[21561],256],127526:[[28436],256],127527:[[25237],256],127528:[[25429],256],127529:[[19968],256],127530:[[19977],256],127531:[[36938],256],127532:[[24038],256],127533:[[20013],256],127534:[[21491],256],127535:[[25351],256],127536:[[36208],256],127537:[[25171],256],127538:[[31105],256],127539:[[31354],256],127540:[[21512],256],127541:[[28288],256],127542:[[26377],256],127543:[[26376],256],127544:[[30003],256],127545:[[21106],256],127546:[[21942],256],127552:[[12308,26412,12309],256],127553:[[12308,19977,12309],256],127554:[[12308,20108,12309],256],127555:[[12308,23433,12309],256],127556:[[12308,28857,12309],256],127557:[[12308,25171,12309],256],127558:[[12308,30423,12309],256],127559:[[12308,21213,12309],256],127560:[[12308,25943,12309],256],127568:[[24471],256],127569:[[21487],256]},63488:{194560:[[20029]],194561:[[20024]],194562:[[20033]],194563:[[131362]],194564:[[20320]],194565:[[20398]],194566:[[20411]],194567:[[20482]],194568:[[20602]],194569:[[20633]],194570:[[20711]],194571:[[20687]],194572:[[13470]],194573:[[132666]],194574:[[20813]],194575:[[20820]],194576:[[20836]],194577:[[20855]],194578:[[132380]],194579:[[13497]],194580:[[20839]],194581:[[20877]],194582:[[132427]],194583:[[20887]],194584:[[20900]],194585:[[20172]],194586:[[20908]],194587:[[20917]],194588:[[168415]],194589:[[20981]],194590:[[20995]],194591:[[13535]],194592:[[21051]],194593:[[21062]],194594:[[21106]],194595:[[21111]],194596:[[13589]],194597:[[21191]],194598:[[21193]],194599:[[21220]],194600:[[21242]],194601:[[21253]],194602:[[21254]],194603:[[21271]],194604:[[21321]],194605:[[21329]],194606:[[21338]],194607:[[21363]],194608:[[21373]],194609:[[21375]],194610:[[21375]],194611:[[21375]],194612:[[133676]],194613:[[28784]],194614:[[21450]],194615:[[21471]],194616:[[133987]],194617:[[21483]],194618:[[21489]],194619:[[21510]],194620:[[21662]],194621:[[21560]],194622:[[21576]],194623:[[21608]],194624:[[21666]],194625:[[21750]],194626:[[21776]],194627:[[21843]],194628:[[21859]],194629:[[21892]],194630:[[21892]],194631:[[21913]],194632:[[21931]],194633:[[21939]],194634:[[21954]],194635:[[22294]],194636:[[22022]],194637:[[22295]],194638:[[22097]],194639:[[22132]],194640:[[20999]],194641:[[22766]],194642:[[22478]],194643:[[22516]],194644:[[22541]],194645:[[22411]],194646:[[22578]],194647:[[22577]],194648:[[22700]],194649:[[136420]],194650:[[22770]],194651:[[22775]],194652:[[22790]],194653:[[22810]],194654:[[22818]],194655:[[22882]],194656:[[136872]],194657:[[136938]],194658:[[23020]],194659:[[23067]],194660:[[23079]],194661:[[23e3]],194662:[[23142]],194663:[[14062]],194664:[[14076]],194665:[[23304]],194666:[[23358]],194667:[[23358]],194668:[[137672]],194669:[[23491]],194670:[[23512]],194671:[[23527]],194672:[[23539]],194673:[[138008]],194674:[[23551]],194675:[[23558]],194676:[[24403]],194677:[[23586]],194678:[[14209]],194679:[[23648]],194680:[[23662]],194681:[[23744]],194682:[[23693]],194683:[[138724]],194684:[[23875]],194685:[[138726]],194686:[[23918]],194687:[[23915]],194688:[[23932]],194689:[[24033]],194690:[[24034]],194691:[[14383]],194692:[[24061]],194693:[[24104]],194694:[[24125]],194695:[[24169]],194696:[[14434]],194697:[[139651]],194698:[[14460]],194699:[[24240]],194700:[[24243]],194701:[[24246]],194702:[[24266]],194703:[[172946]],194704:[[24318]],194705:[[140081]],194706:[[140081]],194707:[[33281]],194708:[[24354]],194709:[[24354]],194710:[[14535]],194711:[[144056]],194712:[[156122]],194713:[[24418]],194714:[[24427]],194715:[[14563]],194716:[[24474]],194717:[[24525]],194718:[[24535]],194719:[[24569]],194720:[[24705]],194721:[[14650]],194722:[[14620]],194723:[[24724]],194724:[[141012]],194725:[[24775]],194726:[[24904]],194727:[[24908]],194728:[[24910]],194729:[[24908]],194730:[[24954]],194731:[[24974]],194732:[[25010]],194733:[[24996]],194734:[[25007]],194735:[[25054]],194736:[[25074]],194737:[[25078]],194738:[[25104]],194739:[[25115]],194740:[[25181]],194741:[[25265]],194742:[[25300]],194743:[[25424]],194744:[[142092]],194745:[[25405]],194746:[[25340]],194747:[[25448]],194748:[[25475]],194749:[[25572]],194750:[[142321]],194751:[[25634]],194752:[[25541]],194753:[[25513]],194754:[[14894]],194755:[[25705]],194756:[[25726]],194757:[[25757]],194758:[[25719]],194759:[[14956]],194760:[[25935]],194761:[[25964]],194762:[[143370]],194763:[[26083]],194764:[[26360]],194765:[[26185]],194766:[[15129]],194767:[[26257]],194768:[[15112]],194769:[[15076]],194770:[[20882]],194771:[[20885]],194772:[[26368]],194773:[[26268]],194774:[[32941]],194775:[[17369]],194776:[[26391]],194777:[[26395]],194778:[[26401]],194779:[[26462]],194780:[[26451]],194781:[[144323]],194782:[[15177]],194783:[[26618]],194784:[[26501]],194785:[[26706]],194786:[[26757]],194787:[[144493]],194788:[[26766]],194789:[[26655]],194790:[[26900]],194791:[[15261]],194792:[[26946]],194793:[[27043]],194794:[[27114]],194795:[[27304]],194796:[[145059]],194797:[[27355]],194798:[[15384]],194799:[[27425]],194800:[[145575]],194801:[[27476]],194802:[[15438]],194803:[[27506]],194804:[[27551]],194805:[[27578]],194806:[[27579]],194807:[[146061]],194808:[[138507]],194809:[[146170]],194810:[[27726]],194811:[[146620]],194812:[[27839]],194813:[[27853]],194814:[[27751]],194815:[[27926]]},63744:{63744:[[35912]],63745:[[26356]],63746:[[36554]],63747:[[36040]],63748:[[28369]],63749:[[20018]],63750:[[21477]],63751:[[40860]],63752:[[40860]],63753:[[22865]],63754:[[37329]],63755:[[21895]],63756:[[22856]],63757:[[25078]],63758:[[30313]],63759:[[32645]],63760:[[34367]],63761:[[34746]],63762:[[35064]],63763:[[37007]],63764:[[27138]],63765:[[27931]],63766:[[28889]],63767:[[29662]],63768:[[33853]],63769:[[37226]],63770:[[39409]],63771:[[20098]],63772:[[21365]],63773:[[27396]],63774:[[29211]],63775:[[34349]],63776:[[40478]],63777:[[23888]],63778:[[28651]],63779:[[34253]],63780:[[35172]],63781:[[25289]],63782:[[33240]],63783:[[34847]],63784:[[24266]],63785:[[26391]],63786:[[28010]],63787:[[29436]],63788:[[37070]],63789:[[20358]],63790:[[20919]],63791:[[21214]],63792:[[25796]],63793:[[27347]],63794:[[29200]],63795:[[30439]],63796:[[32769]],63797:[[34310]],63798:[[34396]],63799:[[36335]],63800:[[38706]],63801:[[39791]],63802:[[40442]],63803:[[30860]],63804:[[31103]],63805:[[32160]],63806:[[33737]],63807:[[37636]],63808:[[40575]],63809:[[35542]],63810:[[22751]],63811:[[24324]],63812:[[31840]],63813:[[32894]],63814:[[29282]],63815:[[30922]],63816:[[36034]],63817:[[38647]],63818:[[22744]],63819:[[23650]],63820:[[27155]],63821:[[28122]],63822:[[28431]],63823:[[32047]],63824:[[32311]],63825:[[38475]],63826:[[21202]],63827:[[32907]],63828:[[20956]],63829:[[20940]],63830:[[31260]],63831:[[32190]],63832:[[33777]],63833:[[38517]],63834:[[35712]],63835:[[25295]],63836:[[27138]],63837:[[35582]],63838:[[20025]],63839:[[23527]],63840:[[24594]],63841:[[29575]],63842:[[30064]],63843:[[21271]],63844:[[30971]],63845:[[20415]],63846:[[24489]],63847:[[19981]],63848:[[27852]],63849:[[25976]],63850:[[32034]],63851:[[21443]],63852:[[22622]],63853:[[30465]],63854:[[33865]],63855:[[35498]],63856:[[27578]],63857:[[36784]],63858:[[27784]],63859:[[25342]],63860:[[33509]],63861:[[25504]],63862:[[30053]],63863:[[20142]],63864:[[20841]],63865:[[20937]],63866:[[26753]],63867:[[31975]],63868:[[33391]],63869:[[35538]],63870:[[37327]],63871:[[21237]],63872:[[21570]],63873:[[22899]],63874:[[24300]],63875:[[26053]],63876:[[28670]],63877:[[31018]],63878:[[38317]],63879:[[39530]],63880:[[40599]],63881:[[40654]],63882:[[21147]],63883:[[26310]],63884:[[27511]],63885:[[36706]],63886:[[24180]],63887:[[24976]],63888:[[25088]],63889:[[25754]],63890:[[28451]],63891:[[29001]],63892:[[29833]],63893:[[31178]],63894:[[32244]],63895:[[32879]],63896:[[36646]],63897:[[34030]],63898:[[36899]],63899:[[37706]],63900:[[21015]],63901:[[21155]],63902:[[21693]],63903:[[28872]],63904:[[35010]],63905:[[35498]],63906:[[24265]],63907:[[24565]],63908:[[25467]],63909:[[27566]],63910:[[31806]],63911:[[29557]],63912:[[20196]],63913:[[22265]],63914:[[23527]],63915:[[23994]],63916:[[24604]],63917:[[29618]],63918:[[29801]],63919:[[32666]],63920:[[32838]],63921:[[37428]],63922:[[38646]],63923:[[38728]],63924:[[38936]],63925:[[20363]],63926:[[31150]],63927:[[37300]],63928:[[38584]],63929:[[24801]],63930:[[20102]],63931:[[20698]],63932:[[23534]],63933:[[23615]],63934:[[26009]],63935:[[27138]],63936:[[29134]],63937:[[30274]],63938:[[34044]],63939:[[36988]],63940:[[40845]],63941:[[26248]],63942:[[38446]],63943:[[21129]],63944:[[26491]],63945:[[26611]],63946:[[27969]],63947:[[28316]],63948:[[29705]],63949:[[30041]],63950:[[30827]],63951:[[32016]],63952:[[39006]],63953:[[20845]],63954:[[25134]],63955:[[38520]],63956:[[20523]],63957:[[23833]],63958:[[28138]],63959:[[36650]],63960:[[24459]],63961:[[24900]],63962:[[26647]],63963:[[29575]],63964:[[38534]],63965:[[21033]],63966:[[21519]],63967:[[23653]],63968:[[26131]],63969:[[26446]],63970:[[26792]],63971:[[27877]],63972:[[29702]],63973:[[30178]],63974:[[32633]],63975:[[35023]],63976:[[35041]],63977:[[37324]],63978:[[38626]],63979:[[21311]],63980:[[28346]],63981:[[21533]],63982:[[29136]],63983:[[29848]],63984:[[34298]],63985:[[38563]],63986:[[40023]],63987:[[40607]],63988:[[26519]],63989:[[28107]],63990:[[33256]],63991:[[31435]],63992:[[31520]],63993:[[31890]],63994:[[29376]],63995:[[28825]],63996:[[35672]],63997:[[20160]],63998:[[33590]],63999:[[21050]],194816:[[27966]],194817:[[28023]],194818:[[27969]],194819:[[28009]],194820:[[28024]],194821:[[28037]],194822:[[146718]],194823:[[27956]],194824:[[28207]],194825:[[28270]],194826:[[15667]],194827:[[28363]],194828:[[28359]],194829:[[147153]],194830:[[28153]],194831:[[28526]],194832:[[147294]],194833:[[147342]],194834:[[28614]],194835:[[28729]],194836:[[28702]],194837:[[28699]],194838:[[15766]],194839:[[28746]],194840:[[28797]],194841:[[28791]],194842:[[28845]],194843:[[132389]],194844:[[28997]],194845:[[148067]],194846:[[29084]],194847:[[148395]],194848:[[29224]],194849:[[29237]],194850:[[29264]],194851:[[149e3]],194852:[[29312]],194853:[[29333]],194854:[[149301]],194855:[[149524]],194856:[[29562]],194857:[[29579]],194858:[[16044]],194859:[[29605]],194860:[[16056]],194861:[[16056]],194862:[[29767]],194863:[[29788]],194864:[[29809]],194865:[[29829]],194866:[[29898]],194867:[[16155]],194868:[[29988]],194869:[[150582]],194870:[[30014]],194871:[[150674]],194872:[[30064]],194873:[[139679]],194874:[[30224]],194875:[[151457]],194876:[[151480]],194877:[[151620]],194878:[[16380]],194879:[[16392]],194880:[[30452]],194881:[[151795]],194882:[[151794]],194883:[[151833]],194884:[[151859]],194885:[[30494]],194886:[[30495]],194887:[[30495]],194888:[[30538]],194889:[[16441]],194890:[[30603]],194891:[[16454]],194892:[[16534]],194893:[[152605]],194894:[[30798]],194895:[[30860]],194896:[[30924]],194897:[[16611]],194898:[[153126]],194899:[[31062]],194900:[[153242]],194901:[[153285]],194902:[[31119]],194903:[[31211]],194904:[[16687]],194905:[[31296]],194906:[[31306]],194907:[[31311]],194908:[[153980]],194909:[[154279]],194910:[[154279]],194911:[[31470]],194912:[[16898]],194913:[[154539]],194914:[[31686]],194915:[[31689]],194916:[[16935]],194917:[[154752]],194918:[[31954]],194919:[[17056]],194920:[[31976]],194921:[[31971]],194922:[[32e3]],194923:[[155526]],194924:[[32099]],194925:[[17153]],194926:[[32199]],194927:[[32258]],194928:[[32325]],194929:[[17204]],194930:[[156200]],194931:[[156231]],194932:[[17241]],194933:[[156377]],194934:[[32634]],194935:[[156478]],194936:[[32661]],194937:[[32762]],194938:[[32773]],194939:[[156890]],194940:[[156963]],194941:[[32864]],194942:[[157096]],194943:[[32880]],194944:[[144223]],194945:[[17365]],194946:[[32946]],194947:[[33027]],194948:[[17419]],194949:[[33086]],194950:[[23221]],194951:[[157607]],194952:[[157621]],194953:[[144275]],194954:[[144284]],194955:[[33281]],194956:[[33284]],194957:[[36766]],194958:[[17515]],194959:[[33425]],194960:[[33419]],194961:[[33437]],194962:[[21171]],194963:[[33457]],194964:[[33459]],194965:[[33469]],194966:[[33510]],194967:[[158524]],194968:[[33509]],194969:[[33565]],194970:[[33635]],194971:[[33709]],194972:[[33571]],194973:[[33725]],194974:[[33767]],194975:[[33879]],194976:[[33619]],194977:[[33738]],194978:[[33740]],194979:[[33756]],194980:[[158774]],194981:[[159083]],194982:[[158933]],194983:[[17707]],194984:[[34033]],194985:[[34035]],194986:[[34070]],194987:[[160714]],194988:[[34148]],194989:[[159532]],194990:[[17757]],194991:[[17761]],194992:[[159665]],194993:[[159954]],194994:[[17771]],194995:[[34384]],194996:[[34396]],194997:[[34407]],194998:[[34409]],194999:[[34473]],195e3:[[34440]],195001:[[34574]],195002:[[34530]],195003:[[34681]],195004:[[34600]],195005:[[34667]],195006:[[34694]],195007:[[17879]],195008:[[34785]],195009:[[34817]],195010:[[17913]],195011:[[34912]],195012:[[34915]],195013:[[161383]],195014:[[35031]],195015:[[35038]],195016:[[17973]],195017:[[35066]],195018:[[13499]],195019:[[161966]],195020:[[162150]],195021:[[18110]],195022:[[18119]],195023:[[35488]],195024:[[35565]],195025:[[35722]],195026:[[35925]],195027:[[162984]],195028:[[36011]],195029:[[36033]],195030:[[36123]],195031:[[36215]],195032:[[163631]],195033:[[133124]],195034:[[36299]],195035:[[36284]],195036:[[36336]],195037:[[133342]],195038:[[36564]],195039:[[36664]],195040:[[165330]],195041:[[165357]],195042:[[37012]],195043:[[37105]],195044:[[37137]],195045:[[165678]],195046:[[37147]],195047:[[37432]],195048:[[37591]],195049:[[37592]],195050:[[37500]],195051:[[37881]],195052:[[37909]],195053:[[166906]],195054:[[38283]],195055:[[18837]],195056:[[38327]],195057:[[167287]],195058:[[18918]],195059:[[38595]],195060:[[23986]],195061:[[38691]],195062:[[168261]],195063:[[168474]],195064:[[19054]],195065:[[19062]],195066:[[38880]],195067:[[168970]],195068:[[19122]],195069:[[169110]],195070:[[38923]],195071:[[38923]]},64e3:{64e3:[[20999]],64001:[[24230]],64002:[[25299]],64003:[[31958]],64004:[[23429]],64005:[[27934]],64006:[[26292]],64007:[[36667]],64008:[[34892]],64009:[[38477]],64010:[[35211]],64011:[[24275]],64012:[[20800]],64013:[[21952]],64016:[[22618]],64018:[[26228]],64021:[[20958]],64022:[[29482]],64023:[[30410]],64024:[[31036]],64025:[[31070]],64026:[[31077]],64027:[[31119]],64028:[[38742]],64029:[[31934]],64030:[[32701]],64032:[[34322]],64034:[[35576]],64037:[[36920]],64038:[[37117]],64042:[[39151]],64043:[[39164]],64044:[[39208]],64045:[[40372]],64046:[[37086]],64047:[[38583]],64048:[[20398]],64049:[[20711]],64050:[[20813]],64051:[[21193]],64052:[[21220]],64053:[[21329]],64054:[[21917]],64055:[[22022]],64056:[[22120]],64057:[[22592]],64058:[[22696]],64059:[[23652]],64060:[[23662]],64061:[[24724]],64062:[[24936]],64063:[[24974]],64064:[[25074]],64065:[[25935]],64066:[[26082]],64067:[[26257]],64068:[[26757]],64069:[[28023]],64070:[[28186]],64071:[[28450]],64072:[[29038]],64073:[[29227]],64074:[[29730]],64075:[[30865]],64076:[[31038]],64077:[[31049]],64078:[[31048]],64079:[[31056]],64080:[[31062]],64081:[[31069]],64082:[[31117]],64083:[[31118]],64084:[[31296]],64085:[[31361]],64086:[[31680]],64087:[[32244]],64088:[[32265]],64089:[[32321]],64090:[[32626]],64091:[[32773]],64092:[[33261]],64093:[[33401]],64094:[[33401]],64095:[[33879]],64096:[[35088]],64097:[[35222]],64098:[[35585]],64099:[[35641]],64100:[[36051]],64101:[[36104]],64102:[[36790]],64103:[[36920]],64104:[[38627]],64105:[[38911]],64106:[[38971]],64107:[[24693]],64108:[[148206]],64109:[[33304]],64112:[[20006]],64113:[[20917]],64114:[[20840]],64115:[[20352]],64116:[[20805]],64117:[[20864]],64118:[[21191]],64119:[[21242]],64120:[[21917]],64121:[[21845]],64122:[[21913]],64123:[[21986]],64124:[[22618]],64125:[[22707]],64126:[[22852]],64127:[[22868]],64128:[[23138]],64129:[[23336]],64130:[[24274]],64131:[[24281]],64132:[[24425]],64133:[[24493]],64134:[[24792]],64135:[[24910]],64136:[[24840]],64137:[[24974]],64138:[[24928]],64139:[[25074]],64140:[[25140]],64141:[[25540]],64142:[[25628]],64143:[[25682]],64144:[[25942]],64145:[[26228]],64146:[[26391]],64147:[[26395]],64148:[[26454]],64149:[[27513]],64150:[[27578]],64151:[[27969]],64152:[[28379]],64153:[[28363]],64154:[[28450]],64155:[[28702]],64156:[[29038]],64157:[[30631]],64158:[[29237]],64159:[[29359]],64160:[[29482]],64161:[[29809]],64162:[[29958]],64163:[[30011]],64164:[[30237]],64165:[[30239]],64166:[[30410]],64167:[[30427]],64168:[[30452]],64169:[[30538]],64170:[[30528]],64171:[[30924]],64172:[[31409]],64173:[[31680]],64174:[[31867]],64175:[[32091]],64176:[[32244]],64177:[[32574]],64178:[[32773]],64179:[[33618]],64180:[[33775]],64181:[[34681]],64182:[[35137]],64183:[[35206]],64184:[[35222]],64185:[[35519]],64186:[[35576]],64187:[[35531]],64188:[[35585]],64189:[[35582]],64190:[[35565]],64191:[[35641]],64192:[[35722]],64193:[[36104]],64194:[[36664]],64195:[[36978]],64196:[[37273]],64197:[[37494]],64198:[[38524]],64199:[[38627]],64200:[[38742]],64201:[[38875]],64202:[[38911]],64203:[[38923]],64204:[[38971]],64205:[[39698]],64206:[[40860]],64207:[[141386]],64208:[[141380]],64209:[[144341]],64210:[[15261]],64211:[[16408]],64212:[[16441]],64213:[[152137]],64214:[[154832]],64215:[[163539]],64216:[[40771]],64217:[[40846]],195072:[[38953]],195073:[[169398]],195074:[[39138]],195075:[[19251]],195076:[[39209]],195077:[[39335]],195078:[[39362]],195079:[[39422]],195080:[[19406]],195081:[[170800]],195082:[[39698]],195083:[[4e4]],195084:[[40189]],195085:[[19662]],195086:[[19693]],195087:[[40295]],195088:[[172238]],195089:[[19704]],195090:[[172293]],195091:[[172558]],195092:[[172689]],195093:[[40635]],195094:[[19798]],195095:[[40697]],195096:[[40702]],195097:[[40709]],195098:[[40719]],195099:[[40726]],195100:[[40763]],195101:[[173568]]},64256:{64256:[[102,102],256],64257:[[102,105],256],64258:[[102,108],256],64259:[[102,102,105],256],64260:[[102,102,108],256],64261:[[383,116],256],64262:[[115,116],256],64275:[[1396,1398],256],64276:[[1396,1381],256],64277:[[1396,1387],256],64278:[[1406,1398],256],64279:[[1396,1389],256],64285:[[1497,1460],512],64286:[,26],64287:[[1522,1463],512],64288:[[1506],256],64289:[[1488],256],64290:[[1491],256],64291:[[1492],256],64292:[[1499],256],64293:[[1500],256],64294:[[1501],256],64295:[[1512],256],64296:[[1514],256],64297:[[43],256],64298:[[1513,1473],512],64299:[[1513,1474],512],64300:[[64329,1473],512],64301:[[64329,1474],512],64302:[[1488,1463],512],64303:[[1488,1464],512],64304:[[1488,1468],512],64305:[[1489,1468],512],64306:[[1490,1468],512],64307:[[1491,1468],512],64308:[[1492,1468],512],64309:[[1493,1468],512],64310:[[1494,1468],512],64312:[[1496,1468],512],64313:[[1497,1468],512],64314:[[1498,1468],512],64315:[[1499,1468],512],64316:[[1500,1468],512],64318:[[1502,1468],512],64320:[[1504,1468],512],64321:[[1505,1468],512],64323:[[1507,1468],512],64324:[[1508,1468],512],64326:[[1510,1468],512],64327:[[1511,1468],512],64328:[[1512,1468],512],64329:[[1513,1468],512],64330:[[1514,1468],512],64331:[[1493,1465],512],64332:[[1489,1471],512],64333:[[1499,1471],512],64334:[[1508,1471],512],64335:[[1488,1500],256],64336:[[1649],256],64337:[[1649],256],64338:[[1659],256],64339:[[1659],256],64340:[[1659],256],64341:[[1659],256],64342:[[1662],256],64343:[[1662],256],64344:[[1662],256],64345:[[1662],256],64346:[[1664],256],64347:[[1664],256],64348:[[1664],256],64349:[[1664],256],64350:[[1658],256],64351:[[1658],256],64352:[[1658],256],64353:[[1658],256],64354:[[1663],256],64355:[[1663],256],64356:[[1663],256],64357:[[1663],256],64358:[[1657],256],64359:[[1657],256],64360:[[1657],256],64361:[[1657],256],64362:[[1700],256],64363:[[1700],256],64364:[[1700],256],64365:[[1700],256],64366:[[1702],256],64367:[[1702],256],64368:[[1702],256],64369:[[1702],256],64370:[[1668],256],64371:[[1668],256],64372:[[1668],256],64373:[[1668],256],64374:[[1667],256],64375:[[1667],256],64376:[[1667],256],64377:[[1667],256],64378:[[1670],256],64379:[[1670],256],64380:[[1670],256],64381:[[1670],256],64382:[[1671],256],64383:[[1671],256],64384:[[1671],256],64385:[[1671],256],64386:[[1677],256],64387:[[1677],256],64388:[[1676],256],64389:[[1676],256],64390:[[1678],256],64391:[[1678],256],64392:[[1672],256],64393:[[1672],256],64394:[[1688],256],64395:[[1688],256],64396:[[1681],256],64397:[[1681],256],64398:[[1705],256],64399:[[1705],256],64400:[[1705],256],64401:[[1705],256],64402:[[1711],256],64403:[[1711],256],64404:[[1711],256],64405:[[1711],256],64406:[[1715],256],64407:[[1715],256],64408:[[1715],256],64409:[[1715],256],64410:[[1713],256],64411:[[1713],256],64412:[[1713],256],64413:[[1713],256],64414:[[1722],256],64415:[[1722],256],64416:[[1723],256],64417:[[1723],256],64418:[[1723],256],64419:[[1723],256],64420:[[1728],256],64421:[[1728],256],64422:[[1729],256],64423:[[1729],256],64424:[[1729],256],64425:[[1729],256],64426:[[1726],256],64427:[[1726],256],64428:[[1726],256],64429:[[1726],256],64430:[[1746],256],64431:[[1746],256],64432:[[1747],256],64433:[[1747],256],64467:[[1709],256],64468:[[1709],256],64469:[[1709],256],64470:[[1709],256],64471:[[1735],256],64472:[[1735],256],64473:[[1734],256],64474:[[1734],256],64475:[[1736],256],64476:[[1736],256],64477:[[1655],256],64478:[[1739],256],64479:[[1739],256],64480:[[1733],256],64481:[[1733],256],64482:[[1737],256],64483:[[1737],256],64484:[[1744],256],64485:[[1744],256],64486:[[1744],256],64487:[[1744],256],64488:[[1609],256],64489:[[1609],256],64490:[[1574,1575],256],64491:[[1574,1575],256],64492:[[1574,1749],256],64493:[[1574,1749],256],64494:[[1574,1608],256],64495:[[1574,1608],256],64496:[[1574,1735],256],64497:[[1574,1735],256],64498:[[1574,1734],256],64499:[[1574,1734],256],64500:[[1574,1736],256],64501:[[1574,1736],256],64502:[[1574,1744],256],64503:[[1574,1744],256],64504:[[1574,1744],256],64505:[[1574,1609],256],64506:[[1574,1609],256],64507:[[1574,1609],256],64508:[[1740],256],64509:[[1740],256],64510:[[1740],256],64511:[[1740],256]},64512:{64512:[[1574,1580],256],64513:[[1574,1581],256],64514:[[1574,1605],256],64515:[[1574,1609],256],64516:[[1574,1610],256],64517:[[1576,1580],256],64518:[[1576,1581],256],64519:[[1576,1582],256],64520:[[1576,1605],256],64521:[[1576,1609],256],64522:[[1576,1610],256],64523:[[1578,1580],256],64524:[[1578,1581],256],64525:[[1578,1582],256],64526:[[1578,1605],256],64527:[[1578,1609],256],64528:[[1578,1610],256],64529:[[1579,1580],256],64530:[[1579,1605],256],64531:[[1579,1609],256],64532:[[1579,1610],256],64533:[[1580,1581],256],64534:[[1580,1605],256],64535:[[1581,1580],256],64536:[[1581,1605],256],64537:[[1582,1580],256],64538:[[1582,1581],256],64539:[[1582,1605],256],64540:[[1587,1580],256],64541:[[1587,1581],256],64542:[[1587,1582],256],64543:[[1587,1605],256],64544:[[1589,1581],256],64545:[[1589,1605],256],64546:[[1590,1580],256],64547:[[1590,1581],256],64548:[[1590,1582],256],64549:[[1590,1605],256],64550:[[1591,1581],256],64551:[[1591,1605],256],64552:[[1592,1605],256],64553:[[1593,1580],256],64554:[[1593,1605],256],64555:[[1594,1580],256],64556:[[1594,1605],256],64557:[[1601,1580],256],64558:[[1601,1581],256],64559:[[1601,1582],256],64560:[[1601,1605],256],64561:[[1601,1609],256],64562:[[1601,1610],256],64563:[[1602,1581],256],64564:[[1602,1605],256],64565:[[1602,1609],256],64566:[[1602,1610],256],64567:[[1603,1575],256],64568:[[1603,1580],256],64569:[[1603,1581],256],64570:[[1603,1582],256],64571:[[1603,1604],256],64572:[[1603,1605],256],64573:[[1603,1609],256],64574:[[1603,1610],256],64575:[[1604,1580],256],64576:[[1604,1581],256],64577:[[1604,1582],256],64578:[[1604,1605],256],64579:[[1604,1609],256],64580:[[1604,1610],256],64581:[[1605,1580],256],64582:[[1605,1581],256],64583:[[1605,1582],256],64584:[[1605,1605],256],64585:[[1605,1609],256],64586:[[1605,1610],256],64587:[[1606,1580],256],64588:[[1606,1581],256],64589:[[1606,1582],256],64590:[[1606,1605],256],64591:[[1606,1609],256],64592:[[1606,1610],256],64593:[[1607,1580],256],64594:[[1607,1605],256],64595:[[1607,1609],256],64596:[[1607,1610],256],64597:[[1610,1580],256],64598:[[1610,1581],256],64599:[[1610,1582],256],64600:[[1610,1605],256],64601:[[1610,1609],256],64602:[[1610,1610],256],64603:[[1584,1648],256],64604:[[1585,1648],256],64605:[[1609,1648],256],64606:[[32,1612,1617],256],64607:[[32,1613,1617],256],64608:[[32,1614,1617],256],64609:[[32,1615,1617],256],64610:[[32,1616,1617],256],64611:[[32,1617,1648],256],64612:[[1574,1585],256],64613:[[1574,1586],256],64614:[[1574,1605],256],64615:[[1574,1606],256],64616:[[1574,1609],256],64617:[[1574,1610],256],64618:[[1576,1585],256],64619:[[1576,1586],256],64620:[[1576,1605],256],64621:[[1576,1606],256],64622:[[1576,1609],256],64623:[[1576,1610],256],64624:[[1578,1585],256],64625:[[1578,1586],256],64626:[[1578,1605],256],64627:[[1578,1606],256],64628:[[1578,1609],256],64629:[[1578,1610],256],64630:[[1579,1585],256],64631:[[1579,1586],256],64632:[[1579,1605],256],64633:[[1579,1606],256],64634:[[1579,1609],256],64635:[[1579,1610],256],64636:[[1601,1609],256],64637:[[1601,1610],256],64638:[[1602,1609],256],64639:[[1602,1610],256],64640:[[1603,1575],256],64641:[[1603,1604],256],64642:[[1603,1605],256],64643:[[1603,1609],256],64644:[[1603,1610],256],64645:[[1604,1605],256],64646:[[1604,1609],256],64647:[[1604,1610],256],64648:[[1605,1575],256],64649:[[1605,1605],256],64650:[[1606,1585],256],64651:[[1606,1586],256],64652:[[1606,1605],256],64653:[[1606,1606],256],64654:[[1606,1609],256],64655:[[1606,1610],256],64656:[[1609,1648],256],64657:[[1610,1585],256],64658:[[1610,1586],256],64659:[[1610,1605],256],64660:[[1610,1606],256],64661:[[1610,1609],256],64662:[[1610,1610],256],64663:[[1574,1580],256],64664:[[1574,1581],256],64665:[[1574,1582],256],64666:[[1574,1605],256],64667:[[1574,1607],256],64668:[[1576,1580],256],64669:[[1576,1581],256],64670:[[1576,1582],256],64671:[[1576,1605],256],64672:[[1576,1607],256],64673:[[1578,1580],256],64674:[[1578,1581],256],64675:[[1578,1582],256],64676:[[1578,1605],256],64677:[[1578,1607],256],64678:[[1579,1605],256],64679:[[1580,1581],256],64680:[[1580,1605],256],64681:[[1581,1580],256],64682:[[1581,1605],256],64683:[[1582,1580],256],64684:[[1582,1605],256],64685:[[1587,1580],256],64686:[[1587,1581],256],64687:[[1587,1582],256],64688:[[1587,1605],256],64689:[[1589,1581],256],64690:[[1589,1582],256],64691:[[1589,1605],256],64692:[[1590,1580],256],64693:[[1590,1581],256],64694:[[1590,1582],256],64695:[[1590,1605],256],64696:[[1591,1581],256],64697:[[1592,1605],256],64698:[[1593,1580],256],64699:[[1593,1605],256],64700:[[1594,1580],256],64701:[[1594,1605],256],64702:[[1601,1580],256],64703:[[1601,1581],256],64704:[[1601,1582],256],64705:[[1601,1605],256],64706:[[1602,1581],256],64707:[[1602,1605],256],64708:[[1603,1580],256],64709:[[1603,1581],256],64710:[[1603,1582],256],64711:[[1603,1604],256],64712:[[1603,1605],256],64713:[[1604,1580],256],64714:[[1604,1581],256],64715:[[1604,1582],256],64716:[[1604,1605],256],64717:[[1604,1607],256],64718:[[1605,1580],256],64719:[[1605,1581],256],64720:[[1605,1582],256],64721:[[1605,1605],256],64722:[[1606,1580],256],64723:[[1606,1581],256],64724:[[1606,1582],256],64725:[[1606,1605],256],64726:[[1606,1607],256],64727:[[1607,1580],256],64728:[[1607,1605],256],64729:[[1607,1648],256],64730:[[1610,1580],256],64731:[[1610,1581],256],64732:[[1610,1582],256],64733:[[1610,1605],256],64734:[[1610,1607],256],64735:[[1574,1605],256],64736:[[1574,1607],256],64737:[[1576,1605],256],64738:[[1576,1607],256],64739:[[1578,1605],256],64740:[[1578,1607],256],64741:[[1579,1605],256],64742:[[1579,1607],256],64743:[[1587,1605],256],64744:[[1587,1607],256],64745:[[1588,1605],256],64746:[[1588,1607],256],64747:[[1603,1604],256],64748:[[1603,1605],256],64749:[[1604,1605],256],64750:[[1606,1605],256],64751:[[1606,1607],256],64752:[[1610,1605],256],64753:[[1610,1607],256],64754:[[1600,1614,1617],256],64755:[[1600,1615,1617],256],64756:[[1600,1616,1617],256],64757:[[1591,1609],256],64758:[[1591,1610],256],64759:[[1593,1609],256],64760:[[1593,1610],256],64761:[[1594,1609],256],64762:[[1594,1610],256],64763:[[1587,1609],256],64764:[[1587,1610],256],64765:[[1588,1609],256],64766:[[1588,1610],256],64767:[[1581,1609],256]},64768:{64768:[[1581,1610],256],64769:[[1580,1609],256],64770:[[1580,1610],256],64771:[[1582,1609],256],64772:[[1582,1610],256],64773:[[1589,1609],256],64774:[[1589,1610],256],64775:[[1590,1609],256],64776:[[1590,1610],256],64777:[[1588,1580],256],64778:[[1588,1581],256],64779:[[1588,1582],256],64780:[[1588,1605],256],64781:[[1588,1585],256],64782:[[1587,1585],256],64783:[[1589,1585],256],64784:[[1590,1585],256],64785:[[1591,1609],256],64786:[[1591,1610],256],64787:[[1593,1609],256],64788:[[1593,1610],256],64789:[[1594,1609],256],64790:[[1594,1610],256],64791:[[1587,1609],256],64792:[[1587,1610],256],64793:[[1588,1609],256],64794:[[1588,1610],256],64795:[[1581,1609],256],64796:[[1581,1610],256],64797:[[1580,1609],256],64798:[[1580,1610],256],64799:[[1582,1609],256],64800:[[1582,1610],256],64801:[[1589,1609],256],64802:[[1589,1610],256],64803:[[1590,1609],256],64804:[[1590,1610],256],64805:[[1588,1580],256],64806:[[1588,1581],256],64807:[[1588,1582],256],64808:[[1588,1605],256],64809:[[1588,1585],256],64810:[[1587,1585],256],64811:[[1589,1585],256],64812:[[1590,1585],256],64813:[[1588,1580],256],64814:[[1588,1581],256],64815:[[1588,1582],256],64816:[[1588,1605],256],64817:[[1587,1607],256],64818:[[1588,1607],256],64819:[[1591,1605],256],64820:[[1587,1580],256],64821:[[1587,1581],256],64822:[[1587,1582],256],64823:[[1588,1580],256],64824:[[1588,1581],256],64825:[[1588,1582],256],64826:[[1591,1605],256],64827:[[1592,1605],256],64828:[[1575,1611],256],64829:[[1575,1611],256],64848:[[1578,1580,1605],256],64849:[[1578,1581,1580],256],64850:[[1578,1581,1580],256],64851:[[1578,1581,1605],256],64852:[[1578,1582,1605],256],64853:[[1578,1605,1580],256],64854:[[1578,1605,1581],256],64855:[[1578,1605,1582],256],64856:[[1580,1605,1581],256],64857:[[1580,1605,1581],256],64858:[[1581,1605,1610],256],64859:[[1581,1605,1609],256],64860:[[1587,1581,1580],256],64861:[[1587,1580,1581],256],64862:[[1587,1580,1609],256],64863:[[1587,1605,1581],256],64864:[[1587,1605,1581],256],64865:[[1587,1605,1580],256],64866:[[1587,1605,1605],256],64867:[[1587,1605,1605],256],64868:[[1589,1581,1581],256],64869:[[1589,1581,1581],256],64870:[[1589,1605,1605],256],64871:[[1588,1581,1605],256],64872:[[1588,1581,1605],256],64873:[[1588,1580,1610],256],64874:[[1588,1605,1582],256],64875:[[1588,1605,1582],256],64876:[[1588,1605,1605],256],64877:[[1588,1605,1605],256],64878:[[1590,1581,1609],256],64879:[[1590,1582,1605],256],64880:[[1590,1582,1605],256],64881:[[1591,1605,1581],256],64882:[[1591,1605,1581],256],64883:[[1591,1605,1605],256],64884:[[1591,1605,1610],256],64885:[[1593,1580,1605],256],64886:[[1593,1605,1605],256],64887:[[1593,1605,1605],256],64888:[[1593,1605,1609],256],64889:[[1594,1605,1605],256],64890:[[1594,1605,1610],256],64891:[[1594,1605,1609],256],64892:[[1601,1582,1605],256],64893:[[1601,1582,1605],256],64894:[[1602,1605,1581],256],64895:[[1602,1605,1605],256],64896:[[1604,1581,1605],256],64897:[[1604,1581,1610],256],64898:[[1604,1581,1609],256],64899:[[1604,1580,1580],256],64900:[[1604,1580,1580],256],64901:[[1604,1582,1605],256],64902:[[1604,1582,1605],256],64903:[[1604,1605,1581],256],64904:[[1604,1605,1581],256],64905:[[1605,1581,1580],256],64906:[[1605,1581,1605],256],64907:[[1605,1581,1610],256],64908:[[1605,1580,1581],256],64909:[[1605,1580,1605],256],64910:[[1605,1582,1580],256],64911:[[1605,1582,1605],256],64914:[[1605,1580,1582],256],64915:[[1607,1605,1580],256],64916:[[1607,1605,1605],256],64917:[[1606,1581,1605],256],64918:[[1606,1581,1609],256],64919:[[1606,1580,1605],256],64920:[[1606,1580,1605],256],64921:[[1606,1580,1609],256],64922:[[1606,1605,1610],256],64923:[[1606,1605,1609],256],64924:[[1610,1605,1605],256],64925:[[1610,1605,1605],256],64926:[[1576,1582,1610],256],64927:[[1578,1580,1610],256],64928:[[1578,1580,1609],256],64929:[[1578,1582,1610],256],64930:[[1578,1582,1609],256],64931:[[1578,1605,1610],256],64932:[[1578,1605,1609],256],64933:[[1580,1605,1610],256],64934:[[1580,1581,1609],256],64935:[[1580,1605,1609],256],64936:[[1587,1582,1609],256],64937:[[1589,1581,1610],256],64938:[[1588,1581,1610],256],64939:[[1590,1581,1610],256],64940:[[1604,1580,1610],256],64941:[[1604,1605,1610],256],64942:[[1610,1581,1610],256],64943:[[1610,1580,1610],256],64944:[[1610,1605,1610],256],64945:[[1605,1605,1610],256],64946:[[1602,1605,1610],256],64947:[[1606,1581,1610],256],64948:[[1602,1605,1581],256],64949:[[1604,1581,1605],256],64950:[[1593,1605,1610],256],64951:[[1603,1605,1610],256],64952:[[1606,1580,1581],256],64953:[[1605,1582,1610],256],64954:[[1604,1580,1605],256],64955:[[1603,1605,1605],256],64956:[[1604,1580,1605],256],64957:[[1606,1580,1581],256],64958:[[1580,1581,1610],256],64959:[[1581,1580,1610],256],64960:[[1605,1580,1610],256],64961:[[1601,1605,1610],256],64962:[[1576,1581,1610],256],64963:[[1603,1605,1605],256],64964:[[1593,1580,1605],256],64965:[[1589,1605,1605],256],64966:[[1587,1582,1610],256],64967:[[1606,1580,1610],256],65008:[[1589,1604,1746],256],65009:[[1602,1604,1746],256],65010:[[1575,1604,1604,1607],256],65011:[[1575,1603,1576,1585],256],65012:[[1605,1581,1605,1583],256],65013:[[1589,1604,1593,1605],256],65014:[[1585,1587,1608,1604],256],65015:[[1593,1604,1610,1607],256],65016:[[1608,1587,1604,1605],256],65017:[[1589,1604,1609],256],65018:[[1589,1604,1609,32,1575,1604,1604,1607,32,1593,1604,1610,1607,32,1608,1587,1604,1605],256],65019:[[1580,1604,32,1580,1604,1575,1604,1607],256],65020:[[1585,1740,1575,1604],256]},65024:{65040:[[44],256],65041:[[12289],256],65042:[[12290],256],65043:[[58],256],65044:[[59],256],65045:[[33],256],65046:[[63],256],65047:[[12310],256],65048:[[12311],256],65049:[[8230],256],65056:[,230],65057:[,230],65058:[,230],65059:[,230],65060:[,230],65061:[,230],65062:[,230],65063:[,220],65064:[,220],65065:[,220],65066:[,220],65067:[,220],65068:[,220],65069:[,220],65072:[[8229],256],65073:[[8212],256],65074:[[8211],256],65075:[[95],256],65076:[[95],256],65077:[[40],256],65078:[[41],256],65079:[[123],256],65080:[[125],256],65081:[[12308],256],65082:[[12309],256],65083:[[12304],256],65084:[[12305],256],65085:[[12298],256],65086:[[12299],256],65087:[[12296],256],65088:[[12297],256],65089:[[12300],256],65090:[[12301],256],65091:[[12302],256],65092:[[12303],256],65095:[[91],256],65096:[[93],256],65097:[[8254],256],65098:[[8254],256],65099:[[8254],256],65100:[[8254],256],65101:[[95],256],65102:[[95],256],65103:[[95],256],65104:[[44],256],65105:[[12289],256],65106:[[46],256],65108:[[59],256],65109:[[58],256],65110:[[63],256],65111:[[33],256],65112:[[8212],256],65113:[[40],256],65114:[[41],256],65115:[[123],256],65116:[[125],256],65117:[[12308],256],65118:[[12309],256],65119:[[35],256],65120:[[38],256],65121:[[42],256],65122:[[43],256],65123:[[45],256],65124:[[60],256],65125:[[62],256],65126:[[61],256],65128:[[92],256],65129:[[36],256],65130:[[37],256],65131:[[64],256],65136:[[32,1611],256],65137:[[1600,1611],256],65138:[[32,1612],256],65140:[[32,1613],256],65142:[[32,1614],256],65143:[[1600,1614],256],65144:[[32,1615],256],65145:[[1600,1615],256],65146:[[32,1616],256],65147:[[1600,1616],256],65148:[[32,1617],256],65149:[[1600,1617],256],65150:[[32,1618],256],65151:[[1600,1618],256],65152:[[1569],256],65153:[[1570],256],65154:[[1570],256],65155:[[1571],256],65156:[[1571],256],65157:[[1572],256],65158:[[1572],256],65159:[[1573],256],65160:[[1573],256],65161:[[1574],256],65162:[[1574],256],65163:[[1574],256],65164:[[1574],256],65165:[[1575],256],65166:[[1575],256],65167:[[1576],256],65168:[[1576],256],65169:[[1576],256],65170:[[1576],256],65171:[[1577],256],65172:[[1577],256],65173:[[1578],256],65174:[[1578],256],65175:[[1578],256],65176:[[1578],256],65177:[[1579],256],65178:[[1579],256],65179:[[1579],256],65180:[[1579],256],65181:[[1580],256],65182:[[1580],256],65183:[[1580],256],65184:[[1580],256],65185:[[1581],256],65186:[[1581],256],65187:[[1581],256],65188:[[1581],256],65189:[[1582],256],65190:[[1582],256],65191:[[1582],256],65192:[[1582],256],65193:[[1583],256],65194:[[1583],256],65195:[[1584],256],65196:[[1584],256],65197:[[1585],256],65198:[[1585],256],65199:[[1586],256],65200:[[1586],256],65201:[[1587],256],65202:[[1587],256],65203:[[1587],256],65204:[[1587],256],65205:[[1588],256],65206:[[1588],256],65207:[[1588],256],65208:[[1588],256],65209:[[1589],256],65210:[[1589],256],65211:[[1589],256],65212:[[1589],256],65213:[[1590],256],65214:[[1590],256],65215:[[1590],256],65216:[[1590],256],65217:[[1591],256],65218:[[1591],256],65219:[[1591],256],65220:[[1591],256],65221:[[1592],256],65222:[[1592],256],65223:[[1592],256],65224:[[1592],256],65225:[[1593],256],65226:[[1593],256],65227:[[1593],256],65228:[[1593],256],65229:[[1594],256],65230:[[1594],256],65231:[[1594],256],65232:[[1594],256],65233:[[1601],256],65234:[[1601],256],65235:[[1601],256],65236:[[1601],256],65237:[[1602],256],65238:[[1602],256],65239:[[1602],256],65240:[[1602],256],65241:[[1603],256],65242:[[1603],256],65243:[[1603],256],65244:[[1603],256],65245:[[1604],256],65246:[[1604],256],65247:[[1604],256],65248:[[1604],256],65249:[[1605],256],65250:[[1605],256],65251:[[1605],256],65252:[[1605],256],65253:[[1606],256],65254:[[1606],256],65255:[[1606],256],65256:[[1606],256],65257:[[1607],256],65258:[[1607],256],65259:[[1607],256],65260:[[1607],256],65261:[[1608],256],65262:[[1608],256],65263:[[1609],256],65264:[[1609],256],65265:[[1610],256],65266:[[1610],256],65267:[[1610],256],65268:[[1610],256],65269:[[1604,1570],256],65270:[[1604,1570],256],65271:[[1604,1571],256],65272:[[1604,1571],256],65273:[[1604,1573],256],65274:[[1604,1573],256],65275:[[1604,1575],256],65276:[[1604,1575],256]},65280:{65281:[[33],256],65282:[[34],256],65283:[[35],256],65284:[[36],256],65285:[[37],256],65286:[[38],256],65287:[[39],256],65288:[[40],256],65289:[[41],256],65290:[[42],256],65291:[[43],256],65292:[[44],256],65293:[[45],256],65294:[[46],256],65295:[[47],256],65296:[[48],256],65297:[[49],256],65298:[[50],256],65299:[[51],256],65300:[[52],256],65301:[[53],256],65302:[[54],256],65303:[[55],256],65304:[[56],256],65305:[[57],256],65306:[[58],256],65307:[[59],256],65308:[[60],256],65309:[[61],256],65310:[[62],256],65311:[[63],256],65312:[[64],256],65313:[[65],256],65314:[[66],256],65315:[[67],256],65316:[[68],256],65317:[[69],256],65318:[[70],256],65319:[[71],256],65320:[[72],256],65321:[[73],256],65322:[[74],256],65323:[[75],256],65324:[[76],256],65325:[[77],256],65326:[[78],256],65327:[[79],256],65328:[[80],256],65329:[[81],256],65330:[[82],256],65331:[[83],256],65332:[[84],256],65333:[[85],256],65334:[[86],256],65335:[[87],256],65336:[[88],256],65337:[[89],256],65338:[[90],256],65339:[[91],256],65340:[[92],256],65341:[[93],256],65342:[[94],256],65343:[[95],256],65344:[[96],256],65345:[[97],256],65346:[[98],256],65347:[[99],256],65348:[[100],256],65349:[[101],256],65350:[[102],256],65351:[[103],256],65352:[[104],256],65353:[[105],256],65354:[[106],256],65355:[[107],256],65356:[[108],256],65357:[[109],256],65358:[[110],256],65359:[[111],256],65360:[[112],256],65361:[[113],256],65362:[[114],256],65363:[[115],256],65364:[[116],256],65365:[[117],256],65366:[[118],256],65367:[[119],256],65368:[[120],256],65369:[[121],256],65370:[[122],256],65371:[[123],256],65372:[[124],256],65373:[[125],256],65374:[[126],256],65375:[[10629],256],65376:[[10630],256],65377:[[12290],256],65378:[[12300],256],65379:[[12301],256],65380:[[12289],256],65381:[[12539],256],65382:[[12530],256],65383:[[12449],256],65384:[[12451],256],65385:[[12453],256],65386:[[12455],256],65387:[[12457],256],65388:[[12515],256],65389:[[12517],256],65390:[[12519],256],65391:[[12483],256],65392:[[12540],256],65393:[[12450],256],65394:[[12452],256],65395:[[12454],256],65396:[[12456],256],65397:[[12458],256],65398:[[12459],256],65399:[[12461],256],65400:[[12463],256],65401:[[12465],256],65402:[[12467],256],65403:[[12469],256],65404:[[12471],256],65405:[[12473],256],65406:[[12475],256],65407:[[12477],256],65408:[[12479],256],65409:[[12481],256],65410:[[12484],256],65411:[[12486],256],65412:[[12488],256],65413:[[12490],256],65414:[[12491],256],65415:[[12492],256],65416:[[12493],256],65417:[[12494],256],65418:[[12495],256],65419:[[12498],256],65420:[[12501],256],65421:[[12504],256],65422:[[12507],256],65423:[[12510],256],65424:[[12511],256],65425:[[12512],256],65426:[[12513],256],65427:[[12514],256],65428:[[12516],256],65429:[[12518],256],65430:[[12520],256],65431:[[12521],256],65432:[[12522],256],65433:[[12523],256],65434:[[12524],256],65435:[[12525],256],65436:[[12527],256],65437:[[12531],256],65438:[[12441],256],65439:[[12442],256],65440:[[12644],256],65441:[[12593],256],65442:[[12594],256],65443:[[12595],256],65444:[[12596],256],65445:[[12597],256],65446:[[12598],256],65447:[[12599],256],65448:[[12600],256],65449:[[12601],256],65450:[[12602],256],65451:[[12603],256],65452:[[12604],256],65453:[[12605],256],65454:[[12606],256],65455:[[12607],256],65456:[[12608],256],65457:[[12609],256],65458:[[12610],256],65459:[[12611],256],65460:[[12612],256],65461:[[12613],256],65462:[[12614],256],65463:[[12615],256],65464:[[12616],256],65465:[[12617],256],65466:[[12618],256],65467:[[12619],256],65468:[[12620],256],65469:[[12621],256],65470:[[12622],256],65474:[[12623],256],65475:[[12624],256],65476:[[12625],256],65477:[[12626],256],65478:[[12627],256],65479:[[12628],256],65482:[[12629],256],65483:[[12630],256],65484:[[12631],256],65485:[[12632],256],65486:[[12633],256],65487:[[12634],256],65490:[[12635],256],65491:[[12636],256],65492:[[12637],256],65493:[[12638],256],65494:[[12639],256],65495:[[12640],256],65498:[[12641],256],65499:[[12642],256],65500:[[12643],256],65504:[[162],256],65505:[[163],256],65506:[[172],256],65507:[[175],256],65508:[[166],256],65509:[[165],256],65510:[[8361],256],65512:[[9474],256],65513:[[8592],256],65514:[[8593],256],65515:[[8594],256],65516:[[8595],256],65517:[[9632],256],65518:[[9675],256]}};var ne={nfc:te,nfd:j,nfkc:pe,nfkd:q};t.exports=ne,ne.shimApplied=!1,String.prototype.normalize||(Object.defineProperty(String.prototype,"normalize",{enumerable:!1,configurable:!0,writable:!0,value:function(){var y=""+this,R=arguments[0]===void 0?"NFC":arguments[0];if(this===null||this===void 0)throw new TypeError("Cannot call method on "+Object.prototype.toString.call(this));if(R==="NFC")return ne.nfc(y);if(R==="NFD")return ne.nfd(y);if(R==="NFKC")return ne.nfkc(y);if(R==="NFKD")return ne.nfkd(y);throw new RangeError("Invalid normalization form: "+R)}}),ne.shimApplied=!0)})()})(Uee);const ylt=Uee.exports;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function vlt(t){const e=t.caseSensitive?t.accentSensitive?"variant":"case":t.accentSensitive?"accent":"base",r=t.caseFirst,n=t.ignorePunctuation;return new Intl.Collator(t.localeLang,{sensitivity:e,caseFirst:r,ignorePunctuation:n})}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const blt="i",wlt=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class Slt{constructor(e,r,n){this.config=e,this.dateTimeHelper=r,this.numberLiteralsHelper=n,this.lt=(i,o)=>this.compare(i,o)<0,this.leq=(i,o)=>this.compare(i,o)<=0,this.gt=(i,o)=>this.compare(i,o)>0,this.geq=(i,o)=>this.compare(i,o)>=0,this.eq=(i,o)=>this.compare(i,o)===0,this.neq=(i,o)=>this.compare(i,o)!==0,this.pow=(i,o)=>Math.pow(Ne(i),Ne(o)),this.addWithEpsilonRaw=(i,o)=>{const a=i+o;return Math.abs(a)<this.actualEps*Math.abs(i)?0:a},this.addWithEpsilon=(i,o)=>{const a=jV(i,o);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(Ne(i),Ne(o)),a)},this.unaryMinus=i=>HI(i,-Ne(i)),this.unaryPlus=i=>i,this.unaryPercent=i=>new A2(Ne(i)/100),this.concat=(i,o)=>i.concat(o),this.nonstrictadd=(i,o)=>i instanceof x?i:o instanceof x?o:typeof i=="number"?typeof o=="number"?this.addWithEpsilonRaw(i,o):i:typeof o=="number"?o:0,this.subtract=(i,o)=>{const a=jV(i,o),s=Ne(i),l=Ne(o);let u=s-l;return Math.abs(u)<this.actualEps*Math.abs(s)&&(u=0),this.ExtendedNumberFactory(u,a)},this.divide=(i,o)=>{const a=Ne(i),s=Ne(o);if(s===0)return new x($.DIV_BY_ZERO);{const l=WV(i,o);return this.ExtendedNumberFactory(a/s,l)}},this.multiply=(i,o)=>{const a=WV(i,o);return this.ExtendedNumberFactory(Ne(i)*Ne(o),a)},this.manyToExactComplex=i=>{const o=[];for(const a of i){if(a instanceof x)return a;if(Ft(a)||typeof a=="string"){const s=this.coerceScalarToComplex(a);s instanceof x||o.push(s)}}return o},this.coerceNumbersExactRanges=i=>this.manyToNumbers(i,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=i=>this.manyToNumbers(i,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=i=>{const o=[];for(const a of i){if(a instanceof x)return a;Ft(a)&&o.push(Ne(a))}return o},this.manyToOnlyNumbersDropNulls=i=>{const o=[];for(const a of i){if(a instanceof x)return a;if(Ft(a))o.push(Ne(a));else if(a!==_t)return new x($.VALUE,W.NumberExpected)}return o},this.manyToCoercedNumbersDropNulls=i=>{const o=[];for(const a of i){if(a instanceof x)return a;if(a===_t)continue;const s=this.coerceScalarToNumberOrError(a);Ft(s)&&o.push(Ne(s))}return o},this.collator=vlt(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const r=this.buildRegex(e);return n=>typeof n=="string"&&r.test(this.normalizeString(n))}neqMatcherFunction(e){const r=this.buildRegex(e);return n=>typeof n!="string"||!r.test(this.normalizeString(n))}searchString(e,r){var n;const o=this.buildRegex(e,!1).exec(r);return(n=o==null?void 0:o.index)!==null&&n!==void 0?n:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let r=0;r<e.length;r++){const n=e.charAt(r);if(Bv(n)||this.config.useRegularExpressions&&Uv(n))return!0}return!1}floatCmp(e,r){const n=Ne(e),i=Ne(r),o=1+this.actualEps;return i>=0&&n*o>=i&&n<=i*o||i<=0&&n*o<=i&&n>=i*o?0:n>i?1:-1}coerceScalarToNumberOrError(e){var r;return e instanceof x?e:(r=this.coerceToMaybeNumber(e))!==null&&r!==void 0?r:new x($.VALUE,W.NumberCoercion)}coerceToMaybeNumber(e){var r;return(r=this.coerceNonDateScalarToMaybeNumber(e))!==null&&r!==void 0?r:typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===_t)return 0;if(typeof e=="string"){if(e==="")return 0;const r=this.coerceStringToMaybePercentNumber(e);if(r!==void 0)return r;const n=this.coerceStringToMaybeCurrencyNumber(e);return n!==void 0?n:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}else return Ft(e)?e:typeof e=="boolean"?Number(e):void 0}coerceStringToMaybePercentNumber(e){const r=e.trim();if(r.endsWith("%")){const n=r.slice(0,r.length-1).trim(),i=this.numberLiteralsHelper.numericStringToMaybeNumber(n);if(i!==void 0)return new A2(i/100)}}coerceStringToMaybeCurrencyNumber(e){const r=this.currencyMatcher(e.trim());if(r!==void 0){const[n,i]=r,o=this.numberLiteralsHelper.numericStringToMaybeNumber(i);if(o!==void 0)return new kA(o,n)}}currencyMatcher(e){for(const r of this.config.currencySymbol){if(e.startsWith(r))return[r,e.slice(r.length).trim()];if(e.endsWith(r))return[r,e.slice(0,e.length-r.length).trim()]}}coerceComplexExactRanges(e){const r=[];for(const i of e)if(i instanceof je)r.push(i);else if(i!==_t){const o=this.coerceScalarToComplex(i);if(o instanceof x)return o;r.push(o)}const n=[];for(const i of r)if(i instanceof je){const o=this.manyToExactComplex(i.valuesFromTopLeftCorner());if(o instanceof x)return o;n.push(...o)}else n.push(i);return n}coerceScalarToComplex(e){return e instanceof x?e:e===_t?[0,0]:Ft(e)?[Ne(e),0]:typeof e=="string"?this.coerceStringToComplex(e):new x($.NUM,W.ComplexNumberExpected)}ExtendedNumberFactory(e,r){const{type:n,format:i}=r;switch(n){case Be.NUMBER_RAW:return e;case Be.NUMBER_CURRENCY:return new kA(e,i!=null?i:this.config.currencySymbol[0]);case Be.NUMBER_DATE:return new BI(e,i);case Be.NUMBER_DATETIME:return new VI(e,i);case Be.NUMBER_TIME:return new UI(e,i);case Be.NUMBER_PERCENT:return new A2(e,i)}}buildRegex(e,r=!0){e=this.normalizeString(e);let n,i=this.config.useWildcards,o=this.config.useRegularExpressions;if(o)try{RegExp(e)}catch{o=!1,i=!1}return o?n=_lt(e,this.config.caseSensitive):i?n=Elt(e,this.config.caseSensitive):n=Clt(e,this.config.caseSensitive),this.config.matchWholeCell&&r?RegExp("^("+n+")$"):RegExp(n)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=Gee(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,r){if(typeof e=="string"||typeof r=="string"){const n=typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):e,i=typeof r=="string"?this.dateTimeHelper.dateStringToDateNumber(r):r;if(Ft(n)&&Ft(i))return this.floatCmp(n,i)}return e===_t?e=UV(r):r===_t&&(r=UV(e)),typeof e=="string"&&typeof r=="string"?this.stringCmp(e,r):typeof e=="boolean"&&typeof r=="boolean"?VV(HA(e),HA(r)):Ft(e)&&Ft(r)?this.floatCmp(e,r):e===_t&&r===_t?0:VV(BV(vS(e)),BV(vS(r)))}stringCmp(e,r){return this.collator.compare(e,r)}manyToNumbers(e,r){const n=[];for(const o of e)if(o instanceof je)n.push(o);else{const a=Ne(this.coerceScalarToNumberOrError(o));if(a instanceof x)return a;n.push(a)}const i=[];for(const o of n)if(o instanceof je){const a=r(o.valuesFromTopLeftCorner());if(a instanceof x)return a;i.push(...a)}else i.push(o);return i}coerceStringToComplex(e){const r=wlt.exec(e);if(r===null)return new x($.NUM,W.ComplexNumberExpected);let n;if(r[6]!==void 0?n=r[1]==="-"?[0,-1]:[0,1]:n=this.parseComplexToken(r[1]+r[3],r[5]),n instanceof x||r[8]===void 0)return n;let i;return r[14]!==void 0?i=r[9]==="-"?[0,-1]:[0,1]:i=this.parseComplexToken(r[9]+r[11],r[13]),i instanceof x?i:r[5]!==""||r[13]===""?new x($.NUM,W.ComplexNumberExpected):r[8]==="+"?[n[0]+i[0],n[1]+i[1]]:[n[0]-i[0],n[1]-i[1]]}parseComplexToken(e,r){const n=Ne(this.coerceNonDateScalarToMaybeNumber(e));return n===void 0?new x($.NUM,W.ComplexNumberExpected):r===""?[n,0]:[0,n]}}function Ar([t,e],r){if(!isFinite(t)||!isFinite(e))return new x($.NUM,W.NaN);if(r=r!=null?r:blt,e===0)return`${t}`;const n=`${e===-1||e===1?"":Math.abs(e)}${r}`;return t===0?`${e<0?"-":""}${n}`:`${t}${e<0?"-":"+"}${n}`}function Vee(t){return t instanceof je?t:je.fromScalar(t)}function HA(t){return Number(t)}function UV(t){return typeof t=="string"?"":Ft(t)?0:typeof t=="boolean"?!1:_t}function jee(t){if(t instanceof x||typeof t=="boolean")return t;if(t===_t)return!1;if(Ft(t))return Ne(t)!==0;{const e=t.toUpperCase();return e==="TRUE"?!0:e==="FALSE"||e===""?!1:void 0}}function BA(t){return t instanceof x||typeof t=="string"?t:t===_t?"":Ft(t)?Ne(t).toString():t?"TRUE":"FALSE"}function QC(t){return t===_t?0:t}function VV(t,e){const r=Ne(t),n=Ne(e);return r>n?1:r<n?-1:0}function Wee(t){return isNaN(t)||t===1/0||t===-1/0}function zee(t){return t===0?0:t}function Bv(t){return["*","?"].includes(t)}const Rlt=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function Uv(t){return Rlt.includes(t)}function Elt(t,e){let r="";for(let n=0;n<t.length;n++){const i=t.charAt(n);if(i==="~"){if(n==t.length-1){r+="~";continue}const o=t.charAt(n+1);Bv(o)||Uv(o)?(r+="\\"+o,n++):(r+=o,n++)}else Bv(i)?r+="."+i:Uv(i)?r+="\\"+i:e?r+=i:r+=i.toLowerCase()}return r}function Clt(t,e){let r="";for(let n=0;n<t.length;n++){const i=t.charAt(n);Bv(i)||Uv(i)?r+="\\"+i:e?r+=i:r+=i.toLowerCase()}return r}function _lt(t,e){let r="";for(let n=0;n<t.length;n++){const i=t.charAt(n);Bv(i)||Uv(i)||e?r+=i:r+=i.toLowerCase()}return r}function jV(t,e){const{type:r,format:n}=mS(t),{type:i,format:o}=mS(e);if(r===Be.NUMBER_RAW)return{type:i,format:o};if(i===Be.NUMBER_RAW)return{type:r,format:n};if((r===Be.NUMBER_DATETIME||r===Be.NUMBER_DATE)&&(i===Be.NUMBER_DATETIME||i===Be.NUMBER_DATE))return{type:Be.NUMBER_RAW};if(r===Be.NUMBER_TIME){if(i===Be.NUMBER_DATE)return{type:Be.NUMBER_DATETIME,format:o+" "+n};if(i===Be.NUMBER_DATETIME)return{type:Be.NUMBER_DATETIME,format:o}}if(i===Be.NUMBER_TIME){if(r===Be.NUMBER_DATE)return{type:Be.NUMBER_DATETIME,format:n+" "+o};if(r===Be.NUMBER_DATETIME)return{type:Be.NUMBER_DATETIME,format:n}}return{type:r,format:n}}function WV(t,e){let{type:r,format:n}=mS(t),{type:i,format:o}=mS(e);return r===Be.NUMBER_PERCENT&&(r=Be.NUMBER_RAW,n=void 0),i===Be.NUMBER_PERCENT&&(i=Be.NUMBER_RAW,o=void 0),r===Be.NUMBER_RAW?{type:i,format:o}:i===Be.NUMBER_RAW?{type:r,format:n}:{type:Be.NUMBER_RAW}}function mg(t){return Gee(t.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function M2(t,e){var r;if(t.isAdHoc())return(r=t.data[0])===null||r===void 0?void 0:r[0];const n=t.range;if(e.formulaAddress.sheet===n.sheet){if(n.width()===1){const i=e.formulaAddress.row-n.start.row;if(i>=0&&i<n.height())return t.data[i][0]}else if(n.height()===1){const i=e.formulaAddress.col-n.start.col;if(i>=0&&i<n.width())return t.data[0][i]}}}function Gee(t,e){return typeof t.normalize=="function"?t.normalize(e.toUpperCase()):ylt[e](t)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var w;(function(t){t.STRING="STRING",t.NUMBER="NUMBER",t.BOOLEAN="BOOLEAN",t.SCALAR="SCALAR",t.NOERROR="NOERROR",t.RANGE="RANGE",t.INTEGER="INTEGER",t.COMPLEX="COMPLEX",t.ANY="ANY"})(w||(w={}));class pt{constructor(e){this.coerceScalarToNumberOrError=r=>this.arithmeticHelper.coerceScalarToNumberOrError(r),this.runFunction=(r,n,i,o)=>{const a=this.evaluateArguments(r,n,i),s=a.map(([p,m])=>p),l=a.map(([p,m])=>m),u=this.buildMetadataForEachArgumentValue(s.length,i),c=n.arraysFlag&&!i.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(u,s.length))return new x($.NA,W.WrongArgNumber);const[f,h]=c?this.calculateSizeOfVectorizedResultArray(s,u):[1,1];if(f===1&&h===1){const p=this.vectorizeAndBroadcastArgumentsIfNecessary(c,s,u,0,0);return this.calculateSingleCellOfResultArray(n,p,u,l,o,i.returnNumberType)}const d=[...Array(f).keys()].map(p=>[...Array(h).keys()].map(m=>{const g=this.vectorizeAndBroadcastArgumentsIfNecessary(c,s,u,p,m),v=this.calculateSingleCellOfResultArray(n,g,u,l,o,i.returnNumberType);if(v instanceof je)throw new Error("Function returning array cannot be vectorized.");return v}));return je.onlyValues(d)},this.runFunctionWithReferenceArgument=(r,n,i,o,a,s=()=>new x($.NA,W.CellRefExpected))=>{if(r.length===0)return this.returnNumberWrapper(o(),i.returnNumberType);if(r.length>1)return new x($.NA,W.WrongArgNumber);let l=r[0];for(;l.type===F.PARENTHESIS;)l=l.expression;let u;if(l.type===F.CELL_REFERENCE)u=l.reference.toSimpleCellAddress(n.formulaAddress);else if(l.type===F.CELL_RANGE||l.type===F.COLUMN_RANGE||l.type===F.ROW_RANGE)try{u=ze.fromAst(l,n.formulaAddress).start}catch{return new x($.REF,W.CellRefExpected)}return u!==void 0?this.returnNumberWrapper(a(u),i.returnNumberType):this.runFunction(r,n,i,s)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,r){return this.interpreter.evaluateAst(e,r)}arraySizeForAst(e,r){return this.arraySizePredictor.checkArraySizeForAst(e,r)}listOfScalarValues(e,r){const n=[];for(const i of e){const o=this.evaluateAst(i,r);if(o instanceof je)for(const a of o.valuesFromTopLeftCorner())n.push([a,!0]);else n.push([o,!1])}return n}coerceToType(e,r,n){let i;if(e instanceof je)switch(r.argumentType){case w.RANGE:case w.ANY:i=e;break;default:{const o=M2(e,n);if(o===void 0)return;e=o}}if(!(e instanceof je))switch(r.argumentType){case w.INTEGER:case w.NUMBER:const o=this.coerceScalarToNumberOrError(e);if(!Ft(o)){i=o;break}const a=Ne(o);if(r.maxValue!==void 0&&a>r.maxValue)return new x($.NUM,W.ValueLarge);if(r.minValue!==void 0&&a<r.minValue)return new x($.NUM,W.ValueSmall);if(r.lessThan!==void 0&&a>=r.lessThan)return new x($.NUM,W.ValueLarge);if(r.greaterThan!==void 0&&a<=r.greaterThan)return new x($.NUM,W.ValueSmall);if(r.argumentType===w.INTEGER&&!Number.isInteger(a))return new x($.NUM,W.IntegerExpected);i=o;break;case w.STRING:i=BA(e);break;case w.BOOLEAN:i=jee(e);break;case w.SCALAR:case w.NOERROR:case w.ANY:i=e;break;case w.RANGE:if(e instanceof x)return e;i=Vee(e);break;case w.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(Ne(e))}return r.passSubtype||i===void 0?i:Ne(i)}calculateSingleCellOfResultArray(e,r,n,i,o,a){const s=this.coerceArgumentsToRequiredTypes(e,r,n,i);if(s instanceof x)return s;const l=o(...s);return this.returnNumberWrapper(l,a)}coerceArgumentsToRequiredTypes(e,r,n,i){const o=[];for(let a=0;a<n.length;a++){const s=n[a],l=r[a]!==void 0?r[a]:s==null?void 0:s.defaultValue;if(l===void 0){o.push(void 0);continue}const u=this.coerceToType(l,s,e);if(u===void 0&&!i[a])return new x($.VALUE,W.WrongType);if(u instanceof x&&s.argumentType!==w.SCALAR)return u;o.push(u)}return o}vectorizeAndBroadcastArgumentsIfNecessary(e,r,n,i,o){return r.map((a,s)=>e&&this.isRangePassedAsAScalarArgument(a,n[s])?this.vectorizeAndBroadcastRangeArgument(a,i,o):a)}vectorizeAndBroadcastRangeArgument(e,r,n){var i;const o=e.height()===1?0:r,a=e.width()===1?0:n;return(i=e.data[o])===null||i===void 0?void 0:i[a]}evaluateArguments(e,r,n){return n.expandRanges?this.listOfScalarValues(e,r):e.map(i=>[this.evaluateAst(i,r),!1])}buildMetadataForEachArgumentValue(e,r){const n=r.parameters?[...r.parameters]:[];if(r.repeatLastArgs!==void 0&&Number.isInteger(r.repeatLastArgs)&&r.repeatLastArgs>0)for(;e>n.length;)n.push(...n.slice(n.length-r.repeatLastArgs));return n}isNumberOfArgumentValuesValid(e,r){return r>e.length?!1:r<e.length?e.slice(r).every(o=>(o==null?void 0:o.optionalArg)||(o==null?void 0:o.defaultValue)!==void 0):!0}calculateSizeOfVectorizedResultArray(e,r){const n=e.filter((a,s)=>this.isRangePassedAsAScalarArgument(a,r[s])),i=Math.max(1,...n.map(a=>a.height())),o=Math.max(1,...n.map(a=>a.width()));return[i,o]}isRangePassedAsAScalarArgument(e,r){return e==null||r==null?!1:e instanceof je&&![w.RANGE,w.ANY].includes(r.argumentType)}metadata(e){const r=this.constructor.implementedFunctions[e];if(r!==void 0)return r;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,r,n){return r!==void 0&&Ft(e)?this.arithmeticHelper.ExtendedNumberFactory(Ne(e),{type:r,format:n}):e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class yt{constructor(e,r,n=!1){if(this.width=e,this.height=r,this.isRef=n,e<=0||r<=0)throw Error("Incorrect array size")}static fromArray(e){return new yt(e.length>0?e[0].length:0,e.length)}static error(){return new yt(1,1,!0)}static scalar(){return new yt(1,1,!1)}isScalar(){return this.width<=1&&this.height<=1||this.isRef}}function Tlt(t,e){return new yt(Math.max(t.width,e.width),Math.max(t.height,e.height))}function Olt(t){return new yt(t.width,t.height)}class Alt{constructor(e,r){this.config=e,this.functionRegistry=r}checkArraySize(e,r){return this.checkArraySizeForAst(e,{formulaAddress:r,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,r){switch(e.type){case F.FUNCTION_CALL:return this.checkArraySizeForFunction(e,r);case F.COLUMN_RANGE:case F.ROW_RANGE:case F.CELL_RANGE:{const n=ze.fromAstOrUndef(e,r.formulaAddress);return n===void 0?yt.error():new yt(n.width(),n.height(),!0)}case F.ARRAY:{const n=[],i=[];for(const s of e.args){const l=s.map(f=>this.checkArraySizeForAst(f,r)),u=Math.min(...l.map(f=>f.height)),c=l.reduce((f,h)=>f+h.width,0);n.push(u),i.push(c)}const o=n.reduce((s,l)=>s+l,0),a=Math.min(...i);return new yt(a,o)}case F.STRING:case F.NUMBER:return yt.scalar();case F.CELL_REFERENCE:return new yt(1,1,!0);case F.DIV_OP:case F.CONCATENATE_OP:case F.EQUALS_OP:case F.GREATER_THAN_OP:case F.GREATER_THAN_OR_EQUAL_OP:case F.LESS_THAN_OP:case F.LESS_THAN_OR_EQUAL_OP:case F.MINUS_OP:case F.NOT_EQUAL_OP:case F.PLUS_OP:case F.POWER_OP:case F.TIMES_OP:{const n=this.checkArraySizeForAst(e.left,r),i=this.checkArraySizeForAst(e.right,r);return!r.arraysFlag&&(n.height>1||n.width>1||i.height>1||i.width>1)?yt.error():Tlt(n,i)}case F.MINUS_UNARY_OP:case F.PLUS_UNARY_OP:case F.PERCENT_OP:{const n=this.checkArraySizeForAst(e.value,r);return!r.arraysFlag&&(n.height>1||n.width>1)?yt.error():Olt(n)}case F.PARENTHESIS:return this.checkArraySizeForAst(e.expression,r);case F.EMPTY:return yt.error();default:return yt.error()}}checkArraySizeForFunction(e,r){const n=this.functionRegistry.getMetadata(e.procedureName),i=this.functionRegistry.getArraySizeFunction(e.procedureName);if(i!==void 0)return i(e,r);const o=e.args.map(u=>{var c;return this.checkArraySizeForAst(u,new aa(r.formulaAddress,r.arraysFlag||((c=n==null?void 0:n.arrayFunction)!==null&&c!==void 0?c:!1)))});if(n===void 0||n.expandRanges||!r.arraysFlag||n.vectorizationForbidden||n.parameters===void 0)return new yt(1,1);const a=[...n.parameters];if(n.repeatLastArgs===void 0&&a.length<o.length||n.repeatLastArgs!==void 0&&a.length<o.length&&(o.length-a.length)%n.repeatLastArgs!==0)return yt.error();for(;a.length<o.length;)a.push(...a.slice(a.length-n.repeatLastArgs));let s=1,l=1;for(let u=0;u<o.length;u++)a[u].argumentType!==w.RANGE&&a[u].argumentType!==w.ANY&&(l=Math.max(l,o[u].height),s=Math.max(s,o[u].width));return new yt(s,l)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Yee{constructor(e,r,n){var i;this.value=r,this.address=n,this.type=e.type,this.message=(i=e.message)!==null&&i!==void 0?i:""}toString(){return this.value}valueOf(){return this.value}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Vt(t,e,r){if(typeof t>"u")return xn.defaultConfig[r];if(typeof e=="string"){if(typeof t===e)return t;throw new Bt(e,r)}else{if(e.includes(t))return t;throw new $ee(e.map(n=>`'${n}'`).join(" "),r)}}function hf(t,e,r){if(t<r)throw new Pee(e,r)}function xlt(t,e,r){if(t>r)throw new kee(e,r)}function fb(t,e,r,n){if(e(t))return t;if(typeof t>"u")return xn.defaultConfig[n];throw new Bt(r,n)}function zV(...t){const e=new Map;t.forEach(n=>{const i=e.get(n.value)||[];i.push(n.name),e.set(n.value,i)});const r=[];for(const n of e.values())n.length>1&&r.push(n);if(r.length>0){r.forEach(i=>i.sort());const n=r.map(i=>`[${i}]`).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${n}`)}}function Ce(t,e,r){if(typeof t!==e)throw new Bt(e,r)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Ilt(t,e,r){t=t.replace(/\s\s+/g," ").trim().toLowerCase();let n=t.substring(t.length-2);n==="am"||n==="pm"?t=t.substring(0,t.length-2).trim():(n=t.substring(t.length-1),n==="a"||n==="p"?t=t.substring(0,t.length-1).trim():n=void 0);const i=t.split(/[ /.-]/g);i.length>=2&&i[i.length-2].includes(":")&&(i[i.length-2]=i[i.length-2]+"."+i[i.length-1],i.pop());const o=i[i.length-1].split(":");if(n!==void 0&&o.push(n),i.length===1)return GV(o,r);if(o.length===1)return YV(i,e);const a=YV(i.slice(0,i.length-1),e),s=GV(o,r);if(a!==void 0)return s===void 0?void 0:Object.assign(Object.assign({},a),s)}const zI=/^ss(\.(s+|0+))?$/;function GV(t,e){if(e===void 0)return;e=e.toLowerCase(),e.endsWith("am/pm")?e=e.substring(0,e.length-5).trim():e.endsWith("a/p")&&(e=e.substring(0,e.length-3).trim());const n=e.split(":");let i;if(t[t.length-1]==="am"||t[t.length-1]==="a"?(i=!1,t.pop()):(t[t.length-1]==="pm"||t[t.length-1]==="p")&&(i=!0,t.pop()),t.length!==n.length)return;const o=n.indexOf("hh"),a=n.indexOf("mm"),s=n.findIndex(p=>zI.test(p)),l=o!==-1?t[o]:"0";if(!/^\d+$/.test(l))return;let u=Number(l);if(i!==void 0){if(u<0||u>12)return;u=u%12,i&&(u=u+12)}const c=a!==-1?t[a]:"0";if(!/^\d+$/.test(c))return;const f=Number(c),h=s!==-1?t[s]:"0";if(!/^\d+(\.\d+)?$/.test(h))return;const d=Math.round(Number(h)*1e3)/1e3;return{hours:u,minutes:f,seconds:d}}function YV(t,e){if(e===void 0)return;const r=e.toLowerCase().split(/[ /.-]/g);if(t.length!==r.length)return;const n=r.indexOf("mm"),i=r.indexOf("dd"),o=r.indexOf("yyyy"),a=r.indexOf("yy");if(!(n in t)||!(i in t)||!(o in t)&&!(a in t)||o in t&&a in t)return;let s;if(o in t){const h=t[o];if(/^\d+$/.test(h)){if(s=Number(h),s<1e3||s>9999)return}else return}else{const h=t[a];if(/^\d+$/.test(h)){if(s=Number(h),s<0||s>99)return}else return}const l=t[n];if(!/^\d+$/.test(l))return;const u=Number(l),c=t[i];if(!/^\d+$/.test(c))return;const f=Number(c);return{year:s,month:u,day:f}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const UA=[31,28,31,30,31,30,31,31,30,31,30,31],Ff=[0,31,59,90,120,151,181,212,243,273,304,334],hb=60,db=60,VA=24;function gg(t){return t&&(typeof t=="object"||typeof t=="function")?"year"in t&&typeof t.year=="number"&&"month"in t&&typeof t.month=="number"&&"day"in t&&typeof t.day=="number":!1}function Kee(t){return t&&(typeof t=="object"||typeof t=="function")?"hours"in t&&typeof t.hours=="number"&&"minutes"in t&&typeof t.minutes=="number"&&"seconds"in t&&typeof t.seconds=="number":!1}const Mlt={year:9999,month:12,day:31};class Nlt{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(Mlt),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:r,dateFormat:n="",timeFormat:i=""}=this.parseDateTimeFromConfigFormats(e);if(r!==void 0)return Kee(r)?gg(r)?new VI(ih(r)+this.dateToNumber(r),n+" "+i):new UI(ih(r),i):gg(r)?new BI(this.dateToNumber(r),n):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1?!1:this.isLeapYear(e.year)&&e.month===2?e.day<=29:e.day<=UA[e.month-1]}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const r=Math.floor(e)+this.minDateAbsoluteValue;let n=Math.floor(r/365.2425);this.dateToNumberFromZero({year:n+1,month:1,day:1})<=r?n++:this.dateToNumberFromZero({year:n-1,month:1,day:1})>r&&n--;const i=r-this.dateToNumberFromZero({year:n,month:1,day:1}),o=Plt(i-(this.isLeapYear(n)&&i>=59?1:0)),a=i-Ff[o]-(this.isLeapYear(n)&&o>1?1:0);return{year:n,month:o+1,day:a+1}}numberToSimpleDateTime(e){const r=nh(e%1),n=Math.floor(r.hours/VA);r.hours=r.hours%VA;const i=this.numberToSimpleDate(Math.floor(e)+n);return Object.assign(Object.assign({},i),r)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,r){return this.isLeapYear(e)&&r===2?29:UA[r-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,r){return e.day===31&&(e.day=30),e.day===30&&r.day===31&&(r.day=30),e.month===2&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,r.month===2&&r.day===this.daysInMonth(r.year,r.month)&&(r.day=30)),[e,r]}yearLengthForBasis(e,r){return e.year!==r.year?e.year+1!==r.year||e.month<r.month||e.month===r.month&&e.day<r.day?(this.leapYearsCount(r.year)-this.leapYearsCount(e.year-1))/(r.year-e.year+1)+365:this.countLeapDays(r)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,r,n){const i=this.parseDateTime(e,r,n);if(!(gg(i)&&(i.year>=0&&i.year<100&&(i.year<this.getNullYear()?i.year+=2e3:i.year+=1900),!this.isValidDate(i))))return i}parseDateTimeFromFormats(e,r,n){const i=r.length===0?[void 0]:r,o=n.length===0?[void 0]:n;for(const a of i)for(const s of o){const l=this.parseSingleFormat(e,a,s);if(l!==void 0)return{dateTime:l,timeFormat:s,dateFormat:a}}return{}}countLeapDays(e){return e.month>2||e.month===2&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+Ff[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return e%4?!1:e%100?!0:e%400?e===1900&&this.config.leapYear1900:!0}}function Plt(t){let e=0;return Ff[e+6]<=t&&(e+=6),Ff[e+3]<=t&&(e+=3),Ff[e+2]<=t?e+=2:Ff[e+1]<=t&&(e+=1),e}function KV(t,e){const r=12*t.year+t.month-1+e;return{year:Math.floor(r/12),month:r%12+1,day:t.day}}function klt(t){return{year:t.year,month:t.month,day:Math.min(t.day,UA[t.month-1])}}function ZC(t){return Math.round(t*3600*24)/(3600*24)}function $lt(t,e=1){return Math.round(t*e)/e}function nh(t){const e=t*VA*db*hb,r=$lt(e%hb,1e5)%hb,n=(e-r)/hb,i=Math.round(n%db)%db,o=(n-i)/db;return{hours:Math.round(o),minutes:i,seconds:r}}function ih(t){return((t.seconds/60+t.minutes)/60+t.hours)/24}function qV(t){return{year:t.year,month:t.month,day:Math.min(30,t.day)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Llt{call(){return llt}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const XV=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,QV=/(\\.|[#0]+(\.[#0]*)?)/g;var ia;(function(t){t.FORMAT="FORMAT",t.FREE_TEXT="FREE_TEXT"})(ia||(ia={}));function pb(t,e){return{type:t,value:e}}var bS;(function(t){t.DATE="DATE",t.NUMBER="NUMBER",t.STRING="STRING"})(bS||(bS={}));function Dlt(t){XV.lastIndex=0;const e=[];let r;do r=XV.exec(t),r!==null&&e.push(r);while(r);return e}function Flt(t){QV.lastIndex=0;const e=QV.exec(t);return e!==null?[e]:[]}function qee(t,e){const r=[];let n=0;for(let o=0;o<t.length;++o){const a=t[o];if(a.index!==n){const s=e.substr(n,a.index-n);r.push(pb(ia.FREE_TEXT,s))}a[0].startsWith("\\")?r.push(pb(ia.FREE_TEXT,a[0])):r.push(pb(ia.FORMAT,a[0])),n=a.index+a[0].length}const i=t[t.length-1];if(i.index+i[0].length<e.length){const o=e.substr(i.index+i[0].length,e.length);r.push(pb(ia.FREE_TEXT,o))}return r}function Xee(t){const e=Dlt(t);if(!e.every(r=>Qee(r)))return{type:bS.DATE,tokens:qee(e,t)}}function Hlt(t){const e=Flt(t);if(!e.every(r=>Qee(r)))return{type:bS.NUMBER,tokens:qee(e,t)}}function Qee(t){return t[0].startsWith("\\")}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Blt(t,e,r,n){const i=r.stringifyDateTime(n.numberToSimpleDateTime(t),e);if(i!==void 0)return i;const o=r.stringifyDuration(nh(t),e);if(o!==void 0)return o;const a=Hlt(e);return a!==void 0?Vlt(a.tokens,t):e}function ci(t,e){let r=t+"";for(;r.length<e;)r="0"+r;return r}function Ult(t,e){let r=t+"";for(;r.length<e;)r=r+"0";return r}function ZV(t,e){return t.split(e).length-1}function Vlt(t,e){let r="";for(let n=0;n<t.length;++n){const i=t[n];if(i.type===ia.FREE_TEXT){r+=i.value;continue}const o=i.value.split("."),a=o[0],s=o[1]||"",l=o[1]?".":"",u=Number(e.toFixed(s.length)).toString().split(".");let c=u[0]||"",f=u[1]||"";if(a.length>c.length){const d=ZV(a.substr(0,a.length-c.length),"0");c=ci(c,d+c.length)}const h=ZV(s.substr(f.length,s.length-f.length),"0");f=Ult(f,h+f.length),r+=c+l+f}return r}function jlt(t,e){const r=Xee(e);if(r===void 0)return;const n=r.tokens;let i="";for(const o of n){if(o.type===ia.FREE_TEXT){i+=o.value;continue}switch(o.value.toLowerCase()){case"h":case"hh":{i+=ci(t.hours,o.value.length),t.hours=0;break}case"[hh]":{i+=ci(t.hours,o.value.length-2),t.hours=0;break}case"m":case"mm":{i+=ci(t.minutes,o.value.length),t.minutes=0;break}case"[mm]":{i+=ci(t.minutes+60*t.hours,o.value.length-2),t.minutes=0,t.hours=0;break}case"s":case"ss":{i+=ci(Math.floor(t.seconds),o.value.length);break}default:{if(zI.test(o.value)){const a=Math.max(o.value.length-3,0);i+=(t.seconds<10?"0":"")+Math.floor(t.seconds*Math.pow(10,a))/Math.pow(10,a);continue}return}}}return i}function Wlt(t,e){const r=Xee(e);if(r===void 0)return;const n=r.tokens;let i="",o=!1;const a=n.some(s=>s.type===ia.FORMAT&&(s.value==="a/p"||s.value==="A/P"||s.value==="am/pm"||s.value==="AM/PM"));for(let s=0;s<n.length;s++){const l=n[s];if(l.type===ia.FREE_TEXT){i+=l.value;continue}switch(l.value.toLowerCase()){case"h":case"hh":{o=!0,i+=ci(a?(t.hours+11)%12+1:t.hours,l.value.length);break}case"d":case"dd":{i+=ci(t.day,l.value.length);break}case"s":case"ss":{i+=ci(Math.floor(t.seconds),l.value.length);break}case"m":case"mm":{s+1<n.length&&n[s+1].value.startsWith(":")&&(o=!0),o?i+=ci(t.minutes,l.value.length):i+=ci(t.month,l.value.length),o=!0;break}case"yy":{i+=ci(t.year%100,l.value.length);break}case"yyyy":{i+=t.year;break}case"am/pm":case"a/p":{const[u,c]=l.value.split("/");i+=t.hours<12?u:c;break}default:{if(zI.test(l.value)){const u=l.value.length-3;i+=(t.seconds<10?"0":"")+Math.floor(t.seconds*Math.pow(10,u))/Math.pow(10,u);continue}return}}}return i}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const jA="length",yg=t=>parseInt(t,16),JV=t=>parseInt(t,10),JC=t=>(t+"").replace(/\-/g,""),wS=(t,e,r)=>t.substr(e,r),vo=t=>t.codePointAt(0)-65;function zlt(t){return JC(t)[jA]===25?yg(wS(JC(t),yg("12"),vo("F")))/(yg(wS(JC(t),vo("C"),vo("Y")>>4))||(~~![][jA]<<3)+1):0}function Glt(t){if(t=(t+"").replace(/\-/g,""),t[jA]!==vo("Z"))return!1;let e=0;return[[0,vo("G")+1],[vo("H"),vo("H")-1],[vo("G")+vo("H"),vo("G")]].reduce((r,[n,i],o)=>(r|=(JV(`${JV(yg(wS(t,e+n-(o===0?0:2),i+(o?2:0)))+(yg(wS(t,e+n+i,2))+[]).padStart(2,"0"))}`)%97||2)>>1,e+=2,r),vo("A"))===[]+1>>1}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Ylt={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:t})=>`The license key for HyperFormula expired on ${t}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let ej=!1;function Klt(t){const e={template:"missing",vars:{}};if(t==="gpl-v3"||t==="internal-use-in-handsontable")e.template="valid";else if(typeof t=="string"&&Glt(t)){const[r,n,i]="03/03/2023".split("/"),o=Math.floor(new Date(`${n}/${r}/${i}`).getTime()/864e5),a=zlt(t);e.vars.keyValidityDate=qlt(new Date((a+1)*864e5)),o>a?e.template="expired":e.template="valid"}else t!==""&&(e.template="invalid");return!ej&&e.template!=="valid"&&(console.warn(Ylt[e.template](e.vars)),ej=!0),e.template}function qlt(t){const r=["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()],n=t.getDate(),i=t.getFullYear();return`${r} ${n}, ${i}`}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var hr;(function(t){class e{constructor(l){this.value=l,this.value=HI(this.value,zee(Ne(this.value)))}}t.Number=e;class r{constructor(l){this.value=l}}t.String=r;class n{constructor(l){this.value=l}}t.Boolean=n;class i{static getSingletonInstance(){return i.instance||(i.instance=new i),i.instance}}t.Empty=i;class o{constructor(l){this.formula=l}}t.Formula=o;class a{constructor(l,u){this.value=new x(l,u)}}t.Error=a})(hr||(hr={}));function Xlt(t){return t.startsWith("=")}function Qlt(t){const e=t.toLowerCase();return e==="true"||e==="false"}function Zlt(t,e){const r=t.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(r)&&Object.prototype.hasOwnProperty.call(e,r)}class Jlt{constructor(e,r,n){this.config=e,this.dateHelper=r,this.numberLiteralsHelper=n}parse(e){if(e==null)return hr.Empty.getSingletonInstance();if(typeof e=="number")return Wee(e)?new hr.Error($.NUM,W.ValueLarge):new hr.Number(e);if(typeof e=="boolean")return new hr.Boolean(e);if(e instanceof Date){const r=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),n=ih({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3}),i=r+n;return i<0?new hr.Error($.NUM,W.DateBounds):i%1===0?new hr.Number(new BI(i,"Date()")):i<1?new hr.Number(new UI(i,"Date()")):new hr.Number(new VI(i,"Date()"))}else if(typeof e=="string"){if(Qlt(e))return new hr.Boolean(e.toLowerCase()==="true");if(Xlt(e))return new hr.Formula(e);if(Zlt(e,this.config.errorMapping))return new hr.Error(this.config.errorMapping[e.toUpperCase()]);{let r=e.trim(),n=0,i;if(r.endsWith("%"))n=1,r=r.slice(0,r.length-1);else{const s=this.currencyMatcher(r);s!==void 0&&(n=2,[i,r]=s)}const o=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(o!==void 0){let s;return n===1?s=new A2(o/100):n===2?s=new kA(o,i):s=o,new hr.Number(s)}const a=this.dateHelper.dateStringToDateNumber(r);return a!==void 0?new hr.Number(a):new hr.String(e.startsWith("'")?e.slice(1):e)}}else throw new Nee(e)}currencyMatcher(e){for(const r of this.config.currencySymbol){if(e.startsWith(r))return[r,e.slice(r.length)];if(e.endsWith(r))return[r,e.slice(0,e.length-r.length)]}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var tu;(function(t){t[t.COPY=0]="COPY",t[t.CUT=1]="CUT"})(tu||(tu={}));var Tn;(function(t){t[t.VALUE=0]="VALUE",t[t.EMPTY=1]="EMPTY",t[t.FORMULA=2]="FORMULA",t[t.PARSING_ERROR=3]="PARSING_ERROR"})(Tn||(Tn={}));class tj{constructor(e,r,n,i,o){this.sourceLeftCorner=e,this.width=r,this.height=n,this.type=i,this.content=o}*getContent(e){if(this.content!==void 0)for(let r=0;r<this.height;++r)for(let n=0;n<this.width;++n)yield[Le(e.sheet,e.col+n,e.row+r),this.content[r][n]]}}class eut{constructor(e,r,n){this.dependencyGraph=r,this.operations=n,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,r,n){this.clipboard=new tj(e,r,n,tu.CUT)}copy(e,r,n){const i=[];for(let o=0;o<n;++o){i[o]=[];for(let a=0;a<r;++a){const s=this.operations.getClipboardCell(Le(e.sheet,e.col+a,e.row+o));i[o].push(s)}}this.clipboard=new tj(e,r,n,tu.COPY,i)}abortCut(){this.clipboard&&this.clipboard.type===tu.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(this.clipboard===void 0)return;if(hi(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new Qr("a valid target address.");const r=ze.spanFrom(e,this.clipboard.width,this.clipboard.height);if(r.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Bu;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(r))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return this.clipboard!==void 0&&this.clipboard.type===tu.CUT}isCopyClipboard(){return this.clipboard!==void 0&&this.clipboard.type===tu.COPY}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class SS{constructor(e,r,n,i){this.displayName=e,this.address=r,this.added=n,this.options=i}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new SS(this.displayName,this.address,this.added,this.options)}}class tut{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const r=this.normalizeExpressionName(e),n=this.mapping.get(r);return!(n&&n.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const r=this.mapping.get(this.normalizeExpressionName(e));if(r&&r.added)return r}remove(e){const r=this.normalizeExpressionName(e),n=this.mapping.get(r);n&&(n.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class rj{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){const r=this.normalizeExpressionName(e);return!this.mapping.has(r)}remove(e){const r=this.normalizeExpressionName(e);this.mapping.get(r)&&this.mapping.delete(r)}normalizeExpressionName(e){return e.toLowerCase()}}class sc{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new tut,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,r){var n,i;return r===void 0?this.workbookStore.isNameAvailable(e):(i=(n=this.worksheetStore(r))===null||n===void 0?void 0:n.isNameAvailable(e))!==null&&i!==void 0?i:!0}namedExpressionInAddress(e){const r=this.addressCache.get(e);if(r&&r.added)return r}namedExpressionForScope(e,r){var n;return r===void 0?this.workbookStore.getExisting(e):(n=this.worksheetStore(r))===null||n===void 0?void 0:n.get(e)}nearestNamedExpression(e,r){var n,i;return(i=(n=this.worksheetStore(r))===null||n===void 0?void 0:n.get(e))!==null&&i!==void 0?i:this.workbookStore.getExisting(e)}isExpressionInScope(e,r){var n,i;return(i=(n=this.worksheetStore(r))===null||n===void 0?void 0:n.has(e))!==null&&i!==void 0?i:!1}isNameValid(e){const r=new RegExp(`^${pJ}$`),n=new RegExp(`^${mJ}$`),i=new RegExp(`^${gJ}$`);return r.test(e)||n.test(e)?!1:i.test(e)}addNamedExpression(e,r,n){const i=r===void 0?this.workbookStore:this.worksheetStoreOrCreate(r);let o=i.get(e);return o!==void 0?(o.added=!0,o.displayName=e,o.options=n):(o=new SS(e,this.nextAddress(),!0,n),i.add(o)),this.addressCache.set(o.address.row,o),o}restoreNamedExpression(e,r){const n=r===void 0?this.workbookStore:this.worksheetStoreOrCreate(r);return e.added=!0,n.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,r){var n;return(n=this.worksheetStoreOrCreate(r).get(e))!==null&&n!==void 0?n:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let r=this.workbookStore.get(e);return r===void 0&&(r=new SS(e,this.nextAddress(),!1),this.workbookStore.add(r)),r}remove(e,r){let n;r===void 0?n=this.workbookStore:n=this.worksheetStore(r);const i=n==null?void 0:n.get(e);if(n===void 0||i===void 0||!i.added)throw"Named expression does not exist";n.remove(e),n instanceof rj&&n.mapping.size===0&&this.worksheetStores.delete(r),this.addressCache.delete(i.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter(({scope:r})=>r===e).map(r=>r.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach(r=>{e.push({expression:r,scope:void 0})}),this.worksheetStores.forEach((r,n)=>{r.getAllNamedExpressions().forEach(i=>{e.push({expression:i,scope:n})})}),e}getAllNamedExpressionsForScope(e){var r,n;return e===void 0?this.workbookStore.getAllNamedExpressions():(n=(r=this.worksheetStores.get(e))===null||r===void 0?void 0:r.getAllNamedExpressions())!==null&&n!==void 0?n:[]}worksheetStoreOrCreate(e){let r=this.worksheetStores.get(e);return r||(r=new rj,this.worksheetStores.set(e,r)),r}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return Le(sc.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}sc.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const Us=t=>{switch(t.type){case F.EMPTY:case F.NUMBER:case F.STRING:case F.ERROR:case F.ERROR_WITH_RAW_INPUT:return!1;case F.CELL_REFERENCE:return!t.reference.isAbsolute();case F.CELL_RANGE:case F.COLUMN_RANGE:case F.ROW_RANGE:return!t.start.isAbsolute();case F.NAMED_EXPRESSION:return!1;case F.PERCENT_OP:case F.PLUS_UNARY_OP:case F.MINUS_UNARY_OP:return Us(t.value);case F.CONCATENATE_OP:case F.EQUALS_OP:case F.NOT_EQUAL_OP:case F.LESS_THAN_OP:case F.GREATER_THAN_OP:case F.LESS_THAN_OR_EQUAL_OP:case F.GREATER_THAN_OR_EQUAL_OP:case F.MINUS_OP:case F.PLUS_OP:case F.TIMES_OP:case F.DIV_OP:case F.POWER_OP:return Us(t.left)||Us(t.right);case F.PARENTHESIS:return Us(t.expression);case F.FUNCTION_CALL:return t.args.some(e=>Us(e));case F.ARRAY:return t.args.some(e=>e.some(r=>Us(r)))}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Al{performEagerTransformations(e,r){for(const n of e.arrayFormulaNodes()){const[i,o]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService)),a=r.rememberNewAst(i);n.setFormula(a),n.setAddress(o)}}transformSingleAst(e,r){const n=this.transformAst(e,r),i=this.fixNodeAddress(r);return[n,i]}transformAst(e,r){switch(e.type){case F.CELL_REFERENCE:return this.transformCellReferenceAst(e,r);case F.CELL_RANGE:return this.transformCellRangeAst(e,r);case F.COLUMN_RANGE:return this.transformColumnRangeAst(e,r);case F.ROW_RANGE:return this.transformRowRangeAst(e,r);case F.EMPTY:case F.ERROR:case F.NUMBER:case F.NAMED_EXPRESSION:case F.ERROR_WITH_RAW_INPUT:case F.STRING:return e;case F.PERCENT_OP:case F.MINUS_UNARY_OP:case F.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,r)});case F.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(n=>this.transformAst(n,r))});case F.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,r)});case F.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(n=>n.map(i=>this.transformAst(i,r)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,r),right:this.transformAst(e.right,r)})}}transformCellReferenceAst(e,r){const n=this.transformCellAddress(e.reference,r);return n instanceof Kt?Object.assign(Object.assign({},e),{reference:n}):n===$.REF?Jo(new x($.REF)):e}transformCellRangeAst(e,r){const n=this.transformCellRange(e.start,e.end,r);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===$.REF?Jo(new x($.REF)):e}transformColumnRangeAst(e,r){const n=this.transformColumnRange(e.start,e.end,r);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===$.REF?Jo(new x($.REF)):e}transformRowRangeAst(e,r){const n=this.transformRowRange(e.start,e.end,r);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===$.REF?Jo(new x($.REF)):e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class rut extends Al{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,r){return e}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){throw Error("Not implemented")}transformColumnRange(e,r,n){return this.transformRange(e,r,n)}transformCellAddress(e,r){const n=xo(e,r);if(n!==this.columnsSpan.sheet&&r.sheet!==this.columnsSpan.sheet)return!1;const i=e.toSimpleColumnAddress(r);return n===this.columnsSpan.sheet&&r.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=i.col?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1:r.sheet===this.columnsSpan.sheet&&n!==this.columnsSpan.sheet?e.isColumnAbsolute()||r.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?e.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(r).col<this.columnsSpan.columnStart?r.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):r.col<this.columnsSpan.columnStart?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,r,n){const i=this.transformCellAddress(e,n),o=this.transformCellAddress(r,n);return i===$.REF||o===$.REF?$.REF:i||o?[i||e,o||r]:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class WA extends Al{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,r){return e}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){return this.transformRange(e,r,n)}transformColumnRange(e,r,n){throw Error("Not implemented")}transformCellAddress(e,r){const n=xo(e,r);if(n!==this.rowsSpan.sheet&&r.sheet!==this.rowsSpan.sheet)return!1;const i=e.toSimpleRowAddress(r);return n===this.rowsSpan.sheet&&r.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=i.row?e.shiftedByRows(this.rowsSpan.numberOfRows):!1:r.sheet===this.rowsSpan.sheet&&n!==this.rowsSpan.sheet?e.isRowAbsolute()||r.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?e.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(this.rowsSpan.numberOfRows):i.row<this.rowsSpan.rowStart?r.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):r.row<this.rowsSpan.rowStart?e.shiftedByRows(this.rowsSpan.numberOfRows):!1}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,r,n){const i=this.transformCellAddress(e,n),o=this.transformCellAddress(r,n);return i===$.REF||o===$.REF?$.REF:i||o?[i||e,o||r]:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class nut extends Al{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,r){return e.isInvalid(r)?$.REF:!1}transformCellRange(e,r,n){return e.isInvalid(n)||r.isInvalid(n)?$.REF:!1}transformColumnRange(e,r,n){return e.isInvalid(n)||r.isInvalid(n)?$.REF:!1}transformRowRange(e,r,n){return e.isInvalid(n)||r.isInvalid(n)?$.REF:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class iut extends Al{constructor(e,r,n,i){super(),this.sourceRange=e,this.toRight=r,this.toBottom=n,this.toSheet=i,this.dependentFormulaTransformer=new out(e,r,n,i)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,r){return this.sourceRange.addressInRange(r)?[this.transformAst(e,r),this.fixNodeAddress(r)]:this.dependentFormulaTransformer.transformSingleAst(e,r)}fixNodeAddress(e){return Le(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,r){return this.transformAddress(e,r)}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformColumnRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){return this.transformRange(e,r,n)}transformAddress(e,r){const n=this.sourceRange;if(e instanceof Kt){const i=e.toSimpleCellAddress(r);if(n.addressInRange(i))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,r,n){const i=this.sourceRange;if(e instanceof Kt&&r instanceof Kt){const o=e.toSimpleCellAddress(n),a=r.toSimpleCellAddress(n);if(i.addressInRange(o)&&i.addressInRange(a))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),r.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),r.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class out extends Al{constructor(e,r,n,i){super(),this.sourceRange=e,this.toRight=r,this.toBottom=n,this.toSheet=i}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,r){return this.shouldMove(e,r)?e.moved(this.toSheet,this.toRight,this.toBottom):!1}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformColumnRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){return this.transformRange(e,r,n)}shouldMove(e,r){return e instanceof Kt?this.sourceRange.addressInRange(e.toSimpleCellAddress(r)):e instanceof Ln?this.sourceRange.rowInRange(e.toSimpleRowAddress(r))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(r))&&!this.sourceRange.isFinite()}transformRange(e,r,n){const i=this.transformCellAddress(e,n),o=this.transformCellAddress(r,n);return i&&o?[i,o]:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class aut extends Al{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,r){return e}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){throw Error("Not implemented")}transformColumnRange(e,r,n){return this.transformRange(e,r,n)}transformCellAddress(e,r){const n=xo(e,r);if(this.columnsSpan.sheet!==r.sheet&&this.columnsSpan.sheet!==n)return!1;if(this.columnsSpan.sheet!==r.sheet&&this.columnsSpan.sheet===n){const i=e.toSimpleColumnAddress(r);if(i.col<this.columnsSpan.columnStart)return!1;if(i.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===r.sheet&&this.columnsSpan.sheet!==n){if(e.isColumnAbsolute())return!1;if(r.col<this.columnsSpan.columnStart)return!1;if(r.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===r.sheet&&this.columnsSpan.sheet===n)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const i=e.toSimpleColumnAddress(r);if(i.col<this.columnsSpan.columnStart){if(r.col<this.columnsSpan.columnStart)return!1;if(r.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(i.col>this.columnsSpan.columnEnd){if(r.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(r.col>this.columnsSpan.columnEnd)return!1}}return $.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,r,n){const i=xo(e,n);let o=e,a=r;if(this.columnsSpan.sheet===i){const u=e.toSimpleColumnAddress(n),c=r.toSimpleColumnAddress(n);if(this.columnsSpan.columnStart<=u.col&&this.columnsSpan.columnEnd>=c.col)return $.REF;u.col>=this.columnsSpan.columnStart&&u.col<=this.columnsSpan.columnEnd&&(o=e.shiftedByColumns(this.columnsSpan.columnEnd-u.col+1)),c.col>=this.columnsSpan.columnStart&&c.col<=this.columnsSpan.columnEnd&&(a=r.shiftedByColumns(-(c.col-this.columnsSpan.columnStart+1)))}const s=this.transformCellAddress(o,n),l=this.transformCellAddress(a,n);if(s===!1&&l===!1)return[o,a];if(s===$.REF||l===$.REF)throw Error("Cannot happen");return[s||o,l||a]}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class zA extends Al{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,r){return e}transformCellAddress(e,r){const n=xo(e,r);if(this.rowsSpan.sheet!==r.sheet&&this.rowsSpan.sheet!==n)return!1;if(this.rowsSpan.sheet!==r.sheet&&this.rowsSpan.sheet===n){const i=e.toSimpleRowAddress(r);if(i.row<this.rowsSpan.rowStart)return!1;if(i.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===r.sheet&&this.rowsSpan.sheet!==n){if(e.isRowAbsolute())return!1;if(r.row<this.rowsSpan.rowStart)return!1;if(r.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===r.sheet&&this.rowsSpan.sheet===n)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const i=e.toSimpleRowAddress(r);if(i.row<this.rowsSpan.rowStart){if(r.row<this.rowsSpan.rowStart)return!1;if(r.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(i.row>this.rowsSpan.rowEnd){if(r.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(r.row>this.rowsSpan.rowEnd)return!1}}return $.REF}transformCellRange(e,r,n){return this.transformRange(e,r,n)}transformRowRange(e,r,n){return this.transformRange(e,r,n)}transformColumnRange(e,r,n){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,r,n){const i=xo(e,n);let o=e,a=r;if(this.rowsSpan.sheet===i){const u=e.toSimpleRowAddress(n),c=r.toSimpleRowAddress(n);if(this.rowsSpan.rowStart<=u.row&&this.rowsSpan.rowEnd>=c.row)return $.REF;u.row>=this.rowsSpan.rowStart&&u.row<=this.rowsSpan.rowEnd&&(o=e.shiftedByRows(this.rowsSpan.rowEnd-u.row+1)),c.row>=this.rowsSpan.rowStart&&c.row<=this.rowsSpan.rowEnd&&(a=r.shiftedByRows(-(c.row-this.rowsSpan.rowStart+1)))}const s=this.transformCellAddress(o,n),l=this.transformCellAddress(a,n);return s===!1&&l===!1?[o,a]:s===$.REF||l===$.REF?$.REF:[s||o,l||a]}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class sut extends Al{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,r){for(const n of e.arrayFormulaNodes()){const[i]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService));n.setFormula(i)}}fixNodeAddress(e){return e}transformCellAddress(e,r){return this.transformAddress(e)}transformCellRange(e,r,n){return this.transformAddress(e)}transformColumnRange(e,r,n){return this.transformAddress(e)}transformRowRange(e,r,n){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet?$.REF:!1}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Zee(t){if(!Array.isArray(t))throw new Qr("an array of arrays.");for(let e=0;e<t.length;e++)if(!Array.isArray(t[e]))throw new Qr("an array of arrays.")}function RS(t){let e=0,r=0,n=0;for(let o=0;o<t.length;o++){let a=0;for(let s=0;s<t[o].length;s++){const l=t[o][s];l!=null&&(a=s+1,++n)}e=Math.max(e,a),a>0&&(r=o+1)}const i=e*r;return{height:r,width:e,fill:i===0?0:n/i}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Jee{constructor(e,r){this.sheet=e,this.indexes=r}normalizedIndexes(){return ES(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>pi.fromNumberOfRows(this.sheet,e[0],e[1]))}}class ete{constructor(e,r){this.sheet=e,this.indexes=r}normalizedIndexes(){return CS(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>pi.fromNumberOfRows(this.sheet,e[0],e[1]))}}class tte{constructor(e,r){this.sheet=e,this.indexes=r}normalizedIndexes(){return CS(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>Mi.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class rte{constructor(e,r){this.sheet=e,this.indexes=r}normalizedIndexes(){return ES(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>Mi.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class lut{constructor(e,r,n,i,o,a,s,l,u){this.dependencyGraph=r,this.columnSearch=n,this.cellContentParser=i,this.parser=o,this.stats=a,this.lazilyTransformingAstService=s,this.namedExpressions=l,this.arraySizePredictor=u,this.changes=cl.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const r=[];for(const n of e.rowsSpans()){const i=this.doRemoveRows(n);i&&r.push(i)}return r}addRows(e){for(const r of e.rowsSpans())this.doAddRows(r)}addColumns(e){for(const r of e.columnsSpans())this.doAddColumns(r)}removeColumns(e){const r=[];for(const n of e.columnsSpans()){const i=this.doRemoveColumns(n);i&&r.push(i)}return r}removeSheet(e){this.dependencyGraph.removeSheet(e);let r;this.stats.measure(ot.TRANSFORM_ASTS,()=>{const i=new sut(e);i.performEagerTransformations(this.dependencyGraph,this.parser),r=this.lazilyTransformingAstService.addTransformation(i)}),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const n=this.namedExpressions.getAllNamedExpressionsForScope(e).map(i=>this.removeNamedExpression(i.normalizeExpressionName(),e));return{version:r,scopedNamedExpressions:n}}removeSheetByName(e){const r=this.sheetMapping.fetch(e);return this.removeSheet(r)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const r=this.sheetMapping.addSheet(e),n=[];return this.dependencyGraph.addressMapping.autoAddSheet(r,n,RS(n)),this.sheetMapping.fetchDisplayName(r)}renameSheet(e,r){return this.sheetMapping.renameSheet(e,r)}moveRows(e,r,n,i){const o=pi.fromNumberOfRows(e,i,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(o),i<r&&(r+=n);const a=Le(e,0,r),s=Le(e,0,i);this.moveCells(a,Number.POSITIVE_INFINITY,n,s);const l=pi.fromNumberOfRows(e,r,n);return this.doRemoveRows(l),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,r,n,i){const o=Mi.fromNumberOfColumns(e,i,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(o),i<r&&(r+=n);const a=Le(e,r,0),s=Le(e,i,0);this.moveCells(a,n,Number.POSITIVE_INFINITY,s);const l=Mi.fromNumberOfColumns(e,r,n);return this.doRemoveColumns(l),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,r,n,i){this.ensureItIsPossibleToMoveCells(e,r,n,i);const o=ze.spanFrom(e,r,n),a=ze.spanFrom(i,r,n),s=i.col-e.col,l=i.row-e.row,u=i.sheet,c=this.getRangeClipboardCells(a),f=this.dependencyGraph.rawValuesFromRange(a);this.columnSearch.removeValues(f);const h=this.dependencyGraph.rawValuesFromRange(o);this.columnSearch.moveValues(h,s,l,u);let d;this.stats.measure(ot.TRANSFORM_ASTS,()=>{const m=new iut(o,s,l,u);m.performEagerTransformations(this.dependencyGraph,this.parser),d=this.lazilyTransformingAstService.addTransformation(m)}),this.dependencyGraph.moveCells(o,s,l,u);const p=this.updateNamedExpressionsForMovedCells(e,r,n,i);return{version:d,overwrittenCellsData:c,addedGlobalNamedExpressions:p}}setRowOrder(e,r){const n=[];let i=[];for(const[o,a]of r)if(o!==a){const s=ze.spanFrom({sheet:e,col:0,row:o},1/0,1),l=this.getRangeClipboardCells(s);i=i.concat(l),n.push(l.map(([{sheet:u,col:c},f])=>[{sheet:u,col:c,row:a},f]))}return n.forEach(o=>this.restoreClipboardCells(e,o.values())),i}setColumnOrder(e,r){const n=[];let i=[];for(const[o,a]of r)if(o!==a){const s=ze.spanFrom({sheet:e,col:o,row:0},1,1/0),l=this.getRangeClipboardCells(s);i=i.concat(l),n.push(l.map(([{sheet:u,col:c,row:f},h])=>[{sheet:u,col:a,row:f},h]))}return n.forEach(o=>this.restoreClipboardCells(e,o.values())),i}addNamedExpression(e,r,n,i){const o=this.namedExpressions.addNamedExpression(e,n,i);this.storeNamedExpressionInCell(o.address,r),this.adjustNamedExpressionEdges(o,e,n)}restoreNamedExpression(e,r,n){const i=e.displayName;this.restoreCell(e.address,r);const o=this.namedExpressions.restoreNamedExpression(e,n);this.adjustNamedExpressionEdges(o,i,n)}changeNamedExpressionExpression(e,r,n,i){const o=this.namedExpressions.namedExpressionForScope(e,n);if(!o)throw new Dv(e);const a=o.copy();o.options=i;const s=this.getClipboardCell(o.address);return this.storeNamedExpressionInCell(o.address,r),[a,s]}removeNamedExpression(e,r){const n=this.namedExpressions.namedExpressionForScope(e,r);if(!n)throw new Dv(e);this.namedExpressions.remove(n.displayName,r);const i=this.getClipboardCell(n.address);if(r!==void 0){const o=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(n.address,o.address)}else this.dependencyGraph.setCellEmpty(n.address);return[n,i]}ensureItIsPossibleToMoveCells(e,r,n,i){if(hi(e)||!(_S(r)&&_S(n)||uut(e,r,n))||hi(i)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(i.sheet))throw new Qr("a valid range of cells to move.");const o=ze.spanFrom(e,r,n),a=ze.spanFrom(i,r,n);if(a.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Bu;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new Df;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new gS}restoreClipboardCells(e,r){const n=[];for(const[i,o]of r)if(this.restoreCell(i,o),o.type===Tn.FORMULA){const{dependencies:a}=this.parser.fetchCachedResult(o.hash);n.push(...this.updateNamedExpressionsForTargetAddress(e,i,a))}return n}restoreCell(e,r){switch(r.type){case Tn.VALUE:{this.setValueToCell(r,e);break}case Tn.FORMULA:{this.setFormulaToCellFromCache(r.hash,e);break}case Tn.EMPTY:{this.setCellEmpty(e);break}case Tn.PARSING_ERROR:{this.setParsingErrorToCell(r.rawInput,r.errors,e);break}}}getOldContent(e){const r=this.dependencyGraph.getCell(e);if(r===void 0||r instanceof Ba)return[e,{type:Tn.EMPTY}];if(r instanceof fl)return[e,Object.assign({type:Tn.VALUE},r.getValues())];if(r instanceof Ni)return[r.getAddress(this.lazilyTransformingAstService),{type:Tn.FORMULA,hash:this.parser.computeHashFromAst(r.getFormula(this.lazilyTransformingAstService))}];if(r instanceof rh)return[e,{type:Tn.PARSING_ERROR,rawInput:r.rawInput,errors:r.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const r=this.dependencyGraph.getCell(e);if(r===void 0||r instanceof Ba)return{type:Tn.EMPTY};if(r instanceof fl)return Object.assign({type:Tn.VALUE},r.getValues());if(r instanceof Ir){const n=r.getArrayCellValue(e);return n===_t?{type:Tn.EMPTY}:{type:Tn.VALUE,parsedValue:n,rawValue:r.getArrayCellRawValue(e)}}else{if(r instanceof hs)return{type:Tn.FORMULA,hash:this.parser.computeHashFromAst(r.getFormula(this.lazilyTransformingAstService))};if(r instanceof rh)return{type:Tn.PARSING_ERROR,rawInput:r.rawInput,errors:r.errors}}throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const r=this.dependencyGraph.getSheetHeight(e),n=this.dependencyGraph.getSheetWidth(e),i=new Array(r);for(let o=0;o<r;o++){i[o]=new Array(n);for(let a=0;a<n;a++){const s=Le(e,a,o);i[o][a]=this.getClipboardCell(s)}}return i}getRangeClipboardCells(e){const r=[];for(const n of e.addresses(this.dependencyGraph))r.push([n,this.getClipboardCell(n)]);return r}setCellContent(e,r){const n=this.cellContentParser.parse(r),i=this.getOldContent(e);if(n instanceof hr.Formula){const o=this.parser.parse(n.formula,e),{ast:a,errors:s}=o;if(s.length>0)this.setParsingErrorToCell(n.formula,s,e);else{const l=this.arraySizePredictor.checkArraySize(a,e);this.setFormulaToCell(e,l,o)}}else n instanceof hr.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:r},e);return i}setSheetContent(e,r){this.clearSheet(e);for(let n=0;n<r.length;n++)for(let i=0;i<r[n].length;i++){const o=Le(e,i,n);this.setCellContent(o,r[n][i])}}setParsingErrorToCell(e,r,n){const i=this.dependencyGraph.getCellValue(n),o=new rh(r,e),a=this.dependencyGraph.setParsingErrorToCell(n,o);this.columnSearch.remove(Ne(i),n),this.columnSearch.applyChanges(a.getChanges()),this.changes.addAll(a),this.changes.addChange(o.getCellValue(),n)}setFormulaToCell(e,r,{ast:n,hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:a}){const s=this.dependencyGraph.getCellValue(e),l=this.dependencyGraph.setFormulaToCell(e,n,ea(a,e),r,i,o);this.columnSearch.remove(Ne(s),e),this.columnSearch.applyChanges(l.getChanges()),this.changes.addAll(l)}setValueToCell(e,r){const n=this.dependencyGraph.getCellValue(r),i=this.dependencyGraph.setValueToCell(r,e);this.columnSearch.change(Ne(n),Ne(e.parsedValue),r),this.columnSearch.applyChanges(i.getChanges().filter(o=>!Hv(o.address,r))),this.changes.addAll(i),this.changes.addChange(e.parsedValue,r)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const r=this.dependencyGraph.getCellValue(e),n=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(Ne(r),e),this.columnSearch.applyChanges(n.getChanges()),this.changes.addAll(n),this.changes.addChange(_t,e)}setFormulaToCellFromCache(e,r){const{ast:n,hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:a}=this.parser.fetchCachedResult(e),s=ea(a,r),[l]=new nut(r.sheet).transformSingleAst(n,r);this.parser.rememberNewAst(l);const u=jst(s),c=this.arraySizePredictor.checkArraySize(n,r);this.dependencyGraph.setFormulaToCell(r,l,u,c,i,o)}rowEffectivelyNotInSheet(e,r){const n=this.dependencyGraph.addressMapping.getHeight(r);return e>=n}getAndClearContentChanges(){const e=this.changes;return this.changes=cl.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const r=[];for(const[a]of this.dependencyGraph.entriesFromRowsSpan(e))r.push({address:a,cellType:this.getClipboardCell(a)});const{affectedArrays:n,contentChanges:i}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(i.getChanges());let o;return this.stats.measure(ot.TRANSFORM_ASTS,()=>{const a=new zA(e);a.performEagerTransformations(this.dependencyGraph,this.parser),o=this.lazilyTransformingAstService.addTransformation(a)}),this.rewriteAffectedArrays(n),{version:o,removedCells:r,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const r=[];for(const[a]of this.dependencyGraph.entriesFromColumnsSpan(e))r.push({address:a,cellType:this.getClipboardCell(a)});const{affectedArrays:n,contentChanges:i}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(i.getChanges()),this.columnSearch.removeColumns(e);let o;return this.stats.measure(ot.TRANSFORM_ASTS,()=>{const a=new aut(e);a.performEagerTransformations(this.dependencyGraph,this.parser),o=this.lazilyTransformingAstService.addTransformation(a)}),this.rewriteAffectedArrays(n),{version:o,removedCells:r,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:r}=this.dependencyGraph.addRows(e);this.stats.measure(ot.TRANSFORM_ASTS,()=>{const n=new WA(e);n.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(n)}),this.rewriteAffectedArrays(r)}rewriteAffectedArrays(e){for(const r of e.values()){if(r.array.size.isRef)continue;const n=r.getFormula(this.lazilyTransformingAstService),i=r.getAddress(this.lazilyTransformingAstService),o=this.parser.computeHashFromAst(n);this.setFormulaToCellFromCache(o,i)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:r,contentChanges:n}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(n.getChanges()),this.stats.measure(ot.TRANSFORM_ASTS,()=>{const i=new rut(e);i.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(i)}),this.rewriteAffectedArrays(r)}columnEffectivelyNotInSheet(e,r){const n=this.dependencyGraph.addressMapping.getWidth(r);return e>=n}adjustNamedExpressionEdges(e,r,n){if(n===void 0)return;const i=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),o=this.namedExpressions.workbookNamedExpressionOrPlaceholder(r),a=this.dependencyGraph.fetchCellOrCreateEmpty(o.address);for(const s of this.dependencyGraph.graph.adjacentNodes(a))if(s instanceof hs&&s.getAddress(this.lazilyTransformingAstService).sheet===n){const l=s.getFormula(this.lazilyTransformingAstService),u=s.getAddress(this.lazilyTransformingAstService),{dependencies:c}=this.parser.fetchCachedResultForAst(l);for(const f of ea(c,u))f instanceof Ys&&f.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(a,s),this.dependencyGraph.graph.addEdge(i,s))}}storeNamedExpressionInCell(e,r){const n=this.cellContentParser.parse(r);if(n instanceof hr.Formula){const i=this.parser.parse(n.formula,Le(-1,0,0));if(Us(i.ast))throw new jI;const{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:s,dependencies:l}=i;this.dependencyGraph.setFormulaToCell(e,o,ea(l,e),yt.scalar(),a,s)}else n instanceof hr.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:r},e)}updateNamedExpressionsForMovedCells(e,r,n,i){if(e.sheet===i.sheet)return[];const o=[],a=ze.spanFrom(i,r,n);for(const s of a.addresses(this.dependencyGraph)){const l=this.addressMapping.fetchCell(s);if(l instanceof hs&&s.sheet!==e.sheet){const u=l.getFormula(this.lazilyTransformingAstService),{dependencies:c}=this.parser.fetchCachedResultForAst(u);o.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,s,c))}}return o}updateNamedExpressionsForTargetAddress(e,r,n){if(e===r.sheet)return[];const i=[],o=this.addressMapping.fetchCell(r);for(const a of ea(n,r)){if(!(a instanceof Ys))continue;const s=a.name,l=this.dependencyGraph.fetchNamedExpressionVertex(s,e),c=this.namedExpressions.isExpressionInScope(s,r.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(s,r.sheet):this.copyOrFetchGlobalNamedExpressionVertex(s,l,i);c!==l&&(this.dependencyGraph.graph.softRemoveEdge(l,o),this.dependencyGraph.graph.addEdge(c,o))}return i}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(sc.SHEET_FOR_WORKBOOK_EXPRESSIONS,new slt(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,r,n){let i=this.namedExpressions.namedExpressionForScope(e);if(i===void 0)if(i=this.namedExpressions.addNamedExpression(e),n.push(i.normalizeExpressionName()),r instanceof hs){const o=this.parser.fetchCachedResultForAst(r.getFormula(this.lazilyTransformingAstService)),{ast:a,hasVolatileFunction:s,hasStructuralChangeFunction:l,dependencies:u}=o;this.dependencyGraph.setFormulaToCell(i.address,a,ea(u,i.address),yt.scalar(),s,l)}else r instanceof Ba?this.setCellEmpty(i.address):r instanceof fl&&this.setValueToCell(r.getValues(),i.address);return this.dependencyGraph.fetchCellOrCreateEmpty(i.address)}}function ES(t){if(t.length<=1)return t;const e=[...t].sort(([i],[o])=>i-o),r=e.reduce((i,[o,a])=>{const s=i[i.length-1],l=s[0]+s[1];return o<=l?s[1]+=Math.max(0,a-(l-o)):i.push([o,a]),i},[e[0]]);let n=0;for(let i=0;i<r.length;++i)r[i][0]-=n,n+=r[i][1];return r}function CS(t){if(t.length<=1)return t;const e=[...t].sort(([i],[o])=>i-o),r=e.reduce((i,[o,a])=>{const s=i[i.length-1];return o===s[0]?s[1]=Math.max(s[1],a):i.push([o,a]),i},[e[0]]);let n=0;for(let i=0;i<r.length;++i)r[i][0]+=n,n+=r[i][1];return r}function _S(t){return Number.isInteger(t)&&t>0}function uut(t,e,r){return t.row===0&&_S(e)&&r===Number.POSITIVE_INFINITY||t.col===0&&_S(r)&&e===Number.POSITIVE_INFINITY}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class tn{}class cut extends tn{constructor(e,r){super(),this.command=e,this.rowsRemovals=r}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class fut extends tn{constructor(e,r,n,i,o,a,s){super(),this.sourceLeftCorner=e,this.width=r,this.height=n,this.destinationLeftCorner=i,this.overwrittenCellsData=o,this.addedGlobalNamedExpressions=a,this.version=s}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class hut extends tn{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class dut extends tn{constructor(e,r,n){super(),this.sheetId=e,this.rowMapping=r,this.oldContent=n}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class put extends tn{constructor(e,r,n){super(),this.sheetId=e,this.columnMapping=r,this.oldContent=n}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class mut extends tn{constructor(e,r,n){super(),this.sheetId=e,this.oldSheetContent=r,this.newSheetContent=n}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class gut extends tn{constructor(e,r,n,i,o){super(),this.sheet=e,this.startRow=r,this.numberOfRows=n,this.targetRow=i,this.version=o,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class yut extends tn{constructor(e,r,n,i,o){super(),this.sheet=e,this.startColumn=r,this.numberOfColumns=n,this.targetColumn=i,this.version=o,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class vut extends tn{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class but extends tn{constructor(e,r){super(),this.command=e,this.columnsRemovals=r}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class wut extends tn{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class Sut extends tn{constructor(e,r,n,i,o){super(),this.sheetName=e,this.sheetId=r,this.oldSheetContent=n,this.scopedNamedExpressions=i,this.version=o}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class Rut extends tn{constructor(e,r,n){super(),this.sheetId=e,this.oldName=r,this.newName=n}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class Eut extends tn{constructor(e,r){super(),this.sheetId=e,this.oldSheetContent=r}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class Cut extends tn{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class _ut extends tn{constructor(e,r,n,i){super(),this.targetLeftCorner=e,this.oldContent=r,this.newContent=n,this.addedGlobalNamedExpressions=i}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class Tut extends tn{constructor(e,r,n,i){super(),this.name=e,this.newContent=r,this.scope=n,this.options=i}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class Out extends tn{constructor(e,r,n){super(),this.namedExpression=e,this.content=r,this.scope=n}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class Aut extends tn{constructor(e,r,n,i,o){super(),this.namedExpression=e,this.newContent=r,this.oldContent=n,this.scope=i,this.options=o}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class xut extends tn{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class Iut{constructor(e,r){this.operations=r,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){this.batchUndoEntry!==void 0?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new xut}commitBatchMode(){if(this.batchUndoEntry===void 0)throw"Batch mode wasn't started";this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,r,n){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([r,n])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return this.undoStack.length===0}isRedoStackEmpty(){return this.redoStack.length===0}undo(){const e=this.undoStack.pop();if(!e)throw"Attempted to undo without operation on stack";this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const r of e.reversedOperations())this.undoEntry(r)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:r},rowsRemovals:n}=e;for(let i=n.length-1;i>=0;--i){const o=n[i];this.operations.addRows(new ete(r,[[o.rowFrom,o.rowCount]]));for(const{address:a,cellType:s}of o.removedCells)this.operations.restoreCell(a,s);this.restoreOldDataFromVersion(o.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:r},columnsRemovals:n}=e;for(let i=n.length-1;i>=0;--i){const o=n[i];this.operations.addColumns(new tte(r,[[o.columnFrom,o.columnCount]]));for(const{address:a,cellType:s}of o.removedCells)this.operations.restoreCell(a,s);this.restoreOldDataFromVersion(o.version-1)}}undoAddRows(e){const r=e.command.rowsSpans();for(let n=r.length-1;n>=0;--n){const i=r[n];this.operations.removeRows(new Jee(e.command.sheet,[[i.rowStart,i.numberOfRows]]))}}undoAddColumns(e){const r=e.command.columnsSpans();for(let n=r.length-1;n>=0;--n){const i=r[n];this.operations.removeColumns(new rte(e.command.sheet,[[i.columnStart,i.numberOfColumns]]))}}undoSetCellContents(e){for(const r of e.cellContents){const n=r.address,[i,o]=r.oldContent;Hv(n,i)||this.operations.setCellEmpty(n),this.operations.restoreCell(i,o)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const r of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(r)}undoMoveRows(e){const{sheet:r}=e;this.operations.moveRows(r,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:r}=e;this.operations.moveColumns(r,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const r of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(r)}undoAddSheet(e){const{sheetName:r}=e;this.operations.removeSheetByName(r)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:r,sheetId:n}=e;this.operations.addSheet(e.sheetName);for(let i=0;i<r.length;i++){const o=r[i];for(let a=0;a<o.length;a++){const s=o[a],l=Le(n,a,i);this.operations.restoreCell(l,s)}}for(const[i,o]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(i,o,n);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:r,sheetId:n}=e;for(let i=0;i<r.length;i++){const o=r[i];for(let a=0;a<o.length;a++){const s=o[a],l=Le(n,a,i);this.operations.restoreCell(l,s)}}}undoSetSheetContent(e){const{oldSheetContent:r,sheetId:n}=e;this.operations.clearSheet(n);for(let i=0;i<r.length;i++){const o=r[i];for(let a=0;a<o.length;a++){const s=o[a],l=Le(n,a,i);this.operations.restoreCell(l,s)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw"Attempted to redo without operation on stack";this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const r of e.operations)this.redoEntry(r)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:r,newContent:n}=e,i=n.length,o=n[0].length;for(let a=0;a<i;++a)for(let s=0;s<o;++s){const l=Le(r.sheet,r.col+s,r.row+a);this.operations.restoreCell(l,n[a][s])}}redoSetCellContents(e){for(const r of e.cellContents)this.operations.setCellContent(r.address,r.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:r,newSheetContent:n}=e;this.operations.setSheetContent(r,n)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[r,n]of e)this.operations.restoreCell(r,n)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const r=this.oldData.get(e)||[];for(const n of r){const[i,o]=n;this.operations.setFormulaToCellFromCache(o,i)}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Mut{constructor(e,r,n,i,o,a,s,l,u,c){this.operations=r,this.undoRedo=n,this.clipboardOperations=i,this.dependencyGraph=o,this.columnSearch=a,this.parser=s,this.cellContentParser=l,this.lazilyTransformingAstService=u,this.namedExpressions=c,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...r){const n=new ete(e,r);this.ensureItIsPossibleToAddRows(e,...r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(n),this.undoRedo.saveOperation(new hut(n))}removeRows(e,...r){const n=new Jee(e,r);this.ensureItIsPossibleToRemoveRows(e,...r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeRows(n);this.undoRedo.saveOperation(new cut(n,i))}addColumns(e,...r){const n=new tte(e,r);this.ensureItIsPossibleToAddColumns(e,...r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(n),this.undoRedo.saveOperation(new vut(n))}removeColumns(e,...r){const n=new rte(e,r);this.ensureItIsPossibleToRemoveColumns(e,...r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeColumns(n);this.undoRedo.saveOperation(new but(n,i))}moveCells(e,r,n,i){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:o,overwrittenCellsData:a,addedGlobalNamedExpressions:s}=this.operations.moveCells(e,r,n,i);this.undoRedo.saveOperation(new fut(e,r,n,i,a,s,o))}moveRows(e,r,n,i){this.ensureItIsPossibleToMoveRows(e,r,n,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const o=this.operations.moveRows(e,r,n,i);this.undoRedo.saveOperation(new gut(e,r,n,i,o))}moveColumns(e,r,n,i){this.ensureItIsPossibleToMoveColumns(e,r,n,i),this.undoRedo.clearRedoStack();const o=this.operations.moveColumns(e,r,n,i);this.undoRedo.saveOperation(new yut(e,r,n,i,o))}cut(e,r,n){this.clipboardOperations.cut(e,r,n)}ensureItIsPossibleToCopy(e,r,n){if(!df(r))throw new Qr("width to be positive integer.");if(!df(n))throw new Qr("height to be positive integer.")}copy(e,r,n){this.ensureItIsPossibleToCopy(e,r,n),this.clipboardOperations.copy(e,r,n)}paste(e){const r=this.clipboardOperations.clipboard;if(r===void 0)throw new Mee;if(this.clipboardOperations.isCutClipboard())this.moveCells(r.sourceLeftCorner,r.width,r.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const n=ze.spanFrom(e,r.width,r.height),i=this.operations.getRangeClipboardCells(n);this.undoRedo.clearRedoStack();const o=this.operations.restoreClipboardCells(r.sourceLeftCorner.sheet,r.getContent(e));this.undoRedo.saveOperation(new _ut(e,i,r.content,o))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return this.clipboardOperations.clipboard===void 0}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){e!==void 0&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const r=this.operations.addSheet(e);return this.undoRedo.saveOperation(new wut(r)),r}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.sheetMapping.fetchDisplayName(e),n=this.operations.getSheetClipboardCells(e),{version:i,scopedNamedExpressions:o}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new Sut(r,e,n,o,i))}renameSheet(e,r){this.ensureItIsPossibleToRenameSheet(e,r);const n=this.operations.renameSheet(e,r);return n!==void 0&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new Rut(e,n,r))),n}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new Eut(e,r))}setCellContents(e,r){if(!(r instanceof Array))r=[[r]];else for(let i=0;i<r.length;i++)if(!(r[i]instanceof Array))throw new Qr("an array of arrays or a raw cell value.");this.ensureItIsPossibleToChangeCellContents(e,r),this.undoRedo.clearRedoStack();const n=[];for(let i=0;i<r.length;i++)for(let o=0;o<r[i].length;o++){const a={sheet:e.sheet,row:e.row+i,col:e.col+o},s=r[i][o];this.clipboardOperations.abortCut();const l=this.operations.setCellContent(a,s);n.push({address:a,newContent:s,oldContent:l})}this.undoRedo.saveOperation(new Cut(n))}setSheetContent(e,r){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,r),Zee(r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,r),this.undoRedo.saveOperation(new mut(e,n,r))}setRowOrder(e,r){this.validateSwapRowIndexes(e,r),this.testRowOrderForArrays(e,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setRowOrder(e,r);this.undoRedo.saveOperation(new dut(e,r,n))}validateSwapRowIndexes(e,r){if(!this.sheetMapping.hasSheetWithId(e))throw new yr(e);this.validateRowOrColumnMapping(e,r,"row")}testColumnOrderForArrays(e,r){for(const[n,i]of r)if(n!==i){const o=ze.spanFrom({sheet:e,col:n,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new Df}}setColumnOrder(e,r){this.validateSwapColumnIndexes(e,r),this.testColumnOrderForArrays(e,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setColumnOrder(e,r);this.undoRedo.saveOperation(new put(e,r,n))}validateSwapColumnIndexes(e,r){if(!this.sheetMapping.hasSheetWithId(e))throw new yr(e);this.validateRowOrColumnMapping(e,r,"column")}testRowOrderForArrays(e,r){for(const[n,i]of r)if(n!==i){const o=ze.spanFrom({sheet:e,col:0,row:n},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new Df}}mappingFromOrder(e,r,n){if(!this.sheetMapping.hasSheetWithId(e))throw new yr(e);const i=n==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(r.length!==i)throw new Qr(`number of ${n}s provided to be sheet ${n==="row"?"height":"width"}.`);const o=[];for(let a=0;a<i;a++)r[a]!==a&&o.push([a,r[a]]);return o}undo(){if(this.undoRedo.isUndoStackEmpty())throw new xee;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new Iee;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,r,n,i){this.ensureItIsPossibleToAddNamedExpression(e,r,n),this.operations.addNamedExpression(e,r,n,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Tut(e,r,n,i))}changeNamedExpressionExpression(e,r,n,i){this.ensureItIsPossibleToChangeNamedExpression(e,n,r);const[o,a]=this.operations.changeNamedExpressionExpression(e,n,r,i);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Aut(o,n,a,r,i))}removeNamedExpression(e,r){this.ensureScopeIdIsValid(r);const[n,i]=this.operations.removeNamedExpression(e,r);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Out(n,i,r)),n}ensureItIsPossibleToAddNamedExpression(e,r,n){this.ensureScopeIdIsValid(n),this.ensureNamedExpressionNameIsValid(e,n),this.ensureNamedExpressionIsValid(r)}ensureItIsPossibleToChangeNamedExpression(e,r,n){if(this.ensureScopeIdIsValid(n),this.namedExpressions.namedExpressionForScope(e,n)===void 0)throw new Dv(e);this.ensureNamedExpressionIsValid(r)}isItPossibleToRemoveNamedExpression(e,r){if(this.ensureScopeIdIsValid(r),this.namedExpressions.namedExpressionForScope(e,r)===void 0)throw new Dv(e)}ensureItIsPossibleToAddRows(e,...r){if(!this.sheetMapping.hasSheetWithId(e))throw new yr(e);const n=this.dependencyGraph.getSheetHeight(e),i=r.map(o=>o[1]).reduce((o,a)=>o+a,0);if(n+i>this.maxRows)throw new Bu;for(const[o,a]of r)if(!Gl(o)||!df(a))throw new Qr("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...r){for(const[n,i]of r){const o=n+i-1;if(!Gl(n)||!Gl(o))throw new Qr("starting and ending row to be nonnegative.");if(o<n)throw new Qr("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new yr(e)}}ensureItIsPossibleToAddColumns(e,...r){if(!this.sheetMapping.hasSheetWithId(e))throw new yr(e);const n=this.dependencyGraph.getSheetWidth(e),i=r.map(o=>o[1]).reduce((o,a)=>o+a,0);if(n+i>this.maxColumns)throw new Bu;for(const[o,a]of r)if(!Gl(o)||!df(a))throw new Qr("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...r){for(const[n,i]of r){const o=n+i-1;if(!Gl(n)||!Gl(o))throw new Qr("starting and ending column to be nonnegative.");if(o<n)throw new Qr("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new yr(e)}}ensureItIsPossibleToMoveRows(e,r,n,i){this.ensureItIsPossibleToAddRows(e,[i,n]);const o=Le(e,0,r),a=Le(e,0,i);if(!this.sheetMapping.hasSheetWithId(e)||hi(o)||hi(a)||!df(n)||i<=r+n&&i>=r)throw new Qr("a valid range of rows to move.");const s=this.dependencyGraph.getSheetWidth(e),l=ze.spanFrom(o,s,n);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new Df;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(pi.fromNumberOfRows(e,i-1,2)))throw new gS}ensureItIsPossibleToMoveColumns(e,r,n,i){this.ensureItIsPossibleToAddColumns(e,[i,n]);const o=Le(e,r,0),a=Le(e,i,0);if(!this.sheetMapping.hasSheetWithId(e)||hi(o)||hi(a)||!df(n)||i<=r+n&&i>=r)throw new Qr("a valid range of columns to move.");const s=this.dependencyGraph.getSheetHeight(e),l=ze.spanFrom(o,n,s);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new Df;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(Mi.fromNumberOfColumns(e,i-1,2)))throw new gS}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new $v(e)}ensureItIsPossibleToRenameSheet(e,r){if(!this.sheetMapping.hasSheetWithId(e))throw new yr(e);const n=this.sheetMapping.get(r);if(n!==void 0&&n!==e)throw new $v(r)}ensureItIsPossibleToChangeContent(e){if(hi(e))throw new Tee(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new yr(e.sheet)}ensureItIsPossibleToChangeCellContents(e,r){const n=RS(r),i=ze.spanFrom(e,n.width,n.height);this.ensureRangeInSizeLimits(i);for(const o of i.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(o)}ensureItIsPossibleToChangeSheetContents(e,r){const n=RS(r),i=ze.spanFrom(Le(e,0,0),n.width,n.height);this.ensureRangeInSizeLimits(i)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Bu}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(e!==void 0&&!this.sheetMapping.hasSheetWithId(e))throw new yr(e)}validateRowOrColumnMapping(e,r,n){const i=n==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),o=r.map(([s,l])=>s).sort((s,l)=>s-l),a=r.map(([s,l])=>l).sort((s,l)=>s-l);for(let s=0;s<o.length;s++){if(!Gl(o[s])||o[s]>=i)throw new Qr(`${n} numbers to be nonnegative integers and less than sheet ${n==="row"?"height":"width"}.`);if(o[s]===o[s+1])throw new Qr(`source ${n} numbers to be unique.`);if(o[s]!==a[s])throw new Qr(`target ${n} numbers to be permutation of source ${n} numbers.`)}}ensureNamedExpressionNameIsValid(e,r){if(!this.namedExpressions.isNameValid(e))throw new Aee(e);if(!this.namedExpressions.isNameAvailable(e,r))throw new Oee(e)}ensureNamedExpressionIsValid(e){const r=this.cellContentParser.parse(e);if(r instanceof hr.Formula){const n=this.parser.parse(r.formula,Le(-1,0,0));if(Us(n.ast))throw new jI}}}function df(t){return Number.isInteger(t)&&t>0}function Gl(t){return Number.isInteger(t)&&t>=0}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Nut{constructor(e,r,n,i,o,a){this.config=e,this.stats=r,this.interpreter=n,this.lazilyTransformingAstService=i,this.dependencyGraph=o,this.columnSearch=a}run(){this.stats.start(ot.TOP_SORT);const{sorted:e,cycled:r}=this.dependencyGraph.topSortWithScc();this.stats.end(ot.TOP_SORT),this.stats.measure(ot.EVALUATION,()=>{this.recomputeFormulas(r,e)})}partialRun(e){const r=cl.empty();return this.stats.measure(ot.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,n=>{if(n instanceof Ni){const i=n.isComputed()?n.getCellValue():void 0,o=this.recomputeFormulaVertexValue(n);if(o!==i){const a=n.getAddress(this.lazilyTransformingAstService);return r.addChange(o,a),this.columnSearch.change(Ne(i),Ne(o),a),!0}return!1}else return n instanceof $n&&n.clearCache(),!0},n=>{if(n instanceof $n)n.clearCache();else if(n instanceof Ni){const i=n.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(Ne(n.valueOrUndef()),i);const o=new x($.CYCLE,void 0,n);n.setCellValue(o),r.addChange(o,i)}})}),r}runAndForget(e,r,n){const i=[];for(const a of ea(n,r))if(a instanceof ze){const s=a;if(this.dependencyGraph.getRange(s.start,s.end)===void 0){const l=new $n(s);this.dependencyGraph.rangeMapping.setRange(l),i.push(l)}}const o=this.evaluateAstToCellValue(e,new aa(r,this.config.useArrayArithmetic));return i.forEach(a=>{this.dependencyGraph.rangeMapping.removeRange(a)}),o}recomputeFormulas(e,r){e.forEach(n=>{n instanceof Ni&&n.setCellValue(new x($.CYCLE,void 0,n))}),r.forEach(n=>{if(n instanceof Ni){const i=this.recomputeFormulaVertexValue(n),o=n.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(Ne(i),o)}else n instanceof $n&&n.clearCache()})}recomputeFormulaVertexValue(e){const r=e.getAddress(this.lazilyTransformingAstService);if(e instanceof Ir&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const n=e.getFormula(this.lazilyTransformingAstService),i=this.evaluateAstToCellValue(n,new aa(r,this.config.useArrayArithmetic,e));return e.setCellValue(i)}}evaluateAstToCellValue(e,r){const n=this.interpreter.evaluateAst(e,r);return n instanceof je?n:n===_t&&this.config.evaluateNullToZero?0:n}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class GA{constructor(e,r){this.address=e,this.newValue=r}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class nte{constructor(e,r){this.name=e,this.newValue=r}}class Put{constructor(e,r,n,i){this.config=e,this.namedExpressions=r,this.sheetIndexMapping=n,this.lazilyTransformingService=i}exportChange(e){const r=e.value,n=e.address;if(n.sheet===sc.SHEET_FOR_WORKBOOK_EXPRESSIONS){const i=this.namedExpressions.namedExpressionInAddress(n.row);if(!i)throw new Error("Missing named expression");return new nte(i.displayName,this.exportScalarOrRange(r))}else if(r instanceof je){const i=[];for(const[o,a]of r.entriesFromTopLeftCorner(n))i.push(new GA(a,this.exportValue(o)));return i}else return new GA(n,this.exportValue(r))}exportValue(e){return e instanceof je?this.detailedError(new x($.VALUE,W.ScalarExpected)):this.config.smartRounding&&Ft(e)?this.cellValueRounding(Ne(e)):e instanceof x?this.detailedError(e):e===_t?null:Ne(e)}exportScalarOrRange(e){return e instanceof je?e.rawData().map(r=>r.map(n=>this.exportValue(n))):this.exportValue(e)}detailedError(e){var r,n;let i;const o=(r=e.root)===null||r===void 0?void 0:r.getAddress(this.lazilyTransformingService);return o!==void 0&&(o.sheet===sc.SHEET_FOR_WORKBOOK_EXPRESSIONS?i=(n=this.namedExpressions.namedExpressionInAddress(o.row))===null||n===void 0?void 0:n.displayName:i=nS(this.sheetIndexMapping,o,-1)),new Yee(e,this.config.translationPackage.getErrorTranslation(e.type),i)}cellValueRounding(e){if(e===0)return e;const r=Math.floor(Math.log10(Math.abs(e))),n=Math.pow(10,this.config.precisionRounding-r);return e<0?-Math.round(-e*n)/n:Math.round(e*n)/n}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class kut{constructor(e,r,n,i,o,a){this.dependencyGraph=e,this.columnSearch=r,this.parser=n,this.cellContentParser=i,this.stats=o,this.arraySizePredictor=a,this.buildStrategy=new $ut(e,r,n,o,i,a)}buildGraph(e,r){const n=r.measure(ot.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),r.measure(ot.PROCESS_DEPENDENCIES,()=>this.processDependencies(n))}processDependencies(e){e.forEach((r,n)=>{this.dependencyGraph.processCellDependencies(r,n)})}}class $ut{constructor(e,r,n,i,o,a){this.dependencyGraph=e,this.columnIndex=r,this.parser=n,this.stats=i,this.cellContentParser=o,this.arraySizePredictor=a}run(e){const r=new Map;for(const n in e){const i=this.dependencyGraph.getSheetId(n),o=e[n];for(let a=0;a<o.length;++a){const s=o[a];for(let l=0;l<s.length;++l){const u=s[l],c=Le(i,l,a),f=this.cellContentParser.parse(u);if(f instanceof hr.Formula){const h=this.stats.measure(ot.PARSER,()=>this.parser.parse(f.formula,c));if(h.errors.length>0){this.shrinkArrayIfNeeded(c);const d=new rh(h.errors,f.formula);this.dependencyGraph.addVertex(c,d)}else{this.shrinkArrayIfNeeded(c);const d=this.arraySizePredictor.checkArraySize(h.ast,c);if(d.isScalar()){const p=new hs(h.ast,c,0);r.set(p,ea(h.dependencies,c)),this.dependencyGraph.addVertex(c,p),h.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(p),h.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(p)}else{const p=new Ir(h.ast,c,new yt(d.width,d.height));r.set(p,ea(h.dependencies,c)),this.dependencyGraph.addArrayVertex(c,p)}}}else if(!(f instanceof hr.Empty)){this.shrinkArrayIfNeeded(c);const h=new fl(f.value,u);this.columnIndex.add(Ne(f.value),c),this.dependencyGraph.addVertex(c,h)}}}}return r}shrinkArrayIfNeeded(e){const r=this.dependencyGraph.getCell(e);r instanceof Ir&&this.dependencyGraph.shrinkArrayToCorner(r)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const mb=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class ite extends pt{version(e,r){return this.runFunction(e.args,r,this.metadata("VERSION"),()=>{const{licenseKeyValidityState:n,licenseKey:i}=this.config;let o;return mb.has(i)?o=mb.get(i):mb.has(n)?o=mb.get(n):n==="valid"&&(o=i.slice(-5)),`HyperFormula v${Pn.version}, ${o}`})}}ite.implementedFunctions={VERSION:{method:"version",parameters:[]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function e_(t,e){var r;let n=e.implementedFunctions[t];const i=(r=e.aliases)===null||r===void 0?void 0:r[t];if(i!==void 0){if(n!==void 0)throw new qst(t,e.name);n=e.implementedFunctions[i]}if(n===void 0)throw vp.functionNotDeclaredInPlugin(t,e.name);return n}class nn{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=r=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(r),this.isFunctionVolatile=r=>this.volatileFunctions.has(r),this.isArrayFunction=r=>this.arrayFunctions.has(r),this.isFunctionDependentOnSheetStructureChange=r=>this.structuralChangeFunctions.has(r),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const r of e.functionPlugins)nn.loadPluginFunctions(r,this.instancePlugins)}else this.instancePlugins=new Map(nn.plugins);for(const[r,n]of nn.protectedFunctions())nn.loadFunctionUnprotected(n,r,this.instancePlugins);for(const[r,n]of this.instancePlugins.entries())this.categorizeFunction(r,e_(r,n))}static registerFunctionPlugin(e,r){this.loadPluginFunctions(e,this.plugins),r!==void 0&&this.loadTranslations(r)}static registerFunction(e,r,n){this.loadPluginFunction(r,e,this.plugins),n!==void 0&&this.loadTranslations(n)}static unregisterFunction(e){if(this.functionIsProtected(e))throw Uu.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const r of this.protectedPlugins())if(r===e)throw Uu.cannotUnregisterProtectedPlugin();for(const[r,n]of this.plugins.entries())n===e&&this.plugins.delete(r)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const r=new Set(Pn.getRegisteredLanguagesCodes());Object.keys(e).forEach(n=>{r.has(n)&&Pn.getLanguage(n).extendFunctions(e[n])})}static loadPluginFunctions(e,r){Object.keys(e.implementedFunctions).forEach(n=>{this.loadPluginFunction(e,n,r)}),e.aliases!==void 0&&Object.keys(e.aliases).forEach(n=>{this.loadPluginFunction(e,n,r)})}static loadPluginFunction(e,r,n){if(this.functionIsProtected(r))throw Uu.cannotRegisterFunctionWithId(r);this.loadFunctionUnprotected(e,r,n)}static loadFunctionUnprotected(e,r,n){const i=e_(r,e).method;if(Object.prototype.hasOwnProperty.call(e.prototype,i))n.set(r,e);else throw vp.functionMethodNotFound(i,e.name)}static*protectedFunctions(){for(const[e,r]of this._protectedPlugins)r!==void 0&&(yield[e,r])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)e!==void 0&&(yield e)}initializePlugins(e){const r=[];for(const[n,i]of this.instancePlugins.entries()){let o=r.find(u=>u instanceof i);o===void 0&&(o=new i(e),r.push(o));const a=e_(n,i),s=a.method;this.functions.set(n,[s,o]);const l=a.arraySizeMethod;l!==void 0&&this.arraySizeFunctions.set(n,[l,o])}}getFunctionPlugin(e){if(!nn.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const r=this.functions.get(e);if(r!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[n,i]=r;return(o,a)=>i[n](o,a)}else return}getArraySizeFunction(e){const r=this.arraySizeFunctions.get(e);if(r!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[n,i]=r;return(o,a)=>i[n](o,a)}else return}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[r,n]of this.instancePlugins)nn.functionIsProtected(r)||e.add(n);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,r){r.isVolatile&&this.volatileFunctions.add(e),r.arrayFunction&&this.arrayFunctions.add(e),r.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),r.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,r)}}nn.plugins=new Map;nn._protectedPlugins=new Map([["VERSION",ite],["OFFSET",void 0]]);/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var mn;(function(t){t.GREATER_THAN="GREATER_THAN",t.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",t.LESS_THAN="LESS_THAN",t.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",t.NOT_EQUAL="NOT_EQUAL",t.EQUAL="EQUAL"})(mn||(mn={}));const gb=(t,e)=>({operator:t,value:e});class Lut{constructor(e){var r,n,i,o;this.trueString=(n=(r=e.translationPackage.getMaybeFunctionTranslation("TRUE"))===null||r===void 0?void 0:r.toLowerCase())!==null&&n!==void 0?n:"true",this.falseString=(o=(i=e.translationPackage.getMaybeFunctionTranslation("FALSE"))===null||i===void 0?void 0:i.toLowerCase())!==null&&o!==void 0?o:"false"}fromCellValue(e,r){if(typeof e!="string"&&typeof e!="boolean"&&typeof e!="number")return;const n=this.parseCriterion(e,r);if(n!==void 0)return{raw:e,lambda:Hut(n,r)}}parseCriterion(e,r){if(typeof e=="number"||typeof e=="boolean")return gb(mn.EQUAL,e);if(typeof e=="string"){const n=Dut.exec(e);let i,o;n?(o=Fut(n[1]),i=n[2]):(o=mn.EQUAL,i=e);const a=r.coerceToMaybeNumber(i),s=i.toLowerCase()===this.trueString?!0:i.toLowerCase()===this.falseString?!1:void 0;if(o===void 0)return;if(i==="")return gb(o,null);if(a===void 0){if(o===mn.EQUAL||o===mn.NOT_EQUAL)return gb(o,s!=null?s:i)}else return gb(o,Ne(a))}}}const Dut=/([<>=]+)(.*)/;function Fut(t){switch(t){case">":return mn.GREATER_THAN;case">=":return mn.GREATER_THAN_OR_EQUAL;case"<":return mn.LESS_THAN;case"<=":return mn.LESS_THAN_OR_EQUAL;case"<>":return mn.NOT_EQUAL;case"=":return mn.EQUAL;default:return}}const Hut=(t,e)=>{switch(t.operator){case mn.GREATER_THAN:return typeof t.value=="number"?r=>typeof r=="number"&&e.floatCmp(r,t.value)>0:r=>!1;case mn.GREATER_THAN_OR_EQUAL:return typeof t.value=="number"?r=>typeof r=="number"&&e.floatCmp(r,t.value)>=0:r=>!1;case mn.LESS_THAN:return typeof t.value=="number"?r=>typeof r=="number"&&e.floatCmp(r,t.value)<0:r=>!1;case mn.LESS_THAN_OR_EQUAL:return typeof t.value=="number"?r=>typeof r=="number"&&e.floatCmp(r,t.value)<=0:r=>!1;case mn.EQUAL:return typeof t.value=="number"?r=>{if(typeof r=="number")return e.floatCmp(r,t.value)===0;if(typeof r=="string"){if(r==="")return!1;const n=e.coerceToMaybeNumber(r);return n===void 0?!1:e.floatCmp(n,t.value)===0}else return!1}:typeof t.value=="string"?e.eqMatcherFunction(t.value):typeof t.value=="boolean"?r=>typeof r=="boolean"&&r===t.value:r=>r===_t;case mn.NOT_EQUAL:return typeof t.value=="number"?r=>{if(typeof r=="number")return e.floatCmp(r,t.value)!==0;if(typeof r=="string"){if(r==="")return!0;const n=e.coerceToMaybeNumber(r);return n===void 0?!0:e.floatCmp(n,t.value)!==0}else return!0}:typeof t.value=="string"?e.neqMatcherFunction(t.value):typeof t.value=="boolean"?r=>typeof r!="boolean"||r!==t.value:r=>r!==_t}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class But{constructor(e,r,n,i,o,a,s,l,u,c){this.config=e,this.dependencyGraph=r,this.columnSearch=n,this.stats=i,this.arithmeticHelper=o,this.functionRegistry=a,this.namedExpressions=s,this.serialization=l,this.arraySizePredictor=u,this.dateTimeHelper=c,this.equalOp=(f,h)=>Ui(this.arithmeticHelper.eq,f,h),this.notEqualOp=(f,h)=>Ui(this.arithmeticHelper.neq,f,h),this.greaterThanOp=(f,h)=>Ui(this.arithmeticHelper.gt,f,h),this.lessThanOp=(f,h)=>Ui(this.arithmeticHelper.lt,f,h),this.greaterThanOrEqualOp=(f,h)=>Ui(this.arithmeticHelper.geq,f,h),this.lessThanOrEqualOp=(f,h)=>Ui(this.arithmeticHelper.leq,f,h),this.concatOp=(f,h)=>Ui(this.arithmeticHelper.concat,BA(f),BA(h)),this.plusOp=(f,h)=>Ui(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.minusOp=(f,h)=>Ui(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.timesOp=(f,h)=>Ui(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.powerOp=(f,h)=>Ui(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.divOp=(f,h)=>Ui(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(f),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.unaryMinusOp=f=>nj(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(f)),this.percentOp=f=>nj(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(f)),this.unaryPlusOp=f=>this.arithmeticHelper.unaryPlus(f),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new Lut(e)}evaluateAst(e,r){let n=this.evaluateAstWithoutPostprocessing(e,r);if(Ft(n)){if(Wee(Ne(n)))return new x($.NUM,W.NaN);n=HI(n,zee(Ne(n)))}return n instanceof je&&n.height()===1&&n.width()===1&&([[n]]=n.data),Uut(n,r.formulaVertex)}evaluateAstWithoutPostprocessing(e,r){switch(e.type){case F.EMPTY:return _t;case F.CELL_REFERENCE:{const n=e.reference.toSimpleCellAddress(r.formulaAddress);return hi(n)?new x($.REF,W.BadRef):this.dependencyGraph.getCellValue(n)}case F.NUMBER:case F.STRING:return e.value;case F.CONCATENATE_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.concatOp,n,i,r)}case F.EQUALS_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.equalOp,n,i,r)}case F.NOT_EQUAL_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.notEqualOp,n,i,r)}case F.GREATER_THAN_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.greaterThanOp,n,i,r)}case F.LESS_THAN_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.lessThanOp,n,i,r)}case F.GREATER_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,n,i,r)}case F.LESS_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.lessThanOrEqualOp,n,i,r)}case F.PLUS_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.plusOp,n,i,r)}case F.MINUS_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.minusOp,n,i,r)}case F.TIMES_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.timesOp,n,i,r)}case F.POWER_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.powerOp,n,i,r)}case F.DIV_OP:{const n=this.evaluateAst(e.left,r),i=this.evaluateAst(e.right,r);return this.binaryRangeWrapper(this.divOp,n,i,r)}case F.PLUS_UNARY_OP:{const n=this.evaluateAst(e.value,r);return this.unaryRangeWrapper(this.unaryPlusOp,n,r)}case F.MINUS_UNARY_OP:{const n=this.evaluateAst(e.value,r);return this.unaryRangeWrapper(this.unaryMinusOp,n,r)}case F.PERCENT_OP:{const n=this.evaluateAst(e.value,r);return this.unaryRangeWrapper(this.percentOp,n,r)}case F.FUNCTION_CALL:{if(this.config.licenseKeyValidityState!=="valid"&&!nn.functionIsProtected(e.procedureName))return new x($.LIC,W.LicenseKey(this.config.licenseKeyValidityState));const n=this.functionRegistry.getFunction(e.procedureName);return n!==void 0?n(e,new aa(r.formulaAddress,r.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),r.formulaVertex)):new x($.NAME,W.FunctionName(e.procedureName))}case F.NAMED_EXPRESSION:{const n=this.namedExpressions.nearestNamedExpression(e.expressionName,r.formulaAddress.sheet);return n?this.dependencyGraph.getCellValue(n.address):new x($.NAME,W.NamedExpressionName(e.expressionName))}case F.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new x($.REF,W.RangeManySheets);const n=ze.fromCellRange(e,r.formulaAddress),i=this.dependencyGraph.getArray(n);if(i){const o=i.array;if(o instanceof Gm)throw new Error("Array should be already computed");if(o instanceof x)return o;if(o instanceof bp)return je.fromRange(o.raw(),n,this.dependencyGraph);throw new Error("Unknown array")}else return je.onlyRange(n,this.dependencyGraph)}case F.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new x($.REF,W.RangeManySheets);const n=ys.fromColumnRange(e,r.formulaAddress);return je.onlyRange(n,this.dependencyGraph)}case F.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new x($.REF,W.RangeManySheets);const n=vs.fromRowRangeAst(e,r.formulaAddress);return je.onlyRange(n,this.dependencyGraph)}case F.PARENTHESIS:return this.evaluateAst(e.expression,r);case F.ARRAY:{let n;const i=[];for(const o of e.args){let a;const s=[];for(const u of o){const c=Vee(this.evaluateAst(u,r)),f=c.height();if(a===void 0)a=f,s.push(...c.data);else if(a===f)for(let h=0;h<f;h++)s[h].push(...c.data[h]);else return new x($.REF,W.SizeMismatch)}const l=s[0].length;if(n===void 0)n=l,i.push(...s);else if(n===l)i.push(...s);else return new x($.REF,W.SizeMismatch)}return je.onlyValues(i)}case F.ERROR_WITH_RAW_INPUT:case F.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,r,n){var i;if(r instanceof je&&!n.arraysFlag&&(r=(i=M2(r,n))!==null&&i!==void 0?i:new x($.VALUE,W.ScalarExpected)),r instanceof x)return r;if(r instanceof je){const o=r.data.map(a=>a.map(e));return je.onlyValues(o)}return e(r)}binaryRangeWrapper(e,r,n,i){var o,a;if(r instanceof je&&!i.arraysFlag&&(r=(o=M2(r,i))!==null&&o!==void 0?o:new x($.VALUE,W.ScalarExpected)),r instanceof x)return r;if(n instanceof je&&!i.arraysFlag&&(n=(a=M2(n,i))!==null&&a!==void 0?a:new x($.VALUE,W.ScalarExpected)),n instanceof x)return n;if(r instanceof je||n instanceof je){if(!(r instanceof je))if(n.isAdHoc()){const c=n.data;for(let f=0;f<c.length;f++)for(let h=0;h<c[0].length;h++)c[f][h]=e(r,c[f][h]);return je.onlyValues(c)}else r=je.fromScalar(r);if(!(n instanceof je))if(r.isAdHoc()){const c=r.data;for(let f=0;f<c.length;f++)for(let h=0;h<c[0].length;h++)c[f][h]=e(c[f][h],n);return je.onlyValues(c)}else n=je.fromScalar(n);if(r.width()===n.width()&&r.height()===n.height()){if(r.isAdHoc()){const c=r.data,f=n.data;for(let h=0;h<c.length;h++)for(let d=0;d<c[0].length;d++)c[h][d]=e(c[h][d],f[h][d]);return je.onlyValues(c)}if(n.isAdHoc()){const c=r.data,f=n.data;for(let h=0;h<c.length;h++)for(let d=0;d<c[0].length;d++)f[h][d]=e(c[h][d],f[h][d]);return je.onlyValues(f)}}const s=Math.max(r.width(),n.width()),l=Math.max(r.height(),n.height()),u=Array(l);for(let c=0;c<l;c++)u[c]=Array(s);for(let c=0;c<l;c++){const f=r.height()!==1?c:0,h=n.height()!==1?c:0;for(let d=0;d<s;d++){const p=r.width()!==1?d:0,m=n.width()!==1?d:0;f<r.height()&&h<n.height()&&p<r.width()&&m<n.width()?u[c][d]=e(r.data[f][p],n.data[h][m]):u[c][d]=new x($.NA)}}return je.onlyValues(u)}return e(r,n)}}function nj(t,e){return e instanceof x?e:t(e)}function Ui(t,e,r){return e instanceof x?e:r instanceof x?r:t(e,r)}function Uut(t,e){return t instanceof x&&e!==void 0?t.attachRootVertex(e):t}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Vut{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,r){this.transformations.forEach(n=>n.performEagerTransformations(e,r))}transformSingleAst(e,r){let[n,i]=[e,r];return this.transformations.forEach(o=>{[n,i]=o.transformSingleAst(n,i)}),[n,i]}isIrreversible(){return!0}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class jut{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return this.combinedTransformer!==void 0?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new Vut(e)}commitCombinedMode(){if(this.combinedTransformer===void 0)throw"Combined mode wasn't started";return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,r,n){this.stats.start(ot.TRANSFORM_ASTS_POSTPONED);for(let o=n;o<this.transformations.length;o++){const a=this.transformations[o];a.isIrreversible()&&(this.undoRedo.storeDataForVersion(o,r,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[s,l]=a.transformSingleAst(e,r);e=s,r=l}const i=this.parser.rememberNewAst(e);return this.stats.end(ot.TRANSFORM_ASTS_POSTPONED),[i,r,this.transformations.length]}*getTransformationsFrom(e,r){for(let n=e;n<this.transformations.length;n++){const i=this.transformations[n];(!r||r(i))&&(yield i)}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const N2=-1;function Wut(t,e,{searchCoordinate:r,orderingDirection:n,matchExactly:i},o){const a=e.start[r],s=r==="col"?e.effectiveEndColumn(o):e.effectiveEndRow(o),l=r==="col"?h=>Ne(o.getCellValue(Le(e.sheet,h,e.start.row))):h=>Ne(o.getCellValue(Le(e.sheet,e.start.col,h))),u=n==="asc"?(h,d)=>ij(h,d):(h,d)=>-ij(h,d),c=zut(h=>u(t,l(h))>=0,a,s),f=l(c);return c===N2||typeof f!=typeof t||i&&f!==t?N2:c-a}function zut(t,e,r){let n=e,i=r;for(;n<i;){const o=Math.ceil((n+i)/2);t(o)?n=o:i=o-1}return n===i&&t(n)?n:N2}function ij(t,e){return typeof t==typeof e?t===_t?0:t<e?-1:t>e?1:0:t===_t?-1:e===_t?1:e instanceof x||typeof t=="number"&&typeof e=="string"||typeof t=="number"&&typeof e=="boolean"?-1:typeof t=="string"&&typeof e=="number"?1:typeof t=="string"&&typeof e=="boolean"?-1:1}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ote{constructor(e){this.dependencyGraph=e}advancedFind(e,r){let n;const i=r.range;i===void 0?n=r.valuesFromTopLeftCorner():n=this.dependencyGraph.computeListOfValuesInRange(i);for(let o=0;o<n.length;o++)if(e(Ne(n[o])))return o;return-1}basicFind(e,r,n,{ordering:i,matchExactly:o}){const a=typeof e=="string"?mg(e):e,s=r.range;return s===void 0?this.findNormalizedValue(a,r.valuesFromTopLeftCorner()):i==="none"?this.findNormalizedValue(a,this.dependencyGraph.computeListOfValuesInRange(s)):Wut(a,s,{searchCoordinate:n,orderingDirection:i,matchExactly:o},this.dependencyGraph)}findNormalizedValue(e,r){return r.map(Ne).map(n=>typeof n=="string"?mg(n):n).indexOf(e)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ate extends ote{constructor(e){super(e),this.dependencyGraph=e}add(e,r){}remove(e,r){}change(e,r,n){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,r,n,i){}removeValues(e){}find(e,r,n){return this.basicFind(e,r,"row",n)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ru{constructor(e,r,n){this.dependencyGraph=e,this.config=r,this.stats=n,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new ate(e)}add(e,r){if(!(e===_t||e instanceof x))if(e instanceof je)for(const[n,i]of e.entriesFromTopLeftCorner(r))this.addSingleCellValue(Ne(n),i);else this.addSingleCellValue(e,r)}remove(e,r){if(e!==void 0)if(e instanceof je)for(const[n,i]of e.entriesFromTopLeftCorner(r))this.removeSingleValue(Ne(n),i);else this.removeSingleValue(e,r)}change(e,r,n){e!==r&&(this.remove(e,n),this.add(r,n))}applyChanges(e){for(const r of e)r.oldValue!==void 0&&this.change(Ne(r.oldValue),Ne(r.value),r.address)}moveValues(e,r,n,i){for(const[o,a]of e){const s=mlt(a,i,r,n);this.remove(o,a),this.add(o,s)}}removeValues(e){for(const[r,n]of e)this.remove(r,n)}find(e,r,{ordering:n,matchExactly:i}){const o=i===!0?"findFirst":"findLast",a=this.findUsingColumnIndex(e,r,o);return a!==void 0?a:this.binarySearchStrategy.find(e,r,{ordering:n,matchExactly:i})}findUsingColumnIndex(e,r,n){const i=r.range;if(i===void 0)return;this.ensureRecentData(i.sheet,i.start.col,e);const o=this.getColumnMap(i.sheet,i.start.col);if(!o)return-1;const a=typeof e=="string"?mg(e):e,s=o.get(a);if(!s||!s.index||s.index.length===0)return;const l=ru.findRowBelongingToRange(s,i,n);return l!==void 0?l-i.start.row:void 0}static findRowBelongingToRange(e,r,n){const i=r.start.row,o=r.end.row,a=n==="findFirst"?Yl(i,e.index,"upperBound"):Yl(o,e.index,"lowerBound");if(a===-1)return;const s=e.index[a];return s>=i&&s<=o?s:void 0}advancedFind(e,r){return this.binarySearchStrategy.advancedFind(e,r)}addColumns(e){const r=this.index.get(e.sheet);!r||r.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const r=this.index.get(e.sheet);!r||r.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,r){this.index.has(e)||this.index.set(e,[]);const n=this.index.get(e);let i=n[r];return i||(i=new Map,n[r]=i),i}getValueIndex(e,r,n){const i=this.getColumnMap(e,r);let o=this.getColumnMap(e,r).get(n);return o||(o={version:this.transformingService.version(),index:[]},i.set(n,o)),o}ensureRecentData(e,r,n){const i=this.getValueIndex(e,r,n),o=this.transformingService.version();if(i.version===o)return;const a=this.transformingService.getTransformationsFrom(i.version,s=>s.sheet===e&&(s instanceof WA||s instanceof zA));for(const s of a)s instanceof WA?this.addRows(r,s.rowsSpan,n):s instanceof zA&&this.removeRows(r,s.rowsSpan,n);i.version=o}addSingleCellValue(e,r){this.stats.measure(ot.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(r.sheet,r.col,e),typeof e=="string"&&(e=mg(e));const n=this.getValueIndex(r.sheet,r.col,e);ru.addValue(n,r.row)})}removeSingleValue(e,r){this.stats.measure(ot.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(r.sheet,r.col,e);const n=this.getColumnMap(r.sheet,r.col);typeof e=="string"&&(e=mg(e));const i=n.get(e);if(!i)return;const o=Yl(r.row,i.index);o>-1&&i.index.splice(o,1),i.index.length===0&&n.delete(e),n.size===0&&delete this.index.get(r.sheet)[r.col]})}addRows(e,r,n){const i=this.getValueIndex(r.sheet,e,n);ru.shiftRows(i,r.rowStart,r.numberOfRows)}removeRows(e,r,n){const i=this.getValueIndex(r.sheet,e,n);ru.removeRowsFromValues(i,r),ru.shiftRows(i,r.rowEnd+1,-r.numberOfRows)}static addValue(e,r){const n=Yl(r,e.index,"lowerBound");e.index[n]===r||e.index.splice(n+1,0,r)}static removeRowsFromValues(e,r){const n=Yl(r.rowStart,e.index,"upperBound"),i=Yl(r.rowEnd,e.index,"lowerBound");n>-1&&i>-1&&n<=i&&e.index[n]<=r.rowEnd&&e.index.splice(n,i-n+1)}static shiftRows(e,r,n){const i=Yl(r,e.index,"upperBound");if(i!==-1)for(let o=i;o<e.index.length;++o)e.index[o]+=n}}function Yl(t,e,r="upperBound"){let n=0,i=e.length-1;for(;n<=i;){const s=Math.floor((n+i)/2);if(t>e[s])n=s+1;else if(t<e[s])i=s-1;else return s}const o=r==="lowerBound"?i:n;return o>=0&&o<=e.length?o:-1}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Gut(t,e,r){return e.useColumnIndex?new ru(t,e,r):new ate(t)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Yut{constructor(e){this.config=e;const r=this.config.thousandSeparator==="."?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,n=this.config.decimalSeparator==="."?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${n}\\d+)|(\\d+(${r}\\d{3,})*(${n}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${r}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const r=this.numericStringToNumber(e);return isNaN(r)?void 0:r}}numericStringToNumber(e){const r=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(r)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class GI{constructor(e,r,n){this.dependencyGraph=e,this.unparser=r,this.exporter=n}getCellFormula(e,r){const n=this.dependencyGraph.getCell(e);if(n instanceof hs){const i=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);return r=r!=null?r:e,this.unparser.unparse(i,r)}else if(n instanceof Ir){const i=n.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(i.row!==e.row||i.col!==e.col||i.sheet!==e.sheet)return;r=r!=null?r:e;const o=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(o!==void 0)return this.unparser.unparse(o,r)}else if(n instanceof rh)return n.getFormula()}getCellSerialized(e,r){var n;return(n=this.getCellFormula(e,r))!==null&&n!==void 0?n:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,r=>this.getCellValue(r))}getSheetFormulas(e){return this.genericSheetGetter(e,r=>this.getCellFormula(r))}genericSheetGetter(e,r){const n=this.dependencyGraph.getSheetHeight(e),i=this.dependencyGraph.getSheetWidth(e),o=new Array(n);for(let a=0;a<n;a++){o[a]=new Array(i);for(let s=0;s<i;s++){const l=Le(e,s,a);o[a][s]=r(l)}for(let s=i-1;s>=0&&(o[a][s]===null||o[a][s]===void 0);s--)o[a].pop()}for(let a=n-1;a>=0&&o[a].length===0;a--)o.pop();return o}genericAllSheetsGetter(e){const r={};for(const n of this.dependencyGraph.sheetMapping.displayNames()){const i=this.dependencyGraph.sheetMapping.fetch(n);r[n]=e(i)}return r}getSheetSerialized(e){return this.genericSheetGetter(e,r=>this.getCellSerialized(r))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){const e=[];let r=0;for(const n of this.dependencyGraph.sheetMapping.displayNames()){const i=this.dependencyGraph.sheetMapping.fetch(n);e[i]=r,r++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(n=>({name:n.expression.displayName,expression:this.getCellSerialized(n.expression.address),scope:n.scope!==void 0?e[n.scope]:void 0,options:n.expression.options}))}withNewConfig(e,r){const n=new See(e,FI(e),this.dependencyGraph.sheetMapping.fetchDisplayName,r);return new GI(this.dependencyGraph,n,this.exporter)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class yb{static buildFromSheets(e,r={},n=[]){const i=new xn(r);return this.buildEngine(i,e,n)}static buildFromSheet(e,r={},n=[]){const i=new xn(r),o=i.translationPackage.getUITranslation(Fv.NEW_SHEET_PREFIX)+"1";return this.buildEngine(i,{[o]:e},n)}static buildEmpty(e={},r=[]){return this.buildEngine(new xn(e),{},r)}static rebuildWithConfig(e,r,n,i){return this.buildEngine(e,r,n,i)}static buildEngine(e,r={},n=[],i=e.useStats?new Cee:new Gst){i.start(ot.BUILD_ENGINE_TOTAL);const o=new sc,a=new nn(e),s=new jut(i),l=WI.buildEmpty(s,e,a,o,i),u=Gut(l,e,i),c=l.sheetMapping,f=l.addressMapping;for(const M in r)if(Object.prototype.hasOwnProperty.call(r,M)){const G=r[M];Zee(G);const j=RS(G);if(j.height>e.maxRows||j.width>e.maxColumns)throw new Bu;const q=c.addSheet(M);f.autoAddSheet(q,G,j)}const h=new pg(e,a,c.get);s.parser=h;const d=new See(e,FI(e),c.fetchDisplayName,o),p=new Nlt(e),m=new Yut(e),g=new Slt(e,p,m),v=new Jlt(e,p,m),S=new Alt(e,a),b=new lut(e,l,u,v,h,i,s,o,S),E=new Iut(e,b);s.undoRedo=E;const T=new eut(e,l,b),N=new Mut(e,b,E,T,l,u,h,v,s,o);n.forEach(M=>{N.ensureItIsPossibleToAddNamedExpression(M.name,M.expression,M.scope),N.operations.addNamedExpression(M.name,M.expression,M.scope,M.options)});const L=new Put(e,o,c.fetchDisplayName,s),V=new GI(l,d,L),B=new But(e,l,u,i,g,a,o,V,S,p);i.measure(ot.GRAPH_BUILD,()=>{new kut(l,u,h,v,i,S).buildGraph(r,i)});const k=new Nut(e,i,B,s,l,u);return k.run(),i.end(ot.BUILD_ENGINE_TOTAL),{config:e,stats:i,dependencyGraph:l,columnSearch:u,parser:h,unparser:d,cellContentParser:v,evaluator:k,lazilyTransformingAstService:s,crudOperations:N,exporter:L,namedExpressions:o,serialization:V,functionRegistry:a}}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function Kut(t){for(const[e,r]of Object.entries(t))r instanceof Function?t[e]=qut(r):delete t[e]}function qut(t){return()=>{throw new Error(`The "${t}" method cannot be called because this HyperFormula instance has been destroyed`)}}var ste={exports:{}};function YI(){}YI.prototype={on:function(t,e,r){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:e,ctx:r}),this},once:function(t,e,r){var n=this;function i(){n.off(t,i),e.apply(r,arguments)}return i._=e,this.on(t,i,r)},emit:function(t){var e=[].slice.call(arguments,1),r=((this.e||(this.e={}))[t]||[]).slice(),n=0,i=r.length;for(n;n<i;n++)r[n].fn.apply(r[n].ctx,e);return this},off:function(t,e){var r=this.e||(this.e={}),n=r[t],i=[];if(n&&e)for(var o=0,a=n.length;o<a;o++)n[o].fn!==e&&n[o].fn._!==e&&i.push(n[o]);return i.length?r[t]=i:delete r[t],this}};ste.exports=YI;var Xut=ste.exports.TinyEmitter=YI;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */var qo;(function(t){t.SheetAdded="sheetAdded",t.SheetRemoved="sheetRemoved",t.SheetRenamed="sheetRenamed",t.NamedExpressionAdded="namedExpressionAdded",t.NamedExpressionRemoved="namedExpressionRemoved",t.ValuesUpdated="valuesUpdated",t.EvaluationSuspended="evaluationSuspended",t.EvaluationResumed="evaluationResumed"})(qo||(qo={}));class Qut extends Xut{emit(e,...r){return super.emit(e,...r),this}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Pn{constructor(e,r,n,i,o,a,s,l,u,c,f,h,d,p){this._config=e,this._stats=r,this._dependencyGraph=n,this._columnSearch=i,this._parser=o,this._unparser=a,this._cellContentParser=s,this._evaluator=l,this._lazilyTransformingAstService=u,this._crudOperations=c,this._exporter=f,this._namedExpressions=h,this._serialization=d,this._functionRegistry=p,this._emitter=new Qut,this._evaluationSuspended=!1}static get defaultConfig(){return Zut()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,r={},n=[]){return this.buildFromEngineState(yb.buildFromSheet(e,r,n))}static buildFromSheets(e,r={},n=[]){return this.buildFromEngineState(yb.buildFromSheets(e,r,n))}static buildEmpty(e={},r=[]){return this.buildFromEngineState(yb.buildEmpty(e,r))}static getLanguage(e){Ce(e,"string","languageCode");const r=this.registeredLanguages.get(e);if(r===void 0)throw new LA;return r}static registerLanguage(e,r){if(Ce(e,"string","languageCode"),this.registeredLanguages.has(e))throw new Fee;this.registeredLanguages.set(e,ilt(r))}static unregisterLanguage(e){if(Ce(e,"string","languageCode"),this.registeredLanguages.has(e))this.registeredLanguages.delete(e);else throw new LA}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,r){nn.registerFunctionPlugin(e,r)}static unregisterFunctionPlugin(e){nn.unregisterFunctionPlugin(e)}static registerFunction(e,r,n){Ce(e,"string","functionId"),nn.registerFunction(e,r,n)}static unregisterFunction(e){Ce(e,"string","functionId"),nn.unregisterFunction(e)}static unregisterAllFunctions(){nn.unregisterAll()}static getRegisteredFunctionNames(e){Ce(e,"string","code");const r=nn.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(r)}static getFunctionPlugin(e){return Ce(e,"string","functionId"),nn.getFunctionPlugin(e)}static getAllFunctionPlugins(){return nn.getPlugins()}static buildFromEngineState(e){return new Pn(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellSerialized(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return Ce(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return Ce(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return Ce(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return Ce(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){const r=this._config.mergeConfig(e),n=this._config.mergeConfig({language:e.language}),i=this._serialization.withNewConfig(n,this._namedExpressions).getAllSheetsSerialized(),o=this._serialization.getAllNamedExpressionsSerialized(),a=yb.rebuildWithConfig(r,i,o,this._stats);this._config=a.config,this._stats=a.stats,this._dependencyGraph=a.dependencyGraph,this._columnSearch=a.columnSearch,this._parser=a.parser,this._unparser=a.unparser,this._cellContentParser=a.cellContentParser,this._evaluator=a.evaluator,this._lazilyTransformingAstService=a.lazilyTransformingAstService,this._crudOperations=a.crudOperations,this._exporter=a.exporter,this._namedExpressions=a.namedExpressions,this._serialization=a.serialization,this._functionRegistry=a.functionRegistry}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.updateConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let r;if(Br(e))r=new ze(e,e);else if(Ti(e))r=new ze(e.start,e.end);else throw new Bt("SimpleCellAddress | SimpleCellRange","address");try{this._crudOperations.ensureRangeInSizeLimits(r);for(const n of r.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(n)}catch{return!1}return!0}setCellContents(e,r){return this._crudOperations.setCellContents(e,r),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,r){return Ce(e,"number","sheetId"),this._crudOperations.setRowOrder(e,r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,r){Ce(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,r),this._crudOperations.testRowOrderForArrays(e,r),!0}catch{return!1}}setRowOrder(e,r){Ce(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,r,"row");return this.swapRowIndexes(e,n)}isItPossibleToSetRowOrder(e,r){Ce(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,r,"row");return this._crudOperations.validateSwapRowIndexes(e,n),this._crudOperations.testRowOrderForArrays(e,n),!0}catch{return!1}}swapColumnIndexes(e,r){return Ce(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,r){Ce(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,r),this._crudOperations.testColumnOrderForArrays(e,r),!0}catch{return!1}}setColumnOrder(e,r){Ce(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,r,"column");return this.swapColumnIndexes(e,n)}isItPossibleToSetColumnOrder(e,r){Ce(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,r,"column");return this._crudOperations.validateSwapColumnIndexes(e,n),this._crudOperations.testColumnOrderForArrays(e,n),!0}catch{return!1}}isItPossibleToAddRows(e,...r){Ce(e,"number","sheetId");const n=CS(r);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...n),!0}catch{return!1}}addRows(e,...r){return Ce(e,"number","sheetId"),this._crudOperations.addRows(e,...r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...r){Ce(e,"number","sheetId");const n=ES(r);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...n),!0}catch{return!1}}removeRows(e,...r){return Ce(e,"number","sheetId"),this._crudOperations.removeRows(e,...r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...r){Ce(e,"number","sheetId");const n=CS(r);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...n),!0}catch{return!1}}addColumns(e,...r){return Ce(e,"number","sheetId"),this._crudOperations.addColumns(e,...r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...r){Ce(e,"number","sheetId");const n=ES(r);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...n),!0}catch{return!1}}removeColumns(e,...r){return Ce(e,"number","sheetId"),this._crudOperations.removeColumns(e,...r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,r){if(!Br(r))throw new Bt("SimpleCellAddress","destinationLeftCorner");if(!Ti(e))throw new Bt("SimpleCellRange","source");try{const n=new ze(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(n.start,n.width(),n.height(),r),!0}catch{return!1}}moveCells(e,r){if(!Br(r))throw new Bt("SimpleCellAddress","destinationLeftCorner");if(!Ti(e))throw new Bt("SimpleCellRange","source");const n=new ze(e.start,e.end);return this._crudOperations.moveCells(n.start,n.width(),n.height(),r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,r,n,i){Ce(e,"number","sheetId"),Ce(r,"number","startRow"),Ce(n,"number","numberOfRows"),Ce(i,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,r,n,i),!0}catch{return!1}}moveRows(e,r,n,i){return Ce(e,"number","sheetId"),Ce(r,"number","startRow"),Ce(n,"number","numberOfRows"),Ce(i,"number","targetRow"),this._crudOperations.moveRows(e,r,n,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,r,n,i){Ce(e,"number","sheetId"),Ce(r,"number","startColumn"),Ce(n,"number","numberOfColumns"),Ce(i,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,r,n,i),!0}catch{return!1}}moveColumns(e,r,n,i){return Ce(e,"number","sheetId"),Ce(r,"number","startColumn"),Ce(n,"number","numberOfColumns"),Ce(i,"number","targetColumn"),this._crudOperations.moveColumns(e,r,n,i),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!Ti(e))throw new Bt("SimpleCellRange","source");const r=new ze(e.start,e.end);return this._crudOperations.copy(r.start,r.width(),r.height()),this.getRangeValues(e)}cut(e){if(!Ti(e))throw new Bt("SimpleCellRange","source");const r=new ze(e.start,e.end);return this._crudOperations.cut(r.start,r.width(),r.height()),this.getRangeValues(e)}paste(e){if(!Br(e))throw new Bt("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!Ti(e))throw new Bt("SimpleCellRange","source");return new ze(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(i=>this.getCellValue(i)))}getRangeFormulas(e){if(!Ti(e))throw new Bt("SimpleCellRange","source");return new ze(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(i=>this.getCellFormula(i)))}getRangeSerialized(e){if(!Ti(e))throw new Bt("SimpleCellRange","source");return new ze(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(i=>this.getCellSerialized(i)))}getFillRangeData(e,r,n=!1){if(!Ti(e))throw new Bt("SimpleCellRange","source");if(!Ti(r))throw new Bt("SimpleCellRange","target");const i=new ze(e.start,e.end),o=new ze(r.start,r.end);return this.ensureEvaluationIsNotSuspended(),o.arrayOfAddressesInRange().map(a=>a.map(s=>{const l=((s.row-(n?r:e).start.row)%i.height()+i.height())%i.height()+e.start.row,u=((s.col-(n?r:e).start.col)%i.width()+i.width())%i.width()+e.start.col;return this._serialization.getCellSerialized({row:l,col:u,sheet:i.sheet},s)}))}isItPossibleToAddSheet(e){Ce(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch{return!1}}addSheet(e){e!==void 0&&Ce(e,"string","sheetName");const r=this._crudOperations.addSheet(e);return this._emitter.emit(qo.SheetAdded,r),r}isItPossibleToRemoveSheet(e){Ce(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}removeSheet(e){Ce(e,"number","sheetId");const r=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const n=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(qo.SheetRemoved,r,n),n}isItPossibleToClearSheet(e){Ce(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}clearSheet(e){return Ce(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,r){Ce(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,r),!0}catch{return!1}}setSheetContent(e,r){return Ce(e,"number","sheetId"),this._crudOperations.setSheetContent(e,r),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,r){return Ce(e,"string","cellAddress"),Ce(r,"number","sheetId"),RA(this.sheetMapping.get,e,r)}simpleCellRangeFromString(e,r){return Ce(e,"string","cellRange"),Ce(r,"number","sheetId"),Git(this.sheetMapping.get,e,r)}simpleCellAddressToString(e,r){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");return Ce(r,"number","sheetId"),nS(this.sheetMapping.fetchDisplayName,e,r)}simpleCellRangeToString(e,r){if(!Ti(e))throw new Bt("SimpleCellRange","cellRange");return Ce(r,"number","sheetId"),Yit(this.sheetMapping.fetchDisplayName,e,r)}getCellDependents(e){let r;if(Br(e))r=this._dependencyGraph.addressMapping.getCell(e);else if(Ti(e))r=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new Bt("SimpleCellAddress | SimpleCellRange",e);return r===void 0?[]:this._dependencyGraph.getAdjacentNodesAddresses(r)}getCellPrecedents(e){let r;if(Br(e))r=this._dependencyGraph.addressMapping.getCell(e);else if(Ti(e))r=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new Bt("SimpleCellAddress | SimpleCellRange",e);return r===void 0?[]:this._dependencyGraph.dependencyQueryAddresses(r)}getSheetName(e){return Ce(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return Ce(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return Ce(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");const r=this.dependencyGraph.getCell(e);return ult(r,e)}doesCellHaveSimpleValue(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");return this.getCellType(e)===ui.VALUE}doesCellHaveFormula(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");const r=this.getCellType(e);return r===ui.FORMULA||r===ui.ARRAYFORMULA}isCellEmpty(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");return this.getCellType(e)===ui.EMPTY}isCellPartOfArray(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");const r=this.getCellType(e);return r===ui.ARRAY||r===ui.ARRAYFORMULA}getCellValueType(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const r=this.dependencyGraph.getCellValue(e);return vS(r)}getCellValueDetailedType(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const r=this.dependencyGraph.getCellValue(e);return flt(r)}getCellValueFormat(e){if(!Br(e))throw new Bt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const r=this.dependencyGraph.getCellValue(e);return hlt(r)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,r){Ce(e,"number","sheetId"),Ce(r,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,r),!0}catch{return!1}}renameSheet(e,r){Ce(e,"number","sheetId"),Ce(r,"string","newName");const n=this._crudOperations.renameSheet(e,r);n!==void 0&&this._emitter.emit(qo.SheetRenamed,n,r)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(r){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),r}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(qo.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(qo.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,r,n){Ce(e,"string","expressionName"),n!==void 0&&Ce(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,r,n),!0}catch{return!1}}addNamedExpression(e,r,n,i){Ce(e,"string","expressionName"),n!==void 0&&Ce(n,"number","scope"),this._crudOperations.addNamedExpression(e,r,n,i);const o=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(qo.NamedExpressionAdded,e,o),o}getNamedExpressionValue(e,r){Ce(e,"string","expressionName"),r!==void 0&&Ce(r,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(r);const n=this._namedExpressions.namedExpressionForScope(e,r);if(n)return this._serialization.getCellValue(n.address)}getNamedExpressionFormula(e,r){Ce(e,"string","expressionName"),r!==void 0&&Ce(r,"number","scope"),this._crudOperations.ensureScopeIdIsValid(r);const n=this._namedExpressions.namedExpressionForScope(e,r);if(n!==void 0)return this._serialization.getCellFormula(n.address)}getNamedExpression(e,r){Ce(e,"string","expressionName"),r!==void 0&&Ce(r,"number","scope");const n=this._namedExpressions.namedExpressionForScope(e,r);if(n===void 0)return;const i=this._serialization.getCellFormula(n.address);return{name:e,scope:r,expression:i,options:n.options}}isItPossibleToChangeNamedExpression(e,r,n){Ce(e,"string","expressionName"),n!==void 0&&Ce(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,r,n),!0}catch{return!1}}changeNamedExpression(e,r,n,i){return Ce(e,"string","expressionName"),n!==void 0&&Ce(n,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,n,r,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,r){Ce(e,"string","expressionName"),r!==void 0&&Ce(r,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,r),!0}catch{return!1}}removeNamedExpression(e,r){Ce(e,"string","expressionName"),r!==void 0&&Ce(r,"number","scope");const n=this._crudOperations.removeNamedExpression(e,r);if(n){const i=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(qo.NamedExpressionRemoved,n.displayName,i),i}else return[]}listNamedExpressions(e){return e!==void 0&&Ce(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){Ce(e,"string","formulaString");const{ast:r,address:n}=this.extractTemporaryFormula(e);if(r===void 0)throw new $A;return this._unparser.unparse(r,n)}calculateFormula(e,r){Ce(e,"string","formulaString"),Ce(r,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(r);const{ast:n,address:i,dependencies:o}=this.extractTemporaryFormula(e,r);if(n===void 0)throw new $A;const a=this.evaluator.runAndForget(n,i,o);return this._exporter.exportScalarOrRange(a)}validateFormula(e){Ce(e,"string","formulaString");const{ast:r}=this.extractTemporaryFormula(e);return!(r===void 0||r.type===F.ERROR&&!r.error)}getRegisteredFunctionNames(){return Pn.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return Ce(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return Ce(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return Ce(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return Ce(e,"number","val"),nh(e)}on(e,r){this._emitter.on(e,r)}once(e,r){this._emitter.once(e,r)}off(e,r){this._emitter.off(e,r)}destroy(){Kut(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new Lee}extractTemporaryFormula(e,r=1){const n=this._cellContentParser.parse(e),i={sheet:r,col:0,row:0};if(!(n instanceof hr.Formula))return{address:i,dependencies:[]};const{ast:o,errors:a,dependencies:s}=this._parser.parse(n.formula,i);return a.length>0?{address:i,dependencies:[]}:{ast:o,address:i,dependencies:s}}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),r=Array.from(this.dependencyGraph.verticesToRecompute());this.dependencyGraph.clearRecentlyChangedVertices(),r.length>0&&e.addAll(this.evaluator.partialRun(r));const n=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(qo.ValuesUpdated,n),n}}}Pn.version="2.3.1";Pn.buildDate="03/03/2023 09:26:52";Pn.releaseDate="03/03/2023";Pn.languages={};Pn.registeredLanguages=new Map;/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const oj=new WeakMap;class xn{constructor(e={},r=!0){const{accentSensitive:n,binarySearchThreshold:i,caseSensitive:o,caseFirst:a,chooseAddressMappingPolicy:s,currencySymbol:l,dateFormats:u,decimalSeparator:c,evaluateNullToZero:f,functionArgSeparator:h,functionPlugins:d,ignorePunctuation:p,leapYear1900:m,localeLang:g,language:v,ignoreWhiteSpace:S,licenseKey:b,matchWholeCell:E,arrayColumnSeparator:T,arrayRowSeparator:N,maxRows:L,maxColumns:V,nullYear:B,nullDate:k,parseDateTime:M,precisionEpsilon:G,precisionRounding:j,stringifyDateTime:q,stringifyDuration:te,smartRounding:pe,timeFormats:ne,thousandSeparator:O,useArrayArithmetic:y,useStats:R,undoLimit:C,useColumnIndex:A,useRegularExpressions:P,useWildcards:H}=e;r&&xn.warnDeprecatedOptions(e),this.useArrayArithmetic=Vt(y,"boolean","useArrayArithmetic"),this.accentSensitive=Vt(n,"boolean","accentSensitive"),this.caseSensitive=Vt(o,"boolean","caseSensitive"),this.caseFirst=Vt(a,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=Vt(p,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=s!=null?s:xn.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...fb(u,Array.isArray,"array","dateFormats")],this.timeFormats=[...fb(ne,Array.isArray,"array","timeFormats")],this.functionArgSeparator=Vt(h,"string","functionArgSeparator"),this.decimalSeparator=Vt(c,[".",","],"decimalSeparator"),this.language=Vt(v,"string","language"),this.ignoreWhiteSpace=Vt(S,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=Vt(b,"string","licenseKey"),this.thousandSeparator=Vt(O,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=Vt(T,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=Vt(N,[";","|"],"arrayRowSeparator"),this.localeLang=Vt(g,"string","localeLang"),this.functionPlugins=[...d!=null?d:xn.defaultConfig.functionPlugins],this.smartRounding=Vt(pe,"boolean","smartRounding"),this.evaluateNullToZero=Vt(f,"boolean","evaluateNullToZero"),this.nullYear=Vt(B,"number","nullYear"),hf(this.nullYear,"nullYear",0),xlt(this.nullYear,"nullYear",100),this.precisionRounding=Vt(j,"number","precisionRounding"),hf(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=Vt(G,"number","precisionEpsilon"),hf(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=Vt(A,"boolean","useColumnIndex"),this.useStats=Vt(R,"boolean","useStats"),this.binarySearchThreshold=i!=null?i:xn.defaultConfig.binarySearchThreshold,this.parseDateTime=Vt(M,"function","parseDateTime"),this.stringifyDateTime=Vt(q,"function","stringifyDateTime"),this.stringifyDuration=Vt(te,"function","stringifyDuration"),this.translationPackage=Pn.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=fb(k,gg,"IDate","nullDate"),this.leapYear1900=Vt(m,"boolean","leapYear1900"),this.undoLimit=Vt(C,"number","undoLimit"),this.useRegularExpressions=Vt(P,"boolean","useRegularExpressions"),this.useWildcards=Vt(H,"boolean","useWildcards"),this.matchWholeCell=Vt(E,"boolean","matchWholeCell"),hf(this.undoLimit,"undoLimit",0),this.maxRows=Vt(L,"number","maxRows"),hf(this.maxRows,"maxRows",1),this.maxColumns=Vt(V,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(l),hf(this.maxColumns,"maxColumns",1),oj.set(this,{licenseKeyValidityState:Klt(this.licenseKey)}),zV({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),zV({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const r=[...fb(e,Array.isArray,"array","currencySymbol")];return r.forEach(n=>{if(typeof n!="string")throw new Bt("string[]","currencySymbol");if(n==="")throw new Kst("currencySymbol")}),r}get licenseKeyValidityState(){return oj.get(this).licenseKeyValidityState}getConfig(){return lte(this)}mergeConfig(e){const r=Object.assign({},this.getConfig(),e);return xn.warnDeprecatedOptions(e),new xn(r,!1)}static warnDeprecatedOptions(e){xn.warnDeprecatedIfUsed(e.binarySearchThreshold,"binarySearchThreshold","1.1")}static warnDeprecatedIfUsed(e,r,n,i){e!==void 0&&console.warn(i===void 0?`${r} option is deprecated since ${n}`:`${r} option is deprecated since ${n}, please use ${i}`)}}xn.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",chooseAddressMappingPolicy:new Llt,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:Ilt,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:Wlt,stringifyDuration:jlt,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};function lte(t){var e;const r={};for(const n in xn.defaultConfig){const i=(e=t[n])!==null&&e!==void 0?e:xn.defaultConfig[n];Array.isArray(i)?r[n]=[...i]:r[n]=i}return r}function Zut(){return lte({})}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const YA={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ute extends pt{arrayformula(e,r){return this.runFunction(e.args,r,this.metadata("ARRAYFORMULA"),n=>n)}arrayformulaArraySize(e,r){if(e.args.length!==1)return yt.error();const n=this.metadata("ARRAYFORMULA");return e.args.map(o=>{var a;return this.arraySizeForAst(o,new aa(r.formulaAddress,r.arraysFlag||((a=n==null?void 0:n.arrayFunction)!==null&&a!==void 0?a:!1)))})[0]}arrayconstrain(e,r){return this.runFunction(e.args,r,this.metadata("ARRAY_CONSTRAIN"),(n,i,o)=>{i=Math.min(i,n.height()),o=Math.min(o,n.width());const a=n.data,s=[];for(let l=0;l<i;l++)s.push(a[l].slice(0,o));return je.onlyValues(s)})}arrayconstrainArraySize(e,r){if(e.args.length!==3)return yt.error();const n=this.metadata("ARRAY_CONSTRAIN"),i=e.args.map(s=>{var l;return this.arraySizeForAst(s,new aa(r.formulaAddress,r.arraysFlag||((l=n==null?void 0:n.arrayFunction)!==null&&l!==void 0?l:!1)))});let{height:o,width:a}=i[0];return e.args[1].type===F.NUMBER&&(o=Math.min(o,e.args[1].value)),e.args[2].type===F.NUMBER&&(a=Math.min(a,e.args[2].value)),o<1||a<1||!Number.isInteger(o)||!Number.isInteger(a)?yt.error():new yt(a,o)}filter(e,r){return this.runFunction(e.args,r,this.metadata("FILTER"),(n,...i)=>{for(const s of i)if(n.width()!==s.width()||n.height()!==s.height())return new x($.NA,W.EqualLength);if(n.width()>1&&n.height()>1)return new x($.NA,W.WrongDimension);const o=n.data,a=[];for(let s=0;s<n.height();s++){const l=[];for(let u=0;u<n.width();u++){let c=!0;for(const f of i)if(jee(f.data[s][u])!==!0){c=!1;break}c&&l.push(o[s][u])}l.length>0&&a.push(l)}return a.length>0?je.onlyValues(a):new x($.NA,W.EmptyRange)})}filterArraySize(e,r){if(e.args.length<=1)return yt.error();const n=this.metadata("FILTER"),i=e.args.map(s=>{var l;return this.arraySizeForAst(s,new aa(r.formulaAddress,r.arraysFlag||((l=n==null?void 0:n.arrayFunction)!==null&&l!==void 0?l:!1)))}),o=Math.max(...i.map(s=>s.width)),a=Math.max(...i.map(s=>s.height));return new yt(o,a)}}ute.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:w.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:w.RANGE},{argumentType:w.INTEGER,minValue:1},{argumentType:w.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class cte extends pt{abs(e,r){return this.runFunction(e.args,r,this.metadata("ABS"),Math.abs)}}cte.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const Jut=0xffffffffffff,aj=-53,sj=53;class fte extends pt{bitlshift(e,r){return this.runFunction(e.args,r,this.metadata("BITLSHIFT"),hte)}bitrshift(e,r){return this.runFunction(e.args,r,this.metadata("BITRSHIFT"),dte)}}fte.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:w.INTEGER,minValue:0},{argumentType:w.INTEGER,minValue:aj,maxValue:sj}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:w.INTEGER,minValue:0},{argumentType:w.INTEGER,minValue:aj,maxValue:sj}]}};function hte(t,e){return e<0?dte(t,-e):pte(t*Math.pow(2,e))}function dte(t,e){return e<0?hte(t,-e):pte(Math.floor(t/Math.pow(2,e)))}function pte(t){return t>Jut?new x($.NUM,W.BitshiftLong):t}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class mte extends pt{bitand(e,r){return this.runFunction(e.args,r,this.metadata("BITAND"),(n,i)=>n&i)}bitor(e,r){return this.runFunction(e.args,r,this.metadata("BITOR"),(n,i)=>n|i)}bitxor(e,r){return this.runFunction(e.args,r,this.metadata("BITXOR"),(n,i)=>n^i)}}mte.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:w.INTEGER,minValue:0},{argumentType:w.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:w.INTEGER,minValue:0},{argumentType:w.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:w.INTEGER,minValue:0},{argumentType:w.INTEGER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class gte extends pt{literalTrue(e,r){return this.runFunction(e.args,r,this.metadata("TRUE"),()=>!0)}literalFalse(e,r){return this.runFunction(e.args,r,this.metadata("FALSE"),()=>!1)}conditionalIf(e,r){return this.runFunction(e.args,r,this.metadata("IF"),(n,i,o)=>n?i:o)}and(e,r){return this.runFunction(e.args,r,this.metadata("AND"),(...n)=>n.filter(i=>i!==void 0).every(i=>!!i))}or(e,r){return this.runFunction(e.args,r,this.metadata("OR"),(...n)=>n.filter(i=>i!==void 0).some(i=>i))}not(e,r){return this.runFunction(e.args,r,this.metadata("NOT"),n=>!n)}xor(e,r){return this.runFunction(e.args,r,this.metadata("XOR"),(...n)=>{let i=0;return n.filter(o=>o!==void 0).forEach(o=>{o&&i++}),i%2===1})}switch(e,r){return this.runFunction(e.args,r,this.metadata("SWITCH"),(n,...i)=>{const o=i.length;let a=0;for(;a+1<o;a+=2)if(!(i[a]instanceof x)&&this.arithmeticHelper.eq(n,i[a]))return i[a+1];return a<o?i[a]:new x($.NA,W.NoDefault)})}iferror(e,r){return this.runFunction(e.args,r,this.metadata("IFERROR"),(n,i)=>n instanceof x?i:n)}ifna(e,r){return this.runFunction(e.args,r,this.metadata("IFNA"),(n,i)=>n instanceof x&&n.type===$.NA?i:n)}choose(e,r){return this.runFunction(e.args,r,this.metadata("CHOOSE"),(n,...i)=>n>i.length?new x($.NUM,W.Selector):i[n-1])}}gte.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:w.BOOLEAN},{argumentType:w.SCALAR,passSubtype:!0},{argumentType:w.SCALAR,defaultValue:!1,passSubtype:!0}]},AND:{method:"and",parameters:[{argumentType:w.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:w.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:w.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:w.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:w.NOERROR},{argumentType:w.SCALAR,passSubtype:!0},{argumentType:w.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:w.SCALAR,passSubtype:!0},{argumentType:w.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:w.SCALAR,passSubtype:!0},{argumentType:w.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:w.INTEGER,minValue:1},{argumentType:w.SCALAR,passSubtype:!0}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class yte extends pt{char(e,r){return this.runFunction(e.args,r,this.metadata("CHAR"),n=>n<1||n>=256?new x($.VALUE,W.CharacterCodeBounds):String.fromCharCode(Math.trunc(n)))}unichar(e,r){return this.runFunction(e.args,r,this.metadata("CHAR"),n=>n<1||n>=1114112?new x($.VALUE,W.CharacterCodeBounds):String.fromCodePoint(Math.trunc(n)))}}yte.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:w.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class vte extends pt{code(e,r){return this.runFunction(e.args,r,this.metadata("CODE"),n=>n.length===0?new x($.VALUE,W.EmptyString):n.charCodeAt(0))}unicode(e,r){return this.runFunction(e.args,r,this.metadata("UNICODE"),n=>{var i;return(i=n.codePointAt(0))!==null&&i!==void 0?i:new x($.VALUE,W.EmptyString)})}}vte.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:w.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:w.STRING}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class bte extends pt{countblank(e,r){return this.runFunction(e.args,r,this.metadata("COUNTBLANK"),(...n)=>{let i=0;return n.forEach(o=>{o===_t&&i++}),i})}}bte.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:w.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class wte extends pt{countunique(e,r){return this.runFunction(e.args,r,this.metadata("COUNTUNIQUE"),(...n)=>{const i=new Set,o=new Set;for(const a of n)a instanceof x?o.add(a.type):a!==""&&i.add(a);return i.size+o.size})}}wte.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:w.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ste extends pt{constructor(){super(...arguments),this.isoweeknumCore=e=>{const r=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),n=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.dateToNumber({year:n.year,month:1,day:1}),o=this.dateTimeHelper.relativeNumberToAbsoluteNumber(i),a=o+((4-o)%7+7)%7,s=Math.floor((r-1)/7)-Math.floor((a-1)/7)+1;return s===0?this.isoweeknumCore(e-7)+1:s},this.days360Core=(e,r,n)=>{const i=this.dateTimeHelper.numberToSimpleDate(e),o=this.dateTimeHelper.numberToSimpleDate(r);let a,s;return n?(a=qV(i),s=qV(o)):[a,s]=this.dateTimeHelper.toBasisUS(i,o),360*(s.year-a.year)+30*(s.month-a.month)+s.day-a.day}}date(e,r){return this.runFunction(e.args,r,this.metadata("DATE"),(n,i,o)=>{const a=Math.trunc(o);let s=Math.trunc(i),l=Math.trunc(n);l<this.dateTimeHelper.getEpochYearZero()&&(l+=this.dateTimeHelper.getEpochYearZero());const u=Math.floor((s-1)/12);l+=u,s-=u*12;const c={year:l,month:s,day:1};if(this.dateTimeHelper.isValidDate(c)){let f=this.dateTimeHelper.dateToNumber(c)+(a-1);return f=this.dateTimeHelper.getWithinBounds(f),f===void 0?new x($.NUM,W.DateBounds):f}return new x($.VALUE,W.InvalidDate)})}time(e,r){return this.runFunction(e.args,r,this.metadata("TIME"),(n,i,o)=>{const a=ih({hours:Math.trunc(n),minutes:Math.trunc(i),seconds:Math.trunc(o)});return a<0?new x($.NUM,W.NegativeTime):a%1})}eomonth(e,r){return this.runFunction(e.args,r,this.metadata("EOMONTH"),(n,i)=>{const o=this.dateTimeHelper.numberToSimpleDate(n);let a=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(KV(o,i)));return a=this.dateTimeHelper.getWithinBounds(a),a===void 0?new x($.NUM,W.DateBounds):a})}day(e,r){return this.runFunction(e.args,r,this.metadata("DAY"),n=>this.dateTimeHelper.numberToSimpleDate(n).day)}days(e,r){return this.runFunction(e.args,r,this.metadata("DAYS"),(n,i)=>Math.trunc(n)-Math.trunc(i))}month(e,r){return this.runFunction(e.args,r,this.metadata("MONTH"),n=>this.dateTimeHelper.numberToSimpleDate(n).month)}year(e,r){return this.runFunction(e.args,r,this.metadata("YEAR"),n=>this.dateTimeHelper.numberToSimpleDate(n).year)}hour(e,r){return this.runFunction(e.args,r,this.metadata("HOUR"),n=>nh(ZC(n)%1).hours)}minute(e,r){return this.runFunction(e.args,r,this.metadata("MINUTE"),n=>nh(ZC(n)%1).minutes)}second(e,r){return this.runFunction(e.args,r,this.metadata("SECOND"),n=>nh(ZC(n)%1).seconds)}text(e,r){return this.runFunction(e.args,r,this.metadata("TEXT"),(n,i)=>Blt(n,i,this.config,this.dateTimeHelper))}weekday(e,r){return this.runFunction(e.args,r,this.metadata("WEEKDAY"),(n,i)=>{const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(n));if(i===3)return(o-1)%7;const a=cj.get(i);return a===void 0?new x($.NUM,W.BadMode):(o-a)%7+1})}weeknum(e,r){return this.runFunction(e.args,r,this.metadata("WEEKNUM"),(n,i)=>{const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(n)),a=this.dateTimeHelper.numberToSimpleDate(n),s=this.dateTimeHelper.dateToNumber({year:a.year,month:1,day:1}),l=this.dateTimeHelper.relativeNumberToAbsoluteNumber(s);if(i===21)return this.isoweeknumCore(n);const u=cj.get(i);return u===void 0?new x($.NUM,W.BadMode):Math.floor((o-u)/7)-Math.floor((l-u)/7)+1})}isoweeknum(e,r){return this.runFunction(e.args,r,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,r){return this.runFunction(e.args,r,this.metadata("DATEVALUE"),n=>{const{dateTime:i}=this.dateTimeHelper.parseDateTimeFromConfigFormats(n);return i===void 0?new x($.VALUE,W.IncorrectDateTime):gg(i)?(Kee(i)?Math.trunc(ih(i)):0)+this.dateTimeHelper.dateToNumber(i):0})}timevalue(e,r){return this.runFunction(e.args,r,this.metadata("TIMEVALUE"),n=>{const i=this.dateTimeHelper.dateStringToDateNumber(n);return i===void 0?new x($.VALUE,W.IncorrectDateTime):Ne(i)%1})}now(e,r){return this.runFunction(e.args,r,this.metadata("NOW"),()=>{const n=new Date(Date.now());return ih({hours:n.getHours(),minutes:n.getMinutes(),seconds:n.getSeconds()})+this.dateTimeHelper.dateToNumber({year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()})})}today(e,r){return this.runFunction(e.args,r,this.metadata("TODAY"),()=>{const n=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()})})}edate(e,r){return this.runFunction(e.args,r,this.metadata("EDATE"),(n,i)=>{const o=this.dateTimeHelper.numberToSimpleDate(n),a=klt(KV(o,i));let s=this.dateTimeHelper.dateToNumber(a);return s=this.dateTimeHelper.getWithinBounds(s),s===void 0?new x($.NUM,W.DateBounds):s})}datedif(e,r){return this.runFunction(e.args,r,this.metadata("DATEDIF"),(n,i,o)=>{if(n>i)return new x($.NUM,W.StartEndDate);if(o==="D")return Math.floor(i)-Math.floor(n);const a=this.dateTimeHelper.numberToSimpleDate(n),s=this.dateTimeHelper.numberToSimpleDate(i);switch(o){case"M":return(s.year-a.year)*12+(s.month-a.month)-(s.day<a.day?1:0);case"YM":return(12+(s.month-a.month)-(s.day<a.day?1:0))%12;case"Y":return s.month>a.month||s.month===a.month&&s.day>=a.day?s.year-a.year:s.year-a.year-1;case"MD":if(s.day>=a.day)return s.day-a.day;{const l=s.month===1?12:s.month-1,u=s.month===1?s.year-1:s.year;return this.dateTimeHelper.daysInMonth(u,l)+s.day-a.day}case"YD":return s.month>a.month||s.month===a.month&&s.day>=a.day?Math.floor(i)-this.dateTimeHelper.dateToNumber({year:s.year,month:a.month,day:a.day}):Math.floor(i)-Math.floor(n)-365*(s.year-a.year-1)-this.dateTimeHelper.leapYearsCount(s.year-1)+this.dateTimeHelper.leapYearsCount(a.year);default:return new x($.NUM,W.BadMode)}})}days360(e,r){return this.runFunction(e.args,r,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,r){return this.runFunction(e.args,r,this.metadata("YEARFRAC"),(n,i,o)=>{switch(n=Math.trunc(n),i=Math.trunc(i),n>i&&([n,i]=[i,n]),o){case 0:return this.days360Core(n,i,!1)/360;case 1:return(i-n)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(n),this.dateTimeHelper.numberToSimpleDate(i));case 2:return(i-n)/360;case 3:return(i-n)/365;case 4:return this.days360Core(n,i,!0)/360}throw new Error("Should not be reachable.")})}interval(e,r){return this.runFunction(e.args,r,this.metadata("INTERVAL"),n=>{n=Math.trunc(n);const i=n%60;n=Math.trunc(n/60);const o=n%60;n=Math.trunc(n/60);const a=n%24;n=Math.trunc(n/24);const s=n%30;n=Math.trunc(n/30);const l=n%12,u=Math.trunc(n/12);return"P"+(u>0?u+"Y":"")+(l>0?l+"M":"")+(s>0?s+"D":"")+"T"+(a>0?a+"H":"")+(o>0?o+"M":"")+(i>0?i+"S":"")})}networkdays(e,r){return this.runFunction(e.args,r,this.metadata("NETWORKDAYS"),(n,i,o)=>this.networkdayscore(n,i,1,o))}networkdaysintl(e,r){return this.runFunction(e.args,r,this.metadata("NETWORKDAYS.INTL"),(n,i,o,a)=>this.networkdayscore(n,i,o,a))}workday(e,r){return this.runFunction(e.args,r,this.metadata("WORKDAY"),(n,i,o)=>this.workdaycore(n,i,1,o))}workdayintl(e,r){return this.runFunction(e.args,r,this.metadata("WORKDAY.INTL"),(n,i,o,a)=>this.workdaycore(n,i,o,a))}networkdayscore(e,r,n,i){e=Math.trunc(e),r=Math.trunc(r);let o=1;e>r&&([e,r]=[r,e],o=-1);const a=uj(n);if(a instanceof x)return a;const s=this.simpleRangeToFilteredHolidays(a,i);return s instanceof x?s:o*this.countWorkdays(e,r,a,s)}workdaycore(e,r,n,i){e=Math.trunc(e),r=Math.trunc(r);const o=uj(n);if(o instanceof x)return o;const a=this.simpleRangeToFilteredHolidays(o,i);if(a instanceof x)return a;if(r>0){let s=1;for(;this.countWorkdays(e+1,e+s,o,a)<r;)s*=2;let l=1;for(;l+1<s;){const u=Math.trunc((l+s)/2);this.countWorkdays(e+1,e+u,o,a)<r?l=u:s=u}return e+s}else if(r<0){r*=-1;let s=1;for(;this.countWorkdays(e-s,e-1,o,a)<r;)s*=2;let l=1;for(;l+1<s;){const u=Math.trunc((l+s)/2);this.countWorkdays(e-u,e-1,o,a)<r?l=u:s=u}return e-s}else return e}countWorkdays(e,r,n,i){const o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(r)),a=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let s=0;for(let l=0;l<7;l++)n.charAt(l)==="0"&&(s+=Math.floor((o+6-l)/7),s-=Math.floor((a-1+6-l)/7));return s-=lj(r+1,i)-lj(e,i),s}simpleRangeToFilteredHolidays(e,r){var n;const i=(n=r==null?void 0:r.valuesFromTopLeftCorner())!==null&&n!==void 0?n:[];for(const a of i)if(a instanceof x)return a;const o=[];for(const a of i)if(a!==_t)if(Ft(a))o.push(Math.trunc(Ne(a)));else return new x($.VALUE,W.WrongType);return[...new Set(o)].sort((a,s)=>a-s).filter(a=>{const l=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(a)-1)%7;return e.charAt(l)==="0"})}}Ste.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER}],returnNumberType:Be.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER}],returnNumberType:Be.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:w.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:w.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:w.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:w.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:w.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:w.NUMBER},{argumentType:w.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER}],returnNumberType:Be.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:w.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:w.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:w.STRING}],returnNumberType:Be.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:w.STRING}],returnNumberType:Be.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:Be.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:Be.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER}],returnNumberType:Be.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:w.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.NOERROR,defaultValue:1},{argumentType:w.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER},{argumentType:w.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER},{argumentType:w.NOERROR,defaultValue:1},{argumentType:w.RANGE,optionalArg:!0}]}};function lj(t,e){if(e.length===0||t<=e[0])return 0;if(e[e.length-1]<t)return e.length;let r=0,n=e.length-1;for(;r+1<n;){const i=Math.floor((n+r)/2);e[i]>=t?n=i:r=i}return n}function uj(t){var e;return typeof t!="number"&&typeof t!="string"?new x($.VALUE,W.WrongType):typeof t=="string"?t.length!==7||!/^(0|1)*$/.test(t)||t==="1111111"?new x($.NUM,W.WeekendString):t:(e=ect.get(t))!==null&&e!==void 0?e:new x($.NUM,W.BadMode)}const cj=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),ect=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Rte extends pt{degrees(e,r){return this.runFunction(e.args,r,this.metadata("DEGREES"),n=>n*(180/Math.PI))}}Rte.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ete extends pt{delta(e,r){return this.runFunction(e.args,r,this.metadata("DELTA"),(n,i)=>n===i?1:0)}}Ete.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Cte extends pt{exp(e,r){return this.runFunction(e.args,r,this.metadata("EXP"),Math.exp)}}Cte.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class _te extends pt{pmt(e,r){return this.runFunction(e.args,r,this.metadata("PMT"),KI)}ipmt(e,r){return this.runFunction(e.args,r,this.metadata("IPMT"),KA)}ppmt(e,r){return this.runFunction(e.args,r,this.metadata("PPMT"),fj)}fv(e,r){return this.runFunction(e.args,r,this.metadata("FV"),qA)}cumipmt(e,r){return this.runFunction(e.args,r,this.metadata("CUMIPMT"),(n,i,o,a,s,l)=>{if(a>s)return new x($.NUM,W.EndStartPeriod);let u=0;for(let c=a;c<=s;c++)u+=KA(n,c,i,o,0,l);return u})}cumprinc(e,r){return this.runFunction(e.args,r,this.metadata("CUMPRINC"),(n,i,o,a,s,l)=>{if(a>s)return new x($.NUM,W.EndStartPeriod);let u=0;for(let c=a;c<=s;c++)u+=fj(n,c,i,o,0,l);return u})}db(e,r){return this.runFunction(e.args,r,this.metadata("DB"),(n,i,o,a,s)=>{if(s===12&&a>o||a>o+1)return new x($.NUM,W.PeriodLong);if(i>=n)return 0;const l=Math.round((1-Math.pow(i/n,1/o))*1e3)/1e3,u=n*l*s/12;if(a===1)return u;let c=u;for(let f=0;f<a-2;f++)c+=(n-c)*l;return a===o+1?(n-c)*l*(12-s)/12:(n-c)*l})}ddb(e,r){return this.runFunction(e.args,r,this.metadata("DDB"),(n,i,o,a,s)=>{if(a>o)return new x($.NUM);let l=s/o,u;l>=1?(l=1,a===1?u=n:u=0):u=n*Math.pow(1-l,a-1);const c=n*Math.pow(1-l,a);return Math.max(u-Math.max(i,c),0)})}dollarde(e,r){return this.runFunction(e.args,r,this.metadata("DOLLARDE"),(n,i)=>{if(i<1)return new x($.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(n)+(n-Math.trunc(n))*10/i})}dollarfr(e,r){return this.runFunction(e.args,r,this.metadata("DOLLARFR"),(n,i)=>{if(i<1)return new x($.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(n)+(n-Math.trunc(n))*i/10})}effect(e,r){return this.runFunction(e.args,r,this.metadata("EFFECT"),(n,i)=>(i=Math.trunc(i),Math.pow(1+n/i,i)-1))}ispmt(e,r){return this.runFunction(e.args,r,this.metadata("ISPMT"),(n,i,o,a)=>o===0?new x($.DIV_BY_ZERO):a*n*(i/o-1))}nominal(e,r){return this.runFunction(e.args,r,this.metadata("NOMINAL"),(n,i)=>(i=Math.trunc(i),(Math.pow(n+1,1/i)-1)*i))}nper(e,r){return this.runFunction(e.args,r,this.metadata("NPER"),(n,i,o,a,s)=>n===0?i===0?new x($.DIV_BY_ZERO):(-o-a)/i:(s&&(i*=1+n),Math.log((i-a*n)/(o*n+i))/Math.log(1+n)))}rate(e,r){return this.runFunction(e.args,r,this.metadata("RATE"),(n,i,o,a,s,l)=>{if(l<=-1)return new x($.VALUE);const u=1e-7,c=50;let f=l;s=s?1:0;for(let h=0;h<c;h++){if(f<=-1)return new x($.NUM);let d;if(Math.abs(f)<u)d=o*(1+n*f)+i*(1+f*s)*n+a;else{const m=Math.pow(1+f,n);d=o*m+i*(1/f+s)*(m-1)+a}if(Math.abs(d)<u)return f;let p;if(Math.abs(f)<u)p=o*n+i*s*n;else{const m=Math.pow(1+f,n),g=n*Math.pow(1+f,n-1);p=o*g+i*(1/f+s)*g+i*(-1/(f*f))*(m-1)}f-=d/p}return new x($.NUM)})}pv(e,r){return this.runFunction(e.args,r,this.metadata("PV"),(n,i,o,a,s)=>(s=s?1:0,n===-1?i===0?new x($.NUM):new x($.DIV_BY_ZERO):n===0?-o*i-a:((1-Math.pow(1+n,i))*o*(1+n*s)/n-a)/Math.pow(1+n,i)))}rri(e,r){return this.runFunction(e.args,r,this.metadata("RRI"),(n,i,o)=>i===0||o<0&&i>0||o>0&&i<0?new x($.NUM):Math.pow(o/i,1/n)-1)}sln(e,r){return this.runFunction(e.args,r,this.metadata("SLN"),(n,i,o)=>o===0?new x($.DIV_BY_ZERO):(n-i)/o)}syd(e,r){return this.runFunction(e.args,r,this.metadata("SYD"),(n,i,o,a)=>a>o?new x($.NUM):(n-i)*(o-a+1)*2/(o*(o+1)))}tbilleq(e,r){return this.runFunction(e.args,r,this.metadata("TBILLEQ"),(n,i,o)=>{if(n=Math.round(n),i=Math.round(i),n>=i)return new x($.NUM);const a=this.dateTimeHelper.numberToSimpleDate(n),s=this.dateTimeHelper.numberToSimpleDate(i);if(s.year>a.year+1||s.year===a.year+1&&(s.month>a.month||s.month===a.month&&s.day>a.day))return new x($.NUM);const l=360-o*(i-n);return l===0?0:l<0?new x($.NUM):365*o/l})}tbillprice(e,r){return this.runFunction(e.args,r,this.metadata("TBILLPRICE"),(n,i,o)=>{if(n=Math.round(n),i=Math.round(i),n>=i)return new x($.NUM);const a=this.dateTimeHelper.numberToSimpleDate(n),s=this.dateTimeHelper.numberToSimpleDate(i);if(s.year>a.year+1||s.year===a.year+1&&(s.month>a.month||s.month===a.month&&s.day>a.day))return new x($.NUM);const l=360-o*(i-n);return l===0?0:l<0?new x($.NUM):100*(1-o*(i-n)/360)})}tbillyield(e,r){return this.runFunction(e.args,r,this.metadata("TBILLYIELD"),(n,i,o)=>{if(n=Math.round(n),i=Math.round(i),n>=i)return new x($.NUM);const a=this.dateTimeHelper.numberToSimpleDate(n),s=this.dateTimeHelper.numberToSimpleDate(i);return s.year>a.year+1||s.year===a.year+1&&(s.month>a.month||s.month===a.month&&s.day>a.day)?new x($.NUM):(100-o)*360/(o*(i-n))})}fvschedule(e,r){return this.runFunction(e.args,r,this.metadata("FVSCHEDULE"),(n,i)=>{const o=i.valuesFromTopLeftCorner();for(const a of o)if(a instanceof x)return a;for(const a of o)if(Ft(a))n*=1+Ne(a);else if(a!==_t)return new x($.VALUE,W.NumberExpected);return n})}npv(e,r){return this.runFunction(e.args,r,this.metadata("NPV"),(n,...i)=>{const o=this.arithmeticHelper.coerceNumbersExactRanges(i);return o instanceof x?o:t_(n,o)})}mirr(e,r){return this.runFunction(e.args,r,this.metadata("MIRR"),(n,i,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());if(a instanceof x)return a;let s=!1,l=!1;const u=[],c=[];for(const p of a)p>0?(s=!0,u.push(p),c.push(0)):p<0?(l=!0,c.push(p),u.push(0)):(c.push(0),u.push(0));if(!s||!l)return new x($.DIV_BY_ZERO);const f=a.length,h=t_(o,u);if(h instanceof x)return h;const d=t_(i,c);return d instanceof x?d:Math.pow(-h*Math.pow(1+o,f)/d/(1+i),1/(f-1))-1})}pduration(e,r){return this.runFunction(e.args,r,this.metadata("PDURATION"),(n,i,o)=>(Math.log(o)-Math.log(i))/Math.log(1+n))}xnpv(e,r){return this.runFunction(e.args,r,this.metadata("XNPV"),(n,i,o)=>{const a=i.valuesFromTopLeftCorner();for(const h of a)if(typeof h!="number")return new x($.VALUE,W.NumberExpected);const s=a,l=o.valuesFromTopLeftCorner();for(const h of l)if(typeof h!="number")return new x($.VALUE,W.NumberExpected);const u=l;if(u.length!==s.length)return new x($.NUM,W.EqualLength);const c=u.length;let f=0;if(u[0]<0)return new x($.NUM,W.ValueSmall);for(let h=0;h<c;h++){if(u[h]=Math.floor(u[h]),u[h]<u[0])return new x($.NUM,W.ValueSmall);f+=s[h]/Math.pow(1+n,(u[h]-u[0])/365)}return f})}}_te.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:0}],returnNumberType:Be.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:0}],returnNumberType:Be.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:0}],returnNumberType:Be.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:0}],returnNumberType:Be.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.INTEGER,minValue:1},{argumentType:w.INTEGER,minValue:1},{argumentType:w.INTEGER,minValue:0,maxValue:1}],returnNumberType:Be.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.INTEGER,minValue:1},{argumentType:w.INTEGER,minValue:1},{argumentType:w.INTEGER,minValue:0,maxValue:1}],returnNumberType:Be.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.INTEGER,minValue:0},{argumentType:w.INTEGER,minValue:0},{argumentType:w.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:Be.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.INTEGER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:Be.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:1}],returnNumberType:Be.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:1}],returnNumberType:Be.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:0}],returnNumberType:Be.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:.1}],returnNumberType:Be.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER},{argumentType:w.NUMBER}],returnNumberType:Be.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER}],returnNumberType:Be.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0}],returnNumberType:Be.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,greaterThan:0}],returnNumberType:Be.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,greaterThan:0}],returnNumberType:Be.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,greaterThan:0}],returnNumberType:Be.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:w.NUMBER},{argumentType:w.RANGE}],returnNumberType:Be.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:w.NUMBER},{argumentType:w.ANY}],repeatLastArgs:1,returnNumberType:Be.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:w.RANGE},{argumentType:w.NUMBER},{argumentType:w.NUMBER}],returnNumberType:Be.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:w.NUMBER,greaterThan:-1},{argumentType:w.RANGE},{argumentType:w.RANGE}]}};function KI(t,e,r,n,i){if(t===0)return(-r-n)/e;{const o=Math.pow(1+t,e);return(n*t+r*t*o)*(i?1/(1+t):1)/(1-o)}}function KA(t,e,r,n,i,o){const a=KI(t,r,n,i,o);return e===1?t*(o?0:-n):t*(o?qA(t,e-2,a,n,o)-a:qA(t,e-1,a,n,o))}function qA(t,e,r,n,i){if(t===0)return-n-r*e;{const o=Math.pow(1+t,e);return r*(i?1+t:1)*(1-o)/t-n*o}}function fj(t,e,r,n,i,o){return KI(t,r,n,i,o)-KA(t,e,r,n,i,o)}function t_(t,e){let r=0;for(let n=e.length-1;n>=0;n--){if(r+=e[n],t===-1){if(r===0)continue;return new x($.DIV_BY_ZERO)}r/=1+t}return r}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Tte extends pt{formulatext(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("FORMULATEXT"),()=>new x($.NA,W.WrongArgNumber),n=>{var i;return(i=this.serialization.getCellFormula(n))!==null&&i!==void 0?i:new x($.NA,W.Formula)})}}Tte.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:w.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ote extends pt{isbinary(e,r){return this.runFunction(e.args,r,this.metadata("ISBINARY"),n=>/^[01]{1,10}$/.test(n))}iserr(e,r){return this.runFunction(e.args,r,this.metadata("ISERR"),n=>n instanceof x&&n.type!==$.NA)}iserror(e,r){return this.runFunction(e.args,r,this.metadata("ISERROR"),n=>n instanceof x)}isformula(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("ISFORMULA"),()=>new x($.NA,W.WrongArgNumber),n=>this.dependencyGraph.addressMapping.getCell(n)instanceof Ni)}isblank(e,r){return this.runFunction(e.args,r,this.metadata("ISBLANK"),n=>n===_t)}isna(e,r){return this.runFunction(e.args,r,this.metadata("ISNA"),n=>n instanceof x&&n.type==$.NA)}isnumber(e,r){return this.runFunction(e.args,r,this.metadata("ISNUMBER"),Ft)}islogical(e,r){return this.runFunction(e.args,r,this.metadata("ISLOGICAL"),n=>typeof n=="boolean")}isref(e,r){return this.runFunction(e.args,r,this.metadata("ISREF"),n=>n instanceof x&&(n.type==$.REF||n.type==$.CYCLE))}istext(e,r){return this.runFunction(e.args,r,this.metadata("ISTEXT"),n=>typeof n=="string")}isnontext(e,r){return this.runFunction(e.args,r,this.metadata("ISNONTEXT"),n=>typeof n!="string")}column(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("COLUMN"),()=>r.formulaAddress.col+1,n=>n.col+1)}columns(e,r){if(e.args.length!==1)return new x($.NA,W.WrongArgNumber);if(e.args.some(i=>i.type===F.EMPTY))return new x($.NUM,W.EmptyArg);let n=e.args[0];for(;n.type===F.PARENTHESIS;)n=n.expression;if(n.type===F.CELL_RANGE||n.type===F.COLUMN_RANGE)return n.end.col-n.start.col+1;if(n.type===F.CELL_REFERENCE)return 1;if(n.type===F.ROW_RANGE)return this.config.maxColumns;{const i=this.evaluateAst(n,r);return i instanceof je?i.width():i instanceof x?i:1}}row(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("ROW"),()=>r.formulaAddress.row+1,n=>n.row+1)}rows(e,r){if(e.args.length!==1)return new x($.NA,W.WrongArgNumber);if(e.args.some(i=>i.type===F.EMPTY))return new x($.NUM,W.EmptyArg);let n=e.args[0];for(;n.type===F.PARENTHESIS;)n=n.expression;if(n.type===F.CELL_RANGE||n.type===F.ROW_RANGE)return n.end.row-n.start.row+1;if(n.type===F.CELL_REFERENCE)return 1;if(n.type===F.COLUMN_RANGE)return this.config.maxRows;{const i=this.evaluateAst(n,r);return i instanceof je?i.height():i instanceof x?i:1}}index(e,r){return this.runFunction(e.args,r,this.metadata("INDEX"),(n,i,o)=>{var a,s,l,u,c,f;return o<1||i<1?new x($.VALUE,W.LessThanOne):o>n.width()||i>n.height()?new x($.NUM,W.ValueLarge):(f=(l=(s=(a=n==null?void 0:n.data)===null||a===void 0?void 0:a[i-1])===null||s===void 0?void 0:s[o-1])!==null&&l!==void 0?l:(c=(u=n==null?void 0:n.data)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c[0])!==null&&f!==void 0?f:new x($.VALUE,W.CellRangeExpected)})}na(e,r){return new x($.NA)}sheet(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("SHEET"),()=>r.formulaAddress.sheet+1,n=>n.sheet+1,n=>{const i=this.dependencyGraph.sheetMapping.get(n);return i!==void 0?i+1:new x($.NA,W.SheetRef)})}sheets(e,r){return this.runFunctionWithReferenceArgument(e.args,r,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new x($.VALUE,W.CellRefExpected))}}Ote.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:w.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:w.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:w.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:w.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:w.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:w.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:w.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:w.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:w.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:w.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:w.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:w.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:w.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:w.RANGE},{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:w.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:w.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:w.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:w.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ate extends pt{iseven(e,r){return this.runFunction(e.args,r,this.metadata("ISEVEN"),n=>n%2===0)}}Ate.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class xte extends pt{isodd(e,r){return this.runFunction(e.args,r,this.metadata("ISODD"),n=>n%2===1)}}xte.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ite extends pt{log10(e,r){return this.runFunction(e.args,r,this.metadata("LOG10"),Math.log10)}log(e,r){return this.runFunction(e.args,r,this.metadata("LOG"),(n,i)=>Math.log(n)/Math.log(i))}ln(e,r){return this.runFunction(e.args,r,this.metadata("LN"),Math.log)}}Ite.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:w.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const XA=parseFloat(Math.PI.toFixed(14));class Mte extends pt{pi(e,r){return this.runFunction(e.args,r,this.metadata("PI"),()=>XA)}sqrtpi(e,r){return this.runFunction(e.args,r,this.metadata("SQRTPI"),n=>Math.sqrt(XA*n))}}Mte.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:w.NUMBER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function hj(t,e){return new yt(e.width,t.height)}function r_(t,e,r){return new yt(1+(t.width-e)/r,1+(t.height-e)/r)}class Nte extends pt{mmult(e,r){return this.runFunction(e.args,r,this.metadata("MMULT"),(n,i)=>{if(!n.hasOnlyNumbers()||!i.hasOnlyNumbers())return new x($.VALUE,W.NumberRange);if(i.height()!==n.width())return new x($.VALUE,W.ArrayDimensions);const o=hj(n.size,i.size),a=this.createKernel(function(s,l,u){let c=0;for(let f=0;f<u;++f)c+=s[this.thread.y][f]*l[f][this.thread.x];return c},o)(n.rawNumbers(),i.rawNumbers(),n.width());return je.onlyNumbers(a)})}mmultArraySize(e,r){if(e.args.length!==2)return yt.error();const n=this.metadata("MMULT"),i=e.args.map(s=>{var l;return this.arraySizeForAst(s,new aa(r.formulaAddress,r.arraysFlag||((l=n==null?void 0:n.arrayFunction)!==null&&l!==void 0?l:!1)))}),[o,a]=i;return hj(o,a)}maxpool(e,r){return this.runFunction(e.args,r,this.metadata("MAXPOOL"),(n,i,o=i)=>{if(!n.hasOnlyNumbers())return new x($.VALUE,W.NumberRange);const a=r_(n.size,i,o),s=this.createKernel(function(l,u,c){const f=this.thread.x*c,h=this.thread.y*c;let d=l[h][f];for(let p=0;p<u;p++)for(let m=0;m<u;m++)d=Math.max(d,l[h+p][f+m]);return d},a)(n.rawNumbers(),i,o);return je.onlyNumbers(s)})}medianpool(e,r){return this.runFunction(e.args,r,this.metadata("MEDIANPOOL"),(n,i,o=i)=>{if(!n.hasOnlyNumbers())return new x($.VALUE,W.NumberRange);const a=r_(n.size,i,o),s=this.createKernel(function(l,u,c){const f=this.thread.x*c,h=this.thread.y*c;let d=l[h][f];for(let b=0;b<u;b++)for(let E=0;E<u;E++)d=Math.max(d,l[h+b][f+E]);let p=l[h][f];for(let b=0;b<u;b++)for(let E=0;E<u;E++)p=Math.min(p,l[h+b][f+E]);const m=u*u;let g=p,v=d,S=42;for(let b=0;b<32;b++){const E=(g+v)/2;let T=0;for(let N=0;N<u;N++)for(let L=0;L<u;L++)l[h+N][f+L]>E&&T++;if(u%2===0)if(T===m/2){S=E;break}else T>m/2?g=E:v=E;else if(T===(m-1)/2){S=E;break}else T>(m-1)/2?g=E:v=E}return S},a)(n.rawNumbers(),i,o);return je.onlyNumbers(s)})}maxpoolArraySize(e,r){if(e.args.length<2||e.args.length>3)return yt.error();const n=this.metadata("MAXPOOL"),o=e.args.map(u=>{var c;return this.arraySizeForAst(u,new aa(r.formulaAddress,r.arraysFlag||((c=n==null?void 0:n.arrayFunction)!==null&&c!==void 0?c:!1)))})[0],a=e.args[1];let s;a.type===F.NUMBER?s=a.value:s=1;let l=s;if(e.args.length===3){const u=e.args[2];u.type===F.NUMBER?l=u.value:l=1}return s>o.width||s>o.height||l>s||(o.width-s)%l!==0||(o.height-s)%l!==0?yt.error():r_(o,s,l)}medianpoolArraySize(e,r){return this.maxpoolArraySize(e,r)}transpose(e,r){return this.runFunction(e.args,r,this.metadata("TRANSPOSE"),n=>{const i=n.rawData(),o=n.size,a=[];for(let s=0;s<o.width;++s){a[s]=[];for(let l=0;l<o.height;++l)a[s][l]=i[l][s]}return je.onlyValues(a)})}transposeArraySize(e,r){if(e.args.length!==1)return yt.error();const n=this.metadata("MMULT"),i=e.args.map(a=>{var s;return this.arraySizeForAst(a,new aa(r.formulaAddress,r.arraysFlag||((s=n==null?void 0:n.arrayFunction)!==null&&s!==void 0?s:!1)))}),[o]=i;return new yt(o.height,o.width)}createKernel(e,r){return function(...n){const i=[];for(let o=0;o<r.height;++o){i.push([]);for(let a=0;a<r.width;++a)i[o][a]=e.apply({thread:{x:a,y:o}},n)}return i}}}Nte.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:w.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:w.RANGE},{argumentType:w.NUMBER},{argumentType:w.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:w.RANGE},{argumentType:w.NUMBER},{argumentType:w.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Pte extends pt{median(e,r){return this.runFunction(e.args,r,this.metadata("MEDIAN"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);return i instanceof x?i:i.length===0?new x($.NUM,W.OneValue):(i.sort((o,a)=>o-a),i.length%2===0?(i[i.length/2-1]+i[i.length/2])/2:i[Math.floor(i.length/2)])})}large(e,r){return this.runFunction(e.args,r,this.metadata("LARGE"),(n,i)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());return o instanceof x?o:(o.sort((a,s)=>a-s),i=Math.trunc(i),i>o.length?new x($.NUM,W.ValueLarge):o[o.length-i])})}small(e,r){return this.runFunction(e.args,r,this.metadata("SMALL"),(n,i)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());return o instanceof x?o:(o.sort((a,s)=>a-s),i=Math.trunc(i),i>o.length?new x($.NUM,W.ValueLarge):o[i-1])})}}Pte.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:w.RANGE},{argumentType:w.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:w.RANGE},{argumentType:w.NUMBER,minValue:1}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class kte extends pt{mod(e,r){return this.runFunction(e.args,r,this.metadata("MOD"),(n,i)=>i===0?new x($.DIV_BY_ZERO):n%i)}}kte.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function vb(t){return Ft(t)&&!Number.isFinite(Ne(t))?0:t}class Co{constructor(e,r,n){this.sumsq=e,this.sum=r,this.count=n}static single(e){return new Co(e*e,e,1)}compose(e){return new Co(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}varSValue(){if(this.count>1)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}varPValue(){if(this.count>0)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}Co.empty=new Co(0,0,0);class qI extends pt{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,r)=>this.arithmeticHelper.addWithEpsilonRaw(e,r)}sum(e,r){return this.doSum(e.args,r)}sumsq(e,r){return this.reduce(e.args,r,0,"SUMSQ",this.addWithEpsilonRaw,n=>Math.pow(Ne(n),2),pf)}max(e,r){return this.doMax(e.args,r)}maxa(e,r){const n=this.reduce(e.args,r,Number.NEGATIVE_INFINITY,"MAXA",(i,o)=>Math.max(i,o),Ne,bb);return vb(n)}min(e,r){return this.doMin(e.args,r)}mina(e,r){const n=this.reduce(e.args,r,Number.POSITIVE_INFINITY,"MINA",(i,o)=>Math.min(i,o),Ne,bb);return vb(n)}count(e,r){return this.doCount(e.args,r)}counta(e,r){return this.doCounta(e.args,r)}average(e,r){return this.doAverage(e.args,r)}averagea(e,r){var n;const i=this.reduce(e.args,r,Co.empty,"_AGGREGATE_A",(o,a)=>o.compose(a),o=>Co.single(Ne(o)),bb);return i instanceof x?i:(n=i.averageValue())!==null&&n!==void 0?n:new x($.DIV_BY_ZERO)}vars(e,r){return this.doVarS(e.args,r)}varp(e,r){return this.doVarP(e.args,r)}vara(e,r){var n;const i=this.reduceAggregateA(e.args,r);return i instanceof x?i:(n=i.varSValue())!==null&&n!==void 0?n:new x($.DIV_BY_ZERO)}varpa(e,r){var n;const i=this.reduceAggregateA(e.args,r);return i instanceof x?i:(n=i.varPValue())!==null&&n!==void 0?n:new x($.DIV_BY_ZERO)}stdevs(e,r){return this.doStdevS(e.args,r)}stdevp(e,r){return this.doStdevP(e.args,r)}stdeva(e,r){const n=this.reduceAggregateA(e.args,r);if(n instanceof x)return n;{const i=n.varSValue();return i===void 0?new x($.DIV_BY_ZERO):Math.sqrt(i)}}stdevpa(e,r){const n=this.reduceAggregateA(e.args,r);if(n instanceof x)return n;{const i=n.varPValue();return i===void 0?new x($.DIV_BY_ZERO):Math.sqrt(i)}}product(e,r){return this.doProduct(e.args,r)}subtotal(e,r){if(e.args.length<2)return new x($.NA,W.WrongArgNumber);const n=this.coerceToType(this.evaluateAst(e.args[0],r),{argumentType:w.NUMBER},r),i=e.args.slice(1);switch(n){case 1:case 101:return this.doAverage(i,r);case 2:case 102:return this.doCount(i,r);case 3:case 103:return this.doCounta(i,r);case 4:case 104:return this.doMax(i,r);case 5:case 105:return this.doMin(i,r);case 6:case 106:return this.doProduct(i,r);case 7:case 107:return this.doStdevS(i,r);case 8:case 108:return this.doStdevP(i,r);case 9:case 109:return this.doSum(i,r);case 10:case 110:return this.doVarS(i,r);case 11:case 111:return this.doVarP(i,r);default:return new x($.VALUE,W.BadMode)}}reduceAggregate(e,r){return this.reduce(e,r,Co.empty,"_AGGREGATE",(n,i)=>n.compose(i),n=>Co.single(Ne(n)),pf)}reduceAggregateA(e,r){return this.reduce(e,r,Co.empty,"_AGGREGATE_A",(n,i)=>n.compose(i),n=>Co.single(Ne(n)),bb)}doAverage(e,r){var n;const i=this.reduceAggregate(e,r);return i instanceof x?i:(n=i.averageValue())!==null&&n!==void 0?n:new x($.DIV_BY_ZERO)}doVarS(e,r){var n;const i=this.reduceAggregate(e,r);return i instanceof x?i:(n=i.varSValue())!==null&&n!==void 0?n:new x($.DIV_BY_ZERO)}doVarP(e,r){var n;const i=this.reduceAggregate(e,r);return i instanceof x?i:(n=i.varPValue())!==null&&n!==void 0?n:new x($.DIV_BY_ZERO)}doStdevS(e,r){const n=this.reduceAggregate(e,r);if(n instanceof x)return n;{const i=n.varSValue();return i===void 0?new x($.DIV_BY_ZERO):Math.sqrt(i)}}doStdevP(e,r){const n=this.reduceAggregate(e,r);if(n instanceof x)return n;{const i=n.varPValue();return i===void 0?new x($.DIV_BY_ZERO):Math.sqrt(i)}}doCount(e,r){return this.reduce(e,r,0,"COUNT",(n,i)=>n+i,Ne,n=>Ft(n)?1:0)}doCounta(e,r){return this.reduce(e,r,0,"COUNTA",(n,i)=>n+i,Ne,n=>n===_t?0:1)}doMax(e,r){const n=this.reduce(e,r,Number.NEGATIVE_INFINITY,"MAX",(i,o)=>Math.max(i,o),Ne,pf);return vb(n)}doMin(e,r){const n=this.reduce(e,r,Number.POSITIVE_INFINITY,"MIN",(i,o)=>Math.min(i,o),Ne,pf);return vb(n)}doSum(e,r){return this.reduce(e,r,0,"SUM",this.addWithEpsilonRaw,Ne,pf)}doProduct(e,r){return this.reduce(e,r,1,"PRODUCT",(n,i)=>n*i,Ne,pf)}reduce(e,r,n,i,o,a,s){return e.length<1?new x($.NA,W.WrongArgNumber):e.reduce((l,u)=>{if(l instanceof x)return l;if(u.type===F.CELL_RANGE||u.type===F.COLUMN_RANGE||u.type===F.ROW_RANGE){const f=this.evaluateRange(u,r,n,i,o,a,s);return f instanceof x?f:o(f,l)}let c;if(c=this.evaluateAst(u,r),c instanceof je)return Array.from(c.valuesFromTopLeftCorner()).map(s).filter(h=>h!==void 0).map(h=>h instanceof x?h:a(h)).reduce((h,d)=>h instanceof x?h:d instanceof x?d:o(h,d),l);if(u.type===F.CELL_REFERENCE){if(c=s(c),c===void 0)return l}else if(c=this.coerceScalarToNumberOrError(c),c=s(c),c===void 0)return l;return c instanceof x?c:o(l,a(c))},n)}evaluateRange(e,r,n,i,o,a,s){let l;try{l=ze.fromAst(e,r.formulaAddress)}catch(f){if(f instanceof Lv)return new x($.REF,W.RangeManySheets);throw f}const u=this.dependencyGraph.getRange(l.start,l.end);if(u===void 0)throw new Error("Range does not exists in graph");let c=u.getFunctionValue(i);return c===void 0&&(c=this.getRangeValues(i,l,u,a,s).reduce((h,d)=>h instanceof x?h:d instanceof x?d:o(h,d),n),u.setFunctionValue(i,c)),c}getRangeValues(e,r,n,i,o){const a=[],{smallerRangeVertex:s,restRange:l}=this.dependencyGraph.rangeMapping.findSmallerRange(r);let u;if(s!==void 0&&this.dependencyGraph.existsEdge(s,n)){const c=s.getFunctionValue(e);if(c!==void 0)a.push(c);else for(const f of s.range.addresses(this.dependencyGraph)){const h=o(this.dependencyGraph.getScalarValue(f));h instanceof x?a.push(h):h!==void 0&&a.push(i(h))}u=l}else u=r;for(const c of u.addresses(this.dependencyGraph)){const f=o(this.dependencyGraph.getScalarValue(c));f instanceof x?a.push(f):f!==void 0&&a.push(i(f))}return a}}qI.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:w.NUMBER},{argumentType:w.ANY}],repeatLastArgs:1}};qI.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};function pf(t){if(Ft(t)||t instanceof x)return t}function bb(t){return typeof t=="boolean"?HA(t):Ft(t)||t instanceof x?t:typeof t=="string"?0:void 0}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class $te extends pt{power(e,r){return this.runFunction(e.args,r,this.metadata("POWER"),Math.pow)}}$te.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Lte extends pt{radians(e,r){return this.runFunction(e.args,r,this.metadata("RADIANS"),n=>n*(Math.PI/180))}}Lte.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const dn=10,Dte=255,dj=2,pj=36,tct="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";class Fte extends pt{dec2bin(e,r){return this.runFunction(e.args,r,this.metadata("DEC2BIN"),(n,i)=>xa(n,2,i))}dec2oct(e,r){return this.runFunction(e.args,r,this.metadata("DEC2OCT"),(n,i)=>xa(n,8,i))}dec2hex(e,r){return this.runFunction(e.args,r,this.metadata("DEC2HEX"),(n,i)=>xa(n,16,i))}bin2dec(e,r){return this.runFunction(e.args,r,this.metadata("BIN2DEC"),n=>{const i=zo(n,2,dn);return i===void 0?new x($.NUM,W.NotBinary):Ia(i,2)})}bin2oct(e,r){return this.runFunction(e.args,r,this.metadata("BIN2OCT"),(n,i)=>{const o=zo(n,2,dn);return o===void 0?new x($.NUM,W.NotBinary):xa(Ia(o,2),8,i)})}bin2hex(e,r){return this.runFunction(e.args,r,this.metadata("BIN2HEX"),(n,i)=>{const o=zo(n,2,dn);return o===void 0?new x($.NUM,W.NotBinary):xa(Ia(o,2),16,i)})}oct2dec(e,r){return this.runFunction(e.args,r,this.metadata("OCT2DEC"),n=>{const i=zo(n,8,dn);return i===void 0?new x($.NUM,W.NotOctal):Ia(i,8)})}oct2bin(e,r){return this.runFunction(e.args,r,this.metadata("OCT2BIN"),(n,i)=>{const o=zo(n,8,dn);return o===void 0?new x($.NUM,W.NotOctal):xa(Ia(o,8),2,i)})}oct2hex(e,r){return this.runFunction(e.args,r,this.metadata("OCT2HEX"),(n,i)=>{const o=zo(n,8,dn);return o===void 0?new x($.NUM,W.NotOctal):xa(Ia(o,8),16,i)})}hex2dec(e,r){return this.runFunction(e.args,r,this.metadata("HEX2DEC"),n=>{const i=zo(n,16,dn);return i===void 0?new x($.NUM,W.NotHex):Ia(i,16)})}hex2bin(e,r){return this.runFunction(e.args,r,this.metadata("HEX2BIN"),(n,i)=>{const o=zo(n,16,dn);return o===void 0?new x($.NUM,W.NotHex):xa(Ia(o,16),2,i)})}hex2oct(e,r){return this.runFunction(e.args,r,this.metadata("HEX2OCT"),(n,i)=>{const o=zo(n,16,dn);return o===void 0?new x($.NUM,W.NotHex):xa(Ia(o,16),8,i)})}base(e,r){return this.runFunction(e.args,r,this.metadata("BASE"),nct)}decimal(e,r){return this.runFunction(e.args,r,this.metadata("DECIMAL"),(n,i)=>{const o=zo(n,i,Dte);return o===void 0?new x($.NUM,W.NotHex):parseInt(o,i)})}}Fte.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:w.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,optionalArg:!0,minValue:0,maxValue:dn}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,optionalArg:!0,minValue:0,maxValue:dn}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:w.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,optionalArg:!0,minValue:0,maxValue:dn}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,optionalArg:!0,minValue:0,maxValue:dn}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:w.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,optionalArg:!0,minValue:0,maxValue:dn}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,optionalArg:!0,minValue:0,maxValue:dn}]},DECIMAL:{method:"decimal",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,minValue:dj,maxValue:pj}]},BASE:{method:"base",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:dj,maxValue:pj},{argumentType:w.NUMBER,optionalArg:!0,minValue:0,maxValue:Dte}]}};function zo(t,e,r){const n=tct.substr(0,e),i=new RegExp(`^[${n}]+$`);if(!(t.length>r||!i.test(t)))return t}function xa(t,e,r){if(t>rct(e))return new x($.NUM,W.ValueBaseLarge);if(t<Hte(e))return new x($.NUM,W.ValueBaseSmall);const n=Bte(t,e);return r===void 0||t<0?n:n.length>r?new x($.NUM,W.ValueBaseLong):ci(n,r)}function Hte(t){return-Math.pow(t,dn)/2}function rct(t){return-Hte(t)-1}function nct(t,e,r){const n=Bte(t,e);return r!==void 0&&r>n.length?ci(n,r):n}function Bte(t,e){const r=t<0?Math.pow(e,dn):0;return(t+r).toString(e).toUpperCase()}function Ia(t,e){const r=parseInt(t,e),n=Math.pow(e,dn);return r>=n/2?r-n:r}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ute extends pt{rand(e,r){return this.runFunction(e.args,r,this.metadata("RAND"),Math.random)}randbetween(e,r){return this.runFunction(e.args,r,this.metadata("RANDBETWEEN"),(n,i)=>i<n?new x($.NUM,W.WrongOrder):(n=Math.ceil(n),i=Math.floor(i)+1,n===i&&(i+=1),n+Math.floor(Math.random()*(i-n))))}}Ute.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER}],isVolatile:!0}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function mj(t){const e=Math.ceil(t);return e%2===1?e:e+1}function gj(t){const e=Math.ceil(t);return e%2===0?e:e+1}class XI extends pt{roundup(e,r){return this.runFunction(e.args,r,this.metadata("ROUNDDOWN"),(n,i)=>{const o=Math.pow(10,i);return n<0?-Math.ceil(-n*o)/o:Math.ceil(n*o)/o})}rounddown(e,r){return this.runFunction(e.args,r,this.metadata("ROUNDDOWN"),(n,i)=>{const o=Math.pow(10,i);return n<0?-Math.floor(-n*o)/o:Math.floor(n*o)/o})}round(e,r){return this.runFunction(e.args,r,this.metadata("ROUND"),(n,i)=>{const o=Math.pow(10,i);return n<0?-Math.round(-n*o)/o:Math.round(n*o)/o})}intFunc(e,r){return this.runFunction(e.args,r,this.metadata("INT"),n=>n<0?-Math.floor(-n):Math.floor(n))}even(e,r){return this.runFunction(e.args,r,this.metadata("EVEN"),n=>n<0?-gj(-n):gj(n))}odd(e,r){return this.runFunction(e.args,r,this.metadata("ODD"),n=>n<0?-mj(-n):mj(n))}ceilingmath(e,r){return this.runFunction(e.args,r,this.metadata("CEILING.MATH"),(n,i,o)=>i===0||n===0?0:(i=Math.abs(i),o===1&&n<0&&(i=-i),Math.ceil(n/i)*i))}ceiling(e,r){return this.runFunction(e.args,r,this.metadata("CEILING"),(n,i)=>n===0?0:i===0?new x($.DIV_BY_ZERO):n>0&&i<0?new x($.NUM,W.DistinctSigns):Math.ceil(n/i)*i)}ceilingprecise(e,r){return this.runFunction(e.args,r,this.metadata("CEILING.PRECISE"),(n,i)=>i===0||n===0?0:(i=Math.abs(i),Math.ceil(n/i)*i))}floormath(e,r){return this.runFunction(e.args,r,this.metadata("FLOOR.MATH"),(n,i,o)=>i===0||n===0?0:(i=Math.abs(i),o===1&&n<0&&(i*=-1),Math.floor(n/i)*i))}floor(e,r){return this.runFunction(e.args,r,this.metadata("FLOOR"),(n,i)=>n===0?0:i===0?new x($.DIV_BY_ZERO):n>0&&i<0?new x($.NUM,W.DistinctSigns):Math.floor(n/i)*i)}floorprecise(e,r){return this.runFunction(e.args,r,this.metadata("FLOOR.PRECISE"),(n,i)=>i===0||n===0?0:(i=Math.abs(i),Math.floor(n/i)*i))}}XI.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:w.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:w.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:w.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:1},{argumentType:w.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:1},{argumentType:w.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,defaultValue:1}]}};XI.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Vte extends pt{sqrt(e,r){return this.runFunction(e.args,r,this.metadata("SQRT"),Math.sqrt)}}Vte.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */function*ict(){}function oct(t){const e=t[Symbol.iterator](),{done:r,value:n}=e.next();return r?{rest:ict()}:{value:n,rest:e}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const act=(t,e,r)=>{if(r.end.row>r.start.row){const n=Le(r.end.sheet,r.end.col,r.end.row-1),i=t.getRange(r.start,n);if(i!==void 0)return{smallerRangeVertex:i,restValuesRange:r.withStart(Le(r.start.sheet,r.start.col,r.end.row)),restConditionRanges:e.map(o=>o.withStart(Le(o.start.sheet,o.start.col,o.end.row)))}}return{restValuesRange:r,restConditionRanges:e}};class sct{constructor(e,r,n,i,o){this.interpreter=e,this.cacheKey=r,this.reduceInitialValue=n,this.composeFunction=i,this.mapFunction=o,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,r){for(const o of r)if(!o.conditionRange.sameDimensionsAs(e))return new x($.VALUE,W.EqualLength);const n=this.tryToGetRangeVertexForRangeValue(e),i=r.map(o=>this.tryToGetRangeVertexForRangeValue(o.conditionRange));if(n&&i.every(o=>o!==void 0)){const o=r.map(l=>l.criterionPackage.raw).join(","),a=this.findAlreadyComputedValueInCache(n,this.cacheKey(r),o);if(a!==void 0)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),a;const s=this.buildNewCriterionCache(this.cacheKey(r),r.map(l=>l.conditionRange.range),e.range);return s.has(o)||s.set(o,[this.evaluateRangeValue(e,r),r.map(l=>l.criterionPackage.lambda)]),n.setCriterionFunctionValues(this.cacheKey(r),s),i.forEach(l=>{l!==void 0&&l.addDependentCacheRange(n)}),s.get(o)[0]}else return this.evaluateRangeValue(e,r)}tryToGetRangeVertexForRangeValue(e){const r=e.range;if(r!==void 0)return this.dependencyGraph.getRange(r.start,r.end)}reduceFunction(e){let r=this.reduceInitialValue;for(const n of e)r=this.composeFunction(r,n);return r}findAlreadyComputedValueInCache(e,r,n){return e.getCriterionFunctionValue(r,n)}evaluateRangeValue(e,r){const n=r.map(s=>s.criterionPackage.lambda),i=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),o=r.map(s=>s.conditionRange.iterateValuesFromTopLeftCorner()),a=vj(n,o,i);return this.reduceFunction(a)}buildNewCriterionCache(e,r,n){const i=this.dependencyGraph.getRange(n.start,n.end),{smallerRangeVertex:o,restConditionRanges:a,restValuesRange:s}=act(this.dependencyGraph,r,n);let l;o!==void 0&&this.dependencyGraph.existsEdge(o,i)?l=o.getCriterionFunctionValues(e):l=new Map;const u=new Map;return l.forEach(([c,f],h)=>{const d=vj(f,a.map(m=>yj(this.dependencyGraph,m)),Array.from(yj(this.dependencyGraph,s)).map(this.mapFunction)[Symbol.iterator]()),p=this.composeFunction(c,this.reduceFunction(d));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),u.set(h,[p,f])}),u}}class lct{constructor(e,r){this.conditionRange=e,this.criterionPackage=r}}function*yj(t,e){for(const r of e.addresses(t))yield Ne(t.getScalarValue(r))}function*vj(t,e,r){for(const n of r){const i=e.map(a=>oct(a));if(!i.every(a=>Object.prototype.hasOwnProperty.call(a,"value")))return;const o=i.map(a=>Ne(a.value));uct(o,t).every(([a,s])=>s(a))&&(yield n),e=i.map(a=>a.rest)}}function uct(t,e){const r=[];for(let n=0;n<Math.min(t.length,e.length);n++)r.push([t[n],e[n]]);return r}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class hl{constructor(e,r){this.sum=e,this.count=r}static single(e){return new hl(e,1)}compose(e){return new hl(this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}}hl.empty=new hl(0,0);function cct(t){return e=>{const r=e.map(n=>`${n.conditionRange.range.sheet},${n.conditionRange.range.start.col},${n.conditionRange.range.start.row}`);return[t,...r].join(",")}}function bj(t){return Ft(t)&&!Number.isFinite(Ne(t))?0:t}function wb(t){if(t instanceof x)return t;if(Ft(t))return Ne(t)}class jte extends pt{sumif(e,r){const n="SUMIF",i=(o,a,s)=>this.computeConditionalAggregationFunction(s!=null?s:o,[o,a],n,0,(l,u)=>this.arithmeticHelper.nonstrictadd(l,u),wb);return this.runFunction(e.args,r,this.metadata(n),i)}sumifs(e,r){const n="SUMIFS",i=(o,...a)=>this.computeConditionalAggregationFunction(o,a,n,0,(s,l)=>this.arithmeticHelper.nonstrictadd(s,l),wb);return this.runFunction(e.args,r,this.metadata(n),i)}averageif(e,r){const n="AVERAGEIF",i=(o,a,s)=>{const l=this.computeConditionalAggregationFunction(s!=null?s:o,[o,a],n,hl.empty,(u,c)=>u.compose(c),u=>Ft(u)?hl.single(Ne(u)):hl.empty);return l instanceof x?l:l.averageValue()||new x($.DIV_BY_ZERO)};return this.runFunction(e.args,r,this.metadata(n),i)}countif(e,r){const n="COUNTIF",i=(o,a)=>this.computeConditionalAggregationFunction(o,[o,a],n,0,(s,l)=>s+l,()=>1);return this.runFunction(e.args,r,this.metadata(n),i)}countifs(e,r){const n="COUNTIFS",i=(...o)=>this.computeConditionalAggregationFunction(o[0],o,n,0,(a,s)=>a+s,()=>1);return this.runFunction(e.args,r,this.metadata(n),i)}minifs(e,r){const n="MINIFS",i=(a,s)=>s===void 0||a===void 0?s===void 0?a:s:Math.min(a,s),o=(a,...s)=>{const l=this.computeConditionalAggregationFunction(a,s,n,Number.POSITIVE_INFINITY,i,wb);return bj(l)};return this.runFunction(e.args,r,this.metadata(n),o)}maxifs(e,r){const n="MAXIFS",i=(a,s)=>s===void 0||a===void 0?s===void 0?a:s:Math.max(a,s),o=(a,...s)=>{const l=this.computeConditionalAggregationFunction(a,s,n,Number.NEGATIVE_INFINITY,i,wb);return bj(l)};return this.runFunction(e.args,r,this.metadata(n),o)}computeConditionalAggregationFunction(e,r,n,i,o,a){const s=[];for(let l=0;l<r.length;l+=2){const u=r[l],c=this.interpreter.criterionBuilder.fromCellValue(r[l+1],this.arithmeticHelper);if(c===void 0)return new x($.VALUE,W.BadCriterion);s.push(new lct(u,c))}return new sct(this.interpreter,cct(n),i,o,a).compute(e,s)}}jte.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:w.RANGE},{argumentType:w.NOERROR},{argumentType:w.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:w.RANGE},{argumentType:w.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:w.RANGE},{argumentType:w.NOERROR},{argumentType:w.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE},{argumentType:w.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:w.RANGE},{argumentType:w.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE},{argumentType:w.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE},{argumentType:w.NOERROR}],repeatLastArgs:2}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Wte extends pt{sumproduct(e,r){return this.runFunction(e.args,r,this.metadata("SUMPRODUCT"),(...n)=>{const i=n[0].width(),o=n[0].height();for(const l of n)if(l.width()!==i||l.height()!==o)return new x($.VALUE,W.EqualLength);let a=0;const s=n.map(l=>l.iterateValuesFromTopLeftCorner());for(let l=0;l<i*o;l++){let u=1;for(const c of s){const f=c.next().value;if(f instanceof x)return f;const h=this.coerceScalarToNumberOrError(f);Ft(h)?u*=Ne(h):u=0}a+=u}return a})}}Wte.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:w.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class zte extends pt{concatenate(e,r){return this.runFunction(e.args,r,this.metadata("CONCATENATE"),(...n)=>"".concat(...n))}split(e,r){return this.runFunction(e.args,r,this.metadata("SPLIT"),(n,i)=>{const o=n.split(" ");return i>=o.length||i<0?new x($.VALUE,W.IndexBounds):o[i]})}len(e,r){return this.runFunction(e.args,r,this.metadata("LEN"),n=>n.length)}lower(e,r){return this.runFunction(e.args,r,this.metadata("LOWER"),n=>n.toLowerCase())}trim(e,r){return this.runFunction(e.args,r,this.metadata("TRIM"),n=>n.replace(/^ +| +$/g,"").replace(/ +/g," "))}proper(e,r){return this.runFunction(e.args,r,this.metadata("PROPER"),n=>n.replace(/\p{L}+/gu,i=>i.charAt(0).toUpperCase()+i.substring(1).toLowerCase()))}clean(e,r){return this.runFunction(e.args,r,this.metadata("CLEAN"),n=>n.replace(/[\u0000-\u001F]/g,""))}exact(e,r){return this.runFunction(e.args,r,this.metadata("EXACT"),(n,i)=>n===i)}rept(e,r){return this.runFunction(e.args,r,this.metadata("REPT"),(n,i)=>i<0?new x($.VALUE,W.NegativeCount):n.repeat(i))}right(e,r){return this.runFunction(e.args,r,this.metadata("RIGHT"),(n,i)=>i<0?new x($.VALUE,W.NegativeLength):i===0?"":n.slice(-i))}left(e,r){return this.runFunction(e.args,r,this.metadata("LEFT"),(n,i)=>i<0?new x($.VALUE,W.NegativeLength):n.slice(0,i))}mid(e,r){return this.runFunction(e.args,r,this.metadata("MID"),(n,i,o)=>i<1?new x($.VALUE,W.LessThanOne):o<0?new x($.VALUE,W.NegativeLength):n.substring(i-1,i+o-1))}replace(e,r){return this.runFunction(e.args,r,this.metadata("REPLACE"),(n,i,o,a)=>i<1?new x($.VALUE,W.LessThanOne):o<0?new x($.VALUE,W.NegativeLength):n.substring(0,i-1)+a+n.substring(i+o-1))}search(e,r){return this.runFunction(e.args,r,this.metadata("SEARCH"),(n,i,o)=>{if(o<1||o>i.length)return new x($.VALUE,W.LengthBounds);const a=i.substring(o-1).toLowerCase();let s;return this.arithmeticHelper.requiresRegex(n)?s=this.arithmeticHelper.searchString(n,a):s=a.indexOf(n.toLowerCase()),s=s+o,s>0?s:new x($.VALUE,W.PatternNotFound)})}substitute(e,r){return this.runFunction(e.args,r,this.metadata("SUBSTITUTE"),(n,i,o,a)=>{const s=new RegExp(i,"g");if(a===void 0)return n.replace(s,o);if(a<1)return new x($.VALUE,W.LessThanOne);let l,u=0;for(;(l=s.exec(n))!==null;)if(a===++u)return n.substring(0,l.index)+o+n.substring(s.lastIndex);return n})}find(e,r){return this.runFunction(e.args,r,this.metadata("FIND"),(n,i,o)=>{if(o<1||o>i.length)return new x($.VALUE,W.IndexBounds);const s=i.substring(o-1).indexOf(n)+o;return s>0?s:new x($.VALUE,W.PatternNotFound)})}t(e,r){return this.runFunction(e.args,r,this.metadata("T"),n=>n instanceof x||typeof n=="string"?n:"")}upper(e,r){return this.runFunction(e.args,r,this.metadata("UPPER"),n=>n.toUpperCase())}}zte.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:w.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:w.STRING},{argumentType:w.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:w.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:w.STRING}]},MID:{method:"mid",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER},{argumentType:w.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:w.STRING}]},T:{method:"t",parameters:[{argumentType:w.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:w.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:w.STRING}]},REPT:{method:"rept",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:w.STRING},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:w.STRING},{argumentType:w.STRING},{argumentType:w.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:w.STRING},{argumentType:w.STRING},{argumentType:w.STRING},{argumentType:w.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:w.STRING},{argumentType:w.STRING},{argumentType:w.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:w.STRING}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Gte extends pt{acos(e,r){return this.runFunction(e.args,r,this.metadata("ACOS"),Math.acos)}asin(e,r){return this.runFunction(e.args,r,this.metadata("ASIN"),Math.asin)}cos(e,r){return this.runFunction(e.args,r,this.metadata("COS"),Math.cos)}sin(e,r){return this.runFunction(e.args,r,this.metadata("SIN"),Math.sin)}tan(e,r){return this.runFunction(e.args,r,this.metadata("TAN"),Math.tan)}atan(e,r){return this.runFunction(e.args,r,this.metadata("ATAN"),Math.atan)}atan2(e,r){return this.runFunction(e.args,r,this.metadata("ATAN2"),(n,i)=>n===0&&i===0?new x($.DIV_BY_ZERO):Math.atan2(i,n))}cot(e,r){return this.runFunction(e.args,r,this.metadata("COT"),n=>n===0?new x($.DIV_BY_ZERO):1/Math.tan(n))}acot(e,r){return this.runFunction(e.args,r,this.metadata("ACOT"),n=>n===0?XA/2:Math.atan(1/n))}sec(e,r){return this.runFunction(e.args,r,this.metadata("SEC"),n=>1/Math.cos(n))}csc(e,r){return this.runFunction(e.args,r,this.metadata("CSC"),n=>n===0?new x($.DIV_BY_ZERO):1/Math.sin(n))}sinh(e,r){return this.runFunction(e.args,r,this.metadata("SINH"),Math.sinh)}asinh(e,r){return this.runFunction(e.args,r,this.metadata("ASINH"),Math.asinh)}cosh(e,r){return this.runFunction(e.args,r,this.metadata("COSH"),Math.cosh)}acosh(e,r){return this.runFunction(e.args,r,this.metadata("ACOSH"),Math.acosh)}tanh(e,r){return this.runFunction(e.args,r,this.metadata("TANH"),Math.tanh)}atanh(e,r){return this.runFunction(e.args,r,this.metadata("ATANH"),Math.atanh)}coth(e,r){return this.runFunction(e.args,r,this.metadata("COTH"),n=>n===0?new x($.DIV_BY_ZERO):1/Math.tanh(n))}acoth(e,r){return this.runFunction(e.args,r,this.metadata("ACOTH"),n=>n===0?new x($.NUM,W.NonZero):Math.atanh(1/n))}sech(e,r){return this.runFunction(e.args,r,this.metadata("SECH"),n=>1/Math.cosh(n))}csch(e,r){return this.runFunction(e.args,r,this.metadata("CSCH"),n=>n===0?new x($.DIV_BY_ZERO):1/Math.sinh(n))}}Gte.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:w.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:w.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:w.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:w.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:w.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:w.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:w.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:w.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:w.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:w.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:w.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:w.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:w.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:w.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:w.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:w.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:w.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:w.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:w.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:w.NUMBER}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class fct extends ote{constructor(e){super(e),this.dependencyGraph=e}find(e,r,n){return this.basicFind(e,r,"col",n)}}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Yte extends pt{constructor(){super(...arguments),this.rowSearch=new fct(this.dependencyGraph)}vlookup(e,r){return this.runFunction(e.args,r,this.metadata("VLOOKUP"),(n,i,o,a)=>{const s=i.range;return s===void 0?new x($.VALUE,W.WrongType):o<1?new x($.VALUE,W.LessThanOne):o>s.width()?new x($.REF,W.IndexLarge):this.doVlookup(QC(n),i,o-1,a)})}hlookup(e,r){return this.runFunction(e.args,r,this.metadata("HLOOKUP"),(n,i,o,a)=>{const s=i.range;return s===void 0?new x($.VALUE,W.WrongType):o<1?new x($.VALUE,W.LessThanOne):o>s.height()?new x($.REF,W.IndexLarge):this.doHlookup(QC(n),i,o-1,a)})}match(e,r){return this.runFunction(e.args,r,this.metadata("MATCH"),(n,i,o)=>this.doMatch(QC(n),i,o))}searchInRange(e,r,n,i){if(!n&&typeof e=="string"&&this.arithmeticHelper.requiresRegex(e))return i.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),r);{const o=n?{ordering:"asc"}:{ordering:"none",matchExactly:!0};return i.find(e,r,o)}}doVlookup(e,r,n,i){this.dependencyGraph.stats.start(ot.VLOOKUP);const o=r.range;let a;o===void 0?a=je.onlyValues(r.data.map(u=>[u[0]])):a=je.onlyRange(ze.spanFrom(o.start,1,o.height()),this.dependencyGraph);const s=this.searchInRange(e,a,i,this.columnSearch);if(this.dependencyGraph.stats.end(ot.VLOOKUP),s===-1)return new x($.NA,W.ValueNotFound);let l;if(o===void 0)l=r.data[s][n];else{const u=Le(o.sheet,o.start.col+n,o.start.row+s);l=this.dependencyGraph.getCellValue(u)}return l instanceof je?new x($.VALUE,W.WrongType):l}doHlookup(e,r,n,i){const o=r.range;let a;o===void 0?a=je.onlyValues([r.data[0]]):a=je.onlyRange(ze.spanFrom(o.start,o.width(),1),this.dependencyGraph);const s=this.searchInRange(e,a,i,this.rowSearch);if(s===-1)return new x($.NA,W.ValueNotFound);let l;if(o===void 0)l=r.data[n][s];else{const u=Le(o.sheet,o.start.col+s,o.start.row+n);l=this.dependencyGraph.getCellValue(u)}return l instanceof je?new x($.VALUE,W.WrongType):l}doMatch(e,r,n){if(![-1,0,1].includes(n))return new x($.VALUE,W.BadMode);if(r.width()>1&&r.height()>1)return new x($.NA);const i=r.width()===1?this.columnSearch:this.rowSearch,o=n===0?{ordering:"none",matchExactly:!0}:{ordering:n===-1?"desc":"asc"},a=i.find(e,r,o);return a===-1?new x($.NA,W.ValueNotFound):a+1}}Yte.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:w.NOERROR},{argumentType:w.RANGE},{argumentType:w.NUMBER},{argumentType:w.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:w.NOERROR},{argumentType:w.RANGE},{argumentType:w.NUMBER},{argumentType:w.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:w.NOERROR},{argumentType:w.RANGE},{argumentType:w.NUMBER,defaultValue:1}]}};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Kte extends pt{roman(e,r){return this.runFunction(e.args,r,this.metadata("ROMAN"),(n,i)=>(n=Math.trunc(n),i===!1?i=4:i===!0&&(i=0),i=Ne(this.coerceScalarToNumberOrError(i)),i instanceof x?i:(i=Math.trunc(i),i<0?new x($.VALUE,W.ValueSmall):i>4?new x($.VALUE,W.ValueLarge):hct(n,i))))}arabic(e,r){return this.runFunction(e.args,r,this.metadata("ARABIC"),n=>{n=n.trim().toUpperCase();let i=!1;if(n.startsWith("-")&&(n=n.slice(1),i=!0,n===""))return new x($.VALUE,W.InvalidRoman);const o={input:n,acc:0};return Go(o,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),Go(o,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),Go(o,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),Go(o,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),Go(o,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),Go(o,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),Go(o,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),Go(o,{token:"IX",val:9}),Go(o,{token:"V",val:5},{token:"IV",val:4}),Go(o,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),o.input!==""?new x($.VALUE,W.InvalidRoman):i?-o.acc:o.acc})}}Kte.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:w.NUMBER,minValue:1,lessThan:4e3},{argumentType:w.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:w.STRING}]}};function Go(t,...e){for(const r of e)if(t.input.startsWith(r.token)){t.input=t.input.slice(r.token.length),t.acc+=r.val;break}}function hct(t,e){const r={val:t%1e3,acc:"M".repeat(Math.floor(t/1e3))};return e===4&&(Fr(r,"IM",999,1e3),Fr(r,"ID",499,500)),e>=3&&(Fr(r,"VM",995,1e3),Fr(r,"VD",495,500)),e>=2&&(Fr(r,"XM",990,1e3),Fr(r,"XD",490,500)),e>=1&&(Fr(r,"LM",950,1e3),Fr(r,"LD",450,500)),Fr(r,"CM",900,1e3),Fr(r,"CD",400,500),Fr(r,"D",500,900),r.acc+="C".repeat(Math.floor(r.val/100)),r.val%=100,e>=2&&(Fr(r,"IC",99,100),Fr(r,"IL",49,50)),e>=1&&(Fr(r,"VC",95,100),Fr(r,"VL",45,50)),Fr(r,"XC",90,100),Fr(r,"XL",40,50),Fr(r,"L",50,90),r.acc+="X".repeat(Math.floor(r.val/10)),r.val%=10,Fr(r,"IX",9,10),Fr(r,"IV",4,5),Fr(r,"V",5,9),r.acc+="I".repeat(r.val),r.acc}function Fr(t,e,r,n){t.val>=r&&t.val<n&&(t.val-=r,t.acc+=e)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class qte extends pt{add(e,r){return this.runFunction(e.args,r,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,r){return this.runFunction(e.args,r,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,r){return this.runFunction(e.args,r,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,r){return this.runFunction(e.args,r,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,r){return this.runFunction(e.args,r,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,r){return this.runFunction(e.args,r,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,r){return this.runFunction(e.args,r,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,r){return this.runFunction(e.args,r,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,r){return this.runFunction(e.args,r,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,r){return this.runFunction(e.args,r,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,r){return this.runFunction(e.args,r,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,r){return this.runFunction(e.args,r,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,r){return this.runFunction(e.args,r,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,r){return this.runFunction(e.args,r,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,r){return this.runFunction(e.args,r,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}qte.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:w.NUMBER,passSubtype:!0},{argumentType:w.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:w.STRING,passSubtype:!0},{argumentType:w.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:w.NUMBER,passSubtype:!0},{argumentType:w.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:w.NOERROR,passSubtype:!0},{argumentType:w.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:w.NOERROR,passSubtype:!0},{argumentType:w.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:w.NOERROR,passSubtype:!0},{argumentType:w.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:w.NOERROR,passSubtype:!0},{argumentType:w.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:w.NOERROR,passSubtype:!0},{argumentType:w.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:w.NUMBER,passSubtype:!0},{argumentType:w.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:w.NUMBER,passSubtype:!0},{argumentType:w.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:w.NOERROR,passSubtype:!0},{argumentType:w.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:w.NUMBER,passSubtype:!0},{argumentType:w.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:w.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:w.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:w.NUMBER,passSubtype:!0}]}};/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */var ft=Math;function dr(t,e){for(var r=0,n=0;r<t.length;++r)n=e*n+t[r];return n}function Xte(t,e,r,n,i){if(e===0)return r;if(e===1)return n;for(var o=2/t,a=n,s=1;s<e;++s)a=n*s*o+i*r,r=n,n=a;return a}function Qte(t,e,r,n,i){return function(a,s){if(n){if(a===0)return n==1?-1/0:1/0;if(a<0)return NaN}if(s===0)return t(a);if(s===1)return e(a);if(s<0)return NaN;s|=0;var l=t(a),u=e(a);return Xte(a,s,l,u,i)}}var QA=function(){var t=.636619772,e=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),r=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function o(f){var h=0,d=0,p=0,m=f*f;if(f<8)d=dr(e,m),p=dr(r,m),h=d/p;else{var g=f-.785398164;m=64/m,d=dr(n,m),p=dr(i,m),h=ft.sqrt(t/f)*(ft.cos(g)*d-ft.sin(g)*p*8/f)}return h}var a=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),s=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(f){var h=0,d=0,p=0,m=f*f,g=ft.abs(f)-2.356194491;return Math.abs(f)<8?(d=f*dr(a,m),p=dr(s,m),h=d/p):(m=64/m,d=dr(l,m),p=dr(u,m),h=ft.sqrt(t/ft.abs(f))*(ft.cos(g)*d-ft.sin(g)*p*8/ft.abs(f)),f<0&&(h=-h)),h}return function f(h,d){if(d=Math.round(d),!isFinite(h))return isNaN(h)?h:0;if(d<0)return(d%2?-1:1)*f(h,-d);if(h<0)return(d%2?-1:1)*f(-h,d);if(d===0)return o(h);if(d===1)return c(h);if(h===0)return 0;var p=0;if(h>d)p=Xte(h,d,o(h),c(h),-1);else{for(var m=2*ft.floor((d+ft.floor(ft.sqrt(40*d)))/2),g=!1,v=0,S=0,b=1,E=0,T=2/h,N=m;N>0;N--)E=N*T*b-v,v=b,b=E,ft.abs(b)>1e10&&(b*=1e-10,v*=1e-10,p*=1e-10,S*=1e-10),g&&(S+=b),g=!g,N==d&&(p=v);S=2*S-b,p/=S}return p}}(),dct=function(){var t=.636619772,e=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),r=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function o(f){var h=0,d=0,p=0,m=f*f,g=f-.785398164;return f<8?(d=dr(e,m),p=dr(r,m),h=d/p+t*QA(f,0)*ft.log(f)):(m=64/m,d=dr(n,m),p=dr(i,m),h=ft.sqrt(t/f)*(ft.sin(g)*d+ft.cos(g)*p*8/f)),h}var a=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),s=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(f){var h=0,d=0,p=0,m=f*f,g=f-2.356194491;return f<8?(d=f*dr(a,m),p=dr(s,m),h=d/p+t*(QA(f,1)*ft.log(f)-1/f)):(m=64/m,d=dr(l,m),p=dr(u,m),h=ft.sqrt(t/f)*(ft.sin(g)*d+ft.cos(g)*p*8/f)),h}return Qte(o,c,"BESSELY",1,-1)}(),ZA=function(){var t=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function r(a){return a<=3.75?dr(t,a*a/(3.75*3.75)):ft.exp(ft.abs(a))/ft.sqrt(ft.abs(a))*dr(e,3.75/ft.abs(a))}var n=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),i=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function o(a){return a<3.75?a*dr(n,a*a/(3.75*3.75)):(a<0?-1:1)*ft.exp(ft.abs(a))/ft.sqrt(ft.abs(a))*dr(i,3.75/ft.abs(a))}return function a(s,l){if(l=Math.round(l),l===0)return r(s);if(l===1)return o(s);if(l<0)return NaN;if(ft.abs(s)===0)return 0;if(s==1/0)return 1/0;var u=0,c,f=2/ft.abs(s),h=0,d=1,p=0,m=2*ft.round((l+ft.round(ft.sqrt(40*l)))/2);for(c=m;c>0;c--)p=c*f*d+h,h=d,d=p,ft.abs(d)>1e10&&(d*=1e-10,h*=1e-10,u*=1e-10),c==l&&(u=h);return u*=a(s,0)/d,s<0&&l%2?-u:u}}(),pct=function(){var t=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),e=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function r(a){return a<=2?-ft.log(a/2)*ZA(a,0)+dr(t,a*a/4):ft.exp(-a)/ft.sqrt(a)*dr(e,2/a)}var n=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),i=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function o(a){return a<=2?ft.log(a/2)*ZA(a,1)+1/a*dr(n,a*a/4):ft.exp(-a)/ft.sqrt(a)*dr(i,2/a)}return Qte(r,o,"BESSELK",2,1)}();/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */function oh(t){const e=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let r=e.length-1,n=!1,i=0,o=0,a,s,l,u;if(t===0)return 0;for(t<0&&(t=-t,n=!0),a=2/(2+t),s=4*a-2;r>0;r--)l=i,i=s*i-o+e[r],o=l;return u=a*Math.exp(-t*t+.5*(e[0]+s*i)-o),n?u-1:1-u}function Zte(t){return 1-oh(t)}function Jte(t){let e=0,r,n,i,o;if(t>=2)return-100;if(t<=0)return 100;for(o=t<1?t:2-t,i=Math.sqrt(-2*Math.log(o/2)),r=-.70711*((2.30753+i*.27061)/(1+i*(.99229+i*.04481))-i);e<2;e++)n=Zte(r)-o,r+=n/(1.1283791670955126*Math.exp(-r*r)-r*n);return t<1?r:-r}const wj={pdf:(t,e)=>t<0?0:e*Math.exp(-e*t),cdf:(t,e)=>t<0?0:1-Math.exp(-e*t)};function vg(t){const e=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],r=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let n=!1,i=0,o=0,a=0,s=t,l,u,c,f;if(t>171.6243769536076)return 1/0;if(s<=0)if(f=s%1,f)n=(s&1?-1:1)*Math.PI/Math.sin(Math.PI*f),s=1-s;else return 1/0;for(c=s,s<1?u=s++:u=(s-=i=(s|0)-1)-1,l=0;l<8;++l)a=(a+e[l])*u,o=o*u+r[l];if(f=a/o+1,c<s)f/=c;else if(c>s)for(l=0;l<i;++l)f*=s,s++;return n&&(f=n/f),f}const n_={pdf:function(e,r,n){return e<0?0:e===0&&r===1?1/n:Math.exp((r-1)*Math.log(e)-e/n-vn(r)-r*Math.log(n))},cdf:function(e,r,n){return e<0?0:QI(r,e/n)},inv:function(t,e,r){return ere(t,e)*r}};function vn(t){let e=0;const r=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let n=1.000000000190015,i,o,a;for(a=(o=i=t)+5.5,a-=(i+.5)*Math.log(a);e<6;e++)n+=r[e]/++o;return Math.log(2.5066282746310007*n/i)-a}function QI(t,e){const r=vn(t);let n=t,i=1/t,o=i,a=e+1-t,s=1/1e-30,l=1/a,u=l,c=1;const f=-~(Math.log(t>=1?t:1/t)*8.5+t*.4+17);let h;if(e<0||t<=0)return NaN;if(e<t+1){for(;c<=f;c++)i+=o*=e/++n;return i*Math.exp(-e+t*Math.log(e)-r)}for(;c<=f;c++)h=-c*(c-t),a+=2,l=h*l+a,s=a+h/s,l=1/l,u*=l*s;return 1-u*Math.exp(-e+t*Math.log(e)-r)}function ere(t,e){let r=0;const n=e-1,i=1e-8,o=vn(e);let a,s,l,u,c,f,h;if(t>=1)return Math.max(100,e+100*Math.sqrt(e));if(t<=0)return 0;for(e>1?(f=Math.log(n),h=Math.exp(n*(f-1)-o),c=t<.5?t:1-t,l=Math.sqrt(-2*Math.log(c)),a=(2.30753+l*.27061)/(1+l*(.99229+l*.04481))-l,t<.5&&(a=-a),a=Math.max(.001,e*Math.pow(1-1/(9*e)-a/(3*Math.sqrt(e)),3))):(l=1-e*(.253+e*.12),t<l?a=Math.pow(t/l,1/e):a=1-Math.log(1-(t-l)/(1-l)));r<12;r++){if(a<=0)return 0;if(s=QI(e,a)-t,e>1?l=h*Math.exp(-(a-n)+n*(Math.log(a)-f)):l=Math.exp(-a+n*Math.log(a)-o),u=s/l,a-=l=u/(1-.5*Math.min(1,u*((e-1)/a-1))),a<=0&&(a=.5*(a+l)),Math.abs(l)<i*a)break}return a}const bo={pdf:function(e,r,n){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(e-r,2)/(2*n*n))},cdf:function(e,r,n){return .5*(1+oh((e-r)/Math.sqrt(2*n*n)))},inv:function(t,e,r){return-1.4142135623730951*r*Jte(2*t)+e}},i_={pdf:function(e,r,n){return e>1||e<0?0:r==1&&n==1?1:r<512&&n<512?Math.pow(e,r-1)*Math.pow(1-e,n-1)/ZI(r,n):Math.exp((r-1)*Math.log(e)+(n-1)*Math.log(1-e)-tre(r,n))},cdf:function(e,r,n){return e>1||e<0?+(e>1):gR(e,r,n)},inv:function(e,r,n){return JI(e,r,n)}};function ZI(t,e){if(!(t<=0||e<=0))return t+e>170?Math.exp(tre(t,e)):vg(t)*vg(e)/vg(t+e)}function tre(t,e){return vn(t)+vn(e)-vn(t+e)}function JI(t,e,r){var n=1e-8,i=e-1,o=r-1,a=0,s,l,u,c,f,h,d,p,m,g,v;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&r>=1?(u=t<.5?t:1-t,c=Math.sqrt(-2*Math.log(u)),d=(2.30753+c*.27061)/(1+c*(.99229+c*.04481))-c,t<.5&&(d=-d),p=(d*d-3)/6,m=2/(1/(2*e-1)+1/(2*r-1)),g=d*Math.sqrt(p+m)/m-(1/(2*r-1)-1/(2*e-1))*(p+5/6-2/(3*m)),d=e/(e+r*Math.exp(2*g))):(s=Math.log(e/(e+r)),l=Math.log(r/(e+r)),c=Math.exp(e*s)/e,f=Math.exp(r*l)/r,g=c+f,t<c/g?d=Math.pow(e*g*t,1/e):d=1-Math.pow(r*g*(1-t),1/r)),v=-vn(e)-vn(r)+vn(e+r);a<10;a++){if(d===0||d===1)return d;if(h=gR(d,e,r)-t,c=Math.exp(i*Math.log(d)+o*Math.log(1-d)+v),f=h/c,d-=c=f/(1-.5*Math.min(1,f*(i/d-o/(1-d)))),d<=0&&(d=.5*(d+c)),d>=1&&(d=.5*(d+c+1)),Math.abs(c)<n*d&&a>0)break}return d}function gR(t,e,r){var n=t===0||t===1?0:Math.exp(vn(e+r)-vn(e)-vn(r)+e*Math.log(t)+r*Math.log(1-t));return t<0||t>1?!1:t<(e+1)/(e+r+2)?n*Sj(t,e,r)/e:1-n*Sj(1-t,r,e)/r}function Sj(t,e,r){var n=1e-30,i=1,o=e+r,a=e+1,s=e-1,l=1,u=1-o*t/a,c,f,h,d;for(Math.abs(u)<n&&(u=n),u=1/u,d=u;i<=100&&(c=2*i,f=i*(r-i)*t/((s+c)*(e+c)),u=1+f*u,Math.abs(u)<n&&(u=n),l=1+f/l,Math.abs(l)<n&&(l=n),u=1/u,d*=u*l,f=-(e+i)*(o+i)*t/((e+c)*(a+c)),u=1+f*u,Math.abs(u)<n&&(u=n),l=1+f/l,Math.abs(l)<n&&(l=n),u=1/u,h=u*l,d*=h,!(Math.abs(h-1)<3e-7));i++);return d}const P2={pdf:function(t,e,r){return r===0||r===1?e*r===t?1:0:rre(e,t)*Math.pow(r,t)*Math.pow(1-r,e-t)},cdf:function(t,e,r){var n,i=1e-10;if(t<0)return 0;if(t>=e)return 1;if(r<0||r>1||e<=0)return NaN;t=Math.floor(t);var o=r,a=t+1,s=e-t,l=a+s,u=Math.exp(vn(l)-vn(s)-vn(a)+a*Math.log(o)+s*Math.log(1-o));return o<(a+1)/(l+2)?n=u*Rj(o,a,s,i):n=1-u*Rj(1-o,s,a,i),Math.round((1-n)*(1/i))/(1/i)}};function Rj(t,e,r,n){for(var i=0,o=1,a=1,s=1,l=0,u=0,c;Math.abs((a-u)/a)>n;)u=a,c=-(e+l)*(e+r+l)*t/(e+2*l)/(e+2*l+1),i=a+c*i,o=s+c*o,l=l+1,c=l*(r-l)*t/(e+2*l-1)/(e+2*l),a=i+c*a,s=o+c*s,i=i/s,o=o/s,a=a/s,s=1;return a/e}function rre(t,e){return t>170||e>170?Math.exp(mct(t,e)):k2(t)/k2(e)/k2(t-e)}function mct(t,e){return o_(t)-o_(e)-o_(t-e)}function o_(t){return t<0?NaN:vn(t+1)}function k2(t){return t<0?NaN:vg(t+1)}const xf={pdf:function(e,r){return e<0?0:e===0&&r===2?.5:Math.exp((r/2-1)*Math.log(e)-e/2-r/2*Math.log(2)-vn(r/2))},cdf:function(e,r){return e<0?0:QI(r/2,e/2)},inv:function(t,e){return 2*ere(t,.5*e)}},If={pdf:function(e,r,n){var i,o,a;return e<0?0:r<=2?e===0&&r<2?1/0:e===0&&r===2?1:1/ZI(r/2,n/2)*Math.pow(r/n,r/2)*Math.pow(e,r/2-1)*Math.pow(1+r/n*e,-(r+n)/2):(i=r*e/(n+e*r),o=n/(n+e*r),a=r*o/2,a*P2.pdf((r-2)/2,(r+n-2)/2,i))},cdf:function(e,r,n){return e<0?0:gR(r*e/(r*e+n),r/2,n/2)},inv:function(e,r,n){return n/(r*(1/JI(e,r/2,n/2)-1))}},Ej={pdf:function(e,r,n){return e<0||r<0||n<0?0:n/r*Math.pow(e/r,n-1)*Math.exp(-Math.pow(e/r,n))},cdf:function(e,r,n){return e<0?0:1-Math.exp(-Math.pow(e/r,n))}},JA={pdf:function(e,r){return r<0||e%1!==0||e<0?0:Math.pow(r,e)*Math.exp(-r)/k2(e)},cdf:function(e,r){var n=0;if(e<0)return 0;for(var i=0;n<=e;n++)i+=JA.pdf(n,r);return i}},La={pdf:function(e,r,n,i){if(e<0||e<n-(r-i))return 0;if(e>i||e>n)return 0;if(n*2>r)return i*2>r?La.pdf(r-n-i+e,r,r-n,r-i):La.pdf(i-e,r,r-n,i);if(i*2>r)return La.pdf(n-e,r,n,r-i);if(n<i)return La.pdf(e,r,i,n);for(var o=1,a=0,s=0;s<e;s++){for(;o>1&&a<i;)o*=1-n/(r-a),a++;o*=(i-s)*(n-s)/((s+1)*(r-n-i+s+1))}for(;a<i;a++)o*=1-n/(r-a);return Math.min(1,Math.max(0,o))},cdf:function t(e,r,n,i){if(e<0||e<n-(r-i))return 0;if(e>=i||e>=n)return 1;if(n*2>r)return i*2>r?t(r-n-i+e,r,r-n,r-i):1-La.cdf(i-e-1,r,r-n,i);if(i*2>r)return 1-La.cdf(n-e-1,r,n,r-i);if(n<i)return La.cdf(e,r,i,n);for(var o=1,a=1,s=0,l=0;l<e;l++){for(;o>1&&s<i;){var u=1-n/(r-s);a*=u,o*=u,s++}a*=(i-l)*(n-l)/((l+1)*(r-n-i+l+1)),o+=a}for(;s<i;s++)o*=1-n/(r-s);return Math.min(1,Math.max(0,o))}},Wi={pdf:function(e,r){return r=r>1e100?1e100:r,1/(Math.sqrt(r)*ZI(.5,r/2))*Math.pow(1+e*e/r,-((r+1)/2))},cdf:function(e,r){var n=r/2;return gR((e+Math.sqrt(e*e+r))/(2*Math.sqrt(e*e+r)),n,n)},inv:function(t,e){var r=JI(2*Math.min(t,1-t),.5*e,.5);return r=Math.sqrt(e*(1-r)/r),t>.5?r:-r}},a_={pdf:function(e,r,n){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(Math.log(e)-r,2)/(2*n*n))},cdf:function(e,r,n){return e<0?0:.5+.5*oh((Math.log(e)-r)/Math.sqrt(2*n*n))},inv:function(t,e,r){return Math.exp(-1.4142135623730951*r*Jte(2*t)+e)}},e4={pdf:function(e,r,n){return e!==e>>>0?!1:e<0?0:rre(e+r-1,r-1)*Math.pow(1-n,e)*Math.pow(n,r)},cdf:function(e,r,n){var i=0,o=0;if(e<0)return 0;for(;o<=e;o++)i+=e4.pdf(o,r,n);return i}};function nre(t){for(var e=0,r=t.length;--r>=0;)e+=t[r];return e}function Vi(t){return nre(t)/t.length}function Ql(t){for(var e=Vi(t),r=0,n=t.length,i;--n>=0;)i=t[n]-e,r+=i*i;return r}function Ym(t,e){return Ql(t)/(t.length-(e?1:0))}function Ks(t,e){return Math.sqrt(Ym(t,e))}function gct(){var t=[].slice.call(arguments),e=new Array(2),r;return t.length===4?r=Math.abs(bo.inv(t[1]/2,0,1)*t[2]/Math.sqrt(t[3])):r=Math.abs(bo.inv(t[1]/2,0,1)*Ks(t[2])/Math.sqrt(t[2].length)),e[0]=t[0]-r,e[1]=t[0]+r,e}function yct(){var t=[].slice.call(arguments),e=new Array(2),r;return t.length===4?r=Math.abs(Wi.inv(t[1]/2,t[3]-1)*t[2]/Math.sqrt(t[3])):r=Math.abs(Wi.inv(t[1]/2,t[2].length-1)*Ks(t[2],!0)/Math.sqrt(t[2].length)),e[0]=t[0]-r,e[1]=t[0]+r,e}function vct(t){for(var e=1,r=t.length;--r>=0;)e*=t[r];return e}function bct(t){return Math.pow(vct(t),1/t.length)}function Km(t,e){var r=Vi(t),n=Vi(e),i=t.length,o=new Array(i),a;for(a=0;a<i;a++)o[a]=(t[a]-r)*(e[a]-n);return nre(o)/(i-1)}function Cj(t,e){return Km(t,e)/Ks(t,1)/Ks(e,1)}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class eM extends pt{erf(e,r){return this.runFunction(e.args,r,this.metadata("ERF"),(n,i)=>i===void 0?oh(n):oh(i)-oh(n))}erfc(e,r){return this.runFunction(e.args,r,this.metadata("ERFC"),Zte)}expondist(e,r){return this.runFunction(e.args,r,this.metadata("EXPON.DIST"),(n,i,o)=>o?wj.cdf(n,i):wj.pdf(n,i))}fisher(e,r){return this.runFunction(e.args,r,this.metadata("FISHER"),n=>Math.log((1+n)/(1-n))/2)}fisherinv(e,r){return this.runFunction(e.args,r,this.metadata("FISHERINV"),n=>1-2/(Math.exp(2*n)+1))}gamma(e,r){return this.runFunction(e.args,r,this.metadata("GAMMA"),vg)}gammadist(e,r){return this.runFunction(e.args,r,this.metadata("GAMMA.DIST"),(n,i,o,a)=>a?n_.cdf(n,i,o):n_.pdf(n,i,o))}gammaln(e,r){return this.runFunction(e.args,r,this.metadata("GAMMALN"),vn)}gammainv(e,r){return this.runFunction(e.args,r,this.metadata("GAMMA.INV"),n_.inv)}gauss(e,r){return this.runFunction(e.args,r,this.metadata("GAUSS"),n=>bo.cdf(n,0,1)-.5)}betadist(e,r){return this.runFunction(e.args,r,this.metadata("BETA.DIST"),(n,i,o,a,s,l)=>n<=s?new x($.NUM,W.ValueSmall):n>=l?new x($.NUM,W.ValueLarge):(n=(n-s)/(l-s),a?i_.cdf(n,i,o):i_.pdf(n,i,o)))}betainv(e,r){return this.runFunction(e.args,r,this.metadata("BETA.INV"),(n,i,o,a,s)=>a>=s?new x($.NUM,W.WrongOrder):i_.inv(n,i,o)*(s-a)+a)}binomialdist(e,r){return this.runFunction(e.args,r,this.metadata("BINOM.DIST"),(n,i,o,a)=>n>i?new x($.NUM,W.WrongOrder):(n=Math.trunc(n),i=Math.trunc(i),a?P2.cdf(n,i,o):P2.pdf(n,i,o)))}binomialinv(e,r){return this.runFunction(e.args,r,this.metadata("BINOM.INV"),(n,i,o)=>{n=Math.trunc(n);let a=-1,s=n;for(;s>a+1;){const l=Math.trunc((a+s)/2);P2.cdf(l,n,i)>=o?s=l:a=l}return s})}besselifn(e,r){return this.runFunction(e.args,r,this.metadata("BESSELI"),(n,i)=>ZA(n,Math.trunc(i)))}besseljfn(e,r){return this.runFunction(e.args,r,this.metadata("BESSELJ"),(n,i)=>QA(n,Math.trunc(i)))}besselkfn(e,r){return this.runFunction(e.args,r,this.metadata("BESSELK"),(n,i)=>pct(n,Math.trunc(i)))}besselyfn(e,r){return this.runFunction(e.args,r,this.metadata("BESSELY"),(n,i)=>dct(n,Math.trunc(i)))}chisqdist(e,r){return this.runFunction(e.args,r,this.metadata("CHISQ.DIST"),(n,i,o)=>(i=Math.trunc(i),o?xf.cdf(n,i):xf.pdf(n,i)))}chisqdistrt(e,r){return this.runFunction(e.args,r,this.metadata("CHISQ.DIST.RT"),(n,i)=>1-xf.cdf(n,Math.trunc(i)))}chisqinv(e,r){return this.runFunction(e.args,r,this.metadata("CHISQ.INV"),(n,i)=>xf.inv(n,Math.trunc(i)))}chisqinvrt(e,r){return this.runFunction(e.args,r,this.metadata("CHISQ.INV.RT"),(n,i)=>xf.inv(1-n,Math.trunc(i)))}fdist(e,r){return this.runFunction(e.args,r,this.metadata("F.DIST"),(n,i,o,a)=>(i=Math.trunc(i),o=Math.trunc(o),a?If.cdf(n,i,o):If.pdf(n,i,o)))}fdistrt(e,r){return this.runFunction(e.args,r,this.metadata("F.DIST.RT"),(n,i,o)=>1-If.cdf(n,Math.trunc(i),Math.trunc(o)))}finv(e,r){return this.runFunction(e.args,r,this.metadata("F.INV"),(n,i,o)=>If.inv(n,Math.trunc(i),Math.trunc(o)))}finvrt(e,r){return this.runFunction(e.args,r,this.metadata("F.INV.RT"),(n,i,o)=>If.inv(1-n,Math.trunc(i),Math.trunc(o)))}weibulldist(e,r){return this.runFunction(e.args,r,this.metadata("WEIBULL.DIST"),(n,i,o,a)=>a?Ej.cdf(n,o,i):Ej.pdf(n,o,i))}poissondist(e,r){return this.runFunction(e.args,r,this.metadata("POISSON.DIST"),(n,i,o)=>(n=Math.trunc(n),o?JA.cdf(n,i):JA.pdf(n,i)))}hypgeomdist(e,r){return this.runFunction(e.args,r,this.metadata("HYPGEOM.DIST"),(n,i,o,a,s)=>n>i||n>o||i>a||o>a?new x($.NUM,W.ValueLarge):n+a<o+i?new x($.NUM,W.ValueLarge):(n=Math.trunc(n),i=Math.trunc(i),o=Math.trunc(o),a=Math.trunc(a),s?La.cdf(n,a,o,i):La.pdf(n,a,o,i)))}tdist(e,r){return this.runFunction(e.args,r,this.metadata("T.DIST"),(n,i,o)=>(i=Math.trunc(i),o?Wi.cdf(n,i):Wi.pdf(n,i)))}tdist2t(e,r){return this.runFunction(e.args,r,this.metadata("T.DIST.2T"),(n,i)=>(1-Wi.cdf(n,Math.trunc(i)))*2)}tdistrt(e,r){return this.runFunction(e.args,r,this.metadata("T.DIST.RT"),(n,i)=>1-Wi.cdf(n,Math.trunc(i)))}tdistold(e,r){return this.runFunction(e.args,r,this.metadata("TDIST"),(n,i,o)=>o*(1-Wi.cdf(n,Math.trunc(i))))}tinv(e,r){return this.runFunction(e.args,r,this.metadata("T.INV"),(n,i)=>Wi.inv(n,Math.trunc(i)))}tinv2t(e,r){return this.runFunction(e.args,r,this.metadata("T.INV.2T"),(n,i)=>Wi.inv(1-n/2,Math.trunc(i)))}lognormdist(e,r){return this.runFunction(e.args,r,this.metadata("LOGNORM.DIST"),(n,i,o,a)=>a?a_.cdf(n,i,o):a_.pdf(n,i,o))}lognorminv(e,r){return this.runFunction(e.args,r,this.metadata("LOGNORM.INV"),(n,i,o)=>a_.inv(n,i,o))}normdist(e,r){return this.runFunction(e.args,r,this.metadata("NORM.DIST"),(n,i,o,a)=>a?bo.cdf(n,i,o):bo.pdf(n,i,o))}norminv(e,r){return this.runFunction(e.args,r,this.metadata("NORM.INV"),(n,i,o)=>bo.inv(n,i,o))}normsdist(e,r){return this.runFunction(e.args,r,this.metadata("NORM.S.DIST"),(n,i)=>i?bo.cdf(n,0,1):bo.pdf(n,0,1))}normsinv(e,r){return this.runFunction(e.args,r,this.metadata("NORM.S.INV"),n=>bo.inv(n,0,1))}phi(e,r){return this.runFunction(e.args,r,this.metadata("PHI"),n=>bo.pdf(n,0,1))}negbinomdist(e,r){return this.runFunction(e.args,r,this.metadata("NEGBINOM.DIST"),(n,i,o,a)=>(n=Math.trunc(n),i=Math.trunc(i),a?e4.cdf(n,i,o):e4.pdf(n,i,o)))}confidencenorm(e,r){return this.runFunction(e.args,r,this.metadata("CONFIDENCE.NORM"),(n,i,o)=>gct(1,n,i,Math.trunc(o))[1]-1)}confidencet(e,r){return this.runFunction(e.args,r,this.metadata("CONFIDENCE.T"),(n,i,o)=>(o=Math.trunc(o),o===1?new x($.DIV_BY_ZERO):yct(1,n,i,o)[1]-1))}standardize(e,r){return this.runFunction(e.args,r,this.metadata("STANDARDIZE"),(n,i,o)=>(n-i)/o)}}eM.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:w.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:w.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:w.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:w.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:w.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:w.NUMBER,minValue:0,lessThan:1},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:w.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.BOOLEAN},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:w.NUMBER,greaterThan:0,maxValue:1},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,defaultValue:0},{argumentType:w.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0,maxValue:1},{argumentType:w.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0,maxValue:1},{argumentType:w.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:1,maxValue:1e10},{argumentType:w.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:w.NUMBER,minValue:0,maxValue:1},{argumentType:w.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:w.NUMBER,minValue:0,maxValue:1},{argumentType:w.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:1},{argumentType:w.NUMBER,minValue:1},{argumentType:w.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:1},{argumentType:w.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:w.NUMBER,minValue:0,maxValue:1},{argumentType:w.NUMBER,minValue:1},{argumentType:w.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:w.NUMBER,minValue:0,maxValue:1},{argumentType:w.NUMBER,minValue:1},{argumentType:w.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0},{argumentType:w.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:1},{argumentType:w.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:1},{argumentType:w.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:w.NUMBER,greaterThan:0,lessThan:1},{argumentType:w.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:w.NUMBER,greaterThan:0,maxValue:1},{argumentType:w.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:w.NUMBER,greaterThan:0,lessThan:1},{argumentType:w.NUMBER},{argumentType:w.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:w.NUMBER,greaterThan:0,lessThan:1},{argumentType:w.NUMBER},{argumentType:w.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:w.NUMBER},{argumentType:w.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:w.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:w.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:1},{argumentType:w.NUMBER,minValue:0,maxValue:1},{argumentType:w.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:w.NUMBER,greaterThan:0,lessThan:1},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:w.NUMBER,greaterThan:0,lessThan:1},{argumentType:w.NUMBER,greaterThan:0},{argumentType:w.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER,greaterThan:0}]}};eM.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class ire extends pt{fact(e,r){return this.runFunction(e.args,r,this.metadata("FACT"),n=>{n=Math.trunc(n);let i=1;for(let o=1;o<=n;o++)i*=o;return i})}factdouble(e,r){return this.runFunction(e.args,r,this.metadata("FACTDOUBLE"),n=>{n=Math.trunc(n);let i=1;for(let o=n;o>=1;o-=2)i*=o;return i})}combin(e,r){return this.runFunction(e.args,r,this.metadata("COMBIN"),(n,i)=>i>n?new x($.NUM,W.WrongOrder):(n=Math.trunc(n),i=Math.trunc(i),_j(n,i)))}combina(e,r){return this.runFunction(e.args,r,this.metadata("COMBINA"),(n,i)=>(n=Math.trunc(n),i=Math.trunc(i),n+i-1>=1030?new x($.NUM,W.ValueLarge):n===0&&i===0?1:_j(n+i-1,i)))}gcd(e,r){return this.runFunction(e.args,r,this.metadata("GCD"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(n);if(i instanceof x)return i;let o=0;for(const a of i){if(a<0)return new x($.NUM,W.ValueSmall);o=ore(o,Math.trunc(a))}return o>Number.MAX_SAFE_INTEGER?new x($.NUM,W.ValueLarge):o})}lcm(e,r){return this.runFunction(e.args,r,this.metadata("LCM"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(n);if(i instanceof x)return i;let o=1;for(const a of i){if(a<0)return new x($.NUM,W.ValueSmall);o=wct(o,Math.trunc(a))}return o>Number.MAX_SAFE_INTEGER?new x($.NUM,W.ValueLarge):o})}mround(e,r){return this.runFunction(e.args,r,this.metadata("MROUND"),(n,i)=>i===0?0:n>0&&i<0||n<0&&i>0?new x($.NUM,W.DistinctSigns):Math.round(n/i)*i)}multinomial(e,r){return this.runFunction(e.args,r,this.metadata("MULTINOMIAL"),(...n)=>{let i=0,o=1;for(let a of n){if(a<0)return new x($.NUM,W.ValueSmall);a=Math.trunc(a);for(let s=1;s<=a;s++)o*=(i+s)/s;i+=a}return Math.round(o)})}quotient(e,r){return this.runFunction(e.args,r,this.metadata("QUOTIENT"),(n,i)=>i===0?new x($.DIV_BY_ZERO):Math.trunc(n/i))}seriessum(e,r){return this.runFunction(e.args,r,this.metadata("SERIESSUM"),(n,i,o,a)=>{const s=this.arithmeticHelper.manyToOnlyNumbersDropNulls(a.valuesFromTopLeftCorner());if(s instanceof x)return s;let l=0;s.reverse();for(const u of s)l*=Math.pow(n,o),l+=u;return l*Math.pow(n,i)})}sign(e,r){return this.runFunction(e.args,r,this.metadata("SIGN"),n=>n>0?1:n<0?-1:0)}sumx2my2(e,r){return this.runFunction(e.args,r,this.metadata("SUMX2MY2"),(n,i)=>{const o=n.valuesFromTopLeftCorner(),a=i.valuesFromTopLeftCorner();if(o.length!==a.length)return new x($.NA,W.EqualLength);const s=o.length;let l=0;for(let u=0;u<s;u++){const c=o[u],f=a[u];if(c instanceof x)return c;if(f instanceof x)return f;typeof c=="number"&&typeof f=="number"&&(l+=Math.pow(c,2)-Math.pow(f,2))}return l})}sumx2py2(e,r){return this.runFunction(e.args,r,this.metadata("SUMX2PY2"),(n,i)=>{const o=n.valuesFromTopLeftCorner(),a=i.valuesFromTopLeftCorner();if(o.length!==a.length)return new x($.NA,W.EqualLength);const s=o.length;let l=0;for(let u=0;u<s;u++){const c=o[u],f=a[u];if(c instanceof x)return c;if(f instanceof x)return f;typeof c=="number"&&typeof f=="number"&&(l+=Math.pow(c,2)+Math.pow(f,2))}return l})}sumxmy2(e,r){return this.runFunction(e.args,r,this.metadata("SUMXMY2"),(n,i)=>{const o=n.valuesFromTopLeftCorner(),a=i.valuesFromTopLeftCorner();if(o.length!==a.length)return new x($.NA,W.EqualLength);const s=o.length;let l=0;for(let u=0;u<s;u++){const c=o[u],f=a[u];if(c instanceof x)return c;if(f instanceof x)return f;typeof c=="number"&&typeof f=="number"&&(l+=Math.pow(c-f,2))}return l})}}ire.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:w.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:w.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:w.NUMBER,minValue:0,lessThan:1030},{argumentType:w.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:w.NUMBER,minValue:0},{argumentType:w.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:w.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:w.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]}};function _j(t,e){2*e>t&&(e=t-e);let r=1;for(let n=1;n<=e;n++)r*=(t-e+n)/n;return Math.round(r)}function ore(t,e){for(t<e&&([t,e]=[e,t]);e>0;)[t,e]=[e,t%e];return t}function wct(t,e){return t===0||e===0?0:t*(e/ore(t,e))}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class are extends pt{complex(e,r){return this.runFunction(e.args,r,this.metadata("COMPLEX"),(n,i,o)=>o!=="i"&&o!=="j"?new x($.VALUE,W.ShouldBeIorJ):Ar([n,i],o))}imabs(e,r){return this.runFunction(e.args,r,this.metadata("IMABS"),ure)}imaginary(e,r){return this.runFunction(e.args,r,this.metadata("IMAGINARY"),([n,i])=>i)}imreal(e,r){return this.runFunction(e.args,r,this.metadata("IMREAL"),([n,i])=>n)}imargument(e,r){return this.runFunction(e.args,r,this.metadata("IMARGUMENT"),([n,i])=>n===0&&i===0?new x($.DIV_BY_ZERO):Math.atan2(i,n))}imconjugate(e,r){return this.runFunction(e.args,r,this.metadata("IMCONJUGATE"),([n,i])=>Ar([n,-i]))}imcos(e,r){return this.runFunction(e.args,r,this.metadata("IMCOS"),n=>Ar(Sb(n)))}imcosh(e,r){return this.runFunction(e.args,r,this.metadata("IMCOSH"),n=>Ar(Tj(n)))}imcot(e,r){return this.runFunction(e.args,r,this.metadata("IMCOT"),n=>Ar(Kl(Sb(n),Rb(n))))}imcsc(e,r){return this.runFunction(e.args,r,this.metadata("IMCSC"),n=>Ar(Kl([1,0],Rb(n))))}imcsch(e,r){return this.runFunction(e.args,r,this.metadata("IMCSCH"),n=>Ar(Kl([1,0],Oj(n))))}imsec(e,r){return this.runFunction(e.args,r,this.metadata("IMSEC"),n=>Ar(Kl([1,0],Sb(n))))}imsech(e,r){return this.runFunction(e.args,r,this.metadata("IMSECH"),n=>Ar(Kl([1,0],Tj(n))))}imsin(e,r){return this.runFunction(e.args,r,this.metadata("IMSIN"),n=>Ar(Rb(n)))}imsinh(e,r){return this.runFunction(e.args,r,this.metadata("IMSINH"),n=>Ar(Oj(n)))}imtan(e,r){return this.runFunction(e.args,r,this.metadata("IMTAN"),n=>Ar(Kl(Rb(n),Sb(n))))}imdiv(e,r){return this.runFunction(e.args,r,this.metadata("IMDIV"),(n,i)=>Ar(Kl(n,i)))}improduct(e,r){return this.runFunction(e.args,r,this.metadata("IMPRODUCT"),(...n)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(n);if(i instanceof x)return i;let o=[1,0];for(const a of i)o=sre(o,a);return Ar(o)})}imsum(e,r){return this.runFunction(e.args,r,this.metadata("IMSUM"),(...n)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(n);if(i instanceof x)return i;let o=[0,0];for(const a of i)o=Sct(o,a);return Ar(o)})}imsub(e,r){return this.runFunction(e.args,r,this.metadata("IMSUB"),(n,i)=>Ar(Rct(n,i)))}imexp(e,r){return this.runFunction(e.args,r,this.metadata("IMEXP"),n=>Ar(lre(n)))}imln(e,r){return this.runFunction(e.args,r,this.metadata("IMLN"),n=>Ar($2(n)))}imlog10(e,r){return this.runFunction(e.args,r,this.metadata("IMLOG10"),n=>{const[i,o]=$2(n),a=Math.log(10);return Ar([i/a,o/a])})}imlog2(e,r){return this.runFunction(e.args,r,this.metadata("IMLOG2"),n=>{const[i,o]=$2(n),a=Math.log(2);return Ar([i/a,o/a])})}impower(e,r){return this.runFunction(e.args,r,this.metadata("IMPOWER"),(n,i)=>Ar(Aj(n,i)))}imsqrt(e,r){return this.runFunction(e.args,r,this.metadata("IMSQRT"),n=>Ar(Aj(n,.5)))}}are.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:w.NUMBER},{argumentType:w.NUMBER},{argumentType:w.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:w.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:w.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:w.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:w.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:w.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:w.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:w.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:w.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:w.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:w.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:w.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:w.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:w.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:w.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:w.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:w.COMPLEX},{argumentType:w.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:w.COMPLEX},{argumentType:w.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:w.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:w.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:w.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:w.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:w.COMPLEX},{argumentType:w.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:w.COMPLEX}]}};function Sct([t,e],[r,n]){return[t+r,e+n]}function Rct([t,e],[r,n]){return[t-r,e-n]}function sre([t,e],[r,n]){return[t*r-e*n,t*n+r*e]}function Kl([t,e],[r,n]){const i=Math.pow(r,2)+Math.pow(n,2),[o,a]=sre([t,e],[r,-n]);return[o/i,a/i]}function Sb([t,e]){return[Math.cos(t)*Math.cosh(e),-Math.sin(t)*Math.sinh(e)]}function Tj([t,e]){return[Math.cosh(t)*Math.cos(e),Math.sinh(t)*Math.sin(e)]}function Rb([t,e]){return[Math.sin(t)*Math.cosh(e),Math.cos(t)*Math.sinh(e)]}function Oj([t,e]){return[Math.sinh(t)*Math.cos(e),Math.cosh(t)*Math.sin(e)]}function lre([t,e]){return[Math.exp(t)*Math.cos(e),Math.exp(t)*Math.sin(e)]}function ure([t,e]){return Math.sqrt(t*t+e*e)}function $2([t,e]){return[Math.log(ure([t,e])),Math.atan2(e,t)]}function Aj(t,e){const[r,n]=$2(t);return lre([e*r,e*n])}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class tM extends pt{avedev(e,r){return this.runFunction(e.args,r,this.metadata("AVEDEV"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof x)return i;if(i.length===0)return new x($.DIV_BY_ZERO);const o=Vi(i);return i.reduce((a,s)=>a+Math.abs(s-o),0)/i.length})}devsq(e,r){return this.runFunction(e.args,r,this.metadata("DEVSQ"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);return i instanceof x?i:i.length===0?0:Ql(i)})}geomean(e,r){return this.runFunction(e.args,r,this.metadata("GEOMEAN"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof x)return i;if(i.length===0)return new x($.NUM,W.OneValue);for(const o of i)if(o<=0)return new x($.NUM,W.ValueSmall);return bct(i)})}harmean(e,r){return this.runFunction(e.args,r,this.metadata("HARMEAN"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof x)return i;if(i.length===0)return new x($.NUM,W.OneValue);for(const o of i)if(o<=0)return new x($.NUM,W.ValueSmall);return i.length/i.reduce((o,a)=>o+1/a,0)})}correl(e,r){return this.runFunction(e.args,r,this.metadata("CORREL"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new x($.NA,W.EqualLength);const o=ql(n,i);return o instanceof x?o:o[0].length<=1?new x($.DIV_BY_ZERO,W.TwoValues):Cj(o[0],o[1])})}rsq(e,r){return this.runFunction(e.args,r,this.metadata("RSQ"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new x($.NA,W.EqualLength);const o=ql(n,i);return o instanceof x?o:o[0].length<=1?new x($.DIV_BY_ZERO,W.TwoValues):Math.pow(Cj(o[0],o[1]),2)})}covariancep(e,r){return this.runFunction(e.args,r,this.metadata("COVARIANCE.P"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new x($.NA,W.EqualLength);const o=ql(n,i);if(o instanceof x)return o;const a=o[0].length;return a<1?new x($.DIV_BY_ZERO,W.OneValue):a===1?0:Km(o[0],o[1])*(a-1)/a})}covariances(e,r){return this.runFunction(e.args,r,this.metadata("COVARIANCE.S"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new x($.NA,W.EqualLength);const o=ql(n,i);return o instanceof x?o:o[0].length<=1?new x($.DIV_BY_ZERO,W.TwoValues):Km(o[0],o[1])})}ztest(e,r){return this.runFunction(e.args,r,this.metadata("Z.TEST"),(n,i,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());if(a instanceof x)return a;const s=a.length;if(o===void 0){if(s<2)return new x($.DIV_BY_ZERO,W.TwoValues);o=Ks(a,!0)}return s<1?new x($.NA,W.OneValue):o===0?new x($.DIV_BY_ZERO):1-bo.cdf((Vi(a)-i)/(o/Math.sqrt(s)),0,1)})}ftest(e,r){return this.runFunction(e.args,r,this.metadata("F.TEST"),(n,i)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner()),a=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(o instanceof x)return o;if(a instanceof x)return a;if(o.length<=1||a.length<=1)return new x($.DIV_BY_ZERO);const s=Ym(o,!0),l=Ym(a,!0);if(s===0||l===0)return new x($.DIV_BY_ZERO);const u=s/l,c=If.cdf(u,o.length-1,a.length-1);return 2*Math.min(c,1-c)})}steyx(e,r){return this.runFunction(e.args,r,this.metadata("STEYX"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new x($.NA,W.EqualLength);const o=ql(n,i);if(o instanceof x)return o;const a=o[0].length;return a<=2?new x($.DIV_BY_ZERO,W.ThreeValues):Math.sqrt((Ql(o[0])-Math.pow(Km(o[0],o[1])*(a-1),2)/Ql(o[1]))/(a-2))})}slope(e,r){return this.runFunction(e.args,r,this.metadata("SLOPE"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new x($.NA,W.EqualLength);const o=ql(n,i);if(o instanceof x)return o;const a=o[0].length;return a<=1?new x($.DIV_BY_ZERO,W.TwoValues):Km(o[0],o[1])*(a-1)/Ql(o[1])})}chisqtest(e,r){return this.runFunction(e.args,r,this.metadata("CHISQ.TEST"),(n,i)=>{const o=n.height(),a=n.width();if(i.height()!==o||i.width()!==a)return new x($.NA,W.EqualLength);const s=ql(n,i);if(s instanceof x)return s;if(s[0].length<=1)return new x($.DIV_BY_ZERO,W.TwoValues);let l=0;for(let u=0;u<s[0].length;u++){if(s[1][u]===0)return new x($.DIV_BY_ZERO);l+=Math.pow(s[0][u]-s[1][u],2)/s[1][u]}return l<0?new x($.NUM,W.NaN):1-xf.cdf(l,o>1&&a>1?(o-1)*(a-1):o*a-1)})}ttest(e,r){return this.runFunction(e.args,r,this.metadata("T.TEST"),(n,i,o,a)=>{const s=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner()),l=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(s instanceof x)return s;if(l instanceof x)return l;const u=s.length,c=l.length;if(a===1){if(c!==u)return new x($.NA,W.EqualLength);if(u<=1)return new x($.DIV_BY_ZERO,W.TwoValues);const f=Array(u);for(let p=0;p<u;p++)f[p]=s[p]-l[p];const h=Ks(f,!0);if(h===0)return new x($.DIV_BY_ZERO);const d=Math.abs(Math.sqrt(u)*Vi(f)/h);return o*(1-Wi.cdf(d,u-1))}else if(a===2){if(u<=1||c<=1)return new x($.DIV_BY_ZERO,W.TwoValues);const f=(Ql(s)+Ql(l))/(u+c-2);if(f===0)return new x($.DIV_BY_ZERO);const h=Math.abs((Vi(s)-Vi(l))/Math.sqrt(f*(1/u+1/c)));return o*(1-Wi.cdf(h,u+c-2))}else{if(u<=1||c<=1)return new x($.DIV_BY_ZERO,W.TwoValues);const f=Ym(s,!0),h=Ym(l,!0);if(f===0&&h===0)return new x($.DIV_BY_ZERO);const d=Math.abs((Vi(s)-Vi(l))/Math.sqrt(f/u+h/c)),p=Math.pow(f/u+h/c,2)/(Math.pow(f/u,2)/(u-1)+Math.pow(h/c,2)/(c-1));return o*(1-Wi.cdf(d,p))}})}skew(e,r){return this.runFunction(e.args,r,this.metadata("SKEW"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof x)return i;const o=i.length;if(o<3)return new x($.DIV_BY_ZERO,W.ThreeValues);const a=Vi(i),s=Ks(i,!0);return s===0?new x($.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-a)/s,3),0)*o/(o-1)/(o-2)})}skewp(e,r){return this.runFunction(e.args,r,this.metadata("SKEW.P"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof x)return i;const o=i.length;if(o<3)return new x($.DIV_BY_ZERO,W.ThreeValues);const a=Vi(i),s=Ks(i,!1);return s===0?new x($.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-a)/s,3),0)/o})}}tM.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:w.RANGE},{argumentType:w.NUMBER},{argumentType:w.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:w.RANGE},{argumentType:w.RANGE},{argumentType:w.INTEGER,minValue:1,maxValue:2},{argumentType:w.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:w.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:w.ANY}],repeatLastArgs:1}};tM.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};function ql(t,e){const r=t.iterateValuesFromTopLeftCorner(),n=e.iterateValuesFromTopLeftCorner();let i,o;const a=[],s=[];for(;i=r.next(),o=n.next(),!i.done&&!o.done;){const l=i.value,u=o.value;if(l instanceof x)return l;if(u instanceof x)return u;Ft(l)&&Ft(u)&&(a.push(Ne(l)),s.push(Ne(u)))}return[a,s]}/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */const xj=Object.freeze(Object.defineProperty({__proto__:null,ArrayPlugin:ute,AbsPlugin:cte,BitShiftPlugin:fte,BitwiseLogicOperationsPlugin:mte,BooleanPlugin:gte,CharPlugin:yte,CodePlugin:vte,CountBlankPlugin:bte,CountUniquePlugin:wte,DateTimePlugin:Ste,DegreesPlugin:Rte,DeltaPlugin:Ete,ExpPlugin:Cte,FinancialPlugin:_te,FormulaTextPlugin:Tte,InformationPlugin:Ote,IsEvenPlugin:Ate,IsOddPlugin:xte,LogarithmPlugin:Ite,MathConstantsPlugin:Mte,MatrixPlugin:Nte,MedianPlugin:Pte,ModuloPlugin:kte,NumericAggregationPlugin:qI,PowerPlugin:$te,RadiansPlugin:Lte,RadixConversionPlugin:Fte,RandomPlugin:Ute,RoundingPlugin:XI,SqrtPlugin:Vte,ConditionalAggregationPlugin:jte,SumprodPlugin:Wte,TextPlugin:zte,TrigonometryPlugin:Gte,LookupPlugin:Yte,RomanPlugin:Kte,SimpleArithmerticPlugin:qte,StatisticalPlugin:eM,MathPlugin:ire,ComplexPlugin:are,StatisticalAggregationPlugin:tM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright (c) 2023 Handsoncode. All rights reserved.
 */class Ot extends Pn{}Ot.HyperFormula=Pn;Ot.ErrorType=$;Ot.CellType=ui;Ot.CellValueType=To;Ot.CellValueDetailedType=clt;Ot.DetailedCellError=Yee;Ot.ExportedCellChange=GA;Ot.ExportedNamedExpressionChange=nte;Ot.ConfigValueTooBigError=kee;Ot.ConfigValueTooSmallError=Pee;Ot.EvaluationSuspendedError=Lee;Ot.ExpectedOneOfValuesError=$ee;Ot.ExpectedValueOfTypeError=Bt;Ot.ArraySize=yt;Ot.FunctionPlugin=pt;Ot.FunctionArgumentType=w;Ot.FunctionPluginValidationError=vp;Ot.InvalidAddressError=Tee;Ot.InvalidArgumentsError=Qr;Ot.LanguageNotRegisteredError=LA;Ot.LanguageAlreadyRegisteredError=Fee;Ot.MissingTranslationError=Of;Ot.NamedExpressionDoesNotExistError=Dv;Ot.NamedExpressionNameIsAlreadyTakenError=Oee;Ot.NamedExpressionNameIsInvalidError=Aee;Ot.NoOperationToRedoError=Iee;Ot.NoOperationToUndoError=xee;Ot.NoRelativeAddressesAllowedError=jI;Ot.NoSheetWithIdError=yr;Ot.NoSheetWithNameError=_ee;Ot.NotAFormulaError=$A;Ot.NothingToPasteError=Mee;Ot.ProtectedFunctionTranslationError=Dee;Ot.SheetNameAlreadyTakenError=$v;Ot.SheetSizeLimitExceededError=Bu;Ot.SourceLocationHasArrayError=Df;Ot.TargetLocationHasArrayError=gS;Ot.UnableToParseError=Nee;const Ect=xn.defaultConfig.language;Pn.registerLanguage(Ect,YA);Pn.languages[YA.langCode]=YA;for(const t of Object.getOwnPropertyNames(xj))t.startsWith("_")||Pn.registerFunctionPlugin(xj[t]);Mnt();const Cct=Ot.buildEmpty({licenseKey:"internal-use-in-handsontable"}),_ct={startDate:xt().toString(),endDate:xt().add(1,"M").toString(),expenditure:[["Line item name","Amount"]],income:[["Line item name","Amount"]],total:[["Total","=sum(income!B1:B9999) - sum(expenditure!B1:B9999)"]]},Tct=Pz("dataAtom",_ct),Oct=()=>{n1(o=>o.database);const[t,e]=Cs(Tct);return de.createElement(Nt,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",sx:{width:"90vw"},spacing:2},de.createElement(Nt,{item:!0,lg:6},de.createElement(n,{value:t.startDate,label:"Start Date",dataKey:"startDate"})),de.createElement(Nt,{item:!0,lg:6},de.createElement(n,{value:t.endDate,label:"End Date",dataKey:"endDate"})),de.createElement(Nt,{item:!0,lg:12},de.createElement(b5,{sx:{width:"90vw"}},de.createElement(i,{data:t.expenditure,reducerKey:"expenditure",updateData:r}))),de.createElement(Nt,{item:!0,lg:12},de.createElement(b5,{sx:{width:"90vw"}},de.createElement(i,{data:t.income,reducerKey:"income",updateData:r}))),de.createElement(Nt,{item:!0,lg:12},de.createElement(b5,{sx:{width:"90vw"}},de.createElement(i,{data:t.total,reducerKey:"total",updateData:r}))));function r(o){const{type:a,payload:s}=o,l=e;switch(o.type){case"startDate":case"endDate":case"expenditure":case"income":l({...t,[a]:s});break}}function n({dataKey:o,label:a,value:s}){return de.createElement(Bz,{dateAdapter:Uz,adapterLocale:"en-sg"},de.createElement(Vz,{label:a,onChange:l=>r({type:o,payload:l}),value:xt(s)}))}function i({reducerKey:o,data:a,updateData:s}){return de.createElement(hJ,{stretchH:"all",width:"100%",data:a,rowHeaders:!0,minSpareRows:1,licenseKey:"non-commercial-and-evaluation",formulas:{engine:Cct,sheetName:o},beforeChange:l=>{let u=on.exports.cloneDeep(a);l.forEach(c=>{if(c===null)return;const[f,h,d,p]=c;console.log({row:f,col:h,oldVal:d,newVal:p}),f>a.length&&on.exports.concat(u,new Array(a.length-f).fill("")),typeof h=="number"&&(u[f][h]=p)}),s({type:o,payload:u})}})}},Act=bl(he.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add"),xct=bl(he.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}),"ArrowBack"),Ict=bl(he.jsx("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward"),Mct=bl(he.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear"),Nct=bl(he.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),Pct=bl(he.jsx("path",{d:"M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2H6zm10 14.5V20H8v-3.5l4-4 4 4zm-4-5-4-4V4h8v3.5l-4 4z"}),"HourglassEmpty"),kct=bl(he.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm.88 15.76V19h-1.75v-1.29c-.74-.18-2.39-.77-3.02-2.96l1.65-.67c.06.22.58 2.09 2.4 2.09.93 0 1.98-.48 1.98-1.61 0-.96-.7-1.46-2.28-2.03-1.1-.39-3.35-1.03-3.35-3.31 0-.1.01-2.4 2.62-2.96V5h1.75v1.24c1.84.32 2.51 1.79 2.66 2.23l-1.58.67c-.11-.35-.59-1.34-1.9-1.34-.7 0-1.81.37-1.81 1.39 0 .95.86 1.31 2.64 1.9 2.4.83 3.01 2.05 3.01 3.45 0 2.63-2.5 3.13-3.02 3.22z"}),"Paid"),$ct=bl(he.jsx("path",{d:"M19 13H5v-2h14v2z"}),"Remove");var Xi={exports:{}};const Lct=Mz(rae);(function(t,e){(function(r,n){n(e,Lct,J.exports)})(ch,function(r,n,i){function o(c){return c&&typeof c=="object"&&"default"in c?c:{default:c}}var a=o(i);function s(c,f,h){var d,p;typeof c=="function"?(d=f||[],p=h):(d=[],p=f);var m=a.default.useRef({hasResult:!1,result:p,error:null}),g=a.default.useReducer(function(b){return b+1},0);g[0];var v=g[1],S=a.default.useMemo(function(){var b=typeof c=="function"?c():c;if(!b||typeof b.subscribe!="function")throw c===b?new TypeError("Given argument to useObservable() was neither a valid observable nor a function."):new TypeError("Observable factory given to useObservable() did not return a valid observable.");if(!m.current.hasResult)if(typeof b.getValue=="function")m.current.result=b.getValue(),m.current.hasResult=!0;else{var E=b.subscribe(function(T){m.current.result=T,m.current.hasResult=!0});typeof E=="function"?E():E.unsubscribe()}return b},d);if(a.default.useDebugValue(m.current.result),a.default.useEffect(function(){var b=S.subscribe(function(E){var T=m.current;(T.error!==null||T.result!==E)&&(T.error=null,T.result=E,T.hasResult=!0,v())},function(E){var T=m.current;T.error!==E&&(T.error=E,v())});return typeof b=="function"?b:b.unsubscribe.bind(b)},d),m.current.error)throw m.current.error;return m.current.result}function l(c,f,h){return s(function(){return n.liveQuery(c)},f||[],h)}function u(c,f,h){if(!c)throw new TypeError("Invalid arguments to usePermissions(): undefined or null");var d;if(arguments.length>=3){if(!("transaction"in c))throw new TypeError("Invalid arguments to usePermission(db, table, obj): 1st arg must be a Dexie instance");if(typeof f!="string")throw new TypeError("Invalid arguments to usePermission(db, table, obj): 2nd arg must be string");if(!h||typeof h!="object")throw new TypeError("Invalid arguments to usePermission(db, table, obj): 3rd arg must be an object");d=c}else{if(c instanceof n.Dexie)throw new TypeError("Invalid arguments to usePermission(db, table, obj): Missing table and obj arguments.");if(typeof c.table=="function"&&typeof c.db=="object")d=c.db,h=c,f=c.table();else throw new TypeError("Invalid arguments to usePermissions(). Expected usePermissions(entity: DexieCloudEntity) or usePermissions(db: Dexie, table: string, obj: DexieCloudObject)")}if(!("cloud"in d))throw new Error("usePermissions() is only for Dexie Cloud but there's no dexie-cloud-addon active in given db.");if(!("permissions"in d.cloud))throw new Error("usePermissions() requires a newer version of dexie-cloud-addon. Please upgrade it.");return s(function(){return d.cloud.permissions(h,f)},[h.realmId,h.owner,f])}r.useLiveQuery=l,r.useObservable=s,r.usePermissions=u,Object.defineProperty(r,"__esModule",{value:!0})})})(Xi,Xi.exports);const cre=kz({show:!1,message:"",severity:"info"}),Dct=()=>{const[t,e]=Cs(cre),r=(i,o)=>{o!=="clickaway"&&e({...t,show:!1})},n=de.createElement(de.Fragment,null,de.createElement(_g,{size:"small","aria-label":"close",color:"inherit",onClick:r},de.createElement(Nct,{fontSize:"small"})));return de.createElement(cae,{open:t.show,autoHideDuration:3e3,onClose:r,action:n},de.createElement(fae,{severity:t.severity},t.message))},Fct=Dct,s_={[ur.category]:[],[ur.name]:"",[ur.amount]:"",[ur.datetime]:xt().unix(),[ur.transactionType]:pn.CREDIT,[ur.creditCard]:""},Hct=()=>{const t=n1(p=>p.database),[,e]=Cs(cre),r=Xi.exports.useLiveQuery(async()=>{const p=await t.expenditure.toArray(),m=await t.recurring.toArray(),g=p.reduce((E,T)=>[...E,...JSON.parse(T[ur.category])],[]),v=m.reduce((E,T)=>[...E,T.name],[]),S=p.map(E=>E[ur.creditCard]),b=m.map(E=>E.credit_card);return{categories:on.exports.uniq([...g,...v]).filter(E=>E!==void 0),creditCards:on.exports.uniq([...S,...b]).filter(E=>E!==void 0)}}),[n,i]=J.exports.useState(s_),[o,a]=J.exports.useState(!1),[s,l]=J.exports.useState("monthly");function u(p,m){i({...n,[p]:m})}function c(p){if(!!Object.values(n).some(v=>v===""||v===null||v===void 0)){e({show:!1,message:"Please fill in all fields first.",severity:"error"});return}const g=JSON.stringify(n.category);if(p===pn.RECURRING){if(o===!1){a(!0);return}let v=xt.unix(n.datetime),S;switch(s){case"weekly":S=`${s} ${v.day()}`;break;case"monthly":S=`${s} ${v.date()}`;break;case"yearly":S=`${s} ${v.format("DD-MM")}`;break;default:S=`${s} ${v.day()}`;break}t.recurring.add({name:n.name,amount:parseFloat(n.amount),cron:S,start:n.datetime,category:g,credit_card:n.credit_card}).then(()=>{e({message:"Recorded!",severity:"success",show:!0}),i({...s_,[ur.datetime]:xt().unix()})});return}t.expenditure.add({...n,category:g,[ur.transactionType]:p}).then(()=>{e({message:"Recorded!",severity:"success",show:!0}),i({...s_,[ur.datetime]:xt().unix()})})}const f=[{endIcon:de.createElement(kct,null),type:pn.SALARY,color:"info"},{endIcon:de.createElement(Act,null),type:pn.DEBIT,color:"success"},{endIcon:de.createElement(Pct,null),type:pn.RECURRING,color:"warning"},{endIcon:de.createElement($ct,null),type:pn.CREDIT,color:"error"}],h={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"75vw",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},d=()=>{const p=m=>{let g=parseInt(m);return g===1?"st":g===2?"nd":g===3?"rd":"th"};return de.createElement(Qae,{open:o,onClose:()=>a(!1)},de.createElement(Ua,{sx:h},de.createElement(Zae,null,de.createElement(Jae,null,"Type of reccurence"),de.createElement(oae,{value:s,onChange:m=>l(m.target.value)},de.createElement(v5,{value:"weekly",control:de.createElement(y5,null),label:"Weekly"}),de.createElement(v5,{value:"monthly",control:de.createElement(y5,null),label:"Monthly"}),de.createElement(v5,{value:"yearly",control:de.createElement(y5,null),label:"Yearly"}))),de.createElement(ms,null,"This will recur ",s,s==="yearly"?` on ${xt.unix(n.datetime).format("D MMMM")}`:s==="monthly"?` on the ${xt.unix(n.datetime).format("D")}${p(xt.unix(n.datetime).format("D"))} day`:` every ${xt.unix(n.datetime).format("dddd")}`),de.createElement(j2,{onClick:()=>{c(pn.RECURRING),a(!1)}},"confirm")))};return de.createElement("div",null,de.createElement(Nt,{container:!0,justifyContent:"center",alignItems:"center",direction:"column",spacing:2},de.createElement(Nt,{item:!0},de.createElement(aN,{size:"small",clearOnEscape:!0,freeSolo:!0,autoSelect:!0,autoComplete:!0,options:(r==null?void 0:r.creditCards)||[],sx:{width:"80vw"},value:n[ur.creditCard],onChange:(p,m)=>u(ur.creditCard,m),renderInput:p=>de.createElement(Lm,{...p,label:"Source"})})),de.createElement(Nt,{item:!0},de.createElement(aN,{size:"small",clearOnEscape:!0,freeSolo:!0,autoSelect:!0,autoComplete:!0,multiple:!0,options:(r==null?void 0:r.categories)||[],sx:{width:"80vw"},value:n[ur.category],onChange:(p,m)=>u(ur.category,m),renderInput:p=>de.createElement(Lm,{...p,label:"Categories"})})),de.createElement(Nt,{item:!0},de.createElement(Lm,{size:"small",label:"Name",sx:{width:"80vw"},value:n[ur.name],onChange:p=>u(ur.name,p.target.value),inputProps:{autoCapitalize:"none"},InputProps:{endAdornment:de.createElement(Kae,{position:"end"},n.name!==""&&de.createElement(_g,{size:"small",onClick:()=>u(ur.name,"")},de.createElement(Mct,null)))}})),de.createElement(Nt,{item:!0},de.createElement(qae,{size:"small",style:{width:"80vw"},value:n[ur.amount],onChange:p=>u(ur.amount,Number(p.target.value.replace(/[^0-9.]/g,""))),prefix:"$",thousandSeparator:!0,customInput:Lm,label:"Amount",inputProps:{inputMode:"decimal"}})),de.createElement(Nt,{item:!0},de.createElement(Bz,{dateAdapter:Uz,adapterLocale:"en-sg"},de.createElement(Vz,{label:"Date",value:xt.unix(n[ur.datetime]),onChange:p=>u(ur.datetime,p===null?null:p.unix()),sx:{width:"80vw"}}))),de.createElement(Nt,{item:!0},de.createElement(Nt,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:2},f.map((p,m)=>de.createElement(Nt,{item:!0,xs:6,key:m},de.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},de.createElement(j2,{variant:"contained",color:p.color,endIcon:p.endIcon,size:"small",onClick:()=>c(p.type)},p.type))))))),de.createElement(d,null))},Bct=({title:t})=>de.createElement(ms,{variant:"body1"},t),mf=({title:t,value:e,color:r})=>de.createElement("div",null,de.createElement(Bct,{title:t}),de.createElement(ms,{variant:"h6",style:{color:r}},e)),Uct=async(t,e)=>{var c;const r=await Mf.expenditure.toArray(),n=r.filter(f=>f.datetime>=t&&f.datetime<=e);let i=n.reduce((f,h)=>f+Number(h.amount)*($z.includes(h.txn_type)?1:-1),0),o=on.exports.sortBy(n.filter(f=>Vf.includes(f.txn_type)),["datetime"]).reduce((f,h)=>f+h.amount,0);const a=Vv(await Mf.recurring.where("start").belowOrEqual(xt().unix()).toArray(),t,xt().unix()).filter(f=>f.datetime>=t&&f.datetime<e).reduce((f,h)=>f+h.amount,0),s=((c=await Mf.expenditure.where({txn_type:pn.SALARY}).first())==null?void 0:c.datetime)||0,l=Vv(await Mf.recurring.where("start").belowOrEqual(xt().unix()).toArray(),s,xt().unix()).reduce((f,h)=>f+h.amount,0);return{total:r.reduce((f,{amount:h,txn_type:d})=>f+([pn.CREDIT,pn.RECURRING].includes(d)?Number(h)*-1:Number(h)),0)-l,spending:o+a,saving:i-a}},Vct=Pz("showBigNumbers",!1);function l_(t,e,r){return t.push({category:e.category,name:e.name,amount:e.amount,txn_type:pn.RECURRING,datetime:r.unix(),recurringId:e.id,credit_card:e.credit_card}),t}function Vv(t,e,r){return t.reduce((n,i)=>{if(r<i.start)return n;let o=i.cron.split(" ")[0],a=i.cron.split(" ")[1],s=[],l=xt.unix(e);switch(o){case"weekly":let u=parseInt(a),c=l.day(),f=Math.abs(c-u);for(c<u?l=l.add(f,"d"):l=l.add(7-f,"d");l.unix()<r;)s=l_(s,i,l),l=l.add(1,"w");break;case"monthly":let h=parseInt(a),d=Math.abs(parseInt(a)-xt.unix(e).date());for(xt.unix(e).date()<xt.unix(i.start).date()?l=l.add(d,"d"):l=xt.unix(e).set("D",h);l.unix()<r;)s=l_(s,i,l),l=l.add(1,"M");break;case"yearly":let p=on.exports.max([xt.unix(e).year(),xt.unix(r).year()]),m=xt(a,"DD-MM").set("year",p||xt().year());m.unix()<r&&m.unix()>=e&&(l=xt.unix(i.start),s=l_(s,i,l));break}return[...n,...s]},[])}const jct=()=>{const{startDate:t,endDate:e}=rM(),[r,n]=Cs(Vct),i=aae(),o=sae(),a=Xi.exports.useLiveQuery(()=>Uct(t,e),[t,e]);return de.createElement("div",null,de.createElement(Nt,{container:!0,justifyContent:"center",alignItems:"center",direction:"row",style:{textAlign:"center"},spacing:1,onClick:()=>n(!r)},de.createElement(Nt,{item:!0,xs:6,md:3},de.createElement(mf,{value:r?`$${a==null?void 0:a.total.toLocaleString()}`:"*****",title:"Total funds",color:r?Number(a==null?void 0:a.total.toLocaleString())<0?"red":"green":void 0})),de.createElement(Nt,{item:!0,xs:6,md:3},de.createElement(mf,{value:xt.unix(t).format("DD MMM"),title:"Pay day",color:"orange"})),de.createElement(Nt,{item:!0,xs:6,md:3},de.createElement(mf,{title:"Monthly Spend",value:r?`$${a==null?void 0:a.spending.toLocaleString()}`||"$0":"*****"})),de.createElement(Nt,{item:!0,xs:6,md:3},de.createElement(mf,{title:"Monthly Save",value:r?`$${a==null?void 0:a.saving.toLocaleString()}`||"$0":"*****"})),de.createElement(Nt,{item:!0,xs:6,md:3},de.createElement(mf,{title:"Total Portfolio",value:r?`$${on.exports.round(o,2).toLocaleString()}`||"$0":"*****"})),de.createElement(Nt,{item:!0,xs:6,md:3},de.createElement(mf,{title:"Total Portfolio (%)",value:r?`${i}%`||"0%":"*****",color:r?i<0?"red":"green":void 0}))))},fre=kz(0);function rM(){var s,l,u,c,f;const t=n1(h=>h.database),[e]=Cs(fre),r=(s=Xi.exports.useLiveQuery(async()=>{var h;return(h=await t.expenditure.orderBy("datetime").last())==null?void 0:h.datetime}))!=null?s:0,n=(l=Xi.exports.useLiveQuery(async()=>(await t.expenditure.where({txn_type:pn.SALARY})).toArray()))!=null?l:[],i=n.length||0,o=(c=(u=n[i-e-1])==null?void 0:u.datetime)!=null?c:r,a=e===0?xt().unix():(f=n[i-e])==null?void 0:f.datetime;return{minDate:r,totalMonths:i,paydays:n,startDate:o,endDate:a}}const Wct=()=>{const t=nae();return J.exports.useEffect(()=>{iae(t)}),de.createElement("div",null,de.createElement(Nt,{container:!0,justifyContent:"center",alignItems:"center",direction:"column",spacing:2},de.createElement(Nt,{item:!0},de.createElement(jct,null)),de.createElement(Nt,{item:!0},de.createElement(Hct,null))))};let nM=X1();const ht=t=>q1(t,nM);let iM=X1();ht.write=t=>q1(t,iM);let yR=X1();ht.onStart=t=>q1(t,yR);let oM=X1();ht.onFrame=t=>q1(t,oM);let aM=X1();ht.onFinish=t=>q1(t,aM);let ah=[];ht.setTimeout=(t,e)=>{let r=ht.now()+e,n=()=>{let o=ah.findIndex(a=>a.cancel==n);~o&&ah.splice(o,1),Xs-=~o?1:0},i={time:r,handler:t,cancel:n};return ah.splice(hre(r),0,i),Xs+=1,dre(),i};let hre=t=>~(~ah.findIndex(e=>e.time>t)||~ah.length);ht.cancel=t=>{yR.delete(t),oM.delete(t),nM.delete(t),iM.delete(t),aM.delete(t)};ht.sync=t=>{t4=!0,ht.batchedUpdates(t),t4=!1};ht.throttle=t=>{let e;function r(){try{t(...e)}finally{e=null}}function n(...i){e=i,ht.onStart(r)}return n.handler=t,n.cancel=()=>{yR.delete(r),e=null},n};let sM=typeof window<"u"?window.requestAnimationFrame:()=>{};ht.use=t=>sM=t;ht.now=typeof performance<"u"?()=>performance.now():Date.now;ht.batchedUpdates=t=>t();ht.catch=console.error;ht.frameLoop="always";ht.advance=()=>{ht.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):mre()};let qs=-1,Xs=0,t4=!1;function q1(t,e){t4?(e.delete(t),t(0)):(e.add(t),dre())}function dre(){qs<0&&(qs=0,ht.frameLoop!=="demand"&&sM(pre))}function zct(){qs=-1}function pre(){~qs&&(sM(pre),ht.batchedUpdates(mre))}function mre(){let t=qs;qs=ht.now();let e=hre(qs);e&&(gre(ah.splice(0,e),r=>r.handler()),Xs-=e),yR.flush(),nM.flush(t?Math.min(64,qs-t):16.667),oM.flush(),iM.flush(),aM.flush(),Xs||zct()}function X1(){let t=new Set,e=t;return{add(r){Xs+=e==t&&!t.has(r)?1:0,t.add(r)},delete(r){return Xs-=e==t&&t.has(r)?1:0,t.delete(r)},flush(r){e.size&&(t=new Set,Xs-=e.size,gre(e,n=>n(r)&&t.add(n)),Xs+=t.size,e=t)}}}function gre(t,e){t.forEach(r=>{try{e(r)}catch(n){ht.catch(n)}})}function r4(){}const Gct=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,configurable:!0}),Ee={arr:Array.isArray,obj:t=>!!t&&t.constructor.name==="Object",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",und:t=>t===void 0};function Da(t,e){if(Ee.arr(t)){if(!Ee.arr(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return t===e}const lt=(t,e)=>t.forEach(e);function ha(t,e,r){if(Ee.arr(t)){for(let n=0;n<t.length;n++)e.call(r,t[n],`${n}`);return}for(const n in t)t.hasOwnProperty(n)&&e.call(r,t[n],n)}const Xn=t=>Ee.und(t)?[]:Ee.arr(t)?t:[t];function bg(t,e){if(t.size){const r=Array.from(t);t.clear(),lt(r,e)}}const qm=(t,...e)=>bg(t,r=>r(...e)),yre=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent);let lM,vre,dl=null,bre=!1,uM=r4;const Yct=t=>{t.to&&(vre=t.to),t.now&&(ht.now=t.now),t.colors!==void 0&&(dl=t.colors),t.skipAnimation!=null&&(bre=t.skipAnimation),t.createStringInterpolator&&(lM=t.createStringInterpolator),t.requestAnimationFrame&&ht.use(t.requestAnimationFrame),t.batchedUpdates&&(ht.batchedUpdates=t.batchedUpdates),t.willAdvance&&(uM=t.willAdvance),t.frameLoop&&(ht.frameLoop=t.frameLoop)};var da=Object.freeze({__proto__:null,get createStringInterpolator(){return lM},get to(){return vre},get colors(){return dl},get skipAnimation(){return bre},get willAdvance(){return uM},assign:Yct});const wg=new Set;let Yi=[],u_=[],TS=0;const vR={get idle(){return!wg.size&&!Yi.length},start(t){TS>t.priority?(wg.add(t),ht.onStart(Kct)):(wre(t),ht(n4))},advance:n4,sort(t){if(TS)ht.onFrame(()=>vR.sort(t));else{const e=Yi.indexOf(t);~e&&(Yi.splice(e,1),Sre(t))}},clear(){Yi=[],wg.clear()}};function Kct(){wg.forEach(wre),wg.clear(),ht(n4)}function wre(t){Yi.includes(t)||Sre(t)}function Sre(t){Yi.splice(qct(Yi,e=>e.priority>t.priority),0,t)}function n4(t){const e=u_;for(let r=0;r<Yi.length;r++){const n=Yi[r];TS=n.priority,n.idle||(uM(n),n.advance(t),n.idle||e.push(n))}return TS=0,u_=Yi,u_.length=0,Yi=e,Yi.length>0}function qct(t,e){const r=t.findIndex(e);return r<0?t.length:r}const Xct={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},Ao="[-+]?\\d*\\.?\\d+",OS=Ao+"%";function bR(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}const Qct=new RegExp("rgb"+bR(Ao,Ao,Ao)),Zct=new RegExp("rgba"+bR(Ao,Ao,Ao,Ao)),Jct=new RegExp("hsl"+bR(Ao,OS,OS)),eft=new RegExp("hsla"+bR(Ao,OS,OS,Ao)),tft=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,rft=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,nft=/^#([0-9a-fA-F]{6})$/,ift=/^#([0-9a-fA-F]{8})$/;function oft(t){let e;return typeof t=="number"?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=nft.exec(t))?parseInt(e[1]+"ff",16)>>>0:dl&&dl[t]!==void 0?dl[t]:(e=Qct.exec(t))?(gf(e[1])<<24|gf(e[2])<<16|gf(e[3])<<8|255)>>>0:(e=Zct.exec(t))?(gf(e[1])<<24|gf(e[2])<<16|gf(e[3])<<8|Nj(e[4]))>>>0:(e=tft.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=ift.exec(t))?parseInt(e[1],16)>>>0:(e=rft.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=Jct.exec(t))?(Ij(Mj(e[1]),Eb(e[2]),Eb(e[3]))|255)>>>0:(e=eft.exec(t))?(Ij(Mj(e[1]),Eb(e[2]),Eb(e[3]))|Nj(e[4]))>>>0:null}function c_(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function Ij(t,e,r){const n=r<.5?r*(1+e):r+e-r*e,i=2*r-n,o=c_(i,n,t+1/3),a=c_(i,n,t),s=c_(i,n,t-1/3);return Math.round(o*255)<<24|Math.round(a*255)<<16|Math.round(s*255)<<8}function gf(t){const e=parseInt(t,10);return e<0?0:e>255?255:e}function Mj(t){return(parseFloat(t)%360+360)%360/360}function Nj(t){const e=parseFloat(t);return e<0?0:e>1?255:Math.round(e*255)}function Eb(t){const e=parseFloat(t);return e<0?0:e>100?1:e/100}function Pj(t){let e=oft(t);if(e===null)return t;e=e||0;let r=(e&4278190080)>>>24,n=(e&16711680)>>>16,i=(e&65280)>>>8,o=(e&255)/255;return`rgba(${r}, ${n}, ${i}, ${o})`}const jv=(t,e,r)=>{if(Ee.fun(t))return t;if(Ee.arr(t))return jv({range:t,output:e,extrapolate:r});if(Ee.str(t.output[0]))return lM(t);const n=t,i=n.output,o=n.range||[0,1],a=n.extrapolateLeft||n.extrapolate||"extend",s=n.extrapolateRight||n.extrapolate||"extend",l=n.easing||(u=>u);return u=>{const c=sft(u,o);return aft(u,o[c],o[c+1],i[c],i[c+1],l,a,s,n.map)}};function aft(t,e,r,n,i,o,a,s,l){let u=l?l(t):t;if(u<e){if(a==="identity")return u;a==="clamp"&&(u=e)}if(u>r){if(s==="identity")return u;s==="clamp"&&(u=r)}return n===i?n:e===r?t<=e?n:i:(e===-1/0?u=-u:r===1/0?u=u-e:u=(u-e)/(r-e),u=o(u),n===-1/0?u=-u:i===1/0?u=u+n:u=u*(i-n)+n,u)}function sft(t,e){for(var r=1;r<e.length-1&&!(e[r]>=t);++r);return r-1}function i4(){return i4=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},i4.apply(this,arguments)}const wp=Symbol.for("FluidValue.get"),lc=Symbol.for("FluidValue.observers"),Gi=t=>Boolean(t&&t[wp]),ai=t=>t&&t[wp]?t[wp]():t,kj=t=>t[lc]||null;function lft(t,e){t.eventObserved?t.eventObserved(e):t(e)}function Wv(t,e){let r=t[lc];r&&r.forEach(n=>{lft(n,e)})}class Rre{constructor(e){if(this[wp]=void 0,this[lc]=void 0,!e&&!(e=this.get))throw Error("Unknown getter");uft(this,e)}}const uft=(t,e)=>Ere(t,wp,e);function Kp(t,e){if(t[wp]){let r=t[lc];r||Ere(t,lc,r=new Set),r.has(e)||(r.add(e),t.observerAdded&&t.observerAdded(r.size,e))}return e}function zv(t,e){let r=t[lc];if(r&&r.has(e)){const n=r.size-1;n?r.delete(e):t[lc]=null,t.observerRemoved&&t.observerRemoved(n,e)}}const Ere=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,configurable:!0}),L2=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,cft=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,$j=new RegExp(`(${L2.source})(%|[a-z]+)`,"i"),fft=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,wR=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,Cre=t=>{const[e,r]=hft(t);if(!e||yre())return t;const n=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(n)return n.trim();if(r&&r.startsWith("--")){const i=window.getComputedStyle(document.documentElement).getPropertyValue(r);return i||t}else{if(r&&wR.test(r))return Cre(r);if(r)return r}return t},hft=t=>{const e=wR.exec(t);if(!e)return[,];const[,r,n]=e;return[r,n]};let f_;const dft=(t,e,r,n,i)=>`rgba(${Math.round(e)}, ${Math.round(r)}, ${Math.round(n)}, ${i})`,_re=t=>{f_||(f_=dl?new RegExp(`(${Object.keys(dl).join("|")})(?!\\w)`,"g"):/^\b$/);const e=t.output.map(o=>ai(o).replace(wR,Cre).replace(cft,Pj).replace(f_,Pj)),r=e.map(o=>o.match(L2).map(Number)),i=r[0].map((o,a)=>r.map(s=>{if(!(a in s))throw Error('The arity of each "output" value must be equal');return s[a]})).map(o=>jv(i4({},t,{output:o})));return o=>{var a;const s=!$j.test(e[0])&&((a=e.find(u=>$j.test(u)))==null?void 0:a.replace(L2,""));let l=0;return e[0].replace(L2,()=>`${i[l++](o)}${s||""}`).replace(fft,dft)}},cM="react-spring: ",Tre=t=>{const e=t;let r=!1;if(typeof e!="function")throw new TypeError(`${cM}once requires a function parameter`);return(...n)=>{r||(e(...n),r=!0)}},pft=Tre(console.warn);function mft(){pft(`${cM}The "interpolate" function is deprecated in v9 (use "to" instead)`)}const gft=Tre(console.warn);function yft(){gft(`${cM}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function SR(t){return Ee.str(t)&&(t[0]=="#"||/\d/.test(t)||!yre()&&wR.test(t)||t in(dl||{}))}const Mu=typeof window<"u"&&window.document&&window.document.createElement?J.exports.useLayoutEffect:J.exports.useEffect,vft=()=>{const t=J.exports.useRef(!1);return Mu(()=>(t.current=!0,()=>{t.current=!1}),[]),t};function fM(){const t=J.exports.useState()[1],e=vft();return()=>{e.current&&t(Math.random())}}function bft(t,e){const[r]=J.exports.useState(()=>({inputs:e,result:t()})),n=J.exports.useRef(),i=n.current;let o=i;return o?Boolean(e&&o.inputs&&wft(e,o.inputs))||(o={inputs:e,result:t()}):o=r,J.exports.useEffect(()=>{n.current=o,i==r&&(r.inputs=r.result=void 0)},[o]),o.result}function wft(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}const hM=t=>J.exports.useEffect(t,Sft),Sft=[];function o4(t){const e=J.exports.useRef();return J.exports.useEffect(()=>{e.current=t}),e.current}const Gv=Symbol.for("Animated:node"),Rft=t=>!!t&&t[Gv]===t,Zo=t=>t&&t[Gv],dM=(t,e)=>Gct(t,Gv,e),RR=t=>t&&t[Gv]&&t[Gv].getPayload();class Ore{constructor(){this.payload=void 0,dM(this,this)}getPayload(){return this.payload||[]}}class qp extends Ore{constructor(e){super(),this.done=!0,this.elapsedTime=void 0,this.lastPosition=void 0,this.lastVelocity=void 0,this.v0=void 0,this.durationProgress=0,this._value=e,Ee.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new qp(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,r){return Ee.num(e)&&(this.lastPosition=e,r&&(e=Math.round(e/r)*r,this.done&&(this.lastPosition=e))),this._value===e?!1:(this._value=e,!0)}reset(){const{done:e}=this;this.done=!1,Ee.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}}class Sp extends qp{constructor(e){super(0),this._string=null,this._toString=void 0,this._toString=jv({output:[e,e]})}static create(e){return new Sp(e)}getValue(){let e=this._string;return e==null?this._string=this._toString(this._value):e}setValue(e){if(Ee.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else if(super.setValue(e))this._string=null;else return!1;return!0}reset(e){e&&(this._toString=jv({output:[this.getValue(),e]})),this._value=0,super.reset()}}const AS={dependencies:null};class ER extends Ore{constructor(e){super(),this.source=e,this.setValue(e)}getValue(e){const r={};return ha(this.source,(n,i)=>{Rft(n)?r[i]=n.getValue(e):Gi(n)?r[i]=ai(n):e||(r[i]=n)}),r}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&lt(this.payload,e=>e.reset())}_makePayload(e){if(e){const r=new Set;return ha(e,this._addToPayload,r),Array.from(r)}}_addToPayload(e){AS.dependencies&&Gi(e)&&AS.dependencies.add(e);const r=RR(e);r&&lt(r,n=>this.add(n))}}class pM extends ER{constructor(e){super(e)}static create(e){return new pM(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){const r=this.getPayload();return e.length==r.length?r.map((n,i)=>n.setValue(e[i])).some(Boolean):(super.setValue(e.map(Eft)),!0)}}function Eft(t){return(SR(t)?Sp:qp).create(t)}function a4(t){const e=Zo(t);return e?e.constructor:Ee.arr(t)?pM:SR(t)?Sp:qp}function xS(){return xS=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},xS.apply(this,arguments)}const Lj=(t,e)=>{const r=!Ee.fun(t)||t.prototype&&t.prototype.isReactComponent;return J.exports.forwardRef((n,i)=>{const o=J.exports.useRef(null),a=r&&J.exports.useCallback(p=>{o.current=Tft(i,p)},[i]),[s,l]=_ft(n,e),u=fM(),c=()=>{const p=o.current;if(r&&!p)return;(p?e.applyAnimatedValues(p,s.getValue(!0)):!1)===!1&&u()},f=new Cft(c,l),h=J.exports.useRef();Mu(()=>(h.current=f,lt(l,p=>Kp(p,f)),()=>{h.current&&(lt(h.current.deps,p=>zv(p,h.current)),ht.cancel(h.current.update))})),J.exports.useEffect(c,[]),hM(()=>()=>{const p=h.current;lt(p.deps,m=>zv(m,p))});const d=e.getComponentProps(s.getValue());return J.exports.createElement(t,xS({},d,{ref:a}))})};class Cft{constructor(e,r){this.update=e,this.deps=r}eventObserved(e){e.type=="change"&&ht.write(this.update)}}function _ft(t,e){const r=new Set;return AS.dependencies=r,t.style&&(t=xS({},t,{style:e.createAnimatedStyle(t.style)})),t=new ER(t),AS.dependencies=null,[t,r]}function Tft(t,e){return t&&(Ee.fun(t)?t(e):t.current=e),e}const Dj=Symbol.for("AnimatedComponent"),Oft=(t,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:r=i=>new ER(i),getComponentProps:n=i=>i}={})=>{const i={applyAnimatedValues:e,createAnimatedStyle:r,getComponentProps:n},o=a=>{const s=Fj(a)||"Anonymous";return Ee.str(a)?a=o[a]||(o[a]=Lj(a,i)):a=a[Dj]||(a[Dj]=Lj(a,i)),a.displayName=`Animated(${s})`,a};return ha(t,(a,s)=>{Ee.arr(t)&&(s=Fj(a)),o[s]=o(a)}),{animated:o}},Fj=t=>Ee.str(t)?t:t&&Ee.str(t.displayName)?t.displayName:Ee.fun(t)&&t.name||null;function Pr(){return Pr=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Pr.apply(this,arguments)}function si(t,...e){return Ee.fun(t)?t(...e):t}const Sg=(t,e)=>t===!0||!!(e&&t&&(Ee.fun(t)?t(e):Xn(t).includes(e))),Are=(t,e)=>Ee.obj(t)?e&&t[e]:t,xre=(t,e)=>t.default===!0?t[e]:t.default?t.default[e]:void 0,Aft=t=>t,CR=(t,e=Aft)=>{let r=xft;t.default&&t.default!==!0&&(t=t.default,r=Object.keys(t));const n={};for(const i of r){const o=e(t[i],i);Ee.und(o)||(n[i]=o)}return n},xft=["config","onProps","onStart","onChange","onPause","onResume","onRest"],Ift={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function Mft(t){const e={};let r=0;if(ha(t,(n,i)=>{Ift[i]||(e[i]=n,r++)}),r)return e}function mM(t){const e=Mft(t);if(e){const r={to:e};return ha(t,(n,i)=>i in e||(r[i]=n)),r}return Pr({},t)}function Yv(t){return t=ai(t),Ee.arr(t)?t.map(Yv):SR(t)?da.createStringInterpolator({range:[0,1],output:[t,t]})(1):t}function Ire(t){for(const e in t)return!0;return!1}function s4(t){return Ee.fun(t)||Ee.arr(t)&&Ee.obj(t[0])}function l4(t,e){var r;(r=t.ref)==null||r.delete(t),e==null||e.delete(t)}function Mre(t,e){if(e&&t.ref!==e){var r;(r=t.ref)==null||r.delete(t),e.add(t),t.ref=e}}const gM={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},IS=1.70158,Cb=IS*1.525,Hj=IS+1,Bj=2*Math.PI/3,Uj=2*Math.PI/4.5,_b=t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,Nft={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>1-(1-t)*(1-t),easeInOutQuad:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeInCubic:t=>t*t*t,easeOutCubic:t=>1-Math.pow(1-t,3),easeInOutCubic:t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1-Math.pow(1-t,4),easeInOutQuart:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1-Math.pow(1-t,5),easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t===0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t===1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeInCirc:t=>1-Math.sqrt(1-Math.pow(t,2)),easeOutCirc:t=>Math.sqrt(1-Math.pow(t-1,2)),easeInOutCirc:t=>t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2,easeInBack:t=>Hj*t*t*t-IS*t*t,easeOutBack:t=>1+Hj*Math.pow(t-1,3)+IS*Math.pow(t-1,2),easeInOutBack:t=>t<.5?Math.pow(2*t,2)*((Cb+1)*2*t-Cb)/2:(Math.pow(2*t-2,2)*((Cb+1)*(t*2-2)+Cb)+2)/2,easeInElastic:t=>t===0?0:t===1?1:-Math.pow(2,10*t-10)*Math.sin((t*10-10.75)*Bj),easeOutElastic:t=>t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t*10-.75)*Bj)+1,easeInOutElastic:t=>t===0?0:t===1?1:t<.5?-(Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*Uj))/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*Uj)/2+1,easeInBounce:t=>1-_b(1-t),easeOutBounce:_b,easeInOutBounce:t=>t<.5?(1-_b(1-2*t))/2:(1+_b(2*t-1))/2},u4=Pr({},gM.default,{mass:1,damping:1,easing:Nft.linear,clamp:!1});class Pft{constructor(){this.tension=void 0,this.friction=void 0,this.frequency=void 0,this.damping=void 0,this.mass=void 0,this.velocity=0,this.restVelocity=void 0,this.precision=void 0,this.progress=void 0,this.duration=void 0,this.easing=void 0,this.clamp=void 0,this.bounce=void 0,this.decay=void 0,this.round=void 0,Object.assign(this,u4)}}function kft(t,e,r){r&&(r=Pr({},r),Vj(r,e),e=Pr({},r,e)),Vj(t,e),Object.assign(t,e);for(const a in u4)t[a]==null&&(t[a]=u4[a]);let{mass:n,frequency:i,damping:o}=t;return Ee.und(i)||(i<.01&&(i=.01),o<0&&(o=0),t.tension=Math.pow(2*Math.PI/i,2)*n,t.friction=4*Math.PI*o*n/i),t}function Vj(t,e){if(!Ee.und(e.decay))t.duration=void 0;else{const r=!Ee.und(e.tension)||!Ee.und(e.friction);(r||!Ee.und(e.frequency)||!Ee.und(e.damping)||!Ee.und(e.mass))&&(t.duration=void 0,t.decay=void 0),r&&(t.frequency=void 0)}}const jj=[];class $ft{constructor(){this.changed=!1,this.values=jj,this.toValues=null,this.fromValues=jj,this.to=void 0,this.from=void 0,this.config=new Pft,this.immediate=!1}}function Nre(t,{key:e,props:r,defaultProps:n,state:i,actions:o}){return new Promise((a,s)=>{var l;let u,c,f=Sg((l=r.cancel)!=null?l:n==null?void 0:n.cancel,e);if(f)p();else{Ee.und(r.pause)||(i.paused=Sg(r.pause,e));let m=n==null?void 0:n.pause;m!==!0&&(m=i.paused||Sg(m,e)),u=si(r.delay||0,e),m?(i.resumeQueue.add(d),o.pause()):(o.resume(),d())}function h(){i.resumeQueue.add(d),i.timeouts.delete(c),c.cancel(),u=c.time-ht.now()}function d(){u>0&&!da.skipAnimation?(i.delayed=!0,c=ht.setTimeout(p,u),i.pauseQueue.add(h),i.timeouts.add(c)):p()}function p(){i.delayed&&(i.delayed=!1),i.pauseQueue.delete(h),i.timeouts.delete(c),t<=(i.cancelId||0)&&(f=!0);try{o.start(Pr({},r,{callId:t,cancel:f}),a)}catch(m){s(m)}}})}const yM=(t,e)=>e.length==1?e[0]:e.some(r=>r.cancelled)?sh(t.get()):e.every(r=>r.noop)?Pre(t.get()):_o(t.get(),e.every(r=>r.finished)),Pre=t=>({value:t,noop:!0,finished:!0,cancelled:!1}),_o=(t,e,r=!1)=>({value:t,finished:e,cancelled:r}),sh=t=>({value:t,cancelled:!0,finished:!1});function kre(t,e,r,n){const{callId:i,parentId:o,onRest:a}=e,{asyncTo:s,promise:l}=r;return!o&&t===s&&!e.reset?l:r.promise=(async()=>{r.asyncId=i,r.asyncTo=t;const u=CR(e,(g,v)=>v==="onRest"?void 0:g);let c,f;const h=new Promise((g,v)=>(c=g,f=v)),d=g=>{const v=i<=(r.cancelId||0)&&sh(n)||i!==r.asyncId&&_o(n,!1);if(v)throw g.result=v,f(g),g},p=(g,v)=>{const S=new Wj,b=new zj;return(async()=>{if(da.skipAnimation)throw Kv(r),b.result=_o(n,!1),f(b),b;d(S);const E=Ee.obj(g)?Pr({},g):Pr({},v,{to:g});E.parentId=i,ha(u,(N,L)=>{Ee.und(E[L])&&(E[L]=N)});const T=await n.start(E);return d(S),r.paused&&await new Promise(N=>{r.resumeQueue.add(N)}),T})()};let m;if(da.skipAnimation)return Kv(r),_o(n,!1);try{let g;Ee.arr(t)?g=(async v=>{for(const S of v)await p(S)})(t):g=Promise.resolve(t(p,n.stop.bind(n))),await Promise.all([g.then(c),h]),m=_o(n.get(),!0,!1)}catch(g){if(g instanceof Wj)m=g.result;else if(g instanceof zj)m=g.result;else throw g}finally{i==r.asyncId&&(r.asyncId=o,r.asyncTo=o?s:void 0,r.promise=o?l:void 0)}return Ee.fun(a)&&ht.batchedUpdates(()=>{a(m,n,n.item)}),m})()}function Kv(t,e){bg(t.timeouts,r=>r.cancel()),t.pauseQueue.clear(),t.resumeQueue.clear(),t.asyncId=t.asyncTo=t.promise=void 0,e&&(t.cancelId=e)}class Wj extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise."),this.result=void 0}}class zj extends Error{constructor(){super("SkipAnimationSignal"),this.result=void 0}}const c4=t=>t instanceof vM;let Lft=1;class vM extends Rre{constructor(...e){super(...e),this.id=Lft++,this.key=void 0,this._priority=0}get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){const e=Zo(this);return e&&e.getValue()}to(...e){return da.to(this,e)}interpolate(...e){return mft(),da.to(this,e)}toJSON(){return this.get()}observerAdded(e){e==1&&this._attach()}observerRemoved(e){e==0&&this._detach()}_attach(){}_detach(){}_onChange(e,r=!1){Wv(this,{type:"change",parent:this,value:e,idle:r})}_onPriorityChange(e){this.idle||vR.sort(this),Wv(this,{type:"priority",parent:this,priority:e})}}const uc=Symbol.for("SpringPhase"),$re=1,f4=2,h4=4,h_=t=>(t[uc]&$re)>0,Fs=t=>(t[uc]&f4)>0,xm=t=>(t[uc]&h4)>0,Gj=(t,e)=>e?t[uc]|=f4|$re:t[uc]&=~f4,Yj=(t,e)=>e?t[uc]|=h4:t[uc]&=~h4;class Dft extends vM{constructor(e,r){if(super(),this.key=void 0,this.animation=new $ft,this.queue=void 0,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!Ee.und(e)||!Ee.und(r)){const n=Ee.obj(e)?Pr({},e):Pr({},r,{from:e});Ee.und(n.default)&&(n.default=!0),this.start(n)}}get idle(){return!(Fs(this)||this._state.asyncTo)||xm(this)}get goal(){return ai(this.animation.to)}get velocity(){const e=Zo(this);return e instanceof qp?e.lastVelocity||0:e.getPayload().map(r=>r.lastVelocity||0)}get hasAnimated(){return h_(this)}get isAnimating(){return Fs(this)}get isPaused(){return xm(this)}get isDelayed(){return this._state.delayed}advance(e){let r=!0,n=!1;const i=this.animation;let{config:o,toValues:a}=i;const s=RR(i.to);!s&&Gi(i.to)&&(a=Xn(ai(i.to))),i.values.forEach((c,f)=>{if(c.done)return;const h=c.constructor==Sp?1:s?s[f].lastPosition:a[f];let d=i.immediate,p=h;if(!d){if(p=c.lastPosition,o.tension<=0){c.done=!0;return}let m=c.elapsedTime+=e;const g=i.fromValues[f],v=c.v0!=null?c.v0:c.v0=Ee.arr(o.velocity)?o.velocity[f]:o.velocity;let S;if(Ee.und(o.duration))if(o.decay){const b=o.decay===!0?.998:o.decay,E=Math.exp(-(1-b)*m);p=g+v/(1-b)*(1-E),d=Math.abs(c.lastPosition-p)<.1,S=v*E}else{S=c.lastVelocity==null?v:c.lastVelocity;const b=o.precision||(g==h?.005:Math.min(1,Math.abs(h-g)*.001)),E=o.restVelocity||b/10,T=o.clamp?0:o.bounce,N=!Ee.und(T),L=g==h?c.v0>0:g<h;let V,B=!1;const k=1,M=Math.ceil(e/k);for(let G=0;G<M&&(V=Math.abs(S)>E,!(!V&&(d=Math.abs(h-p)<=b,d)));++G){N&&(B=p==h||p>h==L,B&&(S=-S*T,p=h));const j=-o.tension*1e-6*(p-h),q=-o.friction*.001*S,te=(j+q)/o.mass;S=S+te*k,p=p+S*k}}else{let b=1;o.duration>0&&(this._memoizedDuration!==o.duration&&(this._memoizedDuration=o.duration,c.durationProgress>0&&(c.elapsedTime=o.duration*c.durationProgress,m=c.elapsedTime+=e)),b=(o.progress||0)+m/this._memoizedDuration,b=b>1?1:b<0?0:b,c.durationProgress=b),p=g+o.easing(b)*(h-g),S=(p-c.lastPosition)/e,d=b==1}c.lastVelocity=S,Number.isNaN(p)&&(console.warn("Got NaN while animating:",this),d=!0)}s&&!s[f].done&&(d=!1),d?c.done=!0:r=!1,c.setValue(p,o.round)&&(n=!0)});const l=Zo(this),u=l.getValue();if(r){const c=ai(i.to);(u!==c||n)&&!o.decay?(l.setValue(c),this._onChange(c)):n&&o.decay&&this._onChange(u),this._stop()}else n&&this._onChange(u)}set(e){return ht.batchedUpdates(()=>{this._stop(),this._focus(e),this._set(e)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(Fs(this)){const{to:e,config:r}=this.animation;ht.batchedUpdates(()=>{this._onStart(),r.decay||this._set(e,!1),this._stop()})}return this}update(e){return(this.queue||(this.queue=[])).push(e),this}start(e,r){let n;return Ee.und(e)?(n=this.queue||[],this.queue=[]):n=[Ee.obj(e)?e:Pr({},r,{to:e})],Promise.all(n.map(i=>this._update(i))).then(i=>yM(this,i))}stop(e){const{to:r}=this.animation;return this._focus(this.get()),Kv(this._state,e&&this._lastCallId),ht.batchedUpdates(()=>this._stop(r,e)),this}reset(){this._update({reset:!0})}eventObserved(e){e.type=="change"?this._start():e.type=="priority"&&(this.priority=e.priority+1)}_prepareNode(e){const r=this.key||"";let{to:n,from:i}=e;n=Ee.obj(n)?n[r]:n,(n==null||s4(n))&&(n=void 0),i=Ee.obj(i)?i[r]:i,i==null&&(i=void 0);const o={to:n,from:i};return h_(this)||(e.reverse&&([n,i]=[i,n]),i=ai(i),Ee.und(i)?Zo(this)||this._set(n):this._set(i)),o}_update(e,r){let n=Pr({},e);const{key:i,defaultProps:o}=this;n.default&&Object.assign(o,CR(n,(l,u)=>/^on/.test(u)?Are(l,i):l)),qj(this,n,"onProps"),Mm(this,"onProps",n,this);const a=this._prepareNode(n);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const s=this._state;return Nre(++this._lastCallId,{key:i,props:n,defaultProps:o,state:s,actions:{pause:()=>{xm(this)||(Yj(this,!0),qm(s.pauseQueue),Mm(this,"onPause",_o(this,Im(this,this.animation.to)),this))},resume:()=>{xm(this)&&(Yj(this,!1),Fs(this)&&this._resume(),qm(s.resumeQueue),Mm(this,"onResume",_o(this,Im(this,this.animation.to)),this))},start:this._merge.bind(this,a)}}).then(l=>{if(n.loop&&l.finished&&!(r&&l.noop)){const u=Lre(n);if(u)return this._update(u,!0)}return l})}_merge(e,r,n){if(r.cancel)return this.stop(!0),n(sh(this));const i=!Ee.und(e.to),o=!Ee.und(e.from);if(i||o)if(r.callId>this._lastToId)this._lastToId=r.callId;else return n(sh(this));const{key:a,defaultProps:s,animation:l}=this,{to:u,from:c}=l;let{to:f=u,from:h=c}=e;o&&!i&&(!r.default||Ee.und(f))&&(f=h),r.reverse&&([f,h]=[h,f]);const d=!Da(h,c);d&&(l.from=h),h=ai(h);const p=!Da(f,u);p&&this._focus(f);const m=s4(r.to),{config:g}=l,{decay:v,velocity:S}=g;(i||o)&&(g.velocity=0),r.config&&!m&&kft(g,si(r.config,a),r.config!==s.config?si(s.config,a):void 0);let b=Zo(this);if(!b||Ee.und(f))return n(_o(this,!0));const E=Ee.und(r.reset)?o&&!r.default:!Ee.und(h)&&Sg(r.reset,a),T=E?h:this.get(),N=Yv(f),L=Ee.num(N)||Ee.arr(N)||SR(N),V=!m&&(!L||Sg(s.immediate||r.immediate,a));if(p){const G=a4(f);if(G!==b.constructor)if(V)b=this._set(N);else throw Error(`Cannot animate between ${b.constructor.name} and ${G.name}, as the "to" prop suggests`)}const B=b.constructor;let k=Gi(f),M=!1;if(!k){const G=E||!h_(this)&&d;(p||G)&&(M=Da(Yv(T),N),k=!M),(!Da(l.immediate,V)&&!V||!Da(g.decay,v)||!Da(g.velocity,S))&&(k=!0)}if(M&&Fs(this)&&(l.changed&&!E?k=!0:k||this._stop(u)),!m&&((k||Gi(u))&&(l.values=b.getPayload(),l.toValues=Gi(f)?null:B==Sp?[1]:Xn(N)),l.immediate!=V&&(l.immediate=V,!V&&!E&&this._set(u)),k)){const{onRest:G}=l;lt(Hft,q=>qj(this,r,q));const j=_o(this,Im(this,u));qm(this._pendingCalls,j),this._pendingCalls.add(n),l.changed&&ht.batchedUpdates(()=>{l.changed=!E,G==null||G(j,this),E?si(s.onRest,j):l.onStart==null||l.onStart(j,this)})}E&&this._set(T),m?n(kre(r.to,r,this._state,this)):k?this._start():Fs(this)&&!p?this._pendingCalls.add(n):n(Pre(T))}_focus(e){const r=this.animation;e!==r.to&&(kj(this)&&this._detach(),r.to=e,kj(this)&&this._attach())}_attach(){let e=0;const{to:r}=this.animation;Gi(r)&&(Kp(r,this),c4(r)&&(e=r.priority+1)),this.priority=e}_detach(){const{to:e}=this.animation;Gi(e)&&zv(e,this)}_set(e,r=!0){const n=ai(e);if(!Ee.und(n)){const i=Zo(this);if(!i||!Da(n,i.getValue())){const o=a4(n);!i||i.constructor!=o?dM(this,o.create(n)):i.setValue(n),i&&ht.batchedUpdates(()=>{this._onChange(n,r)})}}return Zo(this)}_onStart(){const e=this.animation;e.changed||(e.changed=!0,Mm(this,"onStart",_o(this,Im(this,e.to)),this))}_onChange(e,r){r||(this._onStart(),si(this.animation.onChange,e,this)),si(this.defaultProps.onChange,e,this),super._onChange(e,r)}_start(){const e=this.animation;Zo(this).reset(ai(e.to)),e.immediate||(e.fromValues=e.values.map(r=>r.lastPosition)),Fs(this)||(Gj(this,!0),xm(this)||this._resume())}_resume(){da.skipAnimation?this.finish():vR.start(this)}_stop(e,r){if(Fs(this)){Gj(this,!1);const n=this.animation;lt(n.values,o=>{o.done=!0}),n.toValues&&(n.onChange=n.onPause=n.onResume=void 0),Wv(this,{type:"idle",parent:this});const i=r?sh(this.get()):_o(this.get(),Im(this,e!=null?e:n.to));qm(this._pendingCalls,i),n.changed&&(n.changed=!1,Mm(this,"onRest",i,this))}}}function Im(t,e){const r=Yv(e),n=Yv(t.get());return Da(n,r)}function Lre(t,e=t.loop,r=t.to){let n=si(e);if(n){const i=n!==!0&&mM(n),o=(i||t).reverse,a=!i||i.reset;return qv(Pr({},t,{loop:e,default:!1,pause:void 0,to:!o||s4(r)?r:void 0,from:a?t.from:void 0,reset:a},i))}}function qv(t){const{to:e,from:r}=t=mM(t),n=new Set;return Ee.obj(e)&&Kj(e,n),Ee.obj(r)&&Kj(r,n),t.keys=n.size?Array.from(n):null,t}function Fft(t){const e=qv(t);return Ee.und(e.default)&&(e.default=CR(e)),e}function Kj(t,e){ha(t,(r,n)=>r!=null&&e.add(n))}const Hft=["onStart","onRest","onChange","onPause","onResume"];function qj(t,e,r){t.animation[r]=e[r]!==xre(e,r)?Are(e[r],t.key):void 0}function Mm(t,e,...r){var n,i,o,a;(n=(i=t.animation)[e])==null||n.call(i,...r),(o=(a=t.defaultProps)[e])==null||o.call(a,...r)}const Bft=["onStart","onChange","onRest"];let Uft=1;class Dre{constructor(e,r){this.id=Uft++,this.springs={},this.queue=[],this.ref=void 0,this._flush=void 0,this._initialProps=void 0,this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._item=void 0,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),r&&(this._flush=r),e&&this.start(Pr({default:!0},e))}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(e=>e.idle&&!e.isDelayed&&!e.isPaused)}get item(){return this._item}set item(e){this._item=e}get(){const e={};return this.each((r,n)=>e[n]=r.get()),e}set(e){for(const r in e){const n=e[r];Ee.und(n)||this.springs[r].set(n)}}update(e){return e&&this.queue.push(qv(e)),this}start(e){let{queue:r}=this;return e?r=Xn(e).map(qv):this.queue=[],this._flush?this._flush(this,r):(Vre(this,r),d4(this,r))}stop(e,r){if(e!==!!e&&(r=e),r){const n=this.springs;lt(Xn(r),i=>n[i].stop(!!e))}else Kv(this._state,this._lastAsyncId),this.each(n=>n.stop(!!e));return this}pause(e){if(Ee.und(e))this.start({pause:!0});else{const r=this.springs;lt(Xn(e),n=>r[n].pause())}return this}resume(e){if(Ee.und(e))this.start({pause:!1});else{const r=this.springs;lt(Xn(e),n=>r[n].resume())}return this}each(e){ha(this.springs,e)}_onFrame(){const{onStart:e,onChange:r,onRest:n}=this._events,i=this._active.size>0,o=this._changed.size>0;(i&&!this._started||o&&!this._started)&&(this._started=!0,bg(e,([l,u])=>{u.value=this.get(),l(u,this,this._item)}));const a=!i&&this._started,s=o||a&&n.size?this.get():null;o&&r.size&&bg(r,([l,u])=>{u.value=s,l(u,this,this._item)}),a&&(this._started=!1,bg(n,([l,u])=>{u.value=s,l(u,this,this._item)}))}eventObserved(e){if(e.type=="change")this._changed.add(e.parent),e.idle||this._active.add(e.parent);else if(e.type=="idle")this._active.delete(e.parent);else return;ht.onFrame(this._onFrame)}}function d4(t,e){return Promise.all(e.map(r=>Fre(t,r))).then(r=>yM(t,r))}async function Fre(t,e,r){const{keys:n,to:i,from:o,loop:a,onRest:s,onResolve:l}=e,u=Ee.obj(e.default)&&e.default;a&&(e.loop=!1),i===!1&&(e.to=null),o===!1&&(e.from=null);const c=Ee.arr(i)||Ee.fun(i)?i:void 0;c?(e.to=void 0,e.onRest=void 0,u&&(u.onRest=void 0)):lt(Bft,m=>{const g=e[m];if(Ee.fun(g)){const v=t._events[m];e[m]=({finished:S,cancelled:b})=>{const E=v.get(g);E?(S||(E.finished=!1),b&&(E.cancelled=!0)):v.set(g,{value:null,finished:S||!1,cancelled:b||!1})},u&&(u[m]=e[m])}});const f=t._state;e.pause===!f.paused?(f.paused=e.pause,qm(e.pause?f.pauseQueue:f.resumeQueue)):f.paused&&(e.pause=!0);const h=(n||Object.keys(t.springs)).map(m=>t.springs[m].start(e)),d=e.cancel===!0||xre(e,"cancel")===!0;(c||d&&f.asyncId)&&h.push(Nre(++t._lastAsyncId,{props:e,state:f,actions:{pause:r4,resume:r4,start(m,g){d?(Kv(f,t._lastAsyncId),g(sh(t))):(m.onRest=s,g(kre(c,m,f,t)))}}})),f.paused&&await new Promise(m=>{f.resumeQueue.add(m)});const p=yM(t,await Promise.all(h));if(a&&p.finished&&!(r&&p.noop)){const m=Lre(e,a,i);if(m)return Vre(t,[m]),Fre(t,m,!0)}return l&&ht.batchedUpdates(()=>l(p,t,t.item)),p}function p4(t,e){const r=Pr({},t.springs);return e&&lt(Xn(e),n=>{Ee.und(n.keys)&&(n=qv(n)),Ee.obj(n.to)||(n=Pr({},n,{to:void 0})),Ure(r,n,i=>Bre(i))}),Hre(t,r),r}function Hre(t,e){ha(e,(r,n)=>{t.springs[n]||(t.springs[n]=r,Kp(r,t))})}function Bre(t,e){const r=new Dft;return r.key=t,e&&Kp(r,e),r}function Ure(t,e,r){e.keys&&lt(e.keys,n=>{(t[n]||(t[n]=r(n)))._prepareNode(e)})}function Vre(t,e){lt(e,r=>{Ure(t.springs,r,n=>Bre(n,t))})}function Vft(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}const jft=["children"],Q1=t=>{let{children:e}=t,r=Vft(t,jft);const n=J.exports.useContext(MS),i=r.pause||!!n.pause,o=r.immediate||!!n.immediate;r=bft(()=>({pause:i,immediate:o}),[i,o]);const{Provider:a}=MS;return J.exports.createElement(a,{value:r},e)},MS=Wft(Q1,{});Q1.Provider=MS.Provider;Q1.Consumer=MS.Consumer;function Wft(t,e){return Object.assign(t,J.exports.createContext(e)),t.Provider._context=t,t.Consumer._context=t,t}const jre=()=>{const t=[],e=function(i){yft();const o=[];return lt(t,(a,s)=>{if(Ee.und(i))o.push(a.start());else{const l=r(i,a,s);l&&o.push(a.start(l))}}),o};e.current=t,e.add=function(n){t.includes(n)||t.push(n)},e.delete=function(n){const i=t.indexOf(n);~i&&t.splice(i,1)},e.pause=function(){return lt(t,n=>n.pause(...arguments)),this},e.resume=function(){return lt(t,n=>n.resume(...arguments)),this},e.set=function(n){lt(t,i=>i.set(n))},e.start=function(n){const i=[];return lt(t,(o,a)=>{if(Ee.und(n))i.push(o.start());else{const s=this._getProps(n,o,a);s&&i.push(o.start(s))}}),i},e.stop=function(){return lt(t,n=>n.stop(...arguments)),this},e.update=function(n){return lt(t,(i,o)=>i.update(this._getProps(n,i,o))),this};const r=function(i,o,a){return Ee.fun(i)?i(a,o):i};return e._getProps=r,e};function zft(t,e,r){const n=Ee.fun(e)&&e;n&&!r&&(r=[]);const i=J.exports.useMemo(()=>n||arguments.length==3?jre():void 0,[]),o=J.exports.useRef(0),a=fM(),s=J.exports.useMemo(()=>({ctrls:[],queue:[],flush(v,S){const b=p4(v,S);return o.current>0&&!s.queue.length&&!Object.keys(b).some(T=>!v.springs[T])?d4(v,S):new Promise(T=>{Hre(v,b),s.queue.push(()=>{T(d4(v,S))}),a()})}}),[]),l=J.exports.useRef([...s.ctrls]),u=[],c=o4(t)||0;J.exports.useMemo(()=>{lt(l.current.slice(t,c),v=>{l4(v,i),v.stop(!0)}),l.current.length=t,f(c,t)},[t]),J.exports.useMemo(()=>{f(0,Math.min(c,t))},r);function f(v,S){for(let b=v;b<S;b++){const E=l.current[b]||(l.current[b]=new Dre(null,s.flush)),T=n?n(b,E):e[b];T&&(u[b]=Fft(T))}}const h=l.current.map((v,S)=>p4(v,u[S])),d=J.exports.useContext(Q1),p=o4(d),m=d!==p&&Ire(d);Mu(()=>{o.current++,s.ctrls=l.current;const{queue:v}=s;v.length&&(s.queue=[],lt(v,S=>S())),lt(l.current,(S,b)=>{i==null||i.add(S),m&&S.start({default:d});const E=u[b];E&&(Mre(S,E.ref),S.ref?S.queue.push(E):S.start(E))})}),hM(()=>()=>{lt(s.ctrls,v=>v.stop(!0))});const g=h.map(v=>Pr({},v));return i?[g,i]:g}function Sa(t,e){const r=Ee.fun(t),[[n],i]=zft(1,r?t:[t],r?e||[]:e);return r||arguments.length==2?[n,i]:n}let zn;(function(t){t.MOUNT="mount",t.ENTER="enter",t.UPDATE="update",t.LEAVE="leave"})(zn||(zn={}));function bM(t,e,r){const n=Ee.fun(e)&&e,{reset:i,sort:o,trail:a=0,expires:s=!0,exitBeforeEnter:l=!1,onDestroyed:u,ref:c,config:f}=n?n():e,h=J.exports.useMemo(()=>n||arguments.length==3?jre():void 0,[]),d=Xn(t),p=[],m=J.exports.useRef(null),g=i?null:m.current;Mu(()=>{m.current=p}),hM(()=>(lt(m.current,q=>{var te;(te=q.ctrl.ref)==null||te.add(q.ctrl);const pe=L.get(q);pe&&q.ctrl.start(pe.payload)}),()=>{lt(m.current,q=>{q.expired&&clearTimeout(q.expirationId),l4(q.ctrl,h),q.ctrl.stop(!0)})}));const v=Yft(d,n?n():e,g),S=i&&m.current||[];Mu(()=>lt(S,({ctrl:q,item:te,key:pe})=>{l4(q,h),si(u,te,pe)}));const b=[];if(g&&lt(g,(q,te)=>{q.expired?(clearTimeout(q.expirationId),S.push(q)):(te=b[te]=v.indexOf(q.key),~te&&(p[te]=q))}),lt(d,(q,te)=>{p[te]||(p[te]={key:v[te],item:q,phase:zn.MOUNT,ctrl:new Dre},p[te].ctrl.item=q)}),b.length){let q=-1;const{leave:te}=n?n():e;lt(b,(pe,ne)=>{const O=g[ne];~pe?(q=p.indexOf(O),p[q]=Pr({},O,{item:d[pe]})):te&&p.splice(++q,0,O)})}Ee.fun(o)&&p.sort((q,te)=>o(q.item,te.item));let E=-a;const T=fM(),N=CR(e),L=new Map,V=J.exports.useRef(new Map),B=J.exports.useRef(!1);lt(p,(q,te)=>{const pe=q.key,ne=q.phase,O=n?n():e;let y,R,C=si(O.delay||0,pe);if(ne==zn.MOUNT)y=O.enter,R=zn.ENTER;else{const Y=v.indexOf(pe)<0;if(ne!=zn.LEAVE)if(Y)y=O.leave,R=zn.LEAVE;else if(y=O.update)R=zn.UPDATE;else return;else if(!Y)y=O.enter,R=zn.ENTER;else return}if(y=si(y,q.item,te),y=Ee.obj(y)?mM(y):{to:y},!y.config){const Y=f||N.config;y.config=si(Y,q.item,te,R)}E+=a;const A=Pr({},N,{delay:C+E,ref:c,immediate:O.immediate,reset:!1},y);if(R==zn.ENTER&&Ee.und(A.from)){const Y=n?n():e,z=Ee.und(Y.initial)||g?Y.from:Y.initial;A.from=si(z,q.item,te)}const{onResolve:P}=A;A.onResolve=Y=>{si(P,Y);const z=m.current,oe=z.find(me=>me.key===pe);if(!!oe&&!(Y.cancelled&&oe.phase!=zn.UPDATE)&&oe.ctrl.idle){const me=z.every(re=>re.ctrl.idle);if(oe.phase==zn.LEAVE){const re=si(s,oe.item);if(re!==!1){const ge=re===!0?0:re;if(oe.expired=!0,!me&&ge>0){ge<=2147483647&&(oe.expirationId=setTimeout(T,ge));return}}}me&&z.some(re=>re.expired)&&(V.current.delete(oe),l&&(B.current=!0),T())}};const H=p4(q.ctrl,A);R===zn.LEAVE&&l?V.current.set(q,{phase:R,springs:H,payload:A}):L.set(q,{phase:R,springs:H,payload:A})});const k=J.exports.useContext(Q1),M=o4(k),G=k!==M&&Ire(k);Mu(()=>{G&&lt(p,q=>{q.ctrl.start({default:k})})},[k]),lt(L,(q,te)=>{if(V.current.size){const pe=p.findIndex(ne=>ne.key===te.key);p.splice(pe,1)}}),Mu(()=>{lt(V.current.size?V.current:L,({phase:q,payload:te},pe)=>{const{ctrl:ne}=pe;pe.phase=q,h==null||h.add(ne),G&&q==zn.ENTER&&ne.start({default:k}),te&&(Mre(ne,te.ref),ne.ref&&!B.current?ne.update(te):(ne.start(te),B.current&&(B.current=!1)))})},i?void 0:r);const j=q=>J.exports.createElement(J.exports.Fragment,null,p.map((te,pe)=>{const{springs:ne}=L.get(te)||te.ctrl,O=q(Pr({},ne),te.item,te,pe);return O&&O.type?J.exports.createElement(O.type,Pr({},O.props,{key:Ee.str(te.key)||Ee.num(te.key)?te.key:te.ctrl.id,ref:O.ref})):O}));return h?[j,h]:j}let Gft=1;function Yft(t,{key:e,keys:r=e},n){if(r===null){const i=new Set;return t.map(o=>{const a=n&&n.find(s=>s.item===o&&s.phase!==zn.LEAVE&&!i.has(s));return a?(i.add(a),a.key):Gft++})}return Ee.und(r)?t:Ee.fun(r)?t.map(r):Xn(r)}class Wre extends vM{constructor(e,r){super(),this.key=void 0,this.idle=!0,this.calc=void 0,this._active=new Set,this.source=e,this.calc=jv(...r);const n=this._get(),i=a4(n);dM(this,i.create(n))}advance(e){const r=this._get(),n=this.get();Da(r,n)||(Zo(this).setValue(r),this._onChange(r,this.idle)),!this.idle&&Xj(this._active)&&d_(this)}_get(){const e=Ee.arr(this.source)?this.source.map(ai):Xn(ai(this.source));return this.calc(...e)}_start(){this.idle&&!Xj(this._active)&&(this.idle=!1,lt(RR(this),e=>{e.done=!1}),da.skipAnimation?(ht.batchedUpdates(()=>this.advance()),d_(this)):vR.start(this))}_attach(){let e=1;lt(Xn(this.source),r=>{Gi(r)&&Kp(r,this),c4(r)&&(r.idle||this._active.add(r),e=Math.max(e,r.priority+1))}),this.priority=e,this._start()}_detach(){lt(Xn(this.source),e=>{Gi(e)&&zv(e,this)}),this._active.clear(),d_(this)}eventObserved(e){e.type=="change"?e.idle?this.advance():(this._active.add(e.parent),this._start()):e.type=="idle"?this._active.delete(e.parent):e.type=="priority"&&(this.priority=Xn(this.source).reduce((r,n)=>Math.max(r,(c4(n)?n.priority:0)+1),0))}}function Kft(t){return t.idle!==!1}function Xj(t){return!t.size||Array.from(t).every(Kft)}function d_(t){t.idle||(t.idle=!0,lt(RR(t),e=>{e.done=!0}),Wv(t,{type:"idle",parent:t}))}const m4=(t,...e)=>new Wre(t,e);da.assign({createStringInterpolator:_re,to:(t,e)=>new Wre(t,e)});function wM(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}const qft=["style","children","scrollTop","scrollLeft"],zre=/^--/;function Xft(t,e){return e==null||typeof e=="boolean"||e===""?"":typeof e=="number"&&e!==0&&!zre.test(t)&&!(Rg.hasOwnProperty(t)&&Rg[t])?e+"px":(""+e).trim()}const Qj={};function Qft(t,e){if(!t.nodeType||!t.setAttribute)return!1;const r=t.nodeName==="filter"||t.parentNode&&t.parentNode.nodeName==="filter",n=e,{style:i,children:o,scrollTop:a,scrollLeft:s}=n,l=wM(n,qft),u=Object.values(l),c=Object.keys(l).map(f=>r||t.hasAttribute(f)?f:Qj[f]||(Qj[f]=f.replace(/([A-Z])/g,h=>"-"+h.toLowerCase())));o!==void 0&&(t.textContent=o);for(let f in i)if(i.hasOwnProperty(f)){const h=Xft(f,i[f]);zre.test(f)?t.style.setProperty(f,h):t.style[f]=h}c.forEach((f,h)=>{t.setAttribute(f,u[h])}),a!==void 0&&(t.scrollTop=a),s!==void 0&&(t.scrollLeft=s)}let Rg={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};const Zft=(t,e)=>t+e.charAt(0).toUpperCase()+e.substring(1),Jft=["Webkit","Ms","Moz","O"];Rg=Object.keys(Rg).reduce((t,e)=>(Jft.forEach(r=>t[Zft(r,e)]=t[e]),t),Rg);const eht=["x","y","z"],tht=/^(matrix|translate|scale|rotate|skew)/,rht=/^(translate)/,nht=/^(rotate|skew)/,p_=(t,e)=>Ee.num(t)&&t!==0?t+e:t,D2=(t,e)=>Ee.arr(t)?t.every(r=>D2(r,e)):Ee.num(t)?t===e:parseFloat(t)===e;class iht extends ER{constructor(e){let{x:r,y:n,z:i}=e,o=wM(e,eht);const a=[],s=[];(r||n||i)&&(a.push([r||0,n||0,i||0]),s.push(l=>[`translate3d(${l.map(u=>p_(u,"px")).join(",")})`,D2(l,0)])),ha(o,(l,u)=>{if(u==="transform")a.push([l||""]),s.push(c=>[c,c===""]);else if(tht.test(u)){if(delete o[u],Ee.und(l))return;const c=rht.test(u)?"px":nht.test(u)?"deg":"";a.push(Xn(l)),s.push(u==="rotate3d"?([f,h,d,p])=>[`rotate3d(${f},${h},${d},${p_(p,c)})`,D2(p,0)]:f=>[`${u}(${f.map(h=>p_(h,c)).join(",")})`,D2(f,u.startsWith("scale")?1:0)])}}),a.length&&(o.transform=new oht(a,s)),super(o)}}class oht extends Rre{constructor(e,r){super(),this._value=null,this.inputs=e,this.transforms=r}get(){return this._value||(this._value=this._get())}_get(){let e="",r=!0;return lt(this.inputs,(n,i)=>{const o=ai(n[0]),[a,s]=this.transforms[i](Ee.arr(o)?o:n.map(ai));e+=" "+a,r=r&&s}),r?"none":e}observerAdded(e){e==1&&lt(this.inputs,r=>lt(r,n=>Gi(n)&&Kp(n,this)))}observerRemoved(e){e==0&&lt(this.inputs,r=>lt(r,n=>Gi(n)&&zv(n,this)))}eventObserved(e){e.type=="change"&&(this._value=null),Wv(this,e)}}const aht=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],sht=["scrollTop","scrollLeft"];da.assign({batchedUpdates:Lz.exports.unstable_batchedUpdates,createStringInterpolator:_re,colors:Xct});const lht=Oft(aht,{applyAnimatedValues:Qft,createAnimatedStyle:t=>new iht(t),getComponentProps:t=>wM(t,sht)}),kr=lht.animated;function cc(){return cc=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},cc.apply(this,arguments)}var uht={pointerEvents:"none",position:"absolute",zIndex:10,top:0,left:0},Zj=function(t,e){return"translate("+t+"px, "+e+"px)"},Gre=J.exports.memo(function(t){var e,r=t.position,n=t.anchor,i=t.children,o=pr(),a=co(),s=a.animate,l=a.config,u=Eie(),c=u[0],f=u[1],h=J.exports.useRef(!1),d=void 0,p=!1,m=f.width>0&&f.height>0,g=Math.round(r[0]),v=Math.round(r[1]);m&&(n==="top"?(g-=f.width/2,v-=f.height+14):n==="right"?(g+=14,v-=f.height/2):n==="bottom"?(g-=f.width/2,v+=14):n==="left"?(g-=f.width+14,v-=f.height/2):n==="center"&&(g-=f.width/2,v-=f.height/2),d={transform:Zj(g,v)},h.current||(p=!0),h.current=[g,v]);var S=Sa({to:d,config:l,immediate:!s||p}),b=cc({},uht,o.tooltip,{transform:(e=S.transform)!=null?e:Zj(g,v)});return he.jsx(kr.div,{ref:c,style:b,children:i})});Gre.displayName="TooltipWrapper";var Yre=J.exports.memo(function(t){var e=t.size,r=e===void 0?12:e,n=t.color,i=t.style;return he.jsx("span",{style:cc({display:"block",width:r,height:r,background:n},i===void 0?{}:i)})}),Kre=J.exports.memo(function(t){var e,r=t.id,n=t.value,i=t.format,o=t.enableChip,a=o!==void 0&&o,s=t.color,l=t.renderContent,u=pr(),c=jS(i);if(typeof l=="function")e=l();else{var f=n;c!==void 0&&f!==void 0&&(f=c(f)),e=he.jsxs("div",{style:u.tooltip.basic,children:[a&&he.jsx(Yre,{color:s,style:u.tooltip.chip}),f!==void 0?he.jsxs("span",{children:[r,": ",he.jsx("strong",{children:""+f})]}):r]})}return he.jsx("div",{style:u.tooltip.container,children:e})}),cht={width:"100%",borderCollapse:"collapse"},qre=J.exports.memo(function(t){var e,r=t.title,n=t.rows,i=n===void 0?[]:n,o=t.renderContent,a=pr();return i.length?(e=typeof o=="function"?o():he.jsxs("div",{children:[r&&r,he.jsx("table",{style:cc({},cht,a.tooltip.table),children:he.jsx("tbody",{children:i.map(function(s,l){return he.jsx("tr",{children:s.map(function(u,c){return he.jsx("td",{style:a.tooltip.tableCell,children:u},c)})},l)})})})]}),he.jsx("div",{style:a.tooltip.container,children:e})):null});qre.displayName="TableTooltip";var g4=J.exports.memo(function(t){var e=t.x0,r=t.x1,n=t.y0,i=t.y1,o=pr(),a=co(),s=a.animate,l=a.config,u=J.exports.useMemo(function(){return cc({},o.crosshair.line,{pointerEvents:"none"})},[o.crosshair.line]),c=Sa({x1:e,x2:r,y1:n,y2:i,config:l,immediate:!s});return he.jsx(kr.line,cc({},c,{fill:"none",style:u}))});g4.displayName="CrosshairLine";var y4=J.exports.memo(function(t){var e,r,n=t.width,i=t.height,o=t.type,a=t.x,s=t.y;return o==="cross"?(e={x0:a,x1:a,y0:0,y1:i},r={x0:0,x1:n,y0:s,y1:s}):o==="top-left"?(e={x0:a,x1:a,y0:0,y1:s},r={x0:0,x1:a,y0:s,y1:s}):o==="top"?e={x0:a,x1:a,y0:0,y1:s}:o==="top-right"?(e={x0:a,x1:a,y0:0,y1:s},r={x0:a,x1:n,y0:s,y1:s}):o==="right"?r={x0:a,x1:n,y0:s,y1:s}:o==="bottom-right"?(e={x0:a,x1:a,y0:s,y1:i},r={x0:a,x1:n,y0:s,y1:s}):o==="bottom"?e={x0:a,x1:a,y0:s,y1:i}:o==="bottom-left"?(e={x0:a,x1:a,y0:s,y1:i},r={x0:0,x1:a,y0:s,y1:s}):o==="left"?r={x0:0,x1:a,y0:s,y1:s}:o==="x"?e={x0:a,x1:a,y0:0,y1:i}:o==="y"&&(r={x0:0,x1:n,y0:s,y1:s}),he.jsxs(he.Fragment,{children:[e&&he.jsx(g4,{x0:e.x0,x1:e.x1,y0:e.y0,y1:e.y1}),r&&he.jsx(g4,{x0:r.x0,x1:r.x1,y0:r.y0,y1:r.y1})]})});y4.displayName="Crosshair";var Xre=J.exports.createContext({showTooltipAt:function(){},showTooltipFromEvent:function(){},hideTooltip:function(){}}),v4={isVisible:!1,position:[null,null],content:null,anchor:null},Qre=J.exports.createContext(v4),fht=function(t){var e=J.exports.useState(v4),r=e[0],n=e[1],i=J.exports.useCallback(function(s,l,u){var c=l[0],f=l[1];u===void 0&&(u="top"),n({isVisible:!0,position:[c,f],anchor:u,content:s})},[n]),o=J.exports.useCallback(function(s,l,u){u===void 0&&(u="top");var c=t.current.getBoundingClientRect(),f=t.current.offsetWidth,h=f===c.width?1:f/c.width,d=(l.clientX-c.left)*h,p=(l.clientY-c.top)*h;u!=="left"&&u!=="right"||(u=d<c.width/2?"right":"left"),n({isVisible:!0,position:[d,p],anchor:u,content:s})},[t,n]),a=J.exports.useCallback(function(){n(v4)},[n]);return{actions:J.exports.useMemo(function(){return{showTooltipAt:i,showTooltipFromEvent:o,hideTooltip:a}},[i,o,a]),state:r}},Z1=function(){var t=J.exports.useContext(Xre);if(t===void 0)throw new Error("useTooltip must be used within a TooltipProvider");return t},hht=function(){var t=J.exports.useContext(Qre);if(t===void 0)throw new Error("useTooltipState must be used within a TooltipProvider");return t},dht=function(t){return t.isVisible},pht=function(){var t=hht();return dht(t)?he.jsx(Gre,{position:t.position,anchor:t.anchor,children:t.content}):null},mht=function(t){var e=t.container,r=t.children,n=fht(e),i=n.actions,o=n.state;return he.jsx(Xre.Provider,{value:i,children:he.jsx(Qre.Provider,{value:o,children:r})})},ght=j4,yht=jz;function vht(t,e,r){(r!==void 0&&!yht(t[e],r)||r===void 0&&!(e in t))&&ght(t,e,r)}var Zre=vht,NS={exports:{}};(function(t,e){var r=hae,n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,o=i&&i.exports===n,a=o?r.Buffer:void 0,s=a?a.allocUnsafe:void 0;function l(u,c){if(c)return u.slice();var f=u.length,h=s?s(f):new u.constructor(f);return u.copy(h),h}t.exports=l})(NS,NS.exports);var Jj=dae;function bht(t){var e=new t.constructor(t.byteLength);return new Jj(e).set(new Jj(t)),e}var SM=bht,wht=SM;function Sht(t,e){var r=e?wht(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var Jre=Sht;function Rht(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var ene=Rht,Eht=Mp,eW=Object.create,Cht=function(){function t(){}return function(e){if(!Eht(e))return{};if(eW)return eW(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),_ht=Cht,Tht=pae,Oht=Tht(Object.getPrototypeOf,Object),RM=Oht,Aht=_ht,xht=RM,Iht=Wz;function Mht(t){return typeof t.constructor=="function"&&!Iht(t)?Aht(xht(t)):{}}var tne=Mht,Nht=zz,Pht=i1;function kht(t){return Pht(t)&&Nht(t)}var rne=kht,$ht=Gz,Lht=RM,Dht=i1,Fht="[object Object]",Hht=Function.prototype,Bht=Object.prototype,nne=Hht.toString,Uht=Bht.hasOwnProperty,Vht=nne.call(Object);function jht(t){if(!Dht(t)||$ht(t)!=Fht)return!1;var e=Lht(t);if(e===null)return!0;var r=Uht.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&nne.call(r)==Vht}var J1=jht;function Wht(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var ine=Wht,zht=j4,Ght=jz,Yht=Object.prototype,Kht=Yht.hasOwnProperty;function qht(t,e,r){var n=t[e];(!(Kht.call(t,e)&&Ght(n,r))||r===void 0&&!(e in t))&&zht(t,e,r)}var EM=qht,Xht=EM,Qht=j4;function Zht(t,e,r,n){var i=!r;r||(r={});for(var o=-1,a=e.length;++o<a;){var s=e[o],l=n?n(r[s],t[s],s,r,t):void 0;l===void 0&&(l=t[s]),i?Qht(r,s,l):Xht(r,s,l)}return r}var Xp=Zht;function Jht(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var edt=Jht,tdt=Mp,rdt=Wz,ndt=edt,idt=Object.prototype,odt=idt.hasOwnProperty;function adt(t){if(!tdt(t))return ndt(t);var e=rdt(t),r=[];for(var n in t)n=="constructor"&&(e||!odt.call(t,n))||r.push(n);return r}var sdt=adt,ldt=mae,udt=sdt,cdt=zz;function fdt(t){return cdt(t)?ldt(t,!0):udt(t)}var e0=fdt,hdt=Xp,ddt=e0;function pdt(t){return hdt(t,ddt(t))}var mdt=pdt,tW=Zre,gdt=NS.exports,ydt=Jre,vdt=ene,bdt=tne,rW=gae,nW=W4,wdt=rne,Sdt=Yz.exports,Rdt=Cg,Edt=Mp,Cdt=J1,_dt=yae,iW=ine,Tdt=mdt;function Odt(t,e,r,n,i,o,a){var s=iW(t,r),l=iW(e,r),u=a.get(l);if(u){tW(t,r,u);return}var c=o?o(s,l,r+"",t,e,a):void 0,f=c===void 0;if(f){var h=nW(l),d=!h&&Sdt(l),p=!h&&!d&&_dt(l);c=l,h||d||p?nW(s)?c=s:wdt(s)?c=vdt(s):d?(f=!1,c=gdt(l,!0)):p?(f=!1,c=ydt(l,!0)):c=[]:Cdt(l)||rW(l)?(c=s,rW(s)?c=Tdt(s):(!Edt(s)||Rdt(s))&&(c=bdt(l))):f=!1}f&&(a.set(l,c),i(c,l,n,o,a),a.delete(l)),tW(t,r,c)}var Adt=Odt,xdt=Kz,Idt=Zre,Mdt=vae,Ndt=Adt,Pdt=Mp,kdt=e0,$dt=ine;function one(t,e,r,n,i){t!==e&&Mdt(e,function(o,a){if(i||(i=new xdt),Pdt(o))Ndt(t,e,a,r,one,n,i);else{var s=n?n($dt(t,a),o,a+"",t,e,i):void 0;s===void 0&&(s=o),Idt(t,a,s)}},kdt)}var Ldt=one,Ddt=qz,Fdt=bae;function Hdt(t){return Ddt(function(e,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,a=i>2?r[2]:void 0;for(o=t.length>3&&typeof o=="function"?(i--,o):void 0,a&&Fdt(r[0],r[1],a)&&(o=i<3?void 0:o,i=1),e=Object(e);++n<i;){var s=r[n];s&&t(e,s,n,o)}return e})}var Bdt=Hdt,Udt=Ldt,Vdt=Bdt,jdt=Vdt(function(t,e,r){Udt(t,e,r)}),Wdt=jdt,zdt=EM,Gdt=ZS,Ydt=wae,oW=Mp,Kdt=Xz;function qdt(t,e,r,n){if(!oW(t))return t;e=Gdt(e,t);for(var i=-1,o=e.length,a=o-1,s=t;s!=null&&++i<o;){var l=Kdt(e[i]),u=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return t;if(i!=a){var c=s[l];u=n?n(c,l,s):void 0,u===void 0&&(u=oW(c)?c:Ydt(e[i+1])?[]:{})}zdt(s,l,u),s=s[l]}return t}var ane=qdt,Xdt=ane;function Qdt(t,e,r){return t==null?t:Xdt(t,e,r)}var Nu=Qdt;function _R(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function CM(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Qp(){}var fc=.7,Rp=1/fc,lh="\\s*([+-]?\\d+)\\s*",Xv="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",sa="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Zdt=/^#([0-9a-f]{3,8})$/,Jdt=new RegExp("^rgb\\("+[lh,lh,lh]+"\\)$"),ept=new RegExp("^rgb\\("+[sa,sa,sa]+"\\)$"),tpt=new RegExp("^rgba\\("+[lh,lh,lh,Xv]+"\\)$"),rpt=new RegExp("^rgba\\("+[sa,sa,sa,Xv]+"\\)$"),npt=new RegExp("^hsl\\("+[Xv,sa,sa]+"\\)$"),ipt=new RegExp("^hsla\\("+[Xv,sa,sa,Xv]+"\\)$"),aW={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};_R(Qp,Qv,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:sW,formatHex:sW,formatHsl:opt,formatRgb:lW,toString:lW});function sW(){return this.rgb().formatHex()}function opt(){return lne(this).formatHsl()}function lW(){return this.rgb().formatRgb()}function Qv(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=Zdt.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?uW(e):r===3?new Qn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Tb(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Tb(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Jdt.exec(t))?new Qn(e[1],e[2],e[3],1):(e=ept.exec(t))?new Qn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=tpt.exec(t))?Tb(e[1],e[2],e[3],e[4]):(e=rpt.exec(t))?Tb(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=npt.exec(t))?hW(e[1],e[2]/100,e[3]/100,1):(e=ipt.exec(t))?hW(e[1],e[2]/100,e[3]/100,e[4]):aW.hasOwnProperty(t)?uW(aW[t]):t==="transparent"?new Qn(NaN,NaN,NaN,0):null}function uW(t){return new Qn(t>>16&255,t>>8&255,t&255,1)}function Tb(t,e,r,n){return n<=0&&(t=e=r=NaN),new Qn(t,e,r,n)}function sne(t){return t instanceof Qp||(t=Qv(t)),t?(t=t.rgb(),new Qn(t.r,t.g,t.b,t.opacity)):new Qn}function Ep(t,e,r,n){return arguments.length===1?sne(t):new Qn(t,e,r,n==null?1:n)}function Qn(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}_R(Qn,Ep,CM(Qp,{brighter:function(t){return t=t==null?Rp:Math.pow(Rp,t),new Qn(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?fc:Math.pow(fc,t),new Qn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:cW,formatHex:cW,formatRgb:fW,toString:fW}));function cW(){return"#"+m_(this.r)+m_(this.g)+m_(this.b)}function fW(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function m_(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function hW(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new ra(t,e,r,n)}function lne(t){if(t instanceof ra)return new ra(t.h,t.s,t.l,t.opacity);if(t instanceof Qp||(t=Qv(t)),!t)return new ra;if(t instanceof ra)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),o=Math.max(e,r,n),a=NaN,s=o-i,l=(o+i)/2;return s?(e===o?a=(r-n)/s+(r<n)*6:r===o?a=(n-e)/s+2:a=(e-r)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new ra(a,s,l,t.opacity)}function apt(t,e,r,n){return arguments.length===1?lne(t):new ra(t,e,r,n==null?1:n)}function ra(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}_R(ra,apt,CM(Qp,{brighter:function(t){return t=t==null?Rp:Math.pow(Rp,t),new ra(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?fc:Math.pow(fc,t),new ra(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new Qn(g_(t>=240?t-240:t+120,i,n),g_(t,i,n),g_(t<120?t+240:t-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function g_(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const spt=Math.PI/180,lpt=180/Math.PI;var une=-.14861,_M=1.78277,TM=-.29227,TR=-.90649,Zv=1.97294,dW=Zv*TR,pW=Zv*_M,mW=_M*TM-TR*une;function upt(t){if(t instanceof Vu)return new Vu(t.h,t.s,t.l,t.opacity);t instanceof Qn||(t=sne(t));var e=t.r/255,r=t.g/255,n=t.b/255,i=(mW*n+dW*e-pW*r)/(mW+dW-pW),o=n-i,a=(Zv*(r-i)-TM*o)/TR,s=Math.sqrt(a*a+o*o)/(Zv*i*(1-i)),l=s?Math.atan2(a,o)*lpt-120:NaN;return new Vu(l<0?l+360:l,s,i,t.opacity)}function pa(t,e,r,n){return arguments.length===1?upt(t):new Vu(t,e,r,n==null?1:n)}function Vu(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}_R(Vu,pa,CM(Qp,{brighter:function(t){return t=t==null?Rp:Math.pow(Rp,t),new Vu(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?fc:Math.pow(fc,t),new Vu(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*spt,e=+this.l,r=isNaN(this.s)?0:this.s*e*(1-e),n=Math.cos(t),i=Math.sin(t);return new Qn(255*(e+r*(une*n+_M*i)),255*(e+r*(TM*n+TR*i)),255*(e+r*(Zv*n)),this.opacity)}}));function cpt(t,e,r,n,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*r+(1+3*t+3*o-3*a)*n+a*i)/6}function fpt(t){var e=t.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,e-1):Math.floor(r*e),i=t[n],o=t[n+1],a=n>0?t[n-1]:2*i-o,s=n<e-1?t[n+2]:2*o-i;return cpt((r-n/e)*e,a,i,o,s)}}const OR=t=>()=>t;function cne(t,e){return function(r){return t+r*e}}function hpt(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function dpt(t,e){var r=e-t;return r?cne(t,r>180||r<-180?r-360*Math.round(r/360):r):OR(isNaN(t)?e:t)}function ppt(t){return(t=+t)==1?uh:function(e,r){return r-e?hpt(e,r,t):OR(isNaN(e)?r:e)}}function uh(t,e){var r=e-t;return r?cne(t,r):OR(isNaN(t)?e:t)}const gW=function t(e){var r=ppt(e);function n(i,o){var a=r((i=Ep(i)).r,(o=Ep(o)).r),s=r(i.g,o.g),l=r(i.b,o.b),u=uh(i.opacity,o.opacity);return function(c){return i.r=a(c),i.g=s(c),i.b=l(c),i.opacity=u(c),i+""}}return n.gamma=t,n}(1);function mpt(t){return function(e){var r=e.length,n=new Array(r),i=new Array(r),o=new Array(r),a,s;for(a=0;a<r;++a)s=Ep(e[a]),n[a]=s.r||0,i[a]=s.g||0,o[a]=s.b||0;return n=t(n),i=t(i),o=t(o),s.opacity=1,function(l){return s.r=n(l),s.g=i(l),s.b=o(l),s+""}}}var gpt=mpt(fpt);function ypt(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),i;return function(o){for(i=0;i<r;++i)n[i]=t[i]*(1-o)+e[i]*o;return n}}function vpt(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function bpt(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,i=new Array(n),o=new Array(r),a;for(a=0;a<n;++a)i[a]=OM(t[a],e[a]);for(;a<r;++a)o[a]=e[a];return function(s){for(a=0;a<n;++a)o[a]=i[a](s);return o}}function wpt(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function PS(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function Spt(t,e){var r={},n={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?r[i]=OM(t[i],e[i]):n[i]=e[i];return function(o){for(i in r)n[i]=r[i](o);return n}}var b4=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,y_=new RegExp(b4.source,"g");function Rpt(t){return function(){return t}}function Ept(t){return function(e){return t(e)+""}}function fne(t,e){var r=b4.lastIndex=y_.lastIndex=0,n,i,o,a=-1,s=[],l=[];for(t=t+"",e=e+"";(n=b4.exec(t))&&(i=y_.exec(e));)(o=i.index)>r&&(o=e.slice(r,o),s[a]?s[a]+=o:s[++a]=o),(n=n[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,l.push({i:a,x:PS(n,i)})),r=y_.lastIndex;return r<e.length&&(o=e.slice(r),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?Ept(l[0].x):Rpt(e):(e=l.length,function(u){for(var c=0,f;c<e;++c)s[(f=l[c]).i]=f.x(u);return s.join("")})}function OM(t,e){var r=typeof e,n;return e==null||r==="boolean"?OR(e):(r==="number"?PS:r==="string"?(n=Qv(e))?(e=n,gW):fne:e instanceof Qv?gW:e instanceof Date?wpt:vpt(e)?ypt:Array.isArray(e)?bpt:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Spt:PS)(t,e)}function Cpt(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function hne(t){return function e(r){r=+r;function n(i,o){var a=t((i=pa(i)).h,(o=pa(o)).h),s=uh(i.s,o.s),l=uh(i.l,o.l),u=uh(i.opacity,o.opacity);return function(c){return i.h=a(c),i.s=s(c),i.l=l(Math.pow(c,r)),i.opacity=u(c),i+""}}return n.gamma=e,n}(1)}hne(dpt);var AM=hne(uh);function dne(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function xM(t){let e=t,r=t;t.length===1&&(e=(a,s)=>t(a)-s,r=_pt(t));function n(a,s,l,u){for(l==null&&(l=0),u==null&&(u=a.length);l<u;){const c=l+u>>>1;r(a[c],s)<0?l=c+1:u=c}return l}function i(a,s,l,u){for(l==null&&(l=0),u==null&&(u=a.length);l<u;){const c=l+u>>>1;r(a[c],s)>0?u=c:l=c+1}return l}function o(a,s,l,u){l==null&&(l=0),u==null&&(u=a.length);const c=n(a,s,l,u-1);return c>l&&e(a[c-1],s)>-e(a[c],s)?c-1:c}return{left:n,center:o,right:i}}function _pt(t){return(e,r)=>dne(t(e),r)}function Tpt(t){return t===null?NaN:+t}const Opt=xM(dne),Apt=Opt.right;xM(Tpt).center;const xpt=Apt;var w4=Math.sqrt(50),S4=Math.sqrt(10),R4=Math.sqrt(2);function E4(t,e,r){var n,i=-1,o,a,s;if(e=+e,t=+t,r=+r,t===e&&r>0)return[t];if((n=e<t)&&(o=t,t=e,e=o),(s=pne(t,e,r))===0||!isFinite(s))return[];if(s>0){let l=Math.round(t/s),u=Math.round(e/s);for(l*s<t&&++l,u*s>e&&--u,a=new Array(o=u-l+1);++i<o;)a[i]=(l+i)*s}else{s=-s;let l=Math.round(t*s),u=Math.round(e*s);for(l/s<t&&++l,u/s>e&&--u,a=new Array(o=u-l+1);++i<o;)a[i]=(l+i)/s}return n&&a.reverse(),a}function pne(t,e,r){var n=(e-t)/Math.max(0,r),i=Math.floor(Math.log(n)/Math.LN10),o=n/Math.pow(10,i);return i>=0?(o>=w4?10:o>=S4?5:o>=R4?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=w4?10:o>=S4?5:o>=R4?2:1)}function C4(t,e,r){var n=Math.abs(e-t)/Math.max(0,r),i=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),o=n/i;return o>=w4?i*=10:o>=S4?i*=5:o>=R4&&(i*=2),e<t?-i:i}function Ipt(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((e-t)/r))|0,o=new Array(i);++n<i;)o[n]=t+n*r;return o}function xc(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const yW=Symbol("implicit");function Pu(){var t=new Map,e=[],r=[],n=yW;function i(o){var a=o+"",s=t.get(a);if(!s){if(n!==yW)return n;t.set(a,s=e.push(o))}return r[(s-1)%r.length]}return i.domain=function(o){if(!arguments.length)return e.slice();e=[],t=new Map;for(const a of o){const s=a+"";t.has(s)||t.set(s,e.push(a))}return i},i.range=function(o){return arguments.length?(r=Array.from(o),i):r.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return Pu(e,r).unknown(n)},xc.apply(i,arguments),i}function IM(){var t=Pu().unknown(void 0),e=t.domain,r=t.range,n=0,i=1,o,a,s=!1,l=0,u=0,c=.5;delete t.unknown;function f(){var h=e().length,d=i<n,p=d?i:n,m=d?n:i;o=(m-p)/Math.max(1,h-l+u*2),s&&(o=Math.floor(o)),p+=(m-p-o*(h-l))*c,a=o*(1-l),s&&(p=Math.round(p),a=Math.round(a));var g=Ipt(h).map(function(v){return p+o*v});return r(d?g.reverse():g)}return t.domain=function(h){return arguments.length?(e(h),f()):e()},t.range=function(h){return arguments.length?([n,i]=h,n=+n,i=+i,f()):[n,i]},t.rangeRound=function(h){return[n,i]=h,n=+n,i=+i,s=!0,f()},t.bandwidth=function(){return a},t.step=function(){return o},t.round=function(h){return arguments.length?(s=!!h,f()):s},t.padding=function(h){return arguments.length?(l=Math.min(1,u=+h),f()):l},t.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),f()):l},t.paddingOuter=function(h){return arguments.length?(u=+h,f()):u},t.align=function(h){return arguments.length?(c=Math.max(0,Math.min(1,h)),f()):c},t.copy=function(){return IM(e(),[n,i]).round(s).paddingInner(l).paddingOuter(u).align(c)},xc.apply(f(),arguments)}function mne(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return mne(e())},t}function Mpt(){return mne(IM.apply(null,arguments).paddingInner(1))}function Npt(t){return function(){return t}}function Ppt(t){return+t}var vW=[0,1];function Hf(t){return t}function _4(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:Npt(isNaN(e)?NaN:.5)}function kpt(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function $pt(t,e,r){var n=t[0],i=t[1],o=e[0],a=e[1];return i<n?(n=_4(i,n),o=r(a,o)):(n=_4(n,i),o=r(o,a)),function(s){return o(n(s))}}function Lpt(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),o=new Array(n),a=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<n;)i[a]=_4(t[a],t[a+1]),o[a]=r(e[a],e[a+1]);return function(s){var l=xpt(t,s,1,n)-1;return o[l](i[l](s))}}function AR(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function MM(){var t=vW,e=vW,r=OM,n,i,o,a=Hf,s,l,u;function c(){var h=Math.min(t.length,e.length);return a!==Hf&&(a=kpt(t[0],t[h-1])),s=h>2?Lpt:$pt,l=u=null,f}function f(h){return h==null||isNaN(h=+h)?o:(l||(l=s(t.map(n),e,r)))(n(a(h)))}return f.invert=function(h){return a(i((u||(u=s(e,t.map(n),PS)))(h)))},f.domain=function(h){return arguments.length?(t=Array.from(h,Ppt),c()):t.slice()},f.range=function(h){return arguments.length?(e=Array.from(h),c()):e.slice()},f.rangeRound=function(h){return e=Array.from(h),r=Cpt,c()},f.clamp=function(h){return arguments.length?(a=h?!0:Hf,c()):a!==Hf},f.interpolate=function(h){return arguments.length?(r=h,c()):r},f.unknown=function(h){return arguments.length?(o=h,f):o},function(h,d){return n=h,i=d,c()}}function gne(){return MM()(Hf,Hf)}function Dpt(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function kS(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Cp(t){return t=kS(Math.abs(t)),t?t[1]:NaN}function Fpt(t,e){return function(r,n){for(var i=r.length,o=[],a=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),o.push(r.substring(i-=s,i+s)),!((l+=s+1)>n));)s=t[a=(a+1)%t.length];return o.reverse().join(e)}}function Hpt(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var Bpt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function $S(t){if(!(e=Bpt.exec(t)))throw new Error("invalid format: "+t);var e;return new NM({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}$S.prototype=NM.prototype;function NM(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}NM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Upt(t){e:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var yne;function Vpt(t,e){var r=kS(t,e);if(!r)return t+"";var n=r[0],i=r[1],o=i-(yne=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=n.length;return o===a?n:o>a?n+new Array(o-a+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+kS(t,Math.max(0,e+o-1))[0]}function bW(t,e){var r=kS(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const wW={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Dpt,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>bW(t*100,e),r:bW,s:Vpt,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function SW(t){return t}var RW=Array.prototype.map,EW=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function jpt(t){var e=t.grouping===void 0||t.thousands===void 0?SW:Fpt(RW.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?SW:Hpt(RW.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"\u2212":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(f){f=$S(f);var h=f.fill,d=f.align,p=f.sign,m=f.symbol,g=f.zero,v=f.width,S=f.comma,b=f.precision,E=f.trim,T=f.type;T==="n"?(S=!0,T="g"):wW[T]||(b===void 0&&(b=12),E=!0,T="g"),(g||h==="0"&&d==="=")&&(g=!0,h="0",d="=");var N=m==="$"?r:m==="#"&&/[boxX]/.test(T)?"0"+T.toLowerCase():"",L=m==="$"?n:/[%p]/.test(T)?a:"",V=wW[T],B=/[defgprs%]/.test(T);b=b===void 0?6:/[gprs]/.test(T)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function k(M){var G=N,j=L,q,te,pe;if(T==="c")j=V(M)+j,M="";else{M=+M;var ne=M<0||1/M<0;if(M=isNaN(M)?l:V(Math.abs(M),b),E&&(M=Upt(M)),ne&&+M==0&&p!=="+"&&(ne=!1),G=(ne?p==="("?p:s:p==="-"||p==="("?"":p)+G,j=(T==="s"?EW[8+yne/3]:"")+j+(ne&&p==="("?")":""),B){for(q=-1,te=M.length;++q<te;)if(pe=M.charCodeAt(q),48>pe||pe>57){j=(pe===46?i+M.slice(q+1):M.slice(q))+j,M=M.slice(0,q);break}}}S&&!g&&(M=e(M,1/0));var O=G.length+M.length+j.length,y=O<v?new Array(v-O+1).join(h):"";switch(S&&g&&(M=e(y+M,y.length?v-j.length:1/0),y=""),d){case"<":M=G+M+j+y;break;case"=":M=G+y+M+j;break;case"^":M=y.slice(0,O=y.length>>1)+G+M+j+y.slice(O);break;default:M=y+G+M+j;break}return o(M)}return k.toString=function(){return f+""},k}function c(f,h){var d=u((f=$S(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(Cp(h)/3)))*3,m=Math.pow(10,-p),g=EW[8+p/3];return function(v){return d(m*v)+g}}return{format:u,formatPrefix:c}}var Ob,PM,vne;Wpt({thousands:",",grouping:[3],currency:["$",""]});function Wpt(t){return Ob=jpt(t),PM=Ob.format,vne=Ob.formatPrefix,Ob}function zpt(t){return Math.max(0,-Cp(Math.abs(t)))}function Gpt(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Cp(e)/3)))*3-Cp(Math.abs(t)))}function Ypt(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Cp(e)-Cp(t))+1}function Kpt(t,e,r,n){var i=C4(t,e,r),o;switch(n=$S(n==null?",f":n),n.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(o=Gpt(i,a))&&(n.precision=o),vne(n,a)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(o=Ypt(i,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=o-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(o=zpt(i))&&(n.precision=o-(n.type==="%")*2);break}}return PM(n)}function bne(t){var e=t.domain;return t.ticks=function(r){var n=e();return E4(n[0],n[n.length-1],r==null?10:r)},t.tickFormat=function(r,n){var i=e();return Kpt(i[0],i[i.length-1],r==null?10:r,n)},t.nice=function(r){r==null&&(r=10);var n=e(),i=0,o=n.length-1,a=n[i],s=n[o],l,u,c=10;for(s<a&&(u=a,a=s,s=u,u=i,i=o,o=u);c-- >0;){if(u=pne(a,s,r),u===l)return n[i]=a,n[o]=s,e(n);if(u>0)a=Math.floor(a/u)*u,s=Math.ceil(s/u)*u;else if(u<0)a=Math.ceil(a*u)/u,s=Math.floor(s*u)/u;else break;l=u}return t},t}function wne(){var t=gne();return t.copy=function(){return AR(t,wne())},xc.apply(t,arguments),bne(t)}function Sne(t,e){t=t.slice();var r=0,n=t.length-1,i=t[r],o=t[n],a;return o<i&&(a=r,r=n,n=a,a=i,i=o,o=a),t[r]=e.floor(i),t[n]=e.ceil(o),t}function CW(t){return Math.log(t)}function _W(t){return Math.exp(t)}function qpt(t){return-Math.log(-t)}function Xpt(t){return-Math.exp(-t)}function Qpt(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Zpt(t){return t===10?Qpt:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function Jpt(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function TW(t){return function(e){return-t(-e)}}function emt(t){var e=t(CW,_W),r=e.domain,n=10,i,o;function a(){return i=Jpt(n),o=Zpt(n),r()[0]<0?(i=TW(i),o=TW(o),t(qpt,Xpt)):t(CW,_W),e}return e.base=function(s){return arguments.length?(n=+s,a()):n},e.domain=function(s){return arguments.length?(r(s),a()):r()},e.ticks=function(s){var l=r(),u=l[0],c=l[l.length-1],f;(f=c<u)&&(h=u,u=c,c=h);var h=i(u),d=i(c),p,m,g,v=s==null?10:+s,S=[];if(!(n%1)&&d-h<v){if(h=Math.floor(h),d=Math.ceil(d),u>0){for(;h<=d;++h)for(m=1,p=o(h);m<n;++m)if(g=p*m,!(g<u)){if(g>c)break;S.push(g)}}else for(;h<=d;++h)for(m=n-1,p=o(h);m>=1;--m)if(g=p*m,!(g<u)){if(g>c)break;S.push(g)}S.length*2<v&&(S=E4(u,c,v))}else S=E4(h,d,Math.min(d-h,v)).map(o);return f?S.reverse():S},e.tickFormat=function(s,l){if(l==null&&(l=n===10?".0e":","),typeof l!="function"&&(l=PM(l)),s===1/0)return l;s==null&&(s=10);var u=Math.max(1,n*s/e.ticks().length);return function(c){var f=c/o(Math.round(i(c)));return f*n<n-.5&&(f*=n),f<=u?l(c):""}},e.nice=function(){return r(Sne(r(),{floor:function(s){return o(Math.floor(i(s)))},ceil:function(s){return o(Math.ceil(i(s)))}}))},e}function Rne(){var t=emt(MM()).domain([1,10]);return t.copy=function(){return AR(t,Rne()).base(t.base())},xc.apply(t,arguments),t}function OW(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function AW(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function tmt(t){var e=1,r=t(OW(e),AW(e));return r.constant=function(n){return arguments.length?t(OW(e=+n),AW(e)):e},bne(r)}function Ene(){var t=tmt(MM());return t.copy=function(){return AR(t,Ene()).constant(t.constant())},xc.apply(t,arguments)}var v_=new Date,b_=new Date;function Rn(t,e,r,n){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=function(o){return t(o=new Date(+o)),o},i.ceil=function(o){return t(o=new Date(o-1)),e(o,1),t(o),o},i.round=function(o){var a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=function(o,a){return e(o=new Date(+o),a==null?1:Math.floor(a)),o},i.range=function(o,a,s){var l=[],u;if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return l;do l.push(u=new Date(+o)),e(o,s),t(o);while(u<o&&o<a);return l},i.filter=function(o){return Rn(function(a){if(a>=a)for(;t(a),!o(a);)a.setTime(a-1)},function(a,s){if(a>=a)if(s<0)for(;++s<=0;)for(;e(a,-1),!o(a););else for(;--s>=0;)for(;e(a,1),!o(a););})},r&&(i.count=function(o,a){return v_.setTime(+o),b_.setTime(+a),t(v_),t(b_),Math.floor(r(v_,b_))},i.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(n?function(a){return n(a)%o===0}:function(a){return i.count(0,a)%o===0}):i}),i}var LS=Rn(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});LS.every=function(t){return t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Rn(function(e){e.setTime(Math.floor(e/t)*t)},function(e,r){e.setTime(+e+r*t)},function(e,r){return(r-e)/t}):LS};const rmt=LS;LS.range;const ds=1e3,Qi=ds*60,ps=Qi*60,hc=ps*24,kM=hc*7,xW=hc*30,w_=hc*365;var Cne=Rn(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+e*ds)},function(t,e){return(e-t)/ds},function(t){return t.getUTCSeconds()});const Bf=Cne;Cne.range;var _ne=Rn(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*ds)},function(t,e){t.setTime(+t+e*Qi)},function(t,e){return(e-t)/Qi},function(t){return t.getMinutes()});const Tne=_ne;_ne.range;var One=Rn(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*ds-t.getMinutes()*Qi)},function(t,e){t.setTime(+t+e*ps)},function(t,e){return(e-t)/ps},function(t){return t.getHours()});const Ane=One;One.range;var xne=Rn(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Qi)/hc,t=>t.getDate()-1);const xR=xne;xne.range;function Ic(t){return Rn(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,r){e.setDate(e.getDate()+r*7)},function(e,r){return(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Qi)/kM})}var IR=Ic(0),DS=Ic(1),nmt=Ic(2),imt=Ic(3),_p=Ic(4),omt=Ic(5),amt=Ic(6);IR.range;DS.range;nmt.range;imt.range;_p.range;omt.range;amt.range;var Ine=Rn(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12},function(t){return t.getMonth()});const Mne=Ine;Ine.range;var $M=Rn(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});$M.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:Rn(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,r){e.setFullYear(e.getFullYear()+r*t)})};const dc=$M;$M.range;var Nne=Rn(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*Qi)},function(t,e){return(e-t)/Qi},function(t){return t.getUTCMinutes()});const Pne=Nne;Nne.range;var kne=Rn(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*ps)},function(t,e){return(e-t)/ps},function(t){return t.getUTCHours()});const $ne=kne;kne.range;var Lne=Rn(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/hc},function(t){return t.getUTCDate()-1});const MR=Lne;Lne.range;function Mc(t){return Rn(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCDate(e.getUTCDate()+r*7)},function(e,r){return(r-e)/kM})}var NR=Mc(0),FS=Mc(1),smt=Mc(2),lmt=Mc(3),Tp=Mc(4),umt=Mc(5),cmt=Mc(6);NR.range;FS.range;smt.range;lmt.range;Tp.range;umt.range;cmt.range;var Dne=Rn(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12},function(t){return t.getUTCMonth()});const Fne=Dne;Dne.range;var LM=Rn(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});LM.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:Rn(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCFullYear(e.getUTCFullYear()+r*t)})};const pc=LM;LM.range;function Hne(t,e,r,n,i,o){const a=[[Bf,1,ds],[Bf,5,5*ds],[Bf,15,15*ds],[Bf,30,30*ds],[o,1,Qi],[o,5,5*Qi],[o,15,15*Qi],[o,30,30*Qi],[i,1,ps],[i,3,3*ps],[i,6,6*ps],[i,12,12*ps],[n,1,hc],[n,2,2*hc],[r,1,kM],[e,1,xW],[e,3,3*xW],[t,1,w_]];function s(u,c,f){const h=c<u;h&&([u,c]=[c,u]);const d=f&&typeof f.range=="function"?f:l(u,c,f),p=d?d.range(u,+c+1):[];return h?p.reverse():p}function l(u,c,f){const h=Math.abs(c-u)/f,d=xM(([,,g])=>g).right(a,h);if(d===a.length)return t.every(C4(u/w_,c/w_,f));if(d===0)return rmt.every(Math.max(C4(u,c,f),1));const[p,m]=a[h/a[d-1][2]<a[d][2]/h?d-1:d];return p.every(m)}return[s,l]}const[fmt,hmt]=Hne(pc,Fne,NR,MR,$ne,Pne),[dmt,pmt]=Hne(dc,Mne,IR,xR,Ane,Tne);function S_(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function R_(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Nm(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function mmt(t){var e=t.dateTime,r=t.date,n=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,l=t.shortMonths,u=Pm(i),c=km(i),f=Pm(o),h=km(o),d=Pm(a),p=km(a),m=Pm(s),g=km(s),v=Pm(l),S=km(l),b={a:ne,A:O,b:y,B:R,c:null,d:$W,e:$W,f:Fmt,g:Kmt,G:Xmt,H:$mt,I:Lmt,j:Dmt,L:Bne,m:Hmt,M:Bmt,p:C,q:A,Q:FW,s:HW,S:Umt,u:Vmt,U:jmt,V:Wmt,w:zmt,W:Gmt,x:null,X:null,y:Ymt,Y:qmt,Z:Qmt,"%":DW},E={a:P,A:H,b:Y,B:z,c:null,d:LW,e:LW,f:tgt,g:fgt,G:dgt,H:Zmt,I:Jmt,j:egt,L:Vne,m:rgt,M:ngt,p:oe,q:me,Q:FW,s:HW,S:igt,u:ogt,U:agt,V:sgt,w:lgt,W:ugt,x:null,X:null,y:cgt,Y:hgt,Z:pgt,"%":DW},T={a:k,A:M,b:G,B:j,c:q,d:PW,e:PW,f:Mmt,g:NW,G:MW,H:kW,I:kW,j:Omt,L:Imt,m:Tmt,M:Amt,p:B,q:_mt,Q:Pmt,s:kmt,S:xmt,u:wmt,U:Smt,V:Rmt,w:bmt,W:Emt,x:te,X:pe,y:NW,Y:MW,Z:Cmt,"%":Nmt};b.x=N(r,b),b.X=N(n,b),b.c=N(e,b),E.x=N(r,E),E.X=N(n,E),E.c=N(e,E);function N(re,ge){return function(ve){var ie=[],be=-1,ce=0,_e=re.length,Ie,Oe,Ae;for(ve instanceof Date||(ve=new Date(+ve));++be<_e;)re.charCodeAt(be)===37&&(ie.push(re.slice(ce,be)),(Oe=IW[Ie=re.charAt(++be)])!=null?Ie=re.charAt(++be):Oe=Ie==="e"?" ":"0",(Ae=ge[Ie])&&(Ie=Ae(ve,Oe)),ie.push(Ie),ce=be+1);return ie.push(re.slice(ce,be)),ie.join("")}}function L(re,ge){return function(ve){var ie=Nm(1900,void 0,1),be=V(ie,re,ve+="",0),ce,_e;if(be!=ve.length)return null;if("Q"in ie)return new Date(ie.Q);if("s"in ie)return new Date(ie.s*1e3+("L"in ie?ie.L:0));if(ge&&!("Z"in ie)&&(ie.Z=0),"p"in ie&&(ie.H=ie.H%12+ie.p*12),ie.m===void 0&&(ie.m="q"in ie?ie.q:0),"V"in ie){if(ie.V<1||ie.V>53)return null;"w"in ie||(ie.w=1),"Z"in ie?(ce=R_(Nm(ie.y,0,1)),_e=ce.getUTCDay(),ce=_e>4||_e===0?FS.ceil(ce):FS(ce),ce=MR.offset(ce,(ie.V-1)*7),ie.y=ce.getUTCFullYear(),ie.m=ce.getUTCMonth(),ie.d=ce.getUTCDate()+(ie.w+6)%7):(ce=S_(Nm(ie.y,0,1)),_e=ce.getDay(),ce=_e>4||_e===0?DS.ceil(ce):DS(ce),ce=xR.offset(ce,(ie.V-1)*7),ie.y=ce.getFullYear(),ie.m=ce.getMonth(),ie.d=ce.getDate()+(ie.w+6)%7)}else("W"in ie||"U"in ie)&&("w"in ie||(ie.w="u"in ie?ie.u%7:"W"in ie?1:0),_e="Z"in ie?R_(Nm(ie.y,0,1)).getUTCDay():S_(Nm(ie.y,0,1)).getDay(),ie.m=0,ie.d="W"in ie?(ie.w+6)%7+ie.W*7-(_e+5)%7:ie.w+ie.U*7-(_e+6)%7);return"Z"in ie?(ie.H+=ie.Z/100|0,ie.M+=ie.Z%100,R_(ie)):S_(ie)}}function V(re,ge,ve,ie){for(var be=0,ce=ge.length,_e=ve.length,Ie,Oe;be<ce;){if(ie>=_e)return-1;if(Ie=ge.charCodeAt(be++),Ie===37){if(Ie=ge.charAt(be++),Oe=T[Ie in IW?ge.charAt(be++):Ie],!Oe||(ie=Oe(re,ve,ie))<0)return-1}else if(Ie!=ve.charCodeAt(ie++))return-1}return ie}function B(re,ge,ve){var ie=u.exec(ge.slice(ve));return ie?(re.p=c.get(ie[0].toLowerCase()),ve+ie[0].length):-1}function k(re,ge,ve){var ie=d.exec(ge.slice(ve));return ie?(re.w=p.get(ie[0].toLowerCase()),ve+ie[0].length):-1}function M(re,ge,ve){var ie=f.exec(ge.slice(ve));return ie?(re.w=h.get(ie[0].toLowerCase()),ve+ie[0].length):-1}function G(re,ge,ve){var ie=v.exec(ge.slice(ve));return ie?(re.m=S.get(ie[0].toLowerCase()),ve+ie[0].length):-1}function j(re,ge,ve){var ie=m.exec(ge.slice(ve));return ie?(re.m=g.get(ie[0].toLowerCase()),ve+ie[0].length):-1}function q(re,ge,ve){return V(re,e,ge,ve)}function te(re,ge,ve){return V(re,r,ge,ve)}function pe(re,ge,ve){return V(re,n,ge,ve)}function ne(re){return a[re.getDay()]}function O(re){return o[re.getDay()]}function y(re){return l[re.getMonth()]}function R(re){return s[re.getMonth()]}function C(re){return i[+(re.getHours()>=12)]}function A(re){return 1+~~(re.getMonth()/3)}function P(re){return a[re.getUTCDay()]}function H(re){return o[re.getUTCDay()]}function Y(re){return l[re.getUTCMonth()]}function z(re){return s[re.getUTCMonth()]}function oe(re){return i[+(re.getUTCHours()>=12)]}function me(re){return 1+~~(re.getUTCMonth()/3)}return{format:function(re){var ge=N(re+="",b);return ge.toString=function(){return re},ge},parse:function(re){var ge=L(re+="",!1);return ge.toString=function(){return re},ge},utcFormat:function(re){var ge=N(re+="",E);return ge.toString=function(){return re},ge},utcParse:function(re){var ge=L(re+="",!0);return ge.toString=function(){return re},ge}}}var IW={"-":"",_:" ",0:"0"},En=/^\s*\d+/,gmt=/^%/,ymt=/[\\^$*+?|[\]().{}]/g;function Ut(t,e,r){var n=t<0?"-":"",i=(n?-t:t)+"",o=i.length;return n+(o<r?new Array(r-o+1).join(e)+i:i)}function vmt(t){return t.replace(ymt,"\\$&")}function Pm(t){return new RegExp("^(?:"+t.map(vmt).join("|")+")","i")}function km(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function bmt(t,e,r){var n=En.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function wmt(t,e,r){var n=En.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function Smt(t,e,r){var n=En.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function Rmt(t,e,r){var n=En.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function Emt(t,e,r){var n=En.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function MW(t,e,r){var n=En.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function NW(t,e,r){var n=En.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function Cmt(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function _mt(t,e,r){var n=En.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function Tmt(t,e,r){var n=En.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function PW(t,e,r){var n=En.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function Omt(t,e,r){var n=En.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function kW(t,e,r){var n=En.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function Amt(t,e,r){var n=En.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function xmt(t,e,r){var n=En.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function Imt(t,e,r){var n=En.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function Mmt(t,e,r){var n=En.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Nmt(t,e,r){var n=gmt.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function Pmt(t,e,r){var n=En.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function kmt(t,e,r){var n=En.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function $W(t,e){return Ut(t.getDate(),e,2)}function $mt(t,e){return Ut(t.getHours(),e,2)}function Lmt(t,e){return Ut(t.getHours()%12||12,e,2)}function Dmt(t,e){return Ut(1+xR.count(dc(t),t),e,3)}function Bne(t,e){return Ut(t.getMilliseconds(),e,3)}function Fmt(t,e){return Bne(t,e)+"000"}function Hmt(t,e){return Ut(t.getMonth()+1,e,2)}function Bmt(t,e){return Ut(t.getMinutes(),e,2)}function Umt(t,e){return Ut(t.getSeconds(),e,2)}function Vmt(t){var e=t.getDay();return e===0?7:e}function jmt(t,e){return Ut(IR.count(dc(t)-1,t),e,2)}function Une(t){var e=t.getDay();return e>=4||e===0?_p(t):_p.ceil(t)}function Wmt(t,e){return t=Une(t),Ut(_p.count(dc(t),t)+(dc(t).getDay()===4),e,2)}function zmt(t){return t.getDay()}function Gmt(t,e){return Ut(DS.count(dc(t)-1,t),e,2)}function Ymt(t,e){return Ut(t.getFullYear()%100,e,2)}function Kmt(t,e){return t=Une(t),Ut(t.getFullYear()%100,e,2)}function qmt(t,e){return Ut(t.getFullYear()%1e4,e,4)}function Xmt(t,e){var r=t.getDay();return t=r>=4||r===0?_p(t):_p.ceil(t),Ut(t.getFullYear()%1e4,e,4)}function Qmt(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ut(e/60|0,"0",2)+Ut(e%60,"0",2)}function LW(t,e){return Ut(t.getUTCDate(),e,2)}function Zmt(t,e){return Ut(t.getUTCHours(),e,2)}function Jmt(t,e){return Ut(t.getUTCHours()%12||12,e,2)}function egt(t,e){return Ut(1+MR.count(pc(t),t),e,3)}function Vne(t,e){return Ut(t.getUTCMilliseconds(),e,3)}function tgt(t,e){return Vne(t,e)+"000"}function rgt(t,e){return Ut(t.getUTCMonth()+1,e,2)}function ngt(t,e){return Ut(t.getUTCMinutes(),e,2)}function igt(t,e){return Ut(t.getUTCSeconds(),e,2)}function ogt(t){var e=t.getUTCDay();return e===0?7:e}function agt(t,e){return Ut(NR.count(pc(t)-1,t),e,2)}function jne(t){var e=t.getUTCDay();return e>=4||e===0?Tp(t):Tp.ceil(t)}function sgt(t,e){return t=jne(t),Ut(Tp.count(pc(t),t)+(pc(t).getUTCDay()===4),e,2)}function lgt(t){return t.getUTCDay()}function ugt(t,e){return Ut(FS.count(pc(t)-1,t),e,2)}function cgt(t,e){return Ut(t.getUTCFullYear()%100,e,2)}function fgt(t,e){return t=jne(t),Ut(t.getUTCFullYear()%100,e,2)}function hgt(t,e){return Ut(t.getUTCFullYear()%1e4,e,4)}function dgt(t,e){var r=t.getUTCDay();return t=r>=4||r===0?Tp(t):Tp.ceil(t),Ut(t.getUTCFullYear()%1e4,e,4)}function pgt(){return"+0000"}function DW(){return"%"}function FW(t){return+t}function HW(t){return Math.floor(+t/1e3)}var yf,PR,Wne,zne,Gne;mgt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function mgt(t){return yf=mmt(t),PR=yf.format,Wne=yf.parse,zne=yf.utcFormat,Gne=yf.utcParse,yf}function ggt(t){return new Date(t)}function ygt(t){return t instanceof Date?+t:+new Date(+t)}function DM(t,e,r,n,i,o,a,s,l,u){var c=gne(),f=c.invert,h=c.domain,d=u(".%L"),p=u(":%S"),m=u("%I:%M"),g=u("%I %p"),v=u("%a %d"),S=u("%b %d"),b=u("%B"),E=u("%Y");function T(N){return(l(N)<N?d:s(N)<N?p:a(N)<N?m:o(N)<N?g:n(N)<N?i(N)<N?v:S:r(N)<N?b:E)(N)}return c.invert=function(N){return new Date(f(N))},c.domain=function(N){return arguments.length?h(Array.from(N,ygt)):h().map(ggt)},c.ticks=function(N){var L=h();return t(L[0],L[L.length-1],N==null?10:N)},c.tickFormat=function(N,L){return L==null?T:u(L)},c.nice=function(N){var L=h();return(!N||typeof N.range!="function")&&(N=e(L[0],L[L.length-1],N==null?10:N)),N?h(Sne(L,N)):c},c.copy=function(){return AR(c,DM(t,e,r,n,i,o,a,s,l,u))},c}function vgt(){return xc.apply(DM(dmt,pmt,dc,Mne,IR,xR,Ane,Tne,Bf,PR).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function bgt(){return xc.apply(DM(fmt,hmt,pc,Fne,NR,MR,$ne,Pne,Bf,zne).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Tt(t){for(var e=t.length/6|0,r=new Array(e),n=0;n<e;)r[n]="#"+t.slice(n*6,++n*6);return r}const Yne=Tt("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Kne=Tt("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),qne=Tt("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Xne=Tt("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Qne=Tt("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Zne=Tt("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Jne=Tt("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),eie=Tt("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),FM=Tt("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),or=t=>gpt(t[t.length-1]);var kR=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Tt);const wgt=or(kR);var $R=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Tt);const Sgt=or($R);var LR=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Tt);const Rgt=or(LR);var DR=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Tt);const Egt=or(DR);var FR=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Tt);const Cgt=or(FR);var HR=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Tt);const _gt=or(HR);var BR=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Tt);const Tgt=or(BR);var UR=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Tt);const Ogt=or(UR);var VR=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Tt);const Agt=or(VR);var jR=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Tt);const xgt=or(jR);var WR=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Tt);const Igt=or(WR);var zR=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Tt);const Mgt=or(zR);var GR=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Tt);const Ngt=or(GR);var YR=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Tt);const Pgt=or(YR);var KR=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Tt);const kgt=or(KR);var qR=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Tt);const $gt=or(qR);var XR=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Tt);const Lgt=or(XR);var QR=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Tt);const Dgt=or(QR);var ZR=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Tt);const Fgt=or(ZR);var JR=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Tt);const Hgt=or(JR);var e5=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Tt);const Bgt=or(e5);var t5=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Tt);const Ugt=or(t5);var r5=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Tt);const Vgt=or(r5);var n5=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Tt);const jgt=or(n5);var i5=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Tt);const Wgt=or(i5);var o5=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Tt);const zgt=or(o5);var a5=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Tt);const Ggt=or(a5);function Ygt(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-t*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-t*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-t*2475.67)))))))+")"}const Kgt=AM(pa(300,.5,0),pa(-240,.5,1));var qgt=AM(pa(-100,.75,.35),pa(80,1.5,.8)),Xgt=AM(pa(260,.75,.35),pa(80,1.5,.8)),Ab=pa();function Qgt(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return Ab.h=360*t-100,Ab.s=1.5-1.5*e,Ab.l=.8-.9*e,Ab+""}var xb=Ep(),Zgt=Math.PI/3,Jgt=Math.PI*2/3;function eyt(t){var e;return t=(.5-t)*Math.PI,xb.r=255*(e=Math.sin(t))*e,xb.g=255*(e=Math.sin(t+Zgt))*e,xb.b=255*(e=Math.sin(t+Jgt))*e,xb+""}function tyt(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-t*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+t*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-t*6838.66)))))))+")"}function s5(t){var e=t.length;return function(r){return t[Math.max(0,Math.min(e-1,Math.floor(r*e)))]}}const ryt=s5(Tt("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var nyt=s5(Tt("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),iyt=s5(Tt("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),oyt=s5(Tt("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),ayt=Sae,syt=Rae,lyt=Eae,uyt=Qz,cyt=JS,fyt=Cae,hyt=200;function dyt(t,e,r,n){var i=-1,o=syt,a=!0,s=t.length,l=[],u=e.length;if(!s)return l;r&&(e=uyt(e,cyt(r))),n?(o=lyt,a=!1):e.length>=hyt&&(o=fyt,a=!1,e=new ayt(e));e:for(;++i<s;){var c=t[i],f=r==null?c:r(c);if(c=n||c!==0?c:0,a&&f===f){for(var h=u;h--;)if(e[h]===f)continue e;l.push(c)}else o(e,f,n)||l.push(c)}return l}var pyt=dyt,myt=pyt,gyt=qz,yyt=rne,vyt=gyt(function(t,e){return yyt(t)?myt(t,e):[]}),tie=vyt,T4=Math.PI,O4=2*T4,Zl=1e-6,byt=O4-Zl;function A4(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function HM(){return new A4}A4.prototype=HM.prototype={constructor:A4,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,r,n){this._+="Q"+ +t+","+ +e+","+(this._x1=+r)+","+(this._y1=+n)},bezierCurveTo:function(t,e,r,n,i,o){this._+="C"+ +t+","+ +e+","+ +r+","+ +n+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,r,n,i){t=+t,e=+e,r=+r,n=+n,i=+i;var o=this._x1,a=this._y1,s=r-t,l=n-e,u=o-t,c=a-e,f=u*u+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(f>Zl)if(!(Math.abs(c*s-l*u)>Zl)||!i)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var h=r-o,d=n-a,p=s*s+l*l,m=h*h+d*d,g=Math.sqrt(p),v=Math.sqrt(f),S=i*Math.tan((T4-Math.acos((p+f-m)/(2*g*v)))/2),b=S/v,E=S/g;Math.abs(b-1)>Zl&&(this._+="L"+(t+b*u)+","+(e+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*h>u*d)+","+(this._x1=t+E*s)+","+(this._y1=e+E*l)}},arc:function(t,e,r,n,i,o){t=+t,e=+e,r=+r,o=!!o;var a=r*Math.cos(n),s=r*Math.sin(n),l=t+a,u=e+s,c=1^o,f=o?n-i:i-n;if(r<0)throw new Error("negative radius: "+r);this._x1===null?this._+="M"+l+","+u:(Math.abs(this._x1-l)>Zl||Math.abs(this._y1-u)>Zl)&&(this._+="L"+l+","+u),r&&(f<0&&(f=f%O4+O4),f>byt?this._+="A"+r+","+r+",0,1,"+c+","+(t-a)+","+(e-s)+"A"+r+","+r+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):f>Zl&&(this._+="A"+r+","+r+",0,"+ +(f>=T4)+","+c+","+(this._x1=t+r*Math.cos(i))+","+(this._y1=e+r*Math.sin(i))))},rect:function(t,e,r,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +r+"v"+ +n+"h"+-r+"Z"},toString:function(){return this._}};function An(t){return function(){return t}}var BW=1e-12;function rie(t){this._context=t}rie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function BM(t){return new rie(t)}function nie(t){return t[0]}function iie(t){return t[1]}function oie(){var t=nie,e=iie,r=An(!0),n=null,i=BM,o=null;function a(s){var l,u=s.length,c,f=!1,h;for(n==null&&(o=i(h=HM())),l=0;l<=u;++l)!(l<u&&r(c=s[l],l,s))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(c,l,s),+e(c,l,s));if(h)return o=null,h+""||null}return a.x=function(s){return arguments.length?(t=typeof s=="function"?s:An(+s),a):t},a.y=function(s){return arguments.length?(e=typeof s=="function"?s:An(+s),a):e},a.defined=function(s){return arguments.length?(r=typeof s=="function"?s:An(!!s),a):r},a.curve=function(s){return arguments.length?(i=s,n!=null&&(o=i(n)),a):i},a.context=function(s){return arguments.length?(s==null?n=o=null:o=i(n=s),a):n},a}function wyt(){var t=nie,e=null,r=An(0),n=iie,i=An(!0),o=null,a=BM,s=null;function l(c){var f,h,d,p=c.length,m,g=!1,v,S=new Array(p),b=new Array(p);for(o==null&&(s=a(v=HM())),f=0;f<=p;++f){if(!(f<p&&i(m=c[f],f,c))===g)if(g=!g)h=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=f-1;d>=h;--d)s.point(S[d],b[d]);s.lineEnd(),s.areaEnd()}g&&(S[f]=+t(m,f,c),b[f]=+r(m,f,c),s.point(e?+e(m,f,c):S[f],n?+n(m,f,c):b[f]))}if(v)return s=null,v+""||null}function u(){return oie().defined(i).curve(a).context(o)}return l.x=function(c){return arguments.length?(t=typeof c=="function"?c:An(+c),e=null,l):t},l.x0=function(c){return arguments.length?(t=typeof c=="function"?c:An(+c),l):t},l.x1=function(c){return arguments.length?(e=c==null?null:typeof c=="function"?c:An(+c),l):e},l.y=function(c){return arguments.length?(r=typeof c=="function"?c:An(+c),n=null,l):r},l.y0=function(c){return arguments.length?(r=typeof c=="function"?c:An(+c),l):r},l.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:An(+c),l):n},l.lineX0=l.lineY0=function(){return u().x(t).y(r)},l.lineY1=function(){return u().x(t).y(n)},l.lineX1=function(){return u().x(e).y(r)},l.defined=function(c){return arguments.length?(i=typeof c=="function"?c:An(!!c),l):i},l.curve=function(c){return arguments.length?(a=c,o!=null&&(s=a(o)),l):a},l.context=function(c){return arguments.length?(c==null?o=s=null:s=a(o=c),l):o},l}var UW=Array.prototype.slice;function yl(){}function HS(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function l5(t){this._context=t}l5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:HS(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:HS(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Syt(t){return new l5(t)}function aie(t){this._context=t}aie.prototype={areaStart:yl,areaEnd:yl,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:HS(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Ryt(t){return new aie(t)}function sie(t){this._context=t}sie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:HS(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Eyt(t){return new sie(t)}function lie(t,e){this._basis=new l5(t),this._beta=e}lie.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,r=t.length-1;if(r>0)for(var n=t[0],i=e[0],o=t[r]-n,a=e[r]-i,s=-1,l;++s<=r;)l=s/r,this._basis.point(this._beta*t[s]+(1-this._beta)*(n+l*o),this._beta*e[s]+(1-this._beta)*(i+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const Cyt=function t(e){function r(n){return e===1?new l5(n):new lie(n,e)}return r.beta=function(n){return t(+n)},r}(.85);function BS(t,e,r){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-r),t._x2,t._y2)}function UM(t,e){this._context=t,this._k=(1-e)/6}UM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:BS(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:BS(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const _yt=function t(e){function r(n){return new UM(n,e)}return r.tension=function(n){return t(+n)},r}(0);function VM(t,e){this._context=t,this._k=(1-e)/6}VM.prototype={areaStart:yl,areaEnd:yl,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:BS(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Tyt=function t(e){function r(n){return new VM(n,e)}return r.tension=function(n){return t(+n)},r}(0);function jM(t,e){this._context=t,this._k=(1-e)/6}jM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:BS(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Oyt=function t(e){function r(n){return new jM(n,e)}return r.tension=function(n){return t(+n)},r}(0);function WM(t,e,r){var n=t._x1,i=t._y1,o=t._x2,a=t._y2;if(t._l01_a>BW){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);n=(n*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>BW){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*u+t._x1*t._l23_2a-e*t._l12_2a)/c,a=(a*u+t._y1*t._l23_2a-r*t._l12_2a)/c}t._context.bezierCurveTo(n,i,o,a,t._x2,t._y2)}function uie(t,e){this._context=t,this._alpha=e}uie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var r=this._x2-t,n=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:WM(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Ayt=function t(e){function r(n){return e?new uie(n,e):new UM(n,0)}return r.alpha=function(n){return t(+n)},r}(.5);function cie(t,e){this._context=t,this._alpha=e}cie.prototype={areaStart:yl,areaEnd:yl,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){if(t=+t,e=+e,this._point){var r=this._x2-t,n=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:WM(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const xyt=function t(e){function r(n){return e?new cie(n,e):new VM(n,0)}return r.alpha=function(n){return t(+n)},r}(.5);function fie(t,e){this._context=t,this._alpha=e}fie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var r=this._x2-t,n=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:WM(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Iyt=function t(e){function r(n){return e?new fie(n,e):new jM(n,0)}return r.alpha=function(n){return t(+n)},r}(.5);function hie(t){this._context=t}hie.prototype={areaStart:yl,areaEnd:yl,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function Myt(t){return new hie(t)}function VW(t){return t<0?-1:1}function jW(t,e,r){var n=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(n||i<0&&-0),a=(r-t._y1)/(i||n<0&&-0),s=(o*i+a*n)/(n+i);return(VW(o)+VW(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function WW(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function E_(t,e,r){var n=t._x0,i=t._y0,o=t._x1,a=t._y1,s=(o-n)/3;t._context.bezierCurveTo(n+s,i+s*e,o-s,a-s*r,o,a)}function US(t){this._context=t}US.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:E_(this,this._t0,WW(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,E_(this,WW(this,r=jW(this,t,e)),r);break;default:E_(this,this._t0,r=jW(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function die(t){this._context=new pie(t)}(die.prototype=Object.create(US.prototype)).point=function(t,e){US.prototype.point.call(this,e,t)};function pie(t){this._context=t}pie.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,i,o){this._context.bezierCurveTo(e,t,n,r,o,i)}};function Nyt(t){return new US(t)}function Pyt(t){return new die(t)}function mie(t){this._context=t}mie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=zW(t),i=zW(e),o=0,a=1;a<r;++o,++a)this._context.bezierCurveTo(n[0][o],i[0][o],n[1][o],i[1][o],t[a],e[a]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function zW(t){var e,r=t.length-1,n,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,a[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/o[e-1],o[e]-=n,a[e]-=n*a[e-1];for(i[r-1]=a[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(a[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}function kyt(t){return new mie(t)}function u5(t,e){this._context=t,this._t=e}u5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function $yt(t){return new u5(t,.5)}function Lyt(t){return new u5(t,0)}function Dyt(t){return new u5(t,1)}function Op(t,e){if((a=t.length)>1)for(var r=1,n,i,o=t[e[0]],a,s=o.length;r<a;++r)for(i=o,o=t[e[r]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function Ap(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function Fyt(t,e){return t[e]}function Hyt(){var t=An([]),e=Ap,r=Op,n=Fyt;function i(o){var a=t.apply(this,arguments),s,l=o.length,u=a.length,c=new Array(u),f;for(s=0;s<u;++s){for(var h=a[s],d=c[s]=new Array(l),p=0,m;p<l;++p)d[p]=m=[0,+n(o[p],h,p,o)],m.data=o[p];d.key=h}for(s=0,f=e(c);s<u;++s)c[f[s]].index=s;return r(c,f),c}return i.keys=function(o){return arguments.length?(t=typeof o=="function"?o:An(UW.call(o)),i):t},i.value=function(o){return arguments.length?(n=typeof o=="function"?o:An(+o),i):n},i.order=function(o){return arguments.length?(e=o==null?Ap:typeof o=="function"?o:An(UW.call(o)),i):e},i.offset=function(o){return arguments.length?(r=o==null?Op:o,i):r},i}function Byt(t,e){if((n=t.length)>0){for(var r,n,i=0,o=t[0].length,a;i<o;++i){for(a=r=0;r<n;++r)a+=t[r][i][1]||0;if(a)for(r=0;r<n;++r)t[r][i][1]/=a}Op(t,e)}}function gie(t,e){if((l=t.length)>0)for(var r,n=0,i,o,a,s,l,u=t[e[0]].length;n<u;++n)for(a=s=0,r=0;r<l;++r)(o=(i=t[e[r]][n])[1]-i[0])>0?(i[0]=a,i[1]=a+=o):o<0?(i[1]=s,i[0]=s+=o):(i[0]=0,i[1]=o)}function Uyt(t,e){if((i=t.length)>0){for(var r=0,n=t[e[0]],i,o=n.length;r<o;++r){for(var a=0,s=0;a<i;++a)s+=t[a][r][1]||0;n[r][1]+=n[r][0]=-s/2}Op(t,e)}}function Vyt(t,e){if(!(!((a=t.length)>0)||!((o=(i=t[e[0]]).length)>0))){for(var r=0,n=1,i,o,a;n<o;++n){for(var s=0,l=0,u=0;s<a;++s){for(var c=t[e[s]],f=c[n][1]||0,h=c[n-1][1]||0,d=(f-h)/2,p=0;p<s;++p){var m=t[e[p]],g=m[n][1]||0,v=m[n-1][1]||0;d+=g-v}l+=f,u+=d*f}i[n-1][1]+=i[n-1][0]=r,l&&(r-=u/l)}i[n-1][1]+=i[n-1][0]=r,Op(t,e)}}function jyt(t){var e=t.map(Wyt);return Ap(t).sort(function(r,n){return e[r]-e[n]})}function Wyt(t){for(var e=-1,r=0,n=t.length,i,o=-1/0;++e<n;)(i=+t[e][1])>o&&(o=i,r=e);return r}function yie(t){var e=t.map(vie);return Ap(t).sort(function(r,n){return e[r]-e[n]})}function vie(t){for(var e=0,r=-1,n=t.length,i;++r<n;)(i=+t[r][1])&&(e+=i);return e}function zyt(t){return yie(t).reverse()}function Gyt(t){var e=t.length,r,n,i=t.map(vie),o=jyt(t),a=0,s=0,l=[],u=[];for(r=0;r<e;++r)n=o[r],a<s?(a+=i[n],l.push(n)):(s+=i[n],u.push(n));return u.reverse().concat(l)}function Yyt(t){return Ap(t).reverse()}function Kyt(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function VS(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function qyt(t){return t=VS(Math.abs(t)),t?t[1]:NaN}function Xyt(t,e){return function(r,n){for(var i=r.length,o=[],a=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),o.push(r.substring(i-=s,i+s)),!((l+=s+1)>n));)s=t[a=(a+1)%t.length];return o.reverse().join(e)}}function Qyt(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var Zyt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function x4(t){if(!(e=Zyt.exec(t)))throw new Error("invalid format: "+t);var e;return new zM({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}x4.prototype=zM.prototype;function zM(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}zM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Jyt(t){e:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var bie;function evt(t,e){var r=VS(t,e);if(!r)return t+"";var n=r[0],i=r[1],o=i-(bie=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=n.length;return o===a?n:o>a?n+new Array(o-a+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+VS(t,Math.max(0,e+o-1))[0]}function GW(t,e){var r=VS(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const YW={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:Kyt,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return GW(t*100,e)},r:GW,s:evt,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function KW(t){return t}var qW=Array.prototype.map,XW=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function tvt(t){var e=t.grouping===void 0||t.thousands===void 0?KW:Xyt(qW.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?KW:Qyt(qW.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"-":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(f){f=x4(f);var h=f.fill,d=f.align,p=f.sign,m=f.symbol,g=f.zero,v=f.width,S=f.comma,b=f.precision,E=f.trim,T=f.type;T==="n"?(S=!0,T="g"):YW[T]||(b===void 0&&(b=12),E=!0,T="g"),(g||h==="0"&&d==="=")&&(g=!0,h="0",d="=");var N=m==="$"?r:m==="#"&&/[boxX]/.test(T)?"0"+T.toLowerCase():"",L=m==="$"?n:/[%p]/.test(T)?a:"",V=YW[T],B=/[defgprs%]/.test(T);b=b===void 0?6:/[gprs]/.test(T)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function k(M){var G=N,j=L,q,te,pe;if(T==="c")j=V(M)+j,M="";else{M=+M;var ne=M<0||1/M<0;if(M=isNaN(M)?l:V(Math.abs(M),b),E&&(M=Jyt(M)),ne&&+M==0&&p!=="+"&&(ne=!1),G=(ne?p==="("?p:s:p==="-"||p==="("?"":p)+G,j=(T==="s"?XW[8+bie/3]:"")+j+(ne&&p==="("?")":""),B){for(q=-1,te=M.length;++q<te;)if(pe=M.charCodeAt(q),48>pe||pe>57){j=(pe===46?i+M.slice(q+1):M.slice(q))+j,M=M.slice(0,q);break}}}S&&!g&&(M=e(M,1/0));var O=G.length+M.length+j.length,y=O<v?new Array(v-O+1).join(h):"";switch(S&&g&&(M=e(y+M,y.length?v-j.length:1/0),y=""),d){case"<":M=G+M+j+y;break;case"=":M=G+y+M+j;break;case"^":M=y.slice(0,O=y.length>>1)+G+M+j+y.slice(O);break;default:M=y+G+M+j;break}return o(M)}return k.toString=function(){return f+""},k}function c(f,h){var d=u((f=x4(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(qyt(h)/3)))*3,m=Math.pow(10,-p),g=XW[8+p/3];return function(v){return d(m*v)+g}}return{format:u,formatPrefix:c}}var Ib,c5;rvt({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function rvt(t){return Ib=tvt(t),c5=Ib.format,Ib.formatPrefix,Ib}var nvt=Zz,ivt=ane,ovt=ZS;function avt(t,e,r){for(var n=-1,i=e.length,o={};++n<i;){var a=e[n],s=nvt(t,a);r(s,a)&&ivt(o,ovt(a,t),s)}return o}var svt=avt,lvt=svt,uvt=_ae;function cvt(t,e){return lvt(t,e,function(r,n){return uvt(t,n)})}var fvt=cvt,hvt=Tae;function dvt(t){var e=t==null?0:t.length;return e?hvt(t,1):[]}var pvt=dvt,mvt=pvt,gvt=Oae,yvt=Aae;function vvt(t){return yvt(gvt(t,void 0,mvt),t+"")}var wie=vvt,bvt=fvt,wvt=wie,Svt=wvt(function(t,e){return t==null?{}:bvt(t,e)}),Rvt=Svt;function sn(){return sn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},sn.apply(this,arguments)}function I4(t,e){return I4=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},I4(t,e)}function GM(t,e){if(t==null)return{};var r,n,i={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(i[r]=t[r]);return i}var vl={fill:_.exports.string,fontSize:_.exports.number,fontFamily:_.exports.string},Evt=_.exports.shape({domain:_.exports.shape({line:_.exports.shape({stroke:_.exports.string.isRequired,strokeWidth:_.exports.number.isRequired,strokeDasharray:_.exports.string}).isRequired}).isRequired,ticks:_.exports.shape({line:_.exports.shape({stroke:_.exports.string.isRequired,strokeWidth:_.exports.number.isRequired,strokeDasharray:_.exports.string}).isRequired,text:_.exports.shape(sn({},vl)).isRequired}).isRequired,legend:_.exports.shape({text:_.exports.shape(sn({},vl)).isRequired}).isRequired}),Cvt=_.exports.shape({line:_.exports.shape({stroke:_.exports.string.isRequired,strokeWidth:_.exports.number.isRequired,strokeDasharray:_.exports.string}).isRequired}),_vt=_.exports.shape({hidden:_.exports.shape({symbol:_.exports.shape({fill:_.exports.string.isRequired,opacity:_.exports.number}).isRequired,text:_.exports.shape(sn({},vl,{opacity:_.exports.number})).isRequired}).isRequired,text:_.exports.shape(sn({},vl)).isRequired}),Tvt=_.exports.shape({text:_.exports.shape(sn({},vl)).isRequired}),Ovt=_.exports.shape({text:_.exports.shape(sn({},vl)).isRequired}),Avt=_.exports.shape({text:_.exports.shape(sn({},vl)).isRequired}),xvt=_.exports.shape({line:_.exports.shape({stroke:_.exports.string.isRequired,strokeWidth:_.exports.number.isRequired,strokeDasharray:_.exports.string}).isRequired}),Ivt=_.exports.shape({text:_.exports.shape(sn({},vl,{outlineWidth:_.exports.number.isRequired,outlineColor:_.exports.string.isRequired})).isRequired,link:_.exports.shape({stroke:_.exports.string.isRequired,strokeWidth:_.exports.number.isRequired,outlineWidth:_.exports.number.isRequired,outlineColor:_.exports.string.isRequired}).isRequired,outline:_.exports.shape({stroke:_.exports.string.isRequired,strokeWidth:_.exports.number.isRequired,outlineWidth:_.exports.number.isRequired,outlineColor:_.exports.string.isRequired}).isRequired,symbol:_.exports.shape({fill:_.exports.string.isRequired,outlineWidth:_.exports.number.isRequired,outlineColor:_.exports.string.isRequired}).isRequired});_.exports.shape({background:_.exports.string.isRequired,fontFamily:_.exports.string.isRequired,fontSize:_.exports.number.isRequired,textColor:_.exports.string.isRequired,axis:Evt.isRequired,grid:Cvt.isRequired,legends:_vt.isRequired,labels:Tvt.isRequired,dots:Ovt.isRequired,markers:Avt,crosshair:xvt.isRequired,annotations:Ivt.isRequired});var Mvt={background:"transparent",fontFamily:"sans-serif",fontSize:11,textColor:"#333333",axis:{domain:{line:{stroke:"transparent",strokeWidth:1}},ticks:{line:{stroke:"#777777",strokeWidth:1},text:{}},legend:{text:{fontSize:12}}},grid:{line:{stroke:"#dddddd",strokeWidth:1}},legends:{hidden:{symbol:{fill:"#333333",opacity:.6},text:{fill:"#333333",opacity:.6}},text:{},ticks:{line:{stroke:"#777777",strokeWidth:1},text:{fontSize:10}},title:{text:{}}},labels:{text:{}},markers:{lineColor:"#000000",lineStrokeWidth:1,text:{}},dots:{text:{}},tooltip:{container:{background:"white",color:"inherit",fontSize:"inherit",borderRadius:"2px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.25)",padding:"5px 9px"},basic:{whiteSpace:"pre",display:"flex",alignItems:"center"},chip:{marginRight:7},table:{},tableCell:{padding:"3px 5px"},tableCellValue:{fontWeight:"bold"}},crosshair:{line:{stroke:"#000000",strokeWidth:1,strokeOpacity:.75,strokeDasharray:"6 6"}},annotations:{text:{fontSize:13,outlineWidth:2,outlineColor:"#ffffff",outlineOpacity:1},link:{stroke:"#000000",strokeWidth:1,outlineWidth:2,outlineColor:"#ffffff",outlineOpacity:1},outline:{fill:"none",stroke:"#000000",strokeWidth:2,outlineWidth:2,outlineColor:"#ffffff",outlineOpacity:1},symbol:{fill:"#000000",outlineWidth:2,outlineColor:"#ffffff",outlineOpacity:1}}},Nvt=["axis.ticks.text","axis.legend.text","legends.title.text","legends.text","legends.ticks.text","legends.title.text","labels.text","dots.text","markers.text","annotations.text"],Pvt=function(t,e){var r=Wdt({},t,e);return Nvt.forEach(function(n){Zi(r,n+".fontFamily")===void 0&&Nu(r,n+".fontFamily",r.fontFamily),Zi(r,n+".fontSize")===void 0&&Nu(r,n+".fontSize",r.fontSize),Zi(r,n+".fill")===void 0&&Nu(r,n+".fill",r.textColor)}),r},Sie=J.exports.createContext(),YM=function(t){var e=t.children,r=t.animate,n=t.stiffness,i=t.damping,o=t.config,a=J.exports.useMemo(function(){var s=xae(o)?gM[o]:o;return{animate:r,springConfig:{stiffness:n,damping:i},config:s}},[r,n,i,o]);return he.jsx(Sie.Provider,{value:a,children:e})},Xm={animate:_.exports.bool,motionStiffness:_.exports.number,motionDamping:_.exports.number,motionConfig:_.exports.oneOfType([_.exports.oneOf(Object.keys(gM)),_.exports.shape({mass:_.exports.number,tension:_.exports.number,friction:_.exports.number,clamp:_.exports.bool,precision:_.exports.number,velocity:_.exports.number,duration:_.exports.number,easing:_.exports.func})])};YM.propTypes={children:_.exports.node.isRequired,animate:Xm.animate,stiffness:Xm.motionStiffness,damping:Xm.motionDamping,config:Xm.motionConfig};var kvt={animate:!0,stiffness:90,damping:15,config:"default"};YM.defaultProps=kvt;var co=function(){return J.exports.useContext(Sie)},KM=function(t){var e=co(),r=e.animate,n=e.config,i=function(s){var l=J.exports.useRef();return J.exports.useEffect(function(){l.current=s},[s]),l.current}(t),o=J.exports.useMemo(function(){return fne(i,t)},[i,t]),a=Sa({from:{value:0},to:{value:1},reset:!0,config:n,immediate:!r}).value;return m4(a,o)},$vt={nivo:["#d76445","#f47560","#e8c1a0","#97e3d5","#61cdbb","#00b0a7"],BrBG:Qe(kR),PRGn:Qe($R),PiYG:Qe(LR),PuOr:Qe(DR),RdBu:Qe(FR),RdGy:Qe(HR),RdYlBu:Qe(BR),RdYlGn:Qe(UR),spectral:Qe(VR),blues:Qe(t5),greens:Qe(r5),greys:Qe(n5),oranges:Qe(a5),purples:Qe(i5),reds:Qe(o5),BuGn:Qe(jR),BuPu:Qe(WR),GnBu:Qe(zR),OrRd:Qe(GR),PuBuGn:Qe(YR),PuBu:Qe(KR),PuRd:Qe(qR),RdPu:Qe(XR),YlGnBu:Qe(QR),YlGn:Qe(ZR),YlOrBr:Qe(JR),YlOrRd:Qe(e5)},Lvt=Object.keys($vt);Qe(kR),Qe($R),Qe(LR),Qe(DR),Qe(FR),Qe(HR),Qe(BR),Qe(UR),Qe(VR),Qe(t5),Qe(r5),Qe(n5),Qe(a5),Qe(i5),Qe(o5),Qe(jR),Qe(WR),Qe(zR),Qe(GR),Qe(YR),Qe(KR),Qe(qR),Qe(XR),Qe(QR),Qe(ZR),Qe(JR),Qe(e5);_.exports.oneOfType([_.exports.oneOf(Lvt),_.exports.func,_.exports.arrayOf(_.exports.string)]);var M4={basis:Syt,basisClosed:Ryt,basisOpen:Eyt,bundle:Cyt,cardinal:_yt,cardinalClosed:Tyt,cardinalOpen:Oyt,catmullRom:Ayt,catmullRomClosed:xyt,catmullRomOpen:Iyt,linear:BM,linearClosed:Myt,monotoneX:Nyt,monotoneY:Pyt,natural:kyt,step:$yt,stepAfter:Dyt,stepBefore:Lyt},f5=Object.keys(M4);_.exports.oneOf(f5);f5.filter(function(t){return t.endsWith("Closed")});tie(f5,"bundle","basisClosed","basisOpen","cardinalClosed","cardinalOpen","catmullRomClosed","catmullRomOpen","linearClosed");var Dvt=tie(f5,"bundle","basisClosed","basisOpen","cardinalClosed","cardinalOpen","catmullRomClosed","catmullRomOpen","linearClosed"),Fvt=_.exports.oneOf(Dvt),Rie=function(t){if(!M4[t])throw new TypeError("'"+t+"', is not a valid curve interpolator identifier.");return M4[t]},Hvt={defs:_.exports.arrayOf(_.exports.shape({id:_.exports.string.isRequired})).isRequired,fill:_.exports.arrayOf(_.exports.shape({id:_.exports.string.isRequired,match:_.exports.oneOfType([_.exports.oneOf(["*"]),_.exports.object,_.exports.func]).isRequired})).isRequired},Bvt={ascending:yie,descending:zyt,insideOut:Gyt,none:Ap,reverse:Yyt},Uvt=Object.keys(Bvt);_.exports.oneOf(Uvt);var Vvt={expand:Byt,diverging:gie,none:Op,silhouette:Uyt,wiggle:Vyt},jvt=Object.keys(Vvt);_.exports.oneOf(jvt);_.exports.shape({top:_.exports.number,right:_.exports.number,bottom:_.exports.number,left:_.exports.number}).isRequired;var Wvt=["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],qM=_.exports.oneOf(Wvt);Pu(FM);var zvt={top:0,right:0,bottom:0,left:0},h5=function(t,e,r){return r===void 0&&(r={}),J.exports.useMemo(function(){var n=sn({},zvt,r);return{margin:n,innerWidth:t-n.left-n.right,innerHeight:e-n.top-n.bottom,outerWidth:t,outerHeight:e}},[t,e,r.top,r.right,r.bottom,r.left])},Eie=function(){var t=J.exports.useRef(null),e=J.exports.useState({left:0,top:0,width:0,height:0}),r=e[0],n=e[1],i=J.exports.useState(function(){return typeof window<"u"?new ResizeObserver(function(o){var a=o[0];return n(a.contentRect)}):null})[0];return J.exports.useEffect(function(){return t.current&&i!==null&&i.observe(t.current),function(){i!==null&&i.disconnect()}},[]),[t,r]},Gvt=function(t){return J.exports.useMemo(function(){return Pvt(Mvt,t)},[t])},Yvt=function(t){return typeof t=="function"?t:typeof t=="string"?t.indexOf("time:")===0?PR(t.slice("5")):c5(t):function(e){return""+e}},jS=function(t){return J.exports.useMemo(function(){return Yvt(t)},[t])},Cie=J.exports.createContext(),Kvt={},_ie=function(t){var e=t.theme,r=e===void 0?Kvt:e,n=t.children,i=Gvt(r);return he.jsx(Cie.Provider,{value:i,children:n})};_ie.propTypes={children:_.exports.node.isRequired,theme:_.exports.object};var pr=function(){return J.exports.useContext(Cie)},Tie=function(t){var e=t.children,r=t.condition,n=t.wrapper;return r?J.exports.cloneElement(n,{},e):e};Tie.propTypes={children:_.exports.node.isRequired,condition:_.exports.bool.isRequired,wrapper:_.exports.element.isRequired};var qvt={position:"relative"},d5=function(t){var e=t.children,r=t.theme,n=t.renderWrapper,i=n===void 0||n,o=t.isInteractive,a=o===void 0||o,s=t.animate,l=t.motionStiffness,u=t.motionDamping,c=t.motionConfig,f=J.exports.useRef(null);return he.jsx(_ie,{theme:r,children:he.jsx(YM,{animate:s,stiffness:l,damping:u,config:c,children:he.jsx(mht,{container:f,children:he.jsxs(Tie,{condition:i,wrapper:he.jsx("div",{style:qvt,ref:f}),children:[e,a&&he.jsx(pht,{})]})})})})};d5.propTypes={children:_.exports.element.isRequired,isInteractive:_.exports.bool,renderWrapper:_.exports.bool,theme:_.exports.object,animate:_.exports.bool,motionStiffness:_.exports.number,motionDamping:_.exports.number,motionConfig:_.exports.string};_.exports.func.isRequired,_.exports.bool,_.exports.bool,_.exports.object.isRequired,_.exports.bool.isRequired,_.exports.number,_.exports.number,_.exports.string;var t0=function(t){var e=t.children,r=Eie(),n=r[0],i=r[1],o=i.width>0&&i.height>0;return he.jsx("div",{ref:n,style:{width:"100%",height:"100%"},children:o&&e({width:i.width,height:i.height})})};t0.propTypes={children:_.exports.func.isRequired};var Xvt=["id","colors"],Oie=function(t){var e=t.id,r=t.colors,n=GM(t,Xvt);return he.jsx("linearGradient",sn({id:e,x1:0,x2:0,y1:0,y2:1},n,{children:r.map(function(i){var o=i.offset,a=i.color,s=i.opacity;return he.jsx("stop",{offset:o+"%",stopColor:a,stopOpacity:s!==void 0?s:1},o)})}))};Oie.propTypes={id:_.exports.string.isRequired,colors:_.exports.arrayOf(_.exports.shape({offset:_.exports.number.isRequired,color:_.exports.string.isRequired,opacity:_.exports.number})).isRequired,gradientTransform:_.exports.string};var Aie={linearGradient:Oie},F2=J.exports.memo(function(t){var e=t.id,r=t.background,n=t.color,i=t.size,o=t.padding,a=t.stagger,s=i+o,l=i/2,u=o/2;return a===!0&&(s=2*i+2*o),he.jsxs("pattern",{id:e,width:s,height:s,patternUnits:"userSpaceOnUse",children:[he.jsx("rect",{width:s,height:s,fill:r}),he.jsx("circle",{cx:u+l,cy:u+l,r:l,fill:n}),a&&he.jsx("circle",{cx:1.5*o+i+l,cy:1.5*o+i+l,r:l,fill:n})]})});F2.displayName="PatternDots",F2.propTypes={id:_.exports.string.isRequired,color:_.exports.string.isRequired,background:_.exports.string.isRequired,size:_.exports.number.isRequired,padding:_.exports.number.isRequired,stagger:_.exports.bool.isRequired},F2.defaultProps={color:"#000000",background:"#ffffff",size:4,padding:4,stagger:!1};var Jv=function(t){return t*Math.PI/180},Qvt=function(t){return 180*t/Math.PI},Zvt=function(t,e){return{x:Math.cos(t)*e,y:Math.sin(t)*e}},Jvt=function(t){var e=t%360;return e<0&&(e+=360),e},e1t={svg:{align:{left:"start",center:"middle",right:"end",start:"start",middle:"middle",end:"end"},baseline:{top:"text-before-edge",center:"central",bottom:"alphabetic"}},canvas:{align:{left:"left",center:"center",right:"right",start:"left",middle:"center",end:"right"},baseline:{top:"top",center:"middle",bottom:"bottom"}}},H2=J.exports.memo(function(t){var e=t.id,r=t.spacing,n=t.rotation,i=t.background,o=t.color,a=t.lineWidth,s=Math.round(n)%360,l=Math.abs(r);s>180?s-=360:s>90?s-=180:s<-180?s+=360:s<-90&&(s+=180);var u,c=l,f=l;return s===0?u=`
                M 0 0 L `+c+` 0
                M 0 `+f+" L "+c+" "+f+`
            `:s===90?u=`
                M 0 0 L 0 `+f+`
                M `+c+" 0 L "+c+" "+f+`
            `:(c=Math.abs(l/Math.sin(Jv(s))),f=l/Math.sin(Jv(90-s)),u=s>0?`
                    M 0 `+-f+" L "+2*c+" "+f+`
                    M `+-c+" "+-f+" L "+c+" "+f+`
                    M `+-c+" 0 L "+c+" "+2*f+`
                `:`
                    M `+-c+" "+f+" L "+c+" "+-f+`
                    M `+-c+" "+2*f+" L "+2*c+" "+-f+`
                    M 0 `+2*f+" L "+2*c+` 0
                `),he.jsxs("pattern",{id:e,width:c,height:f,patternUnits:"userSpaceOnUse",children:[he.jsx("rect",{width:c,height:f,fill:i,stroke:"rgba(255, 0, 0, 0.1)",strokeWidth:0}),he.jsx("path",{d:u,strokeWidth:a,stroke:o,strokeLinecap:"square"})]})});H2.displayName="PatternLines",H2.propTypes={id:_.exports.string.isRequired,spacing:_.exports.number.isRequired,rotation:_.exports.number.isRequired,background:_.exports.string.isRequired,color:_.exports.string.isRequired,lineWidth:_.exports.number.isRequired},H2.defaultProps={spacing:5,rotation:0,color:"#000000",background:"#ffffff",lineWidth:2};var B2=J.exports.memo(function(t){var e=t.id,r=t.background,n=t.color,i=t.size,o=t.padding,a=t.stagger,s=i+o,l=o/2;return a===!0&&(s=2*i+2*o),he.jsxs("pattern",{id:e,width:s,height:s,patternUnits:"userSpaceOnUse",children:[he.jsx("rect",{width:s,height:s,fill:r}),he.jsx("rect",{x:l,y:l,width:i,height:i,fill:n}),a&&he.jsx("rect",{x:1.5*o+i,y:1.5*o+i,width:i,height:i,fill:n})]})});B2.displayName="PatternSquares",B2.propTypes={id:_.exports.string.isRequired,color:_.exports.string.isRequired,background:_.exports.string.isRequired,size:_.exports.number.isRequired,padding:_.exports.number.isRequired,stagger:_.exports.bool.isRequired},B2.defaultProps={color:"#000000",background:"#ffffff",size:4,padding:4,stagger:!1};var xie={patternDots:F2,patternLines:H2,patternSquares:B2},t1t=["type"],N4=sn({},Aie,xie),Iie=function(t){var e=t.defs;return!e||e.length<1?null:he.jsx("defs",{"aria-hidden":!0,children:e.map(function(r){var n=r.type,i=GM(r,t1t);return N4[n]?J.exports.createElement(N4[n],sn({key:i.id},i)):null})})};Iie.propTypes={defs:_.exports.arrayOf(_.exports.shape({type:_.exports.oneOf(Object.keys(N4)).isRequired,id:_.exports.string.isRequired}))};var r1t=J.exports.memo(Iie),XM=function(t){var e=t.width,r=t.height,n=t.margin,i=t.defs,o=t.children,a=t.role,s=t.ariaLabel,l=t.ariaLabelledBy,u=t.ariaDescribedBy,c=t.isFocusable,f=pr();return he.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:r,role:a,"aria-label":s,"aria-labelledby":l,"aria-describedby":u,focusable:c,tabIndex:c?0:void 0,children:[he.jsx(r1t,{defs:i}),he.jsx("rect",{width:e,height:r,fill:f.background}),he.jsx("g",{transform:"translate("+n.left+","+n.top+")",children:o})]})};XM.propTypes={width:_.exports.number.isRequired,height:_.exports.number.isRequired,margin:_.exports.shape({top:_.exports.number.isRequired,left:_.exports.number.isRequired}).isRequired,defs:_.exports.array,children:_.exports.oneOfType([_.exports.arrayOf(_.exports.node),_.exports.node]).isRequired,role:_.exports.string,isFocusable:_.exports.bool,ariaLabel:_.exports.string,ariaLabelledBy:_.exports.string,ariaDescribedBy:_.exports.string};var Mie=function(t){var e=t.size,r=t.color,n=t.borderWidth,i=t.borderColor;return he.jsx("circle",{r:e/2,fill:r,stroke:i,strokeWidth:n,style:{pointerEvents:"none"}})};Mie.propTypes={size:_.exports.number.isRequired,color:_.exports.string.isRequired,borderWidth:_.exports.number.isRequired,borderColor:_.exports.string.isRequired};var n1t=J.exports.memo(Mie),Nie=function(t){var e=t.x,r=t.y,n=t.symbol,i=n===void 0?n1t:n,o=t.size,a=t.datum,s=t.color,l=t.borderWidth,u=t.borderColor,c=t.label,f=t.labelTextAnchor,h=f===void 0?"middle":f,d=t.labelYOffset,p=d===void 0?-12:d,m=pr(),g=co(),v=g.animate,S=g.config,b=Sa({transform:"translate("+e+", "+r+")",config:S,immediate:!v});return he.jsxs(kr.g,{transform:b.transform,style:{pointerEvents:"none"},children:[J.exports.createElement(i,{size:o,color:s,datum:a,borderWidth:l,borderColor:u}),c&&he.jsx("text",{textAnchor:h,y:p,style:m.dots.text,children:c})]})};Nie.propTypes={x:_.exports.number.isRequired,y:_.exports.number.isRequired,datum:_.exports.object.isRequired,size:_.exports.number.isRequired,color:_.exports.string.isRequired,borderWidth:_.exports.number.isRequired,borderColor:_.exports.string.isRequired,symbol:_.exports.oneOfType([_.exports.func,_.exports.object]),label:_.exports.oneOfType([_.exports.string,_.exports.number]),labelTextAnchor:_.exports.oneOf(["start","middle","end"]),labelYOffset:_.exports.number};var i1t=J.exports.memo(Nie),P4=function(t){var e=t.width,r=t.height,n=t.axis,i=t.scale,o=t.value,a=t.lineStyle,s=t.textStyle,l=t.legend,u=t.legendPosition,c=t.legendOffsetX,f=t.legendOffsetY,h=t.legendOrientation,d=pr(),p=0,m=0,g=0,v=0;n==="y"?(g=i(o),m=e):(p=i(o),v=r);var S=null;if(l){var b=function(E){var T=E.axis,N=E.width,L=E.height,V=E.position,B=E.offsetX,k=E.offsetY,M=E.orientation,G=0,j=0,q=M==="vertical"?-90:0,te="start";if(T==="x")switch(V){case"top-left":G=-B,j=k,te="end";break;case"top":j=-k,te=M==="horizontal"?"middle":"start";break;case"top-right":G=B,j=k,te=M==="horizontal"?"start":"end";break;case"right":G=B,j=L/2,te=M==="horizontal"?"start":"middle";break;case"bottom-right":G=B,j=L-k,te="start";break;case"bottom":j=L+k,te=M==="horizontal"?"middle":"end";break;case"bottom-left":j=L-k,G=-B,te=M==="horizontal"?"end":"start";break;case"left":G=-B,j=L/2,te=M==="horizontal"?"end":"middle"}else switch(V){case"top-left":G=B,j=-k,te="start";break;case"top":G=N/2,j=-k,te=M==="horizontal"?"middle":"start";break;case"top-right":G=N-B,j=-k,te=M==="horizontal"?"end":"start";break;case"right":G=N+B,te=M==="horizontal"?"start":"middle";break;case"bottom-right":G=N-B,j=k,te="end";break;case"bottom":G=N/2,j=k,te=M==="horizontal"?"middle":"end";break;case"bottom-left":G=B,j=k,te=M==="horizontal"?"start":"end";break;case"left":G=-B,te=M==="horizontal"?"end":"middle"}return{x:G,y:j,rotation:q,textAnchor:te}}({axis:n,width:e,height:r,position:u,offsetX:c,offsetY:f,orientation:h});S=he.jsx("text",{transform:"translate("+b.x+", "+b.y+") rotate("+b.rotation+")",textAnchor:b.textAnchor,dominantBaseline:"central",style:s,children:l})}return he.jsxs("g",{transform:"translate("+p+", "+g+")",children:[he.jsx("line",{x1:0,x2:m,y1:0,y2:v,stroke:d.markers.lineColor,strokeWidth:d.markers.lineStrokeWidth,style:a}),S]})};P4.propTypes={width:_.exports.number.isRequired,height:_.exports.number.isRequired,axis:_.exports.oneOf(["x","y"]).isRequired,scale:_.exports.func.isRequired,value:_.exports.oneOfType([_.exports.number,_.exports.string,_.exports.instanceOf(Date)]).isRequired,lineStyle:_.exports.object,textStyle:_.exports.object,legend:_.exports.string,legendPosition:_.exports.oneOf(["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"]),legendOffsetX:_.exports.number.isRequired,legendOffsetY:_.exports.number.isRequired,legendOrientation:_.exports.oneOf(["horizontal","vertical"]).isRequired},P4.defaultProps={legendPosition:"top-right",legendOffsetX:14,legendOffsetY:14,legendOrientation:"horizontal"};var o1t=J.exports.memo(P4),Pie=function(t){var e=t.markers,r=t.width,n=t.height,i=t.xScale,o=t.yScale;return e&&e.length!==0?e.map(function(a,s){return he.jsx(o1t,sn({},a,{width:r,height:n,scale:a.axis==="y"?o:i}),s)}):null};Pie.propTypes={width:_.exports.number.isRequired,height:_.exports.number.isRequired,xScale:_.exports.func.isRequired,yScale:_.exports.func.isRequired,markers:_.exports.arrayOf(_.exports.shape({axis:_.exports.oneOf(["x","y"]).isRequired,value:_.exports.oneOfType([_.exports.number,_.exports.string,_.exports.instanceOf(Date)]).isRequired,lineStyle:_.exports.object,textStyle:_.exports.object}))};var kie=J.exports.memo(Pie),a1t=["theme","renderWrapper","animate","motionStiffness","motionDamping","motionConfig"],$ie=function(t){return function(e){var r,n;function i(){return e.apply(this,arguments)||this}return n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,I4(r,n),i.prototype.render=function(){var o=this.props,a=o.theme,s=o.renderWrapper,l=o.animate,u=o.motionStiffness,c=o.motionDamping,f=o.motionConfig,h=GM(o,a1t);return he.jsx(d5,{theme:a,renderWrapper:s,isInteractive:h.isInteractive,animate:l,motionStiffness:u,motionDamping:c,motionConfig:f,children:he.jsx(t,sn({},h))})},i}(J.exports.Component)},s1t=function(t,e){var r,n=Cg(t)?t:function(i){return Zi(i,t)};return e&&(r=Cg(e)?e:c5(e)),r?function(i){return r(n(i))}:n},Lie=function(t){return Cg(t)?t:function(e){return Zi(e,t)}},C_=function(t){return J.exports.useMemo(function(){return Lie(t)},[t])},Die=function(t,e,r,n,i,o){return t<=i&&i<=t+r&&e<=o&&o<=e+n},Eg=function(t,e){var r=e.clientX,n=e.clientY,i=t.getBoundingClientRect(),o=t.getBBox(),a=o.width===i.width?1:o.width/i.width;return[(r-i.left)*a,(n-i.top)*a]},l1t=Object.keys(Aie),u1t=Object.keys(xie),c1t=function(t,e,r){if(t==="*")return!0;if(Cg(t))return t(e);if(J1(t)){var n=r?Zi(e,r):e;return Iae(Rvt(n,Object.keys(t)),t)}return!1},Fie=function(t,e,r,n){var i=n===void 0?{}:n,o=i.dataKey,a=i.colorKey,s=a===void 0?"color":a,l=i.targetKey,u=l===void 0?"fill":l,c=[],f={};return t.length&&e.length&&(c=[].concat(t),e.forEach(function(h){for(var d=function(m){var g=r[m],v=g.id,S=g.match;if(c1t(S,h,o)){var b=t.find(function(M){return M.id===v});if(b){if(u1t.includes(b.type))if(b.background==="inherit"||b.color==="inherit"){var E=Zi(h,s),T=b.background,N=b.color,L=v;b.background==="inherit"&&(L=L+".bg."+E,T=E),b.color==="inherit"&&(L=L+".fg."+E,N=E),Nu(h,u,"url(#"+L+")"),f[L]||(c.push(sn({},b,{id:L,background:T,color:N})),f[L]=1)}else Nu(h,u,"url(#"+v+")");else if(l1t.includes(b.type))if(b.colors.map(function(M){return M.color}).includes("inherit")){var V=Zi(h,s),B=v,k=sn({},b,{colors:b.colors.map(function(M,G){return M.color!=="inherit"?M:(B=B+"."+G+"."+V,sn({},M,{color:M.color==="inherit"?V:M.color}))})});k.id=B,Nu(h,u,"url(#"+B+")"),f[B]||(c.push(k),f[B]=1)}else Nu(h,u,"url(#"+v+")")}return"break"}},p=0;p<r.length&&d(p)!=="break";p++);})),c};function WS(){return WS=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},WS.apply(this,arguments)}function QW(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function f1t(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=function(i,o){if(i){if(typeof i=="string")return QW(i,o);var a=Object.prototype.toString.call(i).slice(8,-1);return a==="Object"&&i.constructor&&(a=i.constructor.name),a==="Map"||a==="Set"?Array.from(i):a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?QW(i,o):void 0}}(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Hie={nivo:["#e8c1a0","#f47560","#f1e15b","#e8a838","#61cdbb","#97e3d5"],category10:Yne,accent:Kne,dark2:qne,paired:Xne,pastel1:Qne,pastel2:Zne,set1:Jne,set2:eie,set3:FM},h1t=Object.keys(Hie),Bie={brown_blueGreen:kR,purpleRed_green:$R,pink_yellowGreen:LR,purple_orange:DR,red_blue:FR,red_grey:HR,red_yellow_blue:BR,red_yellow_green:UR,spectral:VR},d1t=Object.keys(Bie),p1t={brown_blueGreen:wgt,purpleRed_green:Sgt,pink_yellowGreen:Rgt,purple_orange:Egt,red_blue:Cgt,red_grey:_gt,red_yellow_blue:Tgt,red_yellow_green:Ogt,spectral:Agt},Uie={blues:t5,greens:r5,greys:n5,oranges:a5,purples:i5,reds:o5,blue_green:jR,blue_purple:WR,green_blue:zR,orange_red:GR,purple_blue_green:YR,purple_blue:KR,purple_red:qR,red_purple:XR,yellow_green_blue:QR,yellow_green:ZR,yellow_orange_brown:JR,yellow_orange_red:e5},m1t=Object.keys(Uie),g1t={blues:Ugt,greens:Vgt,greys:jgt,oranges:Ggt,purples:Wgt,reds:zgt,turbo:tyt,viridis:ryt,inferno:iyt,magma:nyt,plasma:oyt,cividis:Ygt,warm:qgt,cool:Xgt,cubehelixDefault:Kgt,blue_green:xgt,blue_purple:Igt,green_blue:Mgt,orange_red:Ngt,purple_blue_green:Pgt,purple_blue:kgt,purple_red:$gt,red_purple:Lgt,yellow_green_blue:Dgt,yellow_green:Fgt,yellow_orange_brown:Hgt,yellow_orange_red:Bgt},U2=WS({},Hie,Bie,Uie),y1t=Object.keys(U2),v1t=function(t){return h1t.includes(t)},b1t=function(t){return d1t.includes(t)},w1t=function(t){return m1t.includes(t)},S1t={rainbow:Qgt,sinebow:eyt};WS({},p1t,g1t,S1t);var R1t=function(t,e){if(typeof t=="function")return t;if(J1(t)){if(function(l){return l.theme!==void 0}(t)){if(e===void 0)throw new Error("Unable to use color from theme as no theme was provided");var r=Zi(e,t.theme);if(r===void 0)throw new Error("Color from theme is undefined at path: '"+t.theme+"'");return function(){return r}}if(function(l){return l.from!==void 0}(t)){var n=function(l){return Zi(l,t.from)};if(Array.isArray(t.modifiers)){for(var i,o=[],a=function(){var l=i.value,u=l[0],c=l[1];if(u==="brighter")o.push(function(f){return f.brighter(c)});else if(u==="darker")o.push(function(f){return f.darker(c)});else{if(u!=="opacity")throw new Error("Invalid color modifier: '"+u+"', must be one of: 'brighter', 'darker', 'opacity'");o.push(function(f){return f.opacity=c,f})}},s=f1t(t.modifiers);!(i=s()).done;)a();return o.length===0?n:function(l){return o.reduce(function(u,c){return c(u)},Ep(n(l))).toString()}}return n}throw new Error("Invalid color spec, you should either specify 'theme' or 'from' when using a config object")}return function(){return t}},xp=function(t,e){return J.exports.useMemo(function(){return R1t(t,e)},[t,e])},E1t=_.exports.oneOfType([_.exports.func,_.exports.arrayOf(_.exports.string),_.exports.shape({scheme:_.exports.oneOf(y1t).isRequired,size:_.exports.number}),_.exports.shape({datum:_.exports.string.isRequired}),_.exports.string]);_.exports.oneOfType([_.exports.string,_.exports.func,_.exports.shape({theme:_.exports.string.isRequired}),_.exports.shape({from:_.exports.string.isRequired,modifiers:_.exports.arrayOf(_.exports.array)})]);var C1t=function(t,e){if(typeof t=="function")return t;var r=typeof e=="function"?e:function(f){return Zi(f,e)};if(Array.isArray(t)){var n=Pu(t),i=function(f){return n(r(f))};return i.scale=n,i}if(J1(t)){if(function(f){return f.datum!==void 0}(t))return function(f){return Zi(f,t.datum)};if(function(f){return f.scheme!==void 0}(t)){if(v1t(t.scheme)){var o=Pu(U2[t.scheme]),a=function(f){return o(r(f))};return a.scale=o,a}if(b1t(t.scheme)){if(t.size!==void 0&&(t.size<3||t.size>11))throw new Error("Invalid size '"+t.size+"' for diverging color scheme '"+t.scheme+"', must be between 3~11");var s=Pu(U2[t.scheme][t.size||11]),l=function(f){return s(r(f))};return l.scale=s,l}if(w1t(t.scheme)){if(t.size!==void 0&&(t.size<3||t.size>9))throw new Error("Invalid size '"+t.size+"' for sequential color scheme '"+t.scheme+"', must be between 3~9");var u=Pu(U2[t.scheme][t.size||9]),c=function(f){return u(r(f))};return c.scale=u,c}}throw new Error("Invalid colors, when using an object, you should either pass a 'datum' or a 'scheme' property")}return function(){return t}},Vie=function(t,e){return J.exports.useMemo(function(){return C1t(t,e)},[t,e])},_1t=Mae;function T1t(t){return t&&t.length?_1t(t):[]}var ZW=T1t,O1t=Gz,A1t=i1,x1t="[object Date]";function I1t(t){return A1t(t)&&O1t(t)==x1t}var M1t=I1t,N1t=M1t,P1t=JS,JW=z4.exports,ez=JW&&JW.isDate,k1t=ez?P1t(ez):N1t,$1t=k1t,__=new Date,T_=new Date;function wn(t,e,r,n){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=function(o){return t(o=new Date(+o)),o},i.ceil=function(o){return t(o=new Date(o-1)),e(o,1),t(o),o},i.round=function(o){var a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=function(o,a){return e(o=new Date(+o),a==null?1:Math.floor(a)),o},i.range=function(o,a,s){var l=[],u;if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return l;do l.push(u=new Date(+o)),e(o,s),t(o);while(u<o&&o<a);return l},i.filter=function(o){return wn(function(a){if(a>=a)for(;t(a),!o(a);)a.setTime(a-1)},function(a,s){if(a>=a)if(s<0)for(;++s<=0;)for(;e(a,-1),!o(a););else for(;--s>=0;)for(;e(a,1),!o(a););})},r&&(i.count=function(o,a){return __.setTime(+o),T_.setTime(+a),t(__),t(T_),Math.floor(r(__,T_))},i.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(n?function(a){return n(a)%o===0}:function(a){return i.count(0,a)%o===0}):i}),i}var zS=wn(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});zS.every=function(t){return t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?wn(function(e){e.setTime(Math.floor(e/t)*t)},function(e,r){e.setTime(+e+r*t)},function(e,r){return(r-e)/t}):zS};const tz=zS;zS.range;var GS=1e3,Ip=6e4,YS=36e5,jie=6048e5,Wie=wn(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+e*GS)},function(t,e){return(e-t)/GS},function(t){return t.getUTCSeconds()});const rz=Wie;Wie.range;var zie=wn(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*GS)},function(t,e){t.setTime(+t+e*Ip)},function(t,e){return(e-t)/Ip},function(t){return t.getMinutes()});const L1t=zie;zie.range;var Gie=wn(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*GS-t.getMinutes()*Ip)},function(t,e){t.setTime(+t+e*YS)},function(t,e){return(e-t)/YS},function(t){return t.getHours()});const D1t=Gie;Gie.range;function Nc(t){return wn(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,r){e.setDate(e.getDate()+r*7)},function(e,r){return(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Ip)/jie})}var k4=Nc(0),Yie=Nc(1),Kie=Nc(2),qie=Nc(3),Xie=Nc(4),Qie=Nc(5),Zie=Nc(6);k4.range;Yie.range;Kie.range;qie.range;Xie.range;Qie.range;Zie.range;var Jie=wn(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12},function(t){return t.getMonth()});const F1t=Jie;Jie.range;var QM=wn(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});QM.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:wn(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,r){e.setFullYear(e.getFullYear()+r*t)})};const H1t=QM;QM.range;var eoe=wn(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*Ip)},function(t,e){return(e-t)/Ip},function(t){return t.getUTCMinutes()});const B1t=eoe;eoe.range;var toe=wn(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*YS)},function(t,e){return(e-t)/YS},function(t){return t.getUTCHours()});const U1t=toe;toe.range;function Pc(t){return wn(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCDate(e.getUTCDate()+r*7)},function(e,r){return(r-e)/jie})}var $4=Pc(0),roe=Pc(1),noe=Pc(2),ioe=Pc(3),ooe=Pc(4),aoe=Pc(5),soe=Pc(6);$4.range;roe.range;noe.range;ioe.range;ooe.range;aoe.range;soe.range;var loe=wn(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12},function(t){return t.getUTCMonth()});const V1t=loe;loe.range;var ZM=wn(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});ZM.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:wn(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,r){e.setUTCFullYear(e.getUTCFullYear()+r*t)})};const j1t=ZM;ZM.range;function nu(){return nu=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},nu.apply(this,arguments)}var vf=[function(t){return t.setMilliseconds(0)},function(t){return t.setSeconds(0)},function(t){return t.setMinutes(0)},function(t){return t.setHours(0)},function(t){return t.setDate(1)},function(t){return t.setMonth(0)}],W1t={millisecond:[],second:vf.slice(0,1),minute:vf.slice(0,2),hour:vf.slice(0,3),day:vf.slice(0,4),month:vf.slice(0,5),year:vf.slice(0,6)},z1t=function(t){return function(e){return W1t[t].forEach(function(r){r(e)}),e}},uoe=function(t){var e=t.format,r=e===void 0?"native":e,n=t.precision,i=n===void 0?"millisecond":n,o=t.useUTC,a=o===void 0||o,s=z1t(i);return function(l){if(l===void 0)return l;if(r==="native"||l instanceof Date)return s(l);var u=a?Gne(r):Wne(r);return s(u(l))}},G1t=function(t,e,r,n){var i,o,a,s,l=t.min,u=l===void 0?0:l,c=t.max,f=c===void 0?"auto":c,h=t.stacked,d=h!==void 0&&h,p=t.reverse,m=p!==void 0&&p,g=t.clamp,v=g!==void 0&&g,S=t.nice,b=S!==void 0&&S;u==="auto"?i=d===!0?(o=e.minStacked)!=null?o:0:e.min:i=u,f==="auto"?a=d===!0?(s=e.maxStacked)!=null?s:0:e.max:a=f;var E=wne().rangeRound(n==="x"?[0,r]:[r,0]).domain(m?[a,i]:[i,a]).clamp(v);return b===!0?E.nice():typeof b=="number"&&E.nice(b),Y1t(E,d)},Y1t=function(t,e){e===void 0&&(e=!1);var r=t;return r.type="linear",r.stacked=e,r},K1t=function(t,e,r){var n=Mpt().range([0,r]).domain(e.all);return n.type="point",n},q1t=function(t,e,r,n){var i=t.round,o=i===void 0||i,a=IM().range(n==="x"?[0,r]:[r,0]).domain(e.all).round(o);return X1t(a)},X1t=function(t){var e=t;return e.type="band",e},Q1t=function(t,e,r){var n,i,o=t.format,a=o===void 0?"native":o,s=t.precision,l=s===void 0?"millisecond":s,u=t.min,c=u===void 0?"auto":u,f=t.max,h=f===void 0?"auto":f,d=t.useUTC,p=d===void 0||d,m=t.nice,g=m!==void 0&&m,v=uoe({format:a,precision:l,useUTC:p});n=c==="auto"?v(e.min):a!=="native"?v(c):c,i=h==="auto"?v(e.max):a!=="native"?v(h):h;var S=p?bgt():vgt();S.range([0,r]),n&&i&&S.domain([n,i]),g===!0?S.nice():typeof g!="object"&&typeof g!="number"||S.nice(g);var b=S;return b.type="time",b.useUTC=p,b},Z1t=function(t,e,r,n){var i,o=t.base,a=o===void 0?10:o,s=t.min,l=s===void 0?"auto":s,u=t.max,c=u===void 0?"auto":u;if(e.all.some(function(m){return m===0}))throw new Error("a log scale domain must not include or cross zero");var f,h,d=!1;if(e.all.filter(function(m){return m!=null}).forEach(function(m){d||(i===void 0?i=Math.sign(m):Math.sign(m)!==i&&(d=!0))}),d)throw new Error("a log scale domain must be strictly-positive or strictly-negative");f=l==="auto"?e.min:l,h=c==="auto"?e.max:c;var p=Rne().domain([f,h]).rangeRound(n==="x"?[0,r]:[r,0]).base(a).nice();return p.type="log",p},J1t=function(t,e,r,n){var i,o,a=t.constant,s=a===void 0?1:a,l=t.min,u=l===void 0?"auto":l,c=t.max,f=c===void 0?"auto":c,h=t.reverse,d=h!==void 0&&h;i=u==="auto"?e.min:u,o=f==="auto"?e.max:f;var p=Ene().constant(s).rangeRound(n==="x"?[0,r]:[r,0]).nice();d===!0?p.domain([o,i]):p.domain([i,o]);var m=p;return m.type="symlog",m},e0t=function(t){return t==="x"?"y":"x"},t0t=function(t,e){return t===e},r0t=function(t,e){return t.getTime()===e.getTime()};function e1(t,e,r,n){switch(t.type){case"linear":return G1t(t,e,r,n);case"point":return K1t(0,e,r);case"band":return q1t(t,e,r,n);case"time":return Q1t(t,e,r);case"log":return Z1t(t,e,r,n);case"symlog":return J1t(t,e,r,n);default:throw new Error("invalid scale spec")}}var nz=function(t,e,r){var n;if("stacked"in r&&r.stacked){var i=t.data[e==="x"?"xStacked":"yStacked"];return i==null?null:r(i)}return(n=r(t.data[e]))!=null?n:null},n0t=function(t,e,r,n,i){var o=t.map(function(c){return function(f){return nu({},f,{data:f.data.map(function(h){return{data:nu({},h)}})})}(c)}),a=i0t(o,e,r);"stacked"in e&&e.stacked===!0&&o0t(a,o),"stacked"in r&&r.stacked===!0&&a0t(a,o);var s=e1(e,a.x,n,"x"),l=e1(r,a.y,i,"y"),u=o.map(function(c){return nu({},c,{data:c.data.map(function(f){return nu({},f,{position:{x:nz(f,"x",s),y:nz(f,"y",l)}})})})});return nu({},a,{series:u,xScale:s,yScale:l})},i0t=function(t,e,r){return{x:iz(t,"x",e),y:iz(t,"y",r)}},iz=function(t,e,r,n){var i=n===void 0?{}:n,o=i.getValue,a=o===void 0?function(p){return p.data[e]}:o,s=i.setValue,l=s===void 0?function(p,m){p.data[e]=m}:s;if(r.type==="linear")t.forEach(function(p){p.data.forEach(function(m){var g=a(m);g&&l(m,parseFloat(String(g)))})});else if(r.type==="time"&&r.format!=="native"){var u=uoe(r);t.forEach(function(p){p.data.forEach(function(m){var g=a(m);g&&l(m,u(g))})})}var c=[];switch(t.forEach(function(p){p.data.forEach(function(m){c.push(a(m))})}),r.type){case"linear":var f=Nae(ZW(c).filter(function(p){return p!==null}),function(p){return p});return{all:f,min:Math.min.apply(Math,f),max:Math.max.apply(Math,f)};case"time":var h=P_(c,function(p){return p.getTime()}).slice(0).sort(function(p,m){return m.getTime()-p.getTime()}).reverse();return{all:h,min:h[0],max:Qe(h)};default:var d=ZW(c);return{all:d,min:d[0],max:Qe(d)}}},coe=function(t,e,r){var n=e0t(t),i=[];e[n].all.forEach(function(o){var a=$1t(o)?r0t:t0t,s=[];r.forEach(function(l){var u=l.data.find(function(d){return a(d.data[n],o)}),c=null,f=null;if(u!==void 0){if((c=u.data[t])!==null){var h=Qe(s);h===void 0?f=c:h!==null&&(f=h+c)}u.data[t==="x"?"xStacked":"yStacked"]=f}s.push(f),f!==null&&i.push(f)})}),e[t].minStacked=Math.min.apply(Math,i),e[t].maxStacked=Math.max.apply(Math,i)},o0t=function(t,e){return coe("x",t,e)},a0t=function(t,e){return coe("y",t,e)},foe=function(t){var e=t.bandwidth();if(e===0)return t;var r=e/2;return t.round()&&(r=Math.round(r)),function(n){var i;return((i=t(n))!=null?i:0)+r}},hoe={millisecond:[tz,tz],second:[rz,rz],minute:[L1t,B1t],hour:[D1t,U1t],day:[wn(function(t){return t.setHours(0,0,0,0)},function(t,e){return t.setDate(t.getDate()+e)},function(t,e){return(e.getTime()-t.getTime())/864e5},function(t){return Math.floor(t.getTime()/864e5)}),wn(function(t){return t.setUTCHours(0,0,0,0)},function(t,e){return t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e.getTime()-t.getTime())/864e5},function(t){return Math.floor(t.getTime()/864e5)})],week:[k4,$4],sunday:[k4,$4],monday:[Yie,roe],tuesday:[Kie,noe],wednesday:[qie,ioe],thursday:[Xie,ooe],friday:[Qie,aoe],saturday:[Zie,soe],month:[F1t,V1t],year:[H1t,j1t]},s0t=Object.keys(hoe),l0t=new RegExp("^every\\s*(\\d+)?\\s*("+s0t.join("|")+")s?$","i"),doe=function(t,e){if(Array.isArray(e))return e;if(typeof e=="string"&&"useUTC"in t){var r=e.match(l0t);if(r){var n=r[1],i=r[2],o=hoe[i][t.useUTC?1:0];if(i==="day"){var a,s,l=t.domain(),u=l[0],c=l[1],f=new Date(c);return f.setDate(f.getDate()+1),(a=(s=o.every(Number(n!=null?n:1)))==null?void 0:s.range(u,f))!=null?a:[]}if(n===void 0)return t.ticks(o);var h=o.every(Number(n));if(h)return t.ticks(h)}throw new Error("Invalid tickValues: "+e)}if("ticks"in t){if(e===void 0)return t.ticks();if(typeof(d=e)=="number"&&isFinite(d)&&Math.floor(d)===d)return t.ticks(e)}var d;return t.domain()};function Mo(){return Mo=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Mo.apply(this,arguments)}var poe=function(t){var e,r=t.axis,n=t.scale,i=t.ticksPosition,o=t.tickValues,a=t.tickSize,s=t.tickPadding,l=t.tickRotation,u=t.engine,c=u===void 0?"svg":u,f=doe(n,o),h=e1t[c],d="bandwidth"in n?foe(n):n,p={lineX:0,lineY:0},m={textX:0,textY:0},g=typeof document=="object"&&document.dir==="rtl",v=h.align.center,S=h.baseline.center;return r==="x"?(e=function(b){var E;return{x:(E=d(b))!=null?E:0,y:0}},p.lineY=a*(i==="after"?1:-1),m.textY=(a+s)*(i==="after"?1:-1),S=i==="after"?h.baseline.top:h.baseline.bottom,l===0?v=h.align.center:i==="after"&&l<0||i==="before"&&l>0?(v=h.align[g?"left":"right"],S=h.baseline.center):(i==="after"&&l>0||i==="before"&&l<0)&&(v=h.align[g?"right":"left"],S=h.baseline.center)):(e=function(b){var E;return{x:0,y:(E=d(b))!=null?E:0}},p.lineX=a*(i==="after"?1:-1),m.textX=(a+s)*(i==="after"?1:-1),v=i==="after"?h.align.left:h.align.right),{ticks:f.map(function(b){return Mo({key:b instanceof Date?""+b.valueOf():""+b,value:b},e(b),p,m)}),textAlign:v,textBaseline:S}},moe=function(t,e){if(t===void 0||typeof t=="function")return t;if(e.type==="time"){var r=PR(t);return function(n){return r(n instanceof Date?n:new Date(n))}}return c5(t)},L4=function(t){var e,r=t.width,n=t.height,i=t.scale,o=t.axis,a=t.values,s=(e=a,(Array.isArray(e)?a:void 0)||doe(i,a)),l="bandwidth"in i?foe(i):i,u=o==="x"?s.map(function(c){var f,h;return{key:c instanceof Date?""+c.valueOf():""+c,x1:(f=l(c))!=null?f:0,x2:(h=l(c))!=null?h:0,y1:0,y2:n}}):s.map(function(c){var f,h;return{key:c instanceof Date?""+c.valueOf():""+c,x1:0,x2:r,y1:(f=l(c))!=null?f:0,y2:(h=l(c))!=null?h:0}});return u},u0t=J.exports.memo(function(t){var e,r=t.value,n=t.format,i=t.lineX,o=t.lineY,a=t.onClick,s=t.textBaseline,l=t.textAnchor,u=t.animatedProps,c=pr(),f=(e=n==null?void 0:n(r))!=null?e:r,h=J.exports.useMemo(function(){var d={opacity:u.opacity};return a?{style:Mo({},d,{cursor:"pointer"}),onClick:function(p){return a(p,f)}}:{style:d}},[u.opacity,a,f]);return he.jsxs(kr.g,Mo({transform:u.transform},h,{children:[he.jsx("line",{x1:0,x2:i,y1:0,y2:o,style:c.axis.ticks.line}),he.jsx(kr.text,{dominantBaseline:s,textAnchor:l,transform:u.textTransform,style:c.axis.ticks.text,children:f})]}))}),c0t=J.exports.memo(function(t){var e=t.axis,r=t.scale,n=t.x,i=n===void 0?0:n,o=t.y,a=o===void 0?0:o,s=t.length,l=t.ticksPosition,u=t.tickValues,c=t.tickSize,f=c===void 0?5:c,h=t.tickPadding,d=h===void 0?5:h,p=t.tickRotation,m=p===void 0?0:p,g=t.format,v=t.renderTick,S=v===void 0?u0t:v,b=t.legend,E=t.legendPosition,T=E===void 0?"end":E,N=t.legendOffset,L=N===void 0?0:N,V=t.onClick,B=t.ariaHidden,k=pr(),M=J.exports.useMemo(function(){return moe(g,r)},[g,r]),G=poe({axis:e,scale:r,ticksPosition:l,tickValues:u,tickSize:f,tickPadding:d,tickRotation:m}),j=G.ticks,q=G.textAlign,te=G.textBaseline,pe=null;if(b!==void 0){var ne,O=0,y=0,R=0;e==="y"?(R=-90,O=L,T==="start"?(ne="start",y=s):T==="middle"?(ne="middle",y=s/2):T==="end"&&(ne="end")):(y=L,T==="start"?ne="start":T==="middle"?(ne="middle",O=s/2):T==="end"&&(ne="end",O=s)),pe=he.jsx("text",{transform:"translate("+O+", "+y+") rotate("+R+")",textAnchor:ne,style:Mo({dominantBaseline:"central"},k.axis.legend.text),children:b})}var C=co(),A=C.animate,P=C.config,H=Sa({transform:"translate("+i+","+a+")",lineX2:e==="x"?s:0,lineY2:e==="x"?0:s,config:P,immediate:!A}),Y=bM(j,{keys:function(z){return z.key},initial:function(z){return{opacity:1,transform:"translate("+z.x+","+z.y+")",textTransform:"translate("+z.textX+","+z.textY+") rotate("+m+")"}},from:function(z){return{opacity:0,transform:"translate("+z.x+","+z.y+")",textTransform:"translate("+z.textX+","+z.textY+") rotate("+m+")"}},enter:function(z){return{opacity:1,transform:"translate("+z.x+","+z.y+")",textTransform:"translate("+z.textX+","+z.textY+") rotate("+m+")"}},update:function(z){return{opacity:1,transform:"translate("+z.x+","+z.y+")",textTransform:"translate("+z.textX+","+z.textY+") rotate("+m+")"}},leave:{opacity:0},config:P,immediate:!A});return he.jsxs(kr.g,{transform:H.transform,"aria-hidden":B,children:[Y(function(z,oe,me,re){return J.exports.createElement(S,Mo({tickIndex:re,format:M,rotate:m,textBaseline:te,textAnchor:q,animatedProps:z},oe,V?{onClick:V}:{}))}),he.jsx(kr.line,{style:k.axis.domain.line,x1:0,x2:H.lineX2,y1:0,y2:H.lineY2}),pe]})}),f0t={ticksPosition:_.exports.oneOf(["before","after"]),tickValues:_.exports.oneOfType([_.exports.number,_.exports.arrayOf(_.exports.oneOfType([_.exports.number,_.exports.string,_.exports.instanceOf(Date)])),_.exports.string]),tickSize:_.exports.number,tickPadding:_.exports.number,tickRotation:_.exports.number,format:_.exports.oneOfType([_.exports.func,_.exports.string]),renderTick:_.exports.func,legend:_.exports.node,legendPosition:_.exports.oneOf(["start","middle","end"]),legendOffset:_.exports.number,ariaHidden:_.exports.bool},Mb=_.exports.shape(f0t),goe=["top","right","bottom","left"],yoe=J.exports.memo(function(t){var e=t.xScale,r=t.yScale,n=t.width,i=t.height,o={top:t.top,right:t.right,bottom:t.bottom,left:t.left};return he.jsx(he.Fragment,{children:goe.map(function(a){var s=o[a];if(!s)return null;var l=a==="top"||a==="bottom";return he.jsx(c0t,Mo({},s,{axis:l?"x":"y",x:a==="right"?n:0,y:a==="bottom"?i:0,scale:l?e:r,length:l?n:i,ticksPosition:a==="top"||a==="left"?"before":"after"}),a)})})}),h0t=J.exports.memo(function(t){var e=t.animatedProps,r=pr();return he.jsx(kr.line,Mo({},e,r.grid.line))}),oz=J.exports.memo(function(t){var e=t.lines,r=co(),n=r.animate,i=r.config,o=bM(e,{keys:function(a){return a.key},initial:function(a){return{opacity:1,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2}},from:function(a){return{opacity:0,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2}},enter:function(a){return{opacity:1,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2}},update:function(a){return{opacity:1,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2}},leave:{opacity:0},config:i,immediate:!n});return he.jsx("g",{children:o(function(a,s){return J.exports.createElement(h0t,Mo({},s,{key:s.key,animatedProps:a}))})})}),voe=J.exports.memo(function(t){var e=t.width,r=t.height,n=t.xScale,i=t.yScale,o=t.xValues,a=t.yValues,s=J.exports.useMemo(function(){return!!n&&L4({width:e,height:r,scale:n,axis:"x",values:o})},[n,o,e,r]),l=J.exports.useMemo(function(){return!!i&&L4({width:e,height:r,scale:i,axis:"y",values:a})},[r,e,i,a]);return he.jsxs(he.Fragment,{children:[s&&he.jsx(oz,{lines:s}),l&&he.jsx(oz,{lines:l})]})}),d0t=function(t,e){var r,n=e.axis,i=e.scale,o=e.x,a=o===void 0?0:o,s=e.y,l=s===void 0?0:s,u=e.length,c=e.ticksPosition,f=e.tickValues,h=e.tickSize,d=h===void 0?5:h,p=e.tickPadding,m=p===void 0?5:p,g=e.tickRotation,v=g===void 0?0:g,S=e.format,b=e.legend,E=e.legendPosition,T=E===void 0?"end":E,N=e.legendOffset,L=N===void 0?0:N,V=e.theme,B=poe({axis:n,scale:i,ticksPosition:c,tickValues:f,tickSize:d,tickPadding:m,tickRotation:v,engine:"canvas"}),k=B.ticks,M=B.textAlign,G=B.textBaseline;t.save(),t.translate(a,l),t.textAlign=M,t.textBaseline=G,t.font=(V.axis.ticks.text.fontWeight?V.axis.ticks.text.fontWeight+" ":"")+V.axis.ticks.text.fontSize+"px "+V.axis.ticks.text.fontFamily,((r=V.axis.domain.line.strokeWidth)!=null?r:0)>0&&(t.lineWidth=Number(V.axis.domain.line.strokeWidth),t.lineCap="square",V.axis.domain.line.stroke&&(t.strokeStyle=V.axis.domain.line.stroke),t.beginPath(),t.moveTo(0,0),t.lineTo(n==="x"?u:0,n==="x"?0:u),t.stroke());var j=typeof S=="function"?S:function(O){return""+O};if(k.forEach(function(O){var y;((y=V.axis.ticks.line.strokeWidth)!=null?y:0)>0&&(t.lineWidth=Number(V.axis.ticks.line.strokeWidth),t.lineCap="square",V.axis.ticks.line.stroke&&(t.strokeStyle=V.axis.ticks.line.stroke),t.beginPath(),t.moveTo(O.x,O.y),t.lineTo(O.x+O.lineX,O.y+O.lineY),t.stroke());var R=j(O.value);t.save(),t.translate(O.x+O.textX,O.y+O.textY),t.rotate(Jv(v)),V.axis.ticks.text.fill&&(t.fillStyle=V.axis.ticks.text.fill),t.fillText(String(R),0,0),t.restore()}),b!==void 0){var q=0,te=0,pe=0,ne="center";n==="y"?(pe=-90,q=L,T==="start"?(ne="start",te=u):T==="middle"?(ne="center",te=u/2):T==="end"&&(ne="end")):(te=L,T==="start"?ne="start":T==="middle"?(ne="center",q=u/2):T==="end"&&(ne="end",q=u)),t.translate(q,te),t.rotate(Jv(pe)),t.font=(V.axis.legend.text.fontWeight?V.axis.legend.text.fontWeight+" ":"")+V.axis.legend.text.fontSize+"px "+V.axis.legend.text.fontFamily,V.axis.legend.text.fill&&(t.fillStyle=V.axis.legend.text.fill),t.textAlign=ne,t.textBaseline="middle",t.fillText(b,0,0)}t.restore()},boe=function(t,e){var r=e.xScale,n=e.yScale,i=e.width,o=e.height,a=e.top,s=e.right,l=e.bottom,u=e.left,c=e.theme,f={top:a,right:s,bottom:l,left:u};goe.forEach(function(h){var d=f[h];if(!d)return null;var p=h==="top"||h==="bottom",m=h==="top"||h==="left"?"before":"after",g=p?r:n,v=moe(d.format,g);d0t(t,Mo({},d,{axis:p?"x":"y",x:h==="right"?i:0,y:h==="bottom"?o:0,scale:g,format:v,length:p?i:o,ticksPosition:m,theme:c}))})},KS=function(t,e){var r=e.width,n=e.height,i=e.scale,o=e.axis,a=e.values;L4({width:r,height:n,scale:i,axis:o,values:a}).forEach(function(s){t.beginPath(),t.moveTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.stroke()})},p0t=function(t){var e=t.x,r=t.y,n=t.size,i=t.fill,o=t.opacity,a=o===void 0?1:o,s=t.borderWidth,l=s===void 0?0:s,u=t.borderColor;return he.jsx("circle",{r:n/2,cx:e+n/2,cy:r+n/2,fill:i,opacity:a,strokeWidth:l,stroke:u===void 0?"transparent":u,style:{pointerEvents:"none"}})},m0t=function(t){var e=t.x,r=t.y,n=t.size,i=t.fill,o=t.opacity,a=o===void 0?1:o,s=t.borderWidth,l=s===void 0?0:s,u=t.borderColor;return he.jsx("g",{transform:"translate("+e+","+r+")",children:he.jsx("path",{d:`
                    M`+n/2+` 0
                    L`+.8*n+" "+n/2+`
                    L`+n/2+" "+n+`
                    L`+.2*n+" "+n/2+`
                    L`+n/2+` 0
                `,fill:i,opacity:a,strokeWidth:l,stroke:u===void 0?"transparent":u,style:{pointerEvents:"none"}})})},g0t=function(t){var e=t.x,r=t.y,n=t.size,i=t.fill,o=t.opacity,a=o===void 0?1:o,s=t.borderWidth,l=s===void 0?0:s,u=t.borderColor;return he.jsx("rect",{x:e,y:r,fill:i,opacity:a,strokeWidth:l,stroke:u===void 0?"transparent":u,width:n,height:n,style:{pointerEvents:"none"}})},y0t=function(t){var e=t.x,r=t.y,n=t.size,i=t.fill,o=t.opacity,a=o===void 0?1:o,s=t.borderWidth,l=s===void 0?0:s,u=t.borderColor;return he.jsx("g",{transform:"translate("+e+","+r+")",children:he.jsx("path",{d:`
                M`+n/2+` 0
                L`+n+" "+n+`
                L0 `+n+`
                L`+n/2+` 0
            `,fill:i,opacity:a,strokeWidth:l,stroke:u===void 0?"transparent":u,style:{pointerEvents:"none"}})})};function ku(){return ku=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ku.apply(this,arguments)}var v0t={top:0,right:0,bottom:0,left:0},JM=function(t){var e,r=t.direction,n=t.itemsSpacing,i=t.padding,o=t.itemCount,a=t.itemWidth,s=t.itemHeight;if(typeof i!="number"&&(typeof(e=i)!="object"||Array.isArray(e)||e===null))throw new Error("Invalid property padding, must be one of: number, object");var l=typeof i=="number"?{top:i,right:i,bottom:i,left:i}:ku({},v0t,i),u=l.left+l.right,c=l.top+l.bottom,f=a+u,h=s+c,d=(o-1)*n;return r==="row"?f=a*o+d+u:r==="column"&&(h=s*o+d+c),{width:f,height:h,padding:l}},woe=function(t){var e=t.anchor,r=t.translateX,n=t.translateY,i=t.containerWidth,o=t.containerHeight,a=t.width,s=t.height,l=r,u=n;switch(e){case"top":l+=(i-a)/2;break;case"top-right":l+=i-a;break;case"right":l+=i-a,u+=(o-s)/2;break;case"bottom-right":l+=i-a,u+=o-s;break;case"bottom":l+=(i-a)/2,u+=o-s;break;case"bottom-left":u+=o-s;break;case"left":u+=(o-s)/2;break;case"center":l+=(i-a)/2,u+=(o-s)/2}return{x:l,y:u}},Soe=function(t){var e,r,n,i,o,a,s=t.direction,l=t.justify,u=t.symbolSize,c=t.symbolSpacing,f=t.width,h=t.height;switch(s){case"left-to-right":e=0,r=(h-u)/2,i=h/2,a="central",l?(n=f,o="end"):(n=u+c,o="start");break;case"right-to-left":e=f-u,r=(h-u)/2,i=h/2,a="central",l?(n=0,o="start"):(n=f-u-c,o="end");break;case"top-to-bottom":e=(f-u)/2,r=0,n=f/2,o="middle",l?(i=h,a="alphabetic"):(i=u+c,a="text-before-edge");break;case"bottom-to-top":e=(f-u)/2,r=h-u,n=f/2,o="middle",l?(i=0,a="text-before-edge"):(i=h-u-c,a="alphabetic")}return{symbolX:e,symbolY:r,labelX:n,labelY:i,labelAnchor:o,labelAlignment:a}},b0t={circle:p0t,diamond:m0t,square:g0t,triangle:y0t},w0t=function(t){var e,r,n,i,o,a,s,l,u,c,f,h=t.x,d=t.y,p=t.width,m=t.height,g=t.data,v=t.direction,S=v===void 0?"left-to-right":v,b=t.justify,E=b!==void 0&&b,T=t.textColor,N=t.background,L=N===void 0?"transparent":N,V=t.opacity,B=V===void 0?1:V,k=t.symbolShape,M=k===void 0?"square":k,G=t.symbolSize,j=G===void 0?16:G,q=t.symbolSpacing,te=q===void 0?8:q,pe=t.symbolBorderWidth,ne=pe===void 0?0:pe,O=t.symbolBorderColor,y=O===void 0?"transparent":O,R=t.onClick,C=t.onMouseEnter,A=t.onMouseLeave,P=t.toggleSerie,H=t.effects,Y=J.exports.useState({}),z=Y[0],oe=Y[1],me=pr(),re=J.exports.useCallback(function(I){if(H){var D=H.filter(function(U){return U.on==="hover"}).reduce(function(U,ae){return ku({},U,ae.style)},{});oe(D)}C==null||C(g,I)},[C,g,H]),ge=J.exports.useCallback(function(I){if(H){var D=H.filter(function(U){return U.on!=="hover"}).reduce(function(U,ae){return ku({},U,ae.style)},{});oe(D)}A==null||A(g,I)},[A,g,H]),ve=Soe({direction:S,justify:E,symbolSize:(e=z.symbolSize)!=null?e:j,symbolSpacing:te,width:p,height:m}),ie=ve.symbolX,be=ve.symbolY,ce=ve.labelX,_e=ve.labelY,Ie=ve.labelAnchor,Oe=ve.labelAlignment,Ae=[R,C,A,P].some(function(I){return I!==void 0}),xe=typeof M=="function"?M:b0t[M];return he.jsxs("g",{transform:"translate("+h+","+d+")",style:{opacity:(r=z.itemOpacity)!=null?r:B},children:[he.jsx("rect",{width:p,height:m,fill:(n=z.itemBackground)!=null?n:L,style:{cursor:Ae?"pointer":"auto"},onClick:function(I){R==null||R(g,I),P==null||P(g.id)},onMouseEnter:re,onMouseLeave:ge}),J.exports.createElement(xe,ku({id:g.id,x:ie,y:be,size:(i=z.symbolSize)!=null?i:j,fill:(o=(a=g.fill)!=null?a:g.color)!=null?o:"black",borderWidth:(s=z.symbolBorderWidth)!=null?s:ne,borderColor:(l=z.symbolBorderColor)!=null?l:y},g.hidden?me.legends.hidden.symbol:void 0)),he.jsx("text",{textAnchor:Ie,style:ku({},me.legends.text,{fill:(u=(c=(f=z.itemTextColor)!=null?f:T)!=null?c:me.legends.text.fill)!=null?u:"black",dominantBaseline:Oe,pointerEvents:"none",userSelect:"none"},g.hidden?me.legends.hidden.text:void 0),x:ce,y:_e,children:g.label})]})},S0t=function(t){var e=t.data,r=t.x,n=t.y,i=t.direction,o=t.padding,a=o===void 0?0:o,s=t.justify,l=t.effects,u=t.itemWidth,c=t.itemHeight,f=t.itemDirection,h=f===void 0?"left-to-right":f,d=t.itemsSpacing,p=d===void 0?0:d,m=t.itemTextColor,g=t.itemBackground,v=g===void 0?"transparent":g,S=t.itemOpacity,b=S===void 0?1:S,E=t.symbolShape,T=t.symbolSize,N=t.symbolSpacing,L=t.symbolBorderWidth,V=t.symbolBorderColor,B=t.onClick,k=t.onMouseEnter,M=t.onMouseLeave,G=t.toggleSerie,j=JM({itemCount:e.length,itemWidth:u,itemHeight:c,itemsSpacing:p,direction:i,padding:a}).padding,q=i==="row"?u+p:0,te=i==="column"?c+p:0;return he.jsx("g",{transform:"translate("+r+","+n+")",children:e.map(function(pe,ne){return he.jsx(w0t,{data:pe,x:ne*q+j.left,y:ne*te+j.top,width:u,height:c,direction:h,justify:s,effects:l,textColor:m,background:v,opacity:b,symbolShape:E,symbolSize:T,symbolSpacing:N,symbolBorderWidth:L,symbolBorderColor:V,onClick:B,onMouseEnter:k,onMouseLeave:M,toggleSerie:G},ne)})})},Roe=function(t){var e=t.data,r=t.containerWidth,n=t.containerHeight,i=t.translateX,o=i===void 0?0:i,a=t.translateY,s=a===void 0?0:a,l=t.anchor,u=t.direction,c=t.padding,f=c===void 0?0:c,h=t.justify,d=t.itemsSpacing,p=d===void 0?0:d,m=t.itemWidth,g=t.itemHeight,v=t.itemDirection,S=t.itemTextColor,b=t.itemBackground,E=t.itemOpacity,T=t.symbolShape,N=t.symbolSize,L=t.symbolSpacing,V=t.symbolBorderWidth,B=t.symbolBorderColor,k=t.onClick,M=t.onMouseEnter,G=t.onMouseLeave,j=t.toggleSerie,q=t.effects,te=JM({itemCount:e.length,itemsSpacing:p,itemWidth:m,itemHeight:g,direction:u,padding:f}),pe=te.width,ne=te.height,O=woe({anchor:l,translateX:o,translateY:s,containerWidth:r,containerHeight:n,width:pe,height:ne}),y=O.x,R=O.y;return he.jsx(S0t,{data:e,x:y,y:R,direction:u,padding:f,justify:h,effects:q,itemsSpacing:p,itemWidth:m,itemHeight:g,itemDirection:v,itemTextColor:S,itemBackground:b,itemOpacity:E,symbolShape:T,symbolSize:N,symbolSpacing:L,symbolBorderWidth:V,symbolBorderColor:B,onClick:k,onMouseEnter:M,onMouseLeave:G,toggleSerie:typeof j=="boolean"?void 0:j})},R0t={start:"left",middle:"center",end:"right"},Eoe=function(t,e){var r=e.data,n=e.containerWidth,i=e.containerHeight,o=e.translateX,a=o===void 0?0:o,s=e.translateY,l=s===void 0?0:s,u=e.anchor,c=e.direction,f=e.padding,h=f===void 0?0:f,d=e.justify,p=d!==void 0&&d,m=e.itemsSpacing,g=m===void 0?0:m,v=e.itemWidth,S=e.itemHeight,b=e.itemDirection,E=b===void 0?"left-to-right":b,T=e.itemTextColor,N=e.symbolSize,L=N===void 0?16:N,V=e.symbolSpacing,B=V===void 0?8:V,k=e.theme,M=JM({itemCount:r.length,itemWidth:v,itemHeight:S,itemsSpacing:g,direction:c,padding:h}),G=M.width,j=M.height,q=M.padding,te=woe({anchor:u,translateX:a,translateY:l,containerWidth:n,containerHeight:i,width:G,height:j}),pe=te.x,ne=te.y,O=c==="row"?v+g:0,y=c==="column"?S+g:0;t.save(),t.translate(pe,ne),t.font=k.legends.text.fontSize+"px "+(k.legends.text.fontFamily||"sans-serif"),r.forEach(function(R,C){var A,P,H=C*O+q.left,Y=C*y+q.top,z=Soe({direction:E,justify:p,symbolSize:L,symbolSpacing:B,width:v,height:S}),oe=z.symbolX,me=z.symbolY,re=z.labelX,ge=z.labelY,ve=z.labelAnchor,ie=z.labelAlignment;t.fillStyle=(A=R.color)!=null?A:"black",t.fillRect(H+oe,Y+me,L,L),t.textAlign=R0t[ve],ie==="central"&&(t.textBaseline="middle"),t.fillStyle=(P=T!=null?T:k.legends.text.fill)!=null?P:"black",t.fillText(String(R.label),H+re,Y+ge)}),t.restore()},E0t={data:_.exports.arrayOf(_.exports.object),anchor:_.exports.oneOf(["top","top-right","right","bottom-right","bottom","bottom-left","left","top-left","center"]).isRequired,translateX:_.exports.number,translateY:_.exports.number,direction:_.exports.oneOf(["row","column"]).isRequired,itemsSpacing:_.exports.number,itemWidth:_.exports.number.isRequired,itemHeight:_.exports.number.isRequired,itemDirection:_.exports.oneOf(["left-to-right","right-to-left","top-to-bottom","bottom-to-top"]),itemTextColor:_.exports.string,itemBackground:_.exports.string,itemOpacity:_.exports.number,symbolShape:_.exports.oneOfType([_.exports.oneOf(["circle","diamond","square","triangle"]),_.exports.func]),symbolSize:_.exports.number,symbolSpacing:_.exports.number,symbolBorderWidth:_.exports.number,symbolBorderColor:_.exports.string,onClick:_.exports.func,onMouseEnter:_.exports.func,onMouseLeave:_.exports.func,effects:_.exports.arrayOf(_.exports.shape({on:_.exports.oneOfType([_.exports.oneOf(["hover"])]).isRequired,style:_.exports.shape({itemTextColor:_.exports.string,itemBackground:_.exports.string,itemOpacity:_.exports.number,symbolSize:_.exports.number,symbolBorderWidth:_.exports.number,symbolBorderColor:_.exports.string}).isRequired}))};const az=Math.pow(2,-52),Nb=new Uint32Array(512);class qS{static from(e,r=A0t,n=x0t){const i=e.length,o=new Float64Array(i*2);for(let a=0;a<i;a++){const s=e[a];o[2*a]=r(s),o[2*a+1]=n(s)}return new qS(o)}constructor(e){const r=e.length>>1;if(r>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*r-5,0);this._triangles=new Uint32Array(n*3),this._halfedges=new Int32Array(n*3),this._hashSize=Math.ceil(Math.sqrt(r)),this._hullPrev=new Uint32Array(r),this._hullNext=new Uint32Array(r),this._hullTri=new Uint32Array(r),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(r),this._dists=new Float64Array(r),this.update()}update(){const{coords:e,_hullPrev:r,_hullNext:n,_hullTri:i,_hullHash:o}=this,a=e.length>>1;let s=1/0,l=1/0,u=-1/0,c=-1/0;for(let k=0;k<a;k++){const M=e[2*k],G=e[2*k+1];M<s&&(s=M),G<l&&(l=G),M>u&&(u=M),G>c&&(c=G),this._ids[k]=k}const f=(s+u)/2,h=(l+c)/2;let d=1/0,p,m,g;for(let k=0;k<a;k++){const M=O_(f,h,e[2*k],e[2*k+1]);M<d&&(p=k,d=M)}const v=e[2*p],S=e[2*p+1];d=1/0;for(let k=0;k<a;k++){if(k===p)continue;const M=O_(v,S,e[2*k],e[2*k+1]);M<d&&M>0&&(m=k,d=M)}let b=e[2*m],E=e[2*m+1],T=1/0;for(let k=0;k<a;k++){if(k===p||k===m)continue;const M=T0t(v,S,b,E,e[2*k],e[2*k+1]);M<T&&(g=k,T=M)}let N=e[2*g],L=e[2*g+1];if(T===1/0){for(let G=0;G<a;G++)this._dists[G]=e[2*G]-e[0]||e[2*G+1]-e[1];Uf(this._ids,this._dists,0,a-1);const k=new Uint32Array(a);let M=0;for(let G=0,j=-1/0;G<a;G++){const q=this._ids[G];this._dists[q]>j&&(k[M++]=q,j=this._dists[q])}this.hull=k.subarray(0,M),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Pb(v,S,b,E,N,L)){const k=m,M=b,G=E;m=g,b=N,E=L,g=k,N=M,L=G}const V=O0t(v,S,b,E,N,L);this._cx=V.x,this._cy=V.y;for(let k=0;k<a;k++)this._dists[k]=O_(e[2*k],e[2*k+1],V.x,V.y);Uf(this._ids,this._dists,0,a-1),this._hullStart=p;let B=3;n[p]=r[g]=m,n[m]=r[p]=g,n[g]=r[m]=p,i[p]=0,i[m]=1,i[g]=2,o.fill(-1),o[this._hashKey(v,S)]=p,o[this._hashKey(b,E)]=m,o[this._hashKey(N,L)]=g,this.trianglesLen=0,this._addTriangle(p,m,g,-1,-1,-1);for(let k=0,M,G;k<this._ids.length;k++){const j=this._ids[k],q=e[2*j],te=e[2*j+1];if(k>0&&Math.abs(q-M)<=az&&Math.abs(te-G)<=az||(M=q,G=te,j===p||j===m||j===g))continue;let pe=0;for(let C=0,A=this._hashKey(q,te);C<this._hashSize&&(pe=o[(A+C)%this._hashSize],!(pe!==-1&&pe!==n[pe]));C++);pe=r[pe];let ne=pe,O;for(;O=n[ne],!Pb(q,te,e[2*ne],e[2*ne+1],e[2*O],e[2*O+1]);)if(ne=O,ne===pe){ne=-1;break}if(ne===-1)continue;let y=this._addTriangle(ne,j,n[ne],-1,-1,i[ne]);i[j]=this._legalize(y+2),i[ne]=y,B++;let R=n[ne];for(;O=n[R],Pb(q,te,e[2*R],e[2*R+1],e[2*O],e[2*O+1]);)y=this._addTriangle(R,j,O,i[j],-1,i[R]),i[j]=this._legalize(y+2),n[R]=R,B--,R=O;if(ne===pe)for(;O=r[ne],Pb(q,te,e[2*O],e[2*O+1],e[2*ne],e[2*ne+1]);)y=this._addTriangle(O,j,ne,-1,i[ne],i[O]),this._legalize(y+2),i[O]=y,n[ne]=ne,B--,ne=O;this._hullStart=r[j]=ne,n[ne]=r[R]=j,n[j]=R,o[this._hashKey(q,te)]=j,o[this._hashKey(e[2*ne],e[2*ne+1])]=ne}this.hull=new Uint32Array(B);for(let k=0,M=this._hullStart;k<B;k++)this.hull[k]=M,M=n[M];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,r){return Math.floor(C0t(e-this._cx,r-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:r,_halfedges:n,coords:i}=this;let o=0,a=0;for(;;){const s=n[e],l=e-e%3;if(a=l+(e+2)%3,s===-1){if(o===0)break;e=Nb[--o];continue}const u=s-s%3,c=l+(e+1)%3,f=u+(s+2)%3,h=r[a],d=r[e],p=r[c],m=r[f];if(_0t(i[2*h],i[2*h+1],i[2*d],i[2*d+1],i[2*p],i[2*p+1],i[2*m],i[2*m+1])){r[e]=m,r[s]=h;const v=n[f];if(v===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=e;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(e,v),this._link(s,n[a]),this._link(a,f);const S=u+(s+1)%3;o<Nb.length&&(Nb[o++]=S)}else{if(o===0)break;e=Nb[--o]}}return a}_link(e,r){this._halfedges[e]=r,r!==-1&&(this._halfedges[r]=e)}_addTriangle(e,r,n,i,o,a){const s=this.trianglesLen;return this._triangles[s]=e,this._triangles[s+1]=r,this._triangles[s+2]=n,this._link(s,i),this._link(s+1,o),this._link(s+2,a),this.trianglesLen+=3,s}}function C0t(t,e){const r=t/(Math.abs(t)+Math.abs(e));return(e>0?3-r:1+r)/4}function O_(t,e,r,n){const i=t-r,o=e-n;return i*i+o*o}function A_(t,e,r,n,i,o){const a=(n-e)*(i-t),s=(r-t)*(o-e);return Math.abs(a-s)>=33306690738754716e-32*Math.abs(a+s)?a-s:0}function Pb(t,e,r,n,i,o){return(A_(i,o,t,e,r,n)||A_(t,e,r,n,i,o)||A_(r,n,i,o,t,e))<0}function _0t(t,e,r,n,i,o,a,s){const l=t-a,u=e-s,c=r-a,f=n-s,h=i-a,d=o-s,p=l*l+u*u,m=c*c+f*f,g=h*h+d*d;return l*(f*g-m*d)-u*(c*g-m*h)+p*(c*d-f*h)<0}function T0t(t,e,r,n,i,o){const a=r-t,s=n-e,l=i-t,u=o-e,c=a*a+s*s,f=l*l+u*u,h=.5/(a*u-s*l),d=(u*c-s*f)*h,p=(a*f-l*c)*h;return d*d+p*p}function O0t(t,e,r,n,i,o){const a=r-t,s=n-e,l=i-t,u=o-e,c=a*a+s*s,f=l*l+u*u,h=.5/(a*u-s*l),d=t+(u*c-s*f)*h,p=e+(a*f-l*c)*h;return{x:d,y:p}}function Uf(t,e,r,n){if(n-r<=20)for(let i=r+1;i<=n;i++){const o=t[i],a=e[o];let s=i-1;for(;s>=r&&e[t[s]]>a;)t[s+1]=t[s--];t[s+1]=o}else{const i=r+n>>1;let o=r+1,a=n;$m(t,i,o),e[t[r]]>e[t[n]]&&$m(t,r,n),e[t[o]]>e[t[n]]&&$m(t,o,n),e[t[r]]>e[t[o]]&&$m(t,r,o);const s=t[o],l=e[s];for(;;){do o++;while(e[t[o]]<l);do a--;while(e[t[a]]>l);if(a<o)break;$m(t,o,a)}t[r+1]=t[a],t[a]=s,n-o+1>=a-r?(Uf(t,e,o,n),Uf(t,e,r,a-1)):(Uf(t,e,r,a-1),Uf(t,e,o,n))}}function $m(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function A0t(t){return t[0]}function x0t(t){return t[1]}const sz=1e-6;class $u{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,r){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,r){this._+=`L${this._x1=+e},${this._y1=+r}`}arc(e,r,n){e=+e,r=+r,n=+n;const i=e+n,o=r;if(n<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${o}`:(Math.abs(this._x1-i)>sz||Math.abs(this._y1-o)>sz)&&(this._+="L"+i+","+o),n&&(this._+=`A${n},${n},0,1,1,${e-n},${r}A${n},${n},0,1,1,${this._x1=i},${this._y1=o}`)}rect(e,r,n,i){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${+n}v${+i}h${-n}Z`}value(){return this._||null}}class D4{constructor(){this._=[]}moveTo(e,r){this._.push([e,r])}closePath(){this._.push(this._[0].slice())}lineTo(e,r){this._.push([e,r])}value(){return this._.length?this._:null}}class I0t{constructor(e,[r,n,i,o]=[0,0,960,500]){if(!((i=+i)>=(r=+r))||!((o=+o)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=i,this.xmin=r,this.ymax=o,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:r,triangles:n},vectors:i}=this,o=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let d=0,p=0,m=n.length,g,v;d<m;d+=3,p+=2){const S=n[d]*2,b=n[d+1]*2,E=n[d+2]*2,T=e[S],N=e[S+1],L=e[b],V=e[b+1],B=e[E],k=e[E+1],M=L-T,G=V-N,j=B-T,q=k-N,te=M*M+G*G,pe=j*j+q*q,ne=(M*q-G*j)*2;if(!ne)g=(T+B)/2-1e8*q,v=(N+k)/2+1e8*j;else if(Math.abs(ne)<1e-8)g=(T+B)/2,v=(N+k)/2;else{const O=1/ne;g=T+(q*te-G*pe)*O,v=N+(M*pe-j*te)*O}o[p]=g,o[p+1]=v}let a=r[r.length-1],s,l=a*4,u,c=e[2*a],f,h=e[2*a+1];i.fill(0);for(let d=0;d<r.length;++d)a=r[d],s=l,u=c,f=h,l=a*4,c=e[2*a],h=e[2*a+1],i[s+2]=i[l]=f-h,i[s+3]=i[l+1]=c-u}render(e){const r=e==null?e=new $u:void 0,{delaunay:{halfedges:n,inedges:i,hull:o},circumcenters:a,vectors:s}=this;if(o.length<=1)return null;for(let c=0,f=n.length;c<f;++c){const h=n[c];if(h<c)continue;const d=Math.floor(c/3)*2,p=Math.floor(h/3)*2,m=a[d],g=a[d+1],v=a[p],S=a[p+1];this._renderSegment(m,g,v,S,e)}let l,u=o[o.length-1];for(let c=0;c<o.length;++c){l=u,u=o[c];const f=Math.floor(i[u]/3)*2,h=a[f],d=a[f+1],p=l*4,m=this._project(h,d,s[p+2],s[p+3]);m&&this._renderSegment(h,d,m[0],m[1],e)}return r&&r.value()}renderBounds(e){const r=e==null?e=new $u:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),r&&r.value()}renderCell(e,r){const n=r==null?r=new $u:void 0,i=this._clip(e);if(i===null||!i.length)return;r.moveTo(i[0],i[1]);let o=i.length;for(;i[0]===i[o-2]&&i[1]===i[o-1]&&o>1;)o-=2;for(let a=2;a<o;a+=2)(i[a]!==i[a-2]||i[a+1]!==i[a-1])&&r.lineTo(i[a],i[a+1]);return r.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let r=0,n=e.length/2;r<n;++r){const i=this.cellPolygon(r);i&&(i.index=r,yield i)}}cellPolygon(e){const r=new D4;return this.renderCell(e,r),r.value()}_renderSegment(e,r,n,i,o){let a;const s=this._regioncode(e,r),l=this._regioncode(n,i);s===0&&l===0?(o.moveTo(e,r),o.lineTo(n,i)):(a=this._clipSegment(e,r,n,i,s,l))&&(o.moveTo(a[0],a[1]),o.lineTo(a[2],a[3]))}contains(e,r,n){return r=+r,r!==r||(n=+n,n!==n)?!1:this.delaunay._step(e,r,n)===e}*neighbors(e){const r=this._clip(e);if(r)for(const n of this.delaunay.neighbors(e)){const i=this._clip(n);if(i){e:for(let o=0,a=r.length;o<a;o+=2)for(let s=0,l=i.length;s<l;s+=2)if(r[o]==i[s]&&r[o+1]==i[s+1]&&r[(o+2)%a]==i[(s+l-2)%l]&&r[(o+3)%a]==i[(s+l-1)%l]){yield n;break e}}}}_cell(e){const{circumcenters:r,delaunay:{inedges:n,halfedges:i,triangles:o}}=this,a=n[e];if(a===-1)return null;const s=[];let l=a;do{const u=Math.floor(l/3);if(s.push(r[u*2],r[u*2+1]),l=l%3===2?l-2:l+1,o[l]!==e)break;l=i[l]}while(l!==a&&l!==-1);return s}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const r=this._cell(e);if(r===null)return null;const{vectors:n}=this,i=e*4;return n[i]||n[i+1]?this._clipInfinite(e,r,n[i],n[i+1],n[i+2],n[i+3]):this._clipFinite(e,r)}_clipFinite(e,r){const n=r.length;let i=null,o,a,s=r[n-2],l=r[n-1],u,c=this._regioncode(s,l),f,h;for(let d=0;d<n;d+=2)if(o=s,a=l,s=r[d],l=r[d+1],u=c,c=this._regioncode(s,l),u===0&&c===0)f=h,h=0,i?i.push(s,l):i=[s,l];else{let p,m,g,v,S;if(u===0){if((p=this._clipSegment(o,a,s,l,u,c))===null)continue;[m,g,v,S]=p}else{if((p=this._clipSegment(s,l,o,a,c,u))===null)continue;[v,S,m,g]=p,f=h,h=this._edgecode(m,g),f&&h&&this._edge(e,f,h,i,i.length),i?i.push(m,g):i=[m,g]}f=h,h=this._edgecode(v,S),f&&h&&this._edge(e,f,h,i,i.length),i?i.push(v,S):i=[v,S]}if(i)f=h,h=this._edgecode(i[0],i[1]),f&&h&&this._edge(e,f,h,i,i.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(e,r,n,i,o,a){for(;;){if(o===0&&a===0)return[e,r,n,i];if(o&a)return null;let s,l,u=o||a;u&8?(s=e+(n-e)*(this.ymax-r)/(i-r),l=this.ymax):u&4?(s=e+(n-e)*(this.ymin-r)/(i-r),l=this.ymin):u&2?(l=r+(i-r)*(this.xmax-e)/(n-e),s=this.xmax):(l=r+(i-r)*(this.xmin-e)/(n-e),s=this.xmin),o?(e=s,r=l,o=this._regioncode(e,r)):(n=s,i=l,a=this._regioncode(n,i))}}_clipInfinite(e,r,n,i,o,a){let s=Array.from(r),l;if((l=this._project(s[0],s[1],n,i))&&s.unshift(l[0],l[1]),(l=this._project(s[s.length-2],s[s.length-1],o,a))&&s.push(l[0],l[1]),s=this._clipFinite(e,s))for(let u=0,c=s.length,f,h=this._edgecode(s[c-2],s[c-1]);u<c;u+=2)f=h,h=this._edgecode(s[u],s[u+1]),f&&h&&(u=this._edge(e,f,h,s,u),c=s.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(e,r,n,i,o){for(;r!==n;){let a,s;switch(r){case 5:r=4;continue;case 4:r=6,a=this.xmax,s=this.ymin;break;case 6:r=2;continue;case 2:r=10,a=this.xmax,s=this.ymax;break;case 10:r=8;continue;case 8:r=9,a=this.xmin,s=this.ymax;break;case 9:r=1;continue;case 1:r=5,a=this.xmin,s=this.ymin;break}(i[o]!==a||i[o+1]!==s)&&this.contains(e,a,s)&&(i.splice(o,0,a,s),o+=2)}if(i.length>4)for(let a=0;a<i.length;a+=2){const s=(a+2)%i.length,l=(a+4)%i.length;(i[a]===i[s]&&i[s]===i[l]||i[a+1]===i[s+1]&&i[s+1]===i[l+1])&&(i.splice(s,2),a-=2)}return o}_project(e,r,n,i){let o=1/0,a,s,l;if(i<0){if(r<=this.ymin)return null;(a=(this.ymin-r)/i)<o&&(l=this.ymin,s=e+(o=a)*n)}else if(i>0){if(r>=this.ymax)return null;(a=(this.ymax-r)/i)<o&&(l=this.ymax,s=e+(o=a)*n)}if(n>0){if(e>=this.xmax)return null;(a=(this.xmax-e)/n)<o&&(s=this.xmax,l=r+(o=a)*i)}else if(n<0){if(e<=this.xmin)return null;(a=(this.xmin-e)/n)<o&&(s=this.xmin,l=r+(o=a)*i)}return[s,l]}_edgecode(e,r){return(e===this.xmin?1:e===this.xmax?2:0)|(r===this.ymin?4:r===this.ymax?8:0)}_regioncode(e,r){return(e<this.xmin?1:e>this.xmax?2:0)|(r<this.ymin?4:r>this.ymax?8:0)}}const M0t=2*Math.PI,bf=Math.pow;function N0t(t){return t[0]}function P0t(t){return t[1]}function k0t(t){const{triangles:e,coords:r}=t;for(let n=0;n<e.length;n+=3){const i=2*e[n],o=2*e[n+1],a=2*e[n+2];if((r[a]-r[i])*(r[o+1]-r[i+1])-(r[o]-r[i])*(r[a+1]-r[i+1])>1e-10)return!1}return!0}function $0t(t,e,r){return[t+Math.sin(t+e)*r,e+Math.cos(t-e)*r]}class eN{static from(e,r=N0t,n=P0t,i){return new eN("length"in e?L0t(e,r,n,i):Float64Array.from(D0t(e,r,n,i)))}constructor(e){this._delaunator=new qS(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,r=this.points;if(e.hull&&e.hull.length>2&&k0t(e)){this.collinear=Int32Array.from({length:r.length/2},(h,d)=>d).sort((h,d)=>r[2*h]-r[2*d]||r[2*h+1]-r[2*d+1]);const l=this.collinear[0],u=this.collinear[this.collinear.length-1],c=[r[2*l],r[2*l+1],r[2*u],r[2*u+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let h=0,d=r.length/2;h<d;++h){const p=$0t(r[2*h],r[2*h+1],f);r[2*h]=p[0],r[2*h+1]=p[1]}this._delaunator=new qS(r)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let l=0,u=n.length;l<u;++l){const c=o[l%3===2?l-2:l+1];(n[l]===-1||a[c]===-1)&&(a[c]=l)}for(let l=0,u=i.length;l<u;++l)s[i[l]]=l;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],a[i[0]]=1,i.length===2&&(a[i[1]]=0))}voronoi(e){return new I0t(this,e)}*neighbors(e){const{inedges:r,hull:n,_hullIndex:i,halfedges:o,triangles:a,collinear:s}=this;if(s){const f=s.indexOf(e);f>0&&(yield s[f-1]),f<s.length-1&&(yield s[f+1]);return}const l=r[e];if(l===-1)return;let u=l,c=-1;do{if(yield c=a[u],u=u%3===2?u-2:u+1,a[u]!==e)return;if(u=o[u],u===-1){const f=n[(i[e]+1)%n.length];f!==c&&(yield f);return}}while(u!==l)}find(e,r,n=0){if(e=+e,e!==e||(r=+r,r!==r))return-1;const i=n;let o;for(;(o=this._step(n,e,r))>=0&&o!==n&&o!==i;)n=o;return o}_step(e,r,n){const{inedges:i,hull:o,_hullIndex:a,halfedges:s,triangles:l,points:u}=this;if(i[e]===-1||!u.length)return(e+1)%(u.length>>1);let c=e,f=bf(r-u[e*2],2)+bf(n-u[e*2+1],2);const h=i[e];let d=h;do{let p=l[d];const m=bf(r-u[p*2],2)+bf(n-u[p*2+1],2);if(m<f&&(f=m,c=p),d=d%3===2?d-2:d+1,l[d]!==e)break;if(d=s[d],d===-1){if(d=o[(a[e]+1)%o.length],d!==p&&bf(r-u[d*2],2)+bf(n-u[d*2+1],2)<f)return d;break}}while(d!==h);return c}render(e){const r=e==null?e=new $u:void 0,{points:n,halfedges:i,triangles:o}=this;for(let a=0,s=i.length;a<s;++a){const l=i[a];if(l<a)continue;const u=o[a]*2,c=o[l]*2;e.moveTo(n[u],n[u+1]),e.lineTo(n[c],n[c+1])}return this.renderHull(e),r&&r.value()}renderPoints(e,r=2){const n=e==null?e=new $u:void 0,{points:i}=this;for(let o=0,a=i.length;o<a;o+=2){const s=i[o],l=i[o+1];e.moveTo(s+r,l),e.arc(s,l,r,0,M0t)}return n&&n.value()}renderHull(e){const r=e==null?e=new $u:void 0,{hull:n,points:i}=this,o=n[0]*2,a=n.length;e.moveTo(i[o],i[o+1]);for(let s=1;s<a;++s){const l=2*n[s];e.lineTo(i[l],i[l+1])}return e.closePath(),r&&r.value()}hullPolygon(){const e=new D4;return this.renderHull(e),e.value()}renderTriangle(e,r){const n=r==null?r=new $u:void 0,{points:i,triangles:o}=this,a=o[e*=3]*2,s=o[e+1]*2,l=o[e+2]*2;return r.moveTo(i[a],i[a+1]),r.lineTo(i[s],i[s+1]),r.lineTo(i[l],i[l+1]),r.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:e}=this;for(let r=0,n=e.length/3;r<n;++r)yield this.trianglePolygon(r)}trianglePolygon(e){const r=new D4;return this.renderTriangle(e,r),r.value()}}function L0t(t,e,r,n){const i=t.length,o=new Float64Array(i*2);for(let a=0;a<i;++a){const s=t[a];o[a*2]=e.call(n,s,a,t),o[a*2+1]=r.call(n,s,a,t)}return o}function*D0t(t,e,r,n){let i=0;for(const o of t)yield e.call(n,o,i,t),yield r.call(n,o,i,t),++i}var lz=function(t){return typeof t=="function"?t:function(e){return e[t]}},F0t=function(t){var e=t.points,r=t.x,n=r===void 0?"x":r,i=t.y,o=i===void 0?"y":i,a=lz(n),s=lz(o);return e.map(function(l){return[a(l),s(l)]})},H0t=function(t){var e=t.points,r=t.width,n=t.height,i=t.debug,o=eN.from(e),a=i?o.voronoi([0,0,r,n]):void 0;return{delaunay:o,voronoi:a}},Coe=function(t){var e=t.points,r=t.x,n=t.y,i=t.width,o=t.height,a=t.debug,s=J.exports.useMemo(function(){return F0t({points:e,x:r,y:n})},[e,r,n]);return J.exports.useMemo(function(){return H0t({points:s,width:i,height:o,debug:a})},[s,i,o,a])},B0t=function(t){var e=t.nodes,r=t.width,n=t.height,i=t.x,o=t.y,a=t.onMouseEnter,s=t.onMouseMove,l=t.onMouseLeave,u=t.onClick,c=t.debug,f=J.exports.useRef(null),h=J.exports.useState(null),d=h[0],p=h[1],m=Coe({points:e,x:i,y:o,width:r,height:n,debug:c}),g=m.delaunay,v=m.voronoi,S=J.exports.useMemo(function(){if(c&&v)return v.render()},[c,v]),b=J.exports.useCallback(function(V){if(!f.current)return[null,null];var B=Eg(f.current,V),k=B[0],M=B[1],G=g.find(k,M);return[G,G!==void 0?e[G]:null]},[f,g]),E=J.exports.useCallback(function(V){var B=b(V),k=B[0],M=B[1];p(k),M&&(a==null||a(M,V))},[b,p,a]),T=J.exports.useCallback(function(V){var B=b(V),k=B[0],M=B[1];p(k),M&&(s==null||s(M,V))},[b,p,s]),N=J.exports.useCallback(function(V){if(p(null),l){var B=void 0;d!==null&&(B=e[d]),B&&l(B,V)}},[p,d,l,e]),L=J.exports.useCallback(function(V){var B=b(V),k=B[0],M=B[1];p(k),M&&(u==null||u(M,V))},[b,p,u]);return he.jsxs("g",{ref:f,children:[c&&v&&he.jsxs(he.Fragment,{children:[he.jsx("path",{d:S,stroke:"red",strokeWidth:1,opacity:.75}),d!==null&&he.jsx("path",{fill:"pink",opacity:.35,d:v.renderCell(d)})]}),he.jsx("rect",{width:r,height:n,fill:"red",opacity:0,style:{cursor:"auto"},onMouseEnter:E,onMouseMove:T,onMouseLeave:N,onClick:L})]})},U0t=function(t,e){t.save(),t.globalAlpha=.75,t.beginPath(),e.render(t),t.strokeStyle="red",t.lineWidth=1,t.stroke(),t.restore()},V0t=function(t,e,r){t.save(),t.globalAlpha=.35,t.beginPath(),e.renderCell(r,t),t.fillStyle="red",t.fill(),t.restore()};function Mn(){return Mn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Mn.apply(this,arguments)}var _oe=function(t){var e=t.point;return he.jsx(Kre,{id:he.jsxs("span",{children:["x: ",he.jsx("strong",{children:e.data.xFormatted}),", y:"," ",he.jsx("strong",{children:e.data.yFormatted})]}),enableChip:!0,color:e.serieColor})};_oe.propTypes={point:_.exports.object.isRequired};var j0t=J.exports.memo(_oe),Toe=function(t){var e=t.slice,r=t.axis,n=pr(),i=r==="x"?"y":"x";return he.jsx(qre,{rows:e.points.map(function(o){return[he.jsx(Yre,{color:o.serieColor,style:n.tooltip.chip},"chip"),o.serieId,he.jsx("span",{style:n.tooltip.tableCellValue,children:o.data[i+"Formatted"]},"value")]})})};Toe.propTypes={slice:_.exports.object.isRequired,axis:_.exports.oneOf(["x","y"]).isRequired};var W0t=J.exports.memo(Toe),Ooe={data:_.exports.arrayOf(_.exports.shape({id:_.exports.oneOfType([_.exports.string,_.exports.number]).isRequired,data:_.exports.arrayOf(_.exports.shape({x:_.exports.oneOfType([_.exports.number,_.exports.string,_.exports.instanceOf(Date)]),y:_.exports.oneOfType([_.exports.number,_.exports.string,_.exports.instanceOf(Date)])})).isRequired})).isRequired,xScale:_.exports.object.isRequired,xFormat:_.exports.oneOfType([_.exports.func,_.exports.string]),yScale:_.exports.object.isRequired,yFormat:_.exports.oneOfType([_.exports.func,_.exports.string]),layers:_.exports.arrayOf(_.exports.oneOfType([_.exports.oneOf(["grid","markers","axes","areas","crosshair","lines","slices","points","mesh","legends"]),_.exports.func])).isRequired,curve:Fvt.isRequired,axisTop:Mb,axisRight:Mb,axisBottom:Mb,axisLeft:Mb,enableGridX:_.exports.bool.isRequired,enableGridY:_.exports.bool.isRequired,gridXValues:_.exports.oneOfType([_.exports.number,_.exports.arrayOf(_.exports.oneOfType([_.exports.number,_.exports.string,_.exports.instanceOf(Date)]))]),gridYValues:_.exports.oneOfType([_.exports.number,_.exports.arrayOf(_.exports.oneOfType([_.exports.number,_.exports.string,_.exports.instanceOf(Date)]))]),enablePoints:_.exports.bool.isRequired,pointSymbol:_.exports.func,pointSize:_.exports.number.isRequired,pointColor:_.exports.any.isRequired,pointBorderWidth:_.exports.number.isRequired,pointBorderColor:_.exports.any.isRequired,enablePointLabel:_.exports.bool.isRequired,pointLabel:_.exports.oneOfType([_.exports.string,_.exports.func]).isRequired,markers:_.exports.arrayOf(_.exports.shape({axis:_.exports.oneOf(["x","y"]).isRequired,value:_.exports.oneOfType([_.exports.number,_.exports.string,_.exports.instanceOf(Date)]).isRequired,style:_.exports.object})),colors:E1t.isRequired,enableArea:_.exports.bool.isRequired,areaOpacity:_.exports.number.isRequired,areaBlendMode:qM.isRequired,areaBaselineValue:_.exports.oneOfType([_.exports.number,_.exports.string,_.exports.instanceOf(Date)]).isRequired,lineWidth:_.exports.number.isRequired,legends:_.exports.arrayOf(_.exports.shape(E0t)).isRequired,isInteractive:_.exports.bool.isRequired,debugMesh:_.exports.bool.isRequired,tooltip:_.exports.oneOfType([_.exports.func,_.exports.object]).isRequired,enableSlices:_.exports.oneOf(["x","y",!1]).isRequired,debugSlices:_.exports.bool.isRequired,sliceTooltip:_.exports.oneOfType([_.exports.func,_.exports.object]).isRequired,enableCrosshair:_.exports.bool.isRequired,crosshairType:_.exports.string.isRequired},z0t=Mn({},Ooe,{enablePointLabel:_.exports.bool.isRequired,role:_.exports.string.isRequired,useMesh:_.exports.bool.isRequired},Xm,Hvt),G0t=Mn({pixelRatio:_.exports.number.isRequired},Ooe),Aoe={curve:"linear",xScale:{type:"point"},yScale:{type:"linear",min:0,max:"auto"},layers:["grid","markers","axes","areas","crosshair","lines","points","slices","mesh","legends"],axisBottom:{},axisLeft:{},enableGridX:!0,enableGridY:!0,enablePoints:!0,pointSize:6,pointColor:{from:"color"},pointBorderWidth:0,pointBorderColor:{theme:"background"},enablePointLabel:!1,pointLabel:"yFormatted",colors:{scheme:"nivo"},enableArea:!1,areaBaselineValue:0,areaOpacity:.2,areaBlendMode:"normal",lineWidth:2,legends:[],isInteractive:!0,tooltip:j0t,enableSlices:!1,debugSlices:!1,sliceTooltip:W0t,debugMesh:!1,enableCrosshair:!0,crosshairType:"bottom-left"},Na=Mn({},Aoe,{enablePointLabel:!1,useMesh:!1,animate:!0,motionConfig:"gentle",defs:[],fill:[],role:"img"}),Y0t=Mn({},Aoe,{pixelRatio:typeof window<"u"&&window.devicePixelRatio||1}),K0t=function(t){var e=t.curve;return J.exports.useMemo(function(){return oie().defined(function(r){return r.x!==null&&r.y!==null}).x(function(r){return r.x}).y(function(r){return r.y}).curve(Rie(e))},[e])},q0t=function(t){var e=t.curve,r=t.yScale,n=t.areaBaselineValue;return J.exports.useMemo(function(){return wyt().defined(function(i){return i.x!==null&&i.y!==null}).x(function(i){return i.x}).y1(function(i){return i.y}).curve(Rie(e)).y0(r(n))},[e,r,n])},X0t=function(t){var e=t.enableSlices,r=t.points,n=t.width,i=t.height;return J.exports.useMemo(function(){if(e===!1)return[];if(e==="x"){var o=new Map;return r.forEach(function(s){s.data.x!==null&&s.data.y!==null&&(o.has(s.x)?o.get(s.x).push(s):o.set(s.x,[s]))}),Array.from(o.entries()).sort(function(s,l){return s[0]-l[0]}).map(function(s,l,u){var c,f=s[0],h=s[1],d=u[l-1],p=u[l+1];return{id:f,x0:c=d?f-(f-d[0])/2:f,x:f,y0:0,y:0,width:p?f-c+(p[0]-f)/2:n-c,height:i,points:h.reverse()}})}if(e==="y"){var a=new Map;return r.forEach(function(s){s.data.x!==null&&s.data.y!==null&&(a.has(s.y)?a.get(s.y).push(s):a.set(s.y,[s]))}),Array.from(a.entries()).sort(function(s,l){return s[0]-l[0]}).map(function(s,l,u){var c,f,h=s[0],d=s[1],p=u[l-1],m=u[l+1];return c=p?h-(h-p[0])/2:h,f=m?h-c+(m[0]-h)/2:i-c,{id:h,x0:0,x:0,y0:c,y:h,width:n,height:f,points:d.reverse()}})}},[e,r])},xoe=function(t){var e=t.data,r=t.xScale,n=r===void 0?Na.xScale:r,i=t.xFormat,o=t.yScale,a=o===void 0?Na.yScale:o,s=t.yFormat,l=t.width,u=t.height,c=t.colors,f=c===void 0?Na.colors:c,h=t.curve,d=h===void 0?Na.curve:h,p=t.areaBaselineValue,m=p===void 0?Na.areaBaselineValue:p,g=t.pointColor,v=g===void 0?Na.pointColor:g,S=t.pointBorderColor,b=S===void 0?Na.pointBorderColor:S,E=t.enableSlices,T=E===void 0?Na.enableSlicesTooltip:E,N=jS(i),L=jS(s),V=Vie(f,"id"),B=pr(),k=xp(v,B),M=xp(b,B),G=J.exports.useState([]),j=G[0],q=G[1],te=J.exports.useMemo(function(){return n0t(e.filter(function(Y){return j.indexOf(Y.id)===-1}),n,a,l,u)},[e,j,n,a,l,u]),pe=te.xScale,ne=te.yScale,O=te.series,y=J.exports.useMemo(function(){var Y=e.map(function(oe){return{id:oe.id,label:oe.id,color:V(oe)}}),z=Y.map(function(oe){return Mn({},O.find(function(me){return me.id===oe.id}),{color:oe.color})}).filter(function(oe){return Boolean(oe.id)});return{legendData:Y.map(function(oe){return Mn({},oe,{hidden:!z.find(function(me){return me.id===oe.id})})}).reverse(),series:z}},[e,O,V]),R=y.legendData,C=y.series,A=J.exports.useCallback(function(Y){q(function(z){return z.indexOf(Y)>-1?z.filter(function(oe){return oe!==Y}):[].concat(z,[Y])})},[]),P=function(Y){var z=Y.series,oe=Y.getPointColor,me=Y.getPointBorderColor,re=Y.formatX,ge=Y.formatY;return J.exports.useMemo(function(){return z.reduce(function(ve,ie){return[].concat(ve,ie.data.filter(function(be){return be.position.x!==null&&be.position.y!==null}).map(function(be,ce){var _e={id:ie.id+"."+ce,index:ve.length+ce,serieId:ie.id,serieColor:ie.color,x:be.position.x,y:be.position.y};return _e.color=oe(ie),_e.borderColor=me(_e),_e.data=Mn({},be.data,{xFormatted:re(be.data.x),yFormatted:ge(be.data.y)}),_e}))},[])},[z,oe,me,re,ge])}({series:C,getPointColor:k,getPointBorderColor:M,formatX:N,formatY:L}),H=X0t({enableSlices:T,points:P,width:l,height:u});return{legendData:R,toggleSerie:A,lineGenerator:K0t({curve:d}),areaGenerator:q0t({curve:d,yScale:ne,areaBaselineValue:m}),getColor:V,series:C,xScale:pe,yScale:ne,slices:H,points:P}},Ioe=function(t){var e=t.areaBlendMode,r=t.areaOpacity,n=t.color,i=t.fill,o=t.path,a=co(),s=a.animate,l=a.config,u=KM(o),c=Sa({color:n,config:l,immediate:!s});return he.jsx(kr.path,{d:u,fill:i||c.color,fillOpacity:r,strokeWidth:0,style:{mixBlendMode:e}})};Ioe.propTypes={areaBlendMode:qM.isRequired,areaOpacity:_.exports.number.isRequired,color:_.exports.string,fill:_.exports.string,path:_.exports.string.isRequired};var Moe=function(t){var e=t.areaGenerator,r=t.areaOpacity,n=t.areaBlendMode,i=t.lines.slice(0).reverse();return he.jsx("g",{children:i.map(function(o){return he.jsx(Ioe,Mn({path:e(o.data.map(function(a){return a.position}))},Mn({areaOpacity:r,areaBlendMode:n},o)),o.id)})})};Moe.propTypes={areaGenerator:_.exports.func.isRequired,areaOpacity:_.exports.number.isRequired,areaBlendMode:qM.isRequired,lines:_.exports.arrayOf(_.exports.object).isRequired};var Q0t=J.exports.memo(Moe),Noe=function(t){var e=t.lineGenerator,r=t.points,n=t.color,i=t.thickness,o=J.exports.useMemo(function(){return e(r)},[e,r]),a=KM(o);return he.jsx(kr.path,{d:a,fill:"none",strokeWidth:i,stroke:n})};Noe.propTypes={points:_.exports.arrayOf(_.exports.shape({x:_.exports.oneOfType([_.exports.string,_.exports.number]),y:_.exports.oneOfType([_.exports.string,_.exports.number])})),lineGenerator:_.exports.func.isRequired,color:_.exports.string.isRequired,thickness:_.exports.number.isRequired};var Z0t=J.exports.memo(Noe),Poe=function(t){var e=t.lines,r=t.lineGenerator,n=t.lineWidth;return e.slice(0).reverse().map(function(i){var o=i.id,a=i.data,s=i.color;return he.jsx(Z0t,{id:o,points:a.map(function(l){return l.position}),lineGenerator:r,color:s,thickness:n},o)})};Poe.propTypes={lines:_.exports.arrayOf(_.exports.shape({id:_.exports.oneOfType([_.exports.string,_.exports.number]).isRequired,color:_.exports.string.isRequired,data:_.exports.arrayOf(_.exports.shape({data:_.exports.shape({x:_.exports.oneOfType([_.exports.string,_.exports.number,_.exports.instanceOf(Date)]),y:_.exports.oneOfType([_.exports.string,_.exports.number,_.exports.instanceOf(Date)])}).isRequired,position:_.exports.shape({x:_.exports.number,y:_.exports.number}).isRequired})).isRequired})).isRequired,lineWidth:_.exports.number.isRequired,lineGenerator:_.exports.func.isRequired};var J0t=J.exports.memo(Poe),koe=function(t){var e=t.slice,r=t.axis,n=t.debug,i=t.tooltip,o=t.isCurrent,a=t.setCurrent,s=Z1(),l=s.showTooltipFromEvent,u=s.hideTooltip,c=J.exports.useCallback(function(d){l(J.exports.createElement(i,{slice:e,axis:r}),d,"right"),a(e)},[l,i,e]),f=J.exports.useCallback(function(d){l(J.exports.createElement(i,{slice:e,axis:r}),d,"right")},[l,i,e]),h=J.exports.useCallback(function(){u(),a(null)},[u]);return he.jsx("rect",{x:e.x0,y:e.y0,width:e.width,height:e.height,stroke:"red",strokeWidth:n?1:0,strokeOpacity:.75,fill:"red",fillOpacity:o&&n?.35:0,onMouseEnter:c,onMouseMove:f,onMouseLeave:h})};koe.propTypes={slice:_.exports.object.isRequired,axis:_.exports.oneOf(["x","y"]).isRequired,debug:_.exports.bool.isRequired,height:_.exports.number.isRequired,tooltip:_.exports.oneOfType([_.exports.func,_.exports.object]),isCurrent:_.exports.bool.isRequired,setCurrent:_.exports.func.isRequired};var ebt=J.exports.memo(koe),$oe=function(t){var e=t.slices,r=t.axis,n=t.debug,i=t.height,o=t.tooltip,a=t.current,s=t.setCurrent;return e.map(function(l){return he.jsx(ebt,{slice:l,axis:r,debug:n,height:i,tooltip:o,setCurrent:s,isCurrent:a!==null&&a.id===l.id},l.id)})};$oe.propTypes={slices:_.exports.arrayOf(_.exports.shape({id:_.exports.oneOfType([_.exports.number,_.exports.string,_.exports.instanceOf(Date)]).isRequired,x:_.exports.number.isRequired,y:_.exports.number.isRequired,points:_.exports.arrayOf(_.exports.object).isRequired})).isRequired,axis:_.exports.oneOf(["x","y"]).isRequired,debug:_.exports.bool.isRequired,height:_.exports.number.isRequired,tooltip:_.exports.oneOfType([_.exports.func,_.exports.object]).isRequired,current:_.exports.object,setCurrent:_.exports.func.isRequired};var tbt=J.exports.memo($oe),Loe=function(t){var e=t.points,r=t.symbol,n=t.size,i=t.borderWidth,o=t.enableLabel,a=t.label,s=t.labelYOffset,l=pr(),u=s1t(a),c=e.slice(0).reverse().map(function(f){return{id:f.id,x:f.x,y:f.y,datum:f.data,fill:f.color,stroke:f.borderColor,label:o?u(f.data):null}});return he.jsx("g",{children:c.map(function(f){return he.jsx(i1t,{x:f.x,y:f.y,datum:f.datum,symbol:r,size:n,color:f.fill,borderWidth:i,borderColor:f.stroke,label:f.label,labelYOffset:s,theme:l},f.id)})})};Loe.propTypes={points:_.exports.arrayOf(_.exports.object),symbol:_.exports.func,size:_.exports.number.isRequired,color:_.exports.func.isRequired,borderWidth:_.exports.number.isRequired,borderColor:_.exports.func.isRequired,enableLabel:_.exports.bool.isRequired,label:_.exports.oneOfType([_.exports.string,_.exports.func]).isRequired,labelYOffset:_.exports.number};var rbt=J.exports.memo(Loe),Doe=function(t){var e=t.points,r=t.width,n=t.height,i=t.margin,o=t.setCurrent,a=t.onMouseEnter,s=t.onMouseMove,l=t.onMouseLeave,u=t.onClick,c=t.tooltip,f=t.debug,h=Z1(),d=h.showTooltipAt,p=h.hideTooltip,m=J.exports.useCallback(function(b,E){d(J.exports.createElement(c,{point:b}),[b.x+i.left,b.y+i.top],"top"),o(b),a&&a(b,E)},[o,d,c,a,i]),g=J.exports.useCallback(function(b,E){d(J.exports.createElement(c,{point:b}),[b.x+i.left,b.y+i.top],"top"),o(b),s&&s(b,E)},[o,d,c,s]),v=J.exports.useCallback(function(b,E){p(),o(null),l&&l(b,E)},[p,o,l]),S=J.exports.useCallback(function(b,E){u&&u(b,E)},[u]);return he.jsx(B0t,{nodes:e,width:r,height:n,onMouseEnter:m,onMouseMove:g,onMouseLeave:v,onClick:S,debug:f})};Doe.propTypes={points:_.exports.arrayOf(_.exports.object).isRequired,width:_.exports.number.isRequired,height:_.exports.number.isRequired,margin:_.exports.object.isRequired,setCurrent:_.exports.func.isRequired,onMouseEnter:_.exports.func,onMouseMove:_.exports.func,onMouseLeave:_.exports.func,onClick:_.exports.func,tooltip:_.exports.oneOfType([_.exports.func,_.exports.object]).isRequired,debug:_.exports.bool.isRequired};var nbt=J.exports.memo(Doe),F4=function(t){var e=t.data,r=t.xScale,n=t.xFormat,i=t.yScale,o=t.yFormat,a=t.layers,s=t.curve,l=t.areaBaselineValue,u=t.colors,c=t.margin,f=t.width,h=t.height,d=t.axisTop,p=t.axisRight,m=t.axisBottom,g=t.axisLeft,v=t.enableGridX,S=t.enableGridY,b=t.gridXValues,E=t.gridYValues,T=t.lineWidth,N=t.enableArea,L=t.areaOpacity,V=t.areaBlendMode,B=t.enablePoints,k=t.pointSymbol,M=t.pointSize,G=t.pointColor,j=t.pointBorderWidth,q=t.pointBorderColor,te=t.enablePointLabel,pe=t.pointLabel,ne=t.pointLabelYOffset,O=t.defs,y=t.fill,R=t.markers,C=t.legends,A=t.isInteractive,P=t.useMesh,H=t.debugMesh,Y=t.onMouseEnter,z=t.onMouseMove,oe=t.onMouseLeave,me=t.onClick,re=t.tooltip,ge=t.enableSlices,ve=t.debugSlices,ie=t.sliceTooltip,be=t.enableCrosshair,ce=t.crosshairType,_e=t.role,Ie=h5(f,h,c),Oe=Ie.margin,Ae=Ie.innerWidth,xe=Ie.innerHeight,I=Ie.outerWidth,D=Ie.outerHeight,U=xoe({data:e,xScale:r,xFormat:n,yScale:i,yFormat:o,width:Ae,height:xe,colors:u,curve:s,areaBaselineValue:l,pointColor:G,pointBorderColor:q,enableSlices:ge}),ae=U.legendData,X=U.toggleSerie,le=U.lineGenerator,ee=U.areaGenerator,Z=U.series,ue=U.xScale,K=U.yScale,se=U.slices,we=U.points,Se=pr(),Me=xp(G,Se),qe=xp(q,Se),ke=J.exports.useState(null),We=ke[0],Ke=ke[1],Xe=J.exports.useState(null),nt=Xe[0],Rt=Xe[1],it={grid:he.jsx(voe,{theme:Se,width:Ae,height:xe,xScale:v?ue:null,yScale:S?K:null,xValues:b,yValues:E},"grid"),markers:he.jsx(kie,{markers:R,width:Ae,height:xe,xScale:ue,yScale:K,theme:Se},"markers"),axes:he.jsx(yoe,{xScale:ue,yScale:K,width:Ae,height:xe,theme:Se,top:d,right:p,bottom:m,left:g},"axes"),areas:null,lines:he.jsx(J0t,{lines:Z,lineGenerator:le,lineWidth:T},"lines"),slices:null,points:null,crosshair:null,mesh:null,legends:C.map(function(rt,Lt){return he.jsx(Roe,Mn({},rt,{containerWidth:Ae,containerHeight:xe,data:rt.data||ae,theme:Se,toggleSerie:rt.toggleSerie?X:void 0}),"legend."+Lt)})},st=Fie(O,Z,y);return N&&(it.areas=he.jsx(Q0t,{areaGenerator:ee,areaOpacity:L,areaBlendMode:V,lines:Z},"areas")),A&&ge!==!1&&(it.slices=he.jsx(tbt,{slices:se,axis:ge,debug:ve,height:xe,tooltip:ie,current:nt,setCurrent:Rt},"slices")),B&&(it.points=he.jsx(rbt,{points:we,symbol:k,size:M,color:Me,borderWidth:j,borderColor:qe,enableLabel:te,label:pe,labelYOffset:ne},"points")),A&&be&&(We!==null&&(it.crosshair=he.jsx(y4,{width:Ae,height:xe,x:We.x,y:We.y,type:ce},"crosshair")),nt!==null&&(it.crosshair=he.jsx(y4,{width:Ae,height:xe,x:nt.x,y:nt.y,type:ge},"crosshair"))),A&&P&&ge===!1&&(it.mesh=he.jsx(nbt,{points:we,width:Ae,height:xe,margin:Oe,current:We,setCurrent:Ke,onMouseEnter:Y,onMouseMove:z,onMouseLeave:oe,onClick:me,tooltip:re,debug:H},"mesh")),he.jsx(XM,{defs:st,width:I,height:D,margin:Oe,role:_e,children:a.map(function(rt,Lt){return typeof rt=="function"?he.jsx(J.exports.Fragment,{children:rt(Mn({},t,{innerWidth:Ae,innerHeight:xe,series:Z,slices:se,points:we,xScale:ue,yScale:K,lineGenerator:le,areaGenerator:ee,currentPoint:We,setCurrentPoint:Ke,currentSlice:nt,setCurrentSlice:Rt}))},Lt):it[rt]})})};F4.propTypes=z0t,F4.defaultProps=Na;var ibt=$ie(F4),obt=function(t){return he.jsx(t0,{children:function(e){var r=e.width,n=e.height;return he.jsx(ibt,Mn({width:r,height:n},t))}})},H4=function(t){var e=t.width,r=t.height,n=t.margin,i=t.pixelRatio,o=t.data,a=t.xScale,s=t.xFormat,l=t.yScale,u=t.yFormat,c=t.curve,f=t.layers,h=t.colors,d=t.lineWidth,p=t.enableArea,m=t.areaBaselineValue,g=t.areaOpacity,v=t.enablePoints,S=t.pointSize,b=t.pointColor,E=t.pointBorderWidth,T=t.pointBorderColor,N=t.enableGridX,L=t.gridXValues,V=t.enableGridY,B=t.gridYValues,k=t.axisTop,M=t.axisRight,G=t.axisBottom,j=t.axisLeft,q=t.legends,te=t.isInteractive,pe=t.debugMesh,ne=t.onMouseLeave,O=t.onClick,y=t.tooltip,R=t.canvasRef,C=J.exports.useRef(null),A=h5(e,r,n),P=A.margin,H=A.innerWidth,Y=A.innerHeight,z=A.outerWidth,oe=A.outerHeight,me=pr(),re=J.exports.useState(null),ge=re[0],ve=re[1],ie=xoe({data:o,xScale:a,xFormat:s,yScale:l,yFormat:u,width:H,height:Y,colors:h,curve:c,areaBaselineValue:m,pointColor:b,pointBorderColor:T}),be=ie.lineGenerator,ce=ie.areaGenerator,_e=ie.series,Ie=ie.xScale,Oe=ie.yScale,Ae=ie.points,xe=Coe({points:Ae,width:H,height:Y,debug:pe}),I=xe.delaunay,D=xe.voronoi;J.exports.useEffect(function(){R&&(R.current=C.current),C.current.width=z*i,C.current.height=oe*i;var K=C.current.getContext("2d");K.scale(i,i),K.fillStyle=me.background,K.fillRect(0,0,z,oe),K.translate(P.left,P.top),f.forEach(function(se){if(typeof se=="function"&&se({ctx:K,innerWidth:H,innerHeight:Y,series:_e,points:Ae,xScale:Ie,yScale:Oe,lineWidth:d,lineGenerator:be,areaGenerator:ce,currentPoint:ge,setCurrentPoint:ve}),se==="grid"&&me.grid.line.strokeWidth>0&&(K.lineWidth=me.grid.line.strokeWidth,K.strokeStyle=me.grid.line.stroke,N&&KS(K,{width:H,height:Y,scale:Ie,axis:"x",values:L}),V&&KS(K,{width:H,height:Y,scale:Oe,axis:"y",values:B})),se==="axes"&&boe(K,{xScale:Ie,yScale:Oe,width:H,height:Y,top:k,right:M,bottom:G,left:j,theme:me}),se==="areas"&&p===!0&&(K.save(),K.globalAlpha=g,ce.context(K),_e.forEach(function(Se){K.fillStyle=Se.color,K.beginPath(),ce(Se.data.map(function(Me){return Me.position})),K.fill()}),K.restore()),se==="lines"&&(be.context(K),_e.forEach(function(Se){K.strokeStyle=Se.color,K.lineWidth=d,K.beginPath(),be(Se.data.map(function(Me){return Me.position})),K.stroke()})),se==="points"&&v===!0&&S>0&&Ae.forEach(function(Se){K.fillStyle=Se.color,K.beginPath(),K.arc(Se.x,Se.y,S/2,0,2*Math.PI),K.fill(),E>0&&(K.strokeStyle=Se.borderColor,K.lineWidth=E,K.stroke())}),se==="mesh"&&pe===!0&&(U0t(K,D),ge&&V0t(K,D,ge.index)),se==="legends"){var we=_e.map(function(Se){return{id:Se.id,label:Se.id,color:Se.color}}).reverse();q.forEach(function(Se){Eoe(K,Mn({},Se,{data:Se.data||we,containerWidth:H,containerHeight:Y,theme:me}))})}})},[C,z,oe,f,me,be,_e,Ie,Oe,N,L,V,B,k,M,G,j,q,Ae,v,S,ge]);var U=J.exports.useCallback(function(K){var se=Eg(C.current,K),we=se[0],Se=se[1];if(!Die(P.left,P.top,H,Y,we,Se))return null;var Me=I.find(we-P.left,Se-P.top);return Ae[Me]},[C,P,H,Y,I]),ae=Z1(),X=ae.showTooltipFromEvent,le=ae.hideTooltip,ee=J.exports.useCallback(function(K){var se=U(K);ve(se),se?X(J.exports.createElement(y,{point:se}),K):le()},[U,ve,X,le,y]),Z=J.exports.useCallback(function(K){le(),ve(null),ge&&ne&&ne(ge,K)},[le,ve,ne]),ue=J.exports.useCallback(function(K){if(O){var se=U(K);se&&O(se,K)}},[U,O]);return he.jsx("canvas",{ref:C,width:z*i,height:oe*i,style:{width:z,height:oe,cursor:te?"auto":"normal"},onMouseEnter:te?ee:void 0,onMouseMove:te?ee:void 0,onMouseLeave:te?Z:void 0,onClick:te?ue:void 0})};H4.propTypes=G0t,H4.defaultProps=Y0t;var abt=$ie(H4),sbt=J.exports.forwardRef(function(t,e){return he.jsx(abt,Mn({},t,{canvasRef:e}))});J.exports.forwardRef(function(t,e){return he.jsx(t0,{children:function(r){var n=r.width,i=r.height;return he.jsx(sbt,Mn({width:n,height:i},t,{ref:e}))}})});const uz=["#77DD77","#836953","#89cff0","#9adedb","#aa9499","#cb99c9","#ff9899","#e8c1a0","#f47560","#f1e15b","#e8a838","#61cdbb","#97e3d5"],XS=["savings","spending"];function lbt(t,e,r){let n={savings:[],spending:[]};return t.forEach((o,a)=>{var c;let s=t[a+1],l;if(s===void 0?l=r.filter(f=>f.datetime>=o):l=r.filter(f=>f.datetime>=o&&f.datetime<s),l.length===0)return;let u=xt.unix((c=on.exports.sortBy(l,["datetime"])[l.length-1])==null?void 0:c.datetime).format("MMM");e.map(f=>{switch(f){case XS[0]:n[f].push({x:u,y:on.exports.round(l.reduce((d,p)=>d+=$z.includes(p.txn_type)?Number(p.amount):-Number(p.amount),0),2)});break;case XS[1]:n[f].push({x:u,y:on.exports.round(l.reduce((d,p)=>d+=Vf.includes(p.txn_type)?Number(p.amount):0,0),2)});break;default:f in n||(n[f]=[]);let h=[];f.includes("/")?(h=l.filter(d=>d.name.toLowerCase()===f.substring(1)&&Vf.includes(d.txn_type)),n[f].push({x:u,y:on.exports.round(h.reduce((d,p)=>d+Number(p.amount),0),2)})):(h=l.filter(d=>d.category===f&&Vf.includes(d.txn_type)),n[f].push({x:u,y:on.exports.round(h.reduce((d,p)=>d+Number(p.amount),0),2)}));break}})}),Object.keys(n).map((o,a)=>({id:o,data:n[o],color:o==="spending"?"#fa0690":o==="savings"?"#128795":uz[(a-2)%uz.length]}))}const ubt=()=>{const t=n1(g=>g.database),[e]=Cs(V4),[r,n]=J.exports.useState("all"),[i,o]=J.exports.useState(()=>[]),[a,s]=J.exports.useState(()=>[]),[l,u]=J.exports.useState(),[c,f]=J.exports.useState(6),h=Xi.exports.useLiveQuery(async()=>{const g=[...(await t.expenditure.where({txn_type:pn.SALARY}).toArray()).map(L=>L.datetime),xt().unix()].filter(L=>L>xt().subtract(c,"month").unix());if(g.length<2)return[];const v=Vv(await t.recurring.where("start").belowOrEqual(xt().unix()).toArray(),g[0],xt().unix()),S=await t.expenditure.toArray(),b=on.exports.uniq((await t.expenditure.toArray()).map(L=>L.category)),E=on.exports.uniq((await t.expenditure.toArray()).map(L=>`/${L.name.toLowerCase()}`)),T=on.exports.sortBy([...S,...v],["datetime"]);return lbt(g,["spending","savings"].concat(b).concat(E),T)},[c]),d=Xi.exports.useLiveQuery(async()=>(await t.expenditure.toArray()).filter(g=>Vf.includes(g.txn_type)).reduce((g,v)=>{let S=g,b=g.find(E=>E.name===v.category);if(b===void 0)S.push({name:v.category,count:Number(v.amount)});else{let E=g.indexOf(b);S[E]={...b,count:b.count+Number(v.amount)}}return g},[]).sort((g,v)=>v.count-g.count).map(g=>g.name)),p=Xi.exports.useLiveQuery(async()=>on.exports.uniq((await t.expenditure.toArray()).filter(g=>Vf.includes(g.txn_type)&&i.includes(g.category)).reduce((g,v)=>{let S=g,b=g.find(E=>E.name===v.name);if(b===void 0)S.push({name:v.name,count:Number(v.amount)});else{let E=g.indexOf(b);S[E]={...b,count:b.count+Number(v.amount)}}return g},[]).sort((g,v)=>v.count-g.count).map(g=>`/${g.name.toLowerCase()}`)),[i]),m=Xi.exports.useLiveQuery(async()=>{var S,b;const g=(S=await t.expenditure.orderBy("datetime").first())==null?void 0:S.datetime,v=(b=await t.expenditure.orderBy("datetime").last())==null?void 0:b.datetime;return g===void 0||v===void 0?12:xt.unix(v).diff(xt.unix(g),"month")+1});return J.exports.useEffect(()=>{u(h==null?void 0:h.filter(g=>{switch(r){case"all":return XS.includes(g.id);case"spending":return i.length===0?g.id==="spending":a.length===0?i.includes(g.id):a.includes(g.id);default:return g.id===r}}))},[r,h,i,a]),(h||[]).length===0?de.createElement(de.Fragment,null):de.createElement(Ua,{sx:{width:"80vw",textAlign:"center"}},de.createElement(ms,{variant:"h6"},"Overall Savings and Spending"),de.createElement(Lm,{size:"small",label:"Last number of months",select:!0,fullWidth:!0,sx:{mt:2,mb:2},onChange:g=>f(Number(g.target.value))},Array.from({length:m||12},(g,v)=>v+1).map(g=>de.createElement(Pae,{value:g,key:`age-selector-${g}`},g))),de.createElement(Ua,{sx:on.exports.omit(Joe,["m"])},de.createElement(obt,{data:l||[],margin:{top:10,right:10,bottom:50,left:50},xScale:{type:"point"},yScale:{type:"linear",min:"auto",max:"auto"},theme:{axis:{legend:{text:{fill:e?"#939393":"#000"}},ticks:{text:{fill:e?"#939393":"#000"}}}},colors:g=>g.color,yFormat:" >-.2f",pointSize:10,pointColor:{theme:"background"},pointBorderWidth:2,pointBorderColor:{from:"serieColor"},pointLabelYOffset:-12,useMesh:!0,tooltip:g=>de.createElement(eae,null,de.createElement(ms,null,g.point.serieId.replace("/","")),de.createElement(ms,null,g.point.data.x,": ",g.point.data.y))})),de.createElement(S5,{exclusive:!0,value:r,onChange:(g,v)=>{o([]),v!==null&&n(v)}},XS.concat("all").map(g=>de.createElement(w5,{size:"small",value:g},g))),de.createElement(Ua,{sx:{overflowX:"auto",whiteSpace:"nowrap"}},de.createElement(S5,{value:i,onChange:(g,v)=>o(v)},d!==void 0&&r==="spending"&&(d==null?void 0:d.map(g=>de.createElement(w5,{size:"small",value:g,sx:{color:e?"lightgrey":"black"}},g))))),de.createElement(Ua,{sx:{overflowX:"auto",whiteSpace:"nowrap"}},de.createElement(S5,{value:a,onChange:(g,v)=>s(v)},p!==void 0&&p.length>0&&(p==null?void 0:p.map(g=>de.createElement(w5,{size:"small",value:g,sx:{color:e?"lightgrey":"black"}},g.substring(1)))))))};function cbt(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var fbt=cbt,hbt=Xp,dbt=Jz;function pbt(t,e){return t&&hbt(e,dbt(e),t)}var mbt=pbt,gbt=Xp,ybt=e0;function vbt(t,e){return t&&gbt(e,ybt(e),t)}var bbt=vbt,wbt=Xp,Sbt=eG;function Rbt(t,e){return wbt(t,Sbt(t),e)}var Ebt=Rbt,Cbt=kae,_bt=RM,Tbt=eG,Obt=$ae,Abt=Object.getOwnPropertySymbols,xbt=Abt?function(t){for(var e=[];t;)Cbt(e,Tbt(t)),t=_bt(t);return e}:Obt,Foe=xbt,Ibt=Xp,Mbt=Foe;function Nbt(t,e){return Ibt(t,Mbt(t),e)}var Pbt=Nbt,kbt=Lae,$bt=Foe,Lbt=e0;function Dbt(t){return kbt(t,Lbt,$bt)}var Hoe=Dbt,Fbt=Object.prototype,Hbt=Fbt.hasOwnProperty;function Bbt(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&Hbt.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var Ubt=Bbt,Vbt=SM;function jbt(t,e){var r=e?Vbt(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var Wbt=jbt,zbt=/\w*$/;function Gbt(t){var e=new t.constructor(t.source,zbt.exec(t));return e.lastIndex=t.lastIndex,e}var Ybt=Gbt,cz=Dae,fz=cz?cz.prototype:void 0,hz=fz?fz.valueOf:void 0;function Kbt(t){return hz?Object(hz.call(t)):{}}var qbt=Kbt,Xbt=SM,Qbt=Wbt,Zbt=Ybt,Jbt=qbt,e2t=Jre,t2t="[object Boolean]",r2t="[object Date]",n2t="[object Map]",i2t="[object Number]",o2t="[object RegExp]",a2t="[object Set]",s2t="[object String]",l2t="[object Symbol]",u2t="[object ArrayBuffer]",c2t="[object DataView]",f2t="[object Float32Array]",h2t="[object Float64Array]",d2t="[object Int8Array]",p2t="[object Int16Array]",m2t="[object Int32Array]",g2t="[object Uint8Array]",y2t="[object Uint8ClampedArray]",v2t="[object Uint16Array]",b2t="[object Uint32Array]";function w2t(t,e,r){var n=t.constructor;switch(e){case u2t:return Xbt(t);case t2t:case r2t:return new n(+t);case c2t:return Qbt(t,r);case f2t:case h2t:case d2t:case p2t:case m2t:case g2t:case y2t:case v2t:case b2t:return e2t(t,r);case n2t:return new n;case i2t:case s2t:return new n(t);case o2t:return Zbt(t);case a2t:return new n;case l2t:return Jbt(t)}}var S2t=w2t,R2t=G4,E2t=i1,C2t="[object Map]";function _2t(t){return E2t(t)&&R2t(t)==C2t}var T2t=_2t,O2t=T2t,A2t=JS,dz=z4.exports,pz=dz&&dz.isMap,x2t=pz?A2t(pz):O2t,I2t=x2t,M2t=G4,N2t=i1,P2t="[object Set]";function k2t(t){return N2t(t)&&M2t(t)==P2t}var $2t=k2t,L2t=$2t,D2t=JS,mz=z4.exports,gz=mz&&mz.isSet,F2t=gz?D2t(gz):L2t,H2t=F2t,B2t=Kz,U2t=fbt,V2t=EM,j2t=mbt,W2t=bbt,z2t=NS.exports,G2t=ene,Y2t=Ebt,K2t=Pbt,q2t=Fae,X2t=Hoe,Q2t=G4,Z2t=Ubt,J2t=S2t,ewt=tne,twt=W4,rwt=Yz.exports,nwt=I2t,iwt=Mp,owt=H2t,awt=Jz,swt=e0,lwt=1,uwt=2,cwt=4,Boe="[object Arguments]",fwt="[object Array]",hwt="[object Boolean]",dwt="[object Date]",pwt="[object Error]",Uoe="[object Function]",mwt="[object GeneratorFunction]",gwt="[object Map]",ywt="[object Number]",Voe="[object Object]",vwt="[object RegExp]",bwt="[object Set]",wwt="[object String]",Swt="[object Symbol]",Rwt="[object WeakMap]",Ewt="[object ArrayBuffer]",Cwt="[object DataView]",_wt="[object Float32Array]",Twt="[object Float64Array]",Owt="[object Int8Array]",Awt="[object Int16Array]",xwt="[object Int32Array]",Iwt="[object Uint8Array]",Mwt="[object Uint8ClampedArray]",Nwt="[object Uint16Array]",Pwt="[object Uint32Array]",ar={};ar[Boe]=ar[fwt]=ar[Ewt]=ar[Cwt]=ar[hwt]=ar[dwt]=ar[_wt]=ar[Twt]=ar[Owt]=ar[Awt]=ar[xwt]=ar[gwt]=ar[ywt]=ar[Voe]=ar[vwt]=ar[bwt]=ar[wwt]=ar[Swt]=ar[Iwt]=ar[Mwt]=ar[Nwt]=ar[Pwt]=!0;ar[pwt]=ar[Uoe]=ar[Rwt]=!1;function V2(t,e,r,n,i,o){var a,s=e&lwt,l=e&uwt,u=e&cwt;if(r&&(a=i?r(t,n,i,o):r(t)),a!==void 0)return a;if(!iwt(t))return t;var c=twt(t);if(c){if(a=Z2t(t),!s)return G2t(t,a)}else{var f=Q2t(t),h=f==Uoe||f==mwt;if(rwt(t))return z2t(t,s);if(f==Voe||f==Boe||h&&!i){if(a=l||h?{}:ewt(t),!s)return l?K2t(t,W2t(a,t)):Y2t(t,j2t(a,t))}else{if(!ar[f])return i?t:{};a=J2t(t,f,s)}}o||(o=new B2t);var d=o.get(t);if(d)return d;o.set(t,a),owt(t)?t.forEach(function(g){a.add(V2(g,e,r,g,t,o))}):nwt(t)&&t.forEach(function(g,v){a.set(v,V2(g,e,r,v,t,o))});var p=u?l?X2t:q2t:l?swt:awt,m=c?void 0:p(t);return U2t(m||t,function(g,v){m&&(v=g,g=t[v]),V2t(a,v,V2(g,e,r,v,t,o))}),a}var kwt=V2,$wt=Zz,Lwt=Hae;function Dwt(t,e){return e.length<2?t:$wt(t,Lwt(e,0,-1))}var Fwt=Dwt,Hwt=ZS,Bwt=Qe,Uwt=Fwt,Vwt=Xz;function jwt(t,e){return e=Hwt(e,t),t=Uwt(t,e),t==null||delete t[Vwt(Bwt(e))]}var Wwt=jwt,zwt=J1;function Gwt(t){return zwt(t)?void 0:t}var Ywt=Gwt,Kwt=Qz,qwt=kwt,Xwt=Wwt,Qwt=ZS,Zwt=Xp,Jwt=Ywt,eSt=wie,tSt=Hoe,rSt=1,nSt=2,iSt=4,oSt=eSt(function(t,e){var r={};if(t==null)return r;var n=!1;e=Kwt(e,function(o){return o=Qwt(o,t),n||(n=o.length>1),o}),Zwt(t,tSt(t),r),n&&(r=qwt(r,rSt|nSt|iSt,Jwt));for(var i=e.length;i--;)Xwt(r,e[i]);return r}),joe=oSt,aSt=Bae;function sSt(t,e){var r=[];return aSt(t,function(n,i,o){e(n,i,o)&&r.push(n)}),r}var lSt=sSt,uSt=Vae,cSt=lSt,fSt=Uae,hSt=W4;function dSt(t,e){var r=hSt(t)?uSt:cSt;return r(t,fSt(e))}var pSt=dSt;function ma(){return ma=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ma.apply(this,arguments)}var B4={dotSize:4,noteWidth:120,noteTextOffset:8,animate:!0,motionStiffness:90,motionDamping:13},mSt=function(t){var e=typeof t;return J.exports.isValidElement(t)||e==="string"||e==="function"||e==="object"},gSt=function(t){var e=typeof t;return e==="string"||e==="function"},t1=function(t){return t.type==="circle"},U4=function(t){return t.type==="dot"},r1=function(t){return t.type==="rect"},ySt=function(t){var e=t.data,r=t.annotations,n=t.getPosition,i=t.getDimensions;return r.reduce(function(o,a){var s=a.offset||0;return[].concat(o,pSt(e,a.match).map(function(l){var u=n(l),c=i(l);return(t1(a)||r1(a))&&(c.size=c.size+2*s,c.width=c.width+2*s,c.height=c.height+2*s),ma({},joe(a,["match","offset"]),u,c,{size:a.size||c.size,datum:l})}))},[])},vSt=function(t,e,r,n){var i=Math.atan2(n-e,r-t);return Jvt(Qvt(i))},Woe=function(t){var e,r,n=t.x,i=t.y,o=t.noteX,a=t.noteY,s=t.noteWidth,l=s===void 0?B4.noteWidth:s,u=t.noteTextOffset,c=u===void 0?B4.noteTextOffset:u;if(oN(o))e=n+o;else{if(o.abs===void 0)throw new Error("noteX should be either a number or an object containing an 'abs' property");e=o.abs}if(oN(a))r=i+a;else{if(a.abs===void 0)throw new Error("noteY should be either a number or an object containing an 'abs' property");r=a.abs}var f=n,h=i,d=vSt(n,i,e,r);if(t1(t)){var p=Zvt(Jv(d),t.size/2);f+=p.x,h+=p.y}if(r1(t)){var m=Math.round((d+90)/45)%8;m===0&&(h-=t.height/2),m===1&&(f+=t.width/2,h-=t.height/2),m===2&&(f+=t.width/2),m===3&&(f+=t.width/2,h+=t.height/2),m===4&&(h+=t.height/2),m===5&&(f-=t.width/2,h+=t.height/2),m===6&&(f-=t.width/2),m===7&&(f-=t.width/2,h-=t.height/2)}var g=e,v=e;return(d+90)%360>180?(g-=l,v-=l):v+=l,{points:[[f,h],[e,r],[v,r]],text:[g,r-c],angle:d+90}},zoe=function(t){var e=t.data,r=t.annotations,n=t.getPosition,i=t.getDimensions;return J.exports.useMemo(function(){return ySt({data:e,annotations:r,getPosition:n,getDimensions:i})},[e,r,n,i])},bSt=function(t){var e=t.annotations;return J.exports.useMemo(function(){return e.map(function(r){return ma({},r,{computed:Woe(ma({},r))})})},[e])},wSt=function(t){return J.exports.useMemo(function(){return Woe(t)},[t])},SSt=function(t){var e=t.datum,r=t.x,n=t.y,i=t.note,o=pr(),a=co(),s=a.animate,l=a.config,u=Sa({x:r,y:n,config:l,immediate:!s});return typeof i=="function"?J.exports.createElement(i,{x:r,y:n,datum:e}):he.jsxs(he.Fragment,{children:[o.annotations.text.outlineWidth>0&&he.jsx(kr.text,{x:u.x,y:u.y,style:ma({},o.annotations.text,{strokeLinejoin:"round",strokeWidth:2*o.annotations.text.outlineWidth,stroke:o.annotations.text.outlineColor}),children:i}),he.jsx(kr.text,{x:u.x,y:u.y,style:joe(o.annotations.text,["outlineWidth","outlineColor"]),children:i})]})},yz=function(t){var e=t.points,r=t.isOutline,n=r!==void 0&&r,i=pr(),o=J.exports.useMemo(function(){var l=e[0];return e.slice(1).reduce(function(u,c){return u+" L"+c[0]+","+c[1]},"M"+l[0]+","+l[1])},[e]),a=KM(o);if(n&&i.annotations.link.outlineWidth<=0)return null;var s=ma({},i.annotations.link);return n&&(s.strokeLinecap="square",s.strokeWidth=i.annotations.link.strokeWidth+2*i.annotations.link.outlineWidth,s.stroke=i.annotations.link.outlineColor,s.opacity=i.annotations.link.outlineOpacity),he.jsx(kr.path,{fill:"none",d:a,style:s})},RSt=function(t){var e=t.x,r=t.y,n=t.size,i=pr(),o=co(),a=o.animate,s=o.config,l=Sa({x:e,y:r,radius:n/2,config:s,immediate:!a});return he.jsxs(he.Fragment,{children:[i.annotations.outline.outlineWidth>0&&he.jsx(kr.circle,{cx:l.x,cy:l.y,r:l.radius,style:ma({},i.annotations.outline,{fill:"none",strokeWidth:i.annotations.outline.strokeWidth+2*i.annotations.outline.outlineWidth,stroke:i.annotations.outline.outlineColor,opacity:i.annotations.outline.outlineOpacity})}),he.jsx(kr.circle,{cx:l.x,cy:l.y,r:l.radius,style:i.annotations.outline})]})},ESt=function(t){var e=t.x,r=t.y,n=t.size,i=n===void 0?B4.dotSize:n,o=pr(),a=co(),s=a.animate,l=a.config,u=Sa({x:e,y:r,radius:i/2,config:l,immediate:!s});return he.jsxs(he.Fragment,{children:[o.annotations.outline.outlineWidth>0&&he.jsx(kr.circle,{cx:u.x,cy:u.y,r:u.radius,style:ma({},o.annotations.outline,{fill:"none",strokeWidth:2*o.annotations.outline.outlineWidth,stroke:o.annotations.outline.outlineColor,opacity:o.annotations.outline.outlineOpacity})}),he.jsx(kr.circle,{cx:u.x,cy:u.y,r:u.radius,style:o.annotations.symbol})]})},CSt=function(t){var e=t.x,r=t.y,n=t.width,i=t.height,o=t.borderRadius,a=o===void 0?6:o,s=pr(),l=co(),u=l.animate,c=l.config,f=Sa({x:e-n/2,y:r-i/2,width:n,height:i,config:c,immediate:!u});return he.jsxs(he.Fragment,{children:[s.annotations.outline.outlineWidth>0&&he.jsx(kr.rect,{x:f.x,y:f.y,rx:a,ry:a,width:f.width,height:f.height,style:ma({},s.annotations.outline,{fill:"none",strokeWidth:s.annotations.outline.strokeWidth+2*s.annotations.outline.outlineWidth,stroke:s.annotations.outline.outlineColor,opacity:s.annotations.outline.outlineOpacity})}),he.jsx(kr.rect,{x:f.x,y:f.y,rx:a,ry:a,width:f.width,height:f.height,style:s.annotations.outline})]})},_St=function(t){var e=t.datum,r=t.x,n=t.y,i=t.note,o=wSt(t);if(!mSt(i))throw new Error("note should be a valid react element");return he.jsxs(he.Fragment,{children:[he.jsx(yz,{points:o.points,isOutline:!0}),t1(t)&&he.jsx(RSt,{x:r,y:n,size:t.size}),U4(t)&&he.jsx(ESt,{x:r,y:n,size:t.size}),r1(t)&&he.jsx(CSt,{x:r,y:n,width:t.width,height:t.height,borderRadius:t.borderRadius}),he.jsx(yz,{points:o.points}),he.jsx(SSt,{datum:e,x:o.text[0],y:o.text[1],note:i})]})},vz=function(t,e){e.forEach(function(r,n){var i=r[0],o=r[1];n===0?t.moveTo(i,o):t.lineTo(i,o)})},TSt=function(t,e){var r=e.annotations,n=e.theme;r.length!==0&&(t.save(),r.forEach(function(i){if(!gSt(i.note))throw new Error("note is invalid for canvas implementation");n.annotations.link.outlineWidth>0&&(t.lineCap="square",t.strokeStyle=n.annotations.link.outlineColor,t.lineWidth=n.annotations.link.strokeWidth+2*n.annotations.link.outlineWidth,t.beginPath(),vz(t,i.computed.points),t.stroke(),t.lineCap="butt"),t1(i)&&n.annotations.outline.outlineWidth>0&&(t.strokeStyle=n.annotations.outline.outlineColor,t.lineWidth=n.annotations.outline.strokeWidth+2*n.annotations.outline.outlineWidth,t.beginPath(),t.arc(i.x,i.y,i.size/2,0,2*Math.PI),t.stroke()),U4(i)&&n.annotations.symbol.outlineWidth>0&&(t.strokeStyle=n.annotations.symbol.outlineColor,t.lineWidth=2*n.annotations.symbol.outlineWidth,t.beginPath(),t.arc(i.x,i.y,i.size/2,0,2*Math.PI),t.stroke()),r1(i)&&n.annotations.outline.outlineWidth>0&&(t.strokeStyle=n.annotations.outline.outlineColor,t.lineWidth=n.annotations.outline.strokeWidth+2*n.annotations.outline.outlineWidth,t.beginPath(),t.rect(i.x-i.width/2,i.y-i.height/2,i.width,i.height),t.stroke()),t.strokeStyle=n.annotations.link.stroke,t.lineWidth=n.annotations.link.strokeWidth,t.beginPath(),vz(t,i.computed.points),t.stroke(),t1(i)&&(t.strokeStyle=n.annotations.outline.stroke,t.lineWidth=n.annotations.outline.strokeWidth,t.beginPath(),t.arc(i.x,i.y,i.size/2,0,2*Math.PI),t.stroke()),U4(i)&&(t.fillStyle=n.annotations.symbol.fill,t.beginPath(),t.arc(i.x,i.y,i.size/2,0,2*Math.PI),t.fill()),r1(i)&&(t.strokeStyle=n.annotations.outline.stroke,t.lineWidth=n.annotations.outline.strokeWidth,t.beginPath(),t.rect(i.x-i.width/2,i.y-i.height/2,i.width,i.height),t.stroke()),typeof i.note=="function"?i.note(t,{datum:i.datum,x:i.computed.text[0],y:i.computed.text[1],theme:n}):(t.font=n.annotations.text.fontSize+"px "+n.annotations.text.fontFamily,t.textAlign="left",t.textBaseline="alphabetic",t.fillStyle=n.annotations.text.fill,t.strokeStyle=n.annotations.text.outlineColor,t.lineWidth=2*n.annotations.text.outlineWidth,n.annotations.text.outlineWidth>0&&(t.lineJoin="round",t.strokeText(i.note,i.computed.text[0],i.computed.text[1]),t.lineJoin="miter"),t.fillText(i.note,i.computed.text[0],i.computed.text[1]))}),t.restore())};function Jt(){return Jt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Jt.apply(this,arguments)}function Zp(t,e){if(t==null)return{};var r,n,i={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(i[r]=t[r]);return i}var bz,OSt=function(t){var e=t.bars,r=t.annotations,n=zoe({data:e,annotations:r,getPosition:function(i){return{x:i.x+i.width/2,y:i.y+i.height/2}},getDimensions:function(i){var o=i.height,a=i.width;return{width:a,height:o,size:Math.max(a,o)}}});return he.jsx(he.Fragment,{children:n.map(function(i,o){return he.jsx(_St,Jt({},i),o)})})},ASt=function(t){var e=t.width,r=t.height,n=t.legends,i=t.toggleSerie;return he.jsx(he.Fragment,{children:n.map(function(o,a){var s,l=o[0],u=o[1];return he.jsx(Roe,Jt({},l,{containerWidth:e,containerHeight:r,data:(s=l.data)!=null?s:u,toggleSerie:l.toggleSerie&&l.dataFrom==="keys"?i:void 0}),a)})})},xSt=["data"],ISt=function(t){var e,r=t.bar,n=r.data,i=Zp(r,xSt),o=t.style,a=o.borderColor,s=o.color,l=o.height,u=o.labelColor,c=o.labelOpacity,f=o.labelX,h=o.labelY,d=o.transform,p=o.width,m=t.borderRadius,g=t.borderWidth,v=t.label,S=t.shouldRenderLabel,b=t.isInteractive,E=t.onClick,T=t.onMouseEnter,N=t.onMouseLeave,L=t.tooltip,V=t.isFocusable,B=t.ariaLabel,k=t.ariaLabelledBy,M=t.ariaDescribedBy,G=pr(),j=Z1(),q=j.showTooltipFromEvent,te=j.showTooltipAt,pe=j.hideTooltip,ne=J.exports.useMemo(function(){return function(){return J.exports.createElement(L,Jt({},i,n))}},[L,i,n]),O=J.exports.useCallback(function(H){E==null||E(Jt({color:i.color},n),H)},[i,n,E]),y=J.exports.useCallback(function(H){return q(ne(),H)},[q,ne]),R=J.exports.useCallback(function(H){T==null||T(n,H),q(ne(),H)},[n,T,q,ne]),C=J.exports.useCallback(function(H){N==null||N(n,H),pe()},[n,pe,N]),A=J.exports.useCallback(function(){te(ne(),[i.absX+i.width/2,i.absY])},[te,ne,i]),P=J.exports.useCallback(function(){pe()},[pe]);return he.jsxs(kr.g,{transform:d,children:[he.jsx(kr.rect,{width:m4(p,function(H){return Math.max(H,0)}),height:m4(l,function(H){return Math.max(H,0)}),rx:m,ry:m,fill:(e=n.fill)!=null?e:s,strokeWidth:g,stroke:a,focusable:V,tabIndex:V?0:void 0,"aria-label":B?B(n):void 0,"aria-labelledby":k?k(n):void 0,"aria-describedby":M?M(n):void 0,onMouseEnter:b?R:void 0,onMouseMove:b?y:void 0,onMouseLeave:b?C:void 0,onClick:b?O:void 0,onFocus:b&&V?A:void 0,onBlur:b&&V?P:void 0}),S&&he.jsx(kr.text,{x:f,y:h,textAnchor:"middle",dominantBaseline:"central",fillOpacity:c,style:Jt({},G.labels.text,{pointerEvents:"none",fill:u}),children:v})]})},MSt=["color","label"],fr={indexBy:"id",keys:["value"],groupMode:"stacked",layout:"vertical",reverse:!1,minValue:"auto",maxValue:"auto",valueScale:{type:"linear"},indexScale:{type:"band",round:!0},padding:.1,innerPadding:0,axisBottom:{},axisLeft:{},enableGridX:!1,enableGridY:!0,enableLabel:!0,label:"formattedValue",labelSkipWidth:0,labelSkipHeight:0,labelTextColor:{from:"theme",theme:"labels.text.fill"},colorBy:"id",colors:{scheme:"nivo"},borderRadius:0,borderWidth:0,borderColor:{from:"color"},isInteractive:!0,tooltip:function(t){var e=t.color,r=t.label,n=Zp(t,MSt);return he.jsx(Kre,{id:r,value:n.formattedValue,enableChip:!0,color:e})},tooltipLabel:function(t){return t.id+" - "+t.indexValue},legends:[],initialHiddenIds:[],annotations:[],markers:[]},xr=Jt({},fr,{layers:["grid","axes","bars","markers","legends","annotations"],barComponent:ISt,defs:[],fill:[],animate:!0,motionConfig:"default",role:"img",isFocusable:!1}),ni=Jt({},fr,{layers:["grid","axes","bars","legends","annotations"],pixelRatio:typeof window<"u"&&(bz=window.devicePixelRatio)!=null?bz:1}),Goe=function(t,e,r,n,i,o){return e1(n,{all:t.map(e),min:0,max:0},i,o).padding(r)},Yoe=function(t,e){return t.map(function(r){return Jt({},e.reduce(function(n,i){return n[i]=null,n},{}),r)})},p5=function(t){return Object.keys(t).reduce(function(e,r){return t[r]&&(e[r]=t[r]),e},{})},m5=function(t){return[t,Number(t)]},NSt=["layout","minValue","maxValue","reverse","width","height","padding","innerPadding","valueScale","indexScale","hiddenIds"],tN=function(t,e){return t>e},Koe=function(t,e){return t<e},qoe=function(t,e){return Array.from(" ".repeat(e-t),function(r,n){return t+n})},PSt=function(t){return tN(t,0)?0:t},kSt=function(t,e,r,n){var i=t.data,o=t.formatValue,a=t.getColor,s=t.getIndex,l=t.getTooltipLabel,u=t.innerPadding,c=u===void 0?0:u,f=t.keys,h=t.xScale,d=t.yScale,p=t.margin,m=r?Koe:tN,g=i.map(p5),v=[];return f.forEach(function(S,b){return qoe(0,h.domain().length).forEach(function(E){var T,N,L,V=m5(i[E][S]),B=V[0],k=V[1],M=s(i[E]),G=((T=h(M))!=null?T:0)+e*b+c*b,j=m(N=k,0)?(L=d(N))!=null?L:0:n,q=function(pe,ne){var O;return m(pe,0)?n-ne:((O=d(pe))!=null?O:0)-n}(k,j),te={id:S,value:B===null?B:k,formattedValue:o(k),hidden:!1,index:E,indexValue:M,data:g[E]};v.push({key:S+"."+te.indexValue,index:v.length,data:te,x:G,y:j,absX:p.left+G,absY:p.top+j,width:e,height:q,color:a(te),label:l(te)})})}),v},$St=function(t,e,r,n){var i=t.data,o=t.formatValue,a=t.getIndex,s=t.getColor,l=t.getTooltipLabel,u=t.keys,c=t.innerPadding,f=c===void 0?0:c,h=t.xScale,d=t.yScale,p=t.margin,m=r?Koe:tN,g=i.map(p5),v=[];return u.forEach(function(S,b){return qoe(0,d.domain().length).forEach(function(E){var T,N,L,V=m5(i[E][S]),B=V[0],k=V[1],M=a(i[E]),G=m(N=k,0)?n:(L=h(N))!=null?L:0,j=((T=d(M))!=null?T:0)+e*b+f*b,q=function(pe,ne){var O;return m(pe,0)?((O=h(pe))!=null?O:0)-n:n-ne}(k,G),te={id:S,value:B===null?B:k,formattedValue:o(k),hidden:!1,index:E,indexValue:M,data:g[E]};v.push({key:S+"."+te.indexValue,index:v.length,data:te,x:G,y:j,absX:p.left+G,absY:p.top+j,width:q,height:e,color:s(te),label:l(te)})})}),v},LSt=function(t){var e,r,n=t.layout,i=t.minValue,o=t.maxValue,a=t.reverse,s=t.width,l=t.height,u=t.padding,c=u===void 0?0:u,f=t.innerPadding,h=f===void 0?0:f,d=t.valueScale,p=t.indexScale,m=t.hiddenIds,g=m===void 0?[]:m,v=Zp(t,NSt),S=v.keys.filter(function(R){return!g.includes(R)}),b=Yoe(v.data,S),E=n==="vertical"?["y","x",s]:["x","y",l],T=E[0],N=E[1],L=E[2],V=Goe(b,v.getIndex,c,p,L,N),B=Jt({max:o,min:i,reverse:a},d),k=B.min==="auto"?PSt:function(R){return R},M=b.reduce(function(R,C){return[].concat(R,S.map(function(A){return C[A]}))},[]).filter(Boolean),G=k(Math.min.apply(Math,M)),j=(r=Math.max.apply(Math,M),isFinite(r)?r:0),q=e1(B,{all:M,min:G,max:j},T==="x"?s:l,T),te=n==="vertical"?[V,q]:[q,V],pe=te[0],ne=te[1],O=(V.bandwidth()-h*(S.length-1))/S.length,y=[Jt({},v,{data:b,keys:S,innerPadding:h,xScale:pe,yScale:ne}),O,B.reverse,(e=q(0))!=null?e:0];return{xScale:pe,yScale:ne,bars:O>0?n==="vertical"?kSt.apply(void 0,y):$St.apply(void 0,y):[]}},DSt=["data","layout","minValue","maxValue","reverse","width","height","padding","valueScale","indexScale","hiddenIds"],FSt=function t(e){var r;return e.some(Array.isArray)?t((r=[]).concat.apply(r,e)):e},HSt=function(t,e,r){var n=t.formatValue,i=t.getColor,o=t.getIndex,a=t.getTooltipLabel,s=t.innerPadding,l=t.stackedData,u=t.xScale,c=t.yScale,f=t.margin,h=[];return l.forEach(function(d){return u.domain().forEach(function(p,m){var g,v,S=d[m],b=(g=u(o(S.data)))!=null?g:0,E=((v=function(k){return c(k[r?0:1])}(S))!=null?v:0)+.5*s,T=function(k,M){var G;return((G=c(k[r?1:0]))!=null?G:0)-M}(S,E)-s,N=m5(S.data[d.key]),L=N[0],V=N[1],B={id:d.key,value:L===null?L:V,formattedValue:n(V),hidden:!1,index:m,indexValue:p,data:p5(S.data)};h.push({key:d.key+"."+p,index:h.length,data:B,x:b,y:E,absX:f.left+b,absY:f.top+E,width:e,height:T,color:i(B),label:a(B)})})}),h},BSt=function(t,e,r){var n=t.formatValue,i=t.getColor,o=t.getIndex,a=t.getTooltipLabel,s=t.innerPadding,l=t.stackedData,u=t.xScale,c=t.yScale,f=t.margin,h=[];return l.forEach(function(d){return c.domain().forEach(function(p,m){var g,v,S=d[m],b=(g=c(o(S.data)))!=null?g:0,E=((v=function(k){return u(k[r?1:0])}(S))!=null?v:0)+.5*s,T=function(k,M){var G;return((G=u(k[r?0:1]))!=null?G:0)-M}(S,E)-s,N=m5(S.data[d.key]),L=N[0],V=N[1],B={id:d.key,value:L===null?L:V,formattedValue:n(V),hidden:!1,index:m,indexValue:p,data:p5(S.data)};h.push({key:d.key+"."+p,index:h.length,data:B,x:E,y:b,absX:f.left+E,absY:f.top+b,width:T,height:e,color:i(B),label:a(B)})})}),h},USt=function(t){var e,r=t.data,n=t.layout,i=t.minValue,o=t.maxValue,a=t.reverse,s=t.width,l=t.height,u=t.padding,c=u===void 0?0:u,f=t.valueScale,h=t.indexScale,d=t.hiddenIds,p=d===void 0?[]:d,m=Zp(t,DSt),g=m.keys.filter(function(O){return!p.includes(O)}),v=Hyt().keys(g).offset(gie)(Yoe(r,g)),S=n==="vertical"?["y","x",s]:["x","y",l],b=S[0],E=S[1],T=S[2],N=Goe(r,m.getIndex,c,h,T,E),L=Jt({max:o,min:i,reverse:a},f),V=(e=FSt(v),f.type==="log"?e.filter(function(O){return O!==0}):e),B=Math.min.apply(Math,V),k=Math.max.apply(Math,V),M=e1(L,{all:V,min:B,max:k},b==="x"?s:l,b),G=n==="vertical"?[N,M]:[M,N],j=G[0],q=G[1],te=m.innerPadding>0?m.innerPadding:0,pe=N.bandwidth(),ne=[Jt({},m,{innerPadding:te,stackedData:v,xScale:j,yScale:q}),pe,L.reverse];return{xScale:j,yScale:q,bars:pe>0?n==="vertical"?HSt.apply(void 0,ne):BSt.apply(void 0,ne):[]}},VSt=function(t){var e=t.bars,r=t.direction,n=t.from,i=t.groupMode,o=t.layout,a=t.legendLabel,s=t.reverse,l=Lie(a!=null?a:n==="indexes"?"indexValue":"id");return n==="indexes"?function(u,c,f){var h=P_(u.map(function(d){var p,m;return{id:(p=d.data.indexValue)!=null?p:"",label:f(d.data),hidden:d.data.hidden,color:(m=d.color)!=null?m:"#000"}}),function(d){return d.id});return c==="horizontal"&&h.reverse(),h}(e,o,l):function(u,c,f,h,d,p){var m=P_(u.map(function(g){var v;return{id:g.data.id,label:p(g.data),hidden:g.data.hidden,color:(v=g.color)!=null?v:"#000"}}),function(g){return g.id});return(c==="vertical"&&h==="stacked"&&f==="column"&&d!==!0||c==="horizontal"&&h==="stacked"&&d===!0)&&m.reverse(),m}(e,o,r,i,s,l)},Xoe=function(t){var e=t.indexBy,r=e===void 0?fr.indexBy:e,n=t.keys,i=n===void 0?fr.keys:n,o=t.label,a=o===void 0?fr.label:o,s=t.tooltipLabel,l=s===void 0?fr.tooltipLabel:s,u=t.valueFormat,c=t.colors,f=c===void 0?fr.colors:c,h=t.colorBy,d=h===void 0?fr.colorBy:h,p=t.borderColor,m=p===void 0?fr.borderColor:p,g=t.labelTextColor,v=g===void 0?fr.labelTextColor:g,S=t.groupMode,b=S===void 0?fr.groupMode:S,E=t.layout,T=E===void 0?fr.layout:E,N=t.reverse,L=N===void 0?fr.reverse:N,V=t.data,B=t.minValue,k=B===void 0?fr.minValue:B,M=t.maxValue,G=M===void 0?fr.maxValue:M,j=t.margin,q=t.width,te=t.height,pe=t.padding,ne=pe===void 0?fr.padding:pe,O=t.innerPadding,y=O===void 0?fr.innerPadding:O,R=t.valueScale,C=R===void 0?fr.valueScale:R,A=t.indexScale,P=A===void 0?fr.indexScale:A,H=t.initialHiddenIds,Y=H===void 0?fr.initialHiddenIds:H,z=t.enableLabel,oe=z===void 0?fr.enableLabel:z,me=t.labelSkipWidth,re=me===void 0?fr.labelSkipWidth:me,ge=t.labelSkipHeight,ve=ge===void 0?fr.labelSkipHeight:ge,ie=t.legends,be=ie===void 0?fr.legends:ie,ce=t.legendLabel,_e=J.exports.useState(Y!=null?Y:[]),Ie=_e[0],Oe=_e[1],Ae=J.exports.useCallback(function(ke){Oe(function(We){return We.indexOf(ke)>-1?We.filter(function(Ke){return Ke!==ke}):[].concat(We,[ke])})},[]),xe=C_(r),I=C_(a),D=C_(l),U=jS(u),ae=pr(),X=Vie(f,d),le=xp(m,ae),ee=xp(v,ae),Z=(b==="grouped"?LSt:USt)({layout:T,reverse:L,data:V,getIndex:xe,keys:i,minValue:k,maxValue:G,width:q,height:te,getColor:X,padding:ne,innerPadding:y,valueScale:C,indexScale:P,hiddenIds:Ie,formatValue:U,getTooltipLabel:D,margin:j}),ue=Z.bars,K=Z.xScale,se=Z.yScale,we=J.exports.useMemo(function(){return ue.filter(function(ke){return ke.data.value!==null}).map(function(ke,We){return Jt({},ke,{index:We})})},[ue]),Se=J.exports.useCallback(function(ke){var We=ke.width,Ke=ke.height;return!!oe&&!(re>0&&We<re)&&!(ve>0&&Ke<ve)},[oe,re,ve]),Me=J.exports.useMemo(function(){return i.map(function(ke){var We=ue.find(function(Ke){return Ke.data.id===ke});return Jt({},We,{data:Jt({id:ke},We==null?void 0:We.data,{hidden:Ie.includes(ke)})})})},[Ie,i,ue]),qe=J.exports.useMemo(function(){return be.map(function(ke){return[ke,VSt({bars:ke.dataFrom==="keys"?Me:ue,direction:ke.direction,from:ke.dataFrom,groupMode:b,layout:T,legendLabel:ce,reverse:L})]})},[be,Me,ue,b,T,ce,L]);return{bars:ue,barsWithValue:we,xScale:K,yScale:se,getIndex:xe,getLabel:I,getTooltipLabel:D,formatValue:U,getColor:X,getBorderColor:le,getLabelColor:ee,shouldRenderBarLabel:Se,hiddenIds:Ie,toggleSerie:Ae,legendsWithData:qe}},jSt=["isInteractive","animate","motionConfig","theme","renderWrapper"],WSt=function(t){var e=t.data,r=t.indexBy,n=t.keys,i=t.margin,o=t.width,a=t.height,s=t.groupMode,l=t.layout,u=t.reverse,c=t.minValue,f=t.maxValue,h=t.valueScale,d=t.indexScale,p=t.padding,m=t.innerPadding,g=t.axisTop,v=t.axisRight,S=t.axisBottom,b=S===void 0?xr.axisBottom:S,E=t.axisLeft,T=E===void 0?xr.axisLeft:E,N=t.enableGridX,L=N===void 0?xr.enableGridX:N,V=t.enableGridY,B=V===void 0?xr.enableGridY:V,k=t.gridXValues,M=t.gridYValues,G=t.layers,j=G===void 0?xr.layers:G,q=t.barComponent,te=q===void 0?xr.barComponent:q,pe=t.enableLabel,ne=pe===void 0?xr.enableLabel:pe,O=t.label,y=t.labelSkipWidth,R=y===void 0?xr.labelSkipWidth:y,C=t.labelSkipHeight,A=C===void 0?xr.labelSkipHeight:C,P=t.labelTextColor,H=t.markers,Y=H===void 0?xr.markers:H,z=t.colorBy,oe=t.colors,me=t.defs,re=me===void 0?xr.defs:me,ge=t.fill,ve=ge===void 0?xr.fill:ge,ie=t.borderRadius,be=ie===void 0?xr.borderRadius:ie,ce=t.borderWidth,_e=ce===void 0?xr.borderWidth:ce,Ie=t.borderColor,Oe=t.annotations,Ae=Oe===void 0?xr.annotations:Oe,xe=t.legendLabel,I=t.tooltipLabel,D=t.valueFormat,U=t.isInteractive,ae=U===void 0?xr.isInteractive:U,X=t.tooltip,le=X===void 0?xr.tooltip:X,ee=t.onClick,Z=t.onMouseEnter,ue=t.onMouseLeave,K=t.legends,se=t.role,we=se===void 0?xr.role:se,Se=t.ariaLabel,Me=t.ariaLabelledBy,qe=t.ariaDescribedBy,ke=t.isFocusable,We=ke===void 0?xr.isFocusable:ke,Ke=t.barAriaLabel,Xe=t.barAriaLabelledBy,nt=t.barAriaDescribedBy,Rt=t.initialHiddenIds,it=co(),st=it.animate,rt=it.config,Lt=h5(o,a,i),kt=Lt.outerWidth,It=Lt.outerHeight,gt=Lt.margin,Kr=Lt.innerWidth,rn=Lt.innerHeight,Lr=Xoe({indexBy:r,label:O,tooltipLabel:I,valueFormat:D,colors:oe,colorBy:z,borderColor:Ie,labelTextColor:P,groupMode:s,layout:l,reverse:u,data:e,keys:n,minValue:c,maxValue:f,margin:gt,width:Kr,height:rn,padding:p,innerPadding:m,valueScale:h,indexScale:d,enableLabel:ne,labelSkipWidth:R,labelSkipHeight:A,legends:K,legendLabel:xe,initialHiddenIds:Rt}),fo=Lr.bars,Jp=Lr.barsWithValue,Cn=Lr.xScale,et=Lr.yScale,Et=Lr.getLabel,Wt=Lr.getTooltipLabel,mr=Lr.getBorderColor,Mt=Lr.getLabelColor,_r=Lr.shouldRenderBarLabel,qr=Lr.toggleSerie,Tr=Lr.legendsWithData,kc=bM(Jp,{keys:function(ye){return ye.key},from:function(ye){return Jt({borderColor:mr(ye),color:ye.color,height:0,labelColor:Mt(ye),labelOpacity:0,labelX:ye.width/2,labelY:ye.height/2,transform:"translate("+ye.x+", "+(ye.y+ye.height)+")",width:ye.width},l==="vertical"?{}:{height:ye.height,transform:"translate("+ye.x+", "+ye.y+")",width:0})},enter:function(ye){return{borderColor:mr(ye),color:ye.color,height:ye.height,labelColor:Mt(ye),labelOpacity:1,labelX:ye.width/2,labelY:ye.height/2,transform:"translate("+ye.x+", "+ye.y+")",width:ye.width}},update:function(ye){return{borderColor:mr(ye),color:ye.color,height:ye.height,labelColor:Mt(ye),labelOpacity:1,labelX:ye.width/2,labelY:ye.height/2,transform:"translate("+ye.x+", "+ye.y+")",width:ye.width}},leave:function(ye){return Jt({borderColor:mr(ye),color:ye.color,height:0,labelColor:Mt(ye),labelOpacity:0,labelX:ye.width/2,labelY:0,transform:"translate("+ye.x+", "+(ye.y+ye.height)+")",width:ye.width},l==="vertical"?{}:{labelX:0,labelY:ye.height/2,height:ye.height,transform:"translate("+ye.x+", "+ye.y+")",width:0})},config:rt,immediate:!st}),Ra=J.exports.useMemo(function(){return{borderRadius:be,borderWidth:_e,enableLabel:ne,isInteractive:ae,labelSkipWidth:R,labelSkipHeight:A,onClick:ee,onMouseEnter:Z,onMouseLeave:ue,getTooltipLabel:Wt,tooltip:le,isFocusable:We,ariaLabel:Ke,ariaLabelledBy:Xe,ariaDescribedBy:nt}},[be,_e,ne,Wt,ae,A,R,ee,Z,ue,le,We,Ke,Xe,nt]),xl=Fie(re,fo,ve,{dataKey:"data",targetKey:"data.fill"}),Ve={annotations:null,axes:null,bars:null,grid:null,legends:null,markers:null};j.includes("annotations")&&(Ve.annotations=he.jsx(OSt,{bars:fo,annotations:Ae},"annotations")),j.includes("axes")&&(Ve.axes=he.jsx(yoe,{xScale:Cn,yScale:et,width:Kr,height:rn,top:g,right:v,bottom:b,left:T},"axes")),j.includes("bars")&&(Ve.bars=he.jsx(J.exports.Fragment,{children:kc(function(ye,Te){return J.exports.createElement(te,Jt({},Ra,{bar:Te,style:ye,shouldRenderLabel:_r(Te),label:Et(Te.data)}))})},"bars")),j.includes("grid")&&(Ve.grid=he.jsx(voe,{width:Kr,height:rn,xScale:L?Cn:null,yScale:B?et:null,xValues:k,yValues:M},"grid")),j.includes("legends")&&(Ve.legends=he.jsx(ASt,{width:Kr,height:rn,legends:Tr,toggleSerie:qr},"legends")),j.includes("markers")&&(Ve.markers=he.jsx(kie,{markers:Y,width:Kr,height:rn,xScale:Cn,yScale:et},"markers"));var fe=J.exports.useMemo(function(){return Jt({},Ra,{margin:gt,width:o,height:a,innerWidth:Kr,innerHeight:rn,bars:fo,legendData:Tr,enableLabel:ne,xScale:Cn,yScale:et,tooltip:le,getTooltipLabel:Wt,onClick:ee,onMouseEnter:Z,onMouseLeave:ue})},[Ra,gt,o,a,Kr,rn,fo,Tr,ne,Cn,et,le,Wt,ee,Z,ue]);return he.jsx(XM,{width:kt,height:It,margin:gt,defs:xl,role:we,ariaLabel:Se,ariaLabelledBy:Me,ariaDescribedBy:qe,isFocusable:We,children:j.map(function(ye,Te){var Dt;return typeof ye=="function"?he.jsx(J.exports.Fragment,{children:J.exports.createElement(ye,fe)},Te):(Dt=Ve==null?void 0:Ve[ye])!=null?Dt:null})})},zSt=function(t){var e=t.isInteractive,r=e===void 0?xr.isInteractive:e,n=t.animate,i=n===void 0?xr.animate:n,o=t.motionConfig,a=o===void 0?xr.motionConfig:o,s=t.theme,l=t.renderWrapper,u=Zp(t,jSt);return he.jsx(d5,{animate:i,isInteractive:r,motionConfig:a,renderWrapper:l,theme:s,children:he.jsx(WSt,Jt({isInteractive:r},u))})},GSt=["isInteractive","renderWrapper","theme"],x_=function(t,e,r,n){return t.find(function(i){return Die(i.x+e.left,i.y+e.top,i.width,i.height,r,n)})},YSt=function(t){var e=t.data,r=t.indexBy,n=t.keys,i=t.margin,o=t.width,a=t.height,s=t.groupMode,l=t.layout,u=t.reverse,c=t.minValue,f=t.maxValue,h=t.valueScale,d=t.indexScale,p=t.padding,m=t.innerPadding,g=t.axisTop,v=t.axisRight,S=t.axisBottom,b=S===void 0?ni.axisBottom:S,E=t.axisLeft,T=E===void 0?ni.axisLeft:E,N=t.enableGridX,L=N===void 0?ni.enableGridX:N,V=t.enableGridY,B=V===void 0?ni.enableGridY:V,k=t.gridXValues,M=t.gridYValues,G=t.layers,j=G===void 0?ni.layers:G,q=t.renderBar,te=q===void 0?function(et,Et){var Wt=Et.bar,mr=Wt.color,Mt=Wt.height,_r=Wt.width,qr=Wt.x,Tr=Wt.y,kc=Et.borderColor,Ra=Et.borderRadius,xl=Et.borderWidth,Ve=Et.label,fe=Et.labelColor,ye=Et.shouldRenderLabel;if(et.fillStyle=mr,xl>0&&(et.strokeStyle=kc,et.lineWidth=xl),et.beginPath(),Ra>0){var Te=Math.min(Ra,Mt);et.moveTo(qr+Te,Tr),et.lineTo(qr+_r-Te,Tr),et.quadraticCurveTo(qr+_r,Tr,qr+_r,Tr+Te),et.lineTo(qr+_r,Tr+Mt-Te),et.quadraticCurveTo(qr+_r,Tr+Mt,qr+_r-Te,Tr+Mt),et.lineTo(qr+Te,Tr+Mt),et.quadraticCurveTo(qr,Tr+Mt,qr,Tr+Mt-Te),et.lineTo(qr,Tr+Te),et.quadraticCurveTo(qr,Tr,qr+Te,Tr),et.closePath()}else et.rect(qr,Tr,_r,Mt);et.fill(),xl>0&&et.stroke(),ye&&(et.textBaseline="middle",et.textAlign="center",et.fillStyle=fe,et.fillText(Ve,qr+_r/2,Tr+Mt/2))}:q,pe=t.enableLabel,ne=pe===void 0?ni.enableLabel:pe,O=t.label,y=t.labelSkipWidth,R=y===void 0?ni.labelSkipWidth:y,C=t.labelSkipHeight,A=C===void 0?ni.labelSkipHeight:C,P=t.labelTextColor,H=t.colorBy,Y=t.colors,z=t.borderRadius,oe=z===void 0?ni.borderRadius:z,me=t.borderWidth,re=me===void 0?ni.borderWidth:me,ge=t.borderColor,ve=t.annotations,ie=ve===void 0?ni.annotations:ve,be=t.legendLabel,ce=t.tooltipLabel,_e=t.valueFormat,Ie=t.isInteractive,Oe=Ie===void 0?ni.isInteractive:Ie,Ae=t.tooltip,xe=Ae===void 0?ni.tooltip:Ae,I=t.onClick,D=t.onMouseEnter,U=t.onMouseLeave,ae=t.legends,X=t.pixelRatio,le=X===void 0?ni.pixelRatio:X,ee=t.canvasRef,Z=J.exports.useRef(null),ue=pr(),K=h5(o,a,i),se=K.margin,we=K.innerWidth,Se=K.innerHeight,Me=K.outerWidth,qe=K.outerHeight,ke=Xoe({indexBy:r,label:O,tooltipLabel:ce,valueFormat:_e,colors:Y,colorBy:H,borderColor:ge,labelTextColor:P,groupMode:s,layout:l,reverse:u,data:e,keys:n,minValue:c,maxValue:f,margin:se,width:we,height:Se,padding:p,innerPadding:m,valueScale:h,indexScale:d,enableLabel:ne,labelSkipWidth:R,labelSkipHeight:A,legends:ae,legendLabel:be}),We=ke.bars,Ke=ke.barsWithValue,Xe=ke.xScale,nt=ke.yScale,Rt=ke.getLabel,it=ke.getTooltipLabel,st=ke.getBorderColor,rt=ke.getLabelColor,Lt=ke.shouldRenderBarLabel,kt=ke.legendsWithData,It=Z1(),gt=It.showTooltipFromEvent,Kr=It.hideTooltip,rn=bSt({annotations:zoe({data:We,annotations:ie,getPosition:function(et){return{x:et.x,y:et.y}},getDimensions:function(et){var Et=et.width,Wt=et.height;return{width:Et,height:Wt,size:Math.max(Et,Wt)}}})}),Lr=J.exports.useMemo(function(){return{borderRadius:oe,borderWidth:re,isInteractive:Oe,isFocusable:!1,labelSkipWidth:R,labelSkipHeight:A,margin:se,width:o,height:a,innerWidth:we,innerHeight:Se,bars:We,legendData:kt,enableLabel:ne,xScale:Xe,yScale:nt,tooltip:xe,getTooltipLabel:it,onClick:I,onMouseEnter:D,onMouseLeave:U}},[oe,re,Oe,R,A,se,o,a,we,Se,We,kt,ne,Xe,nt,xe,it,I,D,U]);J.exports.useEffect(function(){var et,Et=(et=Z.current)==null?void 0:et.getContext("2d");Z.current&&Et&&(Z.current.width=Me*le,Z.current.height=qe*le,Et.scale(le,le),Et.fillStyle=ue.background,Et.fillRect(0,0,Me,qe),Et.translate(se.left,se.top),j.forEach(function(Wt){Wt==="grid"?typeof ue.grid.line.strokeWidth=="number"&&ue.grid.line.strokeWidth>0&&(Et.lineWidth=ue.grid.line.strokeWidth,Et.strokeStyle=ue.grid.line.stroke,L&&KS(Et,{width:o,height:a,scale:Xe,axis:"x",values:k}),B&&KS(Et,{width:o,height:a,scale:nt,axis:"y",values:M})):Wt==="axes"?boe(Et,{xScale:Xe,yScale:nt,width:we,height:Se,top:g,right:v,bottom:b,left:T,theme:ue}):Wt==="bars"?Ke.forEach(function(mr){te(Et,{bar:mr,borderColor:st(mr),borderRadius:oe,borderWidth:re,label:Rt(mr.data),labelColor:rt(mr),shouldRenderLabel:Lt(mr)})}):Wt==="legends"?kt.forEach(function(mr){var Mt=mr[0],_r=mr[1];Eoe(Et,Jt({},Mt,{data:_r,containerWidth:we,containerHeight:Se,theme:ue}))}):Wt==="annotations"?TSt(Et,{annotations:rn,theme:ue}):typeof Wt=="function"&&Wt(Et,Lr)}),Et.save())},[b,T,v,g,Ke,oe,re,rn,L,B,st,Rt,rt,k,M,s,a,Se,we,Lr,j,l,kt,se.left,se.top,qe,Me,le,te,Xe,nt,u,Lt,ue,o]);var fo=J.exports.useCallback(function(et){if(We&&Z.current){var Et=Eg(Z.current,et),Wt=Et[0],mr=Et[1],Mt=x_(We,se,Wt,mr);Mt!==void 0?(gt(J.exports.createElement(xe,Jt({},Mt.data,{color:Mt.color,label:Mt.label,value:Number(Mt.data.value)})),et),et.type==="mouseenter"&&(D==null||D(Mt.data,et))):Kr()}},[Kr,se,D,We,gt,xe]),Jp=J.exports.useCallback(function(et){if(We&&Z.current){Kr();var Et=Eg(Z.current,et),Wt=Et[0],mr=Et[1],Mt=x_(We,se,Wt,mr);Mt&&(U==null||U(Mt.data,et))}},[Kr,se,U,We]),Cn=J.exports.useCallback(function(et){if(We&&Z.current){var Et=Eg(Z.current,et),Wt=Et[0],mr=Et[1],Mt=x_(We,se,Wt,mr);Mt!==void 0&&(I==null||I(Jt({},Mt.data,{color:Mt.color}),et))}},[se,I,We]);return he.jsx("canvas",{ref:function(et){Z.current=et,ee&&"current"in ee&&(ee.current=et)},width:Me*le,height:qe*le,style:{width:Me,height:qe,cursor:Oe?"auto":"normal"},onMouseEnter:Oe?fo:void 0,onMouseMove:Oe?fo:void 0,onMouseLeave:Oe?Jp:void 0,onClick:Oe?Cn:void 0})},KSt=J.exports.forwardRef(function(t,e){var r=t.isInteractive,n=t.renderWrapper,i=t.theme,o=Zp(t,GSt);return he.jsx(d5,{isInteractive:r,renderWrapper:n,theme:i,animate:!1,children:he.jsx(YSt,Jt({},o,{canvasRef:e}))})}),qSt=function(t){return he.jsx(t0,{children:function(e){var r=e.width,n=e.height;return he.jsx(zSt,Jt({width:r,height:n},t))}})};J.exports.forwardRef(function(t,e){return he.jsx(t0,{children:function(r){var n=r.width,i=r.height;return he.jsx(KSt,Jt({width:n,height:i},t,{ref:e}))}})});function XSt(){const{startDate:t,endDate:e}=rM(),[r]=Cs(V4),n=Xi.exports.useLiveQuery(async()=>{const i=await Mf.expenditure.where(ur.datetime).between(t,e||1/0,!0,!0).toArray(),o=Vv(await Mf.recurring.toArray(),t,e),a=Gae([...i,...o]).filter(u=>u.txn_type===pn.CREDIT).groupBy(ur.creditCard).mapValues(u=>u.reduce((c,f)=>c+Number(f.amount),0)).value(),s=[];return{chartData:Object.entries(a).reduce((u,c)=>{const[f,h]=c;return s.push(f),[...u,{source:f,[f]:h}]},[]),banks:on.exports.uniq(s)}},[t,e]);return de.createElement(Ua,{sx:Joe},de.createElement(ms,{variant:"h6"},"Spending by Card"),de.createElement(qSt,{data:(n==null?void 0:n.chartData)||[],indexBy:"source",keys:(n==null?void 0:n.banks)||[],tooltip:i=>de.createElement(eae,null,`${i.id} $${i.value.toLocaleString()}`),margin:{top:10,right:10,bottom:40,left:40},theme:{axis:{legend:{text:{fill:r?"#939393":"#000"}},ticks:{text:{fill:r?"#939393":"#000"}}},labels:{text:{fill:r?"#fff":"#000",textShadow:`1px 1px ${r?"black":"white"}`}}}}))}var rN={},QSt=Hz.exports;Object.defineProperty(rN,"__esModule",{value:!0});var Qoe=rN.default=void 0,ZSt=QSt(Dz()),JSt=Fz(),e6t=(0,ZSt.default)((0,JSt.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12 1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteForever");Qoe=rN.default=e6t;var t6t=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Xr=globalThis&&globalThis.__assign||function(){return Xr=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Xr.apply(this,arguments)},wz={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},Sz={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},kb={width:"20px",height:"20px",position:"absolute"},r6t={top:Xr(Xr({},wz),{top:"-5px"}),right:Xr(Xr({},Sz),{left:void 0,right:"-5px"}),bottom:Xr(Xr({},wz),{top:void 0,bottom:"-5px"}),left:Xr(Xr({},Sz),{left:"-5px"}),topRight:Xr(Xr({},kb),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:Xr(Xr({},kb),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:Xr(Xr({},kb),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:Xr(Xr({},kb),{left:"-10px",top:"-10px",cursor:"nw-resize"})},n6t=function(t){t6t(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.onMouseDown=function(n){r.props.onResizeStart(n,r.props.direction)},r.onTouchStart=function(n){r.props.onResizeStart(n,r.props.direction)},r}return e.prototype.render=function(){return J.exports.createElement("div",{className:this.props.className||"",style:Xr(Xr({position:"absolute",userSelect:"none"},r6t[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},e}(J.exports.PureComponent),i6t=globalThis&&globalThis.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Xo=globalThis&&globalThis.__assign||function(){return Xo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Xo.apply(this,arguments)},o6t={width:"auto",height:"auto"},$b=function(t,e,r){return Math.max(Math.min(t,r),e)},Rz=function(t,e){return Math.round(t/e)*e},wf=function(t,e){return new RegExp(t,"i").test(e)},Lb=function(t){return Boolean(t.touches&&t.touches.length)},a6t=function(t){return Boolean((t.clientX||t.clientX===0)&&(t.clientY||t.clientY===0))},Ez=function(t,e,r){r===void 0&&(r=0);var n=e.reduce(function(o,a,s){return Math.abs(a-t)<Math.abs(e[o]-t)?s:o},0),i=Math.abs(e[n]-t);return r===0||i<r?e[n]:t},I_=function(t){return t=t.toString(),t==="auto"||t.endsWith("px")||t.endsWith("%")||t.endsWith("vh")||t.endsWith("vw")||t.endsWith("vmax")||t.endsWith("vmin")?t:t+"px"},Db=function(t,e,r,n){if(t&&typeof t=="string"){if(t.endsWith("px"))return Number(t.replace("px",""));if(t.endsWith("%")){var i=Number(t.replace("%",""))/100;return e*i}if(t.endsWith("vw")){var i=Number(t.replace("vw",""))/100;return r*i}if(t.endsWith("vh")){var i=Number(t.replace("vh",""))/100;return n*i}}return t},s6t=function(t,e,r,n,i,o,a){return n=Db(n,t.width,e,r),i=Db(i,t.height,e,r),o=Db(o,t.width,e,r),a=Db(a,t.height,e,r),{maxWidth:typeof n>"u"?void 0:Number(n),maxHeight:typeof i>"u"?void 0:Number(i),minWidth:typeof o>"u"?void 0:Number(o),minHeight:typeof a>"u"?void 0:Number(a)}},l6t=["as","style","className","grid","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],Cz="__resizable_base__",u6t=function(t){i6t(e,t);function e(r){var n=t.call(this,r)||this;return n.ratio=1,n.resizable=null,n.parentLeft=0,n.parentTop=0,n.resizableLeft=0,n.resizableRight=0,n.resizableTop=0,n.resizableBottom=0,n.targetLeft=0,n.targetTop=0,n.appendBase=function(){if(!n.resizable||!n.window)return null;var i=n.parentNode;if(!i)return null;var o=n.window.document.createElement("div");return o.style.width="100%",o.style.height="100%",o.style.position="absolute",o.style.transform="scale(0, 0)",o.style.left="0",o.style.flex="0 0 100%",o.classList?o.classList.add(Cz):o.className+=Cz,i.appendChild(o),o},n.removeBase=function(i){var o=n.parentNode;!o||o.removeChild(i)},n.ref=function(i){i&&(n.resizable=i)},n.state={isResizing:!1,width:typeof(n.propsSize&&n.propsSize.width)>"u"?"auto":n.propsSize&&n.propsSize.width,height:typeof(n.propsSize&&n.propsSize.height)>"u"?"auto":n.propsSize&&n.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},n.onResizeStart=n.onResizeStart.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n}return Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){return!this.resizable||!this.resizable.ownerDocument?null:this.resizable.ownerDocument.defaultView},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||o6t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){var r=0,n=0;if(this.resizable&&this.window){var i=this.resizable.offsetWidth,o=this.resizable.offsetHeight,a=this.resizable.style.position;a!=="relative"&&(this.resizable.style.position="relative"),r=this.resizable.style.width!=="auto"?this.resizable.offsetWidth:i,n=this.resizable.style.height!=="auto"?this.resizable.offsetHeight:o,this.resizable.style.position=a}return{width:r,height:n}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sizeStyle",{get:function(){var r=this,n=this.props.size,i=function(s){if(typeof r.state[s]>"u"||r.state[s]==="auto")return"auto";if(r.propsSize&&r.propsSize[s]&&r.propsSize[s].toString().endsWith("%")){if(r.state[s].toString().endsWith("%"))return r.state[s].toString();var l=r.getParentSize(),u=Number(r.state[s].toString().replace("px","")),c=u/l[s]*100;return c+"%"}return I_(r.state[s])},o=n&&typeof n.width<"u"&&!this.state.isResizing?I_(n.width):i("width"),a=n&&typeof n.height<"u"&&!this.state.isResizing?I_(n.height):i("height");return{width:o,height:a}},enumerable:!1,configurable:!0}),e.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var r=this.appendBase();if(!r)return{width:0,height:0};var n=!1,i=this.parentNode.style.flexWrap;i!=="wrap"&&(n=!0,this.parentNode.style.flexWrap="wrap"),r.style.position="relative",r.style.minWidth="100%",r.style.minHeight="100%";var o={width:r.offsetWidth,height:r.offsetHeight};return n&&(this.parentNode.style.flexWrap=i),this.removeBase(r),o},e.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},e.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},e.prototype.componentDidMount=function(){if(!(!this.resizable||!this.window)){var r=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:r.flexBasis!=="auto"?r.flexBasis:void 0})}},e.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},e.prototype.createSizeForCssProperty=function(r,n){var i=this.propsSize&&this.propsSize[n];return this.state[n]==="auto"&&this.state.original[n]===r&&(typeof i>"u"||i==="auto")?"auto":r},e.prototype.calculateNewMaxFromBoundary=function(r,n){var i=this.props.boundsByDirection,o=this.state.direction,a=i&&wf("left",o),s=i&&wf("top",o),l,u;if(this.props.bounds==="parent"){var c=this.parentNode;c&&(l=a?this.resizableRight-this.parentLeft:c.offsetWidth+(this.parentLeft-this.resizableLeft),u=s?this.resizableBottom-this.parentTop:c.offsetHeight+(this.parentTop-this.resizableTop))}else this.props.bounds==="window"?this.window&&(l=a?this.resizableRight:this.window.innerWidth-this.resizableLeft,u=s?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(l=a?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),u=s?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return l&&Number.isFinite(l)&&(r=r&&r<l?r:l),u&&Number.isFinite(u)&&(n=n&&n<u?n:u),{maxWidth:r,maxHeight:n}},e.prototype.calculateNewSizeFromDirection=function(r,n){var i=this.props.scale||1,o=this.props.resizeRatio||1,a=this.state,s=a.direction,l=a.original,u=this.props,c=u.lockAspectRatio,f=u.lockAspectRatioExtraHeight,h=u.lockAspectRatioExtraWidth,d=l.width,p=l.height,m=f||0,g=h||0;return wf("right",s)&&(d=l.width+(r-l.x)*o/i,c&&(p=(d-g)/this.ratio+m)),wf("left",s)&&(d=l.width-(r-l.x)*o/i,c&&(p=(d-g)/this.ratio+m)),wf("bottom",s)&&(p=l.height+(n-l.y)*o/i,c&&(d=(p-m)*this.ratio+g)),wf("top",s)&&(p=l.height-(n-l.y)*o/i,c&&(d=(p-m)*this.ratio+g)),{newWidth:d,newHeight:p}},e.prototype.calculateNewSizeFromAspectRatio=function(r,n,i,o){var a=this.props,s=a.lockAspectRatio,l=a.lockAspectRatioExtraHeight,u=a.lockAspectRatioExtraWidth,c=typeof o.width>"u"?10:o.width,f=typeof i.width>"u"||i.width<0?r:i.width,h=typeof o.height>"u"?10:o.height,d=typeof i.height>"u"||i.height<0?n:i.height,p=l||0,m=u||0;if(s){var g=(h-p)*this.ratio+m,v=(d-p)*this.ratio+m,S=(c-m)/this.ratio+p,b=(f-m)/this.ratio+p,E=Math.max(c,g),T=Math.min(f,v),N=Math.max(h,S),L=Math.min(d,b);r=$b(r,E,T),n=$b(n,N,L)}else r=$b(r,c,f),n=$b(n,h,d);return{newWidth:r,newHeight:n}},e.prototype.setBoundingClientRect=function(){if(this.props.bounds==="parent"){var r=this.parentNode;if(r){var n=r.getBoundingClientRect();this.parentLeft=n.left,this.parentTop=n.top}}if(this.props.bounds&&typeof this.props.bounds!="string"){var i=this.props.bounds.getBoundingClientRect();this.targetLeft=i.left,this.targetTop=i.top}if(this.resizable){var o=this.resizable.getBoundingClientRect(),a=o.left,s=o.top,l=o.right,u=o.bottom;this.resizableLeft=a,this.resizableRight=l,this.resizableTop=s,this.resizableBottom=u}},e.prototype.onResizeStart=function(r,n){if(!(!this.resizable||!this.window)){var i=0,o=0;if(r.nativeEvent&&a6t(r.nativeEvent)?(i=r.nativeEvent.clientX,o=r.nativeEvent.clientY):r.nativeEvent&&Lb(r.nativeEvent)&&(i=r.nativeEvent.touches[0].clientX,o=r.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable){var a=this.props.onResizeStart(r,n,this.resizable);if(a===!1)return}this.props.size&&(typeof this.props.size.height<"u"&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),typeof this.props.size.width<"u"&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio=typeof this.props.lockAspectRatio=="number"?this.props.lockAspectRatio:this.size.width/this.size.height;var s,l=this.window.getComputedStyle(this.resizable);if(l.flexBasis!=="auto"){var u=this.parentNode;if(u){var c=this.window.getComputedStyle(u).flexDirection;this.flexDir=c.startsWith("row")?"row":"column",s=l.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var f={original:{x:i,y:o,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:Xo(Xo({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(r.target).cursor||"auto"}),direction:n,flexBasis:s};this.setState(f)}},e.prototype.onMouseMove=function(r){var n=this;if(!(!this.state.isResizing||!this.resizable||!this.window)){if(this.window.TouchEvent&&Lb(r))try{r.preventDefault(),r.stopPropagation()}catch{}var i=this.props,o=i.maxWidth,a=i.maxHeight,s=i.minWidth,l=i.minHeight,u=Lb(r)?r.touches[0].clientX:r.clientX,c=Lb(r)?r.touches[0].clientY:r.clientY,f=this.state,h=f.direction,d=f.original,p=f.width,m=f.height,g=this.getParentSize(),v=s6t(g,this.window.innerWidth,this.window.innerHeight,o,a,s,l);o=v.maxWidth,a=v.maxHeight,s=v.minWidth,l=v.minHeight;var S=this.calculateNewSizeFromDirection(u,c),b=S.newHeight,E=S.newWidth,T=this.calculateNewMaxFromBoundary(o,a);this.props.snap&&this.props.snap.x&&(E=Ez(E,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(b=Ez(b,this.props.snap.y,this.props.snapGap));var N=this.calculateNewSizeFromAspectRatio(E,b,{width:T.maxWidth,height:T.maxHeight},{width:s,height:l});if(E=N.newWidth,b=N.newHeight,this.props.grid){var L=Rz(E,this.props.grid[0]),V=Rz(b,this.props.grid[1]),B=this.props.snapGap||0;E=B===0||Math.abs(L-E)<=B?L:E,b=B===0||Math.abs(V-b)<=B?V:b}var k={width:E-d.width,height:b-d.height};if(p&&typeof p=="string"){if(p.endsWith("%")){var M=E/g.width*100;E=M+"%"}else if(p.endsWith("vw")){var G=E/this.window.innerWidth*100;E=G+"vw"}else if(p.endsWith("vh")){var j=E/this.window.innerHeight*100;E=j+"vh"}}if(m&&typeof m=="string"){if(m.endsWith("%")){var M=b/g.height*100;b=M+"%"}else if(m.endsWith("vw")){var G=b/this.window.innerWidth*100;b=G+"vw"}else if(m.endsWith("vh")){var j=b/this.window.innerHeight*100;b=j+"vh"}}var q={width:this.createSizeForCssProperty(E,"width"),height:this.createSizeForCssProperty(b,"height")};this.flexDir==="row"?q.flexBasis=q.width:this.flexDir==="column"&&(q.flexBasis=q.height),Lz.exports.flushSync(function(){n.setState(q)}),this.props.onResize&&this.props.onResize(r,h,this.resizable,k)}},e.prototype.onMouseUp=function(r){var n=this.state,i=n.isResizing,o=n.direction,a=n.original;if(!(!i||!this.resizable)){var s={width:this.size.width-a.width,height:this.size.height-a.height};this.props.onResizeStop&&this.props.onResizeStop(r,o,this.resizable,s),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:Xo(Xo({},this.state.backgroundStyle),{cursor:"auto"})})}},e.prototype.updateSize=function(r){this.setState({width:r.width,height:r.height})},e.prototype.renderResizer=function(){var r=this,n=this.props,i=n.enable,o=n.handleStyles,a=n.handleClasses,s=n.handleWrapperStyle,l=n.handleWrapperClass,u=n.handleComponent;if(!i)return null;var c=Object.keys(i).map(function(f){return i[f]!==!1?J.exports.createElement(n6t,{key:f,direction:f,onResizeStart:r.onResizeStart,replaceStyles:o&&o[f],className:a&&a[f]},u&&u[f]?u[f]:null):null});return J.exports.createElement("div",{className:l,style:s},c)},e.prototype.render=function(){var r=this,n=Object.keys(this.props).reduce(function(a,s){return l6t.indexOf(s)!==-1||(a[s]=r.props[s]),a},{}),i=Xo(Xo(Xo({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(i.flexBasis=this.state.flexBasis);var o=this.props.as||"div";return J.exports.createElement(o,Xo({ref:this.ref,style:i,className:this.props.className},n),this.state.isResizing&&J.exports.createElement("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer())},e.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},e}(J.exports.PureComponent),nN={},c6t=Hz.exports;Object.defineProperty(nN,"__esModule",{value:!0});var Zoe=nN.default=void 0,f6t=c6t(Dz()),h6t=Fz(),d6t=(0,f6t.default)((0,h6t.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"FileDownload");Zoe=nN.default=d6t;const p6t=(t,e)=>{const r=JSON.stringify(t,null,2),n=new Blob([r],{type:"application/json"}),i=URL.createObjectURL(n),o=document.createElement("a");o.href=i,o.download=e+".json",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)},m6t=()=>{const t=n1(f=>f.database),e="90vw",[r,n]=J.exports.useState(400),[i,o]=J.exports.useState(0),[a,s]=J.exports.useState(""),l=Xi.exports.useLiveQuery(async()=>{const f=await t.expenditure.toArray();let{minDate:h,maxDate:d}=f.reduce((g,v)=>({minDate:Math.min(v.datetime,g.minDate),maxDate:Math.max(v.datetime,g.maxDate)}),{minDate:1/0,maxDate:0});const p=f.reduce((g,v)=>Math.max(g,v.id||0),0),m=Vv(await t.recurring.where("start").belowOrEqual(d).toArray(),h,d).map((g,v)=>({...g,id:p+v}));return on.exports.sortBy([...f,...m],["datetime"])}),u=J.exports.useCallback(f=>{let h=f.row.id,d=f.field,p=f.value;t.expenditure.update(h,{[d]:d==="amount"?parseFloat(p):p}).then().finally()},[]),c=[{field:"datetime",renderCell:f=>`${xt.unix(f.row.datetime).format("YYYY MMM DD")}`},{field:"category",editable:!0,renderCell:f=>{let h=[];try{h=JSON.parse(f.row.category)}catch(d){console.error(d)}return de.createElement(de.Fragment,null,h.map(d=>de.createElement(Xae,{label:d})))}},{field:"credit_card"},{field:"name",editable:!0},{field:"amount",editable:!0},{field:"delete",renderCell:f=>de.createElement(_g,{onClick:async()=>{f.row.recurringId?await t.recurring.delete(f.row.recurringId):await t.expenditure.delete(f.row.id)}},de.createElement(Qoe,null))},{field:"txn_type"}];return de.createElement("div",null,de.createElement(u6t,{size:{width:e,height:r},onResizeStop:(f,h,d,p)=>{n(r+p.height)},minWidth:e,maxWidth:e,minHeight:220},de.createElement(jae,{sx:{[`& .${pn.DEBIT}`]:{bgcolor:"green"},[`& .${pn.CREDIT}`]:{bgcolor:"red"},[`& .${pn.SALARY}`]:{bgcolor:"blue"},[`& .${pn.RECURRING}`]:{bgcolor:"orange",color:"grey"}},onCellEditCommit:u,disableSelectionOnClick:!0,columns:c,rows:l||[],getRowClassName:f=>f.row[ur.transactionType],initialState:{sorting:{sortModel:[{field:"datetime",sort:"desc"}]}}})),de.createElement(Nt,{style:{width:"100%"},container:!0,direction:"row",justifyContent:"space-between",alignItems:"flex-start"},de.createElement(Nt,{item:!0},de.createElement(j2,{variant:"contained",startIcon:de.createElement(Zoe,null),onClick:async()=>{const f=await t.expenditure.toArray(),h=await t.recurring.toArray();p6t({expenditure:f,recurring:h},"expenditure")}},"export")),de.createElement(Nt,{item:!0},de.createElement(ms,{variant:"subtitle2",onClick:()=>o(i+1)},"*psst this table is resizable"))),i>=10&&de.createElement("div",null,de.createElement(j2,{size:"small",onClick:()=>{const f=JSON.parse(a);"expenditure"in f&&t.expenditure.clear().then(()=>{t.expenditure.bulkAdd(f.expenditure)}),"recurring"in f&&t.recurring.clear().then(()=>{t.recurring.bulkAdd(f.recurring)})}},"upload"),de.createElement("input",{type:"file",accept:"application/json",onChange:f=>{let h=new FileReader;f.target.files!==null&&(h.readAsText(f.target.files[0],"UTF-8"),h.onload=d=>{var p;s((p=d.target)==null?void 0:p.result)})}})))},g6t=()=>de.createElement(Nt,{container:!0,justifyContent:"center",alignItems:"center",direction:"column"},de.createElement(Nt,{item:!0},de.createElement(XSt,null)),de.createElement(Nt,{item:!0},de.createElement(ubt,null)),de.createElement(Nt,{item:!0},de.createElement(m6t,null))),Joe={m:4,height:"40vh",width:"80vw",textAlign:"center"},eae=({children:t})=>{const[e]=Cs(V4);return de.createElement(Ua,{sx:{backgroundColor:e?"#000":"#fff",padding:"5px 10px 5px 10px",borderRadius:"25px"}},t)};function y6t(){const{minDate:t,totalMonths:e}=rM(),[r,n]=Cs(fre);return de.createElement(Nt,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",style:{width:"80vw"}},de.createElement(Nt,{item:!0},de.createElement(_g,{onClick:()=>n(Math.min(e-1,r+1))},de.createElement(xct,null))),de.createElement(Nt,{item:!0},de.createElement(ms,null,xt.unix(t!=null?t:xt().unix()).subtract(r,"month").format("MMM YYYY"))),de.createElement(Nt,{item:!0},de.createElement(_g,{onClick:()=>n(Math.max(0,r-1))},de.createElement(Ict,null))))}var v6t={exports:{}};(function(t,e){(function(r,n){t.exports=n(lae())})(ch,function(r){function n(a){return a&&typeof a=="object"&&"default"in a?a:{default:a}}var i=n(r),o={name:"en-sg",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),weekStart:1,weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),ordinal:function(a){return a},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"}};return i.default.locale(o,null,!0),o})})(v6t);const M_=[{name:"Input",component:Wct},{name:"Insights",component:g6t},{name:"Goals",component:Oct}],N6t=()=>{const[t,e]=J.exports.useState(M_[2].name);return de.createElement(Ua,{sx:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"}},de.createElement(y6t,null),de.createElement(Wae,{value:t,onChange:(r,n)=>e(n)},M_.map((r,n)=>de.createElement(zae,{label:r.name,key:n,value:r.name}))),de.createElement(Ua,{sx:{mt:2,mb:6}},M_.map((r,n)=>{if(t===r.name)return de.createElement(r.component,{key:n})})),de.createElement(Fct,null))};export{N6t as default};
